id,original query
1,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating<3)*100,2) as poor_query_percentage from Queries group by 1"
2,"select query_name,round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*), 2) as poor_query_percentage from Queries group by query_name "
3,"SELECT query_name, ROUND(AVG(rating/position),2) As 'quality', ROUND(100*SUM(IF(rating<3,1,0))/COUNT(query_name),2) As 'poor_query_percentage' FROM Queries GROUP BY query_name"
4,"select query_name, round(avg(rating/position),2) as quality, round((sum(rating < 3)/count(rating))*100,2) as poor_query_percentage from queries group by query_name"
5,"select query_name,round(sum(rating/position)/count(*),2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from queries group by query_name"
6,"Select query_name , round(avg(rating/position),2) as quality , round(sum(case when rating < 3 then 1 else 0 end)*100/count(rating),2) as poor_query_percentage From Queries Group by query_name"
7,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
8,"select query_name, round(avg(rating/position),2) as quality, round(sum(if(rating<3, 1, 0))*100/sum(1),2) as poor_query_percentage from queries group by 1"
9,"select query_name, round(avg(rating/position), 2) as quality, round(avg(case when rating <3 then 1 else 0 end)*100, 2) as poor_query_percentage from queries group by query_name"
10,"SELECT query_name, ROUND( SUM(rating / position) / COUNT(query_name), 2 ) AS quality, ROUND( 100 * SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(query_name) , 2 ) AS poor_query_percentage FROM Queries Group BY 1"
11,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(rating < 3)*100,2) AS poor_query_percentage From Queries GROUP By query_name"
12,"select query_name, round(avg(rating/position),2) as quality , round(avg(case when rating < 3 then 1 else 0 end)*100,2) as poor_query_percentage from queries group by query_name"
13,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
14,"SELECT query_name, ROUND (AVG(rating/position),2) AS quality, ROUND (AVG(rating<3) *100,2) AS poor_query_percentage From Queries GROUP BY query_name "
15,"SELECT query_name, ROUND(AVG(quality),2) quality,ROUND(AVG(poor)*100,2) poor_query_percentage FROM( SELECT query_name, rating/position quality, IF(rating<3,1,0) poor FROM Queries ) t GROUP BY query_name"
16,"select query_name, round(avg(rating/position),2) as quality, round(avg(case when rating<3 then 1 else 0 end)*100,2) as poor_query_percentage from queries group by query_name "
17,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(result)*100,2) as poor_query_percentage from Queries group by 1"
18,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
19,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
20,"select query_name,round(avg(rating/position),2) as quality, round(avg(poorrating)*100,2) as poor_query_percentage from ( select query_name,position,rating, (case when rating <3 then 1 else 0 end) as poorrating from queries)temp group by query_name "
21,"select query_name, round(avg(rating/position),2) AS quality, round(avg(rating<3)*100,2) AS poor_query_percentage from Queries group by query_name "
22,"select query_name, round(avg(rating/position), 2) as quality, round((sum(case when rating < 3 then 1 else 0 end)/count(rating))*100, 2) as poor_query_percentage from queries group by query_name"
23,"select query_name, coalesce(round(avg(rating/position),2),0) as quality, coalesce(round(sum(case when rating < 3 then 1 else 0 end)*100 / count(*),2),0) as poor_query_percentage from queries group by 1"
24,"select query_name, round(sum(rating/position)/count(*),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from queries group by 1"
25,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
26,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality,ROUND((SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(query_name))*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
27,"SELECT query_name, ROUND(SUM(rating/ position) / COUNT(query_name),2) AS quality, ROUND(SUM(rating < 3) / COUNT(query_name) * 100 , 2) AS poor_query_percentage FROM queries GROUP BY query_name "
28,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating <3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from (select distinct * from queries) q group by 1"
29,"select t.query_name,round(avg(quality),2) as quality,round(sum(case when r.rating<3 then 1 else 0 end)/count(r.rating)*100,2) as poor_query_percentage from (select query_name, rating/position as quality from queries ) t, queries r where r.query_name = t.query_name group by t.query_name"
30,"with temp as ( select query_name, rating/position as quality, case when rating<3 then 1 else 0 end as poor from queries ) select query_name, round(avg(quality),2) as quality, round(avg(poor)*100,2) as poor_query_percentage from temp group by query_name"
31,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
32,"select a.query_name, round(avg(a.rating/a.position),2) as quality,IFNULL(round(b.coun/count(*)*100,2),0.00) as poor_query_percentage from Queries as a left join ( select query_name,count(*) as coun from Queries where rating<3 group by query_name) as b on a.query_name = b.query_name group by a.query_name"
33,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(rating)*100, 2) AS poor_query_percentage FROM Queries GROUP BY 1"
34,"select query_name, round(avg(rating/position),2)as quality , round(100*avg(case when rating < 3 then 1 else 0 end),2) as poor_query_percentage from Queries group by 1"
35,"round(sum(case when rating < 3 then 1 else 0 end)/count(q.query_name)*100,2) as poor_query_percentage from Queries q group by q.query_name "
36,"select query_name, round(sum(rating/position)/count(query_name),2) as quality, round(sum(if(rating<3,1,0))*100/count(query_name),2) as poor_query_percentage from Queries group by query_name"
37,"select query_name, round(avg(rating / position) ,2) as quality, round(avg( case when rating < 3 then 1 else 0 end ) * 100 , 2) as poor_query_percentage from Queries group by query_name"
38,"SELECT distinct query_name, round(avg(rating/position),2) as quality, round(avg(rating < 3 ) *100,2) as poor_query_percentage FROM Queries GROUP BY query_name "
39,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM queries GROUP BY query_name"
40,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(rating < 3)*100,2) AS poor_query_percentage FROM Queries GROUP BY 1 "
41,"select query_name,round(avg(new_rate),2) as quality,round(sum(rating_1)/count(query_name)*100,2) as poor_query_percentage from (select query_name,rating/position as new_rate,case when rating<3 then 1 else 0 end as rating_1 from Queries)a group by query_name"
42,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(rating)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name "
43,"select query_name, round(sum(rating/position)/count(*),2) as quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100,2) as poor_query_percentage from queries group by query_name"
44,"select query_name, round(avg(rating/position),2) quality, round(avg(rating<3)*100,2) poor_query_percentage from Queries group by query_name "
45,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
46,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(rating)*100,2) AS poor_query_percentage from Queries group by query_name "
47,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
48,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
49,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from Queries group by query_name"
50,"SELECT query_name, round(avg(rating/position), 2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(rating)*100, 2) as poor_query_percentage from Queries group by query_name"
51,"select query_name, round(avg(rating/position),2) quality, round(avg(case when rating< 3 then 1 else 0 end)*100,2) poor_query_percentage from queries group by query_name"
52,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
53,"select query_name, round(sum(rating / position) / count(*), 2) as quality, round(sum(if(rating < 3, 1, 0)) * 100 / count(*),2) as poor_query_percentage from Queries group by 1"
54,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating<3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
55,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end )*100/count(rating),2) as poor_query_percentage from queries group by query_name"
56,"select query_name, round(sum(rating/position)/count(*),2) as quality, round(sum(case when rating <3 then 1 else 0 end)/count(*) * 100,2) as poor_query_percentage from queries group by 1"
57,"select query_name, round((sum(rating/position)/count(query_name)),2) as quality, round(100*(sum(if(rating<3,1,0))/count(query_name)),2) as poor_query_percentage from Queries group by query_name "
58,"select a.query_name, a.qua as quality, round(poor*100,2) as poor_query_percentage from (select query_name, round(sum(rating/position)/count(rating),2) as qua from queries group by query_name) a join (select query_name, (sum(case when rating<3 then 1 else 0 end)/count(rating)) as poor from queries group by query_name) b on a.query_name = b.query_name "
59,"select query_name, round((sum(rating/position)/count(*)),2) as quality, ifnull(round((sum(case when rating < 3 then 1 else null end)/count(*))*100,2),0) as poor_query_percentage from Queries group by query_name"
60,"select query_name, round(sum(rating/position) /count(*),2)as quality, round(sum(case when rating<3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from queries group by 1"
61,"SELECT q1.query_name, ROUND(AVG(q1.rating/q1.position),2) AS quality, ROUND(COUNT(DISTINCT q2.result)/COUNT(DISTINCT q1.result)*100,2) AS poor_query_percentage FROM queries q1 LEFT JOIN (SELECT query_name, result FROM queries WHERE rating < 3 ) q2 ON q1.query_name = q2.query_name GROUP BY q1.query_name "
62,"select query_name , round(avg(r),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(rating)*100,2) as poor_query_percentage from( select * , rating/position as r from Queries )a group by query_name"
63,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(IF(rating < 3, 100, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY 1"
64,"select query_name, round((sum(rating/position)/count(*)), 2) quality, round(count(case when rating < 3 then rating end)/count(*)*100 ,2) poor_query_percentage from queries group by query_name "
65,"select query_name, round(avg(rating/position), 2) as quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage from Queries group by query_name "
66,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
67,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name "
68,"select t1.query_name, round(t1.quality_sum/t2.cnt,2) as quality, round((t1.poor_query/t2.cnt)*100,2) as poor_query_percentage from ( (select query_name, sum(ratio) as quality_sum, sum(poor) as poor_query from ( select query_name, rating/position as ratio, case when rating<3 then 1 else 0 end as poor from Queries ) as a group by query_name) as t1 left join (select query_name,count(*) as cnt from Queries group by query_name) as t2 on t1.query_name = t2.query_name ) "
69,"select query_name, round(avg(rating / position), 2) as quality, round((sum(if(rating < 3, 1, 0)) / count(1))* 100, 2) as poor_query_percentage from queries group by 1"
70,"select query_name, round(avg(rating/position),2) as quality, round(avg(case when rating < 3 Then 1 Else 0 End)*100,2) as poor_query_percentage From queries group by query_name "
71,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
72,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100*SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(rating),2) AS poor_query_percentage FROM Queries GROUP BY query_name "
73,"SELECT query_name, ROUND(SUM(rating/position) / COUNT(position),2) AS quality, ROUND(100*SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(rating),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
74,"Select query_name, round(sum(rating/position)/count(*),2) as quality, round(avg(case when rating<3 then 1 else 0 end)*100,2) as poor_query_percentage from queries group by query_name"
75,"select query_name, round(avg(rating/position),2) as quality, round((sum(rating < 3)/count(rating))*100,2) as poor_query_percentage from queries group by query_name"
76,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
77,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
78,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(100 * SUM(IF(rating < 3, 1, 0)) / COUNT(query_name), 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
79,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from queries group by query_name"
80,"select query_name, round(sum(rating/position)/count(query_name),2) as quality, coalesce(round(sum(case when rating < 3 then 1 end)/count(query_name)*100,2),0.00000) as poor_query_percentage from Queries group by query_name "
81,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from queries group by 1"
82,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
83,"SELECT DISTINCT query_name, quality, ROUND(num_good_results*100/num_query_results,2) AS poor_query_percentage FROM (SELECT *, ROUND(AVG(rating/position) OVER (PARTITION BY query_name),2) AS quality, COUNT(result) OVER (PARTITION BY query_name) AS num_query_results, COUNT(CASE WHEN rating < 3 THEN 1 END) OVER (PARTITION BY query_name) AS num_good_results FROM Queries) query_results_table "
84,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(100*AVG(rating < 3),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
85,"select query_name, round( avg(rating/position), 2) as quality, round( avg(rating<3)*100,2) as poor_query_percentage from queries group by query_name"
86,"select query_name,round(avg(rating/position),2) as quality, round(100*avg(if(rating > 2,0,1)),2) as poor_query_percentage from queries group by query_name"
87,"select query_name, round(avg(rating / position), 2) as quality, round(100 * sum(case when rating < 3 then 1 else 0 end) / count(*), 2) as poor_query_percentage from queries group by 1 "
88,"SELECT query_name, IFNULL(ROUND(AVG(rating/position),2),0.00) as quality, IFNULL(ROUND(AVG(rating<3)*100,2),0.00) AS poor_query_percentage FROM Queries GROUP BY query_name "
89,"WITH t1 AS (SELECT query_name, ROUND(AVG(rating / position),2) AS quality, ROUND(AVG(rating < 3)*100,2) AS poor_query_percentage FROM Queries GROUP BY 1) SELECT * FROM t1 "
90,"SELECT query_name, ROUND(AVG((rating/position)),2) as quality, ROUND(AVG(case when rating<3 then 1 ELSE 0 END)*100,2) as poor_query_percentage from Queries GROUP by query_name"
91,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
92,"select query_name, round(avg(rating/position),2) as quality, round(avg(if(rating <3,1,0))*100,2) as poor_query_percentage from queries group by query_name"
93,"select query_name, round(avg(rating / position), 2) as quality, round((sum(if(rating < 3, 1, 0)) / count(1))* 100, 2) as poor_query_percentage from queries group by 1"
94,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
95,"SELECT query_name , ROUND(AVG(rating*100 / position), 0)/100 AS quality , ROUND(AVG(case when rating < 3 then 1 else 0 end )*100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
96,"select query_name, round(avg(rating/position),2) as quality, round((sum(case when rating<3 then 1 else 0 end)/count(1))*100,2) as poor_query_percentage from Queries group by query_name "
97,"Select query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
98,"select query_name, round(avg(rating / position), 2) as quality, round((sum(if(rating < 3, 1, 0)) / count(1))* 100, 2) as poor_query_percentage from queries group by 1"
99,"select query_name, round(avg(rating/position),2) as 'quality', round(sum(case when rating < 3 then 1 else 0 end) * 100/count(*),2) as 'poor_query_percentage' from queries group by query_name"
100,"select distinct(Q.query_name), round(AVG(Q.quality),2) quality, round((sum(Q.quality_index)/count(*))*100,2) poor_query_percentage from (select query_name,rating,rating/position as quality, if(rating <3,1,0) as quality_index from Queries) Q group by query_name"
101,"Select query_name, round(avg(rating/position), 2) as quality, round(100*sum(case when rating < 3 Then 1 Else 0 End)/count(*), 2) as poor_query_percentage From Queries Group by query_name"
102,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by query_name"
103,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(position),2) as poor_query_percentage from Queries group by query_name"
104,"select query_name , round(avg(rating/position),2) as quality , round(sum(rating < 3) /count(*)*100,2) as poor_query_percentage from Queries group by query_name"
105,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating<3)*100,2) as poor_query_percentage from Queries group by query_name "
106,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND((COUNT(CASE WHEN rating < 3 THEN 1 ELSE null END)/COUNT(*))*100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
107,"with cte as ( select query_name,result,position,rating, case when rating<3 then 1 else 0 end as status from queries ) select query_name,round(sum(rating/position)/count(*),2) as quality, round((sum(status)/count(*))*100,2) as poor_query_percentage from cte group by query_name "
108,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating<3)*100,2) as poor_query_percentage from Queries group by 1"
109,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
110,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality,ROUND((SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(query_name))*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
111,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
112,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
113,"select query_name, round(avg(rating/position), 2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(*), 2) as poor_query_percentage from queries group by 1"
114,"SELECT query_name, ROUND(SUM(quality)/COUNT(*), 2) quality, ROUND((SUM(poor)/COUNT(*)*100), 2) poor_query_percentage FROM (SELECT *, rating/position quality, CASE WHEN rating < 3 THEN 1 ELSE 0 END poor FROM queries) t1 GROUP BY query_name "
115,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name "
116,"SELECT query_name, ROUND((SUM(rating/position))/count(query_name) , 2) as quality, ROUND((SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)*100)/count(query_name),2) as poor_query_percentage FROM queries group by query_name order by query_name "
117,"SELECT DISTINCT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(query_name)*100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
118,"SELECT query_name, ROUND(SUM(rating / position) / COUNT(position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(rating)*100,2 ) AS poor_query_percentage FROM Queries GROUP BY query_name"
119,"Select x.query_name,round(sum(x.rating/x.position)/count(x.rating),2) as quality, round(sum(x.flag)/count(x.rating)*100,2) as poor_query_percentage from (Select query_name,position,rating, case when rating<3 THEN 1 else 0 end as flag from queries) as x group by 1"
120,"select query_name, round(avg(rating/position), 2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(*) * 100, 2) as poor_query_percentage from queries group by 1 "
121,"SELECT query_name, round(AVG(rating/position),2) as quality, round(sum(If(rating<3,100,0))/count(*),2) as poor_query_percentage FROM Queries GROUP BY 1 "
122,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(rating < 3) / COUNT(*) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
123,"SELECT query_name, ROUND((SUM(rating / position) / COUNT(query_name)), 2) AS quality, ROUND((COUNT(CASE WHEN rating < 3 THEN 1 END) / COUNT(query_name) * 100), 2) AS poor_query_percentage FROM queries GROUP BY query_name"
124,"select query_name, round(avg(rating/position),2) as quality, round(sum(if(rating<3, 100, 0))/count(rating),2) as poor_query_percentage from queries group by 1"
125,"SELECT query_name, ROUND(SUM(rating/position)/COUNT(*),2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
126,"select query_name, cast(sum(rating/position)/count(query_name) as decimal(32,2)) quality, cast(sum(case when rating<3 then 1 else 0 end)/count(query_name)*100 as decimal(32,2)) poor_query_percentage from Queries group by query_name"
127,"select query_name, round(avg(rating/position), 2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100 / count(position), 2) poor_query_percentage from queries group by query_name "
128,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100 * SUM(IF(rating<3, 1, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name ORDER BY query_name"
129,"select query_name, round(avg(rating/position), 2) as quality, round(100*sum(case when rating < 3 then 1 else 0 end) / count(rating), 2) as poor_query_percentage from Queries group by 1"
130,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM Queries GROUP BY QUERY_NAME"
131,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name "
132,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
133,"select query_name, round(avg(rating/position), 2) as quality, round(avg(rating < 3) * 100, 2) as poor_query_percentage from queries group by query_name "
134,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name "
135,"SELECT query_name ,ROUND(AVG(rating/position),2) AS quality ,ROUND(SUM(IF(rating < 3,1,0)) * 100 / COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
136,"select query_name, round(avg(rating/position),2) as quality, round(100*count(case when rating < 3 then 1 end) / count(query_name), 2) as poor_query_percentage from Queries group by query_name "
137,"select query_name , round(sum(rating/position)/count(*),2) as quality , coalesce(round((sum(case when rating<3 then 1 else 0 end)*100/count(*)),2),0) as poor_query_percentage from Queries group by 1"
138,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100 * SUM(IF(rating<3, 1, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name ORDER BY query_name"
139,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG( CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME "
140,"select query_name , round(avg(rating/position),2) as quality , round((avg(case when rating<3 then 1 else 0 end))*100,2) poor_query_percentage from Queries group by query_name"
141,"select query_name, round(sum(rating/position)/count(distinct result),2) as quality, round((count(case when rating<3 then rating else null end)/count(distinct result))*100,2) as poor_query_percentage from Queries group by query_name order by query_name"
142,"Select query_name , cast(sum((rating*1.0) / (position*1.0)) / count(*) as decimal (32,2)) quality , Cast((Sum(case When rating < 3 then 1 else 0 end)*100.00) / count(rating) as decimal (32,2)) as poor_query_percentage From Queries Group by Query_name"
143,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
144,"SELECT query_name, ROUND(AVG(rating / position), 2) quality, ROUND(100 * AVG(rating < 3), 2) as poor_query_percentage FROM Queries GROUP BY query_name"
145,"select query_name, round( avg(rating/position), 2) as quality, round( sum(rating<3)/count(rating)*100,2) as poor_query_percentage from queries group by query_name"
146,"select query_name, round(avg(rating / position*1.0), 2) as quality, round( sum(case when rating < 3 then 1 else 0 end) * 100.0 / count(*) , 2) as poor_query_percentage from queries group by query_name"
147,"SELECT query_name, ROUND(AVG(rating * 100 / POSITION)) / 100 AS quality, ROUND(SUM(rating < 3) * 100 / COUNT(*), 2) AS poor_query_percentage FROM Queries GROUP BY query_name ORDER BY NULL"
148,"select query_name, round(avg(rating/position),2) as quality, round(count(if(rating<3,result,null))/count(result)*100,2) as poor_query_percentage from queries group by query_name"
149,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from Queries group by query_name"
150,"select query_name, round(avg(rating/position),2) as quality, round(sum(if(rating<3,1,0))/count(query_name)*100,2) as poor_query_percentage from queries group by query_name "
151,"select query_name, round(avg(rating/position),2) as quality, round(100*avg(rating < 3),2) as poor_query_percentage from Queries group by query_name "
152,"select query_name, round(avg(rating/position), 2) as quality, round(avg(rating < 3) * 100, 2) as poor_query_percentage from Queries group by query_name"
153,"select query_name, round(avg(rating/position),2) quality, round(100*sum(rating<3)/count(rating),2) poor_query_percentage from Queries group by 1"
154,"select query_name,round(avg(rating/position),2)as quality,round(sum(case when rating <3 then 1 else 0 end)*100/count(query_name),2) as poor_query_percentage from queries group by 1"
155,"select query_name, round(avg(rating / position) ,2) as quality, round(avg( case when rating < 3 then 1 else 0 end ) * 100 , 2) as poor_query_percentage from Queries group by query_name"
156,"Select query_name, round((sum(rating/position))/count(query_name),2) as quality, round(((sum(if(rating<3,1,0)))/count(query_name))*100,2) as poor_query_percentage from queries group by query_name"
157,"select query_name, round(sum(qual)/count(1),2) quality, round(sum(poor)/count(1)*100,2) poor_query_percentage from ( select query_name, (rating / position ) qual, case when rating<3 then 1 else 0 end poor from Queries) as base group by query_name "
158,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100 * SUM(IF(rating<3, 1, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name ORDER BY query_name"
159,"SELECT query_name , ROUND(AVG(rating*100 / position), 0)/100 AS quality , ROUND(AVG(case when rating < 3 then 1 else 0 end )*100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
160,"select query_name, round(avg(rating / position), 2) as quality, round(100 * sum(rating < 3) / count(*), 2) as poor_query_percentage from Queries group by query_name"
161,"select query_name,round(avg(rating/position),2) as quality,round(avg(rating<3)*100,2)as poor_query_percentage from queries group by query_name"
162,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
163,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(query_name) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
164,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(100 * SUM(rating < 3) / COUNT(result), 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
165,"select query_name, round(avg(rating/position),2) quality, round((avg(case when rating<3 then 1 else 0 end))*100,2) poor_query_percentage from Queries group by query_name"
166,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY 1"
167,"SELECT query_name,ROUND(avg(rating/position),2)AS quality, round(sum(if(rating<3,1,0))/count(1)*100,2)AS poor_query_percentage FROM Queries GROUP BY 1 "
168,"select query_name, round(avg(rating / position),2) quality, round((avg(case when rating<3 then 1 else 0 end))*100,2) poor_query_percentage from Queries group by query_name"
169,"select query_name, round(avg(rating/position), 2) as quality, round((avg(case when rating < 3 then 1 else 0 end))*100, 2) as poor_query_percentage from queries group by 1 "
170,"select query_name, round(avg(rating / position), 2) as quality, round(100 * avg(rating < 3),2) as poor_query_percentage from Queries group by 1 "
171,"select query_name, ROUND( avg(rating / position), 2) AS quality, round(sum(case when rating <3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from Queries group by query_name"
172,"select query_name, round(avg(rating/position),2) as quality, round(avg(case when rating < 3 then 1 else 0 end)*100,2) as poor_query_percentage from queries group by query_name"
173,"SELECT query_name, ROUND(AVG(rating / position), 2) AS 'quality', ROUND(AVG(rating < 3) * 100, 2) AS 'poor_query_percentage' FROM Queries GROUP BY query_name "
174,"SELECT query_name, ROUND(avg(rating/position),2) as quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100/COUNT(rating),2) as poor_query_percentage FROM queries GROUP BY 1"
175,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100*SUM(IF(rating < 3, 1, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY 1"
176,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(AVG(IF(rating < 3, 1, 0)) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
177,"select query_name, round(coalesce(avg(rating/position), 0),2) quality, round(coalesce(sum(case when rating < 3 then 1 else 0 end)/count(rating),0)*100, 2) as poor_query_percentage from queries group by 1 "
178,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
179,"select query_name, round(avg(rating/position),2) as quality, round(sum(if(rating<3,1,0))/count(query_name)*100,2) as poor_query_percentage from queries group by 1"
180,"select query_name, round(avg(rating/position), 2) as quality, round((sum(case when rating < 3 then 1 else 0 end)/count(query_name))* 100, 2)poor_query_percentage from Queries group by query_name"
181,"SELECT query_name, round(avg(rating/position),2) as quality, round(avg(CASE WHEN rating<3 THEN 1 ELSE 0 END)*100,2) as poor_query_percentage FROM Queries GROUP BY query_name"
182,"select query_name, round(avg(rating/position),2) quality, round((sum(if(rating<3,1,0))/count(query_name))*100,2) poor_query_percentage from queries group by query_name"
183,"select query_name, round(avg(rating / position), 2) as quality, round(avg(rating < 3) * 100, 2) as poor_query_percentage from queries group by query_name"
184,"with cte_quality as ( select query_name, round( avg(rating / position), 2 ) as quality, round( 100 * avg(rating < 3), 2 ) as poor_query_percentage from Queries group by 1 ) select * from cte_quality"
185,"select query_name, round((avg(rating/position)),2) as quality, round(100*sum(case when rating < 3 then 1 else 0 end)/count(*), 2) as poor_query_percentage from queries group by query_name"
186,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
187,"SELECT query_name, ROUND(SUM(rating / position) / COUNT(*), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(*) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
188,"select query_name, round(avg(rating/position), 2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(rating) * 100,2) as poor_query_percentage from Queries group by query_name"
189,"Select query_name, round(avg(rating/position),2) as quality, round((count(case when rating < 3 then 1 else NUll end)/count(*))*100,2) as poor_query_percentage from queries group by 1"
190,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(IF(rating < 3, 100, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY 1 "
191,"select query_name, round(avg(rating/position), 2) as quality, round(100*avg(rating<3),2) as poor_query_percentage from Queries group by query_name"
192,"SELECT query_name, ROUND(AVG(rating / position),2) AS quality, ROUND( SUM(CASE WHEN rating<3 THEN 100 ELSE 0 END) / COUNT(*) ,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
193,"select query_name, round(sum(rating/position) /count(query_name),2) as quality, round(100*sum(case when rating < 3 then 1 else 0 end)/count(query_name),2) as poor_query_percentage from Queries group by query_name"
194,"SELECT query_name ,ROUND(AVG(rating/position),2) AS quality ,ROUND(SUM(IF(rating<3,1,0))*100/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
195,"Select query_name, round(AVG(rating/position),2) as quality, ROUND(SUM( CASE WHEN rating <3 then 1 else 0 end)*100/count(query_name),2) as poor_query_percentage FROM Queries Group by query_name "
196,"WITH query_quality AS (SELECT query_name, ROUND(SUM(rating / position) / COUNT(*),2) AS quality FROM Queries GROUP BY 1), query_poor_percet AS (SELECT query_name, ROUND(100 * SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(*),2) as poor_query_percentage FROM Queries GROUP BY 1) SELECT t1.*, t2.poor_query_percentage FROM query_quality t1 INNER JOIN query_poor_percet t2 ON t1.query_name = t2.query_name"
197,"select query_name , round(avg(rating/position), 2) as quality , round(count(case when rating < 3 then result else null end)/count(result)*100 , 2) as poor_query_percentage from Queries group by 1"
198,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(rating),2) as poor_query_percentage from queries group by query_name"
199,"with cte as ( select query_name, rating/position as ratio, rating, position from queries ) select query_name, Round(avg(ratio),2) as quality, Round((sum(case when rating < 3 then 1 else 0 end) / count(*)) * 100,2) as poor_query_percentage from cte group by query_name "
200,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(COUNT(CASE WHEN rating < 3 THEN rating ELSE NULL END) / COUNT(1) * 100, 2) AS poor_query_percentage FROM queries GROUP BY 1"
201,"select query_name, round(avg(rp),2) as quality, round(sum(rating_lt_3)/count(rating)*100,2) as poor_query_percentage from (select query_name, rating/position as rp, case when rating < 3 then 1 else 0 end as rating_lt_3, rating from Queries) sub group by query_name "
202,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating < 3)*100,2) as poor_query_percentage from queries group by 1"
203,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(IF(rating<3,1,0))/COUNT(rating)*100,2) AS poor_query_percentage FROM queries GROUP BY query_name"
204,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(IF(rating < 3, 1, 0)) / COUNT(*) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
205,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(*) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
206,"Select query_name, round(avg((rating/position)),2) quality , round(avg(case when rating < 3 then 1 else 0 end)*100,2) poor_query_percentage from Queries group by 1"
207,"select query_name, ROUND(AVG(rating/position), 2) as quality, ROUND(SUM(rating < 3) * 100 / count(*), 2) as poor_query_percentage from Queries group by query_name "
208,"select query_name, round(avg(rating / position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end) / count(*) * 100, 2) as poor_query_percentage from queries group by query_name "
209,"SELECT query_name, ROUND(AVG(rating / position),2) as quality, round((sum( case when rating < 3 then 1 else 0 end) / count(*) ) * 100, 2) as poor_query_percentage from queries group by query_name"
210,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM((CASE WHEN rating < 3 THEN 1 ELSE 0 END))/COUNT(*) * 100,2) AS poor_query_percentage FROM Queries GROUP BY query_name "
211,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
212,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
213,"select query_name, round(avg(rating/position),2) quality, round((avg(case when rating<3 then 1 else 0 end))*100,2) poor_query_percentage from Queries group by query_name"
214,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
215,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(AVG(IF(rating < 3, 1, 0)) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
216,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(rating)*100,2) as poor_query_percentage from queries group by query_name"
217,"select query_name, round(avg(rating/position),2) as quality, round(avg(case when rating <3 then 1 else 0 end)*100, 2) as poor_query_percentage from queries group by query_name"
218,"select query_name , round(sum(rating/position)/count(*),2) as quality , round(avg(rating<3)*100,2) as poor_query_percentage from Queries group by query_name "
219,"select query_name, round(avg(q.rating/position),2) as 'quality', round((sum(rating < 3) / count(query_name)) * 100,2) as 'poor_query_percentage' from Queries q group by query_name "
220,"select query_name, round(avg(rating/ position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/ count(1)) * 100 , 2) poor_query_percentage from Queries group by query_name"
221,"select query_name , round(avg((rating/position)),2) as quality , round(count(case when rating < 3 then result end)/count(distinct result)*100,2) as poor_query_percentage from queries group by 1 "
222,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from queries group by 1"
223,"select query_name, round(sum(rating*1.0/position)/count(1),2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(1),2) as poor_query_percentage from Queries group by query_name"
224,"Select x.query_name,round(avg(x.rating/x.position),2) as quality,round(sum(x.flag)/count(*)*100,2) as poor_query_percentage from (Select query_name,position,rating, case when rating<3 THEN 1 else 0 END as flag from queries) as x group by 1 "
225,"with x as ( select query_name, round(sum(rating/position)/count(*),2) as quality from queries group by 1 ), y as ( select q.query_name, round((count(rating)/(select count(*) from queries where q.query_name = query_name group by query_name))*100,2) as poor_query_percentage from queries as q where rating < 3 group by 1 ) select x.query_name,x.quality, case when y.poor_query_percentage is null then 0 else y.poor_query_percentage end as poor_query_percentage from x left join y on x.query_name = y.query_name"
226,"select query_name , round(sum(rating/position)/count(result),2) as quality, round(sum(if(rating<3,1,0))/count(result)*100,2) as poor_query_percentage from Queries group by query_name "
227,"SELECT query_name, ROUND(AVG(rating/position),2) As quality , ROUND(COUNT(CASE WHEN rating < 3 THEN 1 END)/COUNT(*)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name  "
228,"select query_name, round(avg(rating/position),2) as quality, round( avg(case when rating < 3 then 1 else 0 end)* 100,2) as poor_query_percentage from queries group by query_name"
229,"select query_name, round(sum(rating/position)/count(query_name), 2) as quality, round(100*sum(if(rating < 3, 1, 0))/count(query_name), 2) as poor_query_percentage from Queries group by query_name"
230,"SELECT query_name, round(AVG(rating/position),2) as quality, round(sum(If(rating<3,100,0))/count(*),2) as poor_query_percentage FROM Queries GROUP BY 1 "
231,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/ count(*),2) as poor_query_percentage from Queries group by 1"
232,"SELECT query_name, ROUND(AVG(rating / position), 2) as quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END ) / COUNT(*) * 100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
233,"SELECT query_name , ROUND(AVG(rating*100 / position), 0)/100 AS quality , ROUND(AVG(case when rating < 3 then 1 else 0 end )*100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
234,"with cte as ( select * , round(AVG(rating/position) over (partition by query_name),2) as quality, count(result) over (partition by query_name) as total, count(case when rating<3 then 1 end) over (partition by query_name) as good from Queries ) select distinct query_name, quality, round(good*100/total,2) as poor_query_percentage from cte"
235,"select query_name, round(sum(rating/position)/count(query_name),2) as quality, ROUND((avg(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100),2) as poor_query_percentage FROM Queries GROUP BY query_name"
236,"SELECT query_name, cast(sum((rating* 1.0)/(position*1.0))/count(*) as decimal(32,2)) quality, cast((sum(case when rating < 3 then 1 else 0 end )* 100.00)/count(rating) as decimal(32,2)) as poor_query_percentage From Queries Group by query_name "
237,"select query_name, round(avg(rating / position ), 2) as quality, round(100 * sum(case when rating < 3 then 1 else 0 end) / count(1), 2) poor_query_percentage from Queries group by query_name"
238,"select queries.query_name, round(avg(rating/position),2) as quality, ifnull(round((sum(if(rating<3,1,0)*100))/count(*),2),0) as poor_query_percentage from queries group by query_name "
239,"select query_name, round(avg(rating/position), 2) as quality, round(100 * sum(case when rating < 3 then 1 else 0 end)/count(*), 2) as poor_query_percentage from Queries group by 1"
240,"SELECT query_name, round(AVG(rating/position),2) as quality, round(AVG(case when rating < 3 then 1 else 0 end)*100, 2) as poor_query_percentage FROM Queries GROUP BY 1"
241,"SELECT query_name, round(sum(rating/position)/count(*),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(*)*100, 2) as poor_query_percentage FROM Queries GROUP BY 1"
242,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by 1 "
243,"select query_name, round(avg(rating*1.00/position),2) as quality, round(avg(rating <3)*100,2) as poor_query_percentage from Queries group by 1"
244,"SELECT query_name, ROUND(SUM(rating / position) / COUNT(*), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) * 100 / COUNT(*), 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
245,"SELECT query_name ,round(sum((rating/position))/count(query_name),2) as quality , ROUND(avg(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2)as poor_query_percentage FROM Queries GROUP BY query_name"
246,"with tmp as (select query_name, round(ifnull(avg(rating/position), 0.00), 2) as quality from Queries group by query_name), tb1 as( select query_name, count(rating) as numer1 from Queries where rating < 3 group by query_name), tb2 as ( select query_name, count(rating) as denom from Queries group by query_name), tb3 as( select query_name, 0 as numer2 from Queries where rating >= 3 group by query_name), tb4 as ( select query_name, numer1 as numer3 from tb1 union all select query_name, numer2 from tb3), tb5 as ( select query_name, sum(numer3) as numer from tb4 group by query_name) select tmp.query_name, quality, round(ifnull(numer / denom * 100, 0.00), 2) as poor_query_percentage from tmp left join tb5 on tb5.query_name = tmp.query_name left join tb2 on tmp.query_name = tb2.query_name "
247,"select query_name, round(avg(qua), 2) as quality, round(avg(poor_query)*100, 2) as 'poor_query_percentage' from (select query_name, rating, rating/position as 'qua' ,if(rating>=3, 0 ,1) as 'poor_query' from Queries) temp group by query_name "
248,"WITH q AS( SELECT query_name, ROUND(IFNULL(SUM(rating/position)/COUNT(*), 0), 2) 'quality', COUNT(*) 'n_queries' FROM queries GROUP BY query_name ), p AS( SELECT query_name, COUNT(*) 'poor_queries' FROM queries WHERE rating < 3 GROUP BY query_name ) SELECT n.query_name, quality, ROUND(IFNULL(poor_queries/n_queries*100, 0), 2) 'poor_query_percentage' FROM (SELECT DISTINCT query_name FROM queries) n LEFT JOIN p USING(query_name) LEFT JOIN q USING(query_name)  "
249,"SELECT query_name, ROUND(SUM(rating/position)/COUNT(query_name),2) AS quality, ROUND(SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(query_name)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
250,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
251,"select query_name, round(avg(rating/position) ,2) as quality, round(100 * sum(if(rating<3,1,0))/count(*), 2) as poor_query_percentage from queries group by query_name"
252,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM Queries GROUP BY QUERY_NAME"
253,"select query_name, round(avg(rating/position),2) as quality, round(count(case when rating < 3 then 1 end)/ count(*) * 100,2) as poor_query_percentage from queries group by query_name"
254,"select query_name, round(avg(rating/position), 2) as quality, round(avg(rating < 3)*100, 2) as poor_query_percentage from queries group by 1"
255,"select query_name,round(1.0*avg(rating/position), 2) as quality, round(100.0*sum(case when rating <3 then 1 else 0 end)/count(1),2) as poor_query_percentage from queries group by query_name"
256,"select query_name, round(avg(rating / position), 2) as quality, round((sum(case when rating < 3 then 1 else 0 end) / count(*))*100, 2) as poor_query_percentage from Queries group by 1"
257,"select query_name, round(avg(rating / position), 2) as quality, round(avg(rating < 3) * 100, 2) as poor_query_percentage from Queries group by query_name "
258,"SELECT q.query_name, ROUND(AVG(q.rating/q.position),2) AS quality, ROUND(AVG(CASE WHEN q.rating<3 then 1 else 0 end)*100,2) AS poor_query_percentage FROM queries q GROUP BY q.query_name"
259,"select query_name, round(avg(rating/position),2) as quality, round((sum(rating <3)/count(*)) * 100,2) as poor_query_percentage from queries group by query_name"
260,"select query_name, Round(AVG(rating/position), 2) as quality, Round(AVG(rating < 3)*100, 2) as poor_query_percentage from Queries Group By query_name"
261,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 100 ELSE 0 END), 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
262,"select query_name, round(avg(rating / position), 2) as quality, round(avg(rating < 3) * 100, 2) as poor_query_percentage from queries group by query_name"
263,"select query_name, round(sum(rating/position)/count(*),2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from Queries group by 1"
264,"SELECT query_name, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS quality, ROUND(SUM(RATING<3)/COUNT(*) * 100,2) AS poor_query_percentage FROM QUERIES GROUP BY query_name"
265,"select query_name, round(avg(rating / position), 2) as quality, round(sum(rating < 3) / count(*) * 100, 2) as poor_query_percentage from queries group by query_name"
266,"Select query_name, round(avg(rating/position),2) as 'quality', round(SUM(CASE when rating < 3 then 1 else 0 end)/count(*)*100,2) as 'poor_query_percentage' from Queries group by query_name "
267,"select query_name, round(avg(rating/position),2) AS quality, round((avg(case when rating < 3 then 1 else 0 END))*100, 2) poor_query_percentage from Queries group by query_name"
268,"Select query_name as query_name, Round(sum(rating/position)/count(*),2) as quality, Round(sum(Case When rating < 3 Then 1 Else 0 End)/count(*)*100,2) as poor_query_percentage From Queries Group By query_name"
269,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
270,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from queries group by 1"
271,"WITH t1 AS (SELECT DISTINCT query_name, result, position, rating FROM Queries) SELECT h1 AS ""query_name"", ROUND(AVG(s1/s4),2) as quality, ROUND(COUNT(s2)/COUNT(s1)*100,2) as poor_query_percentage FROM( SELECT t1.query_name as h1,q.query_name as h2,t1.rating as s1,q.rating as s2,t1.position as s4 FROM t1 LEFT JOIN (SELECT * FROM t1 WHERE rating<3 ) as q ON t1.query_name=q.query_name AND q.rating=t1.rating AND t1.result=q.result) as gamma GROUP BY h1 "
272,"SELECT query_name, ROUND(SUM(rating/position)/COUNT(*), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(*)*100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
273,"select query_name, round(avg(rating/position),2) as quality, round(sum(rating < 3)/count(*)*100,2) as poor_query_percentage from Queries group by query_name "
274,"Select q2.query_name,round(SUM(q1.rating/q1.position)/ count(q1.query_name),2) as quality, round((SUM(CASE WHEN q2.rating<3 THEN 1 ELSE 0 END)/count(q2.query_name))*100,2) as poor_query_percentage FROM QUERIES q1 Inner Join Queries q2 Using (query_name) GROUP BY q2.query_name "
275,"select query_name, round(avg(rating/position), 2) as quality, round(100*sum(case when rating < 3 then 1 else 0 end)/count(*), 2) as poor_query_percentage from queries group by 1"
276,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/ count(rating) * 100,2) as poor_query_percentage from queries group by query_name "
277,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating<3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
278,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating < 3)*100,2) as poor_query_percentage from queries group by 1"
279,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating <3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from Queries group by 1 order by 1 desc"
280,"select query_name, round(avg(rating / position), 2) as quality, round(100*sum(if(rating < 3, 1, 0)) / count(rating), 2) as poor_query_percentage from queries group by query_name"
281,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
282,"select query_name, round(avg(rating/position), 2) quality, round((sum(case when rating < 3 then 1 else 0 end)/count(*))*100, 2) poor_query_percentage from queries q group by query_name"
283,"Select query_name, round(avg(rating/position),2) as quality, round((sum(if(rating<3,1,0))/count(*))*100,2) poor_query_percentage from Queries group by query_name"
284,"SELECT query_name, CAST( AVG(rating*1.0/position) AS DECIMAL(10,2) ) AS quality, CAST( AVG(CASE WHEN rating < 3 THEN 100.0 ELSE 0 END) AS DECIMAL(10,2) ) AS poor_query_percentage FROM Queries GROUP BY query_name"
285,"Select query_name, round(avg(rating/position),2) as quality, round(avg(case when rating<3 then 1 else 0 end)*100,2) as poor_query_percentage From Queries Group by query_name"
286,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
287,"select query_name, round(avg(qualityrate),2)as quality, round(avg(rate)*100,2) as poor_query_percentage from( select query_name, result, position, rating, (rating/position) as qualityrate, (case when rating<3 then 1 else 0 end) as rate from Queries ) tem group by query_name "
288,"SELECT q.query_name, ROUND(AVG(q.rating / q.position), 2) AS 'quality', ROUND(SUM(IF(q.rating < 3, 1, 0)) / COUNT(q.rating) * 100, 2) AS 'poor_query_percentage' FROM Queries q GROUP BY q.query_name "
289,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(IF(rating < 3, 100, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
290,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from Queries group by query_name"
291,"Select query_name, IFNULL(ROUND(AVG(rating/position),2),0) As quality, IFNULL(ROUND((Sum(Case when rating <3 then 1 else 0 end) / Count(*)) *100,2),0) As poor_query_percentage From (Select Distinct query_name,result,position,rating from Queries) Q Group By query_name "
292,"Select query_name, Round(Avg(rating/position), 2) as quality, Round(Avg(rating < 3) * 100, 2) as poor_query_percentage From Queries Group By query_name"
293,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(IF(rating < 3, 100, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY 1"
294,"SELECT query_name, round(avg(rating/position), 2) as quality, round(SUM(rating<3)/COUNT(*)*100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
295,"select query_name, round(avg(rating/position),2) as quality, round(sum(rating < 3) * 100 / COUNT(*),2) as poor_query_percentage from queries group by query_name"
296,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100*SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name "
297,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(100 * SUM(IF(rating<3, 1, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name ORDER BY query_name"
298,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name  "
299,"select query_name, round(sum(rating/position)/count(query_name),2) as quality, round(100 * avg(rating < 3), 2) as poor_query_percentage from Queries group by query_name "
300,"SELECT query_name ,ROUND(AVG(rating / position), 2) AS quality ,ROUND(AVG(rating < 3)* 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
301,"select query_name, round(avg(rating/position),2) as quality, round(sum(rating < 3)/count(*)*100,2) as poor_query_percentage from queries group by query_name"
302,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
303,"with quality as ( select distinct query_name, round(avg(rating/position) over (partition by query_name),2) as quality from queries) select a.query_name, quality, round((sum(a.poor_query)/count(a.query_name))*100,2) as poor_query_percentage from ( select query_name, case when rating<3 then 1 else 0 end as poor_query from queries ) a left join quality on quality.query_name=a.query_name group by a.query_name, quality"
304,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND((SUM(IF(rating<3,1,0))/COUNT(rating))*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
305,"select query_name,round(sum(rating/position)/count(position),2) as quality, round((sum(case when rating<3 then 1 else 0 end)/count(rating))*100,2) as poor_query_percentage from Queries group by 1"
306,"SELECT q.query_name, ROUND(AVG(q.rating / q.position), 2) AS 'quality', ROUND((SELECT COUNT(q1.rating) FROM Queries q1 WHERE q1.rating < 3 AND q1.query_name = q.query_name) / (SELECT COUNT(*) FROM Queries q2 WHERE q2.query_name = q.query_name) * 100, 2) AS 'poor_query_percentage' FROM Queries q GROUP BY q.query_name "
307,"select distinct(query_name), round(avg(rating/position),2) as quality, round(100*sum(if(rating<3,1,0))/count(rating),2) as poor_query_percentage from queries group by query_name "
308,"SELECT t1.query_name , ROUND(AVG(t1.rating/t1.position), 2) as quality, ROUND((COUNT(CASE WHEN t1.rating < 3 THEN 1 END)/ COUNT(*))*100, 2) as poor_query_percentage from (SELECT DISTINCT * from Queries) t1 group by t1.query_name"
309,"SELECT query_name , ROUND(AVG(rating*100 / position), 0)/100 AS quality , ROUND(AVG(case when rating < 3 then 1 else 0 end )*100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
310,"select query_name,round(avg(rating/position),2) as quality,round(avg(rating<3)*100,2) as poor_query_percentage from Queries group by query_name"
311,"SELECT query_name , ROUND(AVG(rating*100 / position), 0)/100 AS quality , ROUND(AVG(case when rating < 3 then 1 else 0 end )*100, 2) as poor_query_percentage FROM Queries GROUP BY query_name"
312,"SELECT query_name, round(AVG(rating/position), 2) AS quality, round(COUNT(CASE WHEN rating < 3 THEN query_name END)/COUNT(query_name)*100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
313,"SELECT query_name, ROUND(SUM(rating/position)/COUNT(*), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(*) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY 1"
314,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(((SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END))/ COUNT(*)) *100,2) AS poor_query_percentage FROM queries GROUP BY query_name"
315,"SELECT query_name, ROUND(avg(rating/position),2) AS quality, ROUND(100*AVG(rating < 3),2) AS poor_query_percentage FROM Queries GROUP BY 1"
316,"select distinct query_name, round(avg(rating/position),2) as quality, round( sum(case when rating<3 then 1 else 0 end)/count(rating)*100,2) as poor_query_percentage from Queries group by query_name"
317,"select query_name, round(avg(rating/position),2) as quality, round(100*sum(case when rating<3 then 1 else 0 end)/count(*),2) as poor_query_percentage from Queries group by query_name"
318,"SELECT query_name, ROUND(AVG(rating/position),2) as quality, ROUND(100*SUM(IF(rating <3, 1, 0))/COUNT(rating),2) as poor_query_percentage FROM Queries GROUP BY query_name"
319,"WITH queries AS( SELECT query_name, rating / position AS quality, CASE WHEN rating < 3 THEN 1 ELSE 0 END AS poor_flag from Queries ) SELECT query_name, ROUND(AVG(quality), 2) AS quality, ROUND( SUM(poor_flag) / COUNT(*) * 100 , 2) AS poor_query_percentage FROM queries GROUP BY query_name"
320,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(IF(rating < 3, 100, 0))/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY 1"
321,"SELECT query_name, ROUND(SUM(rating / position) / COUNT(position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(rating)*100,2 ) AS poor_query_percentage FROM Queries GROUP BY query_name"
322,"select query_name, round(sum(rating/position)/count(*), 2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(*)*100, 2) as poor_query_percentage from Queries group by query_name "
323,"select query_name, round(sum(rating/position)/ count(query_name), 2) as quality, round(count(case when rating < 3 then 1 end)/ count(query_name)*100, 2) as poor_query_percentage from Queries group by query_name "
324,"with a as( select query_name, (count(case when rating<3 then 1 else null end)/count(rating))*100 as poor_query_percentage from queries group by query_name), b as ( select query_name, round(sum(rating/position)/count(rating),2) as quality from queries group by query_name) select b.query_name,b.quality, round(a.poor_query_percentage,2) as poor_query_percentage from a join b on b.query_name = a.query_name "
325,"select query_name, ROUND(AVG(rating / position), 2) as quality, ROUND(sum(if(rating < 3, 1, 0)) * 100 / COUNT(*), 2) as poor_query_percentage from Queries group by query_name"
326,"select a.query_name, round(avg(a.rating / a.position), 2) quality, round(100*( select count(*) from Queries b where b.query_name=a.query_name and b.rating < 3) / count(*), 2) poor_query_percentage from Queries a group by a.query_name"
327,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating < 3) * 100,2) as poor_query_percentage from Queries group by query_name order by query_name "
328,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(SUM(CASE WHEN rating <3 THEN 1 ELSE 0 END)*100/COUNT(*),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
329,"SELECT a1.query_name, round(avg(a1.temp),2) as quality, round(100*(sum(a1.q)/count(a1.q)),2) as poor_query_percentage from (SELECT query_name, rating/position as temp, case WHEN rating<3 then 1 else 0 end as q from Queries) a1 group by a1.query_name"
330,"SELECT q.query_name, ROUND(AVG(q.rating / q.position), 2) AS 'quality', ROUND((SELECT COUNT(q1.rating) FROM Queries q1 WHERE q1.rating < 3 AND q1.query_name = q.query_name) / (SELECT COUNT(*) FROM Queries q2 WHERE q2.query_name = q.query_name) * 100, 2) AS 'poor_query_percentage' FROM Queries q GROUP BY q.query_name "
331,"select query_name, round(avg(rating/position),2) as quality, round(sum(if(rating<3,1,0))/count(*) * 100 ,2) as poor_query_percentage from Queries group by 1"
332,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(rating)*100,2) as poor_query_percentage from Queries group by query_name"
333,"select query_name, round(avg(rating/position),2) quality, round(count(case when rating<3 then 1 end)/count(query_name)*100,2) poor_query_percentage from queries group by query_name"
334,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM Queries GROUP BY QUERY_NAME "
335,"Select query_name, round(sum(if(rating < 3,1,0)) * 100 / count(rating),2) as poor_query_percentage, round(sum(rating/position)/count(rating),2) as quality from Queries group by query_name"
336,"select query_name, round(sum(rating/position)/count(*),2) as quality, round(count(case when rating<3 then rating end)/count(*)*100,2) as poor_query_percentage from Queries group by query_name"
337,"select query_name, round(avg(rating/position), 2) as quality, round((avg(rating<3)*100),2) as poor_query_percentage from Queries group by query_name"
338,"select query_name, round(avg(rating/position), 2) as quality, round(100*sum(if(rating < 3, 1, 0)) / count(*),2) as poor_query_percentage from Queries group by query_name"
339,"SELECT query_name, ROUND(AVG(1.0*rating/position),2) AS quality, ROUND(AVG(rating<3)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
340,"SELECT q.query_name, ROUND(AVG(q.rating / q.position), 2) AS 'quality', ROUND((SELECT COUNT(q1.rating) FROM Queries q1 WHERE q1.rating < 3 AND q1.query_name = q.query_name) / (SELECT COUNT(*) FROM Queries q2 WHERE q2.query_name = q.query_name) * 100, 2) AS 'poor_query_percentage' FROM Queries q GROUP BY q.query_name "
341,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(rating < 3) / COUNT(rating) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
342,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND((SUM(if(rating<3,1,0))/count(*)*100),2) AS poor_query_percentage FROM Queries GROUP BY query_name"
343,"select query_name, round(avg(rating / position), 2) as quality, round((sum(if(rating < 3, 1, 0)) / count(1))* 100, 2) as poor_query_percentage from queries group by 1"
344,"SELECT query_name, ROUND(AVG(rating / position), 2) AS 'quality', ROUND(AVG(rating < 3) * 100, 2) AS 'poor_query_percentage' FROM Queries GROUP BY query_name "
345,"select query_name, round(avg(rating/position),2)as quality, round(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2)as poor_query_percentage from Queries group by query_name "
346,"SELECT query_name, ROUND((SUM(rating/position))/count(query_name) , 2) as quality, ROUND((SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)*100)/count(query_name),2) as poor_query_percentage FROM queries group by query_name order by query_name"
347,"select query_name, round((sum(rating/position) / count(query_name) ),2) as quality , round (avg(rating<3)*100,2) as poor_query_percentage from Queries group by query_name "
348,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) * 100/ COUNT(rating), 2) as poor_query_percentage FROM Queries GROUP BY query_name"
349,"SELECT query_name, round(AVG(rating / position),2) AS quality, round(100 * COUNT(IF(rating < 3, 1, NULL)) / COUNT(1), 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
350,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(rating<3)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
351,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from Queries group by query_name"
352,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from queries group by 1"
353,"SELECT q.query_name, ROUND(AVG(q.rating / q.position), 2) AS 'quality', ROUND((SELECT COUNT(q1.rating) FROM Queries q1 WHERE q1.rating < 3 AND q1.query_name = q.query_name) / (SELECT COUNT(*) FROM Queries q2 WHERE q2.query_name = q.query_name) * 100, 2) AS 'poor_query_percentage' FROM Queries q GROUP BY q.query_name "
354,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/ COUNT(rating) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY 1 "
355,"with a as( select query_name, (count(case when rating<3 then 1 else null end)/count(rating))*100 as poor_query_percentage from queries group by query_name), b as ( select query_name, round(sum(rating/position)/count(rating),2) as quality from queries group by query_name) select b.query_name,b.quality, round(a.poor_query_percentage,2) as poor_query_percentage from a join b on b.query_name = a.query_name "
356,"with metrics as ( select *, rating *1.0 / position as quality, if(rating < 3,1,0) as is_poor_query from Queries ) select query_name, round(avg(quality),2) as quality, round(avg(is_poor_query)*100,2) as poor_query_percentage from metrics group by 1"
357,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
358,"SELECT query_name, ROUND(SUM(rating / position) / COUNT(*),2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) * 100 / COUNT(*), 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
359,"select query_name, round(avg(rating/position),2) as quality, round(avg(rating < 3)*100,2) as poor_query_percentage from queries group by 1 "
360,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)*100/count(*),2) as poor_query_percentage from queries group by query_name"
361,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
362,"SELECT query_name, ROUND(AVG(rating/position),2) as quality, ROUND((SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(*)*100),2) as poor_query_percentage FROM Queries GROUP BY query_name"
363,"select query_name, round(coalesce(avg(rating/position), 0),2) quality, round(coalesce(sum(case when rating < 3 then 1 else 0 end)/count(rating),0)*100, 2) as poor_query_percentage from queries group by 1"
364,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(IF(rating < 3, 1, 0))*100, 2) AS poor_query_percentage FROM Queries GROUP BY 1 "
365,"SELECT query_name, ROUND(SUM(rating / position)/ COUNT(rating), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/ COUNT(rating) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY 1 "
366,"SELECT query_name, ROUND(SUM(rating/position)/COUNT(*),2) AS quality, ROUND(1.0*100*COUNT(CASE WHEN rating <3 THEN 1 END)/COUNT(*),2) AS poor_query_percentage FROM queries GROUP BY 1"
367,"SELECT query_name, ROUND(sum(rating/position)/count(rating), 2) as quality, ROUND(SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END) * 100 / count(rating), 2) as poor_query_percentage FROM Queries GROUP BY query_name"
368,"WITH q_cte AS (SELECT distinct query_name,result,position,rating FROM queries) SELECT query_name, round((sum((rating)/(position)))/count(*),2) quality, round((SUM(CASE WHEN rating <3 THEN 1 ELSE 0 END) / count(*))*100,2) poor_query_percentage FROM q_cte GROUP BY query_name"
369,"select query_name, round(avg(rating/position),2) as quality, round((sum(case when rating<3 then 1 else 0 end)/count(query_name))*100,2) as poor_query_percentage from queries group by 1"
370,"select query_name, round(avg(rating / position), 2) as quality, round(avg(if(rating < 3, 1, 0)) * 100, 2) as poor_query_percentage from queries group by query_name"
371,"select query_name, round(avg(quality),2) as quality, round((avg(poor_check) * 100),2) as poor_query_percentage from (select query_name, position, rating, (case when rating < 3 then 1 else 0 end ) as poor_check, rating/position as quality from queries )a group by query_name"
372,"select query_name, round(avg(qua), 2) quality, round(sum(rr) / count(query_name) * 100, 2) poor_query_percentage from ( select query_name, result, position, rating, rating/position qua, (case when rating < 3 then 1 else 0 end) rr from queries) cte group by 1 "
373,"SELECT query_name, ROUND(AVG(rating/position),2) AS quality, ROUND(AVG(CASE WHEN rating < 3 THEN 1 ELSE 0 END)*100,2) AS poor_query_percentage FROM Queries GROUP BY query_name"
374,"select query_name, round(sum(rating/position)/count(*),2) as quality, round(sum(case when rating <3 then 1 else 0 end)/count(*)*100,2) as poor_query_percentage from queries group by query_name"
375,"with cte AS( SELECT query_name, count(*) as total_count, SUM(rating/position) as total_position, SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) as total_rating FROM Queries GROUP BY query_name ) SELECT query_name, ROUND((total_position/total_count), 2) as quality, ROUND((total_rating/total_count)*100.00, 2) as poor_query_percentage FROM cte "
376,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating<3 then 1 else 0 end)*100/count(query_name),2) as poor_query_percentage from Queries group by query_name"
377,"SELECT query_name, ROUND(AVG(rating/position), 2) AS quality, ROUND(SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END)/COUNT(*)*100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
378,"select query_name, round(avg(rating/position), 2) as quality, round(100* sum(case when rating < 3 then 1 else 0 end)/count(*), 2) as poor_query_percentage from Queries group by 1"
379,"SELECT query_name, ROUND(SUM(rating / position) / COUNT(*), 2) AS quality, ROUND(100 * SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(*), 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
380,"select query_name,round(avg(rating/position),2)quality, round(100 * avg(rating < 3),2)poor_query_percentage from queries group by query_name "
381,"select query_name, round(avg(rating/position),2) as quality, round(100*avg(rating<3),2) as poor_query_percentage from Queries group by 1"
382,"select query_name, round(avg(rating/position), 2) as quality, round((sum(case when rating < 3 then 1 else 0 end)/count(1))*100,2) as poor_query_percentage from Queries group by query_name"
383,"Select query_name, coalesce( Round( sum(rating/position)/count(query_name) ,2) ,0) as quality, coalesce( Round( sum(if(rating < 3, 1, 0))/count(query_name) *100 ,2) ,0) as poor_query_percentage from Queries Group by query_name"
384,"SELECT query_name, ROUND (AVG(rating/position), 2) AS quality, ROUND ((COUNT(CASE WHEN rating < 3 THEN 1 END)/COUNT(*)) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name "
385,"select query_name, round(avg(rating/position) ,2) as quality, round( sum( case when rating < 3 then 1 else 0 end) /count(rating) * 100 ,2) as poor_query_percentage from queries group by query_name"
386,"Select query_name, round(avg(rating/position),2) as quality,round((sum(if(rating < 3, 1, 0)) / count(1))* 100, 2) as poor_query_percentage From Queries Group by query_name "
387,"SELECT query_name, ROUND(AVG(rating / position), 2) AS quality, ROUND(AVG(rating < 3) * 100, 2) AS poor_query_percentage FROM Queries GROUP BY query_name"
388,"select query_name, round(avg(rating/position),2) as quality, round(sum(case when rating < 3 then 1 else 0 end)/count(rating)*100,2) as poor_query_percentage from queries group by 1 "
389,"with CTE as ( select query_name, rating, position, result, case when rating < 3 then 1 else 0 end as poor_quality_number from Queries ) select query_name, round(sum(rating / position)/count(result),2) as quality, round(100*sum(poor_quality_number)/count(result),2) as poor_query_percentage from CTE group by query_name"
390,"SELECT query_name, round(sum(rating/position)/count(query_name),2) as quality, round(sum(if(rating<3,1,0))/count(query_name)*100,2) as poor_query_percentage FROM Queries GROUP BY query_name "
