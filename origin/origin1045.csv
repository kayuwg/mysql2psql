id,original query
1,"with cte as (Select customer_id, count(distinct product_key)ct from Customer group by customer_id) Select customer_id from cte where ct IN (Select count(distinct product_key) from Product)"
2,select customer_id from customer group by customer_id having count(distinct product_key) >= (select count(distinct product_key) cnt from product)
3,select customer_id from Customer group by 1 having count(distinct product_key) = (select count(*) from Product)
4,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(*) from Product)
5,"SELECT DISTINCT customer_id FROM ( SELECT customer_id, product_key, DENSE_RANK() OVER(PARTITION BY customer_id ORDER BY product_key) AS num_product FROM Customer ) temp WHERE num_product IN (SELECT COUNT(*) FROM Product)"
6,"select customer_id from (select customer_id, count(distinct product_key) as ct from Customer group by 1 ) tmp where ct = (select count(*) from Product) "
7,"select customer_id from ( select customer_id, count(distinct product_key) as product_number from Customer group by customer_id ) as temp where temp.product_number = (select count(distinct product_key) from Product)"
8,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product) 
9,SELECT c.customer_id FROM Customer c inner join Product p on c.product_key=p.product_key group by c.customer_id having count(distinct p.product_key)= (select count(distinct p.product_key) from Product p)
10,"with cte_filter as ( select c.customer_id, c.product_key from Customer c inner join Product p on c.product_key = p.product_key ) select customer_id from( select customer_id, count(distinct product_key) as counted from cte_filter group by customer_id having counted = (select count(distinct product_key) from Product) ) a"
11,with t1 as ( select count(*) as products from producT ) select customer_id from customer group by customer_id having count(distinct product_key) = (select products from t1) 
12,SELECT customer_id FROM customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM product)
13,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
14,"select customer_id from ( select distinct customer_id, count(distinct product_key) as np from customer group by customer_id ) a join (select count(*) as total from Product) b on np = total "
15,select customer_id from customer c group by customer_id having count(distinct product_key) = (select count(*) from product)
16,"WITH T1 AS (SELECT count(product_key) AS _total FROM product ) SELECT customer_id FROM customer c, t1 GROUP BY 1, t1._total HAVING count(DISTINCT product_key) = t1._total"
17,select c.customer_id from Customer c join Product p on c.product_key = p.product_key group by c.customer_id having count(distinct c.product_key) = (select count(*) from Product)
18,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product) 
19,"select customer_id from( select customer_id, count(distinct product_key)ct from customer group by customer_id)t where ct =(select count(*) from product)"
20,"SELECT customer_id FROM( SELECT customer_id, COUNT(DISTINCT product_key) AS count FROM Customer GROUP BY customer_id )C WHERE count = (SELECT COUNT(product_key) AS pc FROM Product)"
21,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
22,"with temp as( select customer_id, count(distinct(product_key)) as product_num from customer group by customer_id ) select customer_id from temp where product_num = (select count(product_key) from product)"
23,"with cust as ( select customer_id, count(distinct product_key) prod_cnt from customer group by customer_id) select customer_id as CUSTOMER_ID from cust where prod_cnt = (select count(*) from product)"
24,select customer_id from customer c group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
25,"select customer_id from (select customer_id, case when sum(cnt)=p.b then customer_id end as l from (select customer_id,c.product_key,count(distinct c.product_key) as cnt from Customer c inner join Product p on c.product_key=p.product_key group by customer_id,c.product_key )as a,(select count(product_key) as b from Product)as p where 1=1 group by customer_id)as o where o.l is not null"
26,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product)
27,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM Product) 
28,select customer_id from customer group by customer_id having count(distinct product_key) in (select count(distinct product_key) from product)
29,"with unique_products_customers as ( select distinct customer_id, product_key from customer ), row_numbered_product_customers as ( select *, row_number() over (partition by customer_id order by product_key) row_num from unique_products_customers upc ) select customer_id from row_numbered_product_customers where row_num = ( select count(distinct product_key) from product )"
30,"with tmp as (select count(distinct product_key) as diverse1 from Product) , tmp2 as ( select customer_id, count(distinct product_key) as diverse from Customer where product_key in (select distinct product_key from Product) group by 1) select customer_id from tmp2, tmp where diverse = diverse1"
31,select customer_id from Customer c group by customer_id having count(distinct product_key) = (select count(product_key) from Product) 
32,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM Product)
33,"select distinct a.customer_id from( select customer_id,count(distinct product_key ) as cnt from Customer group by customer_id having cnt in (select count(product_key) from product))a"
34,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
35,select distinct customer_id from Customer group by customer_id having count(distinct product_key)=(select count(*) from Product)
36,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(*) from Product)
37,select customer_id from Customer c right join Product p on c.product_key = p.product_key group by customer_id having count(distinct c.product_key) = (select count(product_key) from Product)
38,"with cte as ( select customer_id, count(distinct product_key) as ordered, total from Customer, (select count(product_key) as total from Product) a group by 1 ) select distinct customer_id from cte where ordered = total"
39,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) AS num_total FROM Product) 
40,select distinct customer_id from Customer group by customer_id having group_concat(distinct product_key order by product_key) = (select group_concat(product_key order by product_key) from Product ) 
41,SELECT customer_id FROM Customer GROUP BY customer_id Having count(distinct product_key) = ( SELECT count(product_key) as cnt FROM Product) 
42,SELECT customer_id FROM customer GROUP BY customer_id HAVING count(distinct product_key) = (select count(distinct product_key) FROM product)
43,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from Product)
44,"with cte as ( select customer_id,count(distinct product_key) as cnt from customer group by customer_id ) select customer_id from cte where cnt= ( select count(distinct product_key) from product ) "
45,"select a.customer_id from (select customer_id , sum(distinct product_key) as total1 from Customer group by customer_id) a , (select sum(distinct product_key) as total2 from Product) b where a.total1 = b.total2"
46,"with cte1 as (select count(product_key) as c1 from Product), cte2 as (select distinct customer_id, count(distinct product_key) as c2 from Customer group by customer_id) select distinct customer_id from cte1, cte2 where cte1.c1 = cte2.c2"
47,SELECT DISTINCT customer_id FROM Customer GROUP BY 1 HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product) 
48,"with boughtpdts (customer_id, bought) as (select customer_id, c.product_key from customer c join product p on c.product_key = p.product_key ) select customer_id from boughtpdts group by customer_id having count(distinct bought)=(select count(product_key) from product) "
49,select customer_id from Customer group by customer_id having count(distinct(product_key)) = (select count(product_key) from Product)
50,"Select customer_id from (select distinct customer_id,product_key from customer) g group by customer_id having count(*) = (select count( product_key) from product)"
51,SELECT customer_id FROM Customer C GROUP BY customer_id HAVING COUNT(DISTINCT product_key)=(SELECT COUNT(distinct product_key) FROM Product)
52,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct(product_key)) from Product)
53,select customer_id from customer c inner join product p on c.product_key=p.product_key group by customer_id having count(distinct p.product_key)=(select count(product_key) from product)
54,SELECT customer_id FROM customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM product) 
55,select customer_id from Customer group by customer_id having count(distinct product_key) in (select count(distinct product_key) from Product) 
56,select customer_id from customer group by 1 having group_concat(distinct product_key)=(select group_concat(distinct product_key) from product) 
57,select customer_id from customer group by customer_id HAVING count(DISTINCT product_key) = (SELECT count(DISTINCT product_key) FROM customer)
58,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(*) from product ) 
59,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product)
60,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(*) from product)
61,select customer_id from customer c group by 1 having count(distinct c.product_key) = (select count(product_key) from product )
62,"select A.customer_id from (select customer_id,count(DISTINCT product_key) cnt from customer join product using(product_key) group by customer_id)A where A.cnt=(select count(product_key) from product) "
63,"select customer_id from( select customer_id, count(distinct product_key)ct from customer group by customer_id)t where ct =(select count(*) from product)"
64,select distinct customer_id from Customer group by 1 having count(distinct product_key) = (select count(distinct product_key) from Product)
65,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
66,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = ( SELECT COUNT(DISTINCT product_key) as num_prods FROM Product) 
67,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(*) from product)
68,"with cte as ( select customer_id, count(distinct product_key) as cnts from Customer group by 1 ) select customer_id from cte where cnts = ( select count(distinct product_key) from Product )"
69,"SELECT customer_id FROM (SELECT customer_id, count(DISTINCT product_key) AS proCount FROM Customer GROUP BY customer_id)t WHERE t.proCount= (SELECT count(product_key) mx FROM Product)"
70,select customer_id from customer group by 1 having count(distinct product_key) =(select count(*) as 'cnt' from product) order by 1 
71,"select customer_id from ( select customer_id, count(distinct product_key) as cnt from customer group by 1) temp where cnt = (select count(distinct product_key) from product) "
72,Select customer_id from customer Group by customer_id Having count(distinct product_key) = (select count(distinct product_key) from product) 
73,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT(product_key)) = (SELECT COUNT(*) FROM Product)
74,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product) 
75,SELECT customer_id from customer group by customer_id having count(DISTINCT product_key)=(SELECT count(p.product_key) from product p)
76,select c.customer_id from customer c group by c.customer_id having count(distinct c.product_key) = (select count(product_key) from product)
77,select customer_id from customer group by customer_id having count(distinct product_key)= (select count(distinct product_key) from product)
78,select distinct customer_id from customer group by customer_id having count(distinct product_key) = (select distinct count(product_key) from product)
79,SELECT customer_id FROM customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT count(distinct product_key) FROM product)
80,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
81,select distinct customer_id from Customer group by customer_id having count(distinct product_key)=(select count(product_key) from Product)
82,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product) 
83,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = ( SELECT COUNT(*) FROM Product ) 
84,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
85,SELECT customer_id FROM (SELECT DISTINCT * FROM CUSTOMER) a GROUP BY customer_id HAVING COUNT(customer_id)=(SELECT count(DISTINCT product_key) FROM Product)
86,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
87,"with cte as ( select *, count(*) as total_products from Product ) select customer_id from ( select customer_id, count(distinct product_key) as bought_products from Customer group by customer_id ) tmp where bought_products = (select max(total_products) from cte)"
88,select customer_id from customer group by customer_id having count(distinct product_key)= (select count(*) from product)
89,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) IN (SELECT COUNT(DISTINCT product_key) FROM Product)
90,"SELECT x.customer_id FROM ( SELECT DISTINCT customer_id, COUNT(DISTINCT product_key) AS cnt FROM Customer GROUP BY 1 )x WHERE x.cnt = (SELECT COUNT(DISTINCT product_key) AS cnt FROM Product) "
91,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM Product)
92,select customer_id from Customer group by customer_id having count(distinct product_key)=(select count(*) from Product)
93,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product)
94,select customer_id from customer c group by customer_id HAVING count(distinct product_key) = (select count(distinct product_key) from product) 
95,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Customer)
96,"with cust_count as ( select customer_id,count(distinct product_key) as count_prod from customer group by 1 ) select distinct customer_id from cust_count where count_prod = (select count(distinct product_key) from product) "
97,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(product_key) FROM Product)
98,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
99,select customer_id from (select distinct * from Customer) t group by customer_id having count(0) = (select count(0) from Product)
100,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product) 
101,SELECT customer_id FROM customer c GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) from product)
102,SELECT customer_id FROM customer GROUP BY 1 HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM product) ORDER BY 1
103,select cs.customer_id as customer_id from customer cs group by 1 having count(distinct cs.product_key) = (select count( distinct pd.product_key) from product pd) 
104,SELECT customer_id FROM customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key)=(SELECT COUNT(*) FROM product) 
105,select customer_id from Customer group by customer_id having count(distinct product_key)=(select count(*) from Product)
106,"select customer_id from (select customer_id, count(distinct product_key) as productCt from Customer group by customer_id) t where productCt=(select count(*) from Product)  "
107,select customer_id from Customer c group by customer_id having count(distinct c.product_key) = (select count(product_key) from Product)
108,select customer_id from customer group by 1 having count(distinct product_key) = (select count(product_key) from product) 
109,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key ) as count_product from Product)
110,select customer_id from customer group by 1 having count(distinct product_key)=(select count(*) from Product) order by 1 
111,select customer_id from customer group by customer_id having count(distinct product_key)= (select count( distinct product_key) from product) 
112,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT(product_key)) = (SELECT COUNT(*) FROM Product) 
113,select customer_id from customer group by 1 having count(distinct product_key)=(select count(*) as num from product)
114,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) as prdcnt from product)
115,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) as num_p from product)
116,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
117,"select a.customer_id from (select customer_id, count(distinct product_key) as cnt from Customer group by 1) a, (select count(*) as cnt from Product) b where a.cnt = b.cnt"
118,"WITH CTE1 AS ( SELECT customer_id, COUNT(DISTINCT product_key) AS ct FROM Customer GROUP BY customer_id) SELECT customer_id FROM CTE1 WHERE ct = (SELECT COUNT(*) FROM Product)"
119,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
120,select customer_id from customer c inner join product p on c.product_key=p.product_key group by 1 having count(distinct p.product_key)=(select count(*) from product)
121,"with temp as (select C.customer_id, C.product_key as P1, P.product_key AS P2 from Customer C left JOIN Product P ON C.product_key = P.product_key) select customer_id from temp where P1=P2 group by 1 having count(distinct P1)= (select count(distinct product_key) from Product)"
122,"select customer_id from ( select customer_id, if(count(distinct product_key) = (select count(product_key) from Product),1,0) as valid from Customer group by 1 ) t where valid = 1"
123,SELECT c.customer_id FROM Customer c GROUP BY c.customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product p)
124,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product)
125,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
126,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product) 
127,select customer_id from Customer group by customer_id having count(distinct product_key) in (select count(product_key) from Product) 
128,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(*) from product)
129,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product) 
130,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product)
131,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = ( SELECT COUNT(distinct product_key) FROM Product )
132,"select distinct A.customer_id as customer_id from (select customer_id, count(distinct product_key) as num_products from Customer group by customer_id)A JOIN (select count(product_key) as num_products from Product)B ON(A.num_products = B.num_products) where A.customer_id is not NULL"
133,"with unique_purchases as (select distinct customer_id, product_key from customer) select customer_id from unique_purchases group by customer_id having count(unique_purchases.customer_id) = (select count(distinct product_key) from product) "
134,"WITH cust as ( SELECT customer_id,COUNT(DISTINCT product_key) as cnt FROM Customer GROUP BY 1 ) SELECT customer_id FROM cust WHERE cnt = (SELECT COUNT(DISTINCT product_key) FROM Product) "
135,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = ( SELECT COUNT(DISTINCT product_key) FROM Product )
136,"select customer_id from (select distinct customer_id, count(distinct product_key) as customer_products from Customer group by 1) c where customer_products = (select count(*) from Product) "
137,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
138,"select customer_id from ( SELECT customer_id, count(distinct product_key) ct from Customer group by customer_id having ct = (select count(distinct product_key) from Product)) as t"
139,"with cte as ( Select customer_id, count(DISTINCT product_key) as ct from Customer group by customer_id) Select customer_id from cte where ct = (Select count(DISTINCT product_key) from Product)"
140,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product)
141,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(*) from Product)
142,select customer_id from customer group by customer_id having count(distinct product_key) = ( select count(distinct product_key) from product )
143,select customer_id from Customer group by customer_id having count(distinct product_key)= (select count(distinct product_key) from product) 
144,"select customer_id from ( select customer_id, count(distinct product_key) as ct from ( select c.customer_id, p.* from customer c inner join product p on c.product_key=p.product_key ) t group by customer_id ) j where ct = (select count(*) from product) "
145,select customer_id from product p left join customer c on p.product_key = c.product_key group by 1 having count(distinct c.product_key) = (select count(product_key) from product) 
146,select customer_id from customer group by 1 having count(distinct product_key) = (select count(1) from product)
147,"with a as ( select customer_id, group_concat(distinct product_key ) as nn from customer group by customer_id ) , b as (select group_concat(distinct product_key ) as nn2 from product ) select distinct customer_id from a where nn in (select nn2 from b) "
148,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product) 
149,"WITH first_pass AS( SELECT customer_id,count(distinct product_key) as total_products FROM Customer WHERE length(product_key) > 0 GROUP BY 1) SELECT customer_id FROM first_pass where total_products = (SELECT count(distinct product_key) FROM Customer)"
150,SELECT DISTINCT c.customer_id FROM customer c WHERE c.product_key in (SELECT p.product_key FROM product p) GROUP BY c.customer_id HAVING COUNT(DISTINCT c.product_key)=(SELECT COUNT(*) FROM product)
151,select a.customer_id from (select distinct * from Customer) as a group by a.customer_id having sum(case when a.product_key in (select * from Product) then 1 else 0 end) = (select count(*) from Product)
152,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product) 
153,"with cte as( SELECT customer_id, COUNT(DISTINCT(product_key)) as num FROM Customer GROUP BY customer_id) select customer_id from cte where num=(Select count(*) FROM Product) "
154,select customer_id from Customer group by customer_id having count(distinct(product_key)) = (select count(*) from Product)
155,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
156,select customer_id from Customer c right join Product p on c.product_key = p.product_key group by customer_id having count(distinct c.product_key) = (select count(product_key) from Product)
157,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count( product_key) from product) 
158,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
159,Select customer_id from Customer group by customer_id having count(distinct(product_key)) = (select Count(distinct(product_key)) from product)
160,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
161,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
162,"SELECT customer_id FROM ( SELECT customer_id, COUNT(DISTINCT product_key) AS number_purchase FROM Customer GROUP BY customer_id ) t WHERE number_purchase = (SELECT COUNT(DISTINCT product_key) from Product)"
163,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product) 
164,"WITH cte AS (SELECT customer_id, COUNT(DISTINCT product_key) ct FROM Customer GROUP BY customer_id) SELECT customer_id FROM cte WHERE ct=(SELECT COUNT(product_key) FROM Product) "
165,select customer_id from Customer group by customer_id having count(distinct product_key) = ( select count(1) from Product)
166,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
167,"select customer_id from (select customer_id,count(product_key) from Customer group by customer_id having count(distinct product_key)=(select count(product_key) from Product)) t"
168,SELECT c.customer_id FROM Customer c GROUP BY c.customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product p) 
169,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT(product_key)) = (SELECT COUNT(DISTINCT product_key) FROM Product)
170,select customer_id from Customer as c group by 1 having count(distinct product_key) = ( select count(distinct product_key) from Product )
171,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
172,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) as cnt from Product)
173,"SELECT customer_id FROM (SELECT customer_id, product_key, COUNT(DISTINCT product_key) as ctr FROM Customer GROUP BY customer_id) as c WHERE ctr=(select count(DISTINCT product_key) FROM Product) "
174,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product)
175,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) as req from product) 
176,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
177,select distinct customer_id from Customer group by customer_id having count(distinct product_key) = (select count(product_key) from Product)
178,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
179,"with temp as ( select c.customer_id,p.product_key from customer c cross join product p ) select distinct customer_id from customer where customer_id not in ( select customer_id from (select t.customer_id,coalesce(c.product_key,0) as pk from temp t left join customer c on t.customer_id = c.customer_id and t.product_key = c.product_key)t1 where pk = 0) "
180,"SELECT CUSTOMER_ID FROM (SELECT CUSTOMER_ID, SUM(PRODUCT_KEY) AS TOT FROM (SELECT DISTINCT CUSTOMER_ID, PRODUCT_KEY FROM CUSTOMER ORDER BY PRODUCT_KEY) A GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_KEY) = (SELECT SUM(PRODUCT_KEY) FROM PRODUCT)) A"
181,select customer_id from Customer group by customer_id having count(distinct product_key)=(select count(*) from product)
182,"with total_prod(total) as (select count(distinct product_key) from product), con_prod(customer_id,total) as (select a.customer_id, count(distinct a.product_key) from customer a join product b on a.product_key = b.product_key group by a.customer_id) select distinct customer_id from total_prod, con_prod where total_prod.total = con_prod.total"
183,SELECT DISTINCT customer_id FROM customer GROUP BY 1 HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM Product)
184,select customer_id from Customer GROUP BY customer_id having count(distinct product_key) = (SELECT COUNT(*) FROM Product) 
185,select customer_id from Customer group by customer_id having count(distinct Customer.product_key) = (select count(*) from Product)
186,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
187,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product)
188,select customer_id from customer group by customer_id having count(distinct product_key) >= (select count(*) from product)
189,"with base as ( select distinct customer_id,product_key from customer) ,base2 as ( select customer_id,sum(product_key) as vall from base group by customer_id ) ,ans as ( select customer_id from base2 where vall=(select sum(distinct product_key) from product) ) select customer_id from ans"
190,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product) 
191,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
192,select distinct customer_id from customer group by customer_id having count(distinct product_key ) = (select count(product_key) from product) 
193,"with a as (select distinct customer_id,product.product_key from Customer cross join product) select distinct a.customer_id from a where a.customer_id not in ( select a.customer_id from a left join Customer on a.customer_id=customer.customer_id and a.product_key=customer.product_key where customer.product_key is null)  "
194,WITH cte AS( SELECT COUNT(*) FROM Product ) SELECT customer_id FROM Customer GROUP BY 1 HAVING COUNT(DISTINCT product_key) = ( SELECT * FROM cte )
195,"with purchased as ( select customer_id id, count(distinct product_key) purchases from customer group by 1 ) select id customer_id from purchased where purchases = (select count(*) from product)"
196,SELECT customer_id FROM customer GROUP BY 1 HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM product)
197,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product) 
198,"SELECT sub.customer_id FROM (SELECT c.customer_id, SUM(DISTINCT c.product_key) AS sub_total, SUM(DISTINCT p.product_key) AS total FROM Customer c, Product p GROUP BY customer_id) sub WHERE sub.sub_total = sub.total "
199,select customer_id from customer group by customer_id having count(distinct product_key)= (select count(product_key) from product)
200,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key)=(SELECT COUNT(DISTINCT product_key) FROM Product) 
201,SELECT customer_id FROM Customer GROUP BY 1 HAVING count(distinct product_key)= (SELECT count(*) FROM Product) 
202,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(*) from Product) 
203,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
204,select customer_id from (select distinct * from customer) a group by customer_id having count(1) = (select count(1) from product)
205,"SELECT c.customer_id FROM ( SELECT a.customer_id, a.product_key, COUNT(DISTINCT a.product_key) AS cnt FROM Customer a INNER JOIN Product b ON a.product_key = b.product_key GROUP BY a.customer_id )c WHERE c.cnt = (SELECT COUNT(d.product_key) as cnt FROM Product d)"
206,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product)  
207,"select customer_id from (select c.customer_id, p.product_key from customer c inner join product p on c.product_key = p.product_key) c_p group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product) "
208,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT(product_key)) = (SELECT COUNT(*) FROM Product)
209,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key)= (SELECT COUNT(DISTINCT product_key) FROM product)
210,"with temp as ( select distinct P.product_key, C.customer_id from Product P join Customer C USING(product_key)) select customer_id from temp group by customer_id having count(product_key) = (select count(product_key) from Product)"
211,"with a as (select distinct customer_id,product.product_key from Customer cross join product) select distinct a.customer_id from a where a.customer_id not in ( select a.customer_id from a left join Customer on a.customer_id=customer.customer_id and a.product_key=customer.product_key where customer.product_key is null)  "
212,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM Product)
213,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product) 
214,select customer_id from customer group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product) 
215,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT(product_key)) = (SELECT COUNT(*) FROM Product)
216,"with abc as ( select a.customer_id,count(distinct b.product_key) as counts from customer as a join customer as b on a.customer_id =b.customer_id where b.product_key in (select * from product) and (a.product_key != b.product_key) group by 1) select customer_id from abc where counts = (select count(*) from product)"
217,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(*) FROM Product)
218,"SELECT Sub.customer_id FROM ( SELECT customer_id, COUNT(DISTINCT product_key) AS num_bought_product FROM Customer GROUP BY customer_id ) Sub WHERE Sub.num_bought_product = (SELECT COUNT(product_key) FROM Product)"
219,"select customer_id from ( select customer_id, if( count(distinct product_key)=(select count(*) from Product),1,0) 'val' from Customer group by customer_id having val = 1) A"
220,select customer_id from customer group by customer_id having count(distinct product_key)=(select count(product_key) from product) 
221,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from Product)
222,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product)
223,"SELECT customer_id from (SELECT customer_id, COUNT(DISTINCT c.product_key) as ct FROM Customer c RIGHT JOIN Product p on c.product_key=p.product_key GROUP BY customer_id) a WHERE ct=(SELECT COUNT(DISTINCT product_key) FROM Product)"
224,"select distinct customer_id from (select customer_id, product_key, dense_rank()over(partition by customer_id order by product_key) as rnk from customer) t where rnk = (select count(distinct product_key) from product) "
225,"select distinct a.customer_id from (select customer_id, count(distinct product_key) from customer group by customer_id having count(distinct product_key)= (select count(product_key) from product)) a "
226,"WITH customers AS ( SELECT DISTINCT customer_id FROM Customer), possibilities AS ( SELECT c.customer_id, p.product_key FROM Customer c, Product p) SELECT p.customer_id FROM possibilities p LEFT JOIN Customer c ON p.customer_id = c.customer_id AND p.product_key=c.product_key GROUP BY 1 HAVING COUNT(DISTINCT c.product_key) = (SELECT COUNT(*) FROM Product)"
227,"with cte as ( select customer_id, count(product_key) over (partition by customer_id) as cnt from (select distinct * from Customer) t ) select distinct customer_id from cte where cnt=(select count(*) from Product) "
228,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(product_key) from Product)
229,SELECT customer_id from Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(product_key) FROM Product)  
230,"SELECT customer_id FROM (SELECT customer_id, COUNT(DISTINCT product_key) as cnt FROM customer GROUP BY customer_id) temp WHERE cnt=(SELECT COUNT(*) FROM product)"
231,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(product_key) from product)
232,SELECT customer_id FROM Customer C GROUP BY customer_id HAVING COUNT(DISTINCT(product_key))= (SELECT COUNT(*) FROM Product)
233,select customer_id from customer c group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product) 
234,select distinct customer_id from Customer group by 1 having count(distinct product_key) = (select count(*) from product )
235,"with cte as (select customer_id, count(distinct product_key) as cnt from Customer group by customer_id) select customer_id from cte where cnt = (select count(product_key) from Product) "
236,SELECT customer_id FROM Customer GROUP BY customer_id HAVING count(DISTINCT product_key) = ALL(SELECT count(DISTINCT product_key) FROM Product)
237,"WITH basic AS ( SELECT customer_id, COUNT(DISTINCT product_key) AS NoProductsBought FROM Customer GROUP BY customer_id ), noproducts AS (SELECT COUNT(*) AS nop FROM Product) SELECT customer_id FROM basic, noproducts WHERE NoProductsBought = nop "
238,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(distinct product_key) from product) 
239,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(product_key) FROM Product)
240,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT(product_key)) = (SELECT COUNT(*) FROM Product)
241,select customer_id from customer group by 1 having count(distinct product_key) = (select count(distinct product_key) from product)
242,"WITH CTE AS ( SELECT DISTINCT customer_id, product_key FROM Customer ), CTE1 AS ( SELECT customer_id, COUNT(*) cnt FROM CTE GROUP BY customer_id HAVING COUNT(*)=(SELECT COUNT(*) FROM Product) ) SELECT customer_id FROM CTE1"
243,select customer_id from customer group by customer_id having count(distinct(product_key)) = (select count(*) from product)
244,select customer_id from customer group by customer_id having count(distinct product_key) = ( select count(distinct product_key) from Product )
245,"SELECT customer_id FROM( SELECT customer_id, GROUP_CONCAT(DISTINCT product_key SEPARATOR ';') AS search FROM Customer GROUP BY 1 )t WHERE search IN (SELECT GROUP_CONCAT(DISTINCT product_key SEPARATOR ';') AS search FROM Product) "
246,SELECT customer_id FROM Customer GROUP BY 1 HAVING COUNT( DISTINCT product_key) = (SELECT COUNT(product_key) FROM Product) 
247,SELECT customer_id FROM Customer GROUP BY customer_id HAVING COUNT(DISTINCT product_key) = (SELECT COUNT(DISTINCT product_key) FROM Product) 
248,"with t1 as ( select customer_id, count(distinct product_key) as num_items from customer group by customer_id ) select customer_id from t1 where num_items = (select count(*) from product)"
249,SELECT customer_id FROM Customer GROUP BY customer_id HAVING count(distinct product_key) = (select count(distinct product_key) From Product)
250,"select customer_id from (select *, count(distinct product_key) from Customer group by customer_id HAVING count(distinct product_key) = (select count(distinct product_key) from Product) )l "
251,"select a.customer_id as customer_id from (select customer_id, group_concat(distinct(product_key) order by product_key) as new from customer group by customer_id) a where new = (select group_concat(distinct(product_key) order by product_key) from product)"
252,"WITH bought AS (SELECT customer_id, COUNT(DISTINCT product_key) as cnt FROM customer GROUP BY customer_id ) SELECT customer_id FROM bought WHERE bought.cnt = ( SELECT COUNT(*) as cnt FROM product)"
253,select customer_id from customer group by customer_id having count(distinct product_key) = (select count(*) from product)
254,select customer_id from Customer group by customer_id having count(distinct product_key) = (select count(product_key) from Product) 
