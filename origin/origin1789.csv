id,original query
1,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') union (select employee_id, department_id from Employee group by employee_id having count(*) = 1 )"
2,"with t as ( select employee_id,department_id,primary_flag, count(department_id) over(partition by employee_id) as num_dep from employee ) select employee_id,department_id from t where primary_flag = 'Y' or num_dep = 1 "
3,"select employee_id,department_id from Employee where primary_flag='Y' or employee_id in (select employee_id from Employee group by 1 having count(*)=1)"
4,"select * from ( select distinct ct.employee_id,case when ct.ct_dept = 1 then department_id when ct.ct_dept > 1 and primary_flag = 'Y' then department_id else NULL end as department_id from Employee left join (select employee_id,count(department_id) as ct_dept from Employee group by employee_id) as ct on Employee.employee_id = ct.employee_id ) as a where department_id is not null"
5,"with cte_final as ( select employee_id, case when count(*) = 1 then any_value(department_id) else sum( if(primary_flag = 'Y', department_id, 0)) end as department_id from Employee group by 1 ) select * from cte_final "
6,"select employee_id, department_id from (select employee_id, department_id, rank() over(partition by employee_id order by primary_flag asc) as rank_ from Employee) tmp1 where rank_=1 order by employee_id"
7,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
8,"with emp as ( select employee_id, department_id, primary_flag, count(*) over(partition by employee_id) cnt from employee ) select employee_id, department_id from emp where (primary_flag='Y' and cnt>1) or cnt=1"
9,"select employee_id, department_id from ( select employee_id, count(department_id) ct from employee group by employee_id ) r1 natural join employee where primary_flag='Y' or (ct=1 and primary_flag='N') "
10,"select employee_id , max(department_id ) as department_id from employee group by 1 having count(*) = 1 union select employee_id , max(case when primary_flag = 'Y' then department_id end ) as department_id from employee group by 1 having count(*) > 1 "
11,"SELECT employee_id, department_id FROM ( SELECT employee_id, department_id, primary_flag, COUNT(department_id) OVER (PARTITION BY employee_id) AS count_dept FROM Employee ) AS t1 WHERE count_dept = 1 OR primary_flag = 'Y'"
12,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id,department_id from employee group by employee_id having count(employee_id ) = 1 "
13,"SELECT employee_id, department_id FROM (SELECT *, COUNT(employee_id) OVER (PARTITION BY employee_id) C FROM Employee) T WHERE C = 1 OR primary_flag = 'Y'"
14,"SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) < 2 UNION SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y'"
15,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
16,"WITH lookup AS ( SELECT employee_id, department_id, COUNT(department_id) AS flag FROM Employee GROUP BY employee_id ) SELECT Employee.employee_id, Employee.department_id FROM Employee LEFT JOIN lookup ON Employee.employee_id = lookup.employee_id WHERE primary_flag = 'Y' OR flag = 1 "
17,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
18,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag ='Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id)=1)"
19,"SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) = 1 UNION SELECT employee_id, department_id FROM Employee WHERE primary_flag = ""Y"""
20,"select employee_id, department_id from Employee where primary_flag=""Y"" or employee_id in (select employee_id from Employee group by employee_id having count(department_id)=1) "
21,"WITH Temp1 as (SELECT employee_id, department_id FROM employee WHERE primary_flag=""Y"" ), Temp2 as (SELECT employee_id, department_id, count(department_id) as c FROM employee group by 1 having c = 1) SELECT employee_id, department_id FROM Temp2 UNION select employee_id, department_id from Temp1 "
22,"with cte as( select employee_id, department_id, rank() over (partition by employee_id order by primary_flag asc) as rnk from employee ) select employee_id, department_id from cte where rnk = 1 group by employee_id"
23,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee where employee_id in ( select employee_id from employee group by employee_id having count(*) = 1)"
24,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(DISTINCT department_id) = 1  "
25,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 "
26,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by 1 having count(primary_flag)=1)"
27,"with cte as ( select e.employee_id, count(*) as 'employcount' from Employee e group by 1 ) select e.employee_id, e.department_id from Employee e left join cte on e.employee_id = cte.employee_id where cte.employcount = 1 or (cte.employcount > 1 and e.primary_flag = 'Y') "
28,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION select employee_id, department_id from Employee where primary_flag = 'Y' "
29,"select b.employee_id,b.department_id from (select a.*, row_number() over (partition by employee_id order by primary_flag asc) as row_num from Employee as a) as b where row_num=1 "
30,"WITH temp AS ( SELECT employee_id, department_id, ROW_NUMBER() OVER (PARTITION BY employee_id ORDER BY primary_flag ASC) AS rk FROM Employee ) SELECT employee_id, department_id FROM temp WHERE rk = 1"
31,"SELECT employee_id, department_id FROM (SELECT employee_id, department_id, CASE WHEN COUNT(department_id) OVER(PARTITION BY employee_id) = 1 THEN 'Y' ELSE primary_flag END AS primary_flag FROM Employee )t WHERE primary_flag = 'Y'"
32,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 "
33,"WITH lookup AS ( SELECT employee_id, department_id, COUNT(department_id) AS flag FROM Employee GROUP BY employee_id ) SELECT Employee.employee_id, Employee.department_id FROM Employee LEFT JOIN lookup ON Employee.employee_id = lookup.employee_id WHERE primary_flag = 'Y' OR flag = 1 "
34,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING count(department_id) = 1)"
35,"(SELECT DISTINCT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION ALL (SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'N' AND employee_id IN(SELECT employee_id FROM Employee GROUP BY 1 HAVING COUNT(*) = 1)) "
36,"Select employee_id,department_id from Employee where primary_flag='Y' UNION Select employee_id,department_id from Employee group by employee_id having count(employee_id)=1 "
37,"with temp as ( select employee_id, department_id from Employee where primary_flag = 'Y' ) select * from temp union select employee_id, department_id from Employee where employee_id not in (select employee_id from temp)"
38,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
39,"select DISTINCT E1.employee_id , COALESCE(E2.department_id,E1.department_id) AS department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id AND E1.primary_flag='N' AND E2.primary_flag='Y' "
40,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
41,"Select employee_id, department_id from employee where primary_flag = 'Y' or employee_id in (Select employee_id from employee Group by employee_id having count(department_id) = 1) "
42,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION select employee_id, department_id from Employee where primary_flag = 'Y' "
43,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
44,"select employee_id, department_id from Employee where primary_flag = 'Y' OR employee_id in (select employee_id from Employee group by employee_id having count(*) = 1)"
45,"(select employee_id, department_id from Employee where primary_flag = 'Y') union (select employee_id, department_id from Employee group by 1 having count(distinct department_id) = 1)"
46,"select e.employee_id, case when f.c>1 and e.primary_flag='Y' then e.department_id when f.c=1 then e.department_id end as department_id from employee e left join (select employee_id, department_id, count(primary_flag) as c from employee group by employee_id) f on e.employee_id = f.employee_id having department_id is not null"
47,"SELECT employee_id, department_id FROM (SELECT employee_id, department_id, primary_flag, COUNT(department_id) OVER(PARTITION BY employee_id) cn FROM Employee) temp WHERE (CASE WHEN cn = 1 THEN primary_flag = ""N"" OR primary_flag = ""Y"" WHEN cn > 1 THEN primary_flag = ""Y"" END)"
48,"WITH EmployeeWithOneDepartment AS ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 ), firstTable AS ( SELECT E.employee_id, E.department_id FROM Employee E INNER JOIN EmployeeWithOneDepartment E1 ON E.employee_id = E1.employee_id ), secondTable AS ( SELECT E.employee_id, E.department_id FROM Employee E WHERE E.primary_flag = 'Y' ) SELECT * FROM firstTable UNION SELECT * FROM secondTable"
49,"(select employee_id, department_id from Employee group by employee_id having count(department_id) = 1) union (select employee_id, department_id from Employee where primary_flag = 'Y')"
50,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y' "
51,"select employee_id, department_id from employee where primary_flag='Y' union select employee_id, department_id from employee group by employee_id having count(employee_id)=1"
52,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id, department_id from Employee group by employee_id having (count(department_id)=1) "
53,"select employee_id , department_id from employee where primary_flag = 'Y' union select employee_id , department_id from employee group by employee_id having count(department_id)=1 "
54,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION select employee_id, department_id from Employee where primary_flag = 'Y'"
55,"select employee_id, department_id from Employee group by 1 having count(distinct department_id) = 1 union select employee_id, department_id from Employee where primary_flag ='Y' "
56,"(select employee_id ,department_id from Employee group by employee_id having count( department_id) =1 ) union (select employee_id ,department_id from Employee where primary_flag =""Y"" group by employee_id) "
57,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
58,"WITH main AS ( SELECT *, COUNT(*) OVER(PARTITION BY employee_id) AS dep_count FROM Employee ) SELECT employee_id, department_id FROM main WHERE primary_flag = 'Y' OR dep_count = 1"
59,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1"
60,"(SELECT employee_id, department_id from employee group by employee_id HAVING count(distinct department_id) = 1) UNION (SELECT employee_id, department_id from employee WHERE primary_flag ='Y') "
61,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1) "
62,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = ""Y"" ) UNION ( SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 )"
63,"SELECT DISTINCT A.employee_id, A.department_id FROM (SELECT employee_id, department_id FROM Employee WHERE employee_id IN (SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1) UNION ALL SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') A "
64,"WITH deps AS ( SELECT employee_id, COUNT(DISTINCT department_id) AS deps_num FROM Employee e GROUP BY employee_id ) SELECT e.employee_id, SUM(IF(deps_num = 1, department_id, IF(primary_flag='Y', department_id, 0))) AS department_id FROM Employee e LEFT JOIN deps d ON e.employee_id = d.employee_id GROUP BY e.employee_id"
65,"select distinct employee_id, department_id from (select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION ALL select employee_id, department_id from Employee where primary_flag = 'Y') b"
66,"select employee_id, department_id from Employee where primary_flag = ""Y"" union select employee_id, department_id from Employee group by employee_id having count(employee_id)=1 "
67,"with cte as ( select employee_id, department_id, count(distinct department_id) as count from employee group by employee_id ) select employee_id, department_id from( select e.employee_id, e.department_id, primary_flag, count from employee e join cte c on e.employee_id = c.employee_id ) sub where (count > 1 and primary_flag = ""Y"") or (count = 1)"
68,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 "
69,"(select employee_id ,department_id from Employee group by employee_id having count( department_id) =1 ) union (select employee_id ,department_id from Employee where primary_flag =""Y"" group by employee_id) "
70,"SELECT employee_id, department_id FROM Employee where primary_flag = 'Y' group by 1 union SELECT a.employee_id, a.department_id FROM (SELECT employee_id, department_id, count(department_id) from Employee group by 1 having count(department_id) = 1) a "
71,"select employee_id, department_id from (select *, count(1) over (partition by employee_id order by primary_flag) as cnt from Employee) tab where cnt = 1 or (cnt > 1 and primary_flag = 'Y')"
72,"select employee_id,department_id from Employee where primary_flag = 'Y' or (employee_id in (select employee_id from Employee group by employee_id having count(department_id)=1))"
73,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee where primary_flag = 'N' and employee_id not in (select employee_id from employee where primary_flag = 'Y') group by 1 having count(*) = 1"
74,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(employee_id) = 1  "
75,"with cnt as( select distinct employee_id, department_id, count(employee_id) as cnt from employee group by employee_id) select distinct employee_id, department_id from cnt where cnt = 1 union select distinct employee_id, department_id from employee where primary_flag = 'Y' "
76,"select employee_id, department_id from ( select *, count(*) over(partition by employee_id) as num_department from employee ) as e1 where (num_department>1 and primary_flag='Y') or (num_department=1) "
77,"select employee_id, department_id from Employee where employee_id not in (select employee_id from Employee where primary_flag = 'Y') union (select employee_id, department_id from Employee where primary_flag = 'Y')"
78,"select employee_id, department_id from ( select employee_id, department_id, max(primary_flag) over (partition by employee_id ) as last_flag, primary_flag from Employee order by 1 ) temp where (primary_flag = 'Y') or (last_flag = 'N') order by 1"
79,"WITH primaries as ( SELECT * FROM Employee WHERE primary_flag = 'Y' ) SELECT Employee.employee_id, CASE WHEN primaries.department_id IS NULL THEN Employee.department_id ELSE primaries.department_id END AS ""department_id"" FROM Employee LEFT JOIN primaries ON Employee.employee_id = primaries.employee_id GROUP BY Employee.employee_id ORDER BY Employee.employee_id ASC"
80,"with base as (select employee_id, count(distinct department_id) as nd from employee group by 1) select e.employee_id, e.department_id from employee e left join base b on e.employee_id = b.employee_id where b.nd = 1 union select employee_id, department_id from employee where primary_flag = 'Y'"
81,"select employee_id, department_id from employee where primary_flag ='Y' union select employee_id, department_id from employee e where primary_flag ='N' and not exists (select 1 from employee e1 where e.employee_id = e1.employee_id and e1.primary_flag ='Y' )"
82,"SELECT employee_id,department_id FROM Employee GROUP BY 1 HAVING COUNT(department_id)=1 UNION SELECT employee_id,department_id FROM Employee WHERE primary_flag = ""Y"" GROUP BY 1 "
83,"select employee_id, department_id from Employee where primary_flag = 'Y' OR employee_id in (select employee_id from Employee group by 1 having count(primary_flag)=1)"
84,"select DISTINCT E1.employee_id , COALESCE(E2.department_id,E1.department_id) AS department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id AND E1.primary_flag='N' AND E2.primary_flag='Y' "
85,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) = 1"
86,"select t1.employee_id, case when t1.department_id is null then t2.department_id else t1.department_id end department_id from (select e.employee_id, case when count(*) = 1 then e.department_id else null end department_id from employee e group by employee_id) t1 left join (select e.employee_id, department_id from employee e where e.primary_flag = 'Y') t2 on t1.employee_id = t2.employee_id"
87,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
88,"with cte as ( select *, row_number() over (partition by employee_id order by primary_flag asc) as rownum from Employee ) select employee_id, department_id from cte where rownum = 1 "
89,"Select employee_id, department_id From (Select *, count(department_id) over (partition by employee_id) as num From Employee Order by employee_id) a Where num = 1 OR primary_flag = 'Y' "
90,"(SELECT employee_id, department_id from employee group by employee_id HAVING count(distinct department_id) = 1) UNION (SELECT employee_id, department_id from employee WHERE primary_flag ='Y')"
91,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(distinct department_id) = 1)"
92,"with t as (select employee_id, department_id from Employee where primary_flag=""Y"" group by 1,2), t2 as (select employee_id, department_id, count(department_id) c from Employee group by 1 having c=1) select employee_id, department_id from t2 union select employee_id, department_id from t"
93,"select employee_id, department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(*) =1) "
94,"select distinct e.employee_id, COALESCE(E1.department_id,E.department_id) AS department_id from Employee e left join Employee e1 on e.employee_id = e1.employee_id and e.primary_flag = 'N' and e1.primary_flag = 'Y' "
95,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
96,"WITH single AS ( SELECT employee_id, count(employee_id) AS count FROM Employee GROUP BY employee_id HAVING count = 1), multi AS ( SELECT employee_id, count(employee_id) AS count FROM Employee GROUP BY employee_id HAVING count > 1) SELECT E.employee_id, E.department_id FROM single INNER JOIN Employee E ON single.employee_id = E.employee_id UNION SELECT E.employee_id, E.department_id FROM multi INNER JOIN Employee E ON multi.employee_id = E.employee_id WHERE E.primary_flag = 'Y' "
97,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 "
98,"with temp as ( select employee_id, count(employee_id) as dep from Employee group by employee_id ) select A.employee_id, A.department_id from Employee A left join temp B on A.employee_id = B.employee_id where A.primary_flag = ""Y"" or B.dep = 1.00"
99,"select e.employee_id, case when f.c>1 and e.primary_flag='Y' then e.department_id when f.c=1 then e.department_id end as department_id from employee e left join (select employee_id, department_id, count(primary_flag) as c from employee group by employee_id) f on e.employee_id = f.employee_id having department_id is not null"
100,"select e.employee_id, case when f.c>1 and e.primary_flag='Y' then e.department_id when f.c=1 then e.department_id end as department_id from employee e left join (select employee_id, department_id, count(primary_flag) as c from employee group by employee_id) f on e.employee_id = f.employee_id having department_id is not null"
101,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' OR employee_id in( SELECT employee_id FROM Employee GROUP BY employee_id HAVING count(department_id) = 1) "
102,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
103,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
104,"SELECT employee_id,department_id FROM employee WHERE primary_flag = ""Y"" UNION SELECT employee_id, department_id FROM employee GROUP BY employee_id having count(*) = 1 ORDER BY employee_id"
105,"(select employee_id, department_id from Employee where primary_flag = 'Y') union (select employee_id, department_id from Employee where employee_id not in (select employee_id from Employee where primary_flag = 'Y')) "
106,"(select employee_id, department_id from Employee where primary_flag = 'Y') union (select employee_id, department_id from Employee group by employee_id having count(department_id) = 1)"
107,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag='Y') UNION (SELECT employee_id,department_id FROM Employee GROUP BY employee_id HAVING count(department_id)=1)"
108,"select employee_id, department_id from Employee where primary_flag=""Y"" union select employee_id, department_id from Employee where primary_flag=""N"" and employee_id not in (select employee_id from Employee where primary_flag=""Y"")"
109,"select employee_id, department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(department_id) = 1) "
110,"select DISTINCT E1.employee_id , COALESCE(E2.department_id,E1.department_id) AS department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id AND E1.primary_flag='N' AND E2.primary_flag='Y' "
111,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT DISTINCT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 "
112,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 "
113,"select distinct e1.employee_id, coalesce(e2.department_id, e1.department_id) as department_id from Employee e1 left join Employee e2 on e1.employee_id = e2.employee_id and e1.primary_flag = 'N' and e2.primary_flag = 'Y'"
114,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
115,"WITH cte AS ( SELECT employee_id, (CASE WHEN count(department_id) over (partition by employee_id) = 1 THEN department_id WHEN count(department_id) over (partition by employee_id) > 1 AND primary_flag = 'Y' THEN department_id ELSE 0 END) as department_id FROM employee ) SELECT employee_id, max(department_id) as department_id FROM cte GROUP BY 1"
116,"select employee_id, department_id from Employee where primary_flag='Y' Union select employee_id, department_id from Employee group by 1 having count(department_id)=1"
117,"select e.employee_id, e.department_id from employee e where primary_flag = 'Y' OR (select count(*) from employee where employee_id = e.employee_id) = 1"
118,"SELECT employee_id, MAX(CASE WHEN primary_flag = ""Y"" THEN department_id END) AS department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) > 1 UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) = 1"
119,"select employee_id, department_id from (select employee_id, department_id, primary_flag, count(department_id) over(partition by employee_id) cn from Employee) temp where (cn = 1 and (primary_flag = ""N"" or primary_flag = ""Y"")) or (cn > 1 and primary_flag = ""Y"") "
120,"select employee_id, department_id from ( select employee_id, department_id, row_number() over (partition by employee_id order by case when primary_flag = 'Y' then 1 else 2 end asc) as rn from Employee ) t where rn = 1"
121,"select employee_id,department_id from Employee where primary_flag='Y' or employee_id in (select employee_id from Employee group by employee_id having count(employee_id)=1) "
122,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 "
123,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E1 WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'N' AND NOT EXISTS (SELECT 1 FROM EMPLOYEE E2 WHERE E.EMPLOYEE_ID = E2.EMPLOYEE_ID AND E2.PRIMARY_FLAG = 'Y' )"
124,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY Employee_id HAVING COUNT(*) = 1 "
125,"SELECT distinct employee_id, department_id from( SELECT *, count(department_id) over(partition by employee_id) as d_count from Employee)p1 where (d_count>1 and primary_flag='Y') or (d_count=1)"
126,"select employee_id, department_id from Employee where primary_flag='Y' union select employee_id, department_id from Employee group by employee_id having sum(primary_flag='Y') = 0"
127,"with cte as (select employee_id, department_id from employee group by employee_id having count(department_id)=1) select employee_id, department_id from cte union all select employee_id, department_id from employee where employee_id not in (select employee_id from cte) and primary_flag = 'Y'"
128,"select employee_id, department_id from Employee where employee_id in (select employee_id from Employee group by employee_id having count(employee_id)>1) and primary_flag='Y' union all select employee_id, department_id from Employee where employee_id in (select employee_id from Employee group by employee_id having count(employee_id) = 1)"
129,"select employee_id, department_id from Employee e where primary_flag = 'Y' or (primary_flag = 'N' and employee_id in (select distinct employee_id from Employee group by employee_id having count(department_id) =1))"
130,"select distinct employee_id,department_id from Employee where primary_flag='Y' union select distinct employee_id, department_id from Employee where employee_id not in ( select distinct employee_id from (select distinct employee_id,department_id from Employee where primary_flag='Y')a )"
131,"(SELECT employee_id, department_id from employee group by employee_id HAVING count(distinct department_id) = 1) UNION (SELECT employee_id, department_id from employee WHERE primary_flag ='Y')"
132,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(1) = 1"
133,"select employee_id, department_id from employee group by employee_id having count(employee_id)=1 union select employee_id, department_id from employee where primary_Flag='Y'"
134,"with no_primary as ( select employee_id, department_id, primary_flag from employee group by employee_id having count(employee_id) = 1 and primary_flag = 'N'), yes_primary as ( select distinct employee_id, department_id from Employee where primary_flag = 'Y') select employee_id, department_id from yes_primary union all select employee_id, department_id from no_primary "
135,"select employee_id, department_id from employee where primary_flag = ""Y"" union select employee_id, department_id from employee group by employee_id having count(employee_id) = 1 "
136,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
137,"select employee_id , department_id from employee where primary_flag='Y' union select employee_id , department_id from employee group by employee_id having count(*) =1"
138,"select employee_id,department_id from Employee where primary_flag = 'Y' group by employee_id, primary_flag union select employee_id, department_id from Employee group by employee_id having count(department_id) = 1 "
139,"(select employee_id ,department_id from Employee group by employee_id having count(distinct department_id) =1 ) union (select employee_id ,department_id from Employee where primary_flag =""Y"" group by employee_id) "
140,"(select employee_id, department_id from employee where primary_flag = 'Y') union (select employee_id, department_id from employee group by employee_id having count(department_id) = 1)"
141,"select employee_id,department_id from Employee where primary_flag='Y' union select employee_id,department_id from Employee group by 1 having count(*)=1"
142,"SELECT employee_id , department_id FROM employee WHERE primary_flag = 'Y' UNION SELECT employee_id , department_id FROM employee GROUP BY 1 HAVING COUNT(department_id) = 1"
143,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(primary_flag) = 1 "
144,"select employee_id,department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(department_id) = 1)"
145,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' OR employee_id IN (SELECT employee_id FROM Employee GROUP BY 1 HAVING COUNT(*) = 1 ) "
146,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee WHERE employee_id in ( SELECT employee_id FROM Employee GROUP BY 1 HAVING COUNT(*) = 1)"
147,"(select employee_id, department_id from employee where primary_flag='Y') union (select employee_id, department_id from employee group by 1 having count(*)=1)"
148,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = ""Y"" OR employee_id IN (SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
149,"WITH temp AS ( SELECT *, COUNT(*) OVER(PARTITION BY employee_id ORDER BY employee_id) cnt FROM Employee ) SELECT employee_id, SUM(CASE WHEN cnt=1 OR primary_flag ='Y' THEN department_id ELSE 0 END) department_id FROM temp GROUP BY employee_id"
150,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(*) = 1)"
151,"select employee_id, department_id from employee group by employee_id having count(distinct department_id) = 1 union select employee_id, department_id from employee where primary_flag = 'Y'"
152,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1) "
153,"with cte as (select *, count(department_id) over(partition by employee_id) as ct from Employee) select distinct employee_id, if(ct=1,department_id,if(primary_flag='Y',department_id,null)) as department_id from cte where (ct = 1) or (ct>1 and primary_flag='Y') "
154,"select employee_id, department_id from Employee where primary_flag='Y' union select employee_id, department_id from Employee group by employee_id having count(employee_id)=1"
155,"select employee_id,department_id from employee group by 1 having count(*)=1 union select employee_id,department_id from employee where primary_flag='Y' "
156,"with tmp as (select employee_id, department_id from employee group by employee_id having count(department_id) = 1) select * from tmp union select employee_id, department_id from employee where primary_flag = 'Y'"
157,"select a.employee_id, a.department_id from (select e1.employee_id, e1.department_id, e2.primary_flag from Employee e1 left join Employee e2 on e1.employee_id = e2.employee_id and e1.department_id != e2.department_id and e1.primary_flag !='Y') a where a.primary_flag is null"
158,"select employee_id, department_id from (select employee_id, department_id, primary_flag, count(department_id) over(partition by employee_id) as cn from Employee) temp where (case when cn=1 then primary_flag='Y' or primary_flag='N' when cn>1 then primary_flag='Y' end)"
159,"select E1.employee_id , COALESCE(E2.department_id,E1.department_id) AS department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id and E1.primary_flag='N' and E2.primary_flag='Y' group by e1.employee_id "
160,"SELECT employee_id,department_id FROM Employee WHERE primary_flag='Y' or employee_id in (SELECT employee_id from Employee group by 1 having count(distinct department_id)=1) ORDER BY 1"
161,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in ( select employee_id from Employee group by employee_id having count(employee_id)=1 ) "
162,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
163,"select distinct E1.employee_id, coalesce(E2.department_id, E1.department_id ) as department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id AND E1.primary_flag='N' AND E2.primary_flag='Y' "
164,"(select employee_id, department_id from Employee where primary_flag = 'Y') union (select employee_id, department_id from Employee group by 1 having count(distinct department_id) = 1)"
165,"with cte as ( select employee_id, count(*) ct, max(primary_flag) pf from Employee group by employee_id) , cte1 as ( select * from employee where primary_flag='Y') select distinct c.employee_id, case when ct>1 and pf='Y' then c1.department_id else e.department_id end department_id from cte c inner join employee e on c.employee_id=e.employee_id left join cte1 c1 on c1.employee_id=c.employee_id "
166,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E1 WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'N' AND NOT EXISTS (SELECT 1 FROM EMPLOYEE E2 WHERE E.EMPLOYEE_ID = E2.EMPLOYEE_ID AND E2.PRIMARY_FLAG = 'Y' )"
167,"select employee_id, department_id from ( select employee_id,department_id,primary_flag,count(employee_id) over (partition by employee_id) as c from employee ) A where c = 1 or primary_flag ='Y'"
168,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' GROUP BY employee_id) UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
169,"select employee_id, department_id from( select employee_id, department_id, primary_flag, count(department_id) over (partition by employee_id) as c from Employee) as TMP where primary_flag = 'Y' or c = 1"
170,"select employee_id, department_id from ( select employee_id, department_id, primary_flag, rank() over (partition by employee_id order by primary_flag) as is_primary from employee ) as a where a.is_primary = 1"
171,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' OR employee_id IN ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 ) "
172,"with t as( select employee_id, department_id from Employee group by employee_id having count(department_id)=1 ), tt as ( select employee_id, department_id from Employee where primary_flag='Y' ) select * from t union select * from tt"
173,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) = 1 ORDER BY employee_id, department_id"
174,"select employee_id, case when (count(department_id)> 1 ) then sum( IF( primary_flag = ""Y"",department_id , NULL)) when (count(department_id))= 1 then department_id end department_id from employee group by employee_id "
175,"SELECT employee_id, COALESCE(MAX(CASE WHEN primary_flag = 'Y' THEN department_id ELSE NULL END),department_id) AS department_id FROM Employee GROUP BY employee_id"
176,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y' "
177,"WITH new_employee AS ( SELECT employee_id, department_id, RANK() OVER(PARTITION BY employee_id ORDER BY primary_flag) AS row_rk FROM Employee ) SELECT employee_id, department_id FROM new_employee WHERE row_rk=1"
178,"WITH dep_count as ( SELECT employee_id, COUNT(DISTINCT department_id) FROM Employee GROUP BY 1 HAVING COUNT(DISTINCT department_id) = 1 ) ,multiple_department AS ( SELECT employee_id, department_id FROM Employee WHERE primary_flag ='Y' ), single_department AS ( SELECT employee_id, department_id FROM Employee WHERE employee_id in (SELECT employee_id FROM dep_count) ) SELECT employee_id, department_id from multiple_department UNION SELECT employee_id, department_id from single_department "
179,"Select employee_id, department_id from Employee where primary_flag = 'Y' UNION ALL Select employee_id, department_id from Employee where primary_flag = 'N' AND employee_id not in (Select employee_id from Employee where primary_flag = 'Y') "
180,"select employee_id,department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(department_id) = 1)"
181,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION select employee_id, department_id from Employee where primary_flag = 'Y'"
182,"select employee_id, department_id from employee where primary_flag ='Y' or employee_id in (select employee_id from employee group by employee_id having count(employee_id)=1)"
183,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id, department_id from Employee where employee_id in (select employee_id from Employee group by employee_id having count(*) = 1) "
184,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION select employee_id, department_id from Employee where primary_flag = 'Y'"
185,"WITH CTE AS (SELECT employee_id, department_id FROM employee GROUP BY 1 HAVING COUNT(department_id) = 1 UNION ALL SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' ) SELECT DISTINCT employee_id, department_id from CTE"
186,"select employee_id,department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(department_id) = 1)"
187,"select e1.employee_id, e1.department_id from Employee e1 left join (select employee_id, department_id, primary_flag, count(employee_id) as cnt from Employee group by employee_id) as e2 on e1.employee_id = e2.employee_id where e1.primary_flag = 'Y' or e2.cnt = 1 "
188,"SELECT DISTINCT employee_id, department_id FROM ( SELECT employee_id, department_id FROM Employee WHERE primary_flag = ""Y"" UNION ALL SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING count(*) = 1 ) as a "
189,"select employee_id, department_id from Employee where primary_flag = 'Y' OR employee_id in (select employee_id from Employee group by employee_id having count(*) = 1)"
190,"select employee_id, department_id from employee where primary_flag = 'Y' and employee_id in ( select employee_id from Employee group by employee_id having count(*) > 1) union (select employee_id, department_id from Employee group by employee_id having count(*) = 1)"
191,"SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 UNION SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' "
192,"select distinct employee_id, department_id from ( select employee_id, department_id, primary_flag, count(*) over (partition by employee_id) as total_count from Employee ) a where a.primary_flag='Y' or total_count=1"
193,"select employee_id, department_id from Employee where primary_flag='Y' group by employee_id union select employee_id, department_id from Employee group by employee_id having count(employee_id)=1"
194,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(department_id) = 1"
195,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 "
196,"select employee_id, department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by 1 having count(department_id) = 1)"
197,"WITH temp AS ( SELECT employee_id, department_id, primary_flag, DENSE_RANK() OVER (PARTITION BY employee_id ORDER BY primary_flag) AS my_rank FROM Employee ) SELECT employee_id, department_id FROM temp WHERE my_rank = 1"
198,"select employee_id, department_id from Employee where primary_flag='Y' union select employee_id, department_id from Employee group by employee_id having count(*) = 1"
199,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(employee_id) = 1 "
200,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
201,"SELECT employee_id, department_id FROM (select employee_id, department_id, DENSE_RANK() OVER(partition by employee_id order by primary_flag) AS myrank from employee )t WHERE myrank=1"
202,"(select employee_id, department_id from employee group by 1 having count(department_id) = 1) union (select employee_id, department_id from employee where primary_flag = 'Y')"
203,"select employee_id, department_id from Employee join (select employee_id, count(*) as cnt from Employee group by employee_id) t using(employee_id) where cnt = 1 or primary_flag = 'Y'"
204,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY 1 HAVING COUNT(department_id) =1 "
205,"select employee_id, department_id from (select *, count(employee_id)over(partition by employee_id) as cnt from employee) t where cnt=1 or primary_flag='Y'"
206,"select employee_id,department_id from employee where primary_flag='Y' union select employee_id,department_id from employee where employee_id not in (select employee_id from employee where primary_flag='Y') group by employee_id,department_id having count(*)=1 "
207,"select employee_id,department_id from Employee where primary_flag = 'Y' or employee_id in ( select employee_id from Employee group by employee_id having count(department_id) = 1 ) "
208,"with t as(select employee_id,department_id,row_number()over(partition by employee_id order by primary_flag)rk from Employee) select employee_id, department_id from t where rk = 1 "
209,"select employee_id, department_id from Employee where primary_flag = 'Y' group by employee_id union select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1"
210,"(select employee_id, department_id from Employee where primary_flag = 'Y') union (select employee_id, department_id from Employee group by employee_id having count(*) = 1)"
211,"select distinct a.employee_id, a.department_id from ( select employee_id, department_id from Employee where employee_id in (select employee_id from Employee group by employee_id having count(*) = 1) union all select employee_id, department_id from Employee where primary_flag = 'Y' ) a"
212,"select employee_id, department_id from Employee where primary_flag = 'Y' UNION select employee_id, department_id from Employee group by employee_id having count(primary_flag) = 1 "
213,"select employee_id, case when count(*) = 1 then department_id else sum(if(primary_flag=""Y"",department_id,0)) end as department_id from Employee group by employee_id"
214,"select employee_id,department_id from Employee where primary_flag='Y' UNION ALL select employee_id,department_id from Employee where employee_id not in (select employee_id from Employee where primary_flag='Y')"
215,"Select employee_id, department_id from Employee where primary_flag = 'Y' union Select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1 "
216,"select employee_id, department_id from employee group by employee_id having count(department_id) = 1 union select employee_id, department_id from employee where primary_flag = 'Y'"
217,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(employee_id) = 1) "
218,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 "
219,"select employee_id, department_id from employee where primary_flag='Y' or employee_id in ( select employee_id from employee group by employee_id having count(department_id)=1 )"
220,"SELECT employee_id, department_id FROM (SELECT employee_id, department_id, primary_flag, COUNT(department_id) OVER(PARTITION BY employee_id) cn FROM Employee) temp WHERE (CASE WHEN cn = 1 THEN primary_flag = ""N"" OR primary_flag = ""Y"" WHEN cn > 1 THEN primary_flag = ""Y"" END)"
221,"SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING(COUNT(department_id) = 1) UNION SELECT employee_id, department_id FROM Employee WHERE primary_flag=""Y"" GROUP BY employee_id"
222,"select employee_id, department_id from employee where primary_flag='Y' or employee_id in( select employee_id from employee group by employee_id having count(department_id)=1)"
223,"with t1 as (select employee_id, department_id from employee where primary_flag = 'Y' ) select employee_id, department_id from employee where primary_flag = 'N' and employee_id not in (select employee_id from t1) union all select * from t1 order by employee_id "
224,"select b.employee_id,b.department_id from Employee b where b.primary_flag='Y' or( b.primary_flag='N' and b.employee_id in (select a.employee_id from Employee a group by a.employee_id having count(*)=1) ) group by b.employee_id"
225,"WITH single AS(SELECT employee_id as employee_id, department_id as department_id FROM Employee GROUP BY employee_id HAVING count(employee_id)=1), multi AS( SELECT employee_id as employee_id, department_id as department_id FROM Employee WHERE primary_flag = 'Y' ) SELECT employee_id, department_id FROM single UNION SELECT employee_id, department_id FROM multi"
226,"select a.employee_id, MAX(CASE WHEN cnt = 1 THEN a.department_id WHEN cnt > 1 and a.primary_flag = 'Y' THEN a.department_id END) 'department_id' from employee a inner join (select employee_id, count(*) 'cnt' from employee group by 1) b on a.employee_id = b.employee_id group by 1 "
227,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
228,"select employee_id, department_id from Employee as e1 where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(department_id) = 1) "
229,"WITH single_dept AS ( SELECT employee_id, department_id FROM employee GROUP BY employee_id HAVING COUNT(*) = 1 ) SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT * FROM single_dept"
230,"SELECT employee_id , department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id , department_id FROM Employee group by employee_id HAVING COUNT(employee_id) = 1 "
231,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(*) = 1) order by employee_id"
232,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(department_id) = 1"
233,"with temp as ( select employee_id, count(department_id) from Employee group by employee_id having count(department_id) =1 ) select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from temp) "
234,"select employee_id,department_id from employee where primary_flag='Y' or employee_id in (select employee_id from employee group by employee_id having count(department_id)=1) "
235,"select employee_id,department_id from Employee group by employee_id having count(employee_id)=1 union select employee_id,department_id from Employee where primary_flag=""Y"" group by employee_id "
236,"SELECT employee_id, department_id FROM Employee WHERE employee_id IN ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1 ) OR primary_flag = 'Y' ORDER BY employee_id"
237,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' GROUP BY employee_id) UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
238,"(SELECT employee_id, department_id from employee group by employee_id HAVING count(distinct department_id) = 1) UNION (SELECT employee_id, department_id from employee WHERE primary_flag ='Y')"
239,"select employee_id,department_id from employee where primary_flag = 'Y' OR employee_id in (select employee_id from employee group by employee_id having count(*)=1) "
240,"SELECT employee_id,department_id FROM Employee wHERE primary_flag='Y' UNION SELECT employee_id,department_id FROM Employee WHERE employee_id IN (SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id)=1)"
241,"with cte as ( select employee_id from employee group by 1 having(count(distinct department_id))=1 ) select employee_id,department_id from employee where primary_flag='Y' union select e.employee_id,e.department_id from cte join employee e on cte.employee_id=e.employee_id "
242,"SELECT employee_id, department_id FROM Employee WHERE (primary_flag='Y') UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id)=1 ORDER BY employee_id"
243,"with new as (select employee_id, department_id from employee where primary_flag ='Y') select distinct e.employee_id, ifnull(n.department_id,e.department_id) as department_id from employee e left join new n on e.employee_id=n.employee_id"
244,"select employee_id,department_id from Employee where primary_flag='Y' Union select employee_id, department_id from Employee group by employee_id having count(department_id)=1 "
245,"select employee_id, department_id from Employee where primary_flag='Y' union select employee_id, department_id from Employee where employee_id not in (select employee_id from Employee where primary_flag='Y')"
246,"select employee_id, department_id from (select * , count(department_id) over(partition by employee_id) as num_dep from Employee) as a where primary_flag = 'Y' or num_dep = 1 "
247,"SELECT employee_id, department_id FROM employee WHERE primary_flag = 'Y' OR employee_id IN ( SELECT employee_id FROM employee GROUP BY employee_id HAVING COUNT(department_id) = 1 ) "
248,"SELECT employee_id, if(count(department_id)=1, department_id, sum(if(primary_flag='Y',1,0)*department_id)) as department_id FROM Employee GROUP BY employee_id"
249,"with t as ( select employee_id , sum(case when primary_flag = 'Y' then department_id else 0 end ) department_id from employee group by employee_id having count(*) > 1 ) select employee_id, department_id from employee group by employee_id having count(*) = 1 union select * from t "
250,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1"
251,"SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1 UNION SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y'"
252,"select employee_id, department_id from Employee where employee_id in (select employee_id from Employee group by employee_id having count(*)=1 ) union select employee_id, department_id from Employee where primary_flag = 'Y'"
253,"SELECT employee_id, department_id FROM( SELECT employee_id, department_id,primary_flag, COUNT(department_id) OVER(PARTITION BY employee_id) as num_dept FROM Employee )a WHERE primary_flag='Y' or num_dept=1 "
254,"WITH ETC AS( SELECT *, COUNT(department_id) OVER(PARTITION BY employee_id) cnt FROM Employee ) SELECT employee_id, department_id FROM ETC WHERE cnt = 1 OR primary_flag = 'Y'"
255,"select employee_id, department_id from employee group by employee_id having count(distinct department_id) = 1 union select employee_id, department_id from employee where primary_flag = 'Y' "
256,"select DISTINCT E1.employee_id , COALESCE(E2.department_id,E1.department_id) AS department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id AND E1.primary_flag='N' AND E2.primary_flag='Y'"
257,"select employee_id , department_id from Employee group by employee_id having count(*)=1 union select employee_id , department_id from Employee where primary_flag ='Y' "
258,"with mult as ( select employee_id from employee group by employee_id having count(*) > 1 ) select employee_id, department_id from employee group by employee_id having count(*) = 1 union all select e.employee_id, e.department_id from mult as m inner join employee as e on m.employee_id = e.employee_id where primary_flag = 'Y' "
259,"select employee_id, department_id from Employee where primary_flag = 'Y' OR employee_id in (select employee_id from Employee group by employee_id having count(*) = 1)"
260,"SELECT employee_id, department_id FROM Employee e WHERE primary_flag = 'Y' or employee_id in ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING count(department_id) = 1 )"
261,"with a as (select employee_id, department_id, primary_flag from Employee group by employee_id having count(department_id) =1), b as (select employee_id, department_id, primary_flag, count(department_id) from Employee where primary_flag ='Y' group by employee_id) select a.employee_id, a.department_id from a union select b.employee_id, b.department_id from b "
262,"select employee_id, department_id from Employee where employee_id in ( select employee_id from Employee group by employee_id having count(department_id) < 2 ) union select employee_id, department_id from Employee where primary_flag = 'Y'"
263,"SELECT employee_id , department_id FROM ( SELECT employee_id, department_id, DENSE_RANK() OVER(PARTITION BY employee_id ORDER BY primary_flag) AS rnk FROM employee) r WHERE rnk = 1 "
264,"select employee_id, department_id from ( select employee_id, department_id, max(primary_flag) over (partition by employee_id ) as last_flag, primary_flag from Employee order by 1 ) temp where (primary_flag = 'Y') or (last_flag = 'N') order by 1"
265,"with cte as ( select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1) select distinct employee_id, department_id from Employee where primary_flag = 'Y' UNION select * from cte"
266,"select a.employee_id, a.department_id from employee a inner join (select employee_id, count(distinct primary_flag) as cn from employee group by employee_id) as b on a.employee_id = b.employee_id where (b.cn = 1) or (b.cn > 1 and primary_flag = 'Y') "
267,"with cte as( select employee_id, department_id from employee where primary_flag = 'Y') select employee_id, department_id from employee where employee_id not in (select employee_id from cte) union select * from cte"
268,"select employee_id , department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(employee_id) = 1)"
269,"select t2.employee_id, t2.department_id from ( select t1.*, (select count(distinct t3.department_id) from employee t3 where t1.employee_id = t3.employee_id) as num_dept from employee t1 ) t2 where num_dept = 1 or (num_dept > 1 and primary_flag = 'Y')  "
270,"select employee_id, department_id from employee where primary_flag =""Y"" union select employee_id, department_id from employee group by employee_id having count(department_id)=1 "
271,"SELECT employee_id, department_id FROM( SELECT employee_id, department_id, primary_flag, COUNT(department_id) OVER(PARTITION BY employee_id) as num_depts FROM employee )a WHERE primary_flag='Y' or num_depts=1"
272,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
273,"(SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(DISTINCT department_id) = 1) UNION (SELECT employee_id, department_id FROM Employee WHERE primary_flag=""Y"")"
274,"select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1 union select employee_id, department_id from Employee where primary_flag = 'Y' "
275,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
276,"select employee_id, department_id from Employee group by 1 having count(distinct department_id) = 1 union select employee_id, department_id from Employee where primary_flag ='Y' "
277,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id, department_id from Employee group by employee_id having count(department_id) = 1"
278,"with emp as ( select employee_id, department_id, primary_flag, count(*) over(partition by employee_id) cnt from employee ) select employee_id, department_id from emp where (primary_flag='Y' and cnt>1) or cnt=1 "
279,"SELECT employee_id, department_id FROM employee GROUP BY employee_id HAVING count(*) = 1 UNION SELECT employee_id, department_id FROM employee WHERE primary_flag = ""Y"" AND employee_id NOT IN (SELECT employee_id FROM employee GROUP BY employee_id HAVING count(*) = 1)"
280,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
281,"select employee_id, department_id from employee where primary_flag = 'Y' or (primary_flag = 'N' and employee_id not in (select employee_id from employee where primary_flag = 'Y' ) ) "
282,"Select employee_id,department_id from Employee where primary_flag = 'Y' or employee_id in ( Select employee_id from Employee group by employee_id having count(department_id) = 1 ) "
283,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING count(employee_id) = 1"
284,"select T.employee_id, T.department_id from ( select *, count(employee_id) over (partition by employee_id) c from Employee ) T where T.c=1 OR T.primary_flag='Y'"
285,"WITH lookup AS ( SELECT employee_id, department_id, COUNT(department_id) AS flag FROM Employee GROUP BY employee_id ) SELECT Employee.employee_id, Employee.department_id FROM Employee LEFT JOIN lookup ON Employee.employee_id = lookup.employee_id WHERE primary_flag = 'Y' OR flag = 1 "
286,"select employee_id, department_id from Employee group by employee_id having count(distinct department_id) = 1 union select employee_id, department_id from Employee where primary_flag = 'Y'"
287,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1)"
288,"(select employee_id, department_id from employee group by employee_id having count(department_id) = 1) union (select employee_id, department_id from employee where primary_flag = 'Y' )"
289,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
290,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 union select employee_id, department_id from Employee where primary_flag = 'Y'"
291,"select employee_id, department_id from employee where primary_flag=""Y"" union select employee_id, department_id from employee group by employee_id having count(department_id)=1"
292,"select employee_id, department_id from Employee where primary_flag = ""Y"" or employee_id in (select employee_id from Employee group by employee_id having count(department_id) = 1 order by employee_id)"
293,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' or employee_id in ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING count(department_id) = 1 )"
294,"Select employee_id, department_id from Employee where primary_flag= 'Y' union Select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1 "
295,"select employee_id, department_id from ( select employee_id, department_id, primary_flag, sum(1) over(partition by employee_id) as dept_cnt from employee ) x where primary_flag = 'Y' or dept_cnt = 1 order by 1"
296,"select employee_id,department_id from employee where primary_flag='Y' union select employee_id,department_id from employee group by employee_id having count(department_id)=1 "
297,"select employee_id, department_id from Employee where primary_flag = 'Y' union all select employee_id, department_id from Employee where primary_flag = 'N' and employee_id in ( select employee_id from Employee group by 1 having count(*) = 1 ) "
298,"with cte as( select *, rank() over(partition by employee_id order by primary_flag asc) 'rnk' from employee) select employee_id, department_id from cte where rnk = 1 "
299,"with cte as (select *, row_number() over (partition by employee_id order by primary_flag) as r from employee) select employee_id, department_id from cte where r = 1"
300,"select employee_id, case when count(*) = 1 then department_id else sum(if(primary_flag=""Y"",department_id,0)) end as department_id from Employee group by employee_id"
301,"with dept as( select employee_id from employee group by employee_id having count(*)=1 ) select dept.employee_id, e1.department_id from employee e1 join dept on e1.employee_id=dept.employee_id union select employee_id, department_id from employee where primary_flag='Y'"
302,"select employee_id , max(department_id) as department_id from Employee group by employee_id having count(1) = 1 union select employee_id , department_id from Employee where primary_flag = 'Y'"
303,"select employee_id, department_id from Employee where primary_flag='Y' or employee_id in (select employee_id from Employee group by employee_id having count(Department_id)=1)"
304,"select distinct employee_id, department_id from employee where primary_flag='Y' union all select distinct employee_id, department_id from employee where primary_flag='N' and employee_id not in (select distinct employee_id from employee where primary_flag='Y')  "
305,"select employee_id, department_id from employee where employee_id in ( select employee_id from employee group by 1 having count(department_id) = 1 ) union select employee_id, department_id from employee where primary_flag = 'Y' "
306,"(SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') union (select employee_id, department_id from Employee group by employee_id having count(*) = 1 )"
307,"select employee_id, department_id from employee where primary_flag='Y' union select employee_id, department_id from employee where employee_id in (select employee_id from employee group by employee_id having count(department_id)=1)"
308,"select employee_id, department_id from Employee where primary_flag=""Y"" or employee_id in (select employee_id from Employee group by employee_id having count(*)=1)"
309,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' OR employee_id IN (SELECT employee_id FROM (SELECT employee_id, COUNT(department_id) AS ""dpt_count"" FROM Employee GROUP BY employee_id) AS DptCount WHERE dpt_count = 1)"
310,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(employee_id) = 1)"
311,"select employee_id, department_id from ( select employee_id, department_id, rank() over(partition by employee_id order by primary_flag ASC) '_rank' from Employee ) tbl where tbl._rank = 1"
312,"with temp as( select *, count(department_id) as cnt from employee group by employee_id), temp1 as(select employee_id, department_id from temp where cnt=1), temp2 as(select employee_id, department_id from Employee where primary_flag=""Y"") select * from temp1 union select * from temp2"
313,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' OR employee_id NOT IN (SELECT employee_id FROM Employee WHERE primary_flag = 'Y') "
314,"Select employee_id, department_id from employee where primary_flag = 'Y' UNION Select employee_id, department_id from employee Group by employee_id Having count(employee_id)=1 "
315,"select employee_id, department_id from employee group by employee_id having count(department_id)=1 union select employee_id, department_id from employee where primary_flag='Y' "
316,"select employee_id, department_id from employee where primary_flag = ""Y"" union select employee_id, department_id from employee group by employee_id having count(employee_id) = 1 "
317,"select employee_id, department_id from Employee where employee_id in (select employee_id from Employee group by employee_id having count(*)=1 ) union select employee_id, department_id from Employee where primary_flag = 'Y'"
318,"with cte as (select employee_id, department_id, primary_flag, count(employee_id) over (partition by employee_id) as counter from Employee) select employee_id, department_id from cte where counter = 1 union select employee_id, department_id from cte where counter > 1 and primary_flag = 'Y'"
319,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee where primary_flag = 'N' and employee_id not in (select employee_id from employee where primary_flag = 'Y' )"
320,"SELECT employee_id, department_id FROM Employee WHERE primary_flag='Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*)=1"
321,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(employee_id) = 1"
322,"(SELECT DISTINCT employee_id, department_id FROM Employee WHERE primary_flag = 'Y') UNION (SELECT DISTINCT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id) = 1) ORDER BY employee_id"
323,"select employee_id, department_id from Employee group by employee_id having count(*) = 1 UNION select employee_id, department_id from Employee where primary_flag = 'Y' "
324,"SELECT employee_id, department_id FROM (SELECT employee_id, department_id, DENSE_RANK() OVER(partition by employee_id order by primary_flag ) as rk FROM Employee e )AS temp WHERE rk =1 "
325,"(select a.employee_id, b.department_id from (select employee_id from Employee group by employee_id having count(*)=1) a left join Employee b on a.employee_id=b.employee_id) union (select employee_id,department_id from Employee where primary_flag='Y')"
326,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(*) = 1) order by employee_id"
327,"WITH t1 AS ( SELECT *, ( SELECT IF( COUNT(DISTINCT department_id) = 1 ,1,0) FROM Employee e2 WHERE e2.employee_id = e1.employee_id ) AS only_in_one_department FROM Employee e1 ), t2 AS ( SELECT employee_id, department_id FROM t1 WHERE primary_flag = 'Y' OR only_in_one_department ) SELECT * FROM t2"
328,"select employee_id, department_id from (select employee_id, department_id, rank()over(partition by employee_id order by primary_flag ) as flag_rank from employee)t where flag_rank = 1"
329,"select employee_id ,department_id from Employee where primary_flag='Y' union Select employee_id , department_id from Employee group by employee_id having count(*)=1 "
330,"SELECT employee_id, department_id FROM Employee WHERE employee_id IN ( SELECT employee_id FROM Employee GROUP BY employee_id HAVING COUNT( employee_id ) = 1 ) || primary_flag = 'Y'"
331,"SELECT employee_id, department_id FROM employee GROUP BY employee_id HAVING count(department_id) = 1 UNION SELECT employee_id, department_id FROM employee WHERE primary_flag = 'Y'"
332,"WITH CTE AS ( SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION ALL SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) = 1 ) SELECT DISTINCT employee_id, department_id FROM CTE"
333,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee where employee_id in ( select employee_id from employee group by employee_id having count(department_id) = 1) "
334,"select employee_id, department_id from employee where primary_flag = 'Y' or employee_id in (select employee_id from employee group by employee_id having count(employee_id) = 1) "
335,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(employee_id) = 1"
336,"SELECT employee_id, department_id FROM Employee WHERE primary_flag='Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(department_id)=1"
337,"with temp1 as ( select employee_id, department_id, count(employee_id) cnt from Employee group by 1 ), temp2 as ( select * from employee where employee_id not in (select employee_id from temp1 where cnt=1 ) and primary_flag =""Y"" ) (select employee_id, department_id from temp1 where cnt =1) union (select employee_id, department_id from temp2)"
338,"select e1.employee_id, e1.department_id from Employee e1 left join (select employee_id, department_id, primary_flag, count(employee_id) as cnt from Employee group by employee_id) as e2 on e1.employee_id = e2.employee_id where e1.primary_flag = 'Y' or e2.cnt = 1"
339,"SELECT employee_id, department_id FROM employee group by 1 having count(department_id) = 1 union SELECT employee_id, department_id FROM employee WHERE primary_flag = 'Y'"
340,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' OR employee_id IN (SELECT employee_id FROM (SELECT employee_id, COUNT(*) AS cnt FROM Employee GROUP BY employee_id) AS t1 WHERE cnt = 1)  "
341,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1)"
342,"select employee_id ,department_id from Employee where primary_flag = ""Y"" union select employee_id ,department_id from Employee group by employee_id having count(department_id) = 1"
343,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1 "
344,"select employee_id, department_id from Employee where primary_flag = 'Y' group by employee_id union select employee_id, department_id from Employee group by employee_id having count(department_id) = 1"
345,"select employee_id, department_id from Employee Where primary_flag = 'Y' OR employee_id in (Select employee_id from Employee Group by employee_id HAVING COUNT(employee_id) = 1) "
346,"select employee_id, department_id from employee where primary_flag = 'Y' or employee_id in ( select employee_id from( select employee_id, count(department_id) as count from employee group by employee_id having count(department_id) = 1 ) d) "
347,"select employee_id, department_id from (select *, count(employee_id) over(partition by employee_id) c from Employee) t where c = 1 or primary_flag = 'Y'"
348,"(SELECT employee_id, department_id from employee group by employee_id HAVING count(distinct department_id) = 1) UNION (SELECT employee_id, department_id from employee WHERE primary_flag ='Y')"
349,"select employee_id, department_id from employee where primary_flag = 'Y' union select employee_id, department_id from employee group by employee_id having count(*) = 1"
350,"with y as ( select employee_id, department_id from employee where primary_flag = 'Y' ), n as ( select employee_id, department_id from employee where employee_id not in (select employee_id from y) ) select distinct employee_id, department_id from y union select distinct employee_id, department_id from n"
351,"select a.employee_id, a.department_id from (select e1.employee_id, e1.department_id, case when e2.primary_flag is null then 'null' else e2.primary_flag end as primary_flag_v1 from Employee e1 left join Employee e2 on e1.employee_id = e2.employee_id and e1.department_id != e2.department_id and e1.primary_flag !='Y') a where a.primary_flag_v1 = 'null' "
352,"SELECT employee_id, department_id FROM Employee WHERE primary_flag = 'Y' UNION SELECT employee_id, department_id FROM Employee GROUP BY employee_id HAVING COUNT(*) = 1 "
353,"select employee_id, department_id from (select employee_id, department_id, primary_flag, count(1) over(partition by employee_id) as cnt from Employee) t where cnt = 1 or (cnt>1 and primary_flag = 'Y')"
354,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count(*) = 1) order by employee_id"
355,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
356,"select employee_id , department_id from employee where employee_id in ( select employee_id from employee group by 1 having count(distinct department_id) = 1 ) union select employee_id , department_id from employee where primary_flag = 'Y'"
357,"select employee_id ,department_id from Employee where primary_flag = 'Y' union select a.employee_id ,a.department_id from employee a inner join (select employee_id from employee group by employee_id having sum(1) = 1) b on a.employee_id = b.employee_id"
358,"select DISTINCT E1.employee_id , COALESCE(E2.department_id,E1.department_id) AS department_id from Employee E1 LEFT JOIN Employee E2 ON E1.employee_id=E2.employee_id AND E1.primary_flag='N' AND E2.primary_flag='Y'"
359,"select employee_id, department_id from Employee where primary_flag = 'Y' union select employee_id, department_id from Employee group by employee_id having count(employee_id) = 1"
360,"select employee_id, department_id from Employee where primary_flag = 'Y' or employee_id in (select employee_id from Employee group by employee_id having count( distinct primary_flag)=1 )"
361,"with E1 as ( select employee_id, department_id from Employee where primary_flag='Y' ), E2 as ( select employee_id, department_id from Employee where employee_id not in (select employee_id from E1) ) select employee_id, department_id from E1 union all select employee_id, department_id from E2 "
362,"(Select employee_id, department_id From Employee where primary_flag = ""Y"" ) UNION (Select employee_id, department_id From Employee Group by employee_id Having count(department_id) = 1) "
