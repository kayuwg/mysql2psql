id,original query
1,"select if(from_id<to_id,from_id,to_id)as person1, if(from_id>to_id,from_id,to_id)as person2, count(*)as call_count, sum(duration)as total_duration from calls group by person1, person2"
2,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
3,"with cte as ( select from_id as person1, to_id as person2, duration from calls union all select to_id as person1, from_id as person2, duration from calls ) SELECT PERSON1 AS person1,PERSON2 AS person2,COUNT(PERSON1) as call_count,SUM(DURATION) as total_duration FROM CTE WHERE PERSON1 < PERSON2 GROUP BY PERSON1,PERSON2"
4,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ((select from_id as person1, to_id as person2, duration from Calls where from_id < to_id) union all (select to_id as person1, from_id as person2, duration from Calls where from_id > to_id)) as tb group by person1, person2"
5,"with cte1 as ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from cte1 group by from_id,to_id"
6,"with CTE as ( select case when from_id<to_id then from_id else to_id end as from_id, case when from_id>to_id then from_id else to_id end as to_id,duration from calls ) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from CTE group by from_id,to_id "
7,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select case when from_id > to_id then to_id else from_id end as person1, case when from_id < to_id then to_id else from_id end as person2, duration from calls )temp group by person1, person2 "
8,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1, to_id as person2, duration from Calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from Calls where from_id>to_id ) t1 group by 1,2 "
9,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, count(duration) as call_count, sum(duration) as total_duration FROM Calls GROUP BY person1, person2"
10,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
11,"SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM( SELECT duration, CASE WHEN from_id<to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id>to_id THEN from_id ELSE to_id END AS person2 FROM Calls) AS sub1 GROUP BY person1, person2  "
12,"select case when from_id>to_id then to_id else from_id end as person1, case when from_id>to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person2, person1"
13,"with temp1 as ( select case when from_id < to_id then from_id else to_id end as person1, case when from_id> to_id then from_id else to_id end as person2, duration from calls) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from temp1 group by person1, person2"
14,"with cte as( select case when from_id < to_id then from_id else to_id end as from_id, case when from_id > to_id then from_id else to_id end as to_id, duration from calls) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2"
15,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
16,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration from calls group by person2, person1"
17,"select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2"
18,"SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY LEAST(from_id, to_id), GREATEST(from_id, to_id)"
19,"WITH getCalls AS( SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id > to_id UNION ALL SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id ) SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM getCalls GROUP BY 1,2 ORDER BY 1,2"
20,"SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, count(*) as call_count, sum(duration) as total_duration FROM Calls GROUP BY person1, person2 "
21,"select LEAST(from_id, to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
22,"select least(from_id,to_id)person1, greatest(from_id,to_id)person2, COUNT(*) AS call_count, sum(duration) total_duration from Calls group by 1,2 order by 1,2"
23,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
24,"WITH TEMP AS( SELECT * FROM Calls UNION ALL SELECT to_id as from_id, from_id as to_id, duration FROM Calls) SELECT from_id as person1, to_id as person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM TEMP GROUP BY 1,2 HAVING from_id < to_id"
25,"SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(c.duration) as total_duration FROM calls c GROUP BY 1,2 "
26,"SELECT sub.person1, sub.person2, COUNT(*) AS call_count, SUM(sub.duration) AS total_duration FROM (SELECT from_id AS person1, to_id AS person2, duration FROM Calls UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls) sub GROUP BY sub.person1, sub.person2 HAVING sub.person1 < sub.person2"
27,"SELECT a.from_id AS person1, a.to_id AS person2, COUNT(*) AS call_count, SUM(a.duration) AS total_duration FROM (SELECT (CASE WHEN c.from_id<c.to_id THEN c.from_id ELSE c.to_id END) as from_id, (CASE WHEN c.from_id<c.to_id THEN c.to_id ELSE c.from_id END) AS to_id, c.duration FROM calls c) AS a GROUP BY a.from_id, a.to_id "
28,"with cte as ( select * from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(1) call_count, sum(duration) total_duration from cte group by 1, 2"
29,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
30,"SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls GROUP BY person1,person2"
31,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN to_id > from_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM calls GROUP BY CASE WHEN from_id < to_id THEN from_id ELSE to_id END, CASE WHEN to_id > from_id THEN to_id ELSE from_id END "
32,"SELECT CASE WHEN from_id<to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id<to_id THEN to_id ELSE from_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
33,"select from_id as person1, to_id as person2, count(case when from_id < to_id then concat(from_id, to_id) else 0 end) as call_count, sum(duration) as total_duration from Calls where case when from_id < to_id then concat(from_id, to_id) when to_id < from_id then concat(to_id, from_id) end group by case when from_id < to_id then concat(from_id, to_id) when to_id < from_id then concat(to_id, from_id) end"
34,"WITH tb1 AS( SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(*) call_count, SUM(duration) total_duration FROM tb1 GROUP BY person1, person2 "
35,"with tab as ( select * from calls union all select to_id as from_id,from_id as to_id, duration from calls ) select from_id as person1, to_id as person2, count(from_id) as call_count, sum(duration) as total_duration from tab where from_id < to_id group by 1,2 order by 1,2"
36,"SELECT IF(from_id<to_id,from_id,to_id) person1, IF(from_id>to_id,from_id,to_id) person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY IF(from_id<to_id,from_id,to_id), IF(from_id>to_id,from_id,to_id)"
37,"SELECT DISTINCT PERSON1, PERSON2, COUNT(C.DURATION) AS CALL_COUNT, SUM(C.DURATION) AS TOTAL_DURATION FROM (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS) C GROUP BY PERSON1, PERSON2 ORDER BY PERSON1"
38,"select from_id as person1, to_id as person2, count(1) as call_count,sum(duration) as total_duration from (select from_id as from_id, to_id as to_id, duration from calls where from_id<to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id>to_id ) as t group by from_id,to_id"
39,"select id1 as person1, id2 as person2, count(duration) as call_count, sum(duration) as total_duration from ( select from_id as id1, to_id as id2, duration from calls union all select to_id as id1, from_id as id2, duration from calls) as temp where id1<id2 group by id1, id2"
40,"select t2.person1 as Person1, t2.person2 as Person2, count(*) as call_count, sum(t2.duration) as total_duration from (SELECT IF(from_id < to_id, from_id, to_id) as person1 , IF(from_id > to_id, from_id, to_id) as person2 , duration from Calls) as t2 group by t2.person1, t2.person2 "
41,"SELECT CASE WHEN to_id > from_id THEN from_id ELSE to_id END AS person1, CASE WHEN to_id > from_id THEN to_id ELSE from_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM calls GROUP BY person1 , person2"
42,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
43,"WITH t AS (SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END as person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END as person2, duration FROM calls) SELECT person1, person2, count(*) as call_count, sum(duration) as total_duration FROM t GROUP BY 1,2"
44,"select a.person1, a.person2, count(*) as call_count, sum(a.duration) as total_duration from ( select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, duration from calls ) a group by a.person1, a.person2 "
45,"select distinct person1, person2, count(duration) as call_count, sum(duration)as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls )a where person1<person2 group by person1, person2"
46,"WITH cte_summary AS ( SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE to_id < from_id ) SELECT person1, person2, COUNT(1) AS call_count, SUM(duration) AS total_duration FROM cte_summary GROUP BY person1, person2"
47,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls group by 1, 2"
48,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY 1,2"
49,"select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, count(to_id) as call_count, sum(duration) as total_duration from Calls group by 1,2 order by 1,2 "
50,"select temp.from_id as person1, temp.to_id as person2, count(temp.from_id) as call_count, sum(temp.duration) as total_duration from (select from_id , to_id,duration from calls union all select to_id as from_id,from_id as to_id, duration from calls) as temp where temp.from_id<temp.to_id group by temp.from_id,temp.to_id"
51,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2"
52,"SELECT DISTINCT PERSON1, PERSON2, COUNT(C.DURATION) AS CALL_COUNT, SUM(C.DURATION) AS TOTAL_DURATION FROM (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS) C GROUP BY PERSON1, PERSON2 ORDER BY PERSON1 "
53,"select case when from_id<to_id then from_id else to_id end as person1, case when from_id>to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2"
54,"SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM( SELECT IF(from_id < to_id, from_id, to_id) AS person1, IF(from_id > to_id, from_id, to_id) AS person2, duration FROM Calls ) tmp GROUP BY 1, 2"
55,"SELECT LEAST(from_id,to_id) AS person1, GREATEST (from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM calls GROUP BY person1,person2"
56,"select distinct person1, person2, count(duration) as call_count, sum(duration)as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls )a where person1<person2 group by person1, person2"
57,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
58,"with temp as ( select case when from_id<to_id then from_id else to_id end as person1, case when to_id>from_id then to_id else from_id end as person2, duration from calls ) select person1, person2, count(*) as call_count, sum(duration)as total_duration from temp group by 1, 2 "
59,"with a as( SELECT * FROM Calls UNION ALL SELECT to_id from_id, from_id to_id, duration FROM Calls) SELECT from_id person1, to_id person2, COUNT(*) call_count, SUM(duration) total_duration FROM a GROUP BY person1, person2 HAVING person1 < person2"
60,"select if(from_id < to_id, from_id, to_id) as person1 , if(from_id > to_id, from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by 1, 2 "
61,"select A.person1, A.person2, count(duration) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1,from_id as person2, duration from Calls) as A where A.person1<A.person2 group by 1,2"
62,"with cte as ( select * from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(1) call_count, sum(duration) total_duration from cte group by 1, 2 "
63,"with cte as( select (case when from_id < to_id then from_id else to_id end) as person1, (case when from_id > to_id then from_id else to_id end) as person2, duration from calls ) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by 1,2"
64,"with t as (select from_id, to_id, count(duration) as call_count, sum(duration) as total_duration from calls group by from_id, to_id) select distinct if(t1.from_id < t1.to_id, t1.from_id, t1.to_id) person1, if(t1.from_id < t1.to_id, t1.to_id, t1.from_id) person2, if(t2.from_id is null, t1.call_count, t1.call_count + t2.call_count) as call_count, if(t2.from_id is null, t1.total_duration, t1.total_duration + t2.total_duration) as total_duration from t t1 left join t t2 on t1.from_id = t2.to_id and t1.to_id = t2.from_id "
65,"SELECT person1, person2, COUNT(1) AS call_count, SUM(duration) AS total_duration FROM ( SELECT CASE WHEN (from_id < to_id) THEN from_id ELSE to_id END AS person1, CASE WHEN (from_id < to_id) THEN to_id ELSE from_id END AS person2, duration FROM Calls ) AS CallsProcessed GROUP BY person1, person2 "
66,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
67,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
68,"WITH CTE1 AS ( SELECT from_id, to_id, duration FROM calls UNION ALL SELECT to_id, from_id, duration FROM calls ) SELECT from_id as person1, to_id as person2, COUNT(*) as call_count, SUM(duration) total_duration FROM CTE1 WHERE from_id<to_id GROUP BY from_id, to_id "
69,"select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(1) as call_count, sum(duration) as total_duration from calls group by person1, person2  "
70,"select case when from_id < to_id then from_id else to_id end ""person1"", case when from_id > to_id then from_id else to_id end ""person2"", count(*) ""call_count"", sum(duration) ""total_duration"" from calls group by 1, 2 "
71,"select from_id as person1, to_id as person2, count(*) as call_count, sum(duration)as total_duration from (select to_id as from_id,from_id as to_id,duration from calls where from_id >to_id union all select from_id,to_id ,duration from calls where from_id < to_id)t group by 1,2 order by person1"
72,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2"
73,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
74,"select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(1) as call_count, sum(duration) as total_duration from calls group by person1, person2  "
75,"SELECT from_id as person1, to_id as person2, count(*) as call_count, SUM(duration) as total_duration FROM (SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) as from_id, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) as to_id, duration FROM Calls) t GROUP BY from_id, to_id "
76,"select case when c.from_id < c.to_id then c.from_id else c.to_id end as person1, case when c.from_id > c.to_id then c.from_id else c.to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls c group by person1, person2"
77,"with pairs as ( select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by from_id, to_id union select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by from_id, to_id ) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from pairs where person1 < person2 group by person1, person2"
78,"select LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1,2"
79,"select from_id as person1, to_id as person2,count(*) as call_count,sum(duration) as total_duration from ( select case when from_id > to_id then to_id else from_id end as from_id, case when from_id > to_id then from_id else to_id end as to_id, duration from Calls ) temp group by from_id,to_id"
80,"with t1 as( select * from calls where from_id<to_id union all select to_id as 'from_id', from_id as 'to_id', duration from calls where from_id>to_id ) select from_id as 'person1', to_id as 'person2', count(from_id) as 'call_count', sum(duration) as 'total_duration' from t1 group by 1,2 "
81,"SELECT DISTINCT Person1, person2, SUM(call_count) AS call_count,SUM( total_duration) total_duration FROM( SELECT DISTINCT from_id AS person1 , to_id AS person2 ,COUNT(*) call_count ,SUM(duration) total_duration FROM Calls WHERE from_id< to_id GROUP BY from_id, to_id UNION ALL SELECT DISTINCT to_id AS person1 , from_id AS person2 ,COUNT(*) call_count ,SUM(duration) total_duration FROM Calls WHERE from_id> to_id GROUP BY from_id, to_id) AS f GROUP BY person1, person2"
82,"WITH TEMP AS (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS C) SELECT DISTINCT PERSON1, PERSON2, COUNT(DURATION) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM TEMP GROUP BY PERSON1, PERSON2 "
83,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
84,"Select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from (Select * from calls union all Select to_id as from_id, from_id as to_id, duration from calls) a where from_id < to_id group by from_id,to_id"
85,"with t as ( select from_id as p1, to_id as p2, duration from calls where to_id > from_id union all select to_id as p1, from_id as p2, duration from calls where to_id < from_id ) select p1 as person1, p2 as person2, count(*) as call_count, sum(t.duration) as total_duration from t group by person1, person2 "
86,"WITH reorder_tb AS ( SELECT IF(from_id < to_id, from_id, to_id) AS person1, IF(from_id < to_id, to_id, from_id) AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM reorder_tb GROUP BY person1, person2"
87,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
88,"with temp as (select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from temp group by from_id, to_id"
89,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2 "
90,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id < to_id union all select to_id as person1, from_id as person1, duration from Calls where from_id > to_id) as all_ordered group by person1, person2"
91,"select t.person1, t.person2, count(duration) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls) t where t.person1 < t.person2 group by 1,2"
92,"with base as ( select * from ( select * from calls where from_id < to_id )t union all( select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) ) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from base group by 1,2"
93,"with cte as ( select * from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(1) call_count, sum(duration) total_duration from cte group by 1, 2"
94,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1,to_id as person2, duration from Calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from Calls where to_id<from_id )tmp group by person1, person2"
95,"Select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, Count(*) as call_count, SUM(duration) as total_duration From calls Group By person1, person2 "
96,"select (case when from_id < to_id then from_id else to_id end) person1, (case when to_id > from_id then to_id else from_id end) person2, count(1) call_count, sum(duration) total_duration from Calls group by 1,2 "
97,"select least(from_id, to_id) as person1 , greatest(from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by person1, person2 "
98,"SELECT CASE WHEN from_id<to_id THEN to_id ELSE from_id END ""person1"", CASE WHEN from_id>to_id THEN to_id ELSE from_id END ""person2"", COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1,person2 "
99,"WITH X AS ( SELECT DISTINCT * FROM Calls ), CTE1 AS ( SELECT (CASE WHEN from_id<to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id<to_id THEN to_id ELSE from_id END) AS person2, duration FROM Calls) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM CTE1 GROUP BY person1, person2"
100,"select person1,person2,sum(call_count) call_count,sum(duration) total_duration from (select from_id as person1,to_id as person2, count(*) as call_count, sum(duration) duration from Calls where from_id<to_id group by from_id,to_id union select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) duration from Calls where to_id<from_id group by to_id,from_id) A group by person1,person2"
101,"select ( case when from_id < to_id then from_id when from_id > to_id then to_id end ) person1, (case when from_id < to_id then to_id when from_id > to_id then from_id end ) person2, count(*) as call_count,sum(duration) as total_duration from Calls group by person1, person2"
102,"SELECT LEAST(from_id,to_id) AS person1, GREATEST(from_id,to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2 "
103,"select (case when from_id < to_id then from_id else to_id end) person1, (case when from_id > to_id then from_id else to_id end) person2, count(from_id) call_count, sum(duration) total_duration from Calls group by person1, person2 "
104,"select id1 person1, id2 person2, count(*) call_count, sum(duration) total_duration from (select LEAST(from_id, to_id) as id1, GREATEST(from_id, to_id) as id2, duration from Calls) as t1 group by id1, id2 "
105,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from Calls where from_id > to_id)t group by person1, person2 "
106,"SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM ( SELECT * FROM calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM calls WHERE to_id < from_id ) a group by from_id, to_id "
107,"SELECT from_id AS person1, to_id AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM ( SELECT * FROM Calls UNION ALL SELECT to_id, from_id, duration FROM Calls ) as T1 WHERE from_id<to_id GROUP BY from_id, to_id ORDER BY 1"
108,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
109,"select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person1, person2"
110,"WITH CTE1 AS ( SELECT FROM_ID AS PERSON1, TO_ID AS PERSON2, DURATION FROM CALLS WHERE FROM_ID < TO_ID UNION ALL SELECT TO_ID AS PERSON1, FROM_ID AS PERSON2, DURATION FROM CALLS WHERE TO_ID < FROM_ID ) SELECT PERSON1, PERSON2, COUNT(*) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM CTE1 GROUP BY PERSON1, PERSON2 "
111,"select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by 1,2"
112,"with cte as (select case when from_id<to_id then from_id else to_id end as from_id, case when from_id<to_id then to_id else from_id end as to_id, duration from calls) select from_id as person1, to_id as person2,count(duration) call_count, sum(duration) total_duration from cte group by 1,2"
113,"with t as ( select from_id as p1, to_id as p2, duration from calls where to_id > from_id union all select to_id as p1, from_id as p2, duration from calls where to_id < from_id ) select p1 as person1, p2 as person2, count(*) as call_count, sum(t.duration) as total_duration from t group by person1, person2 "
114,"select if (from_id < to_id, from_id, to_id) as person1, if(from_id < to_id, to_id, from_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
115,"select A.person1, A.person2, count(duration) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1,from_id as person2, duration from Calls) as A where A.person1<A.person2 group by 1,2"
116,"WITH main(person1, person2, duration) AS ( SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM Calls WHERE from_id > to_id ) SELECT person1, person2, COUNT(duration) AS call_Count, SUM(duration) AS total_duration FROM main GROUP BY person1, person2 "
117,"WITH allrows AS ( SELECT IF (from_id <= to_id, from_id, to_id) AS person1, IF (from_id <= to_id, to_id, from_id) AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM allrows GROUP BY person1, person2 ORDER BY person1, person2 "
118,"Select Case when from_id < to_id then from_id Else to_id End as Person1, Case When from_id < to_id then to_id Else from_id End as Person2, Count(*) AS call_count, Sum(duration) AS total_duration from calls group by person1, person2 order by person1, person2 "
119,"select case when from_id < to_id then from_id when from_id > to_id then to_id end as person1, case when from_id < to_id then to_id when from_id > to_id then from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
120,"WITH CTE AS( SELECT*, CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2 FROM Calls ) SELECT person1,person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM CTE GROUP BY person1,person2"
121,"with cte as ( select case when from_id > to_id then to_id else from_id end as from_id, case when from_id < to_id then to_id else from_id end as to_id, duration from Calls ) select from_id person1 , to_id person2 , count(from_id) call_count , sum(duration) total_duration from cte group by from_id, to_id "
122,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
123,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
124,"with t1 as(select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from calls) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from t1 group by person1, person2"
125,"with t as (select t1.from_id,t1.to_id,t1.duration from (select from_id,to_id,duration from calls union all select to_id as from_id,from_id as to_id,duration from calls) t1 where t1.to_id > t1.from_id) select from_id as person1 ,to_id as person2 ,count(*) as call_count ,sum(duration) as total_duration from t GROUP BY from_id ,to_id "
126,"SELECT DISTINCT PERSON1, PERSON2, COUNT(C.DURATION) AS CALL_COUNT, SUM(C.DURATION) AS TOTAL_DURATION FROM (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS) C GROUP BY PERSON1, PERSON2 ORDER BY PERSON1"
127,"with cte as ( select from_id as person1, to_id as person2, duration from calls union all select to_id as person1, from_id as person2, duration from calls ) SELECT PERSON1 AS person1,PERSON2 AS person2,COUNT(PERSON1) as call_count,SUM(DURATION) as total_duration FROM CTE WHERE PERSON1 < PERSON2 GROUP BY PERSON1,PERSON2"
128,"select base.person1,base.person2, count(*) call_count, sum(base.duration) total_duration from (select from_id person1, to_id person2, duration from Calls union all select to_id person1, from_id person2, duration from Calls ) as base where base.person1< base.person2 group by base.person1, base.person2 "
129,"select from_id as person1, to_id as person2, sum(ct) as call_count, sum(duration) as total_duration from ( select from_id, to_id, count(*) as ct, sum(duration) as duration from Calls group by from_id, to_id having from_id < to_id union select to_id, from_id, count(*) as ct, sum(duration) as duration from Calls group by to_id, from_id having to_id < from_id ) sub group by from_id, to_id "
130,"SELECT least(from_id,to_id) AS person1, greatest(from_id,to_id) AS person2, count(*) AS call_count, sum(duration) AS total_duration FROM Calls GROUP BY 1,2"
131,"select case when from_id>to_id then from_id else to_id end as person1, case when from_id>to_id then to_id else from_id end as person2, count(duration) call_count, sum(duration) total_duration from Calls group by person1, person2"
132,"SELECT MIN(from_id) AS person1, MAX(to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM ( SELECT CONCAT(LEAST(from_id, to_id), '-', GREATEST(from_id, to_id)) AS persons, from_id, to_id, duration FROM Calls ) a GROUP BY persons"
133,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
134,"select t.from_id as person1 , t.to_id as person2 , count(*) as call_count , sum(t.duration) as total_duration from (select from_id, to_id, duration from Calls UNION ALL select to_id, from_id, duration from Calls) t where t.from_id < t.to_id group by person1, person2"
135,"SELECT person1,person2, COUNT(*) call_count,SUM(duration) total_duration FROM (SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) person2, duration FROM Calls c ) temp GROUP BY person1,person2"
136,"select IF(from_id>to_id, to_id, from_id) as person1, IF(from_id>to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
137,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, duration from calls) x group by person1, person2"
138,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
139,"with final as ( with other1 as ( with other as ( with cte as ( Select * ,count(*) over(partition by from_id,to_id) as 'calls_between' from Calls ) Select *,sum(duration) as 'initial_sum' from cte group by from_id,to_id ) Select o1.from_id as 'first_from',o1.to_id as 'first_to',o2.from_id as 'second_from',o2.to_id as 'second_to',o1.calls_between,o1.initial_sum as 'first_sum',o2.initial_sum as 'second_sum' from other o1 left join other o2 on o1.to_id = o2.from_id and o1.from_id = o2.to_id where (o2.from_id is null and o2.to_id is null) or (o1.from_id < o2.from_id and o1.to_id > o2.to_id) ) Select *, case when (first_from = second_to and first_to = second_from) then calls_between + 1 when second_from is null and second_to is null then calls_between end as updated_call_count, case when (first_from = second_to and first_to = second_from) then first_sum + second_sum when second_from is null and second_to is null then first_sum end as updated_sum from other1 ) Select first_from as person1,first_to as person2,updated_call_count as call_count, updated_sum as total_duration from final"
140,"WITH CTE1 AS ( SELECT (CASE WHEN from_id<to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id<to_id THEN to_id ELSE from_id END) AS person2, duration FROM Calls) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM CTE1 GROUP BY person1, person2"
141,"WITH cte AS (SELECT from_id, to_id, COUNT(*) AS cnt, SUM(duration) AS dur FROM Calls GROUP BY from_id, to_id) SELECT IF(from_id<to_id, from_id, to_id) AS person1, IF(from_id<to_id, to_id, from_id) AS person2, SUM(cnt) AS call_count, SUM(dur) AS total_duration FROM cte GROUP BY person1, person2 "
142,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
143,"SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, count(*) as call_count, sum(duration) as total_duration FROM Calls GROUP BY person1, person2 "
144,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1 "
145,"select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id, from_id, duration from Calls) t1 where from_id < to_id group by person1, person2"
146,"select least(from_id, to_id) person1, greatest(to_id, from_id) person2,count(*) call_count, sum(duration) total_duration from Calls group by 1, 2 "
147,"select least(from_id, to_id) person1, greatest(from_id, to_id) person2, count(*) call_count, sum(duration) total_duration from calls group by 1,2 "
148,"select id1 person1, id2 person2, count(*) call_count, sum(duration) total_duration from (select if(from_id < to_id, from_id, to_id) as id1, if(from_id > to_id, from_id, to_id) as id2, duration from Calls) as t1 group by id1, id2"
149,"SELECT from_id AS person1,to_id AS person2,COUNT(*) AS call_count,SUM(duration) AS total_duration FROM Calls GROUP BY from_id+to_id, from_id*to_id ORDER BY 1,2 "
150,"select LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) total_duration from Calls group by person1, person2 "
151,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1,person2"
152,"select LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) total_duration from Calls group by person1, person2 "
153,"with cte as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
154,"select distinct person1, person2, count(duration) as call_count, sum(duration)as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls )a where person1<person2 group by person1, person2"
155,"with cte as ( select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, duration from calls) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2"
156,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2 ORDER BY person1"
157,"with summaryTable as ( select Case when from_id < to_id then from_id else to_id end as person1, Case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls as c1 group by from_id, to_id ) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from summaryTable as st group by person1, person2 "
158,"with cte as ((select from_id as person1, to_id as person2, duration from calls where from_id<to_id) union all (select to_id as person1, from_id as person2, duration from calls where from_id>to_id)) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2"
159,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
160,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
161,"select least(from_id, to_id) as person1 , greatest(from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by person1, person2 "
162,"with cte as (select distinct from_id as person1, to_id as person2, count(*) over(partition by from_id,to_id ) as call_count, sum(duration) over(partition by from_id,to_id ) as total_duration from calls where from_id<to_id union distinct select distinct to_id as person1, from_id as person2, count(*) over(partition by to_id,from_id ) as call_count,sum(duration) over(partition by to_id,from_id) as total_duration from calls where to_id<from_id) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from cte group by person1, person2 "
163,"with cte as ( select * from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(1) call_count, sum(duration) total_duration from cte group by 1, 2"
164,"WITH cte AS (SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE from_id > to_id) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM cte GROUP BY person1, person2"
165,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
166,"select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2 "
167,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(1) as call_count, sum(duration) as total_duration from Calls group by 1,2 "
168,"with cte as (Select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, duration from calls), cte_1 as (Select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2) Select * from cte_1"
169,"select from_id as person1, to_id as person2, count(from_id) as call_count ,sum(duration) as total_duration from (select case when to_id<from_id then to_id else from_id end as from_id ,case when to_id<from_id then from_id else to_id end as to_id ,duration from Calls)a group by from_id,to_id"
170,"SELECT CASE WHEN from_id < to_id then from_id ELSE to_id end as person1, CASE WHEN from_id < to_id then to_id ELSE from_id end as person2, count(*) as call_count, sum(duration) as total_duration FROM calls group by 1,2"
171,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2 "
172,"select if(from_id < to_id, from_id, to_id) as person1 , if(from_id > to_id, from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by 1, 2 "
173,"SELECT LEAST(from_id,to_id) AS person1, GREATEST(from_id,to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2 "
174,"with ct as (select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from calls where from_id < to_id group by from_id, to_id union all select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) total_duration from calls where from_id > to_id group by to_id,from_id) select person1,person2,sum(call_count) as call_count,sum(total_duration) as total_duration from ct group by person1,person2 "
175,"with t as (SELECT CASE WHEN from_id<to_id then from_id else to_id end as person1, CASE WHEN from_id<to_id then to_id else from_id end as person2, duration from calls) select person1,person2, count(duration) as call_count, sum(duration) as total_duration from t group by person1,person2"
176,"select case when c.from_id < c.to_id then c.from_id else c.to_id end as person1, case when c.from_id > c.to_id then c.from_id else c.to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls c group by person1, person2"
177,"WITH cte AS (SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE from_id > to_id) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM cte GROUP BY person1, person2"
178,"select least(from_id, to_id) as person1 , greatest(from_id,to_id) as person2,count(*) as call_count,sum(duration) as total_duration from calls group by person1,person2"
179,"with person_single as (select * from (select distinct from_id as person from Calls union select distinct to_id as person from Calls) sub ), duration_sub as (select * from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls) sub2), combo_pair as (select p1.person as person1, p2.person as person2 from person_single p1 join person_single p2 on p1.person < p2.person ) select d.person1, d.person2, count(d.duration) as call_count, sum(d.duration) as total_duration from combo_pair p join duration_sub d on p.person1 = d.person1 and p.person2 = d.person2 group by 1,2 "
180,"select least(from_id,to_id)person1, greatest(from_id,to_id)person2, COUNT(*) AS call_count, sum(duration) total_duration from Calls group by 1,2 order by 1,2"
181,"SELECT DISTINCT Least(from_id,to_id) as person1, Greatest(from_id,to_id) as person2, Count(*) as call_count, Sum(duration) as total_duration FROM Calls Group by person1,person2"
182,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) t group by 1,2"
183,"select from_id as person1, to_id as person2, count(case when from_id < to_id then concat(from_id, to_id) else 0 end) as call_count, sum(duration) as total_duration from Calls where case when from_id < to_id then concat(from_id, to_id) when to_id < from_id then concat(to_id, from_id) end group by case when from_id < to_id then concat(from_id, to_id) when to_id < from_id then concat(to_id, from_id) end "
184,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1,2 "
185,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, sum(duration) as total_duration, count(duration) as call_count from Calls group by person1,person2 order by person1,person2 "
186,"WITH all_calls AS ( SELECT DISTINCT from_id, to_id, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls WHERE from_id < to_id GROUP BY from_id, to_id UNION ALL SELECT DISTINCT to_id AS from_id, from_id AS to_id, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls WHERE from_id > to_id GROUP BY from_id, to_id ) SELECT from_id AS person1, to_id AS person2, SUM(call_count) AS call_count, SUM(total_duration) AS total_duration FROM all_calls GROUP BY person1, person2 "
187,"select t.from_id as person1, t.to_id as person2, count(duration) as call_count, sum(duration) as total_duration from ( select from_id, to_id, duration from Calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from Calls where from_id > to_id ) t group by 1, 2"
188,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(1) as call_count, sum(duration) as total_duration from calls group by 1,2"
189,"select least(from_id,to_id) 'person1', greatest(from_id,to_id) 'person2', count(*) 'call_count', sum(duration) 'total_duration' from calls group by person1, person2 "
190,"WITH CET AS (SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE from_id > to_id) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM CET GROUP BY 1,2"
191,"select LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2 "
192,"Select Least(from_id, to_id) as person1, Greatest(from_id, to_id) as person2, Count(*) as call_count, Sum(duration) as total_duration From Calls Group By person1, person2 "
193,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) all_records group by person1, person2 "
194,"select least(from_id,to_id) as person1 , greatest(from_id,to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from calls a group by person1,person2 "
195,"select distinct person1, person2, count(duration) as call_count, sum(duration)as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls )a where person1<person2 group by person1, person2"
196,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1,person2"
197,"select LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by LEAST(from_id, to_id), GREATEST(from_id, to_id)"
198,"select (case when from_id < to_id then from_id else to_id end) as person1, (case when from_id > to_id then from_id else to_id end) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
199,"with t as ( select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, duration from Calls) select distinct person1, person2, count(*) as call_count, sum(duration) as total_duration from t group by person1, person2"
200,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
201,"WITH CTE AS ( Select * FROM calls UNION ALL select to_id,from_id, duration from calls ) SELECT from_id as person1, to_id as person2, count(*) as call_count,sum(duration) as total_duration from cte where from_id < to_id group by from_id,to_id "
202,"WITH CTE AS( SELECT from_id as person1, to_id as person2, duration FROM Calls UNION ALL SELECT to_id as person1, from_id as person2, duration FROM Calls ) SELECT person1, person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM CTE WHERE person1<person2 GROUP BY person1, person2"
203,"SELECT (CASE WHEN from_id > to_id THEN to_id ELSE from_id END) as person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) as person2, count(duration) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1, person2"
204,"select t.from_id as person1, t.to_id as person2, count(*) as call_count, sum(t.duration) as total_duration from ( (select from_id, to_id, duration from calls where from_id < to_id ) union all ( select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) ) t group by 1,2 "
205,"select t.from_id as person1 , t.to_id as person2 , count(*) as call_count , sum(t.duration) as total_duration from (select from_id, to_id, duration from Calls UNION ALL select to_id, from_id, duration from Calls) t where t.from_id < t.to_id group by person1, person2"
206,"SELECT c3.to_id as person1, c3.from_id as person2, COUNT(c3.duration) as call_count, SUM(c3.duration) as total_duration FROM (SELECT c1.to_id, c1.from_id, c1.duration FROM Calls as c1 UNION ALL SELECT c2.from_id as ""to_id"", c2.to_id as ""from_id"", c2.duration FROM Calls as c2) as c3 WHERE to_id < from_id GROUP BY to_id,from_id "
207,"SELECT least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration FROM Calls GROUP BY 1,2"
208,"with main as ( select from_id,to_id,duration from calls union all select to_id,from_id,duration from calls ) select from_id as person1, to_id as person2, count(1) as call_count, sum(duration) as total_duration from main where from_id<to_id group by from_id,to_id "
209,"select case when from_id > to_id then to_id else from_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
210,"SELECT person1, person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM ( SELECT from_id as person1, to_id as person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id as person1, from_id as person2, duration FROM Calls WHERE to_id < from_id) t GROUP BY person1, person2"
211,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
212,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from Calls where from_id>to_id) temp group by person1, person2"
213,"select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from (select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id union all select from_id, to_id, duration from calls where from_id < to_id) a group by from_id, to_id"
214,"WITH t AS (SELECT * FROM Calls UNION ALL SELECT to_id AS from_id,from_id AS to_id,duration FROM Calls) SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM t WHERE from_id < to_id GROUP BY 1,2  "
215,"select case when from_id < to_id then from_id else to_id end ""person1"", case when from_id > to_id then from_id else to_id end ""person2"", count(duration) ""call_count"", sum(duration) ""total_duration"" from calls group by 1, 2 "
216,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) all_records group by person1, person2 "
217,"select case when from_id > to_id then to_id else from_id end as person1, case when to_id > from_id then to_id else from_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person2, person1 "
218,"select from_id as person1,to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id, from_id, duration from Calls) t1 where from_id < to_id group by person1, person2"
219,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
220,"select least(from_id,to_id) as person1,greatest(from_id,to_id) as person2,count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2"
221,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1,person2"
222,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from( select from_id as person1,to_id as person2,duration from calls where from_id<to_id union all select to_id as person1, from_id as person2, duration from calls where to_id<from_id )a group by person1 , person2"
223,"with tab as (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls ) select person1, person2, count(duration) as call_count, sum(duration) as total_duration from tab group by person1, person2 "
224,"select if(from_id >to_id,to_id , from_id )person1, if(from_id > to_id, from_id,to_id )person2,count(*) call_count ,sum(duration) total_duration from Calls group by person1,person2"
225,"select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
226,"WITH c AS ( SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS from_id, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS to_id, duration FROM Calls ) SELECT from_id AS person1, to_id AS person2, COUNT(from_id) AS call_count, SUM(duration) AS total_duration FROM c GROUP BY from_id, to_id"
227,"with t as ( select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from calls ) select person1,person2,count(duration) as call_count, sum(duration) as total_duration from t group by 1,2"
228,"with temp as (select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from temp group by from_id, to_id"
229,"Select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from (Select case when from_id > to_id then to_id else from_id end from_id, case when to_id < from_id then from_id else to_id end to_id, duration from Calls )t1 group by from_id, to_id "
230,"with cte1 as ( select * from Calls where from_id < to_id ), cte2 as ( select to_id as from_id, from_id as to_id, duration from Calls where from_id > to_id ), cte3 as ( select * from cte1 union all select * from cte2 ) select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from cte3 group by person1, person2"
231,"select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1,2"
232,"WITH clean_calls AS ( SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) as person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) as person2, duration FROM Calls) SELECT person1, person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM clean_calls GROUP BY person1, person2 "
233,"SELECT DISTINCT PERSON1, PERSON2, COUNT(C.DURATION) AS CALL_COUNT, SUM(C.DURATION) AS TOTAL_DURATION FROM (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS) C GROUP BY PERSON1, PERSON2 ORDER BY PERSON1 "
234,"select case when c.from_id < c.to_id then c.from_id else c.to_id end as person1, case when c.from_id > c.to_id then c.from_id else c.to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls c group by person1, person2"
235,"SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
236,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1, 2 "
237,"with tmp as ((select from_id as person1, to_id as person2, duration from calls where from_id < to_id) union all (select to_id as person1, from_id as person2, duration from calls where from_id > to_id)) select person1, person2, count(person1) as call_count, sum(duration) as total_duration from tmp group by person1, person2"
238,"with cte as (select c1.from_id, c1.to_id, c1.duration from calls c1 union all select c2.to_id as from_id, c2.from_id as to_id, c2.duration from calls c2) select from_id as person1, to_id as person2, count(from_id) as call_count, sum(duration) as total_duration from cte where from_id<to_id group by 1,2 "
239,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2 "
240,"with cte as ( select from_id, to_id, sum(duration) as dur, count(from_id) as cnt from calls group by 1,2 order by 1,2 ) select c1.from_id as person1, c1.to_id as person2, sum(ifnull(c1.cnt,0)+ifnull(c2.cnt,0)) as call_count, sum(ifnull(c1.dur,0) + ifnull(c2.dur,0)) as total_duration from cte c1 left join cte c2 on c1.to_id = c2.from_id and c2.to_id = c1.from_id where c1.from_id < c2.from_id or c2.to_id is null group by 1,2"
241,"WITH main(person1, person2, duration) AS ( SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM Calls WHERE from_id > to_id ) SELECT person1, person2, COUNT(duration) AS call_Count, SUM(duration) AS total_duration FROM main GROUP BY person1, person2 "
242,"SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1, person2"
243,"with cte as( select case when from_id < to_id then from_id else to_id end from_id1, case when from_id < to_id then to_id else from_id end to_id1, duration from calls ) select from_id1 person1, to_id1 person2,count(*) call_count, sum(duration) total_duration from cte group by 1,2 "
244,"with a as ( select case when from_id < to_id then from_id else to_id end as id1 , case when from_id < to_id then to_id else from_id end as id2 , duration from (select * from calls where from_id!=to_id) as t) select id1 as person1 , id2 as person2 , count(*) as call_count , sum(duration) as total_duration from a group by id1, id2"
245,"SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id > to_id THEN from_id ELSE to_id END) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
246,"select if(calls.from_id<calls.to_id,calls.from_id,calls.to_id) person1, if(calls.from_id<calls.to_id,calls.to_id,calls.from_id) person2, count(*) call_count,sum(duration) total_duration from calls group by 1,2"
247,"WITH table1 AS( SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, duration FROM Calls ) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) As total_duration FROM table1 GROUP BY person1, person2 "
248,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY 1,2"
249,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
250,"SELECT LEAST(from_id, to_id) person1, GREATEST(from_id, to_id) person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1, person2 "
251,"select least(from_id , to_id) person1, greatest (from_id , to_id) person2 , count(duration) as call_count , sum(duration) as total_duration from Calls group by 1,2 order by 1,2 "
252,"select person1 ,person2 ,count(duration) as call_count ,sum(duration) as total_duration from( select if(from_id<to_id, from_id,to_id) as person1 ,if(from_id<to_id, to_id, from_id) as person2 ,duration from Calls ) callA group by person1,person2"
253,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1,2"
254,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
255,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1,person2"
256,"with t as ( select case when from_id > to_id then to_id else from_id end person1, case when from_id > to_id then from_id else to_id end person2, duration from calls ) select t.person1, t.person2, count(*) call_count, sum(duration) total_duration from t group by person1, person2"
257,"select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
258,"SELECT CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1, person2 "
259,"SELECT person1, person2, COUNT(*) call_count, SUM(duration) total_duration FROM (SELECT from_id person1, to_id person2, duration FROM calls UNION ALL SELECT to_id person1, from_id person2, duration FROM calls) a WHERE 1=1 AND person1 <person2 GROUP BY person1, person2"
260,"SELECT person1, person2, COUNT(c.duration) AS call_count, SUM(c.duration) AS total_duration FROM (SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, duration FROM Calls) c GROUP BY person1, person2"
261,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1,2"
262,"with cte as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
263,"with cte as (select from_id,to_id,duration from calls where from_id<to_id union all select to_id,from_id,duration from calls where from_id>to_id) select from_id person1,to_id person2,count(*) call_count, sum(duration) total_duration from cte group by 1,2"
264,"CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls c GROUP BY 1, 2 "
265,"select c.person1, c.person2, sum(call_count) call_count, sum(total_duration) total_duration from (select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id<to_id group by 1,2 union select to_id person1, from_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id>to_id group by 1,2) c group by 1,2 "
266,"select person1, person2, count(duration) as call_count, sum(duration) as total_duration from (select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) tmp group by 1,2"
267,"with tot as (select c1.from_id as person1, c1.to_id as person2,count(c1.duration) as ct, sum(c1.duration) as dur from calls c1 where c1.from_id<c1.to_id group by c1.from_id,c1.to_id union select c2.to_id as person1, c2.from_id as person1,count(c2.duration) as ct, sum(c2.duration) as dur from calls c2 where c2.to_id<c2.from_id group by c2.to_id,c2.from_id) select person1,person2,sum(ct) as call_count,sum(dur) as total_duration from tot group by person1,person2 "
268,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select IF(from_id > to_id, from_id, to_id) as person1, IF(from_id < to_id, from_id, to_id) as person2, duration from calls ) as t group by person1, person2"
269,"select case when(from_id > to_id) then to_id else from_id end as person1 , case when(from_id > to_id) then from_id else to_id end as person2 , count(*) as call_count , sum(duration) as total_duration from calls group by 1,2 "
270,"select IF(from_id<to_id, from_id, to_id) as person1, IF(from_id<to_id, to_id, from_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls GROUP BY 1,2 "
271,"select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1,person2"
272,"SELECT IF(from_id<to_id,from_id,to_id) person1, IF(from_id>to_id,from_id,to_id) person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1, person2 "
273,"select c.person1, c.person2, sum(call_count) call_count, sum(total_duration) total_duration from (select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id<to_id group by 1,2 union select to_id person1, from_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id>to_id group by 1,2) c group by 1,2 "
274,"select distinct person1, person2, count(duration) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from calls) t group by 1,2 "
275,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) as a group by person1, person2"
276,"with temp as (select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from temp group by from_id, to_id"
277,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1, 2 "
278,"select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2"
279,"select least(from_id, to_id) as 'person1', greatest(from_id, to_id) as 'person2', count(duration) as 'call_count', sum(duration) as 'total_duration' from calls group by person1, person2"
280,"select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from (select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2 union select to_id as person1, from_id as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2) sub group by 1, 2 having person1 < person2 "
281,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
282,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2 "
283,"select least(from_id,to_id)person1, greatest(from_id,to_id)person2, COUNT(*) AS call_count, sum(duration) total_duration from Calls group by 1,2 order by 1,2"
284,"select person1,person2, SUM(call_count) as call_count, SUM(total_duration) as total_duration from (select from_id as person1,to_id as person2,count(1) as call_count,SUM(duration) as total_duration from calls where from_id < to_id group by from_id,to_id UNION select to_id as person1,from_id as person2,count(1) as call_count,SUM(duration) as total_duration from calls where from_id > to_id group by from_id,to_id ) t group by person1,person2 order by person1"
285,"select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id,from_id,duration from Calls) as temp where from_id<to_id group by person1,person2 "
286,"select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from( select from_id, to_id, duration from calls where from_id < to_id union all select to_id, from_id, duration from calls where to_id < from_id) t group by 1,2 order by 1,2"
287,"SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM ( SELECT from_id, to_id, duration FROM calls WHERE from_id < to_id UNION ALL SELECT to_id, from_id, duration FROM calls WHERE from_id > to_id ) a GROUP BY from_id, to_id"
288,"SELECT CASE WHEN from_id<to_id THEN to_id ELSE from_id END ""person1"", CASE WHEN from_id>to_id THEN to_id ELSE from_id END ""person2"", COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1,person2 "
289,"select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
290,"select (case when from_id < to_id then from_id else to_id end) person1, (case when from_id > to_id then from_id else to_id end) person2, count(duration)call_count, sum(duration) total_duration from calls group by 1, 2 order by 1, 2"
291,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by person1, person2 "
292,"with base as ( select from_id as id1, to_id as id2, duration from Calls union all select to_id as id1, from_id as id2, duration from Calls ) select id1 as person1, id2 as person2, count(1) as call_count, sum(duration) as total_duration from base where id1 < id2 group by 1,2"
293,"SELECT IF(from_id < to_id, from_id, to_id) AS person1, IF(from_id < to_id, to_id, from_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2 "
294,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2 ORDER BY person1, person2 "
295,"select least(from_id,to_id) as person1, greatest(from_id, to_id) as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by 1, 2 "
296,"with cte as( select case when from_id<to_id then from_id else to_id end as person1, case when to_id<from_id then from_id else to_id end as person2, duration from calls) select person1,person2,count(*) as call_count,sum(duration) as total_duration from cte group by 1,2"
297,"select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count,sum(duration) as total_duration from calls group by case when from_id > to_id then to_id else from_id end, case when from_id > to_id then from_id else to_id end"
298,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2 "
299,"with cte as (select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, duration from calls) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
300,"select from_id as 'person1', to_id as 'person2', count(*) as 'call_count', sum(duration) as 'total_duration' from ( select * from Calls Union all select to_id as 'from_id', from_id as 'to_id', duration from Calls) as A where from_id < to_id group by from_id, to_id "
301,"select DISTINCT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
302,"select c.person1, c.person2, sum(call_count) call_count, sum(total_duration) total_duration from (select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id<to_id group by 1,2 union select to_id person1, from_id person2, count(*) call_count, sum(duration) total_duration from Calls c where from_id>to_id group by 1,2) c group by 1,2 "
303,"WITH CTE AS( SELECT*, CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2 FROM Calls ) SELECT person1,person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM CTE GROUP BY person1,person2"
304,"Select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from Calls Group by person1, person2"
305,"select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1, 2 "
306,"WITH c1 AS (SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id > to_id) SELECT from_id AS person1, to_id AS person2 , count(1) AS call_count, SUM(duration) AS total_duration FROM c1 GROUP BY from_id, to_id"
307,"select case when(from_id > to_id) then to_id else from_id end as person1 , case when(from_id > to_id) then from_id else to_id end as person2 , count(*) as call_count , sum(duration) as total_duration from calls group by 1,2 "
308,"select least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by 1, 2"
309,"select least(from_id,to_id) as person1, greatest(from_id,to_id) as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by person1, person2 "
310,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
311,"with tmp as ( select case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2, duration from Calls ) select person1,person2, count(*) as call_count, sum(duration) total_duration from tmp group by 1,2"
312,"with cte as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
313,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2"
314,"select case when from_id < to_id then from_id else to_id end as person1, case when from_id > to_id then from_id else to_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by 1,2"
315,"with t as (select from_id, to_id, count(duration) as call_count, sum(duration) as duration from calls group by from_id, to_id) select from_id as person1, to_id as person2, call_count, duration as total_duration from t where (from_id,to_id) not in (select t1.from_id,t1.to_id from t t1, t t2 where t1.from_id = t2.to_id and t1.to_id = t2.from_id) union all select t1.from_id,t1.to_id, (t1.call_count + t2.call_count) as call_count, (t1.duration + t2.duration) as total_duration from t t1, t t2 where t1.from_id = t2.to_id and t1.to_id = t2.from_id and t1.from_id <t1.to_id "
316,"SELECT LEAST(from_id,to_id) person1, GREATEST(from_id,to_id) person2, COUNT(duration) call_count, SUM(duration) total_duration FROM Calls GROUP BY person1, person2"
317,"select least(from_id,to_id) as person1, greatest(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
318,"with cte1 as ( select *, if(from_id>to_id,cast(to_id + from_id*power(2,32) as unsigned),cast(from_id + to_id*power(2,32) as unsigned)) as combo from Calls ) select if(from_id<to_id, from_id, to_id) as person1, if(from_id>to_id, from_id, to_id) as person2, count(combo) as call_count, sum(duration) as total_duration from cte1 group by combo order by person1, person2"
319,"SELECT least(from_id, to_id) as person1, greatest(from_id, to_id) as person2, count(duration) as call_count, sum(duration) as total_duration from Calls group by person1, person2"
320,"WITH all_calls AS (SELECT * FROM Calls UNION ALL SELECT to_id, from_id, duration FROM Calls) SELECT from_id AS person1, to_id as person2, COUNT(duration) AS call_count,SUM(duration) AS total_duration FROM all_calls WHERE from_id < to_id GROUP BY from_id, to_id"
321,"with union_pair as ( select from_id as person1, to_id as person2, count(*) as num_calls, sum(duration) as total_duration from Calls where from_id < to_id group by 1, 2 union all select to_id as person1, from_id as person2, count(*) as num_calls, sum(duration) as total_duration from Calls where to_id < from_id group by 1, 2 ) select person1, person2, sum(num_calls) as call_count, sum(total_duration) as total_duration from union_pair group by 1, 2 "
322,"select if (from_id < to_id, from_id, to_id) as person1, if(from_id < to_id, to_id, from_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
323,"WITH CTE AS ( SELECT FROM_ID AS PERSON1,TO_ID AS PERSON2, DURATION FROM CALLS WHERE FROM_ID<TO_ID UNION ALL SELECT TO_ID AS PERSON1,FROM_ID AS PERSON2,DURATION FROM CALLS WHERE FROM_ID>TO_ID) SELECT PERSON1,PERSON2, COUNT(*) AS CALL_COUNT, SUM(DURATION) AS total_duration FROM CTE GROUP BY PERSON1,PERSON2"
324,"SELECT LEAST(from_id, to_id) AS person1 ,GREATEST(from_id, to_id) AS person2 ,count(*) AS call_count ,sum(duration) AS total_duration FROM Calls GROUP BY 1,2 "
325,"WITH combo as ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id, from_id, duration from calls where from_id > to_id ) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from combo group by from_id, to_id order by from_id, to_id"
326,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY LEAST(from_id, to_id), GREATEST(from_id, to_id)"
327,"with cte as (select (case when from_id < to_id then from_id else to_id end) as from_id, (case when to_id > from_id then to_id else from_id end) as to_id, duration from calls) select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from cte group by from_id, to_id"
328,"with cte as ( select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from calls where from_id<to_id group by 1,2 union all select to_id as person1, from_id as person2, count(duration) as call_count, sum(duration) as total_duration from calls where from_id>to_id group by 1,2 ) select person1, person2, sum(call_count) as call_count, sum(total_duration) as total_duration from cte group by 1,2 "
329,"with temp as( select a.from_id person1, a.to_id person2, count(*) cnt, sum(duration) duration from calls a group by a.from_id, a.to_id), temp2 as( select t1.person1, t1.person2, ifnull(sum(t1.cnt),0)+ ifnull(sum(t2.cnt),0) call_count, coalesce(sum(t1.duration),0)+ ifnull(sum(t2.duration),0) total_duration from temp t1 left join temp t2 on t1.person1 = t2.person2 and t1.person2 = t2.person1 where t1.person1 < t1.person2 group by 1,2) select * from temp2 union select person2,person1,cnt,duration from temp where person2< person1 and (person2,person1) not in (select person1,person2 from temp2) "
330,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
331,"SELECT LEAST(from_id,to_id) as person1, GREATEST(from_id,to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM Calls GROUP BY person1,person2 "
332,"select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from (select to_id as from_id, from_id as to_id, duration from Calls where from_id > to_id union all select from_id, to_id, duration from Calls where from_id < to_id) t group by 1,2"
333,"SELECT a AS person1, b as person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM ( (SELECT from_id AS a, to_id AS b, duration FROM Calls WHERE from_id < to_id) UNION ALL (SELECT to_id AS a, from_id AS b, duration FROM Calls WHERE from_id > to_id ) ) AS t1 GROUP BY a, b "
334,"WITH calls_cte AS ( SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS from_id, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS to_id, duration FROM Calls ) SELECT from_id AS person1, to_id AS person2, COUNT(1) AS call_count, SUM(duration) AS total_duration FROM calls_cte GROUP BY from_id, to_id"
335,"SELECT from_id AS person1, to_id AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM (SELECT from_id, to_id, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id > to_id)t GROUP BY 1, 2 "
336,"with cte1 as ( select case when from_id<to_id then from_id else to_id end as person1, case when from_id>to_id then from_id else to_id end as person2,duration from calls ) select person1,person2,count(1) as call_count,sum(duration) as total_duration from cte1 group by 1,2 "
337,"SELECT CASE WHEN from_id < to_id THEN from_id ELSE to_id END person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls GROUP BY 1,2"
338,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1, 2"
339,"with a as ( select case when from_id < to_id then from_id else to_id end as id1 , case when from_id < to_id then to_id else from_id end as id2 , duration from (select * from calls where from_id!=to_id) as t) select id1 as person1 , id2 as person2 , count(*) as call_count , sum(duration) as total_duration from a group by id1, id2"
340,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY LEAST(from_id, to_id), GREATEST(from_id, to_id)"
341,"with new as(select if(from_id<to_id,from_id,to_id) as person1, if(from_id<to_id,to_id,from_id) as person2, duration from calls) select person1, person2, count(*) as call_count, sum(duration) as total_duration from new group by 1,2"
342,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
343,"SELECT from_id AS person1, to_id AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM (SELECT from_id, to_id, duration FROM Calls WHERE from_id<to_id UNION ALL SELECT to_id AS from_id, from_id AS to_id, duration FROM Calls WHERE from_id>to_id)t1 GROUP BY person1,person2 "
344,"with cte1 as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id ) ,cte2 as ( select to_id as person1, from_id as person2, duration from calls where from_id > to_id ) ,cte3 as( select person1, person2, duration from cte1 union all select person1, person2, duration from cte2 ) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte3 group by 1,2"
345,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select duration, case when from_id<to_id then from_id else to_id end as person1, case when from_id<to_id then to_id else from_id end as person2 from Calls) Table1 group by Table1.person1, Table1.person2"
346,"select CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, count(1) as call_count, sum(duration) as total_duration from calls group by 1,2 "
347,"select person1, person2, count(duration) as call_count, sum(duration) as total_duration from (select person1, person2, duration from (select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls) t1 where person1<person2) t2 group by 1,2 "
348,"WITH same_calls AS ( SELECT from_id, to_id, COUNT(*) as call_count, SUM(duration) as total_duration from Calls GROUP BY from_id, to_id ), temp_data AS ( SELECT C1.from_id, C1.to_id, C2.from_id as c2_from_id, (COALESCE(C1.call_count,0)+COALESCE(C2.call_count,0)) as call_count, (COALESCE(C1.total_duration,0) + COALESCE(C2.total_duration,0)) as total_duration from same_calls C1 LEFT JOIN same_calls C2 ON C1.from_id = C2.to_id AND C1.to_id = C2.from_id ORDER BY C1.from_id, C1.to_id ) SELECT from_id as person1, to_id as person2, call_count , total_duration from temp_data where (from_id < c2_from_id OR c2_from_id is NULL)"
349,"SELECT t.from_id AS person1, t.to_id as person2, SUM(t.call_count) as call_count, SUM(t.duration) as total_duration FROM ((SELECT from_id, to_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls GROUP BY from_id, to_id) UNION ALL (SELECT to_id, from_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls GROUP BY from_id, to_id)) as t WHERE t.from_id < t.to_id GROUP BY t.from_id, t.to_id "
350,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id >to_id THEN from_id ELSE to_id END AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2"
351,"with cte as ( select from_id as person1, to_id as person2, duration from calls union all select to_id as person1, from_id as person2, duration from calls ) select person1,person2, count(*) as call_count, sum(duration) as total_duration from cte where person1 < person2 group by person1,person2"
352,"SELECT (CASE WHEN from_id < to_id THEN from_id ELSE to_id END) AS person1, (CASE WHEN from_id < to_id THEN to_id ELSE from_id END) AS person2, COUNT(duration) as call_count, SUM(duration) AS total_duration FROM Calls GROUP BY 1,2"
353,"select least(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2"
354,"Select case when from_id < to_id then from_id else to_id end person1, case when from_id > to_id then from_id else to_id end person2, count(*) call_count, sum(duration) total_duration From Calls Group BY person1, person2"
355,"select if(from_id<to_id, from_id, to_id) person1, if(from_id>to_id,from_id, to_id) person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2"
356,"SELECT person1, person2, count(*) as call_count, sum(duration) as total_duration FROM (SELECT from_id as person1, to_id as person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id as person1, from_id as person2, duration FROM Calls WHERE from_id > to_id) A GROUP BY person1, person2"
357,"select t.person1, t.person2, count(t.duration) as call_count, sum(t.duration) as total_duration from ( select case when c.from_id > c.to_id then c.to_id else c.from_id end as person1, case when c.from_id > c.to_id then c.from_id else c.to_id end as person2, c.duration from Calls c ) t group by t.person1, t.person2"
358,"SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM( SELECT CASE WHEN from_id<to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id>to_id THEN from_id ELSE to_id END AS person2, duration FROM Calls) c GROUP BY person1, person2"
359,"WITH cte AS ( Select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) Select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
360,"select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id as from_id, from_id as to_id, duration from calls where from_id > to_id ) as tmp group by from_id, to_id"
361,"SELECT c.from_id as person1, c.to_id as person2, SUM(c.call_count) as call_count, SUM(c.duration) as total_duration FROM (SELECT from_id, to_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls c1 WHERE c1.from_id < c1.to_id GROUP BY from_id, to_id UNION SELECT to_id as from_id, from_id as to_id, SUM(duration) as duration, COUNT(*) as call_count FROM Calls c2 WHERE c2.from_id > c2.to_id GROUP BY from_id, to_id) c GROUP BY person1, person2 "
362,"select from_id as person1, to_id as person2, count(duration) as call_count, sum(duration) as total_duration from (select * from Calls union all select to_id, from_id, duration from Calls) as t where from_id < to_id group by person1, person2"
363,"select if(from_id<to_id, from_id, to_id) person1, if(from_id>to_id, from_id, to_id) person2, count(*) call_count, sum(duration) total_duration from calls group by person1, person2 "
364,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
365,"select from_ as person1, to_ as person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id < to_id then from_id else to_id end as from_, case when from_id > to_id then from_id else to_id end as to_, duration from Calls) t1 group by from_, to_ "
366,"select case when from_id > to_id then to_id else from_id end as person1, case when from_id < to_id then to_id else from_id end as person2, count(*) call_count, sum(duration) total_duration from calls group by 1,2 "
367,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
368,"WITH TEMP AS (SELECT (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1, (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2, DURATION FROM CALLS C) SELECT DISTINCT PERSON1, PERSON2, COUNT(*) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM TEMP GROUP BY PERSON1, PERSON2 "
369,"select distinct person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select from_id as person1, to_id as person2, duration from Calls union all select to_id as person1, from_id as person2, duration from Calls ) c where person1 < person2 group by person1, person2 "
370,"select DISTINCT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
371,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
372,"select case when from_id < to_id then from_id else to_id end as 'person1', case when from_id < to_id then to_id else from_id end as 'person2', count(*) as call_count, sum(duration)as total_duration from Calls group by 1,2 "
373,"select case when from_id < to_id then from_id else to_id end person1, case when from_id > to_id then from_id else to_id end person2, count(duration) call_count, sum(duration) total_duration from calls group by person1, person2"
374,"WITH temp AS ( SELECT from_id AS person1, to_id AS person2, duration FROM Calls WHERE from_id < to_id UNION ALL SELECT to_id AS person1, from_id AS person2, duration FROM Calls WHERE to_id < from_id ) SELECT person1, person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM temp GROUP BY person1, person2"
375,"select case when from_id<to_id then from_id else to_id end as person1, case when to_id>from_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2"
376,"select case when from_id>to_id then to_id else from_id end as person1, case when from_id>to_id then from_id else to_id end as person2, count(duration) as call_count, sum(duration) as total_duration from calls group by person1, person2"
377,"SELECT LEAST(from_id, to_id) AS person1, GREATEST(from_id, to_id) AS person2, COUNT(*) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person1, person2"
378,"select person1, person2, call_count, total_duration from (select person1, person2, sum(c1) as call_count, sum(d1) as total_duration from (select from_id as person1, to_id as person2, count(*) as c1, sum(duration) as d1 from Calls group by 1, 2 union select to_id as person1, from_id as person2, count(*) as c1, sum(duration) as d1 from Calls group by 1, 2) as a group by 1, 2) as b where person1 < person2"
379,"SELECT CASE WHEN from_id > to_id THEN to_id ELSE from_id END AS person1, CASE WHEN from_id > to_id THEN from_id ELSE to_id END AS person2, COUNT(duration) AS call_count, SUM(duration) AS total_duration FROM Calls GROUP BY person2,person1"
380,"select from_id_ as person1, to_id_ as person2, count(*) as call_count, sum(duration) as total_duration from (select case when from_id > to_id then to_id else from_id end as from_id_, case when from_id > to_id then from_id else to_id end as to_id_, duration from Calls)a group by from_id_, to_id_"
381,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from ( select if(from_id < to_id, from_id, to_id) as person1, if(from_id < to_id, to_id, from_id) as person2, duration from Calls ) temp group by person1, person2 "
382,"select if(from_id>to_id, from_id, to_id) as person1, if (from_id<to_id, from_id,to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
383,"With cte as ( Select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, duration from Calls) Select person1, person2, count(duration) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
384,"select case when to_id < from_id then to_id else from_id end as person1, case when to_id > from_id then to_id else from_id end as person2, count(*) as call_count, sum(duration) as total_duration from Calls group by person1, person2 "
385,"with all_users as (select distinct from_id as id from calls union select distinct to_id as id from calls) select a.id as person1, b.id as person2, count(duration) as call_count, sum(duration) as total_duration from all_users a join all_users b on a.id<b.id join calls c on (a.id = c.from_id and b.id = c.to_id ) or (a.id = c.to_id and b.id = c.from_id ) group by 1,2"
386,"select person1, person2, sum(call_count) call_count, sum(total_duration) total_duration from( select from_id person1, to_id person2, count(*) call_count, sum(duration) total_duration from calls where from_id<to_id group by from_id, to_id union select to_id person1, from_id person2, count(*) call_count, sum(duration) total_duration from calls where from_id>to_id group by to_id, from_id) t group by t.person1, t.person2 "
387,"with cte as ( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from cte group by person1, person2 "
388,"select least(from_id, to_id) as person1 , greatest(from_id, to_id) as person2 , count(*) as call_count , sum(duration) as total_duration from Calls group by 1, 2 "
389,"select person1, person2, count(*) as call_count, sum(duration) as total_duration from (select from_id as person1, to_id as person2, duration from Calls where from_id < to_id union all select to_id as person1, from_id as person2, duration from Calls where to_id < from_id) a group by 1,2"
390,"select if(from_id < to_id, from_id, to_id) as person1, if(from_id > to_id, from_id, to_id) as person2, count(*) as call_count, sum(duration) as total_duration from calls group by person1, person2 "
391,"with new as( select from_id as person1, to_id as person2, duration from calls where from_id < to_id union all select to_id as person1, from_id as person1, duration from calls where from_id > to_id) select person1, person2, count(*) as call_count, sum(duration) as total_duration from new group by person1, person2 "
392,"with temp as (select from_id, to_id, count(*) as ct, sum(duration) as du from Calls group by from_id, to_id) select case when from_id > to_id then to_id else from_id end as person1, case when from_id > to_id then from_id else to_id end as person2, sum(ct) call_count, sum(du) total_duration from temp group by case when from_id > to_id then to_id else from_id end, case when from_id > to_id then from_id else to_id end "
393,"with cte as ( select from_id, to_id, duration from calls where from_id < to_id union all select to_id, from_id, duration from calls where from_id > to_id) select from_id as person1, to_id as person2, count(*) as call_count, sum(duration) as total_duration from cte group by from_id, to_id"
394,"SELECT LEAST(from_id, to_id) as person1, GREATEST(from_id, to_id) as person2, COUNT(*) as call_count, SUM(duration) as total_duration FROM calls GROUP BY person1, person2"
