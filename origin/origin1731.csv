id,original query
1,"SELECT E1.reports_to AS employee_id, E2.name AS name, COUNT(E1.employee_id) AS reports_count, ROUND(AVG(E1.age),0) AS average_age FROM Employees AS E1 INNER JOIN Employees AS E2 ON E1.reports_to = E2.employee_id GROUP BY E1.reports_to HAVING COUNT(E1.employee_id)>0 ORDER BY employee_id"
2,"select e.employee_id, e.name, cnt as reports_count, round(aage,0) as average_age from employees e join (select distinct reports_to, count(reports_to) as cnt, avg(age) as aage from employees where reports_to is not null group by 1) a on e.employee_id = a.reports_to order by e.employee_id"
3,"select e1.reports_to as employee_id , e2.name, count(*) as reports_count, round(avg(e1.age)) as average_age from employees e1 left join employees e2 on(e1.reports_to=e2.employee_id) where e1.reports_to is not null group by e1.reports_to order by e1.reports_to "
4,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age),0) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1 "
5,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1"
6,"SELECT m.employee_id, m.name, COUNT(e.employee_id) reports_count, ROUND(AVG(e.age),0) average_age FROM Employees e JOIN Employees m ON e.reports_to = m.employee_id GROUP BY m.employee_id, m.name ORDER BY m.employee_id "
7,"select distinct e.reports_to as employee_id,e1.name,count(e1.employee_id) as reports_count,round(avg(e.age),0) as average_age from employees e1 join employees e on e1.employee_id=e.reports_to group by e.reports_to having count(e.reports_to)>=1 order by e1.employee_id"
8,"SELECT E1.reports_to AS employee_id, E2.name AS name, COUNT(E1.employee_id) AS reports_count, ROUND(AVG(E1.age),0) AS average_age FROM Employees AS E1 INNER JOIN Employees AS E2 ON E1.reports_to = E2.employee_id GROUP BY E1.reports_to HAVING COUNT(E1.employee_id)>0 ORDER BY employee_id"
9,"SELECT e1.employee_id, e1.name, COUNT(*) AS reports_count, ROUND(AVG(e2.age), 0) AS average_age FROM Employees e1 JOIN Employees e2 WHERE e1.employee_id = e2.reports_to GROUP BY employee_id HAVING COUNT(*) >= 1 ORDER BY e1.employee_id"
10,"SELECT E1.employee_id, E1.name, COUNT(E2.reports_to) AS reports_count, ROUND(AVG(E2.age)) AS average_age FROM Employees AS E1 JOIN Employees AS E2 ON E1.employee_id = E2.reports_to GROUP BY E1.employee_id ORDER BY E1.employee_id"
11,"select b.employee_id as employee_id, b.name as name, count(*) as reports_count, round(Avg(a.age)) as average_age from Employees a, Employees b where a.reports_to = b.employee_id group by b.employee_id order by b.employee_id "
12,"select e1.employee_id, e1.name, count(e2.employee_id) as reports_count, round(avg(e2.age),0) as average_age from employees e1 join employees e2 on e2.reports_to = e1.employee_id group by 1 order by 1"
13,"select mng.employee_id, mng.name, count(ee.name) as reports_count, round(avg(ee.age),0) as average_age from Employees ee, Employees mng where ee.reports_to = mng. employee_id group by mng.employee_id order by mng.employee_id "
14,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY employee_id ORDER BY employee_id"
15,"select e.employee_id, e.name, count(distinct r.employee_id) as reports_count, round(avg(r.age), 0) as average_age from Employees e join Employees r on e.employee_id = r.reports_to group by employee_id"
16,"SELECT e1.employee_id, e1.name, COUNT(*) reports_count, ROUND(AVG(e2.age)) average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY e1.employee_id"
17,"SELECT e1.employee_id, e1.name, COUNT(e2.reports_to) AS reports_count, ROUND(AVG(e2.age),0) AS average_age FROM Employees e1, Employees e2 WHERE e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY employee_id ASC "
18,"select e1.reports_to as employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age)) as average_age from employees as e1 join employees as e2 on e1.reports_to = e2.employee_id group by e1.reports_to order by e1.reports_to"
19,"SELECT E1.reports_to AS employee_id, E2.name AS name, COUNT(E1.employee_id) AS reports_count, ROUND(AVG(E1.age),0) AS average_age FROM Employees AS E1 INNER JOIN Employees AS E2 ON E1.reports_to = E2.employee_id GROUP BY E1.reports_to HAVING COUNT(E1.employee_id)>0 ORDER BY E1.reports_to"
20,"select e2.employee_id, e2.name, count(e1.employee_id) as reports_count, round((avg(e1.age))) as average_age from Employees e1 join Employees e2 on e1.reports_to = e2.employee_id group by e2.employee_id order by e2.employee_id "
21,"select e1.employee_id, e1.name, count(*) as reports_count, round(avg(e2.age), 0) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id "
22,"select e1.reports_to as employee_id, e2.name, count(*) as reports_count, round(avg(e1.age),0) as average_age from Employees e1 join Employees e2 on e1.reports_to = e2.employee_id GROUP BY 1,2 Order By 1,2 "
23,"select e.employee_id, e.name, count(distinct r.employee_id) as reports_count, round(avg(r.age),0) as average_age from Employees as e left join Employees as r on r.reports_to = e.employee_id where r.employee_id is not null group by 1, 2 order by 1"
24,"select a.employee_id, a.name, count(b.employee_id) as reports_count, round(avg(b.age)) as average_age from Employees a , Employees b where a.employee_id = b.reports_to group by a.employee_id order by a.employee_id"
25,"SELECT E2.employee_id, E2.name, COUNT(DISTINCT E1.employee_id) reports_count, ROUND(AVG(E1.age)) average_age FROM employees E1 JOIN employees E2 ON E1.reports_to = E2.employee_id GROUP BY 1,2 ORDER BY 1 "
26,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
27,"SELECT A.employee_id, A.name, COUNT(B.name) reports_count, ROUND(AVG(B.age) )average_age FROM Employees A LEFT JOIN Employees B ON A.employee_id = B.reports_to WHERE B.name IS NOT NULL GROUP BY A.employee_id, A.name ORDER BY A.employee_id"
28,"select e1.reports_to as employee_id, e2.name, count(e2.employee_id) as reports_count, round(avg(e1.age),0) as average_age from Employees e1 inner join Employees e2 on e1.reports_to=e2.employee_id group by employee_id order by employee_id "
29,"Select e1.reports_to as employee_id, e2.name, count(e1.reports_to) reports_count, round(avg(e1.age),0) average_age from employees e1, employees e2 where e1.reports_to=e2.employee_id group by e1.reports_to order by e1.reports_to "
30,"SELECT e1.employee_id, e1.name, COUNT(*) as reports_count, ROUND(AVG(e2.age), 0) as average_age FROM Employees AS e1 JOIN Employees AS e2 ON e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY e1.employee_id"
31,"select m.employee_id, m.name, count(distinct e.employee_id) as reports_count, round(avg(e.age)) as average_age from Employees m join Employees e on e.reports_to = m.employee_id group by 1 order by 1"
32,"select t.employee_id , t.name , count(t.employee_id) as reports_count , round(avg(t.age)) as average_age from (select l.employee_id,l.name,r.age from Employees l join Employees r on l.employee_id = r.reports_to) as t group by t.employee_id order by t.employee_id"
33,"SELECT e2.employee_id , e2.name , COUNT(DISTINCT e1.employee_id) AS reports_count , ROUND(AVG(e1.age)) AS average_age FROM employees e1 JOIN employees e2 ON e1.reports_to=e2.employee_id GROUP BY e2.employee_id "
34,"select e1.employee_id,e1.name,count(e1.employee_id)as reports_count, round(avg(e2.age),0) as average_age from employees e1 inner join employees e2 on e1.employee_id=e2.reports_to group by e1.employee_id order by e1.employee_id"
35,"SELECT b.employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
36,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
37,"with cte as (select reports_to, count(employee_id) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) select c.reports_to as employee_id, e.name, c.reports_count, c.average_age from Employees e join cte c on c.reports_to=e.employee_id order by 1"
38,"Select Employees.employee_id,Employees.name,tab1.cnt as reports_count,tab1.average_age as average_age from Employees inner join (Select coalesce(reports_to,0) as rt,count(reports_to) as cnt,round(avg(age)) as average_age from Employees where reports_to<>0 group by reports_to having count(reports_to)>=1) tab1 on tab1.rt=Employees.employee_id order by Employees.employee_id "
39,"select e1.reports_to as employee_id, e2.name, count(e2.employee_id) as reports_count, round(avg(e1.age),0) as average_age from Employees e1 inner join Employees e2 on e1.reports_to=e2.employee_id group by employee_id order by employee_id "
40,"select employee_id, name, count(distinct id) as reports_count, round(avg(age),0) as average_age from (select a.employee_id, b.employee_id as id,a.name,b.age from Employees a inner join Employees b on a.employee_id=b.reports_to) c group by employee_id,name"
41,"SELECT e2.employee_id, e2.name, count(*) reports_count, round( avg(e1.age),0 ) as average_age from Employees e1 join Employees e2 on e1.reports_to=e2.employee_id group by e2.employee_id, e2.name order by employee_id"
42,"select e2.reports_to as employee_id, e1.name, count(*) as reports_count, round(avg(e2.age)) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e2.reports_to order by e2.reports_to "
43,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age)) as average_age from Employees a, employees b where a.employee_id = b.reports_to group by 1 order by 1 "
44,"WITH CTE1 AS ( SELECT reports_to AS employee_id, COUNT(*) AS reports_count, ROUND(AVG(age), 0) AS average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to) SELECT CTE1.employee_id, Employees.name, reports_count, average_age FROM CTE1 JOIN Employees ON CTE1.employee_id = Employees.employee_id ORDER BY employee_id"
45,"Select e1.employee_id employee_id, e1.name name, count(e2.employee_id) reports_count, round(avg(e2.age)) as average_age from Employees e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e1.employee_id, e1.name order by e1.employee_id"
46,"SELECT M.employee_id, M.name, COUNT(M.employee_id) AS reports_count, ROUND(AVG(E.age), 0) AS average_age FROM Employees E JOIN (SELECT DISTINCT employee_id, name FROM Employees) AS M ON E.reports_to = M.employee_id GROUP BY M.employee_id ORDER BY M.employee_id "
47,"select e2.employee_id, e2.name, count(distinct e1.employee_id) as reports_count, round(avg(e1.age), 0) as average_age from employees e1 left join employees e2 on e1.reports_to = e2.employee_id where e1.reports_to is not null group by 1,2 order by 1 "
48,"select e2.employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age)) as average_age from Employees as e1 join Employees as e2 on e1.reports_to = e2.employee_id group by e2.employee_id order by e2.employee_id "
49,"select a.employee_id,a.name, count(b.name) reports_count, round(avg(b.age),0) average_age from Employees a join Employees b on a.employee_id = b.reports_to group by a.employee_id order by a.employee_id "
50,"select e.employee_id, e.name, count(distinct r.employee_id) as reports_count, round(avg(r.age), 0) as average_age from Employees e join Employees r on e.employee_id = r.reports_to group by employee_id "
51,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age),0) as average_age from employees a join employees b where a.employee_id=b.reports_to group by employee_id order by employee_id"
52,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(M.AGE)) AVERAGE_AGE FROM EMPLOYEES E, EMPLOYEES M WHERE M.REPORTS_TO = E.EMPLOYEE_ID GROUP BY E.EMPLOYEE_ID, E.NAME ORDER BY E.EMPLOYEE_ID"
53,"select e1.employee_id, e1.name, count(*) as reports_count, round(avg(e2.age)) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id"
54,"SELECT e2.employee_id, e2.name, COUNT(e1.reports_to) AS reports_count, ROUND(AVG(e1.age), 0) AS average_age FROM Employees AS e1 INNER JOIN Employees AS e2 ON e1.reports_to=e2.employee_id GROUP BY e2.employee_id, name ORDER BY e2.employee_id"
55,"select d.employee_id, d.name, count(e.employee_id) reports_count, round(avg(e.age)) average_age from employees e join employees d on e.reports_to = d.employee_id group by d.employee_id, d.name order by 1"
56,"SELECT E1.reports_to AS employee_id, E2.name AS name, COUNT(E1.employee_id) AS reports_count, ROUND(AVG(E1.age),0) AS average_age FROM Employees AS E1 INNER JOIN Employees AS E2 ON E1.reports_to = E2.employee_id GROUP BY E1.reports_to HAVING COUNT(E1.employee_id)>0 ORDER BY employee_id"
57,"select m.employee_id employee_id, m.name name, count(*) reports_count, round(avg(e.age), 0) average_age from employees m inner join employees e on e.reports_to = m.employee_id group by m.employee_id order by m.employee_id "
58,"SELECT E1.reports_to AS employee_id, E2.name AS name, COUNT(E1.employee_id) AS reports_count, ROUND(AVG(E1.age),0) AS average_age FROM Employees AS E1 INNER JOIN Employees AS E2 ON E1.reports_to = E2.employee_id GROUP BY E1.reports_to HAVING COUNT(E1.employee_id)>0 ORDER BY employee_id"
59,"select m.employee_id, m.name, count(m.employee_id) as reports_count, round(avg(e.age)) as average_age from employees e join employees m on e.reports_to = m.employee_id group by m.employee_id having count(*)>=1 order by 1"
60,"select e1.employee_id, e1.name, e2.reports_count, e2.average_age from employees e1 join (select count(name) as reports_count,reports_to, round(AVG(age)) as average_age from employees group by reports_to) e2 on e1.employee_id = e2.reports_to order by e1.employee_id"
61,"select employee_id, name, count(*) as reports_count, round(avg(age),0) as average_age from ( select e1.employee_id, e1.name, e2.age from employees e1 join employees e2 on e1.employee_id = e2.reports_to and e1.employee_id is not null and e2.reports_to is not null ) a group by 1,2 order by 1"
62,"select a.reports_to as employee_id, b.name, count(distinct a.employee_id) as reports_count, round(avg(a.age)) as average_age from Employees a join Employees b on a.reports_to = b.employee_id group by employee_id order by employee_id"
63,"select m.employee_id, m.name,count(e.reports_to) as reports_count, round(avg(e.age),0) as average_age from employees m, employees e where m.employee_id = e.reports_to group by 1 order by 1"
64,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age),0) as average_age from employees as a join employees as b on a.employee_id = b.reports_to group by a.employee_id order by a.employee_id"
65,"select a.employee_id, a.name, count(*) as reports_count, round(avg(b.age)) as average_age from Employees a, Employees b where a.employee_id = b.reports_to group by 1,2 order by 1"
66,"select distinct e1.employee_id, e1.name, count(e2.reports_to) as reports_count, round(avg(e2.age)) as average_age from Employees e1 left join Employees e2 on e1.employee_id = e2.reports_to where e2.name is not null group by e1.employee_id order by 1"
67,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1"
68,"with cte as ( select reports_to,count(distinct employee_id) as total, round(avg(age),0) as average_age from employees group by reports_to ) select cte.reports_to as employee_id,e.name,cte.total as reports_count, cte.average_age from cte join employees as e on cte.reports_to=e.employee_id order by employee_id"
69,"SELECT a.Employee_id, a.name, COUNT(b.employee_id) AS reports_count, ROUND(avg(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY a.employee_id ORDER BY a.employee_id"
70,"SELECT m.employee_id, m.name, COUNT(DISTINCT(e.employee_id)) AS reports_count, ROUND(AVG(e.age),0) AS average_age FROM Employees e INNER JOIN Employees m ON e.reports_to = m.employee_id WHERE e.reports_to IS NOT NULL GROUP BY m.employee_id"
71,"select e1.employee_id , e1.name ,count(e2.reports_to)as reports_count , round(avg(e2.age)) as average_age from Employees as e1 join Employees as e2 on (e1.employee_id = e2.reports_to) group by e1.employee_id order by e1.employee_id "
72,"select t1.employee_id, t1.name, sum(case when t2.reports_to is not null then 1 else 0 end) as reports_count, round(avg(t2.age),0) as average_age from employees t1 join employees t2 on t1.employee_id = t2.reports_to group by 1 order by 1"
73,"select e2.employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age)) as average_age from employees e1, employees e2 where e2.employee_id=e1.reports_to group by e2.employee_id order by e2.employee_id"
74,"with cte as ( select reports_to as employee_id, count(reports_to) as reports_count, round(avg(age)) as average_age from Employees where reports_to in (select distinct employee_id from Employees) group by 1) select cte.employee_id,e.name,cte.reports_count, cte.average_age from Employees e join cte on e.employee_id = cte.employee_id order by 1 "
75,"SELECT DISTINCT b.employee_id, b.name, COUNT(a.employee_id) AS reports_count, ROUND(AVG(a.age),0) AS average_age FROM Employees a LEFT JOIN Employees b ON a.reports_to = b.employee_id WHERE a.reports_to IS NOT NULL GROUP BY b.employee_id ORDER BY b.employee_id "
76,"Select e.employee_id as employee_id, e.name as name, reports_count, gh.age as average_age from Employees e JOIN (select distinct reports_to,count(reports_to) as reports_count, ROUND(AVG(age)) as age from Employees group by reports_to) gh on gh.reports_to = e.employee_id order by employee_id asc "
77,"select a.reports_to as employee_id, b.name, count(distinct a.employee_id) as reports_count, round(avg(a.age), 0) as average_age from Employees a left join Employees b on a.reports_to = b.employee_id where a.reports_to is not null group by 1,2"
78,"with cte as (select reports_to, count(employee_id) as reports_count, round(avg(age)) as average_age from employees where reports_to is not null group by reports_to) select employee_id, name, reports_count, average_age from cte inner join employees a on cte.reports_to = a.employee_id order by a.employee_id "
79,"SELECT m.employee_id, m.name as name, COUNT(e.employee_id) as reports_count, ROUND(AVG(e.age),0) as average_age from Employees m join employees e on m.employee_id = e.reports_to GROUP BY employee_id ORDER BY employee_id"
80,"select M.employee_id, M.name, count(E.reports_to) as reports_count, round(((sum(E.age))/count(E.reports_to))) as average_age from Employees E inner join Employees M on E.reports_to = M.employee_id group by M.employee_id order by M.employee_id"
81,"with cte as (select reports_to , count(employee_id) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) select employee_id, name, reports_count, average_age from cte inner join Employees a on cte.reports_to = a.employee_id order by a.employee_id "
82,"select m.employee_id employee_id, m.name name, count(*) reports_count, round(avg(e.age), 0) average_age from employees m inner join employees e on e.reports_to = m.employee_id group by m.employee_id order by m.employee_id "
83,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
84,"select a.employee_id, a.name, count(*) as reports_count, round(avg(b.age)) as average_age from employees a, employees b where a.employee_id=b.reports_to group by a.employee_id order by employee_id"
85,"with cte as (select reports_to, count(employee_id) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) select c.reports_to as employee_id, e.name, c.reports_count, c.average_age from Employees e join cte c on c.reports_to=e.employee_id order by 1 "
86,"select e1.employee_id , e1.name ,count(*) as reports_count ,round(avg(e2.age)) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id"
87,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1, 2 ORDER BY 1"
88,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1"
89,"select e1.reports_to as employee_id,e2.name,count(e1.employee_id) as reports_count, ROUND(avg(e1.age),0) as average_age from Employees as e1 left join Employees as e2 on e1.reports_to = e2.employee_id group by e1.reports_to having e1.reports_to is not NUll order by employee_id"
90,"with cte as ( select reports_to, count(distinct employee_id) as reports_count, round(avg(age), 0) as average_age from Employees group by reports_to ) select e.employee_id, e.name, cte.reports_count, cte.average_age from Employees e join cte on e.employee_id = cte.reports_to order by employee_id "
91,"select a.employee_id, a.name as name, count(distinct b.employee_id) as reports_count, round(avg(b.age)) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by a.employee_id,a.name order by 1 "
92,"SELECT a.manager_id as employee_id,a.manager_name as name, COUNT(*) as reports_count,round(AVG(a.age),0) as average_age FROM (SELECT E.employee_id,E.name as employee_name, m.employee_id as manager_id,m.name as manager_name,E.age FROM Employees E JOIN Employees M on E.reports_to = M.employee_id)a group by a.manager_id,a.manager_name order by employee_id"
93,"SELECT b.employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
94,"SELECT e1.reports_to AS employee_id, e2.name, COUNT(*) AS reports_count, ROUND(AVG(e1.age),0) AS average_age FROM Employees AS e1 JOIN Employees AS e2 ON e1.reports_to = e2.employee_id GROUP BY employee_id ORDER BY employee_id"
95,"SELECT e2.employee_id, e2.name, count(e1.name) as reports_count, round(avg(e1.age),0) as average_age FROM employees e1 inner join employees e2 on e1.reports_to = e2.employee_id and e1.reports_to is not null GROUP BY e2.employee_id, e2.name having count(e1.name) >= 1 order by employee_id"
96,"select a.employee_id, a.name, count(*) as reports_count, round(avg(b.age)) as average_age from Employees a inner join Employees b on a.employee_id = b.reports_to group by employee_id order by employee_id asc"
97,"select e.employee_id as employee_id, e.name as name, count(m.employee_id) as reports_count, round(avg(m.age)) as average_age from Employees e , Employees m where e.employee_id = m.reports_to group by e.employee_id order by e.employee_id"
98,"SELECT t1.employee_id,t1.name,count(t2.age) as reports_count, round(avg(t2.age))as average_age FROM Employees t1 JOIN Employees t2 ON t1.employee_id=t2.reports_to GROUP BY t1.employee_id ORDER BY t1.employee_id"
99,"select e1.reports_to as employee_id, e2.name as name, count(e1.name) as reports_count, round(avg(e1.age),0) as average_age from employees as e1 join employees as e2 on e1.reports_to = e2.employee_id group by employee_id order by employee_id "
100,"select m.employee_id employee_id, m.name name, count(*) reports_count, round(avg(e.age), 0) average_age from employees m inner join employees e on e.reports_to = m.employee_id group by m.employee_id order by m.employee_id "
101,"select e2.employee_id, e2.name as name, count(e1.name) as reports_count, round(avg(e1.age),0) as average_age from employees e1 join employees e2 on e2.employee_id=e1.reports_to group by 1 order by 1"
102,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1 "
103,"SELECT e2.employee_id, e2.name, COUNT(e1.reports_to) as reports_count, ROUND(AVG(e1.age),0) as average_age FROM Employees e1 LEFT JOIN Employees e2 ON e1.reports_to = e2.employee_id WHERE e1.reports_to IS NOT NULL GROUP BY 1 ORDER BY 1"
104,"SELECT E1.EMPLOYEE_ID , E1.NAME , COUNT(*) AS REPORTS_COUNT , ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1,2"
105,"SELECT e.employee_id, e.name, t.reports_count, t.average_age FROM Employees e RIGHT JOIN (SELECT reports_to AS manager, COUNT(DISTINCT employee_id) AS reports_count, ROUND(AVG(age),0) AS average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY 1) t ON e.employee_id = t.manager "
106,"select a.reports_to as employee_id, b.name, count(a.name) as reports_count, round(avg(a.age),0) as average_age from employees a join employees b on a.reports_to = b.employee_id group by 1,2 order by 1,2 "
107,"select e1.employee_id, e1.name, count(e2.reports_to) as reports_count, round(avg(e2.age),0) as average_age from Employees e1 join Employees e2 on e1.employee_id=e2.reports_to group by 1,2 order by 1"
108,"WITH TeamStats AS (SELECT reports_to AS employee_id ,COUNT(employee_id) AS reports_count ,ROUND(AVG(age)) AS average_age FROM Employees GROUP BY reports_to) SELECT E.employee_id ,E.name ,TS.reports_count ,TS.average_age FROM Employees E INNER JOIN TeamStats TS ON E.employee_id = TS.employee_id ORDER BY 1 ASC"
109,"with cte as (select reports_to , count(employee_id) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) select a.employee_id, a.name, reports_count, average_age from cte inner join Employees a on cte.reports_to = a.employee_id order by a.employee_id "
110,"select a.employee_id, a.name, count(distinct b.employee_id) as reports_count, round(avg(b.age),0) as average_age from Employees as a join Employees as b on a.employee_id = b.reports_to group by a.employee_id, a.name order by a.employee_id"
111,"select b.reports_to employee_id, a.name name, count(b.employee_id) reports_count, round(avg(b.age),0) average_age from employees a join employees b on a.employee_id=b.reports_to group by b.reports_to, a.name order by 1"
112,"select e1.reports_to as employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age),0) as average_age from employees e1 join employees e2 on e1.reports_to=e2.employee_id group by e1.reports_to order by e1.reports_to"
113,"SELECT E1.employee_id, E1.name, COUNT(E2.reports_to) AS reports_count, ROUND(AVG(E2.age)) AS average_age FROM Employees AS E1 JOIN Employees AS E2 ON E1.employee_id = E2.reports_to GROUP BY E1.employee_id ORDER BY E1.employee_id"
114,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
115,"select m.employee_id, m.name, count(distinct e.employee_id) as reports_count, round(avg(e.age)) as average_age from Employees m join Employees e on e.reports_to = m.employee_id group by 1"
116,"select e1.employee_id, e1.name, count(e2.employee_id) as reports_count, round(avg(e2.age),0) as average_age from Employees e1 join Employees e2 on e2.reports_to = e1.employee_id group by e1.employee_id order by e1.employee_id"
117,"SELECT e1.reports_to AS employee_id, e2.name, COUNT(e1.employee_id) AS reports_count, ROUND(AVG(e1.age),0) AS average_age FROM Employees e1 INNER JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e1.reports_to, e2.name ORDER BY employee_id"
118,"select e.employee_id,e.name,count(distinct f.employee_id) as reports_count,round(avg(f.age)) as average_age from employees e join employees f on e.employee_id = f.reports_to group by e.employee_id,e.name order by employee_id"
119,"SELECT a.reports_to AS employee_id, b.name, count(distinct a.employee_id) AS reports_count, round(avg(a.age), 0) AS average_age FROM Employees a JOIN Employees b ON a.reports_to=b.employee_id WHERE a.reports_to IS NOT NULL GROUP BY 1 ORDER BY 1 "
120,"select e1.reports_to as employee_id,e2.name,count(distinct e1.employee_id)as reports_count, round(avg(e1.age))as average_age from employees e1 left join employees e2 on e1.reports_to=e2.employee_id where e1.reports_to is not null group by 1 order by 1"
121,"select a.employee_id ,a.name ,count(b.employee_id) as reports_count ,round(avg(b.age),0) as average_age from Employees a inner join Employees b on a.employee_id = b.reports_to GROUP BY employee_id ORDER BY employee_id"
122,"select a.reports_to as employee_id, b.name , count(a.employee_id) reports_count, round(avg(a.age),0) average_age from Employees a left join Employees b on a.reports_to = b.employee_id group by 1 having employee_id is not null order by 1"
123,"select b.employee_id, b.name, count(a.reports_to) as reports_count, round(avg(a.age),0) as average_age from employees a inner join employees b on a.reports_to=b.employee_id group by 1, 2 order by 1"
124,"select m.employee_id, m.name,count(e.reports_to) as reports_count, round(avg(e.age),0) as average_age from employees m, employees e where m.employee_id = e.reports_to group by e.reports_to order by 1"
125,"select e1.employee_id, e1.name,count(e2.reports_to) as reports_count, round(avg(e2.age),0) as average_age from employees e1 join employees e2 on e1.employee_id = e2.reports_to group by 1,2 order by e1.employee_id"
126,"select e2.employee_id, e2.name, count(*) as reports_count, round(avg(e1.age)) as average_age from employees e1 join employees e2 on e1.reports_to=e2.employee_id group by e2.employee_id order by 1"
127,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1"
128,"select a.employee_id, a.name, count(*) as reports_count, round(avg(b.age)) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by 1 order by 1 "
129,"SELECT a.employee_id, a.name, COUNT(b.reports_to) as reports_count, ROUND(AVG(b.age)) as average_age FROM employees a JOIN employees b ON a.employee_id = b.reports_to GROUP BY b.reports_to ORDER BY 1"
130,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age)) as average_age from employees a join employees b on a.employee_id = b.reports_to group by a.employee_id, a.name order by a.employee_id"
131,"select e1.employee_id, e1.name, count(e2.reports_to) as reports_count, round(avg(e2.age),0) as average_age from Employees e1 inner join Employees e2 on e2.reports_to = e1.employee_id group by e1.employee_id, e1.name order by e1.employee_id "
132,"SELECT E1.employee_id, E1.name, SUM(IF(E2.reports_to, 1, 0)) AS reports_count, ROUND(AVG(E2.age), 0) AS average_age FROM Employees E1 JOIN Employees E2 ON E1.employee_id = E2.reports_to GROUP BY 1, 2 ORDER BY 1 "
133,"SELECT a.employee_id, a.name, COUNT(*) as reports_count, ROUND(AVG(b.age),0) as average_age FROM Employees a JOIN Employees b ON a.employee_id = b.reports_to GROUP BY 1, 2 ORDER BY 1"
134,"select M.employee_id, M.name, count(E.employee_id) as reports_count, round(avg(E.age),0) as average_age from Employees E inner join Employees M on E.reports_to = M.employee_id group by M.employee_id, M.name order by M.employee_id"
135,"select a.employee_id ,a.name ,count(b.employee_id) as reports_count ,round(avg(b.age),0) as average_age from Employees a inner join Employees b on a.employee_id = b.reports_to GROUP BY 1,2 order by 1,2 "
136,"SELECT e1.reports_to AS employee_id, e2.name AS name, COUNT(DISTINCT e1.employee_id) AS reports_count, ROUND(AVG(e1.age), 0) AS average_age FROM Employees e1 LEFT JOIN Employees e2 ON e1.reports_to = e2.employee_id WHERE e1.reports_to IS NOT NULL GROUP BY 1, 2"
137,"select a.employee_id, a.name, count(b.employee_id) as reports_count, round(avg(b.age)) as average_age from Employees a , Employees b where a.employee_id = b.reports_to group by a.employee_id order by a.employee_id"
138,"select e1.reports_to employee_id, e2.name name, count(e1.employee_id) reports_count, round(avg(e1.age),0) average_age from Employees e1 left join Employees e2 on e1.reports_to = e2.employee_id where e1.reports_to is not null group by 1 order by 1"
139,"select e.employee_id, e.name, count(e1.employee_id) as reports_count, ROUND(avg(e1.age) )as average_age from employees e join employees e1 on e.employee_id=e1.reports_to group by 1 order by 1"
140,"SELECT e2.employee_id, e2.name, COUNT(e1.employee_id) AS 'reports_count', ROUND(AVG(e1.age)) AS 'average_age' FROM Employees e2 INNER JOIN Employees e1 ON e1.reports_to = e2.employee_id GROUP BY e1.reports_to ORDER BY e2.employee_id "
141,"SELECT e2.employee_id as employee_id, e2.name as name, COUNT(*) as reports_count, ROUND(AVG(e1.age)) as average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY 1 ORDER BY 1 "
142,"select b.employee_id,b.name,count(*)reports_count,ifnull(round(avg(e.age)),0)average_age from employees b join employees e on b.employee_id = e.reports_to group by 1 order by 1"
143,"select reports_to as employee_id, ManagerName as Name, count(*) as reports_count, round(avg(age),0) as average_age from ( select E.*, M.name as ManagerName from Employees E join Employees M on E.reports_to = M.employee_id where E.reports_to is not null )t1 group by reports_to, ManagerName order by reports_to asc"
144,"select a.reports_to as employee_id, b.name as name, count(distinct a.employee_id) as reports_count, round(avg(a.age)) as average_age from Employees a inner join Employees b on a.reports_to = b.employee_id group by employee_id order by employee_id "
145,"Select distinct b.employee_id, b.name, count(*) as reports_count, Round(avg(a.age),0) average_age From Employees a join Employees b on a.reports_to = b.employee_id Group by b.employee_id Order by b.employee_id"
146,"SELECT e1.employee_id AS employee_id, e1.name AS name, COUNT(*) AS reports_count, ROUND(AVG(e2.age)) AS average_age FROM Employees AS e1 JOIN Employees AS e2 ON e1.employee_id = e2.reports_to GROUP BY employee_id ORDER BY employee_id"
147,"select e.reports_to employee_id, m.name name, count(e.employee_id) reports_count, round(avg(e.age)) average_age from employees e join employees m on e.reports_to=m.employee_id group by 1 order by 1 "
148,"WITH c1 AS (SELECT e2.employee_id, e2.name, e1.employee_id AS reports_from, e1.age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id) SELECT employee_id, name , COUNT(reports_from) AS reports_count, ROUND(AVG(age)) AS average_age FROM c1 GROUP BY employee_id, name ORDER BY employee_id"
149,"select e1.employee_id, e1.name, count(e2.employee_id) reports_count, round(avg(e2.age)) average_age from employees e1 join employees e2 on e2.reports_to = e1.employee_id group by e1.employee_id order by 1"
150,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1 "
151,"with cte as ( select e.employee_id, e.name as employee_name, e.reports_to as manager_id, m.name as manager, e.age as employee_age from Employees e join Employees m on m.employee_id = e.reports_to) select manager_id as employee_id, manager as name , count(employee_id) as reports_count, round(avg(employee_age),0) as average_age from cte group by 1,2 order by 1"
152,"select e.reports_to as employee_id, m.name as name, COUNT(DISTINCT e.employee_id) as reports_count, ROUND(AVG(e.age),0) as average_age FROM Employees e JOIN Employees m ON e.reports_to = m.employee_id GROUP BY e.reports_to ORDER By e.reports_to "
153,"select e.employee_id, e.name, count(e1.employee_id) as reports_count, ROUND(avg(e1.age) )as average_age from employees e join employees e1 on e.employee_id=e1.reports_to group by 1 order by 1"
154,"WITH managers AS ( SELECT B.employee_id,A.name,A.employee_id as subordinate,B.name as manager,A.age FROM (Employees as A) JOIN (Employees as B) ON A.reports_to = B.employee_id ) SELECT employee_id, manager as name, COUNT(subordinate) as reports_count, ROUND(AVG(age)) as average_age FROM managers GROUP BY employee_id ORDER BY employee_id"
155,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age)) as average_age from employees a join employees b on a.employee_id = b.reports_to group by a.employee_id order by a.employee_id"
156,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1 "
157,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age)) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by 1 order by 1"
158,"with cte as(select a.employee_id,a.name,b.age from employees a left join employees b on a.employee_id=b.reports_to) select employee_id,name,count(age) as reports_count, round(avg(age),0) as average_age from cte where age is not null group by 1 order by 1"
159,"SELECT a.employee_id, a.name, COUNT(b.reports_to) as reports_count, ROUND(AVG(b.age),0) as average_age FROM Employees a JOIN Employees b ON a.employee_id = b.reports_to GROUP BY 1, 2 ORDER BY 1"
160,"select distinct E.employee_id,E.name, count(E.employee_id) as reports_count, round(avg(E1.age),0) as average_age from Employees E, Employees E1 where E.employee_id=E1.reports_to group by E.employee_id order by E.employee_id "
161,"select manager_id as employee_id, name, val as reports_count, average_age from employees e join ( select reports_to as manager_id, count(employee_id) as val, round(avg(age)) average_age from employees where reports_to is not null group by reports_to) o on e.employee_id=o.manager_id order by employee_id"
162,"select a.reports_to as employee_id, b.name, count(a.name) as reports_count, round(avg(a.age),0) as average_age from Employees a join Employees b on a.reports_to=b.employee_id group by 1,2 order by 1,2"
163,"select a.employee_id, a.name, count(*) 'reports_count', round(avg(b.age)) 'average_age' from employees a inner join employees b on a.employee_id = b.reports_to group by 1 order by 1 asc "
164,"WITH cte AS (SELECT DISTINCT reports_to AS employee_id, COUNT(employee_id) AS reports_count, ROUND(AVG(age), 0) AS average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to) SELECT cte.employee_id, e.name, cte.reports_count, cte.average_age FROM Employees AS e JOIN cte ON e.employee_id = cte.employee_id ORDER BY employee_id "
165,"with cte as (select reports_to , round(avg(age)) as average_age , count(employee_id) reports_count from Employees as mng where reports_to is not null group by reports_to) select e.employee_id , e.name , reports_count,average_age from cte join employees as e on cte.reports_to = e.employee_id order by e.employee_id "
166,"select a.reports_to as employee_id, b.name, count(distinct a.employee_id) as reports_count, round(avg(a.age)) as average_age from Employees a join Employees b on a.reports_to = b.employee_id group by 1 having reports_count >= 1 "
167,"select e.employee_id employee_id,e.name name ,count(b.employee_id) reports_count,Round(AVG(b.age),0) average_age from Employees e join Employees b on b.reports_to=e.employee_id group by 1 order by 1"
168,"SELECT a.reports_to AS employee_id, b.name, COUNT(*) AS reports_count, ROUND(AVG(a.age),0) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY a.reports_to ORDER BY employee_id"
169,"select e.employee_id, e.name, count(m.employee_id) as reports_count, round(avg(m.age),0) as average_age from Employees e, Employees m where m.reports_to = e.employee_id group by m.reports_to order by e.employee_id"
170,"SELECT employee_id, name, reports_count, average_age FROM ( SELECT DISTINCT reports_to, COUNT(*) reports_count, ROUND(AVG(age)) average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to ) s LEFT JOIN Employees e ON s.reports_to = e.employee_id ORDER BY employee_id "
171,"WITH result AS (SELECT m.employee_id, m.name, e.employee_id AS reports, e.age FROM employees AS m JOIN employees AS e ON m.employee_id = e.reports_to) SELECT employee_id, name, COUNT(reports) AS reports_count, ROUND(AVG(age)) AS average_age FROM result GROUP BY 1, 2 ORDER BY 1"
172,"select e1.employee_id, e1.name, count(*) as reports_count, round(avg(e2.age), 0) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id "
173,"WITH manager_ids AS ( SELECT reports_to as manager_id, COUNT(*) as reports_count,AVG(age) as average_age FROM employees Where reports_to is NOT NULL GROUP BY 1 ) SELECT employee_id, name,reports_count,ROUND(average_age,0) as average_age FROM Employees INNER JOIN manager_ids ON manager_ids.manager_id = employees.employee_id ORDER BY employee_id"
174,"select e1.reports_to as employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age),0) as average_age from Employees e1 join Employees e2 on e1.reports_to=e2.employee_id group by e1.reports_to order by e1.reports_to "
175,"select e1.employee_id as employee_id, e1.name as name, count(e2.employee_id) as reports_count, round(avg(e2.age),0) as average_age from employees e1 join employees e2 on e2.reports_to=e1.employee_id group by 1,2 order by 1"
176,"select e1.employee_id, e1.name, count(e2.employee_id) as reports_count, round(avg(e2.age), 0) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by 1, 2 order by 1"
177,"select e.employee_id employee_id, e.name name, count(*) reports_count, round(avg(e2.age)) average_age from Employees e join Employees e2 on e.employee_id=e2.reports_to group by e2.reports_to order by e.employee_id"
178,"select t1.employee_id, t1.name, count(t1.name) reports_count,round(avg(t1.age)) average_age from (select e1.employee_id employee_id, e1.name name,e2.name employee,e2.age age from employees e1 join employees e2 on e1.employee_id=e2.reports_to)t1 group by 1,2 order by 1 "
179,"Select r.employee_id as employee_id, r.name, count(e.employee_id) as reports_count, round(avg(e.age),0) as average_age FROM employees e JOIN employees r on r.employee_id = e.reports_to group by e.reports_to order by e.reports_to "
180,"select a.employee_id, a.name as name, count(distinct b.employee_id) as reports_count, round(avg(b.age)) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by a.employee_id order by 1 "
181,"Select a.employee_id, a.name, b.reports_count, b.average_age From Employees a Left join ( Select reports_to, count(reports_to) as reports_count, round(avg(age),0) as average_age From Employees Group by reports_to) as b on a.employee_id = b.reports_to where b.reports_count is not null Order by 1 "
182,"select a.employee_id, a.name, count(b.employee_id) as reports_count, round(avg(b.age),0) as average_age from employees a, employees b where a.employee_id = b.reports_to group by a.employee_id order by a.employee_id "
183,"select e.employee_id, e.name, count(distinct r.employee_id) as reports_count, round(avg(r.age), 0) as average_age from Employees e join Employees r on e.employee_id = r.reports_to group by employee_id "
184,"SELECT e2.employee_id, e2.name, COUNT(e1.employee_id) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e2.employee_id ORDER BY e2.employee_id "
185,"with cte as ( select reports_to, count(distinct employee_id) as reports_count, round(avg(age), 0) as average_age from Employees group by reports_to ) select e.employee_id, e.name, cte.reports_count, cte.average_age from Employees e join cte on e.employee_id = cte.reports_to order by employee_id "
186,"select a.employee_id, a.name, count(b.employee_id)as reports_count , round(avg(b.age),0) as average_age from employees a inner join employees b on a.employee_id = b.reports_to where b.reports_to is not null group by 1,2 order by a.employee_id asc"
187,"select e2.employee_id, e2.name, count(*) as reports_count, round(avg(e1.age),0) as average_age from employees e1 join employees e2 on e1.reports_to = e2.employee_id group by 1 order by 1"
188,"select a.employee_id,a.name,b.reports_count,b.average_age from employees a join (select distinct(reports_to) as manager, count(reports_to) as reports_count, round(avg(age)) as average_age from employees where reports_to is not null group by reports_to) b on a.employee_id = b.manager order by a.employee_id "
189,"select m.employee_id, m.name, count(r.reports_to) as reports_count,round(avg(r.age),0) as average_age from Employees m join Employees r on m.employee_id = r.reports_to group by m.employee_id order by m.employee_id"
190,"with temp as (select reports_to as employee_id, count(employee_id) as reports_count, round(avg(age),0) as average_age from employees where reports_to is not null group by reports_to) select temp.employee_id, employees.name, reports_count, average_age from temp left join employees on temp.employee_id = employees.employee_id order by temp.employee_id"
191,"SELECT m.employee_id, m.name, COUNT(DISTINCT e.employee_id) AS reports_count, ROUND(AVG(e.age),0) AS average_age FROM Employees e JOIN Employees m ON e.reports_to=m.employee_id GROUP BY 1,2"
192,"SELECT b.employee_id, b.name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id ORDER BY b.employee_id  "
193,"SELECT e2.reports_to As employee_id, e1.name, COUNT(e2.employee_id) AS reports_count , ROUND(AVG(e2.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY employee_id"
194,"SELECT e2.employee_id as employee_id, e2.name as name, COUNT(*) as reports_count, ROUND(AVG(e1.age)) as average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY 1 ORDER BY 1 "
195,"select e.employee_id, e.name, r.reports_count, r.average_age from (select reports_to, count(reports_to) as reports_count, round(avg(age), 0) as average_age from Employees where reports_to in (select employee_id from Employees) group by reports_to) r left join Employees e on e.employee_id = r.reports_to order by e.employee_id"
196,"SELECT b.employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
197,"select e1.reports_to as employee_id, e2.name, count(e1.name) as reports_count, round(avg(e1.age),0) as average_age from Employees as e1 join Employees as e2 on e1.reports_to=e2.employee_id where e1.reports_to is not null group by e1.reports_to order by employee_id "
198,"select m.employee_id employee_id, m.name name, count(*) reports_count, round(avg(e.age), 0) average_age from employees m inner join employees e on e.reports_to = m.employee_id group by m.employee_id order by m.employee_id "
199,"select e2.employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age)) as average_age from employees e1 join employees e2 on e2.employee_id=e1.reports_to group by 1 order by 1"
200,"SELECT e2.employee_id, e2.name, COUNT(*) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e2.employee_id ORDER BY e2.employee_id"
201,"select A.employee_id, A.name, count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id "
202,"select b.employee_id, b.name, count(*) as reports_count, round(avg(a.age),0) as average_age from employees a inner join employees b on a.reports_to = b.employee_id where b.employee_id is not null group by 1 order by 1"
203,"WITH counts as ( SELECT reports_to, count(distinct employee_id) as reports_count, avg(age) as average_age FROM Employees GROUP BY 1 ) SELECT c.reports_to as employee_id, e.name, c.reports_count, ROUND(c.average_age, 0) as average_age FROM counts c JOIN Employees e ON c.reports_to = e.employee_id WHERE c.reports_count is not null ORDER BY 1"
204,"select a.reports_to as employee_id, b.name as name, count(b.employee_id) as reports_count, round(avg(a.age),0) as average_age from employees a join employees b on a.reports_to=b.employee_id group by a.reports_to having count(a.reports_to)>=1 order by b.employee_id "
205,"select t1.employee_id, name, reports_count, average_age from (select reports_to as employee_id, count(1) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) t1 join Employees t2 on t1.employee_id = t2.employee_id order by t1.employee_id"
206,"with cte1 as(select employee_id, name from Employees), cte2 as (select reports_to, count(*) over(partition by reports_to) as reports_count, round(avg(age) over(partition by reports_to),0) as average_age from Employees), cte3 as (select distinct reports_to, reports_count, average_age from cte2 where reports_to is not null) select t2.employee_id, t2.name, t1.reports_count, t1.average_age from cte3 t1 left join cte1 t2 on t1.reports_to=t2.employee_id"
207,"select a.reports_to as employee_id, b.name, count(distinct a.employee_id) as reports_count, round(avg(a.age)) as average_age from employees a join employees b on a.reports_to = b.employee_id group by 1 order by 1"
208,"SELECT e1.employee_id, e1.name, COUNT(e2.employee_id) AS reports_count, ROUND(AVG(e2.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id=e2.reports_to GROUP BY e1.employee_id ORDER BY e1.employee_id"
209,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id ORDER BY b.employee_id "
210,"select a.reports_to as employee_id, b.name, count(a.employee_id) as reports_count, round(avg(a.age),0) as average_age from employees as a left join employees as b on a.reports_to = b.employee_id where a.reports_to is not null group by 1,2 order by 1"
211,"SELECT e1.employee_id, e1.name, COUNT(e2.reports_to) AS reports_count, ROUND(AVG(e2.age)) AS average_age FROM Employees AS e1, Employees AS e2 WHERE e1.employee_id = e2.reports_to GROUP BY employee_id ORDER BY employee_id"
212,"select e1.employee_id, e1.name, count(e2.reports_to) as reports_count, round(avg(e2.age),0) as average_age from employees e1 inner join employees e2 on e1.employee_id = e2.reports_to group by 1,2 order by 1 "
213,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
214,"select e.employee_id, e.name, count(distinct r.employee_id) as reports_count, round(avg(r.age),0) as average_age from Employees as e left join Employees as r on r.reports_to = e.employee_id where r.employee_id is not null group by 1, 2 order by 1"
215,"select a.reports_to as employee_id, b.name, count(distinct a.employee_id) as reports_count, round(avg(a.age)) as average_age from Employees a join Employees b on a.reports_to = b.employee_id group by employee_id order by employee_id"
216,"with rpt_info as ( select reports_to as mgr_id, count(*) as ct, avg(age) as avg_age from employees group by reports_to ) select ri.mgr_id as employee_id, e.name, ri.ct as reports_count, round(ri.avg_age) as average_age from rpt_info as ri inner join employees as e on ri.mgr_id = e.employee_id order by employee_id "
217,"select e1.employee_id, e1.name, count(*) reports_count, round(avg(e2.age),0) average_age from employees e1 join employees e2 on e1.employee_id = e2.reports_to group by e1.employee_id, e1.name having count(*) > 0 order by employee_id "
218,"select A.employee_id, A.name, count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
219,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
220,"select A.employee_id,A.name,count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id "
221,"select A.employee_id,A.name,count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
222,"SELECT b.employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
223,"with manager_info as ( select reports_to,count(distinct employee_id) as reports_count,ROUND(avg(age),0) as average_age from Employees where reports_to is not null group by reports_to ) select m.reports_to employee_id,e.name,m.reports_count,m.average_age from manager_info m inner join Employees e on e.employee_id=m.reports_to order by m.reports_to"
224,"select b.employee_id, b.name, count(a.employee_id) as reports_count, round(avg(a.age),0) as average_age from Employees a join Employees b on a.reports_to=b.employee_id group by 1 order by 1 "
225,"select e1.reports_to as employee_id, e2.name, count(e2.employee_id) as reports_count, round(avg(e1.age),0) as average_age from employees e1, employees e2 where e1.reports_to=e2.employee_id group by e1.reports_to order by e1.reports_to"
226,"SELECT a.reports_to AS employee_id, b.name, COUNT(*) AS reports_count, ROUND(AVG(a.age),0) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY a.reports_to HAVING a.reports_to IS NOT NULL ORDER BY employee_id"
227,"select a.employee_id, a.name, count(b.name) as reports_count, round(avg(b.age),0) as average_age from Employees a join Employees b on a. employee_id = b.reports_to group by a.employee_id order by a.employee_id "
228,"SELECT e2.employee_id, e2.name, COUNT(e1.employee_id) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e2.employee_id ORDER BY e2.employee_id"
229,"SELECT e2.reports_to employee_id, e1.name ,COUNT(*) as reports_count, ROUND(AVG(e2.age),0) as average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id = e2.reports_to GROUP BY e2.reports_to ORDER BY e2.reports_to"
230,"select E1.reports_to as employee_id, E.name, count(E1.employee_id) as reports_count, round(avg(E1.age)) as average_age from employees E1 join employees E on E1.reports_to = E.Employee_id where E1.reports_to is not null group by E1.reports_to order by employee_id"
231,"select A.employee_id,A.name,count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
232,"SELECT B.employee_id, B.name, COUNT(A.employee_id) AS reports_count, ROUND(AVG(A.age)) AS average_age FROM Employees A LEFT JOIN Employees B ON A.reports_to = B.employee_id WHERE ISNULL(B.employee_id) = FALSE GROUP BY B.employee_id ORDER BY 1 "
233,"select A.employee_id,A.name,count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
234,"select a.employee_id, a.name, count(*) as reports_count, round(avg(b.age)) as average_age from Employees a, Employees b where a.employee_id = b.reports_to group by 1 order by 1"
235,"select e2.employee_id as employee_id, e2.name as name, count(e1.reports_to) as reports_count, round(avg(e1.age)) as average_age from Employees e1 , Employees e2 where e2.employee_id = e1.reports_to group by e2.employee_id order by e2.employee_id"
236,"select e.reports_to as employee_id,ee.name as name,count(*)as reports_count,round(avg(e.age))average_age from employees e join employees ee on e.reports_to = ee.employee_id group by ee.employee_id order by ee.employee_id "
237,"select e1.employee_id, e1.name, count(e2.employee_id) as reports_count, round(avg(e2.age)) as average_age from employees e1 inner join employees e2 on e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id"
238,"select a.employee_id, a.name as name, count(distinct b.employee_id) as reports_count, round(avg(b.age)) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by a.employee_id order by 1 "
239,"select e.employee_id, e.name, count(e1.employee_id) as reports_count, ROUND(avg(e1.age) )as average_age from employees e join employees e1 on e.employee_id=e1.reports_to group by 1 order by 1"
240,"WITH a AS ( SELECT reports_to, COUNT(*) as reports_count, ROUND(AVG(age), 0) as average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to) SELECT a.reports_to as employee_id, Employees.name, a.reports_count, a.average_age FROM a JOIN Employees ON a.reports_to = Employees.employee_id ORDER BY employee_id "
241,"SELECT e2.employee_id, e2.name, COUNT(e1.employee_id) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e2.employee_id ORDER BY e2.employee_id"
242,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, ROUND(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1 "
243,"WITH managers AS( SELECT reports_to as employee_id, COUNT(DISTINCT employee_id) as reports_count, ROUND(AVG(age)) as average_age FROM employees GROUP BY reports_to HAVING reports_to IS NOT NULL ) SELECT m.employee_id, e.name, reports_count, average_age FROM managers m JOIN employees e ON m.employee_id = e.employee_id ORDER BY 1"
244,"select e.employee_id, e.name, count(1) as reports_count, round(avg(r.age),0) as average_age from employees r join employees e on r.reports_to = e.employee_id group by 1 order by 1"
245,"with temp as (select reports_to as employee_id, count(*) as reports_count, round(avg(age),0) as average_age from employees where reports_to is not null group by 1) select e1.employee_id, name, reports_count, average_age from temp e1 join employees e2 on e1.employee_id=e2.employee_id order by e1.employee_id"
246,"select m.employee_id, m.name, count(e.employee_id) as reports_count, round(avg(e.age), 0) as average_age from employees e inner join employees m on e.reports_to = m.employee_id group by m.employee_id order by m.employee_id"
247,"Select b.employee_id, b.name, count(distinct a.employee_id) reports_count, round(avg(a.age)) average_age from employees a join employees b on a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
248,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1"
249,"WITH temp AS (SELECT reports_to, COUNT(reports_to) AS counts, ROUND(AVG(age)) AS age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to) SELECT Employees.employee_id, Employees.name, temp.counts AS reports_count, temp.age AS average_age FROM Employees LEFT JOIN temp ON temp.reports_to=Employees.employee_id WHERE temp.counts>0 ORDER BY Employees.employee_id "
250,"SELECT e2.employee_id, e2.name, COUNT(e1.employee_id) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id WHERE e1.reports_to IS NOT NULL GROUP BY e1.reports_to ORDER BY e2.employee_id"
251,"Select x.employee_id, name,reports_count, average_age from Employees e inner join (Select reports_to as employee_id,count(*) as reports_count, round(avg(age),0) as average_age from Employees where reports_to is not null group by reports_to) x on e.employee_id = x.employee_id order by x.employee_id "
252,"SELECT e1.reports_to AS employee_id, e2.name, COUNT(e2.employee_id) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY 1 ORDER BY 1"
253,"select a.reports_to as employee_id, b.name , count(a.employee_id) reports_count, round(avg(a.age),0) average_age from Employees a left join Employees b on a.reports_to = b.employee_id group by 1 having employee_id is not null order by 1"
254,"select a.employee_id, a.name, count(*) as reports_count, round(avg(b.age)) as average_age from employees a join employees b on a.employee_id = b.reports_to group by 1 order by 1"
255,"select A.employee_id, A.name, count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
256,"select distinct e2.employee_id, e2.name, count(e1.employee_id) as reports_count, round(avg(e1.age)) as average_age from employees e1 join employees e2 on e1.reports_to = e2.employee_id group by 1, 2 order by employee_id"
257,"select m.employee_id , m.name , count(e.employee_id) reports_count, round(avg(e.age)) average_age from employees e , employees m where e.reports_to = m.employee_id group by m.employee_id order by 1"
258,"select a.reports_to as employee_id, b.name , count(a.employee_id) reports_count, round(avg(a.age),0) average_age from Employees a left join Employees b on a.reports_to = b.employee_id group by a.reports_to having employee_id is not null order by a.reports_to "
259,"SELECT a.employee_id, b.name, reports_count, average_age FROM (SELECT reports_to as employee_id, count(*) as reports_count, round(avg(age), 0) as average_age FROM employees WHERE reports_to IS NOT NULL GROUP BY reports_to HAVING count(*) > 0) as a LEFT JOIN employees b ON a.employee_id = b.employee_id ORDER BY employee_id"
260,"select e1.employee_id, e1.name, count(e1.employee_id=e2.reports_to) as reports_count, round(avg(e2.age),0) as average_age from employees e1 join employees e2 on e1.employee_id=e2.reports_to group by e1.employee_id order by e1.employee_id"
261,"SELECT e.employee_id, e.name, COUNT(*) as reports_count, ROUND(AVG(e1.age),0) as average_age FROM employees e INNER JOIN employees e1 on e1.reports_to = e.employee_id GROUP BY 1,2 ORDER BY 1"
262,"SELECT e1.reports_to AS employee_id, e2.name, COUNT(e1.employee_id) AS reports_count, ROUND(AVG(e1.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e1.reports_to, e2.name ORDER BY e1.reports_to"
263,"select m.employee_id, m.name, count(r.reports_to) as reports_count,round(avg(r.age),0) as average_age from Employees m join Employees r on m.employee_id = r.reports_to group by m.employee_id order by m.employee_id"
264,"with cet as (select e.employee_id, e.name, e.reports_to, m.name as manager_name, e.age from employees e left join employees m on e.reports_to=m.employee_id) select reports_to as employee_id, manager_name as name, count(reports_to) as reports_count, round(avg(age)) average_age from cet where reports_to is not null group by reports_to, manager_name order by 1"
265,"select e1.reports_to as employee_id, e2.name, count(distinct e1.employee_id) as reports_count, round(avg(e1.age),0) as average_age from employees e1 left join employees e2 on e1.reports_to = e2.employee_id where e1.reports_to is not null group by 1,2 order by 1"
266,"select e1.employee_id, e1.name, count(distinct e2.employee_id) as reports_count, round(avg(e2.age)) as average_age from Employees e1 inner join Employees e2 on e2.reports_to = e1.employee_id group by 1,2 order by 1"
267,"select t2.employee_id, t2.name, count(*) reports_count, round(avg(t1.age)) average_age from employees t1 join employees t2 on t1.reports_to = t2.employee_id group by t2.employee_id order by t2.employee_id "
268,"select m.employee_id,max(m.name) as name, count(e.employee_id) as reports_count , round(avg(e.age), 0) as average_age from employees as m join employees as e on m.employee_id=e.reports_to group by m.employee_id order by m.employee_id"
269,"select tb1.employee_id,tb1.name,count(tb2.reports_to) as reports_count, round(avg(tb2.age),0) as average_age from Employees tb2 join Employees tb1 on tb1.employee_id=tb2.reports_to group by tb1.employee_id,tb1.name order by tb1.employee_id "
270,"with cte as (select reports_to , count(employee_id) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) select employee_id, name, reports_count, average_age from cte inner join Employees a on cte.reports_to = a.employee_id order by a.employee_id"
271,"with cte as ( select reports_to, count(distinct employee_id) as reports_count, round(avg(age), 0) as average_age from Employees group by reports_to ) select e.employee_id, e.name, cte.reports_count, cte.average_age from Employees e join cte on e.employee_id = cte.reports_to order by employee_id "
272,"SELECT m.employee_id, m.name, COUNT(e.reports_to) AS reports_count, ROUND(AVG(e.age), 0) AS average_age FROM Employees e JOIN Employees m ON e.reports_to = m.employee_id GROUP BY 1 ORDER BY employee_id"
273,"Select b.employee_id, b.name, count(distinct a.employee_id) reports_count, round(avg(a.age)) average_age from employees a join employees b on a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
274,"select a.employee_id,a.name,count(b.employee_id) as reports_count,Round(avg(b.age),0) as average_age from Employees a join Employees b on a.employee_id=b.reports_to group by a.employee_id,a.name order by a.employee_id"
275,"SELECT e1.Employee_id, e1.name, COUNT(e2.name) AS reports_count, ROUND(AVG(e2.age),0) AS average_age FROM Employees e1 LEFT JOIN Employees e2 ON e1.employee_id=e2.reports_to GROUP BY e1.Employee_id HAVING COUNT(e2.name) >= 1 ORDER BY e1.Employee_id "
276,"WITH ManagerTeamDetails AS (SELECT reports_to ,COUNT(employee_id) AS counter ,AVG(age) AS average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to) SELECT E.employee_id ,E.name ,MTD.counter AS reports_count ,ROUND(MTD.average_age,0) AS average_age FROM Employees E INNER JOIN ManagerTeamDetails MTD ON MTD.reports_to = E.employee_id ORDER BY 1 ASC"
277,"select a.employee_id as employee_id, a.name as name, count(b.employee_id) as reports_count, round(avg(b.age)) as average_age from employees a inner join employees b on a.employee_id=b.reports_to group by a.employee_id order by a.employee_id "
278,"select e1.employee_id,e1.name,round(count(m.employee_id)) reports_count, round(avg(m.age)) average_age from employees e1 join employees m on e1.employee_id = m.reports_to group by e1.employee_id order by e1.employee_id"
279,"select e1.employee_id, ifnull(e1.name, 0) as name, ifnull(count(e2.reports_to),0) as reports_count, ifnull(round(avg(e2.age)),0) as average_age from employees e1, employees e2 where e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id"
280,"SELECT e1.employee_id, e1.name, COUNT(e2.employee_id) as reports_count, ROUND(AVG(e2.age),0) as average_age FROM Employees e1 INNER JOIN Employees e2 WHERE e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY e1.employee_id"
281,"with temp as ( SELECT reports_to ,SUM(1) AS reports_count ,ROUND(AVG(age)) AS average_age FROM Employees WHERE reports_to IS NOT NULL GROUP BY reports_to ) SELECT Employees.employee_id ,Employees.name ,temp.reports_count ,temp.average_age FROM temp INNER JOIN Employees ON temp.reports_to = Employees.employee_id ORDER BY Employees.employee_id "
282,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age), 0) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by a.employee_id, a.name order by 1"
283,"SELECT e1.employee_id, e1.name, count(*) as reports_count, ROUND(AVG(e2.age),0) AS average_age FROM Employees e1 LEFT JOIN Employees e2 ON e1.employee_id = e2.reports_to WHERE e2.employee_id is not null GROUP BY 1 ORDER BY 1 "
284,"select e1.employee_id, e1.name, count(e1.employee_id) as reports_count, round(avg(e2.age),0) as average_age from Employees as e1 join Employees as e2 on e1.employee_id = e2.reports_to group by e2.reports_to order by e1.employee_id"
285,"select t.reports_to as employee_id, e.name as name, t.reports_count, t.average_age from (select reports_to, count(*) as reports_count, round(avg(age),0) as average_age from employees where reports_to is not null group by reports_to) t join employees e on t.reports_to = e.employee_id order by employee_id "
286,"select e2.employee_id, e2.name, count(*) as reports_count, round(avg(e1.age),0) as average_age from employees as e1, employees as e2 where e1.reports_to = e2.employee_id group by 1 order by 1"
287,"select A.employee_id,A.name,count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
288,"WITH t as (SELECT a.employee_id, a.name, b.employee_id as reporter, b.age as reporter_age FROM employees a INNER JOIN employees b on a.employee_id = b.reports_to) SELECT employee_id, name, count(reporter) reports_count, round(AVG(reporter_age),0) as average_age FROM t GROUP BY employee_id ORDER BY employee_id ASC"
289,"SELECT T1.employee_id, T1.name, COUNT(*) AS reports_count, ROUND(AVG(T2.age), 0) AS average_age FROM Employees AS T1 JOIN Employees AS T2 ON T1.employee_id = T2.reports_to GROUP BY T1.employee_id HAVING COUNT(*) > 0 ORDER BY T1.employee_id "
290,"select m.employee_id, m.name, count(*) as reports_count, round(avg(e.age)) as average_age from Employees m, Employees e where e.reports_to = m.employee_id group by m.employee_id order by m.employee_id"
291,"SELECT a.employee_id, a.name, COUNT(a.employee_id) as reports_count, ROUND(AVG(b.age)) as average_age FROM employees a JOIN employees b ON a.employee_id = b.reports_to GROUP BY b.reports_to ORDER BY 1"
292,"select a.employee_id,a.name,count(distinct b.employee_id) as reports_count, round(avg(b.age)) as average_age from employees a join employees b on a.employee_id = b.reports_to group by 1 order by 1"
293,"with cte as ( select reports_to, count(distinct employee_id) as reports_count, round(avg(age), 0) as average_age from Employees group by reports_to ) select e.employee_id, e.name, cte.reports_count, cte.average_age from Employees e join cte on e.employee_id = cte.reports_to order by employee_id "
294,"SELECT e2.reports_to As employee_id, e1.name, COUNT(e2.employee_id) AS reports_count , ROUND(AVG(e2.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY employee_id"
295,"SELECT a.employee_id, a.name, COUNT(b.reports_to) as reports_count, ROUND(AVG(b.age), 0) as average_age FROM Employees a JOIN Employees b ON a.employee_id = b.reports_to GROUP BY 1, 2 ORDER BY 1 "
296,"select e1.employee_id, e1.name, count(*) as reports_count, round(avg(e2.age),0) as average_age from Employees e1 JOIN Employees e2 on e2.reports_to = e1.employee_id group by 1 order by 1"
297,"select reports_to as employee_id, (select e1.name from Employees e1 where e1.employee_id = Employees.reports_to) as name, count(employee_id) reports_count, round(sum(age)/count(employee_id)) as average_age from Employees group by reports_to having reports_to is not NULL order by employee_id"
298,"select e1.reports_to as employee_id, e2.name as name, count(e1.name) as reports_count, round(avg(e1.age),0) as average_age from employees e1 join employees e2 on e1.reports_to = e2.employee_id where e1.reports_to is not null group by 1 order by 1 "
299,"select e.employee_id, e.name, count(distinct r.employee_id) as reports_count, round(avg(r.age), 0) as average_age from Employees e join Employees r on e.employee_id = r.reports_to group by employee_id "
300,"SELECT e1.reports_to as employee_id, e2.name, count(e1.name) as reports_count, round(AVG(e1.age),0) as average_age FROM employees e1 INNER JOIN employees e2 on e1.reports_to = e2.employee_id GROUP BY e1.reports_to order by e1.reports_to"
301,"select e1.reports_to as employee_id, e2.name as name, count(e1.employee_id) as reports_count, round(avg(e1.age),0) as average_age from Employees e1 join Employees e2 on e1.reports_to = e2.employee_id where e1.reports_to is not null group by 1 order by 1"
302,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1 "
303,"select reports_to as employee_id, namee as name, count(employee_id) as reports_count, round( avg(age) , 0) as average_age from ( select e.* , e1.name as namee from Employees e join Employees e1 on e1.employee_id = e.reports_to) t group by reports_to order by employee_id"
304,"select b.employee_id as employee_id, b.name as name, count(a.employee_id) as reports_count, round(avg(a.age)) as average_age from employees a join employees b on a.reports_to = b.employee_id group by 1,2 order by employee_id "
305,"Select A.employee_id, A.name, count(B.reports_to) as reports_count, round(avg(B.age)) as average_age FROM Employees A, Employees B WHERE A.employee_id = B.reports_to group by A.employee_id order by A.employee_id "
306,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1"
307,"Select b.employee_id, b.name, count(distinct a.employee_id) reports_count, round(avg(a.age)) average_age from employees a join employees b on a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
308,"select m.employee_id,m.name, count(m.employee_id) reports_count,round(avg(e.age)) average_age from Employees e join Employees m on e.reports_to=m.employee_id group by m.employee_id,m.name order by employee_id asc"
309,"SELECT b.employee_id, b.name, COUNT(a.employee_id) AS reports_count, ROUND(AVG(a.age), 0) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1, 2 ORDER BY 1"
310,"with cte as (select reports_to, count(employee_id) as reports_count, round(avg(age)) as average_age from Employees where reports_to is not null group by reports_to) select e.employee_id, e.name, c.reports_count, c.average_age from Employees as e join cte as c on e.employee_id = c.reports_to order by e.employee_id"
311,"SELECT e1.employee_id As employee_id, e1.name, COUNT(e1.employee_id) AS reports_count , ROUND(AVG(e2.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id = e2.reports_to GROUP BY e1.employee_id ORDER BY employee_id "
312,"select a.reports_to as employee_id, b.name as name, count(*) as reports_count, round(avg(a.age)) as average_age from Employees a inner join Employees b on a.reports_to = b.employee_id group by employee_id order by employee_id "
313,"select e1.employee_id,e1.name, count(e2.reports_to) as reports_count, round(avg(e2.age)) as average_age from Employees e1 join employees e2 on e1.employee_id=e2.reports_to group by e1.employee_id, e1.name order by e1.employee_id"
314,"select e1.employee_id, e1.name, count(e2.reports_to) as reports_count, round(avg(e2.age),0) as average_age from Employees e1 join Employees e2 on e2.reports_to = e1.employee_id group by e1.employee_id order by e1.employee_id "
315,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id group by employee_id order by employee_id "
316,"SELECT A.REPORTS_TO EMPLOYEE_ID,B.NAME NAME,COUNT(A.REPORTS_TO) REPORTS_COUNT,ROUND(AVG(A.AGE)) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
317,"SELECT a.employee_id, a.name, COUNT(*) AS reports_count, round(AVG(b.age)) AS average_age FROM Employees a, Employees b WHERE a.employee_id = b.reports_to GROUP BY 1 ORDER BY 1 "
318,"SELECT M.manager_id AS employee_id, M.manager_name AS name, COUNT(M.manager_id) AS reports_count, ROUND(AVG(E.age), 0) AS average_age FROM Employees E JOIN (SELECT DISTINCT employee_id AS manager_id, name as manager_name FROM Employees) AS M ON E.reports_to = M.manager_id GROUP BY M.manager_id ORDER BY M.manager_id "
319,"WITH age AS (SELECT a.employee_id, a.name AS manager_name, b.name AS direct_report_name, b.age FROM Employees a INNER JOIN Employees b ON a.employee_id = b.reports_to) SELECT employee_id, manager_name AS name, COUNT(direct_report_name) AS reports_count, ROUND(AVG(age)) AS average_age FROM age GROUP BY 1,2 ORDER BY 1 "
320,"select b.employee_id, b.name, count(*) as reports_count, round(avg(a.age)) as average_age from Employees a, Employees b where a.reports_to = b.employee_id group by b.employee_id order by b.employee_id"
321,"SELECT E2.employee_id, E2.name, count(*) as reports_count, round(avg(E1.age)) as average_age FROM Employees E1 INNER JOIN Employees E2 ON E1.reports_to = E2.employee_id GROUP BY 1 ORDER BY 1 "
322,"SELECT t1.reports_to AS employee_id, t2.name AS name, COUNT(t1.employee_id) AS reports_count, ROUND(AVG(t1.age)) AS average_age FROM Employees t1, Employees t2 WHERE t1.reports_to = t2.employee_id GROUP BY t2.employee_id ORDER BY 1"
323,"Select reports_to as employee_id, (Select name From Employees Where employee_id = emp.reports_to) as name, Count(*) as reports_count, Round(Avg(age)) as average_age From Employees emp Where reports_to is not null Group By reports_to Order By employee_id"
324,"select e.employee_id, e.name, count(m.employee_id) as reports_count, round(avg(m.age),0) as average_age from employees e inner join employees m on e.employee_id=m.reports_to where m.reports_to is not null group by m.reports_to order by 1"
325,"with cte as ( select count(name) as reports_count, reports_to, round(avg(age),0) as average_age from employees group by reports_to) select employee_id, name, reports_count, average_age from employees e join cte on e.employee_id = cte.reports_to order by employee_id"
326,"select reports_to employee_id, (select b.name from employees b where b.employee_id=a.reports_to) name, count(*) reports_count, round(avg(age), 0) average_age from employees a where reports_to is not null group by reports_to order by 1"
327,"select e1.reports_to as employee_id, e2.name,count(e1.reports_to)as reports_count, round(avg(e1.age))as average_age from employees e1 left join employees e2 on e1.reports_to = e2.employee_id where e1.reports_to is not null group by 1 order by 1 "
328,"select e1.reports_to as employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age),0) as average_age from employees e1 join employees e2 on e1.reports_to=e2.employee_id group by e1.reports_to order by e1.reports_to"
329,"select r1.reports_to as employee_id, name, reports_count, average_age from ( select reports_to, count(employee_id) reports_count, round(avg(age),0) average_age from employees group by reports_to ) r1 join employees on r1.reports_to=employees.employee_id order by 1 "
330,"SELECT e2.employee_id, e2.name, COUNT(*) AS reports_count, ROUND(AVG(e1.age),0) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.reports_to = e2.employee_id GROUP BY e2.employee_id ORDER BY e2.employee_id"
331,"select a.reports_to as employee_id, b.name, count(distinct a.employee_id) as reports_count, round(avg(a.age)) as average_age from Employees a join Employees b on a.reports_to = b.employee_id group by 1 having reports_count >= 1 "
332,"SELECT Managers.employee_id, Employees.name, Managers.reports_count, Managers.average_age FROM ( SELECT E.reports_to AS employee_id, COUNT(*) AS reports_count, ROUND(AVG(E.age),0) AS average_age FROM Employees AS E WHERE E.reports_to IS NOT NULL GROUP BY E.reports_to) Managers JOIN Employees ON Managers.employee_id = Employees.employee_id ORDER BY Managers.employee_id "
333,"select e1.employee_id, e1.name, sum(case when e2.reports_to is not null then 1 end) as reports_count, round(avg(e2.age),0) as average_age from employees e1 inner join employees e2 on e1.employee_id = e2.reports_to group by e1.employee_id, e1.name order by e1.employee_id"
334,"select e2.employee_id,e2.name, count(e1.employee_id) as reports_count, round(avg(e1.age),0) average_age from Employees e1 join Employees e2 on e1.reports_to = e2.employee_id group by e2.employee_id order by e2.employee_id "
335,"SELECT e1.employee_id,e1.name,count(e2.reports_to)as reports_count,round(avg(e2.age))as average_age FROM Employees as e1 LEFT JOIN Employees as e2 ON e1.employee_id=e2.reports_to GROUP BY e1.employee_id HAVING reports_count>=1 ORDER BY e1.employee_id"
336,"select reports_to employee_id, (select b.name from employees b where b.employee_id=a.reports_to) name, count(*) reports_count, round(avg(age), 0) average_age from employees a where reports_to is not null group by reports_to order by 1"
337,"SELECT e.reports_to as employee_id, r.name, COUNT(e.employee_id) AS reports_count, ROUND(AVG(e.age),0) AS average_age FROM Employees e JOIN Employees r ON r.employee_id = e.reports_to GROUP BY e.reports_to ORDER BY e.reports_to"
338,"SELECT t1.employee_id, t1.name, COUNT(t2.employee_id) reports_count, ROUND(AVG(t2.age), 0) average_age FROM Employees t1 LEFT JOIN Employees t2 ON t1.employee_id = t2.reports_to WHERE t2.reports_to IS NOT NULL GROUP BY 1 ORDER BY employee_id"
339,"select e1.employee_id,e1.name,round(count(e2.employee_id)) reports_count, round(avg(e2.age)) average_age from employees e1 join employees e2 on e1.employee_id = e2.reports_to group by e1.employee_id order by e1.employee_id"
340,"SELECT b.employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id, b.name "
341,"SELECT manager AS employee_id, name, COUNT(employee) AS reports_count, ROUND(AVG(age)) AS average_age FROM (SELECT e1.employee_id AS manager, e2.employee_id as employee, e2.age as age, e1.name AS name FROM Employees AS e1 INNER JOIN Employees AS e2 ON e1.employee_id = e2.reports_to ) AS abc GROUP BY employee_id ORDER BY 1 "
342,"select e1.reports_to as employee_id, e2.name, count(e1.reports_to) as reports_count, round(avg(e1.age),0) as average_age from employees e1 join employees e2 on e1.reports_to=e2.employee_id group by e1.reports_to order by e1.reports_to"
343,"with cte as( select reports_to, count(employee_id)as reports_count, round(avg(age),0) as average_age from employees group by reports_to) select e.employee_id, e.name, cte.reports_count, cte.average_age from employees e inner join cte on e.employee_id = cte.reports_to where cte.reports_to is not null order by employee_id"
344,"select p1.reports_to as employee_id, p2.name, count(p1.reports_to) as reports_count, round(avg(p1.age),0) as average_age from Employees as p1 join Employees as p2 on p1.reports_to=p2.employee_id group by p1.reports_to order by p1.reports_to"
345,"select b.employee_id, b.name, count(*) as reports_count, round(avg(a.age)) as average_age from Employees a, Employees b where a.reports_to=b.employee_id group by a.reports_to order by b.employee_id"
346,"select distinct a.reports_to as employee_id, b.name, count(a.employee_id) as reports_count, round(avg(a.age),0) as average_age from Employees a join employees b on a.reports_to = b. employee_id where a.reports_to is not null group by a.reports_to order by a.reports_to  "
347,"select e1.reports_to as employee_id, e2.name, count(*) as reports_count, round(avg(e1.age)) as average_age from employees e1 join employees e2 on e1.reports_to = e2.employee_id group by 1, 2 order by 1"
348,"select e2.reports_to as employee_id, name, reports_count, round(average_age,0) as average_age from employees e1 inner join ( select reports_to, count(employee_id) as reports_count, avg(age) as average_age from employees where reports_to is not null group by reports_to) e2 on e1.employee_id = e2.reports_to order by 1"
349,"select a.employee_id as employee_id , a.name as name, count(*) as reports_count, round(avg(b.age ),0) as average_age from Employees as a inner join Employees as b on a.employee_id = b.reports_to group by a.employee_id order by a.employee_id"
350,"select a.employee_id, a.name, count(b.reports_to) as reports_count, round(avg(b.age), 0) as average_age from Employees a join Employees b on a.employee_id = b.reports_to group by a.employee_id, a.name order by a.employee_id"
351,"SELECT DISTINCT a.reports_to AS employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age),0) AS average_age FROM Employees a LEFT JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1,2 HAVING COUNT(DISTINCT a.employee_id)>=1 AND a.reports_to IS NOT NULL"
352,"select E.employee_id, E.name, count(EE.reports_to) as reports_count, round(avg(EE.age)) as average_age from Employees E LEFT JOIN Employees EE ON E.employee_id = EE.reports_to group by 1 having count(EE.reports_to) >=1 order by 1"
353,"with cte as ( select reports_to, count(distinct employee_id) as reports_count, round(avg(age), 0) as average_age from Employees group by reports_to ) select e.employee_id, e.name, cte.reports_count, cte.average_age from Employees e join cte on e.employee_id = cte.reports_to order by employee_id "
354,"select A.employee_id,A.name,count(B.reports_to) as reports_count, round(avg(B.age)) as average_age from employees A, employees B where A.employee_id = B.reports_to group by A.employee_id order by A.employee_id"
355,"SELECT b.employee_id AS employee_id, b.name AS name, COUNT(*) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1"
356,"SELECT b.employee_id, b.name, COUNT(DISTINCT a.employee_id) AS reports_count, ROUND(AVG(a.age)) AS average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY b.employee_id, b.name"
357,"SELECT m.employee_id, m.name, COUNT(e.employee_id) AS reports_count, ROUND(AVG(e.age),0) AS average_age FROM Employees e INNER JOIN Employees m ON e.reports_to = m.employee_id WHERE e.reports_to IS NOT NULL GROUP BY m.employee_id ORDER BY m.employee_id"
358,"select m.employee_id, m.name, count(*) as reports_count, round(avg(e.age)) as average_age from employees e, employees m where e.reports_to=m.employee_id group by 1 having count(distinct e.name) >= 1 "
359,"select b.employee_id as employee_id,b.name as name ,count( *) as reports_count,ROUND(AVG(a.age)) as average_age FROM Employees a JOIN Employees b ON a.reports_to = b.employee_id GROUP BY 1 ORDER BY 1 "
360,"with a as (select reports_to as employer, count(employee_id) as reports_count, round(avg(age), 0) as average_age from Employees where reports_to is not null group by reports_to) select employee_id, name, reports_count, average_age from Employees, a where employee_id = employer order by employee_id"
361,"SELECT e1.employee_id, e1.name, COUNT(*) AS reports_count, ROUND(AVG(e2.age)) AS average_age FROM Employees e1 JOIN Employees e2 ON e1.employee_id=e2.reports_to GROUP BY 1 ORDER BY 1"
362,"select e1.employee_id, e1.name, count(*)as reports_count, round(avg(e2.age)) as average_age from employees e1 join employees e2 on e2.reports_to = e1.employee_id group by 1 order by 1 "
363,"with new as (select e1.employee_id, e2.name, e1.reports_to, e1.age from Employees e1 left join Employees e2 on e1.reports_to = e2.employee_id) select reports_to as employee_id, name, count(*) reports_count, round(avg(age),0) average_age from new where reports_to is not null group by reports_to order by employee_id"
364,"select a.reports_to as employee_id, b.name, count(*) as reports_count, round(avg(a.age),0) as average_age from employees a inner join employees b on a.reports_to=b.employee_id group by a.reports_to order by a.reports_to"
365,"select e.employee_id, e.name, (select count(*) from Employees r1 where r1.reports_to=e.employee_id group by r1.reports_to) reports_count, (select round(avg(age)) from Employees r2 where r2.reports_to=e.employee_id group by r2.reports_to) average_age from Employees e where e.employee_id in ( select reports_to from Employees r3 where r3.reports_to=e.employee_id ) order by e.employee_id "
366,"select e.reports_to employee_id, m.name name, count(e.employee_id) reports_count, round(avg(e.age)) average_age from employees e join employees m on e.reports_to=m.employee_id group by 1 order by 1 "
367,"SELECT a.employee_id, a.name, COUNT(DISTINCT b.employee_id) AS reports_count, ROUND(AVG(b.age),0) AS average_age FROM Employees a JOIN Employees b ON b.reports_to = a.employee_id GROUP BY 1,2 ORDER BY 1"
368,"with ss as ( select*from employees where reports_to is not null) select e.employee_id, e.name, count(ss.reports_to) as reports_count, round(avg(ss.age)) as average_age from employees e join ss on e.employee_id = ss.reports_to group by e.employee_id order by e.employee_id "
