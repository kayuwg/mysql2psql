id,original query
1,"WITH temp AS (SELECT id, country, amount, state, LEFT(trans_date, 7) AS month FROM Transactions) SELECT month, country, COUNT(id) AS trans_count, COUNT(CASE WHEN state = ""approved"" THEN id END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = ""approved"" THEN amount ELSE ""0"" END) AS approved_total_amount FROM temp GROUP BY month, country"
2,"select substr(trans_date,1,7) as month,country,count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
3,"with cte as ( select date_format(trans_date,""%Y-%m"") as month, country, count( id) as trans_count, sum(case when state= 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2) select * from cte"
4,"SELECT SUBSTR(trans_date, 1, 7) AS month , country , COUNT(1) AS trans_count , COUNT(IF(state = 'approved', 1, NULL)) AS approved_count , SUM(amount) AS trans_total_amount , SUM(IF(state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY 1, 2 "
5,"select DATE_FORMAT(trans_date, '%Y-%m') as month, country, count(state) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) as approved_count , sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by month, country"
6,"select date_format(trans_date, '%Y-%m') as month, country, count(distinct id ) as trans_count, count(distinct case when state = 'approved' then id else null end ) as approved_count, sum(amount ) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end ) as approved_total_amount from Transactions group by 1,2 order by 1 , 2 desc"
7,"SELECT SUBSTRING(trans_date,1,7) AS month, country, COUNT(id) AS trans_count, COUNT(CASE WHEN state = 'approved' THEN id ELSE NULL END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY 1,2"
8,"SELECT DATE_FORMAT(trans_date, '%Y-%m') as month, country, COUNT(*) as trans_count, COUNT(CASE WHEN state='approved' THEN 1 ELSE NULL END) as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) as approved_total_amount FROM transactions GROUP BY month, country"
9,"select DATE_FORMAT(trans_date,'%Y-%m') as month,country,count(*) as trans_count, count(case when state='approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
10,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
11,"select date_format(trans_date, ""%Y-%m"") as month, country, count(id) as trans_count, count(if (state = ""approved"", 1, null)) as approved_count, sum(amount) as trans_total_amount, sum(if(state = ""approved"", amount, 0)) as approved_total_amount from Transactions group by 1,2"
12,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(id) AS trans_count, COUNT(CASE WHEN state='approved' THEN 1 ELSE NULL END ) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END )AS approved_total_amount FROM Transactions GROUP BY month,country ORDER BY month "
13,"SELECT SUBSTRING(trans_date,1,7) AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) as approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country "
14,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 order by 1"
15,"select month, country, count(distinct id) as 'trans_count', sum(if(state = 'approved', 1, 0)) as 'approved_count', sum(amount) as 'trans_total_amount', sum(if(state = 'approved', amount, 0)) as 'approved_total_amount' from (select id, country, state, amount, left(trans_date, 7) as 'month' from Transactions) as t group by month, country "
16,"SELECT month, country, COUNT(*) trans_count, SUM(CASE WHEN state = ""approved"" THEN 1 ELSE 0 END) approved_count, SUM(amount) trans_total_amount, SUM(CASE WHEN state = ""approved"" THEN amount ELSE 0 END) approved_total_amount FROM ( SELECT country, state, amount, LEFT(trans_date, 7) month FROM Transactions ) t GROUP BY month, country "
17,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, count(if(state='approved', 1, null)) as approved_count, sum(amount) as trans_total_amount, sum(if(state='approved', amount, 0)) as approved_total_amount from Transactions group by month, country"
18,"select left(trans_date,7) as month, country, count(id) as trans_count, count(case when state = 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2 "
19,"select date_format(trans_date, ""%Y-%m"") as month,country,count(*) as trans_count, sum(case when state= 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state= 'approved' then amount else 0 end) approved_total_amount from transactions group by month,country"
20,"select left(trans_date, 7) as month, country, count(*) as trans_count, sum(state='approved') as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
21,"select left(trans_date,7) as month, country, count(trans_date) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,country order by 1"
22,"select left(trans_date, 7) as month, country, count(id) as trans_count, count(case when state=""approved"" then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from transactions group by left(trans_date, 7), country"
23,"select substring(trans_date,1,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
24,"select date_format(trans_date, '%Y-%m') month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) approved_count, sum(amount) trans_total_amount, sum(case when state='approved' then amount else 0 end) approved_total_amount from Transactions group by month, country"
25,"SELECT DATE_FORMAT(trans_date, '%Y-%m') month, country, COUNT(*) trans_count, COUNT(IF(state='approved',1,null)) approved_count, SUM(amount) trans_total_amount, SUM(IF(state='approved',amount,0)) approved_total_amount FROM transactions GROUP BY DATE_FORMAT(trans_date, '%Y-%m'), country"
26,"select left(trans_date,7) as month,country, count(state) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by month,country"
27,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month, country, count(id) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) as approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount from transactions group by 1,2"
28,"Select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount From Transactions Group by left(trans_date,7), country order by left(trans_date,7), country desc"
29,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, count(case when state='approved' then 1 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by left(trans_date,7),country order by country desc "
30,"Select DATE_FORMAT(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(if(state = 'approved',1,0 )) as approved_count, sum(amount) as trans_total_amount, sum(if(state = 'approved', amount, 0)) as approved_total_amount From Transactions Group by 1,2"
31,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by country, date_format(trans_date, '%Y-%m')"
32,"select substr(trans_date, 1, 7) as month, country, count(id) as trans_count, sum(case state when 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case state when 'approved' then amount else 0 end) as approved_total_amount from Transactions group by substr(trans_date, 1, 7), country"
33,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country "
34,"select DATE_FORMAT(trans_date,'%Y-%m') as month , country , count(distinct id) as trans_count , sum(case when state = 'approved' then 1 else 0 end) as approved_count , sum(amount) as trans_total_amount , coalesce(sum(case when state = 'approved' then amount end),0) as approved_total_amount from transactions group by 1, 2"
35,"SELECT LEFT(trans_date,7) month,country,COUNT(state) trans_count, SUM(CASE WHEN state =""approved"" THEN 1 ELSE 0 END) AS approved_count, SUM(amount) trans_total_amount, SUM(CASE WHEN state =""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM transactions GROUP BY LEFT(trans_date,7),country"
36,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2 order by 1"
37,"select left(trans_date,7) as month, country, count(state) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
38,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(approved_type) as approved_count, sum(amount) as trans_total_amount, sum(approved_amount) as approved_total_amount from (select *, case when state = ""approved"" then 1 else 0 end as approved_type, case when state=""approved"" then amount else 0 end as approved_amount from Transactions) a group by left(trans_date,7), country "
39,"select date_format(trans_Date, '%Y-%m') as month, country, count(*) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
40,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state= ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
41,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(state=""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country "
42,"select LEFT(trans_date, 7) as month, country, count(*) as trans_count, SUM(CASE WHEN state= ""approved"" THEN 1 ELSE 0 END) as approved_count, SUm(amount) as trans_total_amount, SUM(CASE WHEN state= ""approved"" THEN amount ELSE 0 END) as approved_total_amount from Transactions group by 1, 2"
43,"SELECT SUBSTRING(trans_date,1,7) AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) as approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country "
44,"select Date_format(trans_date, '%Y-%m') month ,country ,count(*) trans_count ,sum(if(state='approved',1,0)) approved_count ,sum(amount) trans_total_amount ,sum(if(state='approved',amount,0)) approved_total_amount from transactions group by 1, 2"
45,"select left(trans_date,7) as month, country, count(state) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by month, country"
46,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by date_format(trans_date, '%Y-%m'), country"
47,"select left(trans_date, 7) AS month, country, count(trans_date) as trans_count, sum(state = ""approved"") as approved_count, sum(amount) as trans_total_amount, sum(CASE WHEN state = ""approved"" THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY month, country"
48,"select DATE_FORMAT(trans_date, '%Y-%m') as month, country, count(id) as trans_count, count(case state when 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case state when 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
49,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
50,"select date_format(trans_date,'%Y-%m') as month, country, count(*) as trans_count, sum(if(state='approved',1,0)) as approved_count, sum(amount) as trans_total_amount, sum(if(state='approved',amount,0)) as approved_total_amount from Transactions t group by date_format(trans_date,'%Y-%m'),country"
51,"select substring(trans_date,1,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
52,"with t as ( select left(trans_date, 7) as month, country, sum(amount) as trans_total_amount, count(*) as trans_count from transactions group by month, country ), s as ( select left(trans_date, 7) as month, country, sum(amount) as approved_total_amount, count(*) as approved_count from transactions where state = 'approved' group by month, country ) select month, country, trans_count, ifnull(approved_count, 0) as approved_count, trans_total_amount, ifnull(approved_total_amount, 0) as approved_total_amount from t left join s using (month, country) union select month, country, ifnull(trans_count, 0) as trans_count, approved_count, ifnull(trans_total_amount, 0) as trans_total_amount, approved_total_amount from t right join s using (month, country) "
53,"SELECT MID(trans_date,1,7) AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
54,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state=""approved"" THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month,country"
55,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month , country, COUNT(*) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM( CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY 1,2"
56,"select left(tr.trans_date,7) as month, tr.country as country, count(tr.id) as trans_count, count(if(tr.state = 'approved',tr.id,null)) as approved_count, sum(tr.amount) as trans_total_amount, sum(if(tr.state = 'approved',tr.amount,0)) as approved_total_amount from Transactions tr group by 1,2"
57,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount , sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, country"
58,"select SUBSTRING(trans_date,1,7) as month, country, count(state) as trans_count, count(case when state = 'approved' then 1 end) as approved_count, sum(amount) as trans_total_amount, coalesce(sum(case when state = 'approved' then amount end),0) as approved_total_amount from transactions group by 1,2 "
59,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(case when state=""approved"" then 1 else 0 end) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
60,"select substring(trans_date, 1, 7) as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
61,"SELECT mt as month,country,count(id) as trans_count,sum(st) as approved_count, sum(amount) as trans_total_amount, sum(st*amount) as approved_total_amount from( SELECT DATE_FORMAT(TRANS_DATE,'%Y-%m') as mt,country,id,case when state='approved' then 1 else 0 end as st,amount FROM TRANSACTIONS ) X group by mt,country"
62,"select left(trans_date ,7) month, country, count(*) trans_count, sum(state = 1) approved_count, sum(amount) trans_total_amount , sum(case when state = 1 then amount else 0 end) approved_total_amount from Transactions group by 1,2"
63,"SELECT SUBSTRING(trans_date, 1, 7) AS 'month', country, COUNT(1) AS 'trans_count', SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS 'approved_count', SUM(amount) AS 'trans_total_amount', SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS 'approved_total_amount' FROM Transactions GROUP BY country, YEAR(trans_date), MONTH(trans_date)"
64,"select DATE_FORMAT(trans_date,""%Y-%m"") as month,country , count(id) as trans_count, count(if(state='approved',id,null)) as approved_count, sum(amount) as trans_total_amount,coalesce(sum(case when state='approved' then amount end),0) as approved_total_amount from transactions group by 1,2"
65,"select substring(trans_date,1,7) as month, country, count(distinct id) as trans_count, sum( CASE WHEN state = 'approved' THEN 1 ELSE 0 END ) as approved_count, sum(amount) as trans_total_amount, sum( CASE WHEN state = 'approved' THEN amount ELSE 0 END ) as approved_total_amount from Transactions group by substring(trans_date,1,7),country"
66,"select DATE_FORMAT(trans_date, ""%Y-%m"") as month, country ,count(distinct id) as trans_count ,sum( case when state like 'approved' then 1 else 0 end) as approved_count ,sum(amount) as trans_total_amount ,sum(case when state like 'approved' then amount else 0 end) as approved_total_amount from Transactions group by DATE_FORMAT(trans_date, ""%Y-%m""),country "
67,"WITH ALL_TRANS AS( SELECT DATE_FORMAT(TRANS_DATE,""%Y-%m"") as month, COUNTRY, COUNT(*) AS TRANS_COUNT, SUM(AMOUNT) AS TRANS_TOTAL_AMOUNT FROM TRANSACTIONS GROUP BY MONTH, COUNTRY ), APR_TRANS AS( SELECT DATE_FORMAT(TRANS_DATE,""%Y-%m"") as month, COUNTRY, COUNT(*) AS APPROVED_COUNT, SUM(AMOUNT) AS APPROVED_TOTAL_AMOUNT FROM TRANSACTIONS WHERE STATE='approved' GROUP BY MONTH, COUNTRY ) SELECT T.MONTH, T.COUNTRY,T.TRANS_COUNT,IFNULL(A.APPROVED_COUNT,0) APPROVED_COUNT, T.TRANS_TOTAL_AMOUNT, IFNULL(A.APPROVED_TOTAL_AMOUNT,0) AS APPROVED_TOTAL_AMOUNT FROM ALL_TRANS T LEFT JOIN APR_TRANS A ON T.MONTH=A.MONTH AND T.COUNTRY=A.COUNTRY"
68,"select left(trans_date, 7) as month, country, count(1) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(case when state = 'approved' then amount else 0 end) as trans_total_amount, sum(amount) as approved_total_amount from transactions group by month, country "
69,"select left(trans_date, 7) as month,country , count(DISTINCT(id)) as trans_count, COUNT(DISTINCT(CASE WHEN State = 'approved' then id end)) as approved_count, SUM(amount) as trans_total_amount, COALESCE(SUM(CASE WHEN State = 'approved' then amount end),0) as approved_total_amount from transactions group by month , country "
70,"select substr(trans_date,1,7) as month, country, count(distinct id) as trans_count , sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by substr(trans_date,1,7),country order by substr(trans_date,1,7),country "
71,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
72,"select month, country, count(id) as trans_count, count(case when state = 'approved' then 1 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from (select *, date_format(trans_date, '%Y-%m') as month from Transactions ) t group by month, country"
73,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
74,"SELECT DATE_FORMAT(trans_date,'%Y-%m') as month,country, count(state) as trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) as trans_total_amount, SUM( CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY country, month(trans_date) "
75,"select substr(trans_date,1, 7) as month, country, count(distinct id) as trans_count, count(distinct case when state = 'approved' then id else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2 "
76,"select date_format(trans_date,""%Y-%m"") as ""month"", country, count(*) as ""trans_count"", sum(if(state = ""approved"", 1, 0)) as ""approved_count"", sum(amount) as ""trans_total_amount"", sum(if(state = ""approved"", amount, 0)) as ""approved_total_amount"" from transactions group by 1,2"
77,"WITH T1 AS ( SELECT LEFT(trans_date, 7) AS month, id, country, state, amount FROM Transactions), T2 AS ( SELECT month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM T1 GROUP BY 1, 2) SELECT * FROM T2"
78,"select substring(trans_date,1,7) as month, country, count(id) as trans_count, count(case when state='approved' then id else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 order by 1,2"
79,"with total_transaction as (select date_format(trans_date,""%Y-%m"") as month, country, count(*) trans_count, sum(amount) trans_total_amount from Transactions t group by date_format(trans_date,""%Y-%m""),country ), approved_transaction as( select date_format(trans_date,""%Y-%m"") as month, country, count(*) approved_count, sum(amount) approved_total_amount from Transactions t where state='approved' group by date_format(trans_date,""%Y-%m""),country ) select t.month, t.country, t.trans_count, ifnull(a.approved_count,0) as approved_count, t.trans_total_amount, ifnull(a.approved_total_amount,0) as approved_total_amount from total_transaction t left join approved_transaction a on t.month=a.month and t.country=a.country "
80,"SELECT LEFT(trans_date, 7) as month, country, COUNT(id) as trans_count, SUM(state = 'approved') as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY month, country "
81,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
82,"select left(trans_date,7) as month, country, count(id) as trans_count, count(distinct case when state = 'approved' then id end) as approved_count, sum(amount) as trans_total_amount, sum(case when state= ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
83,"select left(trans_date,7) as month, country, count(*) as trans_count, sum(case when state=""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by left(trans_date,7), country"
84,"select substr(trans_date,1,7) as month, country, count(distinct id) as trans_count, ifnull(sum(case when state = 'approved' then 1 else 0 end),0) as approved_count, sum(amount) as trans_total_amount, ifnull(sum(case when state = 'approved' then amount end ),0) as approved_total_amount from Transactions group by 1,2"
85,"select left(trans_date,7) as month,country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count,sum(amount) as trans_total_amount,sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month,country "
86,"SELECT LEFT(trans_date,7) AS month, country, COUNT(Distinct id) AS trans_count, SUM(CASE WHEN state = 'approved' then 1 else 0 END) AS approved_count , SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month,country ORDER BY LEFT(trans_date,7),country "
87,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country order by month, country desc "
88,"with cte as (select left(trans_date ,7) as month_ , country , count(id) as numm , sum(amount) as amt from Transactions group by left(trans_date ,7) , country ), cte1 as (select left(trans_date , 7) as month_ , country , count(id) as num_, sum(amount) as amt1 from Transactions where state = 'approved' group by left(trans_date ,7) , country) select cte.month_ as month , cte.country as country , cte.numm as trans_count , coalesce(cte1.num_ ,0) as approved_count , cte.amt as trans_total_amount , coalesce(cte1.amt1 ,0) as approved_total_amount from cte left outer join cte1 on cte.month_ = cte1.month_ and cte.country = cte1.country  "
89,"select date_format(trans_date,'%Y-%m') as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 order by 1"
90,"WITH CTE1 AS ( SELECT SUBSTR(trans_date, 1, 7) AS month, country, state, amount FROM Transactions) SELECT month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM CTE1 GROUP BY month, country"
91,"select substring(trans_date,1,7) 'month', country, COUNT(*) 'trans_count', COUNT(CASE WHEN state = 'approved' THEN 1 END) 'approved_count', SUM(amount) 'trans_total_amount', SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) 'approved_total_amount' from transactions group by 1,2 order by 1"
92,"select date_format(trans_date,'%Y-%m') as month, country, count(1) as trans_count, count(case when state=""approved""then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum( case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by 1,2 "
93,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month, country, COUNT(state) AS trans_count, SUM(IF (state = 'approved',1,0)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF (state = 'approved',amount,0)) AS approved_total_amount FROM Transactions GROUP BY month, country"
94,"SELECT LEFT(trans_date,7) AS month, country, COUNT(country) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = 'approved',amount,0)) AS approved_total_amount FROM Transactions GROUP BY 1,2"
95,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(if(state = 'approved', 1, 0)) as approved_count, sum(amount) as trans_total_amount, sum(if(state = 'approved', amount, 0)) as approved_total_amount from transactions group by month, country"
96,"select c1.year_mon as month, c1.country, c1.total_trans as trans_count, ifnull(c2.approve_trans,0) as approved_count, c1.total_trans_amount as trans_total_amount, ifnull(c2.approve_trans_amount,0) as approved_total_amount from (select country, date_format(trans_date, ""%Y-%m"") as year_mon,count(country) as total_trans, sum(amount) as total_trans_amount from transactions group by country, date_format(trans_date, ""%Y-%m"")) c1 left join (select country, date_format(trans_date, ""%Y-%m"") as year_mon,count(country) as approve_trans, sum(amount) as approve_trans_amount from transactions where state = 'approved' group by country, date_format(trans_date, ""%Y-%m"")) c2 on c1.country = c2.country and c1.year_mon = c2.year_mon"
97,"select LEFT(trans_date, 7) AS month, country, count(id) as trans_count, sum( case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum( case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country "
98,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(state=""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
99,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) as trans_count, SUM(state = 'approved') as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions t GROUP BY month, country"
100,"select a.month, a.country, a.trans_count, ifnull(b.approved_count,0) as approved_count, ifnull(a.trans_total_amount,0) as trans_total_amount, ifnull(b.approved_total_amount,0) as approved_total_amount from (select substr(trans_date,1,7) as month, country, count(distinct id) as trans_count, sum(amount) as trans_total_amount from transactions group by 1,2) a left join (select substr(trans_date,1,7) as month, country, count(distinct id) as approved_count, sum(amount) as approved_total_amount from transactions where state='approved' group by 1,2 ) b on a.month=b.month and a.country=b.country"
101,"SELECT LEFT(trans_date,7)as month, country, count(id)as trans_count, sum(case when state=""approved"" then 1 else 0 end)as approved_count, sum(amount)as trans_total_amount, sum(case when state=""approved""then amount else 0 end)as approved_total_amount FROM Transactions group by 1,2"
102,"select left(trans_date, 7) month, country, count(*) trans_count, count(case when state='approved' then 1 end) approved_count, sum(amount) trans_total_amount , ifnull(sum(case when state='approved' then amount end),0) approved_total_amount from transactions group by 1, 2"
103,"Select left(trans_date,7) as month, country, count(DISTINCT ID) as trans_count, sum(IF(state = 'approved', 1, 0)) as approved_count, sum(amount) as trans_total_amount, sum(IF(state = 'approved', amount, 0)) as approved_total_amount from Transactions group by left(trans_date,7), country "
104,"With trans_fliter as (Select date_format(trans_date, ""%Y-%m"") as month, country, count(id) as trans_count, sum(amount) as trans_total_amount From Transactions Group by month, country), approv_fliter as (Select date_format(trans_date, ""%Y-%m"") as month, country, count(id) as approved_count, sum(amount) as approved_total_amount From Transactions Where state = ""approved"" Group by month, country) Select t.month, t.country, trans_count, ifnull(approved_count,0) as approved_count, trans_total_amount, ifnull(approved_total_amount,0) as approved_total_amount From trans_fliter t Left join approv_fliter a On t.month=a.month and t.country=a.country "
105,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
106,"with t as ( SELECT *, LEFT(trans_date, 7) As month FROM Transactions ) SELECT DISTINCT t1.month, t1.country, t1.trans_count, IFNULL(t2.approved_count, 0) As approved_count, t1.trans_total_amount, IFNULL(t2.approved_total_amount, 0) As approved_total_amount FROM (SELECT month, country, COUNT(id) As trans_count, SUM(amount) As trans_total_amount FROM t GROUP BY month, country) t1 LEFT JOIN (SELECT month, country, COUNT(id) As approved_count, SUM(amount) As approved_total_amount FROM t WHERE state = 'approved' GROUP BY month, country) t2 ON t1.month = t2.month AND t1.country = t2.country "
107,"select left(trans_date,7) as month,country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
108,"SELECT month , country , coalesce(sum(trans_count) , 0) as trans_count , coalesce(sum(approved_count), 0) as approved_count , coalesce(sum(trans_total_amount),0) as trans_total_amount , coalesce(sum(approved_total_amount), 0) as approved_total_amount FROM( SELECT left(trans_date, 7) as month , country , count(0) as approved_count , sum(amount) as approved_total_amount , 0 as trans_count , 0 as trans_total_amount FROM Transactions t WHERE state = 'approved' GROUP BY left(trans_date, 7), country UNION SELECT left(trans_date, 7) as month , country , 0 as approved_count , 0 as approved_total_amount , count(0) as trans_count , sum(amount) as trans_total_amount FROM Transactions t GROUP BY left(trans_date, 7), country )temp group by month, country ORDER BY month, country "
109,"with cte as ( select id, country, case when state = 'approved' then 1 else 0 end as approved_count, 1 as trans_count, case when state = 'approved' then amount else 0 end as approved_trans_amount, amount as trans_total_amount, date_format(trans_date, '%Y-%m') as month from Transactions ) select month, country, sum(trans_count) as trans_count, sum(approved_count) as approved_count, sum(trans_total_amount) as trans_total_amount, sum(approved_trans_amount) as approved_total_amount from cte group by month, country"
110,"select substring(trans_date,1,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
111,"select a.month, a.country, ifnull(trans_count, 0) as trans_count, ifnull(approved_count, 0) as approved_count, ifnull(trans_total_amount, 0) as trans_total_amount, ifnull(approved_total_amount, 0) as approved_total_amount from( select left(trans_date, 7) as month, country, count(id) as trans_count, sum(amount) as trans_total_amount from Transactions group by 1, 2) as a left join (select left(trans_date, 7) as month, country, count(id) as approved_count, sum(amount) as approved_total_amount from Transactions where state = 'approved' group by 1, 2) as b on a.month = b.month and a.country = b.country "
112,"select date_format(trans_date, ""%Y-%m"") as month, country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(case when state in ('approved','declined') then amount else 0 end) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
113,"select left(trans_date, 7) as month, country, count(distinct id) as trans_count, sum(amount) as trans_total_amount, count( case when state ='approved' then 1 else null end) as approved_count, sum(case when state ='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 order by 1,2"
114,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(amount) as trans_total_amount, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
115,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY DATE_FORMAT(trans_date, '%Y-%m'), country "
116,"select date_format(trans_date, ""%Y-%m"") as month, country, count(*) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end) as approved_total_amount from transactions group by 2, 1 order by 1 "
117,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, count(case when state = 'approved' then id end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
118,"select substring(trans_date, 1,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by substring(trans_date, 1,7), country"
119,"select left(trans_date,7) as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(if (state = 'approved', amount, 0)) as approved_total_amount from transactions group by month,country"
120,"select left(trans_date,7) as month, country, count(distinct id) trans_count, sum(case when state='approved' then 1 else 0 end ) approved_count, sum(amount)as trans_total_amount, sum(case when state='approved' then amount else 0 end) approved_total_amount from transactions group by month, country"
121,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(trans_date) AS trans_count, SUM(IF(state = 'approved', 1, 0)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY 1, 2 "
122,"select left(t1.trans_date,7) as month, t1.country, count(t1.state) as trans_count, count(t2.state)as approved_count, sum(t1.amount) as trans_total_amount, ifnull(sum(t2.amount),0) as approved_total_amount from Transactions t1 left join (select * from Transactions where state='approved')t2 on t1.id=t2.id group by 1,2 "
123,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(state=""approved"") as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by left(trans_date,7), country "
124,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
125,"select left(trans_date,7) as month, country, count(left(trans_date,7)) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount ) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions t group by month,country "
126,"select date_format(trans_date, '%Y-%m') month, country, count(id) trans_count, count(case when state = 'approved' then id else null end) approved_count, sum(amount) trans_total_amount, sum(case when state = 'approved' then amount else 0 end) approved_total_amount from transactions group by month, country"
127,"select left(trans_date, 7) as 'month', country, count(distinct id) as 'trans_count', sum(if(state = 'approved', 1, 0)) as 'approved_count', sum(amount) as 'trans_total_amount', sum(if(state = 'approved', amount, 0)) as 'approved_total_amount' from Transactions group by month, country "
128,"select substring(trans_date,1,7) 'month', country, COUNT(*) 'trans_count', COUNT(CASE WHEN state = 'approved' THEN 1 END) 'approved_count', SUM(amount) 'trans_total_amount', SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) 'approved_total_amount' from transactions group by 1,2 order by 1"
129,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(case when state = 'approved' then 1 else 0 end) approved_count, sum(amount) trans_total_amount, sum(case when state= 'approved' then amount else 0 end) approved_total_amount from transactions group by 1, 2"
130,"with cte as (select left(trans_date,7) as month, country, sum(amount) as approved_total_amount, count(amount) as approved_count from transactions group by left(trans_date,7), country), cte2 as (select left(trans_date,7) as month, country, sum(amount) as trans_total_amount, count(amount) as trans_count from transactions where state = 'approved' group by left(trans_date,7), country) select a.month, a.country,ifnull(b.trans_count,0) as trans_count, ifnull(a.approved_count,0) as approved_count, ifnull(b.trans_total_amount,0) as trans_total_amount, ifnull(a.approved_total_amount,0) as approved_total_amount from cte a left join cte2 b on a.month = b.month and a.country = b.country"
131,"select date_format(trans_date,'%Y-%m') as month, country, count(id) as trans_count, count(case when state ='approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum( case when state ='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2 order by 1 "
132,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by month, country"
133,"select substring(trans_date, 1, 7) as month, country, count(id) as trans_count, count( case when state = 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
134,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
135,"SELECT DATE_FORMAT(trans_date, '%Y-%m') month, country, COUNT(*) trans_count, SUM(state = 'approved') approved_count, SUM(amount) trans_total_amount, SUM(IF(state = 'approved', amount, 0)) approved_total_amount FROM Transactions GROUP BY DATE_FORMAT(trans_date, '%Y-%m'), country"
136,"select distinct month, country, count(amount) over(partition by month, country) as trans_count, count(approved_count) over(partition by month, country) as approved_count, sum(amount) over(partition by month, country) as trans_total_amount, sum(approved_amount) over(partition by month, country) as approved_total_amount from ( select *, substr(trans_date, 1, 7) as month, (case when state = ""approved"" then amount else null end) as approved_count, (case when state = ""approved"" then amount else 0 end) as approved_amount from Transactions ) as t "
137,"SELECT distinct LEFT(trans_date, 7) as month, country, count(id) over (partition by LEFT(trans_date, 7),country) AS trans_count, count(case when state=""approved"" then id else null end) over (partition by LEFT(trans_date, 7),country) as approved_count, sum(amount) over (partition by LEFT(trans_date, 7),country) AS trans_total_amount, sum(case when state=""approved"" then amount else 0 end) over (partition by LEFT(trans_date, 7),country) AS approved_total_amount FROM transactions "
138,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month,country, COUNT(id) AS trans_count, SUM(state=""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state=""approved"",amount,0)) AS approved_total_amount FROM Transactions GROUP BY month,country"
139,"select left(trans_date,7) as month, country, count(id) as trans_count, count(case when state = 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
140,"SELECT DISTINCT SUBSTRING(trans_date,1,7) AS month, country, IFNULL(COUNT(*) OVER(PARTITION BY SUBSTRING(trans_date,1,7),country),0) trans_count, IFNULL(COUNT(CASE WHEN state = 'approved' THEN 1 END) OVER(PARTITION BY SUBSTRING(trans_date,1,7),country),0) approved_count, IFNULL(SUM(amount) OVER(PARTITION BY SUBSTRING(trans_date,1,7),country),0) trans_total_amount, IFNULL(SUM(CASE WHEN state = 'approved' THEN amount END) OVER(PARTITION BY SUBSTRING(trans_date,1,7),country),0) approved_total_amount FROM Transactions "
141,"SELECT DATE_FORMAT(CONCAT_WS('-', T1.trans_year, T1.trans_month, '1'), ""%Y-%m"") AS month, T1.country, T1.trans_count, COALESCE(T2.approved_count, 0) AS approved_count, T1.trans_total_amount, COALESCE(T2.approved_total_amount, 0) AS approved_total_amount FROM ( SELECT country, YEAR(trans_date) AS trans_year, MONTH(trans_date) AS trans_month, COUNT(id) as trans_count, SUM(amount) AS trans_total_amount FROM Transactions GROUP BY country, YEAR(trans_date), MONTH(trans_date) ) AS T1 LEFT JOIN ( SELECT country, YEAR(trans_date) AS trans_year, MONTH(trans_date) AS trans_month, COUNT(id) as approved_count, SUM(amount) AS approved_total_amount FROM Transactions WHERE state = 'approved' GROUP BY country, YEAR(trans_date), MONTH(trans_date) ) AS T2 ON T1.country = T2.country AND T1.trans_year = T2.trans_year AND T1.trans_month = T2.trans_month "
142,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(*) AS trans_count, COUNT(CASE WHEN state = 'approved' THEN 1 ELSE NULL END) AS approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions t GROUP BY month, country"
143,"WITH Results AS ( SELECT country, DATE_FORMAT(trans_date, '%Y-%m') AS month, amount, CASE WHEN state = 'approved' THEN amount ELSE NULL END AS approved_amount FROM Transactions ) SELECT month, country, COUNT(1) AS trans_count, COUNT(approved_amount) AS approved_count, SUM(amount) AS trans_total_amount, SUM(COALESCE(approved_amount, 0)) AS approved_total_amount FROM Results GROUP BY month, country"
144,"SELECT LEFT(trans_date, 7) as month, country, COUNT(state) as trans_count, SUM(CASE WHEN state= 'approved' THEN 1 ELSE 0 END) as approved_Count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state= 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY month, country "
145,"SELECT LEFT(trans_date,7) AS month, country, COUNT(*) AS trans_count,SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY 1,2"
146,"SELECT t1.month, t1.country, trans_count, IFNULL(approved_count,0) AS approved_count, trans_total_amount, IFNULL(approved_total_amount,0) AS approved_total_amount FROM ( SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) AS trans_count, SUM(amount) AS trans_total_amount FROM Transactions GROUP BY month, country ) AS t1 LEFT OUTER JOIN ( SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) AS approved_count, SUM(amount) AS approved_total_amount FROM Transactions WHERE state = 'approved' GROUP BY month, country ) AS t2 ON (t1.month = t2.month AND t1.country = t2.country) "
147,"SELECT SUBSTRING(trans_date,1,7) AS month,country, COUNT(id) AS trans_count, SUM(state=""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE state WHEN ""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month,country"
148,"select left(trans_date, 7) as 'month', country, count(*) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
149,"select date_format(trans_date, '%Y-%m') as month, country, count(trans_date) as trans_count, count(case when state = ""approved"" then 1 end) as approved_count, sum(amount) as trans_total_amount, coalesce(sum(case when state = ""approved"" then amount end), 0) as approved_total_amount from Transactions group by 1, 2 "
150,"select DATE_FORMAT(trans_date,'%Y-%m') as month , country , count(distinct id) as trans_count , sum(case when state = 'approved' then 1 else 0 end) as approved_count , sum(amount) as trans_total_amount , coalesce(sum(case when state = 'approved' then amount end),0) as approved_total_amount from transactions group by 1, 2"
151,"select date_format(trans_date, ""%Y-%m"") as month, country, count(id) as trans_count, sum(if(state ='approved',1, 0)) as approved_count, sum(amount) as trans_total_amount, sum(if(state ='approved', amount, 0)) as approved_total_amount from transactions group by 1,2"
152,"select DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, count(id) as trans_count, sum((case when state='approved' then 1 else 0 End)) as approved_count, sum(amount) as trans_total_amount, sum((case when state='approved' then amount else 0 End)) as approved_total_amount from transactions group by month, country "
153,"SELECT left(trans_date,7) as month, country, COUNT(id) AS trans_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) approved_total_amount, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) approved_count FROM Transactions GROUP BY country, month "
154,"select Date_format(trans_date, '%Y-%m') month ,country ,count(*) trans_count ,sum(state='approved') approved_count ,sum(amount) trans_total_amount ,sum(if(state='approved',amount,0)) approved_total_amount from transactions group by month, country"
155,"select left(trans_date,7) month, country, count(*) trans_count, sum(case when state='approved' then 1 else 0 end) approved_count, sum(amount) trans_total_amount, sum(case when state='approved' then amount else 0 end) approved_total_amount from Transactions group by left(trans_date,7) , country "
156,"with t1 as( select left(trans_date, 7) month, country, count(*) trans_count, sum(amount) trans_total_amount from Transactions group by 1,2), t2 as( select left(trans_date, 7) month, country, count(*) approved_count, sum(amount) approved_total_amount from Transactions where state = 1 group by 1,2 ) select t1.month, t1.country, ifnull(t1.trans_count,0) trans_count ,ifnull(t2.approved_count,0) approved_count, ifnull(t1.trans_total_amount,0) trans_total_amount,ifnull(t2.approved_total_amount,0) approved_total_amount from t1 left join t2 using(month,country) union select t1.month, t1.country, ifnull(t1.trans_count,0) trans_count ,ifnull(t2.approved_count,0) approved_count, ifnull(t1.trans_total_amount,0) trans_total_amount,ifnull(t2.approved_total_amount,0) approved_total_amount from t1 right join t2 using(month,country)"
157,"select left(trans_date, 7) as month, country, count(*) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country "
158,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions t GROUP BY 1, 2"
159,"SELECT LEFT(trans_date,7) AS month, t.country, COUNT(t.id) trans_count, count(case when state = 'approved' then 1 else null end) as approved_count, SUM(amount) trans_total_amount, SUM(case when state='approved' then amount else 0 end) as approved_total_amount FROM Transactions t GROUP BY 1,2"
160,"select month,country,count(id) as 'trans_count',count(case when state = 'approved' then 1 else null end) as approved_count, sum(amount) as 'trans_total_amount', sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from (select *, DATE_FORMAT(trans_date, '%Y-%m') as month from transactions) as temp group by month,country"
161,"select left(trans_date, 7) as month, country, count(*) as trans_count, count(case when state = 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
162,"SELECT month, country, COUNT(*) trans_count, SUM(IF(state='approved',1,0)) approved_count, SUM(amount) trans_total_amount, SUM(IF(state='approved',amount,0)) approved_total_amount FROM (SELECT LEFT(trans_date, 7) month, country, state, amount FROM Transactions ) t GROUP BY month, country"
163,"WITH tot AS (SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS ym_data, country, COUNT(*) AS trans_count, SUM(amount) AS trans_total_amount FROM Transactions GROUP BY country, ym_data), app AS (SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS ym_data, country, COUNT(*) AS approved_count, SUM(amount) AS approved_total_amount FROM Transactions WHERE state = 'approved' GROUP BY country, ym_data) SELECT t.ym_data AS month, t.country, t.trans_count, ifnull(p.approved_count,0) AS approved_count, t.trans_total_amount, ifnull(p.approved_total_amount,0) AS approved_total_amount FROM tot AS t LEFT JOIN app AS p ON t.country = p.country AND t.ym_data = p.ym_data ORDER BY month "
164,"SELECT C.month, C.country, COALESCE(C.trans_count,0) trans_count, COALESCE(D.approved_count,0) approved_count, COALESCE(C.trans_total_amount,0) trans_total_amount, COALESCE(D.approved_total_amount,0) approved_total_amount FROM (SELECT A.month, A.country, COUNT(A.id) trans_count, SUM(A.amount) trans_total_amount FROM (SELECT (CASE WHEN MONTH(trans_date) - 10 < 0 THEN CONCAT(YEAR(trans_date), '-0', MONTH(trans_date)) ELSE CONCAT(YEAR(trans_date), '-', MONTH(trans_date)) END) month, country, state, amount, id FROM Transactions) A GROUP BY A.month, A.country) C LEFT JOIN (SELECT A.month, A.country, COUNT(A.id) approved_count, SUM(A.amount) approved_total_amount FROM (SELECT (CASE WHEN MONTH(trans_date) - 10 < 0 THEN CONCAT(YEAR(trans_date), '-0', MONTH(trans_date)) ELSE CONCAT(YEAR(trans_date), '-', MONTH(trans_date)) END) month, country, state, amount, id FROM Transactions WHERE state = 'approved') A GROUP BY A.month, A.country) D ON C.month = D.month AND C.country = D.country"
165,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
166,"select date_format(trans_date,'%Y-%m') as month,country, count(id) as trans_count,count(case when state='approved' then id else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month,country"
167,"select date_format(trans_date,'%Y-%m') as month, country, count(*) as trans_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from TRansactions group by month, country"
168,"select date_format(trans_date,'%Y-%m') as month , country,count(id) as trans_count, sum(case when state = ""approved"" then 1 else 0 end)as approved_count, sum(amount)as trans_total_amount, coalesce(sum(case when state = ""approved"" then amount else 0 end),0)as approved_total_amount from transactions group by 1,2"
169,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY month, country"
170,"with cte1 as ( select id, date_format(trans_date, '%Y-%m') as month, country, count(trans_date) as approved_count, sum(amount) as approved_total_amount from transactions where state='approved' group by 1,2) select date_format(t.trans_date, '%Y-%m') as month, t.country, count(t.trans_date) as trans_count, ifnull(count(c.approved_count),0) as approved_count, sum(t.amount) as trans_total_amount, ifnull(sum(c.approved_total_amount),0) as approved_total_amount from transactions t left join cte1 c on t.id=c.id group by 1,2 "
171,"WITH t1 AS ( SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) trans_count, SUM(amount) trans_total_amount FROM Transactions GROUP BY 1, 2 ), t2 AS ( SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) approved_count, SUM(amount) approved_total_amount FROM Transactions WHERE state = 'approved' GROUP BY 1, 2 ) SELECT t1.month, t1.country, trans_count, COALESCE(approved_count, 0) approved_count, trans_total_amount, COALESCE(approved_total_amount, 0) approved_total_amount FROM t1 LEFT JOIN t2 ON t1.month = t2.month AND t1.country = t2.country"
172,"select DATE_FORMAT(trans_date,'%Y-%m') as month, country, count(id) as trans_count, count(case when state = 'approved' then id else null end ) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end ) as approved_total_amount from Transactions group by 1,2 order by 1 "
173,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state= ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by month,country"
174,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
175,"SELECT DATE_FORMAT (trans_date, '%Y-%m') as month, country, count(*) as trans_count, SUM(CASE WHEN state=""approved"" THEN 1 ELSE 0 END) as approved_count, sum(amount) as trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) as approved_total_amount FROM transactions GROUP BY month, country "
176,"SELECT DATE_FORMAT(trans_date,'%Y-%m') as month, country, count(*) as trans_count, sum(case when state = ""approved"" then 1 else 0 end ) as approved_count, sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end ) as approved_total_amount from Transactions group by month, country order by month, country desc  "
177,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) as trans_count, SUM(state = 'approved') as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions t GROUP BY month, country"
178,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount , sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, country"
179,"select DATE_FORMAT(trans_date, ""%Y-%m"") as month, country, count(id) as trans_count, sum(state=""approved"") as approved_count, sum(amount) as trans_total_amount, sum((state=""approved"") * amount) as approved_total_amount from transactions t group by year(trans_date), month(trans_date), country "
180,"select left(trans_date,7) as month, country, count(id) as trans_count, sum( case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum( case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by month, country"
181,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
182,"select DATE_FORMAT(trans_date,'%Y-%m') as month, country, count(distinct id) as trans_count, sum(case when state= 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, country order by 1, 2 desc"
183,"select date_format(trans_date, ""%Y-%m"") as month , country , count(id) as trans_count , sum(case when state='approved' then 1 else 0 end) as approved_count , sum(amount) as trans_total_amount , sum(case when state ='approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
184,"select date_format(trans_date,'%Y-%m') as month, country,count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 order by 1,2"
185,"SELECT DATE_FORMAT(trans_date,'%Y-%m') as month, country, COUNT(*) as trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY 1, 2 "
186,"select DATE_FORMAT(trans_date,'%Y-%m') as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, ifnull(sum(case when state = 'approved' then amount end),0) as approved_total_amount from Transactions group by 1,2 "
187,"with total_transactions as ( SELECT DATE_FORMAT(trans_date, '%Y-%m') as month, country, COUNT(id) as trans_count, SUM(amount) as trans_total_amount FROM transactions group by month, country ), approved_transactions as ( SELECT DATE_FORMAT(trans_date, '%Y-%m') as month, country, COUNT(id) as approved_count, SUM(amount) as approved_total_amount FROM transactions WHERE state = 'approved' group by month, country ) SELECT t.month, t.country, t.trans_count, COALESCE(a.approved_count,0) as approved_count, t.trans_total_amount, COALESCE(a.approved_total_amount,0) as approved_total_amount FROM total_transactions t LEFT OUTER JOIN approved_transactions a ON t.month = a.month AND t.country = a.country "
188,"select left(trans_date, 7) as month , country , count(*) as trans_count , sum(state = 'approved') as approved_count , sum(amount) as trans_total_amount , sum(amount * if(state='approved', 1,0))as approved_total_amount from transactions group by 1,2"
189,"WITH newtable as (SELECT *, DATE_FORMAT(trans_date,'%Y-%m') as month FROM Transactions) SELECT month, country, count(*) as trans_count, IFNULL(SUM(CASE WHEN state = 'approved' THEN 1 END),0) AS approved_count, sum(amount) as trans_total_amount, IFNULL(SUM(CASE WHEN state = 'approved' THEN amount END),0) AS approved_total_amount FROM newtable GROUP BY month, country "
190,"select date_format(trans_date,""%Y-%m"") as month, country, count(id) as trans_count, sum(if(state=""approved"",1,0)) as approved_count, sum(amount) as trans_total_amount, sum(if(state=""approved"",amount,0)) as approved_total_amount from Transactions group by month, country "
191,"WITH cte AS (SELECT id, country, CASE WHEN state='approved' THEN 1 ELSE 0 END as apr,amount, DATE_FORMAT(trans_date,'%Y-%m') AS month FROM Transactions) SELECT month, country, COUNT(id) AS trans_count, SUM(apr) AS approved_count, SUM(amount) AS trans_total_amount, SUM(amount*apr) AS approved_total_amount FROM cte GROUP BY month, country"
192,"WITH cte AS ( SELECT *, LEFT(trans_date, 7) AS month_str, (CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS isApproved, (CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approvedAmount FROM Transactions ) SELECT month_str AS month, country, COUNT(*) AS trans_count, SUM(isApproved) AS approved_count, SUM(amount) AS trans_total_amount, SUM(approvedAmount) AS approved_total_amount FROM cte GROUP BY month_str, country"
193,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(state = 'approved') as approved_count, sum(amount) as trans_total_amount, sum(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount from Transactions group by month, country"
194,"select left(trans_date,7) as month, country, count(id) as trans_count,sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
195,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by left(trans_date,7), country "
196,"Select concat(year(trans_date),'-',DATE_FORMAT(trans_date, ""%m"") ) as month , country , count(id) as trans_count , SUM(case when state='approved' then 1 else 0 end) as approved_count , sum(amount) as trans_total_amount , SUM(case when state='approved' then amount else 0 end) as approved_total_amount From transactions group by 1,2"
197,"select left(trans_date,7) as month, country, count(1) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
198,"select DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(state='Approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='Approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month,country"
199,"select date_format(trans_date, ""%Y-%m"") as month, country, count(id) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
200,"with cte as (select left(trans_date ,7) as month_ , country , count(id) as numm , sum(amount) as amt from Transactions group by left(trans_date ,7) , country ), cte1 as (select left(trans_date , 7) as month_ , country , count(id) as num_, sum(amount) as amt1 from Transactions where state = 'approved' group by left(trans_date ,7) , country) select cte.month_ as month , cte.country as country , cte.numm as trans_count , ifnull(cte1.num_ ,0) as approved_count , cte.amt as trans_total_amount , ifnull(cte1.amt1 ,0) as approved_total_amount from cte left outer join cte1 on cte.month_ = cte1.month_ and cte.country = cte1.country  "
201,"select date_format(trans_date,""%Y-%m"") as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end)approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end)approved_total_amount from Transactions group by country, month"
202,"select DATE_FORMAT(trans_date,""%Y-%m"") as month, country, count(*) as trans_count, sum(state =""approved"") as approved_count,sum(amount) as trans_total_amount , sum(case when state = ""approved"" then amount else 0 end ) as approved_total_amount from Transactions group by month, country"
203,"SELECT date_format(trans_date,'%Y-%m') as month, country, count(id)trans_count , sum(case when state='approved' then 1 else 0 end) as approved_count , sum(amount)trans_total_amount , sum(case when state='approved' then amount else 0 end) as approved_total_amount FROM Transactions group by 1, 2 "
204,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(state = 'approved') as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
205,"select date_format(trans_date,'%Y-%m') as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
206,"select substring(trans_date,1,7) month ,country ,count(*) trans_count ,sum(if(state='approved',1,0)) approved_count ,sum(amount) trans_total_amount ,sum(if(state='approved',amount,0)) approved_total_amount from transactions group by 1, 2"
207,"SELECT LEFT(trans_date,7) as month, country, COUNT(id) as trans_count, SUM(Case when state = 'approved' then 1 else 0 end) AS approved_count, SUM(amount) as trans_total_amount, SUM(Case when state = 'approved' then amount else 0 end) AS approved_total_amount FROM Transactions GROUP BY 1,2"
208,"select date_format(trans_date,""%Y-%m"") as month, country,count(state)as trans_count, sum(case when state=""approved"" then 1 else 0 end)as approved_count, sum(amount)as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by date_format(trans_date,""%Y-%m""),country "
209,"with cte as ( select substr(trans_date,1,7) as month,country,state,amount,trans_date, case when state='approved' then 1 else 0 end as approved_count, case when state='approved' then amount else 0 end as approved_amount from transactions ) select month,country,count(*) as trans_count, sum(approved_count) as approved_count, sum(amount) as trans_total_amount, sum(approved_amount) as approved_total_amount from cte group by month,country "
210,"select date_format(trans_date, ""%Y-%m"") as month, country, count(state) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 2,1"
211,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(state=""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
212,"with trans as( select substr(trans_date,1,7) as 'month', country, count(id) as 'trans_count', sum(amount) as 'trans_total_amount' from transactions group by 1,2 ), app as( select substr(trans_date,1,7) as 'month', country, count(id) as 'approved_count', sum(amount) as 'approved_total_amount' from transactions where state = 'approved' group by 1,2 ) select trans.month, trans.country, trans_count, ifnull(approved_count,0) as 'approved_count', trans_total_amount, ifnull(approved_total_amount,0) as 'approved_total_amount' from trans left join app on trans.month = app.month and trans.country = app.country "
213,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
214,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY month, country"
215,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) as trans_count, SUM(state = 'approved') as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions t GROUP BY month, country"
216,"select left(trans_date, 7) as month, country, count(state) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 order by 1"
217,"select left(trans_date, 7) month,country,count(id) trans_count, sum(state='approved') as approved_count, sum(amount) trans_total_amount,sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month(trans_date),country "
218,"select left(trans_date,7) month,country, count(*) trans_count, sum(amount) trans_total_amount, sum(state='approved') approved_count , sum(if(state='approved',amount,0)) approved_total_amount from Transactions group by left(trans_date,7), country"
219,"select date_format(trans_date, '%Y-%m') as month, country, count(0) as trans_count, count(case when state='approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount , sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by date_format(trans_date, '%Y-%m'), country"
220,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END ) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END )AS approved_total_amount FROM Transactions GROUP BY month,country ORDER BY month "
221,"select left(trans_date, 7) as month, country, count(*) as trans_count, sum(state='approved') as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
222,"select left(trans_date, 7) as month, country, count(*) as trans_count, sum( case when state = 'approved' then 1 else 0 end ) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2 "
223,"select date_format(trans_date, '%Y-%m')as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, ifnull(sum(case when state='approved' then amount end), 0) as approved_total_amount from Transactions group by 1, 2"
224,"SELECT DATE_FORMAT(trans_date, '%Y-%m') month, country, COUNT(*) trans_count, COUNT(IF(state='approved',1,null)) approved_count, SUM(amount) trans_total_amount, SUM(IF(state='approved',amount,0)) approved_total_amount FROM transactions GROUP BY DATE_FORMAT(trans_date, '%Y-%m'), country"
225,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month, country, COUNT(id) AS trans_count, SUM(IF (state = 'approved', 1, 0)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF (state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY month, country "
226,"select LEFT(trans_date, 7) 'month', country, count(distinct id) as 'trans_count', count(distinct case when state = 'approved' then id else null end) as 'approved_count', sum(amount) as 'trans_total_amount', sum(case when state = 'approved' then amount else 0 end) as 'approved_total_amount' from Transactions group by 1,country "
227,"select date_format(trans_date,""%Y-%m"") as month, country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
228,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
229,"select DATE_FORMAT(trans_date,'%Y-%m') as month, country, COUNT(DISTINCT id) as trans_count, SUM(IF(state = 'approved', 1, 0)) AS approved_count, sum(amount) as trans_total_amount, IFNULL( sum( IF(state = 'approved', amount, 0)), 0) AS approved_total_amount from transactions group by 1, 2"
230,"select date_format(trans_date,'%Y-%m') as month, country, sum(case when state='approved' then 1 when state='declined' then 1 else 0 end) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(case when state='approved' then amount when state='declined' then amount else 0 end) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by month,country"
231,"SELECT month, country, COUNT(*) trans_count, SUM(IF(state='approved',1,0)) approved_count, SUM(amount) trans_total_amount, SUM(IF(state='approved',amount,0)) approved_total_amount FROM (SELECT LEFT(trans_date, 7) month, country, state, amount FROM Transactions ) t GROUP BY month, country"
232,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(DISTINCT id) AS trans_count, SUM(CASE WHEN state = ""approved"" THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = ""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY DATE_FORMAT(trans_date, ""%Y-%m""), country"
233,"select DATE_FORMAT(trans_date ,'%Y-%m') as month,country, count(state) trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count , sum(amount) trans_total_amount , sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2 "
234,"SELECT LEFT(trans_date,7) AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state ='approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM transactions GROUP BY 1,2"
235,"select date_format(trans_date,""%Y-%m"") as month, country, count(id) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by country, month"
236,"select date_format(trans_date,'%Y-%m') month,country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count , sum(amount) trans_total_amount , sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2 order by 1"
237,"Select date_format(trans_date, '%Y-%m') as month, country, sum(1) as trans_count, sum(CASE WHEN state = 'approved' THEN 1 else 0 END) as approved_count, sum(amount) as trans_total_amount, sum(CASE WHEN state = 'approved' THEN amount else 0 END) as approved_total_amount from Transactions group by month, country "
238,"select DATE_FORMAT(trans_date, '%Y-%m') as month, country, count(id) as trans_count,sum(if(state='approved',1,0)) as approved_count, sum(amount) as trans_total_amount , sum(if(state='approved',amount,0)) as approved_total_amount from Transactions group by month,country "
239,"SELECT t1.month as month,t1.country as country,t1.trans_count as trans_count,COALESCE(t2.approved_count,0) as approved_count,t1.trans_total_amount as trans_total_amount,COALESCE(t2.approved_total_amount,0) as approved_total_amount FROM (SELECT SUBSTRING(trans_date,1,7) AS month,country,COUNT(id) AS trans_count,SUM(amount) as trans_total_amount FROM Transactions GROUP BY 1,2) t1 LEFT JOIN (SELECT SUBSTRING(trans_date,1,7) AS month,country,COUNT(id) AS approved_count,SUM(amount) as approved_total_amount FROM Transactions WHERE state=""approved"" GROUP BY 1,2) t2 ON t1.month=t2.month AND t1.country=t2.country "
240,"select left(trans_date,7) as month, country, count(id) as 'trans_count', sum(case when state = 'approved' then 1 else 0 end) as 'approved_count', sum(amount) as 'trans_total_amount', sum(case when state = 'approved' then amount else 0 end) as 'approved_total_amount' from Transactions group by concat(year(trans_date),month(trans_date)),country"
241,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(state=""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country "
242,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by left(trans_date,7), country "
243,"SELECT LEFT(trans_date,7) AS month, country, COUNT(Distinct id) AS trans_count, SUM(CASE WHEN state = 'approved' then 1 else 0 END) AS approved_count , SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month,country "
244,"select left(trans_date,7)as month, country, count(*)as trans_count, sum(case when state =""approved"" then 1 else 0 end)as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end)as approved_total_amount from transactions group by month, country"
245,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
246,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT( DISTINCT id ) AS trans_count, COUNT( DISTINCT IF( state = 'approved' ,id,NULL) ) as approved_count, SUM(amount) AS trans_total_amount, SUM(IF( state = 'approved', amount,0)) AS approved_total_amount FROM Transactions GROUP BY 1,2"
247,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY month, country"
248,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, count(case when state='approved' then 1 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by left(trans_date,7),country order by country desc "
249,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, count(if(state='approved', 1, null)) as approved_count, sum(amount) as trans_total_amount, sum(if(state='approved', amount, 0)) as approved_total_amount from Transactions group by month, country"
250,"SELECT LEFT(trans_date,7) AS month ,country ,COUNT(id) AS trans_count ,SUM(IF(state = 'approved',1,0)) AS approved_count ,SUM(amount) AS trans_total_amount ,SUM(IF(state = 'approved',amount,0)) AS approved_total_amount FROM Transactions GROUP BY LEFT(trans_date,7),country"
251,"with temp(id, country, state, amount, month) as (select id, country, state, amount, left(trans_date,7) as month from transactions), temp1(month, country,trans_count, trans_total_amount) as (select distinct month, country, count(id) over (partition by month, country) as trans_count, sum(amount) over (partition by month, country) as trans_total_amount from temp), temp2(month, country, approved_count, approved_total_amount) as (select distinct month, country, count(id) over (partition by month, country) as approved_count, sum(amount) over (partition by month, country) as approved_total_amount from temp where state = 'approved') select distinct t1.month, t1.country, t1.trans_count, COALESCE(t2.approved_count,0) as approved_count, t1.trans_total_amount, COALESCE(t2.approved_total_amount,0) as approved_total_amount from temp1 t1 left outer join temp2 t2 on t1.month = t2.month and t1.country = t2.country order by month asc, country desc "
252,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) AS trans_count, COUNT(if(state='approved', 1, null)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(if(state='approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY 1, 2 "
253,"select substring(trans_date, 1, 7) as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
254,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(amount) as trans_total_amount, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
255,"select left(trans_date, 7) as 'month', country, count(*) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
256,"select left(trans_date,7) as `month`, country, count(id) as trans_count, sum(amount) as trans_total_amount, count(if(state=""approved"", id,null)) as approved_count, sum(if(state=""approved"", amount,0)) as approved_total_amount from transactions group by left(trans_date,7), country"
257,"select a.month, a.country, trans_count, ifnull(approved_count,0) approved_count,trans_total_amount,ifnull(approved_total_amount,0) approved_total_amount from (select substring(trans_date,1,7) month, country, count(id) trans_count, sum(amount) trans_total_amount from Transactions group by month, country ) a left join (select substring(trans_date,1,7) month, country, count(id) approved_count, sum(amount) approved_total_amount from Transactions where state='approved' group by month, country) b on a.month=b.month and a.country=b.country"
258,"select if(length(month)=6,concat(substring(month,1,5),""0"",substring(month,-1,1)),month) as month,country, trans as trans_count,app as approved_count, total as trans_total_amount, app_tot as approved_total_amount from (select country, concat_ws(""-"",extract(year from trans_date),extract(month from trans_date)) as month, sum(amount) as total, sum(case when state like 'approved' then amount else 0 end) as app_tot, sum(case when state like 'approved' then 1 else 0 end) as app, count(id) as trans from transactions group by month, country)t"
259,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) AS trans_count, COUNT(IF(state = 'approved', 1, NULL)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = 'approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY 1, 2"
260,"select t1.dt as month, t1.country, ifnull(t1.tot_cnt,0) as trans_count, ifnull(t2.tot_cnt,0) as approved_count, ifnull(t1.tot,0) as trans_total_amount, ifnull(t2.tot,0) as approved_total_amount from (select left(trans_date, 7) as dt, country, sum(amount) as tot, count(id) as tot_cnt from Transactions group by 1,2) t1 left join (select left(trans_date, 7) as dt, country, sum(amount) as tot, count(id) as tot_cnt from Transactions where state = 'approved' group by 1,2 ) t2 on t1.dt = t2.dt and t1.country = t2.country group by 1,2"
261,"Select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount From Transactions Group by left(trans_date,7), country order by left(trans_date,7), country desc"
262,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, sum(case when state ='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
263,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
264,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country "
265,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = 'approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
266,"SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month, country, COUNT(id) AS trans_count, SUM(state='approved') AS approved_count, SUM(amount) AS trans_total_amount, IFNULL(SUM(CASE WHEN state='approved' THEN amount END), 0) AS approved_total_amount FROM transactions GROUP BY DATE_FORMAT(trans_date, '%Y-%m'), country "
267,"select left(trans_date,7) as month, country, count(distinct id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by month, country"
268,"SELECT DISTINCT a.month, a.country, count(a.state) OVER (PARTITION BY a.month, a.country) AS trans_count, SUM(CASE WHEN state = 'A' THEN 1 ELSE 0 END) OVER (PARTITION BY a.month, a.country) AS approved_count, SUM(a.AMOUNT) OVER (PARTITION BY a.month, a.country) AS trans_total_amount, SUM(CASE WHEN state = 'A' THEN a.amount else 0 END) OVER (PARTITION BY a.month, a.country) AS approved_total_amount FROM (SELECT SUBSTRING(trans_date, 1, 7) AS month, country, CASE WHEN state = 'approved' THEN 'A' else 'D' END as state, amount FROM transactions)a "
269,"select left(trans_date, 7) as month, country, count(distinct id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, ifnull(sum(case when state = 'approved' then amount end), 0) as approved_total_amount from Transactions group by month, country"
270,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(case when state=""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by date_format(trans_date, '%Y-%m'), country "
271,"select substr(trans_date, 1, 7) as month, country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state ='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2 "
272,"select DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, count(state) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
273,"select substring(trans_date, 1, 7) as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
274,"select left(trans_date, 7) as month, country, count(*) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as 'approved_count', sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by left(trans_date, 7), country"
275,"select left(trans_date, 7) as month, country, count(id) as trans_count, sum(state='approved') as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
276,"select date_format(trans_date,""%Y-%m"") month,country, count(*) trans_count, sum(case when state='approved'then 1 else 0 end) approved_count, sum(amount) trans_total_amount, sum(case when state='approved' then amount else 0 end ) approved_total_amount from transactions group by date_format(trans_date,""%Y-%m""),country"
277,"select DATE_FORMAT(trans_date,'%Y-%m') as month , country , count(distinct id) as trans_count , sum(case when state = 'approved' then 1 else 0 end) as approved_count , sum(amount) as trans_total_amount , coalesce(sum(case when state = 'approved' then amount end),0) as approved_total_amount from transactions group by 1, 2"
278,"select left(trans_date,7) as month, country, count(amount) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) AS approved_count, sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end) AS approved_total_amount from Transactions group by left(trans_date,7), country"
279,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, count(distinct id) as trans_count, SUM(CASE WHEN state = ""approved"" THEN 1 ELSE 0 END) as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = ""approved"" THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY month, country"
280,"select date_format(trans_date,'%Y-%m') as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2"
281,"select substring(trans_date,1,7) as month, country , count(*) as trans_count, count( case when state='approved' then 1 else null end ) as approved_count, sum(amount) as trans_total_amount, sum( case when state='approved' then amount else 0 end ) as approved_total_amount from Transactions group by month, country"
282,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state = ""approved"") AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state = ""approved"", amount, 0)) AS approved_total_amount FROM Transactions GROUP BY LEFT(trans_date, 7), country"
283,"select substring(trans_date,1,7) as month, country,count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by month,country"
284,"select date_format(trans_date, '%Y-%m') as month, country, count(id) as trans_count, count(if(state='approved', 1, null)) as approved_count, sum(amount) as trans_total_amount, sum(if(state='approved', amount, 0)) as approved_total_amount from Transactions group by month, country"
285,"select date_format(trans_date, '%Y-%m') as month, country, count(*) as trans_count, sum(state = 'approved') as approved_count, sum(amount) as trans_total_amount, sum(if(state = 'approved', amount, 0)) as approved_total_amount from Transactions group by 1, 2"
286,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(state=""approved"") as approved_count, sum(amount) as trans_total_amount, sum((state=""approved"")*amount) as approved_total_amount from Transactions group by left(trans_date,7), country"
287,"SELECT date_format(trans_date, '%Y-%m') as month, country, COUNT(id) as trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY month, country"
288,"select date_format(trans_date, '%Y-%m') as month, country, count(1) as trans_count, sum(IF(state = 'approved',1,0)) as approved_count, sum(amount) as trans_total_amount, sum(IF(state = 'approved',amount,0)) as approved_total_amount from transactions group by 1,2"
289,"select left(trans_date, 7) as month, country,count(id) as trans_count, sum(if(state=""approved"",1,0)) as approved_count, sum(amount) as trans_total_amount, sum(if(state=""approved"",1,0)*amount)as approved_total_amount from Transactions group by month, country"
290,"select distinct new_date as month, country, count(id)over(partition by new_date, country) as trans_count, sum(case when state = 'approved' then 1 else 0 end)over(partition by new_date, country) as approved_count, sum(amount)over(partition by new_date, country) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end)over(partition by new_date, country) as approved_total_amount from ( select *, DATE_FORMAT(trans_date,""%Y-%m"") as new_date from transactions)sub order by trans_date"
291,"SELECT DATE_FORMAT(trans_date, '%Y-%m') month, country, count(id) trans_count, IFNULL(SUM(CASE WHEN state = 'approved' THEN 1 END), 0) approved_count, IFNULL(SUM(amount),0) trans_total_amount, IFNULL(SUM(CASE WHEN state = 'approved' THEN amount END), 0) approved_total_amount FROM transactions GROUP BY 1,2 ORDER BY 1"
292,"select left(trans_date,7) as month, country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(case when state='approved' then amount else 0 end) as approved_total_amount, sum(amount) as trans_total_amount from Transactions group by left(trans_date,7), country"
293,"select date_format(trans_date,'%Y-%m') as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
294,"Select country, date_format(trans_date, '%Y-%m') as month, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount, sum(amount) as trans_total_amount, sum(case when state = 'approved' then 1 else 0 end) as approved_count, count(*) as trans_count from Transactions group by month(trans_date), year(trans_date), country "
295,"with T1 as ( select id, country, case when state='approved' then 1 else 0 end as approved_state, amount, case when state='approved' then amount else 0 end as approved_amount, date_format(trans_date,'%Y-%m') as month from Transactions ) select month, country, count(id) as trans_count, sum(approved_state) as approved_count, sum(amount) as trans_total_amount, sum(approved_amount) as approved_total_amount from T1 group by month, country "
296,"select left(trans_date,7) as month, country, count(*) as trans_count, sum(case when state ='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state ='approved' then amount else 0 end) approved_total_amount from Transactions group by left(trans_date,7), country "
297,"select left(trans_date,7) as month,country,count(*) as trans_count, count(case when state='approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
298,"SELECT DATE_FORMAT(trans_date, '%Y-%m') as month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) as approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) as approved_total_amount FROM Transactions GROUP BY country, EXTRACT(MONTH FROM trans_date)"
299,"SELECT date_format(trans_date,""%Y-%m"") AS month ,country ,COUNT(id) AS trans_count ,SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count ,SUM(amount) AS trans_total_amount ,SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY country,MONTH(trans_date)"
300,"SELECT DATE_FORMAT(trans_date,'%Y-%m') as month, country, count(id) as trans_count, SUM(IF(state=1, 1, 0)) as approved_count, sum(amount) as trans_total_amount, SUM(IF(state='approved', amount, 0)) as approved_total_amount FROM Transactions GROUP BY month, country"
301,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY 1,2"
302,"select left(trans_date, 7) as month, country , count(*) as trans_count , count(if(state ='approved',1,null)) as approved_count , sum(amount) as trans_total_amount , sum(if(state ='approved',amount ,0)) as approved_total_amount from Transactions group by left(trans_date, 7), country"
303,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state=""approved"" THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
304,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by country,month(trans_date)"
305,"select left(trans_date, 7) month, country, count(id) trans_count, sum(case when state='approved' then 1 else 0 end) approved_count, sum(amount) trans_total_amount, sum(case when state='approved' then amount else 0 end) approved_total_amount from Transactions group by 1,2"
306,"with trans as ( select year(t.trans_date) as 'year', month(t.trans_date) as 'month', t.country, count(*) as trans_count, sum(t.amount) as 'trans_total_amount' from Transactions t group by 1,2,3 ), approved as ( select year(t.trans_date) as 'year', month(t.trans_date) as 'month', t.country, count(*) as approved_count, sum(t.amount) as 'approved_total_amount' from Transactions t where state = 'approved' group by 1,2,3 ) select case when length(t.month) = 1 then concat(t.year,'-0',t.month) else concat(t.year,'-',t.month) end as 'month', t.country, ifnull(t.trans_count,0) as 'trans_count', ifnull(a.approved_count,0) as 'approved_count', ifnull(t.trans_total_amount,0) as 'trans_total_amount', ifnull(a.approved_total_amount,0) as 'approved_total_amount' from trans t left join approved a on t.year = a.year and t.month = a.month and t.country = a.country where t.trans_count IS NOT NULL "
307,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state= 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state= 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
308,"select substring(trans_date,1,7) month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2 "
309,"SELECT T1.month, T1.country, trans_count, trans_total_amount, IFNULL(approved_count,0) approved_count, IFNULL(approved_total_amount,0) approved_total_amount FROM ( SELECT DATE_FORMAT(trans_date, ""%Y-%m"") month, country, COUNT(*) trans_count, SUM(amount) trans_total_amount FROM Transactions GROUP BY DATE_FORMAT(trans_date, ""%Y-%m""), country) AS T1 LEFT JOIN ( SELECT DATE_FORMAT(trans_date, ""%Y-%m"") month, country, COUNT(*) approved_count, SUM(amount) approved_total_amount FROM Transactions WHERE state = ""approved"" GROUP BY DATE_FORMAT(trans_date, ""%Y-%m""), country) AS T2 ON T1.month = T2.month AND T1.country = T2.country"
310,"select left(trans_date,7) as month,country, count(state) as trans_count, sum(case when state=""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state=""approved"" then amount else 0 end) as approved_total_amount from Transactions group by 1,2 "
311,"WITH T1 AS ( SELECT LEFT(trans_date,7) AS month,country,COUNT(DISTINCT id) AS approved_count, SUM(amount) AS approved_total_amount FROM Transactions WHERE state = 'approved' GROUP BY month,country), T2 AS ( SELECT LEFT(trans_date,7) AS month,country,COUNT(DISTINCT id) AS trans_count, SUM(amount) AS trans_total_amount FROM Transactions GROUP BY month,country), T3 AS ( SELECT LEFT(trans_date,7) AS month,country FROM Transactions) SELECT DISTINCT T3.month,T3.country,COALESCE(trans_count,0) AS trans_count ,COALESCE(approved_count,0) AS approved_count, COALESCE(trans_total_amount,0) AS trans_total_amount ,COALESCE(approved_total_amount,0) AS approved_total_amount FROM T3 LEFT JOIN T2 ON T2.month = T3.month AND T2.country = T3.country LEFT JOIN T1 ON T1.month = T2.month AND T1.country = T2.country"
312,"SELECT DATE_FORMAT(trans_date,'%Y-%m') AS month, country, COUNT(*) as trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, COALESCE(SUM(CASE WHEN state = 'approved' THEN amount END),0) AS approved_total_amount FROM transactions GROUP BY 1, 2 "
313,"select substring(trans_date,1,7) as month, country, COUNT(trans_date) as trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(CASE WHEN state = 'approved' OR state = 'declined' THEN Amount ELSE 0 END) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN Amount ELSE 0 END) AS approved_total_amount from Transactions group by country, month "
314,"select left(trans_date,7) as month, country, count(id) as trans_count, count(case when state = 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1, 2 "
315,"with cte as (select country, state, amount, date_format(trans_date, '%Y-%m') as month from transactions) select month, country, count(amount) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from cte group by month, country"
316,"SELECT MID(trans_date,1,7) AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
317,"select DATE_FORMAT(trans_date, '%Y-%m') as month, country, count(id) as trans_count, count(case state when 'approved' then 1 else null end) as approved_count, sum(amount) as trans_total_amount, sum(case state when 'approved' then amount else 0 end) as approved_total_amount from Transactions group by month, country"
318,"select substring(trans_date, 1, 7) as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
319,"SELECT LEFT(trans_date,7) AS month, country, COUNT(state) AS trans_count, COUNT(IF(state='approved',state,NULL)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state='approved',amount,0)) AS approved_total_amount FROM Transactions GROUP BY month, country "
320,"select substr(trans_date, 1, 7) as month, country, count(distinct id) as trans_count, sum(case when state = ""approved"" then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by month, country"
321,"select date_format(trans_date, '%Y-%m') as month, country,count(id) as trans_count, ifnull(sum(case when state = 'approved' then 1 else 0 end),0) as approved_count, sum(amount) as trans_total_amount, ifnull(sum(case when state = 'approved' then amount end),0) as approved_total_amount from Transactions group by 1,2"
322,"SELECT DATE_FORMAT(trans_date, '%Y-%m') as month, country, COUNT(id) as trans_count, SUM(CASE WHEN state = 'approved' then 1 else 0 END) as approved_count, SUM(amount) as trans_total_amount, SUM(CASE WHEN state = 'approved' then amount else 0 END) as approved_total_amount FROM Transactions GROUP BY 1,2"
323,"select date_format(trans_date, ""%Y-%m"") as month, country, count(1) as trans_count, sum(if(state='approved',1,0)) as approved_count, sum(amount) as trans_total_amount, sum(if(state='approved',amount,0)) as approved_total_amount from Transactions group by date_format(trans_date, ""%Y-%m""), country"
324,"select left(trans_date,7) as month, country, count(state) as trans_count, sum(state = 'approved') as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2 "
325,"select left(trans_date, 7) as month, country, COUNT(id) AS trans_count, COUNT(IF(state = 'approved', 1, NULL)) AS approved_count, SUM(amount) AS trans_total_amount, SUM(IF(state='approved', amount, 0)) AS approved_total_amount FROM Transactions GROUP BY 1, 2 "
326,"select substr(trans_date,1,7) month,country, count(*) trans_count, sum(case when state = 'approved' then 1 else 0 end) approved_count, sum(amount) trans_total_amount, sum(case when state = 'approved' then amount else 0 end) approved_total_amount from transactions group by 1,2 order by 1,2"
327,"select date_format(trans_date,'%Y-%m') as month, country, count(id) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by date_format(trans_date,'%Y-%m'), country "
328,"select substring(trans_date , 1,7) as month , country , count(state) as trans_count, sum(if (state = 'approved', 1, 0)) as approved_count , sum(amount) as trans_total_amount, sum(if (state='approved', amount ,0) )as approved_total_amount from Transactions group by month, country "
329,"select left(trans_date, 7) as month, country, count(state) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from transactions group by month(trans_date), country"
330,"select date_format(trans_date,""%Y-%m"") as month, country, count(*) as trans_count,sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by 1,2"
331,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state= ""approved"" then amount else 0 end) as approved_total_amount from Transactions group by 1, 2"
332,"select substring(trans_date,1,7) as month, country, count(*) as trans_count, sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount from transactions group by month,country"
333,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(state='approved') AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state='approved' THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY country, month"
334,"SELECT substring(trans_date, 1, 7) as month, country, count(id) as trans_count, SUM(IF(state = 'approved', 1, 0)) as approved_count, SUM(amount) as trans_total_amount, SUM(IF(state = 'approved', amount, 0)) as approved_total_amount FROM Transactions Group BY month, country"
335,"select DATE_FORMAT( trans_date , '%Y-%m' ) as month , country, count(state) as trans_count, COUNT(CASE WHEN state='approved' THEN 1 END) AS approved_count, sum(amount) as trans_total_amount, sum(CASE WHEN state='approved' THEN amount ELSE 0 END ) as approved_total_amount from transactions group by month, country order by month "
336,"SELECT DATE_FORMAT(trans_date, ""%Y-%m"") AS month, country, COUNT(*) AS trans_count, SUM(CASE WHEN state='approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state=""approved"" THEN amount ELSE 0 END) AS approved_total_amount FROM Transactions GROUP BY month, country"
337,"SELECT LEFT(trans_date, 7) AS month, country, COUNT(id) AS trans_count, SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count, SUM(amount) AS trans_total_amount, SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END ) AS approved_total_amount FROM Transactions GROUP BY month, country"
338,"select left(trans_date,7) as month, country, count(id) as trans_count, sum(case when state = 'approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state = 'approved' then amount else 0 end) as approved_total_amount from Transactions group by 1,2"
