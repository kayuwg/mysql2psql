id,original query
1,"select us.product_id,round(sum(units * price) / sum(units), 2) as average_price from unitssold us join prices p on us.product_id = p.product_id and us.purchase_date between p.start_date and p.end_date group by 1"
2,"With TEMP as ( Select a.product_id, a.purchase_date, a.units, b.price from UnitsSold a, Prices b Where a.product_id = b.product_id and a.purchase_date between b.start_date and b.end_date) Select product_id, round(sum(price*units)/sum(units),2) as average_price from TEMP group by product_id "
3,"select p.product_id, round(sum(u.units * p.price)/sum(u.units),2) as average_price from UnitsSold u join Prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
4,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
5,"SELECT product_id, ROUND(sum(a) / sum(units), 2) as average_price FROM ( SELECT p.product_id AS product_id, price, units, price * units AS a FROM Prices AS p LEFT JOIN UnitsSold AS u ON p.product_id = u.product_id AND (purchase_date <= end_date AND purchase_date >= start_date) ) AS t GROUP BY product_id"
6,"select t.id product_id, round(prod/sums, 2) average_price from (select sum(p.price*u.units) prod, p.product_id id, sum(u.units) sums from prices p inner join unitsSold u on u.purchase_date <= p.end_date and u.purchase_date >= p.start_date and p.product_id = u.product_id group by p.product_id) t"
7,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p left JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
8,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
9,"select p.product_id, round(sum(p.price * u.units)/sum(u.units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by 1 "
10,"select a.product_id, round(sum(a.cost)/sum(a.units), 2) as average_price from ( select UnitsSold.product_id as product_id, units, (units * Prices.price) as cost from UnitsSold left join Prices on UnitsSold.product_id = Prices.product_id where purchase_date between Prices.start_date and Prices.end_date ) a group by product_id"
11,"select p.product_id, round(sum(p.price* u.units)/sum(u.units),2) as average_price from Prices as p inner join UnitsSold as u on p.product_id = u.product_id where u.purchase_date >= p.start_date and u.purchase_date <= p.end_date group by p.product_id"
12,"with revenue as ( select a.*, b.purchase_date, b.units, a.price * b.units as revenue from Prices as a left join UnitsSold as b on a.product_id = b.product_id and a.start_date <= b.purchase_date and a.end_date >= b.purchase_date ) select product_id, round(sum(revenue) / sum(units), 2) as average_price from revenue group by product_id "
13,"SELECT UnitsSold.product_id, ROUND(SUM(Prices.price * UnitsSold.units) / SUM(UnitsSold.units), 2) AS average_price FROM UnitsSold INNER JOIN Prices ON UnitsSold.product_id = Prices.product_id AND (UnitsSold.purchase_date BETWEEN Prices.start_date AND Prices.end_date) GROUP BY UnitsSold.product_id"
14,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= end_date ) AS s GROUP BY s.product_id"
15,"with cte as (select p.product_id, p.price*u.units as total, u.units as units from prices as p inner join unitssold as u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date) select product_id, round(sum(total)/sum(units),2) as average_price from cte group by product_id "
16,"SELECT p.product_id,ROUND(SUM(u.units*p.price)/SUM(u.units),2) as average_price FROM Prices as p JOIN UnitsSold as u ON p.product_id=u.product_id AND (u.purchase_date BETWEEN p.start_date AND p.end_date) GROUP BY product_id"
17,"select p.product_id, round(sum(p.price * u.units)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
18,"SELECT Prices.product_id, ROUND(SUM(Prices.price * UnitsSold.units) / SUM(UnitsSold.units), 2) as average_price FROM Prices LEFT JOIN UnitsSold ON Prices.product_id = UnitsSold.product_id AND Prices.start_date <= UnitsSold.purchase_date AND UnitsSold.purchase_date <= Prices.end_date GROUP BY Prices.product_id"
19,"select product_id, round(ifnull(sum(price*units)/sum(units),0),2) as average_price from (select * from (select a.product_id, a.start_date,a.end_date,a.price,b.purchase_date,b.units from Prices a left join UnitsSold b on a.product_id = b.product_id ) c where purchase_date>=start_date and purchase_date<=end_date) d group by product_id"
20,"with CTE as( select p.product_id, p.price, u.units from UnitsSold u join Prices p on u.product_id=p.product_id and purchase_date between p.start_date and p.end_date) select c.product_id, round(sum(c.units*c.price)/ sum(c.units),2)as average_price from CTE c group by c.product_id "
21,"select A.product_id,round(sum(price*units)/sum(units),2) as average_price from Prices as A left join UnitsSold as B on A.product_id=B.product_id and B.purchase_date between A.start_date and A.end_date group by 1"
22,"select u.product_id,cast(sum(p.price * u.units)/sum(u.units) as decimal(10,2)) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by u.product_id "
23,"select P.product_id, round(sum(units*price)/sum(units),2) as average_price from Prices P join UnitsSold U on P.product_id = U.product_id where purchase_date between start_date and end_date group by P.product_id "
24,"select a.product_id, round(sum(units*price)/sum(units),2) as average_price from Prices a join UnitsSold b on a.product_id = b.product_id and b.purchase_date >= a.start_date and b.purchase_date <= a.end_date group by a.product_id "
25,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by product_id"
26,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= end_date ) AS s GROUP BY s.product_id"
27,"Select d.product_id, round((sum(price*units)+0.00)/(sum(units)+0.00),2) as average_price from( Select * from prices p natural join unitssold u where u.purchase_date between p.start_date and p.end_date) d group by d.product_id"
28,"SELECT u.product_id, ROUND(SUM(u.units * p.price) / SUM(u.units), 2) AS average_price FROM UnitsSold u LEFT JOIN prices p ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY u.product_id"
29,"select u.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from prices p join unitssold u on u.purchase_date between p.start_date and p.end_date and u.product_id = p.product_id group by product_id"
30,"select a.product_id, round((sum(a.price*b.units)/sum(b.units)),2) as average_price from prices a join unitssold b on a.product_id = b.product_id and (b.purchase_date between a.start_date and a.end_date) group by a.product_id"
31,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
32,"select p.product_id, round(sum(p.price*u.units)/ sum(units),2) as average_price from prices p inner join unitssold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by p.product_id "
33,"select p.product_id, round(sum(u.units*p.price)/sum(u.units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id where u.purchase_Date between p.start_date and p.end_date group by p.product_id"
34,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
35,"select a.product_id,round(sum(a.price*b.units)/sum(b.units),2) as average_price from prices as a join unitssold as b on a.product_id=b.product_id and (b.purchase_date between a.start_date and a.end_date) group by a.product_id"
36,"select p.product_id, round((sum(units * price) / sum(units)),2) as average_price from Prices p join UnitsSold u on u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date group by p.product_id"
37,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
38,"select product_id, round(sum(units*price)/sum(units), 2) average_price from Prices join UnitsSold using (product_Id) where purchase_date between start_date and end_date group by product_id "
39,"select p.product_id, ROUND(SUM(p.price*u.units)/SUM(u.units),2) as average_price from prices p LEFT JOIN unitssold u ON p.product_id = u.product_id Where purchase_date BETWEEN start_date AND end_date GROUp BY p.product_id"
40,"Select p.product_id, round(sum(units*price)/sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
41,"select P.product_id , round(sum(P.price*U.units)/sum(U.units),2) as average_price from UnitsSold U join Prices P on U.product_id = P.product_id and (purchase_date between start_date and end_date) group by P.product_id "
42,"select p.product_id, round(sum(total_units*price) / sum(total_units),2) as average_price from prices p join (select product_id, purchase_date, sum(units) as total_units from unitssold group by 1,2) us on p.product_id = us.product_id and us.purchase_date between p.start_date and p.end_date group by 1"
43,"select t.id product_id, round(prod/sums, 2) average_price from (select sum(p.price*u.units) prod, p.product_id id, sum(u.units) sums from prices p inner join unitsSold u on u.purchase_date <= p.end_date and u.purchase_date >= p.start_date and p.product_id = u.product_id group by p.product_id) t"
44,"WITH PPUS As ( SELECT Prices.product_id, start_date, end_date, price, purchase_date, units FROM Prices inner join UnitsSold on Prices.product_id = UnitsSold.product_id WHERE purchase_date between start_date and end_date) SELECT product_id, ROUND(SUM(units*price)/SUM(units),2) as average_price FROM PPUS GROUP BY product_id"
45,"select Prices.product_id, round(sum(units*price)/sum(units),2) as average_price from Prices, UnitsSold where Prices.product_id = UnitsSold.product_id and UnitsSold.purchase_date <= Prices.end_date and UnitsSold.purchase_date >= Prices.start_date group by Prices.product_id"
46,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
47,"select U.product_id, round(sum(U.units * P.price)/sum(U.units),2) as average_price from UnitsSold as U left join Prices as P on U.product_id = P.product_id where U.purchase_date between P.start_date and P.end_date group by U.product_id"
48,"select p.product_id, round(sum(u.units * p.price)/sum(u.units), 2) AS average_price from Prices p INNER JOIN UnitsSold u ON p.product_id = u.product_id AND (u.purchase_date BETWEEN p.start_date AND p.end_date) group by p.product_id "
49,"SELECT p.product_id, ROUND(SUM(p.price * u.units) / SUM(u.units),2) AS average_price FROM Prices AS p JOIN UnitsSold AS u ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
50,"SELECT T.product_id, ROUND(total_p/total_q,2) AS average_price FROM ( SELECT p.product_id, SUM(price*units) AS total_p, SUM(units) AS total_q FROM prices P JOIN unitssold U ON P.product_id=U.product_id WHERE purchase_date BETWEEN start_date and end_date GROUP BY P.product_id) T ORDER BY T.product_id"
51,"select b.product_id, round(sum(units * price) / sum(units) , 2) as average_price from UnitsSold b left join Prices a on b.product_id = a.product_id and b.purchase_date between a.start_date and end_date group by 1"
52,"select product_id, round(sum(price)/ sum(units),2) as average_price from(select x.product_id, x.purchase_date, x.units, x.units * y.price as price from UnitsSold x join Prices y on x.product_id = y.product_id and x.purchase_date between y.start_date and y.end_date) a group by 1 "
53,"with cte as ( select p.product_id, price, units, price*units as total from prices p inner join unitssold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date ) select product_id, round(sum(total)/ sum(units),2) as average_price from cte group by product_id "
54,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= end_date ) AS s GROUP BY s.product_id"
55,"select p.product_id, round(sum(p.price*u.units)/sum(u.units), 2) average_price from prices p join unitssold u on p.product_id=u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
56,"select p.product_id, round(sum(u.units * p.price)/ sum(u.units), 2) average_price from prices p inner join unitssold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by p.product_id "
57,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
58,"SELECT p.product_id, ROUND(SUM(u.units * p.price)/sum(u.units),2) as average_price FROM Prices p LEFT JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.Start_date AND p.end_date GROUP BY p.product_id "
59,"select prices.product_id, round(sum(price*units)/sum(units),2) as average_price from prices join unitssold on prices.product_id = unitssold.product_id and purchase_date between start_date and end_date group by prices.product_id "
60,"WITH raw_data AS ( SELECT U.*, price, units*price AS value FROM UnitsSold AS U INNER JOIN Prices AS P ON U.product_id = P.product_id AND purchase_date BETWEEN start_date AND end_date ) SELECT product_id, ROUND(SUM(value)/SUM(units),2) AS average_price FROM raw_data GROUP BY product_id"
61,"select p.product_id, round(sum(p.price * u.units)/sum(u.units), 2) as average_price from Prices p, UnitsSold u where p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
62,"SELECT DISTINCT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
63,"SELECT a.product_id, round((SUM(a.price*b.units)+0.00)/(SUM(b.units)+0.00), 2) AS average_price FROM prices a INNER JOIN UnitsSold b USING(product_id) WHERE b.purchase_date BETWEEN a.start_date AND a.end_date GROUP BY a.product_id"
64,"SELECT p.product_id AS product_id, ROUND(SUM(units * price) / SUM(units), 2) AS average_price FROM UnitsSold us LEFT JOIN Prices p ON us.product_id = p.product_id AND p.start_date <= us.purchase_date AND p.end_date >= us.purchase_date GROUP BY p.product_id ORDER BY p.product_id"
65,"WITH temp AS ( SELECT U.product_id, SUM(P.price * U.units) AS total_price, SUM(U.units) AS total_units FROM UnitsSold U INNER JOIN Prices P ON U.product_id = P.product_id AND U.purchase_date BETWEEN P.start_date AND P.end_date GROUP BY U.product_id ) SELECT product_id, ROUND(total_price / total_units,2) AS average_price FROM temp"
66,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
67,"WITH cte AS( SELECT u.product_id, u.purchase_date, u.units, p.price FROM UnitsSold u JOIN prices p ON u.product_id = p.product_id AND (purchase_date BETWEEN start_date AND end_date)) SELECT product_id, ROUND(SUM(price * units) / SUM(units),2) AS average_price FROM cte GROUP BY product_id ORDER BY product_id"
68,"SELECT product_id, round(sum(price*units)/sum(units),2) as average_price FROM Prices LEFT JOIN UnitsSold USING(product_id) WHERE purchase_date BETWEEN start_date AND end_date GROUP BY product_id"
69,"select p.product_id, round(sum(price * units) / sum(units), 2) as average_price from Prices p join UnitsSold u ON p.product_id = u.product_id where purchase_date between start_date and end_date group by product_id"
70,"select p.product_id, round(sum(units*price) / sum(units),2) as average_price from prices p inner join unitssold u on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
71,"select p.product_id, round((sum(p.price * s.units)/sum(s.units)), 2) as average_price from Prices p join UnitsSold s on (p.product_id = s.product_id and s.purchase_date between p.start_date and p.end_date) group by 1 "
72,"SELECT p.product_id, ROUND(SUM(u.units*p.price) / SUM(u.units), 2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
73,"with temp as( select a.product_id,price,units, sum(a.price*b.units) as tot , sum(b.units) as a from prices a inner join unitssold b using(product_id) where b.purchase_Date between a.start_date and a.end_date group by a.product_id) select product_id , coalesce(Round((tot/a),2),0) as average_price from temp group by product_id "
74,"WITH CTE1 AS ( SELECT DISTINCT * FROM UnitsSold ), CTE2 AS ( SELECT p.product_id, start_date, end_date, purchase_date, price, units FROM Prices AS p JOIN CTE1 AS U ON p.product_id = u.product_id HAVING start_date<=purchase_date AND end_date>=purchase_date) SELECT product_id, ROUND(SUM(price*units)/SUM(units), 2) AS average_price FROM CTE2 GROUP BY product_id"
75,"select u.product_id,ROUND((sum(units * price) / sum(units)),2) as average_price from UnitsSold u join Prices p on u.product_id = p.product_id and u.purchase_date BETWEEN p.start_date and p.end_date group by product_id"
76,"SELECT B.product_id, ROUND(SUM(B.units*A.price)/SUM(B.units), 2) AS average_price FROM UnitsSold B LEFT JOIN Prices A ON A.product_id = B.product_id AND A.start_date <= B.purchase_date AND B.purchase_date <= A.end_date GROUP BY 1"
77,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a left JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
78,"with temp(product_id, price, units) as (select p.product_id, p.price, u.units from prices p, unitssold u where p.product_id = u.product_id and purchase_date between start_date and end_date) select product_id, round(sum(price*units)/sum(units),2) as average_price from temp group by product_id"
79,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p inner join UnitsSold u on (p.product_id=u.product_id and u.purchase_date between start_date and end_date) group by p.product_id"
80,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id "
81,"select u.product_id, round(sum(units * price)/sum(units),2) as average_price from unitssold u join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
82,"select p.product_id,round(sum(p.price*u.units)/sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id=u.product_id and u.purchase_date between start_date and end_date group by p.product_id "
83,"SELECT a.product_id, ROUND(SUM(a.price*b.units)/SUM(b.units),2) AS average_price FROM Prices a JOIN UnitsSold b ON a.product_id=b.product_id AND b.purchase_date BETWEEN a.start_date AND a.end_date GROUP BY product_id"
84,"SELECT p.product_id, round(SUM(p.price * u.units) / SUM(u.units), 2) as average_price FROM Prices p LEFT JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date and p.end_date GROUP BY p.product_id"
85,"select p.product_id , round(sum(price*units)/sum(units),2)average_price from prices p join unitssold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by 1 order by 1"
86,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
87,"WITH t1 AS (SELECT p.product_id, p.price, u.units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= p.end_date) SELECT product_id, ROUND(SUM(units*price)/SUM(units),2) AS average_price FROM t1 GROUP BY 1"
88,"select a.product_id, round(sum(a.units*b.price)/sum(a.units), 2) as average_price from unitssold a inner join prices b on a.product_id = b.product_id and a.purchase_date between b.start_date and b.end_date group by a.product_id"
89,"with u as ( select Prices.product_id, Prices.price, UnitsSold.units from Prices, UnitsSold where Prices.start_date<=UnitsSold.purchase_date and Prices.end_date>=UnitsSold.purchase_date and Prices.product_id=UnitsSold.product_id) select product_id, round(sum(price*units)/sum(units),2) as average_price from u group by product_id "
90,"select a.product_id as product_id, round(sum(a.price*b.units)/sum(b.units),2) as average_price from Prices a left join UnitsSold b on a.product_id=b.product_id and b.purchase_date between a.start_date and a.end_date group by 1"
91,"select P.product_id, ROUND(SUM(P.price * U.units) / SUM(U.units),2) as average_price from Prices P LEFT JOIN UnitsSold U ON P.product_id = U.product_id where U.purchase_date between P.start_date and P.end_date group by 1"
92,"SELECT p.product_id, round(sum(u.units*p.price)/sum(u.units), 2) as average_price FROM Prices p INNER JOIN UnitsSold u ON p.product_id = u.product_id AND (U.purchase_date BETWEEN P.start_date AND P.end_date) GROUP BY p.product_id"
93,"with cte as ( select p.product_id, p.start_date, p.end_date, u.units as quantity, (p.price*u.units) as selling_price from Prices p left join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date ) select product_id, round ((sum(selling_price) * 1.00 /sum(quantity)),2) as average_price from cte group by product_id"
94,"SELECT Prices.product_id, ROUND(SUM(units*price)/ SUM(units),2) as average_price FROM Prices INNER JOIN UnitsSold ON Prices.product_id = UnitsSold.product_id AND (UnitsSold.purchase_date BETWEEN Prices.start_date AND Prices.end_date) GROUP BY Prices.product_id"
95,"with cte as (select p.product_id as id,price,units,u.product_id as id2 from prices p join unitssold u on p.product_id=u.product_id and u.purchase_date between p.start_date and p.end_date) select id as product_id, round((sum(price*units))/sum(units),2) as average_price from cte group by product_id"
96,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
97,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
98,"with temp as ( select p.product_id , price , units , price * units as tot_price from prices p join unitssold u on p.product_id = u.product_id where purchase_date between start_date and end_date ) select product_id , round(sum(tot_price)/sum(units),2) as average_price from temp group by product_id"
99,"with t1 as ( select product_id, purchase_date, sum(units) as total_sold from unitssold group by product_id), t2 as ( select prices.product_id, sum(price * units) as total_dollar_amount from prices join unitssold on purchase_date >= start_date and purchase_date <= end_date and prices.product_id = unitssold.product_id group by product_id) select t1.product_id, round(t2.total_dollar_amount/t1.total_sold,2) as average_price from t1 join t2 on t1.product_id = t2.product_id"
100,"SELECT p.product_id, ROUND(sum(p.price * u.units)/sum(u.units), 2) average_price From Prices p join UnitsSold u on p.product_id = u.product_id and (u.purchase_date BETWEEN p.start_date and p.end_date) group by p.product_id "
101,"Select product_id,ROUND((total)/total_units,2) as 'average_price' FROM ( select sum(price*units) as total ,p.product_id, sum(units) as 'total_units' FROM Prices p JOIn UnitsSold u on p.product_id=u.product_id AND u.purchase_date between p.start_date and p.end_date group by p.product_id )a"
102,"select P.product_id, round(sum(price*units)/sum(units), 2) as average_price from Prices P left join UnitsSold U on P.product_id =U.product_id where purchase_date between start_date and end_date group by product_id "
103,"select product_id, round((sum(price*units)/sum(units)), 2) as average_price from prices join unitssold using(product_id) where purchase_date between start_date and end_date group by product_id "
104,"select P.product_id, round(SUM(P.price * S.units) / SUM(S.units),2) as average_price from Prices P join UnitsSold S ON P.product_id = S.product_id where S.purchase_date between P.start_date and P.end_date group by 1"
105,"Select a.product_id,ROUND(SUM(a.units*b.price)/SUM(a.units),2) as average_price from UnitsSold a JOIN Prices b On a.product_id = b.product_id AND a.purchase_date between b.start_date and b.end_date group by a.product_id "
106,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p inner join UnitsSold u on p.product_id=u.product_id and (purchase_date between start_date and end_date) group by p.product_id"
107,"select p.product_id,round(sum(p.price*u.units)/sum(u.units),2) as average_price from UnitsSold u join Prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
108,"select p.product_id, ROUND(SUM(u.units*p.price) / SUM(u.units),2) as average_price from Prices p inner join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
109,"SELECT T.id AS product_id, ROUND(SUM(T.unit*T.price)/SUM(T.unit), 2) AS average_price FROM (SELECT U.product_id as id, U.units as unit, P.price as price FROM Prices AS P, UnitsSold AS U WHERE (U.purchase_date BETWEEN P.start_date AND P.end_date) AND P.product_id = U.product_id ) AS T GROUP BY T.id"
110,"select prices.product_id, round(sum(price*units)/sum(units),2) average_price from prices join unitssold using(product_id) where purchase_date between start_date and end_date group by 1 order by 1"
111,"SELECT Prices.product_id, ROUND(SUM(UnitsSold.units * Prices.price) / SUM(UnitsSold.units), 2) AS average_price FROM Prices LEFT JOIN UnitsSold ON Prices.product_id = UnitsSold.product_id AND UnitsSold.purchase_date BETWEEN Prices.start_date AND Prices.end_date GROUP BY Prices.product_id"
112,"select p.product_id, ROUND((SUM(p.price * u.units) / SUM(u.units)), 2) as average_price from prices p join unitssold u on p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
113,"select u.product_id, round(sum(units*p.price)/sum(units),2) as 'average_price' from unitssold u left join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by u.product_id "
114,"select a.product_id , round(sum(a.price*b.units)/sum(b.units),2) as average_price from (select distinct * from prices) as a inner join unitssold as b on a.start_date <= b.purchase_date and a.end_date >= b.purchase_date and a.product_id = b.product_id group by 1"
115,"SELECT u.product_id, ROUND(SUM(units*price)/SUM(units), 2) AS average_price FROM UnitsSold u JOIN Prices p ON u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY u.product_id"
116,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
117,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(u.units),2) AS average_price FROM Prices p LEFT JOIN UnitsSold U ON p.product_id = u.product_id WHERE DATE(purchase_date) BETWEEN DATE(start_date) AND DATE(end_date) GROUP BY product_id"
118,"select p.product_id, round((sum(p.price*s.units)/sum(s.units)),2) as average_price from prices p join unitsSold s on p.product_id =s.product_id AND s.purchase_date BETWEEN p.start_date AND p.end_date group by p.product_id "
119,"WITH cte AS ( SELECT p.product_id, p.price*u.units as sales, u.units FROM prices p JOIN unitsSold u ON u.purchase_date BETWEEN p.start_date AND p.end_date AND p.product_id = u.product_id ) SELECT product_id, round(sum(sales)/sum(units),2) as average_price FROM cte GROUP BY product_id"
120,"WITH temp AS (SELECT u.product_id, u.purchase_date, u.units, p.price, u.units*p.price AS tot_price FROM UnitsSold u LEFT JOIN Prices p ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date AND p.end_date) SELECT product_id, ROUND(SUM(tot_price)/SUM(units), 2) AS average_price FROM temp GROUP BY 1"
121,"Select u.product_id, round(sum(u.units*p.price)/sum(u.units), 2) as average_price From Prices as p Join UnitsSold as u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date Group by u.product_id"
122,"select p.product_id, round(sum(units*price)/sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and purchase_date between start_date and end_date group by product_id"
123,"with temp_price as ( select u.product_id, p.price*u.units as t_price, u.units from unitssold u left join prices p on u.product_id=p.product_id and u.purchase_date between p.start_date and p.end_date ) select product_id, round(sum(t_price)/sum(units),2) as average_price from temp_price group by product_id "
124,"select a.product_id, round(ifnull(sum(units*price)/sum(units), 0), 2) as average_price from prices a left join unitssold b on a.product_id = b.product_id and b.purchase_date between a.start_date and a.end_date group by 1"
125,"SELECT product_id, ROUND(sum(a) / sum(units), 2) AS average_price FROM (SELECT p.product_id AS product_id, price, units, price * units AS a FROM Prices AS p LEFT JOIN UnitsSold AS u ON p.product_id = u.product_id AND (purchase_date <= end_date AND purchase_date >= start_date) ) AS t GROUP BY product_id"
126,"select P.product_id, round(sum(P.price*U.units)/sum(U.units),2) AS average_price from Prices P INNER JOIN UnitsSold U ON P.product_id=U.product_id AND (U.purchase_date BETWEEN P.start_date AND P.end_date) group by P.product_id "
127,"select p.product_id, round(sum(units*price)/sum(units),2) as average_price from Prices p inner join UnitsSold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date group by 1"
128,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
129,"SELECT p.product_id, ROUND(SUM(units*price)/SUM(units), 2) AS average_price FROM Prices AS p JOIN UnitsSold AS s ON p.product_id = s.product_id WHERE purchase_date BETWEEN start_date AND end_date GROUP BY p.product_id "
130,"select product_id, round(sum(revenue)/sum(total_units),2) as average_price from (select prices.product_id, sum(price*units) as revenue, sum(units) as total_units from prices join UnitsSold on prices.product_id=UnitsSold.product_id where UnitsSold.purchase_date between prices.start_date and prices.end_date group by prices.product_id,purchase_date) as tem group by product_id"
131,"select p.product_id,round(sum(price*units)/sum(units),2) as average_price from Prices p inner join UnitsSold u on (p.product_id=u.product_id and (purchase_date between start_date and end_date)) group by product_id "
132,"SELECT a.product_id, ROUND(SUM(a.units*b.price)/SUM(a.units),2) AS average_price FROM unitssold a INNER JOIN prices b ON a.product_id=b.product_id AND a.purchase_date between b.start_date AND b.end_date GROUP BY 1 ORDER BY 1"
133,"SELECT P.product_id, ROUND(SUM(P.Price * U.units)/SUM(U.units),2) AS average_price FROM Prices P JOIN UnitsSold U ON P.product_id = U.product_id AND (U.purchase_date BETWEEN P.start_date AND P.end_date) GROUP BY product_id "
134,"select P.product_id , ROUND(sum(P.price * S.units) / SUM(S.units) ,2) as average_price from Prices P JOIN UnitsSold S ON P.product_id = S.product_id where S.purchase_date between P.start_date and P.end_date group by 1"
135,"SELECT a.product_id , ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
136,"select u.product_id, round( sum(u.units * p.price) / sum(u.units) , 2) as average_price from UnitsSold u inner join Prices p on p.product_id = u.product_id AND u.purchase_date between p.start_date and p.end_date group by u.product_id"
137,"with temp as (select u.product_id, sum(units) as tot_units, sum(price*units) as total from UnitsSold u join prices p on u.product_id = p.product_id where purchase_date between start_date and end_date group by 1) select product_id, round(total/tot_units,2) as average_price from temp"
138,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
139,"SELECT u.product_id, round(sum(price*units)/sum(units),2)as average_price from UnitsSold u left join Prices p on u.product_id=p.product_id and purchase_date between start_date and end_date GROUP by u.product_id"
140,"SELECT Prices.product_id, ROUND((SUM(price * units) / SUM(units)),2) AS average_price FROM Prices INNER JOIN UnitsSold ON UnitsSold.product_id = Prices.product_id WHERE purchase_date BETWEEN start_date AND end_date GROUP BY product_id "
141,"SELECT p.product_id, ROUND(SUM(p.price * u.units) / SUM(u.units), 2) AS average_price FROM Prices p INNER JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY product_id  "
142,"select p.product_id, round(sum(price*units)/sum(units),2) average_price from prices p join unitssold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date group by p.product_id "
143,"SELECT p.product_id product_id, round((sum(u.units*p.price) / sum(u.units)),2) average_price FROM UnitsSold u JOIN Prices p ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY 1 "
144,"with cte as ( select product_id,sum(units) summ from unitssold u group by 1) select z.product_id,round(average_price/c.summ,2) as average_price from ( select p.product_id,sum(case when purchase_date between start_date and end_date then price*units end) average_price from prices p ,unitssold u where u.product_id=p.product_id group by 1 ) z, cte c where c.product_id=z.product_id "
145,"with combined as ( select p.product_id, price, units, start_date, end_date, purchase_date from Prices p join UnitsSold u on p.product_id = u.product_id) select product_id, round(sum(tol)/sum(units),2) as average_price from (select product_id, price*units as tol, units from combined where purchase_date between start_date and end_date) as t group by product_id"
146,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
147,"with cte as ( select u.product_id, u.purchase_date, u.units, p.price from unitssold u join prices p on u.product_id=p.product_id where u.purchase_date between p.start_date and p.end_date) select product_id, round(sum(units*price)/sum(units),2) as average_price from cte group by 1"
148,"select p.product_id, round(sum(u.units * p.price)/ sum(u.units), 2) average_price from prices p join unitssold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by product_id "
149,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a INNER JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
150,"select p.product_id, round(sum(p.price * u.units)/sum(u.units), 2) as average_price from unitssold u left join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
151,"SELECT p.product_id AS product_id, ROUND(SUM(units * price) / SUM(units), 2) AS average_price FROM UnitsSold us LEFT JOIN Prices p ON us.product_id = p.product_id AND p.start_date <= us.purchase_date AND p.end_date >= us.purchase_date GROUP BY p.product_id ORDER BY p.product_id"
152,"SELECT p.product_id, ROUND((SUM(p.price * u.units) / SUM(u.units)), 2) average_price FROM Prices p JOIN UnitsSold u ON (p.product_id = u.product_id) AND (u.purchase_date BETWEEN p.start_date AND p.end_date) GROUP BY 1 "
153,"with tb as( select p.product_id, u.units, p.price*u.units as sales from Prices p join Unitssold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date) select product_id, round(sum(sales)/sum(units),2) as average_price from tb group by 1 "
154,"select t.id product_id, round(prod/sums, 2) average_price from (select sum(p.price*u.units) prod, p.product_id id, sum(u.units) sums from prices p inner join unitsSold u on u.purchase_date <= p.end_date and u.purchase_date >= p.start_date and p.product_id = u.product_id group by p.product_id) t"
155,"SELECT a.product_id, round(SUM(a.price*b.units)/SUM(b.units), 2) AS average_price FROM prices a INNER JOIN UnitsSold b USING(product_id) WHERE b.purchase_date BETWEEN a.start_date AND a.end_date GROUP BY a.product_id"
156,"WITH cte AS (SELECT u.product_id, u.units, p.price, u.units*p.price AS total FROM Prices p JOIN UnitsSold u ON u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date) SELECT product_id, ROUND(SUM(total)/SUM(units),2) AS average_price FROM cte GROUP BY product_id "
157,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p inner join UnitsSold u on p.product_id=u.product_id and (purchase_date between start_date and end_date) group by product_id "
158,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= end_date ) AS s GROUP BY s.product_id"
159,"select u.product_id, round((sum(u.units * p.price)/ sum(u.units)),2) as average_price from unitssold u join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
160,"select u.product_id, round(sum(units*price)/sum(units),2) as average_price from prices p, unitssold u where purchase_date between start_date and end_date and u.product_id = p.product_id group by 1"
161,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
162,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from prices p join UnitsSold u on p.product_id = u.product_id and purchase_date between start_date and end_date group by 1"
163,"select p.product_id,round(sum(price*units)/sum(units),2) as average_price from Prices p join UnitsSold u on u.purchase_date<=p.end_date and u.purchase_date>=p.start_date and p.product_id=u.product_id group by product_id"
164,"select p.product_id, round(sum(p.price*u.units) / sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by product_id"
165,"select U.product_id, cast(sum(units*price)/sum(units) as Decimal(36,2)) as average_price from Unitssold U left join Prices P on P.product_id = U.product_id and U.purchase_date between P.start_date and P.end_date group by U.product_id"
166,"select u.product_id, round( sum(p.price * u.units) / sum(u.units) , 2) as average_price from prices p join unitssold u on u.product_id = p.product_id where u.purchase_date between p.start_date and p.end_date group by u.product_id"
167,"select product_id, round(sum(total_daily_price) / sum(units),2) as average_price from (select uni.product_id, uni.purchase_date, uni.units, P.price * uni.units as total_daily_price from UnitsSold uni join Prices P on P.product_id = uni.product_id and uni.purchase_date between P.start_date and P.end_date) sub group by product_id"
168,"SELECT product_id, ROUND(SUM(units*price)/SUM(units),2) AS average_price FROM (SELECT u.product_id, u.units, p.price FROM UnitsSold u LEFT JOIN Prices p USING(product_id) WHERE u.purchase_date BETWEEN p.start_date AND p.end_date) sub GROUP BY product_id"
169,"select P.product_id, round(sum(P.price * U.units) / sum(U.units),2) as average_price from Prices P JOIN UnitsSold U ON P.product_id = U.product_id where U.purchase_date between P.start_date and P.end_date group by 1"
170,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and u.purchase_date between p.start_Date and p.end_date group by product_id"
171,"select p.product_id,round((sum(price*units)/sum(units)),2) as average_price from prices p inner join unitssold u on p.product_id=u.product_id where purchase_date between start_date and end_date group by p.product_id"
172,"with temp as ( select p.product_id , price , units , price * units as tot_price from prices p join unitssold u on p.product_id = u.product_id where purchase_date between start_date and end_date ) select product_id , round(sum(tot_price)/sum(units),2) as average_price from temp group by product_id"
173,"SELECT p.product_id, ROUND((SUM(p.price * u.units) / SUM(u.units)), 2) average_price FROM prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
174,"select P.product_id, round(sum(price*units)/sum(units), 2) as average_price from Prices P left join UnitsSold U on P.product_id =U.product_id where purchase_date between start_date and end_date group by product_id"
175,"select P.product_id, round(sum(units*price)/sum(units),2)as average_price from Prices P inner join UnitsSold U on P.product_id = U.product_id and U.purchase_date BETWEEN P.start_date and P.end_date group by P.product_id"
176,"select product_id, round(sum(price*units)/sum(units),2) as average_price from (select product_id, purchase_date, (select price from prices p where purchase_date between start_date and end_date and p.product_id=u.product_id) as price, units from unitssold u)T group by product_id "
177,"WITH total_units AS (SELECT u1.product_id, SUM(u1.units) total_units FROM UnitsSold u1 GROUP BY u1.product_id), total_daily_revenue AS ( SELECT p.product_id, u2.purchase_date, (p.price * u2.units) total_daily_revenue FROM Prices p INNER JOIN UnitsSold u2 ON p.product_id = u2.product_id WHERE u2.purchase_date BETWEEN p.start_date AND p.end_date ), total_revenue AS ( SELECT total_daily_revenue.product_id, SUM(total_daily_revenue.total_daily_revenue) total_revenue FROM total_daily_revenue GROUP BY total_daily_revenue.product_id ) SELECT total_units.product_id, ROUND((total_revenue.total_revenue / total_units.total_units), 2) average_price FROM total_units JOIN total_revenue ON total_units.product_id = total_revenue.product_id "
178,"SELECT P.product_id, round(SUM(P.price * U.units)/SUM(U.units),2) as average_price FROM UnitsSold U JOIN Prices P on (P.product_id=U.product_id AND U.purchase_date BETWEEN P.start_date and P.end_date) GROUP BY P.product_id "
179,"select Prices.product_id , round((sum( units * price) / sum(units)),2) as average_price from Prices,UnitsSold where Prices.product_id = UnitsSold.product_id and UnitsSold.purchase_date >= Prices.start_date and UnitsSold.purchase_date <= Prices.end_date group by product_id"
180,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p inner join UnitsSold u on (p.product_id = u.product_id and u.purchase_date<= p.end_date and u.purchase_date>=p.start_date ) group by product_id "
181,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
182,"with temp as ( select p.product_id , price , units , price * units as tot_price from prices p join unitssold u on p.product_id = u.product_id where purchase_date between start_date and end_date ) select product_id , round(sum(tot_price)/sum(units),2) as average_price from temp group by product_id "
183,"select p.product_id, round(sum(p.price * u.units)/sum(u.units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date)group by product_id"
184,"select a.product_id,round(sum((a.price*b.units))/sum(b.units),2) as average_price from prices a join UnitsSold b on a.product_id=b.product_id where purchase_date between start_date and end_date group by product_id "
185,"select Prices.product_id, round(sum(price*units) / sum(units),2) as average_price from Prices join UnitsSold on Prices.product_id=UnitsSold.product_id where purchase_date between start_date and end_date group by product_id "
186,"SELECT A.product_id, ROUND(SUM(A.price * B.units) / SUM(B.units), 2 ) AS average_price FROM Prices AS A left join UnitsSold AS B on A.product_id = B.product_id WHERE B.purchase_date >= A.start_date AND B.purchase_date <= A.end_date GROUP BY A.product_id "
187,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p JOIN UnitsSold u ON p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by u.product_id "
188,"select a.product_id, round(sum(price * units) / sum(units), 2) as average_price from unitssold a join prices b on a.product_id = b.product_id and purchase_date between start_date and end_date group by a.product_id"
189,"select a.product_id, round(sum(a.price * b.units) / sum(b.units),2) as average_price from prices a join unitssold b on b.purchase_date BETWEEN a.start_date AND a.end_date and a.product_id = b.product_id group by 1 "
190,"select prices.product_id, round(sum(prices.price*unitssold.units)/sum(unitssold.units), 2) as average_price from prices join unitssold on prices.product_id=unitssold.product_id and unitssold.purchase_date between prices.start_date and prices.end_date group by product_id"
191,"select p.product_id, round(((SUM(p.price*u.units)) / (SUM(u.units))),2) as average_price from prices p join UnitsSold u where p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id order by p.product_id "
192,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id "
193,"select p.product_id, round(sum(units*price)/sum(units),2) average_price from prices p join unitssold us on p.product_id = us.product_id and purchase_date between start_date and end_date group by p.product_id "
194,"with temp as( select p.product_id,p.price,u.units, (price*units) as total from prices p join unitssold u on p.product_id = u.product_id where purchase_date between start_date and end_date group by p.product_id, start_date, end_date, purchase_date, p.price, u.units) select product_id, round((sum(temp.total)/sum(temp.units)),2) as average_price from temp group by product_id"
195,"select p.product_id,round(sum(u.units*p.price)/sum(u.units),2) as average_price from prices p join UnitsSold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date group by u.product_id"
196,"select us.product_id,round(sum(units * price) / sum(units), 2) as average_price from unitssold us join prices p on us.product_id = p.product_id and us.purchase_date between p.start_date and p.end_date group by 1"
197,"SELECT p.product_id AS product_id, ROUND((SUM(u.units*p.price)/SUM(u.units)),2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND (u.purchase_date BETWEEN p.start_date AND p.end_date) GROUP BY p.product_id "
198,"SELECT A.product_id, ROUND(SUM(A.price * B.units) / SUM(B.units), 2 ) AS average_price FROM Prices AS A left join UnitsSold AS B on A.product_id = B.product_id WHERE B.purchase_date BETWEEN A.start_date AND A.end_date GROUP BY A.product_id "
199,"with w as ( select a.*, b.units, a.price*b.units as total_price from prices a join unitssold b on a.product_id = b.product_id and b.purchase_date between a.start_date and a.end_date) select product_id, round(sum(total_price)/sum(units),2) as average_price from w group by product_id "
200,"select p.product_id, round(sum(price*units)/sum(units),2) 'average_price' from prices p, unitssold u where p.product_id=u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
201,"select t1.id product_id, round(sum(t1.prod/t2.sums), 2) average_price from (select (p.price*u.units) prod, p.product_id id from prices p inner join unitsSold u on u.purchase_date <= p.end_date and u.purchase_date >= p.start_date and p.product_id = u.product_id ) t1 inner join (select sum(u.units) sums, p.product_id from prices p inner join unitsSold u on u.purchase_date <= p.end_date and u.purchase_date >= p.start_date and p.product_id = u.product_id group by u.product_id) t2 on t1.id = t2.product_id group by t1.id"
202,"with cte as( select P.product_id, price, units, (price * units) total_price from Prices P left join UnitsSold U on P.product_id = U.product_id and U.purchase_date between P.start_date and P.end_date) select distinct product_id, round(sum(total_price) / sum(units),2) average_price from cte group by product_id"
203,"select us.product_id,round(sum(units * price) / sum(units), 2) as average_price from unitssold us join prices p on us.product_id = p.product_id and us.purchase_date between p.start_date and p.end_date group by 1"
204,"select t1.product_id as product_id, round(sum(t1.total_price)/sum(t1.units),2) as average_price from (select Prices.product_id as product_id, Prices.price * UnitsSold.units as total_price, UnitsSold.units as units from Prices inner join UnitsSold on Prices.product_id = UnitsSold.product_id and UnitsSold.purchase_date between Prices.start_date and Prices.end_date) as t1 group by product_id"
205,"SELECT a.product_id as product_id, ROUND(SUM(a.units * b.price)/SUM(a.units),2) as average_price FROM UnitsSold a JOIN Prices b ON a.product_id = b.product_id AND a.purchase_date between b.start_date and b.end_date GROUP BY 1"
206,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(units),2) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
207,"SELECT Prices.product_id, ROUND(SUM(price * units)/SUM(units),2) AS average_price FROM Prices INNER JOIN UnitsSold ON Prices.product_id = UnitsSold.product_id WHERE purchase_date BETWEEN start_date AND end_date GROUP BY Prices.product_id"
208,"select p.product_id, round(sum(u.units*p.price)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by product_id "
209,"SELECT A.PRODUCT_ID, round(sum(units * price) / sum(units), 2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
210,"select p.product_id, ROUND(SUM(u.units*p.price)/SUM(u.units),2) as average_price from prices as p join unitssold as u on p.product_id=u.product_id where u.purchase_Date>=p.start_date and u.purchase_date<=p.end_date group by p.product_id "
211,"SELECT distinct p.product_id, round(sum(p.price*u.units)/sum(u.units) ,2) as average_price FROM Prices as p LEFT JOIN UnitsSold as u ON p.product_id = u.product_id WHERE u.purchase_date between p.start_date and p.end_date GROUP BY p.product_id "
212,"select p.product_id, round(sum(price * units) / sum(units), 2) average_price from Prices p join UnitsSold s on p.product_id = s.product_id and purchase_date between start_date and end_date group by 1"
213,"with temp as ( select p.product_id , price , units , price * units as tot_price from prices p join unitssold u on p.product_id = u.product_id where purchase_date between start_date and end_date ) select product_id , round(sum(tot_price)/sum(units),2) as average_price from temp group by product_id"
214,"with t as ( select p.product_id,p.price,u.units, p.price*u.units as total_price from Prices p join UnitsSold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date) select product_id,round(sum(total_price)/ sum(units),2)as average_price from t group by product_id "
215,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p left join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and end_date group by p.product_id"
216,"with t as ( select product_id, price*units as total, units from prices join unitssold using(product_id) where purchase_date between start_date and end_date ) select product_id, round(sum(total)/sum(units), 2) as average_price from t group by product_id order by product_id "
217,"select b.product_id, round(sum(units*price)/sum(units),2) as average_price from prices a, unitsSold b where a.product_id = b.product_id and b.purchase_date between a.start_date and a.end_date group by b.product_id"
218,"select p.product_id, round(sum(s.units * p.price)/sum(s.units),2) as average_price from prices as p join unitssold as s on p.product_id = s.product_id and s.purchase_Date between p.start_date and p.end_date group by p.product_id "
219,"select product_id,round(sum(units*price)/sum(units),2) as average_price from unitssold join prices using (product_id) where purchase_date between start_date and end_date group by product_id "
220,"SELECT p.product_id, ROUND(SUM(p.price * u.units) / SUM(u.units), 2) AS average_price FROM Prices p, UnitsSold u WHERE p.product_id = u.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= p.end_date GROUP BY p.product_id"
221,"select u.product_id, round(sum(u.units * p.price) / sum(u.units), 2) as average_price from prices p join unitssold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by u.product_id"
222,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
223,"select p.product_id, round((sum(p.price*u.units))/(sum(u.units)),2) as average_price from prices p left join unitssold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
224,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices as p left join UnitsSold as u on p.product_id=u.product_id and (purchase_date between start_date and end_date) group by 1"
225,"select p.product_id, round((sum(p.price*u.units)/sum(u.units)),2) as average_price from unitssold u join prices p on p.product_id=u.product_id and u.purchase_date between p.start_date and p.end_Date group by p.product_id "
226,"SELECT a.product_id,round(sum(a.price*b.units)/sum(b.units),2) as average_price FROM Prices a Join UnitsSold b on a.product_id=b.product_id and b.purchase_date between a.start_date and a.end_date group by a.product_id"
227,"Select p.product_id, round(sum(price*units)/sum(units),2) as average_price From Prices as p Left join UnitsSold as u on p.product_id = u.product_id Where purchase_date between start_date and end_date Group by p.product_id "
228,"with sales as (select prices.product_id,(prices.price*unitssold.units) as total_price,unitssold.units from prices join unitssold on prices.product_id=unitssold.product_id and unitssold.purchase_date between prices.start_date and prices.end_date) select product_id,round(sum(total_price)/sum(units),2) as average_price from sales group by product_id"
229,"select product_id , round(sum(x) / sum(units), 2) as average_price from ( select a.product_id , sum(price * units) as x , sum(units) as units from UnitsSold a join prices b on a.product_id = b.product_id and purchase_date between b.start_date and b.end_date group by 1 ) x group by 1 "
230,"select p.product_id, round(sum(u.units * p.price)/ sum(u.units), 2) average_price from prices p join unitssold u on p.product_id = u.product_id where (u.purchase_date between p.start_date and p.end_date) group by 1 "
231,"select p.product_id, round(sum(p.price * u.units)/sum(u.units),2) as average_price from prices p, unitssold u where (u.purchase_date between p.start_date and p.end_date) and (u.product_id = p.product_id) group by p.product_id order by p.product_id asc "
232,"select p.product_id, round(sum(price*units) / sum(units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and purchase_date between start_date and end_date group by p.product_id"
233,"select u.product_id, round(sum(units*price)/sum(units),2) as average_price from UnitsSold u JOIN prices p USING(product_id) where purchase_date between start_date and end_date group by 1"
234,"SELECT T.product_id, ROUND(SUM(T.total_price)/SUM(T.units),2) AS average_price FROM ( SELECT P.product_id, (units*price) as total_price, price, units FROM Prices AS P JOIN UnitsSold AS US ON P.product_id = US.product_id WHERE purchase_date BETWEEN Start_date AND end_date ) AS T GROUP BY T.product_id"
235,"select p.product_id, round(sum(u.units * p.price)/ sum(u.units), 2) average_price from prices p inner join unitssold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by p.product_id"
236,"WITH temp AS( SELECT U.product_id, U.units AS totalunits, U.units * P.price AS totalprice FROM Prices P JOIN UnitsSold U ON U.purchase_date BETWEEN P.start_date AND P.end_date AND P.product_id = U.product_id) SELECT product_id, ROUND(SUM(totalprice)/SUM(totalunits),2) AS average_price FROM temp GROUP BY product_id"
237,"SELECT t1.product_id , ROUND(SUM(t2.units*t1.price)/SUM(t2.units),2) AS average_price FROM Prices AS t1 INNER JOIN UnitsSold AS t2 USING(product_id) WHERE t2.purchase_date BETWEEN t1.start_date AND t1.end_date GROUP BY product_id"
238,"select u.product_id, round(sum(u.units*p.price)/sum(units),2) as average_price from UnitsSold u left join Prices p on u.product_id=p.product_id and (u.purchase_date between p.start_date and p.end_date) group by u.product_id"
239,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id "
240,"SELECT p.product_id AS product_id , ROUND(SUM(price*units) / SUM(units),2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
241,"SELECT P.product_id, ROUND( SUM(units * price) / SUM(units), 2) AS average_price FROM UnitsSold AS S JOIN Prices AS P ON S.product_id = P.product_id AND (S.purchase_date BETWEEN P.start_date AND P.end_date) GROUP BY P.product_id "
242,"select p.product_id, round((sum(u.units * p.price)/sum(units)), 2) as average_price from prices p join unitssold u on p.product_id = u.product_id WHERE u.purchase_date between p.start_date and p.end_date group by 1"
243,"with combined as ( select p.product_id, price, units, start_date, end_date, purchase_date from Prices p join UnitsSold u on p.product_id = u.product_id) select product_id, round(sum(tol)/sum(units),2) as average_price from (select product_id, price*units as tol, units from combined where purchase_date between start_date and end_date) as t group by product_id"
244,"select u.product_id, round(sum(p.price*u.units) / sum(units), 2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by u.product_id"
245,"with tcte as ( select p.product_id, u.purchase_date, (p.price * u.units) as total from prices p, unitssold u where p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date ) select t.product_id,round(sum(t.total)/ sum(u.units), 2) as average_price from tcte t, unitssold u where t.product_id = u.product_id and t.purchase_date = u.purchase_date group by t.product_id "
246,"select p.product_id,round(sum(units*price)/coalesce(sum(units),1),2) as average_price from prices p left join unitssold u on p.product_id = u.product_id and purchase_date>=start_date and purchase_date<=end_date group by p.product_id"
247,"select distinct a.product_id, round(sum(a.price*b.units)/sum(b.units),2) as average_price from Prices a join UnitsSold b on a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) group by a.product_id "
248,"select p.product_id ,round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices as p left join UnitsSold u on(p.product_id =u.product_id) where u.purchase_date between p.start_date and p.end_date group by product_id"
249,"select product_id, round(sum(price*units)/sum(units),2) as average_price from (select p.product_id, price, units from Prices p left join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date ) a group by product_id "
250,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
251,"select a.product_id,ROUND (sum(a.price*b.units)/ SUM(b.units),2) as average_price from Prices a, UnitsSold b where b.purchase_date between a.start_date and a.end_date and a.product_id = b.product_id group by product_id"
252,"with temp(product_id, price_unit, units) as (select a.product_id, (a.price*b.units) as price_unit, b.units from Prices a inner join UnitsSold b on a.product_id = b.product_id and b.purchase_date between start_date and end_date ) select product_id, round(sum(price_unit)/sum(units), 2) as average_price from temp group by product_id order by product_id"
253,"select p.product_id, round(sum(u.units*price)/sum(u.units),2) as average_price from Prices p inner join UnitsSold u on p.product_id=u.product_id and u.purchase_date>=p.start_date and u.purchase_date<=p.end_date group by p.product_id "
254,"select a.product_id, round(sum(a.price * b.units)/sum(b.units),2) as average_price from Prices a join UnitsSold b on a.product_id = b.product_id AND a.start_date <= b.purchase_date AND a.end_date >= b.purchase_date group by a.product_id "
255,"select p.product_id, round((sum(p.price * us.units) / sum(us.units)), 2) as average_price from Prices p join UnitsSold us on p.product_id = us.product_id and us.purchase_date between p.start_date and p.end_date group by p.product_id"
256,"select p.product_id , round(sum(price*units)/sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id=u.product_id and (purchase_date<=end_date and purchase_date>=start_date) group by 1"
257,"select distinct p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Unitssold U join Prices P on u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
258,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(u.units), 2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id=u.product_id AND (u.purchase_date BETWEEN p.start_date AND p.end_date) GROUP BY p.product_id "
259,"SELECT P.product_id, ROUND(SUM(U.units *P.price)/SUM(U.units),2) AS average_price FROM Prices P LEFT JOIN UnitsSold U On P.product_id = U.product_id AND(U.purchase_date BETWEEN P.start_date AND P.end_date) GROUP BY product_id "
260,"with c as ( select p.product_id, start_date, end_date, purchase_date, units, price, units*price as tot_price from Prices p left join UnitsSold u on p.product_id= u.product_id where u.purchase_date between p.start_date and p.end_date ) , b as ( select product_id, sum(units) as tot_units from c group by product_id ) , a as ( select c.product_id,tot_price, tot_units from c, b where c.product_id=b.product_id ) select a.product_id, round(sum(tot_price)*1.0/ min(tot_units), 2) as average_price from a group by product_id"
261,"SELECT u.product_id, ROUND(SUM(p.price*u.units)/SUM(u.units),2) AS average_price FROM unitssold u JOIN prices p ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY u.product_id "
262,"with total_dollar_step1 as( select u.product_id,p.price*u.units as total_lines from unitssold u left join prices p on u.product_id=p.product_id and u.purchase_date between p.start_date and p.end_date), total_dollar_step2 as ( select product_id,sum(total_lines) as total_price from total_dollar_step1 group by product_id), units_total as(select product_id,sum(units) as total_u from unitssold group by product_id) select a.product_id,round(a.total_price/b.total_u,2) as average_price from total_dollar_step2 a inner join units_total b on a.product_id=b.product_id"
263,"select a.product_id, Round(sum(a.units*b.price)/sum(a.units), 2) as average_price from unitsSold a, prices b where a.product_id = b.product_id and a.purchase_date between b.start_date and b.end_date group by a.product_id"
264,"select p.product_id, round(sum(price * units) / sum(units), 2) average_price from Prices p, UnitsSold s where p.product_id = s.product_id and purchase_date between start_date and end_date group by 1"
265,"select u.product_id, round( sum( case when u.purchase_date between p.start_date and p.end_date then p.price else 0 end * u.units) / sum(case when u.purchase_date between p.start_date and p.end_date then u.units else 0 end) ,2) as average_price from prices p, unitssold u where u.product_id = p.product_id group by u.product_id"
266,"SELECT p.product_id, IFNULL(ROUND((SUM(p.price * u.units) / SUM(u.units)), 2), 0) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id WHERE u.purchase_date <= p.end_date AND u.purchase_date >= p.start_date GROUP BY p.product_id ORDER BY 1 "
267,"select a.product_id, round(sum(a.price*b.units)/sum(b.units),2) as average_price from Prices a join UnitsSold b on a.product_id = b.product_id and b.purchase_date between a.start_date and a.end_date group by a.product_id "
268,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id "
269,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from prices p, unitsSold u where u.product_id=p.product_id and purchase_date between start_date and end_date group by p.product_id"
270,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(units),2) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
271,"select u.product_id, round(sum(p.price * u.units)/sum(u.units), 2) as average_price from UnitsSold as u join Prices as p on p.product_id = u.product_id and u.purchase_date between start_date and end_date group by u.product_id "
272,"SELECT product_id, ROUND(total_cost/units, 2) AS average_price FROM (SELECT p.product_id, SUM(units*price) AS total_cost, SUM(units) AS units FROM Prices p JOIN UnitsSold u ON u.product_id = p.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= p.end_date GROUP BY product_id) AS T"
273,"select a.product_id, Round(SUM(b.units*a.price)/SUM(b.units),2) as average_price from Prices as a join UnitsSold as b on a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) Group by product_id "
274,"SELECT p.product_id, ROUND(SUM(u.units * p.price) / SUM(u.units),2) AS average_price FROM Prices AS p LEFT JOIN UnitsSold AS u ON (p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date) GROUP BY p.product_id"
275,"Select u.product_id, round(sum(u.units*p.price)/sum(u.units), 2) as average_price From Prices as p Join UnitsSold as u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date Group by u.product_id"
276,"SELECT P.product_id, ROUND(SUM(P.price*U.units)/SUM(U.units),2) AS average_price FROM Prices P INNER JOIN UnitsSold U ON P.product_id = U.product_id AND U.purchase_date BETWEEN P.start_date AND P.end_date GROUP BY P.product_id "
277,"SELECT P.product_id, ROUND(SUM(U.units*P.price) / SUM(U.units), 2) AS 'average_price' FROM Prices P INNER JOIN UnitsSold U ON P.product_id = U.product_id AND U.purchase_date BETWEEN P.start_date AND P.end_date GROUP BY p.product_id ORDER BY P.product_id ASC"
278,"select p.product_id,round(sum(units*price)/sum(units),2) as average_price from prices p join unitssold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date group by product_id"
279,"with CTE as( select p.product_id, p.price, u.units from UnitsSold u join Prices p on u.product_id=p.product_id and purchase_date between p.start_date and p.end_date) select c.product_id, round(sum(c.units*c.price)/ sum(c.units),2)as average_price from CTE c group by c.product_id "
280,"SELECT product_id, ROUND(SUM(temp_sum)/SUM(units),2) AS average_price FROM ( SELECT p1.product_id, (p1.price * u1.units) AS temp_sum, u1.units FROM Prices p1 JOIN UnitsSold u1 ON p1.product_id = u1.product_id AND u1.purchase_date between p1.start_date AND p1.end_date) a GROUP BY a.product_id"
281,"select prices.product_id, round(sum(prices.price*unitssold.units)/sum(unitssold.units), 2) as average_price from prices inner join unitssold on prices.product_id = unitssold.product_id where unitssold.purchase_date between prices.start_date and prices.end_date group by prices.product_id"
282,"select p.product_id, round((sum(p.price*u.units)/sum(u.units)),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
283,"select p.product_id, round(sum(units*price)/sum(units),2) as average_price from prices p inner join unitssold u on p.product_id=u.product_id and purchase_date<=end_date and purchase_date>=start_date group by p.product_id"
284,"Select p.product_id, ROUND(sum(price*units)/sum(units),2) as average_price FROM Prices p JOIN Unitssold u on p.product_id = u.product_id and purchase_date between start_date and end_date GROUP BY 1"
285,"SELECT u.product_id, ROUND((SUM(u.units*p.price) / SUM(u.units)), 2) AS average_price FROM UnitsSold u JOIN Prices p ON u.product_id = p.product_id AND u.purchase_date >= p.start_date AND u.purchase_date <= p.end_date GROUP BY u.product_id"
286,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p join UnitsSold s on p.product_id=s.product_id and s.purchase_date>=start_date and s.purchase_date<=end_date group by 1"
287,"select p.product_id,round((sum(p.price*U.units)/sum(U.units)),2) as average_price from prices p join unitssold U on P.product_id=U.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id "
288,"select p.product_id, round(sum(p.price*u.units)/ sum(u.units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and datediff(u.purchase_date, p.start_date) >= 0 and datediff(p.end_date, u.purchase_date) >= 0 group by product_id "
289,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(units),2) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
290,"SELECT p.product_id, ROUND((SUM(u.units * p.price) / SUM(u.units)), 2) AS 'average_price' FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id "
291,"SELECT p.product_id, CAST(SUM(sold.units * p.price)/SUM(sold.units) AS DECIMAL(18,2)) AS average_price FROM UnitsSold sold INNER JOIN Prices p ON p.product_id = sold.product_id AND sold.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY product_id"
292,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
293,"select product_id,round(sum(sellingprice)/sum(units),2) average_price from ( (select u.product_id,u.purchase_date,u.units,p.price, units*price sellingprice from unitssold u join prices p on u.product_id = p.product_id and u.purchase_date>=p.start_date and u.purchase_date <=p.end_date) )a group by 1"
294,"SELECT P.product_id ,ROUND(SUM(P.price*U.units)/SUM(U.units),2) AS average_price FROM Prices P INNER JOIN UnitsSold U ON U.product_id = P.product_id AND U.purchase_date BETWEEN P.start_date AND P.end_date GROUP BY P.product_id"
295,"select product_id, round(sum(price)/ sum(units),2) as average_price from(select x.product_id, x.purchase_date, x.units, x.units * y.price as price from UnitsSold x join Prices y on x.product_id = y.product_id and x.purchase_date between y.start_date and y.end_date) a group by 1 "
296,"SELECT DISTINCT p.product_id, ROUND(SUM(price*units)/SUM(units),2) average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND purchase_date BETWEEN start_date AND end_date GROUP BY 1"
297,"with x as (select p.product_id, p.price , u.units, (p.price*u.units) as total_money from Prices as p join UnitsSold as u on p.product_id = u.product_id where purchase_date between p.start_date and p.end_date ) select product_id, round(sum(total_money)/sum(units), 2 ) as average_price from x group by product_id "
298,"select Prices.product_id, round(sum(Prices.price*UnitsSold.units)/sum(UnitsSold.units),2) as average_price from Prices inner join (select distinct * from UnitsSold) UnitsSold on Prices.product_id = UnitsSold.product_id where purchase_date>=start_date and purchase_date<=end_date group by Prices.product_id"
299,"WITH cost as (SELECT p.product_id, (p.price * u.units) as total_cost, u.units, u.purchase_date FROM unitssold u LEFT JOIN prices p ON u.product_id = p.product_id and (u.purchase_date between p.start_date and p.end_date) GROUP BY p.product_id, u.purchase_date) SELECT product_id, round(sum(total_cost)/sum(units), 2) as average_price FROM cost GROUP BY product_id "
300,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
301,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
302,"SELECT u.product_id, ROUND(SUM(p.price * u.units) / SUM(u.units), 2) AS average_price FROM UnitsSold u LEFT JOIN Prices p ON u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY u.product_id"
303,"select p.product_id, round(sum(price *units)/sum(units),2 )average_price from Prices p join UnitsSold u on p.product_id = u.product_id and purchase_date <= end_date and purchase_date>=start_date group by p.product_id"
304,"select p.product_id, round(sum(u.units * p.price) / sum(u.units),2) as average_price from UnitsSold u, Prices p where (p.product_id = u.product_id) and u.purchase_date between p.start_date and p.end_date group by u.product_id "
305,"SELECT prices.product_id, ROUND(SUM(price*units)/SUM(units),2) AS average_price FROM prices JOIN unitssold ON prices.product_id = unitssold.product_id AND unitssold.purchase_date BETWEEN start_date AND end_date GROUP BY prices.product_id"
306,"SELECT p.product_id, ROUND(SUM(p.price * us.units) / SUM(us.units), 2) AS average_price FROM Prices AS p LEFT OUTER JOIN UnitsSold AS us ON p.product_id = us.product_id AND p.start_date <= us.purchase_date AND us.purchase_date <= p.end_date GROUP BY p.product_id "
307,"SELECT a.product_id, ROUND(SUM(a.units*b.price) / SUM(a.units), 2) AS average_price FROM UnitsSold a LEFT JOIN Prices b ON a.product_id = b.product_id AND a.purchase_date BETWEEN b.start_date AND b.end_date GROUP BY 1"
308,"SELECT p.product_id, ROUND(SUM(price * units) / SUM(units),2) AS average_price FROM Prices p LEFT JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date >= start_date AND u.purchase_date <= end_date GROUP BY 1"
309,"with temp as ( select u.product_id, u.units, p.price*u.units as total_price from prices p join UnitsSold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date ) select product_id, round(sum(total_price)/sum(units),2) as average_price from temp group by product_id"
310,"select p.product_id, round(sum(u.units*p.price)/sum(u.units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id"
311,"SELECT U.product_id , ROUND(SUM(U.units*P.price)/SUM(U.units),2) AS average_price FROM UnitsSold U JOIN Prices P ON U.product_id = P.product_id WHERE purchase_date BETWEEN start_date AND end_date GROUP BY U.product_id ORDER BY U.product_id "
312,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
313,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p left join UnitsSold u on p.product_id=u.product_id and u.purchase_date>=p.start_date and u.purchase_date<=p.end_date group by 1"
314,"SELECT p.product_id, ROUND(IFNULL(SUM(p.price*u.units) / SUM(u.units),0),2) as average_price FROM Prices p LEFT JOIN UnitsSold u ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date and p.end_date GROUP BY p.product_id "
315,"select p.product_id, round(sum(u.units*p.price)/sum(u.units),2) as average_price from prices p join unitssold u on u.product_id=p.product_id and purchase_date between start_date and end_date group by p.product_id"
316,"select p.product_id ,round(sum(u.units*p.price)/sum(u.units),2) as average_price from Prices p, UnitsSold u where u.purchase_date between p.start_date and p.end_date and p.product_id = u.product_id group by u.product_id"
317,"select product_id, round(sum(units*(select price from prices where product_id=a.product_id and start_date <= a.purchase_date and end_date >= a.purchase_date))/sum(units),2) as average_price from UnitsSold as a group by product_id"
318,"select p.product_id, round(sum(u.units * p.price)/ sum(u.units), 2) average_price from prices p inner join unitssold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by p.product_id"
319,"select p.product_id, round(sum(u.units*p.price)/sum(u.units), 2) average_price from prices p inner join unitssold u on p.product_id=u.product_id and (u.purchase_date between p.start_date and p.end_date) group by p.product_id "
320,"Select a.product_id, round((sum((a.price * b.units)) / sum(b.units)), 2) as average_price from Prices a Join UnitsSold b on a.product_id = b.product_id and (b.purchase_date >= a.start_date and b.purchase_date <= a.end_date) group by a.product_id"
321,"SELECT U.product_id, ROUND((SUM(U.units*P.price)/SUM(U.units)),2) AS average_price FROM UnitsSold AS U INNER JOIN Prices AS P ON U.product_id=P.product_id AND U.purchase_date BETWEEN P.start_date AND P.end_date GROUP BY U.product_id "
322,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(units),2) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
323,"SELECT u.product_id, ROUND(SUM(u.units * p.price) / SUM(u.units), 2) AS average_price FROM unitssold u LEFT JOIN prices p ON u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY 1 "
324,"with cte as ( select p.product_id, p.price, u.units from prices p inner join unitssold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date ) select product_id, round(sum(price*units)/sum(units),2) as average_price from cte group by product_Id"
325,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
326,"SELECT U.product_id , ROUND(SUM(U.units*P.price)/SUM(U.units),2) AS average_price FROM UnitsSold U LEFT JOIN Prices P ON U.product_id = P.product_id WHERE purchase_date BETWEEN start_date AND end_date GROUP BY U.product_id ORDER BY U.product_id"
327,"select p.product_id, round(sum(units*price)/sum(units),2) average_price from prices p join unitssold us on p.product_id = us.product_id and purchase_date between start_date and end_date group by p.product_id "
328,"select u.product_id, round(sum(u.units*p.price)/sum(u.units),2) as average_price From UnitsSold u join Prices p On u.product_id = p.product_id where u.purchase_date between p.start_date and p.end_date group by u.product_id"
329,"select p.product_id,round(sum(price*units)/sum(units),2) as average_price from prices as p join unitssold as u on p.product_id=u.product_id and purchase_date between start_date and end_date group by p.product_id"
330,"select p.product_id, round(sum(units*price)/sum(units),2) average_price from prices p join unitssold us on p.product_id = us.product_id and purchase_date between start_date and end_date group by p.product_id"
331,"select u.product_id, round(sum(price*units)/sum(units),2) average_price from unitssold u join prices p where u.product_id = p.product_id and purchase_date between start_date and end_date group by u.product_id"
332,"select p.product_id, round((sum(p.price*u.units)/sum(u.units)),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id "
333,"select p.product_id, round(sum(price*units)/sum(units),2)as average_price from prices p join UnitsSold us on p.product_id=us.product_id and purchase_date between start_date and end_date group by product_id"
334,"WITH cte AS (SELECT u.product_id, u.units, p.price, u.units*p.price AS total FROM Prices p JOIN UnitsSold u ON u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date) SELECT product_id, ROUND(SUM(units*price)/SUM(units),2) AS average_price FROM cte GROUP BY product_id "
335,"select p.product_id, round(sum(p.price * u.units)/sum(u.units),2) as average_price from unitssold as u left join prices as p on u.product_id = p.product_id and p.start_date <= u.purchase_date and p.end_date >= u.purchase_date group by p.product_id "
336,"select p.product_id, round((sum(p.price*u.units)/sum(u.units)),2) as average_price from prices as p, unitssold as u where p.product_id = u.product_id and u.purchase_date >= p.start_date and u.purchase_date <= p.end_date group by p.product_id"
337,"select product_id, round((sum(price * units) / sum(units) ), 2) as average_price from (select * from prices left join unitssold using (product_id) where purchase_date between start_date and end_date) as t group by product_id "
338,"select product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p left join UnitsSold u using(product_id) where purchase_date between start_date and end_date group by p.product_id"
339,"Select P.product_id, Round(sum(U.units*P.price) / sum(U.units) , 2) as average_price FROM Prices as P INNER JOIN UnitsSold as U ON P.product_id = U.product_id Where U.purchase_date between P.start_date and P.end_date Group by product_id"
340,"with cte as ( select u.product_id, (units*price) as price, sum(units) over (partition by product_id) as units_sold from UnitsSold u inner join Prices p on u.purchase_date >= p.start_date and u.purchase_date <= p.end_date and u.product_id = p.product_id ) select product_id, round(sum(price)/max(units_sold),2) as average_price from cte group by product_id"
341,"Select Prices.product_id,Round(Sum(Price*units)/Sum(Units),2) as average_price FRom Prices Inner Join UnitsSold Using(product_id) Where UnitsSold.purchase_date BETWEEN Prices.start_date AND Prices.end_date Group By Prices.product_id"
342,"select u.product_id, round(sum(price*units)/sum(units), 2) as average_price from UnitsSold u left join Prices p on u.product_id = p.product_id and purchase_date <= end_date and purchase_date >= start_date group by product_id"
343,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from prices as p left join unitssold as u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by p.product_id "
344,"SELECT p.product_id, ROUND((SUM(p.price * us.units) / SUM(us.units)), 2) average_price FROM prices p JOIN UnitsSold us ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
345,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b ON a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
346,"select u.product_id, round((sum((u.units * p.price)))/sum(u.units),2) as average_price from unitssold u join prices p on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by u.product_id "
347,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and (u.purchase_date between p.start_date and p.end_date) group by p.product_id "
348,"SELECT product_id, ROUND(sum(a) / sum(units), 2) as average_price FROM ( SELECT p.product_id AS product_id, price, units, price * units AS a FROM Prices AS p LEFT JOIN UnitsSold AS u ON p.product_id = u.product_id AND (purchase_date <= end_date AND purchase_date >= start_date) ) AS t GROUP BY product_id"
349,"SELECT p.product_id, ROUND(SUM(price*units)/SUM(units), 2) AS average_price FROM Prices AS p JOIN UnitsSold AS u ON p.product_id = u.product_id AND (u.purchase_date BETWEEN p.start_date AND p.end_date) GROUP BY p.product_id"
350,"SELECT DISTINCT u.product_id, ROUND(SUM(p.price*u.units)/SUM(u.units),2) AS average_price FROM UnitsSold u LEFT JOIN Prices p ON u.product_id = p.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY u.product_id"
351,"SELECT p.product_id, ROUND((SUM(p.price * s.units) / SUM(s.units)), 2) average_price FROM Prices p JOIN UnitsSold s ON p.product_id = s.product_id AND s.purchase_date between p.start_date and p.end_date GROUP by product_id "
352,"select u.product_id, ROUND(SUM(u.units*p.price)/SUM(u.units),2) average_price from unitssold u join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_Date group by u.product_id"
353,"select p.product_id, round(sum(u.units*p.price)/sum(units), 2) as average_price from Prices p left join UnitsSold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by p.product_id"
354,"SELECT u.product_id, ROUND(SUM(u.units*p.price)/ SUM(u.units),2) AS average_price FROM UnitsSold u JOIN Prices p ON (u.purchase_date BETWEEN p.start_date AND p.end_date) AND p.product_id = u.product_id GROUP BY u.product_id"
355,"with cte as ( select u.product_id, u.units, p.price from UnitsSold u left join Prices p on (u.product_id = p.product_id) and (u.purchase_date between p.start_date and p.end_date) ) select product_id, round(sum(units*price) / sum(units), 2) as average_price from cte group by 1"
356,"select product_id,round(sum(units*price)/sum(units),2) as average_price from (select Prices.product_id as product_id,units,price from Prices join UnitsSold on Prices.product_id = UnitsSold.product_id and purchase_date between start_date and end_date)t1 group by product_id"
357,"select a.product_id, round(sum(price * units) / sum(units), 2) as average_price from unitssold a join prices b on a.product_id = b.product_id and purchase_date between start_date and end_date group by a.product_id"
358,"select p.product_id, round(sum(u.units*p.price)/sum(units),2) as average_price from prices p join unitssold u on p.product_id = u.product_id and purchase_date between start_date and end_date group by p.product_id"
359,"SELECT p.product_id, ROUND(SUM(u.units*p.price)/SUM(u.units),2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND (u.purchase_date BETWEEN p.start_date AND end_date) GROUP BY product_id "
360,"WITH TA as (select P.product_id, U.purchase_date, price, Units from Prices P join UnitsSold U on P.product_id = U.product_id where U.purchase_date between P.Start_date and P.end_date) select product_id, round(sum(price * Units)/sum(units), 2) as average_price from TA group by product_id"
361,"select us.product_id, round(sum(p.price*us.units)/sum(us.units),2) as average_price from UnitsSold us left join Prices p on p.product_id=us.product_id and us.purchase_date between p.start_date and p.end_date group by us.product_id"
362,"select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p join UnitsSold s on p.product_id = s.product_id where purchase_date between start_date and end_date group by product_id order by product_id"
363,"Select p.product_id, round(sum(price*units)/sum(units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
364,"SELECT p.product_id, round(sum(price*units)/sum(units),2) average_price FROM prices p join UnitsSold u ON u.product_id=p.product_id and purchase_date between start_date and end_date group by p.product_id"
365,"select p.product_id,round(SUM(p.price* u.units)/SUM(u.units),2) 'average_price' from prices p inner join unitssold u on u.purchase_date between p.start_date and p.end_date and p.product_id = u.product_id group by 1 order by 1"
366,"select u.product_id, round(sum(u.units*p.price)/sum(u.units),2) as average_price from unitssold u left join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by p.product_id "
367,"with temp as ( select pr.product_id, pr.start_date, pr.end_date, pr.price, un.purchase_date, un.units,pr.price*un.units as sales from Prices pr join UnitsSold un on un.product_id=pr.product_id having purchase_date between start_date and end_date ) select product_id, round(sum(sales)/sum(units),2) as average_price from temp group by product_id"
368,"select product_id, round(sum(price*units)/sum(units),2) average_price from (select p.product_id, price, units from Prices p join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date) a group by product_id"
369,"with totalPurchase as ( select pri.product_id ,sum(price*units) as totalPrice ,sum(units) as totalUnits from Prices as pri join UnitsSold as Us on pri.product_id = Us.product_id and purchase_date between start_date and end_date group by pri.product_id ) select product_id ,round(totalPrice/totalUnits,2) as average_price from totalPurchase"
370,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(units),2) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
371,"SELECT Prices.product_id, ROUND(SUM(units*price) / SUM(units), 2) average_price FROM Prices JOIN UnitsSold us ON Prices.product_id = us.product_id AND us.purchase_date BETWEEN Prices.start_date AND Prices.end_date GROUP BY Prices.product_id"
372,"select product_id, round(sum(units*price)/sum(units), 2) as average_price from ( select distinct a.product_id, a.purchase_date, a.units, b.price from UnitsSold a join Prices b on a.product_id = b.product_id and a.purchase_date >= b.start_date and a.purchase_date <= b.end_date ) as t1 group by product_id order by product_id"
373,"SELECT product_id, IFNULL(ROUND(SUM(temp_sum)/SUM(units),2),0) AS average_price FROM ( SELECT p1.product_id, (p1.price * u1.units) AS temp_sum, u1.units FROM Prices p1 JOIN UnitsSold u1 ON p1.product_id = u1.product_id AND u1.purchase_date between p1.start_date AND p1.end_date) a GROUP BY a.product_id"
374,"SELECT a.product_id, ROUND(CAST(SUM(a.units*b.price) AS DECIMAL (7,2))/CAST(SUM(a.units) AS DECIMAL (7,2)),2) as average_price FROM UnitsSold a LEFT JOIN Prices b ON a.product_id=b.product_id and a.purchase_date between b.start_date and b.end_date GROUP BY a.product_id "
375,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p inner join UnitsSold u on p.product_id=u.product_id where u.purchase_date between p.start_date and p.end_date group by p.product_id "
376,"select p.product_id, round(sum(u.units * p.price)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date group by u.product_id order by u.product_id"
377,"SELECT product_id, CAST(SUM(total_price) / SUM(total_units) AS DECIMAL(10, 2)) AS average_price FROM ( SELECT p.product_id AS product_id, p.price * u.units AS total_price, u.units AS total_units FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date ) AS s GROUP BY s.product_id"
378,"SELECT a.product_id,ROUND(SUM(b.units*a.price)/SUM(b.units),2) as average_price FROM Prices as a JOIN UnitsSold as b where a.product_id=b.product_id AND (b.purchase_date BETWEEN a.start_date AND a.end_date) GROUP BY product_id"
379,"SELECT p.product_id ,ROUND(SUM(p.price * u.units)/SUM(u.units),2) as average_price FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id WHERE u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY 1"
380,"SELECT u.product_id, round(sum(price*units)/ sum(units),2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id=u.product_id AND (purchase_date BETWEEN start_date AND end_date) GROUP BY 1 "
381,"SELECT p.product_id, ROUND(SUM(price*units)/SUM(units), 2) AS average_price FROM prices p INNER JOIN unitssold u ON p.product_id = u.product_id AND purchase_Date BETWEEN start_Date AND end_Date GROUP BY p.product_id "
382,"with new as ( select u.product_id, u.purchase_date, u.units, p.price from unitssold u join prices p on p.product_id = u.product_id where u.purchase_date between p.start_date and p.end_date ) select product_id, round(sum(units*price)/ sum(units),2) as 'average_price' from new group by product_id order by product_id"
383,"SELECT P.product_id, ROUND(SUM(P.price*U.units)/SUM(U.units),2) as average_price FROM Prices P JOIN UnitsSold U ON P.product_id=U.product_id WHERE U.purchase_date BETWEEN P.start_date AND P.end_date GROUP By P.product_id "
384,"SELECT p.product_id, ROUND(SUM(price * units) / SUM(units), 2) AS average_price FROM Prices AS p LEFT JOIN UnitsSold AS u ON p.product_id = u.product_id WHERE purchase_date BETWEEN start_date AND end_date GROUP BY p.product_id "
385,"select t2.product_id, round((t1.mul/t2.sum),2) as 'average_price' from (select p.product_id, sum((p.price * units)) as mul from prices p left join unitsSold u on (p.product_id = u.product_id) where start_date <= purchase_date and end_date >= purchase_date group by p.product_id) t1 left join (select product_id, sum(units) as 'sum' from UnitsSold group by product_id) t2 on (t1.product_id = t2.product_id) "
386,"select p.product_id, round(sum(units*price)/sum(units),2)as average_price from prices p join unitssold u on p.product_id=u.product_id where purchase_date between start_date and end_date group by product_id"
387,"select p.product_id, round(sum(p.price*u.units)/sum(u.units),2) as average_price from Prices p join UnitsSold u on p.product_id=u.product_id and u.purchase_Date between p.start_Date and p.end_Date group by p.product_id"
388,"SELECT P.product_id, ROUND(SUM(P.price * U.units)/ SUM(U.units), 2) AS average_price FROM Prices AS P JOIN UnitsSold AS U ON P.product_id = U.product_id WHERE U.purchase_date BETWEEN P.start_date and P.end_date GROUP BY P.product_id"
389,"SELECT u.product_id, ROUND(SUM(price * units) / SUM(units), 2) AS average_price FROM UnitsSold u LEFT JOIN Prices p ON u.product_id = p.product_id AND (purchase_date BETWEEN start_date AND end_date) GROUP BY u.product_id "
390,"select p.product_id,round(SUM(p.price* u.units)/SUM(u.units),2) 'average_price' from prices p inner join unitssold u on u.purchase_date between p.start_date and p.end_date and p.product_id = u.product_id group by 1 order by 1"
391,"select p.product_id, round(sum(price*units)/ sum(units), 2) as average_price from unitssold u join prices p on p.product_id= u.product_id and (u.purchase_date between p.start_date and p.end_date) group by product_id"
392,"SELECT a.product_id, ROUND(sum(price*units)/sum(units),2) average_price FROM UnitsSold a JOIN Prices b ON a.product_id = b.product_id and purchase_date between start_date and end_date GROUP BY 1"
393,"select us.product_id, round(sum(units*price)/sum(units),2) as average_price from prices p inner join unitssold us on p.product_id = us.product_id and us.purchase_date between p.start_date and p.end_date group by 1"
394,"select a.product_id, round(sum(a.units*b.price)/sum(a.units),2) as average_price from UnitsSold as a left join prices as b on a.product_id=b.product_id and start_date <= a.purchase_date and end_date >= a.purchase_date group by a.product_id"
395,"SELECT p.product_id, ROUND(SUM(p.price*u.units)/SUM(units),2) AS average_price FROM prices p JOIN unitssold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date AND p.end_date GROUP BY p.product_id"
396,"SELECT u.product_id, ROUND(SUM(p.price * u.units)/SUM(u.units), 2) AS average_price FROM Prices p JOIN UnitsSold u ON p.product_id = u.product_id AND u.purchase_date BETWEEN p.start_date and p.end_date GROUP BY 1"
397,"select a.product_id, round(sum(price * units)/sum(units), 2) average_price from Prices a join UnitsSold b on a.product_id = b.product_id and a.start_date <= b.purchase_date and a.end_date >= b.purchase_date group by a.product_id "
398,"select a.product_id, ROUND(sum(b.units * a.price)/sum(b.units), 2) as average_price from Prices as a Join UnitsSold as b on a.product_id = b.product_id and (b.purchase_date between a.start_date and a.end_date) group by product_id"
399,"select u.product_id, round(sum(u.units * p.price) / sum(u.units), 2) as average_price from unitssold u join prices p on u.product_id = p.product_id and u.purchase_date between p.start_date and p.end_date group by 1 order by 1"
400,"select p.product_id, round(sum(price * units)/sum(units), 2) as average_price from Prices p inner join UnitsSold u on p.product_id = u.product_id and u.purchase_date between p.start_date and p.end_date group by 1"
