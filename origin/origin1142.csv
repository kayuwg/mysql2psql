id,original query
1,"WITH user_session AS ( SELECT user_id, COUNT(DISTINCT(session_id)) AS num FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(num), 2),0) AS average_sessions_per_user FROM user_session "
2,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f"
3,"select round(ifnull(count(distinct user_id,session_id)/count(distinct user_id),0),2) as average_sessions_per_user from activity where activity_date<='2019-07-27' and activity_date>date_sub('2019-07-27', INTERVAL 30 DAY) "
4,"select round(ifnull(avg(num),0),2) as 'average_sessions_per_user' from ( select user_id, count(distinct session_id) as 'num' from activity where datediff('2019-07-27',activity_date) < 30 group by user_id) as A "
5,"select coalesce(round(sum(session_per_user_cnt)/user_cnt,2),0) as average_sessions_per_user from ( select count(distinct user_id) as user_cnt, count(distinct session_id) as session_per_user_cnt from activity where activity_date between '2019-06-28' and '2019-07-26' ) a"
6,"select round(ifnull(count(distinct user_id, session_id)/count(distinct user_id),0),2) as average_sessions_per_user from activity where activity_date <= ""2019-07-27"" and activity_date > date_sub(""2019-07-27"",interval 30 day)"
7,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN DATE_SUB(""2019-07-27"",INTERVAL 29 DAY) AND ""2019-07-27"" "
8,"With t1 AS (SELECT COUNT(DISTINCT(session_id)) AS session_total FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND'2019-07-27' GROUP BY user_id) SELECT IFNULL(ROUND(AVG(session_total),2),0) AS average_sessions_per_user FROM t1 "
9,"WITH d AS (SELECT * FROM Activity a WHERE activity_date BETWEEN date_add('2019-07-27', interval -29 day) AND '2019-07-27') SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT USER_ID) , 2) , 0) AS average_sessions_per_user FROM d"
10,"SELECT IFNULL(ROUND(SUM(t.cnt) / COUNT(*), 2), 0.00) AS 'average_sessions_per_user' FROM (SELECT COUNT(DISTINCT session_id) AS 'cnt' FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY user_id) t "
11,"SELECT ifnull(round(count(DISTINCT session_id)/count(distinct user_id),2),0.00) as ""average_sessions_per_user"" FROM Activity WHERE activity_date BETWEEN ""2019-06-28"" AND ""2019-07-27"" "
12,"with t as ( select distinct user_id, count(distinct session_id) as num_sessions from Activity where activity_date <= date(""2019-07-27"") and activity_date >= date_add(""2019-07-27"", INTERVAL -29 DAY) group by user_id) select ifnull(round(sum(num_sessions)/count(user_id),2),0) as average_sessions_per_user from t "
13,"WITH sessions AS ( SELECT user_id, COALESCE(COUNT(DISTINCT session_id), 0) total_sessions FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id ) SELECT ROUND(COALESCE((SUM(total_sessions)/COUNT(user_id)), 0), 2) average_sessions_per_user FROM sessions"
14,"select ifnull(round(sum(ct)/count(user_id),2),0.00)as average_sessions_per_user from ( select user_id, count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t"
15,"select ifnull(round(count(distinct(session_id))/count(distinct(user_id)),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'"
16,"select round(ifnull(count(distinct session_id)/count(distinct user_id), 0),2) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) <= 29"
17,"SELECT ROUND(IFNULL(AVG(cnt),0), 2) AS average_sessions_per_user FROM ( SELECT user_id, COUNT(DISTINCT session_id) AS cnt FROM Activity WHERE DATEDIFF(""2019-07-27"", activity_date) < 30 GROUP BY user_id ) t  "
18,"select round(ifnull(avg(_count),0),2) average_sessions_per_user from(select distinct user_id, count(distinct session_id) _count from Activity where activity_date <= '2019-07-27' and activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) a "
19,"select round(ifnull(count(distinct session_id)/count(distinct user_id), 0), 2) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'"
20,"SELECT IFNULL(ROUND((COUNT(distinct session_id) / count(distinct user_id)), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
21,"with cte as ( select user_id , count(distinct session_id) num_session from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) select round(coalesce(sum(num_session)/count(distinct user_id),0.00),2) as average_sessions_per_user from cte"
22,"select coalesce(round(sum(sumc)/count(distinct user_id),2), 0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sumc from activity where datediff('2019-07-27', activity_date) < 30 group by user_id ) a"
23,"select coalesce(round(count(distinct session_id) / count(distinct user_id), 2), 0) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27' "
24,"Select ifnull((round(sum(cs)/count(user_id),2)),0.00) as average_sessions_per_user from ( Select user_id, count(distinct session_id)cs from Activity where activity_date between '2019-06-28' AND '2019-07-27' group by 1 having count(distinct session_id)>=1 )t"
25,"select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
26,"SELECT IFNULL(ROUND(AVG((SESSIONS)),2),0) average_sessions_per_user FROM (SELECT COUNT(DISTINCT SESSION_ID) SESSIONS FROM ACTIVITY WHERE ACTIVITY_DATE > DATE_SUB('2019-07-27', INTERVAL 30 DAY) GROUP BY USER_ID )X "
27,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
28,"SELECT ROUND(IFNULL(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id) ,0),2) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date)<=29"
29,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(distinct user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE datediff('2019-07-27',activity_date)<30 "
30,"SELECT IFNULL(ROUND(AVG(sessions), 2), 0.00) AS average_sessions_per_user FROM (SELECT user_id, COUNT(DISTINCT(session_id)) AS sessions FROM activity WHERE (activity_date <= CAST('2019-07-27' AS DATE)) AND (activity_date > DATE_SUB(""2019-07-27"", INTERVAL 30 DAY)) GROUP BY user_id) AS activity_filtered"
31,"select ifnull (round( count(distinct session_id) * 1.0 / count(distinct user_id) , 2) , 0) as average_sessions_per_user from activity where datediff('2019-07-27', activity_date) < 30"
32,"select ifnull(round ((count(distinct session_id)/ count(distinct user_id)),2),0) as average_sessions_per_user from activity where activity_date > date_sub('2019-07-27',interval 30 day) "
33,"select ifnull(round(count(session_id)/count(distinct user_id),2),0) as average_sessions_per_user from( select user_id, session_id from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by 1,2) z"
34,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
35,"select round(coalesce(avg(session),0),2) as average_sessions_per_user from (SELECT DISTINCT user_id, COUNT(DISTINCT session_id) AS session FROM Activity WHERE activity_date > DATE_SUB(""2019-07-27"", INTERVAL 30 DAY) GROUP BY user_id HAVING session >= 1) as tb1 "
36,"select round(ifnull(sum(session_num) / count(session_num), 0.00), 2) as average_sessions_per_user from (select count(distinct session_id) as session_num from Activity where activity_date between Date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) as new_table "
37,"select ifnull(round(avg(ct),2),0.00)as average_sessions_per_user from ( select count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t"
38,"with cte as( select user_id, count(distinct session_id) as countofsessions from activity where activity_date < '2019-07-28' and activity_date > '2019-06-27' group by user_id) select (case when ROUND(sum(countofsessions) /count(user_id),2) is null then 0 else ROUND(sum(countofsessions) /count(user_id),2) end) as average_sessions_per_user from cte"
39,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from Activity where datediff('2019-07-27',activity_date) < 30 "
40,"with user_session_counts as ( SELECT user_id, COUNT(DISTINCT session_id) as sessions FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30 and DATEDIFF('2019-07-27',activity_date)>= 0 GROUP BY 1 ) SELECT ROUND(CASE WHEN AVG(sessions) IS NULL THEN 0 ELSE AVG(sessions) END,2) as average_sessions_per_user FROM user_session_counts"
41,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f"
42,"select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
43,"select round(coalesce(count(distinct session_id)/count(distinct user_id),0),2) as average_sessions_per_user from Activity where activity_date <= '2019-07-27' and activity_date >'2019-06-27'"
44,"with cte_cleaned as (select distinct * from Activity), agg as (select user_id, count(distinct session_id) as session_count from cte_cleaned where activity_date <= '2019-07-27' and activity_date > '2019-06-27' group by 1) select coalesce(round(avg(session_count), 2), 0) average_sessions_per_user from agg "
45,"with temp (tot_sessions,user_id) as ( select count(distinct session_id) as tot_sessions, user_id from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id ) select case when round(sum(tot_sessions)/count(user_id),2) is NULL then 0 else round(sum(tot_sessions)/count(user_id),2) end as average_sessions_per_user from temp "
46,"select round(coalesce(count(distinct session_id)/count(distinct user_id), 0), 2) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) between 0 and 29"
47,"with user_count as ( select user_id, count(distinct session_id) as session_count from activity where activity_date >= '2019-07-27' - interval 29 day and activity_date <= '2019-07-27' group by user_id ) select ifnull(round(avg(session_count),2),0) as average_sessions_per_user from user_count "
48,"SELECT IFNULL(ROUND(SUM(session)/COUNT(*), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT user_id, COUNT(DISTINCT(session_id)) AS session FROM Activity WHERE activity_date <= DATE(""2019-07-27"") AND activity_date >= DATE(""2019-06-28"") GROUP BY user_id) A"
49,"select ifnull(round((count(distinct session_id)/count(distinct user_id)),2),0.00) as average_sessions_per_user from activity where activity_date >='2019-06-28' and activity_date <='2019-07-27'"
50,"SELECT ifnull(round(count(distinct session_id) / count(distinct user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date <= '2019-07-27' AND activity_date >= '2019-06-28' "
51,"select ROUND(ifnull(count(distinct session_id)/count(distinct user_id), 0.00),2) AS average_sessions_per_user from activity where activity_date between ""2019-06-28"" and ""2019-07-27"" ORDER BY user_id"
52,"WITH sessions_per_user AS (SELECT user_id, COUNT(DISTINCT session_id) AS cnt_session FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id) SELECT IFNULL(ROUND(SUM(cnt_session)/COUNT(user_id), 2), 0.00) AS average_sessions_per_user FROM sessions_per_user "
53,"SELECT IFNULL(ROUND((COUNT(DISTINCT CONCAT(user_id,session_id ))/COUNT(DISTINCT user_id)),2),0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30 "
54,"SELECT IFNULL(ROUND(SUM(session)/COUNT(*), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT user_id, COUNT(DISTINCT(session_id)) AS session FROM Activity WHERE activity_date <= DATE(""2019-07-27"") AND activity_date > DATE(""2019-06-27"") GROUP BY user_id) A"
55,"select ifnull(round(count(distinct session_id) / count(distinct user_id), 2), 0.00) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27' "
56,"select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
57,"SELECT ROUND(COALESCE(AVG(ct),0),2) AS average_sessions_per_user FROM (SELECT user_id, COUNT(session_id) AS ct FROM (SELECT user_id, session_id FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id, session_id) sub GROUP BY user_id ) sub"
58,"with T as( select user_id, count(distinct session_id) as num_session from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id ) select ifnull(round(sum(T.num_session) / count(T.user_id), 2), 0.00) as average_sessions_per_user from T"
59,"SELECT COALESCE(ROUND(AVG(cnt), 2), 0.00) AS average_sessions_per_user FROM ( SELECT COUNT(DISTINCT session_id) AS cnt FROM ( SELECT user_id, session_id FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY user_id, session_id ) t GROUP BY user_id ) t "
60,"select round(coalesce(sum(b.num_sessions)/count(b.user_id), 0), 2) as average_sessions_per_user from ( select a.user_id, count(*) as num_sessions from ( select user_id, session_id from Activity where activity_date between '2019-06-28' and '2019-07-27' and activity_type in ('open_session', 'end_session', 'scroll_down', 'send_message') group by 1,2 ) a group by a.user_id ) b"
61,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2), 0) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' "
62,"with new as( select user_id, count(distinct session_id) as cnt from activity where activity_date between subdate('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) select ifnull(round(avg(cnt),2),0) as average_sessions_per_user from new"
63,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27' "
64,"SELECT ROUND(IFNULL((COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id)),0),2) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN DATE_ADD(""2019-07-27"", INTERVAL-29 day) AND ""2019-07-27"" "
65,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
66,"select ifnull(round(count(distinct session_id)/count(distinct user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
67,"With session_date as (Select user_id, count(distinct session_id) as count_session From Activity Where datediff(""2019-07-27"", activity_date)<=29 Group by user_id) Select round(ifnull(avg(count_session),0),2) as average_sessions_per_user From session_date"
68,"SELECT IFNULL(ROUND(AVG(num),2),0) average_sessions_per_user FROM (SELECT user_id, COUNT(DISTINCT session_id) num FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY 1)T1 "
69,"select ifnull ( (select round( ((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
70,"select ifnull(round(avg(n_sessions),2),0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as n_sessions from Activity where datediff('2019-07-27',activity_date) < 30 group by user_id) a"
71,"select IFNULL(round(count(distinct session_id) / count(distinct user_id), 2), 0) average_sessions_per_user from activity where datediff('2019-07-27', activity_date) < 30"
72,"select ifnull(round(count(distinct session_id) / count(distinct user_id), 2), 0) as 'average_sessions_per_user' from (select * from Activity where datediff('2019-07-27', activity_date) < 30 ) as temp "
73,"with temp as ( select count(distinct session_id) as dissession ,user_id from Activity where activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' group by user_id ) select ifnull(round(sum(dissession) / count(user_id),2),0) as average_sessions_per_user from temp"
74,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30 "
75,"select ifnull(round(sum(ct)/count(ct),2),0.00)as average_sessions_per_user from ( select user_id, count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t"
76,"select round(ifnull(count(distinct session_id)/count(distinct user_id), 0), 2) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'"
77,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
78,"select round(ifnull(count(distinct user_id, session_id)/count(distinct user_id),0),2) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'"
79,"select ifnull(round(avg(number),2),0) as average_sessions_per_user From (Select user_id as id,count(distinct session_id) as number from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) as tb1"
80,"select ifnull(round((count(distinct session_id))/(count(distinct user_id)),2),0.00) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) < 30 "
81,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f"
82,"select coalesce(round(avg(session_cnt),2),0) as average_sessions_per_user from (select user_id, count(distinct session_id) as session_cnt from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by 1 having count(1)>=1 ) sess "
83,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27' "
84,"select coalesce(round(count(distinct session_id)/count(distinct user_id),2), 0.00) as average_sessions_per_user from activity where timestampdiff(day, activity_date, '2019-07-28') <= 30"
85,"select ifnull(round(sum(total)/count(*),2),0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as total from Activity where activity_date <= '2019-07-27' and activity_date >= '2019-06-28' group by user_id) T "
86,"Select IfNull (round(count(distinct session_id)/count(distinct User_id),2), 0.00) as average_sessions_per_user From Activity Where activity_date > date_sub('2019-07-27', interval 30 day)"
87,"select ifnull(round(avg(sess),2),0) as average_sessions_per_user from ( select user_id,count(distinct session_id) as sess from Activity where activity_date between '2019-06-28' and '2019-07-27' group by 1)x"
88,"Select ifnull(round((count(Distinct(concat(user_id,'_',session_id))) / count(Distinct(user_id))),2),0) as average_sessions_per_user From Activity Where activity_date between '2019-06-28' and '2019-07-27'"
89,"with user_count as ( select user_id, count(distinct session_id) as session_count from activity where activity_date >= '2019-07-27' - interval 29 day and activity_date <= '2019-07-27' group by user_id ) select ifnull(round(avg(session_count),2),0) as average_sessions_per_user from user_count "
90,"select ifnull(round(avg(sessions),2),0) average_sessions_per_user from( select distinct user_id , count(distinct session_id) sessions from activity where activity_date >= '2019-06-28' and activity_date <= '2019-07-27' group by user_id ) t"
91,"WITH cte AS (SELECT user_id,COUNT(DISTINCT session_id )num_session FROM activity WHERE datediff('2019-07-27',activity_date) <=29 GROUP BY user_id ) SELECT COALESCE(ROUND(SUM(num_session)/count(DISTINCT user_id),2),0.00)average_sessions_per_user FROM cte"
92,"select coalesce(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where timestampdiff(day, activity_date, '2019-07-28') <=30"
93,"with pre as (select user_id,count(distinct session_id )num_session from activity where datediff('2019-07-27',activity_date) <=29 group by user_id ) select coalesce(round(sum(num_session)/count(distinct user_id),2),0.00)average_sessions_per_user from pre"
94,"select ifnull(round ((select sum(numerator.total_sessions) from ( select count(distinct session_id) as total_sessions from Activity where activity_date between DATE_SUB('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' group by user_id ) as numerator) / ( select count(distinct denominator.total_users) from ( select distinct user_id as total_users from Activity where activity_date between DATE_SUB('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' ) as denominator ),2),0) as average_sessions_per_user"
95,"select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select user_id, count(distinct session_id) cnt from Activity where activity_date > ('2019-07-27' - interval 30 day) group by user_id) temp "
96,"select round(ifnull(avg(ifnull(n,0)),0),2) ""average_sessions_per_user"" from (select user_id, count(distinct session_id) n from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id) t"
97,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
98,"select round(ifnull(count(distinct session_id) / count(distinct user_id),0.00),2) as average_sessions_per_user from Activity where activity_date between subdate('2019-07-27', 29) and '2019-07-27'"
99,"WITH user_sessions AS ( SELECT user_id, COUNT(DISTINCT session_id) AS sessions FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 AND DATEDIFF('2019-07-27', activity_date) >= 0 GROUP BY user_id ) SELECT IFNULL(ROUND(SUM(sessions)/COUNT(user_id),2),0) AS average_sessions_per_user FROM user_sessions"
100,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2),0) as average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date)<30"
101,"with ct as( select user_id, count(distinct session_id) as ag from Activity where datediff('2019-07-27',activity_date)<=29 group by 1 having count(distinct activity_type)>=1 ) select ifnull(round(sum(ag)/count(user_id),2),0) as average_sessions_per_user from ct"
102,"Select IFNULL(ROUND(COUNT(DISTINCT user_id,session_id)/COUNT(DISTINCT user_id),2),0) as average_sessions_per_user From Activity where activity_date between '2019-06-28' and '2019-07-27' "
103,"SELECT IFNULL(ROUND(AVG(num_sessions),2),0) as average_sessions_per_user FROM ( SELECT user_id, COUNT(distinct session_id) as num_sessions FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-28', INTERVAL 30 DAY) AND DATE('2019-07-27') GROUP BY user_id) as ctv"
104,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
105,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
106,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
107,"select coalesce(round(avg(session_count),2),0) average_sessions_per_user from ( select user_id, count(distinct(session_Id)) session_count from activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id ) as r"
108,"select coalesce(round(count(t.session_id) / count(distinct user_id),2) ,0) as average_sessions_per_user from ( select user_id, session_id, count(session_id) as id_num from Activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27' group by session_id) t"
109,"with cte1 as ( select user_id, count(distinct session_id) as session_num from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by 1), cte2 as ( select count(distinct user_id) as user_num from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27') select round(ifnull(sum(c1.session_num)/c2.user_num,0),2) as average_sessions_per_user from cte1 c1 cross join cte2 c2 "
110,"Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= Cast('2019-06-28' as Date) Group By user_id) as Activity_ "
111,"select ifnull(round(avg(session_count), 2),0) as average_sessions_per_user from (select user_id, count(distinct session_id) as session_count from Activity WHERE activity_date BETWEEN ""2019-06-28"" AND ""2019-07-27"" GROUP BY user_id) as t1 "
112,"select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select user_id, count(distinct session_id) cnt from Activity where activity_date >= '2019-06-28' group by user_id) temp "
113,"with x as (select user_id as users, count(distinct session_id) as total from activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id) select coalesce (round (sum(total)/ count(distinct users),2),0) as average_sessions_per_user from x"
114,"With t1 AS (SELECT COUNT(DISTINCT(session_id)) AS session_total FROM Activity WHERE activity_date<='2019-07-27' AND activity_date>'2019-06-27' GROUP BY user_id) SELECT IFNULL(ROUND(AVG(session_total),2),0) AS average_sessions_per_user FROM t1 "
115,"select ifnull(round(count(distinct user_id ,session_id )/count(distinct user_id ),2),0.00) as average_sessions_per_user from Activity where activity_date BETWEEN '2019-06-28' AND '2019-07-27' "
116,"with cte as (select user_id, count(distinct session_id) as num_sessions from activity where activity_date between date_add( '2019-07-27', interval -29 day) and '2019-07-27' group by 1) select round(ifnull(sum(num_sessions)/count(*),0) , 2) as average_sessions_per_user from cte"
117,"select coalesce(cast(avg(sessionids) as decimal(5,2) ), 0.0000) as average_sessions_per_user from ( select user_id , count(distinct session_id) sessionids from activity a where activity_date between '2019-06-28' and '2019-07-27' group by 1 )a"
118,"Select IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT(user_id)),2),0.00) as average_sessions_per_user FROM Activity where activity_date >= ""2019-06-28"" and activity_date <= ""2019-07-27"""
119,"select ifnull(round((select count(distinct session_id) from activity where datediff( '2019-07-27',activity_date)<=29)/ count(distinct user_id),2) ,0)as average_sessions_per_user from activity where datediff('2019-07-27',activity_date)<=29 "
120,"select ifnull(round ((count(distinct session_id)/ count(distinct user_id)),2),0) as average_sessions_per_user from activity where activity_date > date_sub('2019-07-27',interval 30 day) "
121,"with cte as ( select user_id, count(distinct session_id) as session_uniq_id, sum(case when activity_type is not null then 1 else 0 end) as activity_bool from Activity where activity_date >= ""2019-06-28"" and activity_date <= ""2019-07-27"" group by user_id ) select ifnull(round(sum(session_uniq_id) / count(distinct user_id), 2), 0) as average_sessions_per_user from cte where activity_bool != 0"
122,"with temp as (SELECT COUNT(DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id) select ifnull(round(avg(sess),2),0) as average_sessions_per_user from temp"
123,"select ifnull(round((sum(sessions)/count(user_id)) ,2) ,0) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sessions from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id )as a "
124,"with t1 as (select user_id, count(distinct session_id) sd from activity where activity_date >= date_add(""2019-07-28"", INTERVAL -30 DAY) group by user_id having sd>0) select ifnull(round(avg(sd),2),0) average_sessions_per_user from t1 "
125,"select round(ifnull(count(distinct session_id)/count(distinct user_id),0), 2) average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27' "
126,"select round(coalesce(avg(sessions),0), 2) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sessions from activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27' group by user_id ) f "
127,"SELECT IFNULL( ROUND( (COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id)) , 2) , 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' "
128,"SELECT IFNULL( ROUND(COUNT(DISTINCT session_id) /COUNT(DISTINCT user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
129,"select IFNULL(round(avg(number_sessions), 2), 0) as average_sessions_per_user FROM (select user_id, count(distinct session_id) as number_sessions from Activity where activity_date between date_sub('2019-07-27', interval (29) day) and '2019-07-27' group by user_id) result "
130,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
131,"select ifnull(round(avg(session),2),0) as average_sessions_per_user From ( Select user_id, count(distinct(session_id)) as session From Activity Where activity_date <= ""2019-07-27"" And activity_date >= ""2019-06-28"" Group by user_id ) as c "
132,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
133,"select coalesce(round(count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from Activity where activity_date between DATE_SUB(DATE(""2019-07-27""), INTERVAL 29 DAY) AND DATE(""2019-07-27"") "
134,"select round(coalesce(avg(sessions), 0), 2) as average_sessions_per_user from ( select user_id, count(distinct session_id) as sessions from activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27' group by 1 ) f"
135,"select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
136,"WITH sessions as ( SELECT DISTINCT user_id as active_users, COUNT(DISTINCT session_id) as session_count FROM ACTIVITY WHERE activity_date > DATE_SUB(""2019-07-27"", INTERVAL 30 DAY) GROUP BY user_id ) SELECT IFNULL(ROUND(SUM(session_count)/ count(active_users),2),0) as average_sessions_per_user FROM sessions  "
137,"select ifnull( round(count(distinct(session_id))/ count(distinct(user_id)),2), 0.00) as average_sessions_per_user from activity where datediff('2019-07-27', activity_date)<30 "
138,"SELECT IFNULL(round(avg(n_session),2),0) as average_sessions_per_user FROM (SELECT user_id, count(distinct(session_id)) as n_session FROM Activity WHERE activity_date BETWEEN DATE('2019-07-27') - INTERVAL 29 DAY AND '2019-07-27' GROUP BY user_id) a"
139,"select ifnull(round(avg(num),2),0.00000) as average_sessions_per_user from ( select count(distinct session_id) as num from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' and activity_type is not null group by user_id ) temp "
140,"with temp1 as ( select user_id, count(distinct session_id) cnt from activity where activity_date between ADDDATE('2019-07-27', -29) and '2019-07-27' group by user_id ) select ifnull(round(sum(cnt)/count(distinct user_id), 2), 0) average_sessions_per_user from temp1 "
141,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
142,"with temp as ( select user_id, (count(distinct session_id)) as count1, count(distinct user_id) as counts from Activity where activity_date between '2019-06-28' AND '2019-07-27' group by user_id having count(activity_type) >=1) select COALESCE(ROUND(sum(temp.count1) / sum(counts),2),0) as average_sessions_per_user from temp "
143,"SELECT ROUND( IFNULL(AVG(a.count),0) ,2) AS ""average_sessions_per_user"" FROM ( SELECT user_id, COUNT(DISTINCT session_id) AS ""count"" FROM Activity WHERE activity_date > DATE_ADD(""2019-07-27"", INTERVAL -30 DAY) AND activity_date <= ""2019-07-27"" GROUP BY user_id HAVING COUNT(DISTINCT session_id) >= 1 ) AS a"
144,"SELECT ROUND(IFNULL(COUNT(DISTINCT(session_id)) / COUNT(DISTINCT(user_id)),0),2) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) < 30"
145,"select ifnull(round(count(distinct session_id)/(count(distinct user_id)), 2), 0.00) as average_sessions_per_user from activity where activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
146,"select ifnull (round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) as temp"
147,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
148,"with pre as (select user_id,count(distinct session_id )num_session from activity where datediff('2019-07-27',activity_date) <=29 group by user_id ) select coalesce(round(sum(num_session)/count(distinct user_id),2),0.00)average_sessions_per_user from pre "
149,"with a as ( select user_id, count(distinct session_id) sess_num from Activity where datediff('2019-07-27',activity_date) <=29 group by user_id ) select coalesce(round(sum(sess_num) /count(distinct user_id), 2), 0.00) average_sessions_per_user from a"
150,"select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select user_id, count(distinct session_id) cnt from Activity where activity_date >= '2019-06-28' group by user_id) temp "
151,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27'"
152,"Select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27' "
153,"select ifnull(round(avg(t),2),0) as average_sessions_per_user from( select activity_date,count(distinct session_id) as t from Activity where activity_date>cast('2019-06-27'as date) and activity_date<cast('2019-07-27' as date) group by user_id ) as t "
154,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f "
155,"SELECT ROUND(IFNULL(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 0), 2) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN ""2019-06-28"" AND ""2019-07-27"" "
156,"with cte as (select user_id, count(distinct session_id) as count_session from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id ) select ifnull(round(sum(count_session) / count(distinct user_id), 2),0) as average_sessions_per_user from cte"
157,"SELECT IFNULL(ROUND(AVG(a.session_count),2),0) AS average_sessions_per_user FROM ( SELECT COUNT(DISTINCT session_id) AS session_count FROM activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id) a"
158,"select round(ifnull(count(distinct session_id) / count(distinct user_id),0),2) as average_sessions_per_user from Activity where activity_date between date_add(""2019-07-27"", interval -29 day) and ""2019-07-27"""
159,"select ifnull(round(sum(sub.sess)/ count( distinct user_id),2),0) average_sessions_per_user from ( select user_id ,count(distinct session_id) sess from Activity where activity_date <= '2019-07-27' and activity_date >= '2019-06-28' group by user_id) sub "
160,"Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= Cast('2019-06-28' as Date) Group By user_id) as Activity_ "
161,"SELECT IFNULL(ROUND(COUNT(DISTINCT user_id,session_id)/COUNT(DISTINCT user_id),2),0) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'"
162,"WITH user_sessions AS ( SELECT COUNT(DISTINCT session_id) AS sessions, user_id FROM Activity WHERE activity_date > '2019-6-27' AND activity_date < '2019-7-28' GROUP BY user_id ) SELECT CASE WHEN sessions IS NULL THEN 0 ELSE ROUND(AVG(sessions), 2) END AS average_sessions_per_user FROM user_sessions "
163,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE activity_date <= '2019-07-27' AND activity_date >= '2019-06-28' "
164,"with t as ( select user_id,count(distinct session_id) as num_sess from activity where activity_date >= date_add('2019-07-27',interval -29 day) and activity_date <= '2019-07-27' group by 1 ) select coalesce(cast(avg(num_sess) as decimal(65,2)),0) as average_sessions_per_user from t "
165,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date > '2019-07-27' - interval 1 month"
166,"select ifnull(round(avg(num_sess), 2), 0) average_sessions_per_user from ( select count(distinct session_id) num_sess from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id ) tmp "
167,"With new_table as ( select count(distinct(session_id)) as sessions_per_user from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) select ifnull(round(avg(sessions_per_user),2),0) as average_sessions_per_user From new_table "
168,"WITH cte_getActivity AS ( SELECT COUNT(DISTINCT session_id) AS count_session FROM Activity WHERE activity_date > date_sub('2019-07-27', interval 30 day) GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(count_session),2),0) AS average_sessions_per_user FROM cte_getActivity"
169,"select round(ifnull(sum(b.req)*1.0/count(b.user_id),0),2) as average_sessions_per_user from ( select a.user_id, ifnull(count(distinct a.session_id),0) as req from (select distinct * from Activity where datediff('2019-07-27',activity_Date) < 30)a group by a.user_id )b"
170,"select ifnull(round(avg(cnt),2),0) as average_sessions_per_user from (select user_id, count(distinct session_id) as cnt from Activity where datediff('2019-07-27',activity_date) < 30 group by user_id) t "
171,"WITH temp AS ( SELECT COUNT(DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(sess), 2), 0) AS average_sessions_per_user FROM temp"
172,"WITH temp AS ( SELECT COUNT( DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id ) SELECT IFNULL(ROUND(AVG(sess), 2), 0) AS average_sessions_per_user FROM temp "
173,"select ifnull(round(avg(table2.session_number),2),0) as average_sessions_per_user from( select table1.user_id,count(distinct(table1.session_id)) as session_number from( select * from Activity where activity_date > '2019-06-27' and activity_date <= '2019-07-27') AS table1 group by table1.user_id ) AS table2"
174,"Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= '2019-06-28' Group By user_id) as Activity_ "
175,"select COALESCE(round(sum(x.b)/count(x.a),2),0.00) as average_sessions_per_user from (select user_id as a, count(distinct session_id) as b from Activity where activity_date between ""2019-06-28"" and ""2019-07-27"" group by user_id) as x"
176,"select ifnull(round(avg(new.a),2), 0) as average_sessions_per_user from ( select user_id, count(distinct session_id)/count(distinct user_id) as a from activity where activity_date between '2019-06-28' and '2019-07-27') new"
177,"SELECT IFNULL(ROUND(COUNT(DISTINCT SESSION_ID)/COUNT(DISTINCT USER_ID), 2), 0.00) AS average_sessions_per_user FROM ACTIVITY WHERE ACTIVITY_DATE >= '2019-06-28' AND ACTIVITY_DATE <= '2019-07-27' "
178,"SELECT coalesce(round(avg(nb_sessions),2),0) as average_sessions_per_user FROM ( SELECT user_id , count(distinct(session_id)) as nb_sessions FROM Activity Where activity_date between date_add('2019-07-27', INTERVAL -29 DAY) and '2019-07-27' GROUP by user_id HAVING count(distinct(session_id)) > 0 )t"
179,"select ifnull(Round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from Activity where activity_date >= date_sub('2019-07-27',interval 29 day)"
180,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
181,"select ifnull(round(avg(number),2),0) as average_sessions_per_user From (Select user_id as id,count(distinct session_id) as number from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) as tb1"
182,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from activity where activity_date between '2019-6-28' and '2019-07-27' "
183,"with cte as( select user_id, count(distinct session_id) as numofsession from Activity where datediff(date(""2019-07-27""), activity_date) <= 29 group by user_id ) select coalesce( round(sum(numofsession)/count(distinct user_id) ,2), 0.00) as average_sessions_per_user from cte"
184,"select round(ifnull(count(distinct session_id) / count(distinct user_id), 0), 2) as average_sessions_per_user from Activity where activity_date between DATE_sub('2019-07-27', INTERVAL 29 DAY) and '2019-07-27' "
185,"select (case when count(distinct user_id)=0 then 0 else round(cast(count(distinct session_id) as float)/count(distinct user_id),2) end) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27' "
186,"select round(ifnull(avg(n),0),2) ""average_sessions_per_user"" from (select user_id, count(distinct session_id) n from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id) t"
187,"SELECT ( CASE WHEN Count(DISTINCT user_id) = 0 THEN 0 ELSE Round(Cast(Count(DISTINCT session_id) AS FLOAT) / Count(DISTINCT user_id), 2) END ) average_sessions_per_user FROM activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'"
188,"select case when round(avg(totalsession),2) is null then round(0, 2) else round(avg(totalsession),2) end average_sessions_per_user from ( select user_id, count(distinct session_id) totalsession from activity where activity_date <= '2019-07-27' and activity_date > date_add('2019-07-27', INTERVAL -30 day) group by user_id )a"
189,"SELECT ifnull(round(cOUNT(distinct user_id,session_id) /COUNT(distinct user_id),2),0.00) as Average_sessions_per_user FROM activity WHERE activity_date BETWEEN ('2019-07-27'-INTERVAL 29 DAY) AND '2019-07-27' "
190,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) as average_sessions_per_user FROM Activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'"
191,"select IFNULL(round(count(distinct session_id) / count(distinct user_id),2),0) as 'average_sessions_per_user' from Activity act where datediff('2019-07-27', activity_date) < 30 "
192,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f"
193,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE activity_date >= ""2019-06-28"" AND activity_date <= ""2019-07-27"" "
194,"select round(ifnull(count(distinct session_id)/ count(distinct user_id),0), 2) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27' "
195,"select round(ifnull(count(distinct session_id)/count(distinct user_id) ,0),2)average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27'"
196,"select ifnull(round(sum(num)/count(distinct user_id),2), 0) as average_sessions_per_user from (select distinct user_id, count(distinct session_id) as num from Activity where activity_date between date_sub('2019-07-27', Interval 29 Day) and '2019-07-27' group by 1) as tempt"
197,"select ifnull(round(((count(distinct session_id))/(count( distinct user_id))),2),0) as average_sessions_per_user from activity where activity_date between ""2019-06-28"" and ""2019-07-27"""
198,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0.00)as average_sessions_per_user from Activity where activity_date between '2019-06-28'and'2019-07-27' "
199,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
200,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date > '2019-06-27' AND activity_date <= '2019-07-27' "
201,"select IFNULL( (select round(count(distinct session_id)/count(distinct user_id),2) as average_sessions_per_user from Activity where activity_date>DATE_ADD('2019-07-27', INTERVAL -30 DAY) and activity_date<='2019-07-27'), 0) as average_sessions_per_user "
202,"SELECT IFNULL(ROUND(COUNT(DISTINCT user_id, session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30"
203,"select case when count(distinct user_id) =0 then 0.00 else round(count(distinct session_id) / count(distinct user_id) , 2) END as average_sessions_per_user from Activity where activity_date between date '2019-06-28' and date '2019-07-27' "
204,"SELECT IFNULL( (SELECT round(((COUNT(DISTINCT session_id))/(COUNT( DISTINCT user_id))),2) from activity WHERE activity_date BETWEEN ""2019-06-28"" and ""2019-07-27"") ,0) AS average_sessions_per_user"
205,"WITH CTE_1 AS( SELECT user_id , session_id , activity_type FROM Activity WHERE activity_date BETWEEN DATE_ADD(""2019-07-27"", INTERVAL -29 DAY) AND ""2019-07-27"" ) , CTE_2 AS ( SELECT user_id , COALESCE(COUNT(DISTINCT session_id), 0) AS num_sessions FROM CTE_1 GROUP BY user_id ) SELECT COALESCE(ROUND(SUM(num_sessions) / COUNT(*), 2), 0) AS average_sessions_per_user FROM CTE_2  "
206,"select IFNULL(ROUND(avg(number_sessions),2),0) as average_sessions_per_user FROM ( select user_id, count(distinct session_id) as number_sessions FROM Activity where activity_date between date_sub('2019-07-27', interval (30-1) day) and '2019-07-27' group by 1 ) a"
207,"select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
208,"select ifnull( (select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27""),0) as average_sessions_per_user "
209,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2),0) as average_sessions_per_user from activity where activity_date between date_sub('2019-07-27',interval 29 day) and '2019-07-27' "
210,"select ifnull(round(avg(cnt),2),0) average_sessions_per_user from (select count(distinct session_id) cnt from activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) t"
211,"SELECT IFNULL(ROUND( COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2) ,0) as average_sessions_per_user FROM Activity WHERE activity_date BETWEEN date_sub('2019-07-27', interval 29 day) and '2019-07-27' and user_id in ( SELECT distinct user_id FROM Activity WHERE activity_date BETWEEN date_sub('2019-07-27', interval 29 day) and '2019-07-27' GROUP BY user_id HAVING COUNT(activity_type)>=1 ) "
212,"with temp as(select user_id,count(distinct session_id) as count from activity where datediff('2019-07-27',activity_date)<30 group by user_id) select ifnull(round(avg(count),2),0) as average_sessions_per_user from temp "
213,"SELECT ROUND((CASE WHEN COUNT(DISTINCT A1.user_id) = 0 THEN 0 ELSE SUM(A1.sessionCount)/ COUNT(DISTINCT A1.user_id) END), 2) AS average_sessions_per_user FROM (SELECT user_id, COUNT(DISTINCT (CASE WHEN activity_date BETWEEN ""2019-06-28"" AND ""2019-07-27"" THEN session_id END)) AS sessionCount FROM Activity GROUP BY user_id) AS A1 WHERE A1.sessionCount > 0"
214,"WITH t1 AS ( SELECT user_id, COUNT(DISTINCT session_id) AS sess FROM Activity WHERE DATEDIFF('2019-07-27',activity_date) <= 29 GROUP BY user_id ), t2 AS ( SELECT IFNULL(ROUND(AVG(sess), 2), 0) AS average_sessions_per_user FROM t1 ) SELECT * FROM t2"
215,"SELECT IFNULL(ROUND(AVG(a.num), 2),0) as average_sessions_per_user FROM ( SELECT COUNT(DISTINCT session_id) as num FROM Activity WHERE DATEDIFF(""2019-07-27"", activity_date) < 30 AND DATEDIFF(""2019-07-27"", activity_date) > 0 GROUP BY user_id ) as a"
216,"select ifnull(round(avg(sess_no),2),0) as average_sessions_per_user from (select count(distinct session_id) as sess_no from Activity where activity_date between ""2019-06-28"" and ""2019-07-27"" group by user_id ) tmp "
217,"select ifnull(round(count(distinct session_id)/ count(distinct user_id),2),0) as average_sessions_per_user from Activity where datediff('2019-07-27',activity_date) <30 "
218,"SELECT IFNULL(ROUND(COUNT(DISTINCT user_id, session_id) / COUNT(DISTINCT user_id), 2), 0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30"
219,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
220,"with cte as (select count(distinct session_id) as totalSessions, count(distinct user_id) as totalUsers from Activity where activity_date between subDate(""2019-07-27"", interval 29 day) and ""2019-07-27"") select ifnull(round(totalSessions/totalUsers, 2), 0) as average_sessions_per_user from cte"
221,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id) f"
222,"select ifnull(round(AVG(session),2),0.00) as average_sessions_per_user from (select user_id, count(distinct session_id) as session from Activity where activity_date between date_sub('2019-07-27',interval 29 day) and '2019-07-27' group by user_id)as T "
223,"with t1 as (select user_id, count(distinct session_id) sd from activity where activity_date between date_sub('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' group by user_id having sd>0) select ifnull(round(avg(sd),2),0) average_sessions_per_user from t1 "
224,"with cte as ( select count(distinct session_id) as cnt from Activity where datediff('2019-07-27',activity_date)<=29 group by user_id ) select ifnull(round(avg(cnt),2),0) as average_sessions_per_user from cte"
225,"with cte as ( select count(distinct user_id) as eachuser, count(distinct session_id) as sessioncount from Activity where datediff('2019-07-27', activity_date) < 30 ) select ifnull( round( sessioncount /eachuser, 2 ) ,0 ) as average_sessions_per_user from cte "
226,"select round(ifnull(avg(c),0),2) as average_sessions_per_user from ( select user_id, count(distinct session_id) as c from Activity where DATEDIFF('2019-07-27',activity_date) < 30 group by 1) k"
227,"select COALESCE(ROUND(avg(sessions),2),0) AS average_sessions_per_user FROM ( select user_id, (count(distinct(session_id))) as sessions FROM activity WHERE activity_date between '2019-06-28' and '2019-07-27' GROUP BY 1 ) AS X"
228,"SELECT COALESCE(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date between '2019-06-28' and '2019-07-27'"
229,"select ifnull(round(avg(ct),2),0) average_sessions_per_user from ( select user_id, count(distinct session_id) ct from Activity where activity_date between '2019-06-28' and '2019-07-27' group by user_id ) a"
230,"select ifnull(round(avg(tem.a),2),0) as average_sessions_per_user from (select count(distinct(s.session_id)) as a from Activity s where s.activity_date between '2019-06-28' and '2019-07-27' group by user_id) tem"
231,"SELECT COALESCE(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date > date_sub('2019-07-27', interval 30 DAY)"
232,"select ifnull(round((count(distinct session_id))/(count(distinct user_id)),2),0.00) as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) < 30 "
233,"SELECT ( CASE WHEN Count(DISTINCT user_id) = 0 THEN 0 ELSE Round(Cast(Count(DISTINCT session_id) AS FLOAT) / Count(DISTINCT user_id), 2) END ) average_sessions_per_user FROM activity WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'"
234,"select round(ifnull(avg(c.a),0),2) as average_sessions_per_user from (Select count(distinct session_id) as a from Activity where activity_date between SUBDATE('2019-07-27',interval 29 day) and '2019-07-27' group by user_id) c"
235,"with total as(select session_id from activity where activity_date between date_sub('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' group by session_id) select ifnull(round(count(total.session_id)/B.avgt,2),0.00) as average_sessions_per_user from total,(select count(distinct user_id) as avgt from activity where activity_date between date_sub('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' )B"
236,"select ifnull(round(avg(cnt),2),0.00) as average_sessions_per_user from ( select count(distinct session_id) as cnt from Activity where datediff(""2019-07-27"",activity_date)<30 group by user_id) as tb1 "
237,"select ifnull(round(avg(cnt), 2), 0) as average_sessions_per_user from (select user_id, count(distinct session_id) as cnt from activity a where activity_date between '2019-06-28' and '2019-07-27' group by user_id) tmp"
238,"select round(ifnull(count(distinct session_id) *1.0/count(distinct user_id),0 ),2) as average_sessions_per_user from Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27' "
239,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0) AS average_sessions_per_user FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' "
240,"select round(coalesce(sum(ses_count)/count(distinct user_id),0),2) as average_sessions_per_user from (select user_id, count(distinct session_id) as ses_count from activity where activity_date <= '2019-07-27' and activity_date >'2019-06-27' group by user_id) as T"
241,"select coalesce(round(avg(session_number),2),0.00) as average_sessions_per_user from (select distinct user_id, count(distinct session_id) as session_number from Activity where datediff('2019-07-27',activity_date) < 30 group by user_id having session_number >= 1) c  "
242,"select round( ifnull( count(distinct session_id) / count(distinct user_id) ,0) ,2) as average_sessions_per_user from Activity where DATEDIFF(""2019-07-27"", activity_date) < 30 "
243,"select ifnull(round(avg(c),2),0.00) as average_sessions_per_user from( select count(distinct session_id) as c from Activity where activity_date between ""2019-06-28"" and ""2019-07-27"" group by user_id )t "
244,"With temp AS ( SELECT COUNT(DISTINCT session_id) AS sess FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' GROUP BY user_id) SELECT IFNULL(ROUND(AVG(sess),2),0) AS average_sessions_per_user FROM temp "
245,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select *, count(distinct session_id)as count_session from Activity where activity_date between date_add('2019-07-27', interval -29 day) and '2019-07-27'group by user_id ) cte where user_id in (select user_id from Activity group by user_id, activity_type having count(activity_type)>=1 ) "
246,"with total as(select session_id from activity where activity_date between date_sub('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' group by session_id) select ifnull(round(count(total.session_id)/B.avgt,2),0.00) as average_sessions_per_user from total,(select count(distinct user_id) as avgt from activity where activity_date between date_sub('2019-07-28', INTERVAL 30 DAY) and '2019-07-27' )B"
247,"SELECT IFNULL(ROUND( COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2) , 0) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27', activity_date)<=29"
248,"SELECT ifnull(ROUND(AVG(CNT), 2), 0.00) AS average_sessions_per_user FROM ( SELECT user_id, count(DISTINCT session_id) AS CNT FROM Activity WHERE activity_date >= ""2019-06-28"" AND activity_date <= ""2019-07-27"" GROUP BY user_id) AS A"
249,"select ifnull(round(count(distinct session_id)/ count(distinct user_id),2),0) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27' "
250,"with user_session_counts as ( SELECT user_id, COUNT(DISTINCT session_id) as sessions FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27' GROUP BY 1 ) SELECT ROUND(CASE WHEN AVG(sessions) IS NULL THEN 0 ELSE AVG(sessions) END,2) as average_sessions_per_user FROM user_session_counts"
251,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2), 0) as average_sessions_per_user from Activity where activity_date between '2019-06-28' and '2019-07-27 ' "
252,"with cte as (select distinct session_id, user_id from Activity where Activity.activity_date between ""2019-06-28"" and ""2019-07-27"") select round(coalesce((count(session_id)) / (count(distinct user_id)), 0), 2) as average_sessions_per_user from cte "
253,"select case when count(distinct session_id) = 0 then 0.00 else round((count(distinct session_id)/ count(distinct user_id)),2) end as average_sessions_per_user from Activity where datediff('2019-07-27', activity_date) < 30 and datediff('2019-07-27', activity_date) >= 0 "
254,"with t1 as (select user_id, count(distinct session_id) as total from activity where datediff('2019-07-27',activity_date) <=29 group by 1) select ifnull(round(sum(total)/count(distinct user_id),2),0) as average_sessions_per_user from t1 "
255,"select ifnull(round( count(distinct session_id)/count(distinct user_id),2),0.00) as average_sessions_per_user from Activity where activity_date <= '2019-07-27' and activity_date >= date_add('2019-07-27', interval -29 day) "
256,"Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= Cast('2019-06-28' as Date) Group By user_id) as Activity_ "
257,"SELECT round(coalesce(avg(s_id),0),2) average_sessions_per_user FROM (SELECT user_id, count(DISTINCT session_id) s_id FROM activity WHERE 1=1 AND activity_date BETWEEN date_sub(cast('2019-07-27' as date),INTERVAL 29 DAY) AND cast('2019-07-27' as date) GROUP BY user_id) a "
258,"SELECT IFNULL(ROUND(AVG((SESSIONS)),2),0) average_sessions_per_user FROM (SELECT COUNT(DISTINCT SESSION_ID) SESSIONS FROM ACTIVITY WHERE ACTIVITY_DATE > DATE_SUB('2019-07-27', INTERVAL 30 DAY) GROUP BY USER_ID )X "
259,"SELECT IFNULL(ROUND((COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id)),2),0) AS average_sessions_per_user FROM Activity WHERE activity_date > DATE_SUB('2019-07-27', INTERVAL 30 DAY) AND activity_date <= '2019-07-27' "
260,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date >= '2019-06-28' and activity_date <= '2019-07-27'"
261,"select ifnull(round(count(distinct session_id)/count(distinct user_id),2), 0) as average_sessions_per_user from activity where activity_date between '2019-06-28' and '2019-07-27' "
262,"SELECT IFNULL(ROUND(SUM(A.USER_SESSION)/COUNT(*),2),0) AS average_sessions_per_user FROM ( SELECT USER_ID, COUNT(DISTINCT SESSION_ID) AS USER_SESSION FROM ACTIVITY WHERE activity_date > ""2019-06-27"" AND activity_date < ""2019-07-28"" GROUP BY USER_ID ) AS A "
263,"with user_count as ( select user_id, count(distinct session_id) as session_count from activity where activity_date >= '2019-07-27' - interval 29 day and activity_date <= '2019-07-27' group by user_id ) select ifnull(round(avg(session_count),2),0) as average_sessions_per_user from user_count "
264,"select ifnull(round(avg(number),2),0) as average_sessions_per_user from ( select distinct user_id, count(distinct session_id) as number from activity where activity_date <= '2019-07-27' and activity_date >= '2019-06-28' group by user_id )t"
265,"with filtered as (select user_id, session_id from Activity where activity_date <= '2019-07-27' and activity_date > '2019-06-27' group by 1,2) select round(coalesce(avg(sessions),0),2) as average_sessions_per_user from (select user_id, count(session_id) as sessions from filtered group by 1) a"
266,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id), 2), 0.00) AS average_sessions_per_user FROM Activity WHERE activity_date > '2019-06-27' AND activity_date <= '2019-07-27' "
267,"select ifnull(round(avg(count_session),2),0) as average_sessions_per_user from (select count(distinct session_id) as count_session from activity where activity_date > date_sub('2019-07-27', interval 30 day) group by user_id having count_session >0) f"
268,"select ifnull(round(sum(ct)/count(user_id), 2), 0) as average_sessions_per_user from (select user_id, count(distinct session_id) as ct from Activity where activity_date between date_sub('2019-07-27', interval 29 day) and '2019-07-27' group by user_id) a"
269,"SELECT IFNULL(ROUND(SUM(t.cnt) / COUNT(*), 2), 0.00) AS 'average_sessions_per_user' FROM (SELECT COUNT(DISTINCT session_id) AS 'cnt' FROM Activity WHERE DATEDIFF('2019-07-27', activity_date) < 30 GROUP BY user_id) t "
270,"with a as (select user_id, count(distinct session_id) as sc from activity where activity_date >= '2019-06-28' and activity_date < '2019-07-27' group by user_id) select coalesce(round(sum(sc)/count(distinct user_id),2),0.00000) as average_sessions_per_user from a"
271,"SELECT ifnull(ROUND(COUNT(DISTINCT session_id) / COUNT(DISTINCT user_id), 2),0.00) AS average_sessions_per_user FROM Activity WHERE activity_date > Subdate('2019-07-27',30) and activity_date <= '2019-07-27'"
272,"with cte as ( SELECT count(distinct session_id) as tot FROM Activity WHERE activity_date BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27' Group BY user_id) select ifnull(Round(avg(tot),2),0) as average_sessions_per_user FROM cte "
273,"SELECT IFNULL(ROUND(COUNT(DISTINCT session_id)/COUNT(DISTINCT user_id),2),0.00) AS average_sessions_per_user FROM Activity WHERE DATEDIFF('2019-07-27',activity_date)<30 "
274,"select ifnull ((select round(((count(distinct session_id))/(count( distinct user_id))),2) from activity where activity_date between ""2019-06-28"" and ""2019-07-27"") ,0) as average_sessions_per_user"
275,"Select IFNULL(Round(AVG(Count_),2),0) as average_sessions_per_user From (Select Count(Distinct session_id) as Count_ From Activity Where activity_date >= Cast('2019-06-28' as Date) Group By user_id) as Activity_ "
276,"SELECT COALESCE(ROUND(COUNT(DISTINCT session_id)/ COUNT(DISTINCT user_id), 2), 0.00) as average_sessions_per_user FROM Activity WHERE activity_date > date_sub('2019-07-27', interval 30 DAY)"
277,"select ifnull(round(sum(ct)/count(ct),2),0.00)as average_sessions_per_user from ( select count(distinct session_id) as ct from Activity where datediff('2019-07-27', activity_date) between 0 and 29 group by user_id) t"
278,"select ifnull(round( sum(N) / sum(D), 2), 0.00) average_sessions_per_user from ( select count(distinct session_id) N, 1 D from Activity where activity_date between ""2019-06-28"" and ""2019-07-27"" group by user_id ) t"
