id,original query
1,"select round(avg(removal_percent),2) as average_daily_percent from (SELECT a.post_id, count(distinct r.post_id) /count(distinct a.post_id) *100 as removal_percent FROM ACTIONS a left join removals r on a.post_id=r.post_id WHERE a.action='report' and a.extra='spam' group by a.action_date) t "
2,"with spam_post as ( select distinct action_date, post_id from Actions where extra = 'spam' ) select round(100 * avg(ratio), 2) ""average_daily_percent"" from (select s.action_date, count(r.post_id)/count(s.post_id) as ratio from spam_post s left join Removals r on s.post_id = r.post_id group by 1) t "
3,"select round(avg(daily_percent),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id )*100 as daily_percent from Actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1)a"
4,"select round(avg(per_day)*100.0,2) as average_daily_percent from ( select action_date, count(distinct r.post_id)*1.0/count(distinct a.post_id) as per_day from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1 ) x"
5,"select round(avg(percent_)*100,2) as average_daily_percent from (select action_date, count( distinct case when extra='spam' and post_id in (select post_id from removals) then (post_id) else null end) /count( distinct case when extra='spam' then (post_id) else null end) as percent_ from actions group by action_date)a where percent_ is not null "
6,"select round(sum(percent)/count(percent) * 100, 2) as average_daily_percent from ( select count(removal_post)/count(action_post) as percent from ( select distinct a.post_id as action_post,r.post_id as removal_post, a.action_date as action_date from Actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' ) as temp group by action_date ) as percent_tab"
7,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
8,"select round(avg(avgreport),2) average_daily_percent from ( select action_date,round((coalesce(count(distinct r.post_id),0) / count(distinct a.post_id))*100,2) avgreport from Actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1 )a"
9,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
10,"select round(avg(daily_removal) *100,2) average_daily_percent from (select st.action_date, count(distinct r.post_id) / count(distinct st.post_id) as daily_removal from (select * from Actions where extra = 'spam') st left join Removals r on st.post_id = r.post_id group by st.action_date) temp1 "
11,"select round(avg(ct)* 100,2) as average_daily_percent from ( Select count(distinct r.post_id)/count(distinct a.post_id) ct,action_date from Actions a left join Removals r on a.post_id=r.post_id where a.extra='spam' group by 2 )t"
12,"select distinct round(sum(c.remove_post)/count(distinct c.action_date)*100, 2) as average_daily_percent from ( select distinct a.action_date, b.posts/a.posts as remove_post from ( select distinct a.action_date, count(distinct a.post_id) as posts from actions a where a.extra = 'spam' group by a.action_date ) a left join ( select distinct a.action_date, count(distinct a.post_id) as posts from actions a join removals b on a.post_id = b.post_id where a.extra = 'spam' group by a.action_date ) b on a.action_date = b.action_date ) c"
13,"SELECT ROUND(SUM(percentage)/(SELECT COUNT(DISTINCT action_date) AS 'count_days' FROM Actions WHERE action = 'report' AND extra = 'spam'),2) AS 'average_daily_percent' FROM ( SELECT a.action_date , COUNT(DISTINCT b.post_id)*100/COUNT(DISTINCT a.post_id) AS 'percentage' FROM Actions a LEFT JOIN Removals b ON a.post_id=b.post_id WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date) a"
14,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
15,"select round(avg(t.ratio) *100, 2) as average_daily_percent from (select a.action_date, count(r.post_id)/count(distinct a.post_id) as ratio from (select distinct action_date, post_id from Actions where action = 'report' and extra = 'spam') a left join Removals r on a.post_id = r.post_id group by 1) t "
16,"with cte as ( select distinct a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on r.post_id = a.post_id where a.action = 'report' and a.extra = 'spam' ), cte2 as ( select cte.action_date, count(case when cte.remove_date is not null then 1 else null end) as delcnt, count(cte.post_id) as spmcnt from cte group by 1) select round(sum(cte2.delcnt / cte2.spmcnt)/count(cte2.action_date)*100,2) as average_daily_percent from cte2 "
17,"with cte as (select distinct post_id,action_date, action, extra from actions where action = 'report' and extra = 'spam'), cte2 as (select action_date, count(b.post_id)/count(a.post_id)*100 as spam_report from cte a left join removals b on a.post_id = b.post_id group by 1) select round(avg(spam_report),2) as average_daily_percent from cte2 "
18,"select round(avg(removal),2) average_daily_percent from ( select action_date,count(distinct r.post_id)/count(distinct a.post_id) *100 as removal from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date) a"
19,"SELECT ROUND(AVG(num_removed/num_reported)*100, 2) AS average_daily_percent FROM ( SELECT COUNT(DISTINCT a.post_id) AS num_reported, COUNT(DISTINCT r.post_id) AS num_removed FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id AND r.remove_date > a.action_date WHERE action = 'report' AND extra = 'spam' GROUP BY a.action_date ) t "
20,"select round(avg(ptg),2) as average_daily_percent from ( select action_date, 100.0 * count(distinct removals.post_id) / count(distinct actions.post_id) as ptg from actions left join removals on actions.post_id = removals.post_id where action = 'report' and extra = 'spam' group by action_date ) tmp"
21,"with spam as ( select action_date, 100*count(distinct b.post_id)/count(distinct a.post_id) as percent from actions a left join removals b on a.post_id = b.post_id where a.extra= ""spam"" group by 1 ) select round (avg(percent),2) as average_daily_percent from spam"
22,"with day_pct_of_rem_spam as (select action_date, count(distinct case when remove_date is not null then a.post_id else null end)/count(distinct a.post_id) spam_pct from Actions a left join Removals r on a.post_id = r.post_id where a.action = 'report' and a.extra = 'spam' group by action_date) select round(avg(spam_pct)*100,2) as average_daily_percent from day_pct_of_rem_spam"
23,"SELECT round(avg(report_rate),2) as average_daily_percent FROM( select action_date , sum(removed)*100/count(distinct reported_posts) as report_rate FROM( select distinct action_date , a.post_id as reported_posts , case when r.post_id IS NOT NULL then 1 else 0 end as removed FROM Actions a LEFT JOIN Removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam') t GROUP by action_date) t2 "
24,"select round(avg(removal/report)*100,2) as 'average_daily_percent' from (select action_date, count(distinct a.post_id) as 'report', count(distinct r.post_id) as 'removal' from Actions a left join Removals r on r.post_id = a.post_id where extra = 'spam' and a.action = 'report' group by 1) temp "
25,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
26,"select round(avg(pct) *100,2) average_daily_percent from ( select action_date, count(distinct r.post_id)/count(distinct a.post_id) pct from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by 1 ) t "
27,"with count as ( select count(distinct r.post_id) / count(distinct a.post_id) as daily_avg from actions a left join removals r using(post_id) where action = ""report"" and extra = ""spam"" group by action_date) select round(avg(daily_avg)*100, 2) as average_daily_percent from count "
28,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp "
29,"select round(avg(daily_percent)*100,2) 'average_daily_percent' from (select count(distinct b.post_id)/count(distinct a.post_id) 'daily_percent' from (select * from actions where action='report' and extra='spam') a left join removals b on a.post_id=b.post_id group by action_date ) c"
30,"with t as ( select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as pct from actions a left join removals r using(post_id) where extra = 'spam' group by a.action_date ) select round(avg(pct), 2 ) as average_daily_percent from t "
31,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) A "
32,"with spam_posts as ( select distinct a.post_id, a.action_date, r.remove_date from actions as a left join removals as r on a.post_id = r.post_id where a.extra = 'spam' ), result_table as ( select action_date, count(remove_date) / count(distinct post_id) ""avg_pct"" from spam_posts group by 1 ) select round(100 * avg(avg_pct), 2) ""average_daily_percent"" from result_table"
33,"with spam_posts as ( select distinct a.post_id, a.action_date, r.remove_date from removals r right join actions a on a.post_id = r.post_id where a.extra = 'spam' ) select round(100 * avg(avg_pct), 2) ""average_daily_percent"" from (select action_date, count(remove_date) / count(distinct post_id) ""avg_pct"" from spam_posts group by 1 ) result_table "
34,"select round(avg(percent_)*100,2) as average_daily_percent from (select action_date, count( distinct case when extra='spam' and post_id in (select post_id from removals) then (post_id) else null end) /count( distinct case when extra='spam' then (post_id) else null end) as percent_ from actions group by action_date)a "
35,"select round(100*avg(pct),2) as average_daily_percent from( select action_date, count(distinct b.post_id)/count(distinct a.post_id) as pct from actions a left join removals b on a.post_id=b.post_id where extra='spam' group by 1) t "
36,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
37,"with cte as ( select action_date, count(distinct b.post_id)/count(distinct a.post_id) * 100 as abs from Actions a left join Removals b on a.post_id=b.post_id where action = 'report' and extra = 'spam' group by action_date ) select round(avg(abs),2) as average_daily_percent from cte"
38,"WITH TEMP1 AS (SELECT post_id, action_date FROM actions WHERE action = 'report' and extra = 'spam' GROUP BY post_id, action_date), TEMP2 AS (SELECT TEMP1.action_date, count(r.post_id) AS num FROM TEMP1 LEFT JOIN Removals r on TEMP1.post_id =r.post_id GROUP BY action_date) SELECT ROUND(AVG(TGT)*100,2) AS average_daily_percent from( SELECT num/count(TEMP1.post_id) as TGT FROM TEMP1 JOIN TEMP2 USING (ACTION_DATE) GROUP BY ACTION_DATE) a "
39,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date) temp"
40,"WITH cte AS (SELECT action_date, COUNT(DISTINCT post_id) AS reported_spam FROM Actions WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date), cte2 AS (SELECT action_date, COUNT(DISTINCT post_id) AS removed_spam FROM actions JOIN removals USING (post_id) WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date) SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT COALESCE((removed_spam/reported_spam)*100,0) AS daily_percent FROM cte LEFT JOIN cte2 USING (action_date)) q"
41,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
42,"with a as (select count(distinct t2.post_id)/count(distinct t1.post_id) as percentage from Actions t1 left join Removals t2 on t2.post_id=t1.post_id where extra like ""spam"" group by action_date) SELECT ROUND(AVG(percentage)*100,2) AS average_daily_percent FROM a"
43,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
44,"with cte AS( select action_date, count(distinct a.post_id) as num_spam, count(distinct r.post_id) as num_remove from actions a left join removals r using (post_id) where extra = 'spam' group by action_date ) select round(avg(num_remove / num_spam)*100,2) as average_daily_percent from cte "
45,"with t1 as (select distinct action_date, post_id from actions where action = 'report' and extra = 'spam'), t2 as (select count(*) as reported, sum(case when post_id in (select post_id from removals) then 1 else 0 end) as removed from t1 group by action_date) select round(ifnull(100*avg(removed/reported), 0), 2) as average_daily_percent from t2"
46,"with report_spam as ( select post_id, action_date from actions where action='report' and extra='spam' group by 1,2), spam_removal as ( select rs.action_date, count(rm.post_id) as removal_num from report_spam rs left join removals rm on rs.post_id=rm.post_id group by 1) select round(avg(target_value)*100,2) as average_daily_percent from ( select sr.action_date, sr.removal_num/count(rs.post_id) as target_value from report_spam rs join spam_removal sr on sr.action_date=rs.action_date group by 1) t "
47,"select round(avg(pcent),2) as ""average_daily_percent"" from ( select action_date, sum(cnt)/sum(total)*100 as pcent from (select a.action_date, count(distinct a.post_id) as total, ifnull(count(distinct r.post_id), 0) as cnt from actions as a left join removals as r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date) as t group by action_date ) as p"
48,"with t1 as ( select post_id, action_date from Actions where extra = 'spam'), t2 as ( select distinct t1.post_id as id, t1.action_date, r.post_id as rid from t1 left join Removals r on t1.post_id = r.post_id ), t3 as ( select count(t2.rid)/count(t2.id) as percentage from t2 group by t2.action_date) select round(avg(t3.percentage)*100,2) as average_daily_percent from t3"
49,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp"
50,"select round(avg(daily_count), 2) as average_daily_percent from (select count(distinct b.post_id)/count(distinct a.post_id)*100 as daily_count from actions a left join removals b on a.post_id = b.post_id where extra = 'spam' group by action_date ) b"
51,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
52,"select ROUND(SUM(daily_avg)*100/count(action_date),2) as average_daily_percent from( select action_date, count(distinct r.post_id)/count(distinct a.post_id) as daily_avg from Actions a left join removals r using(post_id) where extra = 'spam' and action = 'report' group by action_date) as t1 "
53,"WITH cte_actions AS ( SELECT a.action_date, a.post_id, r.post_id AS removed_post_id FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' ) SELECT ROUND(AVG(pct), 2) AS average_daily_percent FROM ( SELECT t.action_date, COALESCE(r.reomved_post_count, 0) / total_post_count * 100 AS pct FROM ( SELECT action_date, COUNT(DISTINCT post_id) AS total_post_count FROM cte_actions GROUP BY action_date ) t LEFT JOIN ( SELECT action_date, COUNT(DISTINCT post_id) AS reomved_post_count FROM cte_actions WHERE removed_post_id IS NOT NULL GROUP BY action_date ) r ON r.action_date = t.action_date ) pct "
54,"select round(avg(daily_percent), 2) as average_daily_percent from ( select action_date, (sum(removed)*100.0)/count(distinct post_id) as daily_percent from ( select distinct a.action_date, a.post_id, case when r.post_id is null then 0 else 1 end as removed from actions a left join removals r using (post_id) where extra = 'spam' ) x group by action_date ) y"
55,"WITH cte_total_post AS ( SELECT action_date, COUNT(DISTINCT post_id) AS total_post FROM Actions WHERE extra ='spam ' GROUP BY action_date ORDER BY action_date) ,cte_remove AS ( SELECT action_date, COUNT(DISTINCT post_id) AS removed FROM (SELECT a.post_id, action_date,extra FROM Actions a INNER JOIN Removals r ON a.post_id=r.post_id WHERE extra =""spam"") AS d GROUP BY action_date ) , cte_percentage AS ( SELECT t.action_date, COALESCE((removed/total_post),0) AS average_daily_percent FROM cte_total_post t LEFT JOIN cte_remove r ON t.action_date=r.action_date) SELECT ROUND(AVG(average_daily_percent)*100, 2) AS average_daily_percent FROM cte_percentage "
56,"WITH t1 AS ( SELECT action_date, post_id FROM Actions WHERE extra = 'spam' GROUP BY action_date, post_id ), t2 AS ( SELECT t1.action_date, AVG(CASE WHEN t1.action_date < r.remove_date THEN 1 ELSE 0 END) * 100 AS daily_percent FROM t1 LEFT JOIN Removals r ON t1.post_id = r.post_id GROUP BY action_date ) SELECT ROUND(AVG(daily_percent), 2) AS average_daily_percent FROM t2"
57,"select ROUND(avg (pct),2) as average_daily_percent from( select count(distinct R.post_id)/count(distinct A.post_id)*100.00 as pct from Actions A left join Removals R on A.post_id=R.post_id where extra='spam' and action = 'report' group by A.action_date)T "
58,"select round(sum(percentage_daily)/count(distinct action_date)*100,2) as average_daily_percent from (select a.action_date, (count(distinct r.post_id)/count(distinct a.post_id)) as percentage_daily from (select * from Actions where extra=""spam"") a left join Removals r on a.post_id=r.post_id group by a.action_date) b "
59,"WITH RS AS (SELECT DISTINCT A.POST_ID AS POST1, A.ACTION_DATE, B.POST_ID AS POST2 FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'spam') SELECT ROUND(AVG(PTG),2) AS average_daily_percent FROM (SELECT RS.ACTION_DATE, 100.00 * SUM(CASE WHEN RS.POST2 IS NULL THEN 0 ELSE 1 END)/ COUNT(CASE WHEN RS.POST2 IS NULL THEN 0 ELSE 1 END) AS PTG FROM RS GROUP BY RS.ACTION_DATE) P"
60,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp"
61,"WITH cte AS (SELECT action_date, COUNT(DISTINCT post_id) AS reported_spam FROM Actions WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date), cte2 AS (SELECT action_date, COUNT(DISTINCT post_id) removed_spam FROM actions JOIN removals USING (post_id) WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date) SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT COALESCE((removed_spam/reported_spam)*100,0) AS daily_percent FROM cte LEFT JOIN cte2 USING (action_date)) q"
62,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
63,"WITH tp AS (SELECT a.action_date, 100.0*SUM(CASE WHEN remove_date IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT post_id) AS pct_removed FROM (SELECT DISTINCT action_date, post_id FROM Actions WHERE action = 'report' AND extra ='spam') AS a LEFT JOIN Removals AS r USING(post_id) GROUP BY a.action_date) SELECT ROUND(AVG(pct_removed),2) AS average_daily_percent FROM tp "
64,"WITH cte AS( SELECT action_date, COUNT(DISTINCT R.post_id) / COUNT(DISTINCT A.post_id)*100 as daily_percent FROM Actions A LEFT JOIN Removals R ON A.post_id = R.post_id WHERE extra = 'spam' GROUP BY action_date ) SELECT ROUND(AVG(daily_percent), 2) as average_daily_percent FROM cte  "
65,"SELECT ROUND(AVG(removed_rate), 2) AS average_daily_percent FROM ( SELECT action_date, COUNT(DISTINCT removals.post_id)/COUNT(DISTINCT actions.post_id)*100 AS removed_rate FROM actions LEFT JOIN removals USING(post_id) WHERE action = 'report' AND extra = 'spam' GROUP BY action_date) temp"
66,"WITH cte_total_post AS ( SELECT action_date, COUNT(DISTINCT post_id) AS total_post FROM Actions WHERE extra ='spam ' GROUP BY action_date ORDER BY action_date) ,cte_remove AS ( SELECT action_date, COUNT(DISTINCT post_id) AS removed FROM (SELECT a.post_id, action_date,extra FROM Actions a INNER JOIN Removals r ON a.post_id=r.post_id WHERE extra =""spam"") AS d GROUP BY action_date ) SELECT ROUND(AVG(average_daily_percent)*100, 2) AS average_daily_percent FROM (SELECT t.action_date, COALESCE((removed/total_post),0) AS average_daily_percent FROM cte_total_post t LEFT JOIN cte_remove r ON t.action_date=r.action_date) AS d "
67,"select round(avg(a.mean),2) average_daily_percent from (select 100*sum(case when isnull(b.post_id) then 0 else 1 end)/count(distinct a.post_id) as mean from (select distinct post_id,action_date from Actions where extra='spam') a left join Removals b on a.post_id=b.post_id group by a.action_date) a "
68,"with cte as ( select distinct a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on r.post_id = a.post_id where a.action = 'report' and a.extra = 'spam' ), cte2 as ( select cte.action_date, count(case when cte.remove_date is not null then 1 else null end) as delcnt, count(cte.post_id) as spmcnt from cte group by 1) select round(sum(cte2.delcnt / cte2.spmcnt)/count(cte2.action_date)*100,2) as average_daily_percent from cte2 "
69,"select round(avg(removal_rate)*100,2) average_daily_percent from ( select action_date, count(distinct b.post_id)/count(distinct a.post_id) removal_rate from actions a left join removals b using (post_id) where action ='report' and extra ='spam' group by 1 ) t "
70,"with cte as ( select a.post_id, a.action_date, b.remove_date from Actions a left join Removals b on a.post_id = b.post_id where extra = 'spam' group by a.post_id, a.action_date) select round(avg(percent)*100,2) as average_daily_percent from (select action_date, sum(case when remove_date is not null then 1 else 0 end)/ count(post_id) as percent from cte group by action_date) e"
71,"with spam_posts as ( select distinct a.post_id, a.action_date, r.post_id as post_id_r from removals r right join actions a on a.post_id = r.post_id where a.extra = 'spam' ) select round(100 * avg(avg_pct), 2) ""average_daily_percent"" from (select action_date, count(post_id_r) / count(distinct post_id) ""avg_pct"" from spam_posts group by 1 ) result_table "
72,"SELECT round(avg(prct), 2) AS average_daily_percent FROM ( SELECT spammed.action_date, count(DISTINCT Removals.post_id) / count(DISTINCT spammed.post_id)*100 prct FROM Actions spammed LEFT JOIN Removals ON Removals.post_id = spammed.post_id WHERE spammed.extra = 'spam' GROUP BY 1 ) sub "
73,"SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT action_date,COUNT(DISTINCT IF(remove_date IS NULL,NULL,post_id))/COUNT(DISTINCT post_id)*100 AS daily_percent FROM Actions LEFT JOIN Removals USING(post_id) WHERE action=""report"" AND extra =""spam"" GROUP BY action_date) AS temp"
74,"with cte_spam as ( SELECT action_date, ((count(distinct(t2.post_id))) / (count(distinct(t1.post_id)))) as PERCENTAGE FROM ACTIONS t1 left join removals t2 on t1.post_id = t2.post_id WHERE EXTRA LIKE 'spam' GROUP BY action_date ) SELECT ROUND(AVG(percentage)*100,2) AS average_daily_percent FROM CTE_SPAM"
75,"with cte1 as ( select action_date, count(distinct post_id) as total_daily_spam from Actions where extra='spam' and action='report' group by action_date), cte2 as (select action_date, count(distinct a.post_id) as total_removal from Actions a left join Removals b on a.post_id=b.post_id where a.extra='spam' and a.action='report' and b.remove_date>a.action_date group by action_date) select round(avg(daily_avg)*100,2) as average_daily_percent from ( select (COALESCE(b.total_removal,0)/a.total_daily_spam) as daily_avg from cte1 a left join cte2 b on a.action_date=b.action_date)c "
76,"select round(100*avg(cnt),2) average_daily_percent from (select count(distinct r.post_id) / count(distinct a.post_id) cnt, action_date from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' and action = 'report' group by action_date) temp "
77,"select round(avg(tc2*100/tc1),2) as average_daily_percent from (select action_date,count(distinct t1id) as tc1,count(distinct t2id) as tc2 from (select t1.post_id as t1id,action_date,t2.post_id as t2id from Actions t1 left join Removals t2 on t1.post_id = t2.post_id where action = ""report"" and extra= ""spam"") t3 group by action_date) t4"
78,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
79,"select round(avg(daily_percentage)*100,2) as average_daily_percent from (select a.action_date, count(distinct a.post_id, r.remove_date)/count(distinct a.post_id) as daily_percentage from Actions as a left join Removals as r on r.post_id = a.post_id where a.action = 'report' and a.extra = 'spam' group by a.action_date)t"
80,"SELECT ROUND(SUM(DAILY_AVERAGE)/COUNT(action_date),2) as average_daily_percent FROM ( SELECT A.action_date, (COUNT(DISTINCT B.POST_ID) / COUNT(DISTINCT A.POST_ID)) *100 AS DAILY_AVERAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = ""SPAM"" GROUP BY action_date )AS C "
81,"SELECT COALESCE(ROUND(AVG(percent),2),0.00) as average_daily_percent FROM( Select a.action_date, (count(DISTINCT r.post_id)/count(DISTINCT a.post_id)) *100 as percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra='spam' GROUP BY a.action_date )a"
82,"with cte as( select count(distinct r.post_id) / count(distinct a.post_id) * 100 as pctg from actions a left join removals r using (post_id) where extra = 'spam' group by action_date) select round(avg(pctg),2) as average_daily_percent from cte "
83,"SELECT ROUND(AVG(daily_ave) * 100,2) average_daily_percent FROM ( SELECT action_date, COUNT(CASE WHEN post_id IN (SELECT post_id FROM removals) THEN 1 ELSE NULL END) / COUNT(post_id) daily_ave FROM ( SELECT DISTINCT action_date, post_id, CASE WHEN extra = 'spam' THEN extra ELSE null END extra FROM actions ) a WHERE extra = 'spam' GROUP BY 1 ) final"
84,"SELECT ROUND(AVG(pnt), 2) AS average_daily_percent FROM ( SELECT COUNT(DISTINCT r.post_id)*100/ COUNT(distinct a.post_id) AS pnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp "
85,"with t1 as (select distinct action_date, post_id from actions where action = 'report' and extra = 'spam'), t2 as (select count(*) as reported, sum(case when post_id in (select post_id from removals) then 1 else 0 end) as removed from t1 group by action_date) select round(100*ifnull(avg(removed/reported), 0), 2) as average_daily_percent from t2"
86,"select round(avg(tmp)*100,2) as average_daily_percent from (select action_date, avg(case when remove_date is not NULL then 1 else 0 end) as tmp from (select t.post_id, action_date, count_s, remove_date from (select post_id, action_date, sum(case when extra = 'spam' then 1 else 0 end) as count_s from Actions group by action_date, post_id) as t left join Removals on Removals.post_id = t.post_id where count_s>0) as t2 group by action_date) as t3"
87,"with day_pct_of_rem_spam as (select action_date, count(distinct case when remove_date is not null then a.post_id else null end)/count(distinct a.post_id) spam_pct from Actions a left join Removals r on a.post_id = r.post_id where a.action = 'report' and a.extra = 'spam' group by action_date) select round(avg(spam_pct)*100,2) as average_daily_percent from day_pct_of_rem_spam"
88,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
89,"WITH CTE AS ( SELECT action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) as total FROM actions as a LEFT JOIN removals as r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY 1) SELECT ROUND(AVG(total*100),2) as average_daily_percent FROM CTE"
90,"WITH report_spam as ( select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1 ) select round(sum(percent)/count(distinct action_date),2) as average_daily_percent FROM report_spam "
91,"with spam_post as ( select distinct action_date, post_id from Actions where extra = 'spam' ) select round(100 * avg(ratio), 2) ""average_daily_percent"" from (select s.action_date, count(r.post_id)/count(s.post_id) as ratio from spam_post s left join Removals r on s.post_id = r.post_id group by 1) t "
92,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
93,"select round(avg(removed/spam)*100,2) as average_daily_percent from (select a.action_date, count(distinct a.post_id) as spam, count(distinct r.post_id) as removed from actions as a left join removals as r on a.post_id = r.post_id where a.extra = 'spam' group by 1 ) as tmp"
94,"with main as ( select action_date, count(distinct r.post_id)/ count(distinct a.post_id)*100 as removal_percent from actions a left join removals r on a.post_id= r.post_id where a.extra='spam' and a.action='report' group by action_date ) select round(avg(removal_percent), 2) as average_daily_percent FROM main "
95,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
96,"with spam_posts as ( select distinct a.post_id, a.action_date, r.remove_date from removals r right join actions a on a.post_id = r.post_id where a.extra = 'spam' ) select round(100 * avg(avg_pct), 2) ""average_daily_percent"" from (select action_date, count(remove_date) / count(distinct post_id) ""avg_pct"" from spam_posts group by 1 ) result_table "
97,"select round(avg(daily_count) ,2) as average_daily_percent from (select count(distinct b.post_id)/count(distinct a.post_id)*100 as daily_count from Actions as a left join Removals as b on a.post_id = b.post_id where a.extra='spam' group by a.action_date) b"
98,"WITH date_pct AS ( SELECT a.action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) AS daily_pct FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ) SELECT ROUND(100*AVG(daily_pct),2) AS average_daily_percent FROM date_pct "
99,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
100,"with a as ( select distinct post_id, action_date from actions where action = 'report' and extra='spam'), b as( select a.post_id , a.action_date , r.remove_date from a left join removals as r on a.post_id=r.post_id), c as ( select action_date , sum(if(remove_date is null, 0, 1)) as num_remove , count(distinct post_id) as num_posts from b group by action_date) select round(100*avg(num_remove/num_posts), 2) as average_daily_percent from c "
101,"with spam_reports as ( select post_id, action_date from actions where action='report' and extra='spam' group by post_id, action_date) , spam_removal as ( select rep.action_date, count(rm.post_id) as removal_num from spam_reports rep left join removals rm on rep.post_id=rm.post_id group by rep.action_date) , spam_removal_rate as ( select sr.action_date, sr.removal_num/count(rep.post_id) as target_value from spam_reports rep join spam_removal sr on sr.action_date=rep.action_date group by sr.action_date ) select round(avg(target_value)*100,2) as average_daily_percent from spam_removal_rate "
102,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM (SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' GROUP BY action_date) as t "
103,"select round(avg(remove_pct)*100,2) as average_daily_percent from (select action_date, count(distinct r.post_id)/count(distinct a.post_id) as remove_pct from Actions a left join Removals r on a.post_id = r.post_id and a.action_date < r.remove_date where action ='report' and extra = 'spam' group by action_date ) tmp"
104,"with removal as( select post_id, count(distinct a.post_id) as removal_cnt, action_date from actions as a where extra = 'spam' and post_id in (select distinct post_id from removals) group by action_date), spam as( select count(distinct post_id) as cnt, action_date from actions where extra = 'spam' group by action_date), zero as( select ifnull(removal_cnt,0) as removal_cnt, spam.action_date from removal right join spam on removal.action_date = spam.action_date) select round(avg(rate)*100,2) as average_daily_percent from( select removal_cnt/cnt as rate, s.action_date from spam as s join zero as z on s.action_date = z.action_date group by s.action_date) as sub"
105,"WITH CTE AS ( SELECT DISTINCT post_id, action_date, extra FROM Actions WHERE extra = 'spam' ) SELECT ROUND(avg(pct)*100,2) AS average_daily_percent FROM (SELECT SUM(cnt)/COUNT(post_id) AS pct FROM( SELECT *, CASE WHEN post_id in (SELECT post_id FROM Removals) THEN 1 ELSE 0 END AS cnt FROM CTE )A GROUP BY action_date )B "
106,"select round(avg(percent)*100, 2) as average_daily_percent from ( select action_date, count(distinct Removals.post_id)/ count(distinct Actions.post_id) as percent from Actions left join Removals on Actions.post_id = Removals.post_id where extra = 'spam' group by action_date ) a "
107,"with actions as (SELECT count(DISTINCT r.post_id)/count(distinct a.post_id)*100 as cnt FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date) SELECT ROUND(AVG(cnt),2) AS average_daily_percent FROM actions "
108,"WITH table1 AS( SELECT action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 AS daily_percentage FROM Actions a LEFT JOIN Removals r USING(post_id) WHERE extra='spam' GROUP BY action_date ) SELECT ROUND(AVG(daily_percentage),2) AS average_daily_percent FROM table1 "
109,"select round(avg(percent_)*100,2) as average_daily_percent from (select action_date, count( distinct case when extra='spam' and post_id in (select post_id from removals) then (post_id) else null end) /count( distinct case when extra='spam' then (post_id) else null end) as percent_ from actions group by action_date)a where percent_ is not null "
110,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp"
111,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
112,"select ROUND(avg((case when num_remove is null then 0 else num_remove end)/num_total) *100,2) as average_daily_percent from (select action_date,count(Distinct post_id) as num_total from Actions where extra = 'spam' group by action_date) as b left join (select action_date, count(distinct a.post_id) as num_remove from (select * from actions where extra = 'spam') as a join removals on a.post_id = removals.post_id group by action_date) as c on b.action_date = c.action_date "
113,"WITH table1 AS( SELECT COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id)*100 AS pct_removed FROM Actions a LEFT JOIN Removals r USING(post_id) WHERE extra = 'spam' GROUP BY action_date ) SELECT ROUND(AVG(pct_removed),2) AS average_daily_percent FROM table1"
114,"SELECT ROUND(AVG(d.num)*100,2) average_daily_percent FROM (SELECT (COUNT(c.remove_date)/ COUNT(c.action_date)) num FROM ( SELECT DISTINCT a.post_id,a.action_date,b.remove_date FROM Actions a LEFT JOIN Removals b ON a.post_id=b.post_id WHERE extra=""spam"") c GROUP BY action_date)d "
115,"WITH total_spam AS( SELECT action_date, COUNT(DISTINCT post_id) spam_count FROM actions WHERE extra = 'spam' GROUP BY action_date ), deleted_spam AS ( SELECT a.action_date, COALESCE(COUNT(DISTINCT r.post_id), 0) deleted_spam_count FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date ), pct AS ( SELECT total_spam.action_date, ((deleted_spam.deleted_spam_count/total_spam.spam_count) * 100) deleted_spam_pct FROM total_spam JOIN deleted_spam ON total_spam.action_date = deleted_spam.action_date ) SELECT ROUND(AVG(deleted_spam_pct), 2) average_daily_percent FROM pct"
116,"select round(avg(removed_spam),2) average_daily_percent from (select action_date, (count(distinct R.post_id) / count(distinct A.post_id)) * 100 removed_spam from Actions A LEFT JOIN Removals R on A.post_id = R.post_id WHERE extra ='spam' group by action_date)A"
117,"with actions as (SELECT count(DISTINCT r.post_id)/count(distinct a.post_id)*100 as cnt FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date) SELECT ROUND(AVG(cnt),2) AS average_daily_percent FROM actions "
118,"Select round(avg(removed),2) average_daily_percent from ( Select (count(distinct r.post_id)/count(distinct a.post_id))*100 removed, action_date from Actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra like 'spam' group by action_date ) temp "
119,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp"
120,"SELECT ROUND(AVG(daily_percentage)*100,2) AS average_daily_percent FROM ( SELECT action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id) as daily_percentage FROM Actions a LEFT JOIN Removals r ON a.post_id=r.post_id WHERE action='report' AND extra='spam' GROUP BY action_date) d"
121,"SELECT ROUND(AVG(t.percentage), 2) AS average_daily_percent FROM (SELECT COUNT(DISTINCT(r.post_id)) / COUNT(DISTINCT(a.post_id)) * 100 AS percentage FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY action_date) t"
122,"with cte as(select * from actions where extra='spam'), cte1 as(select count(distinct r.post_id)/ count(distinct c.post_id) as daily_percent from cte c left join removals r on c.post_id=r.post_id group by action_date) select round(avg(daily_percent)*100,2) as average_daily_percent from cte1 "
123,"with cte as (select distinct post_id, action_date from Actions where extra = 'spam'), cte2 as (select cte.post_id, action_date, case when post_id in (select post_id from removals) then 1 else 0 end as cnt from cte), cte3 as (select *, sum(cnt)/count(post_id) as pct from cte2 group by action_date) select round(avg(pct)*100,2) as average_daily_percent from cte3"
124,"with cte as (select DISTINCT post_id,action_date FROM Actions WHERE extra='spam'), cte2 AS (SELECT post_id,action_date,CASE WHEN post_id IN (SELECT post_id FROM Removals) THEN 1 ELSE 0 END AS cnt FROM cte), cte3 AS(SELECT *,SUM(cnt)/COUNT(post_id) AS pct FROM cte2 GROUP BY action_date) SELECT ROUND(AVG(pct)*100,2) AS average_daily_percent FROM cte3 "
125,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
126,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
127,"WITH T1 AS ( SELECT DISTINCT post_id, action_date, remove_date FROM Actions LEFT JOIN Removals USING(post_id) WHERE extra='spam' ), T2 AS ( SELECT SUM(CASE WHEN remove_date IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*)*100 AS percent FROM T1 GROUP BY action_date ) SELECT ROUND(AVG(percent), 2) AS average_daily_percent FROM T2"
128,"with spam as (select action_date, count(distinct post_id) as spam_num from Actions where action = 'report' and extra='spam' group by action_date), remove_1 as (select action_date, count(distinct r.post_id) as remove_num from Actions a left join Removals r using (post_id) where a.action = 'report' and a.extra='spam' group by action_date) select round(avg(remove_num/spam_num)*100,2) as average_daily_percent from remove_1, spam where remove_1.action_date = spam.action_date "
129,"WITH t AS ( SELECT DISTINCT post_id, action_date, extra FROM Actions WHERE extra = 'spam' ) SELECT ROUND(avg(daily_percent)*100,2) AS 'average_daily_percent' FROM ( SELECT SUM(dividend)/COUNT(post_id) AS 'daily_percent' FROM( SELECT *, CASE WHEN post_id in (SELECT post_id FROM Removals) THEN 1 ELSE 0 END AS 'dividend' FROM t) As t1 GROUP BY action_date) As t2 "
130,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
131,"with cte as ( select action_date, post_id, count(distinct post_id) as cnt from actions where extra = 'spam' group by 1,2) ,cte2 as( select count(r.post_id)/sum(cnt)*100 as pct from cte left join removals r on r.post_id = cte.post_id group by action_date) select round(sum(pct)/count(pct),2) average_daily_percent from cte2"
132,"with a as (SELECT action_date, COUNT(DISTINCT post_id) AS spam_count FROM Actions WHERE extra = 'spam' GROUP BY action_date), b as (SELECT action_date, remove_date, COUNT(DISTINCT r.post_id) AS remove_count FROM Actions AS a LEFT JOIN Removals AS r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date) SELECT ROUND((AVG(b.remove_count/a.spam_count))*100, 2) AS average_daily_percent FROM b JOIN a ON a.action_date = b.action_date "
133,"WITH spam_table AS(SELECT DISTINCT action_date, post_id, extra, CASE WHEN post_id IN (SELECT post_id FROM Removals) THEN 'removed' ELSE 'not removed' END removed FROM Actions WHERE action='report' AND extra='spam') SELECT ROUND(AVG(percent_removed),2) average_daily_percent FROM ( SELECT action_date, SUM(CASE WHEN removed='removed' THEN 1 ELSE 0 END)/COUNT(*)*100 percent_removed FROM spam_table GROUP BY 1) sub1 "
134,"with reports as ( select distinct action_date as reporting_date,post_id from actions where action = 'report' and extra = 'spam' ) ,daily_per as ( select rp.reporting_date, count(distinct case when rp.reporting_date <= rm.remove_date then rm.post_id end) *100.0/count(distinct rp.post_id) as daily_per from reports rp left join removals rm on rp.post_id = rm.post_id group by 1 ) select round(avg(daily_per),2) as average_daily_percent from daily_per"
135,"with rminfo as (select action_date , round(100*count(distinct b.post_id)/count(distinct a.post_id) , 2) as rm_percentage from actions a left join removals b on a.post_id = b.post_id where extra = 'spam' group by action_date) select round(avg(rm_percentage) , 2) as average_daily_percent from rminfo"
136,"select round ( sum(dailyper)/ COUNT(action_date), 2) average_daily_percent from ( select action_date, ( count(distinct r.post_id) / count(distinct a.post_id) ) * 100 dailyper, 1 as PerDay from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date ) t"
137,"select ROUND(avg(daily_percent*100),2) as average_daily_percent FROM (select t.action_date as date, (count(distinct case when remove_date is not null then post_id else null end)/ count(distinct post_id) ) as daily_percent FROM (SELECT a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on a.post_id = r.post_id WHERE a.extra='spam') t GROUP BY t.action_date) t2"
138,"select round(100*avg(daily_percent),2) as average_daily_percent from (select ifnull(count(distinct b.post_id), 0)/count(distinct a.post_id) as daily_percent from (select post_id, action_date from Actions where extra = 'spam') a left join Removals b on a.post_id = b.post_id group by a.action_date) t1"
139,"with t as ( select action_date ,count(distinct r.post_id)/count(distinct a.post_id) as r_percent from Actions a LEFT JOIN Removals r on a.post_id = r.post_id where a.action ='report' and a.extra = 'spam' group by a.action_date having count(distinct case when a.action='report' and a.extra='spam' then a.post_id else null end) > 0 ) select round(100*avg(r_percent),2) as average_daily_percent from t "
140,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp "
141,"WITH cte AS( SELECT action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id) AS cnt FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE extra='spam' GROUP BY action_date) SELECT ROUND(AVG(cnt)*100,2) AS average_daily_percent FROM cte"
142,"with cte as (select distinct post_id,action_date,extra from Actions where extra = 'spam') select round(avg(percent)*100,2) as average_daily_percent from ( select action_date, sum(rk)/count(rk) as percent from(select *, case when post_id in (select post_id from Removals) then 1 else 0 end as rk from cte)a group by action_date )b "
143,"select round(avg(t.ratio) *100, 2) as average_daily_percent from (select a.action_date, count(r.post_id)/count(distinct a.post_id) as ratio from (select distinct action_date, post_id from Actions where action = 'report' and extra = 'spam') a left join Removals r on a.post_id = r.post_id group by 1) t "
144,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp"
145,"select round(avg(cnt),2) as average_daily_percent from ( select (count(distinct r.post_id)/count(distinct a.post_id))*100 as cnt from actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by action_date) tmp "
146,"with cte1 as (select action_date, count(distinct post_id) as total_posts from Actions where extra = 'spam' group by action_date), cte2 as (select action_date, count(distinct r.post_id) as removed_post from Actions a inner join Removals r on a.post_id = r.post_id and extra = 'Spam' group by action_date) select round(AVG(ifnull(removed_post*100/total_posts,0)),2) as average_daily_percent from cte1 left join cte2 on cte1.action_date = cte2.action_date"
147,"WITH spams AS ( SELECT DISTINCT a.post_id, (CASE WHEN r.remove_date IS NOT NULL THEN 1 ELSE 0 END) as is_reported, a.action_date FROM Actions a LEFT JOIN Removals r USING(post_id) WHERE a.action = 'report' AND extra = 'spam' ), avgs AS ( SELECT SUM(is_reported=1) / COUNT(DISTINCT post_id) as daily_perc FROM spams GROUP BY action_date ) select ROUND(AVG(daily_perc * 100), 2) as average_daily_percent from avgs"
148,"SELECT ROUND(SUM(Daily_Percent)*100/COUNT(DISTINCT action_date),2) AS average_daily_percent FROM ( SELECT A.action_date, (COUNT(DISTINCT R.post_id)/COUNT(DISTINCT A.post_id)) AS Daily_Percent FROM Actions A LEFT JOIN Removals R ON R.post_id = A.post_id WHERE A.extra = 'spam' GROUP BY A.action_date ) A "
149,"SELECT ROUND(AVG(spamremoved/spamnum)*100, 2) as average_daily_percent FROM ( SELECT COUNT(distinct a.post_id) as spamnum, COUNT(distinct CASE WHEN remove_date IS NOT NULL THEN a.post_id ELSE NULL END) as spamremoved, action_date FROM Actions as a LEFT JOIN Removals as r ON a.post_id = r.post_id WHERE extra = 'spam' GROUP BY action_date ) as sub"
150,"select round(avg(perc),2) average_daily_percent from ( select action_date, (count(distinct r.post_id)/count(distinct a.post_id)) * 100 perc from Actions a left join Removals r on a.post_id = r.post_id where a.extra='spam' group by 1 )a "
151,"select round(avg(Bcnt*100/Acnt),2) as average_daily_percent from ( select action_date, count(distinct A.post_id) as Acnt, count( distinct B.post_id) as Bcnt from Actions A left join Removals B on A.post_id=B.post_id where extra =""spam"" and action like ""report"" group by 1 )t"
152,"with cte as ( select a.post_id, action_date, remove_date from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by 1,2 ), cte2 as ( select round(sum(case when remove_date is not null then 1 else 0 end)*100/count(*),2) as daily_per from cte group by action_date) select round(avg(daily_per),2) as average_daily_percent from cte2"
153,"with cte1 as ( select 100*(count(distinct r.post_id)/count(distinct a.post_id)) as cnt from Actions a left join Removals r on a.post_id=r.post_id where a.extra='spam' group by a.action_date ), cte2 as ( select round(avg(cnt),2) as average_daily_percent from cte1 ) select * from cte2 "
154,"With data_com as (Select a.post_id, action_date, extra, remove_date From Actions a Left Join Removals r On a.post_id = r.post_id Where extra=""spam""), data_daily as (Select action_date, count(distinct case when remove_date is null then null else post_id end)/ count(distinct post_id)*100 as daily_percent From data_com Group by action_date) Select round(avg(daily_percent),2) as average_daily_percent From data_daily"
155,"with report_post as ( Select distinct a.post_id, action_date, action, case when r.post_id is not null then 1 else 0 end as removed_id From Actions a left outer join Removals r on a.post_id = r.post_id where a.action = 'report' and a.extra = 'spam' ), daily_percentage as ( Select avg(removed_id)*100 as daily, action_date from report_post group by action_date ) Select round(avg(daily), 2) as average_daily_percent from daily_percentage"
156,"with cte as ( select distinct action_date, post_id, action, extra from Actions ) select round(100 * avg(remove_count / total_count), 2) as 'average_daily_percent' from ( select action_date, count(a.post_id) as total_count, count(r.post_id) as remove_count from cte a left join Removals r on a.post_id = r.post_id and a.action_date <= r.remove_date where a.action = 'report' and a.extra = 'spam' group by action_date )ft"
157,"select round(avg(daily_count), 2) as average_daily_percent from (select count(distinct b.post_id)/count(distinct a.post_id)*100 as daily_count from actions a left join removals b on a.post_id = b.post_id where extra = 'spam' group by action_date ) b"
158,"with cte1 as ( select action_date, count(distinct post_id) as spam_count from actions where extra = ""spam"" group by action_date ), cte2 as ( select action_date, remove_date, count(distinct r.post_id) as remove_count from actions a left join removals r on a.post_id = r.post_id where a.extra = ""spam"" group by a.action_date ) select round(avg(remove_count/spam_count)*100,2) as average_daily_percent from cte1, cte2 where cte1.action_date = cte2.action_date "
159,"select round(100*avg(percentage),2) as average_daily_percent from ( select action_date, count(distinct Removals.post_id)/count(distinct Actions.post_id) as percentage from Actions left join Removals on Actions.post_id = Removals.post_id where Actions.extra='spam' group by action_date )a"
160,"with cte as (SELECT post_id, action_date FROM Actions WHERE action = 'report' and extra = 'spam') SELECT round(avg(pnt),2) as average_daily_percent FROM (SELECT cte.action_date, count(distinct r.post_id)*100/count(distinct cte.post_id) as pnt FROM cte LEFT JOIN Removals r ON cte.post_id = r.post_id GROUP BY cte.action_date) as a "
161,"select round(avg(perc_removed),2) as average_daily_percent from ( select action_date, count(distinct r.post_id)*100/count(distinct a.post_id) as perc_removed from actions a left join removals r on a.post_id=r.post_id where action='report' and extra='spam' group by 1 ) abc"
162,"with cte1 as ( select action_date, count(distinct post_id) as total_daily_spam from Actions where extra='spam' and action='report' group by action_date), cte2 as (select action_date, count(distinct a.post_id) as total_removal from Actions a left join Removals b on a.post_id=b.post_id where a.extra='spam' and a.action='report' and b.remove_date>a.action_date group by action_date) select round(avg(daily_avg)*100,2) as average_daily_percent from ( select (COALESCE(b.total_removal,0)/a.total_daily_spam) as daily_avg from cte1 a left join cte2 b on a.action_date=b.action_date)c "
163,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' and a.action='report' GROUP BY action_date)a"
164,"select round(avg(t.daily_ratio*100 ),2) as average_daily_percent from (select count(distinct if(post_id in (select c.post_id from Removals c) , a.post_id ,null))/count(distinct a.post_id) as daily_ratio from Actions a where a.action='report' and a.extra='spam' group by action_date ) t "
165,"with daily_removal as ( select distinct a.post_id, a.action_date, r.remove_date, (case when r.remove_date is null then 0 else 1 end) as is_removed from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam') select round(avg(t.daily_avg)*100,2) as average_daily_percent from ( select avg(is_removed) as daily_avg from daily_removal group by action_date) t "
166,"select round(sum(100 * p) / count(distinct action_date), 2) as average_daily_percent from( select A.action_date, count(distinct R.post_id) / count(distinct A.post_id) as p from Actions as A left outer join Removals as R on A.post_id = R.post_id where A.extra = 'spam' group by A.action_date) as TMP "
167,"WITH table1 AS( SELECT COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id)*100 AS pct_removed FROM Actions a LEFT JOIN Removals r USING(post_id) WHERE extra = 'spam' GROUP BY action_date ) SELECT ROUND(AVG(pct_removed),2) AS average_daily_percent FROM table1"
168,"WITH spam as (SELECT DISTINCT(post_id), action_date FROM Actions WHERE extra = 'spam') SELECT round(avg(fraction) * 100,2) as average_daily_percent FROM (SELECT sum(removal)/count(post_id) as fraction FROM (SELECT *, CASE WHEN post_id IN (SELECT post_id FROM Removals) THEN 1 ELSE 0 END AS removal FROM spam) a GROUP BY action_date) b"
169,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' GROUP BY action_date)tmp"
170,"WITH base_table AS ( SELECT action_date, SUM(IF(remove_date IS NOT NULL, 1, 0)) / COUNT(DISTINCT spam.post_id) AS ratio FROM ( SELECT action_date, post_id, action, extra FROM Actions WHERE action = ""report"" AND LOWER(extra) LIKE ""%spam%"" GROUP BY 1,2,3,4 ) AS spam LEFT JOIN Removals AS rm ON spam.post_id = rm.post_id AND spam.action_date < remove_date GROUP BY 1 ) SELECT ROUND(AVG(ratio) * 100, 2) AS average_daily_percent FROM base_table"
171,"SELECT ROUND(AVG(spamremoved/spamnum)*100, 2) as average_daily_percent FROM ( SELECT COUNT(distinct a.post_id) as spamnum, COUNT(distinct CASE WHEN remove_date IS NOT NULL THEN a.post_id ELSE NULL END) as spamremoved, action_date FROM Actions as a LEFT JOIN Removals as r ON a.post_id = r.post_id WHERE extra = 'spam' GROUP BY action_date ) as sub"
172,"with spam_tbl as ( select action_date, count(distinct post_id) as spam_count from actions where extra = ""spam"" group by action_date ), remove_tbl as ( select action_date, remove_date, count(distinct r.post_id) as remove_count from actions a left join removals r on a.post_id = r.post_id where a.extra = ""spam"" group by a.action_date ) select round(avg(remove_count/spam_count)*100,2) as average_daily_percent from spam_tbl, remove_tbl where spam_tbl.action_date = remove_tbl.action_date "
173,"with tmp as( select action_date, count(distinct post_id) as total from actions where extra = 'spam' group by action_date ), tmp2 as( select a.action_date, count(distinct r.post_id) as removals from removals as r left join actions as a on r.post_id = a.post_id and a.extra='spam' group by a.action_date ), tmp3 as ( select ifnull(removals,0)/total*100 as percent from tmp left join tmp2 on tmp.action_date = tmp2.action_date group by tmp.action_date ) select round(avg(percent),2) as average_daily_percent from tmp3 "
174,"select round(avg(removal_percent),2) as average_daily_percent from(select action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as removal_percent from actions a left join removals r on a.post_id = r.post_id where a.extra = 'spam' group by action_date)a"
175,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
176,"SELECT ROUND(AVG(pct_per_day), 2) AS average_daily_percent FROM (SELECT (IFNULL(COUNT(DISTINCT b.post_id), 0) * 100.0 / IFNULL(COUNT(DISTINCT a.post_id), 0)) AS pct_per_day FROM Actions a LEFT JOIN Removals b ON a.post_id = b.post_id WHERE extra = 'spam' GROUP BY action_date) t"
177,"SELECT ROUND(AVG(num),2) as 'average_daily_percent' FROM (SELECT (COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)) *100 as 'num' FROM Actions a LEFT JOIN Removals r ON r.post_id=a.post_id WHERE a.extra='spam' GROUP BY a.action_date) t "
178,"with temp as(SELECT DISTINCT Actions.post_id, Actions.action_date, Removals.remove_date FROM Actions LEFT JOIN Removals on Actions.post_id = Removals.post_id WHERE extra='spam') SELECT ROUND(AVG(perc)*100,2) AS average_daily_percent FROM (SELECT COUNT(remove_date)/COUNT(DISTINCT post_id) as perc FROM temp GROUP BY action_date) a"
179,"WITH temp1 AS (SELECT DISTINCT action_date, COUNT(DISTINCT post_id) AS reported_count FROM Actions WHERE action = ""report"" AND extra = ""spam"" GROUP BY action_date), temp2 AS (SELECT DISTINCT action_date, COUNT(DISTINCT post_id) AS rem_count FROM Actions WHERE action = ""report"" AND extra = ""spam"" AND (post_id IN (SELECT post_id FROM Removals)) GROUP BY action_date) SELECT ROUND(AVG(sub.daily_percent), 2) AS average_daily_percent FROM ( SELECT COALESCE( (rem_count / reported_count) * 100, 0) AS daily_percent FROM temp1 LEFT JOIN temp2 USING (action_date) ) sub"
180,"with temp as( SELECT a.post_id,a.action_date,a.extra,r.post_id as R_postid FROM actions a LEFT JOIN removals as r on a.post_id=r.post_id WHERE a.extra='spam' ), temp2 as( SELECT action_date,round(COUNT(distinct R_postid)/COUNT(distinct post_id)*100,2) as pct_remove FROM temp GROUP BY action_date ) SELECT round(sum(pct_remove)/count(distinct action_date),2) as average_daily_percent FROM temp2 "
181,"select round(avg(rate) * 100, 2) as average_daily_percent from (select (count(remove_date) / count(extra)) as rate from (select distinct Actions.post_id, action_date, extra, Removals.remove_date from Actions left join Removals on Actions.post_id = Removals.post_id where extra = 'spam') as tmp1 group by action_date) as tmp2 "
182,"with daily_pct_posts as ( select action_date, count(distinct t2.post_id)/count(distinct t1.post_id) as removal_pct from actions t1 left join removals t2 on t1.post_id = t2.post_id where t1.extra = 'spam' group by action_date ) select round(avg(removal_pct)*100,2) as average_daily_percent from daily_pct_posts "
183,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from ( select a.action_date, count(distinct r.post_id)/ count(distinct a.post_id) * 100 percent from Actions a left join Removals r on r.post_id = a.post_id where a.extra = 'spam' group by 1) temp"
184,"with A as( select action_date, count(distinct post_id) as ""spam_num"" from actions where action='report' and extra = ""spam"" group by 1 ), B as( select action_date, count(distinct post_id) as ""spam_num"" from actions where extra = ""spam"" and post_id not in (select post_id from removals) group by 1 ) select round(avg(if(B.spam_num is Null, A.spam_num,A.spam_num-B.spam_num)/A.spam_num)*100,2) as ""average_daily_percent"" from A left join B on A.action_date = B.action_date"
185,"with cte as ( select distinct Actions.post_id as A_id, action_date, Removals.post_id as R_id from Actions left join Removals on Actions.post_id = Removals.post_id where action = ""report"" and extra = ""spam"" ), cte2 as ( select action_date, count(R_id)/count(A_id) as percent from cte group by action_date ) select round(avg(percent)*100,2) as average_daily_percent from cte2"
186,"WITH label AS ( SELECT action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) AS daily_percent FROM actions AS a LEFT JOIN removals AS r ON a.post_id = r.post_id WHERE action = 'report' AND extra = 'spam' GROUP BY action_date ) SELECT ROUND(AVG(daily_percent) * 100, 2) AS average_daily_percent FROM label "
187,"select round(avg(rnk), 2) AS average_daily_percent from ( select a.action_date,(count(distinct r.post_id)/count(distinct a.post_id))*100 as rnk from actions a left join removals r on a.post_id=r.post_id where a.action='report' and a.extra='spam' group by a.action_date ) as temp"
188,"select round(avg(remove_rate)*100, 2) as average_daily_percent from (select a.action_date, sum(case when r.post_id is not null then 1 else 0 end)/count(*) as remove_rate from (select distinct action_date, post_id from actions where extra = 'spam') as a left join removals r on a.post_id = r.post_id group by a.action_date) as temp "
189,"SELECT round(avg(rate) *100,2) average_daily_percent FROM (SELECT a.action_date, count(distinct(r.post_id))/count(distinct(a.post_id)) as rate FROM Actions a LEFT JOIN Removals r ON a.post_Id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date ) temp  "
190,"select round(avg(percent_)*100,2) as average_daily_percent from (select action_date, count( distinct case when extra='spam' and post_id in (select post_id from removals) then (post_id) else null end) /count( distinct case when extra='spam' then (post_id) else null end) as percent_ from actions group by action_date)a where percent_ is not null"
191,"with cte as (select distinct action_date, Actions.post_id, case when remove_date is null then 0 else 1 end as wasRemoved from Actions LEFT JOIN Removals ON Actions.post_id = Removals.post_id where action = ""report"" and extra = 'spam') , cte2 as (select action_date, round(100*sum(wasRemoved)/count(post_id),2) as daily_percent from cte group by action_date) select round(avg(daily_percent),2) as average_daily_percent from cte2"
192,"select round(avg(cnt),2) as average_daily_percent from (select (count(distinct r.post_id) / count(distinct a.post_id))*100 as cnt from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by action_date) t"
193,"WITH spam_posts_per_day AS( SELECT post_id, action_date FROM Actions WHERE action = 'report' AND extra = 'spam' GROUP BY 1, 2 ) SELECT ROUND(SUM(temp3.percentage_per_day) / COUNT(DISTINCT temp3.action_date), 2) AS average_daily_percent FROM( SELECT temp2.action_date AS action_date, temp2.num_posts_removed / temp2.num_posts * 100 AS percentage_per_day FROM( SELECT temp.action_date AS action_date, COUNT(DISTINCT temp.post_id) AS num_posts, SUM(temp.post_removed) AS num_posts_removed FROM( SELECT s.post_id AS post_id, s.action_date AS action_date, CASE WHEN r.remove_date IS NULL THEN 0 ELSE 1 END AS post_removed FROM spam_posts_per_day s LEFT JOIN Removals r ON s.post_id = r.post_id )temp GROUP BY 1 )temp2 )temp3"
194,"WITH cte AS (SELECT action_date, COUNT(DISTINCT post_id) AS reported_spam FROM Actions WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date), cte2 AS (SELECT action_date, COUNT(DISTINCT post_id) removed_spam FROM actions JOIN removals USING (post_id) WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date) SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT COALESCE((removed_spam/reported_spam)*100,0) AS daily_percent FROM cte LEFT JOIN cte2 USING (action_date)) q "
195,"select round(avg(r)*100,2) as average_daily_percent from (select action_date, avg(case when b.post_id is null then 0 else 1 end) as r from (select distinct action_date, post_id from Actions where action = 'report' and extra='spam') a left join Removals b on a.post_id = b.post_id group by 1) k "
196,"Select Round(Avg(a.removal_percent),2) as average_daily_percent From (Select action_date, count(distinct(r.post_id))/count(distinct(a.post_id))*100 as removal_percent From Actions a Left Join Removals r on a.post_id = r. post_id WHERE a.extra='spam' GROUP BY action_date)a"
197,"select round(avg(pctg)*100,2) as average_daily_percent from (select action_date , count(distinct r.post_id)/count(distinct a.post_id ) as pctg from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by 1) t "
198,"select round(100*avg(drr.dailyremovalrate), 2) as average_daily_percent from (select sum(if(r.post_id is not null, 1, 0)) / count(*) as dailyremovalrate from (select distinct post_id, action_date from Actions where extra = 'spam') as a left join Removals r on a.post_id = r.post_id group by a.action_date) as drr "
199,"with all_table as ( select distinct Actions.post_id, action_date, extra, remove_date from Actions left join Removals on Actions.post_id = Removals.post_id) select round(avg(rate) * 100, 2) as average_daily_percent from (select (count(remove_date) / count(extra)) as rate, action_date from all_table where extra = 'spam' group by action_date) as tmp1  "
200,"select round(avg(daily_percent), 2) as average_daily_percent from (SELECT a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as daily_percent from Actions a left join Removals r on a.post_id = r.post_id WHERE a.extra='spam' group by a.action_date) tmp"
201,"select round(ifnull(avg(cnt1*100/cnt),0),2) as average_daily_percent from (select action_date, count(post_id) as cnt, count(case when remove_date is not null then post_id else null end) as cnt1 from (select distinct a.post_id, action_date, extra, r.remove_date from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam') a group by action_date) b"
202,"WITH CTE AS ( SELECT a.action_date, COUNT(DISTINCT a.post_id) AS reported_spam FROM Actions a WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ), CTE2 AS ( SELECT a.action_date, COUNT(DISTINCT a.post_id) AS removed_spam FROM Actions a JOIN removals USING (post_id) WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ) SELECT ROUND(AVG(sub.daily_percent), 2) AS average_daily_percent FROM ( SELECT COALESCE( (removed_spam / reported_spam) * 100, 0) AS daily_percent FROM CTE LEFT JOIN CTE2 USING (action_date) ) sub"
203,"select round(avg(percentage),2) as average_daily_percent from (select action_date, sum(case when remove_date is not null then 1 else 0 end) / count(1)*100 as percentage from (select distinct post_id, action_date from actions where action = 'report' and extra = 'spam')a left join removals b on a.action_date < b.remove_date and a.post_id = b.post_id group by action_date)c"
204,"select round(avg(cntr/cnt)*100,2) as average_daily_percent from (select action_date, count(distinct a.post_id) as cnt, count(distinct r.post_id) as cntr from (select action_date, post_id from Actions where action = 'report' and extra = 'spam') as a left join Removals r on a.post_id = r.post_id group by action_date) as b "
205,"select round(avg(percentage)*100, 2) as average_daily_percent from ( select action_date, count(distinct r.post_id)/count(distinct a.post_id)*1.0 as percentage from Actions a left join Removals r using (post_id) where action = 'report' and extra = 'spam' group by 1 ) a"
206,"SELECT ROUND(avg(daily_percent)*100, 2) AS average_daily_percent FROM (SELECT IFNULL(COUNT(DISTINCT R.post_id)/COUNT(DISTINCT A.post_id), 0) AS daily_percent FROM Actions A LEFT JOIN Removals R on A.post_id = R.post_id WHERE A.extra = 'spam' GROUP BY A.action_date) spammed "
207,"WITH cte AS (SELECT action_date, COUNT(DISTINCT post_id) AS reported_spam FROM Actions WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date), cte2 AS (SELECT action_date, COUNT(DISTINCT post_id) removed_spam FROM actions JOIN removals USING (post_id) WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date) SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT COALESCE((removed_spam/reported_spam)*100,0) AS daily_percent FROM cte LEFT JOIN cte2 USING (action_date)) q "
208,"Select round(avg(removal_percent),2) as average_daily_percent from ( select action_date, count(distinct r.post_id)/ count(distinct a.post_id)*100 as removal_percent from Actions a left join removals r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date)a "
209,"Select round(avg(temp.percent)*100,2) as average_daily_percent from ( select a.action_date, count(distinct r.post_id)/count(distinct a.post_id) as percent from actions a left join removals r on a.post_id = r.post_id where extra ='spam' group by 1) temp "
210,"SELECT ROUND(AVG(daily_percent)*100, 2) AS average_daily_percent FROM ( SELECT a.action_date, COALESCE(SUM(CASE WHEN remove_date IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT a.post_id), 0) AS daily_percent FROM (SELECT DISTINCT post_id, action_date, extra FROM Actions) a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra = 'spam' GROUP BY action_date) t1 "
211,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
212,"select ROUND(sum(daily_avg)/count(date)*100,2) as average_daily_percent FROM (select t.action_date as date, (count(distinct case when remove_date is not null then post_id else null end)/count(distinct post_id)) as daily_avg FROM (SELECT a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on a.post_id = r.post_id WHERE a.extra='spam') t GROUP BY t.action_date) t2"
213,"with temp as (select action_date, count(distinct post_id) as spams, count(distinct r.post_id) as rm from actions a left join removals r using (post_id) where extra ='spam' group by action_date) select round(avg(rm/spams)*100,2) as average_daily_percent from temp"
214,"select round(avg(percent), 2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
215,"with cte as (select action_date, count(distinct case when extra = 'spam' and post_id in (select post_id from removals) then post_id else null end)/ count(distinct case when extra= 'spam' then post_id else null end) as pct from actions group by 1 ) select round(avg(pct)*100,2) as average_daily_percent from cte where pct is not null"
216,"WITH temp_daily as(SELECT COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id) as daily_percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = ""spam"" GROUP BY a.action_date) SELECT ROUND(SUM(daily_percent)/COUNT(*)*100,2) as average_daily_percent FROM temp_daily"
217,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
218,"WITH daily_cte AS ( SELECT COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) AS daily_rate FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE a.extra = ""spam"" GROUP BY a.action_date ) SELECT ROUND(AVG(daily_rate) * 100, 2) AS average_daily_percent FROM daily_cte"
219,"SELECT COALESCE(ROUND(AVG(percent),2),0.00) as average_daily_percent FROM( Select a.action_date, (count(DISTINCT r.post_id)/count(DISTINCT a.post_id)) *100 as percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra='spam' GROUP BY a.action_date )a"
220,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM ( SELECT count(DISTINCT r.post_id)/count(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' group by action_date )a"
221,"with t1 as ( select post_id, action_date from Actions where extra = 'spam'), t2 as ( select distinct t1.post_id as id, t1.action_date, r.post_id as rid from t1 left join Removals r on t1.post_id = r.post_id ), t3 as ( select count(t2.rid)/count(t2.id) as percentage from t2 group by t2.action_date) select round(avg(t3.percentage)*100,2) as average_daily_percent from t3"
222,"with cte as ( select distinct Actions.post_id as A_id, action_date, Removals.post_id as R_id from Actions left join Removals on Actions.post_id = Removals.post_id where action = ""report"" and extra = ""spam"" ), cte2 as ( select action_date, sum(case when R_id is null then 0 else 1 end)/count(case when R_id is null then 0 else 1 end) as percent from cte group by action_date ) select round(avg(percent)*100,2) as average_daily_percent from cte2 "
223,"WITH t1 AS (SELECT t2.action_date , COUNT(DISTINCT t3.post_id)/count(DISTINCT t2.post_id)*100 AS percent FROM actions AS t2 LEFT JOIN removals AS t3 ON t2.post_id = t3.post_id WHERE t2.extra='spam' GROUP BY t2.action_date) SELECT ROUND(SUM(percent)/COUNT(DISTINCT action_date),2) AS average_daily_percent FROM t1 "
224,"select round(sum(percentage)/count(distinct action_date) *100, 2) as average_daily_percent from(select action_date, count(distinct case when removed_post is not null then removed_post end)/count(distinct report_post) as percentage from(select x.post_id as report_post, y.post_id as removed_post, x.action_date from(select post_id, action_date, extra from Actions where action = 'report' and extra = 'spam')x left join Removals y on x.post_id = y.post_id) y group by action_date) z"
225,"select round(avg(removed_spam),2) average_daily_percent from (select action_date, (count(distinct R.post_id) / count(distinct A.post_id)) * 100 removed_spam from Actions A LEFT JOIN Removals R on A.post_id = R.post_id WHERE A.action='report' and A.extra ='spam' group by A.action_date)A"
226,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
227,"select round(avg(average_daily_percent),2) as average_daily_percent from (select 100*count(distinct r.post_id)/count(distinct a.post_id) average_daily_percent from Actions a left join Removals r on a.post_id=r.post_id where a.extra ='spam' and a.action ='report' group by a.action_date )b"
228,"select round(avg(percent_)*100,2) as average_daily_percent from (select action_date, count( distinct case when extra='spam' and post_id in (select post_id from removals) then (post_id) else null end) /count( distinct case when extra='spam' then (post_id) else null end) as percent_ from actions group by action_date)a where percent_ is not null"
229,"select round(avg(c.per),2) as average_daily_percent from( (select count(b.remove_date)/count(distinct a.post_id) *100 as per from (select distinct post_id,action_date from Actions where action = 'report' and extra ='spam') as a left join Removals as b on a.post_id = b.post_id group by a.action_date) ) as c "
230,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
231,"SELECT ROUND(100*AVG(daily_percent), 2) average_daily_percent FROM (SELECT COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id) daily_percent, action_date FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra = 'spam' GROUP BY action_date) t"
232,"WITH CTE AS ( SELECT a.action_date, COUNT(DISTINCT a.post_id) AS reported_spam FROM Actions a WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ), CTE2 AS ( SELECT a.action_date, COUNT(DISTINCT a.post_id) AS removed_spam FROM Actions a JOIN removals USING (post_id) WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ) SELECT ROUND(AVG(sub.daily_percent), 2) AS average_daily_percent FROM ( SELECT COALESCE( (removed_spam / reported_spam) * 100, 0) AS daily_percent FROM CTE LEFT JOIN CTE2 USING (action_date) ) sub "
233,"with t as ( SELECT DISTINCT post_id, action_date FROM Actions WHERE extra = 'spam' ) SELECT ROUND(100*AVG(daily_percent),2) As 'average_daily_percent' FROM ( SELECT action_date, SUM(removed)/COUNT(post_id) As 'daily_percent' FROM ( SELECT post_id, action_date, CASE WHEN post_id IN (SELECT post_id FROM Removals) THEN 1 ELSE 0 END As 'removed' FROM t ) As t0 GROUP BY action_date ) As t2 "
234,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
235,"select round(avg(cnt), 2 ) as average_daily_percent from ( SELECT action_date, (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id where extra='spam' and action = 'report' GROUP BY action_date ) a"
236,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) sub "
237,"SELECT ROUND(AVG(remove_rate),2) AS average_daily_percent FROM (SELECT action_date ,COUNT(remove_date)/COUNT(post_id)*100 AS remove_rate FROM (SELECT DISTINCT a.post_id ,a.action_date ,r.remove_date FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam') c1 GROUP BY 1) c2 "
238,"with action_removal as (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id) as freq from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date) select round(sum(freq)*100 / count(freq),2) as average_daily_percent from action_removal"
239,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
240,"with rp as (select distinct a.post_id as post1, a.action_date, r.post_id as post2 from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' ) select round(avg(ptg),2) as average_daily_percent from (select rp.action_date, 100.00* sum(case when rp.post2 is null then 0 else 1 end)/ count(case when rp.post2 is null then 0 else 1 end) as ptg from rp group by 1) b"
241,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(distinct r.post_id)/ COUNT(distinct a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' and action = 'report' GROUP BY action_date)tmp"
242,"SELECT ROUND(AVG(daily_rate),2) AS average_daily_percent FROM (SELECT Actions.action_date, COUNT(DISTINCT Removals.post_id)*100 / COUNT(DISTINCT Actions.post_id) AS daily_rate FROM Actions LEFT JOIN Removals ON Actions.post_id= Removals.post_id WHERE Actions.action = 'report' AND extra= 'spam' GROUP BY Actions.action_date) sub"
243,"WITH C AS ( SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 AS percent FROM Actions a LEFT JOIN Removals r ON a.post_id=r.post_id WHERE a.extra='spam' GROUP BY 1 ) SELECT ROUND(AVG(percent),2) AS average_daily_percent FROM C"
244,"SELECT ROUND(AVG(c.remove_daily_percent), 2) average_daily_percent FROM ( SELECT b.action_date, COUNT(DISTINCT b.removal_post_id) * 100 / COUNT(DISTINCT b.post_id) remove_daily_percent FROM ( SELECT a.action_date, a.post_id, r.post_id removal_post_id FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' ) b GROUP BY b.action_date ) c "
245,"select ifnull(round((sum(removal_rate)/count(action_date))*100,2),0) as average_daily_percent from ( select t.action_date, count(distinct remove_post_id)/count(distinct post_id) as removal_rate from ( select a.post_id, a.action_date, r.remove_date, r.post_id as remove_post_id from actions a left join removals r on a.post_id=r.post_id where a.action='report' and a.extra='spam' ) t group by 1 ) t2 "
246,"select round(avg(rate), 2) as average_daily_percent from ( select action_date, count(distinct r.post_id) / count(distinct a.post_id) * 100 as rate from Actions a left outer join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date) a1 "
247,"with cte as ( select action_date, count(distinct b.post_id)/count(distinct a.post_id) * 100 as abs from Actions a left join Removals b on a.post_id=b.post_id where action = 'report' and extra = 'spam' group by action_date ) select round(avg(abs),2) as average_daily_percent from cte"
248,"SELECT ROUND(AVG(percentage), 2) AS average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) * 100 AS percentage FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY 1) t "
249,"with report_spam as ( select post_id, action_date from actions where action='report' and extra='spam' group by 1,2), spam_removal as ( select rs.action_date, count(rm.post_id) as removal_num from report_spam rs left join removals rm on rs.post_id=rm.post_id group by 1) select round(avg(target_value)*100,2) as average_daily_percent from ( select sr.action_date, sr.removal_num/count(rs.post_id) as target_value from report_spam rs join spam_removal sr on sr.action_date=rs.action_date group by 1) t"
250,"select round(100*avg(removed_rate), 2) as average_daily_percent from( select 1.0*count(DISTINCT CASE WHEN remove_date IS NOT NULL THEN a.post_id ELSE NULL END) / count(distinct a.post_id) as removed_rate from ( select post_id, action_date from actions where extra = ""spam"" ) a left join removals b on a.post_id = b.post_id group by action_date ) b"
251,"SELECT round(avg(prct), 2) AS average_daily_percent FROM (SELECT spammed.action_date, count(DISTINCT Removals.post_id) / count(DISTINCT spammed.post_id)*100 prct FROM Actions spammed LEFT JOIN Removals ON Removals.post_id = spammed.post_id WHERE spammed.extra = 'spam' GROUP BY 1) sub"
252,"with cte1 as ( select a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on a.post_id=r.post_id where a.extra='spam' ), cte2 as ( select (count(distinct case when remove_date is null then null else post_id end)/count(distinct post_id))*100 as daily, action_date from cte1 group by action_date ), cte3 as ( select round(sum(daily)/count(action_date),2) as average_daily_percent from cte2 ) select * from cte3 "
253,"select round(sum(percentage_daily)/count(action_date)*100,2) as average_daily_percent from (select a.action_date, (count(distinct r.post_id)/count(distinct a.post_id)) as percentage_daily from (select * from Actions where extra=""spam"") a left join Removals r on a.post_id=r.post_id group by a.action_date) b "
254,"select round(avg(percent)*100,2) as average_daily_percent from ( select action_date , count(distinct r.post_id)/count(distinct a.post_id) as percent from Actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1 ) t1"
255,"SELECT ROUND(AVG(t.num)*100,2) average_daily_percent FROM (SELECT COUNT(DISTINCT b.post_id)/COUNT(DISTINCT a.post_id) num FROM Actions a LEFT JOIN Removals b ON a.post_id=b.post_id WHERE extra=""spam"" GROUP BY action_date)t "
256,"with ta as ( select action_date, count(distinct r.post_id) rcnt ,count(distinct a.post_id) pcnt from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by 1) select round(avg((rcnt*1.0/pcnt)*100),2) as average_daily_percent from ta"
257,"with cte as ( select a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam'), cte2 as ( select action_date, (COUNT(distinct CASE WHEN remove_date is not null THEN post_id ELSE null END)/COUNT(distinct post_id)) as daily_average from cte group by action_date ) select ROUND(SUM(daily_average)/COUNT(action_date)*100,2) as average_daily_percent from cte2"
258,"SELECT ROUND(AVG(percent),2) AS average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT r.post_id)*100/COUNT(DISTINCT a.post_id) AS percent FROM (SELECT post_id, action_date FROM Actions WHERE action = 'report' AND extra = 'spam') a LEFT JOIN Removals r ON a.post_id = r.post_id GROUP BY a.action_date) tmp"
259,"with A as( select action_date, count(distinct post_id) as ""spam_num"" from actions where action='report' and extra = ""spam"" group by 1 ), B as( select action_date, count(distinct post_id) as ""spam_num"" from actions where extra = ""spam"" and post_id not in (select post_id from removals) group by 1 ) select round(avg(if(B.spam_num is Null, A.spam_num,A.spam_num-B.spam_num)/A.spam_num)*100,2) as ""average_daily_percent"" from A left join B on A.action_date = B.action_date"
260,"with daily_pct_posts as ( select action_date, count(distinct t2.post_id)/count(distinct t1.post_id) as removal_pct from actions t1 left join removals t2 on t1.post_id = t2.post_id where t1.extra = 'spam' group by action_date ) select round(avg(removal_pct)*100,2) as average_daily_percent from daily_pct_posts"
261,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
262,"SELECT ROUND(SUM(percent)/COUNT(action_date), 2) as average_daily_percent FROM ( SELECT a.action_date, (count(distinct r.post_id)/count(distinct a. post_id)) * 100 as percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date ) temp"
263,"SELECT ROUND(AVG(percent),2) as average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 as percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date) temp "
264,"SELECT ROUND(SUM(percentage) / COUNT(DISTINCT(action_date)), 2) AS average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT(r.post_id)) / COUNT(DISTINCT(a.post_id)) * 100 AS percentage FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date) t"
265,"with DailyRemoval as( select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as rate from Actions a left join Removals r on a.post_id = r.post_id where extra=""spam"" group by action_date ) select round(avg(rate), 2) as average_daily_percent from DailyRemoval "
266,"select round(avg(final_tab.percent), 2) average_daily_percent from (select t1.action_date, round((sum(case when r.post_id is not null then 1 else 0 end)/count(*))*100, 2) percent from (select distinct post_id, action_date from actions where extra = 'spam') t1 left join removals r on r.post_id = t1.post_id group by t1.action_date) final_tab "
267,"WITH spam AS ( SELECT DISTINCT A.post_id, action_date, CASE WHEN remove_date IS NOT NULL THEN 1 ELSE 0 END removed FROM Actions A LEFT JOIN Removals R ON A.post_id = R.post_id WHERE extra = 'spam'), perc_removed AS ( SELECT action_date, 100 * (SUM(removed)/ COUNT(removed)) AS percent_removed FROM spam GROUP BY action_date) SELECT ROUND(AVG(percent_removed),2) AS average_daily_percent FROM perc_removed"
268,"select round(avg(percentage)*100,2) as 'average_daily_percent' from ( select action_date, sum(case when remove_date is not null then 1 else 0 end)/count(post_id) as 'percentage' from ( select distinct action_date, a.post_id, r.remove_date from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam') as A group by action_date ) as B"
269,"with cte as (select distinct post_id, action_date from Actions where extra='spam'), result as (select 100*sum(case when b.post_id is not null then 1 else 0 end)/count(a.post_id) as percent from cte a left join removals b on a.post_id=b.post_id group by a.action_date) select round(avg(percent),2) as average_daily_percent from result "
270,"select round(avg(daily_count)*100,2) as average_daily_percent from (select count(distinct r.post_id)/count(distinct a.post_id) as daily_count from Actions a left join Removals r on a.post_id=r.post_id where extra=""spam"" group by action_date) as temp "
271,"WITH cts AS ( SELECT action_date, COUNT(distinct Actions.post_id) AS total_count, COUNT(*) AS total_simple_count, COUNT(distinct CASE WHEN Removals.remove_date is null THEN null ELSE Actions.post_id END) AS removed_count FROM Actions LEFT OUTER JOIN Removals ON Actions.post_id = Removals.post_id WHERE action='report' AND extra='spam' GROUP BY action_date ) SELECT ROUND(100.0 * AVG(removed_count / total_count), 2) AS average_daily_percent FROM cts "
272,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
273,"with s as (select a.action_date, count(distinct r.post_id) as spam, count(distinct a.post_id) as n from actions a left join removals r on a.post_id = r.post_id and a.action_date <= r.remove_date where action = 'report' and extra = 'spam' group by 1) select round(avg(spam/n*100),2) as average_daily_percent from s "
274,"SELECT ROUND(AVG(removed_rate), 2) AS average_daily_percent FROM ( SELECT action_date, COUNT(DISTINCT removals.post_id)/COUNT(DISTINCT actions.post_id)*100 AS removed_rate FROM actions LEFT JOIN removals USING(post_id) WHERE action = 'report' AND extra = 'spam' GROUP BY action_date) temp"
275,"WITH cteA AS ( SELECT post_id ,action_date ,COUNT(DISTINCT post_id) as no_spams FROM Actions WHERE extra = 'spam' AND action = 'report' GROUP BY action_date ), cteB AS ( SELECT r.post_id ,action_date ,COUNT(DISTINCT a.post_id) AS post_rem FROM Removals AS r JOIN Actions AS a ON r.post_id = a.post_id WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ) SELECT ROUND(AVG(sub.daily_percent), 2) AS average_daily_percent FROM ( SELECT COALESCE( (post_rem / cteA.no_spams) * 100, 0) AS daily_percent FROM cteA LEFT JOIN cteB USING (action_date) ) sub "
276,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp "
277,"select round(avg(d.percent),2) as average_daily_percent from (select c.action_date, count(distinct c.post_id)as removals, count(distinct c.total) as sum_total, count(distinct c.post_id)/ count(distinct c.total)*100 as percent from (select a.post_id as total, a.action_date, a.extra,b.post_id from actions a left join removals b on a.post_id=b.post_id where a.extra='spam') c group by 1 )d "
278,"select round(avg(removal_percent),2) as average_daily_percent from( select action_date, count(distinct r.post_id) /count(distinct a.post_id) * 100 as removal_percent from Actions a left join removals r using (post_id) where a.extra = 'spam' group by action_date) x "
279,"FROM (SELECT (COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id)) * 100 AS removal_percent, a.action_date FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date ) x "
280,"with cte as ( select distinct Actions.post_id as A_id, action_date, Removals.post_id as R_id from Actions left join Removals on Actions.post_id = Removals.post_id where action = ""report"" and extra = ""spam"" ), cte2 as ( select action_date, count(R_id)/count(A_id) as percent from cte group by action_date ) select round(avg(percent)*100,2) as average_daily_percent from cte2"
281,"select round(avg(removal_percent),2) as average_daily_percent from (select action_date, count(distinct r.post_id)/ count(distinct a.post_id) * 100 as removal_percent from Actions a left join Removals r on a.post_id = r.post_id where a.extra = ""spam"" group by action_date) a"
282,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
283,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' GROUP BY action_date)tmp"
284,"with cte as (select a.action_date, count(distinct r.post_id) as removals_count, count(distinct a.post_id) as spam_reports_count from actions as a left join removals as r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date) select round(avg(removals_count / spam_reports_count) * 100, 2) as average_daily_percent from cte"
285,"select round(avg(daily_percent),2) as average_daily_percent from ( select action_date, (count(distinct t2.post_id)/ count(distinct t1.post_id))*100 as daily_percent from actions t1 left join removals t2 on t1.post_id=t2.post_id where extra='spam' and action='report' group by 1 ) tbl"
286,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
287,"with tot as ( select action_date ,count(distinct(t2.post_id))/count(distinct(t1.post_id)) as rem from actions t1 left join removals t2 on t1.post_id=t2.post_id where t1.extra='spam' group by t1.action_date) select round(avg(rem)*100,2) as average_daily_percent from tot "
288,"select round(sum(percentage) / count(distinct action_date), 2) as average_daily_percent from ( select a.action_date, count(distinct r.post_id) / count(distinct a.post_id) * 100 as percentage from actions a left join removals r on r.post_id = a.post_id where a.extra = 'spam' group by 1 ) tb "
289,"select round(avg(num_removed/num_report)*100,2) as average_daily_percent from (select count(distinct post_id) as num_report, action_date, count(distinct case when post_id in (select post_id from Removals) then post_id else null end) as num_removed from Actions where action = 'report' and extra='spam' group by action_date) tmp "
290,"WITH cte AS (SELECT action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) * 100 AS per FROM Actions AS a LEFT JOIN Removals AS r USING(post_id) WHERE extra = ""spam"" GROUP BY action_date) SELECT ROUND(AVG(per), 2) AS average_daily_percent FROM cte "
291,"with b as (select distinct a.action_date, sum(if(r.post_id is not null,1,0))/count(a.action_date) as perc from (select distinct action_date, post_id, action, extra from actions) as a LEFT JOIN Removals as r ON r.post_id = a.post_id and r.remove_date >= a.action_date where action='report' and extra='spam' GROUP BY action_date) SELECT round(avg(perc)*100,2) AS average_daily_percent FROM b "
292,"with cte as ( select distinct a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on r.post_id = a.post_id where a.action = 'report' and a.extra = 'spam' ), cte2 as ( select cte.action_date, count(case when cte.remove_date is not null then 1 else null end) as delcnt, count(cte.post_id) as spmcnt from cte group by 1) select round(sum(cte2.delcnt / cte2.spmcnt)/count(cte2.action_date)*100,2) as average_daily_percent from cte2 "
293,"select round(100*avg(percentage) ,2) as average_daily_percent from ( select a.action_date, count(distinct r.post_id) / count(distinct a.post_id) as percentage from Actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by a.action_date )_"
294,"SELECT ROUND(SUM(remove_daily_percent) / COUNT(DISTINCT b.action_date), 2) average_daily_percent FROM ( SELECT a.action_date, a.post_id, COUNT(DISTINCT r.post_id) * 100 / COUNT(DISTINCT a.post_id) remove_daily_percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date ) b "
295,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
296,"WITH cte1 AS (SELECT DISTINCT action_date, post_id FROM Actions WHERE extra='spam') SELECT ROUND(AVG(daily_ratio)*100,2) AS 'average_daily_percent' FROM (SELECT action_date, SUM(removal_post_id)/COUNT(removal_post_id) as daily_ratio FROM (SELECT cte1.action_date, cte1.post_id, CASE WHEN r.post_id IS NULL THEN 0 ELSE 1 END AS removal_post_id FROM cte1 LEFT JOIN removals as r ON cte1.post_id=r.post_id ) as t1 GROUP BY action_date) as t2 "
297,"Select round(avg(removed),2) average_daily_percent from ( Select (count(distinct r.post_id)/count(distinct a.post_id))*100 removed, action_date from Actions a left join Removals r on a.post_id = r.post_id where action = 'report' and extra like 'spam' group by action_date ) temp "
298,"SELECT ROUND(AVG(rate), 2) AS average_daily_percent FROM (SELECT DISTINCT action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id)*100 AS rate FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY action_date) tmp"
299,"SELECT round(avg(ratio) * 100,2) as average_daily_percent FROM ( SELECT action_date, sum(case when remove_date is null then 0 else 1 end) / count(*) as ratio FROM ( SELECT distinct a.post_id, action_date, r.remove_date FROM Actions a Left JOIN Removals r ON a.post_id = r.post_id WHERE extra = 'spam' ) a group by 1 ) b"
300,"with cte1 as (select distinct post_id, action_date, action, extra from actions), cte2 as (select distinct post_id, remove_date from removals), cte3 as (select c1.action_date, sum(case when c2.remove_date is not null then 1 else 0 end) as removals_count, count(distinct c1.post_id) as spam_reports_count from cte1 as c1 left join cte2 as c2 on c1.post_id = c2.post_id where c1.extra = 'spam' group by c1.action_date) select round(avg(removals_count / spam_reports_count) * 100, 2) as average_daily_percent from cte3 "
301,"select round(avg(daily_percent*100),2) as average_daily_percent from (select action_date, count(distinct case when R.remove_date is not null then A.post_id else null end)/count(distinct A.post_id) as daily_percent from Actions A left join Removals R on A.post_id = R.post_id where A.action = 'report' and A.extra = 'spam' group by action_date) tbl"
302,"WITH spam_posts_per_day AS( SELECT post_id, action_date FROM Actions WHERE action = 'report' AND extra = 'spam' GROUP BY 1, 2 ) SELECT ROUND(SUM(temp3.percentage_per_day) / COUNT( temp3.action_date), 2) AS average_daily_percent FROM( SELECT temp2.action_date AS action_date, temp2.num_posts_removed / temp2.num_posts * 100 AS percentage_per_day FROM( SELECT temp.action_date AS action_date, COUNT( temp.post_id) AS num_posts, SUM(temp.post_removed) AS num_posts_removed FROM( SELECT s.post_id AS post_id, s.action_date AS action_date, CASE WHEN r.post_id IS NULL THEN 0 ELSE 1 END AS post_removed FROM spam_posts_per_day s LEFT JOIN Removals r ON s.post_id = r.post_id )temp GROUP BY 1 )temp2 )temp3"
303,"SELECT ROUND(AVG(removel_percent),2) AS average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id)*100 AS removel_percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE action = 'report' AND extra = 'spam' GROUP BY action_date) AS temp  "
304,"with cte as ( select f.post_id, f.action_date, r.post_id remove_id from ( select post_id, action_date from actions where extra = 'spam') f left join removals r on f.post_id = r.post_id and f.action_date < r.remove_date ) select round(avg(perc) * 100, 2) average_daily_percent from ( select action_date, count(distinct remove_id) / count(distinct post_id) perc from cte group by 1) cte1 "
305,"select round(100*avg(removed_rate), 2) as average_daily_percent from( select 1.0*count(DISTINCT CASE WHEN remove_date IS NOT NULL THEN a.post_id ELSE NULL END) / count(distinct a.post_id) as removed_rate from ( select post_id, action_date from actions where extra = ""spam"" ) a left join removals b on a.post_id = b.post_id group by action_date ) b"
306,"with filter_action as (SELECT post_id, extra, action_date FROM Actions WHERE extra = 'spam') SELECT ROUND(COALESCE(AVG(daily_ave) * 100,0),2) as average_daily_percent FROM (SELECT COUNT(DISTINCT(r.post_id))/COUNT(DISTINCT(f.post_id)) as daily_ave FROM filter_action f LEFT JOIN Removals r ON f.post_id = r.post_id GROUP BY action_date) tab  "
307,"with actions as (select distinct post_id, action_date, action, extra from actions), removals as (select distinct post_id, remove_date from removals), cte as (select a.action_date, sum(case when r.remove_date is not null then 1 else 0 end) as removals_count, count(a.post_id) as spam_reports_count from actions as a left join removals as r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date order by a.action_date asc) select round(avg(removals_count / spam_reports_count) * 100, 2) as average_daily_percent from cte "
308,"WITH t AS (SELECT action_date, 100* COUNT(DISTINCT Removals.post_id) / COUNT(DISTINCT post_id) AS avg_r FROM Actions LEFT JOIN Removals USING (post_id) WHERE extra = 'spam' GROUP BY action_date) SELECT ROUND(AVG(avg_r), 2) AS average_daily_percent FROM t "
309,"WITH cte1 AS ( SELECT DISTINCT action_date, post_id FROM Actions WHERE extra = 'spam' ) SELECT ROUND(AVG(daily_ratio) * 100, 2) AS 'average_daily_percent' FROM ( SELECT action_date, SUM(removal_post_id) / COUNT(removal_post_id) as daily_ratio FROM ( SELECT cte1.action_date, cte1.post_id, CASE WHEN r.post_id IS NULL THEN 0 ELSE 1 END AS removal_post_id FROM cte1 LEFT JOIN removals as r ON cte1.post_id = r.post_id ) as t1 GROUP BY action_date ) as t2"
310,"WITH total as (SELECT action_date, count(distinct post_id) AS total_count FROM Actions WHERE extra = 'spam' GROUP BY action_date), removed AS (SELECT action_date, count(distinct Removals.post_id) AS removed_count FROM Removals JOIN Actions ON Removals.post_id = Actions.post_id WHERE extra = 'spam' GROUP BY action_date) SELECT ROUND(avg(daily_percent)*100, 2) AS average_daily_percent FROM ( SELECT IFNULL(removed_count, 0)/total_count AS daily_percent FROM total LEFT JOIN removed ON total.action_date = removed.action_date GROUP BY total.action_date) t1"
311,"WITH tmp as ( SELECT t1.user_id,t1.post_id,t1.action_date,t1.action,t1.extra,t2.remove_date FROM Actions t1 LEFT JOIN Removals t2 ON t1.post_id = t2.post_id WHERE t1.action = 'report' AND t1.extra = 'spam' ) ,calc as ( SELECT action_date, COALESCE(ROUND((COUNT(DISTINCT CASE WHEN remove_date is not null THEN post_id END)/COUNT( DISTINCT post_id))*100,2),0) as percent FROM tmp GROUP BY action_date ) SELECT ROUND(SUM(percent)/COUNT(percent),2) as average_daily_percent FROM calc"
312,"select action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as removal from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1) select round(avg(removal),2) as average_daily_percent from cte "
313,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
314,"select round ( sum(dailyper)/ COUNT(action_date), 2) average_daily_percent from ( select action_date, ( count(distinct r.post_id) / count(distinct a.post_id) ) * 100 dailyper from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date ) t"
315,"with normalized_actions as ( select distinct action_date, post_id from actions where action = 'report' and extra = 'spam' ), spam_reports as ( select action_date, sum(CASE WHEN r.post_id is not null THEN 1 ELSE 0 END) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
316,"select round(avg(rate), 2) as average_daily_percent from ( select action_date, count(distinct r.post_id) / count(distinct a.post_id) * 100 as rate from Actions a left outer join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date) a1 "
317,"select Round(100*avg(sub.removals/sub.totals),2) as average_daily_percent from (select action_date, count(distinct r.post_id) as removals, count(distinct a.post_id) as totals from Actions a left join Removals r on a.post_id = r. post_id where action = 'report' and extra = 'spam' group by 1) sub "
318,"WITH c1 AS (SELECT DISTINCT post_id ,action_date FROM Actions WHERE extra = 'spam') ,c2 AS ( SELECT action_date ,SUM(CASE WHEN post_id IN (SELECT post_id FROM Removals) THEN 1 ELSE 0 END)/COUNT(post_id)*100 AS removal_rate FROM c1 GROUP BY 1) SELECT ROUND(AVG(removal_rate),2) AS average_daily_percent FROM c2"
319,"SELECT ROUND(AVG(removel_percent),2) AS average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id)*100 AS removel_percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE action = 'report' AND extra = 'spam' GROUP BY action_date) AS temp  "
320,"WITH tmp AS ( SELECT * FROM Actions WHERE action = 'report' AND extra = 'spam' ) SELECT ROUND(AVG(percent)*100,2) AS average_daily_percent FROM ( SELECT action_date, ((SUM(removed_flag)) /(SUM(reported_flag))) AS percent FROM ( SELECT A.*, COALESCE(B.removed_flag,0) as removed_flag FROM ( SELECT action_date, post_id, 1 AS reported_flag FROM tmp GROUP BY action_date, post_id )A LEFT JOIN ( SELECT *, 1 AS removed_flag FROM Removals )B ON A.post_id = B.post_id AND A.action_date <= B.remove_date )t GROUP BY action_date )tmp"
321,"select round(avg(cnt), 2 ) as average_daily_percent from ( SELECT action_date, (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id where extra='spam' and action = 'report' GROUP BY action_date ) a"
322,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
323,"WITH dactions AS (SELECT DISTINCT post_id, action_date, extra FROM Actions ), numerator AS (SELECT a.action_date, COUNT(*) as num FROM dactions a WHERE a.extra = 'spam' AND a.post_id IN (SELECT r.post_id FROM Removals r WHERE a.action_date<=r.remove_date) GROUP BY a.action_date), denominator AS (SELECT action_date, COUNT(*) as den FROM dactions WHERE extra = 'spam' GROUP BY action_date) SELECT ROUND(AVG(IFNULL(num,0)/den*100),2) AS average_daily_percent FROM denominator d LEFT JOIN numerator n ON d.action_date = n.action_date "
324,"SELECT ROUND(AVG(averageval),2) ""average_daily_percent"" FROM (SELECT action_date ,(count(distinct r.post_id)*100/ COUNT(distinct a.post_id)) AS Averageval FROM Actions a LEFT JOIN Removals r ON r.post_id=a.post_id WHERE a.action='report' AND a.extra='spam' GROUP BY Action_date)t"
325,"with vt as (SELECT ACTION_DATE, count(distinct r.post_id)/count(distinct a.post_id) as perc FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' and a.action = 'report' GROUP BY A.ACTION_DATE) select round(sum(perc)*100/count(*),2) average_daily_percent from vt "
326,"select round(sum(100 * p) / count(action_date), 2) as average_daily_percent from( select A.action_date, count(distinct R.post_id) / count(distinct A.post_id) as p from Actions as A left outer join Removals as R on A.post_id = R.post_id where A.extra = 'spam' group by A.action_date) as TMP "
327,"SELECT ROUND(AVG(daily_removal_rate), 2) average_daily_percent FROM( SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT(a.post_id)) *100 daily_removal_rate FROM Actions a LEFT JOIN Removals r ON r.post_id = a.post_id WHERE a.action = 'report' AND extra = 'spam' GROUP BY a.action_date ) tb "
328,"select round(avg(rate),2) average_daily_percent from (select action_date, 100*count(distinct b.post_id) / count(distinct a.post_id) rate from Actions a left join Removals b on a.post_id = b.post_id where action = 'report' and a.extra = 'spam' group by action_date) a"
329,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
330,"select round(avg(pct) *100,2) average_daily_percent from ( select action_date, count(distinct r.post_id)/count(distinct a.post_id) pct from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by action_date ) a"
331,"SELECT ROUND(AVG(avg_rate),2) AS average_daily_percent FROM (SELECT a.action_date, 100*COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id) AS avg_rate FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY 1) AS t"
332,"with cte1 as ( select distinct post_id, action_date from Actions where extra='spam' ), cte2 as ( select action_date, count(post_id) as spam_count from cte1 group by action_date ), cte3 as ( select a.action_date,count(a.post_id) as remove_count from cte1 a inner join Removals b on a.post_id=b.post_id group by a.action_date ) select round(avg(COALESCE(c2.remove_count, 0 )*100 /c1.spam_count),2) as average_daily_percent from cte2 c1 left join cte3 c2 on c1.action_date=c2.action_date "
333,"select round(avg(rr*100),2) as average_daily_percent from( select count(distinct r.post_id)/count(distinct a.post_id) as rr from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by action_date) t "
334,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from( select action_date, count(distinct r.post_id) / count(distinct a.post_id)*100 as percent from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam' group by action_date )b "
335,"select round(avg(r_cnt/spam_cnt*100),2) as average_daily_percent from ( select action_date, count(distinct a.post_id) as spam_cnt, count(distinct r.post_id) as r_cnt from Actions a left join Removals r on a.post_id=r.post_id where a.extra='spam' group by 1)x"
336,"WITH cte1 AS (SELECT DISTINCT action_date, post_id FROM Actions WHERE extra='spam') SELECT ROUND(AVG(daily_ratio)*100,2) AS 'average_daily_percent' FROM (SELECT action_date, SUM(removal_post_id)/COUNT(removal_post_id) as daily_ratio FROM (SELECT cte1.action_date, cte1.post_id, CASE WHEN r.post_id IS NULL THEN 0 ELSE 1 END AS removal_post_id FROM cte1 LEFT JOIN removals as r ON cte1.post_id=r.post_id ) as t1 GROUP BY action_date) as t2 "
337,"WITH cte_total_post AS ( SELECT action_date, COUNT(DISTINCT post_id) AS total_post FROM Actions WHERE extra ='spam ' GROUP BY action_date ORDER BY action_date) ,cte_remove AS ( SELECT action_date, COUNT(DISTINCT post_id) AS removed FROM (SELECT a.post_id, action_date,extra FROM Actions a INNER JOIN Removals r ON a.post_id=r.post_id WHERE extra =""spam"") AS d GROUP BY action_date ) SELECT ROUND(AVG(average_daily_percent)*100, 2) AS average_daily_percent FROM (SELECT t.action_date, COALESCE((removed/total_post),0) AS average_daily_percent FROM cte_total_post t LEFT JOIN cte_remove r ON t.action_date=r.action_date) AS d "
338,"select round(avg(ratio),2) average_daily_percent from (select action_date, (count(distinct r.post_id) / count(distinct a.post_id)) * 100 ratio from actions a left outer join removals r on a.post_id = r.post_id where extra = 'spam' group by action_date)a "
339,"select round(AVG(p)*100,2) as average_daily_percent from (select action_date, count(distinct Removals.post_id)/count(distinct Actions.post_id) as p from Actions left join Removals On Actions.post_id = Removals.post_id Where Actions.extra = ""spam"" group by action_date)temp"
340,"with cte as ( select action_date, avg(if(isnull(r.remove_date),0,1))*100 as re from (select distinct post_id, action_date, extra from actions) a left join removals r on a.post_id = r.post_id and a.extra='spam' where a.extra = 'spam' group by action_date ) select round(avg(re),2) as average_daily_percent from cte"
341,"with a as ( select action_date, a.post_id, round(count(distinct r.post_id)/count(distinct a.post_id)*100,2) as p from actions a left join removals r on a.post_id = r.post_id where a.extra = 'spam' group by 1 order by 1) select round(sum(p)/count(distinct action_date),2) as average_daily_percent from a"
342,"select round(avg(a.p)*100,2) as average_daily_percent from (Select action_date, count(distinct Removals.post_id)/count(distinct Actions.post_id) as p from Actions left join Removals on Actions.post_id=Removals.post_id where extra='spam' group by action_date) a"
343,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
344,"WITH report_spam AS ( SELECT DISTINCT post_id, action_date, post_id IN (SELECT post_id FROM Removals) AS removed FROM Actions WHERE action = 'report' AND extra = 'spam' ), daily_rate AS ( SELECT SUM(removed)/COUNT(post_id) AS daily_percent FROM report_spam GROUP BY action_date ) SELECT ROUND(AVG(daily_percent) * 100, 2) AS average_daily_percent FROM daily_rate"
345,"with temp as( select count(distinct re.post_id)/count(distinct ac.post_id)*100 as res from Actions ac left join Removals re on re.post_id=ac.post_id where ac.extra like ""spam"" group by action_date ) select round(avg(res),2) as average_daily_percent from temp "
346,"WITH cte AS (SELECT action_date, COUNT(DISTINCT post_id) AS reported_spam FROM Actions WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date), cte2 AS (SELECT action_date, COUNT(DISTINCT post_id) removed_spam FROM actions JOIN removals USING (post_id) WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date) SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT COALESCE((removed_spam/reported_spam)*100,0) AS daily_percent FROM cte LEFT JOIN cte2 USING (action_date)) q"
347,"with cte as (select a.action_date, count(distinct r.post_id) / count(distinct a.post_id) as removal_rate_per_day from Actions a left join removals r using(post_id) where action = 'report' and extra = 'spam' group by a.action_date) select round(100*avg(removal_rate_per_day),2) as average_daily_percent from cte "
348,"select round(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by 1) temp"
349,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
350,"with cte as ( select * from actions where action = 'report' and extra = 'spam' ) select round(sum(pct) / count(distinct action_date), 2) as average_daily_percent from ( select c.action_date, count(distinct r.post_id) * 100 / count(DISTINCT c.post_id) as pct from cte c left join removals r on c.post_id = r.post_id group by c.action_date ) tmp "
351,"select round(avg(perc)*100,2) as average_daily_percent from ( select a.action_date, count(distinct case when b.remove_date is not null then a.post_id end)/count(distinct a.post_id) as perc from Actions a left join Removals b on a.post_id=b.post_id where a.extra='spam' and a.action='report' group by 1 )a"
352,"select round(avg(rate), 2) average_daily_percent from (select action_date, 100*count(distinct b.post_id) / count(distinct a.post_id) rate from Actions a left join Removals b on a.post_id = b.post_id where a.action='report' and a.extra='spam' group by action_date) a "
353,"with spam_count as ( select distinct user_id, post_id, action_date from actions where extra = 'spam' ), removed_posts as ( select distinct a.user_id, r.post_id, a.action_date from removals r join actions a on a.post_id = r.post_id where a.extra = 'spam' ) select round(100 * avg(avg_pct), 2) ""average_daily_percent"" from (select s.action_date, count(distinct r.post_id) / count(distinct s.post_id) ""avg_pct"" from spam_count s left join removed_posts r on r.post_id = s.post_id and r.user_id = s.user_id group by 1 ) result_table "
354,"SELECT ROUND(AVG(percentage),2) AS average_daily_percent FROM( SELECT tem.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT tem.post_id) * 100 AS percentage FROM Removals r RIGHT JOIN ( SELECT post_id, action_date FROM Actions WHERE extra = 'spam') tem ON r.post_id = tem.post_id GROUP BY 1) tem1 "
355,"With removed as (Select distinct a.action,a.extra,a.post_id, a.action_date, case when isnull(b.remove_date)=True then 0 else 1 end as removed from Actions a left join Removals b on a.post_id=b.post_id where a.action='report' and a.extra='spam') , average as (Select action_date, avg(removed) as day from removed group by action_date) select round(avg(day)*100,2) as average_daily_percent from average"
356,"select round(avg(percent_removal),2) as average_daily_percent from (select remove_date, ( count(distinct r.post_id)/ count(distinct a.post_id)*100) as percent_removal from actions a left join removals r on r.post_id = a.post_id where a.extra = 'spam' group by action_date)a"
357,"Select round(avg(removal_percent),2) as average_daily_percent From (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a left outer JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date) a"
358,"select round(100 * avg(local_percentage), 2) as average_daily_percent from (select (sum(case when t.spam = 'T' then 1 else 0 end) / count(*) ) as local_percentage, t.action_date from (select distinct Actions.post_id, (case when remove_date is null then 'F' else 'T' end) as spam, Actions.action_date from Actions left join Removals using(post_id) where Actions.action = 'report' and Actions.extra = 'spam' ) as t group by t.action_date) as t2"
359,"select round(sum(ratio) * 100 / count(action_date),2) as average_daily_percent from ( select c.action_date, count(distinct c.r_post_id) / count(distinct c.post_id) as ratio from (select a.action_date, a.post_id, a.extra, b.post_id as r_post_id from actions a left outer join removals b on a.post_id = b.post_id where extra = 'spam') c group by c.action_date ) d"
360,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date)a"
361,"select round(sum(percent)/count(distinct action_date), 2) as average_daily_percent from (select action_date, (count(distinct r.post_id)/count(distinct a.post_id)) * 100 as percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by action_date) dsf "
362,"select round(avg(daily_percent),2) as average_daily_percent from (select count(distinct R.post_id)/count(distinct A.post_id)*100 as daily_percent from Actions as A left join Removals as R on A.post_id = R.post_id where extra = 'spam' group by action_date) as sub_table"
363,"with cte1 as ( select action_date, count(distinct post_id) as total_daily_spam from Actions where extra='spam' and action='report' group by action_date), cte2 as (select action_date, count(distinct a.post_id) as total_removal from Actions a join Removals b on a.post_id=b.post_id where a.extra='spam' and a.action='report' and b.remove_date>a.action_date group by action_date) select round(avg(daily_avg)*100,2) as average_daily_percent from ( select (COALESCE(b.total_removal,0)/a.total_daily_spam) as daily_avg from cte1 a left join cte2 b on a.action_date=b.action_date)c "
364,"with removal as ( select distinct a.post_id, a.action_date, a.extra, b.post_id as remove_id from actions as a left join removals as b on a.post_id = b.post_id and a.action_date < b.remove_date where a.extra = 'spam' ), percentage as ( select action_date, sum(case when remove_id is null then 0 else 1 end)/count(post_id)*100 as percentage from removal group by action_date ) select round(avg(percentage),2)as average_daily_percent from percentage "
365,"select round(sum(pct)/ count(action_date) ,2) as average_daily_percent from (select action_date, sum(removed_yn)/count(*)*100 as pct from (select a.post_id, a.action_date, case when b.post_id is not null then 1 else 0 end as removed_yn from (select distinct post_id, action_date, extra from Actions where extra = 'spam') a left join Removals b on a.post_id = b.post_id ) c group by action_date) d"
366,"from ( select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as daily_percent from actions a left join removals r on a.post_id=r.post_id where extra='spam' group by a.action_date ) t1 "
367,"select round(avg(removals/reported*100),2) as average_daily_percent from (select a.action_date, count(distinct a.post_id) as reported,count(distinct r.post_id) as removals from Actions a left join Removals r on a.post_id=r.post_id where a.extra='spam' group by 1) tmp"
368,"select ROUND(avg(cnt), 2) as average_daily_percent from ( select a.action_date, count(distinct r.post_id)/count(distinct a.post_id) * 100 as cnt from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date ) as tab "
369,"select round(avg(daily_count)*100,2) as average_daily_percent from (select count(distinct r.post_id)/count(distinct a.post_id) as daily_count from Actions a left join Removals r on a.post_id=r.post_id where extra=""spam"" group by action_date) as temp "
370,"select round(sum(percent)/count(distinct d),2) as average_daily_percent from (with spams as (select * from actions a where a.extra='spam') select s.action_date as d, count(distinct r.post_id)/count(distinct s.post_id)*100 as percent from spams s left join removals r on s.post_id=r.post_id group by d) temp "
371,"SELECT ROUND(AVG(perc),2) AS average_daily_percent FROM (SELECT action_date, COALESCE(COUNT(r.post_id),0)*100/COUNT(*) AS perc FROM (SELECT post_id, action_date, extra FROM Actions GROUP BY 1,2,3) a LEFT JOIN (SELECT post_id, remove_date FROM Removals GROUP BY 1,2) r ON a.post_id = r.post_id WHERE extra = 'spam' GROUP BY action_date ) sub"
372,"WITH TMP AS (SELECT distinct a.post_id, action_Date, b.post_id as rm FROM actions a LEFT JOIN removals b ON a.post_id = b.post_id WHERE extra = 'spam'), TMP2 AS (SELECT action_date, count(rm) / count(post_id) * 100 as daily_percent FROM TMP GROUP BY 1) SELECT round(AVG(daily_percent),2) average_daily_percent from tmp2 "
373,"SELECT ROUND(AVG(removal_percent),2) as average_daily_percent FROM (SELECT action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as removal_percent FROM Actions a LEFT JOIN Removals r ON a.post_id= r.post_id WHERE a.extra='spam' GROUP BY action_date) AS b"
374,"select round(sum(sum_act)/count(distinct action_date)*100,2) as average_daily_percent from (select a.action_date, count(distinct b.post_id)/count(distinct a.post_id) as sum_act from Actions a left join Removals b on a.post_id=b.post_id where extra='spam' group by 1)t "
375,"WITH total AS (SELECT action_date, COUNT(DISTINCT post_id) AS total_spam FROM Actions WHERE extra = 'spam' GROUP BY action_date ), removed AS (SELECT action_date, COUNT(DISTINCT Removals.post_id) AS removed_count FROM Actions JOIN Removals ON Actions.post_id = Removals.post_id WHERE extra='spam' AND remove_date IS NOT NULL GROUP BY action_date) SELECT ROUND(AVG(100 * IFNULL(removed.removed_count, 0) / total.total_spam), 2) AS average_daily_percent FROM removed RIGHT JOIN total ON removed.action_date = total.action_date"
376,"select round(avg(removal_percent),2) as average_daily_percent from ( select action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as removal_percent from actions a left join removals r on a.post_id = r.post_id where a.extra='spam' group by action_date)a"
377,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(CASE WHEN r.post_id is not null THEN 1 ELSE 0 END) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
378,"select round(avg(daily_percent),2) as average_daily_percent from (select round(count(distinct r.post_id)/count(distinct a.post_id)*100,2) as daily_percent from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date ) as tmp"
379,"select round(avg(b.percent),2) as average_daily_percent from (select action_date, count(distinct r.post_id) /count(distinct a.post_id)*100 as percent from Actions a left join removals r on a.post_id = r.post_id where a.extra ='spam' group by action_date) b "
380,"select round(avg(cnt),2) as average_daily_percent from( select count(distinct removals.post_id)/count(distinct actions.post_id)*100 as cnt from actions left join removals using(post_id) where extra='spam' group by action_date) as t "
381,"select round(avg(daily_percentage),2) as average_daily_percent from (select count(distinct r.post_id) * 100 / count(distinct a.post_id) as daily_percentage from Actions a left join Removals r on a.post_id = r.post_id where a.action='report' and a.extra='spam' group by a.action_date) tmp"
382,"select action_date, a.post_id as act_post_id, count(a.post_id) as actions_cnt, r.post_id as rem_post_id, count(r.post_id) as removals_cnt from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1,2) ,cte2 as( select sum(removals_cnt/actions_cnt)/count(*)*100 as daily_percent from cte group by action_date) select round(sum(daily_percent)/count(*),2) as average_daily_percent from cte2 "
383,"SELECT ROUND(AVG(daily_percentage)*100,2) as average_daily_percent FROM ( SELECT COUNT(DISTINCT CASE WHEN R.remove_date IS NOT NULL THEN A.post_id ELSE NULL END)/COUNT(DISTINCT(A.post_id)) AS daily_percentage FROM Actions as A LEFT JOIN Removals as R ON R.post_id = A.post_id WHERE extra = 'spam' GROUP BY action_date ) as SUB"
384,"SELECT ROUND(AVG(pct)*100,2) average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT b.post_id)/COUNT(DISTINCT a.post_id) pct FROM (SELECT DISTINCT action_date, post_id FROM Actions WHERE 1=1 AND action ='report' AND extra='spam' ) a LEFT JOIN Removals b ON a.post_id=b.post_id GROUP BY a.action_date)t "
385,"with cte as( select count(distinct r.post_id)/count(distinct a.post_id) as n from Actions a left join Removals r on r.post_id = a.post_id where a.extra = 'spam' group by a.action_date ) select round(avg(n)*100,2) as average_daily_percent from cte"
386,"select round(avg(daily_percentage),2) as average_daily_percent from( SELECT action_date, (Sum(CASE WHEN removal_post_id IS NULL THEN 0 ELSE 1 END) / Count(*))*100 as daily_percentage FROM (SELECT distinct a.post_id AS action_post_id, a.action_date, r.post_id AS removal_post_id FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE a.extra = 'spam') a GROUP BY 1 ) b "
387,"with main1 as ( select action_date, count(distinct post_id) as num1 from actions where extra = 'spam' and action = 'report' group by action_date ), main2 as ( select action_date, count(distinct r.post_id) as num2 from actions a join removals r on a.post_id = r.post_id where extra = 'spam' and action = 'report' group by action_date ) select round(avg(daily_perc), 2) as average_daily_percent from (select coalesce((main2.num2 / main1.num1)*100.0, 0) as daily_perc from main1 left join main2 on main1.action_date = main2.action_date) main3"
388,"with spam_tbl as ( select action_date, count(distinct post_id) as spam_count from actions where extra = ""spam"" group by action_date ), remove_tbl as ( select action_date, remove_date, count(distinct r.post_id) as remove_count from actions a left join removals r on a.post_id = r.post_id where a.extra = ""spam"" group by a.action_date ) select round(avg(remove_count/spam_count)*100,2) as average_daily_percent from spam_tbl, remove_tbl where spam_tbl.action_date = remove_tbl.action_date "
389,"with t as( select (count(distinct r.post_id)/count(distinct a.post_id))*100 as cnt from Actions a left join Removals r on a.post_id = r.post_id where a.extra = 'spam' group by a.action_date) select round(avg(cnt),2) as average_daily_percent from t  "
390,"select round(avg(daily_percent),2) as average_daily_percent from (select count(distinct t.rpost)*100/count(distinct t.apost) as daily_percent from (select a.user_id,a.action_date,a.extra,r.post_id as rpost, a.post_id as apost from Actions a left join removals r using(post_id) where extra = 'spam' ) as t group by t.action_date)t1 "
391,"with A as( select action_date, count(distinct post_id) as ""spam_num"" from actions where action='report' and extra = ""spam"" group by 1 ), B as( select action_date, count(distinct post_id) as ""spam_num"" from actions where action='report' and extra = ""spam"" and post_id not in (select post_id from removals) group by 1 ) select round(avg(if(B.spam_num is Null, A.spam_num,A.spam_num-B.spam_num)/A.spam_num)*100,2) as ""average_daily_percent"" from A left join B on A.action_date = B.action_date"
392,"with cte as ( select distinct post_id, action_date from actions where action = 'report' and extra = 'spam' ), cte2 as ( select round(count(r.post_id)/count(cte.post_id) * 100, 2) as average_daily_percent from cte left join removals r on cte.post_id = r.post_id group by cte.action_date ) select round(avg(average_daily_percent), 2) as average_daily_percent from cte2 "
393,"with cte1 as (select distinct post_id, action_date, action, extra from actions), cte2 as (select distinct post_id, remove_date from removals), cte3 as (select c1.action_date, sum(case when c2.remove_date is not null then 1 else 0 end) as removals_count, count(c1.post_id) as spam_reports_count from cte1 as c1 left join cte2 as c2 on c1.post_id = c2.post_id where c1.extra = 'spam' group by c1.action_date) select round(avg(removals_count / spam_reports_count) * 100, 2) as average_daily_percent from cte3 "
394,"WITH base_table AS ( SELECT action_date, SUM(IF(remove_date IS NOT NULL, 1, 0)) / COUNT(DISTINCT spam.post_id) AS ratio FROM (SELECT DISTINCT distinct action_date, post_id, action, extra FROM Actions WHERE action = ""report"" AND LOWER(extra) LIKE ""%spam%"") AS spam LEFT JOIN Removals AS rm ON spam.post_id = rm.post_id AND spam.action_date < remove_date GROUP BY 1 ) SELECT ROUND(AVG(ratio) * 100, 2) AS average_daily_percent FROM base_table"
395,"WITH cte AS (SELECT action_date, COUNT(DISTINCT post_id) AS reported_spam FROM Actions WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date), cte2 AS (SELECT action_date, COUNT(DISTINCT post_id) removed_spam FROM actions JOIN removals USING (post_id) WHERE ACTION = 'report' AND extra='spam' GROUP BY action_date) SELECT ROUND(AVG(daily_percent),2) AS average_daily_percent FROM (SELECT COALESCE((removed_spam/reported_spam)*100,0) AS daily_percent FROM cte LEFT JOIN cte2 USING (action_date)) q"
396,"SELECT ROUND(SUM(percent)/COUNT(DISTINCT action_date), 2) average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra='spam' GROUP BY 1) rslt "
397,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
398,"WITH CTE AS ( SELECT DISTINCT post_id, action_date, extra FROM Actions WHERE extra = 'spam' ) SELECT ROUND(avg(pct)*100,2) AS average_daily_percent FROM ( SELECT SUM(cnt)/COUNT(post_id) AS pct FROM ( SELECT *, CASE WHEN post_id in (SELECT post_id FROM Removals) THEN 1 ELSE 0 END AS cnt FROM CTE )A GROUP BY action_date )B"
399,"with cte as ( select action_date, post_id, count(distinct post_id) as cnt from actions where extra = 'spam' group by 1,2) ,cte2 as( select count(r.post_id)/sum(cnt)*100 as pct from cte left join removals r on r.post_id = cte.post_id group by action_date) select round(sum(pct)/count(pct),2) average_daily_percent from cte2"
400,"WITH spam_posts_per_day AS( SELECT post_id, action_date FROM Actions WHERE action = 'report' AND extra = 'spam' GROUP BY 1,2 ) SELECT ROUND(SUM(temp3.percentage_per_day) / COUNT( temp3.action_date), 2) AS average_daily_percent FROM( SELECT temp2.action_date AS action_date, temp2.num_posts_removed / temp2.num_posts * 100 AS percentage_per_day FROM( SELECT temp.action_date AS action_date, COUNT( temp.post_id) AS num_posts, SUM(temp.post_removed) AS num_posts_removed FROM( SELECT s.post_id AS post_id, s.action_date AS action_date, CASE WHEN r.post_id IS NULL THEN 0 ELSE 1 END AS post_removed FROM spam_posts_per_day s LEFT JOIN Removals r ON s.post_id = r.post_id )temp GROUP BY 1 )temp2 )temp3"
401,"select round(avg(perc)*100,2) as average_daily_percent from ( select a.action_date, count(distinct case when b.remove_date is not null then a.post_id end)/count(distinct a.post_id) as perc from Actions a left join Removals b on a.post_id=b.post_id where a.extra='spam' and a.action='report' group by 1 )a"
402,"WITH CTE AS ( SELECT a.action_date, COUNT(DISTINCT a.post_id) AS reported_spam FROM Actions a WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ), CTE2 AS ( SELECT a.action_date, COUNT(DISTINCT a.post_id) AS removed_spam FROM Actions a JOIN removals USING (post_id) WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ) SELECT ROUND(AVG(sub.daily_percent), 2) AS average_daily_percent FROM ( SELECT COALESCE( (removed_spam / reported_spam) * 100, 0) AS daily_percent FROM CTE LEFT JOIN CTE2 USING (action_date) ) sub "
403,"SELECT ROUND(AVG(cnt), 2) AS average_daily_percent FROM ( SELECT (COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id))*100 AS cnt FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE extra='spam' GROUP BY action_date)tmp"
404,"SELECT ROUND(SUM(cnt) / COUNT(cnt), 2) AS average_daily_percent FROM (SELECT IFNULL(ROUND(COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) * 100, 2), 0) AS cnt FROM Actions as a LEFT JOIN Removals as r ON a.post_id = r.post_id WHERE action = 'report' AND extra = 'spam' GROUP BY action_date ) AS tmp"
405,"select round(sum(removal_rate) / count(*) * 100, 2) as average_daily_percent from( select a.action_date , sum(case when r.remove_date is not null then 1 else 0 end) / count(*) as removal_rate from( select distinct post_id, action_date from actions where extra = 'spam' ) as a left join removals as r on r.post_id = a.post_id group by a.action_date ) as tmp "
406,"select round(avg(res), 2) as average_daily_percent from (select (count(distinct r.post_id) / count(distinct a.post_id))*100 as res from Actions as a left join Removals as r on a.post_id = r.post_id where extra='spam' group by action_date)tmp"
407,"with tmp as (select action_date, count(distinct r.post_id) / count(distinct a.post_id) as q from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by action_date) select round(avg(q) * 100 , 2) as average_daily_percent from tmp"
408,"SELECT ROUND( AVG(daily_percent), 2 ) AS average_daily_percent FROM( SELECT action_date, ROUND( COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100, 2) as daily_percent FROM Actions as a LEFT JOIN Removals as r ON a.post_id=r.post_id WHERE a.extra='spam' GROUP BY a.action_date ) m "
409,"with A as( select action_date, count(distinct post_id) as ""spam_num"" from actions where extra = ""spam"" group by 1 ), B as( select action_date, count(distinct post_id) as ""spam_num"" from actions where extra = ""spam"" and post_id not in (select post_id from removals) group by 1 ) select round(avg(if(B.spam_num is Null, A.spam_num,A.spam_num-B.spam_num)/A.spam_num)*100,2) as ""average_daily_percent"" from A left join B on A.action_date = B.action_date"
410,"SELECT ROUND(SUM(percent)/COUNT(DISTINCT action_date), 2) average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra='spam' GROUP BY 1) rslt "
411,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
412,"SELECT ROUND(AVG(percent),2) AS average_daily_percent FROM (SELECT a.action_date , COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id) * 100 AS percent FROM Actions As a LEFT JOIN Removals AS r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY action_date ) t "
413,"SELECT ROUND(AVG(daily_percentage), 2) AS average_daily_percent FROM ( SELECT action_date, COUNT(t2.post_id) / COUNT(t1.post_id) * 100 AS ""daily_percentage"" FROM ( SELECT DISTINCT post_id, action_date FROM Actions WHERE action = ""report"" AND extra = ""spam"" ) t1 LEFT JOIN Removals t2 ON t1.post_id = t2.post_id GROUP BY action_date )t "
414,"select round(avg(a.deleted/a.spam)*100,2) as average_daily_percent from (select b.action_date, sum(case when b.extra = 'spam' then 1 else 0 end) as spam, sum(case when b.extra = 'spam' and b.post_id in (select distinct post_id from Removals) then 1 else 0 end) as deleted from (select distinct post_id, action_date, extra from Actions) as b group by b.action_date) as a"
415,"SELECT ROUND(SUM(perc_removal) / COUNT(1), 2) average_daily_percent FROM ( SELECT a.action_date, COUNT(DISTINCT r.post_id) / COUNT(DISTINCT a.post_id) * 100 perc_removal FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra= 'spam' GROUP BY a.action_date ) t"
416,"with spam_tbl as ( select action_date, count(distinct post_id) as spam_count from actions where extra = ""spam"" group by action_date ), remove_tbl as ( select action_date, remove_date, count(distinct r.post_id) as remove_count from actions a left join removals r on a.post_id = r.post_id where a.extra = ""spam"" group by a.action_date ) select round(avg(remove_count/spam_count)*100,2) as average_daily_percent from spam_tbl, remove_tbl where spam_tbl.action_date = remove_tbl.action_date "
417,"select ROUND(AVG(davg)*100,2) as average_daily_percent from (select action_date,(count(distinct case when remove_date is not null then post_id else null end)/count(distinct post_id)) as davg from (select t1.post_id, t1.action_date, r.remove_date from (select post_id, action_date from Actions where extra=""spam"") t1 left join removals r on r.post_id = t1.post_id) t2 group by action_date) t3"
418,"select ROUND(sum(daily_avg)/count(date)*100,2) as average_daily_percent FROM (select t.action_date as date, (count(distinct case when remove_date is not null then post_id else null end)/count(distinct post_id)) as daily_avg FROM (SELECT a.post_id, a.action_date, r.remove_date from Actions a left join Removals r on a.post_id = r.post_id WHERE a.extra='spam') t GROUP BY t.action_date) t2"
419,"WITH total as (SELECT action_date, count(distinct post_id) AS total_count FROM Actions WHERE extra = 'spam' GROUP BY action_date), removed AS (SELECT action_date, count(distinct Removals.post_id) AS removed_count FROM Removals JOIN Actions ON Removals.post_id = Actions.post_id WHERE extra = 'spam' GROUP BY action_date) SELECT ROUND(avg(daily_percent)*100, 2) AS average_daily_percent FROM ( SELECT IFNULL(removed_count/total_count, 0) AS daily_percent FROM total LEFT JOIN removed ON total.action_date = removed.action_date GROUP BY total.action_date) t1 "
420,"SELECT ROUND((sum(avg_day)/count(action_date))*100,2) as average_daily_percent FROM ( SELECT action_date, COUNT(distinct case when B.remove_date is not null then a.post_id else null end)/COUNT(DISTINCT A.post_id) AS avg_day FROM Actions A LEFT JOIN Removals B ON A.post_id = B.post_id WHERE action = 'report' AND extra = 'spam' GROUP BY action_date) t "
421,"WITH t1 AS ( SELECT a.action_date, COUNT(DISTINCT r.post_id) AS cnt FROM actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date ), t2 AS ( SELECT action_date, COUNT(DISTINCT post_id) AS cnt1 FROM Actions WHERE extra = 'spam' GROUP BY action_date ) SELECT ROUND( AVG(cnt*100/cnt1), 2) AS average_daily_percent FROM t1 JOIN t2 ON t1.action_date = t2.action_date"
422,"With spam_report As (Select action_date, Count(Distinct post_id) as spam_count From Actions Where `action` = ""report"" And extra = ""spam"" Group By action_date), removal_count As (Select action_date, Count(Distinct post_id) as removal_count From Actions Where `action` = ""report"" And extra = ""spam"" And post_id in (Select post_id From Removals) Group By action_date ) Select Round(avg(ifnull(b.removal_count,0)/a.spam_count*100),2) as average_daily_percent From spam_report as a Left Join removal_count as b On a.action_date = b.action_date "
423,"select round(100*avg(cnt),2) average_daily_percent from (select count(distinct r.post_id) / count(distinct a.post_id) cnt from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' and action = 'report' group by action_date) temp "
424,"with removal_info as ( select action_date, count(distinct Actions.post_id) as spam_ct, count(distinct Removals.post_id) as removal_ct from Actions left join Removals on (Actions.post_id = Removals.post_id) where extra = ""spam"" group by 1 ) select round(avg(removal_ct * 100 / spam_ct) , 2) as average_daily_percent from removal_info"
425,"select round(avg(a1.res),2) as average_daily_percent from ( select count(distinct r1.post_id) / count(distinct t1.post_id) * 100 as res from (select post_id, action_date from actions where action=""report"" and extra=""spam"") t1 left join removals r1 on t1.post_id = r1.post_id group by t1.action_date ) a1 "
426,"select round(avg(counts)*100,2) as average_daily_percent from ( select action_date, count(r.post_id)/spam_counts as counts from (select post_id ,action_date, count(1) over (partition by action_date) as spam_counts from Actions where extra = 'spam' group by post_id, action_date) a left join removals r on r.post_id = a.post_id group by action_Date) b"
427,"Select Round(avg(percent),2) average_daily_percent From(Select action_date, (Count(distinct r.post_id)/Count(distinct a.post_id ))*100 percent From Actions a Left Join Removals r On r.post_id = a.post_id Where action = 'report' And extra = 'spam' Group by action_date) t"
428,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports"
429,"select action_date, a.post_id as act_post_id, count(a.post_id) as actions_cnt, r.post_id as rem_post_id, count(r.post_id) as removals_cnt from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1,2) ,cte2 as( select sum(removals_cnt/actions_cnt)/count(*)*100 as daily_percent from cte group by action_date) select round(sum(daily_percent)/count(*),2) as average_daily_percent from cte2 "
430,"with spam_count as ( select distinct post_id, action_date from actions where extra = 'spam' ), removed_posts as ( select distinct r.post_id, a.action_date from removals r join actions a on a.post_id = r.post_id where a.extra = 'spam' ) select round(100 * avg(avg_pct), 2) ""average_daily_percent"" from (select s.action_date, count(distinct r.post_id) / count(distinct s.post_id) ""avg_pct"" from spam_count s left join removed_posts r on r.post_id = s.post_id group by 1 ) result_table "
431,"select ROUND(sum(percent)/count(distinct action_date),2) as average_daily_percent from (select a.action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as percent from actions as a left join removals as r on a.post_id = r.post_id where a.extra = ""spam"" group by a.action_date) as temp "
432,"with normalized_actions as ( select distinct action_date, post_id, action, extra from actions ), spam_reports as ( select action_date, sum(if(r.post_id is not null, 1, 0)) / count(1) as perc_spam_reported_removed from normalized_actions a left join removals r on r.post_id = a.post_id and r.remove_date > a.action_date where action = 'report' and extra = 'spam' group by 1 ) select round(avg(perc_spam_reported_removed) * 100, 2) as average_daily_percent from spam_reports "
433,"select round(sum(pctg)/count(distinct action_date)*100,2) as average_daily_percent from (select action_date , count(distinct r.post_id)/count(distinct a.post_id ) as pctg from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by 1) t "
434,"with cte as (select action_date, cast(count(distinct a.post_id) as float) as total, cast(count(distinct r.post_id) as float) as removed from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date ) select cast(avg(removed/total) * 100 as decimal(10,2)) as average_daily_percent from cte"
435,"select round(avg(daily),2) as average_daily_percent from (select action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as daily from actions a left join removals r on a.post_id=r.post_id where extra=""spam"" group by 1)tmp"
436,"select round(avg(rate), 2) as average_daily_percent from ( select action_date, count(distinct r.post_id) / count(distinct a.post_id) * 100 as rate from Actions a left join Removals r on a.post_id = r.post_id where extra = 'spam' group by action_date) a1 "
437,"with r as ( select remove_date , post_id from removals group by remove_date, post_id ) , a as ( select post_id , action_date from actions where extra = 'spam' group by post_id, action_date ) , summary as ( select a.action_date , (count(distinct case when remove_date is not null then r.post_id else null end)/count(distinct a.post_id)) as daily_avg from a left join r on a.post_id = r.post_id group by 1 ) select round(100*avg(daily_avg),2) as average_daily_percent from summary "
438,"select action_date, count(distinct r.post_id)/count(distinct a.post_id)*100 as removal from actions a left join removals r on a.post_id = r.post_id where action = 'report' and extra = 'spam' group by 1) select round(avg(removal),2) as average_daily_percent from cte "
439,"SELECT round(SUM(percent)/count(DISTINCT action_date),2) AS average_daily_percent FROM (SELECT a.action_date,COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 AS percent FROM actions a LEFT JOIN removals r ON a.post_id = r.post_id WHERE a.extra='spam' GROUP BY action_date) temp"
440,"WITH cteA AS ( SELECT post_id ,action_date ,COUNT(DISTINCT post_id) as no_spams FROM Actions WHERE extra = 'spam' AND action = 'report' GROUP BY action_date ), cteB AS ( SELECT r.post_id ,action_date ,COUNT(DISTINCT a.post_id) AS post_rem FROM Removals AS r JOIN Actions AS a ON r.post_id = a.post_id WHERE a.action = 'report' AND a.extra = 'spam' GROUP BY a.action_date ) SELECT ROUND(AVG(sub.daily_percent), 2) AS average_daily_percent FROM ( SELECT COALESCE((post_rem / cteA.no_spams) * 100,0) AS daily_percent FROM cteA LEFT JOIN cteB USING (action_date) ) sub"
441,"select round(avg(avg_post),2)as average_daily_percent from (select action_date, COUNT(DISTINCT r.post_id)/ COUNT(DISTINCT a.post_id)*100 as avg_post from Actions a left join Removals r on a.post_id= r.post_id where a.extra='spam' group by action_date)a "
442,"with cte as (select distinct post_id,action_date from actions where extra=""spam""), tmp as ( select count(removals.post_id)/count(cte.post_id) as daily_percent from cte left join removals on cte.post_id=removals.post_id group by action_date) select round(avg(daily_percent)*100,2) as average_daily_percent from tmp "
443,"with cte as ( select a.action_date , count(distinct r.post_id)/count(distinct a.post_id) as percent from Actions a left join Removals r on a.post_id=r.post_id where a.action='report' and a.extra='spam' group by 1) select round(avg(percent)*100,2) as average_daily_percent from cte "
444,"SELECT ROUND(SUM(percent)/COUNT(DISTINCT action_date), 2) as average_daily_percent FROM ( SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 AS percent FROM Actions a LEFT JOIN Removals r ON a.post_id=r.post_id WHERE a.extra='spam' GROUP BY 1) tmp"
445,"SELECT ROUND(AVG(t.num)*100,2) average_daily_percent FROM (SELECT COUNT(DISTINCT b.post_id)/COUNT(DISTINCT a.post_id) num FROM Actions a LEFT JOIN Removals b ON a.post_id=b.post_id WHERE extra=""spam"" GROUP BY action_date)t "
446,"with x as ( select action_date, round(100*(cast(removals / spam as float)) , 2) as z from ( select action_date , count(distinct a.post_id) as spam , count(distinct r.post_id) as removals from actions a left join removals r on a.post_id = r.post_id where extra = 'spam' group by 1) l ) select round(sum(z) / count(distinct action_date) ,2) as average_daily_percent from x  "
447,"with cte as (select action_date,(count(distinct (r.post_id)))/(count(distinct (a.post_id))) as p from actions a left join removals r on a.post_id=r.post_id where extra='spam' group by a.action_date) select round((sum(p)/count(*))*100,2) as average_daily_percent from cte"
448,"with cte as (select a.action_date, round(count(distinct r.post_id)*100/count(distinct a.post_id),2) as daily from actions a left join removals r on a.post_id=r.post_id where a.action='report' and a.extra ='spam' group by a.action_date) select round(avg(daily),2) as average_daily_percent from cte"
449,"SELECT ROUND(SUM(percent)/ COUNT(*)*100,2) AS average_daily_percent FROM ( SELECT action_date, COUNT(CASE WHEN removeornot = 'removed' THEN 1 END)/ COUNT(*) AS percent FROM ( SELECT DISTINCT post_id, action_date, CASE WHEN post_id IN (SELECT post_id FROM Removals) THEN 'removed' ELSE 'not_removed' END AS removeornot FROM Actions WHERE action = 'report' AND extra = 'spam' GROUP BY 1,2 ) res1 GROUP BY 1 ) res2 "
450,"select round(avg(perc),2) as average_daily_percent from ( select 100.0*count(distinct r.post_id)/count(distinct a.post_id) as perc from Actions a left join Removals r on a.post_id = r.post_id where a.extra = ""spam"" group by a.action_date ) dp "
451,"SELECT ROUND(AVG(percent),2) as average_daily_percent FROM (SELECT a.action_date, COUNT(DISTINCT r.post_id)/COUNT(DISTINCT a.post_id)*100 as percent FROM Actions a LEFT JOIN Removals r ON a.post_id = r.post_id WHERE a.extra = 'spam' GROUP BY a.action_date) temp "
