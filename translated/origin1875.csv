id,original query
1,"SELECT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",""tab"".""rnk"" AS ""team_id"" FROM ""employees"" AS ""e1"" JOIN (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""rnk"" FROM ""employees"" AS ""e2"" GROUP BY ""salary"" HAVING COUNT(1)>1) AS ""tab"" ON ""e1"".""salary""=""tab"".""salary"" ORDER BY 4,1"
2,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
3,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
4,"WITH ""cte"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY 1 HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM ""employees"" JOIN ""cte"" USING (""salary"") ORDER BY 4,1"
5,"WITH ""t"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""s_number"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t"" WHERE ""s_number"">1 ORDER BY ""team_id"",""employee_id"""
6,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" WHERE ""cnt"">1 ORDER BY ""salary"",""employee_id"""
7,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1)"
8,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
9,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)<2) ORDER BY ""team_id"",""employee_id"""
10,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY 1 HAVING COUNT(1)=1)"
11,"WITH ""sal_cnt"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""salary"",COUNT(DISTINCT ""employee_id"") AS ""ecnt"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(DISTINCT ""employee_id"")>1) AS ""t"") SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM ""sal_cnt"" LEFT JOIN ""Employees"" AS ""e"" ON ""sal_cnt"".""salary""=""e"".""salary"" ORDER BY ""team_id"",""employee_id"""
12,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
13,"SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""Employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""employee_id""!=""e2"".""employee_id"" ORDER BY ""salary"",""employee_id"""
14,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")=1) ORDER BY 4,1"
15,"WITH ""A"" AS (SELECT * FROM ""Employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""A"" ORDER BY ""team_id"",""employee_id"""
16,"WITH ""n"" AS (SELECT *,COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""num"" FROM ""employees""), ""salary"" AS (SELECT DISTINCT ""salary"" FROM ""n"" WHERE ""num"">=2), ""team"" AS (SELECT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""salary"") SELECT ""n"".""employee_id"",""n"".""name"",""n"".""salary"",""t"".""team_id"" FROM ""n"" LEFT JOIN ""team"" AS ""t"" ON ""t"".""salary""=""n"".""salary"" WHERE ""num"">=2 ORDER BY ""t"".""team_id"",""n"".""employee_id"""
17,"WITH ""cte"" AS (SELECT ""employee_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")<2) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""cte"")"
18,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""salary"" ORDER BY ""salary"") AS ""rn"",COUNT(1) OVER (PARTITION BY ""salary"") AS ""ct"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t"" WHERE ""ct"">=2"
19,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY 4,1"
20,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
21,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"" FROM ""employees"" AS ""e1"" JOIN ""employees"" AS ""e2"" ON ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""employee_id""!=""e2"".""employee_id"") AS ""t"" ORDER BY 4,1"
22,"SELECT ""e"".*,""a"".""team_id"" FROM ""Employees"" AS ""e"" JOIN (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) AS ""a"" ON ""e"".""salary""=""a"".""salary"" ORDER BY ""team_id"",""e"".""employee_id"""
23,"SELECT DISTINCT ""employee_id"",""name"",""salary"",""team_id"" FROM (SELECT ""a"".""employee_id"" AS ""employee_id"",""a"".""name"" AS ""name"",""a"".""salary"" AS ""salary"",DENSE_RANK() OVER (ORDER BY ""a"".""salary"") AS ""team_id"" FROM ""employees"" AS ""a"" JOIN ""employees"" AS ""b"" ON ""a"".""salary""=""b"".""salary"" AND ""a"".""name""!=""b"".""name"" ORDER BY ""team_id"",""employee_id"") AS ""temp"""
24,"WITH ""salary_rank"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""rnk"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1), ""selected_members"" AS (SELECT * FROM ""Employees"" AS ""emp"" WHERE ""emp"".""salary"" IN (SELECT ""salary"" FROM ""salary_rank"")) SELECT ""employee_id"",""name"",""selected_members"".""salary"",""rnk"" AS ""team_id"" FROM ""selected_members"" LEFT JOIN ""salary_rank"" ON ""selected_members"".""salary""=""salary_rank"".""salary"" ORDER BY ""team_id"",""employee_id"""
25,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT *,COUNT(""salary"") OVER (PARTITION BY ""salary"") AS ""c"" FROM ""Employees"") AS ""a"" WHERE ""c"">1"
26,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
27,"WITH ""temp1"" AS (SELECT ""salary"",COUNT(""employee_id"") AS ""team_size"" FROM ""Employees"" GROUP BY ""salary""), ""temp2"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""temp1"" WHERE ""team_size"">1) SELECT ""e"".""employee_id"",""e"".""name"",""t"".""salary"",""t"".""team_id"" FROM ""temp2"" AS ""t"" LEFT JOIN ""Employees"" AS ""e"" ON ""t"".""salary""=""e"".""salary"" ORDER BY ""t"".""team_id"",""e"".""employee_id"""
28,"WITH ""min_sal"" AS (SELECT ""salary"",COUNT(""salary"") FROM ""Employees"" GROUP BY 1 HAVING COUNT(""salary"")>1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""min_sal"")"
29,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM (SELECT ""salary"",COUNT(""salary"") FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) AS ""sub"")"
30,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>=2) ORDER BY ""team_id"",""employee_id"""
31,"WITH ""cte"" AS (SELECT ""salary"",COUNT(1) AS ""cnt"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""cte"") ORDER BY ""team_id"",""employee_id"""
32,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
33,"WITH ""min_groups"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>=2) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""min_groups"" AS ""m"" ON (""e"".""salary""=""m"".""salary"")"
34,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1)"
35,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
36,"WITH ""min_groups"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(1) OVER (PARTITION BY ""salary"") AS ""counts"" FROM ""Employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""min_groups"" WHERE ""counts"">=2"
37,"WITH ""t1"" AS (SELECT ""salary"",COUNT(1) AS ""cnt"" FROM ""employees"" GROUP BY 1 HAVING ""cnt"">=2), ""t2"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t1"") SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM ""employees"" AS ""e"" JOIN ""t2"" ON ""e"".""salary""=""t2"".""salary"" ORDER BY 4,1"
38,"SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM (""Employees"" AS ""e"") JOIN (SELECT ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"",""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) AS ""a"" WHERE ""e"".""salary""=""a"".""salary"" ORDER BY ""team_id"",""employee_id"""
39,"WITH ""t"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""t"") ORDER BY 4,1"
40,"WITH ""temp1"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""rnk"",COUNT(""salary"") FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1 ORDER BY ""salary"") SELECT ""a"".*,""b"".""rnk"" AS ""team_id"" FROM ""employees"" AS ""a"" JOIN ""temp1"" AS ""b"" ON ""a"".""salary""=""b"".""salary"" ORDER BY ""b"".""rnk"",""a"".""employee_id"""
41,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
42,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
43,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""tt"".""tid"" AS ""team_id"" FROM ""Employees"" AS ""e"" LEFT JOIN (SELECT DENSE_RANK() OVER (ORDER BY ""salary"") AS ""tid"",""salary"" FROM (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) AS ""t"") AS ""tt"" ON ""e"".""salary""=""tt"".""salary"" WHERE ""tt"".""tid"" IS NOT NULL ORDER BY ""team_id"",""employee_id"""
44,"WITH ""t1"" AS (SELECT * FROM ""Employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t1"""
45,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(1)>=2) ORDER BY ""team_id"",""employee_id"""
46,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")<2) ORDER BY 4,""employee_id"""
47,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""e"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
48,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1)"
49,"WITH ""t"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1), ""t2"" AS (SELECT ""employee_id"",""name"",""salary"" FROM ""employees"" WHERE ""salary"" IN (SELECT * FROM ""t"")) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t2"""
50,"WITH ""t"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""s_number"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t"" WHERE ""s_number"">1 ORDER BY ""team_id"",""employee_id"""
51,"WITH ""r"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""r"".""team_id"" FROM ""employees"" AS ""e"" JOIN ""r"" ON ""r"".""salary""=""e"".""salary"" ORDER BY ""team_id"",""employee_id"""
52,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""valid_sal"".""team_id"" FROM ""employees"" AS ""e"" JOIN (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""valid_sal"" ON ""e"".""salary""=""valid_sal"".""salary"" ORDER BY ""team_id"",""employee_id"""
53,"WITH ""team"" AS (SELECT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) SELECT ""e"".""employee_id"" AS ""employee_id"",""e"".""name"" AS ""name"",""t"".""salary"" AS ""salary"",""t"".""team_id"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""team"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" ORDER BY ""t"".""team_id"",""e"".""employee_id"""
54,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"",COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""Employees"") AS ""t"" WHERE ""cnt"">1"
55,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
56,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT * FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1)) AS ""x1"""
57,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
58,"SELECT ""employee_id"",""name"",""salary"",CAST(""team_id"" AS INTEGER) AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"",CASE WHEN @""running_salary""=""salary"" THEN @""running_team_id"" ELSE @""running_team_id"":=@""running_team_id""+1 END AS ""team_id"",@""running_salary"":=""salary"" FROM (SELECT ""employee_id"",""name"",""T2"".""salary"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM ""Employees"" ORDER BY ""salary"",""employee_id"") AS ""T1"" LEFT JOIN (SELECT ""salary"" FROM (SELECT ""salary"",COUNT(""salary"") AS ""totalCount"" FROM ""Employees"" GROUP BY ""salary"") AS ""F1"" WHERE ""totalCount"">1) AS ""T2"" ON ""T1"".""salary""=""T2"".""salary"" WHERE ""T2"".""salary"" IS NOT NULL ORDER BY ""salary"",""employee_id"") AS ""FinalTable"" JOIN (SELECT @""running_salary"":=0,@""running_team_id"":=0) AS ""RunningTable"") AS ""FinalizedTable"""
59,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
60,"WITH ""group_salary"" AS (SELECT DISTINCT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) SELECT ""e"".""employee_id"" AS ""employee_id"",""e"".""name"" AS ""name"",""g"".""salary"" AS ""salary"",""g"".""team_id"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""group_salary"" AS ""g"" ON ""e"".""salary""=""g"".""salary"" ORDER BY ""g"".""team_id"",""e"".""employee_id"""
61,"WITH ""base1"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")<2), ""base2"" AS (SELECT * FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""base1"")) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""base2"""
62,"SELECT ""E"".""employee_id"",""E"".""name"",""E"".""salary"",DENSE_RANK() OVER (ORDER BY ""E"".""salary"") AS ""team_id"" FROM ""Employees"" AS ""E"" JOIN (SELECT ""salary"",COUNT(""employee_id"") AS ""employee_cnt"" FROM ""Employees"" GROUP BY 1) AS ""S"" ON ""E"".""salary""=""S"".""salary"" AND ""S"".""employee_cnt"">=2 ORDER BY ""E"".""salary"",""E"".""employee_id"""
63,"SELECT DISTINCT ""a"".""employee_id"",""a"".""name"",""a"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""a"" JOIN ""Employees"" AS ""b"" WHERE ""a"".""salary""=""b"".""salary"" AND ""a"".""employee_id""!=""b"".""employee_id"" ORDER BY 4,1"
64,"SELECT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",""tb3"".""team_id"" FROM ""employees"" AS ""e1"" JOIN (SELECT ""tb2"".""salary"",(SELECT COUNT(DISTINCT ""tb"".""salary"") FROM (SELECT ""tt"".""salary"" FROM (SELECT DISTINCT ""e_temp"".""salary"",COUNT(DISTINCT ""e_temp"".""employee_id"") AS ""n"" FROM ""employees"" AS ""e_temp"" GROUP BY 1) AS ""tt"" WHERE ""tt"".""n"">=2) AS ""tb"" WHERE ""tb"".""salary""<=""tb2"".""salary"") AS ""team_id"" FROM (SELECT DISTINCT ""tb1"".""salary"" FROM (SELECT DISTINCT ""salary"",COUNT(DISTINCT ""employee_id"") AS ""n"" FROM ""employees"" AS ""e"" GROUP BY 1) AS ""tb1"" WHERE ""tb1"".""n"">1) AS ""tb2"") AS ""tb3"" ON ""tb3"".""salary""=""e1"".""salary"" ORDER BY 4,1"
65,"SELECT ""e1"".""employee_id"",MAX(""e1"".""name"") AS ""name"",MAX(""e1"".""salary"") AS ""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""employees"" AS ""e1"") JOIN ""employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" GROUP BY ""e1"".""employee_id"" HAVING COUNT(""e1"".""employee_id"")>1 ORDER BY 4,1"
66,"WITH ""t"" AS (SELECT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"" FROM ""Employees"" AS ""e1"" WHERE ""e1"".""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1)) SELECT ""t"".""employee_id"",""t"".""name"",""t"".""salary"",DENSE_RANK() OVER (ORDER BY ""t"".""salary"") AS ""team_id"" FROM ""t"""
67,"WITH ""t"" AS (SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",COUNT(""e"".""employee_id"") OVER (PARTITION BY ""e"".""salary"") AS ""cnt"" FROM ""employees"" AS ""e"") SELECT ""t"".""employee_id"",""t"".""name"",""t"".""salary"",DENSE_RANK() OVER (ORDER BY ""t"".""salary"") AS ""team_id"" FROM ""t"" WHERE ""t"".""cnt"">=2 ORDER BY ""team_id"",""t"".""employee_id"""
68,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""a"" WHERE ""cnt"">1) AS ""b"""
69,"WITH ""grp_salary"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(1) OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""grp_salary"" WHERE ""cnt"">1"
70,"WITH ""salaries_group"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""salaries_group"") ORDER BY ""team_id"",""employee_id"""
71,"WITH ""a"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) SELECT ""e"".""employee_id"",""e"".""name"",""a"".""salary"",""a"".""team_id"" FROM ""a"" JOIN ""Employees"" AS ""e"" ON ""a"".""salary""=""e"".""salary"" ORDER BY 4,1"
72,"SELECT ""b"".""employee_id"",""b"".""name"",""b"".""salary"",DENSE_RANK() OVER (ORDER BY ""b"".""salary"") AS ""team_id"" FROM ""employees"" AS ""b"" LEFT JOIN (SELECT ""salary"",COUNT(1) AS ""cnt"" FROM ""employees"" GROUP BY ""salary"") AS ""a"" ON ""b"".""salary""=""a"".""salary"" WHERE ""a"".""cnt"">1"
73,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
74,"WITH ""teams"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""ranking"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1 ORDER BY ""salary"") SELECT ""e"".*,""ranking"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""teams"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" ORDER BY ""ranking"",""e"".""employee_id"""
75,"WITH ""DupSalaries"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""DupSalaries"") ORDER BY ""team_id"",""employee_id"""
76,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""e"".""salary"") AS ""team_id"" FROM ""employees"" AS ""e"" WHERE ""e"".""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")=1)"
77,"WITH ""s0"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY 1 HAVING COUNT(1)>1 ORDER BY 1), ""s1"" AS (SELECT ROW_NUMBER() OVER () AS ""team_id"",""salary"" FROM ""s0"") SELECT ""e"".*,""team_id"" FROM ""employees"" AS ""e"" JOIN ""s1"" USING (""salary"") ORDER BY ""team_id"",""employee_id"""
78,"WITH ""team"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(1)>=2), ""team_id"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""team"") SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""t"".""team_id"" FROM ""Employees"" AS ""e"" JOIN ""team_id"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" ORDER BY ""team_id"",""employee_id"""
79,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""a"".""employee_id"",""a"".""name"",""a"".""salary"" FROM (""Employees"" AS ""a"") JOIN ""Employees"" AS ""b"" WHERE ""a"".""salary""=""b"".""salary"" AND ""a"".""employee_id""<""b"".""employee_id"" UNION SELECT ""b"".""employee_id"",""b"".""name"",""b"".""salary"" FROM (""Employees"" AS ""a"") JOIN ""Employees"" AS ""b"" WHERE ""a"".""salary""=""b"".""salary"" AND ""a"".""employee_id""<""b"".""employee_id"") AS ""temp1"""
80,"WITH ""cte"" AS (SELECT ""salary"",COUNT(1) FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1), ""cte2"" AS (SELECT ""employee_id"",""name"",""a"".""salary"" FROM ""Employees"" AS ""a"" JOIN ""cte"" AS ""b"" WHERE ""a"".""salary""=""b"".""salary"") SELECT ""a"".*,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte2"" AS ""a"""
81,"SELECT DISTINCT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""Employees"" AS ""e2"" USING (""salary"") WHERE ""e"".""employee_id""!=""e2"".""employee_id"" ORDER BY ""team_id"",""employee_id"""
82,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""SALARY"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) ORDER BY ""team_id"",""employee_id"""
83,"WITH ""CTE"" AS (SELECT ""name"",""salary"" FROM ""Employees"" GROUP BY ""Salary"" HAVING COUNT(1)=1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""CTE"") ORDER BY ""team_id"",""employee_id"""
84,"SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""name""!=""e2"".""name"" ORDER BY DENSE_RANK() OVER (ORDER BY ""e1"".""salary""),""e1"".""employee_id"""
85,"WITH ""cte"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""cte"".""salary"",DENSE_RANK() OVER (ORDER BY ""cte"".""salary"") AS ""team_id"" FROM ""Employees"" AS ""e"" LEFT JOIN ""cte"" ON ""e"".""salary""=""cte"".""salary"" WHERE ""cte"".""salary"" IS NOT NULL ORDER BY ""salary"",""employee_id"""
86,"WITH ""CTE"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""team_id"") AS ""cnt"" FROM (SELECT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM ""Employees"" AS ""e1"" JOIN ""Employees"" AS ""e2"" ON ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""employee_id""!=""e2"".""employee_id"" ORDER BY ""team_id"",""e1"".""employee_id"") AS ""sub"") SELECT DISTINCT ""employee_id"",""name"",""salary"",""team_id"" FROM ""CTE"" WHERE ""cnt"">=2"
87,"WITH ""t"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1), ""t2"" AS (SELECT ""employee_id"",""name"",""salary"" FROM ""employees"" WHERE ""salary"" IN (SELECT * FROM ""t"")) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t2"""
88,"WITH ""base1"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")<2), ""base2"" AS (SELECT * FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""base1"")) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""base2"""
89,"SELECT ""e"".*,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" AS ""e"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" AS ""e"" GROUP BY ""salary"" HAVING COUNT(""salary"")<2) ORDER BY ""team_id"",""employee_id"""
90,"WITH ""cte"" AS (SELECT * FROM ""employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" ORDER BY ""team_id"",""employee_id"""
91,"WITH ""cte"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY 1 HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM ""employees"" JOIN ""cte"" USING (""salary"") ORDER BY 4,1"
92,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""s"" FROM ""Employees"") AS ""a"" WHERE ""s"">1 ORDER BY ""team_id"",""employee_id"""
93,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""salary"",CASE WHEN (COUNT(""employee_id"") OVER (PARTITION BY ""salary""))>=2 THEN 1 ELSE 0 END AS ""team"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" WHERE ""team""=1"
94,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
95,"WITH ""s"" AS (SELECT ""salary"",COUNT(DISTINCT ""employee_id"") AS ""employee_cnt"" FROM ""Employees"" GROUP BY ""salary"" HAVING ""employee_cnt"">1) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""s"" LEFT JOIN ""Employees"" AS ""e"" ON ""e"".""salary""=""s"".""salary"" ORDER BY ""team_id"",""e"".""employee_id"""
96,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) ORDER BY ""team_id"",""employee_id"""
97,"WITH ""t1"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""a"".*,DENSE_RANK() OVER (ORDER BY ""a"".""salary"") AS ""team_id"" FROM ""employees"" AS ""a"" RIGHT JOIN ""t1"" ON ""a"".""salary""=""t1"".""salary"" ORDER BY ""team_id"",""employee_id"""
98,"WITH ""test"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""cc"",COUNT(""salary"") OVER (PARTITION BY ""salary"") AS ""mm"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""test"" WHERE ""mm"">1"
99,"SELECT DISTINCT ""a"".""employee_id"",""a"".""name"",""a"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""a"" JOIN ""Employees"" AS ""b"" ON ""a"".""employee_id""!=""b"".""employee_id"" AND ""a"".""salary""=""b"".""salary"" ORDER BY 4,1"
100,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
101,"WITH ""S0"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1), ""S1"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"",""salary"" FROM ""S0"") SELECT ""employee_id"",""name"",""S1"".""salary"",""team_id"" FROM ""Employees"" JOIN ""S1"" ON ""Employees"".""salary""=""S1"".""salary"" ORDER BY ""team_id"",""employee_id"""
102,"SELECT *,DENSE_RANK() OVER (ORDER BY ""SALARY"") AS ""TEAM_ID"" FROM ""EMPLOYEES"" WHERE ""SALARY"" NOT IN (SELECT ""SALARY"" FROM ""EMPLOYEES"" GROUP BY ""SALARY"" HAVING COUNT(1)=1) ORDER BY ""TEAM_ID"",""EMPLOYEE_ID"""
103,"WITH ""t1"" (""salary"") AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)<2), ""t2"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""t1"")) SELECT * FROM ""t2"" ORDER BY ""team_id"",""employee_id"""
104,"WITH ""CTE"" AS (SELECT ""name"",""salary"" FROM ""Employees"" GROUP BY ""Salary"" HAVING COUNT(1)=1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""CTE"") ORDER BY ""team_id"",""employee_id"""
105,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT * FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM (SELECT ""salary"",COUNT(1) AS ""cn"" FROM ""Employees"" GROUP BY 1) AS ""t1"" WHERE ""cn""=1)) AS ""t2"" ORDER BY ""team_id"",""employee_id"""
106,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) ORDER BY ""team_id"",""employee_id"""
107,"WITH ""cte"" AS (SELECT ""e"".""salary"" FROM ""Employees"" AS ""e"" GROUP BY ""e"".""salary"" HAVING COUNT(1)>1) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""e"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""cte"")"
108,"SELECT ""employee_id"",""name"",""a"".""salary"",""team_id"" FROM ""Employees"" AS ""a"" JOIN (SELECT ""salary"",CAST(@""rank"":=@""rank""+1 AS INTEGER) AS ""team_id"" FROM (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1 ORDER BY ""salary"") AS ""c"" JOIN (SELECT @""rank"":=0) AS ""d"") AS ""b"" ON ""a"".""salary""=""b"".""salary"" ORDER BY ""team_id"",""employee_id"""
109,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY 4,1"
110,"WITH ""a"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""rnk"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>=2) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""a"".""rnk"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""a"" ON ""a"".""salary""=""e"".""salary"" ORDER BY ""team_id"",""employee_id"""
111,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary""=ANY (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>=2) ORDER BY ""team_id"",""employee_id"""
112,"WITH ""tmp"" AS (SELECT * FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1)) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""tmp"" ORDER BY ""team_id"",1"
113,"WITH ""s"" AS (SELECT ""salary"",ROW_NUMBER() OVER (PARTITION BY ""salary"") AS ""sal_count"" FROM ""Employees""), ""smult"" AS (SELECT DISTINCT (""salary"") AS ""salary"" FROM ""s"" WHERE ""sal_count"">1) SELECT ""e"".""employee_id"",""e"".""name"",""smult"".""salary"",DENSE_RANK() OVER (ORDER BY ""smult"".""salary"") AS ""team_id"" FROM ""smult"" LEFT JOIN ""Employees"" AS ""e"" ON ""e"".""salary""=""smult"".""salary"" ORDER BY ""team_id"",""employee_id"""
114,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
115,"SELECT ""employee_id"",""name"",""b"".""salary"",""team_id"" FROM ""employees"" AS ""a"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""b"" ON ""a"".""salary""=""b"".""salary"" ORDER BY ""team_id"",""employee_id"""
116,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
117,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
118,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM (SELECT ""salary"",COUNT(DISTINCT ""employee_id"") AS ""cnt"" FROM ""Employees"" GROUP BY ""salary"") AS ""t"" WHERE ""cnt"">=2) ORDER BY ""team_id"",""employee_id"""
119,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
120,"SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM (SELECT ""s2"".""employee_id"",""s2"".""name"",""s2"".""salary"",CONVERT(CASE WHEN ""s2"".""salary""=@""prevsal"" THEN @""id"":=@""id"" ELSE @""id"":=@""id""+1 END, INTEGER) AS ""team_id"",@""prevsal"":=""s2"".""salary"" FROM (SELECT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"" FROM ""Employees"" AS ""e1"" LEFT JOIN (SELECT ""salary"",COUNT(""employee_id"") AS ""groupcount"" FROM ""Employees"" GROUP BY ""salary"") AS ""s1"" ON ""s1"".""salary""=""e1"".""salary"" WHERE ""s1"".""groupcount"">1 ORDER BY ""e1"".""salary"",""e1"".""employee_id"") AS ""s2"" JOIN (SELECT @""id"":=0,@""prevsal"":=-1) AS ""s3"") AS ""s4"""
121,"WITH ""unique_num"" AS (SELECT ""salary"",COUNT(""employee_id"") FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""unique_num"") ORDER BY 4,1"
122,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)"
123,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""e1"".""team_id"" FROM ""employees"" AS ""e"" JOIN (SELECT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(DISTINCT ""employee_id"")>1) AS ""e1"" ON ""e"".""salary""=""e1"".""salary"" ORDER BY ""e1"".""team_id"",""e"".""employee_id"""
124,"SELECT ""employee_id"",""name"",""employees"".""salary"",""team_id"" FROM ""employees"" RIGHT JOIN (SELECT RANK() OVER (ORDER BY ""salary"") AS ""team_id"",""salary"",COUNT(""employee_id"") AS ""cnt"" FROM ""Employees"" GROUP BY ""salary"" HAVING ""cnt"">1) AS ""a"" ON ""employees"".""salary""=""a"".""salary"" ORDER BY ""team_id"",""employee_id"""
125,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)) SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM ""cte"" ORDER BY ""team_id"",""employee_id"""
126,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" AS ""e"" WHERE ""e"".""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) ORDER BY ""team_id"",""employee_id"""
127,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""tmp"".""team_id"" FROM ""Employees"" AS ""e"" RIGHT JOIN (SELECT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""name"")>1) AS ""tmp"" ON ""e"".""salary""=""tmp"".""salary"" ORDER BY ""team_id"",""employee_id"""
128,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
129,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""e1"".* FROM ""Employees"" AS ""e1"" JOIN (SELECT ""salary"",COUNT(""employee_id"") FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""tbl"" ON ""e1"".""salary""=""tbl"".""salary"") AS ""tbl2"""
130,"WITH ""t"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""ct"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t"" WHERE ""ct"">=2"
131,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)"
132,"WITH ""t"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1), ""t2"" AS (SELECT ""employee_id"",""name"",""salary"" FROM ""employees"" WHERE ""salary"" IN (SELECT * FROM ""t"")) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t2"""
133,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""a"" WHERE ""cnt"">1) AS ""b"""
134,"WITH ""employee_rank"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" AS ""e"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""er"".""team_id"" FROM ""employee_rank"" AS ""er"" JOIN ""Employees"" AS ""e"" ON ""er"".""salary""=""e"".""salary"" ORDER BY ""team_id"",""employee_id"""
135,"WITH ""cte"" AS (SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"" FROM ""employees"" AS ""e"" JOIN ""employees"" AS ""e1"" ON ""e"".""salary""=""e1"".""salary"" AND ""e"".""name""!=""e1"".""name"") SELECT DISTINCT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" ORDER BY ""salary"",""employee_id"""
136,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk1"" FROM ""Employees""), ""cte2"" AS (SELECT ""rnk1"",COUNT(""rnk1"") AS ""ctrk"" FROM ""cte1"" GROUP BY ""rnk1""), ""cte3"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte1"" WHERE ""cte1"".""rnk1"" IN (SELECT ""rnk1"" FROM ""cte2"" WHERE ""ctrk"">1)) SELECT * FROM ""cte3"""
137,"SELECT ""employee_id"",""name"",""salary"",""rnk"" AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk"" FROM (SELECT ""employee_id"",""name"",""salary"",COUNT(""name"") OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""a"" WHERE ""cnt"">1) AS ""b"""
138,"SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""Employees"" AS ""e2"" WHERE ""e1"".""employee_id""!=""e2"".""employee_id"" AND ""e1"".""salary""=""e2"".""salary"" ORDER BY 4,1"
139,"WITH ""SALARY"" AS (SELECT ""e"".""salary"" FROM ""Employees"" AS ""e"" GROUP BY ""e"".""salary"" HAVING COUNT(1)>1), ""RANKS"" AS (SELECT ""s1"".""salary"",COUNT(1) AS ""rank"" FROM (""SALARY"" AS ""s1"") JOIN ""SALARY"" AS ""s2"" WHERE ""s1"".""salary"">=""s2"".""salary"" GROUP BY ""s1"".""salary"") SELECT ""e"".*,""r"".""rank"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""RANKS"" AS ""r"" ON ""e"".""salary""=""r"".""salary"" ORDER BY ""team_id"",""e"".""employee_id"""
140,"WITH ""salaries"" AS (SELECT ""e"".""salary"",COUNT(1) FROM ""employees"" AS ""e"" JOIN ""employees"" AS ""e1"" ON ""e"".""employee_id""!=""e1"".""employee_id"" AND ""e"".""salary""=""e1"".""salary"" GROUP BY ""e"".""salary"" HAVING COUNT(1)>=2) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""s"".""salary"") AS ""team_id"" FROM ""employees"" AS ""e"" JOIN ""salaries"" AS ""s"" ON ""e"".""salary""=""s"".""salary"" ORDER BY ""team_id"",""e"".""employee_id"""
141,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
142,"SELECT ""employees"".""employee_id"",""employees"".""name"",""employees"".""salary"",""distinctSalaryWithTeam"".""team_id"" FROM ""Employees"" JOIN (SELECT ""dSalary"",@""curRow"":=@""curRow""+1 AS ""team_id"" FROM (SELECT ""salary"" AS ""dSalary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1 ORDER BY ""dSalary"") AS ""distinctSalary"" JOIN (SELECT @""curRow"":=0) AS ""r"") AS ""distinctSalaryWithTeam"" ON ""Employees"".""salary""=""distinctSalaryWithTeam"".""dSalary"" ORDER BY ""salary"",""employee_id"""
143,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""a"" WHERE ""cnt"">1) AS ""b"""
144,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" AS ""e1"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) ORDER BY ""team_id"",""employee_id"""
145,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)"
146,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""salary"" ORDER BY ""salary"") AS ""sal_rank"" FROM ""Employees""), ""teams"" AS (SELECT ""salary"",COUNT(""employee_id"") AS ""num"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(""employee_id"")>1), ""ordered"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""rn"" FROM ""teams"") SELECT ""employee_id"",""name"",""t"".""salary"",""rn"" AS ""team_id"" FROM ""cte"" AS ""e"" JOIN ""ordered"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" WHERE ""sal_rank""=1 ORDER BY ""team_id"",""employee_id"""
147,"SELECT ""employee_id"",""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""e"".""salary"") AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) AS ""filter_tmp"" ON ""e"".""salary""=""filter_tmp"".""salary"" ORDER BY ""team_id"",""employee_id"""
148,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""salary"" FROM ""Employees"" AS ""e"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" AS ""e1"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2)) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"""
149,"WITH ""ranked_sal"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""r"".""team_id"" FROM ""ranked_sal"" AS ""r"" JOIN ""employees"" AS ""e"" ON ""r"".""salary""=""e"".""salary"" ORDER BY ""team_id"",""employee_id"""
150,"SELECT DISTINCT ""a"".""employee_id"",""a"".""name"",""a"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" AS ""a"" JOIN ""Employees"" AS ""b"" WHERE ""a"".""salary""=""b"".""salary"" AND ""a"".""employee_id""!=""b"".""employee_id"" ORDER BY 4,1"
151,"WITH ""Table1"" AS (SELECT ""salary"",COUNT(1) FROM ""Employees"" GROUP BY 1 HAVING COUNT(1)>1) SELECT * FROM (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""Salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Table1"")) AS ""t"" ORDER BY ""team_id"",""employee_id"""
152,"WITH ""temp1"" AS (SELECT ""salary"",COUNT(""employee_id"") AS ""num_of_emp"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2), ""temp2"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""temp1"") SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM ""Employees"" AS ""e"" JOIN ""temp2"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" ORDER BY ""team_id"",""employee_id"""
153,"SELECT * FROM (SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""name""!=""e2"".""name"") AS ""a"" ORDER BY ""team_id"",""employee_id"""
154,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) ORDER BY 4,1"
155,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk1"" FROM ""Employees""), ""cte2"" AS (SELECT ""rnk1"",COUNT(""rnk1"") AS ""ctrk"" FROM ""cte1"" GROUP BY ""rnk1""), ""cte3"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte1"" WHERE ""cte1"".""rnk1"" IN (SELECT ""rnk1"" FROM ""cte2"" WHERE ""ctrk"">1)) SELECT * FROM ""cte3"""
156,"WITH ""EE2"" AS (SELECT ""team_num"",""employee_id"",""name"",""salary"" FROM (SELECT COUNT(""name"") OVER ""w"" AS ""team_num"",""employee_id"",""name"",""salary"" FROM ""Employees"" WINDOW ""w"" AS (PARTITION BY ""salary"")) AS ""EE"" WHERE ""team_num"">1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""EE2"" ORDER BY ""team_id"",""employee_id"""
157,"WITH ""sals"" AS (SELECT ""salary"",COUNT(1) AS ""total"" FROM ""Employees"" GROUP BY ""salary""), ""rsal"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""sals"" WHERE ""total"">1) SELECT ""employee_id"",""name"",""rsal"".""salary"",""team_id"" FROM ""rsal"" LEFT JOIN ""Employees"" ON ""rsal"".""salary""=""Employees"".""salary"" ORDER BY ""team_id"",""employee_id"""
158,"SELECT ""a"".""employee_id"",""a"".""name"",""a"".""salary"",DENSE_RANK() OVER (ORDER BY ""a"".""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")=1)) AS ""a"""
159,"SELECT ""employee_id"",""NAME"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT *,COUNT(""grp"") OVER (PARTITION BY ""grp"") AS ""cnt"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""grp"" FROM ""employees"") AS ""a"") AS ""b"" WHERE ""cnt"">1 ORDER BY 4,1"
160,"SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT * FROM (SELECT ""employee_id"",""name"",""salary"",COUNT(""salary"") OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""f1"" WHERE ""cnt"">=2) AS ""f2"") AS ""f3"" ORDER BY ""team_id"",""employee_id"""
161,"SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM ""Employees"" AS ""e"" JOIN (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) AS ""temp"" ON ""e"".""salary""=""temp"".""salary"" ORDER BY ""team_id"",""employee_id"""
162,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
163,"SELECT ""e"".""employee_id"" AS ""employee_id"",""e"".""name"" AS ""name"",""s"".""salary"" AS ""salary"",""s"".""team_id"" AS ""team_id"" FROM (SELECT ""s1"".""salary"" AS ""salary"",COALESCE(COUNT(""s2"".""salary""), 0)+1 AS ""team_id"" FROM (SELECT DISTINCT ""e1"".""salary"" FROM ""Employees"" AS ""e1"" JOIN ""Employees"" AS ""e2"" ON (""e1"".""salary""=""e2"".""salary"" AND ""e1"".""employee_id""<""e2"".""employee_id"")) AS ""s1"" LEFT JOIN (SELECT DISTINCT ""e1"".""salary"" FROM ""Employees"" AS ""e1"" JOIN ""Employees"" AS ""e2"" ON (""e1"".""salary""=""e2"".""salary"" AND ""e1"".""employee_id""<""e2"".""employee_id"")) AS ""s2"" ON (""s1"".""salary"">""s2"".""salary"") GROUP BY ""s1"".""salary"") AS ""s"" JOIN ""Employees"" AS ""e"" ON (""s"".""salary""=""e"".""salary"") ORDER BY 3,1"
164,"WITH ""salary_level"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(""name"")>=2) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT * FROM ""salary_level"") ORDER BY 4,1"
165,"WITH ""filtered"" AS (SELECT * FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1)) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""filtered"" ORDER BY ""team_id"",""employee_id"""
166,"SELECT ""e"".*,""team_id"" FROM ""employees"" AS ""e"" JOIN (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) AS ""a"" ON ""e"".""salary""=""a"".""salary"" ORDER BY ""team_id"",""employee_id"""
167,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) ORDER BY ""salary"",""employee_id"""
168,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""sal_cnt"" FROM ""Employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" WHERE ""sal_cnt"">=2 ORDER BY ""team_id"",""employee_id"""
169,"WITH ""eligible_salaries"" AS (SELECT DISTINCT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1) SELECT ""employee_id"",""name"",""t1"".""salary"",""team_id"" FROM ""eligible_salaries"" AS ""t1"" JOIN ""Employees"" AS ""t2"" ON ""t1"".""salary""=""t2"".""salary"" ORDER BY ""team_id"",""employee_id"""
170,"WITH ""teams"" AS (SELECT ""employee_id"",""name"",""salary"" FROM ""employees"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""teams"""
171,"WITH ""main"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""num_emp"" FROM ""Employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""main"" WHERE ""num_emp"">1 ORDER BY ""team_id"",""employee_id"""
172,"WITH ""sql1"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""Employee_equal_sal"" FROM ""Employees""), ""sql2"" AS (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""sql1"" WHERE ""Employee_equal_sal"">=2) SELECT * FROM ""sql2"" ORDER BY ""team_id"",""employee_id"""
173,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1)) SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM ""cte"" ORDER BY ""team_id"",""employee_id"""
174,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",DENSE_RANK() OVER (ORDER BY ""e"".""salary"") AS ""team_id"" FROM ""employees"" AS ""e"" JOIN (SELECT ""salary"",COUNT(""salary"") AS ""count_emp"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) AS ""t"" ON ""e"".""salary""=""t"".""salary"""
175,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
176,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""a"" WHERE ""cnt"">1) AS ""b"""
177,"SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""name""!=""e2"".""name"" ORDER BY DENSE_RANK() OVER (ORDER BY ""e1"".""salary""),""e1"".""employee_id"""
178,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"",COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""team_size"" FROM ""employees"") AS ""tmp"" WHERE ""tmp"".""team_size"">1 ORDER BY ""team_id"",""employee_id"""
179,"SELECT * FROM (SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""name""!=""e2"".""name"") AS ""a"" ORDER BY ""team_id"",""employee_id"""
180,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk1"" FROM ""Employees""), ""cte2"" AS (SELECT ""rnk1"",COUNT(""rnk1"") AS ""ctrk"" FROM ""cte1"" GROUP BY ""rnk1""), ""cte3"" AS (SELECT ""employee_id"",""name"",""salary"" FROM ""cte1"" WHERE ""cte1"".""rnk1"" IN (SELECT ""rnk1"" FROM ""cte2"" WHERE ""ctrk"">1)) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte3"""
181,"WITH ""cte"" AS (SELECT * FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1)) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"""
182,"WITH ""cte"" AS (SELECT ""employee_id"",""name"",""a"".""salary"" FROM ""Employees"" AS ""a"" RIGHT JOIN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) AS ""b"" ON ""a"".""salary""=""b"".""salary"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" ORDER BY ""team_id"",""employee_id"""
183,"WITH ""t1"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1), ""t2"" AS (SELECT ""a"".* FROM ""t1"" LEFT JOIN ""employees"" AS ""a"" ON ""t1"".""salary""=""a"".""salary"") SELECT ""t2"".*,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t2"" ORDER BY ""team_id"",""employee_id"""
184,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")=1)"
185,"WITH ""min_groups"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(1) OVER (PARTITION BY ""salary"") AS ""counts"" FROM ""Employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""min_groups"" WHERE ""counts"">=2"
186,"WITH ""a"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1 ORDER BY ""salary"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""a"")"
187,"WITH ""emp_sal_count"" AS (SELECT ""salary"",COUNT(1) AS ""n"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>=2), ""teams"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""emp_sal_count"") SELECT ""employee_id"",""name"",""employees"".""salary"",""team_id"" FROM ""employees"" JOIN ""teams"" ON ""teams"".""salary""=""employees"".""salary"" ORDER BY ""team_id"",""employee_id"""
188,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""employees"" GROUP BY 1 HAVING COUNT(1)=1)"
189,"WITH ""SALARY"" AS (SELECT ""e"".""salary"" FROM ""Employees"" AS ""e"" GROUP BY ""e"".""salary"" HAVING COUNT(1)>1), ""RANKS"" AS (SELECT ""s1"".""salary"",COUNT(1) AS ""rank"" FROM (""SALARY"" AS ""s1"") JOIN ""SALARY"" AS ""s2"" WHERE ""s1"".""salary"">=""s2"".""salary"" GROUP BY ""s1"".""salary"") SELECT ""e"".*,""r"".""rank"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN ""RANKS"" AS ""r"" ON ""e"".""salary""=""r"".""salary"" ORDER BY ""team_id"",""e"".""employee_id"""
190,"WITH ""t"" AS (SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",COUNT(""e"".""employee_id"") OVER (PARTITION BY ""e"".""salary"") AS ""cnt"" FROM ""employees"" AS ""e"") SELECT ""t"".""employee_id"",""t"".""name"",""t"".""salary"",DENSE_RANK() OVER (ORDER BY ""t"".""salary"") AS ""team_id"" FROM ""t"" WHERE ""t"".""cnt"">=2 ORDER BY ""team_id"",""t"".""employee_id"""
191,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
192,"WITH ""t0"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1 ORDER BY ""salary""), ""t1"" AS (SELECT ""salary"",ROW_NUMBER() OVER () AS ""team_id"" FROM ""t0"") SELECT ""employee_id"",""name"",""Employees"".""salary"",""team_id"" FROM ""Employees"" JOIN ""t1"" ON ""t1"".""salary""=""Employees"".""salary"" ORDER BY ""team_id"",""employee_id"""
193,"WITH ""cte"" AS (SELECT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>1 ORDER BY ""salary""), ""team"" AS (SELECT ""employee_id"",""name"",""employees"".""salary"",""cte"".""team_id"" FROM ""employees"" JOIN ""cte"" ON ""employees"".""salary""=""cte"".""salary"" ORDER BY ""team_id"",""employee_id"") SELECT * FROM ""team"""
194,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>=2)"
195,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
196,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""ct"" FROM ""employees"") AS ""a"" WHERE ""ct"">=2 ORDER BY 4,1"
197,"WITH ""cte1"" AS (SELECT ""employee_id"",""name"",""salary"" FROM (SELECT ""employee_id"",""name"",""salary"",COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""c"" FROM ""Employees"") AS ""z"" WHERE ""c"">1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte1"""
198,"WITH ""tmp"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM ""Employees"" AS ""e"" JOIN ""tmp"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" ORDER BY ""team_id"",""employee_id"""
199,"SELECT * FROM (SELECT DISTINCT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM (""Employees"" AS ""e1"") JOIN ""employees"" AS ""e2"" WHERE ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""name""!=""e2"".""name"") AS ""a"" ORDER BY ""team_id"",""employee_id"""
200,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1)"
201,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM (SELECT ""salary"",COUNT(""salary"") AS ""cnt"" FROM ""employees"" GROUP BY 1) AS ""t"" WHERE ""cnt""=1) ORDER BY ""team_id"",""employee_id"""
202,"SELECT ""employee_id"",""name"",""e"".""salary"",""k"".""numb"" AS ""team_id"" FROM ""Employees"" AS ""e"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""numb"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) AS ""k"" ON ""e"".""salary""=""k"".""salary"" ORDER BY ""team_id"",""employee_id"""
203,"WITH ""raw_data"" AS (SELECT ""employee_id"",""name"",""salary"",COUNT(1) OVER (PARTITION BY ""salary"" ORDER BY ""salary"") AS ""salary_count"" FROM ""employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""raw_data"" WHERE ""salary_count"">1 ORDER BY 3,1"
204,"WITH ""salary_group"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>=2), ""salary_group_ranking"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""salary_group"") SELECT ""e"".*,""s"".""team_id"" FROM ""employees"" AS ""e"" JOIN ""salary_group_ranking"" AS ""s"" ON ""e"".""salary""=""s"".""salary"" ORDER BY ""team_id"",""employee_id"""
205,"SELECT *,DENSE_RANK() OVER (ORDER BY ""Salary"") AS ""team_id"" FROM ""Employees"" WHERE ""Salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(1)>1)"
206,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk1"" FROM ""Employees""), ""cte2"" AS (SELECT ""rnk1"",COUNT(""rnk1"") AS ""ctrk"" FROM ""cte1"" GROUP BY ""rnk1"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte1"" WHERE ""cte1"".""rnk1"" IN (SELECT ""rnk1"" FROM ""cte2"" WHERE ""ctrk"">1)"
207,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
208,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" AS ""e"" GROUP BY ""salary"" HAVING COUNT(0)>1) ORDER BY ""team_id"",""employee_id"""
209,"SELECT ""E"".""employee_id"",""E"".""name"",""E"".""salary"",""B"".""team_id"" FROM ""Employees"" AS ""E"" LEFT JOIN (SELECT ROW_NUMBER() OVER (ORDER BY ""A"".""salary"") AS ""team_id"",""A"".""salary"" FROM (SELECT ""salary"",COUNT(""salary"") FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1) AS ""A"") AS ""B"" ON ""E"".""salary""=""B"".""salary"" WHERE ""B"".""team_id"" IS NOT NULL ORDER BY ""B"".""team_id"",""E"".""employee_id"""
210,"WITH ""team_ids"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) SELECT ""e"".*,""t"".""team_id"" FROM ""Employees"" AS ""e"" JOIN ""team_ids"" AS ""t"" ON ""e"".""salary""=""t"".""salary"" ORDER BY ""t"".""team_id"",""e"".""employee_id"""
211,"WITH ""r"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""r"".""team_id"" FROM ""employees"" AS ""e"" JOIN ""r"" ON ""r"".""salary""=""e"".""salary"" ORDER BY ""team_id"",""employee_id"""
212,"WITH ""EE2"" AS (SELECT COUNT(""name"") OVER ""w"" AS ""team_num"",""employee_id"",""name"",""salary"" FROM ""Employees"" WINDOW ""w"" AS (PARTITION BY ""salary"")) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""EE2"" WHERE ""team_num"">1 ORDER BY ""team_id"",""employee_id"""
213,"WITH ""CTE"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""team_id"") AS ""cnt"" FROM (SELECT ""e1"".""employee_id"",""e1"".""name"",""e1"".""salary"",DENSE_RANK() OVER (ORDER BY ""e1"".""salary"") AS ""team_id"" FROM ""Employees"" AS ""e1"" JOIN ""Employees"" AS ""e2"" ON ""e1"".""salary""=""e2"".""salary"" AND ""e1"".""employee_id""!=""e2"".""employee_id"" ORDER BY ""team_id"",""e1"".""employee_id"") AS ""sub"") SELECT DISTINCT ""employee_id"",""name"",""salary"",""team_id"" FROM ""CTE"" WHERE ""cnt"">=2"
214,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
215,"WITH ""a"" AS (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) SELECT ""e"".""employee_id"",""e"".""name"",""a"".""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""a"" JOIN ""Employees"" AS ""e"" ON ""a"".""salary""=""e"".""salary"" ORDER BY 4,1"
216,"WITH ""get_count"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""ct"" FROM ""employees""), ""get_team"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""get_count"" WHERE ""ct"">1) SELECT ""employee_id"",""name"",""salary"",""team_id"" FROM ""get_team"" ORDER BY ""team_id"",""employee_id"""
217,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT ""employee_id"",""name"",""salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""cnt"" FROM ""employees"") AS ""a"" WHERE ""cnt"">1) AS ""b"""
218,"WITH ""cte"" AS (SELECT * FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")=1)) SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" ORDER BY ""team_id"",""employee_id"""
219,"SELECT ""e"".""employee_id"",""e"".""name"",""e"".""salary"",""a"".""team_id"" FROM ""employees"" AS ""e"" JOIN (SELECT ""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(DISTINCT ""employee_id"")>1) AS ""a"" ON ""e"".""salary""=""a"".""salary"" ORDER BY ""a"".""team_id"",""employee_id"""
220,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""employees"" GROUP BY 1 HAVING COUNT(""employee_id"")>1)"
221,"SELECT ""d1"".*,""d2"".""team_id"" FROM ""Employees"" AS ""d1"" JOIN (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""employee_id"")>=2) AS ""d2"" ON ""d1"".""salary""=""d2"".""salary"" ORDER BY 4,1"
222,"SELECT * FROM (SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT * FROM (SELECT *,COUNT(""name"") OVER (PARTITION BY ""salary"") AS ""num"" FROM ""Employees"") AS ""a"" WHERE ""num"">1) AS ""b"") AS ""d"" ORDER BY ""team_id"",""employee_id"""
223,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk1"" FROM ""Employees""), ""cte2"" AS (SELECT ""rnk1"",COUNT(""rnk1"") AS ""ctrk"" FROM ""cte1"" GROUP BY ""rnk1"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte1"" WHERE ""cte1"".""rnk1"" IN (SELECT ""rnk1"" FROM ""cte2"" WHERE ""ctrk"">1)"
224,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(""salary"")>1)"
225,"WITH ""cte"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" GROUP BY 1 HAVING COUNT(1)>1) SELECT ""e"".""employee_id"",""e"".""name"",""c"".""salary"",""c"".""team_id"" FROM ""Employees"" AS ""e"" JOIN ""cte"" AS ""c"" ON ""e"".""salary""=""c"".""salary"" ORDER BY 4,1"
226,"WITH ""salary"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(1)>1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" IN (SELECT * FROM ""salary"") ORDER BY 4,1"
227,"SELECT ""employee_id"",""NAME"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT *,COUNT(""grp"") OVER (PARTITION BY ""grp"") AS ""cnt"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""grp"" FROM ""employees"") AS ""a"") AS ""b"" WHERE ""cnt"">1 ORDER BY 4,1"
228,"SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""Employees"" GROUP BY ""salary"" HAVING COUNT(1)=1) ORDER BY ""team_id"",""employee_id"""
229,"SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM (SELECT *,COUNT(""employee_id"") OVER (PARTITION BY ""salary"") AS ""num"" FROM ""Employees"") AS ""t"" WHERE ""num"">1 ORDER BY ""salary"",""employee_id"""
230,"WITH ""t1"" AS (SELECT ""salary"",COUNT(1) AS ""cnt"" FROM ""employees"" GROUP BY 1 HAVING ""cnt"">=2), ""t2"" AS (SELECT ""salary"",ROW_NUMBER() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""t1"") SELECT ""employee_id"",""name"",""e"".""salary"",""team_id"" FROM ""employees"" AS ""e"" JOIN ""t2"" ON ""e"".""salary""=""t2"".""salary"" ORDER BY 4,1"
231,"WITH ""cte"" AS (SELECT ""salary"",COUNT(""salary"") AS ""cnt"" FROM ""Employees"" GROUP BY 1) SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""Employees"" WHERE ""salary"" NOT IN (SELECT ""salary"" FROM ""cte"" WHERE ""cnt""<2) ORDER BY 4,1"
232,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""salary"") AS ""rnk1"" FROM ""Employees""), ""cte2"" AS (SELECT ""rnk1"",COUNT(""rnk1"") AS ""ctrk"" FROM ""cte1"" GROUP BY ""rnk1"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte1"" WHERE ""cte1"".""rnk1"" IN (SELECT ""rnk1"" FROM ""cte2"" WHERE ""ctrk"">1)"
233,"WITH ""cte"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""salary"") AS ""count_salary"" FROM ""Employees"") SELECT ""employee_id"",""name"",""salary"",DENSE_RANK() OVER (ORDER BY ""salary"") AS ""team_id"" FROM ""cte"" WHERE ""count_salary"">1 ORDER BY ""team_id"",""employee_id"""
234,"WITH ""team_salary"" AS (SELECT ""salary"" FROM ""employees"" GROUP BY ""salary"" HAVING COUNT(DISTINCT ""employee_id"")>1), ""salary_rank"" AS (SELECT ""salary"",RANK() OVER (ORDER BY ""salary"") AS ""rnk"" FROM ""team_salary"") SELECT ""e"".*,""s"".""rnk"" AS ""team_id"" FROM ""employees"" AS ""e"" LEFT JOIN ""salary_rank"" AS ""s"" ON ""e"".""salary""=""s"".""salary"" WHERE ""s"".""salary"" IS NOT NULL ORDER BY ""s"".""rnk"",""e"".""employee_id"""
