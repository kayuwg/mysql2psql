id,original query
1,"WITH ""tmp"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""queue"") SELECT ""person_name"" FROM ""tmp"" WHERE ""total""<=1000 ORDER BY ""total"" DESC LIMIT 1"
2,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"") AS ""x"" WHERE ""cum_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
3,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""total_weight"" FROM ""queue"") AS ""a"" WHERE ""total_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
4,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""s"" WHERE ""s"".""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
5,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"",""turn"" FROM ""queue"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
6,"WITH ""cumulative_weight"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight_total"" FROM ""Queue"") SELECT ""person_name"" FROM ""Queue"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cumulative_weight"" WHERE ""weight_total""<=1000)"
7,"SELECT ""person_name"" FROM (SELECT ""turn"",""person_name"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""sum_weight"" FROM ""Queue"") AS ""t"" WHERE ""sum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
8,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""qWeight"" FROM ""Queue"") AS ""tab"" WHERE ""qWeight""<=1000 ORDER BY ""qWeight"" DESC LIMIT 1"
9,"WITH ""res"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue""), ""final"" AS (SELECT ""person_name"",ROW_NUMBER() OVER (ORDER BY ""running_total"" DESC) AS ""rnk"" FROM ""res"" WHERE ""running_total""<=1000) SELECT ""person_name"" FROM ""final"" WHERE ""rnk""=1"
10,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") AS ""m"" WHERE ""running_total""<=1000 ORDER BY ""running_total"" DESC LIMIT 1"
11,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""queue"") AS ""temp"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
12,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""queue"") AS ""b"" WHERE ""rnk""<=1000 ORDER BY ""rnk"" DESC LIMIT 1"
13,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_weight"" FROM ""Queue"") AS ""t1"" WHERE ""sum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
14,"WITH ""cte"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumu_wt"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""cumu_wt""=(SELECT MAX(""cumu_wt"") FROM ""cte"" WHERE ""cumu_wt""<=1000)"
15,"WITH ""weight"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_wt"" FROM ""queue"" GROUP BY 1,2 ORDER BY ""turn"" DESC) SELECT ""person_name"" FROM ""weight"" WHERE ""sum_wt""<=1000 LIMIT 1"
16,"WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (SELECT * FROM ""Queue"" ORDER BY ""turn"") SELECT *,SUM(""weight"") OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""weight_till_now"" FROM ""cte"") SELECT *,RANK() OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""cte"") SELECT ""person_name"",MAX(""rnk"") FROM ""cte"" WHERE ""weight_till_now""<=1000 GROUP BY ""person_id"" ORDER BY MAX(""rnk"") DESC LIMIT 1) SELECT ""person_name"" FROM ""cte"""
17,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""cum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
18,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumsum"" FROM ""queue"") AS ""temp"" WHERE ""cumsum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
19,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""Queue"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cte"" WHERE ""cum_weight""<=1000)"
20,"SELECT ""sub"".""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") AS ""sub"" WHERE ""sub"".""running_total""<=1000 ORDER BY ""sub"".""turn"" DESC LIMIT 1"
21,"WITH ""tbl"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""maxweight"",SUM(""weight"") OVER (ORDER BY ""turn"")-""weight"" AS ""minweight"" FROM ""Queue"") SELECT ""person_name"" FROM ""tbl"" WHERE ""maxweight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
22,"SELECT ""t10"".""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_weight"" FROM ""Queue"") AS ""t10"" WHERE ""t10"".""cumulative_weight""<=1000 ORDER BY ""t10"".""turn"" DESC LIMIT 1"
23,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumu_sum"" FROM ""queue"") AS ""A"" WHERE ""cumu_sum""<=1000 ORDER BY ""cumu_sum"" DESC LIMIT 1"
24,"WITH ""cte"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"" GROUP BY 1) SELECT ""person_name"" FROM ""cte"" WHERE ""total_weight""<=1000 AND ""turn"" IN (SELECT MAX(""turn"") FROM ""cte"" WHERE ""total_weight""<=1000)"
25,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cur_weight"" FROM ""Queue"") AS ""t"" WHERE ""cur_weight""<=1000 ORDER BY ""cur_weight"" DESC LIMIT 1"
26,"WITH ""temp"" AS (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_average"" FROM ""queue"") SELECT ""person_name"" FROM ""temp"" WHERE ""running_average""<=1000 ORDER BY ""running_average"" DESC LIMIT 1"
27,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""queue"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""weight"" DESC LIMIT 1"
28,"WITH ""CTE"" AS (SELECT ""person_id"",""Person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""Queue"" ORDER BY ""total"" DESC) SELECT ""Person_name"" FROM ""CTE"" WHERE ""total""<=1000 LIMIT 1"
29,"WITH ""temp"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""temp"" WHERE ""cum_sum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
30,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_weight"" FROM ""queue"") AS ""_"" WHERE ""cumulative_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
31,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""Queue"") AS ""a"" WHERE ""weight""<=1000 ORDER BY ""weight"" DESC LIMIT 1"
32,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumlative_sum"" FROM ""queue"") AS ""t"" WHERE ""cumlative_sum""<=1000 ORDER BY ""cumlative_sum"" DESC LIMIT 1"
33,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cur_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""Queue"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cte"" WHERE ""cur_weight""<=1000)"
34,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""summ"" FROM ""Queue"") AS ""temp"" WHERE ""summ""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
35,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""a"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
36,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_sum"" FROM ""Queue"") AS ""x"" WHERE ""cumulative_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
37,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_sum"" FROM ""Queue"") AS ""x"" WHERE ""cumulative_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
38,"SELECT ""temp"".""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""Queue"") AS ""temp"" WHERE ""temp"".""total""<=1000 ORDER BY ""temp"".""total"" DESC LIMIT 1"
39,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""total_weight""<=1000 AND ""turn""=(SELECT MAX(""turn"") FROM ""cte"" WHERE ""total_weight""<=1000)"
40,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""queue"") AS ""b"" WHERE ""rnk""<=1000 ORDER BY ""rnk"" DESC LIMIT 1"
41,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wt"" FROM ""Queue"" GROUP BY ""person_name"") AS ""a"" WHERE ""wt""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
42,"WITH ""cte"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wt"",""turn"" FROM ""queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cte"" WHERE ""wt""<=1000)"
43,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""s"" FROM ""queue"") AS ""temp"" WHERE ""s""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
44,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""queue"" ORDER BY ""cum_weight"") AS ""a"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
45,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"") AS ""x"" WHERE ""cum_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
46,"SELECT ""a"".""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_w"" FROM ""queue"") AS ""a"" WHERE ""sum_w""<=1000 ORDER BY ""a"".""turn"" DESC LIMIT 1"
47,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_wt"" FROM ""queue"") AS ""t1"" WHERE ""sum_wt""<=1000 ORDER BY ""sum_wt"" DESC LIMIT 1"
48,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""Queue"") AS ""sub"" WHERE ""total""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
49,"WITH ""tb1"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""tb1"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
50,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""queue"") AS ""a"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
51,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"") AS ""x"" WHERE ""cum_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
52,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_w"" FROM ""queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""sum_w""<=1000 ORDER BY ""sum_w"" DESC LIMIT 1"
53,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""queue"") AS ""r"" WHERE ""total""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
54,"WITH ""a"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumsum"" FROM ""Queue"") SELECT ""person_name"" FROM ""a"" WHERE ""cumsum""<=1000 ORDER BY ""cumsum"" DESC LIMIT 1"
55,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""subq"" WHERE ""total_weight""<=1000 ORDER BY ABS(""total_weight""-1000) LIMIT 1"
56,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cur_weight"" FROM ""Queue"" ORDER BY ""cur_weight"") AS ""Q"" WHERE ""cur_weight""<=1000 ORDER BY ""cur_weight"" DESC LIMIT 1"
57,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") AS ""asd"" WHERE ""asd"".""total_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
58,"WITH ""cte"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""max_wt"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""max_wt""<=1000 ORDER BY ""max_wt"" DESC LIMIT 1"
59,"SELECT ""person_name"" FROM (SELECT ""q"".""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""queue"" AS ""q"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
60,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""Queue"") AS ""x"" WHERE ""x"".""total""<=1000 ORDER BY ""x"".""total"" DESC LIMIT 1"
61,"WITH ""temp"" AS (SELECT ""person_name"",""accumulated_weight"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""accumulated_weight"" FROM ""Queue"") AS ""accumulated_weight_table"" WHERE ""accumulated_weight""<=1000 ORDER BY 2 DESC) SELECT ""person_name"" FROM ""temp"" LIMIT 1"
62,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""r_t"" FROM ""queue"") AS ""tmp1"" WHERE ""r_t""<=1000 ORDER BY ""r_t"" DESC LIMIT 1"
63,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""w"" FROM ""queue"") AS ""a"" WHERE ""w""<=1000 ORDER BY ""w"" DESC LIMIT 1"
64,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wlimit"" FROM ""Queue"") AS ""tmp"" WHERE ""wlimit""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
65,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"") AS ""t"" WHERE ""cum_sum""<=1000 GROUP BY 1 ORDER BY ""cum_sum"" DESC LIMIT 1"
66,"WITH ""abc"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""queue"") SELECT ""person_name"" FROM ""abc"" WHERE ""running_total""<=1000 ORDER BY ""running_total"" DESC LIMIT 1"
67,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sums"" FROM ""Queue"") AS ""temp1"" WHERE ""sums""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
68,"WITH ""win"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running"",ROW_NUMBER() OVER (ORDER BY ""turn"") AS ""rk"" FROM ""queue"") SELECT ""person_name"" FROM ""win"" WHERE ""rk""=(SELECT MAX(""rk"") FROM ""win"" WHERE ""running""<=1000)"
69,"WITH ""tmp"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight_sum"" FROM ""Queue"") SELECT ""person_name"" FROM ""tmp"" WHERE ""weight_sum""<=1000 ORDER BY ""weight_sum"" DESC LIMIT 1"
70,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumu_sum"" FROM ""queue"") AS ""A"" WHERE ""cumu_sum""<=1000 ORDER BY ""cumu_sum"" DESC LIMIT 1"
71,"WITH ""totals"" AS (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""queue"") SELECT ""person_name"" FROM ""queue"" WHERE ""turn""=(SELECT MAX(""turn"") AS ""last_person_turn"" FROM ""totals"" WHERE ""running_total""<=1000)"
72,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weigth"" FROM ""Queue"") AS ""t"" WHERE ""turn""=(SELECT MAX(""turn"") FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weigth"" FROM ""Queue"") AS ""t2"" WHERE ""cum_weigth""<=1000)"
73,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""Queue"") AS ""tmp"" WHERE ""tmp"".""rnk""<=1000 OR ""tmp"".""rnk""=1 ORDER BY ""tmp"".""rnk"" DESC LIMIT 1"
74,"WITH ""acc_weight"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""acc_weight"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
75,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""summ"" FROM ""Queue"") AS ""temp"" WHERE ""summ""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
76,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_wt"" FROM ""Queue"") AS ""a"" WHERE ""cumulative_wt""<=1000 ORDER BY ""cumulative_wt"" DESC LIMIT 1"
77,"WITH ""queue_wt"" AS (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""tot_wt"" FROM ""queue"") SELECT ""person_name"" FROM ""queue_wt"" WHERE ""tot_wt""<=1000 ORDER BY ""tot_wt"" DESC LIMIT 1"
78,"WITH ""CTE"" AS (SELECT ""PERSON_NAME"",SUM(""WEIGHT"") OVER (ORDER BY ""TURN"") AS ""CUM_WEIGHT"",""TURN"" FROM ""QUEUE"") SELECT ""C1"".""PERSON_NAME"" FROM ""CTE"" AS ""C1"" LEFT JOIN ""CTE"" AS ""C2"" ON ""C1"".""TURN""+1=""C2"".""TURN"" WHERE (""C1"".""CUM_WEIGHT""<=1000 AND ""C2"".""CUM_WEIGHT"">1000) OR (""C1"".""CUM_WEIGHT""<=1000 AND ""C2"".""CUM_WEIGHT"" IS NULL)"
79,"WITH ""cte"" AS (SELECT *,ABS(1000-SUM(""weight"") OVER (ORDER BY ""turn"")) AS ""cum_sum"",CASE WHEN (SUM(""weight"") OVER (ORDER BY ""turn""))<=1000 THEN 1 ELSE 0 END AS ""inside"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""inside""=1 ORDER BY ""cum_sum"" LIMIT 1"
80,"SELECT ""sub"".""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") AS ""sub"" WHERE ""sub"".""running_total""<=1000 ORDER BY ""sub"".""running_total"" DESC LIMIT 1"
81,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""tot_weight"" FROM ""Queue"") AS ""a"" WHERE ""tot_weight""<=1000 ORDER BY ""tot_weight"" DESC LIMIT 1"
82,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_sum"" FROM ""Queue"") AS ""sub"" WHERE ""running_sum""<=1000 ORDER BY ""running_sum"" DESC LIMIT 1"
83,"WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (SELECT * FROM ""Queue"" ORDER BY ""turn"") SELECT *,SUM(""weight"") OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""weight_till_now"" FROM ""cte"") SELECT *,RANK() OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""cte"") SELECT ""person_name"",MAX(""rnk"") FROM ""cte"" WHERE ""weight_till_now""<=1000 GROUP BY ""person_id"" ORDER BY MAX(""rnk"") DESC LIMIT 1) SELECT ""person_name"" FROM ""cte"""
84,"SELECT ""A"".""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") AS ""A"" WHERE ""A"".""running_total""<=1000 ORDER BY ""A"".""running_total"" DESC LIMIT 1"
85,"WITH ""temp"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""temp"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
86,"WITH ""totals"" AS (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""queue"") SELECT ""person_name"" FROM ""queue"" WHERE ""turn""=(SELECT MAX(""turn"") AS ""last_person_turn"" FROM ""totals"" WHERE ""running_total""<=1000)"
87,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sumamount"" FROM ""queue"") AS ""t1"" WHERE ""sumamount""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
88,"SELECT ""a"".""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") AS ""a"" WHERE ""a"".""total_weight""<=1000 ORDER BY ""a"".""total_weight"" DESC LIMIT 1"
89,"SELECT ""q"".""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumsum"",""turn"" FROM ""Queue"") AS ""q"" WHERE ""q"".""cumsum""<=1000 ORDER BY ""q"".""cumsum"" DESC LIMIT 1"
90,"WITH ""cte"" AS (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_sum"" FROM ""queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""total_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
91,"SELECT ""a"".""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") AS ""a"" WHERE ""a"".""running_total""<=1000 ORDER BY ""a"".""turn"" DESC LIMIT 1"
92,"WITH ""cte"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""acum_weight"" FROM ""queue""), ""cte2"" AS (SELECT ""person_name"",""turn"",CASE WHEN ""acum_weight""<=1000 THEN 0 ELSE 1 END AS ""overwgt_ind"" FROM ""cte"") SELECT ""person_name"" FROM ""cte2"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cte2"" WHERE ""overwgt_ind""=0)"
93,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""weight"",""turn"",1000-SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rema"" FROM ""Queue"") AS ""c"" WHERE ""rema"">=0 ORDER BY ""turn"" DESC LIMIT 1"
94,"WITH ""temp"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""temp"" WHERE ""cum_sum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
95,"WITH ""cte"" AS (SELECT DISTINCT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
96,"WITH ""crs"" AS (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sw"" FROM ""Queue"" ORDER BY ""turn"") SELECT ""person_name"" FROM ""crs"" WHERE ""sw""<=1000 ORDER BY ""sw"" DESC LIMIT 1"
97,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") AS ""a"" WHERE ""total_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
98,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") AS ""temp"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
99,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""CumulativeWeight"" FROM ""Queue"") AS ""t"" WHERE ""t"".""CumulativeWeight""<=1000 ORDER BY ""CumulativeWeight"" DESC LIMIT 1"
100,"WITH ""acc_weight"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""acc_weight"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
101,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"") AS ""x"" WHERE ""cum_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
102,"WITH ""cte"" AS (SELECT SUM(""weight"") OVER (ORDER BY ""turn"") AS ""RunningTotal"",""person_name"",""turn"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""RunningTotal""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
103,"WITH ""a"" AS (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sumweight"" FROM ""Queue"") SELECT ""person_name"" FROM ""Queue"" WHERE ""turn"" IN (SELECT MAX(""turn"") FROM ""a"" WHERE ""a"".""sumweight""<=1000)"
104,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""tmp"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
105,"SELECT ""t"".""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") AS ""t"" WHERE ""t"".""cum_weight""<=1000 ORDER BY ""t"".""cum_weight"" DESC LIMIT 1"
106,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_weight"" FROM ""Queue"") AS ""newtable"" WHERE ""running_weight""<=1000 ORDER BY ""running_weight"" DESC LIMIT 1"
107,"WITH ""run_total"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""run_total"" FROM ""Queue"") SELECT ""person_name"" FROM ""run_total"" WHERE ""run_total"".""run_total""<=1000 ORDER BY ""run_total"".""run_total"" DESC LIMIT 1"
108,"WITH ""win"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running"",ROW_NUMBER() OVER (ORDER BY ""turn"") AS ""rk"" FROM ""queue"") SELECT ""person_name"" FROM ""win"" WHERE ""rk""=(SELECT MAX(""rk"") FROM ""win"" WHERE ""running""<=1000)"
109,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_sum"" FROM ""Queue"") AS ""base"" WHERE ""running_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
110,"WITH ""cte"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wgt"" FROM ""queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""wgt""<=1000 ORDER BY ""wgt"" DESC LIMIT 1"
111,"WITH ""x"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wt"" FROM ""queue"") SELECT ""person_name"" FROM ""x"" WHERE ""wt""<=1000 ORDER BY ""wt"" DESC LIMIT 1"
112,"SELECT ""a"".""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rn_total"" FROM ""queue"") AS ""a"" WHERE ""a"".""rn_total""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
113,"WITH ""queue_table"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""queue_table"" WHERE ""cumulative_weight""<=1000 ORDER BY ""cumulative_weight"" DESC LIMIT 1"
114,"WITH ""temp"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""temp"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
115,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wgt"" FROM ""queue"") AS ""a"" WHERE ""wgt""<=1000 ORDER BY ""wgt"" DESC LIMIT 1"
116,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cum_sum"" FROM ""queue"") AS ""a"" WHERE ""cum_sum""<=1000 ORDER BY ""cum_sum"" DESC LIMIT 1"
117,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""totsum"" FROM ""queue"") AS ""a"" WHERE ""totsum""<=1000 ORDER BY ""totsum"" DESC LIMIT 1"
118,"WITH ""res"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_sum"" FROM ""queue"") SELECT ""person_name"" FROM ""res"" WHERE ""cumulative_sum""<=1000 GROUP BY ""person_name"" ORDER BY ""cumulative_sum"" DESC LIMIT 1"
119,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling_sum"" FROM ""Queue"") AS ""t"" WHERE ""rolling_sum""<=1000 ORDER BY ""rolling_sum"" DESC LIMIT 1"
120,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""r_t"" FROM ""queue"") AS ""tmp1"" WHERE ""r_t""<=1000 ORDER BY ""r_t"" DESC LIMIT 1"
121,"WITH ""TMP1"" AS (SELECT *,SUM(""WEIGHT"") OVER (ORDER BY ""TURN"") AS ""CUM_SUM"",ROW_NUMBER() OVER (ORDER BY ""TURN"") AS ""ROW_INDEX"" FROM ""QUEUE""), ""TMP2"" AS (SELECT *,RANK() OVER (ORDER BY ""ROW_INDEX"" DESC) AS ""RNK"" FROM ""TMP1"" WHERE ""CUM_SUM""<=1000) SELECT DISTINCT ""person_name"" FROM ""TMP2"" WHERE ""RNK""=1"
122,"WITH ""TABLE1"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""accum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""table1"" WHERE ""accum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
123,"WITH ""moving_tb"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""moving_sum"" FROM ""Queue"") SELECT ""person_name"" FROM ""moving_tb"" WHERE ""moving_sum""<=1000 ORDER BY ""moving_sum"" DESC LIMIT 1"
124,"SELECT ""person_name"" FROM (SELECT ""person_name"",""total_weight"",RANK() OVER (ORDER BY ""total_weight"" DESC) AS ""rnk"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") AS ""sub"" WHERE ""total_weight""<=1000) AS ""sub1"" WHERE ""rnk""=1"
125,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""weight_sum"",ROW_NUMBER() OVER (ORDER BY ""turn"") AS ""rw_num"" FROM ""Queue"") AS ""X"" WHERE ""weight_sum""<=1000 ORDER BY ""rw_num"" DESC LIMIT 1"
126,"WITH ""t"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""queue"") SELECT ""person_name"" FROM ""t"" WHERE ""total""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
127,"SELECT ""person_name"" FROM (SELECT ""q"".""person_id"",""q"".""person_name"",""q"".""weight"",""q"".""turn"",CAST((@""wsum"":=@""wsum""+""q"".""weight"") AS INTEGER) AS ""prefixSum"" FROM (""Queue"" AS ""q"") JOIN (SELECT @""wsum"":=0) AS ""init"" ORDER BY ""turn"") AS ""t"" WHERE ""prefixSum""<=1000 ORDER BY ""prefixSum"" DESC LIMIT 1"
128,"WITH ""cte"" AS (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""running_total""=(SELECT MAX(""running_total"") FROM ""cte"" WHERE ""running_total""<=1000)"
129,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""accumulated"" FROM ""queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cte"" WHERE ""accumulated""<=1000)"
130,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""Queue"") AS ""tmp"" WHERE ""tmp"".""rnk""<=1000 ORDER BY ""tmp"".""rnk"" DESC LIMIT 1"
131,"SELECT ""person_name"" FROM ""queue"" WHERE ""person_id"" IN (SELECT ""person_id"" FROM (SELECT ""person_id"",DENSE_RANK() OVER (ORDER BY ""running_weight"" DESC) AS ""r1"" FROM (SELECT ""person_id"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_weight"" FROM ""queue"") AS ""A"" WHERE ""running_weight""<=1000) AS ""B"" WHERE ""r1""=1)"
132,"SELECT ""person_name"" FROM (SELECT ""queue"".*,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumsum"" FROM ""queue"") AS ""running_sum"" WHERE ""cumsum""<=1000 ORDER BY ""cumsum"" DESC LIMIT 1"
133,"SELECT ""person_name"" FROM (SELECT ""q"".""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""queue"" AS ""q"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
134,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""a"" FROM ""queue"") AS ""b"" WHERE ""a""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
135,"WITH ""acc_weight"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""acc_weight"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
136,"WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (SELECT * FROM ""Queue"" ORDER BY ""turn"") SELECT *,SUM(""weight"") OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""weight_till_now"" FROM ""cte"") SELECT *,RANK() OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""cte"") SELECT ""person_name"",MAX(""rnk"") FROM ""cte"" WHERE ""weight_till_now""<=1000 GROUP BY ""person_id"" ORDER BY MAX(""rnk"") DESC LIMIT 1) SELECT ""person_name"" FROM ""cte"""
137,"SELECT ""a"".""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""a"" WHERE ""total_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
138,"SELECT ""person_name"" FROM (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"") AS ""x"" WHERE ""cum_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
139,"WITH ""T1"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum"" FROM ""Queue"") SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",CASE WHEN ""cum"">1000 THEN 0 ELSE 1 END AS ""test"" FROM ""T1"") AS ""sub"" WHERE ""test""=1 ORDER BY ""turn"" DESC LIMIT 1"
140,"WITH ""t1"" AS (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"" GROUP BY 1,2) SELECT ""person_name"" FROM ""t1"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
141,"WITH ""CTE"" AS (SELECT ""person_id"",""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumsum"" FROM ""Queue"") SELECT ""person_name"" FROM ""Queue"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""CTE"" WHERE ""cumsum""<=1000)"
142,"SELECT ""tb1"".""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sumw"" FROM ""Queue"") AS ""tb1"" WHERE ""tb1"".""sumw""<=1000 ORDER BY ""tb1"".""turn"" DESC LIMIT 1"
143,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wt_limit"" FROM ""queue"") AS ""t"" WHERE ""wt_limit""<=1000 ORDER BY ""wt_limit"" DESC LIMIT 1"
144,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""c_wt"" FROM ""queue"") AS ""cumulative_weight"" WHERE ""c_wt""<=1000 ORDER BY ""c_wt"" DESC LIMIT 1"
145,"WITH ""cte"" AS (SELECT SUM(""weight"") OVER (ORDER BY ""turn"") AS ""RunningTotal"",""person_name"",""turn"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""RunningTotal""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
146,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""queue"") AS ""a"" WHERE ""weight""<=1000 ORDER BY ""weight"" DESC LIMIT 1"
147,"WITH ""t1"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_sum"" FROM ""queue"" ORDER BY ""running_sum"") SELECT ""person_name"" FROM ""t1"" WHERE ""running_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
148,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""queue"" ORDER BY ""turn"" DESC) AS ""sub"" WHERE ""total""<=1000 LIMIT 1"
149,"WITH ""cte"" AS (SELECT MAX(""turn"") AS ""turn"" FROM (SELECT ""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling_weight"" FROM ""Queue"") AS ""z"" WHERE ""rolling_Weight""<=1000) SELECT ""person_name"" FROM ""Queue"" WHERE ""turn""=(SELECT ""turn"" FROM ""cte"")"
150,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumsum"" FROM ""Queue"") AS ""a"" WHERE ""cumsum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
151,"WITH ""Accumulation"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""Accumulation"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
152,"WITH ""cnt"" AS (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""CUMSUM"" FROM ""Queue"" ORDER BY ""CUMSUM"" DESC) SELECT ""person_name"" FROM ""cnt"" WHERE ""CUMSUM""<=1000 LIMIT 1"
153,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rt"" FROM ""queue"" AS ""q"") AS ""temp"" WHERE ""rt""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
154,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)<=1000 AS ""is_allowed"",""turn"" FROM ""Queue"") AS ""a"" WHERE ""is_allowed"" ORDER BY ""turn"" DESC LIMIT 1"
155,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight_sum"" FROM ""Queue"") AS ""tmp"" WHERE ""weight_sum""<=1000 ORDER BY ""weight_sum"" DESC LIMIT 1"
156,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""next_person"" FROM ""Queue"" GROUP BY 1,2) AS ""temp"" WHERE ""next_person""<=1000 ORDER BY ""next_person"" DESC LIMIT 1"
157,"WITH ""queue_table"" AS (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_weight"" FROM ""queue"") SELECT ""person_name"" FROM ""queue_table"" WHERE ""cumulative_weight""<=1000 AND ""turn""=(SELECT MAX(""turn"") FROM ""queue_table"" WHERE ""cumulative_weight""<=1000)"
158,"WITH ""tbl"" AS (SELECT ""person_name"",SUM(""weight"") OVER ""w"" AS ""acc_weight"" FROM ""Queue"" WINDOW ""w"" AS (ORDER BY ""turn"")) SELECT ""person_name"" FROM ""tbl"" WHERE ""acc_weight""<=1000 ORDER BY ""acc_weight"" DESC LIMIT 1"
159,"WITH ""t1"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""c_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""t1"" WHERE ""c_weight""=(SELECT MAX(""c_weight"") FROM ""t1"" WHERE ""c_weight""<=1000)"
160,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumm_weight"",""turn"" FROM ""queue"") AS ""a"" WHERE ""cumm_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
161,"WITH ""t"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""r_w"" FROM ""queue"") SELECT ""person_name"" FROM ""t"" WHERE ""r_w""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
162,"WITH ""cte"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling_total"",""turn"" FROM ""queue"" ORDER BY ""turn"") SELECT ""person_name"" FROM ""cte"" WHERE ""rolling_total""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
163,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""summ"" FROM ""Queue"") AS ""temp"" WHERE ""summ""<=1000 ORDER BY ""summ"" DESC LIMIT 1"
164,"SELECT ""bhau"".""person_name"" AS ""person_name"" FROM (SELECT ""person_id"",""person_name"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""totalweight"",ROW_NUMBER() OVER (ORDER BY ""turn"") AS ""rownum"" FROM ""Queue"") AS ""bhau"" WHERE ""bhau"".""totalweight""<=1000 ORDER BY ""bhau"".""rownum"" DESC LIMIT 1"
165,"WITH ""main"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"" ORDER BY ""turn"") SELECT ""person_name"" FROM ""main"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
166,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""tsum"" FROM ""queue"") AS ""u"" WHERE ""tsum""<=1000 ORDER BY ""tsum"" DESC LIMIT 1"
167,"SELECT ""person_name"" FROM (SELECT ""person_name"",""sm"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sm"" FROM ""queue"") AS ""m"" WHERE ""sm""<=1000 ORDER BY ""sm"" DESC) AS ""k"" LIMIT 1"
168,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""Queue"") AS ""t"" WHERE ""total""<=1000 ORDER BY ""total"" DESC LIMIT 1"
169,"SELECT ""person_name"" FROM ""queue"" WHERE ""turn"" IN (SELECT MAX(""turn"") AS ""turn"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""roll_sum_weight"" FROM ""queue"") AS ""a"" WHERE ""roll_sum_weight""<=1000)"
170,"SELECT ""temp"".""person_name"" FROM (SELECT ""q1"".*,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"" AS ""q1"") AS ""temp"" WHERE ""temp"".""cum_weight""<=1000 ORDER BY ""temp"".""turn"" DESC LIMIT 1"
171,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""queue"") AS ""temp"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
172,"WITH ""cte"" AS (SELECT ""person_id"",""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""queue"") SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""fit"",RANK() OVER (PARTITION BY ""fit"" ORDER BY ""TURN"" DESC) AS ""lastfit"" FROM (SELECT ""person_id"",""person_name"",""running_total"",""turn"",CASE WHEN ""running_total""<=1000 THEN 1 ELSE 0 END AS ""fit"" FROM ""cte"") AS ""sub"") AS ""sub2"" WHERE ""fit""=1 AND ""lastfit""=1"
173,"SELECT ""person_name"" FROM (SELECT *,RANK() OVER (ORDER BY ""total"" DESC) AS ""ranks"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""Queue"") AS ""t"" WHERE ""total""<=1000) AS ""tt"" WHERE ""ranks""=1"
174,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""roll_sum"" FROM ""queue"") AS ""a"" WHERE ""roll_sum""<=1000 ORDER BY ""roll_sum"" DESC LIMIT 1"
175,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight_total"" FROM ""Queue"") AS ""w"" WHERE ""weight_total""<=1000 ORDER BY ""weight_total"" DESC LIMIT 1"
176,"SELECT ""person_name"" FROM ""queue"" WHERE ""turn"" IN (SELECT MAX(""turn"") FROM (SELECT ""turn"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""queue"") AS ""A"" WHERE ""total_weight""<='1000')"
177,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""t_weight"",LEAD(""weight"", 1) OVER (ORDER BY ""turn"") AS ""n_weight"" FROM ""queue"") AS ""t"" WHERE ""t_weight""<=1000 AND (""t_weight""+""n_weight"">1000 OR ""n_weight"" IS NULL)"
178,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling_sum"" FROM ""Queue"" ORDER BY 2 DESC) AS ""tmp"" WHERE ""rolling_sum""<=1000 LIMIT 1"
179,"SELECT ""p"".""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (PARTITION BY NULL ORDER BY ""turn"") AS ""s"" FROM ""Queue"") AS ""p"" WHERE ""p"".""s""<=1000 ORDER BY ""p"".""s"" DESC LIMIT 1"
180,"WITH ""T"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""T"" WHERE ""rolling_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
181,"WITH ""cte"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
182,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") AS ""t"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
183,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_wt"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""total_wt""<=1000 ORDER BY ""total_wt"" DESC LIMIT 1"
184,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""val"" FROM ""queue"") AS ""a"" WHERE ""val""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
185,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_weight"" FROM ""Queue"") AS ""a"" WHERE ""sum_weight""<=1000 ORDER BY ""sum_weight"" DESC LIMIT 1"
186,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""t"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
187,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""csum"" FROM ""Queue"") AS ""T"" WHERE ""csum""=(SELECT MAX(""csum"") FROM (SELECT SUM(""weight"") OVER (ORDER BY ""turn"") AS ""csum"" FROM ""Queue"") AS ""T"" WHERE ""csum""<=1000)"
188,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""Queue"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""cte"" WHERE ""cum_weight""<=1000)"
189,"WITH ""temp"" AS (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""temp"" WHERE ""cum_weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
190,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""try"" FROM ""Queue"") AS ""A"" WHERE ""try""<=1000 ORDER BY ""try"" DESC LIMIT 1"
191,"WITH ""tmp"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight_sum"" FROM ""Queue"") SELECT ""person_name"" FROM ""tmp"" WHERE ""weight_sum""<=1000 ORDER BY ""weight_sum"" DESC LIMIT 1"
192,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_total"" FROM ""Queue"") AS ""sub"" WHERE ""running_total""<=1000 ORDER BY ""running_total"" DESC LIMIT 1"
193,"WITH ""acc"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""acc_w"" FROM ""Queue"") SELECT ""person_name"" FROM (SELECT * FROM ""acc"" WHERE ""acc_w""<=1000) AS ""acc_2"" ORDER BY ""acc_w"" DESC LIMIT 1"
194,"SELECT ""person_name"" FROM (SELECT ""q"".""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""queue"" AS ""q"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
195,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_sum"" FROM ""Queue"") AS ""t"" WHERE ""running_sum""<=1000 ORDER BY ""running_sum"" DESC LIMIT 1"
196,"WITH ""cte"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") SELECT ""person_name"" FROM ""cte"" WHERE ""cum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
197,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""total_weight"" FROM ""Queue"") AS ""t1"" WHERE ""t1"".""total_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
198,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""SM"" FROM ""Queue"") AS ""A"" WHERE ""SM""<=1000 ORDER BY ""SM"" DESC LIMIT 1"
199,"SELECT ""a"".""person_name"" FROM (SELECT ""person_name"",1000-SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight_diff"" FROM ""queue"") AS ""a"" WHERE ""a"".""cum_weight_diff"">=0 ORDER BY ""a"".""cum_weight_diff"" LIMIT 1"
200,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""wgt"" FROM ""Queue"" AS ""q"") AS ""a"" WHERE ""a"".""wgt""<=1000 ORDER BY ""a"".""wgt"" DESC LIMIT 1"
201,"WITH ""person_weight"" AS (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""running_sum"",""turn"" FROM ""Queue"") SELECT ""person_name"" FROM ""person_weight"" WHERE ""running_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
202,"WITH ""tmp"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""s"" FROM ""queue"") SELECT ""person_name"" FROM ""tmp"" WHERE ""s""<=1000 ORDER BY ""s"" DESC LIMIT 1"
203,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""queue"" ORDER BY ""cum_sum"" DESC) AS ""t1"" WHERE ""cum_sum""<=1000 LIMIT 1"
204,"WITH ""tmp"" AS (SELECT ""person_name"",""weight"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total"" FROM ""queue"") SELECT ""person_name"" FROM ""tmp"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""tmp"" WHERE ""total""<=1000)"
205,"SELECT ""a"".""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") AS ""a"" WHERE ""a"".""cum_Weight""<=1000 ORDER BY ""cum_weight"" DESC LIMIT 1"
206,"SELECT ""t1"".""person_name"" AS ""person_name"" FROM (SELECT ""person_id"",""person_name"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""runnin_sum"" FROM ""Queue"") AS ""t1"" WHERE ""t1"".""runnin_sum""<=1000 ORDER BY ""t1"".""runnin_sum"" DESC LIMIT 1"
207,"SELECT ""person_name"" FROM (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_weight"" FROM ""Queue"") AS ""t"" WHERE ""cum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
208,"WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (SELECT * FROM ""Queue"" ORDER BY ""turn"") SELECT *,SUM(""weight"") OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""weight_till_now"" FROM ""cte"") SELECT *,RANK() OVER (ORDER BY ""turn"") AS ""rnk"" FROM ""cte"") SELECT ""person_name"",MAX(""rnk"") FROM ""cte"" WHERE ""weight_till_now""<=1000 GROUP BY ""person_id"" ORDER BY MAX(""rnk"") DESC LIMIT 1) SELECT ""person_name"" FROM ""cte"""
209,"SELECT ""person_name"" FROM (SELECT ""q"".""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""queue"" AS ""q"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
210,"SELECT ""person_name"" FROM (SELECT ""person_id"",""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""sub"" WHERE ""sub"".""total_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
211,"WITH ""rolling_sum"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling_sum"" FROM ""queue"") SELECT ""person_name"" FROM ""rolling_sum"" WHERE ""rolling_sum""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
212,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""total_weight"" FROM ""Queue"") AS ""a"" WHERE ""total_weight""<=1000 ORDER BY ""total_weight"" DESC LIMIT 1"
213,"WITH ""data"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cum_sum"" FROM ""Queue"") SELECT ""person_name"" FROM ""data"" WHERE ""cum_sum""<=1000 ORDER BY ""cum_sum"" DESC LIMIT 1"
214,"WITH ""table1"" AS (SELECT *,SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight_cumulative"" FROM ""queue"") SELECT ""person_name"" FROM ""queue"" WHERE ""turn""=(SELECT MAX(""turn"") FROM ""table1"" WHERE ""weight_cumulative""<=1000)"
215,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""rolling"" FROM ""queue"") AS ""s"" WHERE ""rolling""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
216,"WITH ""cte"" AS (SELECT ""person_name"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_weight"" FROM ""queue"" GROUP BY ""person_name"",""weight"") SELECT ""person_name"" FROM ""cte"" WHERE ""cumulative_weight""<=1000 ORDER BY ""cumulative_weight"" DESC LIMIT 1"
217,"SELECT ""t"".""person_name"" FROM (SELECT ""person_id"",""person_name"",""weight"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""cumulative_weight"",""turn"" FROM ""queue"") AS ""t"" WHERE ""t"".""cumulative_weight""<=1000 ORDER BY ""t"".""turn"" DESC LIMIT 1"
218,"SELECT ""person_name"" FROM (SELECT ""person_name"",""turn"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""sum_weight"" FROM ""Queue"") AS ""a"" WHERE ""sum_weight""<=1000 ORDER BY ""turn"" DESC LIMIT 1"
219,"SELECT ""person_name"" FROM ""Queue"" WHERE ""turn"" IN (SELECT MAX(""turn"") FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""accumu_sum"",""turn"" FROM ""Queue"") AS ""t"" WHERE ""accumu_sum""<=1000)"
220,"SELECT ""person_name"" FROM (SELECT ""person_name"",SUM(""weight"") OVER (ORDER BY ""turn"") AS ""weight"" FROM ""Queue"") AS ""t"" WHERE ""weight""<=1000 ORDER BY ""weight"" DESC LIMIT 1"
