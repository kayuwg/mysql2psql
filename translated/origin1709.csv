id,original query
1,"SELECT ""user_id"",MAX(""lead_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_visit_date"" FROM ""UserVisits"") AS ""tmpt"" GROUP BY 1"
2,"SELECT ""a"".""user_id"",MAX(""a"".""w"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""w"" FROM ""UserVisits"") AS ""a"" GROUP BY ""a"".""user_id"""
3,"WITH ""a"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""r_rank"" FROM ""uservisits"") SELECT ""user_id"",MAX(""w"") AS ""biggest_window"" FROM (SELECT ""a1"".""user_id"",""a2"".""visit_date"" - ""a1"".""visit_date"" AS ""w"" FROM ""a"" AS ""a1"" JOIN ""a"" AS ""a2"" ON ""a1"".""user_id""=""a2"".""user_id"" AND ""a2"".""r_rank""=""a1"".""r_rank""+1 UNION ALL SELECT ""user_id"",CAST('2021-01-01' AS DATE) - MAX(""visit_date"") AS ""w"" FROM ""uservisits"" GROUP BY 1) AS ""t"" GROUP BY 1 ORDER BY 1"
4,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"" AS ""start_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""end_date"" FROM ""uservisits"" ORDER BY ""user_id"",""visit_date"") SELECT ""user_id"",MAX(""end_date"" - ""start_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""start_date"",CASE WHEN ""end_date"" IS NULL THEN '2021-1-1' ELSE ""end_date"" END AS ""end_date"" FROM ""cte"") AS ""temp"" GROUP BY ""user_id"""
5,"WITH ""temp1"" AS (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""user_visit_rk"" FROM ""UserVisits""), ""temp2"" AS (SELECT ""a"".""user_id"",""a"".""visit_date"",COALESCE(""b"".""visit_date"", DATE('2021-01-01')) AS ""next_visit_date"" FROM ""temp1"" AS ""a"" LEFT JOIN ""temp1"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_visit_rk""+1=""b"".""user_visit_rk"") SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM ""temp2"" GROUP BY ""user_id"""
6,"SELECT ""user_id"",MAX((TIMESTAMPDIFF(DAY, ""visit_date"", COALESCE(""lead_date"", '2021-01-01')))) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") AS ""lead_date_info"" GROUP BY ""user_id"""
7,"SELECT ""user_id"",MAX(""difference"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-1-1') - ""visit_date"" AS ""difference"" FROM ""uservisits"") AS ""a"" GROUP BY 1 ORDER BY 1"
8,"SELECT ""user_id"",MAX(""lead_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_visit_date"" FROM ""uservisits"") AS ""tmpt"" GROUP BY 1"
9,"SELECT ""user_id"",MAX(""visit_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""visit_window"" FROM ""UserVisits"") AS ""a"" GROUP BY 1"
10,"WITH ""user_visit_ranking"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""ranking"" FROM ""UserVisits"") SELECT ""u0"".""user_id"",MAX(COALESCE(""u1"".""visit_date"", '2021-01-01') - ""u0"".""visit_date"") AS ""biggest_window"" FROM ""user_visit_ranking"" AS ""u0"" LEFT JOIN ""user_visit_ranking"" AS ""u1"" ON ""u1"".""user_id""=""u0"".""user_id"" AND ""u1"".""ranking""=""u0"".""ranking""+1 GROUP BY ""u0"".""user_id"""
11,"SELECT ""user_id"",MAX(""wd"") AS ""biggest_window"" FROM (SELECT ""u1"".""user_id"",MIN(COALESCE(""u2"".""visit_date"", '2021-1-1') - ""u1"".""visit_date"") AS ""wd"" FROM ""UserVisits"" AS ""u1"" LEFT JOIN ""UserVisits"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""visit_date""<""u2"".""visit_date"" GROUP BY 1,""u1"".""visit_date"") AS ""u"" GROUP BY 1 ORDER BY 1"
12,"WITH ""cte"" AS (SELECT DISTINCT ""user_id"",STR_TO_DATE('2021-01-01', '%Y-%m-%d') AS ""visit_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""date_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"" - LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""date_window"" FROM (SELECT * FROM ""uservisits"" UNION ALL SELECT * FROM ""cte"") AS ""a"") AS ""b"" GROUP BY ""user_id"""
13,"SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""uservisits"") AS ""uv"" GROUP BY ""user_id"""
14,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits"" AS ""u"") AS ""t1"" GROUP BY ""user_id"""
15,"SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits"") AS ""a"" GROUP BY 1 ORDER BY 1"
16,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""Temp"" GROUP BY 1 ORDER BY 1"
17,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
18,"SELECT ""user_id"",MAX(""biggest_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - LAG(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC)) AS ""biggest_window"" FROM ""uservisits"") AS ""a"" GROUP BY 1"
19,"SELECT ""user_id"",MAX(""next_visit"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_visit"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"""
20,"WITH ""NextUserVisit"" AS (SELECT ""user_id"",""visit_date"" AS ""currentVisit"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextVisit"" FROM ""UserVisits""), ""VisitDuration"" AS (SELECT ""user_id"",""nextVisit"" - ""currentVisit"" AS ""wd"" FROM ""NextUserVisit"") SELECT ""user_id"",MAX(""wd"") AS ""biggest_window"" FROM ""VisitDuration"" GROUP BY ""user_id"" ORDER BY 1"
21,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"" FROM ""uservisits"" ORDER BY 1,2), ""cte1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""cte""), ""cte2"" AS (SELECT ""user_id"",CASE WHEN ""next_date"" IS NOT NULL THEN ABS(""next_date"" - ""visit_date"") ELSE CAST('2021-01-01' AS DATE) - ""visit_date"" END AS ""date_diff"" FROM ""cte1"") SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM ""cte2"" GROUP BY ""user_id"""
22,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") AS ""sub"" GROUP BY 1 ORDER BY 1"
23,"WITH ""temp"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT ""t1"".""user_id"",MAX(COALESCE(""t2"".""visit_date"", '2021-1-1') - ""t1"".""visit_date"") AS ""biggest_window"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""rnk""=""t2"".""rnk""-1 GROUP BY 1 ORDER BY 1"
24,"SELECT ""a"".""user_id"",MAX(""a"".""bigest"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""bigest"" FROM ""uservisits"") AS ""a"" GROUP BY ""a"".""user_id"""
25,"SELECT ""user_id"",MAX(""nxt_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), DATE '2021-01-01') AS ""nxt_visit_date"" FROM ""uservisits"") AS ""temp"" GROUP BY 1 ORDER BY 1"
26,"SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",CASE WHEN ""lead1"" IS NULL THEN '2021-01-01' ELSE ""lead1"" END AS ""lead_date"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead1"" FROM ""uservisits"") AS ""sub"") AS ""sub1"" GROUP BY ""user_id"""
27,"SELECT ""t"".""user_id"",MAX(""t"".""Next_visit_date"" - ""t"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""Next_visit_date"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"""
28,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""Temp"" GROUP BY 1 ORDER BY 1"
29,"WITH ""x"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""r"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""r"" - ""visit_date"") AS ""biggest_window"" FROM ""x"" GROUP BY ""user_id"""
30,"SELECT ""user_id"",MAX(""day_after"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""day_after"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
31,"WITH ""CET"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""BENCH_DATE"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""BENCH_DATE"" - ""visit_date"") AS ""biggest_window"" FROM ""CET"" GROUP BY ""user_id"" ORDER BY ""user_id"""
32,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lg"" FROM ""uservisits"") SELECT ""user_id"",MAX(""lg"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
33,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
34,"WITH ""t"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""t"" GROUP BY ""user_id"""
35,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01')) AS ""diff"" FROM ""uservisits"") AS ""a"" GROUP BY ""user_id"""
36,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
37,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(COALESCE(""lead_date"", '2021-1-1') - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
38,"WITH ""t"" AS (SELECT DISTINCT (""user_id""),'2021-01-01' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT * FROM ""UserVisits""), ""t2"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, 0) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""t"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""t2"" GROUP BY ""user_id"" ORDER BY ""user_id"""
39,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), CAST('2021-01-01' AS DATE)) AS ""next_date"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
40,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
41,"WITH ""tmp"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""ld"" FROM ""uservisits"") SELECT ""user_id"",MAX(""ld"" - ""visit_date"") AS ""biggest_window"" FROM ""tmp"" GROUP BY 1"
42,"SELECT ""user_id"",MAX(""fc"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""fc"" FROM ""UserVisits"") AS ""s"" GROUP BY ""user_id"" ORDER BY ""user_id"""
43,"SELECT ""user_id"",MAX(ABS(CASE WHEN ""next_visit"" IS NOT NULL THEN ""visit_date"" - ""next_visit"" ELSE 0 END)) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""UserVisits"" AS ""uv"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
44,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rk""=""b"".""rk""-1 GROUP BY 1 ORDER BY 1"
45,"WITH ""tilltoday"" AS (SELECT ""user_id"",CAST('2021-1-1' AS DATE) - MAX(""visit_date"") AS ""next_visit_window"" FROM ""UserVisits"" GROUP BY ""user_id""), ""t"" AS (SELECT ""u1"".""user_id"",""u1"".""visit_date"",MIN(""u2"".""visit_date"" - ""u1"".""visit_date"") AS ""next_visit_window"" FROM ""UserVisits"" AS ""u1"" JOIN ""UserVisits"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""visit_date""<""u2"".""visit_date"" GROUP BY ""u1"".""user_id"",""u1"".""visit_date"") SELECT ""user_id"",MAX(""next_visit_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",""next_visit_window"" FROM ""t"" UNION SELECT ""user_id"",""next_visit_window"" FROM ""tilltoday"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
46,"WITH ""CTE"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
47,"SELECT ""user_id"",MAX(""next_visit"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""next_visit"" FROM ""Uservisits"") AS ""x"" GROUP BY 1 ORDER BY 1"
48,"WITH ""tmp1"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_visit"" FROM ""UserVisits""), ""tmp2"" AS (SELECT ""user_id"",ABS(""visit_date"" - ""next_visit"") AS ""window_size"" FROM ""tmp1"") SELECT ""user_id"",MAX(""window_size"") AS ""biggest_window"" FROM ""tmp2"" GROUP BY ""user_id"""
49,"WITH ""tb1"" AS (SELECT *,LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits""), ""tb2"" AS (SELECT ""user_id"",""visit_date"",CASE WHEN ""next_date"" IS NULL THEN '2021-01-01' ELSE ""next_date"" END AS ""next_date"" FROM ""tb1""), ""tb3"" AS (SELECT *,ABS(""visit_date"" - ""next_date"") AS ""diff"" FROM ""tb2"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""tb3"" GROUP BY ""user_id"""
50,"WITH ""tmp"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""date_rank"" FROM ""uservisits"") SELECT ""t1"".""user_id"",MAX(COALESCE(""t2"".""visit_date"", '2021-1-1') - ""t1"".""visit_date"") AS ""biggest_window"" FROM ""tmp"" AS ""t1"" LEFT JOIN ""tmp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND (""t2"".""date_rank""=""t1"".""date_rank""+1) GROUP BY ""t1"".""user_id"" ORDER BY ""t1"".""user_id"""
51,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
52,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""f"" GROUP BY 1 ORDER BY 1"
53,"WITH ""U"" AS (SELECT ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""r"",""user_id"",""visit_date"" FROM ""UserVisits"") SELECT ""U1"".""user_id"",MAX(ABS(""U1"".""visit_date"" - COALESCE(""U2"".""visit_date"", '2021-1-1'))) AS ""biggest_window"" FROM ""U"" AS ""U1"" LEFT JOIN ""U"" AS ""U2"" ON ""U1"".""user_id""=""U2"".""user_id"" AND ""U1"".""r""+1=""U2"".""r"" GROUP BY 1"
54,"WITH ""base"" AS (SELECT DISTINCT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT DISTINCT ""user_id"",""visit_date"" FROM ""UserVisits""), ""base1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""base"") SELECT DISTINCT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM ""base1"" GROUP BY 1 ORDER BY 1"
55,"SELECT ""user_id"",MAX(CASE WHEN ""gap"" IS NULL THEN CAST('2021-1-1' AS DATE) - ""visit_date"" ELSE ""gap"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""gap"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
56,"WITH ""cte"" AS (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), DATE '2021-01-01') - ""visit_date"" AS ""biggest_window"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""biggest_window"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
57,"WITH ""temp"" AS (SELECT ""user_id"",""visit_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""window_days"") AS ""biggest_window"" FROM (SELECT ""t1"".""user_id"",COALESCE(""t2"".""visit_date"", '2021-01-01') - ""t1"".""visit_date"" AS ""window_days"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""rnk""=""t2"".""rnk""-1) AS ""TBL"" GROUP BY 1 ORDER BY ""user_id"""
58,"SELECT ""user_id"",MAX(""wd"") AS ""biggest_window"" FROM (SELECT *,COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""wd"" FROM ""UserVisits"" ORDER BY 1,2) AS ""t"" GROUP BY 1"
59,"SELECT ""t2"".""a"" AS ""user_id"",MAX(""t2"".""wind"") AS ""biggest_window"" FROM (SELECT ""t1"".""user_id"" AS ""a"",""t1"".""next_date"" - ""t1"".""visit_date"" AS ""wind"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") AS ""t1"") AS ""t2"" GROUP BY 1"
60,"WITH ""cte1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits""), ""cte2"" AS (SELECT ""user_id"",CASE WHEN ""next_date"" IS NOT NULL THEN ABS(""next_date"" - ""visit_date"") ELSE CAST('2021-01-01' AS DATE) - ""visit_date"" END AS ""date_diff"" FROM ""cte1"") SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM ""cte2"" GROUP BY ""user_id"""
61,"WITH ""cts"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(ABS(""visit_date"" - ""next_visit_date"")) AS ""biggest_window"" FROM ""cts"" GROUP BY ""user_id"""
62,"WITH ""VisitWindow"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""nextWindow"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""nextWindow"") AS ""biggest_window"" FROM ""VisitWindow"" GROUP BY ""user_id"" ORDER BY 1"
63,"WITH ""cte1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits""), ""cte2"" AS (SELECT ""user_id"",CASE WHEN ""next_date"" IS NOT NULL THEN ABS(""next_date"" - ""visit_date"") ELSE CAST('2021-01-01' AS DATE) - ""visit_date"" END AS ""date_diff"" FROM ""cte1"") SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM ""cte2"" GROUP BY ""user_id"""
64,"WITH ""getVisits"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""getVisits"" GROUP BY 1"
65,"SELECT ""user_id"",GREATEST(MAX(""win""), CAST('2021-1-1' AS DATE) - MAX(""visit_date"")) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",""visit_date"" - LAG(""visit_date"", 1, ""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""win"" FROM ""UserVisits"") AS ""tmp"" GROUP BY ""user_id"" ORDER BY ""user_id"""
66,"SELECT ""t"".""user_id"",MAX(""t"".""next_visit_date"" - ""t"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""uservisits"") AS ""t"" GROUP BY ""t"".""user_id"" ORDER BY ""t"".""user_id"""
67,"SELECT ""b"".""user_id"",MAX(""req1"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",(CASE WHEN LEAD(""visit_Date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_Date"" IS NULL THEN CAST('2021-1-1' AS DATE) - ""visit_date"" ELSE LEAD(""visit_Date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_Date"" END) AS ""req1"" FROM ""uservisits"") AS ""b"" GROUP BY 1"
68,"SELECT ""user_id"",MAX(""lead_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_visit_date"" FROM ""UserVisits"") AS ""tmpt"" GROUP BY 1"
69,"WITH ""tmp"" AS (SELECT ""user_id"",""visit_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""uservisits"") SELECT ""t1"".""user_id"",MAX(ABS(""t1"".""visit_date"" - COALESCE(""t2"".""visit_date"", '2021-1-1'))) AS ""biggest_window"" FROM ""tmp"" AS ""t1"" LEFT JOIN ""tmp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t2"".""rnk""=""t1"".""rnk""+1 GROUP BY 1"
70,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-01-01') - ""visit_date"" AS ""windows"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
71,"WITH ""U"" AS (SELECT ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""r"",""user_id"",""visit_date"" FROM ""UserVisits"") SELECT ""U1"".""user_id"",MAX(ABS(""U1"".""visit_date"" - COALESCE(""U2"".""visit_date"", '2021-1-1'))) AS ""biggest_window"" FROM ""U"" AS ""U1"" LEFT JOIN ""U"" AS ""U2"" ON ""U1"".""user_id""=""U2"".""user_id"" AND ""U1"".""r""+1=""U2"".""r"" GROUP BY 1"
72,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""USER_ID"" ORDER BY ""visit_date""), '2021-01-01') - ""VISIT_DATE"" AS ""diff"" FROM ""UserVisits"") AS ""xx"" GROUP BY ""user_id"""
73,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
74,"WITH ""cte"" AS (SELECT *,LEAD(""visit_date"") OVER (PARTITION BY ""USER_ID"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""ASD"") AS ""biggest_window"" FROM (SELECT *,CASE WHEN ""next_date"" IS NOT NULL THEN ""next_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END AS ""ASD"" FROM ""cte"") AS ""a"" GROUP BY ""user_id"""
75,"WITH ""tmp"" AS (SELECT *,LEAD(""visit_date"", 1, STR_TO_DATE('2021-1-1', '%Y-%m-%d')) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""tmp"" GROUP BY 1 ORDER BY 1"
76,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rk""=""b"".""rk""-1 GROUP BY 1 ORDER BY 1"
77,"WITH ""daytable"" AS (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), STR_TO_DATE('2021-1-1', '%Y-%m-%d')) - ""visit_date"" AS ""days"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM ""daytable"" GROUP BY ""user_id"""
78,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
79,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM (SELECT * FROM ""UserVisits"" UNION SELECT DISTINCT ""user_id"",TO_CHAR('2021-01-01', 'YYYY-%m-%d') FROM ""UserVisits"") AS ""temp"") AS ""temp2"" GROUP BY ""user_id"""
80,"SELECT ""user_id"",MAX(""lead_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_visit_date"" FROM ""UserVisits"") AS ""tmpt"" GROUP BY 1"
81,"WITH ""R"" AS (SELECT ""USER_ID"",""VISIT_DATE"",RANK() OVER (PARTITION BY ""USER_ID"" ORDER BY ""VISIT_DATE"" DESC) AS ""R"" FROM ""USERVISITS""), ""WIND"" AS (SELECT ""USER_ID"",""VISIT_DATE"",""R"",LAG(""VISIT_DATE"", 1) OVER (PARTITION BY ""USER_ID"" ORDER BY ""VISIT_DATE"" DESC) AS ""PRE"",CASE WHEN ""R""=1 THEN CAST('2021-1-1' AS DATE) - ""VISIT_DATE"" ELSE LAG(""VISIT_DATE"", 1) OVER (PARTITION BY ""USER_ID"" ORDER BY ""VISIT_DATE"" DESC) - ""VISIT_DATE"" END AS ""WIN"" FROM ""R"") SELECT ""USER_ID"",MAX(""WIN"") AS ""BIGGEST_WINDOW"" FROM ""WIND"" GROUP BY ""USER_ID"""
82,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT ""p1"".""user_id"",MAX(COALESCE(""p2"".""visit_date"", '2021-1-1') - ""p1"".""visit_date"") AS ""biggest_window"" FROM ""cte"" AS ""p1"" LEFT JOIN ""cte"" AS ""p2"" ON ""p1"".""user_id""=""p2"".""user_id"" AND ""p1"".""rnk""=""p2"".""rnk""-1 GROUP BY 1 ORDER BY 1"
83,"SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""date_diff"" FROM ""UserVisits"") AS ""s"" GROUP BY 1 ORDER BY 1"
84,"WITH ""visit_order"" AS (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""row_num"" FROM ""UserVisits"") SELECT ""V1"".""user_id"",MAX(COALESCE(""V2"".""visit_date"", '2021-01-01') - ""V1"".""visit_date"") AS ""biggest_window"" FROM ""visit_order"" AS ""V1"" LEFT JOIN ""visit_order"" AS ""V2"" ON ""V1"".""row_num""=""V2"".""row_num""-1 AND ""V1"".""user_id""=""V2"".""user_id"" GROUP BY ""V1"".""user_id"""
85,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""uservisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""cte"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rk""=""b"".""rk""-1 GROUP BY ""a"".""user_id"" ORDER BY ""a"".""user_id"""
86,"SELECT ""user_id"",MAX(""lead_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""lead_visit_date"" FROM ""UserVisits"") AS ""tbl"" GROUP BY 1"
87,"WITH ""cte"" AS (SELECT ""user_id"",DATE('2021-1-1') AS ""visit_date"" FROM (SELECT DISTINCT ""user_id"" FROM ""UserVisits"") AS ""t"" UNION ALL SELECT * FROM ""userVisits"") SELECT ""user_id"",MAX(""win"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"" - LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""win"" FROM ""cte"") AS ""t"" GROUP BY ""user_id"""
88,"WITH ""cte"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1 ORDER BY 1"
89,"WITH ""t1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextv"" FROM ""UserVisits"") SELECT DISTINCT ""user_id"",MAX(""inter"") OVER (PARTITION BY ""user_id"") AS ""biggest_window"" FROM (SELECT ""user_id"",CASE WHEN ""nextv"" IS NOT NULL THEN ""nextv"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END AS ""inter"" FROM ""t1"") AS ""t2"" ORDER BY ""user_id"""
90,"SELECT ""user_id"",MAX(COALESCE(""lead_date"", DATE('2021-01-01')) - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") AS ""lead_date_info"" GROUP BY ""user_id"""
91,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY 1"
92,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
93,"WITH ""cnt"" AS (SELECT ""U1"".""user_id"",MIN((CASE WHEN ""U2"".""visit_date"" IS NULL THEN CAST('2021-1-1' AS DATE) - ""U1"".""visit_date"" ELSE ""U2"".""visit_date"" - ""U1"".""visit_date"" END)) AS ""diff"" FROM ""UserVisits"" AS ""U1"" LEFT JOIN ""UserVisits"" AS ""U2"" ON ""U1"".""user_id""=""U2"".""user_id"" AND ""U1"".""visit_date""<""U2"".""visit_date"" GROUP BY ""U1"".""user_id"",""U1"".""visit_date"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""cnt"" GROUP BY ""user_id"""
94,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""uservisits"") SELECT ""c1"".""user_id"",MAX(COALESCE(""c2"".""visit_date"", '2021-1-1') - ""c1"".""visit_date"") AS ""biggest_window"" FROM ""cte"" AS ""c1"" LEFT JOIN ""cte"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""rnk""=""c2"".""rnk""-1 GROUP BY 1"
95,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""USER_ID"" ORDER BY ""visit_date""), '2021-01-01') - ""VISIT_DATE"" AS ""diff"" FROM ""UserVisits"") AS ""xx"" GROUP BY ""user_id"""
96,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits"") AS ""T"" GROUP BY ""user_id"""
97,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT DISTINCT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-1-1') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""cte"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rnk""=""b"".""rnk""-1 GROUP BY ""a"".""user_id"""
98,"WITH ""t1"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""uservisits""), ""t2"" AS (SELECT ""a"".""user_id"",""a"".""visit_date"",COALESCE(""b"".""visit_date"", '2021-1-1') AS ""next_date"" FROM ""t1"" AS ""a"" LEFT JOIN ""t1"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rnk""=""b"".""rnk""-1) SELECT ""t2"".""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""t2"" GROUP BY 1 ORDER BY 1"
99,"WITH ""cte"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""Uservisits"") SELECT ""user_id"",MAX(""next_visit"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1 ORDER BY 1"
100,"SELECT ""user_id"",CASE WHEN MAX(""DIF"") IS NULL THEN CAST('2021-1-1' AS DATE) - MAX(""visit_date"") WHEN MAX(""DIF"")<CAST('2021-1-1' AS DATE) - MAX(""visit_date"") THEN CAST('2021-1-1' AS DATE) - MAX(""visit_date"") ELSE MAX(""DIF"") END AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"" - LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""DIF"",""visit_date"" FROM ""UserVisits"") AS ""T"" GROUP BY ""user_id"" ORDER BY ""user_id"""
101,"SELECT ""l"".""user_id"",MAX(COALESCE(""r"".""visit_Date"", '2021-01-01') - ""l"".""visit_Date"") AS ""biggest_window"" FROM (SELECT ""u1"".""user_id"",""u1"".""visit_date"",COUNT(DISTINCT ""u2"".""visit_date"") AS ""rnk"" FROM ""uservisits"" AS ""u1"" LEFT JOIN ""uservisits"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""visit_date"">""u2"".""visit_date"" GROUP BY ""u1"".""user_id"",""u1"".""visit_Date"") AS ""l"" LEFT JOIN (SELECT ""u1"".""user_id"",""u1"".""visit_date"",COUNT(DISTINCT ""u2"".""visit_date"") AS ""rnk"" FROM ""uservisits"" AS ""u1"" LEFT JOIN ""uservisits"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""visit_date"">""u2"".""visit_date"" GROUP BY ""u1"".""user_id"",""u1"".""visit_Date"") AS ""r"" ON ""l"".""user_id""=""r"".""user_id"" AND ""l"".""rnk""+1=""r"".""rnk"" GROUP BY ""user_id"" ORDER BY ""user_id"""
102,"WITH ""cet"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""cet"" GROUP BY ""user_id"""
103,"WITH ""d"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next"" FROM ""uservisits""), ""d2"" AS (SELECT ""user_id"",""next"" - ""visit_date"" AS ""w"" FROM ""d"") SELECT ""user_id"",MAX(""w"") AS ""biggest_window"" FROM ""d2"" GROUP BY ""user_id"""
104,"WITH ""t"" AS (SELECT *,CAST(DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS INTEGER) AS ""dr"" FROM ""UserVisits"") SELECT ""t1"".""user_id"",MAX(ABS(CASE WHEN (""t1"".""dr""=1 AND ""t2"".""dr""=1) THEN CAST('2021-01-01' AS DATE) - ""t2"".""visit_date"" ELSE ""t1"".""visit_date"" - ""t2"".""visit_date"" END)) AS ""biggest_window"" FROM (""t"" AS ""t1"") JOIN ""t"" AS ""t2"" WHERE ""t1"".""user_id""=""t2"".""user_id"" AND (""t1"".""dr""-""t2"".""dr""=1 OR (""t1"".""dr""=1 AND ""t2"".""dr""=1)) GROUP BY ""user_id"" ORDER BY ""user_id"""
105,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""lead1"" FROM ""uservisits"") SELECT ""user_id"",MAX(""lead1"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1"
106,"WITH ""fulltable"" AS (SELECT DISTINCT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT * FROM ""UserVisits"" ORDER BY ""user_id"",""visit_date"") SELECT ""user_id"",MAX(""next_visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""next_visit_date"" FROM ""fulltable"" ORDER BY 1,2) AS ""sub"" GROUP BY 1 ORDER BY 1"
107,"WITH ""cte1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits""), ""cte2"" AS (SELECT ""user_id"",CASE WHEN ""next_date"" IS NOT NULL THEN ABS(""next_date"" - ""visit_date"") ELSE CAST('2021-01-01' AS DATE) - ""visit_date"" END AS ""date_diff"" FROM ""cte1"") SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM ""cte2"" GROUP BY ""user_id"""
108,"SELECT ""user_id"",MAX(""visit_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""visit_window"" FROM ""UserVisits"") AS ""t"" GROUP BY 1 ORDER BY 1"
109,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
110,"SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") AS ""sub"" GROUP BY 1"
111,"WITH ""t"" AS (SELECT *,COALESCE(LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC), '2021-1-1') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
112,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
113,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
114,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
115,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""temp"" GROUP BY 1 ORDER BY 1"
116,"WITH ""CTE1"" AS (SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT DISTINCT ""user_id"",""visit_date"" FROM ""UserVisits""), ""CTE2"" AS (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rks"" FROM ""CTE1""), ""CTE3"" AS (SELECT ""a"".""user_id"",""b"".""visit_date"" - ""a"".""visit_date"" AS ""ct"" FROM (""CTE2"" AS ""a"") JOIN ""CTE2"" AS ""b"" WHERE ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rks""+1=""b"".""rks"") SELECT ""user_id"",MAX(""ct"") AS ""biggest_window"" FROM ""CTE3"" GROUP BY ""user_id"" ORDER BY ""user_id"""
117,"WITH ""cte"" AS (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""uservisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1"
118,"WITH ""cte"" AS (SELECT ""u1"".""user_id"",""u1"".""visit_date"",COUNT(DISTINCT ""u2"".""visit_date"") AS ""rnk"" FROM ""uservisits"" AS ""u1"" LEFT JOIN ""uservisits"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""visit_date"">""u2"".""visit_date"" GROUP BY ""u1"".""user_id"",""u1"".""visit_Date"") SELECT ""l"".""user_id"",MAX(COALESCE(""r"".""visit_Date"", '2021-01-01') - ""l"".""visit_Date"") AS ""biggest_window"" FROM ""cte"" AS ""l"" LEFT JOIN ""cte"" AS ""r"" ON ""l"".""user_id""=""r"".""user_id"" AND ""l"".""rnk""+1=""r"".""rnk"" GROUP BY ""user_id"" ORDER BY ""user_id"""
119,"SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""date_diff"" FROM (SELECT DISTINCT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION SELECT * FROM ""UserVisits"" ORDER BY ""user_id"",""visit_date"") AS ""u"") AS ""t"" GROUP BY ""user_id"""
120,"WITH ""temp"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""temp"" GROUP BY ""user_id"" ORDER BY ""user_id"""
121,"SELECT ""user_id"",MAX(""lagged"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""lagged"" FROM ""UserVisits"") AS ""A"" GROUP BY ""user_id"""
122,"SELECT ""user_id"",MAX(""date2"" - ""date1"") AS ""biggest_window"" FROM (SELECT ""a"".""user_id"",""a"".""visit_date"" AS ""date1"",MIN(COALESCE(""b"".""visit_date"", '2021-1-1')) AS ""date2"" FROM ""UserVisits"" AS ""a"" LEFT JOIN ""UserVisits"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""visit_date""<""b"".""visit_date"" GROUP BY 1,2) AS ""sub"" GROUP BY 1 ORDER BY 1"
123,"WITH ""cte"" AS (SELECT ""user_id"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""windoyw"" FROM ""uservisits"") SELECT ""user_id"",MAX(""windoyw"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
124,"WITH ""windows"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""next_visit"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_visit"" - ""visit_date"") AS ""biggest_window"" FROM ""windows"" GROUP BY ""user_id"""
125,"WITH ""temp0"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""temp0"" AS ""a"" LEFT JOIN ""temp0"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rnk""+1=""b"".""rnk"" GROUP BY 1 ORDER BY 1"
126,"WITH ""step1"" AS (SELECT *,COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date""), '2021-01-01') AS ""lead_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""step1"" GROUP BY ""user_id"""
127,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""temp"" GROUP BY 1"
128,"SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits"") AS ""a"" GROUP BY 1"
129,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rk""=""b"".""rk""-1 GROUP BY 1 ORDER BY 1"
130,"SELECT ""a"".""user_id"",MAX(""a"".""nxt_visit"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""user_id"",""visit_date""), '2021-1-1')) AS ""nxt_visit"" FROM ""uservisits"") AS ""a"" GROUP BY 1"
131,"SELECT ""D"".""user_id"",MAX(""D"".""w"") AS ""biggest_window"" FROM (SELECT ""A"".""user_id"",""B"".""visit_date"" - ""A"".""visit_date"" AS ""w"" FROM (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""indx"" FROM ""UserVisits"") AS ""A"", (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""indx"" FROM ""UserVisits"") AS ""B"" WHERE ""A"".""user_id""=""B"".""user_id"" AND ""A"".""indx""=""B"".""indx""-1 UNION ALL SELECT ""C"".""user_id"",CAST('2021-1-1' AS DATE) - ""C"".""visit_date"" AS ""w"" FROM (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""indx"" FROM ""UserVisits"") AS ""C"" WHERE ""C"".""indx""=1) AS ""D"" GROUP BY ""D"".""user_id"" ORDER BY ""D"".""user_id"""
132,"SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""uservisits"") AS ""a"" GROUP BY 1"
133,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
134,"SELECT ""sub"".""user_id"",MAX(""sub"".""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""sub"" GROUP BY ""sub"".""user_id"" ORDER BY ""sub"".""user_id"""
135,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
136,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rk""=""b"".""rk""-1 GROUP BY 1 ORDER BY 1"
137,"WITH ""CTE"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
138,"SELECT ""user_id"",MAX(""Days"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""days"" FROM ""uservisits"") AS ""tmp"" GROUP BY ""user_id"""
139,"WITH ""r"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextvisit"" FROM ""UserVisits"" ORDER BY ""visit_date"") SELECT ""user_id"",MAX(""nextvisit"" - ""visit_date"") AS ""biggest_window"" FROM ""r"" GROUP BY ""user_id"" ORDER BY ""user_id"""
140,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_day"" FROM ""uservisits"") SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",""next_day"" - ""visit_date"" AS ""windows"" FROM ""cte"") AS ""a"" GROUP BY 1 ORDER BY ""user_id"""
141,"WITH ""CTE"" AS (SELECT *,LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""prev_date"",COUNT(""user_id"") OVER (PARTITION BY ""user_id"") AS ""cnt"" FROM (SELECT * FROM ""UserVisits"" UNION ALL SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""UserVisits"") AS ""a"") SELECT ""user_id"",MAX(""visit_date"" - ""prev_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY 1 ORDER BY 1"
142,"SELECT ""user_id"",MAX(TIMESTAMPDIFF(DAY, ""visit_date"", CASE WHEN ""post_date"" IS NULL THEN '2021-01-01' ELSE ""post_date"" END)) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""post_date"" FROM ""userVisits"") AS ""A"" GROUP BY ""user_id"""
143,"WITH ""CTE"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
144,"WITH ""CTE"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
145,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""visit2"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""visit2"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1"
146,"WITH ""tmp"" AS (SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""uservisits"" UNION ALL SELECT ""user_id"",""visit_date"" FROM ""uservisits""), ""tmp2"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextvisit"" FROM ""tmp""), ""tmp3"" AS (SELECT ""user_id"",""nextvisit"" - ""visit_date"" AS ""windowdate"" FROM ""tmp2"") SELECT DISTINCT ""user_id"",MAX(""windowdate"") AS ""biggest_window"" FROM ""tmp3"" GROUP BY ""user_id"" ORDER BY ""user_id"""
147,"SELECT ""user_id"",MAX(""datediff"") AS ""biggest_window"" FROM (SELECT ""user_id"",CASE WHEN ""nextdate"" IS NULL THEN CAST('2021-01-01' AS DATE) - ""visit_date"" ELSE ""nextdate"" - ""visit_date"" END AS ""datediff"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextdate"" FROM ""uservisits"") AS ""a"") AS ""b"" GROUP BY ""user_id"""
148,"WITH ""U"" AS (SELECT *,RANK() OVER (PARTITION BY ""V"".""user_id"" ORDER BY ""V"".""visit_date"") AS ""rk"" FROM (SELECT * FROM ""UserVisits"" UNION SELECT DISTINCT ""user_id"",'2021-1-1' FROM ""UserVisits"") AS ""V""), ""D"" AS (SELECT ""U1"".""user_id"",""U1"".""visit_date"" - ""U2"".""visit_date"" AS ""df"" FROM ""U"" AS ""U1"" JOIN ""U"" AS ""U2"" ON ""U1"".""user_id""=""U2"".""user_id"" AND ""U1"".""rk""=""U2"".""rk""+1) SELECT ""D"".""user_id"",MAX(""D"".""df"") AS ""biggest_window"" FROM ""D"" GROUP BY ""D"".""user_id"" ORDER BY ""D"".""user_id"""
149,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(ABS(""visit_date"" - ""next_visit_date"")) AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
150,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"" FROM ""UserVisits"" UNION ALL SELECT DISTINCT ""user_id"",'2021-01-01' FROM ""UserVisits""), ""cte2"" AS (SELECT ""user_id"",""visit_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""cte"") SELECT ""c1"".""user_id"",MAX(""c2"".""visit_date"" - ""c1"".""visit_date"") AS ""biggest_window"" FROM ""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""rnk""=""c2"".""rnk""-1 GROUP BY ""c1"".""user_id"""
151,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
152,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
153,"SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",""previous_date"",""previous_date"" - ""visit_date"" AS ""days"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""previous_date"" FROM ""UserVisits"") AS ""tmp"") AS ""tmp2"" GROUP BY ""user_id"""
154,"SELECT ""user_id"",MAX(""visit_date"" - ""prev_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""prev_date"" FROM (SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""uservisits"" UNION ALL SELECT * FROM ""uservisits"" ORDER BY ""user_id"",""visit_date"") AS ""t"") AS ""z"" GROUP BY 1"
155,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
156,"WITH ""cte"" AS (SELECT *,COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), CAST('2021-01-01' AS DATE)) AS ""leadd"" FROM ""UserVisits"" ORDER BY 1,2) SELECT ""user_id"",MAX(""day_diff"") AS ""biggest_window"" FROM (SELECT *,""leadd"" - ""visit_date"" AS ""day_diff"" FROM ""cte"") AS ""sub11"" GROUP BY ""user_id"""
157,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"""
158,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""tmp"" GROUP BY 1 ORDER BY 1"
159,"WITH ""table1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""table1"" GROUP BY ""user_id"" ORDER BY ""user_id"""
160,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
161,"WITH ""VISIT_INFO"" AS (SELECT ""USER_ID"",COALESCE(LEAD(""VISIT_DATE"") OVER (PARTITION BY ""USER_ID"" ORDER BY ""VISIT_DATE""), '2021-1-1') - ""VISIT_DATE"" AS ""VISIT_WINDOW"" FROM ""USERVISITS"") SELECT ""USER_ID"",MAX(""VISIT_WINDOW"") AS ""BIGGEST_WINDOW"" FROM ""VISIT_INFO"" GROUP BY ""USER_ID"" ORDER BY ""USER_ID"""
162,"WITH ""cte"" AS (SELECT ""c"".""user_id"",""c"".""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""USER_ID"" ORDER BY ""VISIT_DATE"") AS ""RK"" FROM (SELECT ""b"".""user_id"",""a"".""visit_date"" FROM (SELECT '2021-01-01' AS ""visit_date"") AS ""a"" JOIN (SELECT DISTINCT ""user_id"" FROM ""uservisits"") AS ""b"" UNION SELECT * FROM ""uservisits"") AS ""c"") SELECT ""c1"".""user_id"",MAX(""c1"".""visit_date"" - ""c2"".""visit_date"") AS ""biggest_window"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""rk""=""c2"".""rk""+1 GROUP BY ""c1"".""user_id"""
163,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
164,"WITH ""temp"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""UserVisits""), ""temp2"" AS (SELECT ""user_id"",COALESCE(""next_visit"", '2021-1-1') - ""visit_date"" AS ""window_day"" FROM ""temp"") SELECT ""user_id"",MAX(""window_day"") AS ""biggest_window"" FROM ""temp2"" GROUP BY 1"
165,"WITH ""tbl"" AS (SELECT ""user_id"",""visit_date"" FROM ""UserVisits"" ORDER BY ""visit_date"") SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""days"" FROM ""tbl"") AS ""BASE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
166,"WITH ""DaysSinceJan1"" AS (SELECT ""user_id"",CAST('2021-01-01' AS DATE) - MAX(""visit_date"") AS ""biggest_window"" FROM ""UserVisits"" GROUP BY ""user_id""), ""UserVisitsWithRowNumber"" AS (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""row_num"" FROM ""UserVisits""), ""UserVisitsWindow"" AS (SELECT ""U1"".""user_id"",""U1"".""visit_date"" - ""U2"".""visit_date"" AS ""biggest_window"" FROM ""UserVisitsWithRowNumber"" AS ""U1"" JOIN ""UserVisitsWithRowNumber"" AS ""U2"" ON ""U1"".""user_id""=""U2"".""user_id"" AND ""U1"".""row_num""=""U2"".""row_num""+1), ""UnionTable"" AS (SELECT ""user_id"",""biggest_window"" FROM ""DaysSinceJan1"" UNION ALL SELECT ""user_id"",""biggest_window"" FROM ""UserVisitsWindow"") SELECT ""user_id"",MAX(""biggest_window"") AS ""biggest_window"" FROM ""UnionTable"" GROUP BY ""user_id"""
167,"WITH ""cte"" AS (SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""userVisits"" UNION ALL SELECT ""user_id"",""visit_date"" FROM ""uservisits"" ORDER BY ""user_id"",""visit_date"") SELECT DISTINCT ""user_id"",MAX(""diff"") OVER (PARTITION BY ""user_id"") AS ""biggest_window"" FROM (SELECT ""user_id"",""l1"" - ""visit_date"" AS ""diff"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""l1"" FROM ""cte"") AS ""c"") AS ""v"""
168,"WITH ""cte1"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits""), ""cte2"" AS (SELECT ""user_id"",CASE WHEN ""next_date"" IS NOT NULL THEN ABS(""next_date"" - ""visit_date"") ELSE CAST('2021-01-01' AS DATE) - ""visit_date"" END AS ""date_diff"" FROM ""cte1"") SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM ""cte2"" GROUP BY ""user_id"""
169,"SELECT ""user_id"",MAX(""window1"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1')) AS ""window1"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY 1"
170,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_Date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
171,"WITH ""cte"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
172,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""temp"" GROUP BY ""user_id"" ORDER BY ""user_id"""
173,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""rnk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-1-1') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""b"".""rnk""=""a"".""rnk""-1 GROUP BY ""a"".""user_id"" ORDER BY ""user_id"""
174,"SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",""previous_date"",CASE WHEN ""previous_date"" IS NULL THEN TO_CHAR('2021-1-1', 'YYYY-%m-%d') ELSE ""previous_date"" END - ""visit_date"" AS ""days"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""previous_date"" FROM ""UserVisits"") AS ""tmp"") AS ""tmp2"" GROUP BY ""user_id"""
175,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
176,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""f"" GROUP BY 1 ORDER BY 1"
177,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"") AS ""SUB"" GROUP BY 1"
178,"SELECT ""w"".""user_id"",MAX(""w"".""diffs"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""diffs"" FROM ""UserVisits"") AS ""w"" GROUP BY 1"
179,"WITH ""cte1"" AS (SELECT ""user_id"",""visit_date"" AS ""fv"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""fr"" FROM ""uservisits""), ""cte2"" AS (SELECT ""user_id"",""visit_date"" AS ""nv"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nr"" FROM ""uservisits"") SELECT ""FINAL"".""user_id"",MAX(""FINAL"".""biggest_window"") AS ""biggest_window"" FROM (SELECT ""sf"".""user_id"",""sf"".""fr"",""sf"".""fv"",""sf"".""nv"" - ""sf"".""fv"" AS ""biggest_window"" FROM (SELECT ""cte1"".""user_id"",""cte1"".""fr"",""cte1"".""fv"",COALESCE(""cte2"".""nv"", '2021-1-1') AS ""nv"" FROM ""cte1"" LEFT JOIN ""cte2"" ON ""cte1"".""user_id""=""cte2"".""user_id"" AND ""cte1"".""fr""+1=""cte2"".""nr"") AS ""SF"") AS ""FINAL"" GROUP BY 1 ORDER BY 1"
180,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
181,"SELECT ""user_id"",MAX(""day_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""day_diff"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
182,"SELECT ""user_id"",MAX(""window_length"") AS ""biggest_window"" FROM (SELECT ""user_id"",""next_visit"" - ""visit_date"" AS ""window_length"" FROM (SELECT COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""USER_ID"" ORDER BY ""visit_date""), TO_CHAR('2021-1-1', 'YYYY-%m-%d')) AS ""next_visit"",""visit_date"",""user_id"" FROM ""UserVisits"") AS ""z"") AS ""zz"" GROUP BY 1"
183,"WITH ""t"" AS (SELECT ""user_id"",DATE('2021-1-1') AS ""visit_date"" FROM (SELECT DISTINCT ""user_id"" FROM ""UserVisits"") AS ""t"" UNION ALL SELECT * FROM ""UserVisits"") SELECT ""user_id"",MAX(""win"") AS ""biggest_window"" FROM (SELECT *,""visit_date"" - LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""win"" FROM ""t"") AS ""t1"" GROUP BY ""user_id"""
184,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-01-01') - ""visit_date"" AS ""windows"" FROM ""uservisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
185,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT ""t1"".""user_id"",MAX(COALESCE(""t2"".""visit_date"", '2021-1-1') - ""t1"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""rnk""=""t2"".""rnk""-1 GROUP BY 1 ORDER BY 1"
186,"SELECT ""user_id"",MAX(""window1"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1')) AS ""window1"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
187,"SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits"") AS ""a"" GROUP BY 1"
188,"SELECT ""user_id"",MAX(""next_visit"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"",""visit_date"" FROM ""uservisits"") AS ""t1"" GROUP BY ""user_id"" ORDER BY ""user_id"""
189,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
190,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
191,"WITH ""cte"" AS (SELECT DISTINCT (""user_id"") AS ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT ""user_id"",""visit_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""visit_date"" - ""prior_visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""prior_visit_date"" FROM ""cte"") AS ""t"" WHERE ""prior_visit_date"" IS NOT NULL GROUP BY 1 ORDER BY 1"
192,"WITH ""tb1"" AS (SELECT *,LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits""), ""tb2"" AS (SELECT ""user_id"",""visit_date"",CASE WHEN ""next_date"" IS NULL THEN '2021-01-01' ELSE ""next_date"" END AS ""next_date"" FROM ""tb1""), ""tb3"" AS (SELECT *,ABS(""visit_date"" - ""next_date"") AS ""diff"" FROM ""tb2"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""tb3"" GROUP BY ""user_id"""
193,"SELECT ""t"".""user_id"",MAX(""t"".""next_visit"" - ""t"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"",""user_id"" FROM ""UserVisits"") AS ""t"" GROUP BY ""t"".""user_id"""
194,"WITH ""cte"" AS (SELECT ""user_id"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""visit_window"" FROM ""UserVisits"") SELECT DISTINCT ""user_id"",""visit_window"" AS ""biggest_window"" FROM (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_window"" DESC) AS ""rnk"" FROM ""cte"") AS ""t"" WHERE ""rnk""=1 ORDER BY 1"
195,"SELECT ""x"".""user_id"",MAX(ABS(""x"".""date_2"" - ""x"".""date_1"")) AS ""biggest_window"" FROM (SELECT ""u2"".""user_id"",""u2"".""visit_date"" AS ""date_1"",MAX(""u1"".""visit_date"") AS ""date_2"" FROM ""uservisits"" AS ""u1"" JOIN ""uservisits"" AS ""u2"" ON ""u1"".""visit_date""<""u2"".""visit_date"" AND ""u1"".""user_id""=""u2"".""user_id"" GROUP BY ""u2"".""visit_date"",""u2"".""user_id"" UNION SELECT ""user_id"",MAX(""visit_date"") AS ""date_1"",'2021-1-1' AS ""date_2"" FROM ""uservisits"" GROUP BY ""user_id"") AS ""x"" GROUP BY 1 ORDER BY 1,2"
196,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""t"" GROUP BY 1 ORDER BY 1"
197,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), CAST('2021-01-01' AS DATE)) AS ""next_date"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
198,"WITH ""temp"" AS (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rn"" FROM ""UserVisits"") SELECT ""t1"".""user_id"",MAX(COALESCE(""t2"".""visit_date"", '2021-1-1') - ""t1"".""visit_date"") AS ""biggest_window"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""rn""+1=""t2"".""rn"" GROUP BY ""t1"".""user_id"" ORDER BY ""t1"".""user_id"""
199,"SELECT ""user_id"",MAX(""window2"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1')) AS ""window2"" FROM ""uservisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
200,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rk""=""b"".""rk""-1 GROUP BY 1 ORDER BY 1"
201,"WITH ""cte"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""w"" FROM ""uservisits"") SELECT ""user_id"",MAX(""w"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"" ORDER BY ""user_id"""
202,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",""previous_visit"" - ""visit_date"" AS ""diff"" FROM (SELECT ""user_id"",""visit_date"",""rn"",CASE WHEN ""rn""=1 THEN '2021-01-01' ELSE ""prev_visit"" END AS ""previous_visit"" FROM (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""rn"",LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""prev_visit"" FROM ""UserVisits"") AS ""A"") AS ""B"") AS ""C"" GROUP BY ""user_id"""
203,"SELECT ""user_id"",MAX(CASE WHEN ""user_id""=""lead_user"" THEN ""lead_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_user"" FROM ""UserVisits"" ORDER BY ""user_id"") AS ""t"" GROUP BY ""user_id"""
204,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-01-01') - ""visit_date"" AS ""windows"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
205,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
206,"WITH ""t2"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_day"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_day"" - ""visit_date"") AS ""biggest_window"" FROM ""t2"" GROUP BY ""user_id"""
207,"WITH ""data"" AS (SELECT ""user_id"",""visit_date"",CASE WHEN ""user_id""=@""id"" THEN @""row_number"":=@""row_number""+1 WHEN ""user_id""!=@""id"" THEN @""row_number"":=1 END AS ""rownumber"",@""id"":=""user_id"" FROM (""uservisits"" AS ""u"") JOIN (SELECT @""row_number"":=0,@""id"":=0) AS ""r1"" ORDER BY ""user_id"",""visit_date"") SELECT ""d1"".""user_id"",GREATEST(COALESCE(MAX(""d1"".""visit_date"" - ""d2"".""visit_date""), 0), CAST('2021-01-01' AS DATE) - MAX(""d1"".""visit_date"")) AS ""biggest_window"" FROM ""data"" AS ""d1"" LEFT JOIN ""data"" AS ""d2"" ON ""d1"".""user_id""=""d2"".""user_id"" AND ""d1"".""rownumber""-""d2"".""rownumber""=1 GROUP BY ""d1"".""user_id"" ORDER BY ""d1"".""user_id"""
208,"WITH ""cte"" AS (SELECT *,LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nxt_date"" FROM ""uservisits"" AS ""v""), ""cte2"" AS (SELECT ""user_id"",COALESCE(""nxt_date"" - ""visit_date"", CAST('2021-01-01' AS DATE) - ""visit_date"") AS ""windows"" FROM ""cte"") SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM ""cte2"" GROUP BY 1"
209,"WITH ""temp"" (""user_id"", ""visit_date"", ""ldate"") AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""ldate"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""ldate"" - ""visit_date"") AS ""biggest_window"" FROM ""temp"" GROUP BY ""user_id"""
210,"SELECT ""user_id"",MAX(CASE WHEN ""user_id""=""lead_user"" THEN ""lead_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_user"" FROM ""UserVisits"" ORDER BY ""user_id"") AS ""t"" GROUP BY ""user_id"""
211,"SELECT ""user_id"",ABS(MAX(""next_date"" - ""visit_date"")) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"") AS ""tb1"" GROUP BY 1"
212,"WITH ""t"" AS (SELECT ""user_id"",DATE('2021-1-1') AS ""visit_date"" FROM (SELECT DISTINCT ""user_id"" FROM ""UserVisits"") AS ""t"" UNION ALL SELECT * FROM ""UserVisits"") SELECT ""user_id"",MAX(""win"") AS ""biggest_window"" FROM (SELECT *,""visit_date"" - LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""win"" FROM ""t"") AS ""t1"" GROUP BY ""user_id"""
213,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
214,"SELECT ""user_id"",MAX(""biggest_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""biggest_window"" FROM ""userVisits"") AS ""a"" GROUP BY 1 ORDER BY 1"
215,"SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_visit_date"" FROM ""uservisits"") AS ""a"" GROUP BY 1 ORDER BY 1"
216,"WITH ""visits"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_visits"" FROM ""UserVisits"") SELECT ""user_id"",MAX(ABS(""visit_date"" - ""lead_visits"")) AS ""biggest_window"" FROM ""visits"" GROUP BY ""user_id"" ORDER BY ""user_id"""
217,"SELECT ""user_id"",MAX(CASE WHEN ""user_id""=""lead_user"" THEN ""lead_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_user"" FROM ""UserVisits"" ORDER BY ""user_id"") AS ""t"" GROUP BY ""user_id"""
218,"WITH ""window3"" AS (SELECT ""user_id"",DATE('2021-1-1') - MAX(""visit_date"") AS ""window3"",MAX(""visit_date"") AS ""mx"" FROM ""uservisits"" GROUP BY ""user_id""), ""temp"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""uservisits""), ""window2"" AS (SELECT ""t1"".""user_id"",""t2"".""visit_date"" - ""t1"".""visit_date"" AS ""window2"" FROM ""temp"" AS ""t1"" JOIN ""temp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""rnk""=""t2"".""rnk""-1), ""window1"" AS (SELECT ""user_id"",""window3"" FROM ""window3"" UNION ALL SELECT ""user_id"",""window2"" FROM ""window2"") SELECT ""user_id"",MAX(""window3"") AS ""biggest_window"" FROM ""window1"" GROUP BY ""user_id"" ORDER BY ""user_id"""
219,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""df"" FROM ""userVisits"") SELECT ""user_id"",MAX(""df"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1 ORDER BY 1"
220,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
221,"WITH ""ct"" AS (SELECT ""user_id"",""visit_date"",""nxt_dt"",ABS(""visit_date"" - ""nxt_dt"") AS ""diff"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""nxt_dt"" FROM ""UserVisits"") AS ""tmp"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""ct"" GROUP BY ""user_id"""
222,"SELECT ""user_id"",MAX(""lead_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_visit_date"" FROM ""UserVisits"") AS ""tmpt"" GROUP BY 1"
223,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits"") AS ""asd"" GROUP BY ""user_id"""
224,"WITH ""current_date_cte"" AS (SELECT ""user_id"",""visit_date"" FROM ""UserVisits"" UNION SELECT DISTINCT ""user_id"",DATE('2021-01-01') FROM ""UserVisits""), ""date_diff"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, 0) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""current_date_cte"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""date_diff"" GROUP BY 1"
225,"WITH ""cte1"" AS (SELECT * FROM (SELECT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION SELECT ""user_id"",""visit_date"" FROM ""UserVisits"") AS ""t"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",""following_date"" - ""visit_date"" AS ""diff"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""following_date"" FROM ""cte1"") AS ""v"") AS ""s"" GROUP BY ""user_id"""
226,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC), '2021-01-01') AS ""lag_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lag_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
227,"SELECT ""a"".""user_id"",MAX(""b"".""visit_date"" - ""a"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""ind"" FROM (SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""UserVisits"" UNION (SELECT * FROM ""UserVisits"")) AS ""aa"") AS ""a"" LEFT JOIN (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""ind"" FROM (SELECT DISTINCT ""user_id"",'2021-01-01' AS ""visit_date"" FROM ""UserVisits"" UNION (SELECT * FROM ""UserVisits"")) AS ""bb"") AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""ind""+1=""b"".""ind"" GROUP BY ""a"".""user_id"""
228,"SELECT ""t"".""user_id"",MAX(""t"".""next_visit_date"" - ""t"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits"") AS ""t"" GROUP BY 1 ORDER BY 1"
229,"WITH ""a"" AS (SELECT *,COALESCE(LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC), '2021-1-1') - ""visit_date"" AS ""biggest_window"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""biggest_window"") AS ""biggest_window"" FROM ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
230,"SELECT ""t"".""user_id"",MAX(""t"".""next_visit_date"" - ""t"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""uservisits"") AS ""t"" GROUP BY ""t"".""user_id"" ORDER BY ""t"".""user_id"""
231,"SELECT ""user_id"",MAX(""fc"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""fc"" FROM ""UserVisits"") AS ""s"" GROUP BY ""user_id"" ORDER BY ""user_id"""
232,"WITH ""CTE"" AS (SELECT *,COALESCE(LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC), '2021-1-1') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
233,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-01-01') - ""visit_date"" AS ""windows"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
234,"WITH ""temp"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""temp"" GROUP BY ""user_id"""
235,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
236,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""t"" GROUP BY 1"
237,"SELECT ""user_id"",MAX(""next_visit"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_visit"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
238,"WITH ""new"" AS (SELECT *,COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""newdate"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""newdate"" - ""visit_date"") AS ""biggest_window"" FROM ""new"" GROUP BY 1"
239,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"" ORDER BY ""user_id"""
240,"WITH ""visits"" AS (SELECT ""user_id"",""visit_date"",""next_visit"",""next_visit"" - ""visit_date"" AS ""diff"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""UserVisits"") AS ""T"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""visits"" GROUP BY ""user_id"""
241,"WITH ""cte"" AS (SELECT ""user_id"",COALESCE(LAG(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC), '2021-1-1') - ""visit_date"" AS ""previousday"" FROM ""UserVisits"") SELECT ""cte"".""user_id"",MAX(""previousday"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""cte"".""user_id"" ORDER BY ""cte"".""user_id"""
242,"WITH ""tmp"" AS (SELECT ""user_id"",""visit_date"" FROM ""uservisits"" ORDER BY ""visit_date""), ""tmp1"" AS (SELECT ""user_id"",""visit_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""id"" FROM ""tmp""), ""tmp2"" AS (SELECT ""a"".""user_id"",MAX(""a"".""visit_date"" - ""b"".""visit_date"") AS ""biggest_window"" FROM ""tmp1"" AS ""a"" JOIN ""tmp1"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""id""=""b"".""id""+1 GROUP BY ""a"".""user_id""), ""tmp3"" AS (SELECT ""user_id"",CAST('2021-01-01' AS DATE) - MAX(""visit_date"") AS ""biggest_window"" FROM ""uservisits"" GROUP BY ""user_id"") SELECT ""a"".""user_id"",CASE WHEN ""b"".""biggest_window"" IS NULL OR ""b"".""biggest_window""<""a"".""biggest_window"" THEN ""a"".""biggest_window"" ELSE ""b"".""biggest_window"" END AS ""biggest_window"" FROM ""tmp3"" AS ""a"" LEFT JOIN ""tmp2"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" ORDER BY ""user_id"""
243,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"" FROM ""UserVisits"" UNION ALL SELECT DISTINCT ""user_id"",'2021-01-01' FROM ""UserVisits""), ""cte2"" AS (SELECT ""user_id"",""visit_date"",DENSE_RANK() OVER (ORDER BY ""user_id"",""visit_date"") AS ""rnk"" FROM ""cte"") SELECT ""c1"".""user_id"",MAX(""c2"".""visit_date"" - ""c1"".""visit_date"") AS ""biggest_window"" FROM ""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""rnk""=""c2"".""rnk""-1 GROUP BY ""c1"".""user_id"""
244,"WITH ""tmp1"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""ranks"" FROM ""UserVisits""), ""prep"" AS (SELECT ""t1"".""user_id"",COALESCE(""t2"".""visit_date"" - ""t1"".""visit_date"", DATE('2021-01-01') - ""t1"".""visit_date"") AS ""days"" FROM ""tmp1"" AS ""t1"" LEFT JOIN ""tmp1"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t2"".""ranks""=""t1"".""ranks""+1), ""prep2"" AS (SELECT ""user_id"",""days"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""days"" DESC) AS ""ranks2"" FROM ""prep"") SELECT ""user_id"",""days"" AS ""biggest_window"" FROM ""prep2"" WHERE ""ranks2""=1 GROUP BY 1,2"
245,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""lead_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"" ORDER BY ""user_id"""
246,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""T"" GROUP BY ""user_id"""
247,"SELECT ""user_id"",MAX(COALESCE(""nextVisit"", '2021-1-1') - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextVisit"" FROM ""uservisits"" ORDER BY ""user_id"") AS ""A"" GROUP BY ""user_id"""
248,"WITH ""t"" AS (SELECT DISTINCT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT ""user_id"",""visit_date"" FROM ""UserVisits""), ""tmp"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rk"" FROM ""t"") SELECT ""t1"".""user_id"",MAX(""t2"".""visit_date"" - ""t1"".""visit_date"") AS ""biggest_window"" FROM ""tmp"" AS ""t1"" JOIN ""tmp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""rk""=""t2"".""rk""-1 GROUP BY 1"
249,"SELECT ""user_id"",MAX(""window1"") AS ""biggest_window"" FROM (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1')) AS ""window1"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY 1"
250,"SELECT ""user_id"",MAX(""biggest_window"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""biggest_window"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"""
251,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""UserVisits"" AS ""u"") AS ""a"" GROUP BY ""user_id"""
252,"WITH ""NextVisitDate"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits""), ""VisitWindow"" AS (SELECT ""user_id"",""next_visit_date"" - ""visit_date"" AS ""DaysBetweenVisits"" FROM ""NextVisitDate"") SELECT ""user_id"",MAX(""DaysBetweenVisits"") AS ""biggest_window"" FROM ""VisitWindow"" GROUP BY ""user_id"" ORDER BY 1"
253,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"",DATE('2021-1-1') AS ""today"" FROM ""uservisits"" ORDER BY 1,2) SELECT ""user_id"",MAX(CASE WHEN ""next_visit_date"" IS NULL THEN ""today"" - ""visit_date"" ELSE ""next_visit_date"" - ""visit_date"" END) AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"" ORDER BY ""user_id"""
254,"SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""UserVisits"") AS ""temp"" GROUP BY 1"
255,"SELECT ""user_id"",MAX(ABS(""l"" - ""visit_date"")) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LAG(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""l"" FROM (SELECT * FROM ""uservisits"" ORDER BY ""user_id"",""visit_date"" DESC) AS ""w"") AS ""t"" GROUP BY ""user_id"""
256,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""v1"".""user_id"",""v1"".""visit_date"",COALESCE(MIN(""v2"".""visit_date""), '2021-1-1') AS ""next_date"" FROM ""UserVisits"" AS ""v1"" LEFT JOIN ""UserVisits"" AS ""v2"" ON ""v2"".""user_id""=""v1"".""user_id"" AND ""v2"".""visit_date"">""v1"".""visit_date"" GROUP BY ""v1"".""user_id"",""v1"".""visit_date"") AS ""t"" GROUP BY ""user_id"""
257,"SELECT ""user_id"",MAX(CASE WHEN ""user_id""=""lead_user"" THEN ""lead_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_user"" FROM ""UserVisits"" ORDER BY ""user_id"") AS ""t"" GROUP BY ""user_id"""
258,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_Date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""a"" GROUP BY 1"
259,"SELECT ""t"".""user_id"",MAX(""t"".""next_visit_date"" - ""t"".""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""uservisits"") AS ""t"" GROUP BY ""t"".""user_id"" ORDER BY ""t"".""user_id"""
260,"SELECT ""user_id"",MAX(""visit_date2"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""visit_date2"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"""
261,"SELECT ""user_id"",CASE WHEN CAST('2021-1-1' AS DATE) - MAX(""visit_date"")<COALESCE(MAX(""diff""), 0) THEN COALESCE(MAX(""diff""), 0) ELSE CAST('2021-1-1' AS DATE) - MAX(""visit_date"") END AS ""biggest_window"" FROM (SELECT *,""visit_date"" - LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""diff"" FROM ""uservisits"" ORDER BY ""user_id"",""visit_date"" DESC) AS ""ff"" GROUP BY ""user_id"""
262,"WITH ""A"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""new"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""new"") AS ""biggest_window"" FROM ""A"" GROUP BY ""user_id"" ORDER BY ""user_id"""
263,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-01-01') - ""visit_date"" AS ""windows"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
264,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""uservisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-1-1') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rnk""=""b"".""rnk""-1 GROUP BY 1 ORDER BY 1"
265,"WITH ""A"" AS (SELECT * FROM ""UserVisits"" ORDER BY ""user_id"",""visit_date""), ""B"" AS (SELECT *,LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""A""), ""C"" AS (SELECT *,CASE WHEN ""next_visit"" IS NULL THEN CAST('2021-01-01' AS DATE) - ""visit_date"" ELSE ""next_visit"" - ""visit_date"" END AS ""windows"" FROM ""B"") SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM ""C"" GROUP BY ""user_id"""
266,"SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""date_diff"" FROM (SELECT DISTINCT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION SELECT * FROM ""UserVisits"" ORDER BY ""user_id"",""visit_date"") AS ""u"") AS ""t"" GROUP BY ""user_id"""
267,"WITH ""CTE"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""window_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""window_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"""
268,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""t"" GROUP BY 1 ORDER BY 1"
269,"SELECT ""user_id"",MAX(""widow"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') - ""visit_date"" AS ""widow"" FROM ""UserVisits"") AS ""x"" GROUP BY ""user_id"""
270,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"" FROM ""UserVisits"" UNION ALL SELECT DISTINCT ""user_id"",'2021-01-01' FROM ""UserVisits""), ""cte2"" AS (SELECT ""user_id"",""visit_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""cte"") SELECT ""c1"".""user_id"",MAX(""c2"".""visit_date"" - ""c1"".""visit_date"") AS ""biggest_window"" FROM ""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""rnk""=""c2"".""rnk""-1 GROUP BY ""c1"".""user_id"""
271,"SELECT ""user_id"",MAX(""win"") AS ""biggest_window"" FROM (SELECT ""user_id"",(LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")) - ""visit_date"" AS ""win"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
272,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",CASE WHEN LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") IS NULL THEN CAST('2021-01-01' AS DATE) - ""visit_date"" ELSE LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" END AS ""diff"" FROM ""UserVisits"") AS ""A"" GROUP BY ""user_id"""
273,"WITH ""t_date"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""dif"" FROM ""UserVisits"" ORDER BY 1,2 DESC) SELECT ""user_id"",MAX(""dif"") AS ""biggest_window"" FROM ""t_date"" GROUP BY 1 ORDER BY 1"
274,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
275,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""rnk"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-1-1') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""rnk""=""b"".""rnk""-1 GROUP BY 1 ORDER BY 1"
276,"WITH ""cte1"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""next_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte1"" GROUP BY ""user_id"" ORDER BY ""user_id"""
277,"WITH ""getVisits"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""lead_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""getVisits"" GROUP BY 1"
278,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
279,"WITH ""cte"" AS (SELECT *,CASE WHEN LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") IS NULL THEN '2021-1-1' ELSE LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") END AS ""lead_visit"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lead_visit"" - ""visit_date"") AS ""biggest_window"" FROM ""cte"" GROUP BY 1"
280,"WITH ""T0"" AS (SELECT * FROM ""UserVisits"" UNION SELECT DISTINCT ""user_id"",'2021-1-1' AS ""visit_date"" FROM ""UserVisits""), ""T1"" AS (SELECT *,LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""visit_date_lead"" FROM ""T0""), ""T2"" AS (SELECT ""user_id"",COALESCE(ABS(""visit_date_lead"" - ""visit_date""), 0) AS ""diff"" FROM ""T1"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""T2"" GROUP BY ""user_id"" ORDER BY ""user_id"""
281,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
282,"SELECT ""user_id"",MAX(""nxtvisit"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nxtvisit"" FROM ""UserVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
283,"WITH ""t1"" AS (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""t1"" GROUP BY ""user_id"" ORDER BY ""user_id"""
284,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextvisit"" FROM ""uservisits"") SELECT ""user_id"",MAX(TIMESTAMPDIFF(DAY, ""visit_date"", ""nextvisit"")) AS ""biggest_window"" FROM ""cte"" GROUP BY 1"
285,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_date"" FROM ""uservisits""), ""demo"" AS (SELECT ""user_id"",""next_date"" - ""visit_date"" AS ""diff"" FROM ""cte"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""demo"" GROUP BY ""user_id"""
286,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
287,"WITH ""cte"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC) AS ""order_rank"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""order_lead"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""difference"") AS ""biggest_window"" FROM (SELECT ""user_id"",CASE WHEN ""order_rank""=1 THEN ABS(""visit_date"" - CAST('2021-1-1' AS DATE)) WHEN ""order_rank""!=1 THEN ABS(""visit_date"" - ""order_lead"") END AS ""difference"" FROM ""cte"") AS ""f"" GROUP BY ""user_id"""
288,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"") AS ""temp"" GROUP BY 1 ORDER BY 1"
289,"SELECT ""user_id"",MAX(ABS(CASE WHEN ""next_visit"" IS NOT NULL THEN ""visit_date"" - ""next_visit"" ELSE 0 END)) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""UserVisits"" AS ""uv"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
290,"SELECT ""user_id"",MAX(""second_visit"" - ""first_visit"") AS ""biggest_window"" FROM (SELECT ""t1"".""user_id"",""t1"".""visit_date"" AS ""first_visit"",MIN(""t2"".""visit_date"") AS ""second_visit"" FROM ""UserVisits"" AS ""t1"" JOIN (SELECT DISTINCT (""user_id""),'2021-1-1' AS ""visit_date"" FROM ""UserVisits"" UNION ALL SELECT * FROM ""UserVisits"") AS ""t2"" ON ""t1"".""visit_date""<""t2"".""visit_date"" AND ""t1"".""user_id""=""t2"".""user_id"" GROUP BY ""t1"".""user_id"",""t1"".""visit_date"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
291,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""tr"" FROM ""UserVisits"") SELECT ""a"".""user_id"",MAX(COALESCE(""b"".""visit_date"", '2021-01-01') - ""a"".""visit_date"") AS ""biggest_window"" FROM ""t"" AS ""a"" LEFT JOIN ""t"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""tr""+1=""b"".""tr"" GROUP BY ""user_id"" ORDER BY ""user_id"""
292,"SELECT ""user_id"",MAX(""next_one"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""a"".""user_id"",""a"".""visit_date"",MIN(COALESCE(""b"".""visit_date"", '2021-1-1')) AS ""next_one"" FROM ""UserVisits"" AS ""a"" LEFT JOIN ""UserVisits"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""visit_date""<""b"".""visit_date"" GROUP BY ""a"".""user_id"",""a"".""visit_date"") AS ""a"" GROUP BY ""user_id"""
293,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
294,"SELECT ""user_id"",MAX(CASE WHEN ""user_id""=""lead_user"" THEN ""lead_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_user"" FROM ""UserVisits"" ORDER BY ""user_id"") AS ""t"" GROUP BY ""user_id"""
295,"WITH ""t"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""last_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""last_date"" - ""visit_date"") AS ""biggest_window"" FROM ""t"" GROUP BY 1 ORDER BY ""user_id"""
296,"WITH ""CET"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""RK"" FROM ""UserVisits"") SELECT ""C1"".""user_id"",MAX(COALESCE(""C2"".""visit_date"", '2021-1-1') - ""C1"".""visit_date"") AS ""biggest_window"" FROM ""CET"" AS ""C1"" LEFT JOIN ""CET"" AS ""C2"" ON ""C1"".""user_id""=""C2"".""user_id"" AND ""C1"".""RK""=""C2"".""RK""-1 GROUP BY 1 ORDER BY 1"
297,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""a"" GROUP BY ""user_id"" ORDER BY ""user_id"""
298,"SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",""previous_date"",CASE WHEN ""previous_date"" IS NULL THEN TO_CHAR('2021-1-1', 'YYYY-%m-%d') ELSE ""previous_date"" END - ""visit_date"" AS ""days"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""previous_date"" FROM ""UserVisits"") AS ""tmp"") AS ""tmp2"" GROUP BY ""user_id"""
299,"SELECT ""user_id"",MAX(""wind"") AS ""biggest_window"" FROM (SELECT ""user_id"",""next_visit_date"" - ""visit_date"" AS ""wind"" FROM (SELECT ""user_id"",""visit_date"",(CASE WHEN ""next_visit_date"" IS NULL THEN '2021-01-01' ELSE ""next_visit_date"" END) AS ""next_visit_date"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit_date"" FROM ""uservisits"") AS ""uv"") AS ""w"") AS ""bigw"" GROUP BY ""user_id"""
300,"WITH ""CTE"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_Date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM ""CTE"" GROUP BY ""user_id"" ORDER BY ""user_id"""
301,"WITH ""cte"" AS (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""UserVisits"" ORDER BY ""user_id"") SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"" ORDER BY ""user_id"""
302,"SELECT ""user_id"",MAX(""current_window"") AS ""biggest_window"" FROM (SELECT *,LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_ID"" ORDER BY ""visit_date"") - ""visit_date"" AS ""current_window"" FROM ""UserVisits"") AS ""temp"" GROUP BY ""user_id"""
303,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""windows"" FROM ""userVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
304,"WITH ""main"" AS (SELECT ""user_id"",COALESCE((LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date""), CAST('2021-1-1' AS DATE) - ""visit_date"") AS ""win"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""win"") AS ""biggest_window"" FROM ""main"" GROUP BY ""user_id"" ORDER BY ""user_id"""
305,"WITH ""temp"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LAG(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"" DESC), '2021-01-01') AS ""lag_date"" FROM ""UserVisits"") SELECT ""user_id"",MAX(""lag_date"" - ""visit_date"") AS ""biggest_window"" FROM ""temp"" GROUP BY ""user_id"""
306,"WITH ""cte_a"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""uservisits"" ORDER BY ""user_id"",""visit_date"") SELECT ""user_id"",MAX(""lead_date"" - ""visit_date"") AS ""biggest_window"" FROM ""cte_a"" GROUP BY ""user_id"""
307,"WITH ""NextVisit"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""next_visit"" FROM ""UserVisits""), ""Gaps"" AS (SELECT ""user_id"",""next_visit"" - ""visit_date"" AS ""currnet_gap"" FROM ""NextVisit"") SELECT ""user_id"",MAX(""currnet_gap"") AS ""biggest_window"" FROM ""Gaps"" GROUP BY ""user_id"""
308,"WITH ""base_table"" AS (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-01-01') AS ""next_visit_date"" FROM ""UserVisits"" GROUP BY 1,2) SELECT ""user_id"",MAX(""next_visit_date"" - ""visit_date"") AS ""biggest_window"" FROM ""base_table"" GROUP BY 1 ORDER BY 1"
309,"WITH ""UserVisitsOrder"" AS (SELECT ""user_id"",""visit_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""visit_order"" FROM ""UserVisits""), ""UserWindow"" AS (SELECT ""initialvisit"".""user_id"",COALESCE(""nextvisit"".""visit_date"", '2021-1-1') - ""initialvisit"".""visit_date"" AS ""wd"" FROM ""UserVisitsOrder"" AS ""initialvisit"" LEFT JOIN ""UserVisitsOrder"" AS ""nextvisit"" ON ""initialvisit"".""user_id""=""nextvisit"".""user_id"" AND ""nextvisit"".""visit_order""=""initialvisit"".""visit_order""+1) SELECT ""user_id"",MAX(""wd"") AS ""biggest_window"" FROM ""UserWindow"" GROUP BY ""user_id"""
310,"WITH ""cte"" AS (SELECT ""user_id"",ABS(""visit_date"" - COALESCE(LAG(""visit_date"", 1) OVER (PARTITION BY ""USER_ID"" ORDER BY ""VISIT_DATE"" DESC), '2021-1-1')) AS ""days"" FROM ""uservisits"") SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM ""cte"" GROUP BY ""user_id"""
311,"SELECT ""A"".""user_id"" AS ""user_id"",MAX(COALESCE(""B"".""visit_date"", '2021-1-1') - ""A"".""visit_date"") AS ""biggest_window"" FROM ""UserVisits"" AS ""A"" LEFT JOIN ""UserVisits"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" AND ""A"".""visit_date""<""B"".""visit_date"" WHERE (SELECT COUNT(1) FROM ""UserVisits"" WHERE ""visit_date"">""A"".""visit_date"" AND ""visit_date""<""B"".""visit_date"" AND ""user_id""=""A"".""user_id"")=0 GROUP BY ""A"".""user_id"""
312,"WITH ""t"" AS (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"" FROM ""UserVisits""), ""t2"" AS (SELECT ""user_id"",""lead_date"" - ""visit_date"" AS ""date_window"" FROM ""t"") SELECT ""user_id"",MAX(""date_window"") AS ""biggest_window"" FROM ""t2"" GROUP BY ""user_id"" ORDER BY ""user_id"""
313,"SELECT ""user_id"",MAX(""max_diff"") AS ""biggest_window"" FROM (SELECT ""u"".""user_id"",LEAD(""u"".""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""max_diff"" FROM ""UserVisits"" AS ""u"") AS ""temp"" GROUP BY 1"
314,"WITH ""cte"" AS (SELECT ""u1"".""user_id"",""u1"".""visit_date"",COUNT(DISTINCT ""u2"".""visit_date"") AS ""rnk"" FROM ""uservisits"" AS ""u1"" LEFT JOIN ""uservisits"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""visit_date"">""u2"".""visit_date"" GROUP BY ""u1"".""user_id"",""u1"".""visit_date"") SELECT ""c1"".""user_id"",MAX(COALESCE(""c2"".""visit_date"", '2021-01-01') - ""c1"".""visit_Date"") AS ""biggest_window"" FROM ""cte"" AS ""c1"" LEFT JOIN ""cte"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""rnk""+1=""c2"".""rnk"" GROUP BY ""c1"".""user_id"""
315,"SELECT ""user_id"",MAX(""days"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",""previous_date"",CASE WHEN ""previous_date"" IS NULL THEN TO_CHAR('2021-1-1', 'YYYY-%m-%d') ELSE ""previous_date"" END - ""visit_date"" AS ""days"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""previous_date"" FROM ""UserVisits"") AS ""tmp"") AS ""tmp2"" GROUP BY ""user_id"""
316,"SELECT ""user_id"",MAX(""windows"") AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE((LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"")), '2021-01-01') - ""visit_date"" AS ""windows"" FROM ""uservisits"") AS ""a"" GROUP BY 1 ORDER BY 1"
317,"SELECT ""user_id"",MAX(""date_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-1-1') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""date_diff"" FROM ""UserVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
318,"SELECT ""user_id"",MAX(""next_date"" - ""visit_date"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""), '2021-1-1') AS ""next_date"" FROM ""uservisits"") AS ""tmp"" GROUP BY 1"
319,"WITH ""cte"" AS (SELECT *,LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""nextvisit"" FROM ""uservisits"") SELECT ""user_id"",""w"" AS ""biggest_window"" FROM (SELECT ""user_id"",COALESCE(""nextvisit"", '2021-1-1') - ""visit_date"" AS ""w"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY COALESCE(""nextvisit"", '2021-1-1') - ""visit_date"" DESC) AS ""rnk"" FROM ""cte"") AS ""a"" WHERE ""rnk""=1 GROUP BY 1"
320,"SELECT ""u"".""user_id"",MAX(""u"".""date_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""),COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"", CAST('2021-01-01' AS DATE) - ""visit_date"") AS ""date_diff"" FROM ""UserVisits"") AS ""u"" GROUP BY ""u"".""user_id"""
321,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""userVisits"") AS ""t"" GROUP BY ""user_id"" ORDER BY ""user_id"""
322,"SELECT ""u"".""user_id"",MAX(""u"".""date_diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date""),COALESCE(LEAD(""visit_date"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"", CAST('2021-01-01' AS DATE) - ""visit_date"") AS ""date_diff"" FROM ""UserVisits"") AS ""u"" GROUP BY ""u"".""user_id"""
323,"SELECT ""user_id"",MAX(CASE WHEN ""user_id""=""lead_user"" THEN ""lead_date"" - ""visit_date"" ELSE CAST('2021-1-1' AS DATE) - ""visit_date"" END) AS ""biggest_window"" FROM (SELECT ""user_id"",""visit_date"",LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_date"",LEAD(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") AS ""lead_user"" FROM ""UserVisits"" ORDER BY ""user_id"") AS ""t"" GROUP BY ""user_id"""
324,"SELECT ""user_id"",MAX(""diff_days"") AS ""biggest_window"" FROM (SELECT *,COALESCE(LEAD(""visit_date"") OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"", CAST('2021-01-01' AS DATE) - ""visit_date"") AS ""diff_days"" FROM ""UserVisits"" ORDER BY ""user_id"",""visit_date"") AS ""uv"" GROUP BY ""user_id"""
325,"SELECT ""user_id"",MAX(""diff"") AS ""biggest_window"" FROM (SELECT ""user_id"",LEAD(""visit_date"", 1, '2021-01-01') OVER (PARTITION BY ""user_id"" ORDER BY ""visit_date"") - ""visit_date"" AS ""diff"" FROM ""uservisits"") AS ""tmp"" GROUP BY 1"
