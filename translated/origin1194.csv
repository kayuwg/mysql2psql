id,original query
1,"WITH ""a"" AS (SELECT ""first_player"",SUM(""first_score"") AS ""score_1"" FROM ""Matches"" GROUP BY 1), ""b"" AS (SELECT ""second_player"",SUM(""second_score"") AS ""score_2"" FROM ""Matches"" GROUP BY 1), ""score"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY COALESCE(""a"".""score_1"", 0)+COALESCE(""b"".""score_2"", 0) DESC,""player_id"") AS ""rnk"" FROM (""Players"" AS ""p"" LEFT JOIN ""a"" ON ""p"".""player_id""=""a"".""first_player"") LEFT JOIN ""b"" ON ""p"".""player_id""=""b"".""second_player"") SELECT ""player_id"",""group_id"" FROM ""score"" WHERE ""rnk""=1 ORDER BY ""group_id"""
2,"SELECT ""group_id"",MIN(""id"") AS ""player_id"" FROM (SELECT ""id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""scores"" DESC) AS ""rnk"" FROM (SELECT ""a"".""id"",""b"".""group_id"",SUM(""a"".""scores"") AS ""scores"" FROM (SELECT ""first_player"" AS ""id"",SUM(""first_score"") AS ""scores"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""second_player"" AS ""id"",SUM(""second_score"") AS ""scores"" FROM ""Matches"" GROUP BY 1) AS ""a"" LEFT JOIN ""Players"" AS ""b"" ON ""a"".""id""=""b"".""player_id"" GROUP BY 1,2) AS ""a"") AS ""a"" WHERE ""rnk""=1 GROUP BY 1"
3,"WITH ""CTE"" AS (SELECT ""first_player"" AS ""id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" GROUP BY ""second_player""), ""CTE1"" AS (SELECT ""id"",SUM(""score"") AS ""s"" FROM ""CTE"" GROUP BY ""id""), ""CTE2"" AS (SELECT ""P"".""group_id"",""C1"".""id"" AS ""player_id"",ROW_NUMBER() OVER (PARTITION BY ""P"".""group_id"" ORDER BY ""C1"".""s"" DESC,""C1"".""id"") AS ""rn"" FROM ""Players"" AS ""P"" JOIN ""CTE1"" AS ""C1"" ON ""P"".""player_id""=""C1"".""id"") SELECT ""group_id"",""player_id"" FROM ""CTE2"" WHERE ""rn""=1"
4,"WITH ""m"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""ms"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""m"".""player_id"" AS ""player_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""m"".""score"" DESC,""m"".""player_id"") AS ""rnk"" FROM ""players"" AS ""p"" JOIN ""m"" ON ""p"".""player_id""=""m"".""player_id"") AS ""t"" WHERE ""t"".""rnk""=1"
5,"WITH ""scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM ""Players"" AS ""p"" JOIN ""scores"" AS ""ps"" ON ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
6,"WITH ""t"" AS (SELECT ""x"".""player"" AS ""player"",SUM(""x"".""score"") AS ""total_score"" FROM (SELECT ""match_id"",""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""x"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""t"".""player"" AS ""player_id"",""t"".""total_score"" AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""t"" ON ""t"".""player""=""p"".""player_id"") AS ""final"") AS ""y"" WHERE ""rn""=1"
7,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""total_score"" AS (SELECT ""player"",SUM(""score"") AS ""total"" FROM ""t1"" GROUP BY ""player""), ""tmp"" AS (SELECT ""group_id"",""p"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""p"".""player_id"") AS ""row_num"" FROM ""players"" AS ""p"" JOIN ""total_score"" AS ""ts"" ON ""p"".""player_id""=""ts"".""player"") SELECT ""group_id"",""player_id"" FROM ""tmp"" WHERE ""row_num""=1"
8,"WITH ""cte"" AS (SELECT ""player"",SUM(""score"") AS ""final_score"" FROM (SELECT ""first_player"" AS ""player"",SUM(""first_score"") AS ""score"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""second_player"" AS ""player"",SUM(""second_score"") AS ""score"" FROM ""matches"" GROUP BY 1) AS ""tab"" GROUP BY ""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""c"".""final_score"" DESC,""p"".""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN ""cte"" AS ""c"" ON ""p"".""player_id""=""c"".""player"") AS ""tab1"" WHERE ""rnk""=1"
9,"WITH ""table1"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""first_player""=""p"".""player_id"" UNION ALL SELECT ""second_player"",""second_score"",""group_id"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""second_player""=""p"".""player_id""), ""table2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""table1"" GROUP BY ""group_id"",""player_id""), ""table3"" AS (SELECT ""group_id"",""player_id"",""score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM ""table2"") SELECT ""group_id"",""player_id"" FROM ""table3"" WHERE ""rn""=1"
10,"WITH ""cte"" AS (SELECT ""p"".""player_id"",""scores"",""group_id"" FROM ""players"" AS ""p"" JOIN (SELECT ""player_id"",SUM(""score"") AS ""scores"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""c"" GROUP BY 1) AS ""d"" ON ""d"".""player_id""=""p"".""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",""scores"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""scores"" DESC,""player_id"") AS ""rn"" FROM ""cte"") AS ""c"" WHERE ""rn""=1"
11,"WITH ""cte1"" AS (SELECT ""first_player"",""first_score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""p"".""group_id"",""first_player"",SUM(""first_score"") AS ""tot_score"" FROM ""cte1"" JOIN ""Players"" AS ""p"" ON ""cte1"".""first_player""=""p"".""player_id"" GROUP BY ""first_player"" ORDER BY ""p"".""group_id"",""first_player"",""tot_score"" DESC), ""cte3"" AS (SELECT ""cte2"".*,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""tot_score"" DESC) AS ""giv_rank"" FROM ""cte2"") SELECT ""group_id"" AS ""GROUP_ID"",""first_player"" AS ""PLAYER_ID"" FROM ""cte3"" WHERE ""giv_rank""=1"
12,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""r"" FROM (SELECT ""group_id"",""player_id"",""first_score"" AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" UNION ALL SELECT ""group_id"",""player_id"",""second_score"" AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player"") AS ""a"" GROUP BY 1,2) AS ""b"" WHERE ""r""=1"
13,"WITH ""t"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION SELECT ""match_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""m"" GROUP BY ""player_id"") SELECT ""player_id"",""group_id"" FROM (SELECT ""t"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM ""t"" JOIN ""players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"") AS ""n"" WHERE ""rn""=1"
14,"WITH ""cte1"" AS (SELECT ""first_player"",""first_score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""p"".""group_id"",""first_player"",SUM(""first_score"") AS ""tot_score"" FROM ""cte1"" JOIN ""Players"" AS ""p"" ON ""cte1"".""first_player""=""p"".""player_id"" GROUP BY ""first_player"" ORDER BY ""p"".""group_id"",""first_player"",""tot_score"" DESC), ""cte3"" AS (SELECT ""cte2"".*,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""tot_score"" DESC) AS ""giv_rank"" FROM ""cte2"") SELECT ""group_id"" AS ""GROUP_ID"",""first_player"" AS ""PLAYER_ID"" FROM ""cte3"" WHERE ""giv_rank""=1"
15,"WITH ""players_score"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT DISTINCT ""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC) AS ""rnk"" FROM ""Players"" AS ""p"" JOIN (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""players_score"" GROUP BY 1) AS ""s"" ON ""p"".""player_id""=""s"".""player_id"") AS ""a"" WHERE ""rnk""=1 GROUP BY 1"
16,"WITH ""baseTable"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""playerGroup"" AS (SELECT ""t"".""player_id"" AS ""player_id"",""p"".""group_id"" AS ""group_id"",SUM(""t"".""score"") AS ""player_score"" FROM ""baseTable"" AS ""t"" JOIN ""Players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"" GROUP BY ""t"".""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""player_score"" DESC,""player_id"") AS ""ScoreRank"" FROM ""playerGroup"") AS ""t"" WHERE ""ScoreRank""=1"
17,"WITH ""temp"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""temp1"" AS (SELECT ""group_id"",""p"".""player_id"",SUM(CASE WHEN ""score"" IS NULL THEN 0 ELSE ""score"" END) AS ""score"" FROM ""Players"" AS ""p"" JOIN ""temp"" ON ""p"".""player_id""=""temp"".""player_id"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranking"" FROM ""temp1"") AS ""t"" WHERE ""ranking""=1"
18,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""p"".""player_id"") AS ""player_rank"" FROM ""Players"" AS ""p"" JOIN (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""Matches_unified"" ON ""p"".""player_id""=""player"" GROUP BY ""group_id"",""p"".""player_id"") AS ""rank_data"" WHERE ""player_rank""=1"
19,"WITH ""tmp"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""A"" GROUP BY ""player_id"") SELECT ""group_id"",""B"".""player_id"" FROM (SELECT ""group_id"",""tmp"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""tmp"".""player_id"") AS ""rk"" FROM ""tmp"" JOIN ""Players"" AS ""p"" ON ""tmp"".""player_id""=""p"".""player_id"") AS ""B"" WHERE ""rk""=1"
20,"WITH ""main"" AS (SELECT ""b"".*,""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id""), ""sum_ranked"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rank_val"" FROM ""main"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",""player_id"" FROM ""sum_ranked"" WHERE ""rank_val""=1"
21,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""ttl"" DESC,""player_id"") AS ""rk"" FROM ""players"" AS ""p"" LEFT JOIN (SELECT ""player"",SUM(""score"") AS ""ttl"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""m"" GROUP BY 1) AS ""s"" ON ""player_id""=""player"") AS ""r"" WHERE ""rk""=1"
22,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM (""Players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" WHERE ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
23,"WITH ""uni"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""rnk"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""u"".""score"") DESC,""player_id"") AS ""rk"" FROM ""uni"" AS ""u"" JOIN ""players"" AS ""p"" ON ""u"".""player""=""p"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""rnk"" WHERE ""rk""=1 ORDER BY ""group_id"""
24,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"" ORDER BY ""player_id""), ""cte2"" AS (SELECT ""player_id"",SUM(""score"") AS ""tot_score"" FROM ""cte"" GROUP BY 1), ""cte3"" AS (SELECT ""c"".""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""tot_score"" DESC) AS ""rnk"" FROM ""cte2"" AS ""c"" JOIN ""Players"" AS ""p"" ON ""c"".""player_id""=""p"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""cte3"" WHERE ""rnk""=1 GROUP BY 1"
25,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",""b"".""ttl_points"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""b"".""ttl_points"" DESC,""p"".""player_id"") AS ""rnk"" FROM ""players"" AS ""p"" JOIN (SELECT ""player"",SUM(""player_points"") AS ""ttl_points"" FROM (SELECT ""first_player"" AS ""player"",SUM(""first_score"") AS ""player_points"" FROM ""matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player"",SUM(""second_score"") AS ""player_points"" FROM ""matches"" GROUP BY ""second_player"") AS ""a"" GROUP BY ""a"".""player"") AS ""b"" ON ""p"".""player_id""=""b"".""player"") AS ""c"" WHERE ""c"".""rnk""=1 GROUP BY ""group_id"""
26,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""cte2"" AS (SELECT ""cte"".""player_id"",SUM(""score"") AS ""total"",""group_id"" FROM ""cte"" LEFT JOIN ""players"" ON ""cte"".""player_id""=""players"".""player_id"" GROUP BY ""player_id""), ""cte3"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rnk"",""total"" FROM ""cte2"") SELECT ""group_id"",""player_id"" FROM ""cte3"" WHERE ""rnk""=1 ORDER BY ""group_id"""
27,"WITH ""t"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches""), ""t1"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""t"" ON ""p"".""player_id""=""t"".""player"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rnk"" FROM ""t1"") AS ""tmp"" WHERE ""rnk""=1"
28,"WITH ""t1"" AS (SELECT * FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""tmp"" LEFT JOIN ""Players"" AS ""p"" ON ""tmp"".""player""=""p"".""player_id""), ""t2"" AS (SELECT ""group_id"",""player"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""sum_score"" DESC,""player"") AS ""rk"" FROM (SELECT ""group_id"",""player"",SUM(""score"") AS ""sum_score"" FROM ""t1"" GROUP BY 1,2) AS ""tmp2"") SELECT ""group_id"" AS ""group_id"",""player"" AS ""player_id"" FROM ""t2"" WHERE ""rk""=1"
29,"WITH ""TEMP"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""A"" LEFT JOIN ""Players"" AS ""B"" ON ""A"".""first_player""=""B"".""player_id"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""A"" LEFT JOIN ""Players"" AS ""B"" ON ""A"".""first_player""=""B"".""player_id"") AS ""T"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""TEMP"") AS ""T"" WHERE ""rnk""=1"
30,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
31,"WITH ""score"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""temp1"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""Players"".""group_id"",""Players"".""player_id"",RANK() OVER (PARTITION BY ""Players"".""group_id"" ORDER BY ""score"".""total_score"" DESC,""Players"".""player_id"") AS ""rank_score"" FROM ""Players"" JOIN ""score"" ON ""Players"".""player_id""=""score"".""player_id"") AS ""temp1"" WHERE ""rank_score""=1"
32,"WITH ""T"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",""m"".""first_score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" UNION ALL SELECT ""p"".""player_id"",""p"".""group_id"",""m"".""second_score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player"") SELECT ""b"".""player_id"",""b"".""group_id"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""a"".""score"" DESC,""a"".""player_id"") AS ""rankie"" FROM (SELECT ""player_id"",""group_id"",SUM(""first_score"") AS ""score"" FROM ""T"" GROUP BY ""group_id"",""player_id"") AS ""a"") AS ""b"" WHERE ""b"".""rankie""=1"
33,"WITH ""A"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""B"" AS (SELECT ""group_id"",""A"".""player_id"",SUM(""score"") AS ""total_score"" FROM ""A"" JOIN ""players"" AS ""p"" ON ""A"".""player_id""=""p"".""player_id"" GROUP BY 1,2), ""C"" AS (SELECT ""group_id"",""player_id"",""total_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""score_rank"" FROM ""B"") SELECT ""group_id"",""player_id"" FROM ""C"" WHERE ""score_rank""=1"
34,"WITH ""CTE_PLAYER"" AS (SELECT ""PLAYER_ID"",SUM(""PLAYER_SCORE"") AS ""TOTAL_SCORE"" FROM (SELECT ""FIRST_PLAYER"" AS ""PLAYER_ID"",""FIRST_SCORE"" AS ""PLAYER_SCORE"" FROM ""MATCHES"" UNION ALL SELECT ""SECOND_PLAYER"" AS ""PLAYER_ID"",""SECOND_SCORE"" AS ""PLAYER_SCORE"" FROM ""MATCHES"") AS ""T"" GROUP BY 1) SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""P"".""GROUP_ID"",""P"".""PLAYER_ID"",RANK() OVER (PARTITION BY ""P"".""GROUP_ID"" ORDER BY ""TOTAL_SCORE"" DESC) AS ""PLAYER_RNK"" FROM ""PLAYERS"" AS ""P"" JOIN ""CTE_PLAYER"" AS ""CP"" ON ""P"".""PLAYER_ID""=""CP"".""PLAYER_ID"") AS ""T"" WHERE ""PLAYER_RNK""=1 GROUP BY 1"
35,"WITH ""ind_scores"" AS (SELECT ""first_player"" AS ""id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" GROUP BY ""second_player""), ""tot_scores"" AS (SELECT ""id"",SUM(""score"") AS ""score"" FROM ""ind_scores"" GROUP BY ""id""), ""main"" AS (SELECT ""group_id"",""player_id"",""score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranking"" FROM ""Players"" LEFT JOIN ""tot_Scores"" ON ""Players"".""player_id""=""tot_scores"".""id"") SELECT ""group_id"",""player_id"" FROM ""main"" WHERE ""ranking""=1"
36,"WITH ""base"" AS (SELECT ""group_id"",""player_id"",""first_score"" AS ""score"" FROM ""Matches"" LEFT JOIN ""players"" ON ""first_player""=""player_id"" UNION ALL SELECT ""group_id"",""player_id"",""second_score"" AS ""score"" FROM ""Matches"" LEFT JOIN ""players"" ON ""second_player""=""player_id""), ""score"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""base"" GROUP BY 1,2), ""top_score"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM ""score"") SELECT ""group_id"",""player_id"" FROM ""top_score"" WHERE ""rn""=1"
37,"WITH ""cte"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""P"".""player_id"",""P"".""group_id"",ROW_NUMBER() OVER (PARTITION BY ""P"".""group_id"" ORDER BY ""C"".""score"" DESC,""P"".""player_id"") AS ""r"" FROM ""Players"" AS ""P"" LEFT JOIN ""cte"" AS ""C"" ON ""P"".""player_id""=""C"".""player_id"") AS ""t"" WHERE ""r""=1"
38,"WITH ""PlayerStats"" AS (SELECT ""match_id"",""first_player"" AS ""player"",""first_score"" AS ""player_score"" FROM ""Matches"" UNION SELECT ""match_id"",""second_player"" AS ""player"",""second_score"" AS ""player_score"" FROM ""Matches""), ""PlayerSummary"" AS (SELECT ""Players"".""group_id"",""Players"".""player_id"",RANK() OVER (PARTITION BY ""Players"".""group_id"" ORDER BY SUM(""PlayerStats"".""player_score"") DESC,""Players"".""player_id"") AS ""player_rank"" FROM ""PlayerStats"" JOIN ""Players"" ON ""Players"".""player_id""=""PlayerStats"".""player"" GROUP BY ""Players"".""group_id"",""Players"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""PlayerSummary"" WHERE ""player_rank""=1"
39,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM ""cte"" GROUP BY ""player_id""), ""final"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""ranking"" FROM ""players"" LEFT JOIN ""scores"" USING (""player_id"")) SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""final"" WHERE ""ranking""=1 GROUP BY ""group_id"""
40,"SELECT ""group_id"",""player_id"" FROM (SELECT ""a"".""player_id"",""a"".""group_id"",RANK() OVER (PARTITION BY ""a"".""group_id"" ORDER BY ""y"".""score"" DESC,""a"".""player_id"") AS ""rnk"" FROM ""Players"" AS ""a"" JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""x"" GROUP BY 1) AS ""y"" ON ""a"".""player_id""=""y"".""player"") AS ""b"" WHERE ""rnk""=1"
41,"WITH ""x"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""m"".""score"") AS ""score"" FROM ""players"" AS ""p"" LEFT JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""m"" USING (""player_id"") GROUP BY ""p"".""group_id"",""p"".""player_id"") AS ""a"") SELECT ""group_id"",""player_id"" FROM ""x"" WHERE ""rn""=1"
42,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player"",SUM(""first_score"") AS ""scores"" FROM (SELECT ""FIRST_PLAYER"",""FIRST_SCORE"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches"") AS ""c"" GROUP BY 1) SELECT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""player"",""scores"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""scores"" DESC,""player"") AS ""rnk"" FROM ""cte"" LEFT JOIN ""players"" ON ""cte"".""player""=""players"".""player_id"") AS ""c"" WHERE ""rnk""=1"
43,"SELECT ""group_id"" AS ""GROUP_ID"",""player_id"" AS ""PLAYER_ID"" FROM (SELECT ""p"".""group_id"",""t"".""player_id"",SUM(""t"".""score"") AS ""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""t"".""score"") DESC,""t"".""player_id"") AS ""rnk"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" GROUP BY ""second_player"") AS ""t"" LEFT JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""t"".""player_id"" GROUP BY ""t"".""player_id"",""p"".""group_id"") AS ""m"" WHERE ""rnk""=1"
44,"WITH ""home"" AS (SELECT ""B"".""group_id"" AS ""grp"",""A"".""match_id"" AS ""mid"",""A"".""first_player"" AS ""h"",""A"".""first_score"" AS ""o"" FROM ""Matches"" AS ""A"" LEFT JOIN ""Players"" AS ""B"" ON ""A"".""first_player""=""B"".""player_id""), ""away"" AS (SELECT ""B"".""group_id"" AS ""grp"",""A"".""match_id"" AS ""mid"",""A"".""second_player"" AS ""h"",""A"".""second_score"" AS ""o"" FROM ""Matches"" AS ""A"" LEFT JOIN ""Players"" AS ""B"" ON ""A"".""second_player""=""B"".""player_id""), ""agg"" AS (SELECT * FROM ""home"" UNION ALL SELECT * FROM ""away""), ""totalp"" AS (SELECT ""grp"",""h"",SUM(""o"") AS ""total_points"" FROM ""agg"" GROUP BY 1,2), ""final"" AS (SELECT ""grp"" AS ""group_id"",""h"" AS ""player_id"",ROW_NUMBER() OVER (PARTITION BY ""grp"" ORDER BY ""total_points"" DESC) AS ""rw"" FROM ""totalp"") SELECT ""group_id"",""player_id"" FROM ""final"" WHERE ""rw""=1"
45,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""t2"" AS (SELECT ""player"",SUM(""score"") AS ""total_score"" FROM ""t1"" GROUP BY 1), ""t3"" AS (SELECT ""group_id"",""p"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""p"".""player_id"") AS ""rnk"" FROM ""players"" AS ""p"" JOIN ""t2"" ON ""p"".""player_id""=""t2"".""player"") SELECT ""group_id"",""player_id"" FROM ""t3"" WHERE ""rnk""=1"
46,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rank_score"" FROM ((SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"",""p"".""group_id"" FROM ""matches"" AS ""m"" LEFT JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""m"".""first_player"") UNION ALL (SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"",""p1"".""group_id"" FROM ""matches"" AS ""m"" LEFT JOIN ""players"" AS ""p1"" ON ""p1"".""player_id""=""m"".""second_player"")) AS ""A"" GROUP BY ""player_id"",""group_id"") AS ""B"" WHERE ""rank_score""=1"
47,"WITH ""tb1"" AS (SELECT ""player"",SUM(""Score"") AS ""totalScore"" FROM (SELECT ""first_player"" AS ""player"",SUM(""first_score"") AS ""Score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player"",SUM(""second_score"") AS ""Score"" FROM ""Matches"" GROUP BY ""second_player"") AS ""a"" GROUP BY ""player""), ""tb2"" AS (SELECT ""tb1"".""player"" AS ""player_id"",""group_id"",""tb1"".""totalScore"" FROM ""tb1"" JOIN ""Players"" ON ""tb1"".""player""=""Players"".""player_id"" GROUP BY ""player_id"" ORDER BY ""group_id"",""totalScore"" DESC,""player_id"") SELECT ""group_id"",""player_id"" FROM ""tb2"" GROUP BY ""group_id"""
48,"WITH ""player_score"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""win_player_count"" AS (SELECT ""b"".""group_id"",""a"".""player_id"",SUM(""score"") AS ""total_score"" FROM ""player_score"" AS ""a"" LEFT JOIN ""Players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rk"" FROM ""win_player_count"") AS ""a"" WHERE ""a"".""rk""=1"
49,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",COALESCE(SUM(""s"".""score""), 0) AS ""total_score"" FROM ""players"" AS ""p"" LEFT JOIN (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches"") AS ""s"" ON ""p"".""player_id""=""s"".""player"" GROUP BY ""p"".""player_id"" ORDER BY ""group_id"",""total_score"" DESC,""player_id"") AS ""a"" GROUP BY ""group_id"""
50,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",""sum_score"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""sum_score"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",COALESCE(SUM(""score""), 0) AS ""sum_score"" FROM ""players"" AS ""p"" LEFT JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""A"" ON ""p"".""player_id""=""a"".""player_id"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""B"") AS ""C"" WHERE ""rk""=1"
51,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",""total"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""group_id"",""player_id"",SUM(""first_score"") AS ""total"" FROM ((SELECT ""first_player"",""first_score"" FROM ""Matches"") UNION ALL (SELECT ""second_player"",""second_score"" FROM ""Matches"")) AS ""m1"" LEFT JOIN ""Players"" AS ""p"" ON ""m1"".""first_player""=""p"".""player_id"" GROUP BY ""group_id"",""player_id"") AS ""table1"") AS ""table2"" WHERE ""rk""=1"
52,"SELECT ""group_id"",""Player_id"" FROM (SELECT ""z"".""group_id"",""z"".""player_id"",RANK() OVER (PARTITION BY ""z"".""group_id"" ORDER BY ""z"".""sscore"" DESC,""z"".""player_id"") AS ""rnk"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""score"") AS ""sscore"" FROM (""players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" AS ""a"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"" AS ""a"") AS ""t"" WHERE ""p"".""player_id""=""t"".""player_id"" GROUP BY ""t"".""player_id"") AS ""z"") AS ""y"" WHERE ""rnk""=1"
53,"WITH ""t1"" AS (SELECT ""player"",SUM(""scores"") AS ""scores"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""scores"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""scores"" FROM ""Matches"") AS ""tt"" GROUP BY ""player"") SELECT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""t1"".""player"",""t1"".""scores"",""p"".""group_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""t1"".""scores"" DESC,""t1"".""player"") AS ""ranks"" FROM ""t1"" LEFT JOIN ""Players"" AS ""p"" ON ""t1"".""player""=""p"".""player_id"") AS ""t"" WHERE ""ranks""=1"
54,"WITH ""cte"" AS (SELECT ""player"",SUM(""score"") AS ""final_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""tab"" GROUP BY ""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""c"".""final_score"" DESC,""p"".""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN ""cte"" AS ""c"" ON ""p"".""player_id""=""c"".""player"") AS ""tab1"" WHERE ""rnk""=1"
55,"SELECT ""group_id"",""player_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""points"" DESC,""player_id"") AS ""ranked"" FROM (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) AS ""points"" FROM (""Matches"" AS ""m"") JOIN ""Players"" AS ""p"" WHERE ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1) AS ""t1"") AS ""t2"" WHERE ""ranked""=1"
56,"WITH ""cumulative_score"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""m"".""first_score"") AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" GROUP BY 2 UNION ALL SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""m"".""second_score"") AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player"" GROUP BY 2) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""total_score"") DESC,""player_id"") AS ""score_rank"" FROM ""cumulative_score"" GROUP BY 2) AS ""result_table"" WHERE ""score_rank""=1"
57,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",""overall_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""overall_score"" DESC) AS ""rn"" FROM (SELECT ""player_id"",SUM(""s_score"") AS ""overall_score"" FROM ((SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""s_score"" FROM ""matches"" GROUP BY 1) UNION ALL (SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""s_score"" FROM ""matches"" GROUP BY 1)) AS ""w"" GROUP BY 1) AS ""c"" JOIN (SELECT ""player_id"",""group_id"" FROM ""players"") AS ""d"" USING (""player_id"")) AS ""e"" WHERE ""rn""=1 GROUP BY 1,2"
58,"SELECT ""B"".""group_id"",MIN(""B"".""player"") AS ""player_id"" FROM (SELECT ""P"".""group_id"",""M"".""player"",SUM(""M"".""score"") AS ""totalScore"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""player""=""P"".""player_id"" GROUP BY ""M"".""player"") AS ""B"" WHERE ROW(""B"".""group_id"",""B"".""totalScore"") IN (SELECT ""A"".""group_id"",MAX(""A"".""totalScore"") AS ""maxScore"" FROM (SELECT ""P"".""group_id"",""M"".""player"",SUM(""M"".""score"") AS ""totalScore"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""player""=""P"".""player_id"" GROUP BY ""M"".""player"") AS ""A"" GROUP BY ""A"".""group_id"") GROUP BY ""B"".""group_id"""
59,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
60,"WITH ""uni"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""rnk"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""u"".""score"") DESC,""player_id"") AS ""rk"" FROM ""uni"" AS ""u"" JOIN ""players"" AS ""p"" ON ""u"".""player""=""p"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""rnk"" WHERE ""rk""=1 ORDER BY ""group_id"""
61,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rnk"" FROM ""players"" AS ""a"" JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches"") AS ""t"" USING (""player_id"") GROUP BY ""player_id"") AS ""c"" WHERE ""rnk""=1"
62,"WITH ""Player_scores"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""m"".""first_score"") AS ""total_score"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""m"".""first_player"" GROUP BY ""p"".""group_id"",""p"".""player_id"" UNION ALL SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""m"".""second_score"") AS ""total_score"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""group_id"",""p"".""player_id""), ""Agg_player_scores"" AS (SELECT ""group_id"",""player_id"",SUM(""total_score"") AS ""total_score"" FROM ""Player_scores"" GROUP BY ""group_id"",""player_id""), ""player_rankings"" AS (SELECT ""group_id"",""player_id"",""total_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rn"" FROM ""Agg_player_scores"") SELECT ""group_id"",""player_id"" FROM ""player_rankings"" WHERE ""rn""=1"
63,"WITH ""joined_scores"" AS (SELECT ""match_id"",""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" AS ""m"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"" AS ""m""), ""player_scores"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",COALESCE(SUM(""score""), 0) AS ""score"" FROM ""players"" AS ""p"" LEFT JOIN ""joined_scores"" AS ""j"" ON ""p"".""player_id""=""j"".""player"" GROUP BY 1,2), ""max_in_group"" AS (SELECT ""group_id"",MAX(""score"") AS ""max_score"" FROM ""player_scores"" GROUP BY 1) SELECT ""p"".""group_id"",MIN(""p"".""player_id"") AS ""player_id"" FROM ""player_scores"" AS ""p"" JOIN ""max_in_group"" AS ""m"" ON ""m"".""group_id""=""p"".""group_id"" AND ""m"".""max_score""=""p"".""score"" GROUP BY 1 ORDER BY 1"
64,"WITH ""score"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""p"".""player_id"",""s"".""total_score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN ""score"" AS ""s"" ON ""p"".""player_id""=""s"".""player_id"") AS ""t"" WHERE ""rnk""=1"
65,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""group_id"",SUM(""score"") DESC,""player_id"") AS ""rank1"" FROM (SELECT ""p"".""group_id"",""m"".""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Players"" AS ""p"" ON (""m"".""first_player""=""p"".""player_id"") GROUP BY ""p"".""group_id"",""m"".""first_player"" UNION ALL SELECT ""p"".""group_id"",""m"".""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Players"" AS ""p"" ON (""m"".""second_player""=""p"".""player_id"") GROUP BY ""p"".""group_id"",""m"".""second_player"") AS ""xx"" GROUP BY ""group_id"",""player_id"") AS ""abc"" WHERE ""rank1""=1 ORDER BY ""score"""
66,"WITH ""uni"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""rnk"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""u"".""score"") DESC,""player_id"") AS ""rk"" FROM ""uni"" AS ""u"" JOIN ""players"" AS ""p"" ON ""u"".""player""=""p"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""rnk"" WHERE ""rk""=1 ORDER BY ""group_id"""
67,"WITH ""unionscore"" AS (SELECT ""players"".""player_id"",""players"".""group_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""sumscore"" JOIN ""Players"" AS ""players"" ON ""players"".""player_id""=""sumscore"".""player_id"" GROUP BY ""players"".""player_id"",""players"".""group_id"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""unionscore"" AS ""us1"" WHERE ""score""=(SELECT MAX(""score"") FROM ""unionscore"" AS ""us2"" WHERE ""us1"".""group_id""=""us2"".""group_id"") GROUP BY ""group_id"""
68,"WITH ""cte_player_agg"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE ""m"".""second_score"" END) AS ""total_points"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2), ""cte_group_rank"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""player_rank"" FROM ""cte_player_agg""), ""cte_final"" AS (SELECT ""group_id"",""player_id"" FROM ""cte_group_rank"" WHERE ""player_rank""=1) SELECT * FROM ""cte_final"""
69,"SELECT ""group_id"",""player_id"" FROM (SELECT ""P"".""group_id"",""P"".""player_id"",RANK() OVER (PARTITION BY ""P"".""group_id"" ORDER BY SUM(""score"") DESC,""P"".""player_id"") AS ""rnk"" FROM (SELECT ""match_id"",""M"".""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" AS ""M"" UNION ALL SELECT ""match_id"",""M"".""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"" AS ""M"") AS ""temp"" LEFT JOIN ""Players"" AS ""P"" ON ""temp"".""player_id""=""P"".""player_id"" GROUP BY 1,2) AS ""TBL"" WHERE ""rnk""=1"
70,"WITH ""score"" AS (SELECT ""player"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""sub"" GROUP BY ""player""), ""player"" AS (SELECT ""player_id"",""total_score"",""group_id"" FROM ""players"" AS ""p"" JOIN ""score"" AS ""s"" ON ""p"".""player_id""=""s"".""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""ranks"" FROM ""player"") AS ""sub2"" WHERE ""ranks""=1"
71,"WITH ""e"" AS (SELECT ""a"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""a"".""player_id"") AS ""seq"" FROM (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL (SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"")) AS ""c"" GROUP BY ""player_id"") AS ""a"" JOIN ""Players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""e"" WHERE ""seq""=1 ORDER BY ""group_id"""
72,"WITH ""player_scores"" AS (SELECT ""b"".""group_id"",""a"".""player_id"",SUM(""a"".""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""player_scores"" WHERE ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM ""player_scores"" GROUP BY 1) GROUP BY 1 ORDER BY 1"
73,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""p"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rk"" FROM ""Players"" AS ""p"" JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""sub"" ON ""p"".""player_id""=""sub"".""player_id"" GROUP BY ""group_id"",""p"".""player_id"") AS ""sub"" WHERE ""rk""=1 ORDER BY ""group_id"""
74,"WITH ""playerpoints"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" END) AS ""points"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""player_id"",""p"".""group_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""points"" DESC,""player_id"") AS ""playerrank"" FROM ""playerpoints"") AS ""a"" WHERE ""playerrank""=1"
75,"WITH ""combine"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""c"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rnk"" FROM ""combine"" AS ""c"" JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""c"".""player_id"" GROUP BY ""c"".""player_id"") AS ""a"" WHERE ""rnk""=1"
76,"WITH ""player_scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""f"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""s"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""ranked"" FROM ""player_scores"" AS ""s"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""s"".""player_id"") AS ""f"" WHERE ""ranked""=1"
77,"WITH ""ind_scores"" AS (SELECT ""first_player"" AS ""id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" GROUP BY ""second_player""), ""tot_scores"" AS (SELECT ""id"",SUM(""score"") AS ""score"" FROM ""ind_scores"" GROUP BY ""id""), ""main"" AS (SELECT ""group_id"",""player_id"",""score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranking"" FROM ""Players"" LEFT JOIN ""tot_Scores"" ON ""Players"".""player_id""=""tot_scores"".""id"") SELECT ""group_id"",""player_id"" FROM ""main"" WHERE ""ranking""=1"
78,"WITH ""CTE1"" AS (SELECT ""m"".""match_id"",""p"".""group_id"",""m"".""first_player"" AS ""player_id"",""m"".""first_score"" AS ""score"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Players"" AS ""p"" ON ""m"".""first_player""=""p"".""player_id"" UNION ALL SELECT ""m"".""match_id"",""p"".""group_id"",""m"".""second_player"" AS ""player_id"",""m"".""second_score"" AS ""score"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Players"" AS ""p"" ON ""m"".""second_player""=""p"".""player_id""), ""CTE2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") OVER (PARTITION BY ""group_id"", ""player_id"") AS ""total_points"" FROM ""CTE1"") SELECT DISTINCT ""sub"".""group_id"",""sub"".""player_id"" FROM (SELECT ""group_id"",""player_id"",""total_points"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""rnk"" FROM ""CTE2"") AS ""sub"" WHERE ""rnk""=1"
79,"SELECT ""a"".""group_id"" AS ""GROUP_ID"",""a"".""player_id"" AS ""PLAYER_ID"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""m"".""first_player""=""p"".""player_id"" THEN ""m"".""first_score"" WHEN ""m"".""second_player""=""p"".""player_id"" THEN ""m"".""second_score"" ELSE 0 END) AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1 ORDER BY 2,3 DESC,1) AS ""a"" GROUP BY ""a"".""group_id"""
80,"WITH ""cte_1"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",COALESCE(SUM(""m"".""first_score""), 0) AS ""first_score_total"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" GROUP BY 2), ""cte_2"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",COALESCE(SUM(""m"".""second_score""), 0) AS ""second_score_total"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player"" GROUP BY 2), ""cte"" AS (SELECT ""cte_1"".""group_id"",""cte_1"".""player_id"",DENSE_RANK() OVER (PARTITION BY ""cte_1"".""group_id"" ORDER BY ""cte_1"".""first_score_total""+""cte_2"".""second_score_total"" DESC) AS ""ranking"" FROM ""cte_1"" JOIN ""cte_2"" ON ""cte_1"".""player_id""=""cte_2"".""player_id"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""cte"" WHERE ""ranking""=1 GROUP BY 1"
81,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",SUM(""score"") AS ""score"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rowNum"" FROM (SELECT ""b"".""player_id"",""a"".""first_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""a"" JOIN ""Players"" AS ""b"" ON ""a"".""first_player""=""b"".""player_id"" UNION ALL SELECT ""b"".""player_id"",""a"".""second_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""a"" JOIN ""Players"" AS ""b"" ON ""a"".""second_player""=""b"".""player_id"") AS ""sumMatchs"" GROUP BY ""player_id"") AS ""sumMatchs"" WHERE ""rowNum""=1 ORDER BY ""group_id"""
82,"SELECT ""group_id"",(""player_id"") FROM (SELECT ""p"".""group_id"",""p"".""player_id"",SUM(CASE WHEN ""first_player""=""p"".""player_id"" THEN ""first_score"" ELSE ""second_score"" END) AS ""score"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""m"".""first_player""=""p"".""player_id"" OR ""m"".""second_player""=""p"".""player_id"" GROUP BY ""p"".""group_id"",""p"".""player_id"" ORDER BY ""score"" DESC) AS ""Temp"" GROUP BY ""group_id"""
83,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""p"".""player_id"",SUM(CASE WHEN ""score"" IS NULL THEN 0 ELSE ""score"" END) AS ""score"" FROM ""Players"" AS ""p"" LEFT JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""s"" ON ""p"".""player_id""=""s"".""player_id"" GROUP BY ""group_id"",""p"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""res"" GROUP BY ""group_id"""
84,"WITH ""player_scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""f"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""s"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""ranked"" FROM ""player_scores"" AS ""s"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""s"".""player_id"") AS ""f"" WHERE ""ranked""=1"
85,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""t2"" AS (SELECT ""p"".""player_id"",SUM(COALESCE(""score"", 0)) OVER (PARTITION BY ""player_id"") AS ""score"",""p"".""group_id"" FROM ""t1"" RIGHT JOIN ""players"" AS ""p"" ON ""t1"".""player""=""p"".""player_id""), ""t3"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""r"" FROM ""t2"") SELECT DISTINCT ""group_id"",""player_id"" FROM ""t3"" WHERE ""r""=1"
86,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(""score"") DESC,""p"".""player_id"") AS ""rnk"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" JOIN ""Players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""t2"" WHERE ""rnk""=1"
87,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",""total"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""group_id"",""player_id"",SUM(""first_score"") AS ""total"" FROM ((SELECT ""first_player"",""first_score"" FROM ""Matches"") UNION ALL (SELECT ""second_player"",""second_score"" FROM ""Matches"")) AS ""m1"" LEFT JOIN ""Players"" AS ""p"" ON ""m1"".""first_player""=""p"".""player_id"" GROUP BY ""group_id"",""player_id"") AS ""table1"") AS ""table2"" WHERE ""rk""=1"
88,"SELECT ""z"".""group_id"",""z"".""player_id"" FROM (SELECT ""y"".""group_id"",""x"".""player_id"",SUM(""x"".""score"") AS ""score"",ROW_NUMBER() OVER (PARTITION BY ""y"".""group_id"" ORDER BY SUM(""x"".""score"") DESC,""x"".""player_id"") AS ""row_cnt"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""matches"" GROUP BY ""second_player"") AS ""x"" JOIN ""players"" AS ""y"" ON ""x"".""player_id""=""y"".""player_id"" GROUP BY ""x"".""player_id"",""y"".""group_id"") AS ""z"" WHERE ""z"".""row_cnt""=1"
89,"WITH ""temp"" AS (SELECT ""player_id"",SUM(""point"") AS ""point"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""point"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""point"" FROM ""Matches"") AS ""t"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""point"" DESC,""player_id"") AS ""ranking"" FROM ""Players"" AS ""p"" JOIN ""temp"" ON ""p"".""player_id""=""temp"".""player_id"") AS ""t"" WHERE ""ranking""=1"
90,"WITH ""CTE"" AS (SELECT ""group_id"",""player_id"",""first_score"" AS ""score"" FROM ""Players"" AS ""P"" JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""first_player"" UNION ALL SELECT ""group_id"",""player_id"",""second_score"" AS ""score"" FROM ""players"" AS ""P"" JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""second_player"") SELECT ""group_id"",""Player_id"" FROM (SELECT ""group_id"",""player_id"",SUM(""score""),ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC) AS ""rnk"" FROM ""CTE"" GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"",SUM(""score"") DESC) AS ""T1"" WHERE ""T1"".""rnk""=1"
91,"WITH ""main"" AS (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""P"".""player_id""=""M"".""first_player"" THEN ""first_Score"" ELSE ""second_Score"" END) AS ""score"" FROM ""Players"" AS ""P"" LEFT JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""first_player"" OR ""P"".""player_id""=""M"".""second_player"" GROUP BY ""player_id""), ""second"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranking"" FROM ""main"") SELECT ""group_id"",""player_id"" FROM ""second"" WHERE ""RANKING""=1"
92,"WITH ""scores"" AS (SELECT ""match_id"",""first_player"" AS ""player"",""group_id"",""first_score"" AS ""score"" FROM ""matches"" JOIN ""players"" ON ""matches"".""first_player""=""players"".""player_id"" UNION SELECT ""match_id"",""second_player"" AS ""player"",""group_id"",""second_score"" AS ""score"" FROM ""matches"" JOIN ""players"" ON ""matches"".""second_player""=""players"".""player_id"") SELECT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""player"",""group_id"",SUM(""score"") AS ""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player"") AS ""ranking"" FROM ""scores"" GROUP BY ""player"",""group_id"") AS ""asd"" WHERE ""ranking""=1"
93,"WITH ""base"" AS (SELECT ""player_id"",""group_id"",SUM(""points"") AS ""total_points"" FROM (SELECT ""p"".""player_id"",""group_id"",SUM(""first_score"") AS ""points"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""first_player""=""p"".""player_id"" GROUP BY ""p"".""player_id"",""group_id"" UNION ALL SELECT ""p"".""player_id"",""group_id"",SUM(""second_score"") AS ""points"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""second_player""=""p"".""player_id"" GROUP BY ""p"".""player_id"",""group_id"") AS ""a"" GROUP BY ""player_id"",""group_id""), ""r"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""rnk"" FROM ""base"") SELECT ""player_id"",""group_id"" FROM ""r"" WHERE ""rnk""=1"
94,"WITH ""t1"" AS (SELECT ""player_id"",""players"".""group_id"",COALESCE(SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END), 0) AS ""tot"" FROM ""players"" LEFT JOIN ""matches"" ON ""players"".""player_id""=""matches"".""first_player"" OR ""players"".""player_id""=""matches"".""second_player"" GROUP BY ""player_id"",""players"".""group_id""), ""t2"" AS (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""tot"" DESC,""player_id"") AS ""ran"" FROM ""t1"") SELECT ""group_id"",""player_id"" FROM ""t2"" WHERE ""ran""=1"
95,"WITH ""t1"" AS (SELECT ""m"".""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""matches"" AS ""m"" GROUP BY 1 UNION ALL SELECT ""m"".""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""matches"" AS ""m"" GROUP BY 1), ""t2"" AS (SELECT ""p"".""group_id"",""t1"".""player_id"",SUM(""score"") AS ""tot"" FROM ""t1"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""t1"".""player_id"" GROUP BY 1,2) SELECT ""t3"".""group_id"",""t3"".""player_id"" FROM (SELECT ""t2"".""group_id"",""t2"".""player_id"",RANK() OVER (PARTITION BY ""t2"".""group_id"" ORDER BY ""t2"".""tot"" DESC,""t2"".""player_id"") AS ""rank"" FROM ""t2"") AS ""t3"" WHERE ""t3"".""rank""=1"
96,"WITH ""core_table"" AS (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_Player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""a"" GROUP BY 1) SELECT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""group_id"",""ct"".""player"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""ct"".""player"") AS ""p_rank"" FROM ""core_table"" AS ""ct"" LEFT JOIN ""Players"" AS ""p"" ON ""ct"".""player""=""p"".""player_id"") AS ""b"" WHERE ""p_rank""=1"
97,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches""), ""cte2"" AS (SELECT ""player"",SUM(""score"") AS ""score"" FROM ""cte"" GROUP BY ""player"") SELECT DISTINCT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""group_id"",""cte2"".""player"",""score"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player"") AS ""rnk"" FROM ""cte2"" LEFT JOIN ""Players"" AS ""p"" ON ""cte2"".""player""=""p"".""player_id"") AS ""temp"" WHERE ""rnk""=1"
98,"WITH ""tbMatchUin"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""tbSumScr"" AS (SELECT ""m"".""player_id"",""p"".""group_id"",SUM(""m"".""score"") AS ""sumScore"" FROM ""tbMatchUin"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""player_id""=""p"".""player_id"" GROUP BY ""m"".""player_id"",""p"".""group_id""), ""tbMaxScr"" AS (SELECT ""m"".""group_id"",MAX(""sumScore"") AS ""maxScore"" FROM ""tbSumScr"" AS ""m"" GROUP BY 1) SELECT ""tbMaxScr"".""group_id"",MIN(""tbSumScr"".""player_id"") AS ""player_id"" FROM ""tbSumScr"" JOIN ""tbMaxScr"" ON ""tbMaxScr"".""group_id""=""tbSumScr"".""group_id"" AND ""tbMaxScr"".""maxScore""=""tbSumScr"".""sumScore"" GROUP BY 1"
99,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""points"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""points"" FROM ""matches""), ""cte2"" AS (SELECT ""cte"".""player_id"",SUM(""points""),MAX(""group_id"") AS ""group_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""points"") DESC,""cte"".""player_id"") AS ""rnk"" FROM ""cte"" LEFT JOIN ""players"" AS ""p"" ON ""cte"".""player_id""=""p"".""player_id"" GROUP BY ""cte"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""cte2"" WHERE ""rnk""=1 GROUP BY 1,2"
100,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""order_players"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""m"".""second_player""=""p"".""player_id"" THEN ""second_score"" WHEN ""m"".""first_player""=""p"".""player_id"" THEN ""first_score"" END) AS ""total_score"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""m"".""second_player""=""p"".""player_id"" OR ""m"".""first_player""=""p"".""player_id"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""A"") AS ""B"" WHERE ""B"".""order_players""=1"
101,"WITH ""uni"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""rnk"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""u"".""score"") DESC,""player_id"") AS ""rk"" FROM ""uni"" AS ""u"" JOIN ""players"" AS ""p"" ON ""u"".""player""=""p"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""rnk"" WHERE ""rk""=1 ORDER BY ""group_id"""
102,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
103,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""t2"" AS (SELECT ""p"".""player_id"",SUM(COALESCE(""score"", 0)) OVER (PARTITION BY ""player_id"") AS ""score"",""p"".""group_id"" FROM ""t1"" RIGHT JOIN ""players"" AS ""p"" ON ""t1"".""player""=""p"".""player_id""), ""t3"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""r"" FROM ""t2"") SELECT DISTINCT ""group_id"",""player_id"" FROM ""t3"" WHERE ""r""=1"
104,"WITH ""cte"" AS (SELECT ""player_id"",SUM(""goals_scored"") AS ""total_goals_scored"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""goals_scored"" FROM ""matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""goals_scored"" FROM ""matches"" GROUP BY ""second_player"") AS ""t"" GROUP BY ""player_id"") SELECT ""player_id"",""group_id"" FROM (SELECT ""p"".""group_id"",""c"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""c"".""total_goals_scored"" DESC,""c"".""player_id"") AS ""rn"" FROM ""cte"" AS ""c"" JOIN ""players"" AS ""p"" ON ""c"".""player_id""=""p"".""player_id"") AS ""b"" WHERE ""rn""=1"
105,"WITH ""tmp"" AS (SELECT ""first_player"",""second_player"",""first_score"",""second_score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""first_player"",""second_score"",""first_score"" FROM ""matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""first_player"" AS ""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""first_score"") DESC,""first_player"") AS ""rnk"" FROM ""players"" AS ""a"" JOIN ""tmp"" AS ""b"" ON ""a"".""player_id""=""b"".""first_player"" GROUP BY 1,2) AS ""t"" WHERE ""rnk""=1 ORDER BY 1"
106,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player"" AS ""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player"") AS ""rk"" FROM (SELECT ""player"",SUM(""score"") AS ""total"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""t1"" GROUP BY ""player"") AS ""t2"" LEFT JOIN ""players"" AS ""p"" ON ""t2"".""player""=""p"".""player_id"") AS ""t3"" WHERE ""rk""=1 ORDER BY ""group_id"""
107,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""group_id"",""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""group_rank"" FROM ""players"" AS ""p"" LEFT JOIN (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""m1"" GROUP BY ""player_id"") AS ""m2"" ON ""p"".""player_id""=""m2"".""player_id"") AS ""g"" WHERE ""group_rank""=1"
108,"WITH ""player_scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""f"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""s"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""ranked"" FROM ""player_scores"" AS ""s"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""s"".""player_id"") AS ""f"" WHERE ""ranked""=1"
109,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) DESC,""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""player_id"",""group_id"") AS ""tmp"" WHERE ""rnk""=1"
110,"WITH ""cte"" AS (SELECT DISTINCT ""p"".""group_id"",""t"".""player_id"",SUM(""t"".""score"") OVER (PARTITION BY ""t"".""player_id"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" JOIN ""Players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""cte"") AS ""t"" WHERE ""rnk""=1"
111,"ERROR: mysql parse error: line 1 column 337 near ""temp left join Players on Players.player_id = temp.player))temp1 where RowNo = 1 "" "
112,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM (""Players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" WHERE ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
113,"SELECT ""C"".""group_id"",""C"".""player"" AS ""player_id"" FROM (SELECT ROW_NUMBER() OVER (PARTITION BY ""B"".""group_id"" ORDER BY ""B"".""total_score"" DESC) AS ""R"",""B"".""group_id"",""B"".""player"",""B"".""total_score"" FROM (SELECT ""P"".""group_id"",""A"".""player"",SUM(""A"".""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""A"" LEFT JOIN ""Players"" AS ""P"" ON ""P"".""player_id""=""A"".""player"" GROUP BY ""A"".""player"") AS ""B"") AS ""C"" WHERE ""C"".""R""=1"
114,"WITH ""cte1"" AS (SELECT ""first_player"",""first_score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""p"".""group_id"",""first_player"",SUM(""first_score"") AS ""tot_score"" FROM ""cte1"" JOIN ""Players"" AS ""p"" ON ""cte1"".""first_player""=""p"".""player_id"" GROUP BY ""first_player"" ORDER BY ""p"".""group_id"",""first_player"",""tot_score"" DESC), ""cte3"" AS (SELECT ""cte2"".*,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""tot_score"" DESC) AS ""giv_rank"" FROM ""cte2"") SELECT ""group_id"" AS ""GROUP_ID"",""first_player"" AS ""PLAYER_ID"" FROM ""cte3"" WHERE ""giv_rank""=1"
115,"SELECT ""t3"".""group_id"",""t3"".""player"" AS ""player_id"" FROM (SELECT ""p"".""group_id"",""t2"".""player"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""t2"".""score"" DESC,""t2"".""player"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN (SELECT ""t1"".""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t1"" GROUP BY ""t1"".""player"") AS ""t2"" ON ""p"".""player_id""=""t2"".""player"") AS ""t3"" WHERE ""t3"".""rnk""=1"
116,"SELECT ""group_id"",CASE WHEN COUNT(1)>1 THEN MIN(""player_id"") ELSE ""player_id"" END AS ""player_id"" FROM (SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""max_score"" DESC) AS ""score_rnk"" FROM (SELECT ""group_id"",""player_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" WHEN ""player_id""=""second_player"" THEN ""second_score"" END) AS ""max_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"") AS ""a"") AS ""b"" WHERE ""score_rnk""=1) AS ""c"" GROUP BY ""group_id"""
117,"WITH ""t"" AS (WITH ""t"" AS (SELECT ""first_player"" AS ""pid"",SUM(""first_score"") AS ""s"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""pid"",SUM(""second_score"") AS ""s"" FROM ""Matches"" GROUP BY ""second_player"") SELECT ""t"".""pid"",""p"".""group_id"",SUM(""s"") AS ""score"" FROM ""t"" JOIN ""players"" AS ""p"" ON ""t"".""pid""=""p"".""player_id"" GROUP BY ""pid"" ORDER BY ""group_id"",""score"" DESC,""pid"") SELECT ""group_id"",""pid"" AS ""player_id"" FROM ""t"" GROUP BY ""group_id"""
118,"WITH ""t"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches""), ""t2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total"" FROM ""Players"" JOIN ""t"" ON ""Players"".""player_id""=""t"".""player"" GROUP BY ""group_id"",""player_id""), ""t3"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM ""t2"") SELECT ""group_id"",""player_id"" FROM ""t3"" WHERE ""rk""=1 ORDER BY ""group_id"""
119,"WITH ""full_scores"" AS (SELECT ""m"".""first_player"" AS ""player_id"",""m"".""first_score"" AS ""score"",""p"".""group_id"" AS ""group_id"" FROM ""matches"" AS ""m"" JOIN ""players"" AS ""p"" ON ""m"".""first_player""=""p"".""player_id"" UNION ALL SELECT ""m"".""second_player"" AS ""player_id"",""m"".""second_score"" AS ""score"",""p"".""group_id"" AS ""group_id"" FROM ""matches"" AS ""m"" JOIN ""players"" AS ""p"" ON ""m"".""second_player""=""p"".""player_id""), ""rankings"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC) AS ""ranking"" FROM ""full_scores"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""rankings"" WHERE ""ranking""=1 GROUP BY ""ranking"",""group_id"""
120,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""group_id"",SUM(""scores"") AS ""total_scores"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""scores"") DESC,""p"".""player_id"") AS ""ranking"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""scores"" FROM ""Matches"" GROUP BY ""player_id"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""scores"" FROM ""Matches"" GROUP BY ""player_id"") AS ""a"" JOIN ""Players"" AS ""p"" ON ""a"".""player_id""=""p"".""player_id"" GROUP BY ""p"".""player_id"") AS ""b"" WHERE ""ranking""=1"
121,"SELECT ""r"".""group_id"",""r"".""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""t"".""score"" DESC,""p"".""player_id"") AS ""player_rank"" FROM ""Players"" AS ""p"" JOIN (SELECT ""player_id"",SUM(""s"".""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""s"" GROUP BY ""player_id"") AS ""t"" ON ""p"".""player_id""=""t"".""player_id"") AS ""r"" WHERE ""r"".""player_rank""=1"
122,"WITH ""CTE"" AS ((SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" AS ""m"") UNION ALL (SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"")) SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""group_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""p"".""player_id"") AS ""rk"" FROM ""CTE"" JOIN ""Players"" AS ""p"" ON ""CTE"".""player_id""=""p"".""player_id"" GROUP BY ""p"".""player_id"") AS ""temp"" WHERE ""rk""=1"
123,"WITH ""cte"" AS (SELECT ""player"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches"") AS ""t"" GROUP BY ""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""row_id"" FROM ""cte"" JOIN ""players"" AS ""p"" ON ""cte"".""player""=""p"".""player_id"") AS ""t"" WHERE ""row_id""=1"
124,"WITH ""cte_player_agg"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE ""m"".""second_score"" END) AS ""total_points"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2), ""cte_group_rank"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""player_rank"" FROM ""cte_player_agg""), ""cte_final"" AS (SELECT ""group_id"",""player_id"" FROM ""cte_group_rank"" WHERE ""player_rank""=1) SELECT * FROM ""cte_final"""
125,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",""total_points"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""position"" FROM (SELECT ""player_id"",""group_id"",COALESCE(SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END), 0) AS ""total_points"" FROM ""Players"" LEFT JOIN ""Matches"" ON ""Players"".""player_id""=""Matches"".""first_player"" OR ""Players"".""player_id""=""Matches"".""second_player"" GROUP BY ""player_id"",""group_id"") AS ""tmp"") AS ""tmp2"" WHERE ""position""=1"
126,"WITH ""player_points"" AS (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" WHEN ""player_id""=""second_player"" THEN ""second_score"" ELSE 0 END) AS ""tot_points"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""player_id""), ""rnk_players"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""tot_points"" DESC,""player_id"") AS ""rnk"" FROM ""player_points"") SELECT ""group_id"",""player_id"" FROM ""rnk_players"" WHERE ""rnk""=1"
127,"WITH ""cte"" AS (SELECT DISTINCT ""first_player"" AS ""player_id"",SUM(""first_score"") OVER (PARTITION BY ""first_player"") AS ""score"" FROM ""Matches"" UNION ALL SELECT DISTINCT ""second_player"" AS ""player_id"",SUM(""second_score"") OVER (PARTITION BY ""second_player"") AS ""score"" FROM ""Matches""), ""cte2"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM ""cte"" GROUP BY ""player_id"" ORDER BY ""player_id""), ""cte3"" AS (SELECT ""player_id"",""group_id"",COALESCE(""total_score"", 0) AS ""total_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""rnk"" FROM ""cte2"" RIGHT JOIN ""Players"" USING (""player_id"")) SELECT DISTINCT ""group_id"",""player_id"" FROM ""cte3"" WHERE ""rnk""=1"
128,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""a"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""sum_score"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""player_id"",SUM(""score"") AS ""sum_score"" FROM ""cte"" GROUP BY 1) AS ""a"" LEFT JOIN ""Players"" ON ""a"".""player_id""=""Players"".""player_id"") AS ""b"" WHERE ""rk""=1"
129,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" AS ""m"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"" AS ""m""), ""cte1"" AS (SELECT ""player_id"",SUM(""score"") AS ""sum"" FROM ""cte"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""players"".""group_id"",""cte1"".""player_id"",""cte1"".""sum"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""cte1"".""sum"" DESC,""player_id"") AS ""rnk"" FROM ""cte1"" JOIN ""players"" ON ""cte1"".""player_id""=""players"".""player_id"" ORDER BY ""group_id"") SELECT ""group_id"",""player_id"" FROM ""cte2"" WHERE ""rnk""=1"
130,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
131,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
132,"SELECT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""player"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""tscore"" DESC,""player"") AS ""rnk"" FROM (SELECT ""player"",SUM(""score"") AS ""tscore"",""group_id"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""m"" RIGHT JOIN ""Players"" AS ""p"" ON ""m"".""player""=""p"".""player_id"" GROUP BY ""group_id"",""p"".""player_id"") AS ""a"") AS ""b"" WHERE ""rnk""=1 ORDER BY ""group_id"""
133,"SELECT ""group_id"",MIN(""player_id"") AS ""PLAYER_ID"" FROM ""Players"" AS ""p"" JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""s"" ON ""p"".""player_id""=""s"".""player"" WHERE ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM ""Players"" AS ""p"" JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""s"" ON ""p"".""player_id""=""s"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
134,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
135,"WITH ""cteunpivot"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""ctepersonalscore"" AS (SELECT ""A"".""player_id"",""B"".""group_id"",SUM(""A"".""score"") AS ""score"" FROM ""cteunpivot"" AS ""A"" LEFT JOIN ""players"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" GROUP BY ""A"".""player_id"",""B"".""group_id""), ""ctegroupmaxscore"" AS (SELECT ""group_id"",MAX(""score"") AS ""maxscore"" FROM ""ctepersonalscore"" GROUP BY ""group_id""), ""ctewinners"" AS (SELECT ""A"".""group_id"",""B"".""player_id"" FROM ""ctegroupmaxscore"" AS ""A"" LEFT JOIN ""ctepersonalscore"" AS ""B"" ON ""A"".""group_id""=""B"".""group_id"" AND ""A"".""maxscore""=""B"".""score"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""ctewinners"" GROUP BY ""group_id"" ORDER BY ""group_id"""
136,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches""), ""t2"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""t1"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""t2"".""score"" DESC,""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN ""t2"" USING (""player_id"")) AS ""tmp"" WHERE ""rnk""=1 ORDER BY ""group_id"""
137,"WITH ""main"" AS (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""P"".""player_id""=""M"".""first_player"" THEN ""first_Score"" ELSE ""second_Score"" END) AS ""score"" FROM ""Players"" AS ""P"" LEFT JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""first_player"" OR ""P"".""player_id""=""M"".""second_player"" GROUP BY ""player_id""), ""second"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranking"" FROM ""main"") SELECT ""group_id"",""player_id"" FROM ""second"" WHERE ""RANKING""=1"
138,"WITH ""player_scores_0"" AS (SELECT ""a"".""group_id"",""a"".""player_id"",COALESCE(""b"".""first_score"", 0) AS ""total_score_0"" FROM ""Players"" AS ""a"" LEFT JOIN ""Matches"" AS ""b"" ON ""a"".""player_id""=""b"".""first_player"" UNION ALL SELECT ""c"".""group_id"",""c"".""player_id"",COALESCE(""d"".""second_score"", 0) AS ""total_score_0"" FROM ""Players"" AS ""c"" LEFT JOIN ""Matches"" AS ""d"" ON ""c"".""player_id""=""d"".""second_player""), ""player_scores"" AS (SELECT ""group_id"",""player_id"",SUM(""total_score_0"") AS ""total_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""total_score_0"") DESC,""player_id"") AS ""group_rank"" FROM ""player_scores_0"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""player_scores"" WHERE ""group_rank""=1"
139,"WITH ""c"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""a"" JOIN ""Players"" AS ""b"" ON ""a"".""first_player""=""b"".""player_id"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"",""group_id"" FROM ""Matches"" AS ""a"" JOIN ""Players"" AS ""b"" ON ""a"".""second_player""=""b"".""player_id""), ""e"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""scor"" FROM ""c"" GROUP BY ""group_id"",""player_id""), ""f"" AS (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""scor"" DESC,""player_id"") AS ""k"" FROM ""e"") SELECT ""group_id"",""player_id"" FROM ""f"" WHERE ""k""=1"
140,"WITH ""CTE1"" AS (SELECT ""d1"".""first_player"",""d2"".""group_id"" AS ""group_id_first"",""d1"".""second_player"",""d3"".""group_id"" AS ""group_id_second"",""d1"".""first_score"",""d1"".""second_score"" FROM (""Matches"" AS ""d1"" JOIN ""Players"" AS ""d2"" ON ""d1"".""first_player""=""d2"".""player_id"") JOIN ""Players"" AS ""d3"" ON ""d1"".""second_player""=""d3"".""player_id""), ""CTE2"" AS (SELECT ""first_player"" AS ""player_id"",""group_id_first"" AS ""group_id"",""first_score"" AS ""score"" FROM ""CTE1"" UNION ALL SELECT ""second_player"",""group_id_second"" AS ""group_id"",""second_score"" AS ""score"" FROM ""CTE1"") SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",SUM(""score"") AS ""sum_score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""ranking"" FROM ""CTE2"" GROUP BY ""player_id"",""group_id"") AS ""sub"" WHERE ""ranking""=1"
141,"WITH ""scores"" AS (SELECT ""player"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""A"" GROUP BY ""player"") (SELECT ""group_id"",MIN(""p1"".""player_id"") AS ""player_id"" FROM ""Players"" AS ""p1"" LEFT JOIN ""scores"" ON ""p1"".""player_id""=""scores"".""player"" WHERE ""total_score""=(SELECT MAX(""total_score"") FROM ""Players"" LEFT JOIN ""scores"" ON ""players"".""player_id""=""scores"".""player"" WHERE ""players"".""group_id""=""p1"".""group_id"") GROUP BY ""group_id"")"
142,"WITH ""m"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""ms"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""m"".""player_id"" AS ""player_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""m"".""score"" DESC,""m"".""player_id"") AS ""rnk"" FROM ""players"" AS ""p"" JOIN ""m"" ON ""p"".""player_id""=""m"".""player_id"") AS ""t"" WHERE ""t"".""rnk""=1"
143,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""t2"" AS (SELECT ""p"".""player_id"",SUM(COALESCE(""score"", 0)) OVER (PARTITION BY ""player_id"") AS ""score"",""p"".""group_id"" FROM ""t1"" RIGHT JOIN ""players"" AS ""p"" ON ""t1"".""player""=""p"".""player_id""), ""t3"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""r"" FROM ""t2"") SELECT DISTINCT ""group_id"",""player_id"" FROM ""t3"" WHERE ""r""=1"
144,"WITH ""t1"" AS (SELECT * FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""tmp"" LEFT JOIN ""Players"" AS ""p"" ON ""tmp"".""player""=""p"".""player_id""), ""t2"" AS (SELECT ""group_id"",""player"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player"") AS ""rk"" FROM ""t1"" GROUP BY ""group_id"",""player"") SELECT ""group_id"" AS ""group_id"",""player"" AS ""player_id"" FROM ""t2"" WHERE ""rk""=1"
145,"WITH ""temp"" AS (SELECT ""player_id"",""group_id"",COALESCE(""first_score"", 0) AS ""score"" FROM ""players"" JOIN ""Matches"" ON ""player_id""=""first_player"" UNION ALL SELECT ""player_id"",""group_id"",COALESCE(""second_score"", 0) AS ""score"" FROM ""players"" JOIN ""Matches"" ON ""player_id""=""second_player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""temp"" GROUP BY ""group_id"",""player_id"") AS ""temp"") AS ""temp2"" WHERE ""rn""=1"
146,"WITH ""t1"" AS (SELECT ""p"".""player_id"",COALESCE(SUM(""m"".""first_score"") OVER (PARTITION BY ""player_id""), 0) AS ""s1"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player""), ""t2"" AS (SELECT ""p"".""player_id"",COALESCE(SUM(""m"".""second_score"") OVER (PARTITION BY ""player_id""), 0) AS ""s2"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player""), ""t3"" AS (SELECT ""t1"".""player_id"",""s1""+""s2"" AS ""s"",""group_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""s1""+""s2"" DESC,""player_id"") AS ""n"" FROM (""t1"" JOIN ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"") RIGHT JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""t1"".""player_id"") SELECT DISTINCT ""group_id"",""player_id"" FROM ""t3"" WHERE ""n""=1"
147,"WITH ""t2"" AS (SELECT ""player_id"",SUM(""WIN"") AS ""cnt"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""WIN"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" AS ""WIN"" FROM ""Matches"") AS ""t1"" GROUP BY ""PLAYER_ID""), ""t3"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",COALESCE(""cnt"", 0) AS ""wins"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY COALESCE(""cnt"", 0) DESC,""p"".""player_id"") AS ""rnum"" FROM ""Players"" AS ""p"" LEFT JOIN ""t2"" ON ""p"".""player_id""=""t2"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""T3"" WHERE ""rnum""=1"
148,"WITH ""cte2"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches"") AS ""cte1"" GROUP BY 1), ""cte3"" AS (SELECT ""p"".""group_id"",""c"".""player_id"",""c"".""score"" FROM ""cte2"" AS ""c"" JOIN ""players"" AS ""p"" ON ""c"".""player_id""=""p"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""cte3"" WHERE ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM ""cte3"" GROUP BY 1) GROUP BY 1 ORDER BY 1"
149,"WITH ""tmp1"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",""m"".""first_player"",""m"".""second_player"",""m"".""first_score"",""m"".""second_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player""), ""tmp2"" AS (SELECT ""player_id"",""group_id"",(SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""player_id""=""second_player"" THEN ""second_score"" ELSE 0 END)) AS ""scores"" FROM ""tmp1"" GROUP BY 1,2), ""tmp3"" AS (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""scores"" DESC,""player_id"") AS ""rk"" FROM ""tmp2"") SELECT ""player_id"",""group_id"" FROM ""tmp3"" WHERE ""rk""=1"
150,"WITH ""cte"" AS ((SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"")), ""cte1"" AS (SELECT ""player"",SUM(""score"") AS ""total"" FROM ""cte"" GROUP BY ""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",""c"".""total"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""c"".""total"" DESC,""p"".""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" JOIN ""cte1"" AS ""c"" ON ""p"".""player_id""=""c"".""player"") AS ""a"" WHERE ""rnk""=1 ORDER BY ""group_id"""
151,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""a"".""group_id"",""a"".""player_id"",SUM(""b"".""score"") AS ""total_score"" FROM ""players"" AS ""a"" LEFT JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" GROUP BY 1,2) AS ""tot_rank"") AS ""n"" WHERE ""rn""=1 GROUP BY 1"
152,"WITH ""tmp"" AS (SELECT ""player_id"",""group_id"",""first_score"" AS ""score"" FROM ""Players"" AS ""t1"" JOIN ""Matches"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""first_player"" UNION ALL SELECT ""player_id"",""group_id"",""second_score"" AS ""score"" FROM ""Players"" AS ""t1"" JOIN ""Matches"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""second_player""), ""tmp1"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""tmp"" GROUP BY 1,2), ""tmp2"" AS (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC) AS ""rnk"" FROM ""tmp1"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""tmp2"" WHERE ""rnk""=1 GROUP BY 1"
153,"SELECT ""group_id"",""player_id"" FROM (SELECT ""players"".""group_id"",""players"".""player_id"",""score"".""total_score"",RANK() OVER (PARTITION BY ""players"".""group_id"" ORDER BY ""score"".""total_score"" DESC,""players"".""player_id"") AS ""p_rank"" FROM (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""all_player"" GROUP BY ""player_id"") AS ""score"" JOIN ""players"" ON ""players"".""player_id""=""score"".""player_id"") AS ""ranked_player"" WHERE ""p_rank""=1"
154,"WITH ""score"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",COALESCE(SUM(""m"".""score""), 0) AS ""total_score"" FROM ""players"" AS ""p"" LEFT JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""m"" ON ""p"".""player_id""=""m"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rk"" FROM ""score"") AS ""a"" WHERE ""rk""=1"
155,"WITH ""CTE"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""CTE_1"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""CTE"" GROUP BY ""player_id"") SELECT DISTINCT ""group_id"",FIRST_VALUE(""c"".""player_id"") OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""c"".""player_id"") AS ""player_id"" FROM ""cte_1"" AS ""c"" JOIN ""players"" AS ""p"" ON ""c"".""player_id""=""p"".""player_id"""
156,"SELECT ""group_id"",""player_id"" FROM (SELECT ""t1"".""group_id"",""t2"".""player_id"",SUM(""t2"".""score"") AS ""score"" FROM (""Players"" AS ""t1"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""t2"" WHERE ""t1"".""player_id""=""t2"".""player_id"" GROUP BY ""t2"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
157,"WITH ""CTE"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""CTE_1"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""CTE"" GROUP BY ""player_id"") SELECT DISTINCT ""group_id"",FIRST_VALUE(""c"".""player_id"") OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""c"".""player_id"") AS ""player_id"" FROM ""cte_1"" AS ""c"" LEFT JOIN ""players"" AS ""p"" ON ""c"".""player_id""=""p"".""player_id"""
158,"WITH ""t"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches""), ""t1"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""t"" ON ""p"".""player_id""=""t"".""player"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rnk"" FROM ""t1"") AS ""tmp"" WHERE ""rnk""=1"
159,"SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC) AS ""rnk"" FROM ""Players"" JOIN (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" GROUP BY ""player_id"") AS ""t2"" USING (""player_id"")) AS ""t2"" WHERE ""rnk""=1 GROUP BY ""group_id"""
160,"WITH ""score"" AS (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""matches"" GROUP BY 1) SELECT ""p"".""group_id"",""p"".""player_id"" FROM ""players"" AS ""p"" JOIN (SELECT ""p"".""group_id"",""p"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(""s"".""score"") DESC) AS ""rk"" FROM ""players"" AS ""p"" JOIN ""score"" AS ""s"" ON ""s"".""player_id""=""p"".""player_id"" GROUP BY 1,2) AS ""tmp"" ON ""tmp"".""group_id""=""p"".""group_id"" AND ""tmp"".""rk""=1 AND ""tmp"".""player_id""=""p"".""player_id"""
161,"SELECT ""group_id"",""player_Id"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""p"".*,SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" ELSE 0 END) AS ""score"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""a"") AS ""b"" WHERE ""rn""=1"
162,"SELECT ""GROUP_ID"",""PLAYER_ID"" FROM (SELECT ""group_id"" AS ""GROUP_ID"",""player_id"" AS ""PLAYER_ID"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" WHEN ""player_id""=""second_player"" THEN ""second_score"" END) AS ""total"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""t"") AS ""f"" WHERE ""f"".""rk""=1"
163,"SELECT ""C"".""group_id"",""C"".""player"" AS ""player_id"" FROM (SELECT ROW_NUMBER() OVER (PARTITION BY ""B"".""group_id"" ORDER BY ""B"".""total_score"" DESC) AS ""R"",""B"".""group_id"",""B"".""player"",""B"".""total_score"" FROM (SELECT ""P"".""group_id"",""A"".""player"",SUM(""A"".""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""A"" LEFT JOIN ""Players"" AS ""P"" ON ""P"".""player_id""=""A"".""player"" GROUP BY ""A"".""player"") AS ""B"") AS ""C"" WHERE ""C"".""R""=1"
164,"WITH ""score_cte"" AS (SELECT ""group_id"",""player_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE ""m"".""second_score"" END) AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""group_id"",""p"".""player_id"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""score_cte"" WHERE ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") AS ""score"" FROM ""score_cte"" GROUP BY ""group_id"") GROUP BY ""group_id"""
165,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(CASE WHEN ""p"".""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) DESC,""player_id"") AS ""rn"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""s"" WHERE ""rn""=1"
166,"SELECT ""group_id"",""player_id"" FROM (SELECT ""b"".""player_id"",""total_score"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""b"".""player_id"") AS ""rw"" FROM (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""a"" GROUP BY ""player_id"" ORDER BY ""player_id"") AS ""b"" LEFT JOIN ""players"" AS ""p"" ON ""b"".""player_id""=""p"".""player_id"") AS ""c"" WHERE ""rw""=1"
167,"SELECT ""b"".""group_id"",""b"".""player_id"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(""a"".""score"") DESC,""p"".""player_id"") AS ""rank_d"" FROM ""Players"" AS ""p"" LEFT JOIN (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""a"" ON ""p"".""player_id""=""a"".""player"" GROUP BY ""group_id"",""p"".""player_id"") AS ""b"" WHERE ""b"".""rank_d""=1"
168,"WITH ""SCORE_TB"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION SELECT ""match_id"",""second_player"",""second_score"" FROM ""Matches""), ""PLAY_SUM"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""Players"" LEFT JOIN ""SCORE_TB"" USING (""player_id"") GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""ranking"" FROM ""PLAY_SUM"") AS ""sub"" WHERE ""ranking""=1 ORDER BY ""group_id"""
169,"WITH ""uni"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""rnk"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""u"".""score"") DESC,""player_id"") AS ""rk"" FROM ""uni"" AS ""u"" JOIN ""players"" AS ""p"" ON ""u"".""player""=""p"".""player_id"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""rnk"" WHERE ""rk""=1 ORDER BY ""group_id"""
170,"WITH ""cte"" AS (SELECT ""player"",SUM(""score"") AS ""sum_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""sub"" GROUP BY ""player"") SELECT ""group_id"",""player"" AS ""player_id"" FROM (SELECT ""player"",""group_id"",""sum_score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""sum_score"" DESC,""player"") AS ""rank0"" FROM ""cte"" AS ""c"" JOIN ""players"" AS ""p"" ON ""c"".""player""=""p"".""player_id"") AS ""sub2"" WHERE ""rank0""=1"
171,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM (""Players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" WHERE ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""p"".""group_id"",""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
172,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM ""Players"" AS ""p"" JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" ON ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""p"".""group_id"",""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
173,"WITH ""main"" AS (SELECT ""b"".*,""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id""), ""sum_ranked"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rank_val"" FROM ""main"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",""player_id"" FROM ""sum_ranked"" WHERE ""rank_val""=1"
174,"WITH ""t1"" AS (SELECT ""t"".""player_id"",""p"".""group_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" GROUP BY ""second_player"") AS ""t"" JOIN ""Players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"" GROUP BY ""player_id""), ""t2"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""t1"") SELECT ""group_id"",""player_id"" FROM ""t2"" WHERE ""rnk""=1"
175,"WITH ""stack"" AS (SELECT ""p"".""group_id"",""m"".""first_player"" AS ""player_id"",""m"".""first_score"" AS ""score"" FROM ""matches"" AS ""m"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""m"".""first_player"" UNION ALL SELECT ""p"".""group_id"",""m"".""second_player"",""m"".""second_score"" FROM ""matches"" AS ""m"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""m"".""first_player""), ""scoreagg"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""scoreagg"" FROM ""stack"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""scoreagg"" DESC,""player_id"") AS ""rn"" FROM ""scoreagg"") AS ""d"" WHERE ""rn""=1"
176,"WITH ""table1"" AS (SELECT ""p"".""group_id"",""t"".""player_id"",SUM(""t"".""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" LEFT JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""t"".""player_id"" GROUP BY 1,2 ORDER BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC) AS ""rnk"" FROM ""table1"") AS ""a"" WHERE ""rnk""=1"
177,"WITH ""cte"" AS (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""f"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",COALESCE(""cte"".""score"", 0),""p"".""group_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""cte"".""score"" DESC,""p"".""player_id"") AS ""r"" FROM ""players"" AS ""p"" LEFT JOIN ""cte"" ON ""p"".""player_id""=""cte"".""player"") AS ""cte1"" WHERE ""r""=1"
178,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM (""players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" WHERE ""ps"".""player_id""=""p"".""player_id"" GROUP BY ""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
179,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total"" FROM (SELECT ""group_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM (SELECT ""M"".*,""P"".""group_id"" FROM ""Matches"" AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""first_player""=""P"".""player_id"") AS ""T1"" UNION ALL SELECT ""group_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM (SELECT ""M"".*,""P"".""group_id"" FROM ""Matches"" AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""first_player""=""P"".""player_id"") AS ""T2"") AS ""T3"" GROUP BY ""group_id"",""player_id"") AS ""T4"") AS ""T5"" WHERE ""rn""=1"
180,"WITH ""CTE1"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""CTE2"" AS (SELECT ""a"".""player_id"",""b"".""group_id"",SUM(""a"".""score"") AS ""score"" FROM ""CTE1"" AS ""a"" LEFT JOIN ""players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" GROUP BY 1,2), ""CTE3"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranking"" FROM ""CTE2"") SELECT ""group_id"",""player_id"" FROM ""CTE3"" WHERE ""ranking""=1"
181,"WITH ""playerscore"" AS (SELECT ""player_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" WHEN ""player_id""=""second_player"" THEN ""second_score"" END) AS ""totalscore"" FROM ""players"" LEFT JOIN ""Matches"" ON ""player_id""=""first_player"" OR ""player_id""=""second_player"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",DENSE_RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""s"".""totalscore"" DESC,""p"".""player_id"") AS ""playerrank"" FROM ""Players"" AS ""p"" LEFT JOIN ""playerscore"" AS ""s"" ON ""p"".""player_id""=""s"".""player_id"") AS ""a"" WHERE ""playerrank""=1 ORDER BY ""group_id"""
182,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total"" FROM (SELECT ""group_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM (SELECT ""M"".*,""P"".""group_id"" FROM ""Matches"" AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""first_player""=""P"".""player_id"") AS ""T1"" UNION ALL SELECT ""group_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM (SELECT ""M"".*,""P"".""group_id"" FROM ""Matches"" AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""first_player""=""P"".""player_id"") AS ""T2"") AS ""T3"" GROUP BY ""group_id"",""player_id"") AS ""T4"") AS ""T5"" WHERE ""rn""=1"
183,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
184,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",""total"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""group_id"",""player_id"",SUM(""first_score"") AS ""total"" FROM ((SELECT ""first_player"",""first_score"" FROM ""Matches"") UNION ALL (SELECT ""second_player"",""second_score"" FROM ""Matches"")) AS ""m1"" LEFT JOIN ""Players"" AS ""p"" ON ""m1"".""first_player""=""p"".""player_id"" GROUP BY ""group_id"",""player_id"") AS ""table1"") AS ""table2"" WHERE ""rk""=1"
185,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""group_id"",SUM(""score"") DESC,""player_id"") AS ""rank1"" FROM (SELECT ""p"".""group_id"",""m"".""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Players"" AS ""p"" ON (""m"".""first_player""=""p"".""player_id"") GROUP BY ""p"".""group_id"",""m"".""first_player"" UNION ALL SELECT ""p"".""group_id"",""m"".""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Players"" AS ""p"" ON (""m"".""second_player""=""p"".""player_id"") GROUP BY ""p"".""group_id"",""m"".""second_player"") AS ""xx"" GROUP BY ""group_id"",""player_id"") AS ""abc"" WHERE ""rank1""=1 ORDER BY ""score"""
186,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score_total"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""p"".""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) AS ""score_total"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""s"") AS ""a"" WHERE ""rn""=1"
187,"WITH ""mtch"" AS (SELECT ""p"".""group_id"",""m"".""player_id"",SUM(""m"".""score"") AS ""sum_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""m"" JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""m"".""player_id"" GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"",""player_id"") SELECT ""player_id"",""group_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""sum_score"" DESC,""player_id"") AS ""rk"" FROM ""mtch"") AS ""cte"" WHERE ""rk""=1"
188,"WITH ""a"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""t1"" GROUP BY 1), ""b"" AS (SELECT ""group_id"",""player_id"",""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC) AS ""r_num"" FROM (SELECT ""a"".""player_id"",""p"".""group_id"",""a"".""score"" FROM ""a"" JOIN ""players"" AS ""p"" ON ""a"".""player_id""=""p"".""player_id"") AS ""t1"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""b"" WHERE ""r_num""=1 GROUP BY 1"
189,"WITH ""tem"" AS (SELECT ""a"".""player_id"",SUM(CASE WHEN ""a"".""player_id""=""b"".""first_player"" THEN ""first_score"" ELSE 0 END) AS ""first_score"",SUM(CASE WHEN ""a"".""player_id""=""b"".""second_player"" THEN ""second_score"" ELSE 0 END) AS ""second_score"" FROM ""players"" AS ""a"" LEFT JOIN ""matches"" AS ""b"" ON ""a"".""player_id""=""b"".""first_player"" OR ""a"".""player_id""=""b"".""second_player"" GROUP BY ""player_id""), ""tem2"" AS (SELECT ""a"".""player_id"",""a"".""first_score""+""a"".""second_score"" AS ""total_score"",""b"".""group_id"" FROM ""tem"" AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" GROUP BY ""player_id"" ORDER BY ""total_score"" DESC,""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rank_n"" FROM ""tem2"") AS ""a"" WHERE ""rank_n""=1"
190,"WITH ""PlayerScore"" AS (SELECT ""Unioned"".""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""Unioned"" GROUP BY ""Unioned"".""player_id""), ""GroupPlayerScore"" AS (SELECT ""PlayerScore"".*,""Players"".""group_id"" FROM ""PlayerScore"" LEFT JOIN ""Players"" ON ""PlayerScore"".""player_id""=""Players"".""player_id"") SELECT ""group_id"" AS ""GROUP_ID"",""player_id"" AS ""PLAYER_ID"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranked"" FROM ""GroupPlayerScore"") AS ""ranked"" WHERE ""ranked""=1"
191,"WITH ""home"" AS (SELECT ""p"".*,COALESCE(""m"".""first_score"", 0) AS ""first_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player""), ""home_agg"" AS (SELECT ""h"".""player_id"",""h"".""group_id"",SUM(""h"".""first_score"") AS ""ts"" FROM ""home"" AS ""h"" GROUP BY ""h"".""player_id""), ""away"" AS (SELECT ""p"".*,COALESCE(""m"".""second_score"", 0) AS ""second_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player""), ""away_agg"" AS (SELECT ""a"".""player_id"",""a"".""group_id"",SUM(""a"".""second_score"") AS ""ts"" FROM ""away"" AS ""a"" GROUP BY ""a"".""player_id""), ""temp"" AS (SELECT ""a"".""player_id"",""a"".""group_id"",""a"".""ts""+""b"".""ts"" AS ""total_score"" FROM ""home_agg"" AS ""a"" JOIN ""away_agg"" AS ""b"" USING (""player_id"")) SELECT ""temp"".""group_id"",MIN(""temp"".""player_id"") AS ""player_id"" FROM ""temp"" WHERE ROW(""temp"".""group_id"",""temp"".""total_score"") IN (SELECT ""tem"".""group_id"",MAX(""tem"".""total_score"") FROM ""temp"" AS ""tem"" GROUP BY ""tem"".""group_id"") GROUP BY ""temp"".""group_id"""
192,"WITH ""t1"" AS (SELECT ""p"".""player_id"",SUM(CASE WHEN ""m"".""first_player""=""p"".""player_id"" THEN ""m"".""first_score"" WHEN ""m"".""second_player""=""p"".""player_id"" THEN ""m"".""second_score"" ELSE 0 END) AS ""score"",""p"".""group_id"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""player_id"" ORDER BY ""p"".""group_id"",""p"".""player_id""), ""t2"" AS (SELECT ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""id"",""group_id"",""player_id"" FROM ""t1"") SELECT ""group_id"",""player_id"" FROM ""t2"" WHERE ""id""=1 ORDER BY ""group_id"""
193,"WITH ""m"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""matches"" GROUP BY ""second_player"") AS ""ms"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""m"".""player_id"" AS ""player_id"",SUM(""m"".""score"") AS ""score"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(""m"".""score"") DESC,""m"".""player_id"") AS ""rnk"" FROM ""players"" AS ""p"" JOIN ""m"" ON ""p"".""player_id""=""m"".""player_id"" GROUP BY 2,1) AS ""t"" WHERE ""t"".""rnk""=1"
194,"SELECT ""group_id"",""player_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rk"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE 0 END)+SUM(CASE WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""m"".""second_score"" ELSE 0 END) AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""a"") AS ""b"" WHERE ""rk""=1"
195,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC) AS ""rnk"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC) AS ""rownum"" FROM (SELECT ""group_id"",""player_id"",""match_id"",""first_score"" AS ""score"" FROM ""Players"" AS ""P"" JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""first_player"" UNION ALL SELECT ""group_id"",""player_id"",""match_id"",""second_score"" AS ""score"" FROM ""Players"" AS ""P"" JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""second_player"") AS ""a"" GROUP BY 1,2) AS ""a"" WHERE ""rnk""=1 AND ""rownum""=1 ORDER BY 1"
196,"WITH ""all_player"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""player_score"" FROM ""matches"" UNION SELECT ""match_id"",""second_player"",""second_score"" FROM ""matches""), ""player_total_score"" AS (SELECT ""player_id"",SUM(""player_score"") AS ""total_score"" FROM ""all_player"" GROUP BY 1) SELECT DISTINCT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""pts"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""pts"".""total_score"" DESC,""player_id"") AS ""player_rnk"" FROM ""player_total_score"" AS ""pts"" JOIN ""players"" ON ""players"".""player_id""=""pts"".""player_id"") AS ""tmp"" WHERE ""player_rnk""=1"
197,"SELECT ""group_id"",""Player_id"" FROM (SELECT ""z"".""group_id"",""z"".""player_id"",RANK() OVER (PARTITION BY ""z"".""group_id"" ORDER BY ""z"".""sscore"" DESC,""z"".""player_id"") AS ""rnk"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",SUM(""score"") AS ""sscore"" FROM (""players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" AS ""a"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"" AS ""a"") AS ""t"" WHERE ""p"".""player_id""=""t"".""player_id"" GROUP BY ""t"".""player_id"") AS ""z"") AS ""y"" WHERE ""rnk""=1"
198,"WITH ""score"" AS (SELECT ""player"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""sub"" GROUP BY ""player""), ""player"" AS (SELECT ""player_id"",""total_score"",""group_id"" FROM ""players"" AS ""p"" JOIN ""score"" AS ""s"" ON ""p"".""player_id""=""s"".""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""ranks"" FROM ""player"") AS ""sub2"" WHERE ""ranks""=1"
199,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""player_total"".""score"" DESC,""p"".""player_id"") AS ""rank1"" FROM ""players"" AS ""p"" JOIN (SELECT ""player_id"",SUM(""player_score"".""score"") AS ""score"" FROM ((SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"")) AS ""player_score"" GROUP BY ""player_id"") AS ""player_total"" ON ""p"".""player_id""=""player_total"".""player_id"") AS ""rank_table"" WHERE ""rank_table"".""rank1""=1"
200,"WITH ""PlayerScore"" AS (SELECT ""Unioned"".""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""Unioned"" GROUP BY ""Unioned"".""player_id""), ""GroupPlayerScore"" AS (SELECT ""PlayerScore"".*,""Players"".""group_id"" FROM ""PlayerScore"" LEFT JOIN ""Players"" ON ""PlayerScore"".""player_id""=""Players"".""player_id"") SELECT ""group_id"" AS ""GROUP_ID"",""player_id"" AS ""PLAYER_ID"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""ranked"" FROM ""GroupPlayerScore"") AS ""ranked"" WHERE ""ranked""=1"
201,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM (""Players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" WHERE ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
202,"SELECT ""a"".""group_id"" AS ""GROUP_ID"",""a"".""player_id"" AS ""PLAYER_ID"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""m"".""first_player""=""p"".""player_id"" THEN ""m"".""first_score"" WHEN ""m"".""second_player""=""p"".""player_id"" THEN ""m"".""second_score"" ELSE 0 END) AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1 ORDER BY 2,3 DESC,1) AS ""a"" GROUP BY ""a"".""group_id"""
203,"SELECT ""s"".""group_id"",""s"".""player_id"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" ELSE 0 END) DESC,""p"".""player_id"") AS ""rank_player"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""s"" WHERE ""s"".""rank_player""=1"
204,"WITH ""cte1"" AS (SELECT ""group_id"",""player_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" WHEN ""player_id""=""second_player"" THEN ""second_score"" END) AS ""score"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""p"".""player_id"" IN (""first_player"",""second_player"") GROUP BY ""group_id"",""player_id""), ""cte2"" AS (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rk"" FROM ""cte1"") SELECT ""group_id"",""player_id"" FROM ""cte2"" WHERE ""rk""=1"
205,"WITH ""T1"" AS (SELECT * FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""first_player""=""p"".""player_id""), ""T2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"",""group_id"" FROM ""T1"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"",""group_id"" FROM ""T1"") AS ""temp"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""T2"" WHERE ROW(""group_id"",""total_score"") IN (SELECT ""group_id"",MAX(""total_score"") AS ""max_score"" FROM ""T2"" GROUP BY ""group_id"") GROUP BY ""group_id"""
206,"WITH ""all_player"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""player_score"" FROM ""matches"" UNION SELECT ""match_id"",""second_player"",""second_score"" FROM ""matches""), ""player_total_score"" AS (SELECT ""player_id"",SUM(""player_score"") AS ""total_score"" FROM ""all_player"" GROUP BY 1) SELECT DISTINCT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""pts"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""pts"".""total_score"" DESC,""player_id"") AS ""player_rnk"" FROM ""player_total_score"" AS ""pts"" JOIN ""players"" ON ""players"".""player_id""=""pts"".""player_id"") AS ""tmp"" WHERE ""player_rnk""=1"
207,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(""score"") DESC,""p"".""player_id"") AS ""rnk"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" JOIN ""Players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""t2"" WHERE ""rnk""=1"
208,"SELECT ""group_id"",""player_id"" FROM (SELECT ""sc"".""group_id"" AS ""group_id"",""sc"".""player_id"" AS ""player_id"",RANK() OVER (PARTITION BY ""sc"".""group_id"" ORDER BY SUM(""sc"".""score"") DESC,""sc"".""player_id"") AS ""rnk"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",SUM(""m"".""first_score"") AS ""score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" GROUP BY ""p"".""group_id"",""p"".""player_id"" UNION ALL SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""group_id"",""p"".""player_id"") AS ""sc"" GROUP BY ""sc"".""group_id"",""sc"".""player_id"") AS ""A"" WHERE ""rnk""=1"
209,"WITH ""cte"" AS (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rankd"" FROM (SELECT ""p"".""player_id"",""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" ELSE 0 END) AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""a"") SELECT ""group_id"",""player_id"" FROM ""cte"" WHERE ""rankd""=1"
210,"WITH ""united"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""grouped"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""united"" JOIN ""players"" USING (""player_id"") GROUP BY 1,2 ORDER BY ""score"" DESC) SELECT ""group_id"",""player_id"" FROM ""grouped"" GROUP BY ""group_id"""
211,"WITH ""tb1"" AS (SELECT ""player"",SUM(""Score"") AS ""totalScore"" FROM (SELECT ""first_player"" AS ""player"",SUM(""first_score"") AS ""Score"" FROM ""Matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player"",SUM(""second_score"") AS ""Score"" FROM ""Matches"" GROUP BY ""second_player"") AS ""a"" GROUP BY ""player""), ""tb2"" AS (SELECT ""tb1"".""player"" AS ""player_id"",""group_id"",""tb1"".""totalScore"" FROM ""tb1"" JOIN ""Players"" ON ""tb1"".""player""=""Players"".""player_id"" GROUP BY ""player_id"" ORDER BY ""totalScore"" DESC,""player_id"") SELECT ""group_id"",""player_id"" FROM ""tb2"" GROUP BY ""group_id"""
212,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(""score"") AS ""total_score"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY SUM(""score"") DESC,""p"".""player_id"") AS ""ranks"" FROM ""Players"" AS ""p"" JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" ON ""p"".""player_id""=""t"".""player_id"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""m"" WHERE ""ranks""=1"
213,"WITH ""player_scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""f"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""s"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""ranked"" FROM ""player_scores"" AS ""s"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""s"".""player_id"") AS ""f"" WHERE ""ranked""=1"
214,"WITH ""temp"" AS (SELECT ""player_id"",""group_id"",COALESCE(""first_score"", 0) AS ""score"" FROM ""players"" JOIN ""Matches"" ON ""player_id""=""first_player"" UNION ALL SELECT ""player_id"",""group_id"",COALESCE(""second_score"", 0) AS ""score"" FROM ""players"" JOIN ""Matches"" ON ""player_id""=""second_player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""temp"" GROUP BY ""group_id"",""player_id"") AS ""temp"") AS ""temp2"" WHERE ""rn""=1"
215,"WITH ""playerscore"" AS (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""m"" GROUP BY ""player"") SELECT ""p"".""group_id"" AS ""group_id"",MIN(""p"".""player_id"") AS ""player_id"" FROM ""playerscore"" AS ""ps"" JOIN ""Players"" AS ""p"" ON ""ps"".""player""=""p"".""player_id"" WHERE ""ps"".""score""=(SELECT MAX(""psa"".""score"") AS ""max_score"" FROM ""playerscore"" AS ""psa"" JOIN ""Players"" AS ""pa"" ON ""psa"".""player""=""pa"".""player_id"" AND ""pa"".""group_id""=""p"".""group_id"") GROUP BY ""group_id"""
216,"WITH ""a"" AS (SELECT ""id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""id"",""second_score"" AS ""score"" FROM ""matches"") AS ""tmp"" GROUP BY 1), ""b"" AS (SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC) AS ""rank"" FROM (""players"") JOIN ""a"" WHERE ""player_id""=""id"" ORDER BY 1,2) AS ""tmp"" WHERE ""tmp"".""rank""=1) SELECT DISTINCT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""player_id"") AS ""final"" FROM ""b"") AS ""tmp"" WHERE ""tmp"".""final""=1"
217,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player"" AS ""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player"") AS ""rk"" FROM (SELECT ""player"",SUM(""score"") AS ""total"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches"") AS ""t1"" GROUP BY ""player"") AS ""t2"" LEFT JOIN ""players"" AS ""p"" ON ""t2"".""player""=""p"".""player_id"") AS ""t3"" WHERE ""rk""=1 ORDER BY ""group_id"""
218,"WITH ""MatchDetails"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""points"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""points"" FROM ""Matches""), ""MatchSummary"" AS (SELECT ""MP"".""player_id"",""P"".""group_id"",RANK() OVER (PARTITION BY ""P"".""group_id"" ORDER BY SUM(""MP"".""points"") DESC) AS ""GRk"" FROM ""MatchDetails"" AS ""MP"" JOIN ""Players"" AS ""P"" ON ""P"".""player_id""=""MP"".""player_id"" GROUP BY ""MP"".""player_id"",""P"".""group_id"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""MatchSummary"" WHERE ""GRk""=1 GROUP BY ""group_id"""
219,"SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""group_id"",""p"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC) AS ""player_rank"" FROM ""Players"" AS ""p"" JOIN (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""Matches_unified"" ON ""p"".""player_id""=""player"" GROUP BY ""group_id"",""p"".""player_id"") AS ""rank_data"" WHERE ""player_rank""=1 GROUP BY ""group_id"""
220,"WITH ""cte"" AS (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rankd"" FROM (SELECT ""p"".""player_id"",""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" ELSE 0 END) AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""a"") SELECT ""group_id"",""player_id"" FROM ""cte"" WHERE ""rankd""=1"
221,"WITH ""M1"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""M2"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""M1"" GROUP BY ""player_id""), ""PM1"" AS (SELECT ""P"".""player_id"",""P"".""group_id"",COALESCE(""M2"".""score"", 0) AS ""score"" FROM ""Players"" AS ""P"" LEFT JOIN ""M2"" ON ""P"".""player_id""=""M2"".""player_id""), ""PM2"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""PM1"") SELECT ""group_id"",""player_id"" FROM ""PM2"" WHERE ""rnk""=1"
222,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""first_player"" AS ""player_id"",""score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""first_player"") AS ""rn"" FROM (SELECT ""group_id"",""first_player"",SUM(""first_score"") AS ""score"" FROM (SELECT ""first_player"",""first_score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches"") AS ""x"" JOIN ""players"" AS ""p"" ON ""x"".""first_player""=""p"".""player_id"" GROUP BY 1,2 ORDER BY 1,2) AS ""xx"") AS ""xx"" WHERE ""rn""=1"
223,"WITH ""base"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""_"" GROUP BY ""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""p"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""p"".""group_id"" ORDER BY COALESCE(""score"", 0) DESC,""p"".""player_id"") AS ""ranking"" FROM ""players"" AS ""p"" LEFT JOIN ""base"" AS ""s"" ON ""p"".""player_id""=""s"".""player_id"") AS ""_"" WHERE ""ranking""=1"
224,"WITH ""player_scores"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""f"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""s"".""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""ranked"" FROM ""player_scores"" AS ""s"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""s"".""player_id"") AS ""f"" WHERE ""ranked""=1"
225,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""row_n"" FROM (SELECT ""p"".*,SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE ""m"".""second_score"" END) AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""player_id"",""p"".""group_id"") AS ""p"") AS ""p"" WHERE ""row_n""=1"
226,"WITH ""score"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rk"" FROM ""Players"" AS ""p"" JOIN ""score"" AS ""s"" USING (""player_id"") GROUP BY 1,2) AS ""a"" WHERE ""rk""=1"
227,"WITH ""cte_player_agg"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE ""m"".""second_score"" END) AS ""total_points"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2), ""cte_group_rank"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""player_rank"" FROM ""cte_player_agg""), ""cte_final"" AS (SELECT ""group_id"",MAX(CASE WHEN ""player_rank""=1 THEN ""player_id"" ELSE NULL END) AS ""player_id"" FROM ""cte_group_rank"" GROUP BY 1) SELECT * FROM ""cte_final"""
228,"WITH ""cte"" AS (SELECT ""player"",SUM(""score"") AS ""score"" FROM ((SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"")) AS ""tmp1"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""u"".""player_id"",""u"".""group_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""_rank"" FROM ""Players"" AS ""u"" LEFT JOIN ""cte"" ON ""u"".""player_id""=""cte"".""player"") AS ""tmp"" WHERE ""_rank""=1"
229,"WITH ""cte"" AS (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rankd"" FROM (SELECT ""p"".""player_id"",""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" ELSE 0 END) AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""a"") SELECT ""group_id"",""player_id"" FROM ""cte"" WHERE ""rankd""=1"
230,"SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(CASE WHEN ""p"".""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) DESC,""player_id"") AS ""rn"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""s"" WHERE ""rn""=1"
231,"WITH ""stack"" AS (SELECT ""p"".""group_id"",""m"".""first_player"" AS ""player_id"",""m"".""first_score"" AS ""score"" FROM ""matches"" AS ""m"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""m"".""first_player"" UNION ALL SELECT ""p"".""group_id"",""m"".""second_player"",""m"".""second_score"" FROM ""matches"" AS ""m"" JOIN ""players"" AS ""p"" ON ""p"".""player_id""=""m"".""first_player""), ""scoreagg"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""scoreagg"" FROM ""stack"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""scoreagg"" DESC,""player_id"") AS ""rn"" FROM ""scoreagg"") AS ""d"" WHERE ""rn""=1"
232,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""ps"".""player_id"",SUM(""ps"".""score"") AS ""score"" FROM (""Players"" AS ""p"") JOIN (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""ps"" WHERE ""p"".""player_id""=""ps"".""player_id"" GROUP BY ""ps"".""player_id"" ORDER BY ""group_id"",""score"" DESC,""player_id"") AS ""top_scores"" GROUP BY ""group_id"""
233,"WITH ""scores_grouped"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""scores"" AS (SELECT ""player"",SUM(""score"") AS ""score"" FROM ""scores_grouped"" GROUP BY ""player""), ""score_player"" AS (SELECT ""group_id"",""player_id"",""score"",MAX(""score"") OVER (PARTITION BY ""group_id"") AS ""group_max"" FROM ""players"" JOIN ""scores"" ON ""player_id""=""player"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",MIN(""player_id"") OVER (PARTITION BY ""group_id"") AS ""min_player"" FROM ""score_player"" WHERE ""score""=""group_max"") AS ""min_player"" WHERE ""player_id""=""min_player"""
234,"WITH ""temp"" AS (SELECT * FROM (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION SELECT ""match_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""t1"") SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""group_id"",""t"".""player_id"",SUM(""t"".""score"") AS ""total_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""t"".""score"") DESC,""t"".""player_id"") AS ""rk"" FROM ""temp"" AS ""t"" JOIN ""players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"" GROUP BY ""player_id"") AS ""t2"" WHERE ""rk""=1"
235,"WITH ""t1"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""t2"" AS (SELECT ""p"".""player_id"",SUM(COALESCE(""score"", 0)) OVER (PARTITION BY ""player_id"") AS ""score"",""p"".""group_id"" FROM ""t1"" RIGHT JOIN ""players"" AS ""p"" ON ""t1"".""player""=""p"".""player_id""), ""t3"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""r"" FROM ""t2"") SELECT DISTINCT ""group_id"",""player_id"" FROM ""t3"" WHERE ""r""=1"
236,"WITH ""player_scores_0"" AS (SELECT ""a"".""group_id"",""a"".""player_id"",COALESCE(""b"".""first_score"", 0) AS ""total_score_0"" FROM ""Players"" AS ""a"" LEFT JOIN ""Matches"" AS ""b"" ON ""a"".""player_id""=""b"".""first_player"" UNION ALL SELECT ""c"".""group_id"",""c"".""player_id"",COALESCE(""d"".""second_score"", 0) AS ""total_score_0"" FROM ""Players"" AS ""c"" LEFT JOIN ""Matches"" AS ""d"" ON ""c"".""player_id""=""d"".""second_player""), ""player_scores"" AS (SELECT ""group_id"",""player_id"",SUM(""total_score_0"") AS ""total_score"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""total_score_0"") DESC,""player_id"") AS ""group_rank"" FROM ""player_scores_0"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM ""player_scores"" WHERE ""group_rank""=1"
237,"WITH ""cte"" AS (SELECT ""group_id"",""player_id"",SUM(""total_score"") AS ""total_score"" FROM ((SELECT ""A"".""group_id"",""A"".""player_id"",SUM(""first_score"") AS ""total_score"" FROM ""Players"" AS ""A"" LEFT JOIN ""Matches"" AS ""B"" ON ""A"".""player_id""=""B"".""first_player"" GROUP BY 1,2 UNION ALL SELECT ""A"".""group_id"",""A"".""player_id"",SUM(""second_score"") AS ""total_score"" FROM ""Players"" AS ""A"" LEFT JOIN ""Matches"" AS ""B"" ON ""A"".""player_id""=""B"".""second_player"" GROUP BY 1,2)) AS ""X"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rw_num"" FROM ""cte"") AS ""Y"" WHERE ""rw_num""=1"
238,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""P"".""group_id"",""P"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rnk"" FROM ""cte"" AS ""C"" JOIN ""players"" AS ""P"" ON ""C"".""player_id""=""P"".""player_id"" GROUP BY ""P"".""group_id"",""P"".""player_id"") AS ""t1"" WHERE ""rnk""=1"
239,"WITH ""t"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches""), ""t1"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""t"" ON ""p"".""player_id""=""t"".""player"" GROUP BY 1,2) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rnk"" FROM ""t1"") AS ""tmp"" WHERE ""rnk""=1"
240,"WITH ""total"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""matches""), ""t1"" AS (SELECT ""player"",SUM(""score"") AS ""total_score"" FROM ""total"" GROUP BY ""player"") SELECT ""group_id"",MIN(""a"".""player_id"") AS ""player_id"" FROM ""t1"" JOIN ""players"" AS ""a"" ON ""player""=""a"".""player_id"" WHERE ""total_score""=(SELECT MAX(""total_score"") AS ""mx"" FROM ""t1"" JOIN ""players"" AS ""b"" ON ""player""=""b"".""player_id"" WHERE ""b"".""group_id""=""a"".""group_id"" GROUP BY ""b"".""group_id"") GROUP BY ""group_id"""
241,"WITH ""t"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ((SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"") UNION (SELECT ""match_id"",""second_player"",""second_score"" FROM ""Matches"")) AS ""a"" USING (""player_id"") GROUP BY ""group_id"",""player_id""), ""r"" AS (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rn"" FROM ""t"") SELECT ""group_id"",""player_id"" FROM ""r"" WHERE ""rn""=1"
242,"WITH ""cte"" AS (SELECT ""group_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""first_player""=""b"".""player_id"" UNION ALL SELECT ""group_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"" AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""first_player""=""b"".""player_id""), ""cte2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""score"" FROM ""cte"" GROUP BY 1,2) SELECT DISTINCT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",""score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""cte2"") AS ""x"" WHERE ""rnk""=1 ORDER BY 1"
243,"WITH ""a"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",SUM(""first_score"") AS ""player_score"" FROM ""matches"" GROUP BY 2 UNION ALL SELECT ""match_id"",""second_player"" AS ""player_id"",SUM(""second_score"") AS ""player_score"" FROM ""matches"" GROUP BY 2 ORDER BY ""match_id""), ""b"" AS (SELECT ""player_id"",SUM(""player_score"") AS ""player_score"" FROM ""a"" GROUP BY 1 ORDER BY 1), ""c"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",""b"".""player_score"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""b"".""player_score"" DESC,""p"".""player_id"") AS ""rn"" FROM ""players"" AS ""p"" LEFT JOIN ""b"" ON ""p"".""player_id""=""b"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""c"" WHERE ""rn""=1"
244,"WITH ""cte"" AS (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rankd"" FROM (SELECT ""p"".""player_id"",""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""p"".""player_id""=""m"".""second_player"" THEN ""second_score"" ELSE 0 END) AS ""total_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2) AS ""a"") SELECT ""group_id"",""player_id"" FROM ""cte"" WHERE ""rankd""=1"
245,"WITH ""t"" AS (SELECT ""x"".""player"" AS ""player"",SUM(""x"".""score"") AS ""total_score"" FROM (SELECT ""match_id"",""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""x"" GROUP BY 1) SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""p"".""group_id"" AS ""group_id"",""t"".""player"" AS ""player_id"",""t"".""total_score"" AS ""total_score"" FROM ""Players"" AS ""p"" LEFT JOIN ""t"" ON ""t"".""player""=""p"".""player_id"") AS ""final"") AS ""y"" WHERE ""rn""=1"
246,"SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""player_score"" DESC) AS ""rank_score"" FROM ""Players"" AS ""p"" LEFT JOIN (SELECT ""player"",SUM(""score"") AS ""player_score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""s2"" ON ""p"".""player_id""=""s2"".""player"") AS ""t"" WHERE ""rank_score""=1 GROUP BY ""group_id"""
247,"WITH ""cte_score"" AS (SELECT ""player_id"",SUM(""score"") AS ""tot_score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t"" GROUP BY 1), ""cte_rank"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""s"".""tot_score"" DESC,""player_id"") AS ""rnk_player"" FROM ""Players"" AS ""p"" JOIN ""cte_score"" AS ""s"" USING (""player_id"")) SELECT ""group_id"",""player_id"" FROM ""cte_rank"" WHERE ""rnk_player""=1"
248,"WITH ""cte"" (""match_id"", ""player_id"", ""score"") AS (SELECT ""match_id"",""first_player"",""first_score"" FROM ""Matches"" UNION SELECT ""match_id"",""second_player"",""second_score"" FROM ""Matches""), ""cte1"" AS (SELECT ""player_id"",SUM(""score"") AS ""total_score"" FROM ""cte"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""cte1"".""player_id"",""cte1"".""total_score"",""Players"".""group_id"" FROM ""cte1"" LEFT JOIN ""Players"" ON ""cte1"".""player_id""=""Players"".""player_id""), ""cte3"" AS (SELECT *,MAX(""total_score"") OVER (PARTITION BY ""group_id"") AS ""max_score"" FROM ""cte2""), ""cte4"" AS (SELECT *,MIN(""player_id"") OVER (PARTITION BY ""group_id"") AS ""min_id"" FROM ""cte3"" WHERE ""total_score""=""max_score"") SELECT ""group_id"",""player_id"" FROM ""cte4"" WHERE ""player_id""=""min_id"" ORDER BY ""group_id"""
249,"SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rn"" FROM (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total"" FROM (SELECT ""group_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM (SELECT ""M"".*,""P"".""group_id"" FROM ""Matches"" AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""first_player""=""P"".""player_id"") AS ""T1"" UNION ALL SELECT ""group_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM (SELECT ""M"".*,""P"".""group_id"" FROM ""Matches"" AS ""M"" JOIN ""Players"" AS ""P"" ON ""M"".""first_player""=""P"".""player_id"") AS ""T2"") AS ""T3"" GROUP BY ""group_id"",""player_id"") AS ""T4"") AS ""T5"" WHERE ""rn""=1"
250,"WITH ""a"" AS (SELECT ""first_player"",""first_score"" FROM ""matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""matches""), ""b"" AS (SELECT ""first_player"",SUM(""first_score"") AS ""score"" FROM ""a"" GROUP BY 1), ""c"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",COALESCE(""b"".""score"", 0) AS ""score"" FROM ""players"" AS ""p"" LEFT JOIN ""b"" ON ""p"".""player_id""=""b"".""first_player"" ORDER BY 1,3 DESC) SELECT ""group_id"",""player_id"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""c"") AS ""d"" WHERE ""rnk""=1"
251,"WITH ""cte"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""Matches"" GROUP BY 1) AS ""cte1"" GROUP BY 1) SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""a"".""group_id"",""a"".""player_id"",RANK() OVER (PARTITION BY ""a"".""group_id"" ORDER BY ""b"".""score"" DESC) AS ""rnk"" FROM ""Players"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" ORDER BY 1,2) AS ""cte2"" WHERE ""rnk""=1 GROUP BY 1"
252,"SELECT ""r"".""group_id"",""r"".""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""t"".""score"" DESC,""p"".""player_id"") AS ""player_rank"" FROM ""Players"" AS ""p"" JOIN (SELECT ""player_id"",SUM(""s"".""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") AS ""s"" GROUP BY ""player_id"") AS ""t"" ON ""p"".""player_id""=""t"".""player_id"") AS ""r"" WHERE ""r"".""player_rank""=1"
253,"WITH ""main"" AS (SELECT ""b"".*,""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches"") AS ""a"" JOIN ""players"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id""), ""sum_ranked"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rank_val"" FROM ""main"" GROUP BY ""group_id"",""player_id"") SELECT ""group_id"",""player_id"" FROM ""sum_ranked"" WHERE ""rank_val""=1"
254,"WITH ""cte"" AS (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) AS ""tot_score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""player_id"",""group_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""tot_score"" DESC,""player_id"") AS ""rnk"" FROM ""cte"") AS ""tmp"" WHERE ""rnk""=1"
255,"SELECT ""group_id"",""player_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""points"" DESC,""player_id"") AS ""ranked"" FROM (SELECT ""player_id"",""group_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" ELSE ""second_score"" END) AS ""points"" FROM (""Matches"" AS ""m"") JOIN ""Players"" AS ""p"" WHERE ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1) AS ""t1"") AS ""t2"" WHERE ""ranked""=1"
256,"SELECT ""group_id"",""player_id"" FROM (SELECT ""p"".""player_id"",""p"".""group_id"",COALESCE(""t2"".""score"", 0) AS ""score"",RANK() OVER (PARTITION BY ""p"".""group_id"" ORDER BY ""t2"".""score"" DESC,""p"".""player_id"") AS ""rnk"" FROM ""Players"" AS ""p"" LEFT JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches"") AS ""t1"" GROUP BY ""player"") AS ""t2"" ON ""p"".""player_id""=""t2"".""player"") AS ""t3"" WHERE ""rnk""=1"
257,"SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""group_id"",""sub2"".""player_id"" AS ""player_id"" FROM (SELECT ""group_id"",""sub"".""player_id"" AS ""player_id"",SUM(""score"") AS ""ttl"",MAX(SUM(""score"")) OVER (PARTITION BY ""group_id"") AS ""max_ttl"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""sub"" JOIN ""Players"" AS ""p"" ON ""sub"".""player_id""=""p"".""player_id"" GROUP BY 1,2) AS ""sub2"" WHERE ""ttl""=""max_ttl"") AS ""sub3"" GROUP BY 1"
258,"WITH ""tmp"" AS (SELECT * FROM ""matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""first_player"",""first_player"" AS ""second_player"",""second_score"" AS ""first_score"",""first_score"" AS ""second_score"" FROM ""matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""first_score"") DESC,""player_id"") AS ""rnk"" FROM ""players"" AS ""a"" JOIN ""tmp"" AS ""b"" ON ""a"".""player_id""=""b"".""first_player"" GROUP BY 1,2) AS ""t"" WHERE ""rnk""=1 ORDER BY 1,2"
259,"WITH ""CTE"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player_id"") SELECT ""group_id"",MIN(""p"".""player_id"") AS ""player_id"" FROM ""Players"" AS ""p"" JOIN ""CTE"" ON ""p"".""player_id""=""CTE"".""player_id"" WHERE ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM ""Players"" AS ""p"" JOIN ""CTE"" ON ""p"".""player_id""=""CTE"".""player_id"" GROUP BY ""group_id"") GROUP BY ""group_id"""
260,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
261,"WITH ""tbAll"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""tbSumScore"" AS (SELECT ""tbAll"".""player_id"",""p"".""group_id"",SUM(""tbAll"".""score"") AS ""sumScore"" FROM ""tbAll"" JOIN ""players"" AS ""p"" ON ""tbAll"".""player_id""=""p"".""player_id"" GROUP BY ""tbAll"".""player_id"",""p"".""group_id""), ""tbMaxScore"" AS (SELECT ""group_id"",MAX(""sumScore"") AS ""maxScore"" FROM ""tbSumScore"" GROUP BY ""group_id"") SELECT ""tbSumScore"".""group_id"",MIN(""tbSumScore"".""player_id"") AS ""player_id"" FROM ""tbMaxScore"" JOIN ""tbSumScore"" ON ""tbSumScore"".""group_id""=""tbMaxScore"".""group_id"" WHERE ""tbSumScore"".""sumScore""=""tbMaxScore"".""maxScore"" GROUP BY ""tbSumScore"".""group_id"""
262,"SELECT ""z"".""group_id"",""z"".""player_id"" FROM (SELECT ""y"".""group_id"",""x"".""player_id"",ROW_NUMBER() OVER (PARTITION BY ""y"".""group_id"" ORDER BY SUM(""x"".""score"") DESC,""x"".""player_id"") AS ""row_cnt"" FROM (SELECT ""first_player"" AS ""player_id"",SUM(""first_score"") AS ""score"" FROM ""matches"" GROUP BY ""first_player"" UNION ALL SELECT ""second_player"" AS ""player_id"",SUM(""second_score"") AS ""score"" FROM ""matches"" GROUP BY ""second_player"") AS ""x"" JOIN ""players"" AS ""y"" ON ""x"".""player_id""=""y"".""player_id"" GROUP BY ""x"".""player_id"",""y"".""group_id"") AS ""z"" WHERE ""z"".""row_cnt""=1"
263,"WITH ""CTE"" AS (SELECT ""group_id"",""player_id"",""first_score"" AS ""score"" FROM ""Players"" AS ""P"" JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""first_player"" UNION ALL SELECT ""group_id"",""player_id"",""second_score"" AS ""score"" FROM ""players"" AS ""P"" JOIN ""Matches"" AS ""M"" ON ""P"".""player_id""=""M"".""second_player"") SELECT ""group_id"",""Player_id"" FROM (SELECT ""group_id"",""player_id"",SUM(""score""),RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rnk"" FROM ""CTE"" GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"",SUM(""score"") DESC) AS ""T1"" WHERE ""T1"".""rnk""=1"
264,"WITH ""CTE"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""CTE_1"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""CTE"" GROUP BY ""player_id"") SELECT DISTINCT ""group_id"",FIRST_VALUE(""c"".""player_id"") OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""c"".""player_id"") AS ""player_id"" FROM ""cte_1"" AS ""c"" LEFT JOIN ""players"" AS ""p"" ON ""c"".""player_id""=""p"".""player_id"""
265,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
266,"WITH ""d1"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""d2"" AS (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""d1"" GROUP BY ""player_id""), ""d3"" AS (SELECT ""Players"".""player_id"",""Players"".""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY COALESCE(""d2"".""score"", 0) DESC,""Players"".""player_id"") AS ""row_num"" FROM ""Players"" LEFT JOIN ""d2"" ON ""Players"".""player_id""=""d2"".""player_id"") SELECT ""group_id"",""player_id"" FROM ""d3"" WHERE ""row_num""=1 ORDER BY ""group_id"""
267,"WITH ""table1"" AS (SELECT ""group_id"" AS ""GROUP_ID"",""player_id"" AS ""PLAYER_ID"",""points"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""points"" DESC,""player_id"") AS ""row_num"" FROM (SELECT ""a"".""group_id"" AS ""group_id"",""a"".""player_id"" AS ""player_id"",SUM(CASE WHEN ""b"".""first_player""=""a"".""player_id"" THEN ""b"".""first_score"" WHEN ""b"".""second_player""=""a"".""player_id"" THEN ""b"".""second_score"" END) AS ""points"" FROM ""Matches"" AS ""b"" JOIN ""Players"" AS ""a"" GROUP BY ""a"".""player_id"",""a"".""group_id"") AS ""table2"") SELECT ""GROUP_ID"",""PLAYER_ID"" FROM ""table1"" WHERE ""row_num""=1"
268,"WITH ""cte"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""cte2"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",""c"".""score"" FROM ""Players"" AS ""p"" LEFT JOIN (SELECT ""player_id"",SUM(""score"") AS ""score"" FROM ""cte"" GROUP BY ""player_id"") AS ""c"" ON ""p"".""player_id""=""c"".""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM ""cte2"") AS ""t"" WHERE ""rnk""=1"
269,"WITH ""cte_player_agg"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""m"".""first_score"" ELSE ""m"".""second_score"" END) AS ""total_points"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY 1,2), ""cte_group_rank"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total_points"" DESC,""player_id"") AS ""player_rank"" FROM ""cte_player_agg""), ""cte_final"" AS (SELECT ""group_id"",""player_id"" FROM ""cte_group_rank"" WHERE ""player_rank""=1) SELECT * FROM ""cte_final"""
270,"WITH ""t"" AS (SELECT ""group_id"",""player_id"",SUM(CASE WHEN ""m"".""first_player""=""p"".""player_id"" THEN ""m"".""first_score"" ELSE 0 END)+SUM(CASE WHEN ""m"".""second_player""=""p"".""player_id"" THEN ""m"".""second_score"" ELSE 0 END) AS ""scores"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""player_id"" ORDER BY ""group_id"",""scores"" DESC,""player_id""), ""t2"" AS (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"") AS ""rn"" FROM ""t"") SELECT ""group_id"",""player_id"" FROM ""t2"" WHERE ""rn""=1 GROUP BY ""group_id"" ORDER BY ""group_id"""
271,"WITH ""tr1_flatten"" AS (SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",""m1"".""first_score"" AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m1"" ON ""p"".""player_id""=""m1"".""first_player"" UNION ALL SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",""m2"".""second_score"" AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m2"" ON ""p"".""player_id""=""m2"".""second_player""), ""tr2_agg"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""tr1_flatten"" GROUP BY ""player_id""), ""tr3_rank"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""rank_no"" FROM ""tr2_agg"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""tr3_rank"" WHERE ""rank_no""=1 GROUP BY ""group_id"""
272,"WITH ""t"" AS (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player"",""second_score"" AS ""score"" FROM ""Matches""), ""t2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total"" FROM ""Players"" JOIN ""t"" ON ""Players"".""player_id""=""t"".""player"" GROUP BY ""group_id"",""player_id""), ""t3"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM ""t2"") SELECT ""group_id"",""player_id"" FROM ""t3"" WHERE ""rk""=1 ORDER BY ""group_id"""
273,"WITH ""playerpoints"" AS (SELECT ""p"".""player_id"",""p"".""group_id"",SUM(CASE WHEN ""p"".""player_id""=""m"".""first_player"" THEN ""first_score"" ELSE ""second_score"" END) AS ""points"" FROM ""players"" AS ""p"" LEFT JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""p"".""player_id"",""p"".""group_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""points"" DESC,""player_id"") AS ""playerrank"" FROM ""playerpoints"") AS ""a"" WHERE ""playerrank""=1"
274,"WITH ""tem"" AS (SELECT ""a"".""player_id"",(SUM(CASE WHEN ""a"".""player_id""=""b"".""first_player"" THEN ""first_score"" ELSE 0 END)+SUM(CASE WHEN ""a"".""player_id""=""b"".""second_player"" THEN ""second_score"" ELSE 0 END)) AS ""total_score"",""a"".""group_id"" FROM ""players"" AS ""a"" LEFT JOIN ""matches"" AS ""b"" ON ""a"".""player_id""=""b"".""first_player"" OR ""a"".""player_id""=""b"".""second_player"" GROUP BY ""player_id"" ORDER BY ""total_score"" DESC,""player_id"") SELECT ""group_id"",""player_id"" FROM (SELECT ""player_id"",""group_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC,""player_id"") AS ""rank_n"" FROM ""tem"") AS ""a"" WHERE ""rank_n""=1"
275,"WITH ""score"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""matches""), ""tmp"" AS (SELECT ""p"".""group_id"",""p"".""player_id"",COALESCE(SUM(""score""), 0) AS ""total"" FROM ""players"" AS ""p"" LEFT JOIN ""score"" ON ""p"".""player_id""=""score"".""player_id"" GROUP BY ""p"".""group_id"",""p"".""player_id""), ""tmp2"" AS (SELECT ""group_id"",""player_id"",""total"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC) AS ""rnk"" FROM ""tmp"") SELECT ""group_id"",""player_id"" FROM ""tmp2"" WHERE ""rnk""=1"
276,"SELECT ""group_id"",(""player_id"") FROM (SELECT ""group_id"",""player_id"",SUM(CASE WHEN ""mtch"".""first_player""=""p"".""player_id"" THEN ""first_score"" ELSE ""second_score"" END) AS ""mtchscore"" FROM ""Players"" AS ""p"" LEFT JOIN ""Matches"" AS ""mtch"" ON ""p"".""player_id"" IN (""mtch"".""first_player"",""mtch"".""second_player"") GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"",""mtchscore"" DESC,""player_id"") AS ""TopScore"" GROUP BY ""group_id"""
277,"WITH ""base"" AS (SELECT ""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches""), ""base2"" AS (SELECT ""player_id"",SUM(""score"") AS ""total"" FROM ""base"" GROUP BY ""player_id""), ""base3"" AS (SELECT ""base2"".""player_id"",""p"".""group_id"",""base2"".""total"" FROM ""base2"" JOIN ""Players"" AS ""p"" ON ""base2"".""player_id""=""p"".""player_id""), ""base4"" AS (SELECT ""player_id"",""group_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""total"" DESC,""player_id"") AS ""rk"" FROM ""base3"") SELECT ""group_id"",""player_id"" FROM ""base4"" WHERE ""rk""=1"
278,"WITH ""temp"" AS (SELECT ""group_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""first_player""=""p"".""player_id"" UNION ALL SELECT ""group_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"" AS ""m"" JOIN ""Players"" AS ""p"" ON ""m"".""second_player""=""p"".""player_id""), ""temp2"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""max_score"" FROM ""temp"" GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"",""max_score"" DESC,""player_id""), ""temp3"" AS (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""max_score"" DESC) AS ""r"" FROM ""temp2"") SELECT ""group_id"",""player_id"" FROM ""temp3"" WHERE ""r""=1"
279,"WITH ""t"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""group_id"" ORDER BY ""score"" DESC,""player_id"") AS ""rnk"" FROM (SELECT ""p"".""group_id"",""t"".""player_id"",SUM(""t"".""score"") OVER (PARTITION BY ""player_id"") AS ""score"" FROM ""t"" LEFT JOIN ""Players"" AS ""p"" ON ""t"".""player_id""=""p"".""player_id"") AS ""t1"") AS ""t2"" WHERE ""rnk""=1 ORDER BY ""group_id"""
280,"WITH ""combine"" AS (SELECT ""match_id"",""first_player"" AS ""player_id"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""match_id"",""second_player"" AS ""player_id"",""second_score"" AS ""score"" FROM ""Matches"") SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""c"".""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY SUM(""score"") DESC,""player_id"") AS ""rnk"" FROM ""combine"" AS ""c"" JOIN ""Players"" AS ""p"" ON ""p"".""player_id""=""c"".""player_id"" GROUP BY ""c"".""player_id"") AS ""a"" WHERE ""rnk""=1"
281,"SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM (SELECT ""group_id"",""player_id"" FROM (SELECT ""group_id"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""max_score"" DESC) AS ""score_rnk"" FROM (SELECT ""group_id"",""player_id"",SUM(CASE WHEN ""player_id""=""first_player"" THEN ""first_score"" WHEN ""player_id""=""second_player"" THEN ""second_score"" END) AS ""max_score"" FROM ""players"" AS ""p"" JOIN ""matches"" AS ""m"" ON ""p"".""player_id""=""m"".""first_player"" OR ""p"".""player_id""=""m"".""second_player"" GROUP BY ""group_id"",""player_id"" ORDER BY ""group_id"") AS ""a"") AS ""b"" WHERE ""score_rnk""=1) AS ""c"" GROUP BY ""group_id"""
282,"WITH ""tr1_flatten"" AS (SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",""m1"".""first_score"" AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m1"" ON ""p"".""player_id""=""m1"".""first_player"" UNION ALL SELECT ""p"".""group_id"" AS ""group_id"",""p"".""player_id"" AS ""player_id"",""m2"".""second_score"" AS ""score"" FROM ""Players"" AS ""p"" JOIN ""Matches"" AS ""m2"" ON ""p"".""player_id""=""m2"".""second_player""), ""tr2_agg"" AS (SELECT ""group_id"",""player_id"",SUM(""score"") AS ""total_score"" FROM ""tr1_flatten"" GROUP BY ""player_id""), ""tr3_rank"" AS (SELECT ""group_id"",""player_id"",RANK() OVER (PARTITION BY ""group_id"" ORDER BY ""total_score"" DESC) AS ""rank_no"" FROM ""tr2_agg"") SELECT ""group_id"",MIN(""player_id"") AS ""player_id"" FROM ""tr3_rank"" WHERE ""rank_no""=1 GROUP BY ""group_id"""
283,"SELECT ""group_id"" AS ""GROUP_ID"",MIN(""player_id"") AS ""PLAYER_ID"" FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" AND ROW(""group_id"",""score"") IN (SELECT ""group_id"",MAX(""score"") FROM (""Players"") JOIN (SELECT ""player"",SUM(""score"") AS ""score"" FROM (SELECT ""first_player"" AS ""player"",""first_score"" AS ""score"" FROM ""Matches"" UNION ALL SELECT ""second_player"",""second_score"" FROM ""Matches"") AS ""s"" GROUP BY ""player"") AS ""PlayerScores"" WHERE ""Players"".""player_id""=""PlayerScores"".""player"" GROUP BY ""group_id"") GROUP BY ""group_id"""
