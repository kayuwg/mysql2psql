id,original query
1,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
2,"SELECT ""t"".""period_state"",MIN(""t"".""all_date"") AS ""start_date"",MAX(""t"".""all_date"") AS ""end_date"" FROM (SELECT ""temp"".""period_state"",""temp"".""all_date"",""temp"".""all_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""temp"".""period_state"" ORDER BY ""temp"".""all_date"") DAY' AS ""R"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""all_date"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""all_date"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""temp"") AS ""t"" GROUP BY ""t"".""period_state"",""t"".""R"" ORDER BY ""start_date"""
3,"SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""period_state"",""date1"",ROW_NUMBER() OVER (ORDER BY ""date1"") AS ""rnk"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""rank_state"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""x"") AS ""y"" GROUP BY ""period_state"",""rnk""-""rank_state"" ORDER BY ""date1"""
4,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
5,"WITH ""all_rows"" AS (SELECT ""success_date"" AS ""period_d"",'succeeded' AS ""state"" FROM ""succeeded"" UNION ALL SELECT ""fail_date"" AS ""period_d"",'failed' AS ""state"" FROM ""failed""), ""ranks"" AS (SELECT ""state"" AS ""period_state"",""period_d"",DENSE_RANK() OVER (PARTITION BY ""state"" ORDER BY ""period_d"") AS ""partition_rank"",DENSE_RANK() OVER (ORDER BY ""period_d"") AS ""overall_rank"" FROM ""all_rows"" WHERE ""period_d"">='2019-01-01' AND ""period_d""<='2019-12-31') SELECT ""period_state"",MIN(""period_d"") AS ""start_date"",MAX(""period_d"") AS ""end_date"" FROM ""ranks"" GROUP BY ""period_state"",""overall_rank""-""partition_rank"""
6,"SELECT ""b"".""period_state"",""b"".""start_date"",""b"".""end_date"" FROM (SELECT 'failed' AS ""period_state"",MIN(""a"".""fail_date"") AS ""start_date"",MAX(""a"".""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",(""fail_date"" - CAST('2019-01-01' AS DATE)+1-RANK() OVER (ORDER BY ""fail_date"")) AS ""diff"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""a"" GROUP BY ""a"".""diff"" UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""a"".""success_date"") AS ""start_date"",MAX(""a"".""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",(""success_date"" - CAST('2019-01-01' AS DATE)+1-RANK() OVER (ORDER BY ""success_date"")) AS ""diff"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""a"" GROUP BY ""a"".""diff"") AS ""b"" ORDER BY ""b"".""start_date"""
7,"WITH ""cte1"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""period_state"",""date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""rnk1"",RANK() OVER (ORDER BY ""date"") AS ""rnk2"" FROM ""cte1"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY (""rnk2""-""rnk1""),1"
8,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
9,"SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",DAYOFYEAR(""fail_date"") AS ""days"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""t1"" GROUP BY ""days""-""rn"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",DAYOFYEAR(""success_date"") AS ""days"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""t2"" GROUP BY ""days""-""rn"" ORDER BY ""start_date"""
10,"WITH ""main"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
11,"WITH ""a"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""flag"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""dt"",'succeeded' AS ""flag"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""b"" AS (SELECT ""dt"",""flag"",""dt"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""flag"" ORDER BY ""dt"") DAY' AS ""dtgrp"" FROM ""a"") SELECT ""flag"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""b"" GROUP BY ""dtgrp"",""flag"" ORDER BY 2"
12,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""temp"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY ""start_date"""
13,"WITH ""cte"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"",ROW_NUMBER() OVER () AS ""row_id"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"",ROW_NUMBER() OVER () AS ""row_id"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""cte"" GROUP BY 1,""dt"" + INTERVAL '-""row_id"" DAY' ORDER BY 2"
14,"WITH ""cte"" AS (SELECT DISTINCT ""fail_date"" AS ""date"",'failed' AS ""st"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT DISTINCT ""success_date"" AS ""date"",'succeeded' AS ""st"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""periods"" AS (SELECT ""date"",CASE WHEN ""st""=""previous"" THEN @""project"" ELSE @""project"":=@""project""+1 END AS ""prj"",""previous"",""st"" FROM (SELECT *,LAG(""st"", 1, 1) OVER (ORDER BY ""date"") AS ""previous"" FROM ""cte"") AS ""pre"" CROSS JOIN (SELECT @""project"":=1) AS ""t"" ORDER BY ""date"") SELECT ""st"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""periods"" GROUP BY ""period_state"",""prj"""
15,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT ""period_state"",""overall_rank_num""-""rank_num"" AS ""rank_group"",MIN(""start_date"") AS ""start_date"",MAX(""start_date"") AS ""end_date"" FROM (SELECT ""period_state"",""start_date"",""rank_num"",ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""overall_rank_num"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rank_num"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rank_num"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""tt"" GROUP BY ""period_state"",""overall_rank_num""-""rank_num"") AS ""ttt"" ORDER BY ""start_date"""
16,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""period_state"",""date"",""rid""-ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""num"" FROM (SELECT ""period_state"",""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rid"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"" UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"") AS ""A"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""B"") AS ""C"" GROUP BY ""period_state"",""num"" ORDER BY MIN(""date"")"
17,"WITH ""tasks_state"" AS (SELECT ""task_date"",""state"",DENSE_RANK() OVER (PARTITION BY ""state"" ORDER BY ""task_date"") AS ""rank_in_state"" FROM (SELECT ""fail_date"" AS ""task_date"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31') UNION ALL SELECT ""success_date"" AS ""task_data"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31')) AS ""U"") SELECT ""t"".""state"" AS ""period_state"",MIN(""t"".""task_date"") AS ""start_date"",MAX(""t"".""task_date"") AS ""end_date"" FROM (SELECT ""task_date"",""state"",""task_date"" + INTERVAL '-""rank_in_state"" DAY' AS ""grouping_set"" FROM ""tasks_state"") AS ""t"" GROUP BY ""state"",""grouping_set"" ORDER BY ""start_date"""
18,"WITH ""CTE"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""C"" AS (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""rank_all"",""state"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM ""CTE"") SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""C"" GROUP BY ""inv"",""state"" ORDER BY ""start_date"""
19,"WITH ""temp"" AS (SELECT ""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp1"" AS (SELECT ""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""temp"" GROUP BY EXTRACT(EPOCH FROM ""fail_date"")-""ranking"" UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""temp1"" GROUP BY EXTRACT(EPOCH FROM ""success_date"")-""ranking"" ORDER BY ""start_date"""
20,"SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",DAYOFYEAR(""fail_date"") AS ""days"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""f"" GROUP BY ""days""-""rnk"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",DAYOFYEAR(""success_date"") AS ""days"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s"" GROUP BY ""days""-""rnk"" ORDER BY ""start_date"""
21,"WITH ""alll"" AS (SELECT ""success_date"" AS ""date"",'succeeded' AS ""mode"",""success_date"" - (LAG(""success_date"", 1) OVER (ORDER BY ""success_date"")) AS ""daydiff"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION SELECT ""fail_date"" AS ""date"",'failed' AS ""mode"",""fail_date"" - (LAG(""fail_date"", 1) OVER (ORDER BY ""fail_date"")) AS ""daydiff"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""mode"" AS ""period_state"",""date"" AS ""start_date"",COALESCE(LEAD(""date"", 1) OVER (ORDER BY ""date"") - INTERVAL '1 DAY', (SELECT MAX(""date"") FROM ""alll"")) AS ""end_date"" FROM ""alll"" WHERE COALESCE(""daydiff"", 0)!=1 ORDER BY ""date"""
22,"SELECT ""period_state"",MIN(""sdate"") AS ""start_date"",MAX(""sdate"") AS ""end_date"" FROM (SELECT ""period_state"",""sdate"",RANK() OVER (ORDER BY ""sdate"")-""rnk"" AS ""inv"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""sdate"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""period_state"",""fail_date"" AS ""sdate"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""t"" GROUP BY ""inv"",""period_state"""
23,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"")-ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""row_diff"" FROM ""cte"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"" GROUP BY ""state"",""row_diff"" ORDER BY ""start_date"""
24,"WITH ""temp"" AS (SELECT MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"",'failed' AS ""period_state"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rowNum"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"" GROUP BY ""fail_date"" - INTERVAL '""rowNum"" DAY' UNION ALL SELECT MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"",'succeeded' AS ""period_state"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rowNum"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t2"" GROUP BY ""success_date"" - INTERVAL '""rowNum"" DAY') SELECT ""period_state"",""start_date"",""end_date"" FROM ""temp"" ORDER BY ""start_date"""
25,"WITH ""cte1"" AS (SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")), ""cte2"" AS (SELECT ""period_state"" FROM ""cte1"" LIMIT 1) SELECT * FROM ""cte1"""
26,"SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" - CAST('2019-01-01' AS DATE) AS ""diff_day"",ROW_NUMBER() OVER ()-1 AS ""RANKING"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""sub"" GROUP BY ""diff_day""-""ranking"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" - CAST('2019-01-01' AS DATE) AS ""diff_day"",ROW_NUMBER() OVER ()-1 AS ""RANKING"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""sub"" GROUP BY ""diff_day""-""ranking"" ORDER BY ""start_date"""
27,"WITH ""main"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
28,"WITH ""CTE"" AS ((SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') UNION (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31')) SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM ""CTE"") AS ""a"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
29,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
30,"WITH ""fails"" AS (SELECT ""fail_date"",""fail_date"" - INTERVAL 'RANK() OVER (ORDER BY ""fail_date"") DAY' AS ""fail_group"" FROM ""Failed"" WHERE LEFT(""fail_date"", 4)='2019'), ""fail_agg"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""fails"" GROUP BY ""fail_group""), ""successes"" AS (SELECT ""success_date"",""success_date"" - INTERVAL 'RANK() OVER (ORDER BY ""success_date"") DAY' AS ""success_group"" FROM ""Succeeded"" WHERE LEFT(""success_date"", 4)='2019'), ""success_agg"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""successes"" GROUP BY ""success_group"") SELECT * FROM ""fail_agg"" UNION SELECT * FROM ""success_agg"" ORDER BY 2"
31,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
32,"WITH ""combined"" AS (SELECT 'succeeded' AS ""state"",""success_date"" AS ""dt"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""state"",""fail_date"" AS ""dt"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""results"" AS (SELECT ""state"",""dt"",LAG(""state"", 1) OVER (ORDER BY ""dt"") AS ""prev_state"" FROM ""combined""), ""results_new"" AS (SELECT ""state"",""dt"",SUM(CASE WHEN ""state""!=""prev_state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dt"") AS ""rn"" FROM ""results""), ""state_check"" AS (SELECT ""rn"",MIN(""state"") AS ""period_state"" FROM ""results_new"" GROUP BY 1), ""build_dates"" AS (SELECT ""rn"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""results_new"" GROUP BY 1) SELECT ""sc"".""period_state"",""bd"".""start_date"",""bd"".""end_date"" FROM ""state_check"" AS ""sc"" JOIN ""build_dates"" AS ""bd"" ON ""sc"".""rn""=""bd"".""rn"""
33,"ERROR: mysql parse error: line 1 column 12 near ""period_state, start_date , end_date FROM ( SELECT 'succeeded' as period_state, min(success_date) as start_date ,max(success_date) as end_date FROM ( SELECT success_date , datediff(success_date, LAG(success_date, 1) over(order by success_date asc)) as date_diff , row_number() over(order by success_date asc) as rnk , date_sub(success_date, interval (row_number() over(order by success_date asc)) day) as date_sub FROM succeeded WHERE Year(success_date) = 2019 ) a group by date_sub UNION SELECT 'failed' as period_state, min(fail_date) as start_date ,max(fail_date) as end_date FROM ( SELECT fail_date , datediff(fail_date, LAG(fail_date, 1) over(order by fail_date asc)) as date_diff , row_number() over(order by fail_date asc) as rnk , date_sub(fail_date, interval (row_number() over(order by fail_date asc)) day) as date_sub FROM failed WHERE Year(fail_date) = 2019 ) a group by date_sub ) A order by start_date asc, end_date asc "" "
34,"SELECT * FROM ((SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""gap"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s"" GROUP BY ""gap"") UNION (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""gap"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s"" GROUP BY ""gap"")) AS ""a"" ORDER BY ""start_date"""
35,"WITH ""t"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""d"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""d"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""tt"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""d"") AS ""rnk"",""d"" - INTERVAL 'DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""d"") DAY' AS ""grp"" FROM ""t"") SELECT ""period_state"",MIN(""d"") AS ""start_date"",MAX(""d"") AS ""end_date"" FROM ""tt"" GROUP BY 1,""grp"" ORDER BY 2"
36,"WITH ""cte1"" AS (SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"") AS ""rn1"",RANK() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""rn2"" FROM ""cte1"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""state"",""rn1""-""rn2"" ORDER BY ""start_date"""
37,"SELECT * FROM (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" - CAST('2019-01-01' AS DATE) AS ""Day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""Idx"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""Failed_1"" GROUP BY CAST(""Day"" AS INTEGER)-CAST(""Idx"" AS INTEGER) UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" - CAST('2019-01-01' AS DATE) AS ""Day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""Idx"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""Succeeded_1"" GROUP BY CAST(""Day"" AS INTEGER)-CAST(""Idx"" AS INTEGER)) AS ""All_1"" ORDER BY ""start_date"""
38,"WITH ""main"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
39,"SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""status"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""rk1"",RANK() OVER (ORDER BY ""date"") AS ""rk2"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s"" ORDER BY ""date"") AS ""s"" GROUP BY ""rk2""-""rk1"",""status"""
40,"WITH ""a"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019'), ""b"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""seq"" FROM ""a"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""b"" GROUP BY ""date"" - INTERVAL '""seq"" DAY',""period_state"" ORDER BY ""start_date"""
41,"SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""status"",RANK() OVER (ORDER BY ""date"")-""rk"" AS ""prd"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tb1"") AS ""tb2"" GROUP BY ""tb2"".""prd"",""tb2"".""status"""
42,"SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""grp"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019') AS ""fail"" GROUP BY ""grp"" UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""grp"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') AS ""success"" GROUP BY ""grp"" ORDER BY ""start_date"""
43,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
44,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""dates"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded""), ""cte2"" AS (SELECT ""dates"",""stats"" AS ""period_state"",RANK() OVER (ORDER BY ""dates"") AS ""overall_rk"",""rk"",(RANK() OVER (ORDER BY ""dates"")-""rk"") AS ""inv"" FROM ""cte1"") SELECT ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM ""cte2"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""inv"" ORDER BY 2"
45,"WITH ""base"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""flag"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""flag"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) SELECT ""flag"" AS ""period_state"",""start_date"",""end_date"" FROM (SELECT ""flag"",""diff"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""rk"",""flag"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""new_rk"",ROW_NUMBER() OVER (ORDER BY ""date"")-""rk"" AS ""diff"" FROM ""base"") AS ""aa"" GROUP BY ""flag"",""diff"") AS ""ab"""
46,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
47,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
48,"WITH ""t"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""period_state"",""date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""rnk1"",RANK() OVER (ORDER BY ""date"") AS ""rnk2"" FROM ""t"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY (""rnk2""-""rnk1""),1"
49,"WITH ""F1"" AS (SELECT ""fail_date"",""fail_date"" - CAST('2019-01-01' AS DATE)-CAST(RANK() OVER (ORDER BY ""fail_date"") AS INTEGER) AS ""rks"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31'), ""F2"" AS (SELECT DISTINCT MIN(""fail_date"") OVER (PARTITION BY ""rks"" ORDER BY ""fail_date"") AS ""st_date"",MAX(""fail_date"") OVER (PARTITION BY ""rks"" ORDER BY ""fail_date"" DESC) AS ""ed_date"" FROM ""F1""), ""S1"" AS (SELECT ""success_date"",""success_date"" - CAST('2019-01-01' AS DATE)-CAST(RANK() OVER (ORDER BY ""success_date"") AS INTEGER) AS ""rks"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31'), ""S2"" AS (SELECT DISTINCT MIN(""success_date"") OVER (PARTITION BY ""rks"" ORDER BY ""success_date"") AS ""st_date"",MAX(""success_date"") OVER (PARTITION BY ""rks"" ORDER BY ""success_date"" DESC) AS ""ed_date"" FROM ""S1"") SELECT 'failed' AS ""period_state"",""st_date"" AS ""start_date"",""ed_date"" AS ""end_date"" FROM ""F2"" UNION ALL SELECT 'succeeded',""st_date"",""ed_date"" FROM ""S2"" ORDER BY ""start_date"""
50,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"",'failed' AS ""period_state"" FROM (SELECT ""fail_date"",""fail_date"" - INTERVAL '""rnkFailDate"" DAY' AS ""uniqueValueF"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnkFailDate"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""rnkFailDateTable"") AS ""finalTable"" GROUP BY ""uniqueValueF"" UNION ALL SELECT MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"",'succeeded' AS ""period_state"" FROM (SELECT ""success_date"",""success_date"" - INTERVAL '""rnkSuccessDate"" DAY' AS ""uniqueValueS"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnkSuccessDate"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""rnkSucsseedDateTable"") AS ""finalTable"" GROUP BY ""uniqueValueS"") AS ""unionTable"" ORDER BY ""start_date"",""end_date"""
51,"WITH ""failed_rnk"" AS (SELECT ""fail_date"",""fail_date"" - CAST('2018-12-31' AS DATE)-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""fr"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019), ""NeoFailed"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""failed_rnk"" GROUP BY ""fr""), ""succeed_rnk"" AS (SELECT ""success_date"",""success_date"" - CAST('2018-12-31' AS DATE)-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""sr"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""NeoSucceeded"" AS (SELECT 'succeeded' AS ""period state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""succeed_rnk"" GROUP BY ""sr"") SELECT * FROM ""NeoFailed"" UNION SELECT * FROM ""NeoSucceeded"" ORDER BY ""start_date"""
52,"SELECT ""a"".""period_state"",MIN(""a"".""dt"") AS ""start_date"",MAX(""a"".""dt"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""period_group"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""period_group"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY ""a"".""period_state"",""a"".""period_group"" ORDER BY ""start_date"""
53,"WITH ""temp"" AS (SELECT ""fail_date"" AS ""dates"",0 AS ""status_flag"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION SELECT ""success_date"" AS ""dates"",1 AS ""status_flag"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31' ORDER BY ""dates"") SELECT CASE WHEN ""status_flag""=1 THEN 'succeeded' ELSE 'failed' END AS ""period_state"",""dates"" AS ""start_date"",COALESCE(LEAD(""dates"" + INTERVAL '-1 DAY') OVER (ORDER BY ""dates""), (SELECT MAX(""dates"") FROM ""temp"")) AS ""end_date"" FROM (SELECT *,LAG(""dates"") OVER (PARTITION BY ""status_flag"" ORDER BY ""dates"") AS ""lag_dates"" FROM ""temp"") AS ""sub1"" WHERE ""lag_dates"" IS NULL OR ""lag_dates""!=""dates"" + INTERVAL '-1 DAY'"
54,"WITH ""fail_dates"" AS (SELECT ""fail_date"",LAG(""fail_date"", 1) OVER (ORDER BY ""fail_date"") AS ""prev_fail_date"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31'), ""success_dates"" AS (SELECT ""success_date"",LAG(""success_date"", 1) OVER (ORDER BY ""success_date"") AS ""prev_success_date"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31'), ""fail_dates_is_new_cycle"" AS (SELECT ""fail_date"",""prev_fail_date"",CASE WHEN ""prev_fail_date"" + INTERVAL '1 DAY'!=""fail_date"" THEN 1 ELSE 0 END AS ""is_new_cycle"" FROM ""fail_dates""), ""success_dates_is_new_cycle"" AS (SELECT ""success_date"",""prev_success_date"",CASE WHEN ""prev_success_date"" + INTERVAL '1 DAY'!=""success_date"" THEN 1 ELSE 0 END AS ""is_new_cycle"" FROM ""success_dates""), ""fail_dates_cycles"" AS (SELECT 'failed' AS ""type"",""fail_date"" AS ""event_date"",SUM(""is_new_cycle"") OVER (ORDER BY ""fail_date"") AS ""cycle"" FROM ""fail_dates_is_new_cycle""), ""success_dates_cycles"" AS (SELECT 'succeeded' AS ""type"",""success_date"" AS ""event_date"",SUM(""is_new_cycle"") OVER (ORDER BY ""success_date"") AS ""cycle"" FROM ""success_dates_is_new_cycle""), ""merged"" AS (SELECT ""type"",""event_date"",""cycle"" FROM ""fail_dates_cycles"" UNION SELECT ""type"",""event_date"",""cycle"" FROM ""success_dates_cycles""), ""results_pre_sorting"" AS (SELECT ""type"" AS ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM ""merged"" GROUP BY ""type"",""cycle"") SELECT * FROM ""results_pre_sorting"" ORDER BY ""start_date"""
55,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
56,"SELECT ""period_state"",MIN(""sdate"") AS ""start_date"",MAX(""sdate"") AS ""end_date"" FROM (SELECT ""period_state"",""sdate"",RANK() OVER (ORDER BY ""sdate"")-""rnk"" AS ""inv"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""sdate"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""period_state"",""fail_date"" AS ""sdate"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""t"" GROUP BY ""inv"",""period_state"""
57,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""period_state"",""day"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""c"") AS ""t"" GROUP BY ""period_state"",""inv"" ORDER BY ""start_date"""
58,"WITH ""total"" AS (SELECT ""fail_date"" AS ""days"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""days"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""days""), ""X"" AS (SELECT ""days"",""state"",RANK() OVER (ORDER BY ""days"")-""rnk"" AS ""num"" FROM ""total"") SELECT ""state"" AS ""period_state"",MIN(""days"") AS ""start_date"",MAX(""days"") AS ""end_date"" FROM ""X"" GROUP BY ""state"",""num"""
59,"WITH ""a"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""flag"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""dt"",'succeeded' AS ""flag"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""b"" AS (SELECT ""dt"",""flag"",""dt"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""flag"" ORDER BY ""dt"") DAY' AS ""dtgrp"" FROM ""a"") SELECT ""flag"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""b"" GROUP BY ""dtgrp"",""flag"" ORDER BY ""dt"""
60,"WITH ""dates"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"" UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded""), ""period"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""index_num"" FROM ""dates"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""period"" GROUP BY ""date"" + INTERVAL '-""index_num"" DAY',""period_state"" ORDER BY ""start_date"""
61,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_rk"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
62,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""dates"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded""), ""cte2"" AS (SELECT ""dates"",""stats"" AS ""period_state"",RANK() OVER (ORDER BY ""dates"") AS ""overall_rk"",""rk"",(RANK() OVER (ORDER BY ""dates"")-""rk"") AS ""inv"" FROM ""cte1"") SELECT ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM ""cte2"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""inv"" ORDER BY 2"
63,"WITH ""alll"" AS (SELECT ""success_date"" AS ""date"",'succeeded' AS ""mode"",""success_date"" - (LAG(""success_date"", 1) OVER (ORDER BY ""success_date"")) AS ""daydiff"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION SELECT ""fail_date"" AS ""date"",'failed' AS ""mode"",""fail_date"" - (LAG(""fail_date"", 1) OVER (ORDER BY ""fail_date"")) AS ""daydiff"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""mode"" AS ""period_state"",""date"" AS ""start_date"",COALESCE(LEAD(""date"", 1) OVER (ORDER BY ""date"") - INTERVAL '1 DAY', (SELECT MAX(""date"") FROM ""alll"")) AS ""end_date"" FROM ""alll"" WHERE COALESCE(""daydiff"", 0)!=1 ORDER BY ""date"""
64,"WITH ""cte_date"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte_group"" AS (SELECT ""dt"",""period_state"",RANK() OVER (ORDER BY ""dt"") AS ""rnk_date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""dt"") AS ""rnk_date_state"" FROM ""cte_date"") SELECT DISTINCT ""period_state"",FIRST_VALUE(""dt"") OVER (PARTITION BY ""period_state"", (""rnk_date""-""rnk_date_state"") ORDER BY ""dt"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""start_date"",LAST_VALUE(""dt"") OVER (PARTITION BY ""period_state"", (""rnk_date""-""rnk_date_state"") ORDER BY ""dt"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""end_date"" FROM ""cte_group"" ORDER BY 2"
65,"SELECT ""period_state"",MIN(""days"") AS ""start_date"",MAX(""days"") AS ""end_date"" FROM (SELECT ""period_state"",""days"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""days"") AS ""rk"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""days"" FROM ""failed"" UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""days"" FROM ""succeeded"") AS ""a"" WHERE EXTRACT(YEAR FROM ""days"")='2019') AS ""b"" GROUP BY 1,""days"" + INTERVAL '-""rk"" DAY' ORDER BY 2"
66,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
67,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
68,"WITH ""CTE"" AS (SELECT ""fail_date"" AS ""start_date"",'failed' AS ""Period_state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""start_date"",'succeeded' AS ""Period_state"" FROM ""Succeeded""), ""CTE2"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""id"" FROM ""CTE"" WHERE ""start_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""CTE3"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Period_state"" ORDER BY ""start_date"") AS ""row_num"" FROM ""CTE2""), ""CTE4"" AS (SELECT ""id"",""start_date"",""period_state"",(""id""-""row_num"") AS ""groupings"" FROM ""cTE3"") SELECT ""period_state"",MIN(""start_date"") AS ""start_date"",MAX(""start_date"") AS ""end_date"" FROM ""CTE4"" GROUP BY ""groupings"",""period_state"" ORDER BY ""start_date"",""end_date"""
69,"SELECT ""state"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
70,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"",'failed' AS ""period_state"" FROM (SELECT ""fail_date"",""fail_date"" - INTERVAL '""rnkFailDate"" DAY' AS ""uniqueValueF"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnkFailDate"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""rnkFailDateTable"") AS ""finalTable"" GROUP BY ""uniqueValueF"" UNION ALL SELECT MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"",'succeeded' AS ""period_state"" FROM (SELECT ""success_date"",""success_date"" - INTERVAL '""rnkSuccessDate"" DAY' AS ""uniqueValueS"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnkSuccessDate"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND ' 2019-12-31') AS ""rnkSucsseedDateTable"") AS ""finalTable"" GROUP BY ""uniqueValueS"") AS ""unionTable"" ORDER BY ""start_date"",""end_date"""
71,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""success"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""success_date"" AS ""day"",'succeeded' AS ""success"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""success"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""success"",RANK() OVER (ORDER BY ""day"")-""rnk"" AS ""delta"" FROM (SELECT * FROM ""cte"" UNION ALL SELECT * FROM ""cte2"") AS ""a"") AS ""b"" GROUP BY ""delta"",""success"" ORDER BY ""start_date"""
72,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""period_state"",""day"",RANK() OVER (ORDER BY ""day"")-""rk"" AS ""diff"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""c"") AS ""t"" GROUP BY ""period_state"",""diff"" ORDER BY ""start_date"""
73,"SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""date_grouping"",'failed' AS ""period_state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"")+1000 AS ""date_grouping"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"" GROUP BY ""date_grouping"" ORDER BY ""start_date"""
74,"WITH ""alll"" AS (SELECT ""success_date"" AS ""date"",'succeeded' AS ""mode"",""success_date"" - (LAG(""success_date"", 1) OVER (ORDER BY ""success_date"")) AS ""daydiff"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION SELECT ""fail_date"" AS ""date"",'failed' AS ""mode"",""fail_date"" - (LAG(""fail_date"", 1) OVER (ORDER BY ""fail_date"")) AS ""daydiff"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""mode"" AS ""period_state"",""date"" AS ""start_date"",COALESCE(LEAD(""date"", 1) OVER (ORDER BY ""date"") - INTERVAL '1 DAY', (SELECT MAX(""date"") FROM ""alll"")) AS ""end_date"" FROM ""alll"" WHERE COALESCE(""daydiff"", 0)!=1 ORDER BY ""date"""
75,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MIN(""date"") + INTERVAL 'COUNT(1)-1 DAY' AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"")-ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""row_diff"" FROM ""cte"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"" GROUP BY ""state"",""row_diff"" ORDER BY ""start_date"""
76,"SELECT * FROM (SELECT 'failed' AS ""period_state"",""start_date"",""end_date"" FROM (SELECT ""t1"".""fail_date"" AS ""start_date"",MIN(""t2"".""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' AND ""fail_date"" - INTERVAL '1 DAY' NOT IN (SELECT ""fail_date"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31')) AS ""t1"" CROSS, (SELECT ""fail_date"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' AND ""fail_date"" + INTERVAL '1 DAY' NOT IN (SELECT ""fail_date"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31')) AS ""t2"" WHERE ""t1"".""fail_date""<=""t2"".""fail_date"" GROUP BY ""t1"".""fail_date"") AS ""sub"") AS ""sub1"" UNION ALL SELECT * FROM (SELECT 'succeeded' AS ""period_state"",""start_date"",""end_date"" FROM (SELECT ""t1"".""success_date"" AS ""start_date"",MIN(""t2"".""success_date"") AS ""end_date"" FROM (SELECT ""success_date"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31' AND ""success_date"" - INTERVAL '1 DAY' NOT IN (SELECT ""success_date"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31')) AS ""t1"" CROSS, (SELECT ""success_date"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31' AND ""success_date"" + INTERVAL '1 DAY' NOT IN (SELECT ""success_date"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31')) AS ""t2"" WHERE ""t1"".""success_date""<=""t2"".""success_date"" GROUP BY ""t1"".""success_date"") AS ""sub"") AS ""sub2"" ORDER BY ""start_date"""
77,"WITH ""base"" AS (SELECT 'failed' AS ""state"",""fail_date"" AS ""date_key"",RANK() OVER (ORDER BY ""fail_date"") AS ""base_rank"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""state"",""success_date"" AS ""date_key"",RANK() OVER (ORDER BY ""success_date"") AS ""base_rank"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""base_plus"" AS (SELECT ""state"",""date_key"",""base_rank"",RANK() OVER (ORDER BY ""date_key"") AS ""overall_rank"",RANK() OVER (ORDER BY ""date_key"")-""base_rank"" AS ""rank_diff"" FROM ""base"") SELECT ""state"" AS ""period_state"",MIN(""date_key"") AS ""start_date"",MAX(""date_key"") AS ""end_date"" FROM ""base_plus"" GROUP BY ""state"",""rank_diff"" ORDER BY 2"
78,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
79,"SELECT ""state"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
80,"WITH ""t1"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019'), ""t2"" AS (SELECT ""date"",""status"",LEAD(""status"", 1) OVER (ORDER BY ""date"") AS ""next_status"",LAG(""status"", 1) OVER (ORDER BY ""date"") AS ""previous_status"" FROM ""t1""), ""t3"" AS (SELECT ""date"" AS ""start_date"",""status"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rnk"" FROM ""t2"" WHERE ""status""!=""previous_status"" OR ""previous_status"" IS NULL), ""t4"" AS (SELECT ""date"" AS ""end_date"",""status"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rnk"" FROM ""t2"" WHERE ""status""!=""next_status"" OR ""next_status"" IS NULL) SELECT ""t3"".""status"" AS ""period_state"",""start_date"",""end_date"" FROM ""t3"" JOIN ""t4"" ON ""t3"".""rnk""=""t4"".""rnk"""
81,"WITH ""together"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""grp"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed',""fail_date"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""grp"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""together"" GROUP BY ""period_state"",""grp"" ORDER BY 2"
82,"WITH ""cte1"" AS (SELECT 'failed' AS ""status"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""status"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"") AS ""rn1"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""rn2"" FROM ""cte1"" ORDER BY ""date"") SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""status"",""rn1""-""rn2"" ORDER BY ""start_date"""
83,"WITH ""un"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date1"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date1"" FROM ""Succeeded""), ""flags"" AS (SELECT ""period_state"",""date1"",DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""flag"" FROM ""un"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""flags"" GROUP BY ""period_state"",""flag"" ORDER BY MIN(""date1"")"
84,"SELECT * FROM (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER () AS ""id"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""A"" GROUP BY DAYOFYEAR(""fail_date"")-""id"" UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER () AS ""id"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""A"" GROUP BY DAYOFYEAR(""success_date"")-""id"") AS ""A"" ORDER BY ""start_date"""
85,"WITH ""su"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"",""success_date"" - INTERVAL 'DENSE_RANK() OVER (ORDER BY ""success_date"") DAY' FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""x"" GROUP BY ""success_date"" - INTERVAL '""rk"" DAY'), ""fa"" AS (SELECT ""period_state"",MIN(""fail_date""),MAX(""fail_date"") FROM (SELECT 'failed' AS ""period_state"",""fail_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"",""fail_date"" - INTERVAL 'DENSE_RANK() OVER (ORDER BY ""fail_date"") DAY' FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""x"" GROUP BY ""fail_date"" - INTERVAL '""rk"" DAY') SELECT * FROM ""su"" UNION ALL SELECT * FROM ""fa"" ORDER BY ""start_date"""
86,"WITH ""temp"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",DENSE_RANK() OVER (ORDER BY ""day"") AS ""rko"",""stats"",""rk"",(DENSE_RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM ""temp"" ORDER BY ""day"") AS ""temp"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
87,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""stg"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY ""start_date"""
88,"WITH ""cte"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""Rnk"",""success_date"",DAYOFYEAR(""success_date"") AS ""Day"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""dte"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""Rnk"",""fail_date"",DAYOFYEAR(""fail_date"") AS ""Day"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT * FROM (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte"" GROUP BY ""Day""-""rnk"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""dte"" GROUP BY ""Day""-""rnk"") AS ""e"" ORDER BY ""e"".""start_date"""
89,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
90,"WITH ""base"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""dt"",'failed' AS ""status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" ORDER BY ""dt""), ""base3"" AS (SELECT ""dt"",""status"" AS ""period_state"",RANK() OVER (ORDER BY ""dt"")-DENSE_RANK() OVER (PARTITION BY ""status"" ORDER BY ""dt"") AS ""rk"" FROM ""base"") SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""base3"" GROUP BY ""period_state"",""rk"""
91,"WITH ""CTE"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""CTE2"" AS (SELECT *,(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM ""CTE"") SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""CTE2"" GROUP BY ""inv"",""period_state"" ORDER BY 2"
92,"SELECT * FROM (SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""period_state"",""day"",(CASE WHEN ""period_state""='failed' THEN ROW_NUMBER() OVER (ORDER BY ""day"")-""rf"" ELSE ROW_NUMBER() OVER (ORDER BY ""day"")-""rs"" END) AS ""dd"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rf"",NULL AS ""rs"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",NULL AS ""rf"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rs"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""a"") AS ""b"" GROUP BY ""period_state"",""dd"") AS ""c"" ORDER BY ""start_date"""
93,"WITH ""states"" AS (SELECT ""fail_date"" AS ""period_date"",'failed' AS ""period_state"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""period_date"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""intervals"" AS (SELECT ""period_date"",""period_state"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""period_date"") AS ""rownum"",RANK() OVER (ORDER BY ""period_date"") AS ""grp"" FROM ""states"") SELECT ""period_state"",MIN(""period_date"") AS ""start_date"",MAX(""period_date"") AS ""end_date"" FROM ""intervals"" GROUP BY (""grp""-""rownum""),""period_state"" ORDER BY ""start_date"""
94,"SELECT ""c"".""period_state"",""c"".""start_date"",""c"".""end_date"" FROM (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",DAYOFYEAR(""fail_date"") AS ""day_of_yr"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""row_num"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY ""a"".""day_of_yr""-""a"".""row_num"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",DAYOFYEAR(""success_date"") AS ""day_of_yr"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""row_num"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""b"" GROUP BY ""b"".""day_of_yr""-""b"".""row_num"") AS ""c"" ORDER BY ""c"".""start_date"""
95,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""status"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""day""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""day"") AS ""rn1"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""day"") AS ""rn2"" FROM ""cte1"" ORDER BY ""day"") SELECT ""status"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""cte2"" GROUP BY ""status"",""rn1""-""rn2"" ORDER BY ""day"""
96,"SELECT ""stat"" AS ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM (SELECT *,(RANK() OVER (ORDER BY ""dates"")-""rk"") AS ""ranks"" FROM (SELECT ""fail_date"" AS ""dates"",'failed' AS ""stat"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stat"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""b"") AS ""c"" GROUP BY ""stat"",""ranks"" ORDER BY ""start_date"""
97,"SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""state"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""rnk"",""date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""date"") DAY' AS ""groupin"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') AS ""a"") AS ""a"" GROUP BY ""state"",""groupin"" ORDER BY 2"
98,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"" FROM ""succeeded""), ""cte1"" AS (SELECT ""day"",""period_state"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""day"") AS ""rnk"" FROM ""cte""), ""cte2"" AS (SELECT ""day"",""period_state"",""day"" + INTERVAL '-""rnk"" DAY' AS ""start_dt"" FROM ""cte1"") SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""cte2"" WHERE ""day"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""start_dt"" ORDER BY ""start_date"""
99,"WITH ""T"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"")-ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""groupping"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"") AS ""a"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""S"" AS (SELECT ""period_state"",""groupping"",MIN(""date"") AS ""start_date"" FROM ""T"" GROUP BY ""period_state"",""groupping""), ""E"" AS (SELECT ""period_state"",""groupping"",MAX(""date"") AS ""end_date"" FROM ""T"" GROUP BY ""period_state"",""groupping"") SELECT ""a"".""period_state"",""a"".""start_date"",""b"".""end_date"" FROM ""S"" AS ""a"" LEFT JOIN ""E"" AS ""b"" ON ""a"".""groupping""=""b"".""groupping"" AND ""a"".""period_state""=""b"".""period_state"" ORDER BY ""a"".""start_date"""
100,"WITH ""success"" AS (SELECT 'succeeded' AS ""state"",""success_date"" AS ""dt"",""success_date"" + INTERVAL '-RANK() OVER (ORDER BY ""success_date"") DAY' AS ""rn"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""fail"" AS (SELECT 'failed' AS ""state"",""fail_date"" AS ""dt"",""fail_date"" + INTERVAL '-RANK() OVER (ORDER BY ""fail_date"") DAY' AS ""rn"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""state"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""success"" GROUP BY ""rn"" UNION ALL SELECT ""state"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""fail"" GROUP BY ""rn"" ORDER BY ""start_date"""
101,"WITH ""cte_log"" AS (SELECT ""fail_date"" AS ""calendar_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""calendar_date"",'succeeded' AS ""state"" FROM ""Succeeded""), ""cte_label"" AS (SELECT ""calendar_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""calendar_date"") AS ""day_idx"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""calendar_date"") AS ""partition_day_idx"" FROM ""cte_log"" WHERE ""calendar_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte_final"" AS (SELECT ""state"" AS ""period_state"",MIN(""calendar_date"") AS ""start_date"",MAX(""calendar_date"") AS ""end_date"" FROM ""cte_label"" GROUP BY 1,""day_idx""-""partition_day_idx"" ORDER BY 2) SELECT * FROM ""cte_final"""
102,"SELECT ""type"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ((SELECT 'failed' AS ""type"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') UNION (SELECT 'succeeded' AS ""type"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31')) AS ""w"" GROUP BY ""type"",""day"" - INTERVAL '""rnk"" DAY' ORDER BY ""start_date"""
103,"WITH ""CTE"" AS (SELECT *,(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tb"") SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""CTE"" GROUP BY ""inv"",""period_state"" ORDER BY 2"
104,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"") IN ('2019') UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"") IN ('2019')) AS ""sub"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY ""start_date"""
105,"WITH ""success"" AS (SELECT ""success_date"" AS ""ds"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""fail"" AS (SELECT ""fail_date"" AS ""ds"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""success_agg"" AS (SELECT ""s1"".""ds"",CASE WHEN ""s2"".""ds"" IS NULL THEN 1 ELSE 0 END AS ""ds_begin"",CASE WHEN ""s3"".""ds"" IS NULL THEN 1 ELSE 0 END AS ""ds_end"" FROM (""success"" AS ""s1"" LEFT JOIN ""success"" AS ""s2"" ON ""s1"".""ds"" + INTERVAL '-1 DAY'=""s2"".""ds"") LEFT JOIN ""success"" AS ""s3"" ON ""s1"".""ds"" + INTERVAL '1 DAY'=""s3"".""ds""), ""success_result"" AS (SELECT 'succeeded' AS ""period_state"",""s1"".""ds"" AS ""start_date"",COALESCE(MIN(""s2"".""ds""), '2019-12-31') AS ""end_date"" FROM ""success_agg"" AS ""s1"" LEFT JOIN (SELECT ""ds"" FROM ""success_agg"" WHERE ""ds_end""=1) AS ""s2"" ON ""s1"".""ds""<=""s2"".""ds"" WHERE ""ds_begin""=1 GROUP BY 1,2), ""fail_agg"" AS (SELECT ""f1"".""ds"",CASE WHEN ""f2"".""ds"" IS NULL THEN 1 ELSE 0 END AS ""ds_begin"",CASE WHEN ""f3"".""ds"" IS NULL THEN 1 ELSE 0 END AS ""ds_end"" FROM (""fail"" AS ""f1"" LEFT JOIN ""fail"" AS ""f2"" ON ""f1"".""ds"" + INTERVAL '-1 DAY'=""f2"".""ds"") LEFT JOIN ""fail"" AS ""f3"" ON ""f1"".""ds"" + INTERVAL '1 DAY'=""f3"".""ds""), ""fail_result"" AS (SELECT 'failed' AS ""period_state"",""f1"".""ds"" AS ""start_date"",COALESCE(MIN(""f2"".""ds""), '2019-12-31') AS ""end_date"" FROM ""fail_agg"" AS ""f1"" LEFT JOIN (SELECT ""ds"" FROM ""fail_agg"" WHERE ""ds_end""=1) AS ""f2"" ON ""f1"".""ds""<=""f2"".""ds"" WHERE ""ds_begin""=1 GROUP BY 1,2) SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT * FROM ""success_result"") AS ""t1"" UNION ALL (SELECT * FROM ""fail_result"") ORDER BY 2"
106,"WITH ""f"" AS (SELECT * FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""s"" AS (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""conse_f"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""f""), ""conse_s"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""s""), ""final_s"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""conse_s"" GROUP BY ""success_date"" - INTERVAL '""ranking"" DAY'), ""final_f"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""conse_f"" GROUP BY ""fail_date"" - INTERVAL '""ranking"" DAY') SELECT ""tab"".* FROM (SELECT * FROM ""final_f"" UNION ALL SELECT * FROM ""final_s"") AS ""tab"" ORDER BY ""tab"".""start_date"""
107,"WITH ""t"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""grp"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""grp"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""t"" GROUP BY 1,""grp"" ORDER BY 2"
108,"WITH ""failed_grp"" AS (SELECT ""fail_date"" AS ""task_date"",'failed' AS ""outcome"",""fail_date"" + INTERVAL '-ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""grp"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""succ_grp"" AS (SELECT ""success_date"" AS ""task_date"",'succeeded' AS ""outcome"",""success_date"" + INTERVAL '-ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""grp"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""outcome"" AS ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_date"") AS ""end_date"" FROM ""failed_grp"" GROUP BY ""outcome"",""grp"" UNION ALL SELECT ""outcome"" AS ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_date"") AS ""end_date"" FROM ""succ_grp"" GROUP BY ""outcome"",""grp"" ORDER BY ""start_date"""
109,"WITH ""date_status"" AS (SELECT 'failed' AS ""stat"",""fail_date"" AS ""all_date"" FROM ""failed"" UNION SELECT 'succeeded' AS ""stat"",""success_date"" AS ""all_date"" FROM ""succeeded"" ORDER BY ""all_date"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
110,"WITH ""stg"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dts"",""fail_date"" - INTERVAL '(ROW_NUMBER() OVER (ORDER BY ""fail_date"")) DAY' AS ""grp"" FROM ""Failed"" WHERE TO_CHAR(""fail_date"", 'YYYY')='2019' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dts"",""success_date"" - INTERVAL '(ROW_NUMBER() OVER (ORDER BY ""success_date"")) DAY' AS ""grp"" FROM ""Succeeded"" WHERE TO_CHAR(""success_date"", 'YYYY')='2019') SELECT ""period_state"",MIN(""dts"") AS ""start_date"",MAX(""dts"") AS ""end_date"" FROM ""stg"" GROUP BY ""period_state"",""grp"" ORDER BY ""start_date"""
111,"SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",DAYOFYEAR(""fail_date"") AS ""days"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""t1"" GROUP BY ""days""-""rn"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",DAYOFYEAR(""success_date"") AS ""days"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""t2"" GROUP BY ""days""-""rn"" ORDER BY ""start_date"""
112,"WITH ""t"" AS (SELECT ""date_"",""status_"",ROW_NUMBER() OVER (ORDER BY ""date_"") AS ""id"" FROM (SELECT ""fail_date"" AS ""date_"",'F' AS ""status_"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date_"",'S' AS ""status_"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") SELECT 'succeeded' AS ""period_state"",MIN(""date_"") AS ""start_date"",MAX(""date_"") AS ""end_date"" FROM (SELECT ""date_"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""grp"" FROM ""t"" WHERE ""status_""='S') AS ""s_part"" GROUP BY ""grp"" UNION SELECT 'failed' AS ""period_state"",MIN(""date_"") AS ""start_date"",MAX(""date_"") AS ""end_date"" FROM (SELECT ""date_"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""grp"" FROM ""t"" WHERE ""status_""='F') AS ""f_part"" GROUP BY ""grp"" ORDER BY ""start_date"""
113,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
114,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
115,"SELECT CASE WHEN MAX(""tbl"")='s' THEN 'succeeded' ELSE 'failed' END AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT ""dt"",""tbl"",""id""-ROW_NUMBER() OVER (PARTITION BY ""tbl"" ORDER BY ""dt"") AS ""grp"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""dt"") AS ""id"" FROM (SELECT ""success_date"" AS ""dt"",'s' AS ""tbl"" FROM ""Succeeded"" UNION SELECT ""fail_date"" AS ""dt"",'f' AS ""tbl"" FROM ""Failed"") AS ""a"" WHERE ""dt"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""b"") AS ""c"" GROUP BY ""tbl"",""grp"" ORDER BY 2,3"
116,"SELECT ""status"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT ""status"",""dt"",""dt"" + INTERVAL '-""rn"" DAY' AS ""gp"" FROM (SELECT ""fail_date"" AS ""dt"",'failed' AS ""status"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""dt"",'succeeded' AS ""status"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""T"") AS ""T1"" GROUP BY ""status"",""gp"" ORDER BY ""start_date"""
117,"SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""status"",""date"" - INTERVAL '(RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"")) DAY' AS ""diff_d"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""Succeeded"") AS ""tb1"") AS ""tb2"" WHERE EXTRACT(YEAR FROM ""date"")=2019 GROUP BY ""status"",""diff_d"" ORDER BY ""start_date"""
118,"WITH ""progress"" AS ((SELECT ""fail_date"" AS ""day"",'failed' AS ""status"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""failed"" WHERE ""fail_date"" BETWEEN STR_TO_DATE('2019-01-01', '%Y-%m-%d') AND STR_TO_DATE('2019-12-31', '%Y-%m-%d') ORDER BY ""fail_date"") UNION ALL (SELECT ""success_date"" AS ""day"",'succeeded' AS ""status"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN STR_TO_DATE('2019-01-01', '%Y-%m-%d') AND STR_TO_DATE('2019-12-31', '%Y-%m-%d') ORDER BY ""success_date"")) SELECT ""status"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""progress"" GROUP BY ""day"" - INTERVAL '""rn"" DAY',""status"" ORDER BY ""day"""
119,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""dates"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded""), ""cte2"" AS (SELECT ""dates"",""stats"" AS ""period_state"",RANK() OVER (ORDER BY ""dates"") AS ""overall_rk"",""rk"",(RANK() OVER (ORDER BY ""dates"")-""rk"") AS ""inv"" FROM ""cte1"") SELECT ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM ""cte2"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""inv"" ORDER BY 2"
120,"WITH ""neoFailed"" AS (SELECT ""fail_date"",""fail_date"" - CAST('2018-12-31' AS DATE)-RANK() OVER (ORDER BY ""fail_date"") AS ""fn"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019), ""nF"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""neoFailed"" GROUP BY ""fn""), ""neoSucceeded"" AS (SELECT ""success_date"",""success_date"" - CAST('2018-12-31' AS DATE)-RANK() OVER (ORDER BY ""success_date"") AS ""snc"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""nS"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""neoSucceeded"" GROUP BY ""snc"") SELECT * FROM ""nF"" UNION SELECT * FROM ""nS"" ORDER BY ""start_date"""
121,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT ""status"" AS ""period_state"",""status_rank"",MIN(""sdate"") AS ""start_date"",MAX(""sdate"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""sdate"")-ROW_NUMBER() OVER (PARTITION BY ""status"" ORDER BY ""sdate"") AS ""status_rank"" FROM (SELECT ""fail_date"" AS ""sdate"",'failed' AS ""status"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""sdate"",'succeeded' AS ""status"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""sub"") AS ""sub2"" GROUP BY 1,2) AS ""sub3"" ORDER BY ""start_date"""
122,"SELECT ""period_state"",""start_date"",""end_date"" FROM ((SELECT MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"",'failed' AS ""period_state"" FROM (SELECT *,""fail_date"" - ""con_date"" AS ""date_diff"" FROM (SELECT *,CAST('2018-12-31' AS DATE) + INTERVAL '""rn"" DAY' AS ""con_date"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""rn"" FROM (SELECT * FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""fail_date"") AS ""a"") AS ""b"") AS ""c"") AS ""d"" GROUP BY ""date_diff"") UNION ALL (SELECT MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"",'succeeded' AS ""period_state"" FROM (SELECT *,""success_date"" - ""con_date"" AS ""date_diff"" FROM (SELECT *,CAST('2018-12-31' AS DATE) + INTERVAL '""rn"" DAY' AS ""con_date"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""rn"" FROM (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""success_date"") AS ""a"") AS ""b"") AS ""c"") AS ""d"" GROUP BY ""date_diff"")) AS ""C"" ORDER BY ""start_date"""
123,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
124,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""temp"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY MIN(""day"")"
125,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
126,"WITH ""failed"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"" DESC) AS ""rnum"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""temp"" GROUP BY ""fail_date"" + INTERVAL '""rnum"" DAY'), ""suceed"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"" DESC) AS ""rnum"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""temp2"" GROUP BY ""success_date"" + INTERVAL '""rnum"" DAY') SELECT * FROM ""failed"" UNION ALL SELECT * FROM ""suceed"" ORDER BY ""start_date"""
127,"SELECT ""state"" AS ""period_state"",""date"" AS ""start_date"",CASE WHEN ""next_state"" IS NULL OR (""state""!=""pre_state"" AND ""state""!=""next_state"") OR (""pre_state"" IS NULL AND ""state""!=""next_state"") THEN ""date"" ELSE ""next_date"" END AS ""end_date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"",LAG(""date"", 1) OVER (ORDER BY ""date"") AS ""pre_date"",LEAD(""date"", 1) OVER (ORDER BY ""date"") AS ""next_date"" FROM (SELECT ""state"",""date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"" FROM (SELECT * FROM (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"") AS ""combined1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date"") AS ""combined2"") AS ""combined3"" WHERE ""state""!=""pre_state"" OR ""state""!=""next_state"" OR ""pre_state"" IS NULL OR ""next_state"" IS NULL) AS ""combined4"") AS ""combined5"" WHERE (""pre_state"" IS NULL AND ""state""!=""next_state"") OR (""next_state"" IS NULL AND ""state""!=""pre_state"") OR ""state""=""next_state"" OR (""state""!=""pre_state"" AND ""state""!=""next_state"")"
128,"WITH ""AllData"" AS (SELECT ""success_date"" AS ""t_date"",'succeeded' AS ""state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r_no"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION SELECT ""fail_date"" AS ""t_date"",'failed' AS ""state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r_no"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""state"" AS ""period_state"",MIN(""t_date"") AS ""start_date"",MAX(""t_date"") AS ""end_date"" FROM (SELECT ""t_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""t_date"")-""r_no"" AS ""row_diff"" FROM ""AllData"") AS ""Results"" GROUP BY ""state"",""row_diff"" ORDER BY 2"
129,"WITH ""cte"" AS (SELECT ""date"",""period_state"",""num_1""-""num_2"" AS ""diff"" FROM (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""num_1"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""num_2"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""a"") AS ""b"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte"" GROUP BY ""period_state"",""diff"" ORDER BY MIN(""date"")"
130,"WITH ""all_records"" AS (SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""event_status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""fail_date"" AS ""event_date"",'failed' AS ""event_status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""ordered_records"" AS (SELECT ""event_date"",""event_status"" FROM ""all_records"" ORDER BY ""event_date""), ""grp_records"" AS (SELECT ""event_date"",@""grp_num"":=(CASE WHEN @""prev_status""!=""event_status"" THEN @""grp_num""+1 ELSE @""grp_num"" END) AS ""grp"",@""prev_status"":=""event_status"" AS ""eve_status"" FROM (""ordered_records"" AS ""ord"") CROSS JOIN (SELECT @""grp_num"":=0,@""prev_status"":=NULL) AS ""var_list"") SELECT ""eve_status"" AS ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM ""grp_records"" GROUP BY ""grp"" ORDER BY ""grp"""
131,"WITH ""sf_dates"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""dt_bkt"" AS (SELECT *,RANK() OVER (ORDER BY ""dt"") AS ""rnk1"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""dt"") AS ""rnk2"" FROM ""sf_dates"" ORDER BY ""dt"") SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""dt_bkt"" GROUP BY ""rnk1""-""rnk2"",""period_state"" ORDER BY ""start_date"""
132,"SELECT ""status"" AS ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM (SELECT ""dates"",""status"",(ROW_NUMBER() OVER (ORDER BY ""dates"")-ROW_NUMBER() OVER (PARTITION BY ""status"" ORDER BY ""dates"")) AS ""rn2"" FROM (SELECT ""fail_date"" AS ""dates"",'failed' AS ""status"" FROM ""failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stutus"" FROM ""succeeded"" ORDER BY ""dates"") AS ""tmp"" ORDER BY ""dates"") AS ""tmp1"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""rn2"",""status"""
133,"WITH ""main"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date1"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date1"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""period_state"",""mappings"" ORDER BY ""start_date"""
134,"WITH ""filter"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""status"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""status"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""day""), ""ranking"" AS (SELECT *,RANK() OVER (ORDER BY ""day"") AS ""key_rank"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""day"") AS ""status_rank"" FROM ""filter"" ORDER BY ""day"") SELECT ""status"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""ranking"" GROUP BY ""status"",""key_rank""-""status_rank"" ORDER BY ""day"""
135,"WITH ""cte"" AS (SELECT ""success_date"" AS ""adate"",'succeeded' AS ""period_state"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""period_group"" FROM ""Succeeded"" WHERE LEFT(""success_date"", 4)='2019' UNION SELECT ""fail_date"" AS ""adate"",'failed' AS ""period_state"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""period_group"" FROM ""Failed"" WHERE LEFT(""fail_date"", 4)='2019') SELECT ""period_state"",MIN(""adate"") AS ""start_date"",MAX(""adate"") AS ""end_date"" FROM ""cte"" GROUP BY ""period_state"",""period_group"" ORDER BY ""adate"""
136,"WITH ""combined"" AS (SELECT ""date"",""status"",""date"" - INTERVAL '""rn"" DAY' AS ""diff"" FROM (SELECT ""date"",""status"",ROW_NUMBER() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""rn"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""Succeeded"") AS ""z"") AS ""y"") SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""combined"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""status"",""diff"" ORDER BY ""start_date"""
137,"WITH ""cte1"" AS (SELECT 'failed' AS ""status"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""status"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"") AS ""rn1"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""rn2"" FROM ""cte1"" ORDER BY ""date"") SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""status"",""rn1""-""rn2"" ORDER BY ""start_date"""
138,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
139,"WITH ""a"" AS ((SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"") UNION ALL (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"")), ""b"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""seq"" FROM ""a"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""c"" AS (SELECT ""date"",""period_state"",""seq"",""date"" + INTERVAL '-""seq"" DAY' AS ""seqstart"" FROM ""b"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""c"" GROUP BY ""seqStart"",""period_state"" ORDER BY ""start_date"""
140,"WITH ""alll"" AS (SELECT ""success_date"" AS ""date"",'succeeded' AS ""mode"",""success_date"" - (LAG(""success_date"", 1) OVER (ORDER BY ""success_date"")) AS ""daydiff"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION SELECT ""fail_date"" AS ""date"",'failed' AS ""mode"",""fail_date"" - (LAG(""fail_date"", 1) OVER (ORDER BY ""fail_date"")) AS ""daydiff"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""mode"" AS ""period_state"",""date"" AS ""start_date"",COALESCE(LEAD(""date"", 1) OVER (ORDER BY ""date"") - INTERVAL '1 DAY', (SELECT MAX(""date"") FROM ""alll"")) AS ""end_date"" FROM ""alll"" WHERE COALESCE(""daydiff"", 0)!=1 ORDER BY ""date"""
141,"WITH ""cte"" AS (SELECT ""fail_date"",DAYOFYEAR(""fail_date"") AS ""doy"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte1"" AS (SELECT ""success_date"",DAYOFYEAR(""success_date"") AS ""doy"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""fail"" AS (SELECT ""fail_date"",""doy""-""rn"" AS ""diff"" FROM ""cte""), ""succ"" AS (SELECT ""success_date"",""doy""-""rn"" AS ""diff"" FROM ""cte1"") SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""fail"" GROUP BY ""diff"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""succ"" GROUP BY ""diff"" ORDER BY ""start_date"""
142,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
143,"WITH ""cte_data"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""flg"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""flg"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""ordered_data"" AS (SELECT ""dt"",""flg"",""dt"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""flg"" ORDER BY ""dt"") DAY' AS ""dt_grp"" FROM ""cte_data"") SELECT ""flg"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""ordered_data"" GROUP BY ""dt_grp"",""period_state"" ORDER BY 2"
144,"WITH ""cte_union"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""st"" FROM ""failed"" UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""st"" FROM ""succeeded"") SELECT ""st"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT ""dt"",(""rn""-""rn_st"") AS ""diff"",""st"" FROM (SELECT ""dt"",ROW_NUMBER() OVER (ORDER BY ""dt"") AS ""rn"",ROW_NUMBER() OVER (PARTITION BY ""st"" ORDER BY ""dt"") AS ""rn_st"",""st"" FROM ""cte_union"" WHERE 1=1 AND SUBSTRING(""dt"", 1, 4)=2019) AS ""a"") AS ""b"" GROUP BY ""st"",""diff"" ORDER BY 2"
145,"SELECT ""result"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT 'failed' AS ""result"",""fail_date"" AS ""date"",RANK() OVER (ORDER BY ""fail_date"") AS ""date_rank"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""result"",""success_date"" AS ""date"",RANK() OVER (ORDER BY ""success_date"") AS ""date_rank"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""temp"" GROUP BY ""period_state"",""date"" + INTERVAL '-""date_rank"" DAY' ORDER BY ""start_date"""
146,"WITH ""all_records"" AS (SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""event_status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""fail_date"" AS ""event_date"",'failed' AS ""event_status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""event_grp_ranks"" AS (SELECT ""event_date"",""event_status"",(DENSE_RANK() OVER (ORDER BY ""event_date"")-DENSE_RANK() OVER (PARTITION BY ""event_status"" ORDER BY ""event_date"")) AS ""grp_num"" FROM ""all_records"" AS ""ar"" ORDER BY ""event_date"") SELECT ""event_status"" AS ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM ""event_grp_ranks"" GROUP BY ""event_status"",""grp_num"" ORDER BY ""start_date"""
147,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
148,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
149,"SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""state"",""day"",RANK() OVER (ORDER BY ""day"") AS ""overal_rnk"",RANK() OVER (ORDER BY ""day"")-""rnk"" AS ""inv"" FROM (SELECT 'failed' AS ""state"",""fail_date"" AS ""day"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""state"",""success_date"" AS ""day"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""inner_temp"") AS ""outer_temp"" GROUP BY ""inv"",1 ORDER BY 2"
150,"WITH ""a"" AS (SELECT ""fail_date"" AS ""log_date"",'failed' AS ""job_status"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION ALL SELECT ""success_date"" AS ""log_date"",'succeeded' AS ""job_status"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31'), ""b"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""job_status"" ORDER BY ""log_date"") AS ""row1"",ROW_NUMBER() OVER (ORDER BY ""log_date"") AS ""row2"" FROM ""a""), ""c"" AS (SELECT ""log_date"",""job_status"",""row1"",""row2"",""row2""-""row1"" AS ""rowdiff"" FROM ""b""), ""d"" AS (SELECT ""job_status"" AS ""period_state"",MIN(""log_date"") AS ""start_date"",MAX(""log_date"") AS ""end_date"" FROM ""c"" GROUP BY ""job_status"",""rowdiff"") SELECT * FROM ""d"""
151,"WITH ""main"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""ranking"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date"") AS ""globalRnk"",DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""localRnk"" FROM ""main"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""ranking"" GROUP BY ""period_state"",""globalRnk""-""localRnk"" ORDER BY ""start_date"",""globalRnk"""
152,"WITH ""cte1"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""period_state"",""date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""rnk1"",RANK() OVER (ORDER BY ""date"") AS ""rnk2"" FROM ""cte1"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY (""rnk2""-""rnk1""),1"
153,"WITH ""tab_fail_date"" AS (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""ref_date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""tab_suc_date"" AS (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""ref_date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""tab_fail_pivot"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""tab_fail_date"" GROUP BY ""ref_date""), ""tab_suc_pivot"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""tab_suc_date"" GROUP BY ""ref_date"") SELECT * FROM (SELECT * FROM ""tab_fail_pivot"" UNION SELECT * FROM ""tab_suc_pivot"") AS ""a"" ORDER BY ""a"".""start_date"""
154,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""stg"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY ""start_date"""
155,"WITH ""u"" AS (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""t"" AS (SELECT ""state"",""date"",LAG(""state"") OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"") OVER (ORDER BY ""date"") AS ""seq_state"" FROM ""u""), ""start_t"" AS (SELECT ""state"",""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""row_num"" FROM ""t"" WHERE ""pre_state""!=""state"" OR ""pre_state"" IS NULL), ""end_t"" AS (SELECT ""state"",""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""row_num"" FROM ""t"" WHERE ""seq_state""!=""state"" OR ""seq_state"" IS NULL) SELECT ""s"".""state"" AS ""period_state"",""s"".""date"" AS ""start_date"",""e"".""date"" AS ""end_date"" FROM ""start_t"" AS ""s"" JOIN ""end_t"" AS ""e"" ON ""s"".""row_num""=""e"".""row_num"" ORDER BY ""start_date"""
156,"SELECT * FROM ((SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",CASE WHEN ""success_date"" - @""prev""=1 THEN @""count"" ELSE @""count"":=@""count""+1 END AS ""num"",@""prev"":=""success_date"" FROM (""Succeeded"") CROSS JOIN (SELECT @""prev"":=NULL,@""count"":=0) AS ""i"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') AS ""t"" GROUP BY ""t"".""num"") UNION ALL (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",CASE WHEN ""fail_date"" - @""prev""=1 THEN @""count"" ELSE @""count"":=@""count""+1 END AS ""num"",@""prev"":=""fail_date"" FROM (""Failed"") CROSS JOIN (SELECT @""prev"":=NULL,@""count"":=0) AS ""i"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019') AS ""t"" GROUP BY ""t"".""num"")) AS ""t"" ORDER BY ""start_date"""
157,"WITH ""failed_states"" AS (SELECT DISTINCT ""period_state"",MIN(""fail_date"") OVER (PARTITION BY ""session_id"") AS ""start_date"",MAX(""fail_date"") OVER (PARTITION BY ""session_id"") AS ""end_date"" FROM (SELECT ""period_state"",""fail_date"",SUM(""session_id0"") OVER (ORDER BY ""fail_date"") AS ""session_id"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",CASE WHEN ""fail_date"" - LAG(""fail_date"") OVER (ORDER BY ""fail_date"")>1 THEN 1 ELSE 0 END AS ""session_id0"" FROM (SELECT * FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""t1"") AS ""t11"") AS ""t2""), ""success_states"" AS (SELECT DISTINCT ""period_state"",MIN(""success_date"") OVER (PARTITION BY ""session_id"") AS ""start_date"",MAX(""success_date"") OVER (PARTITION BY ""session_id"") AS ""end_date"" FROM (SELECT ""period_state"",""success_date"",SUM(""session_id0"") OVER (ORDER BY ""success_date"") AS ""session_id"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",CASE WHEN ""success_date"" - LAG(""success_date"") OVER (ORDER BY ""success_date"")>1 THEN 1 ELSE 0 END AS ""session_id0"" FROM (SELECT * FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t1"") AS ""t11"") AS ""t2"") SELECT * FROM (SELECT * FROM ""success_states"" UNION SELECT * FROM ""failed_states"") AS ""t0"" ORDER BY ""start_date"""
158,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"" FROM ""failed"" UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"" FROM ""succeeded""), ""cte2"" AS (SELECT ""day"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""day"") AS ""ranking"" FROM ""cte1"" WHERE ""day"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""cte2"" GROUP BY ""day"" - INTERVAL '""ranking"" DAY',""period_state"" ORDER BY ""start_date"""
159,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"",(CASE WHEN MIN(""fail_date"") THEN 'failed' ELSE 'failed' END) AS ""period_state"" FROM (SELECT ""fail_date"",""fail_date"" - INTERVAL '""rnkFailDate"" DAY' AS ""uniqueValueF"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnkFailDate"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""rnkFailDateTable"") AS ""finalTable"" GROUP BY ""uniqueValueF"" UNION ALL SELECT MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"",(CASE WHEN MIN(""success_date"") THEN 'succeeded' ELSE 'succeeded' END) AS ""period_state"" FROM (SELECT ""success_date"",""success_date"" - INTERVAL '""rnkSuccessDate"" DAY' AS ""uniqueValueS"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnkSuccessDate"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""rnkSucsseedDateTable"") AS ""finalTable"" GROUP BY ""uniqueValueS"") AS ""unionTable"" ORDER BY ""start_date"",""end_date"""
160,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
161,"SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_rank"",""state"",""day_rank"",RANK() OVER (ORDER BY ""day"")-""day_rank"" AS ""interv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""day_rank"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""day_rank"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY ""interv"",""state"" ORDER BY ""start_date"""
162,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
163,"SELECT * FROM (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",RANK() OVER (ORDER BY ""success_date"" DESC) AS ""rnk"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') AS ""t1"" GROUP BY ""success_date"" + INTERVAL '""rnk"" DAY' UNION SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",RANK() OVER (ORDER BY ""fail_date"" DESC) AS ""rnk"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019') AS ""t1"" GROUP BY ""fail_date"" + INTERVAL '""rnk"" DAY') AS ""t3"" ORDER BY ""start_date"""
164,"WITH ""un"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date1"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date1"" FROM ""Succeeded""), ""flags"" AS (SELECT ""period_state"",""date1"",DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""flag"" FROM ""un"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""flags"" GROUP BY ""period_state"",""flag"" ORDER BY MIN(""date1"")"
165,"WITH ""f"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""ingroup_ranking"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<'2020-01-01'), ""s"" AS (SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""ingroup_ranking"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<'2020-01-01'), ""fs"" AS (SELECT *,RANK() OVER (ORDER BY ""dt"") AS ""over_all_ranking"" FROM (SELECT * FROM ""s"" UNION ALL SELECT * FROM ""f"") AS ""tmp"" ORDER BY ""dt""), ""ffs"" AS (SELECT *,(""over_all_ranking""-""ingroup_ranking"") AS ""diff_group"" FROM ""fs"") SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""ffs"" GROUP BY ""diff_group"",""period_state"" ORDER BY ""start_date"""
166,"WITH ""cte_data"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""flg"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""flg"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""ordered_data"" AS (SELECT ""dt"",""flg"",""dt"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""flg"" ORDER BY ""dt"") DAY' AS ""dt_grp"" FROM ""cte_data"") SELECT ""flg"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""ordered_data"" GROUP BY ""dt_grp"",""period_state"" ORDER BY 2"
167,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",DENSE_RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(DENSE_RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
168,"WITH ""result"" AS (SELECT ""fail_date"" AS ""dates"",'failed' AS ""state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""state"" AS ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM ""result"" GROUP BY ""dates"" - INTERVAL '""rnk"" DAY',""state"" ORDER BY ""start_date"""
169,"WITH ""t"" (""dateval"", ""state"") AS (SELECT ""fail_date"",'failed' FROM ""Failed"" UNION ALL SELECT ""success_date"",'succeeded' FROM ""Succeeded"") SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""Prevstate"" IS NULL OR ""prevstate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""prevstate"" FROM ""t"" WHERE ""dateval"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t2"""
170,"SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
171,"WITH ""cte"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""rnk1"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rnk2"" FROM ""cte"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""period_state"",""rnk2""-""rnk1"""
172,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""state"" FROM ""Failed""), ""cte2"" AS (SELECT ""success_date"" AS ""dt"",'succeeded' AS ""state"" FROM ""Succeeded""), ""cte3"" AS (SELECT * FROM ""cte1"" UNION SELECT * FROM ""cte2""), ""cte4"" AS (SELECT * FROM ""cte3"" WHERE ""dt"">=DATE('2019-01-01') AND ""dt""<=DATE('2019-12-31') ORDER BY ""dt""), ""cte5"" AS (SELECT *,LAG(""state"") OVER () AS ""next_state"" FROM ""cte4""), ""cte6"" AS (SELECT *,CASE WHEN ""state""=""next_state"" THEN 0 ELSE 1 END AS ""Ind"" FROM ""cte5""), ""cte7"" AS (SELECT *,SUM(""ind"") OVER (ORDER BY ""dt"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cat"" FROM ""cte6"") SELECT MAX(""state"") AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""cte7"" GROUP BY ""cat"""
173,"SELECT ""state"" AS ""period_state"",""date"" AS ""start_date"",CASE WHEN ""next_state"" IS NULL OR (""state""!=""pre_state"" AND ""state""!=""next_state"") OR (""pre_state"" IS NULL AND ""state""!=""next_state"") THEN ""date"" ELSE ""next_date"" END AS ""end_date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"",LAG(""date"", 1) OVER (ORDER BY ""date"") AS ""pre_date"",LEAD(""date"", 1) OVER (ORDER BY ""date"") AS ""next_date"" FROM (SELECT ""state"",""date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"" FROM (SELECT * FROM (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"") AS ""combined1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date"") AS ""combined2"") AS ""combined3"" WHERE ""state""!=""pre_state"" OR ""state""!=""next_state"" OR ""pre_state"" IS NULL OR ""next_state"" IS NULL) AS ""combined4"") AS ""combined5"" WHERE (""pre_state"" IS NULL AND ""state""!=""next_state"") OR (""next_state"" IS NULL AND ""state""!=""pre_state"") OR ""state""=""next_state"" OR (""state""!=""pre_state"" AND ""state""!=""next_state"")"
174,"WITH ""t"" (""dateval"", ""state"") AS (SELECT ""fail_date"",'failed' FROM ""Failed"" UNION ALL SELECT ""success_date"",'succeeded' FROM ""Succeeded"") SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""Prevstate"" IS NULL OR ""prevstate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""prevstate"" FROM ""t"" WHERE ""dateval"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t2"""
175,"WITH ""combined"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""period_group"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""period_group"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""combined"" GROUP BY ""period_state"",""period_group"" ORDER BY ""start_date"""
176,"WITH ""tmp"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dateid"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dateid"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""tmp2"" AS (SELECT ""period_state"",""dateid"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""dateid"") AS ""row1"",ROW_NUMBER() OVER (ORDER BY ""dateid"") AS ""row2"" FROM ""tmp"") SELECT ""period_state"",MIN(""dateid"") AS ""start_date"",MAX(""dateid"") AS ""end_date"" FROM ""tmp2"" GROUP BY ""period_state"",""row2""-""row1"""
177,"SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""laststate"" IS NULL OR ""laststate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""laststate"" FROM (SELECT ""fail_date"" AS ""dateval"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION ALL SELECT ""success_date"" AS ""dateval"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t"") AS ""t1"") AS ""t2"""
178,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""rnk"",""period_state"",RANK() OVER (ORDER BY ""day"") AS ""overall_rnk"",(RANK() OVER (ORDER BY ""day"")-""rnk"") AS ""dif"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY ""dif"",""period_state"" ORDER BY MIN(""day"")"
179,"WITH ""cte"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT 'failed' AS ""period_state"",""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte"" GROUP BY ""period_state"",DAYOFYEAR(""success_date"")-""rnk"" UNION ALL SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""period_state"",DAYOFYEAR(""fail_date"")-""rnk"" ORDER BY 2"
180,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
181,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""stats"",""rk"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",RANK() OVER (ORDER BY ""day"")-""rk"" AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""stats"",""inv"" ORDER BY ""start_date"""
182,"WITH ""date_tbl"" AS (SELECT * FROM ""failed"" UNION SELECT * FROM ""succeeded"" ORDER BY ""fail_date""), ""date_status"" AS (SELECT ""fail_date"" AS ""all_date"",CASE WHEN ""fail_date"" IN (SELECT * FROM ""failed"") THEN 'failed' ELSE 'succeeded' END AS ""stat"" FROM ""date_tbl"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
183,"SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
184,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""period_state"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""period_state"" ORDER BY ""start_date"""
185,"WITH ""t"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""dates"",'failed' AS ""period_state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""period_state"" FROM ""Succeeded"") AS ""t0"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""dates"") SELECT * FROM (SELECT ""period_state"",""start_date"",CASE WHEN ""end_date"" IS NULL THEN LEAD(""end_date"") OVER (ORDER BY ""dates"") ELSE ""end_date"" END AS ""end_date"" FROM (SELECT ""period_state"",""dates"",CASE WHEN ""start_date""=1 THEN ""dates"" ELSE NULL END AS ""start_date"",CASE WHEN ""end_date""=1 THEN ""dates"" ELSE NULL END AS ""end_date"" FROM (SELECT ""period_state"",""dates"",CASE WHEN ""period_state""!=COALESCE(LAG(""period_state"") OVER (ORDER BY ""dates""), '') THEN 1 ELSE 0 END AS ""start_date"",CASE WHEN ""period_state""!=COALESCE(LEAD(""period_state"") OVER (ORDER BY ""dates""), '') THEN 1 ELSE 0 END AS ""end_date"" FROM ""t"") AS ""t1"" WHERE ""start_date""=1 OR ""end_date""=1 ORDER BY ""dates"") AS ""t2"") AS ""t3"" WHERE ""start_date"" IS NOT NULL"
186,"WITH ""temp"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp1"" AS (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_rnk"",""stats"",""rnk"",(RANK() OVER (ORDER BY ""day"")-""rnk"") AS ""intervals"" FROM ""temp"") SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""temp1"" GROUP BY ""intervals"",""stats"" ORDER BY ""start_date"""
187,"WITH ""cte"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""cte2"" AS (SELECT ""period_state"",""start_date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""start_date"") AS ""rank1"",RANK() OVER (ORDER BY ""start_date"") AS ""rank2"" FROM ""cte"") SELECT ""period_state"",MIN(""start_date"") AS ""start_date"",MAX(""start_date"") AS ""end_date"" FROM ""cte2"" GROUP BY 1,(""rank2""-""rank1"")"
188,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""overall_rk"",((ROW_NUMBER() OVER (ORDER BY ""date""))-""rk"") AS ""inte"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" UNION (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"")) AS ""a"") AS ""c"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""inte"" ORDER BY ""start_date"",""period_state"""
189,"WITH ""t1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""t2"" AS (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rnk"",RANK() OVER (ORDER BY ""day"")-""rnk"" AS ""inv"" FROM ""t1"") SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""t2"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
190,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
191,"SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"") AS ""A"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31' GROUP BY ""success_date"" - INTERVAL '""ranking"" DAY' UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"") AS ""C"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' GROUP BY ""fail_date"" - INTERVAL '""ranking"" DAY' ORDER BY ""start_date"""
192,"WITH ""cte1"" AS (SELECT ""fail_date"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""agg_date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""success_date"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""agg_date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT * FROM (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""agg_date"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte1"" GROUP BY ""agg_date"") AS ""a"" ORDER BY ""start_date"""
193,"WITH ""s"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"",(SELECT MIN(""success_date"") FROM ""succeeded"" WHERE ""success_date"" BETWEEN CAST('2019-01-01' AS DATE) AND CAST('2019-12-31' AS DATE)) + INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"")-1 DAY' AS ""seq_date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN CAST('2019-01-01' AS DATE) AND CAST('2019-12-31' AS DATE) ORDER BY 1,2), ""f"" AS (SELECT 'failed' AS ""period_state"",""fail_date"",(SELECT MIN(""fail_date"") FROM ""failed"" WHERE ""fail_date"" BETWEEN CAST('2019-01-01' AS DATE) AND CAST('2019-12-31' AS DATE)) + INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"")-1 DAY' AS ""seq_date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN CAST('2019-01-01' AS DATE) AND CAST('2019-12-31' AS DATE) ORDER BY 1,2) SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""s"" GROUP BY ""success_date"" - ""seq_date"" UNION SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""f"" GROUP BY ""fail_date"" - ""seq_date"" ORDER BY 2"
194,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
195,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
196,"SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""state"",""gr"",RANK() OVER (ORDER BY ""day"")-""gr"" AS ""rd"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""gr"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""gr"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""c"" ORDER BY ""day"") AS ""temp"" GROUP BY ""state"",""rd"" ORDER BY ""start_date"""
197,"WITH ""f"" AS (SELECT ""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""s"" AS (SELECT ""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""f"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY' UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""s"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY' ORDER BY ""start_date"""
198,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"" FROM ""failed"" UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"" FROM ""succeeded""), ""cte2"" AS (SELECT ""day"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""day"") AS ""ranking"" FROM ""cte1"" WHERE ""day"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""cte2"" GROUP BY ""day"" - INTERVAL '""ranking"" DAY',""period_state"" ORDER BY ""start_date"""
199,"SELECT ""period_state"",MIN(""temp_date"") AS ""start_date"",MAX(""temp_date"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""temp_date"",ROW_NUMBER() OVER () AS ""row_num"",'failed' AS ""period_state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""temp_date"",ROW_NUMBER() OVER () AS ""row_num"",'succeeded' AS ""period_state"" FROM ""Succeeded"") AS ""a"" WHERE ""temp_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY EXTRACT(EPOCH FROM ""temp_date"")-""row_num"",""period_state"" ORDER BY ""start_date"""
200,"SELECT * FROM (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t"" GROUP BY (EXTRACT(EPOCH FROM ""success_date"")-""ranking"") UNION SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""u"" GROUP BY (EXTRACT(EPOCH FROM ""fail_date"")-""ranking"")) AS ""v"" ORDER BY ""start_date"""
201,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""dates"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded""), ""cte2"" AS (SELECT ""dates"",""stats"" AS ""period_state"",RANK() OVER (ORDER BY ""dates"") AS ""overall_rk"",""rk"",(RANK() OVER (ORDER BY ""dates"")-""rk"") AS ""inv"" FROM ""cte1"") SELECT ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM ""cte2"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""inv"" ORDER BY 2"
202,"WITH ""CTE1"" AS (SELECT ""FAIL_DATE"" AS ""PERIOD"",'failed' AS ""PERIOD_STATE"" FROM ""FAILED"" WHERE ""FAIL_DATE"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""SUCCESS_DATE"" AS ""PERIOD"",'succeeded' AS ""PERIOD_STATE"" FROM ""SUCCEEDED"" WHERE ""SUCCESS_DATE"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""PERIOD""), ""CTE2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""PERIOD_STATE"" ORDER BY ""PERIOD"") AS ""RNO"" FROM ""CTE1"" ORDER BY ""PERIOD""), ""CTE3"" AS (SELECT ""PERIOD_STATE"",""PERIOD"" AS ""START_DATE"",COUNT(1) AS ""CNT"" FROM ""CTE2"" GROUP BY ""PERIOD_STATE"",""PERIOD"" - INTERVAL '""RNO"" DAY') SELECT ""PERIOD_STATE"",""START_DATE"",""START_DATE"" + INTERVAL '""CNT""-1 DAY' AS ""END_DATE"" FROM ""CTE3"""
203,"WITH ""t"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""row_num"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""row_num"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""t"" GROUP BY ""day"" + INTERVAL '-""row_num"" DAY',""period_state"" ORDER BY ""start_date"""
204,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ((SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""grp"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) UNION ALL (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""grp"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019)) AS ""a"" GROUP BY ""period_state"",""grp"" ORDER BY ""start_date"""
205,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""period_state"",""rnk"",DENSE_RANK() OVER (ORDER BY ""day"")-""rnk"" AS ""itv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""t2"" GROUP BY ""itv"",""period_state"""
206,"WITH ""CTE_STATES"" AS (SELECT ""fail_date"" AS ""RDate"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""RDate"",'succeeded' AS ""state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"") SELECT ""state"" AS ""period_state"",MIN(""rdate"") AS ""start_date"",MAX(""rdate"") AS ""end_date"" FROM ""CTE_STATES"" WHERE EXTRACT(YEAR FROM ""RDate"")='2019' GROUP BY ""state"",EXTRACT(EPOCH FROM ""rdate"")-""rnk"" ORDER BY 2"
207,"WITH ""comb"" AS (SELECT ""fail_Date"" AS ""dates"",'failed' AS ""state"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dates"",'succeeded' AS ""state"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp"" AS (SELECT ""dates"",""state"",""row_num"",RANK() OVER (PARTITION BY ""state"" ORDER BY ""dates"") AS ""sub_rank_num"" FROM (SELECT ""dates"",""state"",RANK() OVER (ORDER BY ""dates"") AS ""row_num"" FROM ""comb"") AS ""cte"") SELECT ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM (SELECT ""state"" AS ""period_state"",""dates"",FORMAT(""sub_rank_num"", 'float')-FORMAT(""row_num"", 'float') AS ""grps"" FROM ""temp"") AS ""cte"" GROUP BY ""grps"",""period_state"" ORDER BY 2,3"
208,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""succeeded""), ""cte2"" AS (SELECT * FROM ""cte1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte3"" AS (SELECT ""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rn"",LAG(""status"", 1) OVER (ORDER BY ""date"") AS ""prev_status"",""status"",LEAD(""status"", 1) OVER (ORDER BY ""date"") AS ""next_status"" FROM ""cte2""), ""cte4"" AS (SELECT COUNT(1) AS ""max_rn"" FROM ""cte3""), ""cte5"" AS (SELECT ""status"" AS ""period_state"",CASE WHEN ""status""!=""prev_status"" OR ""rn""=1 THEN ""date"" END AS ""start_date"",CASE WHEN ""status""!=""next_status"" OR ""rn""=""max_rn"" THEN ""date"" END AS ""end_date"" FROM ""cte3"" CROSS JOIN ""cte4""), ""cte6"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""rn"",""period_state"" FROM ""cte5"" WHERE ""start_date"" IS NOT NULL), ""cte7"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""rn"",""start_date"" FROM ""cte5"" WHERE ""start_date"" IS NOT NULL), ""cte8"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""end_date"") AS ""rn"",""end_date"" FROM ""cte5"" WHERE ""end_date"" IS NOT NULL) SELECT ""period_state"",""start_date"",""end_date"" FROM (""cte6"" JOIN ""cte7"" ON ""cte6"".""rn""=""cte7"".""rn"") JOIN ""cte8"" ON ""cte7"".""rn""=""cte8"".""rn"""
209,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
210,"WITH ""cte1"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""status1"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""status1"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date1"") AS ""rn1"",RANK() OVER (PARTITION BY ""status1"" ORDER BY ""date1"") AS ""rn2"" FROM ""cte1"") SELECT ""status1"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""cte2"" GROUP BY ""status1"",""rn1""-""rn2"" ORDER BY 2"
211,"WITH ""f"" AS (SELECT ""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"",DAYOFYEAR(""fail_date"") AS ""days"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019'), ""s"" AS (SELECT ""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""ranking"",DAYOFYEAR(""success_date"") AS ""days"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_Date"")=2019) SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""f"" GROUP BY ""days""-""ranking"" UNION ALL SELECT 'succeeded',MIN(""success_date""),MAX(""success_date"") FROM ""s"" GROUP BY ""days""-""ranking"" ORDER BY 2"
212,"WITH ""temp1"" AS (SELECT LAG(""fail_date"") OVER () AS ""pre_date"",""fail_date"",LEAD(""fail_date"") OVER () AS ""post_date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp2"" AS (SELECT LAG(""success_date"") OVER () AS ""pre_date"",""success_date"",LEAD(""success_date"") OVER () AS ""post_date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT * FROM (SELECT ""AA"".""period_state"",""start_date"",""end_date"" FROM (SELECT ROW_NUMBER() OVER () AS ""id"",""period_state"",""start_date"" FROM (SELECT 'failed' AS ""period_state"",CASE WHEN ""pre_date"" IS NULL OR ""fail_date"" - ""pre_date"">1 THEN ""fail_date"" ELSE 0 END AS ""start_date"" FROM ""temp1"") AS ""A"" WHERE ""start_date""!=0) AS ""AA"" LEFT JOIN (SELECT ROW_NUMBER() OVER () AS ""id"",""period_state"",""end_date"" FROM (SELECT 'failed' AS ""period_state"",CASE WHEN ""post_date"" IS NULL OR ""post_date"" - ""fail_date"">1 THEN ""fail_date"" ELSE 0 END AS ""end_date"" FROM ""temp1"") AS ""B"" WHERE ""end_date""!=0) AS ""BB"" ON ""AA"".""id""=""BB"".""id"" UNION ALL SELECT ""AA"".""period_state"",""start_date"",""end_date"" FROM (SELECT ROW_NUMBER() OVER () AS ""id"",""period_state"",""start_date"" FROM (SELECT 'succeeded' AS ""period_state"",CASE WHEN ""pre_date"" IS NULL OR ""success_date"" - ""pre_date"">1 THEN ""success_date"" ELSE 0 END AS ""start_date"" FROM ""temp2"") AS ""A"" WHERE ""start_date""!=0) AS ""AA"" LEFT JOIN (SELECT ROW_NUMBER() OVER () AS ""id"",""period_state"",""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",CASE WHEN ""post_date"" IS NULL OR ""post_date"" - ""success_date"">1 THEN ""success_date"" ELSE 0 END AS ""end_date"" FROM ""temp2"") AS ""B"" WHERE ""end_date""!=0) AS ""BB"" ON ""AA"".""id""=""BB"".""id"") AS ""result"" ORDER BY ""start_date"""
213,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
214,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""b"" GROUP BY ""day"" - INTERVAL '""rn"" DAY',""period_state"" ORDER BY ""start_date"""
215,"WITH ""CTE"" AS (SELECT ""fail_date"" AS ""event_date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) SELECT ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM (SELECT ""period_state"",""event_date"",""event_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""event_date"") DAY' AS ""RK"" FROM ""CTE"") AS ""T"" GROUP BY ""period_state"",""RK"" ORDER BY 2"
216,"WITH ""t1"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""sdrank"" FROM ""succeeded"" WHERE ""success_date"" LIKE '2019%'), ""t2"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""t1"" GROUP BY ""success_date"" - INTERVAL '""sdrank"" DAY'), ""t3"" AS (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""fdrank"" FROM ""failed"" WHERE ""fail_date"" LIKE '2019%'), ""t4"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""t3"" GROUP BY ""fail_date"" - INTERVAL '""fdrank"" DAY') SELECT ""period_state"",""start_date"",""end_date"" FROM ""t2"" UNION SELECT ""period_state"",""start_date"",""end_date"" FROM ""t4"" ORDER BY ""start_date"""
217,"WITH ""cte1"" AS (SELECT 'failed' AS ""status"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""status"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"") AS ""rn1"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""rn2"" FROM ""cte1"" ORDER BY ""date"") SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""status"",""rn1""-""rn2"" ORDER BY ""start_date"""
218,"WITH ""a"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""status"",RANK() OVER (ORDER BY ""fail_date"") AS ""inter"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""status"",RANK() OVER (ORDER BY ""success_date"") AS ""inter"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""day"") SELECT ""status"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""status"",RANK() OVER (ORDER BY ""day"") AS ""external"",""inter"",(RANK() OVER (ORDER BY ""day"")-""inter"") AS ""diff"" FROM ""a"") AS ""t"" GROUP BY ""diff"",""status"" ORDER BY ""start_date"""
219,"WITH ""events_tall"" AS ((SELECT ""fail_date"" AS ""event_date"",'failed' AS ""period_state"" FROM ""Failed"") UNION (SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""period_state"" FROM ""Succeeded"")), ""events_filtered"" AS (SELECT ""period_state"",""event_date"" FROM ""events_tall"" WHERE (""event_date"">='2019-01-01') AND (""event_date""<='2019-12-31')), ""event_runs"" AS (SELECT ""period_state"",""event_date"",ROW_NUMBER() OVER (ORDER BY ""event_date"") AS ""rk1"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""event_date"") AS ""rk2"" FROM ""events_filtered"" ORDER BY ""event_date"") SELECT ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM ""event_runs"" GROUP BY ""rk1""-""rk2"",""period_state"""
220,"WITH ""tmp1"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" + INTERVAL '-ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""grp"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""fail_date"") AS ""ina"" GROUP BY ""grp""), ""tmp2"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" + INTERVAL '-ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""grp"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""success_date"") AS ""ina"" GROUP BY ""grp"") SELECT * FROM ""tmp1"" UNION SELECT * FROM ""tmp2"" ORDER BY ""start_date"""
221,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
222,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""dates"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded""), ""cte2"" AS (SELECT ""dates"",""stats"" AS ""period_state"",RANK() OVER (ORDER BY ""dates"") AS ""overall_rk"",""rk"",(RANK() OVER (ORDER BY ""dates"")-""rk"") AS ""inv"" FROM ""cte1"") SELECT ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM ""cte2"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""inv"" ORDER BY 2"
223,"WITH ""CTE"" AS (SELECT ""fail_date"" AS ""event_date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) SELECT ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM (SELECT ""period_state"",""event_date"",""event_date"" + INTERVAL '(-ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""event_date"")) DAY' AS ""RK"" FROM ""CTE"") AS ""T"" GROUP BY ""period_state"",""RK"" ORDER BY 2"
224,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
225,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""stats"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
226,"WITH ""date_tbl"" AS (SELECT * FROM ""failed"" UNION SELECT * FROM ""succeeded"" ORDER BY ""fail_date""), ""date_status"" AS (SELECT ""fail_date"" AS ""all_date"",CASE WHEN ""fail_date"" IN (SELECT * FROM ""failed"") THEN 'failed' ELSE 'succeeded' END AS ""stat"" FROM ""date_tbl"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
227,"SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""temp"".*,RANK() OVER (ORDER BY ""date"") AS ""all_rk"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" ORDER BY ""date"") AS ""temp"" WHERE ""date"">='2019-01-01' AND ""date""<='2019-12-31') AS ""r"" GROUP BY ""state"",CAST(""all_rk"" AS INTEGER)-CAST(""rk"" AS INTEGER)"
228,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
229,"SELECT ""status"" AS ""period_state"",MIN(""task_dt"") AS ""start_date"",MAX(""task_dt"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""task_dt"") AS ""rn"" FROM (SELECT ""fail_date"" AS ""task_dt"",'failed' AS ""status"" FROM ""FAILED"") AS ""tb1"" WHERE ""task_dt"">='2019-01-01' AND ""task_dt""<='2019-12-31') AS ""tb2"" GROUP BY ""task_dt"" + INTERVAL '-""rn"" DAY' UNION (SELECT ""status"" AS ""period_state"",MIN(""task_dt"") AS ""start_date"",MAX(""task_dt"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""task_dt"") AS ""rn"" FROM (SELECT ""success_date"" AS ""task_dt"",'succeeded' AS ""status"" FROM ""Succeeded"") AS ""tb3"" WHERE ""task_dt"">='2019-01-01' AND ""task_dt""<='2019-12-31') AS ""tb4"" GROUP BY ""task_dt"" + INTERVAL '-""rn"" DAY') ORDER BY ""start_date"""
230,"WITH ""day_status"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"" ORDER BY ""day""), ""t"" AS (SELECT ""day"",""period_state"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""day"") AS ""rnk"",RANK() OVER (ORDER BY ""day"") AS ""id"" FROM ""day_status"") SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""t"" GROUP BY 1,(""id""-""rnk"") ORDER BY 2"
231,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"") SELECT ""period_state"",""start_date"",""start_date"" + INTERVAL '""days""-1 DAY' AS ""end_date"" FROM (SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",COUNT(1) AS ""days"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"")-ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""row_diff"" FROM ""cte"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"" GROUP BY ""state"",""row_diff"") AS ""a"" ORDER BY ""start_date"""
232,"WITH ""tb1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""tb2"" AS (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",RANK() OVER (ORDER BY ""day"")-""rk"" AS ""inv"" FROM ""tb1"") SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""tb2"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
233,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
234,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
235,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"")-ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""row_diff"" FROM ""cte"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"" GROUP BY ""state"",""row_diff"" ORDER BY ""start_date"""
236,"SELECT ""state"" AS ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM (SELECT ""event_date"",""state"",""rnk"",RANK() OVER (ORDER BY ""event_date"")-""rnk"" AS ""rem"" FROM (SELECT ""fail_date"" AS ""event_date"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY ""state"",""rem"""
237,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",DENSE_RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(DENSE_RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
238,"WITH ""status_change"" AS (SELECT ""status"",""dt"" - INTERVAL '""num"" DAY',MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT 'failed' AS ""status"",""fail_date"" AS ""dt"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""num"" FROM ""Failed"" AS ""a"" WHERE ""fail_date"" BETWEEN STR_TO_DATE('2019-01-01', '%Y-%m-%d') AND STR_TO_DATE('2019-12-31', '%Y-%m-%d')) AS ""a"" GROUP BY 1,2 UNION SELECT ""status"",""dt"" - INTERVAL '""num"" DAY',MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""status"",""success_Date"" AS ""dt"",ROW_NUMBER() OVER (ORDER BY ""success_Date"") AS ""num"" FROM ""Succeeded"" AS ""a"" WHERE ""success_Date"" BETWEEN STR_TO_DATE('2019-01-01', '%Y-%m-%d') AND STR_TO_DATE('2019-12-31', '%Y-%m-%d')) AS ""a"" GROUP BY 1,2) SELECT ""status"" AS ""period_state"",""start_date"",""end_date"" FROM ""status_change"" ORDER BY ""start_Date"""
239,"WITH ""TEMP"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""TEMP2"" AS (SELECT ""state"",""date"",DENSE_RANK() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""RANK"",""date"" - INTERVAL 'DENSE_RANK() OVER (PARTITION BY ""state"" ORDER BY ""date"") DAY' AS ""diff"" FROM ""TEMP"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""TEMP2"" GROUP BY 1,""TEMP2"".""diff"" ORDER BY 2"
240,"WITH ""CTE1"" AS (SELECT ""FAIL_DATE"" AS ""PERIOD"",'failed' AS ""PERIOD_STATE"" FROM ""FAILED"" WHERE ""FAIL_DATE"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""SUCCESS_DATE"" AS ""PERIOD"",'succeeded' AS ""PERIOD_STATE"" FROM ""SUCCEEDED"" WHERE ""SUCCESS_DATE"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""PERIOD""), ""CTE2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""PERIOD_STATE"" ORDER BY ""PERIOD"") AS ""RNO"" FROM ""CTE1"" ORDER BY ""PERIOD""), ""CTE3"" AS (SELECT ""PERIOD_STATE"",""PERIOD"" AS ""START_DATE"",COUNT(1) AS ""CNT"" FROM ""CTE2"" GROUP BY ""PERIOD_STATE"",""PERIOD"" - INTERVAL '""RNO"" DAY') SELECT ""PERIOD_STATE"",""START_DATE"",""START_DATE"" + INTERVAL '""CNT""-1 DAY' AS ""END_DATE"" FROM ""CTE3"""
241,"WITH ""dates"" AS (SELECT ""fail_date"" AS ""state_date"",DAYOFYEAR(""fail_date"") AS ""state_doy"",ROW_NUMBER() OVER (ORDER BY DAYOFYEAR(""fail_date"")) AS ""rn"",'failed' AS ""state"" FROM ""failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION ALL SELECT ""success_date"" AS ""state_date"",DAYOFYEAR(""success_date"") AS ""state_doy"",ROW_NUMBER() OVER (ORDER BY DAYOFYEAR(""success_date"")) AS ""rn"",'succeeded' AS ""state"" FROM ""succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31'), ""diffs"" AS (SELECT ""state"",""state_date"",""state_doy""-""rn"" AS ""diff"" FROM ""dates"") SELECT ""state"" AS ""period_state"",MIN(""state_date"") AS ""start_date"",MAX(""state_date"") AS ""end_date"" FROM ""diffs"" GROUP BY ""state"",""diff"" ORDER BY ""start_date"""
242,"SELECT * FROM (SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""period_state"",""day"",(CASE WHEN ""period_state""='failed' THEN ROW_NUMBER() OVER (ORDER BY ""day"")-""rf"" ELSE ROW_NUMBER() OVER (ORDER BY ""day"")-""rs"" END) AS ""dd"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rf"",NULL AS ""rs"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",NULL AS ""rf"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rs"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""a"") AS ""b"" GROUP BY ""period_state"",""dd"") AS ""c"" ORDER BY ""start_date"""
243,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""stg"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY ""start_date"""
244,"WITH ""combined"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""period_group"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""period_group"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""combined"" GROUP BY ""period_state"",""period_group"" ORDER BY ""start_date"""
245,"SELECT 'failed' AS ""period_state"",""start_date"",""end_date"" FROM (SELECT MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"",""fail_date"" - INTERVAL '""diff"" DAY' AS ""anchor"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""diff"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""sub_failed"" GROUP BY ""anchor"") AS ""formatted_failed"" UNION ALL SELECT 'succeeded' AS ""period_state"",""start_date"",""end_date"" FROM (SELECT MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"",""success_date"" - INTERVAL '""diff"" DAY' AS ""anchor"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""diff"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""sub_succeeded"" GROUP BY ""anchor"") AS ""formatted_successes"" ORDER BY ""start_date"""
246,"SELECT 'succeeded' AS ""period_state"",MIN(""id"") AS ""start_date"",MAX(""id"") AS ""end_date"" FROM (SELECT DATE(""success_date"") AS ""id"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""row_num"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') AS ""t1"" GROUP BY ""id"" - INTERVAL '""row_num"" DAY' UNION ALL SELECT 'failed' AS ""period_state"",MIN(""id"") AS ""start_date"",MAX(""id"") AS ""end_date"" FROM (SELECT DATE(""fail_date"") AS ""id"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""row_num"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019') AS ""t2"" GROUP BY ""id"" - INTERVAL '""row_num"" DAY' ORDER BY ""start_date"""
247,"WITH ""temp"" AS (SELECT 'failed' AS ""period_state"",""fail_date"",DAYOFYEAR(""fail_date"") AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"",DAYOFYEAR(""success_date"") AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""temp"" GROUP BY ""period_state"",""day""-""r"" ORDER BY 2"
248,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""ddate"",'failed' AS ""state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION SELECT ""success_date"" AS ""ddate"",'succeeded' AS ""state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) SELECT ""state"" AS ""period_state"",MIN(""ddate"") AS ""start_date"",MAX(""ddate"") AS ""end_date"" FROM (SELECT ""ddate"",""state"",""ddate"" - INTERVAL 'RANK() OVER (PARTITION BY ""state"" ORDER BY ""ddate"") DAY' AS ""ggroup"" FROM ""cte"") AS ""f"" GROUP BY ""state"",""ggroup"" ORDER BY 3"
249,"WITH ""t1"" AS (SELECT ""fail_date"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""p1"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""t2"" AS (SELECT ""success_date"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""p2"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""t1"" GROUP BY ""p1"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""t2"" GROUP BY ""p2"" ORDER BY ""start_date"""
250,"WITH ""unioned_table"" AS (SELECT ""fail_date"" AS ""record_date"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""record_date"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""ranked_unioned_table"" AS (SELECT *,RANK() OVER (ORDER BY ""record_date"") AS ""all_rk"",(RANK() OVER (ORDER BY ""record_date"")-""rk"") AS ""rank_diff"" FROM ""unioned_table"") SELECT ""state"" AS ""period_state"",MIN(""record_date"") AS ""start_date"",MAX(""record_date"") AS ""end_date"" FROM ""ranked_unioned_table"" GROUP BY ""rank_diff"",""state"" ORDER BY ""start_date"""
251,"SELECT * FROM (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",@""rank"":=CASE WHEN @""placehold""=""fail_date"" - INTERVAL '1 DAY' THEN @""rank"" ELSE @""rank""+1 END AS ""r"",@""placehold"":=""fail_date"" FROM (SELECT * FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""fail_date"") AS ""temp"" CROSS, (SELECT @""rank"":=0,@""placehold"":='') AS ""intr"") AS ""temp2"" GROUP BY ""r"" UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",@""rank2"":=CASE WHEN @""placehold2""=""success_date"" - INTERVAL '1 DAY' THEN @""rank2"" ELSE @""rank2""+1 END AS ""r2"",@""placehold2"":=""success_date"" FROM (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""success_date"") AS ""temp"" CROSS, (SELECT @""rank2"":=0,@""placehold2"":='') AS ""intr"") AS ""temp2"" GROUP BY ""r2"") AS ""main"" ORDER BY ""start_date"""
252,"WITH ""x"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rownum"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rownum"" FROM ""Succeeded"") SELECT ""period_state"",MIN(""date_x"") AS ""start_date"",MAX(""date_x"") AS ""end_date"" FROM ""x"" WHERE ""date_x"" LIKE '2019%' GROUP BY 1,""date_x"" - INTERVAL '""rownum"" DAY' ORDER BY 2"
253,"WITH ""cte_Succeded_Failed"" AS (SELECT 'failed' AS ""period_state"",""Fail_date"" AS ""Day"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""Fail_date"")='2019' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""Day"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') SELECT ""period_state"",MIN(""Day"") AS ""start_date"",MAX(""Day"") AS ""end_date"" FROM ""cte_Succeded_Failed"" GROUP BY ""period_state"",""Day"" - INTERVAL '""ranking"" DAY' ORDER BY 2"
254,"SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_rk"",""state"",""rk"",RANK() OVER (ORDER BY ""day"")-""rk"" AS ""diff"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""t1"") AS ""t2"" GROUP BY ""diff"",""state"" ORDER BY ""start_date"""
255,"WITH ""main"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
256,"SELECT CASE WHEN ""checker""=1 THEN 'succeeded' ELSE 'failed' END AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""checker"",EXTRACT(EPOCH FROM ""date"")-""checker""*365-RANK() OVER (PARTITION BY ""checker"" ORDER BY ""date"") AS ""tracker"" FROM (SELECT ""fail_date"" AS ""date"",0 AS ""checker"" FROM ""failed"" UNION SELECT ""success_date"" AS ""date"",1 AS ""checker"" FROM ""succeeded"" ORDER BY ""date"") AS ""temp"" WHERE ""date"">='2019-01-01' AND ""date""<='2019-12-31' ORDER BY ""date"") AS ""d"" GROUP BY ""tracker"""
257,"WITH ""cte"" AS (SELECT ""success_date"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""nxt"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""fail_date"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""nxt"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte3"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte"" GROUP BY ""nxt"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""nxt"") SELECT * FROM ""cte3"" ORDER BY ""start_date"""
258,"WITH ""CTE"" (""day"", ""state"", ""rk"") AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_rk"",""state"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM ""CTE"") AS ""A"" GROUP BY ""inv"",""state"" ORDER BY ""start_date"""
259,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",DENSE_RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(DENSE_RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
260,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""a"" GROUP BY ""fail_date"" + INTERVAL '-""rnk"" DAY' UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""a"" GROUP BY ""success_date"" + INTERVAL '-""rnk"" DAY') AS ""b"" ORDER BY ""start_date"""
261,"SELECT 'failed' AS ""period_state"",""t1"".""start_date"",""t2"".""end_date"" FROM (SELECT ""f1"".""fail_date"" AS ""start_date"",ROW_NUMBER() OVER (ORDER BY ""f1"".""fail_date"") AS ""row_numbers"" FROM (SELECT * FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""f1"" LEFT JOIN (SELECT * FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""f3"" ON ""f3"".""fail_date"" - ""f1"".""fail_date""=-1 WHERE ""f3"".""fail_date"" IS NULL) AS ""t1"" JOIN (SELECT ""f1"".""fail_date"" AS ""end_date"",ROW_NUMBER() OVER (ORDER BY ""f1"".""fail_date"") AS ""row_numbers"" FROM (SELECT * FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""f1"" LEFT JOIN (SELECT * FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""f2"" ON ""f2"".""fail_date"" - ""f1"".""fail_date""=1 WHERE ""f1"".""fail_date"">='2019-01-01' AND ""f1"".""fail_date""<='2019-12-31' AND ""f2"".""fail_date"" IS NULL) AS ""t2"" ON ""t1"".""row_numbers""=""t2"".""row_numbers"" UNION ALL SELECT 'succeeded' AS ""period_state"",""m1"".""start_date"",""m2"".""end_date"" FROM (SELECT ""s1"".""success_date"" AS ""start_date"",ROW_NUMBER() OVER (ORDER BY ""s1"".""success_date"") AS ""row_numbers"" FROM (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s1"" LEFT JOIN (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s3"" ON ""s3"".""success_date"" - ""s1"".""success_date""=-1 WHERE ""s1"".""success_date"">='2019-01-01' AND ""s1"".""success_date""<='2019-12-31' AND ""s3"".""success_date"" IS NULL) AS ""m1"" JOIN (SELECT ""s1"".""success_date"" AS ""end_date"",ROW_NUMBER() OVER (ORDER BY ""s1"".""success_date"") AS ""row_numbers"" FROM (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s1"" LEFT JOIN (SELECT * FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""s2"" ON ""s2"".""success_date"" - ""s1"".""success_date""=1 WHERE ""s1"".""success_date"">='2019-01-01' AND ""s1"".""success_date""<='2019-12-31' AND ""s2"".""success_date"" IS NULL) AS ""m2"" ON ""m1"".""row_numbers""=""m2"".""row_numbers"" ORDER BY ""start_date"""
262,"WITH ""date_tbl"" AS (SELECT * FROM ""failed"" UNION SELECT * FROM ""succeeded"" ORDER BY ""fail_date""), ""date_status"" AS (SELECT ""fail_date"" AS ""all_date"",CASE WHEN ""fail_date"" IN (SELECT * FROM ""failed"") THEN 'failed' ELSE 'succeeded' END AS ""stat"" FROM ""date_tbl"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
263,"WITH ""cte1"" AS (SELECT ""success_date"",""success_date"" - CAST('2018-01-01' AS DATE) AS ""num"",ROW_NUMBER() OVER () AS ""rowsnum"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""fail_date"",""fail_date"" - CAST('2018-01-01' AS DATE) AS ""num"",ROW_NUMBER() OVER () AS ""rowsnum"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte1"" GROUP BY ""num""-""rowsnum"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""num""-""rowsnum"" ORDER BY 2"
264,"WITH ""all_records"" AS (SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""event_status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""fail_date"" AS ""event_date"",'failed' AS ""event_status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""event_grp_ranks"" AS (SELECT ""event_date"",""event_status"",(DENSE_RANK() OVER (ORDER BY ""event_date"")-DENSE_RANK() OVER (PARTITION BY ""event_status"" ORDER BY ""event_date"")) AS ""grp_num"" FROM ""all_records"" AS ""ar"" ORDER BY ""event_date"") SELECT ""event_status"" AS ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM ""event_grp_ranks"" GROUP BY ""event_status"",""grp_num"" ORDER BY ""start_date"""
265,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
266,"WITH ""t1"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY 2), ""t2"" AS (SELECT *,LAG(""period_state"") OVER (ORDER BY ""date"") AS ""_last"",LEAD(""period_state"") OVER (ORDER BY ""date"") AS ""_prev"" FROM ""t1""), ""t3"" AS (SELECT ""period_state"",""date"",CASE WHEN ""_last"" IS NULL THEN 'start' WHEN ""period_state""!=""_last"" THEN 'start' END AS ""_star"",CASE WHEN ""_prev"" IS NULL THEN 'end' WHEN ""period_state""!=""_prev"" THEN 'end' END AS ""_end"" FROM ""t2""), ""t4"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"") AS ""_loop"" FROM ""t3"" WHERE ""_star"" IS NOT NULL), ""t5"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"") AS ""_loop"" FROM ""t3"" WHERE ""_end"" IS NOT NULL) SELECT ""t4"".""period_state"",""t4"".""date"" AS ""start_date"",""t5"".""date"" AS ""end_date"" FROM ""t4"" JOIN ""t5"" ON ""t4"".""_loop""=""t5"".""_loop"""
267,"SELECT * FROM (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""A"" GROUP BY ""fail_date"" - INTERVAL '""ranking"" DAY' UNION SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""A"" GROUP BY ""success_date"" - INTERVAL '""ranking"" DAY') AS ""C"" ORDER BY ""start_date"""
268,"WITH ""Logs"" AS (SELECT ""fail_date"" AS ""log_date"",'failed' AS ""state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""log_date"",'succeeded' AS ""state"" FROM ""Succeeded""), ""GroupDiff"" AS (SELECT ""log_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""log_date"") AS ""RowNums"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""log_date"") AS ""gRowNum"",ROW_NUMBER() OVER (ORDER BY ""log_date"")-ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""log_date"") AS ""gDiff"" FROM ""Logs"" WHERE ""log_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""log_date"") SELECT ""state"" AS ""period_state"",MIN(""log_date"") AS ""start_date"",MAX(""log_date"") AS ""end_date"" FROM ""GroupDiff"" GROUP BY ""state"",""gDiff"""
269,"WITH ""all_dates"" AS (SELECT ""success_date"" AS ""dt"",'succeeded' AS ""state"" FROM ""Succeeded"" AS ""s"" UNION ALL SELECT ""fail_date"" AS ""dt"",'failed' AS ""state"" FROM ""Failed"" AS ""f"") SELECT ""period_state"",MIN(""start_date"") AS ""start_date"",MAX(""end_date"") AS ""end_date"" FROM (SELECT *,LAG(""end_date"", 1) OVER (ORDER BY ""start_date"") AS ""lag_dt"" FROM (SELECT ""state"" AS ""period_state"",""dt"" AS ""start_date"",CASE WHEN ""state""=""lead_state"" AND ""lead_dt"" - ""dt""=1 THEN ""lead_dt"" ELSE ""dt"" END AS ""end_date"",""lead_dt"" - ""dt"" AS ""df"",CASE WHEN ""lead_dt"" - ""dt""=1 AND ""state""=""lead_state"" THEN @""r"" ELSE @""r"":=@""r""+1 END AS ""r"" FROM (SELECT ""dt"",""state"",COALESCE(LEAD(""dt"", 1) OVER (ORDER BY ""dt""), ""dt"") AS ""lead_dt"",COALESCE(LEAD(""state"", 1) OVER (ORDER BY ""dt""), ""state"") AS ""lead_state"" FROM ""all_dates"" WHERE ""dt"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY 1) AS ""temp"" CROSS, (SELECT @""p"":=0,@""r"":=1) AS ""t"") AS ""yo"") AS ""yo1"" WHERE ""lag_dt""!=""end_date"" OR ""lag_dt"" IS NULL GROUP BY ""period_state"",""r"""
270,"SELECT ""checker"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""date"",""checker"",RANK() OVER (ORDER BY ""date"")-""inrank"" AS ""tracker"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""checker"",RANK() OVER (ORDER BY ""fail_date"") AS ""inrank"" FROM ""failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""checker"",RANK() OVER (ORDER BY ""success_date"") AS ""inrank"" FROM ""succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""temp"" ORDER BY ""date"") AS ""d"" GROUP BY ""checker"",""tracker"""
271,"WITH ""tasks"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""period_date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""period_date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""group_calc"" AS (SELECT ""period_state"",""period_date"",(RANK() OVER (ORDER BY ""period_date"")-""seq"") AS ""group_num"" FROM (SELECT *,RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""period_date"") AS ""seq"" FROM ""tasks"") AS ""tab"") SELECT ""period_state"",MIN(""period_date"") AS ""start_date"",MAX(""period_date"") AS ""end_date"" FROM ""group_calc"" GROUP BY ""period_state"",""group_num"""
272,"WITH ""a"" AS ((SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') UNION ALL (SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31')), ""b"" AS (SELECT ""day"",ROW_NUMBER() OVER (ORDER BY ""day"") AS ""overall_rnk"",""period_state"",""rnk"",(ROW_NUMBER() OVER (ORDER BY ""day"")-""rnk"") AS ""grp"" FROM ""a"" ORDER BY ""day"") SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""b"" GROUP BY ""grp"",""period_state"" ORDER BY ""start_date"""
273,"WITH RECURSIVE ""cte_spine"" AS (SELECT '2019-01-01' AS ""calendar_date"" UNION ALL SELECT ""calendar_date"" + INTERVAL '1 DAY' AS ""calendar_date"" FROM ""cte_spine"" WHERE ""calendar_date""<'2019-12-31'), ""cte_log"" AS (SELECT ""fail_date"" AS ""calendar_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""calendar_date"",'succeeded' AS ""state"" FROM ""Succeeded""), ""cte_joined"" AS (SELECT ""s"".""calendar_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""s"".""calendar_date"") AS ""day_idx"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""s"".""calendar_date"") AS ""partition_day_idx"" FROM ""cte_spine"" AS ""s"" LEFT JOIN ""cte_log"" AS ""l"" ON ""s"".""calendar_date""=""l"".""calendar_date"" WHERE ""state"" IS NOT NULL), ""cte_final"" AS (SELECT ""state"" AS ""period_state"",MIN(""calendar_date"") AS ""start_date"",MAX(""calendar_date"") AS ""end_date"" FROM ""cte_joined"" GROUP BY 1,""day_idx""-""partition_day_idx"" ORDER BY 2) SELECT * FROM ""cte_final"""
274,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
275,"WITH ""VT"" AS (SELECT ""fail_date"" AS ""DAT"",'failed' AS ""FLAG"" FROM ""FAILED"" UNION ALL SELECT ""SUCCESS_DATE"",'succeeded' FROM ""SUCCEEDED""), ""FLAGS"" AS (SELECT ""FLAG"" AS ""PERIOD_STATE"",""DAT"",DENSE_RANK() OVER (ORDER BY ""DAT"")-DENSE_RANK() OVER (PARTITION BY ""FLAG"" ORDER BY ""DAT"") AS ""RNK"" FROM ""VT"" WHERE ""DAT"">='2019-01-01' AND ""DAT""<='2019-12-31') SELECT ""PERIOD_STATE"" AS ""period_state"",MIN(""DAT"") AS ""start_date"",MAX(""DAT"") AS ""end_date"" FROM ""FLAGS"" GROUP BY ""PERIOD_STATE"",""RNK"" ORDER BY MIN(""DAT"")"
276,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
277,"SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""laststate"" IS NULL OR ""laststate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""laststate"" FROM (SELECT ""fail_date"" AS ""dateval"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION ALL SELECT ""success_date"" AS ""dateval"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t"") AS ""t1"") AS ""t2"""
278,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""cte2"" AS (SELECT ""date1"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date1"") AS ""overall_rnk"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""period_rnk"" FROM ""cte1"") SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""cte2"" GROUP BY 1,""overall_rnk""-""period_rnk"" ORDER BY 2"
279,"WITH ""cte"" AS (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte1"" AS (SELECT ""success_date"",""success_date"" + INTERVAL '-""rnk"" DAY' AS ""group_date"" FROM ""cte""), ""cte2"" AS (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte3"" AS (SELECT ""fail_date"",""fail_date"" + INTERVAL '-""rnk"" DAY' AS ""group_date"" FROM ""cte2""), ""cte4"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte1"" GROUP BY ""group_date"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte3"" GROUP BY ""group_date"") SELECT * FROM ""cte4"" ORDER BY 2"
280,"WITH ""cte"" AS (SELECT * FROM ((SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""Failed"") UNION (SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""Succeeded"")) AS ""a"" WHERE LEFT(""date"", 4)='2019' ORDER BY ""date"") SELECT ""cte2"".""status"" AS ""period_state"",MIN(""cte2"".""date"") AS ""start_date"",MAX(""cte2"".""date"") AS ""end_date"" FROM (SELECT ""status"",""date"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""ranking"",RANK() OVER (ORDER BY ""date"") AS ""overall_ranking"",(RANK() OVER (ORDER BY ""date"")-RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"")) AS ""inv"" FROM ""cte"") AS ""cte2"" GROUP BY ""cte2"".""status"",""cte2"".""inv"""
281,"WITH ""events"" AS (SELECT ""success_date"" AS ""dt"",'succeeded' AS ""state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION ALL SELECT ""fail_date"" AS ""dt"",'failed' AS ""state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019), ""t0"" AS (SELECT ""dt"",""state"",LAG(""dt"") OVER (ORDER BY ""dt"") AS ""prev_dt"",LAG(""state"") OVER (ORDER BY ""dt"") AS ""prev_state"" FROM ""events""), ""t1"" AS (SELECT ""dt"" AS ""sess_sd"",LEAD(""dt"") OVER (ORDER BY ""dt"") AS ""next_sess_sd"",""state"" FROM ""t0"" WHERE ""prev_dt"" IS NULL OR ""dt"" - ""prev_dt"">1 OR ""prev_state""!=""state""), ""t2"" AS (SELECT ""sess_sd"",MAX(""dt"") AS ""sess_ed"",""s"".""state"" FROM ""t1"" AS ""s"" JOIN ""events"" AS ""e"" ON ""e"".""dt"">=""sess_sd"" AND (""e"".""dt""<""next_sess_sd"" OR ""next_sess_sd"" IS NULL) GROUP BY ""sess_sd"") SELECT ""state"" AS ""period_state"",""sess_sd"" AS ""start_date"",COALESCE(""sess_ed"", ""sess_sd"") AS ""end_date"" FROM ""t2"""
282,"WITH ""tb1"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""s"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""s"" FROM ""Succeeded""), ""tb2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""s"" ORDER BY ""date"") AS ""r"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""r2"" FROM ""tb1"" WHERE EXTRACT(YEAR FROM ""date"")=2019) SELECT ""s"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""tb2"" GROUP BY ""r2""-""r"",""s"" ORDER BY ""start_date"""
283,"WITH ""tmp1"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" + INTERVAL '-ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""grp"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""fail_date"") AS ""ina"" GROUP BY ""grp""), ""tmp2"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" + INTERVAL '-ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""grp"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""success_date"") AS ""ina"" GROUP BY ""grp"") SELECT * FROM ""tmp1"" UNION SELECT * FROM ""tmp2"" ORDER BY ""start_date"""
284,"WITH ""CTE"" AS (SELECT ""date"",""period_state"",((ROW_NUMBER() OVER (ORDER BY ""date""))-""rnk"") AS ""group1"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte"" GROUP BY ""period_state"",""group1"" ORDER BY ""start_date"""
285,"WITH ""wa"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"" FROM ""Failed"" UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" FROM ""Succeeded""), ""wb"" AS (SELECT ""x"".*,CONCAT(""x"".""period_state"", (ROW_NUMBER() OVER (ORDER BY ""x"".""dt"")-ROW_NUMBER() OVER (PARTITION BY ""x"".""period_state"" ORDER BY ""x"".""dt""))) AS ""xtag"" FROM ""wa"" AS ""x"") SELECT ""x"".""period_state"",MIN(""x"".""dt"") AS ""start_date"",MAX(""x"".""dt"") AS ""end_date"" FROM ""wb"" AS ""x"" WHERE ""x"".""dt"" BETWEEN STR_TO_DATE('01-01-2019', '%m-%d-%Y') AND STR_TO_DATE('12-31-2019', '%m-%d-%Y') GROUP BY ""x"".""xtag"",""x"".""period_state"" ORDER BY 2"
286,"WITH ""cte"" AS (SELECT ""success_date"" AS ""date1"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION ALL SELECT ""fail_date"" AS ""date1"",'failed' AS ""state"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 ORDER BY ""date1""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date1"") AS ""rk"",RANK() OVER (PARTITION BY ""state"" ORDER BY ""date1"") AS ""prk"" FROM ""cte"") SELECT ""state"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""cte2"" GROUP BY ""state"",""rk""-""prk"" ORDER BY ""start_date"""
287,"WITH ""fail"" AS (SELECT ""fail_date"" - INTERVAL '""rn"" DAY','failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"",""fail_date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN STR_TO_DATE('2019-01-01', '%Y-%m-%d') AND STR_TO_DATE('2019-12-31', '%Y-%m-%d')) AS ""t"" GROUP BY 1,2), ""success"" AS (SELECT ""success_date"" - INTERVAL '""rn"" DAY','succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"",""success_date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN STR_TO_DATE('2019-01-01', '%Y-%m-%d') AND STR_TO_DATE('2019-12-31', '%Y-%m-%d')) AS ""t"" GROUP BY 1,2) SELECT ""period_state"",""start_date"",""end_date"" FROM ""fail"" UNION ALL SELECT ""period_state"",""start_date"",""end_date"" FROM ""success"" ORDER BY 2"
288,"WITH ""tmp"" AS (SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-1-1' AND '2019-12-31' UNION ALL SELECT ""fail_date"" AS ""day"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-1-1' AND '2019-12-31') SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""state"",RANK() OVER (ORDER BY ""day"") AS ""g_rk"",RANK() OVER (ORDER BY ""day"")-""rk"" AS ""inv"" FROM ""tmp"") AS ""a"" GROUP BY ""state"",""inv"" ORDER BY 2"
289,"WITH ""f"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" + INTERVAL '-""r_id"" DAY' AS ""grp"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER () AS ""r_id"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""ina"") AS ""inb"" GROUP BY ""grp""), ""s"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" + INTERVAL '-""r_id"" DAY' AS ""grp"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER () AS ""r_id"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""ina"") AS ""inb"" GROUP BY ""grp"") SELECT * FROM ""f"" UNION SELECT * FROM ""s"" ORDER BY ""start_date"""
290,"WITH ""a"" AS ((SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"") UNION ALL (SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"")), ""b"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""seq"" FROM ""a"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""c"" AS (SELECT ""date"",""period_state"",""seq"",""date"" + INTERVAL '-""seq"" DAY' AS ""seqStart"" FROM ""b"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""c"" GROUP BY ""seqStart"",""period_state"" ORDER BY ""start_date"""
291,"SELECT ""period_state"",MIN(""period_date"") AS ""start_date"",MAX(""period_date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""period_date"") AS ""ovl"",ROW_NUMBER() OVER (ORDER BY ""period_date"")-""rk"" AS ""inv"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""period_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""period_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31')) AS ""a"") AS ""b"" GROUP BY ""period_state"",""inv"" ORDER BY 2"
292,"WITH ""t"" (""dateval"", ""state"") AS (SELECT ""fail_date"",'failed' FROM ""Failed"" UNION ALL SELECT ""success_date"",'succeeded' FROM ""Succeeded"") SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""Prevstate"" IS NULL OR ""prevstate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""prevstate"" FROM ""t"" WHERE ""dateval"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t2"""
293,"WITH ""temp_table"" AS (SELECT 'failed' AS ""status"",""fail_date"" AS ""ex_date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""status"",""success_date"" AS ""ex_date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""current_status"" AS ""period_state"",""start_date"",CASE WHEN ""end_date"" IS NULL THEN ""max_date"" ELSE ""end_date"" + INTERVAL '-1 DAY' END AS ""end_date"" FROM (SELECT ""current_status"",""ex_date"" AS ""start_date"",LEAD(""ex_date"", 1) OVER (ORDER BY ""ex_date"") AS ""end_date"" FROM (SELECT ""ex_date"",""status"" AS ""current_status"",LAG(""status"", 1) OVER (ORDER BY ""ex_date"") AS ""prev_status"" FROM ""temp_table"" WHERE ""ex_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t2"" WHERE ""current_status""!=""prev_status"" OR ""prev_status"" IS NULL) AS ""t3"" CROSS JOIN (SELECT MAX(""ex_date"") AS ""max_date"" FROM ""temp_table"") AS ""t4"""
294,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date1"",'failed' AS ""status1"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" UNION SELECT ""success_date"" AS ""date1"",'succeeded' AS ""status1"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded""), ""cte2"" AS (SELECT ""date1"",""status1"" AS ""period_state"",RANK() OVER (ORDER BY ""date1"") AS ""overall_rank"",""rk"",(RANK() OVER (ORDER BY ""date1"")-""rk"") AS ""rv"" FROM ""cte"") SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""cte2"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""rv"" ORDER BY ""start_date"""
295,"WITH ""cte_Succeded_Failed"" AS (SELECT 'failed' AS ""period_state"",""Fail_date"" AS ""Day"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""Fail_date"")='2019' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""Day"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') SELECT ""period_state"",MIN(""Day"") AS ""start_date"",MAX(""Day"") AS ""end_date"" FROM ""cte_Succeded_Failed"" GROUP BY ""period_state"",""Day"" - INTERVAL '""ranking"" DAY' ORDER BY 2"
296,"WITH ""f"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""ingroup_ranking"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<'2020-01-01'), ""s"" AS (SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""ingroup_ranking"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<'2020-01-01'), ""fs"" AS (SELECT *,RANK() OVER (ORDER BY ""dt"") AS ""over_all_ranking"" FROM (SELECT * FROM ""s"" UNION ALL SELECT * FROM ""f"") AS ""tmp"" ORDER BY ""dt""), ""ffs"" AS (SELECT *,(""over_all_ranking""-""ingroup_ranking"") AS ""diff_group"" FROM ""fs"") SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""ffs"" GROUP BY ""diff_group"",""period_state"" ORDER BY ""start_date"""
297,"WITH ""date_tbl"" AS (SELECT * FROM ""failed"" UNION SELECT * FROM ""succeeded"" ORDER BY ""fail_date""), ""date_status"" AS (SELECT ""fail_date"" AS ""all_date"",CASE WHEN ""fail_date"" IN (SELECT * FROM ""failed"") THEN 'failed' ELSE 'succeeded' END AS ""stat"" FROM ""date_tbl"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
298,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""the_date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE LEFT(""fail_date"", 4)='2019' UNION ALL SELECT ""success_date"" AS ""the_date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE LEFT(""success_date"", 4)='2019') SELECT ""period_state"",MIN(""the_date"") AS ""start_date"",MAX(""THE_date"") AS ""end_date"" FROM (SELECT ""period_state"",""the_date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""the_date"") AS ""ranking"",RANK() OVER (ORDER BY ""the_date"") AS ""id"" FROM ""cte"") AS ""T"" GROUP BY ""T"".""period_state"",(""T"".""id""-""T"".""ranking"") ORDER BY 2"
299,"SELECT ""t"".""period_state"",MIN(""t"".""all_date"") AS ""start_date"",MAX(""t"".""all_date"") AS ""end_date"" FROM (SELECT ""temp"".""period_state"",""temp"".""all_date"",""temp"".""all_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""temp"".""period_state"" ORDER BY ""temp"".""all_date"") DAY' AS ""R"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""all_date"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""all_date"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""temp"") AS ""t"" GROUP BY ""t"".""period_state"",""t"".""R"" ORDER BY ""start_date"""
300,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"") AS ""a"" WHERE ""a"".""start_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
301,"WITH ""cte"" AS (SELECT ""task_date"",""task_status"",ROW_NUMBER() OVER (ORDER BY ""task_date"") AS ""row_id"" FROM (SELECT ""fail_date"" AS ""task_date"",'failed' AS ""task_status"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""task_date"",'succeeded' AS ""task_status"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""A"") SELECT ""task_status"" AS ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_date"") AS ""end_date"" FROM (SELECT ""task_date"",""task_status"",""row_id""-""sequence"" AS ""grp"" FROM (SELECT ""task_date"",""task_status"",""row_id"",RANK() OVER (PARTITION BY ""task_status"" ORDER BY ""row_id"") AS ""sequence"" FROM ""cte"") AS ""A"") AS ""B"" GROUP BY ""task_status"",""grp"" ORDER BY MIN(""task_date"")"
302,"SELECT ""state"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
303,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT *,""date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") DAY' AS ""dgroup"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY 1) AS ""t0"") AS ""t1"" GROUP BY ""dgroup"",""period_state"" ORDER BY 2"
304,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
305,"SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""laststate"" IS NULL OR ""laststate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""laststate"" FROM (SELECT ""fail_date"" AS ""dateval"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION ALL SELECT ""success_date"" AS ""dateval"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t"") AS ""t1"") AS ""t2"""
306,"WITH ""tmp"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"" FROM ""failed"" UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"" FROM ""succeeded""), ""tmp1"" AS (SELECT ""period_state"",""dt"",RANK() OVER (ORDER BY ""dt"") AS ""rk"" FROM ""tmp"" ORDER BY ""dt""), ""tmp2"" AS (SELECT ""a"".""period_state"",""a"".""dt"",RANK() OVER (ORDER BY ""a"".""dt"") AS ""rk"" FROM ""tmp1"" AS ""a"" LEFT JOIN ""tmp1"" AS ""b"" ON ""a"".""rk""=""b"".""rk""+1 WHERE ""b"".""period_state"" IS NULL OR ""b"".""period_state""!=""a"".""period_state""), ""tmp3"" AS (SELECT ""a"".""period_state"",""a"".""dt"" AS ""start_date"",CASE WHEN ""b"".""dt"" IS NULL THEN ""mx"" ELSE ""b"".""dt"" + INTERVAL '-1 DAY' END AS ""end_date"" FROM (""tmp2"" AS ""a"" LEFT JOIN ""tmp2"" AS ""b"" ON ""a"".""rk""+1=""b"".""rk"") LEFT JOIN (SELECT MAX(""dt"") AS ""mx"" FROM ""tmp"") AS ""c"" ON ""a"".""rk"">0) SELECT ""period_state"",CASE WHEN ""start_date""<DATE('2019-01-01') THEN DATE('2019-01-01') ELSE ""start_date"" END AS ""start_date"",CASE WHEN ""end_date"">DATE('2019-12-31') THEN DATE('2019-12-31') ELSE ""end_date"" END AS ""end_date"" FROM ""tmp3"" WHERE ""start_date""<=DATE('2019-12-31') AND ""end_date"">=DATE('2019-01-01')"
307,"SELECT ""state"" AS ""period_state"",""date"" AS ""start_date"",CASE WHEN ""next_state"" IS NULL OR (""state""!=""pre_state"" AND ""state""!=""next_state"") OR (""pre_state"" IS NULL AND ""state""!=""next_state"") THEN ""date"" ELSE ""next_date"" END AS ""end_date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"",LAG(""date"", 1) OVER (ORDER BY ""date"") AS ""pre_date"",LEAD(""date"", 1) OVER (ORDER BY ""date"") AS ""next_date"" FROM (SELECT ""state"",""date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"" FROM (SELECT * FROM (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"") AS ""combined1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date"") AS ""combined2"") AS ""combined3"" WHERE ""state""!=""pre_state"" OR ""state""!=""next_state"" OR ""pre_state"" IS NULL OR ""next_state"" IS NULL) AS ""combined4"") AS ""combined5"" WHERE (""pre_state"" IS NULL AND ""state""!=""next_state"") OR (""next_state"" IS NULL AND ""state""!=""pre_state"") OR ""state""=""next_state"" OR (""state""!=""pre_state"" AND ""state""!=""next_state"")"
308,"WITH ""CTE"" AS ((SELECT ""fail_date"" AS ""dt"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""dt"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') ORDER BY ""dt""), ""CTE1"" AS (SELECT ""dt"",CASE WHEN ""dt"" IN (SELECT * FROM ""Failed"") THEN 'failed' ELSE 'succeeded' END AS ""status1"" FROM ""CTE""), ""CTE2"" AS (SELECT ""dt"",""status1"",ROW_NUMBER() OVER (ORDER BY ""dt"") AS ""rn"",DENSE_RANK() OVER (PARTITION BY ""status1"" ORDER BY ""dt"") AS ""dr"" FROM ""CTE1"") SELECT ""status1"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""CTE2"" GROUP BY ""status1"",""rn""-""dr"" ORDER BY MIN(""dt"")"
309,"SELECT ""state"" AS ""period_state"",""date"" AS ""start_date"",CASE WHEN ""next_state"" IS NULL OR (""state""!=""pre_state"" AND ""state""!=""next_state"") OR (""pre_state"" IS NULL AND ""state""!=""next_state"") THEN ""date"" ELSE ""next_date"" END AS ""end_date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"",LAG(""date"", 1) OVER (ORDER BY ""date"") AS ""pre_date"",LEAD(""date"", 1) OVER (ORDER BY ""date"") AS ""next_date"" FROM (SELECT ""state"",""date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"" FROM (SELECT * FROM (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"") AS ""combined1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date"") AS ""combined2"") AS ""combined3"" WHERE ""state""!=""pre_state"" OR ""state""!=""next_state"" OR ""pre_state"" IS NULL OR ""next_state"" IS NULL) AS ""combined4"") AS ""combined5"" WHERE (""pre_state"" IS NULL AND ""state""!=""next_state"") OR (""next_state"" IS NULL AND ""state""!=""pre_state"") OR ""state""=""next_state"" OR (""state""!=""pre_state"" AND ""state""!=""next_state"")"
310,"WITH RECURSIVE ""cte_spine"" AS (SELECT '2019-01-01' AS ""calendar_date"" UNION ALL SELECT ""calendar_date"" + INTERVAL '1 DAY' AS ""calendar_date"" FROM ""cte_spine"" WHERE ""calendar_date""<'2019-12-31'), ""cte_log"" AS (SELECT ""fail_date"" AS ""calendar_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""calendar_date"",'succeeded' AS ""state"" FROM ""Succeeded""), ""cte_joined"" AS (SELECT ""s"".""calendar_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""s"".""calendar_date"") AS ""day_idx"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""s"".""calendar_date"") AS ""partition_day_idx"" FROM ""cte_spine"" AS ""s"" LEFT JOIN ""cte_log"" AS ""l"" ON ""s"".""calendar_date""=""l"".""calendar_date""), ""cte_final"" AS (SELECT ""state"" AS ""period_state"",MIN(""calendar_date"") AS ""start_date"",MAX(""calendar_date"") AS ""end_date"" FROM ""cte_joined"" WHERE ""state"" IS NOT NULL GROUP BY 1,""day_idx""-""partition_day_idx"" ORDER BY 2) SELECT * FROM ""cte_final"""
311,"WITH ""CTE"" AS (SELECT ""fail_date"",'failed' AS ""p_state"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r_num"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"",'succeeded' AS ""p_state"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r_num"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""p_state"" AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte"" GROUP BY (EXTRACT(EPOCH FROM ""fail_date"")-""r_num""),""period_state"" ORDER BY ""fail_date"""
312,"WITH ""t1"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""sdrank"" FROM ""succeeded"" WHERE ""success_date"" LIKE '2019%'), ""t2"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""t1"" GROUP BY ""success_date"" - INTERVAL '""sdrank"" DAY'), ""t3"" AS (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""fdrank"" FROM ""failed"" WHERE ""fail_date"" LIKE '2019%'), ""t4"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""t3"" GROUP BY ""fail_date"" - INTERVAL '""fdrank"" DAY') SELECT ""period_state"",""start_date"",""end_date"" FROM ""t2"" UNION SELECT ""period_state"",""start_date"",""end_date"" FROM ""t4"" ORDER BY ""start_date"""
313,"WITH ""fs"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""ss"" AS (SELECT *,""dt"" - INTERVAL 'DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""dt"") DAY' AS ""grp"" FROM ""fs"") SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""ss"" GROUP BY ""period_state"",""grp"" ORDER BY MIN(""dt"")"
314,"WITH ""cte"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"" ORDER BY ""date"") AS ""temp"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT ""period_state"",""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""rnk"" FROM ""cte"") AS ""temp"" GROUP BY ""period_state"",""row_num""-""rnk"" ORDER BY ""start_date"""
315,"SELECT ""state"" AS ""period_state"",""date"" AS ""start_date"",CASE WHEN ""next_state"" IS NULL OR (""state""!=""pre_state"" AND ""state""!=""next_state"") OR (""pre_state"" IS NULL AND ""state""!=""next_state"") THEN ""date"" ELSE ""next_date"" END AS ""end_date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"",LAG(""date"", 1) OVER (ORDER BY ""date"") AS ""pre_date"",LEAD(""date"", 1) OVER (ORDER BY ""date"") AS ""next_date"" FROM (SELECT ""state"",""date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"" FROM (SELECT * FROM (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"") AS ""combined1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date"") AS ""combined2"") AS ""combined3"" WHERE ""state""!=""pre_state"" OR ""state""!=""next_state"" OR ""pre_state"" IS NULL OR ""next_state"" IS NULL) AS ""combined4"") AS ""combined5"" WHERE (""pre_state"" IS NULL AND ""state""!=""next_state"") OR (""next_state"" IS NULL AND ""state""!=""pre_state"") OR ""state""=""next_state"" OR (""state""!=""pre_state"" AND ""state""!=""next_state"")"
316,"WITH ""date_tbl"" AS (SELECT * FROM ""failed"" UNION SELECT * FROM ""succeeded"" ORDER BY ""fail_date""), ""date_status"" AS (SELECT ""fail_date"" AS ""all_date"",CASE WHEN ""fail_date"" IN (SELECT * FROM ""failed"") THEN 'failed' ELSE 'succeeded' END AS ""stat"" FROM ""date_tbl"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
317,"WITH ""fs"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""ss"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""dt"") AS ""rn"",""dt"" - INTERVAL 'DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""dt"") DAY' AS ""grp"" FROM ""fs"") SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""ss"" GROUP BY ""period_state"",""grp"" ORDER BY MIN(""dt"")"
318,"WITH ""stattable"" AS (SELECT ""fail_date"" AS ""event_date"",'failed' AS ""period_state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""period_state"" FROM ""succeeded"") SELECT ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM (SELECT ""period_state"",""event_date"",DAYOFYEAR(""event_date"")-DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""event_date"") AS ""indgrp"" FROM ""stattable"" WHERE EXTRACT(YEAR FROM ""event_date"")=2019) AS ""a"" GROUP BY ""period_state"",""indgrp"" ORDER BY ""start_date"""
319,"WITH ""s"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""id"") AS ""r"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",""success_date"" - (SELECT MIN(""success_date"") FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019')+1 AS ""id"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') AS ""a""), ""f"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""id"") AS ""r"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",""fail_date"" - (SELECT MIN(""fail_date"") FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019')+1 AS ""id"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019') AS ""a"") SELECT * FROM (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""s"" GROUP BY ""id""-""r"" UNION SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""f"" GROUP BY ""id""-""r"") AS ""a"" ORDER BY ""start_date"""
320,"SELECT ""period_state"",MIN(""start_date"") AS ""start_date"",MAX(""end_date"") AS ""end_date"" FROM (SELECT *,CASE WHEN ""tab_3"".""prior_state"" IS NULL THEN @""counter"":=0 WHEN ""tab_3"".""prior_state""=""tab_3"".""period_state"" THEN @""counter"" ELSE @""counter"":=@""counter""+1 END AS ""grouped"" FROM (SELECT *,LAG(""tab_2"".""period_state"") OVER () AS ""prior_state"" FROM (SELECT CASE WHEN ""status""=0 THEN 'failed' ELSE 'succeeded' END AS ""period_state"",""date"" AS ""start_date"",""date"" AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date"",0 AS ""status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",1 AS ""status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tab_1"" ORDER BY ""start_date"") AS ""tab_2"") AS ""tab_3"") AS ""tab_4"" GROUP BY ""grouped"""
321,"WITH ""cte_log"" AS (SELECT ""fail_date"" AS ""calendar_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""calendar_date"",'succeeded' AS ""state"" FROM ""Succeeded""), ""cte_joined"" AS (SELECT ""calendar_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""calendar_date"") AS ""day_idx"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""calendar_date"") AS ""partition_day_idx"" FROM ""cte_log"" WHERE ""calendar_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte_final"" AS (SELECT ""state"" AS ""period_state"",MIN(""calendar_date"") AS ""start_date"",MAX(""calendar_date"") AS ""end_date"" FROM ""cte_joined"" GROUP BY 1,""day_idx""-""partition_day_idx"" ORDER BY 2) SELECT * FROM ""cte_final"""
322,"WITH ""x"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rownum"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rownum"" FROM ""Succeeded"") SELECT ""period_state"",MIN(""date_x"") AS ""start_date"",MAX(""date_x"") AS ""end_date"" FROM ""x"" WHERE ""date_x"" LIKE '2019%' GROUP BY 1,""date_x"" - INTERVAL '""rownum"" DAY' ORDER BY 2"
323,"WITH ""temp1"" AS (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp2"" AS (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""temp1"" GROUP BY EXTRACT(EPOCH FROM ""fail_date"")-""ranking"" UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""temp2"" GROUP BY EXTRACT(EPOCH FROM ""success_date"")-""ranking"" ORDER BY ""start_date"""
324,"WITH ""date_status"" AS (SELECT * FROM (SELECT *,'succeeded' AS ""period"" FROM ""succeeded"" UNION ALL SELECT *,'failed' AS ""period"" FROM ""failed"") AS ""a"" ORDER BY 1) SELECT ""period"" AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""row_num"",RANK() OVER (PARTITION BY ""period"" ORDER BY ""success_date"") AS ""rnk"" FROM ""date_status"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY ""period"",""row_num""-""rnk"" ORDER BY ""start_date"""
325,"WITH ""temp1"" AS (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp2"" AS (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""temp1"" GROUP BY (EXTRACT(EPOCH FROM ""fail_date"")-""ranking"") UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""temp2"" GROUP BY (EXTRACT(EPOCH FROM ""success_date"")-""ranking"") ORDER BY ""start_date"""
326,"WITH ""cte1"" AS (SELECT 'failed' AS ""status"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""status"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"") AS ""rn1"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""rn2"" FROM ""cte1"" ORDER BY ""date"") SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""status"",""rn1""-""rn2"" ORDER BY ""start_date"""
327,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT ""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rn"",LAG(""status"", 1) OVER (ORDER BY ""date"") AS ""prev_status"",""status"",LEAD(""status"", 1) OVER (ORDER BY ""date"") AS ""next_status"" FROM ""cte1""), ""cte3"" AS (SELECT ""status"" AS ""period_state"",CASE WHEN ""status""!=""prev_status"" OR ""rn""=1 THEN ""date"" END AS ""start_date"",CASE WHEN ""status""!=""next_status"" OR ""rn""=(SELECT COUNT(1) AS ""max_rn"" FROM ""cte2"") THEN ""date"" END AS ""end_date"" FROM ""cte2""), ""cte4"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""rn"",""period_state"" FROM ""cte3"" WHERE ""start_date"" IS NOT NULL), ""cte5"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""rn"",""start_date"" FROM ""cte3"" WHERE ""start_date"" IS NOT NULL), ""cte6"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""end_date"") AS ""rn"",""end_date"" FROM ""cte3"" WHERE ""end_date"" IS NOT NULL) SELECT ""period_state"",""start_date"",""end_date"" FROM (""cte4"" JOIN ""cte5"" ON ""cte4"".""rn""=""cte5"".""rn"") JOIN ""cte6"" ON ""cte5"".""rn""=""cte6"".""rn"""
328,"WITH ""cte"" AS (SELECT ""period_state"",""task_date"",DENSE_RANK() OVER (ORDER BY ""task_date"") AS ""overall_ranking"",DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""task_date"") AS ""state_ranking"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""task_date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""task_date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") SELECT ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_Date"") AS ""end_date"" FROM ""cte"" GROUP BY ""period_state"",(""overall_ranking""-""state_ranking"") ORDER BY MIN(""task_date"")"
329,"WITH ""date_tbl"" AS (SELECT * FROM ""failed"" UNION SELECT * FROM ""succeeded"" ORDER BY ""fail_date""), ""date_status"" AS (SELECT ""fail_date"" AS ""all_date"",CASE WHEN ""fail_date"" IN (SELECT * FROM ""failed"") THEN 'failed' ELSE 'succeeded' END AS ""stat"" FROM ""date_tbl"") SELECT ""stat"" AS ""period_state"",MIN(""all_date"") AS ""start_date"",MAX(""all_date"") AS ""end_date"" FROM (SELECT ""stat"",""all_date"",ROW_NUMBER() OVER (ORDER BY ""all_date"") AS ""row_num"",DENSE_RANK() OVER (PARTITION BY ""stat"" ORDER BY ""all_date"") AS ""rnk"" FROM ""date_status"") AS ""a"" WHERE ""all_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""stat"",""row_num""-""rnk"" ORDER BY ""all_date"""
330,"SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rownum"",DAYOFYEAR(""success_date"") AS ""doy"",""success_date"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""a"" GROUP BY ""doy""-CAST(""rownum"" AS INTEGER) UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rownum"",DAYOFYEAR(""fail_date"") AS ""doy"",""fail_date"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""a"" GROUP BY ""doy""-CAST(""rownum"" AS INTEGER) ORDER BY 2"
331,"WITH ""x"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r"" FROM ""Succeeded"") SELECT ""period_state"",MIN(""date_x"") AS ""start_date"",MAX(""date_x"") AS ""end_date"" FROM ""x"" WHERE ""date_x"" LIKE '2019%' GROUP BY 1,""date_x"" + INTERVAL '-""r"" DAY' ORDER BY 2"
332,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""cte2"" AS (SELECT ""date1"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date1"") AS ""overall_rnk"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""period_rnk"" FROM ""cte1""), ""cte3"" AS (SELECT *,""overall_rnk""-""period_rnk"" AS ""diff"" FROM ""cte2"") SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""cte3"" GROUP BY 1,""diff"" ORDER BY 2"
333,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
334,"WITH ""events"" AS (SELECT ""success_date"" AS ""dt"",'succeeded' AS ""state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION ALL SELECT ""fail_date"" AS ""dt"",'failed' AS ""state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019), ""t0"" AS (SELECT ""dt"",""state"",LAG(""dt"") OVER (ORDER BY ""dt"") AS ""prev_dt"",LAG(""state"") OVER (ORDER BY ""dt"") AS ""prev_state"" FROM ""events""), ""t1"" AS (SELECT ""dt"" AS ""sess_sd"",LEAD(""dt"") OVER (ORDER BY ""dt"") AS ""next_sess_sd"",""state"" FROM ""t0"" WHERE ""prev_dt"" IS NULL OR ""dt"" - ""prev_dt"">1 OR ""prev_state""!=""state""), ""t2"" AS (SELECT ""sess_sd"",MAX(""dt"") AS ""sess_ed"",""s"".""state"" FROM ""t1"" AS ""s"" JOIN ""events"" AS ""e"" ON ""e"".""dt"">=""sess_sd"" AND (""e"".""dt""<""next_sess_sd"" OR ""next_sess_sd"" IS NULL) GROUP BY ""sess_sd"") SELECT ""state"" AS ""period_state"",""sess_sd"" AS ""start_date"",COALESCE(""sess_ed"", ""sess_sd"") AS ""end_date"" FROM ""t2"""
335,"SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",""success_date"" - CAST('2019-01-01' AS DATE) AS ""diff"",CAST(ROW_NUMBER() OVER () AS CHAR) AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""sub"" GROUP BY ""diff""-""rk"" UNION SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",""fail_date"" - CAST('2019-01-01' AS DATE) AS ""diff"",CAST(ROW_NUMBER() OVER () AS CHAR) AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""sub"" GROUP BY ""diff""-""rk"" ORDER BY ""start_date"""
336,"WITH ""CTE"" AS (SELECT ""success_date"" AS ""date_num"",1 AS ""status_num"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""idx"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019 UNION ALL SELECT ""fail_date"" AS ""date_num"",0 AS ""status_num"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""idx"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT CASE WHEN ""status_num""=1 THEN 'succeeded' ELSE 'failed' END AS ""period_state"",MIN(""date_num"") AS ""start_date"",MAX(""date_num"") AS ""end_date"" FROM ""CTE"" GROUP BY ""status_num"",""idx"" ORDER BY ""start_date"""
337,"WITH ""dat"" AS ((SELECT ""fail_date"" AS ""dat"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') UNION (SELECT ""success_date"" AS ""dat"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31')), ""temp"" AS (SELECT ""dat"" - INTERVAL '1 DAY' AS ""dat"",(CASE WHEN ""state""='Failed' THEN 'Succeeded' ELSE 'Failed' END) AS ""state"" FROM ""dat"" WHERE ""dat""=(SELECT MIN(""dat"") FROM ""dat"") UNION SELECT * FROM ""dat"" UNION SELECT ""dat"" + INTERVAL '1 DAY' AS ""dat"",(CASE WHEN ""state""='Failed' THEN 'Succeeded' ELSE 'Failed' END) AS ""state"" FROM ""dat"" WHERE ""dat""=(SELECT MAX(""dat"") FROM ""dat"")) SELECT ""period_state"",MIN(""start_date"") AS ""start_date"",""end_date"" FROM (SELECT ""a"".""state"" AS ""period_state"",""a"".""dat"" AS ""start_date"",MIN(""b"".""dat"") - INTERVAL '1 DAY' AS ""end_date"" FROM (""temp"" AS ""a"") CROSS JOIN ""temp"" AS ""b"" WHERE ""a"".""dat""<""b"".""dat"" AND ""a"".""state""!=""b"".""state"" GROUP BY ""a"".""dat"") AS ""a"" WHERE ""start_date""!=(SELECT MIN(""dat"") - INTERVAL '1 DAY' FROM ""dat"") GROUP BY ""end_date"" ORDER BY ""start_date"""
338,"SELECT ""period_state"",""start_date"",""end_date"" FROM (SELECT ""period_state"",""inv"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""period_state"",""day"",RANK() OVER (ORDER BY ""day"") AS ""ovr_rnk"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp"") AS ""rslt"" GROUP BY ""inv"",1) AS ""final"" ORDER BY 2"
339,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
340,"WITH RECURSIVE ""t"" AS (SELECT STR_TO_DATE('2019-01-01', '%Y-%m-%d') AS ""dd"",1 AS ""r"" UNION ALL SELECT ""dd"" + INTERVAL '1 DAY',""r""+1 FROM ""t"" WHERE ""dd""<'2019-12-31'), ""s"" AS (SELECT ""success_date"",ROW_NUMBER() OVER () AS ""r"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""f"" AS (SELECT ""fail_date"",ROW_NUMBER() OVER () AS ""r"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) SELECT ""period_state"",MIN(""d"") AS ""start_date"",MAX(""d"") AS ""end_date"" FROM (SELECT ""s"".""success_date"" AS ""d"",""success_date"" - ""dd"" AS ""g"",'succeeded' AS ""period_state"" FROM ""s"" JOIN ""t"" ON ""s"".""r""=""t"".""r"" UNION SELECT ""fail_date"" AS ""d"",""fail_date"" - ""dd"" AS ""g"",'failed' AS ""period_state"" FROM ""f"" JOIN ""t"" ON ""f"".""r""=""t"".""r"") AS ""x"" GROUP BY ""period_state"",""g"" ORDER BY 2"
341,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"")-RANK() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""grp"" FROM ""cte"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""state"",""grp"" ORDER BY ""date"""
342,"WITH ""combined"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",DAYOFYEAR(""fail_date"")-RANK() OVER (ORDER BY ""fail_date"") AS ""period_group"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",DAYOFYEAR(""success_date"")-RANK() OVER (ORDER BY ""success_date"") AS ""period_group"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""combined"" GROUP BY ""period_state"",""period_group"" ORDER BY ""start_date"""
343,"WITH ""main"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
344,"WITH ""succeeded_ranges"" (""period_state"", ""start_date"", ""end_date"") AS (SELECT 'succeeded',MIN(""success_date""),MAX(""success_date"") FROM (SELECT *,SUM(""match"") OVER (ORDER BY ""success_date"") AS ""block"" FROM (SELECT *,COALESCE(""success_date"" - LAG(""success_date"") OVER (ORDER BY ""success_date"")!=1, 0) AS ""match"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""tmp"") AS ""tmp2"" GROUP BY ""block""), ""failed_ranges"" (""period_state"", ""start_date"", ""end_date"") AS (SELECT 'failed',MIN(""fail_date""),MAX(""fail_date"") FROM (SELECT *,SUM(""match"") OVER (ORDER BY ""fail_date"") AS ""block"" FROM (SELECT *,COALESCE(""fail_date"" - LAG(""fail_date"") OVER (ORDER BY ""fail_date"")!=1, 0) AS ""match"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""tmp"") AS ""tmp2"" GROUP BY ""block"") SELECT * FROM (SELECT * FROM ""succeeded_ranges"" UNION ALL SELECT * FROM ""failed_ranges"") AS ""tmp"" ORDER BY ""start_date"""
345,"WITH ""un"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date1"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date1"" FROM ""Succeeded""), ""flags"" AS (SELECT ""period_state"",""date1"",DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""flag"" FROM ""un"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""flags"" GROUP BY ""period_state"",""flag"" ORDER BY MIN(""date1"")"
346,"WITH ""cte_log"" AS (SELECT ""fail_date"" AS ""calendar_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""calendar_date"",'succeeded' AS ""state"" FROM ""Succeeded""), ""cte_label"" AS (SELECT ""calendar_date"",""state"",ROW_NUMBER() OVER (ORDER BY ""calendar_date"") AS ""day_idx"",ROW_NUMBER() OVER (PARTITION BY ""state"" ORDER BY ""calendar_date"") AS ""partition_day_idx"" FROM ""cte_log"" WHERE ""calendar_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte_final"" AS (SELECT ""state"" AS ""period_state"",MIN(""calendar_date"") AS ""start_date"",MAX(""calendar_date"") AS ""end_date"" FROM ""cte_label"" GROUP BY 1,""day_idx""-""partition_day_idx"" ORDER BY 2) SELECT * FROM ""cte_final"""
347,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""cte2"" AS (SELECT ""date1"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date1"") AS ""overall_rnk"",ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date1"") AS ""period_rnk"" FROM ""cte1"") SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""cte2"" GROUP BY 1,""overall_rnk""-""period_rnk"" ORDER BY 2"
348,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""succeeded""), ""cte2"" AS (SELECT * FROM ""cte1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte3"" AS (SELECT ""date"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rn"",LAG(""status"", 1) OVER (ORDER BY ""date"") AS ""prev_status"",""status"",LEAD(""status"", 1) OVER (ORDER BY ""date"") AS ""next_status"" FROM ""cte2""), ""cte4"" AS (SELECT COUNT(1) AS ""max_rn"" FROM ""cte3""), ""cte5"" AS (SELECT ""status"" AS ""period_state"",CASE WHEN ""status""!=""prev_status"" OR ""rn""=1 THEN ""date"" END AS ""start_date"",CASE WHEN ""status""!=""next_status"" OR ""rn""=""max_rn"" THEN ""date"" END AS ""end_date"" FROM ""cte3"" CROSS JOIN ""cte4""), ""cte6"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""rn"",""period_state"" FROM ""cte5"" WHERE ""start_date"" IS NOT NULL), ""cte7"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""start_date"") AS ""rn"",""start_date"" FROM ""cte5"" WHERE ""start_date"" IS NOT NULL), ""cte8"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""end_date"") AS ""rn"",""end_date"" FROM ""cte5"" WHERE ""end_date"" IS NOT NULL) SELECT ""period_state"",""start_date"",""end_date"" FROM (""cte6"" JOIN ""cte7"" ON ""cte6"".""rn""=""cte7"".""rn"") JOIN ""cte8"" ON ""cte7"".""rn""=""cte8"".""rn"""
349,"WITH ""united"" AS (SELECT 'failed' AS ""status"",""fail_date"" AS ""event_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""event_rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""status"",""success_date"",RANK() OVER (ORDER BY ""success_date"") FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""status"" AS ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM (SELECT ""status"",""event_date"",RANK() OVER (ORDER BY ""event_date"") AS ""consecutive_rnk"",""event_rnk"" FROM ""united"") AS ""tmp"" GROUP BY ""tmp"".""consecutive_rnk""-""event_rnk"",""status"" ORDER BY ""start_date"""
350,"SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"") AS ""tb"" WHERE ""dt"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""tb"".""dt"" + INTERVAL '-""rnk"" DAY' ORDER BY ""start_date"""
351,"SELECT ""b"".""period_state"",""b"".""start_date"",""b"".""end_date"" FROM (SELECT 'failed' AS ""period_state"",MIN(""a"".""fail_date"") AS ""start_date"",MAX(""a"".""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",(""fail_date"" - CAST('2019-01-01' AS DATE)+1-RANK() OVER (ORDER BY ""fail_date"")) AS ""diff"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""a"" GROUP BY ""a"".""diff"" UNION ALL SELECT 'succeeded' AS ""period_state"",MIN(""a"".""success_date"") AS ""start_date"",MAX(""a"".""success_date"") AS ""end_date"" FROM (SELECT ""d"".""success_date"",(""d"".""success_date"" - CAST('2019-01-01' AS DATE)+1-RANK() OVER (ORDER BY ""d"".""success_date"")) AS ""diff"" FROM (SELECT ""success_date"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""d"") AS ""a"" GROUP BY ""a"".""diff"") AS ""b"" ORDER BY ""b"".""start_date"""
352,"WITH ""main"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""main"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
353,"WITH ""A"" AS (SELECT ""period_state"",RANK() OVER (ORDER BY ""d"")-""R"" AS ""diff_rank"",""d"" FROM (SELECT 'failed' AS ""period_state"",RANK() OVER (ORDER BY ""fail_date"") AS ""R"",""fail_date"" AS ""d"" FROM ""Failed"" UNION ALL SELECT 'succeeded' AS ""period_state"",RANK() OVER (ORDER BY ""success_date"") AS ""R"",""success_date"" AS ""d"" FROM ""Succeeded"") AS ""S""), ""B"" AS (SELECT ""period_state"",""diff_rank"",MIN(""d"") AS ""start_date"",MAX(""d"") AS ""end_date"" FROM ""A"" WHERE ""d"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1,2) SELECT ""period_state"",""start_date"",""end_date"" FROM ""B"""
354,"SELECT ""period_state"",MIN(""start_date"") AS ""start_date"",MAX(""end_date"") AS ""end_date"" FROM (SELECT *,CASE WHEN ""prior_state"" IS NULL THEN @""group_id"":=0 WHEN ""prior_state""=""period_state"" THEN @""group_id"" ELSE @""group_id"":=@""group_id""+1 END AS ""grouped_id"" FROM (SELECT *,LAG(""period_state"") OVER () AS ""prior_state"" FROM (SELECT CASE WHEN ""status""=1 THEN 'succeeded' ELSE 'failed' END AS ""period_state"",""date"" AS ""start_date"",""date"" AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date"",0 AS ""status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",1 AS ""status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tab_1"" ORDER BY ""start_date"") AS ""tab_2"") AS ""tab_3"") AS ""tab_4"" GROUP BY ""grouped_id"""
355,"WITH ""succeeded_ranges"" (""period_state"", ""start_date"", ""end_date"") AS (SELECT 'succeeded',MIN(""success_date""),MAX(""success_date"") FROM (SELECT *,SUM(""match"") OVER (ORDER BY ""success_date"") AS ""block"" FROM (SELECT *,COALESCE(""success_date"" - LAG(""success_date"") OVER (ORDER BY ""success_date"")!=1, 0) AS ""match"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""tmp"") AS ""tmp2"" GROUP BY ""block""), ""failed_ranges"" (""period_state"", ""start_date"", ""end_date"") AS (SELECT 'failed',MIN(""fail_date""),MAX(""fail_date"") FROM (SELECT *,SUM(""match"") OVER (ORDER BY ""fail_date"") AS ""block"" FROM (SELECT *,COALESCE(""fail_date"" - LAG(""fail_date"") OVER (ORDER BY ""fail_date"")!=1, 0) AS ""match"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019) AS ""tmp"") AS ""tmp2"" GROUP BY ""block"") SELECT * FROM (SELECT * FROM ""succeeded_ranges"" UNION ALL SELECT * FROM ""failed_ranges"") AS ""tmp"" ORDER BY ""start_date"""
356,"WITH ""T"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"")-ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""groupping"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"") AS ""a"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""S"" AS (SELECT ""period_state"",""groupping"",MIN(""date"") AS ""start_date"" FROM ""T"" GROUP BY ""period_state"",""groupping""), ""E"" AS (SELECT ""period_state"",""groupping"",MAX(""date"") AS ""end_date"" FROM ""T"" GROUP BY ""period_state"",""groupping"") SELECT ""a"".""period_state"",""a"".""start_date"",""b"".""end_date"" FROM ""S"" AS ""a"" LEFT JOIN ""E"" AS ""b"" ON ""a"".""groupping""=""b"".""groupping"" AND ""a"".""period_state""=""b"".""period_state"" ORDER BY ""a"".""start_date"""
357,"WITH ""t1"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp1"" GROUP BY ""success_date"" - INTERVAL '""rnk"" DAY'), ""t2"" AS (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp2"" GROUP BY ""fail_date"" - INTERVAL '""rnk"" DAY') SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"" ORDER BY ""start_date"""
358,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
359,"WITH ""a"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""b"" AS (SELECT ""date"",""period_state"",LAG(""period_state"") OVER (ORDER BY ""date"") AS ""prev_state"",LEAD(""period_state"") OVER (ORDER BY ""date"") AS ""next_state"" FROM ""a""), ""c"" AS (SELECT ""date"" AS ""start_date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""row_num"" FROM ""b"" WHERE ""period_state""!=""prev_state"" OR ""prev_state"" IS NULL), ""d"" AS (SELECT ""date"" AS ""end_date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""date"") AS ""row_num"" FROM ""b"" WHERE ""period_state""!=""next_state"" OR ""next_state"" IS NULL) SELECT ""c"".""period_state"",""c"".""start_date"",""d"".""end_date"" FROM ""c"" JOIN ""d"" ON ""c"".""row_num""=""d"".""row_num"""
360,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""date"") AS ""rn1"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY 1,""rn1""-""rn"" ORDER BY 2"
361,"WITH ""t1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""period_state"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")='2019' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""period_state"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019'), ""t2"" AS (SELECT ""day"",""period_state"",LAG(""period_state"", 1) OVER (ORDER BY ""day"") AS ""lag_state"",LEAD(""period_state"", 1) OVER (ORDER BY ""day"") AS ""lead_state"" FROM ""t1""), ""t3"" AS (SELECT ""day"" AS ""start_date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""day"") AS ""index1"" FROM ""t2"" WHERE ""period_state""!=""lag_state"" OR ""lag_state"" IS NULL), ""t4"" AS (SELECT ""day"" AS ""end_date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""day"") AS ""index2"" FROM ""t2"" WHERE ""period_state""!=""lead_state"" OR ""lead_state"" IS NULL) SELECT ""t3"".""period_state"",""start_date"",""end_date"" FROM ""t3"" JOIN ""t4"" ON ""index1""=""index2"""
362,"WITH ""combined"" AS (SELECT ""fail_date"" AS ""dt"",'failed' AS ""period_state"",DAYOFYEAR(""fail_date"")-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""period_group"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""period_state"",DAYOFYEAR(""success_date"")-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""period_group"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""combined"" GROUP BY ""period_state"",""period_group"" ORDER BY ""start_date"""
363,"SELECT ""status"" AS ""period_state"",MIN(""dates"") AS ""start_date"",MAX(""dates"") AS ""end_date"" FROM (SELECT ""dates"",""status"",""dates"" + INTERVAL '-(ROW_NUMBER() OVER (PARTITION BY ""status"" ORDER BY ""dates"")) DAY' AS ""gp"" FROM ((SELECT ""success_date"" AS ""dates"",'succeeded' AS ""status"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') UNION (SELECT ""fail_date"" AS ""dates"",'failed' AS ""status"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31')) AS ""s"" ORDER BY ""dates"") AS ""t"" GROUP BY ""gp"",""period_state"""
364,"WITH ""fa_start"" AS (SELECT 'failed' AS ""ps"",""fail_date"" AS ""fs"" FROM ""failed"" WHERE ""fail_date"" + INTERVAL '-1 DAY' NOT IN (SELECT ""fail_date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AND ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""fa_end"" AS (SELECT 'failed' AS ""ps"",""fail_date"" AS ""fe"" FROM ""failed"" WHERE ""fail_date"" + INTERVAL '1 DAY' NOT IN (SELECT ""fail_date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AND ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""su_start"" AS (SELECT 'succeeded' AS ""ps"",""success_date"" AS ""ss"" FROM ""succeeded"" WHERE ""success_date"" + INTERVAL '-1 DAY' NOT IN (SELECT ""success_date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AND ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""su_end"" AS (SELECT 'succeeded' AS ""ps"",""success_date"" AS ""se"" FROM ""succeeded"" WHERE ""success_date"" + INTERVAL '1 DAY' NOT IN (SELECT ""success_date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AND ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""ss"".""ps"" AS ""period_state"",""ss"".""ss"" AS ""start_date"",MIN(""se"".""se"") AS ""end_date"" FROM (""su_start"" AS ""ss"") CROSS JOIN ""su_end"" AS ""se"" WHERE ""ss"".""ss""<=""se"".""se"" GROUP BY ""ss"".""ss"" UNION SELECT ""fs"".""ps"" AS ""period_state"",""fs"".""fs"" AS ""start_date"",MIN(""fe"".""fe"") AS ""end_date"" FROM (""fa_start"" AS ""fs"") CROSS JOIN ""fa_end"" AS ""fe"" WHERE ""fs"".""fs""<=""fe"".""fe"" GROUP BY ""fs"".""fs"" ORDER BY ""start_date"""
365,"SELECT ""period_state"",MIN(""sdate"") AS ""start_date"",MAX(""sdate"") AS ""end_date"" FROM (SELECT ""period_state"",""sdate"",RANK() OVER (ORDER BY ""sdate"")-""rnk"" AS ""inv"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""sdate"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""period_state"",""fail_date"" AS ""sdate"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""t"" GROUP BY ""inv"",""period_state"""
366,"SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rownum"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY DAYOFYEAR(""success_date"")-""rownum"" UNION SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rownum"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY DAYOFYEAR(""fail_date"")-""rownum"" ORDER BY 2"
367,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date""), ""cte2"" AS (SELECT *,RANK() OVER (ORDER BY ""date"")-RANK() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""grp"" FROM ""cte"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""state"",""grp"" ORDER BY ""date"""
368,"WITH ""states"" AS ((SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"") UNION ALL (SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"")), ""all_states"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""rn"" FROM ""states"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""all_states"" GROUP BY ""date"" - INTERVAL '""rn"" DAY',""period_state"" ORDER BY ""start_date"""
369,"WITH ""u"" AS (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""t"" AS (SELECT ""state"",""date"",RANK() OVER (ORDER BY ""date"") AS ""rk"",RANK() OVER (PARTITION BY ""state"" ORDER BY ""date"") AS ""s_rk"" FROM ""u"") SELECT ""state"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""t"" GROUP BY ""state"",""rk""-""s_rk"" ORDER BY ""start_date"""
370,"WITH ""a"" AS ((SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""failed"") UNION ALL (SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""succeeded"")), ""b"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""seq"" FROM ""a"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""c"" AS (SELECT ""date"",""period_state"",""seq"",""date"" + INTERVAL '-""seq"" DAY' AS ""seqStart"" FROM ""b"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""c"" GROUP BY ""seqStart"",""period_state"" ORDER BY ""start_date"""
371,"WITH ""CTE"" AS (SELECT ""fail_date"" AS ""event_date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT ""success_date"" AS ""event_date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) SELECT ""period_state"",MIN(""event_date"") AS ""start_date"",MAX(""event_date"") AS ""end_date"" FROM (SELECT ""period_state"",""event_date"",""event_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""event_date"") DAY' AS ""RK"" FROM ""CTE"") AS ""T"" GROUP BY ""period_state"",""RK"" ORDER BY 2"
372,"SELECT * FROM (SELECT ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",'failed' AS ""period_state"",""fail_date"" - CAST('2018-12-31' AS DATE)-ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""dd"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""a"" GROUP BY ""dd"" UNION SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",'succeeded' AS ""period_state"",""success_date"" - CAST('2018-12-31' AS DATE)-ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""dd"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""a"" GROUP BY ""dd"") AS ""b"" ORDER BY ""start_date"""
373,"WITH ""t"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""dates"",'failed' AS ""period_state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""period_state"" FROM ""Succeeded"") AS ""t0"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""dates"") SELECT * FROM (SELECT ""period_state"",""start_date"",CASE WHEN ""end_date"" IS NULL THEN LEAD(""end_date"") OVER (ORDER BY ""dates"") ELSE ""end_date"" END AS ""end_date"" FROM (SELECT ""period_state"",""dates"",CASE WHEN ""period_state""!=COALESCE(LAG(""period_state"") OVER (ORDER BY ""dates""), '') THEN ""dates"" ELSE NULL END AS ""start_date"",CASE WHEN ""period_state""!=COALESCE(LEAD(""period_state"") OVER (ORDER BY ""dates""), '') THEN ""dates"" ELSE NULL END AS ""end_date"" FROM ""t"" ORDER BY ""dates"") AS ""t1"" WHERE ""start_date"" IS NOT NULL OR ""end_date"" IS NOT NULL) AS ""t2"" WHERE ""start_date"" IS NOT NULL"
374,"WITH ""t1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""t2"" AS (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",RANK() OVER (ORDER BY ""day"")-""rk"" AS ""inv"" FROM ""t1"") SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""t2"" GROUP BY ""inv"",""stats"" ORDER BY 2"
375,"WITH ""f"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r"" FROM (SELECT ""fail_date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t"" GROUP BY ""fail_date"" - INTERVAL '""r"" DAY'), ""s"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r"" FROM (SELECT ""success_date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t"" GROUP BY ""success_date"" - INTERVAL '""r"" DAY') SELECT ""period_state"",""start_date"",""end_date"" FROM ""f"" UNION ALL SELECT ""period_state"",""start_date"",""end_date"" FROM ""s"" ORDER BY ""start_date"""
376,"WITH ""t"" (""dateval"", ""state"") AS (SELECT ""fail_date"",'failed' FROM ""Failed"" UNION ALL SELECT ""success_date"",'succeeded' FROM ""Succeeded"") SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""Prevstate"" IS NULL OR ""prevstate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""prevstate"" FROM ""t"" WHERE ""dateval"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t2"""
377,"WITH ""cte"" AS (SELECT 'failed' AS ""flag"",""fail_date"" AS ""date1"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""flag"",""success_date"" AS ""date1"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""mappings"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""date1"")-DENSE_RANK() OVER (PARTITION BY ""flag"" ORDER BY ""date1"") AS ""mappings"" FROM ""cte"") SELECT ""flag"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM ""mappings"" GROUP BY ""flag"",""mappings"" ORDER BY ""start_date"""
378,"WITH ""success"" AS (SELECT ""success_date"",MIN(""fail_date"") AS ""minf"",MAX(""fail_date"") AS ""maxf"" FROM ""succeeded"" AS ""s"" LEFT JOIN ""failed"" AS ""f"" ON ""s"".""success_date""<""f"".""fail_date"" WHERE ""s"".""success_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31') GROUP BY ""success_date"" ORDER BY ""s"".""success_date"",""f"".""fail_date""), ""fail"" AS (SELECT ""f"".""fail_date"",MIN(""success_date"") AS ""mins"",MAX(""success_date"") AS ""maxs"" FROM ""failed"" AS ""f"" LEFT JOIN ""succeeded"" AS ""s"" ON ""f"".""fail_date""<""s"".""success_date"" WHERE ""f"".""fail_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31') GROUP BY ""fail_date"" ORDER BY ""s"".""success_date"",""f"".""fail_date""), ""success_agg"" AS (SELECT MIN(""success_date"") AS ""mins"",MAX(""success_date"") AS ""maxs"",""minf"",""maxf"" FROM ""success"" GROUP BY ""minf"",""maxf""), ""fail_agg"" AS (SELECT MIN(""fail_date"") AS ""minf"",MAX(""fail_date"") AS ""maxf"",""mins"",""maxs"" FROM ""fail"" GROUP BY ""mins"",""maxs""), ""combined"" AS (SELECT 'succeeded' AS ""period_state"",""mins"" AS ""start_date"",""maxs"" AS ""end_date"" FROM ""success_agg"" UNION ALL SELECT 'failed' AS ""period_state"",""minf"" AS ""start_date"",""maxf"" AS ""end_date"" FROM ""fail_agg"") SELECT * FROM ""combined"" ORDER BY ""start_date"""
379,"WITH ""cte1"" AS (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",(RANK() OVER (ORDER BY ""day"")-""ranking"") AS ""ranking_diff"" FROM ""cte1"") SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM ""cte2"" GROUP BY ""ranking_diff"",""stats"" ORDER BY ""start_date"""
380,"WITH ""x"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r"" FROM ""Failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date_x"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r"" FROM ""Succeeded"") SELECT ""period_state"",MIN(""date_x"") AS ""start_date"",MAX(""date_x"") AS ""end_date"" FROM ""x"" WHERE ""date_x"" LIKE '2019%' GROUP BY 1,""date_x"" + INTERVAL '-""r"" DAY' ORDER BY 2"
381,"WITH ""states"" AS ((SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"") UNION ALL (SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"")), ""all_states"" AS (SELECT ""date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_state"",""date"") AS ""rn"" FROM ""states"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""all_states"" GROUP BY ""date"" - INTERVAL '""rn"" DAY',""period_state"" ORDER BY ""start_date"""
382,"SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rownum"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY DAYOFYEAR(""success_date"")-""rownum"" UNION SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rownum"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" GROUP BY DAYOFYEAR(""fail_date"")-""rownum"" ORDER BY 2"
383,"SELECT ""b"".""period_state"",MIN(""b"".""start_date"") AS ""start_date"",MAX(""b"".""start_date"") AS ""end_date"" FROM (SELECT * FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""i"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""start_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""i"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"" ORDER BY ""a"".""start_date"") AS ""b"" GROUP BY ""b"".""period_state"",""b"".""start_date"" + INTERVAL '-""b"".""i"" DAY' ORDER BY MIN(""b"".""start_date"")"
384,"WITH ""cte1"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""period_state"",""date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") AS ""rnk1"",RANK() OVER (ORDER BY ""date"") AS ""rnk2"" FROM ""cte1"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte2"" GROUP BY (""rnk2""-""rnk1""),1"
385,"WITH ""C"" AS (SELECT ('failed') AS ""period_state"",""fail_date"" AS ""dt"",DAYOFYEAR(""fail_date"")-DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ('succeeded') AS ""period_state"",""success_date"" AS ""dt"",DAYOFYEAR(""success_date"")-DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""C"" GROUP BY ""rk"",""period_state"" ORDER BY ""start_date"""
386,"WITH ""temp"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""t_date"" FROM ""failed"" UNION SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""t_date"" FROM ""Succeeded""), ""temp1"" AS (SELECT ""period_state"",""t_date"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""t_date"") AS ""rk"" FROM ""temp"" WHERE ""t_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""temp2"" AS (SELECT ""period_state"",""t_date"",""t_date"" + INTERVAL '-""rk"" DAY' AS ""grp"" FROM ""temp1"") SELECT ""period_state"",MIN(""t_date"") AS ""start_date"",MAX(""t_date"") AS ""end_date"" FROM ""temp2"" GROUP BY ""grp"",""period_state"" ORDER BY 2"
387,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""previous"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019 UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""previous"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019) AS ""l"" GROUP BY ""period_state"",""previous"" ORDER BY 2"
388,"WITH ""CTE_STATUS"" AS (SELECT ""fail_date"" AS ""task_date"",'failed' AS ""period_state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""task_date"",'succeeded' AS ""period_state"" FROM ""Succeeded""), ""grp_data"" AS (SELECT ""cs"".""task_date"",""cs"".""period_state"",@""grp"":=CASE WHEN @""prev""!=""cs"".""period_state"" THEN @""grp""+1 ELSE @""grp"" END AS ""grp_num"",@""prev"":=""cs"".""period_state"" AS ""previous"" FROM (""CTE_STATUS"" AS ""cs"") CROSS JOIN (SELECT @""grp"":=0,@""prev"":=NULL) AS ""a"" WHERE ""task_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""task_date"") SELECT MAX(""period_state"") AS ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_date"") AS ""end_date"" FROM ""grp_data"" GROUP BY ""grp_num"" ORDER BY 2"
389,"WITH ""combined"" AS (SELECT 'failed' AS ""period_state"",""fail_date"" AS ""date"",RANK() OVER (ORDER BY ""fail_date"") AS ""rank_1"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""date"",RANK() OVER (ORDER BY ""success_date"") AS ""rank_1"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""ranked"" AS (SELECT ""period_state"",""date"",""rank_1"",RANK() OVER (ORDER BY ""date"") AS ""rank_2"" FROM ""combined"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""ranked"" GROUP BY ""period_state"",""rank_2""-""rank_1"""
390,"WITH ""a"" AS (SELECT ""fail_date"",""fail_date"" - (SELECT MIN(""fail_date"") FROM ""Failed"")-CAST(RANK() OVER (ORDER BY ""fail_date"") AS INTEGER) AS ""intervals"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019), ""b"" AS (SELECT ""fail_date"",""intervals"",RANK() OVER (PARTITION BY ""intervals"" ORDER BY ""fail_date"") AS ""st_rk"",RANK() OVER (PARTITION BY ""intervals"" ORDER BY ""fail_date"" DESC) AS ""ed_rk"" FROM ""a""), ""c"" AS (SELECT ""fail_date"" AS ""start_date"",""intervals"" FROM ""b"" WHERE ""st_rk""=1), ""d"" AS (SELECT ""fail_date"" AS ""end_date"",""intervals"" FROM ""b"" WHERE ""ed_rk""=1), ""fail"" AS (SELECT ""start_date"",""end_date"" FROM ""c"" JOIN ""d"" ON ""c"".""intervals""=""d"".""intervals""), ""a1"" AS (SELECT ""success_date"",""success_date"" - (SELECT MIN(""success_date"") FROM ""Succeeded"")-CAST(RANK() OVER (ORDER BY ""success_date"") AS INTEGER) AS ""intervals"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""b1"" AS (SELECT ""success_date"",""intervals"",RANK() OVER (PARTITION BY ""intervals"" ORDER BY ""success_date"") AS ""st_rk"",RANK() OVER (PARTITION BY ""intervals"" ORDER BY ""success_date"" DESC) AS ""ed_rk"" FROM ""a1""), ""c1"" AS (SELECT ""success_date"" AS ""start_date"",""intervals"" FROM ""b1"" WHERE ""st_rk""=1), ""d1"" AS (SELECT ""success_date"" AS ""end_date"",""intervals"" FROM ""b1"" WHERE ""ed_rk""=1), ""success"" AS (SELECT ""start_date"",""end_date"" FROM ""c1"" JOIN ""d1"" ON ""c1"".""intervals""=""d1"".""intervals"") SELECT 'failed' AS ""period_state"",""start_date"",""end_date"" FROM ""fail"" UNION ALL SELECT 'succeeded',""start_date"",""end_date"" FROM ""success"" ORDER BY ""start_date"""
391,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""stg"" GROUP BY ""day"" - INTERVAL '""rnk"" DAY',""period_state"" ORDER BY ""start_date"""
392,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",RANK() OVER (ORDER BY ""day"") AS ""overall_ranking"",""stats"",""rk"",(RANK() OVER (ORDER BY ""day"")-""rk"") AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",RANK() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",RANK() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
393,"WITH ""su"" AS (SELECT ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rk"",""success_date"" - INTERVAL 'DENSE_RANK() OVER (ORDER BY ""success_date"") DAY' FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""x"" GROUP BY ""success_date"" - INTERVAL '""rk"" DAY'), ""fa"" AS (SELECT ""period_state"",MIN(""fail_date""),MAX(""fail_date"") FROM (SELECT 'failed' AS ""period_state"",""fail_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rk"",""fail_date"" - INTERVAL 'DENSE_RANK() OVER (ORDER BY ""fail_date"") DAY' FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""x"" GROUP BY ""fail_date"" - INTERVAL '""rk"" DAY') SELECT * FROM ""su"" UNION ALL SELECT * FROM ""fa"" ORDER BY ""start_date"""
394,"SELECT ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""period_state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""period_state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
395,"WITH ""cte"" AS (SELECT ""fail_date"" AS ""cal_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""cal_date"",'succeeded' AS ""state"" FROM ""Succeeded"") SELECT ""state"" AS ""period_state"",MIN(""cal_date"") AS ""start_date"",MAX(""cal_date"") AS ""end_date"" FROM (SELECT ""state"",""cal_date"",RANK() OVER (PARTITION BY ""state"" ORDER BY ""cal_date"") AS ""ranking"",RANK() OVER (ORDER BY ""cal_date"") AS ""id"" FROM ""cte"" WHERE ""cal_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"" GROUP BY ""state"",(""id""-""ranking"") ORDER BY 2"
396,"SELECT ""state"" AS ""period_state"",MIN(""date1"") AS ""start_date"",MAX(""date1"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""date1"",'failed' AS ""state"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""myrank"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""date1"",'succeeded' AS ""state"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""myrank"" FROM ""Succeeded"") AS ""t"" WHERE ""date1"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""state"",""date1"" + INTERVAL '-""myrank"" DAY' ORDER BY ""start_date"""
397,"SELECT ""state"" AS ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT ""dt"",RANK() OVER (ORDER BY ""dt"")-""rnk"" AS ""gid"",""state"" FROM (SELECT ""fail_date"" AS ""dt"",'failed' AS ""state"",RANK() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""dt"",'succeeded' AS ""state"",RANK() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY ""gid"",""state"" ORDER BY 2"
398,"WITH ""total"" AS (SELECT ""fail_date"" AS ""date"",'failed' AS ""status"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""status"" FROM ""Succeeded"" ORDER BY ""date""), ""ranking"" AS (SELECT ""date"",""status"",RANK() OVER (ORDER BY ""date"") AS ""overall_ranking"",RANK() OVER (PARTITION BY ""status"" ORDER BY ""date"") AS ""status_ranking"" FROM ""total""), ""period"" AS (SELECT ""date"",""status"",(""overall_ranking""-""status_ranking"") AS ""period"" FROM ""ranking"") SELECT ""status"" AS ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""period"" WHERE ""date"">='2019-01-01' AND ""date""<='2019-12-31' GROUP BY ""status"",""period"" ORDER BY ""start_date"""
399,"WITH ""tasks_state"" AS (SELECT ""task_date"",""state"",DENSE_RANK() OVER (PARTITION BY ""state"" ORDER BY ""task_date"") AS ""rank_in_state"" FROM (SELECT ""fail_date"" AS ""task_date"",'failed' AS ""state"" FROM ""Failed"" UNION ALL SELECT ""success_date"" AS ""task_data"",'succeeded' AS ""state"" FROM ""Succeeded"") AS ""U"" WHERE ""task_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31')) SELECT ""t"".""state"" AS ""period_state"",MIN(""t"".""task_date"") AS ""start_date"",MAX(""t"".""task_date"") AS ""end_date"" FROM (SELECT ""task_date"",""state"",""task_date"" + INTERVAL '-""rank_in_state"" DAY' AS ""grouping_set"" FROM ""tasks_state"") AS ""t"" GROUP BY ""state"",""grouping_set"" ORDER BY ""start_date"""
400,"WITH RECURSIVE ""success"" AS (SELECT ""success_date"" AS ""start_date"",""success_date"" AS ""end_date"" FROM ""succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")=2019), ""failed1"" AS (SELECT ""fail_date"" AS ""start_date"",""fail_date"" AS ""end_date"" FROM ""failed"" WHERE EXTRACT(YEAR FROM ""fail_date"")=2019), ""success_range"" AS (SELECT ""start_date"",""end_date"",1 AS ""cnt"" FROM ""success"" UNION ALL SELECT ""a"".""start_date"",""b"".""end_date"",""cnt""+1 AS ""cnt"" FROM ""success_range"" AS ""a"" JOIN ""success"" AS ""b"" ON ""a"".""end_date""=""b"".""start_date"" - INTERVAL ''1' DAY'), ""failed_range"" AS (SELECT ""start_date"",""end_date"",1 AS ""cnt"" FROM ""failed1"" UNION ALL SELECT ""a"".""start_date"",""b"".""end_date"",""cnt""+1 AS ""cnt"" FROM ""failed_range"" AS ""a"" JOIN ""failed1"" AS ""b"" ON ""a"".""end_date""=""b"".""start_date"" - INTERVAL ''1' DAY') SELECT * FROM (SELECT 'succeeded' AS ""period_state"",""start_date"",MAX(""end_date"") AS ""end_date"" FROM (SELECT ""end_date"",MIN(""start_date"") AS ""start_date"" FROM ""success_range"" WHERE ROW(""end_date"",""cnt"") IN (SELECT ""end_date"",MAX(""cnt"") FROM ""success_range"" GROUP BY 1) GROUP BY 1) AS ""a"" GROUP BY 2) AS ""b"" UNION ALL SELECT * FROM (SELECT 'failed' AS ""period_state"",""start_date"",MAX(""end_date"") AS ""end_date"" FROM (SELECT ""end_date"",MIN(""start_date"") AS ""start_date"" FROM ""failed_range"" WHERE ROW(""end_date"",""cnt"") IN (SELECT ""end_date"",MAX(""cnt"") FROM ""failed_range"" GROUP BY 1) GROUP BY 1) AS ""a"" GROUP BY 2) AS ""c"" ORDER BY 2"
401,"WITH ""temp_failed"" AS (SELECT ""fail_date"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""failed""), ""failed_cleaned"" AS (SELECT ""fail_date"" AS ""dt"",""fail_date"" + INTERVAL '-""rn"" DAY' AS ""fill_gaps"",'failed' AS ""period_state"" FROM ""temp_failed""), ""temp_succeded"" AS (SELECT ""success_date"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""Succeeded""), ""succeded_cleaned"" AS (SELECT ""success_date"" AS ""dt"",""success_date"" + INTERVAL '-""rn"" DAY' AS ""fill_gaps"",'succeeded' AS ""period_state"" FROM ""temp_succeded""), ""merged_table"" AS (SELECT * FROM ""failed_cleaned"" WHERE ""dt"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT * FROM ""succeded_cleaned"" WHERE ""dt"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM ""merged_table"" GROUP BY ""period_state"",""fill_gaps"" ORDER BY ""start_date"""
402,"WITH ""all_periods"" AS (SELECT ""success_date"" AS ""period_date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" UNION SELECT ""fail_date"" AS ""period_date"",'failed' AS ""period_state"" FROM ""failed""), ""ranked_periods"" AS (SELECT ""period_date"",""period_state"",ROW_NUMBER() OVER (ORDER BY ""period_date"") AS ""period_rank"",RANK() OVER (PARTITION BY ""period_state"" ORDER BY ""period_date"") AS ""state_rnk"" FROM ""all_periods"" WHERE ""period_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""period_state"",MIN(""period_date"") AS ""start_date"",MAX(""period_date"") AS ""end_date"" FROM ""ranked_periods"" GROUP BY 1,""period_date"" + INTERVAL '-""state_rnk"" DAY' ORDER BY 2"
403,"WITH ""CTE1"" AS (SELECT ""FAIL_DATE"" AS ""PERIOD"",'failed' AS ""PERIOD_STATE"" FROM ""FAILED"" WHERE ""FAIL_DATE"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""SUCCESS_DATE"" AS ""PERIOD"",'succeeded' AS ""PERIOD_STATE"" FROM ""SUCCEEDED"" WHERE ""SUCCESS_DATE"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""PERIOD""), ""CTE2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""PERIOD_STATE"" ORDER BY ""PERIOD"") AS ""RNO"" FROM ""CTE1"" ORDER BY ""PERIOD"") SELECT ""PERIOD_STATE"",MIN(""PERIOD"") AS ""START_DATE"",MAX(""PERIOD"") AS ""END_DATE"" FROM ""CTE2"" GROUP BY ""PERIOD_STATE"",""PERIOD"" - INTERVAL '""RNO"" DAY'"
404,"SELECT ""state"" AS ""period_state"",""date"" AS ""start_date"",CASE WHEN ""next_state"" IS NULL OR (""state""!=""pre_state"" AND ""state""!=""next_state"") OR (""pre_state"" IS NULL AND ""state""!=""next_state"") THEN ""date"" ELSE ""next_date"" END AS ""end_date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"",LAG(""date"", 1) OVER (ORDER BY ""date"") AS ""pre_date"",LEAD(""date"", 1) OVER (ORDER BY ""date"") AS ""next_date"" FROM (SELECT ""state"",""date"" FROM (SELECT ""state"",""date"",LAG(""state"", 1) OVER (ORDER BY ""date"") AS ""pre_state"",LEAD(""state"", 1) OVER (ORDER BY ""date"") AS ""next_state"" FROM (SELECT * FROM (SELECT 'succeeded' AS ""state"",""success_date"" AS ""date"" FROM ""succeeded"" UNION SELECT 'failed' AS ""state"",""fail_date"" AS ""date"" FROM ""failed"") AS ""combined1"" WHERE ""date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY ""date"") AS ""combined2"") AS ""combined3"" WHERE ""state""!=""pre_state"" OR ""state""!=""next_state"" OR ""pre_state"" IS NULL OR ""next_state"" IS NULL) AS ""combined4"") AS ""combined5"" WHERE (""pre_state"" IS NULL AND ""state""!=""next_state"") OR (""next_state"" IS NULL AND ""state""!=""pre_state"") OR ""state""=""next_state"" OR (""state""!=""pre_state"" AND ""state""!=""next_state"")"
405,"WITH ""CTE"" AS (SELECT * FROM (SELECT ""fail_date"" AS ""dates"",'failed' AS ""state"" FROM ""Failed"" UNION SELECT ""success_date"" AS ""dates"",'succeeded' AS ""state"" FROM ""Succeeded"" ORDER BY ""dates"") AS ""sub0"" WHERE ""dates"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""state"" AS ""period_state"",""dates"" AS ""start_date"",CASE WHEN RANK() OVER (ORDER BY ""dates"" DESC)=1 THEN (SELECT MAX(""dates"") FROM ""CTE"") ELSE LEAD(""dates"", 1) OVER (ORDER BY ""dates"") - INTERVAL '1 DAY' END AS ""end_date"" FROM (SELECT ""dates"",""state"",CASE WHEN LAG(""state"", 1) OVER (ORDER BY ""dates"")=""state"" THEN 0 ELSE 1 END AS ""flag"" FROM ""CTE"") AS ""sub1"" WHERE ""flag""=1"
406,"SELECT 'failed' AS ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_date"") AS ""end_date"" FROM (SELECT ""fail_date"" AS ""task_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rn"" FROM ""failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31') AS ""t"" GROUP BY ""task_date"" - INTERVAL '""rn"" DAY' UNION SELECT 'succeeded' AS ""period_state"",MIN(""task_date"") AS ""start_date"",MAX(""task_date"") AS ""end_date"" FROM (SELECT ""success_date"" AS ""task_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rn"" FROM ""succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t1"" GROUP BY ""task_date"" - INTERVAL '""rn"" DAY' ORDER BY ""start_date"""
407,"SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM (SELECT *,""date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date"") DAY' AS ""dgroup"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY 1) AS ""t0"") AS ""t1"" GROUP BY ""dgroup"",""period_state"" ORDER BY 2"
408,"SELECT ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rnk"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT 'failed' AS ""period_state"",""fail_date"" AS ""day"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rnk"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp"" GROUP BY ""period_state"",""day"" - INTERVAL '""rnk"" DAY' ORDER BY ""start_date"""
409,"WITH ""tmp"" AS (SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""dt"" FROM ""succeeded"" UNION SELECT 'failed' AS ""period_state"",""fail_date"" AS ""dt"" FROM ""failed"" ORDER BY 2) SELECT ""period_state"",MIN(""dt"") AS ""start_date"",MAX(""dt"") AS ""end_date"" FROM (SELECT *,""dt"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""dt"") DAY' AS ""diff"" FROM ""tmp"" WHERE EXTRACT(YEAR FROM ""dt"")=2019) AS ""t"" GROUP BY ""period_state"",""diff"" ORDER BY 2"
410,"SELECT ""state"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""state"",(ROW_NUMBER() OVER (ORDER BY ""day"")-RANK() OVER (PARTITION BY ""state"" ORDER BY ""day"")) AS ""grp"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""day"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""a"") AS ""b"" GROUP BY ""grp"",""state"" ORDER BY ""start_date"""
411,"WITH ""cte"" AS (SELECT ""success_date"",""success_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""success_date"") DAY' AS ""nxt"" FROM ""succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte2"" AS (SELECT ""fail_date"",""fail_date"" - INTERVAL 'ROW_NUMBER() OVER (ORDER BY ""fail_date"") DAY' AS ""nxt"" FROM ""failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""cte3"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM ""cte"" GROUP BY ""nxt"" UNION ALL SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM ""cte2"" GROUP BY ""nxt"") SELECT * FROM ""cte3"" ORDER BY ""start_date"""
412,"WITH ""cte_Succeded_Failed"" AS (SELECT 'failed' AS ""period_state"",""Fail_date"" AS ""Day"",DENSE_RANK() OVER (ORDER BY ""fail_date"") AS ""ranking"" FROM ""Failed"" WHERE EXTRACT(YEAR FROM ""Fail_date"")='2019' UNION ALL SELECT 'succeeded' AS ""period_state"",""success_date"" AS ""Day"",DENSE_RANK() OVER (ORDER BY ""success_date"") AS ""ranking"" FROM ""Succeeded"" WHERE EXTRACT(YEAR FROM ""success_date"")='2019') SELECT ""period_state"",MIN(""Day"") AS ""start_date"",MAX(""Day"") AS ""end_date"" FROM ""cte_Succeded_Failed"" GROUP BY ""period_state"",""Day"" - INTERVAL '""ranking"" DAY' ORDER BY 2"
413,"WITH ""f"" AS (SELECT 'failed' AS ""period_state"",MIN(""fail_date"") AS ""start_date"",MAX(""fail_date"") AS ""end_date"" FROM (SELECT ""fail_date"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""r"" FROM (SELECT ""fail_date"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t"" GROUP BY ""fail_date"" - INTERVAL '""r"" DAY'), ""s"" AS (SELECT 'succeeded' AS ""period_state"",MIN(""success_date"") AS ""start_date"",MAX(""success_date"") AS ""end_date"" FROM (SELECT ""success_date"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""r"" FROM (SELECT ""success_date"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t"" GROUP BY ""success_date"" - INTERVAL '""r"" DAY') SELECT ""period_state"",""start_date"",""end_date"" FROM ""f"" UNION ALL SELECT ""period_state"",""start_date"",""end_date"" FROM ""s"" ORDER BY ""start_date"""
414,"SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""laststate"" IS NULL OR ""laststate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""laststate"" FROM (SELECT ""fail_date"" AS ""dateval"",'failed' AS ""state"" FROM ""Failed"" WHERE ""fail_date"">='2019-01-01' AND ""fail_date""<='2019-12-31' UNION ALL SELECT ""success_date"" AS ""dateval"",'succeeded' AS ""state"" FROM ""Succeeded"" WHERE ""success_date"">='2019-01-01' AND ""success_date""<='2019-12-31') AS ""t"") AS ""t1"") AS ""t2"""
415,"WITH ""CTE"" AS (SELECT ""date"",""period_state"",((ROW_NUMBER() OVER (ORDER BY ""date""))-(ROW_NUMBER() OVER (PARTITION BY ""period_state"" ORDER BY ""date""))) AS ""group1"" FROM (SELECT ""fail_date"" AS ""date"",'failed' AS ""period_state"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION ALL SELECT ""success_date"" AS ""date"",'succeeded' AS ""period_state"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""tmp"") SELECT ""period_state"",MIN(""date"") AS ""start_date"",MAX(""date"") AS ""end_date"" FROM ""cte"" GROUP BY ""period_state"",""group1"" ORDER BY ""start_date"""
416,"WITH ""t"" (""dateval"", ""state"") AS (SELECT ""fail_date"",'failed' FROM ""Failed"" UNION ALL SELECT ""success_date"",'succeeded' FROM ""Succeeded"") SELECT DISTINCT ""state"" AS ""period_state"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"") AS ""start_date"",FIRST_VALUE(""dateval"") OVER (PARTITION BY ""IslandNumber"" ORDER BY ""dateval"" DESC) AS ""end_date"" FROM (SELECT SUM(CASE WHEN ""Prevstate"" IS NULL OR ""prevstate""!=""state"" THEN 1 ELSE 0 END) OVER (ORDER BY ""dateval"") AS ""IslandNumber"",""dateval"",""state"" FROM (SELECT ""dateval"",""state"",LAG(""state"") OVER (ORDER BY ""dateval"") AS ""prevstate"" FROM ""t"" WHERE ""dateval"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t1"") AS ""t2"""
417,"SELECT ""stats"" AS ""period_state"",MIN(""day"") AS ""start_date"",MAX(""day"") AS ""end_date"" FROM (SELECT ""day"",""stats"",""rk"",ROW_NUMBER() OVER (ORDER BY ""day"") AS ""overall"",(ROW_NUMBER() OVER (ORDER BY ""day""))-""rk"" AS ""inv"" FROM (SELECT ""fail_date"" AS ""day"",'failed' AS ""stats"",ROW_NUMBER() OVER (ORDER BY ""fail_date"") AS ""rk"" FROM ""Failed"" WHERE ""fail_date"" BETWEEN '2019-01-01' AND '2019-12-31' UNION SELECT ""success_date"" AS ""day"",'succeeded' AS ""stats"",ROW_NUMBER() OVER (ORDER BY ""success_date"") AS ""rk"" FROM ""Succeeded"" WHERE ""success_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""t"") AS ""c"" GROUP BY ""inv"",""stats"" ORDER BY ""start_date"""
