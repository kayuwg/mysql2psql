id,original query
1,"WITH ""bigtime_nerd"" AS (SELECT ""name"" FROM (SELECT ""user_id"",COUNT(1) AS ""total"" FROM ""movie_rating"" AS ""m"" GROUP BY 1 ORDER BY 2 DESC) AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" ORDER BY ""total"" DESC,""name"" LIMIT 1), ""moviezz"" AS (SELECT ""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""average"" FROM ""movie_rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1) AS ""f"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""f"".""movie_id"" ORDER BY ""average"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""bigtime_nerd"" UNION ALL SELECT ""title"" AS ""results"" FROM ""moviezz"""
2,"WITH ""t1"" AS (SELECT ""name"" AS ""results"",COUNT(1) AS ""agg"" FROM ""users"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""t2"" AS (SELECT ""title"" AS ""results"",SUM(""rating"")/COUNT(""user_id"") AS ""agg"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""results"" FROM ""t1"" UNION SELECT ""results"" FROM ""t2"""
3,"(SELECT ""name"" AS ""results"" FROM ""Movie_rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""mo"" ON ""mr"".""movie_id""=""mo"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY%m')='202002' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
4,"(SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""m"".""user_id"") FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""m"".""user_id"") DESC,""u"".""name"") AS ""temp"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM (SELECT ""m1"".""title"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""m1"" ON ""m"".""movie_id""=""m1"".""movie_id"" WHERE LEFT(""m"".""created_at"", 7)='2020-02' GROUP BY ""m1"".""title"" ORDER BY AVG(""m"".""rating"") DESC,""m1"".""title"") AS ""temp"" LIMIT 1)"
5,"(SELECT ""u"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"" ORDER BY ""a"".""cnt"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
6,"WITH ""most_ratings"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""count_rank"" FROM ""movie_rating"" GROUP BY 1), ""highest_avg"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""avg_rank"" FROM ""movie_rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_ratings"" WHERE ""count_rank""=1) ORDER BY ""name"" LIMIT 1) AS ""u"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""highest_avg"" WHERE ""avg_rank""=1) ORDER BY ""title"" LIMIT 1) AS ""m"""
7,"WITH ""temp1"" AS (SELECT ""m"".""user_id"",""u"".""name"",COUNT(1) AS ""cnt"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1), ""temp2"" AS (SELECT ""m"".""movie_id"",AVG(""m"".""rating"") AS ""rate"",""Movies"".""title"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" ON ""m"".""movie_id""=""Movies"".""movie_id"" WHERE TO_CHAR(""m"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY ""rate"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""temp1"" UNION ALL SELECT ""title"" FROM ""temp2"""
8,"SELECT ""otr"".""name"" AS ""results"" FROM ((SELECT ""name"",COUNT(1) FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION (SELECT ""title"",AVG(""rating"") FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE EXTRACT(MONTH FROM ""r"".""created_at"")='02' AND EXTRACT(YEAR FROM ""r"".""created_at"")='2020' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)) AS ""otr"""
9,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",RANK() OVER (ORDER BY COUNT(1) DESC,""u"".""name"") AS ""r"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""u"".""name"") AS ""x"" WHERE ""r""=1 UNION SELECT ""title"" FROM (SELECT ""m"".""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""m"".""title"") AS ""r"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""m"".""title"") AS ""x"" WHERE ""r""=1"
10,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""r1"" ON ""u"".""user_id""=""r1"".""user_id"" GROUP BY ""u"".""user_id"",""u"".""name"" ORDER BY COUNT(DISTINCT ""r1"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r2"" ON ""m"".""movie_id""=""r2"".""movie_id"" WHERE TO_CHAR(""r2"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"",""m"".""title"" ORDER BY AVG(""r2"".""rating"") DESC,""m"".""title"" LIMIT 1)"
11,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Users"" AS ""u"" ON (""r"".""user_id""=""u"".""user_id"") GROUP BY ""r"".""user_id"" ORDER BY COUNT(""r"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Movies"" AS ""m"" ON (""r"".""movie_id""=""m"".""movie_id"") WHERE ""r"".""created_at"" LIKE '2020-02%' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
12,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"",""u"".""name"" ORDER BY COUNT(""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""movie_id"",""m"".""title"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1)"
13,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""name"",COUNT(1) AS ""num_movies"" FROM ""Movie_Rating"" AS ""mr1"" JOIN ""Users"" AS ""u"" ON ""mr1"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""num_movies"" DESC,""name"" LIMIT 1) AS ""a"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"",AVG(""mr2"".""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr2"" JOIN ""Movies"" AS ""m"" ON ""mr2"".""movie_id""=""m"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""title"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""b"""
14,"WITH ""cte"" AS (SELECT ""user_id"",""name"",DENSE_RANK() OVER (ORDER BY ""holder"" DESC) AS ""rnk"" FROM (SELECT DISTINCT ""m"".""user_id"",""u"".""name"",COUNT(""m"".""movie_id"") OVER (PARTITION BY ""m"".""user_id"") AS ""holder"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"") AS ""temp""), ""cte2"" AS (SELECT ""Results"",""movie_id"",DENSE_RANK() OVER (ORDER BY ""rating"" DESC) AS ""rnk"" FROM (SELECT ""e"".""title"" AS ""Results"",""e"".""movie_id"",AVG(""m"".""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""e"" ON ""e"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"") AS ""temp"") (SELECT ""name"" AS ""Results"" FROM ""cte"" WHERE ""rnk""=1 ORDER BY ""name"" LIMIT 1) UNION (SELECT ""Results"" FROM ""cte2"" WHERE ""rnk""=1 ORDER BY ""Results"" LIMIT 1)"
15,"(SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""name"",RANK() OVER (ORDER BY COUNT(""rating"") DESC) AS ""rank1"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"") AS ""a"" WHERE ""rank1""=1 ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"" AS ""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""rank1"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""mr"".""movie_id"") AS ""b"" WHERE ""rank1""=1 ORDER BY ""title"" LIMIT 1)"
16,"(SELECT ""u"".""name"" AS ""results"" FROM (""movie_rating"" AS ""mr"") CROSS JOIN ""users"" AS ""u"" WHERE ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""mr"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM (""movie_rating"" AS ""mr"") CROSS JOIN ""movies"" AS ""m"" WHERE ""mr"".""movie_id""=""m"".""movie_id"" AND LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
17,"SELECT ""t"".""name"" AS ""results"" FROM (SELECT ""name"",COUNT(1) AS ""rvw_cnt"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""name"" ORDER BY ""rvw_cnt"" DESC,""name"" LIMIT 1) AS ""t"" UNION SELECT ""mo"".""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rtng"" FROM ""movie_rating"" AS ""a"" JOIN ""movies"" AS ""m"" ON ""a"".""movie_id""=""m"".""movie_id"" WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY ""title"" ORDER BY ""avg_rtng"" DESC,""title"" LIMIT 1) AS ""mo"""
18,"WITH ""tmp"" AS (SELECT ""u"".""name"",COUNT(""movie_rating"".""movie_id"") AS ""cnts"" FROM ""movie_rating"" LEFT JOIN ""users"" AS ""u"" ON ""movie_rating"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY ""cnts"" DESC,""u"".""name"" LIMIT 1), ""tmp2"" AS (SELECT ""movies"".""title"",AVG(""rating"") FROM ""movie_rating"" LEFT JOIN ""movies"" ON ""movie_rating"".""movie_id""=""movies"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_rating"".""movie_id"" ORDER BY AVG(""rating"") DESC,""movies"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""tmp"" UNION SELECT ""title"" AS ""results"" FROM ""tmp2"""
19,"WITH ""tmp"" AS (SELECT ""user_id"",COUNT(1) AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id""), ""tmp1"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""rate"" FROM ""movie_rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") (SELECT ""name"" AS ""results"" FROM ""tmp"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""tmp1"" AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" ORDER BY ""rate"" DESC,""title"" LIMIT 1)"
20,"(SELECT ""name"" AS ""results"" FROM (""movie_rating"") CROSS JOIN ""users"" WHERE ""movie_rating"".""user_id""=""users"".""user_id"" GROUP BY ""movie_rating"".""user_id"" ORDER BY COUNT(1) DESC,""users"".""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (""movie_rating"") CROSS JOIN ""movies"" WHERE ""movie_rating"".""movie_id""=""movies"".""movie_id"" AND EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_rating"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
21,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
22,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
23,"(SELECT ""name"" AS ""results"" FROM ""Users"" LEFT JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""Movies"" LEFT JOIN ""Movie_Rating"" USING (""movie_id"") WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")='202002' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
24,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""name"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
25,"WITH ""joined"" AS (SELECT * FROM (""Users"" JOIN ""Movie_Rating"" USING (""user_id"")) JOIN ""Movies"" USING (""movie_id"")) (SELECT ""name"" AS ""results"" FROM ""joined"" GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""joined"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
26,"(SELECT ""name"" AS ""results"" FROM (SELECT ""m"".""user_id"",""u"".""name"",COUNT(1) AS ""num_rating"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"") AS ""a"" ORDER BY ""num_rating"" DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""mv"".""title"",AVG(""mr"".""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""mv"" ON ""mr"".""movie_id""=""mv"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"") AS ""b"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1)"
27,"WITH ""user_rating_count"" AS (SELECT ""u"".""user_id"",""u"".""name"",COUNT(1) AS ""rating_count"" FROM ""Movie_rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""user_id""), ""max_rating"" AS (SELECT ""name"" FROM ""user_rating_count"" WHERE ""rating_count""=(SELECT MAX(""rating_count"") FROM ""user_rating_count"") ORDER BY ""name"" LIMIT 1), ""movie_rating_month"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id""), ""highest_rating"" AS (SELECT ""m"".""title"" FROM ""movie_rating_month"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""mr"".""avg_rating""=(SELECT MAX(""avg_rating"") FROM ""movie_rating_month"") ORDER BY ""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""max_rating"" UNION SELECT ""title"" AS ""results"" FROM ""highest_rating"""
28,"(SELECT ""results"" FROM (SELECT ""u"".""name"" AS ""results"",COUNT(""u"".""name"") OVER (PARTITION BY ""u"".""user_id"") AS ""r1"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"") AS ""sq"" ORDER BY ""r1"" DESC,""results"" LIMIT 1) UNION ALL (SELECT ""results"" FROM (SELECT ""title"" AS ""results"",AVG(""rating"") OVER (PARTITION BY ""m"".""movie_id"") AS ""r"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", '%m')=2) AS ""sq1"" ORDER BY ""r"" DESC,""results"" LIMIT 1)"
29,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""mr"".""user_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
30,"WITH ""userCte"" AS (SELECT DISTINCT ""m"".""user_id"",""u"".""name"",COUNT(""m"".""user_id"") AS ""ratedCount"" FROM (""Movie_Rating"" AS ""m"") CROSS JOIN ""Users"" AS ""u"" WHERE ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY ""ratedCount"" DESC,""u"".""name"" LIMIT 1), ""highestAvgRating"" AS (SELECT DISTINCT ""r"".""movie_id"",""m"".""title"",AVG(""r"".""rating"") AS ""average"",EXTRACT(MONTH FROM ""r"".""created_at"") AS ""mon"" FROM (""Movie_Rating"" AS ""r"") CROSS JOIN ""movies"" AS ""m"" WHERE EXTRACT(MONTH FROM ""created_at"")='02' AND ""r"".""movie_id""=""m"".""movie_id"" GROUP BY ""r"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""userCte"" UNION ALL SELECT ""title"" AS ""results"" FROM ""highestAvgRating"""
31,"WITH ""user_rated"" AS (SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(0) DESC,""u"".""name"" LIMIT 1), ""movie_rated"" AS (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""user_rated"" UNION ALL SELECT * FROM ""movie_rated"""
32,"(SELECT ""b"".""name"" AS ""results"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1 ORDER BY COUNT(""a"".""movie_id"") DESC,1 LIMIT 1) UNION (SELECT ""b"".""title"" AS ""results"" FROM ""movie_rating"" AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE LEFT(""a"".""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
33,"WITH ""mo"" AS (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" AND TO_CHAR(""mr"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1), ""us"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""mr"".""movie_id"") DESC,""u"".""name"" LIMIT 1) SELECT ""results"" FROM ""us"" UNION ALL SELECT ""results"" FROM ""mo"""
34,"(SELECT ""name"" AS ""results"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY COUNT(""movie_id"") DESC,""name"") AS ""rnk"" FROM ""Movie_Rating"" JOIN ""Users"" USING (""user_id"") GROUP BY 1) AS ""t"" WHERE ""rnk""=1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY ""m_avg"" DESC,""title"") AS ""rnk"" FROM (SELECT *,AVG(""rating"") OVER (PARTITION BY ""movie_id"") AS ""m_avg"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02') AS ""a"" JOIN ""Movies"" USING (""movie_id"")) AS ""b"" WHERE ""rnk""=1)"
35,"(SELECT ""name"" AS ""results"" FROM (SELECT *,RANK() OVER (ORDER BY ""ct"" DESC) AS ""rk"" FROM (SELECT ""user_id"",COUNT(""movie_id"") AS ""ct"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""a"") AS ""b"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""b"".""user_id"" WHERE ""rk""=1 ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT *,RANK() OVER (ORDER BY ""ag"" DESC) AS ""rk"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""ag"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") AS ""c"") AS ""d"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""d"".""movie_id"" WHERE ""rk""=1 ORDER BY ""title"" LIMIT 1)"
36,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",DENSE_RANK() OVER (ORDER BY ""num"" DESC,""name"") AS ""rk"" FROM (SELECT ""u"".""name"",COUNT(""movie_id"") AS ""num"" FROM (""users"" AS ""u"") CROSS JOIN ""movie_rating"" AS ""m"" WHERE ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"") AS ""a"") AS ""b"" WHERE ""b"".""rk""=1 UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",DENSE_RANK() OVER (ORDER BY ""score"" DESC,""title"") AS ""rk"" FROM (SELECT ""m"".""title"",AVG(""rating"") AS ""score"" FROM (SELECT * FROM ""movie_rating"" WHERE ""created_at"" LIKE '2020-02%') AS ""c"" CROSS, ""movies"" AS ""m"" WHERE ""c"".""movie_id""=""m"".""movie_id"" GROUP BY ""c"".""movie_id"") AS ""tt"") AS ""ff"" WHERE ""ff"".""rk""=1"
37,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""r"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""z"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""r"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""y"""
38,"(SELECT ""users"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""users"" ON ""m"".""user_id""=""users"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""users"".""name"" LIMIT 1) UNION (SELECT ""movies"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""movies"" ON ""m"".""movie_id""=""movies"".""movie_id"" WHERE ""m"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""movies"".""title"" ORDER BY AVG(""rating"") DESC,""movies"".""title"" LIMIT 1)"
39,"SELECT * FROM (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""u"".""name"" LIMIT 1) AS ""tmp1"" UNION SELECT * FROM (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1) AS ""tmp2"""
40,"WITH ""joined"" AS (SELECT * FROM (""Users"" JOIN ""Movie_Rating"" USING (""user_id"")) JOIN ""Movies"" USING (""movie_id"")) (SELECT ""name"" AS ""results"" FROM ""joined"" GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""joined"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
41,"WITH ""usr"" AS (SELECT ""name"" AS ""results"",RANK() OVER (ORDER BY COUNT(1) DESC,""name"") AS ""rnk"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name""), ""mve"" AS (SELECT ""title"" AS ""results"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""title"") AS ""rnk"" FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" AND SUBSTR(""r"".""created_at"", 1, 7)='2020-02' GROUP BY ""title"") SELECT ""results"" FROM ""usr"" WHERE ""rnk""=1 UNION ALL SELECT ""results"" FROM ""mve"" WHERE ""rnk""=1"
42,"WITH ""cte"" AS (SELECT ""u"".""name"",COUNT(DISTINCT ""movie_id"") FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY 2 DESC,1 LIMIT 1), ""cte_1"" AS (SELECT ""title"",AVG(""rating"") FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""final"".""name"" AS ""results"" FROM (SELECT ""name"" FROM ""cte"" UNION ALL SELECT ""title"" FROM ""cte_1"") AS ""final"""
43,"(SELECT ""name"" AS ""results"" FROM (SELECT ""mr"".""user_id"",""u"".""name"",COUNT(""mr"".""user_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""b"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",ROUND(AVG(""rating""), 2) AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""a"" LIMIT 1)"
44,"SELECT * FROM (WITH ""tmp"" AS (SELECT ""user_id"",COUNT(1) AS ""rev_count"" FROM ""Movie_Rating"" GROUP BY ""user_id"") SELECT ""U"".""name"" AS ""results"" FROM (SELECT ""user_id"" FROM ""tmp"" WHERE ""rev_count""=(SELECT MAX(""rev_count"") FROM ""tmp"")) AS ""A"" JOIN ""Users"" AS ""U"" ON ""A"".""user_id""=""U"".""user_id"" ORDER BY ""U"".""name"" LIMIT 1) AS ""first"" UNION SELECT * FROM (WITH ""tmp2"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""movie_id"") SELECT ""M"".""title"" AS ""results"" FROM (SELECT ""movie_id"" FROM ""tmp2"" WHERE ""avg_rating""=(SELECT MAX(""avg_rating"") FROM ""tmp2"")) AS ""B"" JOIN ""Movies"" AS ""M"" ON ""B"".""movie_id""=""M"".""movie_id"" ORDER BY ""M"".""title"" LIMIT 1) AS ""fin"""
45,"WITH ""cte"" AS (SELECT ""tab2"".""name"",COUNT(1) AS ""cnt"" FROM ""Movie_Rating"" AS ""tab1"" LEFT JOIN ""Users"" AS ""tab2"" ON ""tab1"".""user_id""=""tab2"".""user_id"" GROUP BY 1 ORDER BY ""name""), ""cte2"" AS (SELECT ""tab2"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""tab1"" LEFT JOIN ""Movies"" AS ""tab2"" ON ""tab1"".""movie_id""=""tab2"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1 ORDER BY ""title"") SELECT ""name"" AS ""results"" FROM (SELECT * FROM ""cte"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1) AS ""tmp"" UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT * FROM ""cte2"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""tmp2"""
46,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""results"" ORDER BY COUNT(""rating"") DESC,""results"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m1"" JOIN ""movie_rating"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""results"" ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1)"
47,"SELECT ""results"" FROM (SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""u"".""user_id"") DESC,""name"" LIMIT 1) AS ""A"" UNION ALL SELECT ""results"" FROM (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""movie_id"",""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) AS ""B"""
48,"WITH ""name"" AS (SELECT ""mr"".""user_id"",COUNT(DISTINCT ""movie_id"") AS ""cnt"",""name"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY 2 DESC,""name"" LIMIT 1), ""title"" AS (SELECT ""title"",AVG(""rating"") AS ""average_rating"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""name"" UNION ALL SELECT ""title"" AS ""results"" FROM ""title"""
49,"WITH ""most_rating"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""rating_rnk"" FROM ""Movie_Rating"" GROUP BY 1), ""avg_highest"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""highest_rnk"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_rating"" WHERE ""rating_rnk""=1) ORDER BY ""name"" LIMIT 1) AS ""m"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""Movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""avg_highest"" WHERE ""highest_rnk""=1) ORDER BY ""title"" LIMIT 1) AS ""c"""
50,"(SELECT ""a"".""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""mr"".""rating"") AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY ""results"" DESC,""u"".""name"") AS ""a"" LIMIT 1) UNION (SELECT ""b"".""title"" AS ""results"" FROM (SELECT ""m"".""title"",AVG(""mr"".""rating"") AS ""res"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE TO_CHAR(""mr"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"") AS ""b"" LIMIT 1)"
51,"SELECT ""name"" AS ""results"" FROM (SELECT ""a"".""user_id"",""a"".""name"",RANK() OVER (ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""a"".""name"") AS ""rnk"" FROM ""Users"" AS ""a"" LEFT JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""user_id"",""name"") AS ""t"" WHERE ""rnk""=1 UNION SELECT ""title"" AS ""results"" FROM (SELECT ""a"".""movie_id"",""a"".""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""a"".""title"") AS ""rnk"" FROM ""Movies"" AS ""a"" LEFT JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"",""title"") AS ""t"" WHERE ""rnk""=1"
52,"SELECT ""results"" FROM (SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""c"" FROM ""Movie_Rating"" JOIN ""Users"" ON ""Users"".""user_id""=""Movie_Rating"".""user_id"" GROUP BY ""name"") AS ""t1"" ORDER BY ""c"" DESC,""name"" LIMIT 1) AS ""t2"" UNION SELECT ""results"" FROM (SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""c"" FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movies"".""movie_id""=""Movie_Rating"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""title"") AS ""t4"" ORDER BY ""c"" DESC,""title"" LIMIT 1) AS ""t3"""
53,"WITH ""t1"" AS (SELECT ""name"" AS ""results"" FROM ""movie_rating"" JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""title"" AS ""results"" FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"""
54,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""resutls"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
55,"WITH ""cte"" AS (SELECT ""m"".""title"" AS ""title"",""u"".""name"" AS ""name"",""mr"".""movie_id"" AS ""movieid"",""mr"".""user_id"" AS ""uid"",""mr"".""rating"" AS ""rating"",""mr"".""created_at"" AS ""cat"" FROM (""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"") JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id""), ""cte1"" AS (SELECT ""name"" FROM ""cte"" GROUP BY ""uid"" HAVING COUNT(""movieid"")=(SELECT MAX(""mcnt"") FROM (SELECT COUNT(""movieid"") AS ""mcnt"" FROM ""cte"" GROUP BY ""uid"") AS ""a"") ORDER BY ""name"" LIMIT 1), ""cte2"" AS (SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") AS ""avrat"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""rnk"" FROM ""cte"" WHERE TO_CHAR(""cat"", 'YYYY-%m')='2020-02' GROUP BY ""title"") AS ""b"" WHERE ""rnk""=1 ORDER BY ""title"" LIMIT 1) SELECT ""cte1"".""name"" AS ""results"" FROM ""cte1"" UNION ALL SELECT ""cte2"".""title"" AS ""results"" FROM ""cte2"""
56,"WITH ""most_rating"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""rate_rank"" FROM ""Movie_Rating"" GROUP BY 1), ""highest_avg"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""rate_rank"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_rating"" WHERE ""rate_rank""=1) ORDER BY ""name"" LIMIT 1) AS ""t1"" UNION ALL SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""Movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""highest_avg"" WHERE ""rate_rank""=1) ORDER BY ""title"" LIMIT 1) AS ""t2"""
57,"WITH ""cte_highest_average_rating"" AS (SELECT ""title"",AVG(""rating"") AS ""rating"" FROM ""MOVIE_RATING"" AS ""T1"" JOIN ""MOVIES"" AS ""T2"" ON ""T1"".""MOVIE_ID""=""T2"".""MOVIE_ID"" WHERE ""CREATED_AT"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""title"" ORDER BY ""rating"" DESC,""title""), ""cte_count_review"" AS (SELECT ""NAME"",COUNT(""t1"".""USER_ID"") AS ""counting"" FROM ""MOVIE_RATING"" AS ""T1"" JOIN ""USERS"" AS ""T2"" ON ""T1"".""USER_ID""=""T2"".""USER_ID"" GROUP BY ""name"" ORDER BY ""counting"" DESC,""name"") (SELECT ""name"" AS ""results"" FROM ""cte_count_review"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""cte_highest_average_rating"" LIMIT 1)"
58,"(SELECT ""u"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"" ORDER BY ""a"".""cnt"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
59,"(SELECT ""name"" AS ""results"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY COUNT(""movie_id"") DESC,""name"") AS ""rnk"" FROM ""Movie_Rating"" JOIN ""Users"" USING (""user_id"") GROUP BY 1) AS ""t"" WHERE ""rnk""=1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY ""m_avg"" DESC,""title"") AS ""rnk"" FROM (SELECT *,AVG(""rating"") OVER (PARTITION BY ""movie_id"") AS ""m_avg"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02') AS ""a"" JOIN ""Movies"" USING (""movie_id"")) AS ""b"" WHERE ""rnk""=1)"
60,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""rating"") DESC,""results"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1)"
61,"WITH ""t1"" AS (SELECT ""name"",RANK() OVER (ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"") AS ""rnk"" FROM ""Movie_Rating"" JOIN ""Users"" USING (""user_id"") GROUP BY ""user_id""), ""t2"" AS (SELECT ""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""title"") AS ""rnk"" FROM ""Movies"" JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""title"") SELECT ""name"" AS ""results"" FROM ""t1"" WHERE ""t1"".""rnk""=1 UNION SELECT ""title"" AS ""results"" FROM ""t2"" WHERE ""t2"".""rnk""=1"
62,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""u"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" AND ""r"".""created_at"" LIKE '2020-02%' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
63,"WITH ""cte"" AS (SELECT ""u"".""name"",COUNT(DISTINCT ""movie_id"") AS ""ct"",RANK() OVER (ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"") AS ""rk"" FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""mr"".""user_id""), ""cte1"" AS (SELECT *,RANK() OVER (ORDER BY ""avgrt"" DESC,""title"") AS ""rk"" FROM (SELECT ""mr"".""movie_id"",""u"".""name"",""mr"".""user_id"",""m"".""title"",""mr"".""rating"",""mr"".""created_at"",AVG(""rating"") AS ""avgrt"" FROM (""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"") LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""movie_id"") AS ""a"") SELECT ""name"" AS ""results"" FROM ""cte"" WHERE ""rk""=1 UNION SELECT ""title"" FROM ""cte1"" WHERE ""rk""=1"
64,"SELECT MIN(""name"") AS ""results"" FROM (SELECT ""m"".""user_id"",""u"".""name"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""m"".""movie_id"") DESC) AS ""rnk"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY 1,2) AS ""t"" WHERE ""rnk""=1 UNION SELECT MIN(""title"") AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",DENSE_RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""rnk"" FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1,2) AS ""tt"" WHERE ""rnk""=1"
65,"SELECT ""name"" AS ""results"" FROM (SELECT *,RANK() OVER (ORDER BY ""num_rating"" DESC,""name"") AS ""rk"" FROM (SELECT ""name"",COUNT(""movie_id"") AS ""num_rating"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY 1) AS ""t1"") AS ""t2"" WHERE ""rk""=1 UNION SELECT ""title"" AS ""results"" FROM (SELECT *,RANK() OVER (ORDER BY ""avg_rating"" DESC,""title"") AS ""rk"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1) AS ""t3"") AS ""t4"" WHERE ""rk""=1"
66,"SELECT * FROM ((SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""mv"" JOIN ""movie_rating"" AS ""m"" ON ""mv"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)) AS ""a"""
67,"WITH ""sub1"" AS (SELECT ""u"".""name"" AS ""name"",COUNT(DISTINCT ""r"".""movie_id"") AS ""num"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""sub2"" AS (SELECT ""m"".""title"" AS ""name"",AVG(""r"".""rating"") AS ""num"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE TO_CHAR(""r"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM (SELECT * FROM ""sub1"" UNION ALL SELECT * FROM ""sub2"") AS ""sub"""
68,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",""u"".""user_id"",COUNT(""rating"") AS ""cnt"" FROM ""users"" AS ""u"" LEFT JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""name"",""user_id"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1) AS ""f"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",""m"".""movie_id"",AVG(""rating"") AS ""avgr"" FROM ""movies"" AS ""m"" LEFT JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""title"",""movie_id"" ORDER BY ""avgr"" DESC,""title"" LIMIT 1) AS ""f2"""
69,"(SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""n_movies_rated"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"") AS ""rater_t"" LIMIT 1) UNION (SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020/02/01' AND ""created_at""<'2020/03/01' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"") AS ""m_t"" LIMIT 1)"
70,"SELECT ""results"" FROM ((SELECT ""B"".""name"" AS ""results"",COUNT(""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""A"" JOIN ""Users"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) UNION (SELECT ""B"".""title"" AS ""results"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""A"" JOIN ""movies"" AS ""B"" ON ""A"".""movie_id""=""B"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1)) AS ""Z"""
71,"(SELECT ""u"".""name"" AS ""Results"" FROM (""Movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"") JOIN ""movies"" AS ""mo"" ON ""mo"".""movie_id""=""m"".""movie_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""mo"".""title"" AS ""Results"" FROM (""Movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"") JOIN ""movies"" AS ""mo"" ON ""mo"".""movie_id""=""m"".""movie_id"" WHERE ""m"".""created_at"">'2020-01-31' AND ""m"".""created_at""<'2020-03-01' GROUP BY ""mo"".""title"" ORDER BY AVG(""m"".""rating"") DESC,""mo"".""title"" LIMIT 1)"
72,"WITH ""cte1"" AS (SELECT ""user_id"",COUNT(""user_id"") AS ""count_movies"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""cte2"" AS (SELECT ""a"".""name"" FROM ""Users"" AS ""a"" RIGHT JOIN ""cte1"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" ORDER BY ""count_movies"" DESC,""a"".""name"" LIMIT 1), ""cte3"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id""), ""cte4"" AS (SELECT ""a"".""title"" FROM ""Movies"" AS ""a"" RIGHT JOIN ""cte3"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" ORDER BY ""avg_rating"" DESC,""a"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte2"" UNION SELECT ""title"" FROM ""cte4"""
73,"(SELECT ""U"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""U"" USING (""user_id"") GROUP BY 1 ORDER BY COUNT(1) DESC,""U"".""name"" LIMIT 1) UNION ALL (SELECT ""M"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""R"" JOIN ""Movies"" AS ""M"" USING (""movie_id"") WHERE TO_CHAR(""R"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""M"".""title"" LIMIT 1)"
74,"(SELECT ""name"" AS ""results"" FROM (SELECT ""mr"".""user_id"",""u"".""name"",COUNT(""mr"".""user_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""user_ratings"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",ROUND(AVG(""rating""), 1) AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""movies_rating"" LIMIT 1)"
75,"WITH ""tem"" AS (SELECT ""a"".*,""b"".""title"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id""), ""tem2"" AS (SELECT ""a"".*,""b"".""name"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"") SELECT ""name"" AS ""results"" FROM ""tem2"" WHERE ""name"" IN (SELECT ""name"" FROM (SELECT ""user_id"",""name"",COUNT(""rating"") AS ""rating"" FROM ""tem2"" GROUP BY ""user_id"" ORDER BY ""rating"" DESC,""name"" LIMIT 1) AS ""a"") UNION (SELECT ""title"" AS ""results"" FROM ""tem"" WHERE ""title"" IN (SELECT ""title"" FROM (SELECT ""movie_id"",""title"",AVG(""rating"") AS ""ave_r"" FROM ""tem"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""movie_id"" ORDER BY ""ave_r"" DESC,""title"" LIMIT 1) AS ""a""))"
76,"(SELECT ""name"" AS ""results"" FROM (SELECT ""mr"".""user_id"",""u"".""name"",COUNT(""mr"".""user_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""b"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",ROUND(AVG(""rating""), 1) AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""a"" LIMIT 1)"
77,"WITH ""cte"" AS (SELECT ""m"".""title"",""u"".""name"",""r"".""rating"",""r"".""created_at"" FROM (""Movie_rating"" AS ""r"" LEFT JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"") LEFT JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id""), ""cte2"" AS (SELECT ""name"",COUNT(""rating"") AS ""r_count"" FROM ""cte"" GROUP BY ""name""), ""cte3"" AS (SELECT ""title"",AVG(""rating"") AS ""r_avg"" FROM ""cte"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""title"") (SELECT ""name"" AS ""results"" FROM ""cte2"" ORDER BY ""r_count"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""cte3"" ORDER BY ""r_avg"" DESC,""title"" LIMIT 1)"
78,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""m1"".""rating"") AS ""rate_num"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m1"" USING (""user_id"") GROUP BY ""u"".""user_id"" ORDER BY ""rate_num"" DESC,""u"".""name"" LIMIT 1) AS ""a"" UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT ""mo"".""title"",AVG(""m2"".""rating"") AS ""rate_avg"" FROM ""Movies"" AS ""mo"" JOIN ""Movie_Rating"" AS ""m2"" USING (""movie_id"") WHERE TO_CHAR(""m2"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""mo"".""title"" ORDER BY ""rate_avg"" DESC,""mo"".""title"" LIMIT 1) AS ""b"""
79,"WITH ""rated"" AS (SELECT ""u"".""name"",COUNT(1) AS ""cnt"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1), ""highest_avg"" AS (SELECT ""m"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""title"" ORDER BY ""avg_rating"" DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""rated"" UNION ALL SELECT ""title"" AS ""results"" FROM ""highest_avg"""
80,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
81,"SELECT DISTINCT ""u1"".""name"" AS ""results"" FROM ""users"" AS ""u1"" JOIN (SELECT ""u"".""name"",COUNT(""movie_id"") FROM ""users"" AS ""u"" LEFT JOIN ""movie_rating"" AS ""m1"" ON ""u"".""user_id""=""m1"".""user_id"" GROUP BY ""m1"".""user_id"" ORDER BY COUNT(""m1"".""movie_id"") DESC,""u"".""name"" LIMIT 1) AS ""temp"" ON ""temp"".""name""=""u1"".""name"" UNION SELECT DISTINCT ""m1"".""title"" AS ""results"" FROM ""movies"" AS ""m1"" JOIN (SELECT ""m"".""title"",AVG(""mr"".""rating"") FROM ""movies"" AS ""m"" LEFT JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1) AS ""temp2"" ON ""temp2"".""title""=""m1"".""title"""
82,"(SELECT ""name"" AS ""results"" FROM ""Users"" JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
83,"WITH ""most_ratings"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""count_rank"" FROM ""movie_rating"" GROUP BY 1), ""highest_avg"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""avg_rank"" FROM ""movie_rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_ratings"" WHERE ""count_rank""=1) ORDER BY ""name"" LIMIT 1) AS ""u"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""highest_avg"" WHERE ""avg_rank""=1) ORDER BY ""title"" LIMIT 1) AS ""m"""
84,"WITH ""cte_top_user"" AS (SELECT ""u"".""name"",COUNT(1) AS ""n_ratings"" FROM ""Movie_rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""n_ratings"" DESC,""u"".""name"" LIMIT 1), ""cte_highest_rated_movie"" AS (SELECT ""m"".""title"" AS ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""mr"".""created_at"", 'YYYY%m')='202002' GROUP BY ""m"".""title"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte_top_user"" UNION SELECT ""title"" AS ""results"" FROM ""cte_highest_rated_movie"""
85,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE LEFT(""c"".""created_at"", 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
86,"WITH ""user_name"" AS (SELECT ""d"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(""rating"") AS ""ct"" FROM ""movie_rating"" GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC) AS ""a"" JOIN ""users"" AS ""d"" ON ""a"".""user_id""=""d"".""user_id"" ORDER BY ""a"".""ct"" DESC,""d"".""name"" LIMIT 1), ""movie_name"" AS (SELECT ""e"".""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""rr"" FROM ""movie_rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC) AS ""q"" JOIN ""movies"" AS ""e"" ON ""q"".""movie_id""=""e"".""movie_id"" ORDER BY ""q"".""rr"" DESC,""e"".""title"" LIMIT 1) SELECT ""results"" FROM ""user_name"" UNION ALL SELECT ""results"" FROM ""movie_name"""
87,"WITH ""CTE_1"" AS (SELECT ""M"".""MOVIE_ID"",""TITLE"",AVG(""RATING"") AS ""AVG_RATING"",RANK() OVER (ORDER BY AVG(""RATING""),""TITLE"" DESC) AS ""RANK_NUM"" FROM (""MOVIES"" AS ""M"") CROSS JOIN ""MOVIE_RATING"" AS ""R"" WHERE ""M"".""MOVIE_ID""=""R"".""MOVIE_ID"" AND EXTRACT(MONTH FROM ""CREATED_AT"")='02' GROUP BY ""MOVIE_ID"",""TITLE""), ""CTE_2"" AS (SELECT ""TITLE"",""AVG_RATING"",""RANK_NUM"" FROM ""CTE_1"" WHERE ""AVG_RATING""=(SELECT MAX(""AVG_RATING"") FROM ""CTE_1"") ORDER BY ""RANK_NUM"" DESC LIMIT 1), ""CTE_3"" AS (SELECT ""NAME"",""R"".""USER_ID"",COUNT(""R"".""USER_ID"") AS ""USER_COUNT"",RANK() OVER (ORDER BY COUNT(""R"".""USER_ID"") DESC,""NAME"") AS ""RANK_NUM"" FROM (""USERS"" AS ""U"") CROSS JOIN ""MOVIE_RATING"" AS ""R"" WHERE ""U"".""USER_ID""=""R"".""USER_ID"" GROUP BY ""NAME"",""R"".""USER_ID""), ""CTE_4"" AS (SELECT ""NAME"",""USER_ID"",""RANK_NUM"" FROM ""CTE_3"" WHERE ""USER_COUNT""=(SELECT MAX(""USER_COUNT"") FROM ""CTE_3"") ORDER BY ""RANK_NUM"" LIMIT 1) SELECT ""NAME"" AS ""RESULTS"" FROM ""CTE_4"" UNION SELECT ""TITLE"" AS ""RESULTS"" FROM ""CTE_2"""
88,"WITH ""cte"" AS (SELECT ""user_id"",""name"",DENSE_RANK() OVER (ORDER BY ""holder"" DESC) AS ""rnk"" FROM (SELECT DISTINCT ""m"".""user_id"",""u"".""name"",COUNT(""m"".""movie_id"") OVER (PARTITION BY ""m"".""user_id"") AS ""holder"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"") AS ""temp""), ""cte2"" AS (SELECT ""Results"",""movie_id"",DENSE_RANK() OVER (ORDER BY ""rating"" DESC) AS ""rnk"" FROM (SELECT ""e"".""title"" AS ""Results"",""e"".""movie_id"",AVG(""m"".""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""e"" ON ""e"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"") AS ""temp"") (SELECT ""name"" AS ""Results"" FROM ""cte"" WHERE ""rnk""=1 ORDER BY ""name"" LIMIT 1) UNION (SELECT ""Results"" FROM ""cte2"" WHERE ""rnk""=1 ORDER BY ""Results"" LIMIT 1)"
89,"SELECT ""name"" AS ""results"" FROM (SELECT ""m"".""user_id"",""u"".""name"",COUNT(DISTINCT ""m"".""movie_id"") AS ""total_rate"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY ""total_rate"" DESC,""name"" LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",AVG(""r"".""rating"") AS ""avg_rating"" FROM ""movies"" AS ""m"" LEFT JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE SUBSTRING(""r"".""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""t2"""
90,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(""movie_id"") AS ""num"" FROM ""Movie_rating"" JOIN ""Users"" ON ""Movie_rating"".""user_id""=""Users"".""user_id"" GROUP BY ""name"" ORDER BY ""num"" DESC,""name"" LIMIT 1) AS ""t"" UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""rate"" FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movie_rating"".""movie_id""=""Movies"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""title"" ORDER BY ""rate"" DESC,""title"" LIMIT 1) AS ""t1"""
91,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""u"" ON ""M"".""user_id""=""u"".""user_id"" GROUP BY ""M"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Movies"" AS ""m"" ON ""a"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""a"".""created_at"")=2 GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1)"
92,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
93,"WITH ""t1"" AS (SELECT ""b"".""name"",COUNT(DISTINCT ""a"".""movie_id"") AS ""rating_qty"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""b"".""name"" ORDER BY ""rating_qty"" DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""b"".""title"",AVG(""a"".""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""b"".""title"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""t1"" UNION ALL SELECT ""title"" AS ""results"" FROM ""t2"""
94,"WITH ""user_name"" AS (SELECT ""d"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(""rating"") AS ""ct"" FROM ""movie_rating"" GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC) AS ""a"" JOIN ""users"" AS ""d"" ON ""a"".""user_id""=""d"".""user_id"" ORDER BY ""a"".""ct"" DESC,""d"".""name"" LIMIT 1), ""movie_name"" AS (SELECT ""e"".""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""rr"" FROM ""movie_rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC) AS ""q"" JOIN ""movies"" AS ""e"" ON ""q"".""movie_id""=""e"".""movie_id"" ORDER BY ""q"".""rr"" DESC,""e"".""title"" LIMIT 1) SELECT ""results"" FROM ""user_name"" UNION ALL SELECT ""results"" FROM ""movie_name"""
95,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
96,"WITH ""most_ratings"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""count_rank"" FROM ""movie_rating"" GROUP BY 1), ""highest_avg"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""avg_rank"" FROM ""movie_rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_ratings"" WHERE ""count_rank""=1) ORDER BY ""name"" LIMIT 1) AS ""u"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""highest_avg"" WHERE ""avg_rank""=1) ORDER BY ""title"" LIMIT 1) AS ""m"""
97,"WITH ""most_ratings"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""count_rank"" FROM ""movie_rating"" GROUP BY 1), ""highest_avg"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""avg_rank"" FROM ""movie_rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_ratings"" WHERE ""count_rank""=1) ORDER BY ""name"",LENGTH(""name"") LIMIT 1) AS ""u"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""highest_avg"" WHERE ""avg_rank""=1) ORDER BY ""title"",LENGTH(""title"") LIMIT 1) AS ""m"""
98,"(SELECT ""name"" AS ""results"" FROM ""Users"" JOIN (SELECT ""user_id"",COUNT(""mr"".""rating"") AS ""cnt_r"" FROM ""Movie_Rating"" AS ""mr"" GROUP BY 1) AS ""u"" USING (""user_id"") ORDER BY ""cnt_r"" DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"",AVG(""mr0"".""rating"") AS ""avg_r"" FROM ""Movie_Rating"" AS ""mr0"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1) AS ""r"" USING (""movie_id"") ORDER BY ""avg_r"" DESC,""title"" LIMIT 1)"
99,"(SELECT ""name"" AS ""results"" FROM (SELECT ""user_id"" FROM ""Movie_Rating"" GROUP BY 1 HAVING COUNT(1)=(SELECT COUNT(""rating"") AS ""c1"" FROM ""Movie_Rating"" GROUP BY ""user_id"" ORDER BY 1 DESC LIMIT 1)) AS ""t1"" JOIN ""users"" AS ""u"" ON ""t1"".""user_id""=""u"".""user_id"" ORDER BY ""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM (SELECT ""movie_id"" FROM ""Movie_rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"" HAVING AVG(""rating"")=(SELECT AVG(""rating"") FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"" ORDER BY 1 DESC LIMIT 1)) AS ""t2"" JOIN ""movies"" AS ""m"" ON ""t2"".""movie_id""=""m"".""movie_id"" ORDER BY ""title"" LIMIT 1)"
100,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-28' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
101,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(""created_at"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""Movies"".""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR FROM ""created_at"")='2020' AND EXTRACT(MONTH FROM ""created_at"")='2' GROUP BY ""movie_id"") AS ""a"" LEFT JOIN ""Movies"" ON ""a"".""movie_id""=""Movies"".""movie_id"" ORDER BY ""a"".""rating"" DESC,""Movies"".""title"" LIMIT 1)"
102,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
103,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN (SELECT ""user_id"",COUNT(""user_id"") AS ""cnt"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""m"".""cnt"" DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""movie_id"") AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" ORDER BY ""mr"".""rating"" DESC,""m"".""title"" LIMIT 1)"
104,"WITH ""CTE"" AS (SELECT ""U"".""NAME"" FROM ""Users"" AS ""U"" JOIN ""Movie_Rating"" AS ""M"" ON ""U"".""USER_ID""=""M"".""USER_ID"" GROUP BY ""M"".""USER_ID"" HAVING COUNT(""M"".""MOVIE_ID"") ORDER BY COUNT(""M"".""MOVIE_ID"") DESC,""U"".""NAME"" LIMIT 1), ""CTE2"" AS (SELECT ""MV"".""TITLE"",AVG(""M"".""RATING"") FROM ""MOVIES"" AS ""MV"" JOIN ""Movie_Rating"" AS ""M"" ON ""MV"".""movie_id""=""M"".""movie_id"" WHERE EXTRACT(MONTH FROM ""M"".""created_at"")=2 AND EXTRACT(YEAR FROM ""M"".""created_at"")=2020 GROUP BY ""M"".""MOVIE_ID"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""NAME"" AS ""results"" FROM ""cte"" UNION SELECT ""title"" AS ""results"" FROM ""cte2"""
105,"(SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""ct"" FROM ""Movie_Rating"" AS ""c"" LEFT JOIN ""Users"" AS ""d"" ON ""c"".""user_id""=""d"".""user_id"" GROUP BY ""c"".""user_id"") AS ""p"" ORDER BY ""ct"" DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""a"".""movie_id"") AS ""t"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1)"
106,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""sub"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""r"".""movie_id"",""title"",AVG(""rating"") FROM (SELECT * FROM ""movie_rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02') AS ""r"" JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) AS ""sub"""
107,"WITH ""temp0"" AS (SELECT ""user_id"",COUNT(""user_id"") AS ""user_cnt"" FROM ""Movie_Rating"" GROUP BY 1), ""temp1"" AS (SELECT MAX(""user_cnt"") AS ""max_cnt"" FROM ""temp0""), ""temp2"" AS (SELECT ""name"" FROM ""Users"" AS ""a"" JOIN ""temp0"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" WHERE ""b"".""user_cnt""=(SELECT ""max_cnt"" FROM ""temp1"") ORDER BY 1 LIMIT 1), ""temp3"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""movie_rate"" FROM ""Movie_Rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1), ""temp4"" AS (SELECT ""movie_id"",MAX(""movie_rate"") AS ""max_rate"" FROM ""temp3"") SELECT ""name"" AS ""results"" FROM ""temp2"" UNION (SELECT ""title"" AS ""results"" FROM ""temp3"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""a"".""movie_rate""=(SELECT ""max_rate"" FROM ""temp4"") ORDER BY 1 LIMIT 1)"
108,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"",""u"".""name"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
109,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(""created_at"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""Movies"".""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR FROM ""created_at"")='2020' AND EXTRACT(MONTH FROM ""created_at"")='2' GROUP BY ""movie_id"") AS ""a"" LEFT JOIN ""Movies"" ON ""a"".""movie_id""=""Movies"".""movie_id"" ORDER BY ""a"".""rating"" DESC,""Movies"".""title"" LIMIT 1)"
110,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""r"".""movie_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""r"".""user_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""a"" UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT ""title"" FROM (SELECT ""m"".""title"",AVG(""r"".""rating"") AS ""rating"",TO_CHAR(""created_at"", 'YYYY-%m') AS ""month"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" GROUP BY ""r"".""movie_id"",3 ORDER BY 2 DESC,1) AS ""b"" WHERE ""month""='2020-02' LIMIT 1) AS ""c"""
111,"WITH ""bigtime_nerd"" AS (SELECT ""name"" FROM (SELECT ""user_id"",COUNT(1) AS ""total"" FROM ""movie_rating"" AS ""m"" GROUP BY 1 ORDER BY 2 DESC) AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" ORDER BY ""total"" DESC,""name"" LIMIT 1), ""moviezz"" AS (SELECT ""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""average"" FROM ""movie_rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1) AS ""f"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""f"".""movie_id"" ORDER BY ""average"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""bigtime_nerd"" UNION ALL SELECT ""title"" AS ""results"" FROM ""moviezz"""
112,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM ""Movie_Rating"" LEFT JOIN ""Movies"" ON ""Movies"".""movie_id""=""Movie_Rating"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""Movies"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
113,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Users"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Movies"" ON ""Movie_Rating"".""movie_id""=""Movies"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""Movies"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
114,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
115,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
116,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
117,"WITH ""cte1"" AS (SELECT ""u"".""user_id"",""u"".""name"",COUNT(""rating"") AS ""most_rating"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""user_id"" ORDER BY ""most_rating"" DESC,""u"".""name""), ""cte2"" AS (SELECT ""m"".""movie_id"",""m"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr1"" JOIN ""Movies"" AS ""m"" ON ""mr1"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""mr1"".""created_at"")=2 GROUP BY ""movie_id"" ORDER BY ""avg_rating"" DESC,""m"".""title"") SELECT ""name"" AS ""results"" FROM ""cte1"" HAVING MAX(""most_rating"") UNION ALL SELECT ""title"" FROM ""cte2"" HAVING MAX(""avg_rating"")"
118,"WITH ""CTE1"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""average"" FROM ""movie_rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id""), ""CTE2"" AS (SELECT ""title"" FROM ""CTE1"" AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" ORDER BY ""average"" DESC,""title"" LIMIT 1), ""CTE3"" AS (SELECT ""name"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""b"".""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""CTE3"" UNION SELECT ""title"" FROM ""CTE2"""
119,"WITH ""high_user"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""m"".""rating"") DESC,""u"".""name"" LIMIT 1), ""high_movie"" AS (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR_MONTH FROM ""mr"".""created_at"")='202002' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1) SELECT ""results"" FROM ""high_user"" UNION ALL SELECT ""results"" FROM ""high_movie"""
120,"(SELECT ""U"".""name"" AS ""results"" FROM (""Movie_Rating"" AS ""M"") CROSS JOIN ""Users"" AS ""U"" WHERE ""M"".""user_id""=""U"".""user_id"" GROUP BY ""M"".""user_id"" ORDER BY COUNT(DISTINCT ""M"".""movie_id"") DESC,""U"".""name"" LIMIT 1) UNION (SELECT ""M2"".""title"" AS ""results"" FROM (""Movie_Rating"" AS ""M1"") CROSS JOIN ""Movies"" AS ""M2"" WHERE ""M1"".""movie_id""=""M2"".""movie_id"" AND EXTRACT(MONTH FROM ""M1"".""created_at"")=2 AND EXTRACT(YEAR FROM ""M1"".""created_at"")=2020 GROUP BY ""M1"".""movie_id"" ORDER BY AVG(""M1"".""rating"") DESC,""M2"".""title"" LIMIT 1)"
121,"(SELECT ""Users"".""name"" AS ""results"" FROM ""Users"" JOIN ""Movie_Rating"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(""results"") DESC,""Users"".""name"" LIMIT 1) UNION (SELECT ""Movies"".""title"" FROM ""Movies"" JOIN ""Movie_Rating"" ON ""Movie_Rating"".""movie_id""=""Movies"".""movie_id"" WHERE ""created_at"" LIKE ('2020-02%') GROUP BY ""Movie_Rating"".""movie_id"" ORDER BY AVG(""Movie_Rating"".""rating"") DESC,""Movies"".""title"" LIMIT 1)"
122,"WITH ""rt"" AS (SELECT ""u"".""name"",COUNT(1) FROM ""movie_rating"" AS ""r"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1), ""mv"" AS (SELECT ""m"".""title"" AS ""name"",AVG(""rating"") FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""r"".""created_at"", 'YYYY%m')='202002' GROUP BY ""m"".""title"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1) SELECT ""rt"".""name"" AS ""results"" FROM ""rt"" UNION SELECT ""mv"".""name"" AS ""results"" FROM ""mv"""
123,"SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) AS ""t1"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) AS ""t2"""
124,"SELECT * FROM (SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE ""r"".""created_at"" BETWEEN DATE('2020-2-1') AND DATE('2020-2-29') GROUP BY ""r"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1) AS ""t2"""
125,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(""movie_id"") AS ""num"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""cte2"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id""), ""cte3"" AS (SELECT ""name"" AS ""results"" FROM ""cte"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""cte"".""user_id"" ORDER BY ""num"" DESC,""name"" LIMIT 1), ""cte4"" AS (SELECT ""title"" AS ""results"" FROM ""cte2"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""cte2"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) SELECT * FROM ""cte3"" UNION SELECT * FROM ""cte4"""
126,"(SELECT ""a"".""name"" AS ""results"" FROM ""Users"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""name"" ORDER BY COUNT(1) DESC,""results"" LIMIT 1) UNION (SELECT ""a"".""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" AND ""b"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""a"".""title"" ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1)"
127,"WITH ""cte"" AS (SELECT ""r"".""movie_id"",""m"".""title"",""r"".""user_id"",""u"".""name"",""r"".""rating"",""r"".""created_at"" FROM (""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"") JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""r"".""movie_id"",""r"".""user_id"" ORDER BY ""r"".""movie_id"",""r"".""user_id""), ""cte2"" AS (SELECT DISTINCT ""cte"".""title"" AS ""results"",AVG(""cte"".""rating"") OVER (PARTITION BY ""cte"".""movie_id"") AS ""score"" FROM ""cte"" WHERE EXTRACT(MONTH FROM ""cte"".""created_at"")='02' ORDER BY 2 DESC,1 LIMIT 1), ""cte3"" AS (SELECT DISTINCT ""cte"".""name"",COUNT(""cte"".""rating"") OVER (PARTITION BY ""cte"".""user_id"") AS ""rtcnt"" FROM ""cte"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""cte3"".""name"" AS ""results"" FROM ""cte3"" UNION SELECT ""cte2"".""results"" FROM ""cte2"""
128,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""mov"" JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM ""movie_rating"" AS ""mov"" JOIN ""movies"" AS ""m"" USING (""movie_id"") WHERE ""created_at"">='2020-02-01' AND ""created_at""<'2020-03-01' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
129,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
130,"WITH ""most_ratings"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""count_rank"" FROM ""movie_rating"" GROUP BY 1), ""highest_avg"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""avg_rank"" FROM ""movie_rating"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY 1) SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""most_ratings"" WHERE ""count_rank""=1) ORDER BY ""name"" LIMIT 1) AS ""u"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""highest_avg"" WHERE ""avg_rank""=1) ORDER BY ""title"" LIMIT 1) AS ""m"""
131,"(SELECT DISTINCT ""b"".""name"" AS ""results"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""b"".""name"" HAVING COUNT(DISTINCT ""a"".""movie_id"")=(SELECT DISTINCT COUNT(DISTINCT ""a"".""movie_id"") AS ""movies"" FROM ""movie_rating"" AS ""a"" GROUP BY ""a"".""user_id"" ORDER BY ""movies"" DESC LIMIT 1) ORDER BY ""b"".""name"" LIMIT 1) UNION (SELECT DISTINCT ""b"".""title"" AS ""results"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""a"".""created_at"" LIKE '%2020-02%' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""b"".""title"" LIMIT 1)"
132,"WITH ""cte"" AS (SELECT ""name"",COUNT(1) AS ""cnt"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""cte2"" AS (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE SUBSTR(""a"".""created_at"", 1, 7)='2020-02' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte"" UNION SELECT ""title"" AS ""results"" FROM ""cte2"""
133,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_Rating"" AS ""m"" USING (""user_id"") GROUP BY 1 ORDER BY COUNT(DISTINCT ""movie_id"") DESC,1 LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""a"" JOIN ""movie_Rating"" AS ""m"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
134,"(SELECT ""U"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""U"" USING (""user_id"") GROUP BY 1 ORDER BY COUNT(1) DESC,""U"".""name"" LIMIT 1) UNION ALL (SELECT ""M"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""R"" JOIN ""Movies"" AS ""M"" USING (""movie_id"") WHERE TO_CHAR(""R"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""M"".""title"" LIMIT 1)"
135,"WITH ""cte"" AS (SELECT ""tab2"".""name"",COUNT(1) AS ""cnt"" FROM ""Movie_Rating"" AS ""tab1"" LEFT JOIN ""Users"" AS ""tab2"" ON ""tab1"".""user_id""=""tab2"".""user_id"" GROUP BY 1 ORDER BY ""name""), ""cte2"" AS (SELECT ""tab2"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""tab1"" LEFT JOIN ""Movies"" AS ""tab2"" ON ""tab1"".""movie_id""=""tab2"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1 ORDER BY ""title"") (SELECT ""name"" AS ""results"" FROM (SELECT * FROM ""cte"" ORDER BY ""cnt"" DESC,""name"") AS ""tmp"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM (SELECT * FROM ""cte2"" ORDER BY ""avg_rating"" DESC,""title"") AS ""tmp2"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1)"
136,"(SELECT DISTINCT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""m"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1)"
137,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""m"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""u"".""title"" AS ""results"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""movies"" AS ""u"" ON ""u"".""movie_id""=""m"".""movie_id"" WHERE ""m"".""created_at"" LIKE '2020-02%' GROUP BY ""u"".""title"" ORDER BY AVG(""m"".""rating"") DESC,""u"".""title"" LIMIT 1)"
138,"WITH ""cte"" AS (SELECT ""u"".""name"",COUNT(1) FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY 2 DESC,1 LIMIT 1), ""cte1"" AS (SELECT ""m"".""title"",AVG(""mr"".""rating"") FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""m"".""title"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte"" UNION SELECT ""title"" AS ""results"" FROM ""cte1"""
139,"WITH ""UserRanking"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""movie_id"") DESC) AS ""Rk"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""MovieRanking"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""Rk"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"") SELECT MIN(""U"".""name"") AS ""results"" FROM ""Users"" AS ""U"" JOIN ""UserRanking"" AS ""UR"" ON ""UR"".""user_id""=""U"".""user_id"" AND ""Rk""=1 UNION ALL SELECT MIN(""M"".""title"") FROM ""Movies"" AS ""M"" JOIN ""MovieRanking"" AS ""MR"" ON ""M"".""movie_id""=""MR"".""movie_id"" AND ""Rk""=1"
140,"WITH ""q1"" AS (SELECT ""u"".""name"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1), ""q2"" AS (SELECT ""n"".""title"" FROM ""Movies"" AS ""n"" JOIN ""Movie_Rating"" AS ""m"" ON ""n"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""n"".""title"" ORDER BY AVG(""m"".""rating"") DESC,""n"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""q1"" UNION ALL SELECT ""title"" AS ""results"" FROM ""q2"""
141,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""total_rated_by_user"" FROM ""movie_rating"" JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""t"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")='202002' GROUP BY ""movie_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""t"""
142,"WITH ""uname"" AS (SELECT ""name"",RANK() OVER (ORDER BY COUNT(""rating"") DESC,""name"") AS ""rk"" FROM ""Users"" AS ""u"" JOIN ""Movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1), ""umovie"" AS (SELECT ""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""title"") AS ""rk"" FROM ""Movies"" AS ""m"" JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""title"") SELECT ""name"" AS ""results"" FROM ""uname"" WHERE ""rk""=1 UNION ALL SELECT ""title"" AS ""results"" FROM ""umovie"" WHERE ""rk""=1"
143,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""mr1"" LEFT JOIN ""users"" AS ""u"" ON ""mr1"".""user_id""=""u"".""user_id"" GROUP BY ""mr1"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
144,"SELECT ""name"" AS ""results"" FROM ((SELECT ""name"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM ""movie_rating"" AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""a"".""movie_id"" ORDER BY SUM(""rating"")/COUNT(""rating"") DESC,""title"" LIMIT 1)) AS ""b"""
145,"ERROR: mysql parse error: line 1 column 4 near ""from users u join (select user_id, count(rating) as cnt from movie_rating group by user_id) m using (user_id) order by m.cnt desc, u.name limit 1), r2 as (select m.title as results from movies m join (select movie_id, avg(rating) as rt from movie_rating where date_format(created_at, '%Y-%m')='2020-02' group by movie_id) r using (movie_id) order by r.rt desc, m.title limit 1) select * from r1 union all select * from r2 "" "
146,"WITH ""user_rated_more_movies"" AS (SELECT ""u"".""name"",DENSE_RANK() OVER (ORDER BY COUNT(""mr"".""movie_id"") DESC,""u"".""name"") AS ""rnk"" FROM ""Movie_rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON (""mr"".""user_id""=""u"".""user_id"") GROUP BY ""u"".""name""), ""movie_rating"" AS (SELECT ""m"".""title"" AS ""name"",DENSE_RANK() OVER (ORDER BY AVG(""rating"") DESC,""m"".""title"") AS ""rnk"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON (""mr"".""movie_id""=""m"".""movie_id"") WHERE ""mr"".""created_at"">='2020-02-01' AND ""mr"".""created_at""<='2020-02-28' GROUP BY ""m"".""title"") SELECT ""name"" AS ""results"" FROM ""user_rated_more_movies"" WHERE ""rnk""=1 UNION SELECT ""name"" AS ""results"" FROM ""movie_rating"" WHERE ""rnk""=1"
147,"SELECT ""Z"".""results"" FROM (SELECT ""X"".""name"" AS ""results"" FROM (SELECT ""a"".""name"",""b"".""user_id"",COUNT(""b"".""movie_id"") AS ""count"" FROM ""Users"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""name"",""b"".""user_id"" ORDER BY ""count"" DESC,""a"".""name"" LIMIT 1) AS ""X"" UNION SELECT ""Y"".""title"" AS ""results"" FROM (SELECT ""c"".""title"",""d"".""movie_id"",AVG(""d"".""rating"") AS ""average"" FROM ""Movies"" AS ""c"" JOIN ""Movie_Rating"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""c"".""title"",""d"".""movie_id"" ORDER BY ""average"" DESC,""c"".""title"" LIMIT 1) AS ""Y"") AS ""Z"""
148,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY COUNT(DISTINCT ""movie_id"") DESC,1 LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
149,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
150,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id"",""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" USING (""movie_id"") WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""movie_id"",""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
151,"(SELECT ""name"" AS ""results"" FROM ""Users"" JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
152,"(SELECT ""U"".""name"" AS ""results"" FROM (""Movie_Rating"" AS ""MR1"" CROSS JOIN ""Movie_Rating"" AS ""MR2"") JOIN ""Users"" AS ""U"" ON ""MR1"".""user_id""=""U"".""user_id"" AND ""MR1"".""user_id""=""MR2"".""user_id"" GROUP BY ""MR1"".""user_id"" ORDER BY COUNT(""MR1"".""movie_id"") DESC,""U"".""name"" LIMIT 1) UNION (SELECT ""M"".""title"" AS ""results"" FROM (""Movie_Rating"" AS ""MR1"" CROSS JOIN ""Movie_Rating"" AS ""MR2"") JOIN ""Movies"" AS ""M"" ON ""MR1"".""movie_id""=""M"".""movie_id"" AND ""MR1"".""movie_id""=""MR2"".""movie_id"" WHERE LEFT(""MR1"".""created_at"", 7)='2020-02' AND LEFT(""MR2"".""created_at"", 7)='2020-02' GROUP BY ""MR1"".""movie_id"" HAVING AVG(""MR1"".""rating"")>=AVG(""MR1"".""rating"") ORDER BY AVG(""MR1"".""rating"") DESC,""M"".""title"" LIMIT 1)"
153,"(SELECT ""name"" AS ""results"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY COUNT(""movie_id"") DESC,""name"") AS ""rnk"" FROM ""Movie_Rating"" JOIN ""Users"" USING (""user_id"") GROUP BY 1) AS ""t"" WHERE ""rnk""=1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT *,DENSE_RANK() OVER (ORDER BY ""m_avg"" DESC,""title"") AS ""rnk"" FROM (SELECT *,AVG(""rating"") OVER (PARTITION BY ""movie_id"") AS ""m_avg"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02') AS ""a"" JOIN ""Movies"" USING (""movie_id"")) AS ""b"" WHERE ""rnk""=1)"
154,"(SELECT ""name"" AS ""results"" FROM (SELECT ""user_id"" FROM ""Movie_Rating"" GROUP BY 1 HAVING COUNT(1)=(SELECT COUNT(""rating"") AS ""c1"" FROM ""Movie_Rating"" GROUP BY ""user_id"" ORDER BY 1 DESC LIMIT 1)) AS ""t1"" JOIN ""users"" AS ""u"" ON ""t1"".""user_id""=""u"".""user_id"" ORDER BY ""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM (SELECT ""movie_id"" FROM ""Movie_rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"" HAVING AVG(""rating"")=(SELECT AVG(""rating"") FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"" ORDER BY 1 DESC LIMIT 1)) AS ""t2"" JOIN ""movies"" AS ""m"" ON ""t2"".""movie_id""=""m"".""movie_id"" ORDER BY ""title"" LIMIT 1)"
155,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY COUNT(DISTINCT ""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m1"".""title"" AS ""results"" FROM ""Movies"" AS ""m1"" JOIN ""Movie_Rating"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY AVG(""m2"".""rating"") DESC,""m1"".""title"" LIMIT 1)"
156,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""CNT"" FROM ""movie_rating"" GROUP BY ""user_id""), ""cte1"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""average"" FROM ""movie_rating"" WHERE EXTRACT(MONTH FROM ""created_at"")='2' AND EXTRACT(YEAR FROM ""created_at"")='2020' GROUP BY ""movie_id"") (SELECT ""name"" AS ""results"" FROM ""users"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" ORDER BY ""CNT"" DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""movies"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" ORDER BY ""average"" DESC,""title"" LIMIT 1)"
157,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""counts"" DESC,""u"".""name"" LIMIT 1) AS ""first"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avgrating"" FROM ""Movie_rating"" AS ""m"" JOIN ""movies"" AS ""mo"" ON ""m"".""movie_id""=""mo"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")='2020' AND EXTRACT(MONTH FROM ""created_at"")='2' GROUP BY ""title"" ORDER BY ""avgrating"" DESC,""title"" LIMIT 1) AS ""second"""
158,"WITH ""mr"" AS (SELECT ""user_id"",COUNT(""movie_id"") AS ""ct"" FROM ""movie_rating"" GROUP BY ""user_id"" ORDER BY ""ct"" DESC LIMIT 1), ""high_rate"" AS (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""movie_rating"" GROUP BY ""user_id"" HAVING COUNT(""movie_id"")=(SELECT ""ct"" FROM ""mr"")) ORDER BY ""results"" LIMIT 1) SELECT ""results"" FROM ""high_rate"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""rt"" FROM ""movie_rating"" JOIN ""movies"" ON ""movie_rating"".""movie_id""=""movies"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""title"" ORDER BY ""rt"" DESC,""title"" LIMIT 1) AS ""A"""
159,"WITH ""users"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1), ""movies"" AS (SELECT ""mo"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""mo"" ON ""m"".""movie_id""=""mo"".""movie_id"" WHERE EXTRACT(MONTH FROM ""m"".""created_at"")=2 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""m"".""rating"") DESC,""mo"".""title"" LIMIT 1) SELECT ""results"" FROM ""users"" UNION SELECT ""results"" FROM ""movies"""
160,"WITH ""cte1"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" CROSS JOIN ""movie_rating"" AS ""mr"" WHERE ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""mr"".""movie_id"") DESC,""name"" LIMIT 1), ""cte2"" AS (SELECT ""m"".""title"" AS ""results"" FROM ""movies"" AS ""m"" CROSS JOIN ""movie_rating"" AS ""mr"" WHERE ""m"".""movie_id""=""mr"".""movie_id"" AND ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""cte1"" UNION SELECT * FROM ""cte2"""
161,"(SELECT ""Users"".""name"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Users"" ON ""Users"".""user_id""=""Movie_Rating"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""Users"".""name"" LIMIT 1) UNION (SELECT ""V"".""title"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Movies"" AS ""V"" ON ""V"".""movie_id""=""M"".""movie_id"" WHERE LEFT(""M"".""created_at"", 7)='2020-02' GROUP BY ""M"".""movie_id"" ORDER BY AVG(""M"".""rating"") DESC,""V"".""title"" LIMIT 1)"
162,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN (SELECT ""user_id"",DENSE_RANK() OVER (ORDER BY COUNT(""movie_id"") DESC) AS ""r"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""f"" ON ""f"".""user_id""=""u"".""user_id"" WHERE ""f"".""r""=1 ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN (SELECT ""movie_id"",DENSE_RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""r"" FROM ""movie_rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") AS ""mr"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""mr"".""r""=1 ORDER BY ""title"" LIMIT 1)"
163,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""user_name"" FROM ""Users"" AS ""u"" JOIN ""Movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""mr"".""movie_id"") DESC,""user_name"" LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"" AS ""title"" FROM ""Movies"" AS ""m"" JOIN ""Movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1) AS ""t2"""
164,"WITH ""cte1"" AS (SELECT ""name"" AS ""results"" FROM ""users"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1), ""cte2"" AS (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT ""results"" FROM ""cte1"" UNION ALL SELECT ""results"" FROM ""cte2"""
165,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""m"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""mo"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""mo"" ON ""mo"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""mo"".""movie_id"" ORDER BY SUM(""rating"")/COUNT(""rating"") DESC,""mo"".""title"" LIMIT 1)"
166,"WITH ""user_tbl"" AS (SELECT ""m"".""user_id"",""u"".""name"" AS ""result"",COUNT(""m"".""rating"") AS ""cnt"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1), ""movie_tbl"" AS (SELECT ""m"".""movie_id"",""m2"".""title"" AS ""result"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" AS ""m2"" ON ""m"".""movie_id""=""m2"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY ""avg_rating"" DESC,""result"" LIMIT 1) SELECT ""result"" AS ""results"" FROM ""user_tbl"" UNION ALL SELECT ""result"" AS ""results"" FROM ""movie_tbl"""
167,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(1) DESC,""a"".""name"" LIMIT 1) UNION (SELECT ""a"".""title"" AS ""results"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""a"".""title"" LIMIT 1)"
168,"(SELECT ""name"" AS ""results"" FROM ""users"" JOIN ""movie_rating"" USING (""user_id"") GROUP BY 1 ORDER BY COUNT(DISTINCT ""movie_id"") DESC,1 LIMIT 1) UNION (SELECT ""title"" FROM ""movies"" JOIN ""movie_rating"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
169,"WITH ""t"" AS (SELECT ""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""title"") AS ""rk"" FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movies"".""movie_id""=""Movie_Rating"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""Movie_Rating"".""movie_id""), ""t1"" AS (SELECT ""name"",RANK() OVER (ORDER BY COUNT(""movie_id"") DESC,""name"") AS ""rk"" FROM ""Movie_Rating"" JOIN ""Users"" ON ""Users"".""user_id""=""Movie_Rating"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"") SELECT ""name"" AS ""results"" FROM ""t1"" WHERE ""rk""=1 UNION SELECT ""title"" AS ""results"" FROM ""t"" WHERE ""rk""=1"
170,"(SELECT ""U"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""MR1"" JOIN ""Users"" AS ""U"" ON ""MR1"".""user_id""=""U"".""user_id"" GROUP BY ""MR1"".""user_id"" ORDER BY COUNT(""MR1"".""movie_id"") DESC,""U"".""name"" LIMIT 1) UNION (SELECT ""M"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""MR1"" JOIN ""Movies"" AS ""M"" ON ""MR1"".""movie_id""=""M"".""movie_id"" WHERE LEFT(""MR1"".""created_at"", 7)='2020-02' GROUP BY ""MR1"".""movie_id"" HAVING AVG(""MR1"".""rating"")>=AVG(""MR1"".""rating"") ORDER BY AVG(""MR1"".""rating"") DESC,""M"".""title"" LIMIT 1)"
171,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(""movie_id"") AS ""num"" FROM ""users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY ""num"" DESC,""name"" LIMIT 1) AS ""t"" UNION SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") AS ""score"" FROM ""movies"" AS ""m"" LEFT JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""t1"""
172,"WITH ""temp1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""no_rating"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""temp2"" AS (SELECT ""name"" AS ""results"" FROM ""temp1"" JOIN ""Users"" ON ""temp1"".""user_id""=""Users"".""user_id"" WHERE ""no_rating""=(SELECT MAX(""no_rating"") FROM ""temp1"") ORDER BY 1 LIMIT 1), ""temp3"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY 1 ORDER BY 2 DESC), ""temp4"" AS (SELECT ""title"" AS ""results"" FROM ""temp3"" JOIN ""Movies"" ON ""temp3"".""movie_id""=""Movies"".""movie_id"" WHERE ""avg_rating""=(SELECT MAX(""avg_rating"") FROM ""temp3"") ORDER BY 1 LIMIT 1) SELECT * FROM ""temp2"" UNION ALL SELECT * FROM ""temp4"""
173,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""MR"" LEFT JOIN ""users"" AS ""U"" ON ""MR"".""user_id""=""U"".""user_id"" GROUP BY ""MR"".""user_id"" ORDER BY COUNT(""MR"".""user_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""mr1"" LEFT JOIN ""movies"" AS ""M"" ON ""mr1"".""movie_id""=""M"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""mr1"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
174,"SELECT ""temp"".""name"" AS ""results"" FROM (SELECT ""u"".""user_id"",""u"".""name"",COUNT(""m"".""rating"") AS ""cnt"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1) AS ""temp"" UNION SELECT ""temp"".""title"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",AVG(""r"".""rating"") AS ""average_rating"" FROM ""Movie_Rating"" AS ""r"" RIGHT JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY ""average_rating"" DESC,""m"".""title"" LIMIT 1) AS ""temp"""
175,"(SELECT ""name"" AS ""results"" FROM (SELECT ""mr"".""user_id"",""u"".""name"",COUNT(""mr"".""user_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""user_ratings"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",ROUND(AVG(""rating""), 1) AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""movies_rating"" LIMIT 1)"
176,"WITH ""temp"" AS (SELECT ""u"".""name"" AS ""results"",COUNT(""movie_id"") FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""m"" USING (""user_id"") GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""temp2"" AS (SELECT ""m"".""title"" AS ""results"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""temp"".""results"" FROM ""temp"" UNION SELECT ""temp2"".""results"" FROM ""temp2"""
177,"WITH ""joined"" AS (SELECT * FROM (""Users"" JOIN ""Movie_Rating"" USING (""user_id"")) JOIN ""Movies"" USING (""movie_id"")) (SELECT ""name"" AS ""results"" FROM ""joined"" GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""joined"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
178,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(""user_id"") AS ""rk"" FROM ""Movie_rating"" GROUP BY 1), ""etc"" AS (SELECT ""movie_id"",(SUM(""rating"")/COUNT(1)) AS ""rat"" FROM ""Movie_rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1), ""titles"" AS (SELECT ""title"" FROM ""Movies"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM ""etc"" WHERE ""rat""=(SELECT MAX(""rat"") FROM ""etc"")) ORDER BY 1 LIMIT 1), ""qwe"" AS (SELECT ""name"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"" WHERE ""rk""=(SELECT MAX(""rk"") FROM ""cte"")) ORDER BY 1 LIMIT 1) SELECT ""title"" AS ""results"" FROM ""titles"" UNION SELECT ""name"" AS ""results"" FROM ""qwe"""
179,"WITH ""table1"" AS (SELECT ""m"".""user_id"",""u"".""name"",COUNT(""m"".""user_id"") AS ""cnt"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id""), ""table2"" AS (SELECT *,RANK() OVER (ORDER BY ""cnt"" DESC,""name"") AS ""rk_user"" FROM ""table1""), ""table1b"" AS (SELECT ""b"".""title"",AVG(""m"".""rating"") AS ""av"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""b"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id""), ""table2b"" AS (SELECT *,RANK() OVER (ORDER BY ""av"" DESC,""title"") AS ""rk_movie"" FROM ""table1b"") SELECT ""name"" AS ""results"" FROM ""table2"" WHERE ""rk_user""=1 UNION ALL SELECT ""title"" FROM ""table2b"" WHERE ""rk_movie""=1"
180,"WITH ""u_rating"" AS (SELECT ""m"".""name"",COUNT(""movie_id"") AS ""avg_r"" FROM ""movie_rating"" AS ""r"" JOIN ""Users"" AS ""m"" ON ""r"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY ""avg_r"" DESC,1 LIMIT 1), ""rating"" AS (SELECT ""m"".""title"",AVG(""rating"") AS ""avg_r"" FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" AND EXTRACT(MONTH FROM ""r"".""created_at"")=2 AND EXTRACT(YEAR FROM ""r"".""created_at"")=2020 GROUP BY 1 ORDER BY ""avg_r"" DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""u_rating"" UNION SELECT ""title"" FROM ""rating"""
181,"WITH ""rating_movie"" AS (SELECT ""m"".""title"",AVG(""r"".""rating"") OVER (PARTITION BY ""r"".""movie_id"") AS ""avg_movie_rate"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29'), ""user_rating"" AS (SELECT ""u"".""name"",""u"".""user_id"",COUNT(""movie_id"") AS ""movie_rate_num"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""u"".""user_id"") (SELECT ""title"" AS ""results"" FROM ""rating_movie"" ORDER BY ""avg_movie_rate"" DESC,""title"" LIMIT 1) UNION (SELECT ""name"" AS ""results"" FROM ""user_rating"" ORDER BY ""movie_rate_num"" DESC,""name"" LIMIT 1)"
182,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
183,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""u"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" AND ""r"".""created_at"" LIKE '2020-02%' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
184,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
185,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY COUNT(""mr"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(MONTH FROM ""mr"".""created_at"")=2 GROUP BY 1 ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
186,"(SELECT ""name"" AS ""results"" FROM (SELECT ""mr"".""user_id"",""u"".""name"",COUNT(""mr"".""user_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""b"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",ROUND(AVG(""rating""), 1) AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1,2 ORDER BY 3 DESC,2) AS ""a"" LIMIT 1)"
187,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Users"" ON ""Users"".""user_id""=""Movie_Rating"".""user_id"" GROUP BY 1 ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movies"".""movie_id""=""Movie_Rating"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
188,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""name"" FROM ""Users"" AS ""u"" JOIN ""Movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""mr"".""movie_id"") DESC,""u"".""name"" LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"" FROM ""Movies"" AS ""m"" JOIN ""Movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1) AS ""t2"""
189,"WITH ""user_name"" AS (SELECT ""d"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(""rating"") AS ""ct"" FROM ""movie_rating"" GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC) AS ""a"" JOIN ""users"" AS ""d"" ON ""a"".""user_id""=""d"".""user_id"" ORDER BY ""a"".""ct"" DESC,""d"".""name"" LIMIT 1), ""movie_name"" AS (SELECT ""e"".""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""rr"" FROM ""movie_rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC) AS ""q"" JOIN ""movies"" AS ""e"" ON ""q"".""movie_id""=""e"".""movie_id"" ORDER BY ""q"".""rr"" DESC,""e"".""title"" LIMIT 1) SELECT ""results"" FROM ""user_name"" UNION ALL SELECT ""results"" FROM ""movie_name"""
190,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1 ORDER BY COUNT(""movie_id"") DESC,1 LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
191,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""name"",COUNT(1) AS ""counts"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""a"" UNION SELECT ""name"" AS ""results"" FROM (SELECT ""m"".""title"" AS ""name"",AVG(""mr"".""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m"".""title"" ORDER BY 2 DESC,1 LIMIT 1) AS ""b"""
192,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
193,"WITH ""t1"" AS (SELECT ""a"".""user_id"",""b"".""name"",COUNT(""a"".""user_id"") AS ""counts"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1,2 ORDER BY ""counts"" DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""a"".""movie_id"",""b"".""title"",AVG(""a"".""rating"") FROM (SELECT * FROM ""movie_rating"" WHERE LEFT(""created_at"", 7)='2020-02') AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" GROUP BY 1,2 ORDER BY 3 DESC,2 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""t1"" UNION ALL SELECT ""title"" AS ""results"" FROM ""t2"""
194,"WITH ""t1"" AS (SELECT ""name"" AS ""results"" FROM ""movie_Rating"" AS ""mr"" LEFT JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""title"" AS ""results"" FROM ""movie_Rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"""
195,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""x"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""o"" UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""y"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""movies"" AS ""b"" ON ""m"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")='2' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""p"""
196,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""u"".""name"" AS ""user_name"",COUNT(""m"".""movie_id"") AS ""numbers"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY ""numbers"" DESC,""u"".""name"" LIMIT 1) AS ""res1"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""movies"".""title"" AS ""movie_name"",AVG(""m"".""rating"") AS ""ratings"" FROM ""Movies"" AS ""movies"" JOIN ""Movie_Rating"" AS ""m"" ON ""movies"".""movie_id""=""m"".""movie_id"" WHERE SUBSTRING(""m"".""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY ""ratings"" DESC,""movie_name"" LIMIT 1) AS ""res2"""
197,"WITH ""user"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" RIGHT JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""m"".""user_id"" HAVING COUNT(1) ORDER BY COUNT(1) DESC,""results"" LIMIT 1), ""title"" AS (SELECT ""mv"".""title"" AS ""tl"" FROM ""Movies"" AS ""mv"" RIGHT JOIN ""Movie_rating"" AS ""m"" ON ""mv"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""m"".""created_at"")=2 GROUP BY ""m"".""movie_id"" HAVING AVG(""m"".""rating"") ORDER BY AVG(""m"".""rating"") DESC,""tl"" LIMIT 1) SELECT ""results"" FROM ""user"" UNION SELECT ""tl"" AS ""results"" FROM ""title"""
198,"WITH ""u"" AS (SELECT ""name"",COUNT(1) FROM ""Users"" JOIN ""Movie_Rating"" ON ""Users"".""user_id""=""Movie_Rating"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""ratings"" AS (SELECT ""title"",AVG(""rating"") FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movies"".""movie_id""=""Movie_Rating"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""u"" UNION SELECT ""title"" AS ""results"" FROM ""ratings"""
199,"WITH ""base"" AS (SELECT ""u"".""user_id"",""u"".""name"",""r"".""movie_id"",""r"".""rating"",""r"".""created_at"",""m"".""title"" FROM (""users"" AS ""u"" JOIN ""movie_rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"") JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id""), ""top_user"" AS (SELECT ""name"" AS ""results"" FROM ""base"" GROUP BY ""name"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1), ""top_movie"" AS (SELECT ""title"" AS ""results"" FROM ""base"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT ""results"" FROM ""top_user"" UNION SELECT ""results"" FROM ""top_movie"""
200,"WITH ""base"" AS (SELECT DISTINCT ""a"".""user_id"",""b"".""name"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1,2), ""base1"" AS (SELECT DISTINCT ""a"".""movie_id"",""b"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1,2) (SELECT ""name"" AS ""results"" FROM ""base"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""base"") ORDER BY 1 LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""base1"" WHERE ""avg_rating"" IN (SELECT MAX(""avg_rating"") FROM ""base1"") ORDER BY 1 LIMIT 1)"
201,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""r"".""user_id"" ORDER BY COUNT(""r"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
202,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""rating"" JOIN ""users"" ON ""rating"".""user_id""=""users"".""user_id"" GROUP BY ""rating"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""movie_rating"" AS ""rating"" JOIN ""movies"" ON ""rating"".""movie_id""=""movies"".""movie_id"" WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY ""rating"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
203,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY COUNT(""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""a"".""title"" AS ""results"" FROM (SELECT ""m"".""title"",DENSE_RANK() OVER (ORDER BY AVG(""mo"".""rating"") DESC) AS ""r"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mo"" ON ""m"".""movie_id""=""mo"".""movie_id"" WHERE EXTRACT(YEAR_MONTH FROM ""mo"".""created_at"")='202002' GROUP BY 1 ORDER BY 1) AS ""a"" WHERE ""a"".""r""=1 LIMIT 1)"
204,"WITH ""cte_highest_average_rating"" AS (SELECT ""title"",AVG(""rating"") AS ""rating"" FROM ""MOVIE_RATING"" AS ""T1"" JOIN ""MOVIES"" AS ""T2"" ON ""T1"".""MOVIE_ID""=""T2"".""MOVIE_ID"" WHERE ""CREATED_AT"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""title"" ORDER BY ""rating"" DESC,""title""), ""cte_count_review"" AS (SELECT ""NAME"",COUNT(""t1"".""USER_ID"") AS ""counting"" FROM ""MOVIE_RATING"" AS ""T1"" JOIN ""USERS"" AS ""T2"" ON ""T1"".""USER_ID""=""T2"".""USER_ID"" GROUP BY ""name"" ORDER BY ""counting"" DESC,""name"") (SELECT ""name"" AS ""results"" FROM ""cte_count_review"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""cte_highest_average_rating"" LIMIT 1)"
205,"SELECT ""results"" FROM (SELECT ""name"" AS ""results"",CASE WHEN ""num_movies_rated"" IS NULL THEN 0 ELSE ""num_movies_rated"" END AS ""num_movies_rated"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""num_movies_rated"" FROM (SELECT ""u"".""name"",""u"".""user_id"",""r"".""movie_id"",""r"".""rating"" FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"") AS ""a"" GROUP BY 1) AS ""b"" ORDER BY ""num_movies_rated"" DESC,""name"" LIMIT 1) AS ""c"" UNION SELECT ""results"" FROM (SELECT ""title"" AS ""results"",CASE WHEN ""avg_rating"" IS NULL THEN 0 ELSE ""avg_rating"" END AS ""avg_rating"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",""r"".""user_id"",""r"".""rating"" FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE TO_CHAR(""created_at"", '%m')=2) AS ""a"" GROUP BY 1) AS ""b"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""c"""
206,"WITH ""user_rate"" AS (SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""user_id"",COUNT(""movie_id"") AS ""cnt"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""t"" ON ""u"".""user_id""=""t"".""user_id"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1), ""movie_rate"" AS (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" LEFT JOIN (SELECT ""movie_id"",TO_CHAR(""created_at"", 'YYYY-%m') AS ""dmonth"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" GROUP BY ""movie_id"",""dmonth"") AS ""v"" ON ""m"".""movie_id""=""v"".""movie_id"" WHERE ""dmonth""='2020-02' ORDER BY ""rating"" DESC,""title"" LIMIT 1) SELECT * FROM (SELECT * FROM ""user_rate"" UNION ALL SELECT * FROM ""movie_rate"") AS ""s"""
207,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN (SELECT ""user_id"" FROM ""Movie_Rating"" GROUP BY ""user_id"" HAVING COUNT(1)=(SELECT MAX(""rate"") AS ""maxrate"" FROM (SELECT COUNT(1) AS ""rate"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""a"")) AS ""t"" ON ""u"".""user_id""=""t"".""user_id"" ORDER BY ""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"" HAVING ABS(AVG(""rating"")-(SELECT MAX(""rate"") AS ""avgrate"" FROM (SELECT AVG(""rating"") AS ""rate"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") AS ""b""))<=0.0001) AS ""d"" ON ""m"".""movie_id""=""d"".""movie_id"" ORDER BY ""m"".""title"" LIMIT 1)"
208,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""m"".""user_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" AS ""m2"" ON ""m"".""movie_id""=""m2"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
209,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"",""u"".""name"" ORDER BY COUNT(DISTINCT ""mr"".""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"",""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""title"" LIMIT 1)"
210,"WITH ""cte1"" AS (SELECT ""u"".""name"",COUNT(""r"".""user_id"") FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""cte2"" AS (SELECT ""m"".""title"",AVG(""rating"") FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte1"" UNION SELECT ""title"" AS ""results"" FROM ""cte2"""
211,"(SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(1) AS ""count"" FROM ""Users"" JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"") AS ""a"" ORDER BY ""count"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" JOIN ""Movie_Rating"" USING (""movie_id"") WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"",""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
212,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""r"".""user_id"" ORDER BY COUNT(""r"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE ""r"".""created_at"" LIKE '2020-02%' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
213,"WITH ""cte"" AS (SELECT ""user_id"",DENSE_RANK() OVER (ORDER BY COUNT(""rating"") DESC) AS ""ratingCnt"" FROM ""Movie_Rating"" GROUP BY 1), ""cte2"" AS (SELECT ""movie_id"",DENSE_RANK() OVER (ORDER BY SUM(""rating"")/COUNT(""movie_id"") DESC) AS ""movieRating"" FROM (SELECT ""movie_id"",""rating"" FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02') AS ""tmp"" GROUP BY 1) (SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""cte"" AS ""c"" ON ""u"".""user_id""=""c"".""user_id"" WHERE ""ratingCnt""=1 ORDER BY ""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""cte2"" AS ""c2"" ON ""m"".""movie_id""=""c2"".""movie_id"" WHERE ""movieRating""=1 ORDER BY ""m"".""title"" LIMIT 1)"
214,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(0) DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
215,"WITH ""r1"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON (""mr"".""user_id""=""u"".""user_id"") GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""u"".""name"" LIMIT 1), ""r2"" AS (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON (""mr"".""movie_id""=""m"".""movie_id"") WHERE EXTRACT(MONTH FROM ""mr"".""created_at"")=2 AND EXTRACT(YEAR FROM ""mr"".""created_at"")=2020 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1) SELECT * FROM ""r1"" UNION SELECT * FROM ""r2"""
216,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
217,"WITH ""user_reviews"" AS (SELECT ""U"".""name"",RANK() OVER (ORDER BY COUNT(""rating"") DESC,""U"".""name"") AS ""rnk"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""U"" ON ""M"".""user_id""=""U"".""user_id"" GROUP BY ""U"".""name""), ""movie_reviews"" AS (SELECT ""M"".""title"",RANK() OVER (ORDER BY AVG(""rating"") DESC,""M"".""title"") AS ""rnk"" FROM ""Movie_Rating"" AS ""MR"" JOIN ""Movies"" AS ""M"" ON ""M"".""movie_id""=""MR"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""M"".""title"") SELECT ""name"" AS ""results"" FROM ""user_reviews"" WHERE ""rnk""=1 UNION SELECT ""title"" AS ""results"" FROM ""movie_reviews"" WHERE ""rnk""=1"
218,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" USING (""user_id"") GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""Movie_Rating"" AS ""m1"" JOIN ""Movies"" AS ""m2"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m1"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
219,"WITH ""a"" AS (SELECT ""name"" AS ""results"" FROM (SELECT ""name"" FROM (SELECT ""name"",ROW_NUMBER() OVER (ORDER BY COUNT(""rating"") DESC,""u"".""name"") AS ""rk"" FROM (""movie_rating"" AS ""mr"" LEFT JOIN ""users"" AS ""u"" USING (""user_id"")) LEFT JOIN ""movies"" AS ""m"" USING (""movie_id"") GROUP BY ""mr"".""user_id"") AS ""a"" WHERE ""rk""=1) AS ""b""), ""b"" AS (SELECT ""title"" AS ""results"" FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""movie_rating"".""movie_id"" ORDER BY AVG(""movie_rating"".""rating"") DESC,""title"" LIMIT 1) SELECT ""results"" FROM ""a"" UNION SELECT ""results"" FROM ""b"""
220,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""U"" JOIN ""Movie_Rating"" AS ""M"" ON ""U"".""user_id""=""M"".""user_id"" GROUP BY ""M"".""user_id"" HAVING COUNT(DISTINCT ""movie_id"")>=(SELECT COUNT(DISTINCT ""movie_id"") FROM ""Movie_Rating"" GROUP BY ""user_id"" ORDER BY 1 DESC LIMIT 1) ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""M"" JOIN ""Movie_Rating"" AS ""R"" ON ""M"".""movie_id""=""R"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""R"".""movie_id"" HAVING AVG(""rating"")>=(SELECT AVG(""rating"") FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY 1 DESC LIMIT 1) ORDER BY ""title"" LIMIT 1)"
221,"SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""r"".""user_id"" FROM (SELECT ""user_id"",RANK() OVER (ORDER BY ""rate_count"" DESC) AS ""count_rank"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""rate_count"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""rc"") AS ""r"" WHERE ""r"".""count_rank""=1) ORDER BY ""name"" LIMIT 1) AS ""n"" UNION SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""Movies"" WHERE ""movie_id"" IN (SELECT ""r"".""movie_id"" FROM (SELECT ""movie_id"",RANK() OVER (ORDER BY ""avg_rating"" DESC) AS ""rating_rank"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"") AS ""ar"") AS ""r"" WHERE ""r"".""rating_rank""=1) ORDER BY ""title"" LIMIT 1) AS ""t"""
222,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" LEFT JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
223,"(SELECT ""name"" AS ""results"" FROM ""Users"" RIGHT JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""Movies"" RIGHT JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
224,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY COUNT(DISTINCT ""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m2"".""title"" AS ""results"" FROM ""Movies"" AS ""m2"" JOIN ""Movie_Rating"" AS ""m"" ON ""m2"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""m"".""created_at"")=2 GROUP BY 1 ORDER BY AVG(""m"".""rating"") DESC,""m2"".""title"" LIMIT 1)"
225,"SELECT ""results"" FROM (SELECT ""u"".""name"" AS ""results"",COUNT(""movie_id"") AS ""c"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""c"" DESC,""results"" LIMIT 1) AS ""a"" UNION SELECT ""results"" FROM (SELECT ""m1"".""title"" AS ""results"",AVG(""rating"") AS ""d"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""m1"" ON ""m1"".""movie_id""=""m"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""m1"".""title"" ORDER BY ""d"" DESC,""results"" LIMIT 1) AS ""b"""
226,"SELECT ""name"" AS ""results"" FROM (SELECT ""m"".""user_id"",""u"".""name"",COUNT(""m"".""user_id"") AS ""no_of_movies_rated"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""user_id"" ORDER BY ""no_of_movies_rated"" DESC,""u"".""name"" LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""t2"""
227,"SELECT ""t"".""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""rating"") AS ""cnt"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1) AS ""t"" UNION ALL SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") AS ""ag"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" AND LEFT(""r"".""created_at"", 7)='2020-02' GROUP BY ""title"" ORDER BY ""ag"" DESC,""title"" LIMIT 1) AS ""t2"""
228,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""r"" JOIN ""users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""rating"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
229,"WITH ""cte1"" AS (SELECT ""u"".""name"",COUNT(1) AS ""cnt"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""cte2"" AS (SELECT ""title"",AVG(""rating"") AS ""rating"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY 2 DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte1"" UNION SELECT ""title"" FROM ""cte2"""
230,"WITH ""cte1"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1), ""cte2"" AS (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""movies"" AS ""mm"" ON ""m"".""movie_id""=""mm"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT ""results"" FROM ""cte1"" UNION SELECT ""results"" FROM ""cte2"""
231,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" HAVING COUNT(""m"".""movie_id"")=(SELECT MAX(""freq"") AS ""maxFreq"" FROM (SELECT COUNT(""movie_id"") AS ""freq"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""t"") ORDER BY ""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""movie_id"" HAVING ABS(AVG(""mr"".""rating"")-(SELECT MAX(""rating"") AS ""maxRate"" FROM (SELECT AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""movie_id"") AS ""t""))<=0.0001 ORDER BY ""m"".""title"" LIMIT 1)"
232,"WITH ""temp"" AS (SELECT ""u"".""name"" AS ""results"",COUNT(""movie_id"") FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""m"" USING (""user_id"") GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""temp2"" AS (SELECT ""m"".""title"" AS ""results"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""temp"".""results"" FROM ""temp"" UNION SELECT ""temp2"".""results"" FROM ""temp2"""
233,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"" FROM (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""user_id"") DESC) AS ""count_rank"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""ranks"" LEFT JOIN ""Users"" ON ""ranks"".""user_id""=""Users"".""user_id"" WHERE ""count_rank""=1 ORDER BY ""name"" LIMIT 1) AS ""top_rater_name"" UNION SELECT ""results"" FROM (SELECT ""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating""),RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""rating_rank"" FROM (SELECT ""movie_id"",""rating"" FROM ""Movie_Rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29') AS ""feb_movies"" GROUP BY ""movie_id"") AS ""rating_ranks"" LEFT JOIN ""Movies"" ON ""rating_ranks"".""movie_id""=""Movies"".""movie_id"" WHERE ""rating_rank""=1 ORDER BY ""results"" LIMIT 1) AS ""top_rated_movie"""
234,"(SELECT ""name"" AS ""results"" FROM ""Users"" RIGHT JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""Movies"" RIGHT JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
235,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""mr"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
236,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN (SELECT ""user_id"" FROM ""Movie_Rating"" GROUP BY ""user_id"" HAVING COUNT(1)=(SELECT MAX(""rate"") AS ""maxrate"" FROM (SELECT COUNT(1) AS ""rate"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""a"")) AS ""t"" ON ""u"".""user_id""=""t"".""user_id"" ORDER BY ""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"" HAVING ABS(AVG(""rating"")-(SELECT MAX(""rate"") AS ""avgrate"" FROM (SELECT AVG(""rating"") AS ""rate"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") AS ""b""))<=0.0001) AS ""d"" ON ""m"".""movie_id""=""d"".""movie_id"" ORDER BY ""m"".""title"" LIMIT 1)"
237,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""U"" JOIN ""Movie_Rating"" AS ""M"" ON ""U"".""user_id""=""M"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""U"" JOIN ""Movie_Rating"" AS ""M"" ON ""M"".""movie_id""=""U"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
238,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
239,"(SELECT ""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(1) AS ""rate_cnt"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""t1"" JOIN ""Users"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" ORDER BY ""rate_cnt"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") AS ""a1"" LEFT JOIN ""Movies"" AS ""a2"" ON ""a1"".""movie_id""=""a2"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1)"
240,"(SELECT ""a"".""name"" AS ""results"" FROM ""Users"" AS ""a"" LEFT JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""name"" ORDER BY COUNT(""a"".""user_id"") DESC,""a"".""name"" LIMIT 1) UNION (SELECT ""a"".""title"" AS ""results"" FROM ""Movies"" AS ""a"" LEFT JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")='202002' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""b"".""rating"") DESC,""a"".""title"" LIMIT 1)"
241,"SELECT ""results"" FROM (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""u"".""name"" LIMIT 1) AS ""a"" UNION SELECT ""results"" FROM (SELECT ""mv"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""mv"" ON ""mr"".""movie_id""=""mv"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY LEFT(""mr"".""created_at"", 7),""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""mv"".""title"" LIMIT 1) AS ""b"""
242,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
243,"WITH ""movie_title"" AS (SELECT ""m"".""title"" AS ""results"",AVG(""mr"".""rating"") AS ""metric"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""user_title"" AS (SELECT ""u"".""name"" AS ""results"",COUNT(""mr"".""rating"") AS ""metric"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""results"" FROM ""movie_title"" UNION SELECT ""results"" FROM ""user_title"""
244,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""r"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""r"".""user_id"" HAVING COUNT(1) ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""r"".""movie_id"" HAVING AVG(""rating"") ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
245,"SELECT ""a"".""results"" FROM (WITH ""cte"" AS (SELECT ""u"".""name"",COUNT(""m"".""rating"") AS ""cnt_rating"" FROM ""users"" AS ""u"" LEFT JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"") SELECT ""name"" AS ""results"" FROM ""cte"" WHERE ""cnt_rating""=(SELECT MAX(""cnt_rating"") FROM ""cte"") ORDER BY ""name"" LIMIT 1) AS ""a"" UNION SELECT ""b"".""results"" FROM (WITH ""max_rating"" AS (SELECT ""m"".""title"",SUM(""mr"".""rating"")/COUNT(1) AS ""avg_rating"" FROM ""movies"" AS ""m"" LEFT JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(MONTH FROM ""mr"".""created_at"")='02' GROUP BY ""m"".""movie_id"") SELECT ""title"" AS ""results"" FROM ""max_rating"" WHERE ""avg_rating""=(SELECT MAX(""avg_rating"") FROM ""max_rating"") ORDER BY ""title"" LIMIT 1) AS ""b"""
246,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
247,"WITH ""a"" AS (SELECT ""Users"".""user_id"",""name"",DENSE_RANK() OVER (ORDER BY COUNT(""movie_id"") DESC) AS ""ranks"" FROM ""Movie_Rating"" JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY 1,2 ORDER BY ""ranks"",""name"" LIMIT 1), ""b"" AS (SELECT ""Movies"".""movie_id"",""title"",DENSE_RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""ranks"" FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movie_Rating"".""movie_id""=""Movies"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1,2 ORDER BY ""ranks"",""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""a"" UNION SELECT ""title"" AS ""results"" FROM ""b"""
248,"SELECT ""results"" FROM ((SELECT ""u"".""name"" AS ""results"",COUNT(1) AS ""n_rated"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY ""n_rated"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"",AVG(""rating"") AS ""a_rating"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""mr"".""created_at"")=2 AND EXTRACT(YEAR FROM ""mr"".""created_at"")=2020 GROUP BY ""mr"".""movie_id"" ORDER BY ""a_rating"" DESC,""m"".""title"" LIMIT 1)) AS ""a"""
249,"SELECT ""results"" FROM ((SELECT ""u"".""name"" AS ""results"",COUNT(1) AS ""n_rated"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY ""n_rated"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"",AVG(""rating"") AS ""a_rating"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""mr"".""created_at"")=2 AND EXTRACT(YEAR FROM ""mr"".""created_at"")=2020 GROUP BY ""mr"".""movie_id"" ORDER BY ""a_rating"" DESC,""m"".""title"" LIMIT 1)) AS ""a"""
250,"WITH ""cte"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""rating"") DESC,""u"".""name"" LIMIT 1), ""cte2"" AS (SELECT ""m1"".""title"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""movies"" AS ""m1"" ON ""m"".""movie_id""=""m1"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m1"".""title"" LIMIT 1) SELECT ""results"" FROM ""cte"" UNION SELECT ""results"" FROM ""cte2"""
251,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(DISTINCT ""r"".""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""r"" ON (""m"".""movie_id""=""r"".""movie_id"") AND (TO_CHAR(""r"".""created_at"", 'YYYY-%m')='2020-02') GROUP BY ""m"".""title"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
252,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""mr"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" USING (""movie_id"") WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
253,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""r"".""movie_id"") FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""r"".""user_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""a"" UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT ""title"" FROM (SELECT ""m"".""title"",AVG(""r"".""rating"") AS ""rating"",TO_CHAR(""created_at"", 'YYYY-%m') AS ""month"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" GROUP BY ""r"".""movie_id"",3 ORDER BY 2 DESC,1) AS ""b"" WHERE ""month""='2020-02' LIMIT 1) AS ""c"""
254,"(SELECT ""Users"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" USING (""user_id"") GROUP BY ""m"".""user_id"" ORDER BY COUNT(""rating"") DESC,""Users"".""name"" LIMIT 1) UNION (SELECT ""Movies"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""Movies"".""title"" LIMIT 1)"
255,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(""movie_id"") AS ""cnt"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""cte1"" AS (SELECT ""title"",AVG(""rating"") AS ""avg"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"") (SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""cte"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" WHERE ""cnt""=(SELECT MAX(""cnt"") FROM ""cte"") ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""cte1"" WHERE ""avg""=(SELECT MAX(""avg"") FROM ""cte1"") ORDER BY 1 LIMIT 1)"
256,"SELECT ""name"" AS ""results"" FROM ""Users"" WHERE ""user_id""=(SELECT ""m"".""user_id"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(0) DESC,""u"".""name"" LIMIT 1) UNION SELECT ""title"" FROM ""Movies"" WHERE ""movie_id""=(SELECT ""m1"".""movie_id"" FROM ""Movie_Rating"" AS ""m1"" JOIN ""Movies"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE ""created_at"" BETWEEN DATE('2020-02-01') AND DATE('2020-02-29') GROUP BY ""m1"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
257,"WITH ""a"" AS (SELECT ""m"".""title"" FROM ""movies"" AS ""m"" CROSS JOIN (SELECT ""movie_id"",AVG(""rating"") AS ""rate"" FROM ""movie_rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1) AS ""tmp"" WHERE ""m"".""movie_id""=""tmp"".""movie_id"" ORDER BY ""tmp"".""rate"" DESC,1 LIMIT 1), ""b"" AS (SELECT ""name"",COUNT(""rating"") FROM ""movie_rating"" AS ""m"" CROSS JOIN ""users"" AS ""u"" WHERE ""m"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""name"" AS ""results"" FROM ""b"" UNION ALL SELECT ""title"" AS ""results"" FROM ""a"""
258,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""m"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m1"".""title"" AS ""results"" FROM ""Movies"" AS ""m1"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m1"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m1"".""title"" LIMIT 1)"
259,"WITH ""user_ratings"" AS (SELECT ""u"".""name"",COUNT(DISTINCT ""mr"".""movie_id"") AS ""movies_rated"" FROM ""users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""highest_202002_avg_rating"" AS (SELECT ""m"".""title"",AVG(""mr"".""rating"") AS ""avg_rating"" FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<'2020-03-01' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""u"".""name"" AS ""results"" FROM ""user_ratings"" AS ""u"" UNION ALL SELECT ""title"" AS ""results"" FROM ""highest_202002_avg_rating"" AS ""h"""
260,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""numberOfMovie"" FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""mv"" ON ""u"".""user_id""=""mv"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY 2 DESC,1 LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",""m"".""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" JOIN ""Movies"" AS ""m"" ON ""Movie_Rating"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) AS ""t2"""
261,"WITH ""cte1"" AS (SELECT ""user_id"",COUNT(""user_id"") AS ""ct"" FROM ""Movie_Rating"" GROUP BY ""user_id"" ORDER BY ""ct"" DESC), ""cte2"" AS (SELECT *,AVG(""rating"") AS ""rt"" FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"" ORDER BY ""rt"" DESC) (SELECT ""name"" AS ""results"" FROM ""Users"" JOIN ""cte1"" USING (""user_id"") ORDER BY ""ct"" DESC,""name"" LIMIT 1) UNION (SELECT ""m"".""title"" FROM ""cte2"" JOIN ""Movies"" AS ""m"" USING (""movie_id"") ORDER BY ""rt"" DESC,""title"" LIMIT 1)"
262,"(SELECT ""user"".""name"" AS ""results"" FROM ""Users"" AS ""user"" JOIN (SELECT ""user_id"",COUNT(""movie_id"") AS ""cnt_rated"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""user_rated"" ON ""user"".""user_id""=""user_rated"".""user_id"" ORDER BY ""cnt_rated"" DESC,""results"" LIMIT 1) UNION ALL (SELECT ""movie"".""title"" AS ""results"" FROM ""Movies"" AS ""movie"" JOIN (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""movie_id"") AS ""movie_rating"" ON ""movie"".""movie_id""=""movie_rating"".""movie_id"" ORDER BY ""avg_rating"" DESC,""results"" LIMIT 1)"
263,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" HAVING COUNT(1)=(SELECT COUNT(1) FROM ""movie_rating"" GROUP BY ""user_id"" ORDER BY 1 DESC LIMIT 1) ORDER BY 1 LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" USING (""movie_id"") WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"" HAVING AVG(""rating"")=(SELECT AVG(""rating"") FROM ""movie_rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"" ORDER BY 1 DESC LIMIT 1) ORDER BY 1 LIMIT 1)"
264,"(SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(""movie_id"") AS ""cnt"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1) AS ""a"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" AS ""a"" LEFT JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1) AS ""a"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1)"
265,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""m"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE LEFT(""r"".""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"" LIMIT 1)"
266,"WITH ""most_user"" AS (SELECT ""users"".""user_id"",""name"",COUNT(""movie_id"") AS ""num_rating"" FROM ""users"" JOIN ""movie_rating"" AS ""mr"" ON ""mr"".""user_id""=""users"".""user_id"" GROUP BY ""user_id"" ORDER BY 2), ""great_user"" AS (SELECT ""name"" FROM ""most_user"" WHERE ""num_rating""=(SELECT MAX(""num_rating"") FROM ""most_user"") LIMIT 1), ""ratings"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""score"" FROM ""movie_rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1), ""highest_rating"" AS (SELECT ""title"" FROM ""movies"" JOIN ""ratings"" ON ""movies"".""movie_id""=""ratings"".""movie_id"" WHERE ""score""=(SELECT MAX(""score"") FROM ""ratings"") ORDER BY ""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""great_user"" UNION SELECT ""title"" AS ""results"" FROM ""highest_rating"""
267,"(SELECT ""users"".""name"" AS ""results"" FROM ""users"" JOIN ""movie_rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(1) DESC,""users"".""name"" LIMIT 1) UNION (SELECT ""movies"".""title"" AS ""results"" FROM ""movies"" JOIN ""movie_rating"" USING (""movie_id"") WHERE LEFT(""movie_rating"".""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""movies"".""title"" LIMIT 1)"
268,"WITH ""cte1"" AS (SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1), ""cte2"" AS (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""cte1"" UNION SELECT * FROM ""cte2"""
269,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""mov"" JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM ""movie_rating"" AS ""mov"" JOIN ""movies"" AS ""m"" USING (""movie_id"") WHERE ""created_at"">='2020-02-01' AND ""created_at""<'2020-03-01' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
270,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
271,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""b"" JOIN ""Movie_Rating"" AS ""c"" ON ""b"".""user_id""=""c"".""user_id"" GROUP BY 1 ORDER BY COUNT(""c"".""user_id"") DESC,1 LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""c"" ON ""a"".""movie_id""=""c"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
272,"WITH ""a"" AS (SELECT ""name"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1), ""b"" AS (SELECT ""title"" FROM (SELECT * FROM ""Movie_Rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29') AS ""temp2"" LEFT JOIN ""Movies"" ON ""temp2"".""movie_id""=""Movies"".""movie_id"" GROUP BY ""temp2"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""a"" UNION SELECT ""title"" FROM ""b"""
273,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""user_id"",""u"".""name"",RANK() OVER (ORDER BY COUNT(""m"".""movie_id"") DESC,""u"".""name"") AS ""rk"",COUNT(""m"".""movie_id"") FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"") AS ""r"" WHERE ""rk""=1 UNION SELECT ""title"" FROM (SELECT ""r"".""movie_id"",""m"".""title"",RANK() OVER (ORDER BY AVG(""r"".""rating"") DESC,""m"".""title"") AS ""m_rk"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""r"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""r"".""movie_id"") AS ""t"" WHERE ""m_rk""=1"
274,"WITH ""cte"" AS (SELECT ""m"".""user_id"",COUNT(""m"".""rating"") AS ""rat"",""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""user_id"" ORDER BY ""rat"" DESC,""results"" LIMIT 1), ""cte1"" AS (SELECT ""m"".""movie_id"",AVG(""rating"") AS ""rat"",""mo"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" AS ""mo"" ON ""m"".""movie_id""=""mo"".""movie_id"" WHERE SUBSTRING(""m"".""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY ""rat"" DESC,""results"" LIMIT 1) SELECT ""cte"".""results"" FROM ""cte"" UNION SELECT ""cte1"".""results"" FROM ""cte1"""
275,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(1) AS ""a"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY ""a"" DESC,""u"".""name"" LIMIT 1) AS ""r1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"",AVG(""rating"") AS ""av"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""created_at"" LIKE '%-02-%' GROUP BY ""m"".""movie_id"" ORDER BY ""av"" DESC,""title"" LIMIT 1) AS ""r2"""
276,"SELECT ""results"" FROM (SELECT ""name"" AS ""results"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",RANK() OVER (ORDER BY ""movie_cnt"" DESC) AS ""rnk"" FROM (SELECT ""user_id"",COUNT(""movie_id"") AS ""movie_cnt"" FROM ""Movie_Rating"" GROUP BY 1) AS ""a"") AS ""a"" WHERE ""rnk""=1) ORDER BY 1 LIMIT 1) AS ""a"" UNION ALL SELECT ""title"" FROM (SELECT ""title"" FROM ""Movies"" AS ""M"" WHERE ""movie_id"" IN (SELECT ""movie_id"" FROM (SELECT ""movie_id"",RANK() OVER (ORDER BY ""avg_rating"" DESC) AS ""rnk"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY 1) AS ""a"") AS ""a"" WHERE ""rnk""=1) ORDER BY 1 LIMIT 1) AS ""a"""
277,"(SELECT ""results"" FROM (SELECT ""u"".""name"" AS ""results"",COUNT(1) AS ""cnt"" FROM ""users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"") AS ""tab"" ORDER BY ""cnt"" DESC,1 LIMIT 1) UNION ALL (SELECT ""results"" FROM (SELECT ""m1"".""title"" AS ""results"",AVG(""rating"") AS ""average"" FROM ""Movie_Rating"" AS ""m2"" JOIN ""Movies"" AS ""m1"" ON ""m1"".""movie_id""=""m2"".""movie_id"" AND LEFT(""m2"".""created_at"", 7)='2020-02' GROUP BY ""m1"".""movie_id"") AS ""tab"" ORDER BY ""average"" DESC,1 LIMIT 1)"
278,"WITH ""t1"" AS (SELECT ""b"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(""a"".""movie_id"") DESC,""b"".""name"" LIMIT 1), ""t2"" AS (SELECT ""b"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""a"".""movie_id"" ORDER BY AVG(""a"".""rating"") DESC,""b"".""title"" LIMIT 1) SELECT * FROM ""t1"" UNION ALL SELECT * FROM ""t2"""
279,"WITH ""CTE1"" AS (SELECT ""X"".""NAME"" AS ""RESULTS"" FROM (SELECT ""U"".""NAME"",COUNT(""MOVIE_ID""),RANK() OVER (ORDER BY COUNT(""MOVIE_ID"") DESC,""U"".""NAME"") AS ""RNK"" FROM ""MOVIE_RATING"" AS ""M"" JOIN ""USERS"" AS ""U"" ON (""M"".""USER_ID""=""U"".""USER_ID"") GROUP BY 1) AS ""X"" WHERE ""X"".""RNK""=1 ORDER BY ""x"".""name"" LIMIT 1), ""CTE2"" AS (SELECT ""X"".""TITLE"" AS ""RESULTS"" FROM (SELECT ""M1"".""TITLE"",AVG(""m"".""rating"") AS ""AVG_RATING"" FROM ""MOVIE_RATING"" AS ""M"" JOIN ""MOVIES"" AS ""M1"" ON (""M"".""MOVIE_ID""=""M1"".""MOVIE_ID"") WHERE ""m"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1 ORDER BY 2 DESC,1) AS ""X"" LIMIT 1) SELECT * FROM ""CTE1"" UNION SELECT * FROM ""CTE2"""
280,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" HAVING COUNT(""m"".""movie_id"")=(SELECT MAX(""freq"") AS ""maxFreq"" FROM (SELECT COUNT(""movie_id"") AS ""freq"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""t"") ORDER BY ""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""movie_id"" HAVING ABS(AVG(""mr"".""rating"")-(SELECT MAX(""rating"") AS ""maxRate"" FROM (SELECT AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""movie_id"") AS ""t""))<=0.0001 ORDER BY ""m"".""title"" LIMIT 1)"
281,"WITH ""max_user"" AS (SELECT ""mr"".""user_id"",""u"".""name"",COUNT(1) FROM ""Movie_rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1), ""highest_movie"" AS (SELECT ""mr"".""movie_id"",""m"".""title"",AVG(""rating"") FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""max_user"" UNION ALL SELECT ""title"" FROM ""highest_movie"" AS ""results"""
282,"ERROR: mysql parse error: line 1 column 4 near ""From( SELECT user_id,count(*) as number From Movie_Rating Group by user_id)a LEFT JOIN Users ON a.user_id = Users.user_id ORDER BY number DESC, name ASC Limit 1) UNION ALL (SELECT title as results From( SELECT movie_id, avg(rating) as rate From Movie_Rating WHERE LEFT(created_at,7) ='2020-02' Group by movie_id)b LEFT JOIN Movies ON b.movie_id = Movies.movie_id ORDER BY rate DESC, title ASC LIMIT 1) "" "
283,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m1"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" AS ""m1"" ON ""m"".""movie_id""=""m1"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""m"".""rating"") DESC,""m1"".""title"" LIMIT 1)"
284,"(SELECT ""U"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""MR"" JOIN ""Users"" AS ""U"" ON ""MR"".""user_id""=""U"".""user_id"" GROUP BY ""MR"".""user_id"" ORDER BY COUNT(""MR"".""movie_id"") DESC,""U"".""name"" LIMIT 1) UNION (SELECT ""M"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""MR"" JOIN ""Movies"" AS ""M"" ON ""MR"".""movie_id""=""M"".""movie_id"" WHERE LEFT(""MR"".""created_at"", 7)='2020-02' GROUP BY ""MR"".""movie_id"" ORDER BY AVG(""MR"".""rating"") DESC,""M"".""title"" LIMIT 1)"
285,"WITH ""highest_rater"" AS (SELECT ""Users"".""name"" FROM (SELECT ""user_id"",COUNT(""rating"") AS ""rating_count"" FROM ""Movie_Rating"" GROUP BY 1 ORDER BY 2 DESC) AS ""m"" LEFT JOIN ""Users"" ON ""Users"".""user_id""=""m"".""user_id"" ORDER BY ""rating_count"" DESC,""name"" LIMIT 1), ""highest_average"" AS (SELECT ""Movies"".""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""average_rating"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1) AS ""m"" LEFT JOIN ""Movies"" ON ""m"".""movie_id""=""Movies"".""movie_id"" ORDER BY ""average_rating"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""highest_rater"" UNION ALL SELECT ""title"" AS ""results"" FROM ""highest_average"""
286,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
287,"WITH ""cte1"" AS (SELECT ""user_id"",COUNT(""user_id"") AS ""ct"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""cte2"" AS (SELECT *,AVG(""rating"") AS ""rt"" FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"") (SELECT ""name"" AS ""results"" FROM ""Users"" JOIN ""cte1"" USING (""user_id"") ORDER BY ""ct"" DESC,""name"" LIMIT 1) UNION (SELECT ""m"".""title"" FROM ""cte2"" JOIN ""Movies"" AS ""m"" USING (""movie_id"") ORDER BY ""rt"" DESC,""title"" LIMIT 1)"
288,"WITH ""MovieCritic"" AS (SELECT ""user_id"",RANK() OVER (ORDER BY COUNT(""movie_id"") DESC) AS ""Rk"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""GreatestMovie"" AS (SELECT ""movie_id"",RANK() OVER (ORDER BY AVG(""rating"") DESC) AS ""Rk"" FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"") SELECT MIN(""name"") AS ""results"" FROM ""Users"" AS ""U"" JOIN ""MovieCritic"" AS ""MC"" ON ""MC"".""user_id""=""U"".""user_id"" AND ""Rk""=1 UNION ALL SELECT MIN(""title"") FROM ""Movies"" AS ""M"" JOIN ""GreatestMovie"" AS ""GM"" ON ""GM"".""movie_id""=""M"".""movie_id"" AND ""Rk""=1"
289,"WITH ""x"" AS (SELECT ""b"".""name"" FROM ""movie_rating"" AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""b"".""name"" LIMIT 1), ""y"" AS (SELECT ""b"".""title"" FROM ""movie_rating"" AS ""a"" JOIN ""movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE LEFT(""a"".""created_at"", 7)='2020-02' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""a"".""rating"") DESC,""b"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""x"" UNION SELECT ""title"" AS ""results"" FROM ""y"""
290,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
291,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" HAVING COUNT(DISTINCT ""movie_id"")=(SELECT COUNT(DISTINCT ""movie_id"") AS ""review_count"" FROM ""Movie_Rating"" AS ""m"" GROUP BY ""user_id"" ORDER BY ""review_count"" DESC LIMIT 1) ORDER BY ""u"".""name"" LIMIT 1) UNION (SELECT ""mo"".""title"" FROM ""Movie_rating"" AS ""m"" JOIN ""Movies"" AS ""mo"" ON ""m"".""movie_id""=""mo"".""movie_id"" AND EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY ""m"".""movie_id"" HAVING AVG(""rating"")=(SELECT AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""m"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")=202002 GROUP BY ""movie_id"" ORDER BY ""avg_rating"" DESC LIMIT 1) ORDER BY ""mo"".""title"" LIMIT 1)"
292,"WITH ""cte"" AS (SELECT ""r"".""movie_id"",""m"".""title"",""r"".""user_id"",""u"".""name"",""r"".""rating"",""r"".""created_at"" FROM (""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"") JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""r"".""movie_id"",""r"".""user_id"" ORDER BY ""r"".""movie_id"",""r"".""user_id""), ""cte2"" AS (SELECT DISTINCT ""cte"".""title"" AS ""results"",AVG(""cte"".""rating"") OVER (PARTITION BY ""cte"".""movie_id"") AS ""score"" FROM ""cte"" WHERE ""cte"".""created_at"" LIKE '2020-02%' ORDER BY 2 DESC,1 LIMIT 1), ""cte3"" AS (SELECT DISTINCT ""cte"".""name"",COUNT(""cte"".""rating"") OVER (PARTITION BY ""cte"".""user_id"") AS ""rtcnt"" FROM ""cte"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""cte3"".""name"" AS ""results"" FROM ""cte3"" UNION SELECT ""cte2"".""results"" FROM ""cte2"""
293,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""results"" ORDER BY COUNT(""rating"") DESC,""results"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m1"" JOIN ""movie_rating"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""results"" ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1)"
294,"WITH ""user"" AS (SELECT ""u"".""name"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""m"".""rating"") DESC,""u"".""name"" LIMIT 1), ""movie"" AS (SELECT ""m"".""title"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_Id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""m"".""movie_Id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""user"" UNION ALL SELECT ""title"" AS ""results"" FROM ""movie"""
295,"WITH ""cte"" AS (SELECT ""u"".""name"",COUNT(""m"".""user_id"") AS ""ct"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1), ""cte2"" AS (SELECT ""m"".""title"",AVG(""rating"") AS ""avg_rat"" FROM ""Movie_Rating"" AS ""r"" LEFT JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""r"".""created_at"")=2 GROUP BY ""r"".""movie_id"" ORDER BY 2 DESC,""m"".""title"") SELECT ""name"" AS ""results"" FROM ""cte"" HAVING MAX(""ct"") UNION ALL SELECT ""title"" FROM ""cte2"" HAVING MAX(""avg_rat"")"
296,"WITH ""num_ratings_by_user"" AS (SELECT ""user_id"",COUNT(1) AS ""num_ratings"" FROM ""movie_rating"" GROUP BY ""user_id""), ""avg_ratings"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"") (SELECT ""name"" AS ""results"" FROM ""num_ratings_by_user"" AS ""z"" LEFT JOIN ""users"" AS ""u"" ON ""z"".""user_id""=""u"".""user_id"" WHERE ""num_ratings""=(SELECT MAX(""num_ratings"") FROM ""num_ratings_by_user"") ORDER BY ""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""avg_ratings"" AS ""zz"" LEFT JOIN ""movies"" AS ""m"" ON ""zz"".""movie_id""=""m"".""movie_id"" WHERE ""avg_rating""=(SELECT MAX(""avg_rating"") FROM ""avg_ratings"") ORDER BY ""title"" LIMIT 1)"
297,"SELECT ""name"" AS ""results"" FROM (SELECT ""m"".""user_id"",COUNT(1) AS ""movies_rated"",""u"".""name"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY ""movies_rated"" DESC,""u"".""name"" LIMIT 1) AS ""tbl"" UNION SELECT ""title"" FROM (SELECT ""m"".""movie_id"",AVG(""m"".""rating"") AS ""avg_rating"",""n"".""title"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Movies"" AS ""n"" ON ""m"".""movie_id""=""n"".""movie_id"" WHERE ""m"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""m"".""movie_id"" ORDER BY ""avg_rating"" DESC,""n"".""title"" LIMIT 1) AS ""tbl2"""
298,"SELECT ""results"" FROM ((SELECT COUNT(1) AS ""num_per_user"",""u"".""name"" AS ""results"" FROM (""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"") JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY 1 DESC,2 LIMIT 1) UNION (SELECT AVG(""rating"") AS ""rating_avg"",""m"".""title"" AS ""results"" FROM (""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"") JOIN ""users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" WHERE ""created_at"" BETWEEN DATE '2020-02-01' AND DATE '2020-02-29' GROUP BY ""m"".""title"" ORDER BY 1 DESC,2 LIMIT 1)) AS ""aa"""
299,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
300,"SELECT * FROM (SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY COUNT(DISTINCT ""movie_id"") DESC LIMIT 1) AS ""x"" UNION ALL SELECT * FROM (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1) AS ""x"""
301,"(SELECT ""name"" AS ""results"" FROM ""users"" JOIN ""movie_rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" JOIN ""movie_rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
302,"WITH ""t1"" AS (SELECT ""name"" AS ""results"" FROM ""movie_rating"" JOIN ""users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""title"" AS ""results"" FROM ""movie_rating"" JOIN ""movies"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""t1"" UNION SELECT * FROM ""t2"""
303,"(SELECT ""A"".""name"" AS ""results"" FROM (SELECT ""M"".""movie_id"",""M"".""user_id"",""M"".""rating"",""M"".""created_at"",""U"".""name"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""U"" ON ""M"".""user_id""=""U"".""user_id"") AS ""A"" GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""B"".""title"" AS ""results"" FROM (SELECT ""M"".""movie_id"",""M"".""user_id"",""M"".""rating"",""M"".""created_at"",""Mo"".""title"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Movies"" AS ""Mo"" ON ""M"".""movie_id""=""Mo"".""movie_id"") AS ""B"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
304,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
305,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""rating"") DESC,1 LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
306,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY COUNT(DISTINCT ""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m2"".""title"" AS ""results"" FROM ""Movies"" AS ""m2"" JOIN ""Movie_Rating"" AS ""m"" ON ""m2"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""m"".""created_at"")=2 GROUP BY 1 ORDER BY AVG(""m"".""rating"") DESC,""m2"".""title"" LIMIT 1)"
307,"WITH ""t1"" AS (SELECT ""u"".""name"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""m"".""movie_id"") AS ""cnt_rat_movie"" FROM ""movie_rating"" AS ""m"" GROUP BY ""user_id"" ORDER BY ""cnt_rat_movie"" DESC) AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""user_id"" ORDER BY ""t"".""cnt_rat_movie"" DESC,""u"".""name"" LIMIT 1), ""t2"" AS (SELECT ""m"".""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY 2 DESC) AS ""r"" JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" ORDER BY ""r"".""avg_rating"" DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM (SELECT * FROM ""t1"" UNION ALL SELECT * FROM ""t2"") AS ""x"""
308,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
309,"SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",DENSE_RANK() OVER (ORDER BY COUNT(""m"".""rating"") DESC,""u"".""name"") AS ""DR"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"") AS ""usr"" WHERE ""DR""=1 UNION ALL SELECT ""title"" AS ""results"" FROM (SELECT ""mo"".""title"",DENSE_RANK() OVER (ORDER BY AVG(""m"".""rating"") DESC,""mo"".""title"") AS ""DR"" FROM ""movies"" AS ""mo"" JOIN ""Movie_Rating"" AS ""m"" ON ""mo"".""movie_id""=""m"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"") AS ""mov"" WHERE ""DR""=1"
310,"WITH ""a"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""r"".""user_id"" ORDER BY COUNT(""u"".""name"") DESC,""u"".""name"" LIMIT 1), ""b"" AS (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE ""r"".""created_at"">='2020-02-01' AND ""r"".""created_at""<'2020-03-01' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""r"".""rating"") DESC,""results"" LIMIT 1) SELECT * FROM ""a"" UNION SELECT * FROM ""b"""
311,"WITH ""user_ratings"" AS (SELECT ""u"".""name"",COUNT(DISTINCT ""mr"".""movie_id"") AS ""movies_rated"" FROM ""users"" AS ""u"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1), ""highest_202002_avg_rating"" AS (SELECT ""m"".""title"",AVG(""mr"".""rating"") AS ""avg_rating"" FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<'2020-03-01' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) SELECT ""u"".""name"" AS ""results"" FROM ""user_ratings"" AS ""u"" UNION ALL SELECT ""title"" AS ""results"" FROM ""highest_202002_avg_rating"" AS ""h"""
312,"WITH ""cte"" AS (SELECT ""title"",""name"",""rating"",""created_at"" FROM (""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"") JOIN ""movies"" AS ""mv"" ON ""m"".""movie_id""=""mv"".""movie_id"") SELECT ""results"" FROM ((SELECT ""name"" AS ""results"" FROM ""cte"" GROUP BY ""name"" ORDER BY COUNT(1) DESC,""results"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""cte"" WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1)) AS ""v"""
313,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" USING (""user_id"") GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""Movie_Rating"" AS ""m1"" JOIN ""Movies"" AS ""m2"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m1"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
314,"(SELECT ""name"" AS ""results"" FROM ""Users"" JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" FROM ""Movies"" JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
315,"(SELECT ""b"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""c"" JOIN ""Users"" AS ""b"" ON ""c"".""user_id""=""b"".""user_id"" GROUP BY ""b"".""name"" ORDER BY COUNT(DISTINCT ""c"".""movie_id"") DESC,""b"".""name"" LIMIT 1) UNION ALL (SELECT ""a"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""c"" JOIN ""Movies"" AS ""a"" ON ""c"".""movie_id""=""a"".""movie_id"" WHERE ""c"".""created_at"" LIKE '2020-02%' GROUP BY ""a"".""title"" ORDER BY AVG(""c"".""rating"") DESC,""a"".""title"" LIMIT 1)"
316,"(SELECT DISTINCT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""m"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1)"
317,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN (SELECT ""user_id"",COUNT(1) AS ""total"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""mr1"" ON ""u"".""user_id""=""mr1"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""mr1"".""total"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""movie_id"") AS ""mr2"" ON ""m"".""movie_id""=""mr2"".""movie_id"" GROUP BY ""m"".""title"" ORDER BY ""mr2"".""avg_rating"" DESC,""m"".""title"" LIMIT 1)"
318,"SELECT ""user_name"" AS ""results"" FROM (SELECT ""b"".""name"" AS ""user_name"",COUNT(1) AS ""counts"" FROM ""Movie_rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""counts"" DESC,""user_name"" LIMIT 1) AS ""first_query"" UNION SELECT ""movie_name"" AS ""results"" FROM (SELECT ""d"".""title"" AS ""movie_name"",AVG(""c"".""rating"") AS ""grade"" FROM ""Movie_rating"" AS ""c"" JOIN ""Movies"" AS ""d"" ON ""c"".""movie_id""=""d"".""movie_id"" WHERE SUBSTR(""c"".""created_at"", 1, 7)='2020-02' GROUP BY ""c"".""movie_id"" ORDER BY ""grade"" DESC,""movie_name"" LIMIT 1) AS ""second_query"""
319,"WITH ""cte"" AS (SELECT ""u"".""name"" FROM (SELECT ""user_id"",COUNT(""user_id"") AS ""cnt"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""a"" LEFT JOIN ""Users"" AS ""u"" USING (""user_id"") ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1), ""cte1"" AS (SELECT ""m"".""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"") AS ""a"" LEFT JOIN ""Movies"" AS ""m"" USING (""movie_id"") ORDER BY ""avg_"" DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte"" UNION SELECT ""title"" AS ""results"" FROM ""cte1"""
320,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" USING (""user_id"") GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" USING (""movie_id"") WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1)"
321,"(SELECT ""r1"".""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(DISTINCT ""movie_id"") AS ""num_m"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""r"".""user_id"" ORDER BY ""num_m"" DESC,""name"" LIMIT 1) AS ""r1"") UNION ALL (SELECT ""r2"".""title"" AS ""results"" FROM (SELECT ""m"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""r"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""r2"")"
322,"WITH ""t1"" AS (SELECT ""u"".""name"" AS ""resultS"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1), ""t2"" AS (SELECT ""m2"".""title"" AS ""resultS"" FROM ""Movie_Rating"" AS ""m1"" LEFT JOIN ""Movies"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""m1"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m2"".""title"" LIMIT 1) SELECT ""results"" FROM ""t1"" UNION ALL SELECT ""results"" FROM ""t2"""
323,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",RANK() OVER (ORDER BY ""num_reviews"" DESC,""name"") AS ""rnk"" FROM (SELECT ""m"".""user_id"",""name"",COUNT(1) AS ""num_reviews"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1,2) AS ""h"") AS ""p"" WHERE ""rnk""=1 UNION SELECT ""title"" FROM (SELECT ""title"",RANK() OVER (ORDER BY ""rr"" DESC,""title"") AS ""rnk"" FROM (SELECT ""mr"".""movie_id"",""title"",AVG(""rating"") AS ""rr"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1,2) AS ""h"") AS ""p"" WHERE ""rnk""=1"
324,"SELECT ""t"".""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""rating"") AS ""cnt"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1) AS ""t"" UNION ALL SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") AS ""ag"" FROM ""Movie_Rating"" AS ""r"" JOIN ""Movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" AND LEFT(""r"".""created_at"", 7)='2020-02' GROUP BY ""title"" ORDER BY ""ag"" DESC,""title"" LIMIT 1) AS ""t2"""
325,"(SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(""user_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m2"".""title"" AS ""results"" FROM ""movie_rating"" AS ""m1"" LEFT JOIN ""movies"" AS ""m2"" USING (""movie_id"") WHERE ""m1"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""movie_id"" ORDER BY AVG(""m1"".""rating"") DESC,""m2"".""title"" LIMIT 1)"
326,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Users"".""user_id""=""Movie_Rating"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Movies"" ON ""Movies"".""movie_id""=""Movie_Rating"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
327,"(SELECT ""name"" AS ""results"" FROM (SELECT ""u"".""name"",DENSE_RANK() OVER (ORDER BY COUNT(""mr"".""movie_id"") DESC,""u"".""name"") AS ""ratingrank"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""name"") AS ""tmp"" WHERE ""tmp"".""ratingrank""=1) UNION ALL (SELECT ""title"" AS ""results"" FROM (SELECT ""m"".""title"",DENSE_RANK() OVER (ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"") AS ""avgratingrank"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"",""rating"" FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02') AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" GROUP BY ""m"".""movie_id"") AS ""tmp2"" WHERE ""tmp2"".""avgratingrank""=1)"
328,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""users"" AS ""u"" ON ""r"".""user_id""=""u"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""r"" LEFT JOIN ""movies"" AS ""m"" ON ""r"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
329,"(SELECT ""u"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"" ORDER BY ""a"".""cnt"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
330,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""a"" JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
331,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(""user_id"") AS ""num_ratings"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY ""num_ratings"" DESC,""name"" LIMIT 1) AS ""x"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_rating"" LEFT JOIN ""Movies"" USING (""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) AS ""y"""
332,"(SELECT ""name"" AS ""results"" FROM ""users"" NATURAL CROSS JOIN ""movie_rating"" GROUP BY ""user_id"",""name"" ORDER BY COUNT(1) DESC,1 LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" NATURAL CROSS JOIN ""movie_rating"" WHERE ""created_at"" LIKE '2020-02%' GROUP BY ""movie_id"",""title"" ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
333,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""mov"" JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM ""movie_rating"" AS ""mov"" JOIN ""movies"" AS ""m"" USING (""movie_id"") WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
334,"ERROR: mysql parse error: line 1 column 126 near ""u inner join cte1 c on c.user_id=u.user_id order by cnt desc, u.name asc limit 1 ), cte3 as ( select movie_id, avg(rating) as avg_rating from movie_rating where month(created_at) = 2 and year(created_at) = 2020 group by movie_id ), cte4 as ( select m.title from cte3 inner join movies m on m.movie_id = cte3.movie_id order by avg_rating desc, m.title asc limit 1 ) select name as results from cte2 union all select * from cte4 "" "
335,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(""movie_id"") AS ""no_movie_rated"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""t1"" UNION SELECT ""title"" AS ""results"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""t2"""
336,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""name"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
337,"WITH ""cte"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""results"" LIMIT 1), ""demo"" AS (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""movies"" AS ""mv"" ON ""m"".""movie_id""=""mv"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1) SELECT ""results"" FROM ""cte"" UNION ALL SELECT ""results"" FROM ""demo"""
338,"WITH ""bigtime_nerd"" AS (SELECT ""name"" FROM (SELECT ""user_id"",COUNT(1) AS ""total"" FROM ""movie_rating"" AS ""m"" GROUP BY 1 ORDER BY 2 DESC) AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" ORDER BY ""total"" DESC,""name"" LIMIT 1), ""moviezz"" AS (SELECT ""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""average"" FROM ""movie_rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1) AS ""f"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""f"".""movie_id"" ORDER BY ""average"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""bigtime_nerd"" UNION ALL SELECT ""title"" AS ""results"" FROM ""moviezz"""
339,"(SELECT ""Users"".""name"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Users"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""Users"".""name"" LIMIT 1) UNION (SELECT ""Movies"".""title"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Movies"" ON ""Movie_Rating"".""movie_id""=""Movies"".""movie_id"" WHERE EXTRACT(MONTH FROM ""Movie_Rating"".""created_at"")=2 AND EXTRACT(YEAR FROM ""Movie_Rating"".""created_at"")=2020 GROUP BY ""Movies"".""movie_id"" ORDER BY AVG(""Movie_Rating"".""rating"") DESC,""Movies"".""title"" LIMIT 1)"
340,"WITH ""greatest_user"" AS (SELECT ""u"".""name"",COUNT(DISTINCT ""movie_id"") AS ""movies_rated"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""movies_rated"" DESC,""u"".""name"" LIMIT 1), ""mv_fb_20"" AS (SELECT ""m"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""mr"".""created_at"")=2 AND EXTRACT(YEAR FROM ""mr"".""created_at"")=2020 GROUP BY ""m"".""title"" ORDER BY ""avg_rating"" DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""greatest_user"" UNION ALL SELECT ""title"" AS ""results"" FROM ""mv_fb_20"""
341,"(SELECT ""title"" AS ""results"" FROM (SELECT ""m2"".""title"",RANK() OVER (ORDER BY AVG(""m1"".""rating"") DESC) AS ""movie_rnk"" FROM ""Movie_Rating"" AS ""m1"" JOIN ""Movies"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""m1"".""created_at"")=2 GROUP BY ""m1"".""movie_id"") AS ""t"" WHERE ""movie_rnk""=1 ORDER BY ""title"" LIMIT 1) UNION (SELECT ""name"" FROM (SELECT ""u"".""name"",RANK() OVER (ORDER BY COUNT(""m"".""user_id"") DESC) AS ""movie_rnk"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"") AS ""t"" WHERE ""movie_rnk""=1 ORDER BY ""name"" LIMIT 1)"
342,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" LEFT JOIN ""Users"" ON ""Movie_Rating"".""user_id""=""Users"".""user_id"" GROUP BY ""Movie_Rating"".""user_id"" ORDER BY COUNT(""created_at"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""Movies"".""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""rating"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR FROM ""created_at"")='2020' AND EXTRACT(MONTH FROM ""created_at"")='2' GROUP BY ""movie_id"") AS ""a"" LEFT JOIN ""Movies"" ON ""a"".""movie_id""=""Movies"".""movie_id"" ORDER BY ""a"".""rating"" DESC,""Movies"".""title"" LIMIT 1)"
343,"WITH ""c1"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1), ""c2"" AS (SELECT ""u"".""title"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""movies"" AS ""u"" ON ""u"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")='202002' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""u"".""title"" LIMIT 1) SELECT * FROM ""c1"" UNION SELECT * FROM ""c2"""
344,"WITH ""req_user"" AS (SELECT ""agg"".""name"" AS ""results"" FROM (SELECT ""u"".""name"",COUNT(""mr"".""movie_id"") AS ""no_reviews"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""AGG""), ""req_movie"" AS (SELECT ""agg"".""title"" AS ""results"" FROM (SELECT ""m"".""title"",SUM(""mr"".""rating"")/COUNT(""mr"".""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY 1 ORDER BY ""avg_rating"" DESC,""m"".""title"" LIMIT 1) AS ""AGG"") SELECT ""results"" FROM ""req_user"" UNION ALL SELECT ""results"" FROM ""req_movie"""
345,"WITH ""u_t"" AS (SELECT ""user_id"",""name"",COUNT(""rating"") AS ""rating"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id""), ""m_t"" AS (SELECT ""movie_id"",""title"",AVG(""rating"") AS ""rating"" FROM ""movie_rating"" AS ""m"" LEFT JOIN ""movies"" AS ""mv"" USING (""movie_id"") WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""movie_id"") SELECT * FROM ((SELECT ""name"" AS ""results"" FROM ""u_t"" ORDER BY ""rating"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""m_t"" ORDER BY ""rating"" DESC,""title"" LIMIT 1)) AS ""t5"""
346,"SELECT * FROM (SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN (SELECT ""user_id"",COUNT(""movie_id"") AS ""count"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""a"" ON ""a"".""user_id""=""u"".""user_id"" ORDER BY ""a"".""count"" DESC,""name"" LIMIT 1) AS ""c"" UNION ALL SELECT * FROM (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN (SELECT ""movie_id"",AVG(""rating"") AS ""avge"" FROM ""movie_rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"") AS ""b"" ON ""b"".""movie_id""=""m"".""movie_id"" ORDER BY ""b"".""avge"" DESC,""m"".""title"" LIMIT 1) AS ""d"""
347,"ERROR: mysql parse error: line 1 column 148 near ""u inner join cte1 c on c.user_id=u.user_id order by cnt desc, u.name asc limit 1 ), cte3 as ( select movie_id, avg(rating) as avg_rating from movie_rating where month(created_at) = 2 and year(created_at) = 2020 group by movie_id ), cte4 as ( select m.title from cte3 inner join movies m on m.movie_id = cte3.movie_id order by avg_rating desc, m.title asc limit 1 ) select name as results from cte2 union all select * from cte4 "" "
348,"(SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""mr"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
349,"(SELECT ""users"".""name"" AS ""results"" FROM ""movie_rating"" LEFT JOIN ""users"" ON ""users"".""user_id""=""movie_rating"".""user_id"" GROUP BY ""movie_rating"".""user_id"" ORDER BY COUNT(""movie_id"") DESC,""users"".""name"" LIMIT 1) UNION (SELECT ""movies"".""title"" AS ""results"" FROM ""movie_rating"" LEFT JOIN ""movies"" ON ""movie_rating"".""movie_id""=""movies"".""movie_id"" WHERE ""movie_rating"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""movie_rating"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
350,"(SELECT ""title"" AS ""results"" FROM (SELECT ""m2"".""title"",RANK() OVER (ORDER BY AVG(""m1"".""rating"") DESC) AS ""movie_rnk"" FROM ""Movie_Rating"" AS ""m1"" JOIN ""Movies"" AS ""m2"" ON ""m1"".""movie_id""=""m2"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""m1"".""created_at"")=2 GROUP BY ""m1"".""movie_id"") AS ""t"" WHERE ""movie_rnk""=1 ORDER BY ""title"" LIMIT 1) UNION (SELECT ""name"" FROM (SELECT ""u"".""name"",RANK() OVER (ORDER BY COUNT(""m"".""user_id"") DESC) AS ""movie_rnk"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"") AS ""t"" WHERE ""movie_rnk""=1 ORDER BY ""name"" LIMIT 1)"
351,"SELECT * FROM (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY COUNT(DISTINCT ""movie_id"") DESC,1 LIMIT 1) AS ""y"" UNION ALL SELECT * FROM (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1) AS ""x"""
352,"WITH ""user_rating"" AS (SELECT ""user_id"",COUNT(""movie_id"") AS ""rated"" FROM ""movie_rating"" GROUP BY ""user_id"" ORDER BY ""rated"" DESC), ""high_average"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""rating"" FROM ""movie_rating"" WHERE TO_CHAR(""created_at"", '%y-%m')='20-02' GROUP BY ""movie_id"" ORDER BY ""rating""), ""a"" AS (SELECT DISTINCT ""u"".""name"" AS ""results"" FROM ""user_rating"" AS ""ur"" JOIN ""users"" AS ""u"" ON ""ur"".""user_id""=""u"".""user_id"" ORDER BY ""ur"".""rated"" DESC,""u"".""name"" LIMIT 1), ""b"" AS (SELECT DISTINCT ""m"".""title"" AS ""results"" FROM ""high_average"" AS ""ha"" JOIN ""movies"" AS ""m"" ON ""ha"".""movie_id""=""m"".""movie_id"" ORDER BY ""ha"".""rating"" DESC,""m"".""title"" LIMIT 1) SELECT * FROM ""a"" UNION SELECT * FROM ""b"""
353,"(SELECT ""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY COUNT(1) DESC,1 LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""movies"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
354,"WITH ""t1"" AS (SELECT ""name"" FROM ""users"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""title"" FROM ""movies"" AS ""a"" JOIN ""movie_rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""t1"" UNION ALL SELECT * FROM ""t2"""
355,"WITH ""bigtime_nerd"" AS (SELECT ""name"" FROM (SELECT ""user_id"",COUNT(1) AS ""total"" FROM ""movie_rating"" AS ""m"" GROUP BY 1 ORDER BY 2 DESC) AS ""m"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" ORDER BY ""total"" DESC,""name"" LIMIT 1), ""moviezz"" AS (SELECT ""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""average"" FROM ""movie_rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1) AS ""f"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""f"".""movie_id"" ORDER BY ""average"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""bigtime_nerd"" UNION ALL SELECT ""title"" AS ""results"" FROM ""moviezz"""
356,"WITH ""cte"" AS (SELECT ""name"" FROM (SELECT ""name"",RANK() OVER (ORDER BY ""cnt"" DESC,""name"") AS ""rn"" FROM (SELECT ""name"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1) AS ""x"") AS ""y"" WHERE ""rn""=1), ""cte2"" AS (SELECT ""title"" FROM (SELECT ""title"",RANK() OVER (ORDER BY ""avg_rating"" DESC,""title"") AS ""rn"" FROM (SELECT ""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY 1) AS ""x"") AS ""y"" WHERE ""rn""=1) SELECT ""name"" AS ""results"" FROM ""cte"" UNION ALL SELECT ""title"" AS ""results"" FROM ""cte2"""
357,"(SELECT ""U"".""name"" AS ""results"" FROM (""Movie_Rating"" AS ""M"") CROSS JOIN ""Users"" AS ""U"" WHERE ""M"".""user_id""=""U"".""user_id"" GROUP BY ""M"".""user_id"" ORDER BY COUNT(DISTINCT ""M"".""movie_id"") DESC,""U"".""name"" LIMIT 1) UNION ALL (SELECT ""M2"".""title"" AS ""results"" FROM (""Movie_Rating"" AS ""M1"") CROSS JOIN ""Movies"" AS ""M2"" WHERE ""M1"".""movie_id""=""M2"".""movie_id"" AND EXTRACT(MONTH FROM ""M1"".""created_at"")=2 AND EXTRACT(YEAR FROM ""M1"".""created_at"")=2020 GROUP BY ""M1"".""movie_id"" ORDER BY AVG(""M1"".""rating"") DESC,""M2"".""title"" LIMIT 1)"
358,"SELECT ""t1"".""results"" FROM (SELECT ""u"".""name"" AS ""results"",COUNT(""m"".""user_id"") AS ""num_of_comment"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""t1"" UNION SELECT ""t2"".""results"" FROM (SELECT ""movies"".""title"" AS ""results"",AVG(""m"".""rating"") FROM ""Movie_Rating"" AS ""m"" JOIN ""movies"" ON ""m"".""movie_id""=""movies"".""movie_id"" AND EXTRACT(MONTH FROM ""m"".""created_at"")='02' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""t2"""
359,"WITH ""cte1"" AS (SELECT ""user_id"",""name"",COUNT(""movie_id"") AS ""movie_count"" FROM ""movie_rating"" NATURAL CROSS JOIN ""users"" GROUP BY ""user_id"",""name""), ""cte2"" AS (SELECT ""movie_id"",""title"",AVG(""rating"") AS ""movie_rating"" FROM ""movie_rating"" NATURAL CROSS JOIN ""movies"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""movie_id"",""title"") (SELECT ""name"" AS ""results"" FROM ""cte1"" WHERE ""movie_count""=(SELECT MAX(""movie_count"") FROM ""cte1"") ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""cte2"" WHERE ""movie_rating""=(SELECT MAX(""movie_rating"") FROM ""cte2"") ORDER BY ""title"" LIMIT 1)"
360,"(SELECT ""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(DISTINCT ""m"".""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE ""r"".""created_at"" LIKE '2020-02%' GROUP BY ""r"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
361,"(SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""u"".""user_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" FROM ""movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" AND EXTRACT(MONTH FROM ""created_at"")='2' GROUP BY ""mr"".""movie_id"" ORDER BY SUM(""mr"".""rating"")/COUNT(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
362,"SELECT ""temp"".""name"" AS ""results"" FROM (SELECT ""u"".""user_id"",""u"".""name"",COUNT(""m"".""rating"") AS ""cnt"" FROM ""Movie_Rating"" AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1) AS ""temp"" UNION SELECT ""temp"".""title"" FROM (SELECT ""m"".""movie_id"",""m"".""title"",AVG(""r"".""rating"") AS ""average_rating"" FROM ""Movie_Rating"" AS ""r"" RIGHT JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1 ORDER BY ""average_rating"" DESC,""m"".""title"" LIMIT 1) AS ""temp"""
363,"(SELECT ""u"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"" ORDER BY ""a"".""cnt"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" LEFT JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
364,"WITH ""cte1"" AS (SELECT ""name"" FROM (SELECT ""name"",COUNT(""u"".""user_id"") AS ""cnt"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""name"") AS ""a"" ORDER BY ""cnt"" DESC,""name"" LIMIT 1), ""cte2"" AS (SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") AS ""average"" FROM ""Movie_Rating"" AS ""m"" JOIN ""Movies"" AS ""v"" ON ""m"".""movie_id""=""v"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""title"" ORDER BY ""average"" DESC,""title"") AS ""b"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""cte1"" UNION SELECT ""title"" AS ""results"" FROM ""cte2"""
365,"(SELECT ""a"".""name"" AS ""results"" FROM ""Users"" AS ""a"" LEFT JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""name"" ORDER BY COUNT(""a"".""user_id"") DESC,""a"".""name"" LIMIT 1) UNION (SELECT ""a"".""title"" AS ""results"" FROM ""Movies"" AS ""a"" LEFT JOIN ""Movie_Rating"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(YEAR_MONTH FROM ""created_at"")='202002' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""b"".""rating"") DESC,""a"".""title"" LIMIT 1)"
366,"SELECT ""results"" FROM (SELECT ""U"".""name"" AS ""results"" FROM ""Users"" AS ""U"" JOIN ""Movie_Rating"" AS ""M"" ON ""U"".""user_id""=""M"".""user_id"" GROUP BY ""U"".""user_id"" ORDER BY COUNT(""M"".""movie_id"") DESC,""U"".""name"" LIMIT 1) AS ""f"" UNION ALL SELECT ""results"" FROM (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""M"" JOIN ""Movie_Rating"" AS ""MR"" ON ""M"".""movie_id""=""MR"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""MR"".""movie_id"" ORDER BY SUM(""rating"")/COUNT(""user_id"") DESC,""title"" LIMIT 1) AS ""s"""
367,"(SELECT ""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(""movie_id"") AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""t"" JOIN ""users"" USING (""user_id"") ORDER BY ""cnt"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""ar"" FROM ""movie_rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""movie_id"") AS ""s"" JOIN ""movies"" USING (""movie_id"") ORDER BY ""ar"" DESC,""title"" LIMIT 1)"
368,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" LEFT JOIN ""Movie_rating"" AS ""r"" ON ""u"".""user_id""=""r"".""user_id"" GROUP BY ""u"".""name"" ORDER BY COUNT(""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" LEFT JOIN ""Movie_Rating"" AS ""r"" ON ""m"".""movie_id""=""r"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""title"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1)"
369,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(""movie_id"") AS ""num"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""cte2"" AS (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"") (SELECT ""name"" AS ""results"" FROM ""cte"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""cte"".""user_id"" ORDER BY ""num"" DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""cte2"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""cte2"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1)"
370,"(SELECT ""U"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""R"" LEFT JOIN ""Users"" AS ""U"" ON ""R"".""user_id""=""U"".""user_id"" GROUP BY ""R"".""user_id"" ORDER BY COUNT(""R"".""movie_id"") DESC,""U"".""name"" LIMIT 1) UNION (SELECT ""M"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""R"" LEFT JOIN ""Movies"" AS ""M"" ON ""R"".""movie_id""=""M"".""movie_id"" WHERE ""R"".""created_at"" LIKE '2020-02%' GROUP BY ""R"".""movie_id"" ORDER BY AVG(""R"".""rating"") DESC,""M"".""title"" LIMIT 1)"
371,"(SELECT ""U"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""U"" USING (""user_id"") GROUP BY 1 ORDER BY COUNT(1) DESC,""U"".""name"" LIMIT 1) UNION ALL (SELECT ""M"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""R"" JOIN ""Movies"" AS ""M"" USING (""movie_id"") WHERE TO_CHAR(""R"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""M"".""title"" LIMIT 1)"
372,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(1) DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
373,"WITH ""cte"" AS (SELECT ""m"".""title"" AS ""results"",AVG(""mr"".""rating"") AS ""avg_rating"" FROM ""movies"" AS ""m"" JOIN ""movie_rating"" AS ""mr"" USING (""movie_id"") WHERE LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY 1) (SELECT ""u"".""name"" AS ""results"" FROM ""users"" AS ""u"" JOIN ""movie_rating"" AS ""mr"" USING (""user_id"") GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""mr"".""user_id"") DESC,1 LIMIT 1) UNION ALL (SELECT ""results"" FROM ""cte"" WHERE ""avg_rating""=(SELECT MAX(""avg_rating"") FROM ""cte"") ORDER BY 1 LIMIT 1)"
374,"WITH ""t1"" AS (SELECT ""u"".""name"",COUNT(""movie_id"") AS ""ct"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY ""ct"" DESC,""u"".""name"" LIMIT 1), ""t2"" AS (SELECT ""m"".""title"",AVG(""rating"") AS ""ar"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""mr"".""movie_id"" ORDER BY ""ar"" DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""t1"" UNION SELECT ""title"" AS ""results"" FROM ""t2"""
375,"WITH ""t1"" AS (SELECT ""b"".""name"",COUNT(DISTINCT ""a"".""movie_id"") AS ""rating_qty"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""b"".""name"" ORDER BY ""rating_qty"" DESC,""name"" LIMIT 1), ""t2"" AS (SELECT ""b"".""title"",AVG(""a"".""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""a"".""created_at"">='2020-02-01' AND ""a"".""created_at""<='2020-02-29' GROUP BY ""b"".""title"" ORDER BY ""avg_rating"" DESC,""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""t1"" UNION ALL SELECT ""title"" AS ""results"" FROM ""t2"""
376,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""movies"" ON ""m"".""movie_id""=""movies"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
377,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY ""u"".""user_id"",""u"".""name"" ORDER BY COUNT(""m"".""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""mr"".""movie_id"",""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
378,"SELECT ""name"" AS ""results"" FROM ""Users"" WHERE ""user_id""=(SELECT ""mr"".""user_id"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movies"" WHERE ""movie_id""=(SELECT ""mr"".""movie_id"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" AND LEFT(""mr"".""created_at"", 7)='2020-02' GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""rating"") DESC,""m"".""title"" LIMIT 1))"
379,"(SELECT ""b"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""B"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(""a"".""user_id"") DESC,""b"".""name"" LIMIT 1) UNION (SELECT ""b"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""B"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""a"".""movie_id"" ORDER BY AVG(""a"".""rating"") DESC,""b"".""title"" LIMIT 1)"
380,"WITH ""t"" AS (SELECT ""title"",MAX(AVG(""mr"".""rating"")) OVER (PARTITION BY ""mr"".""movie_id"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1) (SELECT ""title"" AS ""results"" FROM ""t"" WHERE ""avg_rating"" IN (SELECT MAX(""avg_rating"") FROM ""t"") ORDER BY ""title"" LIMIT 1) UNION (SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr2"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""mr2"".""user_id"" GROUP BY 1 ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1)"
381,"(SELECT ""name"" AS ""results"" FROM ""Users"" JOIN (SELECT ""user_id"",COUNT(""mr"".""rating"") AS ""cnt_r"" FROM ""Movie_Rating"" AS ""mr"" GROUP BY 1) AS ""u"" USING (""user_id"") ORDER BY ""cnt_r"" DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN (SELECT ""movie_id"",AVG(""mr0"".""rating"") AS ""avg_r"" FROM ""Movie_Rating"" AS ""mr0"" WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY 1) AS ""r"" USING (""movie_id"") ORDER BY ""avg_r"" DESC,""title"" LIMIT 1)"
382,"(SELECT ""sub_master_1"".""results"" FROM (SELECT ""u"".""name"" AS ""results"",RANK() OVER (ORDER BY ""rating_count"" DESC) AS ""count_rank"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""rating_count"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""sub"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""sub"".""user_id"") AS ""sub_master_1"" WHERE ""sub_master_1"".""count_rank""=1 ORDER BY ""sub_master_1"".""results"" LIMIT 1) UNION (SELECT ""sub_master_2"".""results"" FROM (SELECT ""m"".""title"" AS ""results"",RANK() OVER (ORDER BY ""sub_2"".""avg_rating"" DESC) AS ""rating_rank"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""movie_id"") AS ""sub_2"" JOIN ""Movies"" AS ""m"" ON ""m"".""movie_id""=""sub_2"".""movie_id"") AS ""sub_master_2"" WHERE ""sub_master_2"".""rating_rank""=1 ORDER BY ""sub_master_2"".""results"" LIMIT 1)"
383,"WITH ""b"" AS (SELECT ""u"".""name"",COUNT(1) AS ""counts"" FROM (""users"" AS ""u"") CROSS JOIN ""movie_rating"" AS ""m"" WHERE ""m"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""name"" ORDER BY ""u"".""name""), ""a"" AS (SELECT ""title"",AVG(""rating"") OVER (PARTITION BY ""title"") AS ""avgs"" FROM (""movies"") CROSS JOIN ""movie_rating"" WHERE ""movie_rating"".""movie_id""=""movies"".""movie_id"" AND TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' ORDER BY ""title"") (SELECT ""name"" AS ""results"" FROM ""b"" WHERE ""counts"" IN (SELECT MAX(""counts"") FROM ""b"") LIMIT 1) UNION (SELECT ""title"" FROM ""a"" WHERE ""avgs"" IN (SELECT MAX(""avgs"") FROM ""a"") LIMIT 1)"
384,"(SELECT ""U"".""name"" AS ""RESULTS"" FROM ""Movie_Rating"" AS ""MV"" JOIN ""Users"" AS ""U"" ON ""MV"".""USER_ID""=""U"".""USER_ID"" GROUP BY ""U"".""name"" ORDER BY COUNT(""MV"".""MOVIE_ID"") DESC,""U"".""name"" LIMIT 1) UNION (SELECT ""M"".""TITLE"" AS ""RESULTS"" FROM ""Movie_Rating"" AS ""MV"" JOIN ""Movies"" AS ""M"" ON ""MV"".""MOVIE_ID""=""M"".""MOVIE_ID"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY ""M"".""TITLE"" ORDER BY AVG(""RATING"") DESC,""M"".""TITLE"" LIMIT 1)"
385,"(SELECT ""name"" AS ""results"" FROM ""users"" JOIN ""movie_rating"" USING (""user_id"") GROUP BY ""movie_rating"".""user_id"",""name"" ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""movies"" JOIN ""movie_rating"" USING (""movie_id"") WHERE TO_CHAR(""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
386,"WITH ""highest_user"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""m"" ON ""u"".""user_id""=""m"".""user_id"" GROUP BY 1 ORDER BY COUNT(""rating"") DESC,""results"" LIMIT 1), ""highest_rating"" AS (SELECT ""m"".""title"" AS ""results"" FROM ""Movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE TO_CHAR(""mr"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY AVG(""rating"") DESC,""results"" LIMIT 1) SELECT ""results"" FROM ""highest_user"" UNION ALL SELECT ""results"" FROM ""highest_rating"""
387,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY COUNT(""a"".""movie_id"") DESC,""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""movie_id"",""rating"" FROM ""Movie_Rating"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2) AS ""a"" JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" GROUP BY ""a"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
388,"SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(""movie_id"") FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""a"" UNION ALL SELECT ""title"" FROM (SELECT ""title"",AVG(""rating"") FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE SUBSTR(""created_at"", 1, 7)='2020-02' GROUP BY 1 ORDER BY 2 DESC,1 LIMIT 1) AS ""a"""
389,"SELECT ""temp1"".""results"" FROM (SELECT ""u"".""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY ""mr"".""user_id"" ORDER BY COUNT(""mr"".""movie_id"") DESC,""u"".""name"" LIMIT 1) AS ""temp1"" UNION SELECT ""temp2"".""results"" FROM (SELECT ""m"".""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE EXTRACT(YEAR FROM ""mr"".""created_at"")=2020 AND EXTRACT(MONTH FROM ""mr"".""created_at"")=2 GROUP BY ""mr"".""movie_id"" ORDER BY AVG(""mr"".""rating"") DESC,1 LIMIT 1) AS ""temp2"""
390,"WITH ""user_rating"" AS (SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Users"" AS ""u"" ON ""mr"".""user_id""=""u"".""user_id"" GROUP BY 1 ORDER BY COUNT(""movie_id"") DESC,""name"" LIMIT 1), ""highest_movie_rating_feb_2020"" AS (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" AS ""mr"" JOIN ""Movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE TO_CHAR(""mr"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY 1 ORDER BY AVG(""mr"".""rating"") DESC,""title"" LIMIT 1) SELECT * FROM ""user_rating"" UNION ALL SELECT * FROM ""highest_movie_rating_feb_2020"""
391,"WITH ""name"" AS (SELECT ""name"" AS ""results"" FROM (SELECT ""name"",COUNT(DISTINCT ""B"".""movie_id"") AS ""num_rated_movies"" FROM (""Movies"" AS ""A"" JOIN ""Movie_Rating"" AS ""B"" ON ""A"".""movie_id""=""B"".""movie_id"") JOIN ""Users"" AS ""C"" ON ""C"".""user_id""=""B"".""user_id"" GROUP BY 1 ORDER BY 2 DESC,1) AS ""A"" LIMIT 1), ""movies"" AS (SELECT ""title"" AS ""results"" FROM (SELECT ""B"".""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""A"" JOIN ""Movies"" AS ""B"" ON ""A"".""movie_id""=""B"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-29' GROUP BY 1 ORDER BY 2 DESC,1) AS ""A"" LIMIT 1) SELECT * FROM ""name"" UNION ALL SELECT * FROM ""movies"""
392,"(SELECT ""name"" AS ""results"" FROM ""Users"" LEFT JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""name"" ORDER BY COUNT(""movie_id"") DESC,1 LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" LEFT JOIN ""Movie_Rating"" USING (""movie_id"") WHERE ""created_at"" BETWEEN CAST('2020-02-01' AS DATE) AND CAST('2020-02-29' AS DATE) GROUP BY ""title"" ORDER BY AVG(""rating"") DESC,1 LIMIT 1)"
393,"WITH ""rating_no"" AS (SELECT ""mr"".""user_id"",""name"",COUNT(""rating"") AS ""cnt"" FROM ""movie_rating"" AS ""mr"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""mr"".""user_id"" GROUP BY ""user_id"" ORDER BY ""cnt"" DESC,""u"".""name"" LIMIT 1), ""rating_rk"" AS (SELECT ""m"".""title"",""mr"".""movie_id"",AVG(""mr"".""rating"") AS ""rt"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""m"".""movie_id""=""mr"".""movie_id"" WHERE ""mr"".""created_at"" BETWEEN '20200201' AND '20200228' GROUP BY ""movie_id"" ORDER BY ""rt"" DESC,""m"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""rating_no"" UNION SELECT ""title"" AS ""results"" FROM ""rating_rk"""
394,"(SELECT ""u"".""name"" AS ""results"" FROM ""Users"" AS ""u"" JOIN ""Movie_Rating"" AS ""mr1"" ON ""u"".""user_id""=""mr1"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY COUNT(""mr1"".""rating"") DESC,""u"".""name"" LIMIT 1) UNION ALL (SELECT ""m"".""title"" AS ""results"" FROM ""movies"" AS ""m"" JOIN ""Movie_Rating"" AS ""mr2"" ON ""m"".""movie_id""=""mr2"".""movie_id"" WHERE TO_CHAR(""mr2"".""created_at"", 'YYYY-%m')='2020-02' GROUP BY ""m"".""movie_id"" ORDER BY AVG(""mr2"".""rating"") DESC,""m"".""title"" LIMIT 1)"
395,"(SELECT ""name"" AS ""results"" FROM (SELECT ""a"".""user_id"",""b"".""name"",COUNT(""movie_id"") AS ""num_movie"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"" ORDER BY ""num_movie"" DESC,""name"") AS ""temp"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM (SELECT ""a"".""movie_id"",""title"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" AS ""a"" JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE ""created_at"" BETWEEN '2020-02-01' AND '2020-02-28' GROUP BY ""a"".""movie_id"" ORDER BY ""avg_rating"" DESC,""title"") AS ""temp2"" LIMIT 1)"
396,"WITH ""CTE_USER"" AS (SELECT ""M"".""user_id"",""U"".""name"" AS ""user_name"",COUNT(""movie_id"") AS ""usercount"" FROM ""Movie_Rating"" AS ""M"" JOIN ""Users"" AS ""U"" ON ""M"".""user_id""=""U"".""user_id"" GROUP BY ""M"".""user_id"" ORDER BY ""usercount"" DESC,""user_name"" LIMIT 1), ""CTE_RATING"" AS (SELECT ""Title"",AVG(""rating"") FROM ""Movie_Rating"" AS ""MR"" JOIN ""Movies"" AS ""M"" ON ""MR"".""movie_id""=""M"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""MR"".""movie_id"" ORDER BY 2 DESC,1 LIMIT 1) SELECT ""user_name"" AS ""results"" FROM ""CTE_USER"" UNION SELECT ""Title"" AS ""results"" FROM ""CTE_RATING"""
397,"WITH ""query1"" AS (SELECT ""U"".""name"" FROM (SELECT ""user_id"",COUNT(1) AS ""movie_count"" FROM ""Movie_Rating"" GROUP BY ""user_id"") AS ""a"" LEFT JOIN ""Users"" AS ""U"" ON ""a"".""user_id""=""U"".""user_id"" ORDER BY ""a"".""movie_count"" DESC,""U"".""name"" LIMIT 1), ""query2"" AS (SELECT ""M"".""title"" FROM (SELECT ""movie_id"",AVG(""rating"") AS ""avg_rating"" FROM ""Movie_Rating"" WHERE TO_CHAR(""created_at"", '%y-%m')='20-02' GROUP BY ""movie_id"") AS ""b"" LEFT JOIN ""Movies"" AS ""M"" ON ""b"".""movie_id""=""M"".""movie_id"" ORDER BY ""b"".""avg_rating"" DESC,""M"".""title"" LIMIT 1) SELECT ""name"" AS ""results"" FROM ""query1"" UNION SELECT ""title"" AS ""results"" FROM ""query2"""
398,"WITH ""user_count"" AS (SELECT ""name"",COUNT(1) AS ""c"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1), ""user_results"" AS (SELECT ""name"" AS ""results"" FROM ""user_count"" WHERE ""c"" IN (SELECT MAX(""c"") FROM ""user_count"") ORDER BY 1 LIMIT 1), ""movie_count"" AS (SELECT ""title"",AVG(""rating"") AS ""a"" FROM ""Movie_Rating"" AS ""a"" LEFT JOIN ""Movies"" AS ""b"" ON ""a"".""movie_id""=""b"".""movie_id"" WHERE EXTRACT(YEAR FROM ""created_at"")=2020 AND EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY 1), ""movie_results"" AS (SELECT ""title"" AS ""results"" FROM ""movie_count"" WHERE ""a"" IN (SELECT MAX(""a"") FROM ""movie_count"") ORDER BY 1 LIMIT 1) SELECT ""results"" FROM ""user_results"" UNION SELECT ""results"" FROM ""movie_results"""
399,"(SELECT ""name"" AS ""results"" FROM ""movie_rating"" AS ""m"" JOIN ""users"" AS ""u"" ON ""m"".""user_id""=""u"".""user_id"" GROUP BY ""m"".""user_id"" ORDER BY COUNT(""rating"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" FROM ""movie_rating"" AS ""b"" JOIN ""movies"" AS ""a"" ON ""b"".""movie_id""=""a"".""movie_id"" WHERE EXTRACT(MONTH FROM ""created_at"")=2 GROUP BY ""b"".""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
400,"(SELECT ""name"" AS ""results"" FROM ""Users"" JOIN ""Movie_Rating"" USING (""user_id"") GROUP BY ""user_id"" ORDER BY COUNT(DISTINCT ""movie_id"") DESC,""name"" LIMIT 1) UNION ALL (SELECT ""title"" AS ""results"" FROM ""Movies"" JOIN ""Movie_Rating"" USING (""movie_id"") WHERE LEFT(""created_at"", 7)='2020-02' GROUP BY ""movie_id"" ORDER BY AVG(""rating"") DESC,""title"" LIMIT 1)"
401,"WITH ""a"" AS (SELECT ""user_id"",COUNT(""movie_id"") AS ""cnt"" FROM ""Movie_Rating"" GROUP BY ""user_id""), ""b"" AS (SELECT ""u"".""name"" AS ""results"" FROM ""a"" LEFT JOIN ""Users"" AS ""u"" ON (""a"".""user_id""=""u"".""user_id"") ORDER BY ""a"".""cnt"" DESC,""u"".""name"" LIMIT 1 OFFSET 0), ""c"" AS (SELECT ""mr"".""movie_id"",SUM(""rating"")/COUNT(""rating"") AS ""s"",""title"" FROM ""Movie_Rating"" AS ""mr"" LEFT JOIN ""Movies"" AS ""m"" ON (""mr"".""movie_id""=""m"".""movie_id"") WHERE EXTRACT(MONTH FROM ""created_at"")=2 AND EXTRACT(YEAR FROM ""created_at"")=2020 GROUP BY ""mr"".""movie_id"" ORDER BY ""s"" DESC,""m"".""title"" LIMIT 1 OFFSET 0) SELECT * FROM ""b"" UNION ALL SELECT ""title"" AS ""results"" FROM ""c"""
402,"(SELECT ""u"".""name"" AS ""results"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""movie_id"") AS ""cnt"" FROM ""movie_rating"" GROUP BY ""user_id"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"" ORDER BY ""a"".""cnt"" DESC,""u"".""name"" LIMIT 1) UNION (SELECT ""m"".""title"" AS ""results"" FROM ""movie_rating"" AS ""mr"" JOIN ""movies"" AS ""m"" ON ""mr"".""movie_id""=""m"".""movie_id"" WHERE ""created_at"">='2020-02-01' AND ""created_at""<='2020-02-29' GROUP BY ""m"".""title"" ORDER BY AVG(""mr"".""rating"") DESC,""m"".""title"" LIMIT 1)"
403,"(SELECT ""name"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Users"" USING (""user_id"") GROUP BY ""user_id"" HAVING COUNT(1)>=ALL (SELECT COUNT(1) FROM ""Movie_Rating"" GROUP BY ""user_id"") ORDER BY ""name"" LIMIT 1) UNION (SELECT ""title"" AS ""results"" FROM ""Movie_Rating"" JOIN ""Movies"" USING (""movie_id"") WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY ""movie_id"" HAVING AVG(""rating"")>=ALL (SELECT AVG(""rating"") FROM ""Movie_Rating"" WHERE SUBSTRING(""created_at"", 1, 7)='2020-02' GROUP BY ""movie_id"") ORDER BY ""title"" LIMIT 1)"
