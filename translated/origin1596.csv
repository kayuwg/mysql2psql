id,original query
1,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
2,"WITH ""customer_product_tbl"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""prod_cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""customer_max_product_tbl"" AS (SELECT ""customer_id"",MAX(""prod_cnt"") AS ""max_cnt"" FROM ""customer_product_tbl"" GROUP BY ""customer_id"") SELECT ""A"".""customer_id"",""A"".""product_id"",""B"".""product_name"" FROM (""customer_product_tbl"" AS ""A"" JOIN ""Products"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"") JOIN ""customer_max_product_tbl"" AS ""C"" ON ""A"".""customer_id""=""C"".""customer_id"" AND ""A"".""prod_cnt""=""C"".""max_cnt"""
3,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""products"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk_n"" FROM ""orders"" JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""temp"".""rnk_n""=1"
4,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""A"".""customer_id"",""A"".""product_id"",""C"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""orders_ct"" DESC) AS ""rank_N"" FROM ((SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""orders_ct"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""A"" LEFT JOIN ""Customers"" AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"") LEFT JOIN ""Products"" AS ""C"" ON ""A"".""product_id""=""C"".""product_id"") AS ""Base"" WHERE ""rank_N""=1"
5,"WITH ""CTE"" AS (SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"")), ""CTE1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""CTE1"" AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"") WHERE ""rk""=1"
6,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
7,"SELECT ""customer_id"",""Products"".""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_id"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
8,"SELECT ""customer_id"",""t"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) AS ""t"" JOIN ""products"" AS ""b"" ON ""t"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
9,"SELECT ""a"".""customer_id"",""a"".""product_id"",""products"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""product_rank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""products"" ON ""a"".""product_id""=""products"".""product_id"" WHERE ""a"".""product_rank""=1"
10,"WITH ""CTE1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cts"" FROM ""Orders"" AS ""o"" GROUP BY 1,2) SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""CTE1"" AS ""c"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ROW(""c"".""customer_id"",""c"".""cts"") IN (SELECT ""customer_id"",MAX(""cts"") FROM ""CTE1"" GROUP BY ""customer_id"")"
11,"SELECT ""A"".""customer_id"",""Products"".""product_id"",""Products"".""product_name"" FROM (SELECT ""A"".""customer_id"",""A"".""product_id"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""A"" JOIN (SELECT ""customer_id"",MAX(""num"") AS ""counts"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""B"" GROUP BY ""customer_id"") AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" WHERE ""num""=""counts"") AS ""A"" JOIN ""Products"" ON ""A"".""product_id""=""Products"".""product_id"""
12,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""qty"" DESC) AS ""rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""qty"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""total_qty"") AS ""ranked"" JOIN ""products"" USING (""product_id"") WHERE ""rank""=1"
13,"WITH ""order_counts"" AS (SELECT ""o"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) SELECT ""oc"".""customer_id"",""oc"".""product_id"",""oc"".""product_name"" FROM ""order_counts"" AS ""oc"" WHERE ""oc"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_counts"" AS ""x"" WHERE ""x"".""customer_id""=""oc"".""customer_id"")"
14,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY ""product_cnt"" DESC) AS ""rank_cnt"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""tmp"" WHERE ""rank_cnt""=1"
15,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
16,"SELECT ""A"".""customer_id"",""A"".""product_id"",""A"".""product_name"" FROM (SELECT ""customer_id"",""Orders"".""product_id"",""product_name"",COUNT(1) AS ""product_counts"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""customer_id"",""Orders"".""product_id"") AS ""A"" JOIN (SELECT ""A"".""customer_id"",MAX(""A"".""product_counts"") AS ""max_counts"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""product_counts"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""A"" GROUP BY ""A"".""customer_id"") AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" WHERE ""product_counts""=""max_counts"""
17,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".*,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""no_of_times_ordered"" DESC) AS ""fav_prod_rank"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""no_of_times_ordered"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" WHERE ""fav_prod_rank""=1"
18,"WITH ""O"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""r"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"" FROM ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""O"".""r""<2"
19,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""rnk"" FROM (SELECT ""o"".""customer_id"" AS ""customer_id"",""o"".""product_id"" AS ""product_id"",""product_name"",COUNT(1) AS ""freq"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""a"") AS ""b"" WHERE ""rnk""=1"
20,"SELECT ""o2"".""customer_id"",""o2"".""product_id"",""p"".""product_name"" FROM (SELECT ""o1"".*,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_order"" DESC) AS ""order_rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_order"" FROM ""Orders"" GROUP BY 1,2) AS ""o1"") AS ""o2"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o2"".""product_id"" WHERE ""o2"".""order_rk""=1"
21,"WITH ""frequency"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""freq"" FROM ""Orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""Products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""rk"" FROM ""frequency"") AS ""a"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""rk""=1"
22,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2) AS ""s"" WHERE ""rnk""=1"
23,"SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""product_name"" FROM (SELECT ""O"".""customer_id"",""P"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY COUNT(""P"".""product_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""O"".""customer_id"",""P"".""product_name"") AS ""a"" WHERE ""a"".""rk""=1"
24,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""e"".""product_id"",""e"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM ""grouped_cnt"" AS ""a"") AS ""b"" WHERE ""b"".""rn""=1) AS ""c"" LEFT JOIN ""products"" AS ""e"" ON ""e"".""product_id""=""c"".""product_id"""
25,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY 1,2 ORDER BY 1,3 DESC) AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"") AS ""t2"" WHERE ""rnk""=1"
26,"WITH ""CTE"" AS (SELECT ""O1"".*,""P1"".""product_name"",""price"" FROM ""Orders"" AS ""O1"" JOIN ""Products"" AS ""P1"" ON ""O1"".""product_id""=""P1"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""RNK"" FROM ""CTE"" GROUP BY 1,2) AS ""T1"" WHERE ""RNK""=1"
27,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""prdrank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""o"".""prdrank""=1"
28,"WITH ""cust_prod_count"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""pcount"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id""), ""cust_maxbuy"" AS (SELECT ""customer_id"",MAX(""pcount"") AS ""mcount"" FROM ""cust_prod_count"" GROUP BY ""customer_id"") SELECT ""p"".""customer_id"",""p"".""product_id"",""n"".""product_name"" FROM (SELECT ""c"".""customer_id"",""c"".""product_id"",""c"".""pcount"" FROM (""cust_prod_count"" AS ""c"") JOIN ""cust_maxbuy"" AS ""d"" WHERE ""c"".""customer_id""=""d"".""customer_id"" AND ""c"".""pcount""=""d"".""mcount"") AS ""p"", ""products"" AS ""n"" WHERE ""p"".""product_id""=""n"".""product_id"""
29,"WITH ""ranked"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (""ranked"" JOIN ""Products"" AS ""p"" ON ""ranked"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""ranked"".""customer_id""=""c"".""customer_id"" WHERE ""rk""=1"
30,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""tot"" FROM ""Orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name""), ""cte2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""tot"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte2"" WHERE ""rnk""=1"
31,"SELECT ""f"".""customer_id"",""f"".""product_id"",""p"".""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""f"" LEFT JOIN ""Products"" AS ""p"" ON ""f"".""product_id""=""p"".""product_id"" WHERE ""rk""=1"
32,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""number"" FROM ""orders"" GROUP BY 1,2), ""cte_1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""number"" DESC) AS ""rank"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte_1"" JOIN ""products"" USING (""product_id"") WHERE ""cte_1"".""rank""=1"
33,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"" WHERE ""rk""=1"
34,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
35,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""e"".""product_id"",""e"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM ""grouped_cnt"" AS ""a"") AS ""b"" WHERE ""b"".""rn""=1) AS ""c"" LEFT JOIN ""products"" AS ""e"" ON ""e"".""product_id""=""c"".""product_id"""
36,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY 1,2) AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_rank""=1"
37,"WITH ""temp1"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(1) AS ""num"" FROM ""Orders"" AS ""o"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id""), ""temp2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""num"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rnk"" FROM ""temp1"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""temp2"" WHERE ""rnk""=1"
38,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".""customer_id"",""b"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY COUNT(""b"".""product_id"") DESC) AS ""product_rank"" FROM (""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY 1,2,3) AS ""d"" WHERE ""product_rank""=1"
39,"WITH ""t"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_orders"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""num_orders"" DESC) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""t"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""rank_product"" FROM ""t"" LEFT JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"") AS ""t2"" WHERE ""t2"".""rank_product""=1"
40,"WITH ""O"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""C"".""customer_id"",""P"".""product_id"",""P"".""product_name"" FROM (""Customers"" AS ""C"" JOIN ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""O"".""rank""=1"
41,"WITH ""t1"" AS (SELECT ""customer_id"",""b"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""a"" LEFT JOIN ""products"" AS ""b"" USING (""product_id"") GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t1"" WHERE ""rnk""=1"
42,"SELECT ""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",""orders_count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""orders_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""orders_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""orders_count"") AS ""t"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""r""=1"
43,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""product_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" LEFT JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""a"".""product_rank""=1"
44,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""ranking""=1"
45,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""r"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""r""=1"
46,"SELECT ""M"".""customer_id"",""M"".""product_id"",""P"".""product_name"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""Rank_count"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""A"") AS ""M"" JOIN ""Products"" AS ""P"" ON ""M"".""product_id""=""P"".""product_id"" WHERE ""Rank_count""=1"
47,"WITH ""ds"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") SELECT ""ds"".""customer_id"" AS ""customer_id"",""p"".""product_id"" AS ""product_id"",""p"".""product_name"" AS ""product_name"" FROM ""ds"" JOIN ""products"" AS ""p"" WHERE ""ds"".""product_id""=""p"".""product_id"" AND ""ds"".""rnk""=1"
48,"WITH ""pc"" AS (SELECT ""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""freq"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2), ""pmax"" AS (SELECT ""customer_id"",MAX(""freq"") AS ""mfreq"" FROM ""pc"" GROUP BY ""customer_id"") SELECT ""pc"".""customer_id"",""product_id"",""product_name"" FROM ""pc"" JOIN ""pmax"" ON ""pc"".""customer_id""=""pmax"".""customer_id"" AND ""pc"".""freq""=""pmax"".""mfreq"""
49,"WITH ""x"" AS (SELECT ""c"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""p"".""product_id"") AS ""cnt"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3), ""y"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""x"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""y"" WHERE ""rnk""=1"
50,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
51,"SELECT ""Customers"".""customer_id"",""Orders_1"".""product_id"",""Products"".""product_name"" FROM ((""Customers"") JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""Orders_1"") JOIN ""Products"" WHERE ""Orders_1"".""rank""=1 AND ""Customers"".""customer_id""=""Orders_1"".""customer_id"" AND ""Orders_1"".""product_id""=""Products"".""product_id"""
52,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""sub"".""customer_id"",""sub"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""sub"".""customer_id"" ORDER BY ""sub"".""freq"" DESC) AS ""most_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""sub"" LEFT JOIN ""Products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"") AS ""final_table"" WHERE ""most_rank""=1"
53,"WITH ""t1"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t1"" WHERE ""rnk""=1"
54,"SELECT ""c"".""customer_id"",""c"".""product_id"",""c"".""product_name"" FROM (SELECT ""b"".""customer_id"",""b"".""product_id"",""b"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""b"".""customer_id"" ORDER BY ""b"".""freq"" DESC) AS ""my_rank"" FROM (SELECT ""a"".""customer_id"",""Products"".""product_name"",""Customers"".""name"",""freq"",""a"".""product_id"" FROM ((SELECT ""customer_id"",""product_id"",COUNT(1) AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Customers"" ON ""a"".""customer_id""=""Customers"".""customer_id"") JOIN ""Products"" ON ""a"".""product_id""=""Products"".""product_id"") AS ""b"") AS ""c"" WHERE ""c"".""my_rank""=1"
55,"WITH ""customer_product_count"" AS (SELECT DISTINCT ""customer_id"",""product_id"",COUNT(""product_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""prod_count"" FROM ""Orders""), ""prod_rank"" AS (SELECT ""customer_id"",""product_id"",""prod_count"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""prod_count"" DESC) AS ""tot_rank"" FROM ""customer_product_count"") SELECT ""sub"".""customer_id"",""sub"".""product_id"",""t"".""product_name"" FROM ""prod_rank"" AS ""sub"" LEFT JOIN ""Products"" AS ""t"" ON ""t"".""product_id""=""sub"".""product_id"" WHERE ""sub"".""tot_rank""=1"
56,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",""cnt_product"",MAX(""cnt_product"") OVER (PARTITION BY ""customer_id"") AS ""max_product"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt_product"" FROM ""Orders"" GROUP BY 1,2) AS ""a"") SELECT ""c"".""customer_id"",""c"".""product_id"",""product_name"" FROM ""CTE"" AS ""c"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""cnt_product""=""max_product"""
57,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""rnk""=1"
58,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") AS ""a"" WHERE ""rnk""=1"
59,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""c"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""t1"".""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""rk"" FROM ""t1"" JOIN ""Products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"") AS ""T"" WHERE ""rk""=1"
60,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ""cte"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""cte"".""rnk""=1"
61,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""prd_count"" DESC) AS ""final_rank"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(""a"".""ord_rank"") AS ""prd_count"" FROM (SELECT ""cust"".""customer_id"",""pro"".""product_id"",""pro"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""ord"".""customer_id"", ""ord"".""product_id"") AS ""ord_rank"" FROM (""Customers"" AS ""cust"" JOIN ""Orders"" AS ""ord"" ON ""cust"".""customer_id""=""ord"".""customer_id"") JOIN ""Products"" AS ""pro"" ON ""pro"".""product_id""=""ord"".""product_id"") AS ""a"" GROUP BY 1,2,3) AS ""b"") AS ""c"" WHERE ""c"".""final_rank""=1"
62,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
63,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""rk""=1"
64,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""ct"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranking"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id"") AS ""a"" LEFT JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""ranking""=1 ORDER BY ""a"".""customer_id"",""a"".""product_id"""
65,"WITH ""T1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""frequent"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranks"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1), ""T2"" AS (SELECT ""customer_id"",""product_id"" FROM ""T1"" WHERE ""ranks""=1) SELECT ""T2"".*,""p"".""product_name"" FROM ""T2"" JOIN ""Products"" AS ""p"" ON ""T2"".""product_id""=""p"".""product_id"""
66,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
67,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""b"" WHERE ""ranking""=1"
68,"WITH ""temp"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""temp"" WHERE ""rnk""=1"
69,"WITH ""joined_source"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""num_orders"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id""), ""ranked_table"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""sales_rank"" FROM ""joined_source"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""ranked_table"" WHERE ""sales_rank""=1"
70,"SELECT ""customer_id"",""b"".""product_id"",""products"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cot"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cot"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" JOIN ""products"" ON ""b"".""product_id""=""products"".""product_id"" WHERE ""rnk""=1"
71,"SELECT ""customer_id"",""tmp1"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num"" FROM ""Orders"" GROUP BY 1,2) AS ""tmp"" WHERE ""num""=1) AS ""tmp1"" LEFT JOIN ""Products"" AS ""p"" ON ""tmp1"".""product_id""=""p"".""product_id"""
72,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_name"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""order_count"" IN (SELECT MAX(""order_count"") FROM ""cte"" AS ""x"" WHERE ""x"".""customer_id""=""cte"".""customer_id"")"
73,"SELECT ""customer_id"",""b"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rk"" FROM ""orders"" GROUP BY ""product_id"",""customer_id"") AS ""b"" LEFT JOIN ""products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" WHERE ""b"".""rk""=1"
74,"SELECT ""tmp2"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""tmp"".*,MAX(""tmp"".""count"") OVER (PARTITION BY ""tmp"".""customer_id"") AS ""max_count"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"") AS ""tmp2"" JOIN ""Products"" AS ""p"" ON ""tmp2"".""product_id""=""p"".""product_id"" WHERE ""tmp2"".""count""=""tmp2"".""max_count"""
75,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""CNT"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""CNT"" DESC), ""cte1"" AS (SELECT ""customer_id"",""product_id"",""CNT"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""CNT"" DESC) AS ""ranking"" FROM ""cte"") SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM ""cte1"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""ranking""=1"
76,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",""product_name"",COUNT(""product_name"") AS ""b"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""product_name"") DESC) AS ""rk"" FROM (""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"",""product_name"" HAVING COUNT(""product_name"")>0) AS ""a"" WHERE ""rk""=1"
77,"SELECT ""sub2"".""customer_id"",""sub2"".""product_id"",""sub2"".""product_name"" FROM (SELECT ""sub"".""customer_id"",""sub"".""product_id"",""sub"".""product_name"",""sub"".""frequence"",RANK() OVER (PARTITION BY ""sub"".""customer_id"" ORDER BY ""sub"".""frequence"" DESC) AS ""ranked"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""frequence"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3 ORDER BY 1) AS ""sub"") AS ""sub2"" WHERE ""sub2"".""ranked""=1"
78,"SELECT ""b"".""customer_id"",""b"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""a"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cntt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cntt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"") AS ""b"" WHERE ""rnk""=1"
79,"SELECT ""TBL"".""customer_id"",""TBL"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""summ"") AS ""TBL"" LEFT JOIN ""Products"" AS ""P"" ON ""TBL"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
80,"WITH ""order_count"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""order_count"" AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""order_rank""=1"
81,"SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""a"".""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""customer_id"",""a"".""product_id"") AS ""a"" WHERE ""num""=1"
82,"WITH ""O"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""c"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""r"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"" FROM ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""O"".""r""<2"
83,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rn"" FROM ""cte"") SELECT ""a"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""cte2"" AS ""a"" JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""a"".""rn""=1"
84,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""CNT"" DESC) AS ""RNK"" FROM (SELECT ""b"".""customer_id"",""c"".""product_id"",""product_name"",COUNT(1) AS ""CNT"" FROM (""ORDERS"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""products"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""A"") AS ""b"" WHERE ""RNK""=1"
85,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rn"" FROM ""orders"" GROUP BY 1,2) AS ""t"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""t"".""rn""=1"
86,"SELECT ""t2"".""customer_id"" AS ""customer_id"",""t2"".""product_id"" AS ""product_id"",""p"".""product_name"" AS ""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"") AS ""t2"" LEFT JOIN ""products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"" WHERE ""t2"".""ranking""=1"
87,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""c"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rn"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""product_name"" FROM ""cte"" JOIN ""Products"" ON ""Products"".""product_id""=""cte"".""product_id"" WHERE ""rn""=1"
88,"WITH ""CTE"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""order_count"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2 ORDER BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""CTE"" WHERE ROW(""customer_id"",""order_count"") IN (SELECT ""customer_id"",MAX(""order_count"") AS ""order_count"" FROM ""cte"" GROUP BY ""customer_id"")"
89,"WITH ""ctes"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""t"".""product_id"",""product_name"" FROM ((SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""ctes"") AS ""t"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""t"".""rnk""=1"
90,"SELECT ""ranking_tab"".""customer_id"",""ranking_tab"".""product_id"",""Products"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",""num_bought"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_bought"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""num_bought"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"") AS ""ranking_tab"" JOIN ""Products"" ON ""ranking_tab"".""product_id""=""Products"".""product_id"" WHERE ""ranking""=1"
91,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""prod_freq"" FROM ""Orders"" GROUP BY 1,2) SELECT ""t1"".""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t1"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t1"".""product_id"" WHERE ""t1"".""prod_freq""=(SELECT MAX(""t2"".""prod_freq"") FROM ""temp"" AS ""t2"" WHERE ""t1"".""customer_id""=""t2"".""customer_id"")"
92,"SELECT ""t3"".""customer_id"",""t3"".""product_id"",""p"".""product_name"" FROM (SELECT ""t2"".""customer_id"",""t2"".""product_id"" FROM (SELECT ""t"".""customer_id"",""t"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""t"".""customer_id"" ORDER BY ""t"".""purchase"" DESC) AS ""rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""purchase"" FROM ""Orders"" GROUP BY 1,2 ORDER BY COUNT(1) DESC) AS ""t"") AS ""t2"" WHERE ""rank""=1) AS ""t3"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t3"".""product_id"""
93,"WITH ""b"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY 1,2) SELECT ""b"".""customer_id"",""b"".""product_id"",""a"".""product_name"" FROM ""Products"" AS ""a"" JOIN ""b"" USING (""product_id"") WHERE ""rnk""=1"
94,"SELECT ""R"".""customer_id"",""R"".""product_id"",""R"".""product_name"" FROM (SELECT ""O"".""customer_id"",""P"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranks"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY 1,2) AS ""R"" WHERE ""R"".""ranks""=1"
95,"WITH ""resultcte"" AS (SELECT ""customer_id"",""product_id"",""cnt"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",COUNT(1) DESC) AS ""sub"") SELECT ""r"".""customer_id"",""r"".""product_id"",""p"".""product_name"" FROM ""resultcte"" AS ""r"" JOIN ""products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""rnk""=1"
96,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"",""p"".""product_id"") AS ""a"" WHERE ""rnk""=1"
97,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""p"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""p"".""product_id"",""product_name"") AS ""a"" WHERE ""rnk""=1"
98,"SELECT ""b"".""customer_id"",""b"".""product_id"",""p"".""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""req"" DESC) AS ""d_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""req"" FROM ""orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" LEFT JOIN ""Products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" WHERE ""b"".""d_rank""=1"
99,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rk"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(DISTINCT ""o"".""order_id"") AS ""cnt"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""t1"") AS ""t2"" WHERE ""rk""=1"
100,"SELECT ""customer_id"",""temp"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""temp"", ""Products"" AS ""p"" WHERE ""p"".""product_id""=""temp"".""product_id"" AND ROW(""customer_id"",""ct"") IN (SELECT ""customer_id"",MAX(""ct"") AS ""max_ct"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""cte"" GROUP BY ""customer_id"")"
101,"WITH ""prnk"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""p"".""customer_id"",""p"".""product_id"",""Pr"".""product_name"" FROM ""prnk"" AS ""p"" JOIN ""Products"" AS ""pr"" ON ""p"".""product_id""=""Pr"".""product_id"" WHERE ""p"".""rnk""=1"
102,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""Orders"".""customer_id"",""Products"".""product_id"",""Products"".""product_name"",RANK() OVER (PARTITION BY ""Orders"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""count_rank"" FROM ""Orders"" LEFT JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""Orders"".""customer_id"",""Products"".""product_id"",""Products"".""product_name"") AS ""product_ranks"" WHERE ""product_ranks"".""count_rank""=1"
103,"WITH ""temp1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""temp2"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""max_c"" FROM ""temp1"" GROUP BY ""customer_id"") SELECT ""t2"".""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM (""temp2"" AS ""t2"" LEFT JOIN ""temp1"" AS ""t1"" ON ""t2"".""customer_id""=""t1"".""customer_id"" AND ""t2"".""max_c""=""t1"".""cnt"") LEFT JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"""
104,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rk""=1"
105,"WITH ""r"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""product_num"" FROM ""Orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_num"" DESC) AS ""rnk"" FROM ""r"") AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""a"".""rnk""=1 ORDER BY 1"
106,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""rnk"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""freq"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""a"") AS ""b"" WHERE ""rnk""=1"
107,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (""cte"") JOIN ""products"" AS ""p"" WHERE ""cte"".""product_id""=""p"".""product_id"" AND ""rnk""=1 ORDER BY ""customer_id"",""p"".""product_id"""
108,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""total"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""tmp"" WHERE ""rnk""=1"
109,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",""c"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""rnk"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""c"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""x"") AS ""y"" WHERE ""rnk""=1"
110,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(""o"".""order_id"") AS ""ords"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"",""p"".""product_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") AS ""a"" WHERE ""rk""=1"
111,"WITH ""summary"" AS (SELECT ""a"".""customer_id"",""b"".""product_id"",""c"".""product_name"",COUNT(1) AS ""ct"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY ""a"".""customer_id"",""b"".""product_id"",""c"".""product_name""), ""max_counts"" AS (SELECT ""customer_id"",MAX(""ct"") AS ""max_ct"" FROM ""summary"" GROUP BY ""customer_id"") SELECT ""b"".""customer_id"",""b"".""product_id"",""b"".""product_name"" FROM ""max_counts"" AS ""a"" JOIN ""summary"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""max_ct""=""b"".""ct"""
112,"SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""p"".""product_id"",""product_name"",COUNT(""o"".""product_id"") OVER (PARTITION BY ""customer_id"", ""o"".""product_id"") AS ""freq"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""tmp"") AS ""tmp2"" WHERE ""rnk""=1"
113,"WITH ""temp"" AS (SELECT ""product_id"",""customer_id"",COUNT(""customer_id"") AS ""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""customer_id"") DESC) AS ""rnum"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""temp"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN ""temp"" ON ""p"".""product_id""=""temp"".""product_id"" WHERE ""rnum""=1 GROUP BY 1,2 ORDER BY 1"
114,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""O"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
115,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",""order_num"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_num"" DESC) AS ""ranking"" FROM (SELECT DISTINCT ""c"".""customer_id"",""p"".""product_id"",""product_name"",COUNT(""o"".""order_id"") OVER (PARTITION BY ""c"".""customer_id"", ""p"".""product_id"") AS ""order_num"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""a"") AS ""b"" WHERE ""ranking""=1"
116,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
117,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""P1"".""product_id"",""P1"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""P1"".""product_id"") DESC) AS ""RNK"" FROM ""Orders"" AS ""O1"" JOIN ""Products"" AS ""P1"" ON ""O1"".""product_id""=""P1"".""product_id"" GROUP BY 1,2) AS ""T1"" WHERE ""RNK""=1"
118,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ""cte"" LEFT JOIN ""products"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
119,"WITH ""OrderFreq"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""Rk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""OdF"".""customer_id"",""OdF"".""product_id"",""P"".""product_name"" FROM ""OrderFreq"" AS ""OdF"" JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""OdF"".""product_id"" WHERE ""Rk""=1 ORDER BY 1"
120,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",MAX(""freq"") AS ""highest_freq"" FROM ""cte1"" GROUP BY 1) SELECT ""c1"".""customer_id"",""c1"".""product_id"",""p"".""product_name"" FROM (""cte1"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""customer_id""=""c2"".""customer_id"" AND ""c1"".""freq""=""c2"".""highest_freq"") JOIN ""Products"" AS ""p"" ON ""c1"".""product_id""=""p"".""product_id"""
121,"SELECT ""tmp"".""customer_id"",""tmp"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""tmp"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""tmp"".""product_id"" WHERE ""rnk""=1"
122,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_order"" FROM ""Orders"" GROUP BY 1,2), ""temp2"" AS (SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"",""num_order"",MAX(""num_order"") OVER (PARTITION BY ""c"".""customer_id"") AS ""max_num_order"" FROM ""temp"" AS ""c"" LEFT JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""temp2"" WHERE ""num_order""=""max_num_order"""
123,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""temp"" AS ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""cnt"">=(SELECT MAX(""cnt"") FROM ""temp"" AS ""t2"" WHERE ""t1"".""customer_id""=""t2"".""customer_id"")"
124,"WITH ""count_products"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cp"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""x"".""customer_id"",""x"".""product_id"",""x"".""product_name"" FROM (SELECT ""c"".""customer_id"",""cp"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""cp"".""customer_id"" ORDER BY ""cp"".""cp"" DESC) AS ""rank_count"" FROM (""count_products"" AS ""cp"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""cp"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""cp"".""product_id"") AS ""x"" WHERE ""x"".""rank_count""=1"
125,"SELECT ""tab"".""customer_id"",""tab"".""product_id"",""p"".""product_name"" FROM (SELECT ""t"".""customer_id"",""t"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""t"".""customer_id"" ORDER BY ""t"".""Freq"" DESC) AS ""Rank"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",COUNT(1) AS ""Freq"" FROM ""Orders"" AS ""O"" GROUP BY ""O"".""customer_id"",""O"".""product_id"") AS ""t"") AS ""tab"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""tab"".""product_id"" WHERE ""tab"".""Rank""=1"
126,"WITH ""temp"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2) SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" LEFT JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rk""=1"
127,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""A"" WHERE ""rnk""=1"
128,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ranking"" FROM ""orders"" GROUP BY 1,2) SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" LEFT JOIN ""Products"" USING (""product_id"") WHERE ""ranking""=1"
129,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""demo"" AS (SELECT ""customer_id"",""product_id"",""count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""d"".""customer_id"",""d"".""product_id"",""p"".""product_name"" FROM ""demo"" AS ""d"" JOIN ""products"" AS ""p"" ON ""d"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
130,"WITH ""T"" AS (SELECT ""O"".""customer_id"",""O"".""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" USING (""customer_id"") GROUP BY ""O"".""customer_id"",""O"".""product_id"") SELECT ""T"".""customer_id"",""T"".""product_id"",""P"".""product_name"" FROM ""T"" JOIN ""Products"" AS ""P"" USING (""product_id"") WHERE ROW(""T"".""customer_id"",""T"".""cnt"") IN (SELECT ""T1"".""customer_id"",MAX(""T1"".""cnt"") FROM ""T"" AS ""T1"" GROUP BY ""T1"".""customer_id"")"
131,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""times"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""times"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""purchase_records"") AS ""t"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""t"".""ranking""=1"
132,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""orders"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" JOIN ""products"" USING (""product_id"") GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1 ORDER BY 1,2"
133,"WITH ""product_ranks"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ranking"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""pr"".""customer_id"",""pr"".""product_id"",""p"".""product_name"" FROM ""product_ranks"" AS ""pr"" JOIN ""Products"" AS ""p"" ON ""pr"".""product_id""=""p"".""product_id"" WHERE ""pr"".""ranking""=1"
134,"WITH ""sub"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""sales_rank"" FROM ""orders"" GROUP BY 1,2) SELECT ""sub"".""customer_id"",""sub"".""product_id"",""p"".""product_name"" FROM ""sub"" JOIN ""products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"" WHERE ""sub"".""sales_rank""=1"
135,"WITH ""f"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""freq"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2), ""most"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_ID"" ORDER BY ""freq"" DESC) AS ""rnk"" FROM ""f"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""most"" WHERE ""rnk""=1"
136,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""frequency"" FROM ""Orders"" AS ""o"" GROUP BY 1,2), ""t2"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""frequency"" DESC) AS ""rnk"" FROM ""t1"") SELECT ""t2"".""customer_id"",""t2"".""product_id"",""p"".""product_name"" FROM ""t2"" LEFT JOIN ""Products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
137,"WITH ""a1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""a2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""a1""), ""a3"" AS (SELECT ""a2"".""customer_id"",""a2"".""product_id"",""c"".""product_name"" FROM ""a2"" LEFT JOIN ""products"" AS ""c"" ON ""a2"".""product_id""=""c"".""product_id"" WHERE ""rnk""=1) SELECT * FROM ""a3"""
138,"SELECT ""c"".""customer_id"",""temp"".""product_id"",""temp"".""product_name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""temp"" ON ""c"".""customer_id""=""temp"".""customer_id"" WHERE ""temp"".""rnk""=1"
139,"SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,MAX(""c"") OVER (PARTITION BY ""customer_id"") AS ""max_c"" FROM (SELECT ""C"".""customer_id"",""P"".""product_id"",""P"".""product_name"",COUNT(""O"".""order_id"") OVER (PARTITION BY ""C"".""customer_id"", ""P"".""product_id"") AS ""c"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"") AS ""TMP1"") AS ""TMP2"" WHERE ""max_c""=""c"""
140,"SELECT ""RNK"".""customer_id"",""RNK"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1) AS ""RNK"" JOIN ""Products"" AS ""p"" ON ""RNK"".""product_id""=""p"".""product_id"" WHERE ""rk""=1 ORDER BY 1"
141,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
142,"WITH ""ctes"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""t"".""product_id"",""product_name"" FROM ((SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""ctes"") AS ""t"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""t"".""rnk""=1"
143,"WITH ""frequency"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""total_times"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""temp_table"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""o"".""total_times"" DESC) AS ""d_rank"",""p"".""product_name"" FROM ""frequency"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""temp_table"" WHERE ""d_rank""=1"
144,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""cntrank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""cntrank""=1"
145,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rk""=1"
146,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count"" DESC) AS ""rk"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(""o"".""product_id"") AS ""count"",""p"".""product_name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"" ORDER BY ""o"".""customer_id"") AS ""cte1"" ORDER BY ""customer_id"") AS ""cte2"" WHERE ""rk""=1"
147,"SELECT ""customer_id"",""sub2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""sub"") AS ""sub2"" LEFT JOIN ""Products"" AS ""p"" ON ""sub2"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
148,"SELECT ""TBL"".""customer_id"",""TBL"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY 1,2) AS ""TBL"" LEFT JOIN ""Products"" AS ""P"" ON ""TBL"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
149,"WITH ""max_prod"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(""o"".""product_id"") AS ""prod_cnt"",""p"".""product_name"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" ORDER BY ""o"".""customer_id""), ""s1"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""prod_cnt"" DESC) AS ""rnk"" FROM ""max_prod"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""s1"" WHERE ""rnk""=1"
150,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,MAX(""cnt"") OVER (PARTITION BY ""customer_id"") AS ""mx"" FROM (SELECT ""a"".""customer_id"",""b"".""name"",""a"".""product_id"",""c"".""product_name"",COUNT(""a"".""product_id"") AS ""cnt"" FROM (""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""products"" AS ""c"" ON ""c"".""product_id""=""a"".""product_id"" GROUP BY 1,2,3,4) AS ""temp"") AS ""x"" WHERE ""mx""=""cnt"""
151,"WITH ""orders_cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""o1"".""customer_id"",""o1"".""product_id"",""p"".""product_name"" FROM (""orders_cte"" AS ""o1"") JOIN ""products"" AS ""p"" WHERE ""o1"".""product_id""=""p"".""product_id"" AND ""o1"".""cnt"" IN (SELECT MAX(""cnt"") FROM ""orders_cte"" AS ""o2"" WHERE ""o1"".""customer_id""=""o2"".""customer_id"")"
152,"WITH ""c"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""pc"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""cr"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""c"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""cr""=1 ORDER BY 1,2"
153,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
154,"WITH ""CTE"" AS (SELECT ""O"".""customer_id"",""P"".""product_id"",""P"".""product_name"",COUNT(1) AS ""num_bought"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""O"".""customer_id"",""P"".""product_id""), ""CTE_2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_bought"" DESC) AS ""ranked_products"" FROM ""CTE"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""CTE_2"" WHERE ""ranked_products""=1"
155,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""e"".""product_id"",""e"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM ""grouped_cnt"" AS ""a"") AS ""b"" WHERE ""b"".""rn""=1) AS ""c"" LEFT JOIN ""products"" AS ""e"" ON ""e"".""product_id""=""c"".""product_id"""
156,"SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t2"".""product_name"" FROM (WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""order_sum"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"" FROM ""temp"" WHERE ROW(""temp"".""customer_id"",""temp"".""order_sum"") IN (SELECT ""customer_id"",MAX(""order_sum"") FROM ""temp"" GROUP BY ""customer_id"")) AS ""t1"" JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"""
157,"SELECT ""customer_id"",""tmp"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2) AS ""tmp"" JOIN ""products"" AS ""p"" ON ""tmp"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
158,"WITH ""tmp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""tmp2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""rank_no"" FROM ""tmp"") SELECT ""c"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (""Customers"" AS ""c"" JOIN ""tmp2"" AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rank_no""=1"
159,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (""customers"" AS ""c"" LEFT JOIN ""cte"" USING (""customer_id"")) LEFT JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""rk""=1"
160,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""n"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""t"".""n""=1 ORDER BY ""customer_id"",""product_id"""
161,"WITH ""a"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""c"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""r"" FROM ""a"") AS ""b"" JOIN ""Products"" ON ""b"".""product_id""=""Products"".""product_id"" WHERE ""b"".""r""=1"
162,"WITH ""t"" AS (SELECT COUNT(1) AS ""cnt"",""customer_id"",""product_id"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE (SELECT COUNT(DISTINCT ""t1"".""cnt"") FROM ""t"" AS ""t1"" WHERE ""t1"".""customer_id""=""t"".""customer_id"" AND ""t1"".""cnt"">=""t"".""cnt"")=1"
163,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""products"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank_count"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""a"".""rank_count""=1"
164,"SELECT ""temp2"".""customer_id"",""temp2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""sum_prod"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""sum_prod"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"") AS ""temp2"" LEFT JOIN ""Products"" ON ""temp2"".""product_id""=""Products"".""product_id"" WHERE ""rk""=1"
165,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
166,"WITH ""rnk"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""r"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",(SELECT ""product_name"" FROM ""products"" AS ""p"" WHERE ""p"".""product_id""=""rnk"".""product_id"") AS ""product_name"" FROM ""rnk"" WHERE ""r""=1"
167,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
168,"WITH ""cnt_prod"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""Products"" AS ""p"" JOIN ""cnt_prod"" AS ""a"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""cnt_prod"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
169,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY ""o"".""customer_id"",""o"".""product_id"" HAVING ROW(""o"".""customer_id"",COUNT(1)) IN (SELECT ""customer_id"",MAX(""freq"") FROM (SELECT ""customer_id"",COUNT(1) AS ""freq"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
170,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",(RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC)) AS ""rnk"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",""p"".""product_id"") AS ""ranked_products"" WHERE ""rnk""=1"
171,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""cnt_rnk"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",COUNT(1) AS ""cnt"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON (""o"".""product_id""=""p"".""product_id"") GROUP BY 1,2,3) AS ""foo"") AS ""hoo"" WHERE ""cnt_rnk""=1"
172,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""num"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rn"" FROM ""cte"") AS ""t"" WHERE ""rn""=1"
173,"WITH ""a"" AS (SELECT *,COUNT(""product_name"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""c"" FROM ""Orders"" LEFT JOIN ""Products"" USING (""product_id"")) SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""r"" FROM ""a"") AS ""t1"" WHERE ""r""=1"
174,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""nb"" FROM ""orders"" GROUP BY 1,2 ORDER BY 1), ""cte2"" AS (SELECT *,MAX(""nb"") OVER (PARTITION BY ""customer_id"") AS ""max"" FROM ""cte1"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""cte2"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""nb""=""a"".""max"""
175,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""prank"" FROM ""Orders"" AS ""o"" GROUP BY 1,2) AS ""tbl"" JOIN ""Products"" AS ""p"" ON ""tbl"".""product_id""=""p"".""product_id"" WHERE ""prank""=1"
176,"SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num"" FROM ""Orders"" GROUP BY 1,2) AS ""a"") AS ""b"" JOIN ""Products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" WHERE ""rk""=1"
177,"WITH ""order_counts"" AS (SELECT ""o"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) SELECT ""oc"".""customer_id"",""oc"".""product_id"",""oc"".""product_name"" FROM ""order_counts"" AS ""oc"" WHERE ""oc"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_counts"" AS ""x"" WHERE ""x"".""customer_id""=""oc"".""customer_id"")"
178,"SELECT ""O"".""customer_id"" AS ""customer_id"",""O"".""product_id"" AS ""product_id"",""P"".""product_name"" AS ""product_name"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY 1,2 HAVING ROW(""O"".""customer_id"",COUNT(""O"".""product_id"")) IN (SELECT ""customer_id"",MAX(""counter"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""counter"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" GROUP BY ""customer_id"")"
179,"SELECT ""customer_id"",""b"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_products_sold"" DESC) AS ""rank_filter"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_products_sold"" FROM ""Orders"" AS ""o"" GROUP BY 1,2) AS ""a"") AS ""b"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""rank_filter""=1 ORDER BY ""customer_id"""
180,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""rank_p""=1"
181,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""total"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total"" DESC) AS ""rnk"" FROM ""cte1"") SELECT ""a"".""customer_id"",""b"".""product_id"",""b"".""product_name"" FROM ""cte2"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""rnk""=1"
182,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""c"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""x"" WHERE ""rnk""=1"
183,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" AS ""o"" GROUP BY 1,2) SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""rk""=1 ORDER BY 1,2"
184,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""count_product"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""t2"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count_product"" DESC) AS ""rank_product"" FROM ""t1"") SELECT ""t2"".""customer_id"",""t2"".""product_id"",""Products"".""product_name"" FROM ""t2"" LEFT JOIN ""Products"" ON ""t2"".""product_id""=""Products"".""product_id"" WHERE ""t2"".""rank_product""=1"
185,"SELECT ""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""r_rank"" FROM ""orders"" GROUP BY 1,2) AS ""t"" JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""r_rank""=1"
186,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"" AS ""customer_id"",""p"".""product_id"" AS ""product_id"",""p"".""product_name"" AS ""product_name"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_ID"") DESC) AS ""order_rank"" FROM (""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"",""p"".""product_id"") AS ""t"" WHERE ""order_rank""=1"
187,"SELECT ""customer_id"",""T"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""RK"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""T"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""RK""=1"
188,"SELECT ""T3"".""customer_id"",""T3"".""product_id"",""p"".""product_name"" FROM ((SELECT ""c"".""customer_id"",""o"".""product_id"",COUNT(""o"".""product_id"") AS ""proCount"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""T3"", ""Products"" AS ""p"") JOIN (SELECT ""T1"".""customer_id"",MAX(""T1"".""proCount"") AS ""proMax"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",COUNT(""o"".""product_id"") AS ""proCount"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""T1"" GROUP BY ""T1"".""customer_id"") AS ""T2"" WHERE ""T2"".""customer_id""=""T3"".""customer_id"" AND ""T2"".""proMAX""=""T3"".""proCount"" AND ""p"".""product_id""=""T3"".""product_id"""
189,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""product_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""times_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""times_rank""=1 ORDER BY ""o"".""customer_id"""
190,"WITH ""CTE1"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"", ""product_id"" ORDER BY ""order_date"") AS ""cnt"" FROM ""orders""), ""CTE2"" AS (SELECT ""customer_id"",""product_id"",MAX(""cnt"") AS ""max_cnt"" FROM ""CTE1"" GROUP BY ""customer_id"",""product_id""), ""CTE3"" AS (SELECT ""customer_id"",""product_id"",""max_cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""max_cnt"" DESC) AS ""cnt_final"" FROM ""CTE2"") SELECT ""customer_id"",""c"".""product_id"",""product_name"" FROM ""CTE3"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""cnt_final""=1"
191,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY 1) SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""t1"") AS ""t2"" LEFT JOIN ""products"" AS ""p"" ON (""p"".""product_id""=""t2"".""product_id"") WHERE ""t2"".""rnk""=1"
192,"SELECT ""b"".""customer_id"",""b"".""product_id"",""p"".""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""howmany"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""howmany"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""rk""=1"
193,"WITH ""tbl1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""tbl2"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""mcnt"" FROM ""tbl1"" GROUP BY ""customer_id""), ""tbl3"" AS (SELECT ""customer_id"",""product_id"",""cnt"" FROM ""tbl1"" WHERE ROW(""customer_id"",""cnt"") IN (SELECT ""tbl2"".""customer_id"",""tbl2"".""mcnt"" FROM ""tbl2"")) SELECT ""o"".""customer_id"",""o"".""product_id"",""product_name"" FROM ""tbl3"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"""
194,"WITH ""a"" AS (SELECT * FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""total_order"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rn_"" FROM ""orders"" GROUP BY 1,2 ORDER BY 1,""total_order"" DESC) AS ""a"" WHERE ""rn_""=1) SELECT ""a"".""customer_id"",""a"".""product_id"",""c"".""product_name"" FROM ""a"" LEFT JOIN ""products"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"""
195,"WITH ""order_cnt"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM (""order_cnt"" AS ""c"") JOIN ""products"" AS ""p"" WHERE ""c"".""product_id""=""p"".""product_id"" AND ""c"".""rnk""=1"
196,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
197,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""rnk""=1"
198,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM (""Customers"" LEFT JOIN ""Orders"" USING (""customer_id"")) JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""rnk""=1"
199,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1"
200,"WITH ""t1"" AS (SELECT ""customer_id"",""orders"".""product_id"",""product_name"",COUNT(""orders"".""product_id""),RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""orders"".""product_id"") DESC) AS ""product_rank"" FROM ""orders"" LEFT JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""product_id"",""customer_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t1"" WHERE ""product_rank""=1"
201,"WITH ""cte"" AS (SELECT ""Customers"".""customer_id"",""Products"".""product_id"",""Products"".""product_name"",RANK() OVER (PARTITION BY ""Customers"".""customer_id"" ORDER BY COUNT(""PRoducts"".""product_id"") DESC) AS ""rnk"" FROM (""Customers"" JOIN ""Orders"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"") JOIN ""products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""Customers"".""customer_id"",""Products"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
202,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""c"".""product_id"",""product_name"" FROM ""cte"" AS ""c"" JOIN ""Products"" AS ""p"" ON ""rnk""=1 AND ""c"".""product_id""=""p"".""product_id"""
203,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(DISTINCT ""o"".""order_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""tmp"" WHERE ""rk""=1"
204,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""ct"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""temp"".""product_id"",""product_name"" FROM (""products"" AS ""p"") JOIN (SELECT ""customer_id"",""product_id"",""ct"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"" FROM ""cte"") AS ""temp"" WHERE ""temp"".""product_id""=""p"".""product_id"" AND ""rk""=1"
205,"SELECT ""O"".""CUSTOMER_ID"",""P"".""PRODUCT_ID"",""P"".""PRODUCT_NAME"" FROM (SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",DENSE_RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY COUNT(""PRODUCT_ID"") DESC) AS ""ORDER_RANK"" FROM ""ORDERS"" GROUP BY ""CUSTOMER_ID"",""PRODUCT_ID"") AS ""O"" JOIN ""PRODUCTS"" AS ""P"" ON ""P"".""PRODUCT_ID""=""O"".""PRODUCT_ID"" WHERE ""ORDER_RANK""=1"
206,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ROW(""customer_id"",""cnt"") IN (SELECT ""customer_id"",MAX(""cnt"") FROM ""cte"" GROUP BY ""customer_id"")"
207,"SELECT ""customer_id"",""products"".""product_id"",""products"".""product_name"" FROM ""orders"" JOIN ""products"" ON ""products"".""product_id""=""orders"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_id"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
208,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_ID"") DESC) AS ""rank_p"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
209,"SELECT ""customer_id"",""s1"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""total"",MAX(""total"") OVER (PARTITION BY ""customer_id"") AS ""max_total"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""total"" FROM ""orders"" GROUP BY 1,2) AS ""s"") AS ""s1"" LEFT JOIN ""products"" AS ""p"" ON ""s1"".""product_id""=""p"".""product_id"" WHERE ""s1"".""total""=""s1"".""max_total"""
210,"SELECT ""t1"".""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ord_cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ord_cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""t1"".""rnk""=1"
211,"SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""Counts"" DESC) AS ""Ranks"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""Counts"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""b"") AS ""a"" JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""ranks""=1"
212,"SELECT ""c"".""customer_id"",""c"".""product_id"",""c"".""product_name"" FROM (SELECT ""customer_id"",MAX(""ct"") AS ""max_ct"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ct"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"") AS ""m"" JOIN (SELECT ""customer_id"",""p"".""product_id"",""product_name"",COUNT(""order_id"") AS ""ct"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""p"".""product_id"",""product_name"") AS ""c"" ON ""m"".""customer_id""=""c"".""customeR_id"" AND ""max_ct""=""ct"""
213,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""Ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""Ranking""=1"
214,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
215,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
216,"WITH ""order_cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""drank"" FROM ""orders"" GROUP BY 1,2) SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""order_cte"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""drank""=1"
217,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""RK"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""o"".""product_id"",""product_name"" FROM ""cte"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_Id"" WHERE ""rk""=1"
218,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
219,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
220,"SELECT ""T2"".""customer_id"",""T2"".""product_id"",""P"".""product_name"" FROM ((SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""count_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""counts"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""T"") AS ""T2"", ""Products"" AS ""P"") JOIN ""Customers"" AS ""C"" WHERE ""count_rank""=1 AND ""T2"".""customer_id""=""C"".""customer_id"" AND ""T2"".""product_id""=""P"".""product_id"" ORDER BY ""T2"".""customer_id"",""T2"".""product_id"""
221,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""num_bought"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3), ""cte_2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_bought"" DESC) AS ""ranked_products"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""CTE_2"" WHERE ""ranked_products""=1"
222,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""sub"" WHERE ""rnk""=1"
223,"WITH ""CTE"" AS (SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"")), ""CTE1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""CTE1"" AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"") WHERE ""rk""=1"
224,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""products"".""product_name"" FROM ""cte"" AS ""a"" LEFT JOIN ""products"" ON ""products"".""product_id""=""a"".""product_id"" WHERE ""a"".""rnk""=1"
225,"WITH ""t0"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(""p"".""product_id"") AS ""quantity"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY CONCAT(""o"".""product_id"", '.', ""o"".""customer_id"")), ""t1"" AS (SELECT ""customer_id"",MAX(""quantity"") AS ""quantity"" FROM ""t0"" GROUP BY ""customer_id"") SELECT ""t0"".""customer_id"",""product_id"",""product_name"" FROM ""t0"" LEFT JOIN ""t1"" ON ""t0"".""customer_id""=""t1"".""customer_id"" WHERE ""t0"".""quantity""=""t1"".""quantity"""
226,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
227,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""a"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
228,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_times"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1), ""temp2"" AS (SELECT ""customer_id"",""product_id"" FROM ""temp"" AS ""A"" WHERE ""num_times""=(SELECT MAX(""num_times"") FROM ""temp"" AS ""B"" WHERE ""B"".""customer_id""=""A"".""customer_id"" GROUP BY ""customer_id"")) SELECT ""temp2"".""customer_id"",""temp2"".""product_id"",""product_name"" FROM ""temp2"" JOIN ""Products"" ON ""temp2"".""product_id""=""Products"".""product_id"""
229,"SELECT ""o"".""customer_id"",""o"".""product_id"",""Products"".""product_name"" FROM ""Products"" JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" WHERE ""o"".""rank_num""=1 AND ""o"".""product_id""=""Products"".""product_id"""
230,"WITH ""main"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(1) AS ""total"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id""), ""second"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total"" DESC) AS ""ranking"" FROM ""main"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""second"" WHERE ""ranking""=1"
231,"SELECT ""ranked"".""customer_id"",""ranked"".""product_id"",""Products"".""product_name"" FROM (SELECT ""totalOrders"".""customer_id"",""totalOrders"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""countOrder"" DESC) AS ""Ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""countOrder"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""totalOrders"") AS ""ranked"" JOIN ""Products"" ON ""ranked"".""product_id""=""Products"".""product_id"" WHERE ""ranked"".""Ranking""=1"
232,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
233,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""e"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""e"".""product_id"" WHERE ""rk""=1"
234,"SELECT ""temp1"".""customer_id"",""temp1"".""product_id"",""temp1"".""product_name"" FROM (SELECT ""temp"".""customer_id"",""temp"".""product_id"",""temp"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""temp"".""customer_id"" ORDER BY ""temp"".""total"" DESC) AS ""rk"" FROM (SELECT ""C"".""customer_id"",""O"".""product_id"",""P"".""product_name"",COUNT(1) AS ""total"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""C"".""customer_id"",""O"".""product_id"",""P"".""product_name"") AS ""temp"") AS ""temp1"" WHERE ""temp1"".""rk""=1"
235,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""rnk""=1"
236,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""count_product"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""t2"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count_product"" DESC) AS ""rank_product"" FROM ""t1"") SELECT ""t2"".""customer_id"",""t2"".""product_id"",""Products"".""product_name"" FROM ""t2"" LEFT JOIN ""Products"" ON ""t2"".""product_id""=""Products"".""product_id"" WHERE ""t2"".""rank_product""=1"
237,"WITH ""cte"" AS (SELECT ""C"".""customer_id"",""P"".""product_id"",""P"".""product_name"",COUNT(DISTINCT ""O"".""order_id"") AS ""oct"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY 1,2,3 ORDER BY 4 DESC), ""cte2"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""oct"" DESC) AS ""rownum"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte2"" WHERE ""rownum""=1"
238,"WITH ""tmp"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM (SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t3"".""product_name"",""t1"".""order_id"" FROM ""Orders"" AS ""t1"" LEFT JOIN ""Products"" AS ""t3"" ON ""t1"".""product_id""=""t3"".""product_id"") AS ""t4"" GROUP BY 1,2,3), ""prep"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""orders"" DESC) AS ""ranks"" FROM ""tmp"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""prep"" WHERE ""ranks""=1"
239,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""t"".""rnk""=1 ORDER BY ""customer_id"",""product_id"""
240,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
241,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""cte"".""product_id"",""product_name"" FROM ""cte"" LEFT JOIN ""products"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
242,"SELECT DISTINCT ""customer_id"",""C"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c_order"" DESC) AS ""d_r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""c_order"" FROM ""orders"") AS ""A"") AS ""B"" WHERE ""d_r""=1) AS ""C"" JOIN ""products"" AS ""p"" ON ""C"".""product_id""=""p"".""product_id"" ORDER BY ""customer_id"",""C"".""product_id"""
243,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2,3) AS ""rslt"" WHERE ""rnk""=1"
244,"SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""frequency"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""frequency"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" LEFT JOIN ""Products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
245,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(0) DESC) AS ""rk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"",""product_name"") AS ""t"" WHERE ""rk""=1"
246,"WITH ""base"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""n_orders"" FROM ""Orders"" GROUP BY 1,2), ""most_order_customer"" AS (SELECT ""customer_id"",MAX(""n_orders"") AS ""maxOrderCnt"" FROM ""base"" GROUP BY 1), ""productsls"" AS (SELECT ""b"".""customer_id"",""b"".""product_id"" FROM ""base"" AS ""b"" JOIN ""most_order_customer"" AS ""m"" ON ""b"".""customer_id""=""m"".""customer_id"" AND ""b"".""n_orders""=""m"".""maxOrderCnt"") SELECT ""p"".""customer_id"",""p"".""product_id"",""p2"".""product_name"" FROM ""productsls"" AS ""p"" JOIN ""products"" AS ""p2"" ON ""p"".""product_id""=""p2"".""product_id"""
247,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""quantity"" DESC) AS ""qty_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""quantity"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" ORDER BY 1,3) SELECT ""CTE"".""customer_id"",""CTE"".""product_id"",""product_name"" FROM ""CTE"" JOIN ""Products"" ON ""CTE"".""product_id""=""Products"".""product_id"" WHERE ""qty_rank""=1"
248,"SELECT ""C"".""CUSTOMER_ID"",""C"".""PRODUCT_ID"",""P"".""PRODUCT_NAME"" FROM (SELECT ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"",DENSE_RANK() OVER (PARTITION BY ""O"".""CUSTOMER_ID"" ORDER BY COUNT(""PRODUCT_ID"") DESC) AS ""CNT"" FROM ""ORDERS"" AS ""O"" GROUP BY ""O"".""CUSTOMER_ID"",""PRODUCT_ID"") AS ""C"" JOIN ""PRODUCTS"" AS ""P"" ON ""C"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" WHERE ""CNT""=1"
249,"SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM (SELECT ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"",""P"".""PRODUCT_NAME"",""FREQ"",RANK() OVER (PARTITION BY ""O"".""CUSTOMER_id"" ORDER BY ""O"".""CUSTOMER_id"",""FREQ"" DESC) AS ""RNK"" FROM (SELECT ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"",COUNT(1) AS ""FREQ"" FROM ""ORDERS"" AS ""O"" GROUP BY ""O"".""CUSTOMER_id"",""O"".""PRODUCT_ID"") AS ""O"" LEFT JOIN ""PRODUCTS"" AS ""P"" ON ""O"".""PRODUCT_ID""=""P"".""PRODUCT_ID"") AS ""RES"" WHERE ""RNK""=1"
250,"WITH ""ranking"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_num"" DESC) AS ""order_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""order_num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""order_count"") SELECT ""R"".""customer_id"",""R"".""product_id"",""P"".""product_name"" FROM ""ranking"" AS ""R"" JOIN ""Products"" AS ""P"" ON ""R"".""product_id""=""P"".""product_id"" WHERE ""order_rank""=1"
251,"WITH ""CTE"" (""customer_id"", ""product_id"", ""num_ordered"") AS (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM ""CTE"" AS ""a"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE (""num_ordered"") IN (SELECT MAX(""num_ordered"") FROM ""cte"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
252,"SELECT ""c"".*,""d"".""product_name"" FROM (SELECT DISTINCT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",""num_order"",MAX(""num_order"") OVER (PARTITION BY ""customer_id"") AS ""max_num_order"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_date"") AS ""num_order"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" WHERE ""num_order""=""max_num_order"") AS ""c"" LEFT JOIN ""Products"" AS ""d"" ON ""c"".""product_id""=""d"".""product_id"""
253,"WITH ""customer_product"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""order_cnt"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""customer_product"" WHERE ""ranking""=1"
254,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rn"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"" WHERE ""rn""=1"
255,"WITH ""ds"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") SELECT ""ds"".""customer_id"" AS ""customer_id"",""p"".""product_id"" AS ""product_id"",""p"".""product_name"" AS ""product_name"" FROM ""ds"" JOIN ""products"" AS ""p"" WHERE ""ds"".""product_id""=""p"".""product_id"" AND ""ds"".""rnk""=1"
256,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""a"" WHERE ""rk""=1"
257,"WITH ""table1"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") OVER (PARTITION BY ""o"".""product_id"", ""o"".""customer_id"") AS ""cnt"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") ORDER BY ""customer_id""), ""table2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""table1"") SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM ""table2"" WHERE ""rnk""=1"
258,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" JOIN ""products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""A"" WHERE ""A"".""rnk""=1"
259,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""sales_rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""sales_rnk""=1"
260,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" GROUP BY 1,2) SELECT ""c"".""customer_id"",""c"".""product_id"",""products"".""product_name"" FROM (""cte"" AS ""c"") JOIN ""products"" WHERE ""c"".""product_id""=""products"".""product_id"" AND ""c"".""cnt""=(SELECT MAX(""cnt"") FROM ""cte"" WHERE ""c"".""customer_id""=""customer_id"") ORDER BY ""c"".""customer_id"""
261,"WITH ""count_cte"" AS (SELECT *,COUNT(1) AS ""total_num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""rnk_cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total_num"" DESC) AS ""rnk"" FROM ""count_cte"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""rnk_cte"" AS ""c"" LEFT JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""rnk""=1"
262,"SELECT ""temp"".""customer_id"",""temp"".""product_id"",""temp"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
263,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",""o"".""product_id"",""p"".""product_name"",""p"".""price"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") AS ""tb"" WHERE ""rnk""=1 ORDER BY ""customer_id"""
264,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""b"".""product_id"",""product_name"",COUNT(1) AS ""p_count"" FROM (""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""p_count"" DESC) AS ""p_rank"" FROM ""cte"") AS ""c"" WHERE ""p_rank""=1"
265,"WITH ""order_count"" AS (SELECT ""O"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(""O"".""product_id"") AS ""order_count"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""O"".""customer_id"",""p"".""product_id"",""p"".""product_name"") SELECT ""OC"".""customer_id"",""OC"".""product_id"",""OC"".""product_name"" FROM ""order_count"" AS ""OC"" WHERE ""OC"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_count"" AS ""X"" WHERE ""X"".""customer_id""=""OC"".""customer_id"")"
266,"SELECT ""s"".""customer_id"",""s"".""product_id"",""s"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""s"".""rnk""=1"
267,"SELECT ""t2"".""customer_id"",""t3"".""product_id"",""t3"".""product_name"" FROM (SELECT ""customer_id"",MAX(""sum_num"") AS ""max_num"" FROM (SELECT ""customer_id"",""Orders"".""product_id"",""product_name"",COUNT(""order_date"") AS ""sum_num"" FROM ""Orders"" LEFT JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""customer_id"",""Orders"".""product_id"",""product_name"") AS ""t1"" GROUP BY ""customer_id"") AS ""t2"" LEFT JOIN (SELECT ""customer_id"",""Orders"".""product_id"",""product_name"",COUNT(""order_date"") AS ""sum_num"" FROM ""Orders"" LEFT JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""customer_id"",""Orders"".""product_id"",""product_name"") AS ""t3"" ON ""t2"".""customer_id""=""t3"".""customer_id"" AND ""t2"".""max_num""=""t3"".""sum_num"""
268,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
269,"WITH ""TEMP"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""freq"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rank"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1,3 DESC) SELECT ""TEMP"".""customer_id"",""TEMP"".""product_id"",""p"".""product_name"" FROM ""TEMP"" LEFT JOIN ""Products"" AS ""p"" ON ""TEMP"".""product_id""=""p"".""product_id"" WHERE ""TEMP"".""rank""=1 ORDER BY 1,2"
270,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""rnk""=1"
271,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
272,"WITH ""a"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",COUNT(1) AS ""quantity"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2), ""b"" AS (SELECT ""a"".*,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""quantity"" DESC) AS ""prod_rank"" FROM ""a"") SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM ""b"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""b"".""prod_rank""=1"
273,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id""),DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""Products"".""product_name"" FROM ""cte"" LEFT JOIN ""Products"" ON ""cte"".""product_id""=""Products"".""product_id"" WHERE ""cte"".""rnk""=1"
274,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
275,"SELECT ""c"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""ranking"" FROM ""orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""a"" ON ""c"".""customer_id""=""a"".""customer_id"") JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""a"".""ranking""=1"
276,"SELECT ""TT"".""customer_id"",""TT"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""TT"" LEFT JOIN ""Products"" AS ""P"" ON ""TT"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
277,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""Products"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""Products"".""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""customer_id"",""Products"".""product_id"") AS ""t"" WHERE ""order_rank""=1 ORDER BY ""customer_id"",""product_id"""
278,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""t"".""product_id"",""product_name"" FROM ""temp"" AS ""t"" JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rk""=1"
279,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
280,"WITH ""grouped"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_orders"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" HAVING COUNT(1)>=1), ""grouped_ranked"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""product_rank"" FROM ""grouped""), ""most_common_product"" AS (SELECT ""customer_id"",""product_id"" FROM ""grouped_ranked"" WHERE ""product_rank""=1) SELECT ""mcp"".""customer_id"",""mcp"".""product_id"",""product_name"" FROM ""most_common_product"" AS ""mcp"" LEFT JOIN ""products"" ON ""mcp"".""product_id""=""products"".""product_id"""
281,"SELECT ""temp2"".""customer_id"",""temp2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp2"" LEFT JOIN ""Products"" ON ""temp2"".""product_id""=""Products"".""product_id"" WHERE ""rk""=1"
282,"SELECT ""customer_id"",""Products"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""order_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"") AS ""temp2"" JOIN ""Products"" ON ""temp2"".""product_id""=""Products"".""product_id"" WHERE ""r""=1"
283,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""rnk""=1"
284,"WITH ""orderr"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""final_order"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""orderr"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id"") AS ""t"" WHERE ""rnk""=1) SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""final_order"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"""
285,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""p_freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") SELECT ""A"".""customer_id"",""A"".""product_id"",""B"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",""p_freq"",MAX(""p_freq"") OVER (PARTITION BY ""customer_id"") AS ""fmax"" FROM ""CTE"") AS ""A"" LEFT JOIN ""Products"" AS ""B"" USING (""product_id"") WHERE ""A"".""p_freq""=""A"".""fmax"""
286,"WITH ""qry1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""c"".""product_name"" FROM ((""qry1"" AS ""a"") JOIN (SELECT ""customer_id"",MAX(""cnt"") AS ""mcnt"" FROM ""qry1"" GROUP BY ""customer_id"") AS ""b"") JOIN ""Products"" AS ""c"" WHERE ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""cnt""=""b"".""mcnt"" AND ""a"".""product_id""=""c"".""product_id"""
287,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""sub"".""customer_id"",""sub"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""sub"".""customer_id"" ORDER BY ""sub"".""freq"" DESC) AS ""most_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""sub"" LEFT JOIN ""Products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"") AS ""final_table"" WHERE ""most_rank""=1"
288,"WITH ""tb"" AS (SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""counts"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""counts"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""r"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""t"".""r""=1) SELECT ""tb"".""customer_id"",""tb"".""product_id"",""p"".""product_name"" FROM ""tb"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""tb"".""product_id"""
289,"WITH ""t_count"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t_count"" WHERE ""rk""=1"
290,"WITH ""a"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""b"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""m"" FROM ""a"" GROUP BY ""customer_id"") SELECT ""a2"".""customer_id"",""a2"".""product_id"",""c2"".""product_name"" FROM (""a"" AS ""a2"" JOIN ""b"" AS ""b2"" ON ""a2"".""customer_id""=""b2"".""customer_id"" AND ""a2"".""cnt""=""b2"".""m"") JOIN ""Products"" AS ""c2"" ON ""a2"".""product_id""=""c2"".""product_id"""
291,"WITH ""count_product"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""count_product"") AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
292,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""rnked"" WHERE ""rnk""=1 ORDER BY 1,2"
293,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""p"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1"
294,"SELECT ""temp"".""customer_id"",""temp"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(DISTINCT ""order_id"") DESC) AS ""RK"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" LEFT JOIN ""Products"" AS ""p"" ON ""temp"".""product_id""=""p"".""product_id"" WHERE ""temp"".""RK""=1"
295,"SELECT ""sq"".""customer_id"",""sq"".""product_id"",""p"".""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""sq"" ON ""p"".""product_id""=""sq"".""product_id"" WHERE ""rnk""=1"
296,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY COUNT(""a"".""product_id"") DESC) AS ""rn"",""b"".""product_name"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"") GROUP BY 1,2,4) AS ""t"" WHERE ""rn""=1"
297,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
298,"SELECT ""t3"".""customer_id"",""t3"".""product_id"",""t3"".""product_name"" FROM (SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(DISTINCT ""order_id"") DESC) AS ""rk"" FROM ""Orders"" GROUP BY 1,2) AS ""t1"" WHERE ""rk""=1) AS ""t2"" LEFT JOIN ""Products"" ON ""t2"".""product_id""=""Products"".""product_id"") AS ""t3"" JOIN ""Customers"" ON ""t3"".""customer_id""=""Customers"".""customer_id"""
299,"WITH ""counter"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY 1,2), ""popular"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""pop"" FROM ""counter"" GROUP BY 1) SELECT ""a"".""customer_id"",""a"".""product_id"",""c"".""product_name"" FROM (""counter"" AS ""a"" JOIN ""popular"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""cnt""=""b"".""pop"") JOIN ""products"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"""
300,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
301,"WITH ""num_orders"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_orders"" FROM ""orders"" GROUP BY 1,2) SELECT ""t"".""customer_id"",""t"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""n"".""product_id"",""product_name"",""num_orders"" FROM ""num_orders"" AS ""n"" LEFT JOIN ""products"" AS ""p"" ON ""n"".""product_id""=""p"".""product_id"") AS ""t"" LEFT JOIN (SELECT ""customer_id"",MAX(""num_orders"") AS ""max_num_orders"" FROM ""num_orders"" GROUP BY 1) AS ""m"" ON ""t"".""customer_id""=""m"".""customer_id"" WHERE ""num_orders""=""max_num_orders"""
302,"WITH ""prod_count"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""den_rank"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""max_prod"" FROM ""prod_count"") SELECT ""sub"".""customer_id"",""sub"".""product_id"",""p"".""product_name"" FROM (SELECT * FROM ""den_rank"" WHERE ""max_prod""=1) AS ""sub"" LEFT JOIN ""Products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"""
303,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
304,"SELECT ""sub"".""customer_id"",""sub"".""product_id"",""sub"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""most_freq_orders"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") AS ""sub"" WHERE ""sub"".""most_freq_orders""=1"
305,"SELECT ""customer_id"",""product_id"",""product_name"" FROM ""orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2 HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""p"" GROUP BY 1)"
306,"WITH ""temp1"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(1) AS ""num"" FROM ""Orders"" AS ""o"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id""), ""temp2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""num"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rnk"" FROM ""temp1"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""temp2"" WHERE ""rnk""=1"
307,"WITH ""Employee_CTE"" (""cnt"", ""cid"", ""pid"") AS (SELECT COUNT(""order_id""),""customer_id"",""product_id"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ((""employee_cte"" AS ""e"" JOIN (SELECT MAX(""cnt"") AS ""max_count"",""cid"" FROM ""Employee_CTE"" GROUP BY ""cid"") AS ""temp1"" ON ""temp1"".""max_count""=""cnt"" AND ""e"".""cid""=""temp1"".""cid"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""e"".""pid"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""e"".""cid"""
308,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt_prod"" DESC) AS ""rnk"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",COUNT(1) AS ""cnt_prod"" FROM ""orders"" AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1,2) AS ""z"") AS ""y"" WHERE ""rnk""=1"
309,"WITH ""tmp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""qty"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""tmp2"" AS (SELECT ""customer_id"",""product_id"",""qty"",MAX(""qty"") OVER (PARTITION BY ""customer_id"") AS ""max_qty"" FROM ""tmp"") SELECT ""customer_id"",""tmp2"".""product_id"",""product_name"" FROM ""tmp2"" JOIN ""products"" AS ""p"" ON ""tmp2"".""product_id""=""p"".""product_id"" WHERE ""qty""=""max_qty"""
310,"WITH ""a"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",COUNT(1) AS ""quantity"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2) SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT ""a"".*,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""quantity"" DESC) AS ""prod_rank"" FROM ""a"") AS ""b"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""b"".""prod_rank""=1"
311,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""my_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""my_rank""=1"
312,"WITH ""cte2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""rank_p"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""cte1"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""cte2"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""rank_p""=1"
313,"WITH ""t"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ranking"" FROM ""orders"" GROUP BY 1,2) SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""t"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""t"".""ranking""=1"
314,"WITH ""Freq"" AS (SELECT ""order_id"",""customer_id"",""o"".""product_id"",""product_name"",COUNT(""order_id"") AS ""order_freq"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id""), ""MaxFreq"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""order_freq"",MAX(""order_freq"") OVER (PARTITION BY ""customer_id"") AS ""max_freq"" FROM ""Freq"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""MaxFreq"" WHERE ""order_freq""=""max_freq"""
315,"WITH ""order_counts"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""count_of_orders"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",""p"".""product_name""), ""order_counts_ranked"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""count_of_orders"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count_of_orders"" DESC) AS ""order_count_rank"" FROM ""order_counts"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""order_counts_ranked"" WHERE ""order_count_rank""=1"
316,"WITH ""cet"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM (""cet"" AS ""c"") JOIN ""products"" AS ""p"" WHERE ""c"".""product_id""=""p"".""product_id"" AND ""rnk""=1"
317,"WITH ""t"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" AS ""t1"" JOIN ""products"" USING (""product_id"") WHERE ""cnt""=(SELECT MAX(""cnt"") FROM ""t"" AS ""t2"" WHERE ""t2"".""customer_id""=""t1"".""customer_id"")"
318,"SELECT ""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank_freq"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rank_freq""=1"
319,"SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""order_id"") AS ""counts"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""r"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""t"" WHERE ""t"".""r""=1"
320,"WITH ""temp"" AS (SELECT ""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""temp"" WHERE ""ranking""=1"
321,"WITH ""CET"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""SERIES"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" HAVING COUNT(1)>0) SELECT ""customer_id"",""A"".""product_id"",""product_name"" FROM ""CET"" AS ""A"" JOIN ""Products"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" WHERE ""SERIES""=1"
322,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""times"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""b"" AS (SELECT ""customer_id"",MAX(""times"") AS ""max_time"" FROM ""cte"" GROUP BY ""customer_id"") SELECT ""b"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (""b"" JOIN ""cte"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""max_time""=""c"".""times"") JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"""
323,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
324,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""P1"".""product_id"",""P1"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""P1"".""product_id"") DESC) AS ""RNK"" FROM ""Orders"" AS ""O1"" JOIN ""Products"" AS ""P1"" ON ""O1"".""product_id""=""P1"".""product_id"" GROUP BY ""customer_id"",""P1"".""product_id"",""P1"".""product_name"") AS ""T1"" WHERE ""RNK""=1"
325,"WITH ""cte"" AS (SELECT ""customer_id"",""orders"".""product_id"",""product_name"",COUNT(1) AS ""num"" FROM ""orders"" LEFT JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""customer_id"",""orders"".""product_id""), ""cte_1"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""num"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte_1"" WHERE ""rnk""=1"
326,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""rank_p""=1"
327,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2 HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""customer_id"",MAX(""prod_count"") FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""prod_count"" FROM ""Orders"" GROUP BY 1,2) AS ""p"" GROUP BY 1)"
328,"WITH ""cte_1"" AS (SELECT ""a"".""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_cnt"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"",""product_id""), ""cte_2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_cnt"" DESC) AS ""rnk"" FROM ""cte_1"") SELECT ""a"".""customer_id"",""a"".""product_id"",""product_name"" FROM ""cte_2"" AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
329,"WITH ""temp_rank"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""tr"".""customer_id"",""tr"".""product_id"",""p"".""product_name"" FROM ""temp_rank"" AS ""tr"" JOIN ""products"" AS ""p"" ON ""tr"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
330,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""product_rank"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" WHERE ""product_rank""=1"
331,"SELECT ""customer_id"",""prod"".""product_id"" AS ""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""prod_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""rankorders"" JOIN ""Products"" AS ""prod"" ON ""prod"".""product_id""=""rankorders"".""product_id"" WHERE ""rankorders"".""prod_rank""=1"
332,"SELECT ""tb2"".""customer_id"",""tb2"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""num_orders"" FROM ""Orders"" GROUP BY 1,2 HAVING ""num_orders"">=1 ORDER BY 1) AS ""tb"") AS ""tb2"" JOIN ""Products"" AS ""p"" ON ""tb2"".""product_id""=""p"".""product_id"" WHERE ""tb2"".""rank""=1"
333,"WITH ""t1"" AS (SELECT DISTINCT ""customer_id"",""product_id"",COUNT(1) OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""cnt"" FROM ""Orders"") SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM ""t1"" WHERE ROW(""customer_id"",""cnt"") IN (SELECT ""customer_id"",MAX(""cnt"") FROM ""t1"" GROUP BY ""customer_id"")) AS ""t2"" LEFT JOIN ""Products"" ON ""t2"".""product_id""=""Products"".""product_id"""
334,"WITH ""o"" AS (SELECT ""Orders"".""product_id"",""Products"".""product_name"",""Orders"".""customer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY 1,2,3), ""rnk"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""o"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""rnk"" WHERE ""rnk""=1"
335,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""customer_id"",""cte2"".""product_id"",""product_name"" FROM ""cte2"" LEFT JOIN ""products"" AS ""p"" ON ""cte2"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
336,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""a"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""mf"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"") AS ""b"" WHERE ""mf""=1"
337,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""counts"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""rnk"" FROM ""cte"") AS ""temp"" WHERE ""temp"".""rnk""=1"
338,"SELECT ""cte"".""customer_id"",""cte"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""r"" FROM ""orders"" GROUP BY 1,2) AS ""cte"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""cte"".""product_Id"" WHERE ""cte"".""r""=1"
339,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"",MAX(COUNT(1)) OVER (PARTITION BY ""customer_id"") AS ""max_cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" AND ""t"".""cnt""=""t"".""max_cnt"""
340,"SELECT ""orders"".""customer_id"",""orders"".""product_id"",""products"".""product_name"" FROM ""orders"" LEFT JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""orders"".""product_id"")) IN (SELECT ""customer_id"",MAX(""num_prod"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""num_prod"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" GROUP BY ""customer_id"")"
341,"WITH ""temp"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""product_name"",COUNT(1) AS ""cnt"" FROM ""Orders"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""customer_id"",""product_id"",""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""temp"") AS ""x"" WHERE ""rnk""=1"
342,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_id"") AS ""temp"" WHERE ""rk""=1"
343,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""product_id"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" GROUP BY 1)"
344,"SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_Id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""t"" WHERE ""t"".""rnk""=1"
345,"WITH ""b"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY 1,2) SELECT ""b"".""customer_id"",""b"".""product_id"",""a"".""product_name"" FROM ""Products"" AS ""a"" JOIN ""b"" USING (""product_id"") WHERE ""rnk""=1"
346,"WITH ""cte"" AS (SELECT ""C"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""product_rank"" FROM (""Orders"" AS ""O"" LEFT JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""O"".""customer_id"") LEFT JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" GROUP BY ""C"".""customer_id"",""O"".""product_id"") SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""product_rank""=1"
347,"WITH ""cte"" AS (SELECT ""customer_id"",""o"".""product_id"",""product_name"",COUNT(""o"".""product_id"") AS ""cnt"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",""cnt"" FROM ""cte"" WHERE ROW(""customer_id"",""cnt"") IN (SELECT ""customer_id"",MAX(""cnt"") FROM ""cte"" GROUP BY ""customer_id"")) AS ""tmp"""
348,"SELECT ""sq"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""sq"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""sq"".""order_rank""=1"
349,"WITH ""order_cnt"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM (""order_cnt"" AS ""c"") JOIN ""products"" AS ""p"" WHERE ""c"".""product_id""=""p"".""product_id"" AND ""c"".""rnk""=1"
350,"SELECT ""t4"".""product_name"",""t3"".* FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""rank_order"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT (""order_id"")) AS ""num_orders"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"") AS ""t2"" WHERE ""rank_order""=1) AS ""t3"" JOIN ""Products"" AS ""t4"" ON ""t3"".""product_id""=""t4"".""product_id"""
351,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ordcnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""ordcnt""=(SELECT MAX(""ordcnt"") FROM ""cte"" AS ""c"" WHERE ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"")"
352,"WITH ""order_counts"" AS (SELECT ""o"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) SELECT ""oc"".""customer_id"",""oc"".""product_id"",""oc"".""product_name"" FROM ""order_counts"" AS ""oc"" WHERE ""oc"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_counts"" AS ""x"" WHERE ""x"".""customer_id""=""oc"".""customer_id"")"
353,"SELECT ""t1"".""customer_id"",""t1"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""r"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"" LEFT JOIN ""products"" ON ""products"".""product_id""=""t1"".""product_id"" WHERE ""t1"".""r""=1"
354,"SELECT ""customer_id"",""Products"".""product_id"" AS ""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""order_counts"") AS ""order_counts_ranked"" JOIN ""Products"" ON ""order_counts_ranked"".""product_id""=""Products"".""product_id"" WHERE ""r""=1"
355,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" AS ""c"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""RNK""=1"
356,"SELECT ""T"".""customer_id"",""P"".""product_id"",""P"".""product_name"" FROM (""Products"" AS ""P"") JOIN (SELECT ""O"".""customer_id"",""O"".""product_id"",RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""Rnk"" FROM ""Orders"" AS ""O"" GROUP BY ""O"".""customer_id"",""O"".""product_id"") AS ""T"" WHERE ""T"".""product_id""=""P"".""product_id"" AND ""T"".""Rnk""=1"
357,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""products"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rank_count"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""rank_count""=1"
358,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"") WHERE ""rnk""=1"
359,"SELECT ""temp"".""customer_id"",""temp"".""product_id"",""temp"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""temp"".""rnk""=1"
360,"WITH ""customer_products_count"" AS (SELECT COUNT(""product_id"") AS ""product_count"",""customer_id"",""product_id"" FROM ""Orders"" GROUP BY 2,3) SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""product_rank"" FROM ""customer_products_count"") AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""product_rank""=1"
361,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
362,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",""product_id"",""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""cte2"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""cte2"" JOIN ""products"" AS ""p"" ON ""cte2"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
363,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""e"".""product_id"",""e"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM ""grouped_cnt"" AS ""a"") AS ""b"" WHERE ""b"".""rn""=1) AS ""c"" LEFT JOIN ""products"" AS ""e"" ON ""e"".""product_id""=""c"".""product_id"""
364,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""r"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" USING (""customer_id"")) LEFT JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""dudu"" WHERE ""r""=1"
365,"SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"" FROM (SELECT ""o"".""customer_id"" AS ""customer_id"",""p"".""product_id"" AS ""product_id"",""p"".""product_name"" AS ""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""p"".""product_id"") DESC) AS ""cnt"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_id"") AS ""t"" WHERE ""t"".""cnt""=1 ORDER BY ""t"".""customer_id"",""t"".""product_id"""
366,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""C"".""customer_id"",""P"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""RANK"" FROM ((""Customers"" AS ""C"") JOIN ""Orders"" AS ""O"") JOIN ""Products"" AS ""P"" WHERE ""C"".""customer_id""=""O"".""customer_id"" AND ""O"".""product_id""=""P"".""product_id"" GROUP BY ""C"".""customer_id"",""P"".""product_id"") AS ""S"" WHERE ""S"".""RANK""=1"
367,"SELECT ""co"".""customer_id"",""co"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""rnk"" DESC) AS ""co"" LEFT JOIN ""Products"" AS ""p"" ON ""co"".""product_id""=""p"".""product_id"" WHERE ""co"".""rnk""=1"
368,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
369,"SELECT ""customer_id"",""t"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) AS ""t"" JOIN ""products"" AS ""b"" ON ""t"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
370,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""rnked"" WHERE ""rnk""=1 ORDER BY 1,2"
371,"SELECT ""tmp"".""customer_id"",""tmp"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_frequent"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"" JOIN ""products"" ON ""tmp"".""product_id""=""products"".""product_id"" WHERE ""rank_frequent""=1 ORDER BY ""tmp"".""customer_id"""
372,"SELECT DISTINCT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",""cnt"",MAX(""cnt"") OVER (PARTITION BY ""customer_id"") AS ""mx"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""cnt"" FROM ""orders"") AS ""o"") AS ""oo"" ON ""oo"".""product_id""=""p"".""product_id"" WHERE ""cnt""=""mx"" ORDER BY 1,2"
373,"SELECT ""t2"".""aa"" AS ""customer_id"",""t2"".""bb"" AS ""product_id"",""t2"".""cc"" AS ""product_name"" FROM (SELECT ""t1"".""a"" AS ""aa"",""t1"".""b"" AS ""bb"",""t1"".""c"" AS ""cc"",""t1"".""cc"" AS ""d"",DENSE_RANK() OVER (PARTITION BY ""t1"".""a"" ORDER BY ""t1"".""cc"" DESC) AS ""rnk"" FROM (SELECT ""c"".""customer_id"" AS ""a"",""o"".""product_id"" AS ""b"",""p"".""product_name"" AS ""c"",COUNT(""product_name"") AS ""cc"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""t1"") AS ""t2"" WHERE ""t2"".""rnk""=1"
374,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2) AS ""temp"" WHERE ""rnk""=1 ORDER BY 1,2"
375,"WITH ""temp1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""temp2"" AS (SELECT ""customer_id"",MAX(""product_count"") AS ""max_product_count"" FROM ""temp1"" GROUP BY ""customer_id"") SELECT ""temp1"".""customer_id"",""temp1"".""product_id"",""product_name"" FROM (""temp1"" JOIN ""temp2"" USING (""customer_id"")) JOIN ""products"" ON ""temp1"".""product_id""=""products"".""product_id"" WHERE ""product_count""=""max_product_count"""
376,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
377,"SELECT ""Customers"".""customer_id"",""Orders_1"".""product_id"",""Products"".""product_name"" FROM ((""Customers"") JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""Orders_1"") JOIN ""Products"" WHERE ""Orders_1"".""rank""=1 AND ""Customers"".""customer_id""=""Orders_1"".""customer_id"" AND ""Orders_1"".""product_id""=""Products"".""product_id"""
378,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""RANKING"" FROM ""Orders"" GROUP BY 1,2) AS ""a"", ""Products"" AS ""p"" WHERE ""a"".""product_id""=""p"".""product_id"" AND ""a"".""RANKING""=1"
379,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
380,"WITH ""order_counts"" AS (SELECT ""o"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,3) SELECT ""oc"".""customer_id"",""oc"".""product_id"",""oc"".""product_name"" FROM ""order_counts"" AS ""oc"" WHERE ""oc"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_counts"" AS ""x"" WHERE ""x"".""customer_id""=""oc"".""customer_id"")"
381,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_Id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
382,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""customer_rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""A"") AS ""B"" WHERE ""customer_rk""=1) SELECT ""T"".""customer_id"",""T"".""product_id"",""P"".""product_name"" FROM ""temp"" AS ""T"" JOIN ""Products"" AS ""P"" ON ""T"".""product_id""=""P"".""product_id"""
383,"WITH ""t"" AS (SELECT COUNT(1) AS ""cnt"",""customer_id"",""product_id"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""p"".""product_id"",""product_name"" FROM (""t"" LEFT JOIN ""t"" AS ""t1"" ON ""t"".""customer_id""=""t1"".""customer_id"" AND ""t"".""cnt""<=""t1"".""cnt"") LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" GROUP BY ""t"".""customer_id"",""p"".""product_id"",""t"".""cnt"" HAVING COUNT(DISTINCT ""t1"".""cnt"")=1"
384,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""prdrank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""o"".""prdrank""=1"
385,"WITH ""base"" AS (SELECT ""customer_id"",""product_id"",""num_order"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_order"" DESC) AS ""rank0"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_order"" FROM ""orders"" GROUP BY 1,2) AS ""sub"") SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT * FROM ""base"" WHERE ""rank0""=1) AS ""b"" JOIN ""products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"""
386,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date""),DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_date"") DESC) AS ""r1"" FROM ""orders"" GROUP BY 1,2) AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""r1""=1"
387,"WITH ""count_cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""counts"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id""), ""rank_cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""r"" FROM ""count_cte"") SELECT ""customer_id"",""Products"".""product_id"",""Products"".""product_name"" FROM ""rank_cte"" JOIN ""Products"" ON ""rank_cte"".""product_id""=""Products"".""product_id"" WHERE ""r""=1"
388,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rank_p""=1"
389,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""ranking"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""ranking""=1 ORDER BY ""customer_id"""
390,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
391,"WITH ""ct"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""freq"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""ct"".""customer_id"",""ct"".""product_id"",""product_name"" FROM (""ct"" JOIN (SELECT ""customer_id"",MAX(""freq"") AS ""freq"" FROM ""ct"" GROUP BY ""customer_id"") AS ""max_ct"" ON ""ct"".""customer_id""=""max_ct"".""customer_id"" AND ""ct"".""freq""=""max_ct"".""freq"") JOIN ""Products"" ON ""Products"".""product_id""=""ct"".""product_id"""
392,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""c"" FROM ""orders"" AS ""o"" GROUP BY 1,2) AS ""t"" JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""c""=1"
393,"WITH ""customer_totals"" AS (SELECT COUNT(""o"".""order_id"") AS ""item_count"",""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""product_id"",""customer_id""), ""rank_products"" AS (SELECT ""item_count"",""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""item_count"" DESC) AS ""order_value_rank"" FROM ""customer_totals"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""rank_products"" WHERE ""order_value_rank""=1"
394,"WITH ""ct"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""freq"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""ct2"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",""freq"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""rnk"" FROM ""ct"") AS ""tmp"" WHERE ""rnk""=1) SELECT ""ct2"".""customer_id"",""ct2"".""product_id"",""prd"".""product_name"" FROM ""ct2"" JOIN ""Products"" AS ""prd"" ON ""prd"".""product_id""=""ct2"".""product_id"""
395,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""temp"" AS ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""cnt"">=(SELECT MAX(""cnt"") FROM ""temp"" AS ""t2"" WHERE ""t1"".""customer_id""=""t2"".""customer_id"" GROUP BY ""t2"".""customer_id"")"
396,"SELECT ""r"".""customer_id"",""r"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""freq_rank"",""freq"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""frequent_order"") AS ""r"" JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""freq_rank""=1"
397,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""order_date"") AS ""cnt"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""order_date"") DESC) AS ""rk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""tmp"" WHERE ""rk""=1"
398,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
399,"SELECT ""customer_id"",""tmp"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) AS ""tmp"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""tmp"".""product_id"" WHERE ""tmp"".""rnk""=1"
400,"SELECT ""T"".""customer_id"",""P"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" GROUP BY ""customer_id"",""product_id"") AS ""T"" JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""T"".""product_id"" WHERE ""T"".""rnk""=1"
401,"WITH ""tmp"" AS (SELECT ""t2"".""customer_id"",""t1"".""product_id"",""t3"".""product_name"",COUNT(""t1"".""order_id"") AS ""qty"" FROM (""Orders"" AS ""t1"" JOIN ""Customers"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"") JOIN ""Products"" AS ""t3"" ON ""t1"".""product_id""=""t3"".""product_id"" GROUP BY ""t2"".""customer_id"",""t1"".""product_id"",""t3"".""product_name""), ""rank_item"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""qty"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""qty"" DESC) AS ""rn"" FROM ""tmp"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""rank_item"" WHERE ""rn""=1"
402,"SELECT ""b"".""customer_id"",""b"".""product_id"",""p"".""product_name"" FROM (SELECT ""a"".*,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ct"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1,2) AS ""a"") AS ""b"", ""Products"" AS ""p"" WHERE ""b"".""rnk""=1 AND ""p"".""product_id""=""b"".""product_id"""
403,"SELECT ""C"".""CUSTOMER_ID"",""C"".""PRODUCT_ID"",""P"".""PRODUCT_NAME"" FROM (SELECT ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"",DENSE_RANK() OVER (PARTITION BY ""O"".""CUSTOMER_ID"" ORDER BY COUNT(""O"".""PRODUCT_ID"") DESC) AS ""CNT"" FROM ""ORDERS"" AS ""O"" GROUP BY ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"") AS ""C"" JOIN ""PRODUCTS"" AS ""P"" ON ""C"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" WHERE ""CNT""=1"
404,"SELECT ""res"".""customer_id"",""res"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""orders"".""customer_id"") DESC) AS ""prank"" FROM ""orders"" GROUP BY ""customer_id"",""orders"".""product_id"") AS ""res"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""res"".""product_id"" WHERE ""prank""=1"
405,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""f"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""agg"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""f"" DESC) AS ""r"" FROM ""cte"") AS ""agg"" JOIN ""products"" AS ""p"" ON ""agg"".""product_id""=""p"".""product_id"" WHERE ""agg"".""r""=1"
406,"WITH ""num_order"" AS (SELECT ""Orders"".""customer_id"",""Orders"".""product_id"",""Products"".""product_name"",COUNT(1) AS ""freq"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""customer_id"",""Orders"".""product_id""), ""max_order"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""freq"",MAX(""freq"") OVER (PARTITION BY ""customer_id"") AS ""max_freq"" FROM ""num_order"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""max_order"" WHERE ""max_freq""=""freq"""
407,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(""order_id"") AS ""total"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"",""product_name"") AS ""t"" WHERE ""rnk""=1"
408,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
409,"WITH ""freq"" AS (SELECT ""product_id"",""customer_id"",COUNT(""customer_id"") AS ""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""customer_id"") DESC) AS ""r_num"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""freq"".""product_id"",""product_name"" FROM ""freq"" JOIN ""products"" AS ""p"" ON ""freq"".""product_id""=""p"".""product_id"" WHERE ""r_num""=1 GROUP BY 1,2 ORDER BY 1"
410,"SELECT ""tab2"".""customer_id"" AS ""customer_id"",""tab3"".""product_id"" AS ""product_id"",""tab3"".""product_name"" AS ""product_name"" FROM (SELECT ""customer_id"",MAX(""fre"") AS ""frequency"" FROM (SELECT ""customer_id"",COUNT(1) AS ""fre"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" HAVING COUNT(""product_id"")>0) AS ""tab1"" GROUP BY ""customer_id"") AS ""tab2"" LEFT JOIN (SELECT ""customer_id"",""a"".""product_id"",""product_name"",COUNT(1) AS ""time"" FROM ""Orders"" AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""customer_id"",""a"".""product_id"") AS ""tab3"" ON ""tab2"".""frequency""=""tab3"".""time"" AND ""tab2"".""customer_id""=""tab3"".""customer_id"" GROUP BY ""tab2"".""customer_id"",""tab3"".""product_id"",""tab3"".""product_name"""
411,"WITH ""t"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""temp"" FROM ""Orders"") SELECT DISTINCT ""customer_id"",""t"".""product_id"",""product_name"" FROM ""t"" JOIN ""Products"" AS ""P"" ON ""t"".""product_id""=""P"".""product_id"" WHERE ROW(""customer_id"",""temp"") IN (SELECT DISTINCT ""customer_id"",MAX(""temp"") OVER (PARTITION BY ""customer_id"") FROM ""t"")"
412,"WITH ""OC"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""count_product"" FROM ""Orders"" AS ""O1"" GROUP BY ""customer_id"",""product_id"") SELECT ""OC3"".""customer_id"",""OC3"".""product_id"",""P"".""product_name"" FROM (SELECT ""OC"".""customer_id"",""Oc"".""product_id"" FROM ""OC"" LEFT JOIN (SELECT MAX(""count_product"") AS ""max_count_product"",""customer_id"",""product_id"" FROM ""OC"" GROUP BY ""customer_id"") AS ""OC2"" ON ""OC"".""customer_id""=""OC2"".""customer_id"" WHERE ""OC"".""count_product""=""OC2"".""max_count_product"") AS ""OC3"" LEFT JOIN ""products"" AS ""P"" ON ""OC3"".""product_id""=""P"".""product_id"""
413,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_order"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id""), ""max_order"" AS (SELECT ""customer_id"",MAX(""num_order"") AS ""max_order"" FROM ""temp"" GROUP BY ""customer_id"" ORDER BY ""customer_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (""temp"" AS ""a"" JOIN ""max_order"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""num_order""=""b"".""max_order"") LEFT JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"""
414,"SELECT ""b"".""customer_id"",""b"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""a"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cntt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cntt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"") AS ""b"" WHERE ""rnk""=1"
415,"SELECT ""customer_id"",""t2"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""r_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""product_count"" FROM ""orders"" GROUP BY 1,2) AS ""t1"") AS ""t2"" JOIN ""products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"" WHERE ""t2"".""r_rank""=1"
416,"WITH ""r1"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) SELECT ""r1"".""customer_id"",""r1"".""product_id"",""p"".""product_name"" FROM ""r1"" LEFT JOIN ""products"" AS ""p"" ON ""r1"".""product_id""=""p"".""product_id"" WHERE ""r1"".""rnk""=1"
417,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk1"" FROM ""orders"" GROUP BY 1,2) AS ""t"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""rnk1""=1"
418,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
419,"SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num"",""product_name"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""num""=1"
420,"WITH ""count_products"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cp"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""x"".""customer_id"",""x"".""product_id"",""x"".""product_name"" FROM (SELECT ""cp"".""customer_id"",""cp"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""cp"".""customer_id"" ORDER BY ""cp"".""cp"" DESC) AS ""rank_count"" FROM ""count_products"" AS ""cp"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""cp"".""product_id"") AS ""x"" WHERE ""x"".""rank_count""=1"
421,"SELECT ""sq"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""sq"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""sq"".""order_rank""=1"
422,"SELECT ""most_buy_1"".""customer_id"",""most_buy_1"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""most_buy"" FROM ""Orders"" AS ""o"" GROUP BY 1,2 ORDER BY 1) AS ""most_buy_1"" JOIN ""Products"" AS ""p"" ON ""most_buy_1"".""product_id""=""p"".""product_id"" WHERE ""most_buy""=1"
423,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ((SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY 1,2) AS ""a"" JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"") JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""rk""=1 ORDER BY 1,2"
424,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""ct"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ""cte"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""cte"".""product_id"" WHERE ""rk""=1"
425,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""order_rank"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""tbl"" WHERE ""order_rank""=1"
426,"WITH ""A"" AS (SELECT ""customer_id"",""Orders"".""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id""), ""B"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(1) AS ""ct"" FROM ""A"" GROUP BY ""customer_id"",""product_id"",""product_name""), ""C"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rks"" FROM ""B"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""C"" WHERE ""rks""=1"
427,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"", ""o"".""product_id"" ORDER BY ""o"".""order_date"") AS ""rn"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" WHERE ""rn""=(SELECT MAX(""rn"") FROM ""t"" AS ""t2"" WHERE ""t2"".""customer_id""=""t"".""customer_id"")"
428,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""Orders"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rk"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY 1,2) AS ""SUB"" WHERE ""rk""=1"
429,"SELECT ""t3"".""customer_id"",""t3"".""product_id"",""R"".""product_name"" FROM (SELECT ""t1"".""id1"" AS ""customer_id"",""t1"".""id2"" AS ""product_id"",""t1"".""mycount"" FROM (SELECT ""o1"".""customer_id"" AS ""id1"",""o1"".""product_id"" AS ""id2"",COUNT(""o1"".""order_id"") AS ""mycount"" FROM ""Orders"" AS ""o1"" GROUP BY ""o1"".""customer_id"",""o1"".""product_id"") AS ""t1"", ""Customers"" AS ""C"" WHERE ""t1"".""id1""=""C"".""customer_id"" HAVING ""t1"".""mycount""=(SELECT MAX(""t2"".""mycount1"") FROM (SELECT ""o2"".""customer_id"" AS ""id3"",""o2"".""product_id"" AS ""id4"",COUNT(""o2"".""order_id"") AS ""mycount1"" FROM ""Orders"" AS ""o2"" GROUP BY ""o2"".""customer_id"",""o2"".""product_id"") AS ""t2"" WHERE ""t2"".""id3""=""t1"".""id1"")) AS ""t3"", ""Products"" AS ""R"" WHERE ""t3"".""product_id""=""R"".""product_id"""
430,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""a"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
431,"SELECT ""customer_id"",""products"".""product_id"",""products"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",""order_count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""order_counts"") AS ""order_counts_ranked"" JOIN ""products"" ON ""order_counts_ranked"".""product_id""=""products"".""product_id"" WHERE ""r""=1"
432,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ((SELECT ""customer_id"",MAX(""cnt"") AS ""mf"" FROM ""cte"" GROUP BY ""customer_id"") AS ""a"" JOIN ""cte"" ON ""a"".""customer_id""=""cte"".""customer_id"" AND ""a"".""mf""=""cte"".""cnt"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""cte"".""product_id"""
433,"WITH ""x"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""Rank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""c"" WHERE ""c"".""Rank""=1) SELECT ""x"".""customer_id"",""x"".""product_id"",""p"".""product_name"" FROM ""x"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""x"".""product_id"""
434,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""rnk""=1 ORDER BY ""o"".""customer_id"",""o"".""product_id"""
435,"SELECT ""B"".""customer_id"",""B"".""product_id"",""Products"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranking"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""B"" JOIN ""Products"" ON ""B"".""product_id""=""Products"".""product_id"" AND ""B"".""ranking""=1"
436,"WITH ""cte"" AS (SELECT ""product_id"",""customer_Id"",COUNT(DISTINCT ""order_date"") AS ""cnt"" FROM ""orders"" GROUP BY 1,2), ""cte2"" AS (SELECT * FROM (SELECT ""customer_Id"",""product_id"",""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") AS ""cte"" WHERE ""rnk""=1) SELECT ""cte2"".""customer_id"",""cte2"".""product_id"",""Products"".""product_name"" FROM ""cte2"" LEFT JOIN ""Products"" ON ""products"".""product_id""=""cte2"".""product_id"""
437,"SELECT ""s"".""customer_id"",""s"".""product_id"",""s"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""s"".""rnk""=1"
438,"WITH ""a"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",COUNT(""o"".""product_id"") AS ""cnt"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") SELECT ""tmp"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ((SELECT ""customer_id"",MAX(""cnt"") AS ""cnt"" FROM ""a"" GROUP BY ""customer_id"") AS ""tmp"" JOIN ""a"" ON ""tmp"".""customer_id""=""a"".""customer_id"" AND ""tmp"".""cnt""=""a"".""cnt"") JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"""
439,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""t"".""rnk""=1"
440,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""frequency"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""cte1"" AS (SELECT ""customer_id"",""product_id"",""frequency"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""frequency"" DESC) AS ""r"" FROM ""cte"") SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t2"".""product_name"" FROM ""cte1"" AS ""t1"" LEFT JOIN ""products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""r""=1 ORDER BY ""t1"".""customer_id"",""t1"".""product_id"""
441,"WITH ""cte"" AS (WITH ""cte"" AS (SELECT DISTINCT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",""c"".""name"",COUNT(""o"".""order_id"") OVER (PARTITION BY ""p"".""product_id"", ""c"".""customer_id"") AS ""cnt"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" ORDER BY ""customer_id"") SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
442,"SELECT ""B"".""customer_id"",""B"".""product_id"",""P"".""product_name"" FROM (SELECT ""A"".""customer_id"",""A"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""A"".""customer_id"" ORDER BY ""tot"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""tot"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id"") AS ""A"") AS ""B"" JOIN ""Products"" AS ""P"" ON ""B"".""product_id""=""p"".""product_id"" WHERE ""ranking""=1"
443,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""order_rank""=1"
444,"SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM (SELECT ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"",""P"".""PRODUCT_NAME"",""FREQ"",RANK() OVER (PARTITION BY ""O"".""CUSTOMER_id"" ORDER BY ""O"".""CUSTOMER_id"",""FREQ"" DESC) AS ""RNK"" FROM (SELECT ""O"".""CUSTOMER_ID"",""O"".""PRODUCT_ID"",COUNT(1) AS ""FREQ"" FROM ""ORDERS"" AS ""O"" GROUP BY ""O"".""CUSTOMER_id"",""O"".""PRODUCT_ID"") AS ""O"" LEFT JOIN ""PRODUCTS"" AS ""P"" ON ""O"".""PRODUCT_ID""=""P"".""PRODUCT_ID"") AS ""RES"" WHERE ""RNK""=1"
445,"WITH ""temp"" AS (SELECT ""product_id"",""customer_id"",COUNT(""customer_id"") AS ""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""customer_id"") DESC) AS ""r_num"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""temp"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN ""temp"" ON ""p"".""product_id""=""temp"".""product_id"" WHERE ""r_num""=1 GROUP BY 1,2 ORDER BY 1"
446,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
447,"SELECT ""customer_id"",""aa"".""product_id"",""bb"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""num"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" WHERE ""b"".""rank""=1) AS ""aa"", ""products"" AS ""bb"" WHERE ""aa"".""product_id""=""bb"".""product_id"""
448,"SELECT ""tab"".""customer_id"",""tab"".""product_id"",""p"".""product_name"" FROM (SELECT ""t"".""customer_id"",""t"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""t"".""customer_id"" ORDER BY ""t"".""Freq"" DESC) AS ""Rank"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",COUNT(1) AS ""Freq"" FROM ""Orders"" AS ""O"" GROUP BY ""O"".""customer_id"",""O"".""product_id"") AS ""t"") AS ""tab"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""tab"".""product_id"" WHERE ""tab"".""Rank""=1"
449,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""r"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""r""=1"
450,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""ct"" FROM ((""Orders"" AS ""o"") JOIN ""Customers"" AS ""c"") JOIN ""Products"" AS ""p"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""t"") AS ""t2"" WHERE ""rk""=1"
451,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
452,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM (""Customers"" AS ""c"" JOIN ""cte"") JOIN ""Products"" AS ""p"" ON ""cte"".""customer_id""=""c"".""customer_id"" AND ""cte"".""product_id""=""p"".""product_id"" WHERE ""cte"".""rnk""=1 GROUP BY ""cte"".""customer_id"",""cte"".""product_id"""
453,"SELECT ""temp"".""customer_id"",""temp"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""rk""=1"
454,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id""),DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""Products"".""product_name"" FROM ""cte"" LEFT JOIN ""Products"" ON ""cte"".""product_id""=""Products"".""product_id"" WHERE ""cte"".""rnk""=1"
455,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""r"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" JOIN ""Products"" AS ""b"" USING (""product_id"") WHERE ""a"".""r""=1"
456,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""frequency"" FROM ""Orders"" GROUP BY 1,2) SELECT ""order_frequency"".""customer_id"",""order_frequency"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""order_frequency"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""order_frequency"".""product_id"" WHERE ROW(""order_frequency"".""customer_id"",""order_frequency"".""frequency"") IN (SELECT ""c"".""customer_id"",MAX(""c"".""frequency"") FROM ""cte"" AS ""c"" GROUP BY 1)"
457,"WITH ""c_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""c_max"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""cnt"" FROM ""c_cnt"" GROUP BY 1) SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM (""c_cnt"" AS ""c"" JOIN ""c_max"" AS ""m"" USING (""customer_id"",""cnt"")) JOIN ""products"" AS ""p"" USING (""product_id"") ORDER BY 1"
458,"WITH ""order_counts"" AS (SELECT ""o"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) SELECT ""oc"".""customer_id"",""oc"".""product_id"",""oc"".""product_name"" FROM ""order_counts"" AS ""oc"" WHERE ""oc"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_counts"" AS ""x"" WHERE ""x"".""customer_id""=""oc"".""customer_id"")"
459,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""TT"".""customer_id"",""TT"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""grouped_cnt"") AS ""TT"" LEFT JOIN ""Products"" AS ""P"" ON ""TT"".""product_id""=""P"".""product_id"" WHERE ""TT"".""rnk""=1"
460,"SELECT ""t3"".""customer_id"",""t3"".""product_id"",""p"".""product_name"" FROM ((SELECT ""t1"".""customer_id"",MAX(""t1"".""ct_order"") AS ""max_num"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ct_order"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"" GROUP BY ""t1"".""customer_id"") AS ""t2"" JOIN (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ct_order"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t3"" ON ""t2"".""customer_id""=""t3"".""customer_id"" AND ""t2"".""max_num""=""t3"".""ct_order"") JOIN ""products"" AS ""p"" ON ""t3"".""product_id""=""p"".""product_id"""
461,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1,2,3) AS ""t1"" WHERE ""rnk""=1"
462,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""mcnt"" FROM ""cte1"" GROUP BY ""customer_id""), ""cte3"" AS (SELECT ""c1"".""customer_id"",""c1"".""product_id"" FROM ""cte1"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""customer_id""=""c2"".""customer_id"" AND ""c1"".""cnt""=""c2"".""mcnt"") SELECT ""c3"".""customer_id"",""c3"".""product_id"",""p"".""product_name"" FROM ""cte3"" AS ""c3"" JOIN ""Products"" AS ""p"" ON ""c3"".""product_id""=""p"".""product_id"""
463,"SELECT ""a"".""customer_id"",""a"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
464,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""freq""=1"
465,"SELECT ""sub"".""customer_id"",""sub"".""product_id"",""sub"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rank_count"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""sub"" WHERE ""sub"".""rank_count""=1 ORDER BY ""sub"".""customer_id"",""sub"".""product_id"""
466,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ""cte"" LEFT JOIN ""products"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
467,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""order_rank""=1"
468,"WITH ""tab"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(""p"".""product_name"") OVER (PARTITION BY ""c"".""customer_id"", ""p"".""product_id"") AS ""mk"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""o"".""product_id"") SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM ""tab"" AS ""x"" WHERE ""x"".""mk"">=ALL (SELECT ""y"".""mk"" FROM ""tab"" AS ""y"" WHERE ""x"".""customer_id""=""y"".""customer_id"")"
469,"WITH ""cst_prod_ct"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_orders"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""rk"" FROM ""cst_prod_ct"") AS ""t"" JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rk""=1"
470,"SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2) AS ""rnked"" WHERE ""rnk""=1"
471,"WITH ""cte1"" AS (SELECT ""c"".""customer_id"" AS ""customer_id"",""p"".""product_id"" AS ""product_id"",COUNT(1) AS ""counts"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""p"".""product_id""), ""cte2"" AS (SELECT ""customer_id"",MAX(""counts"") AS ""max_counts"" FROM ""cte1"" GROUP BY ""customer_id"") SELECT ""cte1"".""customer_id"",""cte1"".""product_id"",""p"".""product_name"" FROM (""cte1"" JOIN ""cte2"" ON ""cte1"".""customer_id""=""cte2"".""customer_id"" AND ""cte1"".""counts""=""cte2"".""max_counts"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""cte1"".""product_id"""
472,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""cte"".""rnk""=1"
473,"SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(DISTINCT ""order_id"") DESC) AS ""rk"" FROM ""Orders"" GROUP BY 1,2) AS ""t1"" WHERE ""rk""=1) AS ""t2"" LEFT JOIN ""Products"" ON ""t2"".""product_id""=""Products"".""product_id"""
474,"SELECT ""t1"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""Products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""total"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""t1"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""r""=1"
475,"WITH ""tab"" AS (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",COUNT(""O"".""order_id"") AS ""CNT"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY 1,2,3), ""Frequent_ordered_product"" AS (SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"",RANK() OVER (PARTITION BY ""t"".""customer_id"" ORDER BY ""t"".""CNT"" DESC) AS ""RNK"" FROM ""tab"" AS ""t"") SELECT ""F"".""customer_id"",""F"".""product_id"",""F"".""product_name"" FROM ""Frequent_ordered_product"" AS ""F"" WHERE ""RNK""=1"
476,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",""c"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""rnk"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""c"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""x"") AS ""y"" WHERE ""rnk""=1"
477,"WITH ""CTE"" AS (SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",COUNT(""ORDER_ID"") AS ""PRODUCT_COUNT"" FROM ""ORDERS"" GROUP BY ""CUSTOMER_ID"",""PRODUCT_ID"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM (""CTE"" AS ""c"" JOIN (SELECT ""CUSTOMER_ID"",MAX(""PRODUCT_COUNT"") AS ""MAX_COUNT"" FROM ""CTE"" GROUP BY ""CUSTOMER_ID"") AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" AND ""c"".""product_count""=""t"".""max_count"") JOIN ""PRODUCTS"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"""
478,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" GROUP BY 1,2) AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""a"".""rnk""=1"
479,"SELECT ""customer_id"",""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_id"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
480,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""counts"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT *,MAX(""counts"") OVER (PARTITION BY ""customer_id"") AS ""max_counts"" FROM ""cte1"") SELECT ""customer_id"",""cte2"".""product_id"",""product_name"" FROM ""cte2"" JOIN ""Products"" ON ""cte2"".""product_id""=""Products"".""product_id"" WHERE ""max_counts""=""counts"""
481,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rn"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""c"" WHERE ""rn""=1"
482,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(""product_id"") AS ""num"",""product_id"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""tbl"".""customer_id"",""tbl"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rk"" FROM ""cte"") AS ""tbl"" JOIN ""Products"" AS ""p"" ON ""tbl"".""product_id""=""p"".""product_id"" WHERE ""tbl"".""rk""=1"
483,"WITH ""base"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""num_orders"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""num_order_rank"" FROM ""base"") AS ""t"" WHERE ""num_order_rank""=1"
484,"SELECT ""customer_id"",""T2"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""counts"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""T"") AS ""T2"" JOIN ""Products"" AS ""P"" ON ""T2"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
485,"WITH ""joined_source"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""num_orders"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id""), ""ranked_table"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""sales_rank"" FROM ""joined_source"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""ranked_table"" WHERE ""sales_rank""=1"
486,"SELECT ""t1"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""Products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""total"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""t1"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""r""=1"
487,"WITH ""a"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""num_orders"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""b"" AS (SELECT ""customer_id"",MAX(""num_orders"") AS ""max_num_orders"" FROM ""a"" GROUP BY ""customer_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""c"".""product_name"" FROM (""a"" JOIN ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""num_orders""=""b"".""max_num_orders"") JOIN ""products"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"""
488,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""total"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total"" DESC) AS ""rnk"" FROM ""cte1"") SELECT ""a"".""customer_id"",""b"".""product_id"",""b"".""product_name"" FROM ""cte2"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""rnk""=1"
489,"SELECT ""B"".""customer_id"",""B"".""product_id"",""Products"".""product_name"" FROM (SELECT ""A"".""customer_id"",""A"".""product_id"",RANK() OVER (PARTITION BY ""A"".""customer_id"" ORDER BY ""A"".""num"" DESC) AS ""RK"" FROM (SELECT DISTINCT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num"" FROM ""Orders"" GROUP BY 1,2) AS ""A"") AS ""B"" LEFT JOIN ""Products"" ON ""B"".""product_id""=""Products"".""product_id"" WHERE ""B"".""RK""=1"
490,"WITH ""t1"" AS (SELECT ""customer_id"",""orders"".""product_id"",""product_name"",COUNT(""orders"".""product_id""),RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""orders"".""product_id"") DESC) AS ""product_rank"" FROM ""orders"" LEFT JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""product_id"",""customer_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t1"" WHERE ""product_rank""=1"
491,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""d"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""temp"".""product_id"",""product_name"" FROM ""temp"" JOIN ""products"" ON ""temp"".""product_id""=""products"".""product_id"" WHERE ""d""=1"
492,"WITH ""frequency"" AS (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""num_orders"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(DISTINCT ""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2), ""most_freq"" AS (SELECT ""customer_id"",""product_id"" FROM ""frequency"" WHERE 1=1 AND ""rnk""=1) SELECT ""mf"".*,""p"".""product_name"" FROM ""most_freq"" AS ""mf"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""mf"".""product_id"""
493,"WITH ""temp"" AS (SELECT DISTINCT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT DISTINCT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""cnt""=1"
494,"WITH ""o_agg"" AS (SELECT ""o"".""customer_id"" AS ""cid"",""o"".""product_id"" AS ""pid"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id""), ""o_p_agg"" AS (SELECT ""cid"",""pid"",""cnt"",""p"".""product_name"" AS ""name"" FROM ""o_agg"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""pid""=""p"".""product_id""), ""ranked"" AS (SELECT ""cid"",""pid"",""name"",RANK() OVER (PARTITION BY ""cid"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""o_p_agg"") SELECT ""cid"" AS ""customer_id"",""pid"" AS ""product_id"",""name"" AS ""product_name"" FROM ""ranked"" WHERE ""rnk""=1"
495,"WITH ""main"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""fin"" WHERE ""rnk""=1) SELECT ""main"".""customer_id"",""main"".""product_id"",""p"".""product_name"" FROM ""main"" JOIN ""products"" AS ""p"" ON ""main"".""product_id""=""p"".""product_id"""
496,"SELECT ""tbl1"".""customer_id"",""tbl1"".""product_id"",""tbl2"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""tbl1"" JOIN ""Products"" AS ""tbl2"" ON ""tbl1"".""product_id""=""tbl2"".""product_id"" WHERE ""tbl1"".""order_rank""=1 ORDER BY ""tbl1"".""customer_id"""
497,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id""),DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""Products"".""product_name"" FROM ""cte"" LEFT JOIN ""Products"" ON ""cte"".""product_id""=""Products"".""product_id"" WHERE ""cte"".""rnk""=1"
498,"SELECT ""b"".""customer_id"",""b"".""product_id"",""c"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",""cnts"",MAX(""cnts"") OVER (PARTITION BY ""customer_id"") AS ""max_cnts"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnts"" FROM ""orders"" GROUP BY 1,2) AS ""a"") AS ""b"" LEFT JOIN ""products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" WHERE ""b"".""cnts""=""b"".""max_cnts"""
499,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""order_rank""=1"
500,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""products"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rk"" FROM ""orders"" JOIN ""products"" ON ""products"".""product_id""=""orders"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""a"".""rk""=1"
501,"SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
502,"WITH ""t"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""orders"" GROUP BY 1,2) SELECT ""t1"".""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM ""t"" AS ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" AND ""t1"".""ct"" IN (SELECT MAX(""ct"") FROM ""t"" AS ""t2"" WHERE ""t1"".""customer_id""=""t2"".""customer_id"")"
503,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT DISTINCT ""b"".""customer_id"",""product_id"" FROM (SELECT DISTINCT ""customer_id"",MAX(""count"") OVER (PARTITION BY ""customer_id"" ORDER BY ""customer_id"") AS ""max"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""customer_id"") OVER (PARTITION BY ""product_id"", ""customer_id"" ORDER BY ""customer_id"") AS ""count"" FROM ""orders"") AS ""a"") AS ""b"" JOIN (SELECT ""customer_id"",""product_id"",COUNT(""customer_id"") OVER (PARTITION BY ""product_id"", ""customer_id"" ORDER BY ""customer_id"") AS ""count"" FROM ""orders"") AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""max""=""c"".""count"") AS ""d"" ON ""p"".""product_id""=""d"".""product_id"""
504,"SELECT ""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"") AS ""a"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""rnk""=1"
505,"WITH ""prod"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""times"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""t"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""times"" DESC) AS ""rnk"" FROM ""prod"") SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rnk""=1"
506,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""cnt"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""t"".""cnt""=1"
507,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".""product_id"",""a"".""customer_id"",""b"".""product_name"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY COUNT(""a"".""product_id"") DESC) AS ""rank_id"" FROM ""Orders"" AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"",""a"".""product_id"") AS ""cte"" WHERE ""rank_id""=1 ORDER BY ""customer_id"",""product_id"""
508,"WITH ""a"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""c"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""r"" FROM ""a"") AS ""x"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""x"".""product_id"" WHERE ""x"".""r""=1"
509,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
510,"WITH ""CTE"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""product_name"",COUNT(""p"".""product_id"") AS ""counting"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""p"".""product_id"") DESC) AS ""order_freq"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""CTe"" WHERE ""order_freq""=1"
511,"WITH ""ct"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""ct"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""rnk""=1"
512,"WITH ""tmp"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""topOrder"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""tmp"" WHERE ""toporder""=1"
513,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_purch"" FROM ""orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""a"" JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""num_purch"" IN (SELECT MAX(""num_purch"") FROM ""cte"" AS ""b"" WHERE ""b"".""customer_id""=""a"".""customer_id"")"
514,"WITH ""s"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""tmp"".""count"" DESC) AS ""rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""count"" FROM ""orders"" GROUP BY 1,2 ORDER BY 1,3 DESC) AS ""tmp"") SELECT ""s"".""customer_id"",""s"".""product_id"",""p"".""product_name"" FROM ""s"" JOIN ""Products"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""s"".""rank""=1 ORDER BY 1,2"
515,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
516,"WITH ""odr"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""product_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ((""customers"" AS ""c"") JOIN ""odr"") JOIN ""products"" AS ""p"" WHERE ""c"".""customer_id""=""odr"".""customer_id"" AND ""odr"".""product_id""=""p"".""product_id"" AND ""odr"".""product_count""=1"
517,"SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""rnk""=1 ORDER BY 1,2"
518,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""order_rank""=1"
519,"WITH ""counter"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY 1,2), ""popular"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""pop"" FROM ""counter"" GROUP BY 1) SELECT ""a"".""customer_id"",""a"".""product_id"",""c"".""product_name"" FROM (""counter"" AS ""a"" JOIN ""popular"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""products"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"" WHERE ""a"".""cnt""=""b"".""pop"""
520,"WITH ""ct"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""ct"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""rnk""=1"
521,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""n_order"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""rk"" FROM (""customers"" AS ""c"" RIGHT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""a"" WHERE ""rk""=1"
522,"SELECT ""z"".""customer_id"",""z"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count1"" DESC) AS ""rnk"" FROM (SELECT *,COUNT(""product_id"") AS ""count1"" FROM ""orders"" GROUP BY ""product_id"",""customer_id"") AS ""t"") AS ""z"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""z"".""product_id"" WHERE ""z"".""rnk""=1"
523,"SELECT ""product_id"",""product_name"",""customer_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""p_count"" DESC) AS ""o_rank"" FROM (SELECT ""o"".""product_id"",""p"".""product_name"",""o"".""customer_id"",COUNT(""order_id"") AS ""p_count"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2,3) AS ""t1"") AS ""t2"" WHERE ""o_rank""=1"
524,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_Id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
525,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
526,"WITH ""cte"" AS (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rn"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rn""=1"
527,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ranks"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM ""cte"" WHERE ""ranks""=1) AS ""t"" JOIN ""products"" AS ""p"" USING (""product_id"")"
528,"WITH ""t"" AS (SELECT ""customer_id"",""orders"".""product_id"",""products"".""product_name"",COUNT(1) AS ""product_count"" FROM ""orders"" LEFT JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""customer_id"",""orders"".""product_id"") SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t1"".""product_name"" FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"" AND ""t1"".""product_count""<""t2"".""product_count"" WHERE ""t2"".""product_count"" IS NULL"
529,"WITH ""amount_purchased"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id""),RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ordered_rank"" FROM ""orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""amount_purchased"" AS ""a"" LEFT JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""a"".""ordered_rank""=1"
530,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"",MAX(COUNT(1)) OVER (PARTITION BY ""customer_id"") AS ""max_cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" AND ""t"".""cnt""=""t"".""max_cnt"""
531,"SELECT ""customer_id"",""t1"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""t"") AS ""t1"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t1"".""product_id"" WHERE ""rn""=1"
532,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" WHERE ""rk""=1"
533,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""RK"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""RK""=1"
534,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_total"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""order_total"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1,2) AS ""a"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ""cte"" JOIN ""Products"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE ""cte"".""rnk""=1"
535,"WITH ""order_count"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""nums"" FROM ""Orders"" GROUP BY 1,2 ORDER BY ""customer_id""), ""max_order"" AS (SELECT ""customer_id"",""product_id"",""nums"" FROM ""order_count"" WHERE ROW(""customer_id"",""nums"") IN (SELECT ""customer_id"",MAX(""nums"") FROM ""order_count"" GROUP BY ""customer_id"")) SELECT ""max_order"".""customer_id"",""max_order"".""product_id"",""Products"".""product_name"" FROM ""max_order"" JOIN ""Products"" ON ""max_order"".""product_id""=""Products"".""product_id"""
536,"WITH ""CTE1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""CTE1"" AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"") WHERE ""rk""=1"
537,"WITH ""ords"" AS (SELECT ""a"".""customer_id"",""b"".""product_id"",""c"".""product_name"",COUNT(1) AS ""cnt"" FROM (""customers"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" WHERE ""b"".""product_id"" IS NOT NULL GROUP BY 1,2,3 HAVING COUNT(1)>=1), ""rn"" AS (SELECT ""customer_id"",""product_id"",""product_name"",""cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""ords"" AS ""a"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""rn"" WHERE ""rnk""=1"
538,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""no_orders"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""req_rank"" FROM ""orders"" GROUP BY 1,2) SELECT ""cte1"".""customer_id"",""cte1"".""product_id"",""p"".""product_name"" FROM ""cte1"" JOIN ""products"" AS ""p"" ON ""cte1"".""product_id""=""p"".""product_id"" WHERE ""cte1"".""req_rank""=1 ORDER BY 1"
539,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
540,"SELECT ""temp"".""customer_id"",""temp"".""product_id"",""Products"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY 1,2) AS ""temp"" JOIN ""Products"" ON ""temp"".""product_id""=""Products"".""product_id"" WHERE ""temp"".""rnk""=1"
541,"SELECT ""b"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""quantity"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""quantity"" FROM ""Orders"" GROUP BY 1,2) AS ""a"") AS ""b"" JOIN ""products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" WHERE ""b"".""rk""=1"
542,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""prdrank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""prdrank""=1"
543,"SELECT ""customer_id"",""t"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""s"") AS ""t"" JOIN ""products"" ON ""products"".""product_id""=""t"".""product_id"" WHERE ""ranking""=1"
544,"WITH ""cte"" AS (SELECT ""product_id"",""customer_id"",COUNT(""order_date"") AS ""total"" FROM ""orders"" GROUP BY 1,2), ""cte2"" AS (SELECT ""product_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total"" DESC) AS ""total_rank"" FROM ""cte"") SELECT ""a"".""product_id"",""a"".""customer_id"",""product_name"" FROM ""cte2"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""total_rank""=1"
545,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""a"" JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
546,"SELECT ""TT"".""customer_id"",""TT"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""TT"" LEFT JOIN ""Products"" AS ""P"" ON ""TT"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
547,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(1) OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""count"" FROM ""Orders"" AS ""O"" JOIN ""Products"" USING (""product_id"")) SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,MAX(""count"") OVER (PARTITION BY ""customer_id"") AS ""max_count"" FROM ""cte"") AS ""T"" WHERE ""count""=""max_count"""
548,"WITH ""agg_orders"" AS (SELECT DISTINCT ""customer_id"",""product_id"",COUNT(""order_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""total_orders"" FROM ""Orders"") SELECT ""customer_id"",""t1"".""product_id"",""product_name"" FROM (SELECT * FROM ""agg_orders"" WHERE ROW(""customer_id"",""total_orders"") IN (SELECT ""customer_id"",MAX(""total_orders"") FROM (SELECT * FROM ""agg_orders"") AS ""t1"" GROUP BY ""customer_id"")) AS ""t1"" LEFT JOIN ""Products"" ON ""t1"".""product_id""=""Products"".""product_id"""
549,"WITH ""ranks"" AS (SELECT ""n"".""customer_id"",""n"".""product_id"",""n"".""num"",DENSE_RANK() OVER (PARTITION BY ""n"".""customer_id"" ORDER BY ""n"".""num"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num"" FROM ""Orders"" GROUP BY 1,2) AS ""n"") SELECT ""r"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""ranks"" AS ""r"" JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""rnk""=1"
550,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_rank""=1"
551,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(1)) IN (SELECT ""sub"".""customer_id"",MAX(""sub"".""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""sub"" GROUP BY ""customer_id"")"
552,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
553,"WITH ""base"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""b"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""base"" AS ""b"" JOIN ""Products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" AND ""rnk""=1"
554,"SELECT ""t1"".""customer_id"",""t1"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""r"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"" LEFT JOIN ""products"" ON ""products"".""product_id""=""t1"".""product_id"" WHERE ""t1"".""r""=1"
555,"SELECT ""T"".""customer_id"",""T"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rn"" FROM ""Orders"" AS ""O"" GROUP BY ""customer_id"",""product_id"") AS ""table1"" WHERE ""rn""=1) AS ""T"" JOIN ""Products"" AS ""P"" ON ""T"".""product_id""=""P"".""product_id"""
556,"SELECT ""b"".""customer_id"" AS ""customer_id"",""b"".""product_id"" AS ""product_id"",""p"".""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",RANK() OVER (PARTITION BY ""a"".""a"".""customer_id"" ORDER BY ""a"".""ordercount"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""ordercount"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""b"".""rk""=1"
557,"WITH ""product_ranks"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""o"" GROUP BY ""customer_id"",""product_id""), ""top"" AS (SELECT * FROM ""product_ranks"" WHERE ""rnk""=1) SELECT ""t"".""customer_id"",""t"".""product_id"",""product_name"" FROM ""top"" AS ""t"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"""
558,"WITH ""TEMP"" AS (SELECT ""C"".""CUSTOMER_ID"" AS ""CUSTOMER_ID"",""P"".""PRODUCT_ID"" AS ""PRODUCT_ID"",""P"".""PRODUCT_NAME"" AS ""PRODUCT_NAME"",COUNT(1) AS ""CNT"" FROM ((""CUSTOMERS"" AS ""C"") JOIN ""ORDERS"" AS ""O"") JOIN ""PRODUCTS"" AS ""P"" WHERE ""C"".""CUSTOMER_ID""=""O"".""CUSTOMER_ID"" AND ""O"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" GROUP BY ""C"".""CUSTOMER_ID"",""P"".""PRODUCT_ID"",""P"".""PRODUCT_NAME""), ""TEMP2"" AS (SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"",RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""CNT"" DESC) AS ""RNK"" FROM ""TEMP"") SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM ""TEMP2"" WHERE ""RNK""=1"
559,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ranks"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"" WHERE ""ranks""=1) AS ""t2"" JOIN ""products"" AS ""p"" USING (""product_id"")"
560,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
561,"SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1),RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""r"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""t"" WHERE ""t"".""r""=1"
562,"WITH ""customer_products_count"" AS (SELECT COUNT(""product_id"") AS ""product_count"",""customer_id"",""product_id"" FROM ""Orders"" GROUP BY 2,3) SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""product_rank"" FROM ""customer_products_count"") AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""product_rank""=1"
563,"SELECT ""f"".""customer_id"",""f"".""product_id"",""g"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""freq"",MAX(COUNT(1)) OVER (PARTITION BY ""customer_id"") AS ""max_freq"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""f"" LEFT JOIN ""products"" AS ""g"" ON ""f"".""product_id""=""g"".""product_id"" WHERE ""f"".""freq""=""f"".""max_freq"""
564,"SELECT ""p"".""customer_id"",""p"".""product_id"",""n"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""dn"" FROM ""orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""p"", ""products"" AS ""n"" WHERE ""p"".""product_id""=""n"".""product_id"" AND ""p"".""dn""=1"
565,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""Products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
566,"WITH ""x"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_of_orders"" DESC) AS ""rn"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_of_orders"" FROM ""orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" WHERE ""rn""=1) SELECT ""a"".*,""p"".""product_name"" FROM ""x"" AS ""a"" JOIN ""products"" AS ""p"" USING (""product_id"")"
567,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"", ""Products"" AS ""b"" WHERE ""a"".""rnk""=1 AND ""a"".""product_id""=""b"".""product_id"" ORDER BY ""a"".""customer_id"",""a"".""product_id"""
568,"SELECT ""b"".""customer_id"" AS ""customer_id"",""b"".""product_id"" AS ""product_id"",""c"".""product_name"" AS ""product_name"" FROM (SELECT ""customer_id"",""Product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""drank"" FROM (SELECT ""customer_id"",""Product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""Product_id"" ORDER BY ""Customer_id"") AS ""a"") AS ""b"" JOIN ""Products"" AS ""c"" ON ""b"".""Product_id""=""c"".""Product_id"" WHERE ""b"".""drank""=1"
569,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""b"" WHERE ""b"".""customer_id""=""c"".""customer_id"")"
570,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM ""cte2"" AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
571,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""product_count"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""temp1"" WHERE ""product_count""=1 ORDER BY ""customer_id"",""product_id"""
572,"WITH ""t_num"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""num_product"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""t_num"" AS ""t"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ROW(""t"".""customer_id"",""t"".""num_product"") IN (SELECT ""customer_id"",MAX(""num_product"") AS ""max_product"" FROM ""t_num"" GROUP BY ""customer_id"")"
573,"SELECT DISTINCT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",""cnt"",MAX(""cnt"") OVER (PARTITION BY ""customer_id"") AS ""mx"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""cnt"" FROM ""orders"") AS ""o"") AS ""oo"" ON ""oo"".""product_id""=""p"".""product_id"" WHERE ""cnt""=""mx"" ORDER BY 1,2"
574,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""Orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"")) JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY 1,2) AS ""a"" WHERE ""a"".""rnk""=1"
575,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""rank_p""=1"
576,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count_order"" DESC) AS ""rank_order"" FROM (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(DISTINCT ""o"".""order_date"") AS ""count_order"" FROM ""Orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"") AS ""t1"") AS ""t2"" WHERE ""rank_order""=1"
577,"SELECT ""customer_id"",""A"".""product_id"" AS ""product_id"",""product_name"" FROM (SELECT ""customer_id"",""prod"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""prod_rank"" FROM (SELECT ""cust"".""customer_id"" AS ""customer_id"",""ord"".""product_id"" AS ""product_id"",COUNT(""product_id"") AS ""product_count"" FROM ""Customers"" AS ""cust"" JOIN ""Orders"" AS ""ord"" ON ""cust"".""customer_id""=""ord"".""customer_id"" GROUP BY ""customer_id"",""product_id"") AS ""prodA"" JOIN ""Products"" AS ""prod"" ON ""prod"".""product_id""=""prodA"".""product_id"") AS ""A"" WHERE ""prod_rank""=1"
578,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""order_ranking"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""ranking_tmp"" WHERE ""order_ranking""=1"
579,"WITH ""CustOrders"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""ordCnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranks"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""CustOrders"" AS ""c"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""ranks""=1"
580,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rank_p"",""product_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"" ORDER BY ""customer_id"") AS ""t"" WHERE ""rank_p""=1"
581,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",""prdcnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""prdcnt"" DESC) AS ""crank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""prdcnt"" FROM ""orders"" GROUP BY 1,2) AS ""a"") AS ""a"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""crank""=1"
582,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""cte_rk"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"" FROM ""cte"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte_rk"" AS ""c"" JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""rk""=1"
583,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
584,"SELECT ""t2"".""customer_id"",""t2"".""product_id"",""p"".""product_name"" FROM (SELECT DISTINCT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""n_order"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t2"" LEFT JOIN ""Products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"" WHERE ROW(""t2"".""customer_id"",""t2"".""n_order"") IN (SELECT DISTINCT ""customer_id"",MAX(""n_order"") AS ""max_order"" FROM (SELECT DISTINCT ""customer_id"",COUNT(DISTINCT ""order_id"") AS ""n_order"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" GROUP BY ""customer_id"")"
585,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank_p"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") AS ""a"" WHERE ""a"".""rank_p""=1"
586,"WITH ""r"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""r"".""customer_id"",""r"".""product_id"",""p"".""product_name"" FROM ""r"" JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""rnk""=1"
587,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""counts"" FROM ""Orders"" GROUP BY 1,2) SELECT ""T"".""customer_id"",""T"".""product_id"",""P"".""product_name"" FROM ""Products"" AS ""P"" RIGHT JOIN (SELECT ""customer_id"",""product_id"" FROM ""temp"" WHERE ROW(""customer_id"",""counts"") IN (SELECT ""customer_id"",MAX(""counts"") FROM ""temp"" GROUP BY 1)) AS ""T"" ON ""P"".""product_id""=""T"".""product_id"""
588,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rn"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""Products"" AS ""p"" JOIN ""cte"" AS ""c"" ON ""p"".""product_id""=""c"".""product_id"" WHERE ""rn""=1"
589,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
590,"SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY COUNT(""a"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""t"".""rnk""=1 ORDER BY ""customer_id"",""product_id"""
591,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""C"".""customer_id"",""C"".""product_id"",""P"".""product_name"" FROM ""cte"" AS ""C"" JOIN ""Products"" AS ""P"" ON ""C"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
592,"WITH ""data_needed"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""num_orders"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""t"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""data_needed"" WHERE ""ranking""=1"
593,"WITH ""count_max"" AS (SELECT ""c"".""customer_id"",""c"".""product_id"" FROM (SELECT ""customer_id"",MAX(""count"") AS ""max_count"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"") AS ""b"" JOIN (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""max_count""=""c"".""count"" ORDER BY ""c"".""customer_id"") SELECT ""m"".""customer_id"",""m"".""product_id"",""product_name"" FROM ""count_max"" AS ""m"" JOIN ""products"" AS ""p"" ON ""m"".""product_id""=""p"".""product_id"""
594,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""orders"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" JOIN ""Products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""rnked"" WHERE ""rnk""=1 ORDER BY 1,2"
595,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM ""grouped_cnt"" AS ""a"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") AS ""cnt"" FROM ""grouped_cnt"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
596,"SELECT ""t"".""customer_id"",""t"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""prank"" FROM ""orders"" GROUP BY 1,2) AS ""t"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""prank""=1"
597,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_id"" HAVING ROW(""o"".""customer_id"",COUNT(""o"".""order_id"")) IN (SELECT ""customer_id"",MAX(""order_n"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_n"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""sub_x"" GROUP BY ""customer_id"")"
598,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""num_bought"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3), ""cte_2"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_bought"" DESC) AS ""ranked_products"" FROM ""cte"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""CTE_2"" WHERE ""ranked_products""=1"
599,"WITH ""new"" AS (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""ranks"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""a"") AS ""b"" WHERE ""ranks""=1) SELECT ""customer_id"",""new"".""product_id"",""product_name"" FROM ""new"" JOIN ""products"" AS ""p"" ON ""new"".""product_id""=""p"".""product_id"""
600,"WITH ""odr"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""product_count"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""odr"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (""odr"") JOIN ""products"" AS ""p"" WHERE ""odr"".""product_id""=""p"".""product_id"" AND ""odr"".""product_count""=1"
601,"WITH ""frequency"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""freq"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""max_frequency"" AS (SELECT ""customer_id"",MAX(""freq"") AS ""max_freq"" FROM ""frequency"" GROUP BY ""customer_id""), ""res"" AS (SELECT ""fq"".""customer_id"",""fq"".""product_id"" FROM ""frequency"" AS ""fq"" JOIN ""max_frequency"" AS ""mxfq"" ON ""fq"".""customer_id""=""mxfq"".""customer_id"" AND ""fq"".""freq""=""mxfq"".""max_freq"") SELECT ""rs"".""customer_id"",""rs"".""product_id"",""pr"".""product_name"" FROM ""res"" AS ""rs"" JOIN ""Products"" AS ""pr"" ON ""rs"".""product_id""=""pr"".""product_id"""
602,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""RNK"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" JOIN ""Products"" USING (""product_id"") WHERE ""RNK""=1"
603,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""t1"".""product_id"",""p"".""product_name"" FROM ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" AND ""rnk""=1"
604,"SELECT ""t2"".""customer_id"",""t2"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""purchase_times"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""purchase_times"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"") AS ""t2"" JOIN ""products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"" WHERE ""t2"".""ranking""=1"
605,"SELECT ""c"".""customer_id"",""c"".""product_id"",""e"".""product_name"" FROM (SELECT ""b"".""customer_id"",""b"".""product_id"" FROM (SELECT ""a"".*,RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""frequent"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""frequent"" FROM ""orders"" GROUP BY 1,2 ORDER BY 1,2) AS ""a"") AS ""b"" WHERE ""b"".""rk""=1) AS ""c"" JOIN ""products"" AS ""e"" ON ""c"".""product_id""=""e"".""product_id"""
606,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""e"".""product_id"",""e"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM ""grouped_cnt"" AS ""a"") AS ""b"" WHERE ""b"".""rn""=1) AS ""c"" LEFT JOIN ""products"" AS ""e"" ON ""e"".""product_id""=""c"".""product_id"""
607,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""cts_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""counts"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" ORDER BY 1,3) SELECT ""temp"".""customer_id"",""temp"".""product_id"",""Products"".""product_name"" FROM ""temp"" LEFT JOIN ""Products"" ON ""temp"".""product_id""=""Products"".""product_id"" WHERE ""temp"".""cts_rank""=1 ORDER BY ""temp"".""customer_id"",""temp"".""product_id"""
608,"WITH ""product_orders_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(0) AS ""ordered"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") SELECT ""p1"".""customer_id"",""p1"".""product_id"",""p"".""product_name"" FROM ""product_orders_cnt"" AS ""p1"" JOIN ""Products"" AS ""p"" ON ""p1"".""product_id""=""p"".""product_id"" WHERE ""ordered""=(SELECT MAX(""ordered"") FROM ""product_orders_cnt"" AS ""p2"" WHERE ""p1"".""customer_id""=""p2"".""customer_id"")"
609,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM ""orders"" JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""a"".""customer_id"",MAX(""a"".""times"") AS ""max_time"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""times"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""a"".""customer_id"")"
610,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""temp"" WHERE ""ranking""=1"
611,"SELECT ""mf"".""customer_id"",""mf"".""product_id"",""p"".""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""freq"") AS ""mf"" ON ""p"".""product_id""=""mf"".""product_id"" WHERE ""mf"".""rnk""=1"
612,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""product_count"" FROM ""Orders"" GROUP BY 1,2) AS ""tmp"") AS ""tmp2"" JOIN ""Products"" ON ""tmp2"".""product_id""=""products"".""product_id"" WHERE ""r""=1"
613,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""unit"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""unit"" FROM ""orders"" GROUP BY 1,2) AS ""o"") SELECT ""cte"".""customer_id"",""cte"".""product_id"",""product_name"" FROM ""cte"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""cte"".""product_Id"" WHERE ""cte"".""r""=1"
614,"SELECT ""sub"".""customer_id"",""sub"".""product_id"",""sub"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(""product_id""),RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" LEFT JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""sub"" WHERE ""sub"".""rnk""=1"
615,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num_purchase"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"" AS ""customer_id"",""t1"".""product_id"" AS ""product_id"",""t2"".""product_name"" FROM ""t1"" LEFT JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""num_purchase""=1"
616,"WITH ""temp"" AS (SELECT ""product_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""customer_id"") DESC) AS ""r_num"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""temp"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN ""temp"" ON ""p"".""product_id""=""temp"".""product_id"" WHERE ""r_num""=1 GROUP BY 1,2 ORDER BY 1"
617,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t2"".""product_name"" FROM ""cte"" AS ""t1"" JOIN ""Products"" AS ""t2"" USING (""product_id"") WHERE ""t1"".""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""t3"" WHERE ""t1"".""customer_id""=""t3"".""customer_id"")"
618,"WITH ""CET"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""NUM"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" HAVING COUNT(1)>0) SELECT ""customer_id"",""A"".""product_id"",""product_name"" FROM ""CET"" AS ""A"" JOIN ""Products"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" WHERE ROW(""customer_id"",""NUM"") IN (SELECT ""customer_id"",MAX(""NUM"") FROM ""CET"" GROUP BY ""customer_id"")"
619,"SELECT ""mf"".""customer_id"",""mf"".""product_id"",""p"".""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""freq"") AS ""mf"" ON ""p"".""product_id""=""mf"".""product_id"" WHERE ""mf"".""rnk""=1"
620,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
621,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",""try"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""try"" DESC) AS ""try2"" FROM (SELECT DISTINCT ""customer_id"",""o"".""product_id"",""product_name"",COUNT(""order_id"") OVER (PARTITION BY ""customer_id"", ""o"".""product_id"") AS ""try"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""A"") AS ""B"" WHERE ""try2""=1"
622,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""rnk""=1"
623,"SELECT ""r"".""customer_id"",""r"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""pr"" FROM ""Orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""r"" JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""pr""=1"
624,"SELECT ""b"".""customer_id"",""b"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""howmany"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""howmany"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""b"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""rk""=1"
625,"WITH ""cust_orderqty"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""qty"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""qty_rank"" FROM ""orders"" GROUP BY 1,2) SELECT ""x"".""customer_id"",""x"".""product_id"",""p"".""product_name"" FROM (SELECT ""c"".""customer_id"",""c"".""product_id"" FROM ""cust_orderqty"" AS ""c"" WHERE ""qty_rank""=1) AS ""x"" JOIN ""products"" AS ""p"" ON ""x"".""product_id""=""p"".""product_id"""
626,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""t"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""t"".""rank_p""=1"
627,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""co"" DESC) AS ""ran"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""co"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2 ORDER BY ""o"".""customer_id"") AS ""a"") AS ""b"" WHERE ""ran""=1"
628,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt_prod"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt_prod"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""cnt_prod"" DESC) AS ""abc"") SELECT ""customer_id"",""cte"".""product_id"",""p"".""product_name"" FROM ""cte"" JOIN ""Products"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
629,"WITH ""CTE"" AS (SELECT *,MAX(""product_cnt"") OVER (PARTITION BY ""Customer_id"") AS ""max_cnt"" FROM (SELECT ""Customer_id"",""product_id"",COUNT(""order_id"") OVER (PARTITION BY ""Customer_id"", ""product_id"") AS ""product_cnt"" FROM ""orders"") AS ""T"" ORDER BY ""customer_id"",""product_id"") SELECT DISTINCT ""customer_id"",""cte"".""product_id"",""product_name"" FROM ""CTE"" LEFT JOIN ""Products"" ON ""CTE"".""product_id""=""Products"".""product_id"" WHERE ""cte"".""max_cnt""=""cte"".""product_cnt"""
630,"SELECT ""co"".""customer_id"",""co"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""rnk"" DESC) AS ""co"" LEFT JOIN ""Products"" AS ""p"" ON ""co"".""product_id""=""p"".""product_id"" WHERE ""co"".""rnk""=1"
631,"SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""ranks"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""counts"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""counts"" DESC) AS ""a"") AS ""b"" LEFT JOIN ""Products"" AS ""p"" ON ""b"".""product_id""=""p"".""product_id"" WHERE ""ranks""=1 ORDER BY ""customer_id"",""b"".""product_id"""
632,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""CNT"" DESC) AS ""RNK"" FROM (SELECT ""customer_id"",""O1"".""product_id"",""product_name"",COUNT(""order_id"") AS ""CNT"" FROM ""Orders"" AS ""O1"" JOIN ""Products"" AS ""P1"" ON ""O1"".""product_id""=""P1"".""product_id"" GROUP BY 1,2) AS ""TEMP"") AS ""TEMP2"" WHERE ""RNK""=1"
633,"WITH ""t1"" AS (SELECT DISTINCT ""customer_id"",""product_id"",COUNT(""product_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""product_count"" FROM ""Orders"") SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t3"".""product_name"" FROM (""t1"" JOIN (SELECT ""t1"".""customer_id"",MAX(""t1"".""product_count"") AS ""max_count"" FROM ""t1"" GROUP BY ""t1"".""customer_id"") AS ""t2"" ON ""t2"".""customer_id""=""t1"".""customer_id"" AND ""t1"".""product_count""=""t2"".""max_count"") JOIN ""Products"" AS ""t3"" ON ""t1"".""product_id""=""t3"".""product_id"""
634,"WITH ""cts"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""highestproduct"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""Customers"".""customer_id"",""cts"".""product_id"",""Products"".""product_name"" FROM (""Customers"" LEFT JOIN ""cts"" ON ""Customers"".""customer_id""=""cts"".""customer_id"" AND ""cts"".""highestProduct""=1) JOIN ""Products"" ON ""cts"".""product_id""=""Products"".""product_id"""
635,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY COUNT(""a"".""product_id"") DESC) AS ""rnk"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""d"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
636,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") SELECT ""customer_id"",""cte2"".""product_id"",""product_name"" FROM ""cte2"" LEFT JOIN ""products"" AS ""p"" ON ""cte2"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
637,"WITH ""count_products"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cp"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""x"".""customer_id"",""x"".""product_id"",""x"".""product_name"" FROM (SELECT ""cp"".""customer_id"",""cp"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""cp"".""customer_id"" ORDER BY ""cp"".""cp"" DESC) AS ""rank_count"" FROM ""count_products"" AS ""cp"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""cp"".""product_id"") AS ""x"" WHERE ""x"".""rank_count""=1"
638,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""r"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" JOIN ""Products"" AS ""b"" USING (""product_id"") WHERE ""a"".""r""=1"
639,"WITH ""cust_orderqty"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""qty_rank"" FROM ""orders"" GROUP BY 1,2) SELECT ""x"".""customer_id"",""x"".""product_id"",""p"".""product_name"" FROM (SELECT ""c"".""customer_id"",""c"".""product_id"" FROM ""cust_orderqty"" AS ""c"" WHERE ""qty_rank""=1) AS ""x"" JOIN ""products"" AS ""p"" ON ""x"".""product_id""=""p"".""product_id"""
640,"SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count_id"" DESC) AS ""my_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""count_id"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""t1"" WHERE ""my_rank""=1) AS ""t2"" JOIN ""Products"" ON ""Products"".""product_id""=""t2"".""product_id"""
641,"WITH ""TEMP"" AS (SELECT ""C"".""CUSTOMER_ID"" AS ""CUSTOMER_ID"",""P"".""PRODUCT_ID"" AS ""PRODUCT_ID"",""P"".""PRODUCT_NAME"" AS ""PRODUCT_NAME"",COUNT(1) AS ""CNT"" FROM ((""CUSTOMERS"" AS ""C"") JOIN ""ORDERS"" AS ""O"") JOIN ""PRODUCTS"" AS ""P"" WHERE ""C"".""CUSTOMER_ID""=""O"".""CUSTOMER_ID"" AND ""O"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" GROUP BY ""C"".""CUSTOMER_ID"",""P"".""PRODUCT_ID"",""P"".""PRODUCT_NAME""), ""TEMP2"" AS (SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"",RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""CNT"" DESC) AS ""RNK"" FROM ""TEMP"") SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM ""TEMP2"" WHERE ""RNK""=1"
642,"WITH ""temp1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""ct"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""temp2"" AS (SELECT ""customer_id"",MAX(""ct"") AS ""ct1"" FROM ""temp1"" GROUP BY ""customer_id""), ""temp3"" AS (SELECT ""a"".""customer_id"",""a"".""ct1"",""b"".""product_id"" FROM ""temp2"" AS ""a"" LEFT JOIN ""temp1"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""ct1""=""b"".""ct"") SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""temp3"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"""
643,"SELECT ""co"".""customer_id"",""co"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""rnk"" DESC) AS ""co"" LEFT JOIN ""Products"" AS ""p"" ON ""co"".""product_id""=""p"".""product_id"" WHERE ""co"".""rnk""=1"
644,"SELECT ""customer_id"",""b"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""product_id"" DESC) AS ""a"") AS ""b"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1"
645,"SELECT ""tmp"".""customer_id"",""tmp"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""most_frequent"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""tmp"" JOIN ""products"" ON ""tmp"".""product_id""=""products"".""product_id"" WHERE ""most_frequent""=1 ORDER BY ""tmp"".""customer_id"""
646,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"" AS ""customer_id"",""O"".""product_id"",""product_name"",COUNT(""order_id""),DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""RK"" FROM ""Orders"" AS ""O"" LEFT JOIN ""products"" AS ""P"" ON ""O"".""product_id""=""P"".""Product_id"" GROUP BY 1,2,3 ORDER BY 1) AS ""t1"" WHERE ""RK""=1"
647,"SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT *,MAX(""c"") OVER (PARTITION BY ""customer_id"") AS ""m"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""c"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t1"") AS ""t2"" LEFT JOIN ""products"" ON ""products"".""product_id""=""t2"".""product_id"" WHERE ""c""=""m"""
648,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
649,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rank_prod"" FROM ""Orders"" GROUP BY 1,2) SELECT ""customer_id"",""P"".""product_id"",""P"".""product_name"" FROM ""cte"" JOIN ""Products"" AS ""P"" ON ""cte"".""product_id""=""P"".""product_id"" WHERE ""rank_prod""=1"
650,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""freq"" DESC) AS ""rnk"" FROM (SELECT ""o"".""customer_id"" AS ""customer_id"",""o"".""product_id"" AS ""product_id"",""product_name"",COUNT(1) AS ""freq"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""a"") AS ""b"" WHERE ""rnk""=1"
651,"WITH ""order_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""max_order_cnt"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""max_cnt"" FROM ""order_cnt"" GROUP BY ""customer_id"") SELECT ""order_cnt"".""customer_id"",""order_cnt"".""product_id"",""p"".""product_name"" FROM (""order_cnt"" JOIN ""max_order_cnt"" ON ""max_order_cnt"".""customer_id""=""order_cnt"".""customer_id"" AND ""max_order_cnt"".""max_cnt""=""order_cnt"".""cnt"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""order_cnt"".""product_id"""
652,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
653,"SELECT ""tbl1"".""customer_id"",""tbl1"".""product_id"",""tbl2"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""tbl1"" JOIN ""Products"" AS ""tbl2"" ON ""tbl1"".""product_id""=""tbl2"".""product_id"" WHERE ""tbl1"".""order_rank""=1 ORDER BY ""tbl1"".""customer_id"""
654,"WITH ""T"" AS (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranking"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""T"" WHERE ""ranking""=1"
655,"SELECT ""customer_id"",""product_id"",""product_name"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_id"")) IN (SELECT ""customer_id"",MAX(""cnt"") AS ""maxi"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" GROUP BY ""customer_id"")"
656,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""t"") SELECT ""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" LEFT JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
657,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""customers"" AS ""c"" JOIN ""products"" AS ""p"") JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",""p"".""product_id"") AS ""tmp"" WHERE ""tmp"".""rnk""=1"
658,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""sub"" WHERE ""rnk""=1"
659,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM ""grouped_cnt"" AS ""a"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") AS ""cnt"" FROM ""grouped_cnt"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
660,"SELECT ""t2"".""customer_id"",""t2"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num"" DESC) AS ""rankie"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""num"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id"") AS ""t1"") AS ""t2"" LEFT JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""rankie""=1"
661,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t2"".""product_name"" FROM ""cte"" AS ""t1"" JOIN ""Products"" AS ""t2"" USING (""product_id"") WHERE ""t1"".""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""t3"" WHERE ""t1"".""customer_id""=""t3"".""customer_id"")"
662,"SELECT ""ranked"".""customer_id"",""ranked"".""product_id"",""p"".""product_name"" FROM (SELECT ""cpo"".""customer_id"",""cpo"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""cpo"".""customer_id"" ORDER BY ""cpo"".""orders"" DESC) AS ""order_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""cpo"") AS ""ranked"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""ranked"".""product_id"" WHERE ""ranked"".""order_rank""=1"
663,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
664,"SELECT ""b"".""customer_id"",""b"".""product_id"",""c"".""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""order_cnt"" DESC) AS ""prod_rank"" FROM (SELECT ""a"".""customer_id"",""b"".""product_id"",COUNT(1) AS ""order_cnt"" FROM ""Customers"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY 1,2) AS ""a"" WHERE ""order_cnt"">=1) AS ""b"" JOIN ""Products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" WHERE ""b"".""prod_rank""=1"
665,"WITH ""CTE"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""n_purchase"" DESC) AS ""n_rank"" FROM (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""n_purchase"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""a"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""n_rank""=1"
666,"SELECT ""tmp2"".""customer_id"",""tmp2"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""frequency"" DESC) AS ""PurchaseRank"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",COUNT(1) AS ""frequency"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""tmp1"") AS ""tmp2"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""tmp2"".""product_id"" WHERE ""tmp2"".""PurchaseRank""=1"
667,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t2"".""product_name"" FROM ""cte"" AS ""t1"" JOIN ""Products"" AS ""t2"" USING (""product_id"") WHERE ""t1"".""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""t3"" WHERE ""t1"".""customer_id""=""t3"".""customer_id"")"
668,"WITH ""cust_orderqty"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""qty_rank"" FROM ""orders"" GROUP BY 1,2) SELECT ""x"".""customer_id"",""x"".""product_id"",""p"".""product_name"" FROM (SELECT ""c"".""customer_id"",""c"".""product_id"" FROM ""cust_orderqty"" AS ""c"" WHERE ""qty_rank""=1) AS ""x"" JOIN ""products"" AS ""p"" ON ""x"".""product_id""=""p"".""product_id"""
669,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num_purchase"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"" AS ""customer_id"",""t1"".""product_id"" AS ""product_id"",""t2"".""product_name"" FROM ""t1"" LEFT JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""num_purchase""=1"
670,"WITH ""temp"" AS (SELECT ""product_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""r_num"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""temp"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN ""temp"" ON ""p"".""product_id""=""temp"".""product_id"" WHERE ""r_num""=1 GROUP BY 1,2"
671,"WITH ""most_ordered"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""order_cnt"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_cnt"" DESC) AS ""order_cnt_rank"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(1) AS ""order_cnt"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""a"") SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (""most_ordered"" AS ""mo"" JOIN ""Customers"" AS ""c"" ON ""mo"".""customer_id""=""c"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""mo"".""product_id""=""p"".""product_id"" WHERE ""mo"".""order_cnt_rank""=1"
672,"SELECT ""t2"".""customer_id"",""t2"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""t"") AS ""t2"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t2"".""product_id"" AND ""t2"".""rnk""=1"
673,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num"" FROM ""Orders"" GROUP BY 1,2) SELECT ""cte"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""cte"" JOIN ""products"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE ROW(""cte"".""customer_id"",""cte"".""num"") IN (SELECT ""customer_id"",MAX(""num"") FROM ""cte"" GROUP BY 1)"
674,"SELECT ""customer_id"",""p"".""product_id"",""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""ranking"" FROM ""orders"" GROUP BY 1,2) AS ""t"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""ranking""=1"
675,"SELECT ""customer_id"",""t2"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_times"" DESC) AS ""order_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""order_times"" FROM ""orders"" GROUP BY 1,2) AS ""t1"") AS ""t2"" JOIN ""products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"" WHERE ""order_rank""=1"
676,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""product_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""times_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""times_rank""=1 ORDER BY ""o"".""customer_id"""
677,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""p_count"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""p_count"" DESC) AS ""rn"" FROM ""cte"") AS ""t"" WHERE ""rn""=1"
678,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") AS ""tmp"" WHERE ""rnk""=1"
679,"WITH ""sales_agg"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""num_of_product"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") SELECT ""sa1"".""customer_id"",""sa1"".""product_id"",""sa1"".""product_name"" FROM ""sales_agg"" AS ""sa1"" JOIN (SELECT ""customer_id"",MAX(""num_of_product"") AS ""max_count"" FROM ""sales_agg"" GROUP BY ""customer_id"") AS ""sa2"" ON ""sa2"".""customer_id""=""sa1"".""customer_id"" AND ""sa1"".""num_of_product""=""sa2"".""max_count"""
680,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""product_count"" FROM ""Orders"" GROUP BY 1,2) AS ""tmp"") AS ""tmp2"" JOIN ""Products"" ON ""tmp2"".""product_id""=""products"".""product_id"" WHERE ""r""=1"
681,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""orderrank"" FROM ""Orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""orderrank""=1 ORDER BY ""customer_id"""
682,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""order_rank"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""tbl"" WHERE ""order_rank""=1"
683,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) AS ""x"" WHERE ""rnk""=1"
684,"WITH ""temp"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""ts"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ts"" DESC) AS ""rk"" FROM ""temp"") AS ""t"" WHERE ""rk""=1"
685,"WITH ""new"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""b"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""ranks"" FROM ""new"") AS ""a"" WHERE ""ranks""=1) AS ""b"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""b"".""product_Id"""
686,"WITH ""TEMP"" AS (SELECT ""C"".""CUSTOMER_ID"",""P"".""PRODUCT_ID"",""P"".""PRODUCT_NAME"",COUNT(1) AS ""CNT"" FROM ((""CUSTOMERS"" AS ""C"") JOIN ""ORDERS"" AS ""O"") JOIN ""PRODUCTS"" AS ""P"" WHERE ""C"".""CUSTOMER_ID""=""O"".""CUSTOMER_ID"" AND ""O"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" GROUP BY ""C"".""CUSTOMER_ID"",""P"".""PRODUCT_ID"",""P"".""PRODUCT_NAME""), ""TEMP2"" AS (SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"",RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""CNT"" DESC) AS ""RNK"" FROM ""TEMP"") SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM ""TEMP2"" WHERE ""RNK""=1"
687,"SELECT ""b"".""customer_id"",""c"".""product_id"",""d"".""product_name"" FROM (""Customers"" AS ""b"" LEFT JOIN (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""rank_num"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_orders"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY COUNT(""order_id"") DESC) AS ""a"") AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Products"" AS ""d"" ON ""c"".""product_id""=""d"".""product_id"" WHERE ""rank_num""=1"
688,"WITH ""cte1"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(DISTINCT ""o"".""order_date"") AS ""order_cnt"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) JOIN ""products"" AS ""p"" USING (""product_id"") GROUP BY 1,2,3), ""cte2"" AS (SELECT ""customer_id"",MAX(""order_cnt"") AS ""max_order_cnt"" FROM ""cte1"" GROUP BY 1) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte1"" WHERE ROW(""customer_id"",""order_cnt"") IN (SELECT * FROM ""cte2"")"
689,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""Rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""p"".""product_id"",""product_name"" FROM (""Customers"" AS ""c"" JOIN ""t1"" USING (""customer_id"")) JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""Rank""=1"
690,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""products"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank_count"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""a"".""rank_count""=1"
691,"WITH ""CTE1"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt_product"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt_product"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"",""product_id"") SELECT ""c1"".""customer_id"",""c1"".""product_id"",""product_name"" AS ""product_name"" FROM ""CTE1"" AS ""c1"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""c1"".""product_id"" WHERE ""rnk""=1"
692,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""num"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""O"".""Product_id"" GROUP BY ""customer_id"",""product_id"") AS ""tb1"" WHERE ""num""=1"
693,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""num"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""s"" WHERE ""num""=1"
694,"SELECT ""b"".""customer_id"",""b"".""product_id"",""products"".""product_name"" FROM (SELECT * FROM (SELECT ""customer_id"",""product_id"",""total_orders"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""total_orders"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""total_orders"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""total_orders"" DESC) AS ""tmp"" GROUP BY ""customer_id"",""product_id"") AS ""a"" WHERE ""rnk""=1) AS ""b"" JOIN ""products"" ON ""b"".""product_id""=""products"".""product_id"""
695,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cust_by_product"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num_purchase"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"" AS ""customer_id"",""t1"".""product_id"" AS ""product_id"",""t2"".""product_name"" FROM ""t1"" LEFT JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""num_purchase""=1"
696,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""O"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""O"".""product_id"") AS ""temp"" WHERE ""rk""=1"
697,"WITH ""tmp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""tmp2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""rank_no"" FROM ""tmp"") SELECT ""c"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (""Customers"" AS ""c"" JOIN ""tmp2"" AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rank_no""=1"
698,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" JOIN ""products"" USING (""product_id"") GROUP BY 1,2) AS ""rnked"" WHERE ""rnk""=1 ORDER BY 1,2"
699,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
700,"WITH ""frequency"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""f"".""customer_id"",""f"".""product_id"",""p"".""product_name"" FROM ""frequency"" AS ""f"" JOIN ""Products"" AS ""p"" ON ""f"".""product_id""=""p"".""product_id"" WHERE ""f"".""rk""=1"
701,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id""),RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""f_rank"" FROM ""Orders"" GROUP BY 1,2) AS ""t1"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""t1"".""f_rank""=1"
702,"SELECT ""customer_id"",""inb"".""product_id"",""inc"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""n_buy"" DESC) AS ""r_buy"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""n_buy"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""ina"") AS ""inb"", ""Products"" AS ""inc"" WHERE ""inb"".""product_id""=""inc"".""product_id"" AND ""r_buy""=1"
703,"WITH ""t"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""ranks"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""ranks"") SELECT ""t"".""customer_id"",""t"".""product_id"",""products"".""product_name"" FROM (""t"") JOIN ""products"" WHERE ""t"".""product_id""=""products"".""product_id"" AND ""ranks""=1"
704,"WITH ""a"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""num_orders"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") SELECT ""customer_id"",""product_id"",(SELECT ""product_name"" FROM ""products"" WHERE ""product_id""=""a"".""product_id"") AS ""product_name"" FROM ""a"" WHERE ""rk""=1"
705,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" JOIN ""products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""t"" WHERE ""rnk""=1"
706,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"" HAVING ROW(""o"".""customer_id"",COUNT(""o"".""order_date"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" GROUP BY ""customer_id"")"
707,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""ORDERS"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"" HAVING ROW(""o"".""customer_id"",COUNT(""o"".""product_id"")) IN (SELECT ""t"".""customer_id"",MAX(""cnt"") AS ""cnt"" FROM (SELECT ""o"".*,COUNT(""o"".""product_id"") AS ""cnt"" FROM ""Orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""t"" GROUP BY ""t"".""customer_id"")"
708,"WITH ""orders_cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""no_of_orders"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""max_cte"" AS (SELECT ""customer_id"",""product_id"",""no_of_orders"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""no_of_orders"" DESC) AS ""rn"" FROM ""orders_cte"") SELECT ""m"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM ""max_cte"" AS ""m"" JOIN ""products"" AS ""p"" ON ""m"".""product_id""=""p"".""product_id"" WHERE ""rn""=1"
709,"WITH ""subtable"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""counts"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""temp"".""product_id"",""p"".""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""counts"" DESC) AS ""ranking"" FROM ""subtable"") AS ""temp"" LEFT JOIN ""products"" AS ""p"" ON ""temp"".""product_id""=""p"".""product_id"" WHERE ""ranking""=1 ORDER BY ""customer_id"",""product_id"""
710,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""cnt"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") AS ""a"") AS ""b"" WHERE ""rnk""=1"
711,"SELECT ""g"".""customer_id"",""g"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""countorder"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""g"" JOIN ""products"" AS ""p"" ON ""g"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
712,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",MAX(""count"") AS ""max_count"" FROM ""cte1"" GROUP BY ""customer_id""), ""result"" AS (SELECT ""A"".""customer_id"",""A"".""product_id"",""C"".""product_name"" FROM (""cte1"" AS ""A"" JOIN ""cte2"" AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" AND ""A"".""count""=""B"".""max_count"") JOIN ""Products"" AS ""C"" ON ""A"".""product_id""=""C"".""product_id"") SELECT * FROM ""result"""
713,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"",MAX(COUNT(1)) OVER (PARTITION BY ""customer_id"") AS ""maxcnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" JOIN ""Products"" USING (""product_id"") WHERE ""cnt""=""maxcnt"""
714,"WITH ""product_cnts"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""purchases"" FROM ""Orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""purchases"" DESC) AS ""ranking"" FROM ""product_cnts"") AS ""_"" WHERE ""ranking""=1"
715,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
716,"WITH ""r1"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) SELECT ""r1"".""customer_id"",""r1"".""product_id"",""p"".""product_name"" FROM ""r1"" LEFT JOIN ""products"" AS ""p"" ON ""r1"".""product_id""=""p"".""product_id"" WHERE ""r1"".""rnk""=1"
717,"SELECT ""a"".""customer_id"",""b"".""product_id"",""c"".""product_name"" FROM (""Customers"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""Products"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY 1,2 HAVING (COUNT(""b"".""order_id"")=(SELECT ""orders"" FROM (SELECT ""customer_id"",MAX(""orders"") AS ""orders"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""orders"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" GROUP BY 1) AS ""b"" WHERE ""b"".""customer_id""=""a"".""customer_id""))"
718,"SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"" HAVING ROW(""o"".""customer_id"",COUNT(""order_id"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
719,"SELECT ""t"".""customer_id"",""t"".""product_id"",""t"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""r"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""t"" WHERE ""t"".""r""=1"
720,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",(SELECT ""product_name"" FROM ""Products"" WHERE ""product_id""=""o"".""product_id"") AS ""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""rank_"" FROM ""Orders"" AS ""o"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" WHERE ""rank_""=1"
721,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""products"" AS ""p"" JOIN (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""prank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""prank""=1"
722,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
723,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_product"" DESC) AS ""rk"" FROM (SELECT ""o"".*,""p"".""product_name"",COUNT(1) AS ""num_product"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""t"") AS ""tm"" WHERE ""rk""=1"
724,"SELECT DISTINCT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(""product_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""ct"" FROM (SELECT ""c"".""customer_id"",""o"".""order_date"",""o"".""product_id"",""p"".""product_name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""T"") AS ""T1"") AS ""T2"" WHERE ""rk""=1 AND ""product_name"" IS NOT NULL"
725,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""product_id"") AS ""Freq"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""t"".""customer_id"" ORDER BY ""t"".""Freq"" DESC) AS ""rk"" FROM ""t"") AS ""a"" WHERE ""a"".""rk""=1"
726,"SELECT ""z"".""customer_id"",""z"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""product_id"",""customer_id"") AS ""z"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""z"".""product_id"" WHERE ""z"".""rnk""=1"
727,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(1) OVER (PARTITION BY ""o"".""product_id"", ""o"".""customer_id"") AS ""Product_count"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT DISTINCT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c"" JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""Product_count""=(SELECT MAX(""cc"".""Product_count"") FROM ""cte"" AS ""cc"" WHERE ""cc"".""customer_id""=""c"".""customer_id"") ORDER BY ""c"".""customer_id"",""p"".""product_name"""
728,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""count"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count"" DESC) AS ""rnk"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",COUNT(""a"".""product_id"") AS ""count"",""b"".""product_name"" FROM ""Orders"" AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"",""a"".""product_id"") AS ""t"") AS ""f"" WHERE ""rnk""=1"
729,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_count"" DESC) AS ""cust_prod_rank"" FROM ""cte"") SELECT ""customer_id"",""cte2"".""product_id"",""p"".""product_name"" FROM ""cte2"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""cte2"".""product_id"" WHERE ""cte2"".""cust_prod_rank""=1"
730,"SELECT ""sub"".""customer_id"" AS ""customer_id"",""sub"".""product_id"" AS ""product_id"",""p"".""product_name"" AS ""product_name"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""grp_rnk"",""c"".""Customer_id"" AS ""customer_id"",""o"".""product_id"" AS ""product_id"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""Customer_id""=""o"".""Customer_id"" GROUP BY ""c"".""Customer_id"",""o"".""product_id"") AS ""sub"" JOIN ""products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"" WHERE ""sub"".""grp_rnk""=1"
731,"WITH ""ordercount"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""product_name"",COUNT(""order_id"") AS ""order_count"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""p"".""product_id"",""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""order_rank"" FROM ""ordercount"") AS ""a"" WHERE ""order_rank""=1"
732,"SELECT ""customer_id"",""products"".""product_id"",""product_name"" FROM ""Orders"" JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" GROUP BY ""customer_id"",""product_id"" HAVING ROW(""customer_id"",COUNT(""order_date"")) IN (SELECT ""customer_id"",MAX(""cnt"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"" GROUP BY ""customer_id"")"
733,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""mcnt"" FROM ""cte1"" GROUP BY ""customer_id""), ""cte3"" AS (SELECT ""c1"".""customer_id"",""c1"".""product_id"" FROM ""cte1"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""customer_id""=""c2"".""customer_id"" AND ""c1"".""cnt""=""c2"".""mcnt"") SELECT ""c3"".""customer_id"",""c3"".""product_id"",""p"".""product_name"" FROM ""cte3"" AS ""c3"" JOIN ""Products"" AS ""p"" ON ""c3"".""product_id""=""p"".""product_id"""
734,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""a"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""cnt"" IN (SELECT MAX(""cnt"") FROM ""cte"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
735,"SELECT ""t2"".*,""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count_product"" DESC) AS ""rank_product"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""count_product"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""t1"" WHERE ""rank_product""=1) AS ""t2"" LEFT JOIN ""Products"" AS ""p"" ON ""t2"".""product_id""=""p"".""product_id"""
736,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",""a"".""cnt_trans"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""cnt_trans"" DESC) AS ""rk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt_trans"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" WHERE ""rk""=1"
737,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""order_rank""=1"
738,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""a"".""product_id"",""product_name"" FROM ""grouped_cnt"" AS ""a"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""cnt"" IN (SELECT MAX(""cnt"") AS ""cnt"" FROM ""grouped_cnt"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"")"
739,"SELECT ""x"".*,""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",SUM(""cnt"") AS ""cnt"" FROM (SELECT ""order_date"",""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""order_date"",""customer_id"",""product_id"") AS ""x"" GROUP BY ""customer_id"",""product_id"") AS ""x"") AS ""x"" WHERE ""x"".""r""=1) AS ""x"" LEFT JOIN ""Products"" AS ""p"" ON ""x"".""product_id""=""p"".""product_id"" ORDER BY ""customer_id"""
740,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""sales_rank"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"") JOIN ""Products"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""sales_rank""=1"
741,"SELECT ""customer_id"",""Products"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""order_count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT (""order_id"")) AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""customer_order_counts"") AS ""customer_order_counts_rank"" JOIN ""Products"" ON ""customer_order_counts_rank"".""product_id""=""Products"".""product_id"" WHERE ""r""=1"
742,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""purchasing_time"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""w1"" AS (SELECT ""customer_id"",""product_id"",""purchasing_time"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""purchasing_time"" DESC) AS ""rankings"" FROM ""cte"") SELECT ""w1"".""customer_id"",""w1"".""product_id"",""p"".""product_name"" FROM ""w1"" JOIN ""products"" AS ""p"" ON ""w1"".""product_id""=""p"".""product_id"" WHERE ""w1"".""rankings""=1"
743,"SELECT DISTINCT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
744,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""CNT"" DESC) AS ""RNK"" FROM (SELECT ""customer_id"",""P1"".""product_id"",""P1"".""product_name"",COUNT(""P1"".""product_id"") AS ""CNT"" FROM ""Orders"" AS ""O1"" JOIN ""Products"" AS ""P1"" ON ""O1"".""product_id""=""P1"".""product_id"" GROUP BY ""customer_id"",""P1"".""product_id"",""P1"".""product_name"") AS ""T1"") AS ""T2"" WHERE ""RNK""=1"
745,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id""),RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""f_rank"" FROM ""Orders"" GROUP BY 1,2) AS ""t1"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""t1"".""f_rank""=1"
746,"WITH ""tbl2"" AS (WITH ""tbl1"" AS (SELECT ""customer_id"" AS ""c"",""product_id"" AS ""p"",COUNT(""product_id"") AS ""num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT *,MAX(""tbl1"".""num"") OVER (PARTITION BY ""tbl1"".""c"") AS ""maxi"" FROM ""tbl1"") SELECT ""tbl2"".""c"" AS ""customer_id"",""tbl2"".""p"" AS ""product_id"",""p"".""product_name"" FROM ""tbl2"" JOIN ""products"" AS ""p"" ON ""tbl2"".""p""=""p"".""product_id"" WHERE ""tbl2"".""maxi""=""tbl2"".""num"" ORDER BY ""tbl2"".""c"""
747,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"",COUNT(1) AS ""cnt"" FROM ""orders"" AS ""a"" LEFT JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1,2,3) AS ""t"") AS ""t1"" WHERE ""rnk""=1"
748,"WITH ""temp"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank_p"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM ""temp"" AS ""t"" JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rank_p""=1"
749,"SELECT ""RT"".""customer_id"",""RT"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_order"" DESC) AS ""RNK"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_order"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""T"") AS ""RT"" JOIN ""Products"" AS ""P"" ON ""RT"".""product_id""=""P"".""product_id"" WHERE ""RNK""=1"
750,"SELECT ""r"".""customer_id"",""r"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""a"") AS ""r"" LEFT JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""rank""=1"
751,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""product_freq"" FROM ""orders"" GROUP BY ""customer_id"",""product_id""), ""max_freq"" AS (SELECT ""customer_id"",MAX(""product_freq"") AS ""max_product_freq"" FROM ""cte"" GROUP BY ""customer_id""), ""best_pdt"" AS (SELECT ""cte"".""customer_id"",""cte"".""product_id"" FROM ""cte"" JOIN ""max_freq"" ON ""cte"".""customer_id""=""max_freq"".""customer_id"" WHERE ""product_freq""=""max_product_freq"") SELECT ""best_pdt"".""customer_id"",""best_pdt"".""product_id"",""p"".""product_name"" FROM ""best_pdt"" JOIN ""products"" AS ""p"" ON ""best_pdt"".""product_id""=""p"".""product_id"""
752,"WITH ""a"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id""), ""b"" AS (SELECT COUNT(1) AS ""c"",""customer_id"",""product_id"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""c"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""r"" FROM ""b"") SELECT DISTINCT ""a"".* FROM ""a"" JOIN ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""a"".""product_id""=""c"".""product_id"" WHERE ""r""=1 ORDER BY ""a"".""customer_id"""
753,"SELECT ""customer_id"",""tmp"".""product_id"",""p"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(""product_id"") AS ""sn"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2 ORDER BY 1,3 DESC) AS ""tmp"" JOIN ""products"" AS ""p"" ON ""tmp"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
754,"SELECT ""customer_id"",""y"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY 1,2) AS ""x"") AS ""y"" JOIN ""Products"" AS ""z"" ON ""y"".""product_id""=""z"".""product_id"" WHERE ""rn""=1"
755,"WITH ""tmp"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""ct"" FROM ""orders"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""tmp"" NATURAL JOIN ""products"" WHERE ROW(""customer_id"",""ct"") IN (SELECT ""customer_id"",MAX(""ct"") FROM ""tmp"" GROUP BY 1)"
756,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""RNK"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""ct"" FROM ""Orders"" GROUP BY 1,2) AS ""cc"" ORDER BY 1,3) SELECT ""customer_id"",""c"".""product_id"",""product_name"" FROM ""CTE"" AS ""C"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
757,"SELECT ""a"".""customer_id"",""a"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) AS ""a"" JOIN ""Products"" USING (""product_id"") WHERE ""rnk""=1"
758,"SELECT ""c"".""customer_id"",""d"".""product_id"",""d"".""product_name"" FROM (SELECT ""a"".""customer_id"",""b"".""product_name"",""a"".""product_id"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY COUNT(""a"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"",""b"".""product_name"") AS ""d"" JOIN ""Customers"" AS ""c"" ON ""d"".""customer_id""=""c"".""customer_id"" WHERE ""d"".""rnk""=1"
759,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
760,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(""o"".""order_id"") AS ""n"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""order_id"") DESC) AS ""ranking"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3 ORDER BY 1) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""ranking""=1"
761,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""count"" FROM (""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"" ORDER BY ""o"".""customer_id"",""count"" DESC) SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""count"" DESC) AS ""r"" FROM ""t"") AS ""a"" WHERE ""r""=1"
762,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",COUNT(1) AS ""cnt"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cte"") AS ""t"" WHERE ""rnk""=1"
763,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
764,"WITH ""t1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cust_by_product"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""num_purchase"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""t1"".""customer_id"" AS ""customer_id"",""t1"".""product_id"" AS ""product_id"",""t2"".""product_name"" FROM ""t1"" LEFT JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""num_purchase""=1"
765,"SELECT ""t"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""p_rank"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""t"".""p_rank""=1"
766,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"",COUNT(1) AS ""order_count"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ROW(""customer_id"",""order_count"") IN (SELECT ""customer_id"",MAX(""order_count"") FROM ""cte"" GROUP BY 1)"
767,"SELECT ""sub"".""customer_id"",""sub"".""product_id"",""sub"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rank"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2,3) AS ""sub"" WHERE ""rank""=1"
768,"SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""o"".""order_rank""=1"
769,"SELECT ""customer_id"",""m"".""product_id"",""product_name"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""drk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""m"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""m"".""product_id"" WHERE ""drk""=1"
770,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""RNK"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""RNK""=1"
771,"SELECT ""c"".""customer_id"",""c"".""product_id"",""d"".""product_name"" FROM (SELECT * FROM (SELECT ""customer_id"",""product_id"",""prdt_cnt"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""prdt_cnt"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""prdt_cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"") AS ""a"") AS ""b"" WHERE ""b"".""rnk""=1) AS ""c"" LEFT JOIN ""products"" AS ""d"" ON ""c"".""product_id""=""d"".""product_id"" ORDER BY ""customer_id"""
772,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""order_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
773,"WITH ""summary"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",COUNT(""o"".""order_id"") AS ""ords"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"",""p"".""product_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""summary"" WHERE ""rk""=1"
774,"WITH ""grouped_cnt"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""e"".""product_id"",""e"".""product_name"" FROM (SELECT ""customer_id"",""product_id"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM ""grouped_cnt"" AS ""a"") AS ""b"" WHERE ""b"".""rn""=1) AS ""c"" LEFT JOIN ""products"" AS ""e"" ON ""e"".""product_id""=""c"".""product_id"""
775,"WITH ""cte1"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""cte2"" AS (SELECT ""customer_id"",MAX(""cnt"") AS ""cnt"" FROM ""cte1"" GROUP BY ""customer_id"") SELECT ""c1"".""customer_id"",""c1"".""product_id"",""p"".""product_name"" FROM (""cte1"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""customer_id""=""c2"".""customer_id"" AND ""c1"".""cnt""=""c2"".""cnt"") JOIN ""Products"" AS ""p"" ON ""c1"".""product_id""=""p"".""product_id"""
776,"SELECT ""cte"".""customer_id"",""cte"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""r"" FROM ""orders"" GROUP BY 1,2) AS ""cte"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""cte"".""product_Id"" WHERE ""cte"".""r""=1"
777,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""ct"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"",""product_id""), ""CTE2"" AS (SELECT ""c"".*,DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"",""p"".""product_name"" FROM ""CTE"" AS ""c"" LEFT JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""CTE2"" WHERE ""rk""=1"
778,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""frequency"" FROM ""Orders"" GROUP BY 1,2) SELECT ""c"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",""product_id"" FROM ""cte"" WHERE ""frequency""=1) AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"""
779,"SELECT ""sub"".""customer_id"",""sub"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY 1,2) AS ""sub"" JOIN ""products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"" WHERE ""sub"".""rnk""=1 ORDER BY ""sub"".""customer_id"",""sub"".""product_id"""
780,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") OVER (PARTITION BY ""customer_id"", ""product_id"") AS ""ct"" FROM ""Orders""), ""cte1"" AS (SELECT ""cte"".*,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""ct"" DESC) AS ""rk"" FROM ""cte"" GROUP BY ""customer_id"",""product_id"") SELECT ""cte1"".""customer_id"",""cte1"".""product_id"",""p"".""product_name"" FROM ""cte1"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""rk""=1"
781,"WITH ""n_orders"" AS (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM ""orders"" AS ""o"" GROUP BY 1,2), ""cust_max"" AS (SELECT ""customer_id"",MAX(""orders"") AS ""orders"" FROM ""n_orders"" GROUP BY 1) SELECT ""n"".""customer_id"",""n"".""product_id"",""p"".""product_name"" FROM (""n_orders"" AS ""n"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""n"".""product_id"") JOIN ""cust_max"" AS ""c"" ON ""c"".""customer_id""=""n"".""customer_id"" AND ""c"".""orders""=""n"".""orders"""
782,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""Customer_id"" ORDER BY ""q"" DESC) AS ""rnk"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""q"" FROM ""Orders"" GROUP BY 1,2) AS ""ct"" GROUP BY 1,2 ORDER BY 1,3) SELECT ""customer_id"",""c"".""product_id"",""product_name"" FROM ""CTE"" AS ""C"" JOIN ""Products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
783,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""ranking"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"") AS ""ASD"" WHERE ""ranking""=1"
784,"WITH ""t"" AS (SELECT ""o"".""customer_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"",""o"".""product_id"",""p"".""product_name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""t"" WHERE ""rnk""=1 ORDER BY ""customer_id"",""product_id"""
785,"WITH ""LOOKUP"" AS (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""p"".""product_id"") DESC) AS ""RNK"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""LOOKUP"" WHERE ""RNK""=1"
786,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""temp"" JOIN ""products"" USING (""product_id"") WHERE ""temp"".""rank""=1"
787,"WITH ""cte"" AS (SELECT ""o"".""product_id"",""p"".""product_name"",""c"".""customer_id"",""c"".""name"",""p"".""price"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" ORDER BY ""c"".""customer_id""), ""cnt"" AS (SELECT ""customer_id"",""product_id"",""product_name"",COUNT(1) AS ""cnt"",MAX(""price"") AS ""price"" FROM ""cte"" GROUP BY 1,2 ORDER BY 1), ""rnk"" AS (SELECT ""customer_id"",""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rnk"" FROM ""cnt"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""rnk"" WHERE ""rnk""=1 ORDER BY 1"
788,"WITH ""temp_rank"" AS (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""tr"".""customer_id"",""tr"".""product_id"",""p"".""product_name"" FROM ""temp_rank"" AS ""tr"" JOIN ""products"" AS ""p"" ON ""tr"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1"
789,"WITH ""cte"" AS (SELECT ""o"".""order_id"",""o"".""customer_id"",""p"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY ""p"".""product_id"",""o"".""customer_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""cte"" WHERE ""rnk""=1"
790,"WITH ""result"" AS (SELECT ""T1"".""customer_id"",""T1"".""product_id"",""T1"".""cnt"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""R"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"" ORDER BY ""customer_id"",""cnt"" DESC) AS ""T1"") SELECT ""r"".""customer_id"",""r"".""product_id"",""p"".""product_name"" FROM ""result"" AS ""r"" JOIN ""products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""R""=1"
791,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(""p"".""product_name"") DESC) AS ""highest_order"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2) AS ""derived_table"" WHERE ""highest_order""=1"
792,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""dn"" FROM ""orders"" AS ""o"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""c1"".""customer_id"",""c1"".""product_id"",""p"".""product_name"" FROM ""cte"" AS ""c1"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""c1"".""product_id"" WHERE ""c1"".""dn""=1"
793,"SELECT ""T"".""customer_id"",""T"".""product_id"",""P"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") AS ""T"" JOIN ""Products"" AS ""P"" ON ""T"".""product_id""=""P"".""product_id"" WHERE ""rnk""=1"
794,"SELECT ""CUSTOMER_ID"",""PRODUCT_ID"",""PRODUCT_NAME"" FROM (SELECT ""C"".""CUSTOMER_ID"" AS ""CUSTOMER_ID"",""P"".""PRODUCT_ID"" AS ""PRODUCT_ID"",""P"".""PRODUCT_NAME"" AS ""PRODUCT_NAME"",COUNT(""ORDER_ID""),DENSE_RANK() OVER (PARTITION BY ""C"".""CUSTOMER_ID"" ORDER BY ""C"".""CUSTOMER_ID"",COUNT(""ORDER_ID"") DESC) AS ""RANKS"" FROM (""CUSTOMERS"" AS ""C"" JOIN ""ORDERS"" AS ""O"" USING (""CUSTOMER_ID"")) JOIN ""PRODUCTS"" AS ""P"" USING (""PRODUCT_ID"") GROUP BY ""C"".""CUSTOMER_ID"",""P"".""PRODUCT_ID"") AS ""X"" WHERE ""RANKS""=1"
795,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""o"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""o"".""product_id"") AS ""a"" WHERE ""rk""=1"
796,"WITH ""a"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""order_times"" FROM ""orders"" GROUP BY 1,2), ""b"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_times"" DESC) AS ""rnk_num"" FROM ""a"" LEFT JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""b"" WHERE ""rnk_num""=1"
797,"WITH ""cte_table"" AS (SELECT ""customer_id"",""product_id"",""num_orders"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_orders"" DESC) AS ""row_num"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""num_orders"" FROM ""Orders"" GROUP BY 1,2) AS ""sub"") SELECT ""c"".""customer_id"",""c"".""product_id"",""product_name"" FROM ""cte_table"" AS ""c"" LEFT JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""c"".""product_id"" WHERE ""row_num""=1"
798,"WITH ""c"" AS (SELECT ""o"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""dn"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""c"" JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""dn""=1"
799,"SELECT ""f"".""customer_id"",""f"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""quantity"" DESC) AS ""ranking"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""product_id"") AS ""quantity"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""t"") AS ""f"" JOIN ""Products"" AS ""p"" ON (""f"".""product_id""=""p"".""product_id"") WHERE ""f"".""ranking""=1"
800,"WITH ""order_counts"" AS (SELECT ""o"".""customer_id"",""p"".""product_name"",""p"".""product_id"",COUNT(""o"".""order_id"") AS ""order_count"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) SELECT ""oc"".""customer_id"",""oc"".""product_id"",""oc"".""product_name"" FROM ""order_counts"" AS ""oc"" WHERE ""oc"".""order_count""=(SELECT MAX(""order_count"") FROM ""order_counts"" AS ""x"" WHERE ""x"".""customer_id""=""oc"".""customer_id"")"
801,"SELECT ""customer_id"",""Products"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""order_count"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""r"" FROM (SELECT ""customer_id"",""product_id"",COUNT(DISTINCT (""order_id"")) AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""customer_order_counts"") AS ""customer_order_counts_rank"" JOIN ""Products"" ON ""customer_order_counts_rank"".""product_id""=""Products"".""product_id"" WHERE ""r""=1"
802,"WITH ""TEMP"" AS (SELECT ""customer_id"",""A"".""product_id"",""product_name"",COUNT(1) AS ""order_count"" FROM ""Orders"" AS ""A"" LEFT JOIN ""Products"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" GROUP BY ""customer_id"",""product_id"",""product_name"") SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""order_rank"" FROM ""TEMP"") AS ""A"" WHERE ""order_rank""=1"
803,"WITH ""ordertimes"" AS (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""order_times"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""maxordertimes"" AS (SELECT ""customer_id"",MAX(""order_times"") AS ""max_order_times"" FROM ""ordertimes"" GROUP BY ""customer_id"") SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (""ordertimes"" AS ""o"" LEFT JOIN ""maxordertimes"" AS ""m"" ON ""o"".""customer_id""=""m"".""customer_id"") LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_times""=""max_order_times"""
804,"WITH ""ct"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""c"".""customer_id"",""c"".""product_id"",""p"".""product_name"" FROM ""ct"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""c"".""rnk""=1"
805,"SELECT ""p1"".""customer_id"",""p1"".""product_id"",""p2"".""product_name"" FROM (SELECT ""c"".""customer_id"",""o"".""product_id"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2) AS ""p1"" JOIN ""products"" AS ""p2"" ON ""p1"".""product_id""=""p2"".""product_id"" WHERE ""p1"".""rnk""=1"
806,"SELECT ""s"".""customer_id"",""s"".""product_id"",""s"".""product_name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""rnk"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""o"".""product_id"") AS ""s"" WHERE ""s"".""rnk""=1"
807,"SELECT ""customer_id"",""m"".""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_num"" DESC) AS ""order_rank"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""order_num"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""n"") AS ""m"" JOIN ""Products"" AS ""p"" ON ""m"".""product_id""=""p"".""product_id"" WHERE ""order_rank""=1"
808,"SELECT ""a"".""customer_id"",""a"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_id"") DESC) AS ""ranking"" FROM ""Orders"" GROUP BY 1,2) AS ""a"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"" WHERE ""a"".""ranking""=1 ORDER BY ""a"".""customer_id"""
809,"SELECT ""tbl1"".""customer_id"",""tbl1"".""product_id"",""tbl2"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""product_id"") DESC) AS ""order_rank"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""tbl1"" JOIN ""Products"" AS ""tbl2"" ON ""tbl1"".""product_id""=""tbl2"".""product_id"" WHERE ""tbl1"".""order_rank""=1 ORDER BY ""tbl1"".""customer_id"""
810,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""T1"".""customer_id"",""T1"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""num_purchase"" DESC) AS ""rank_"" FROM (SELECT ""Orders"".""customer_id"",""Orders"".""product_id"",""product_name"",COUNT(1) AS ""num_purchase"" FROM ""Orders"" LEFT JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" GROUP BY ""Orders"".""customer_id"",""Orders"".""product_id"") AS ""T1"") AS ""T2"" WHERE ""rank_""=1"
811,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""t1"".""customer_id"",""t1"".""product_id"",""t2"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""order_date"") DESC) AS ""rnk"" FROM ""Orders"" AS ""t1"" JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" GROUP BY 1,2,3) AS ""sub"" WHERE ""rnk""=1"
812,"WITH ""cte"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""prdcnt"" FROM ""orders"" GROUP BY ""customer_id"",""product_id"") SELECT ""o"".""customer_id"",""o"".""product_id"",""p"".""product_name"" FROM (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""prdcnt"" DESC) AS ""prdrank"" FROM ""cte"") AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ""o"".""prdrank""=1"
813,"WITH ""tmp"" AS (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id""), ""tmp2"" AS (SELECT ""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_count"" DESC) AS ""rank_no"" FROM ""tmp"") SELECT ""c"".""customer_id"",""t"".""product_id"",""p"".""product_name"" FROM (""Customers"" AS ""c"" JOIN ""tmp2"" AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rank_no""=1"
814,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""c"".""customer_id"",""p"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY COUNT(""o"".""product_id"") DESC) AS ""ranking"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"",""product_id"") AS ""newtable"" WHERE ""ranking""=1"
815,"WITH ""abs"" AS (SELECT ""O"".""customer_id"",""O"".""product_id"",""P"".""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(""O"".""product_id"") DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""customer_id"",""product_id"") SELECT ""customer_id"",""product_id"",""product_name"" FROM ""abs"" WHERE ""rnk""=1"
816,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",""Num_Orders"",MAX(""Num_Orders"") OVER (PARTITION BY ""customer_id"") AS ""MAX_ordered"" FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_id"") AS ""Num_Orders"" FROM ""Orders"" GROUP BY ""customer_id"",""product_id"") AS ""NumberofOrdersByCust_Product"" GROUP BY ""customer_id"",""product_id"") SELECT ""CTE"".""customer_id"",""CTE"".""product_id"",""product_name"" FROM ""CTE"" LEFT JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ""Num_Orders""=""MAX_ordered"""
817,"WITH ""tmp_table"" AS (SELECT ""customer_id"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""cnt"" DESC) AS ""rn"" FROM (SELECT ""customer_id"",""product_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" GROUP BY 1,2 ORDER BY 1,2) AS ""drv"") SELECT ""drv"".""customer_id"",""prod"".""product_id"",""prod"".""product_name"" FROM ""tmp_table"" AS ""drv"" LEFT JOIN ""Products"" AS ""prod"" ON ""drv"".""product_id""=""prod"".""product_id"" WHERE ""drv"".""rn""=1"
818,"SELECT ""a"".""customer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1,2 HAVING ROW(""a"".""customer_id"",COUNT(""product_name"")) IN (SELECT ""customer_id"",MAX(""ordered"") FROM (SELECT ""customer_id"",""product_id"",COUNT(""order_date"") AS ""ordered"" FROM ""orders"" GROUP BY 1,2) AS ""a"" GROUP BY 1)"
819,"SELECT ""customer_id"",""product_id"",""product_name"" FROM (SELECT ""customer_id"",""product_id"",""product_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"") GROUP BY ""customer_id"",""product_id"") AS ""rnked"" WHERE ""rnk""=1 ORDER BY 1,2"
