id,original query
1,"SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM (SELECT DISTINCT ""id"",""login_date"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""l2"") AS ""l"" CROSS, ""accounts"" AS ""a"" WHERE ""a"".""id""=""l"".""id"" AND ""l"".""diff""=4 ORDER BY ""id"""
2,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""d1"".""id"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""d1"" JOIN (SELECT DISTINCT * FROM ""Logins"") AS ""d2"" ON ""d1"".""id""=""d2"".""id"" AND ""d1"".""login_date"" - ""d2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""d1"".""id"",""d1"".""login_date"" HAVING COUNT(DISTINCT ""d2"".""login_date"")=4) ORDER BY 1"
3,"WITH ""log"" AS (SELECT *,LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ld4"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""sub""), ""active"" AS (SELECT * FROM ""log"" WHERE ""login_date"" - INTERVAL '4 DAY'=""ld4"") SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""a"".""id"" FROM ""active"" AS ""a"") ORDER BY ""id"""
4,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
5,"SELECT DISTINCT ""a"".""Id"",""b"".""name"" FROM (SELECT ""Id"",""login_date"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouing"" FROM (SELECT ""Id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""a"") AS ""a"" ORDER BY 1) AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""Id"",""grouing"" HAVING (COUNT(1)>=5)"
6,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ""Logins"" AS ""l1"" LEFT JOIN ""Accounts"" AS ""a"" USING (""id"") WHERE ""login_date"" - INTERVAL '1 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"") AND ""login_date"" - INTERVAL '2 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l3"" WHERE ""l1"".""id""=""l3"".""id"") AND ""login_date"" - INTERVAL '3 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l4"" WHERE ""l1"".""id""=""l4"".""id"") AND ""login_date"" - INTERVAL '4 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l5"" WHERE ""l1"".""id""=""l5"".""id"") ORDER BY ""l1"".""id"""
7,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
8,"SELECT DISTINCT ""c1"".""id"",""a"".""name"" FROM ((SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_rank"" FROM ""logins"") AS ""c1"" CROSS, (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_rank"" FROM ""logins"") AS ""c2"") CROSS JOIN ""accounts"" AS ""a"" WHERE ""c1"".""id""=""c2"".""id"" AND ""c2"".""login_date"" - ""c1"".""login_date""=4 AND ""c2"".""login_rank""=""c1"".""login_rank""+4 AND ""a"".""id""=""c1"".""id"" ORDER BY ""c1"".""id"""
9,"SELECT DISTINCT ""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""A"".""id"") AS ""name"" FROM ""Logins"" AS ""A"" WHERE ROW(""id"",""login_date"" + INTERVAL '1 DAY') IN (SELECT * FROM ""logins"") AND ROW(""id"",""login_date"" + INTERVAL '2 DAY') IN (SELECT * FROM ""logins"") AND ROW(""id"",""login_date"" + INTERVAL '3 DAY') IN (SELECT * FROM ""logins"") AND ROW(""id"",""login_date"" + INTERVAL '4 DAY') IN (SELECT * FROM ""logins"") ORDER BY ""id"""
10,"SELECT DISTINCT ""n4"".""id"",""a1"".""name"" FROM (SELECT ""id"",COUNT(""id"") AS ""num_con"" FROM (SELECT ""id"",""login_date"",""diff_date""-""row_num"" AS ""grp"" FROM (SELECT ""id"",""login_date"",""diff_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"")-1 AS ""row_num"" FROM (SELECT DISTINCT ""l1"".""id"",""l1"".""login_date"",""l1"".""login_date"" - ""t1"".""min_login_date"" AS ""diff_date"" FROM ""logins"" AS ""l1"" LEFT JOIN (SELECT ""id"",MIN(""login_date"") AS ""min_login_date"" FROM ""logins"" GROUP BY ""id"") AS ""t1"" ON ""l1"".""id""=""t1"".""id"" ORDER BY ""id"",""login_date"") AS ""n1"") AS ""n2"") AS ""n3"" GROUP BY ""id"",""grp"") AS ""n4"" JOIN ""accounts"" AS ""a1"" ON ""n4"".""id""=""a1"".""id"" AND ""n4"".""num_con"">=5 ORDER BY ""id"""
11,"WITH ""temp1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""temp2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""temp1"") SELECT DISTINCT ""t2"".""id"",""a"".""name"" FROM ""temp2"" AS ""t2"" JOIN ""Accounts"" AS ""a"" ON ""t2"".""id""=""a"".""id"" WHERE ""t2"".""date_lead_five"" - ""t2"".""login_date""=4 ORDER BY ""t2"".""id"""
12,"SELECT DISTINCT ""id"",""name"" FROM (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY 1,2,3) AS ""b"") AS ""c"" WHERE ""fifth_date"" - ""login_date""=4"
13,"WITH ""daily_login"" AS (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT ""logins_summary"".""id"",""name"" FROM (SELECT ""id"",""login_date"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""days_since_login"" FROM ""daily_login"") AS ""logins_summary"" LEFT JOIN ""Accounts"" ON ""logins_summary"".""id""=""Accounts"".""id"" WHERE ""days_since_login""=4 GROUP BY ""logins_summary"".""id"",""name"""
14,"WITH ""unique_login_dates"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2) SELECT ""temp4"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT ""temp3"".""id"" AS ""id"" FROM (SELECT ""temp2"".""id"" AS ""id"",""temp2"".""grouping_variable"" AS ""grouping_variable"",MAX(""temp2"".""login_date"") AS ""max_login_date"",MIN(""temp2"".""login_date"") AS ""min_login_date"" FROM (SELECT *,""temp"".""login_date"" - INTERVAL '""temp"".""rownumber"" DAY' AS ""grouping_variable"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rownumber"" FROM ""unique_login_dates"") AS ""temp"") AS ""temp2"" GROUP BY ""temp2"".""id"",""temp2"".""grouping_variable"") AS ""temp3"" WHERE ""temp3"".""max_login_date"" - ""temp3"".""min_login_date""+1>=5) AS ""temp4"" ON ""a"".""id""=""temp4"".""id"" GROUP BY 1 ORDER BY 1"
15,"WITH ""logins_cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""temp"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifthdate"" FROM ""logins_cte"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""temp"" WHERE ""fifthdate"" - ""login_date""=4) ORDER BY ""id"""
16,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rn"" DAY' AS ""group_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""logins"") AS ""t"") SELECT DISTINCT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""group_date"" HAVING COUNT(""id"")>=5) ORDER BY ""id"""
17,"SELECT DISTINCT ""l"".""id"",""u"".""name"" FROM (SELECT DISTINCT ""id"",""login_date"",DAYOFYEAR(""login_date"")-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""idgrp"" FROM ""logins"") AS ""l"" JOIN ""accounts"" AS ""u"" USING (""id"") GROUP BY ""l"".""id"",""u"".""name"",""l"".""idgrp"" HAVING COUNT(""l"".""id"")>=5 ORDER BY ""l"".""id"""
18,"WITH ""cte"" AS (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM ""cte"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte2"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
19,"WITH ""cte1"" AS (SELECT ""temp"".""id"",""temp"".""login_date"",ROW_NUMBER() OVER (PARTITION BY ""temp"".""id"" ORDER BY ""temp"".""login_date"") AS ""ranked_dates"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""temp""), ""cte_2"" AS (SELECT ""id"",MAX(""login_date"") - MIN(""login_date"")+1 AS ""diff_days"" FROM ""cte1"" GROUP BY ""id"",""login_date"" + INTERVAL '-""ranked_dates"" DAY') SELECT DISTINCT ""id"",""name"" FROM ""cte_2"" AS ""c2"" JOIN ""accounts"" AS ""a"" USING (""id"") WHERE ""diff_days"">=5 ORDER BY ""id"""
20,"WITH ""CTE"" AS (SELECT ""A"".""id"",""A"".""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""A"".""id"" ORDER BY ""A"".""login_date"") AS ""leadDate"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""A"") SELECT DISTINCT ""B"".""id"",""acc"".""name"" FROM ""CTE"" AS ""B"" JOIN ""accounts"" AS ""acc"" ON ""B"".""id""=""acc"".""id"" WHERE ""B"".""leadDate"" - ""B"".""login_Date""=4 ORDER BY ""B"".""id"""
21,"WITH ""login_info"" AS (SELECT ""L"".""id"",""L"".""login_date"",""A"".""name"",LEAD(""L"".""login_date"", 4) OVER (PARTITION BY ""L"".""id"" ORDER BY ""L"".""login_date"") AS ""fifth_login_day"" FROM ""Logins"" AS ""L"" JOIN ""Accounts"" AS ""A"" ON ""L"".""id""=""A"".""id"" GROUP BY 1,2) SELECT DISTINCT ""L"".""id"",""L"".""name"" FROM ""login_info"" AS ""L"" WHERE ""L"".""fifth_login_day"" - ""L"".""login_date""=4"
22,"WITH ""new"" AS (SELECT ""id"",""login_date"",""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" ORDER BY ""id"") AS ""a"") SELECT DISTINCT ""new"".""id"",""name"" FROM ""new"" LEFT JOIN ""accounts"" AS ""a"" ON ""new"".""id""=""a"".""id"" GROUP BY ""new"".""id"",""diff"" HAVING COUNT(""diff"")>=5"
23,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""m"" AS (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(""l2"".""login_date"") AS ""date_count"" FROM ""t"" AS ""l1"" JOIN ""t"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 AND ""l2"".""login_date"">""l1"".""login_date"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING ""date_count"">=4) SELECT DISTINCT ""m"".""id"",""accounts"".""name"" FROM ""m"" JOIN ""accounts"" ON ""m"".""id""=""accounts"".""id"" ORDER BY ""m"".""id"""
24,"WITH ""x"" AS (SELECT ""id"",""val"",COUNT(1) AS ""ct"" FROM (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""val"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""a"") AS ""b"" GROUP BY ""id"",""val"" HAVING COUNT(1)>=5) SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM ""x"" AS ""a"" JOIN ""accounts"" AS ""b"" USING (""id"") ORDER BY ""a"".""id"""
25,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" - INTERVAL '""row_num"" DAY' AS ""groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""first_login"",MAX(""login_date"") AS ""last_login"" FROM ""temp1"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4) SELECT DISTINCT ""id"",""name"" FROM ""answer_table"" JOIN ""accounts"" USING (""id"") ORDER BY ""answer_table"".""id"""
26,"SELECT ""Accounts"".""id"",""Accounts"".""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag4"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t1"") AS ""temp"" WHERE ""login_date"" - ""lag4""=4) ORDER BY ""id"""
27,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
28,"WITH ""temp"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""temp2"" AS (SELECT ""temp"".""id"",""temp"".""login_date"",LEAD(""login_date"", 4, 0) OVER (PARTITION BY ""temp"".""id"" ORDER BY ""temp"".""login_date"") AS ""consective_5"" FROM ""temp""), ""temp3"" AS (SELECT ""temp2"".""id"",CASE WHEN ""consective_5"" - ""temp2"".""login_date""+1=5 THEN 1 ELSE 0 END AS ""active_user"" FROM ""temp2"") SELECT DISTINCT ""temp3"".""id"",""name"" FROM ""temp3"" JOIN ""Accounts"" ON ""Accounts"".""id""=""temp3"".""id"" WHERE ""active_user""=1 ORDER BY 1"
29,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
30,"WITH ""base"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"") AS ""fifth_dt"" FROM (SELECT * FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") SELECT ""p"".""id"",""q"".""name"" FROM (SELECT *,CASE WHEN (""login_date"" + INTERVAL '4 DAY'=""fifth_dt"") THEN 1 ELSE 0 END AS ""result"" FROM ""base"") AS ""p"" JOIN ""Accounts"" AS ""q"" ON ""p"".""id""=""q"".""id"" WHERE ""result""=1 GROUP BY ""p"".""id"",""q"".""name"" ORDER BY ""p"".""id"""
31,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""leading_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_date"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""leading_date""=""b"".""fifth_date"" ORDER BY ""a"".""id"""
32,"SELECT DISTINCT ""ac"".""id"",""name"" FROM (SELECT ""id"",""login_date"",""lead_5_date"" - ""login_date"" AS ""diff_days"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_5_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""a"") AS ""b"" WHERE ""lead_5_date"" IS NOT NULL) AS ""c"" JOIN ""Accounts"" AS ""ac"" ON ""ac"".""id""=""c"".""id"" AND ""c"".""diff_days""=4 ORDER BY ""ac"".""id"""
33,"WITH ""CTE"" AS (SELECT ""a"".""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""fifth_login_date"" FROM ""logins"" AS ""l"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l"".""id"" GROUP BY ""a"".""id"",""login_date"") SELECT DISTINCT ""id"",""name"" FROM ""cte"" WHERE ""fifth_login_date"" - ""login_date""=4"
34,"SELECT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_day"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY 1,2,3) AS ""t"") AS ""tt"" WHERE ""lead_date""=""fifth_day"" GROUP BY 1,2 ORDER BY 1,2"
35,"WITH ""CTE"" AS (SELECT *,""login_date"" + INTERVAL '""rnum"" DAY' AS ""groupings"" FROM (SELECT *,-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnum"" FROM ""logins"") AS ""sub11"") SELECT DISTINCT ""sub1"".""id"",""acc"".""name"" FROM (SELECT ""id"",""groupings"",MIN(""login_date""),MAX(""login_date""),COUNT(1) FROM ""cte"" GROUP BY 1,2 HAVING MAX(""login_date"") - MIN(""login_date"")>=4) AS ""sub1"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""sub1"".""id"" ORDER BY 1"
36,"SELECT DISTINCT ""acc"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""duration"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""c"".""id""=""acc"".""id"" WHERE ""c"".""duration""=4 ORDER BY ""acc"".""id"""
37,"WITH ""consecutive"" AS (SELECT *,CASE WHEN ""login_date"" - LAG(""login_date"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"")=1 THEN 1 ELSE 0 END AS ""cons_flag"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""a""), ""cum_sum"" AS (SELECT *,SUM(""cons_flag"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"" ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS ""cum_sum"" FROM ""consecutive"") SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM ""cum_sum"" AS ""a"" LEFT JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""cum_sum""=4"
38,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""m"" AS (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(""l2"".""login_date"") AS ""date_count"" FROM ""t"" AS ""l1"" JOIN ""t"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 AND ""l2"".""login_date"">""l1"".""login_date"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING ""date_count"">=4) SELECT DISTINCT ""m"".""id"",""accounts"".""name"" FROM ""m"" JOIN ""accounts"" ON ""m"".""id""=""accounts"".""id"" ORDER BY ""m"".""id"""
39,"WITH ""CTE"" AS (SELECT *,""login_date"" + INTERVAL '""rnum"" DAY' AS ""groupings"" FROM (SELECT *,-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnum"" FROM ""logins"") AS ""sub3"") SELECT DISTINCT ""sub1"".""id"",""acc"".""name"" FROM (SELECT ""id"",""groupings"",MIN(""login_date""),MAX(""login_date""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"",COUNT(""id"") FROM ""cte"" GROUP BY 1,2 HAVING MAX(""login_date"") - MIN(""login_date"")>=4) AS ""sub1"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""sub1"".""id"" ORDER BY 1"
40,"WITH ""cte1"" AS (SELECT ""temp"".""id"",""temp"".""login_date"",ROW_NUMBER() OVER (PARTITION BY ""temp"".""id"" ORDER BY ""temp"".""login_date"") AS ""ranked_dates"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""temp""), ""cte_2"" AS (SELECT ""id"",MAX(""login_date"") - MIN(""login_date"")+1 AS ""diff_days"" FROM ""cte1"" GROUP BY ""id"",""login_date"" + INTERVAL '-""ranked_dates"" DAY') SELECT DISTINCT ""id"",""name"" FROM ""cte_2"" AS ""c2"" JOIN ""accounts"" AS ""a"" USING (""id"") WHERE ""diff_days"">=5 ORDER BY ""id"""
41,"SELECT DISTINCT ""L1"".""ID"",""A"".""NAME"" FROM (""LOGINS"" AS ""L1"" JOIN ""LOGINS"" AS ""L2"" ON ""L1"".""ID""=""L2"".""ID"" AND ""L2"".""LOGIN_DATE"" - ""L1"".""LOGIN_DATE"" BETWEEN 1 AND 4) LEFT JOIN ""ACCOUNTS"" AS ""A"" ON ""A"".""ID""=""L1"".""ID"" GROUP BY ""L1"".""ID"",""L1"".""LOGIN_DATE"" HAVING COUNT(DISTINCT ""L2"".""LOGIN_DATE"")=4"
42,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
43,"WITH ""userLogins"" AS (SELECT ""lg"".""id"",""lg"".""login_date"",LEAD(""lg"".""login_date"", 4) OVER (PARTITION BY ""lg"".""id"" ORDER BY ""lg"".""login_date"") AS ""fivedays"" FROM (SELECT DISTINCT ""l"".* FROM ""logins"" AS ""l"") AS ""lg"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""userLogins"" AS ""ul"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""ul"".""id"" WHERE ""ul"".""fivedays"" IS NOT NULL AND ""ul"".""fivedays"" - ""ul"".""login_date""=4 ORDER BY ""a"".""id"""
44,"WITH ""add_rank_num"" AS (SELECT ""id"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rank_num"",""login_date"" FROM ""Logins""), ""add_date_diff"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rank_num"" DAY' AS ""diff"",""login_date"",""rank_num"" FROM ""add_rank_num""), ""add_count"" AS (SELECT ""id"",COUNT(DISTINCT ""login_date"") AS ""n"" FROM ""add_date_diff"" GROUP BY ""id"",""diff"" HAVING ""n"">=5) SELECT DISTINCT ""add_count"".""id"",""Accounts"".""name"" FROM ""add_count"" JOIN ""Accounts"" ON ""add_count"".""id""=""Accounts"".""id"" ORDER BY ""id"""
45,"WITH ""a"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""b"" AS (SELECT ""id"",""login_date"",""login_date"" - INTERVAL '(ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"")) DAY' AS ""g"" FROM ""a"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""b"" GROUP BY ""id"",""g"" HAVING COUNT(1)>=5) ORDER BY ""id"""
46,"WITH ""table1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""table2"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""table1""), ""table3"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rk"" DAY' AS ""diff"" FROM ""table2"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""table3"" GROUP BY ""id"",""diff"" HAVING COUNT(1)>=5) ORDER BY ""id"""
47,"WITH ""date_rank"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins"") SELECT DISTINCT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""date_rank"" GROUP BY ""id"",""login_date"" - INTERVAL '""rnk"" DAY' HAVING COUNT(DISTINCT ""login_date"")>=5) ORDER BY 1"
48,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""gap"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""c"") AS ""d"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""d"".""id"" WHERE ""gap""=4 ORDER BY ""a"".""id"""
49,"SELECT DISTINCT ""a"".""id"",""ac"".""name"" FROM (SELECT ""id"",""login_date"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"") AS ""a"" JOIN ""Accounts"" AS ""ac"" USING (""id"") WHERE ""a"".""diff""=4 ORDER BY ""a"".""id"""
50,"WITH ""tmp"" AS (SELECT DISTINCT ""ina"".""id"",""name"",""login_date"" FROM (""Accounts"" AS ""ina"") CROSS JOIN ""Logins"" AS ""inb"" WHERE ""ina"".""id""=""inb"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",""login_date"" + INTERVAL '-""r_number"" DAY' AS ""grp"" FROM (SELECT ""id"",""name"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""r_number"" FROM ""tmp"") AS ""inc"") AS ""ind"" GROUP BY ""id"",""name"",""grp"" HAVING COUNT(1)>=5"
51,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN (SELECT ""id"",""daynum""-""rowid"" AS ""daydiff"",COUNT(""daynum""-""rowid"") AS ""count_c"" FROM (SELECT DISTINCT ""id"",EXTRACT(EPOCH FROM ""login_date"") AS ""daynum"",DENSE_RANK() OVER (ORDER BY ""id"",""login_date"") AS ""rowid"" FROM ""logins"" ORDER BY ""id"",""login_date"") AS ""d"" GROUP BY ""id"",""daydiff"") AS ""c"" ON ""c"".""id""=""a"".""id"" AND ""c"".""count_c"">=5 ORDER BY ""a"".""id"""
52,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
53,"SELECT DISTINCT ""a"".""id"",""name"" FROM ""accounts"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ROW(""a"".""id"",""login_date"" + INTERVAL '1 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '2 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '3 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '4 DAY') IN (SELECT * FROM ""logins"") ORDER BY 1"
54,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"",LEAD(""l"".""login_date"", 4) OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""lead_date"",""l"".""login_date"" + INTERVAL '4 DAY' AS ""fifth_day"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"") AS ""sub"" WHERE ""lead_date""=""fifth_day"""
55,"WITH ""T1"" AS (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ranks"" FROM ""Logins""), ""T2"" AS (SELECT ""id"",""login_date"" - INTERVAL '""ranks"" DAY' AS ""diff"",COUNT(1) AS ""num"" FROM ""T1"" GROUP BY 1,2) SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""T2"" WHERE ""num"">4) ORDER BY ""id"""
56,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
57,"WITH ""cte"" AS (SELECT ""l"".""id"",""l"".""login_date"" FROM ""Logins"" AS ""l"" GROUP BY 1,2 ORDER BY 1,2) SELECT DISTINCT ""temp"".""id"",""temp"".""name"" FROM (SELECT ""cte"".""id"",""a"".""name"",""cte"".""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""cte"".""id"" ORDER BY ""login_date"") DAY' AS ""grp_dt"" FROM ""cte"" LEFT JOIN ""accounts"" AS ""a"" ON ""cte"".""id""=""a"".""id"") AS ""temp"" GROUP BY ""temp"".""id"",""temp"".""grp_dt"" HAVING COUNT(1)>=5"
58,"WITH ""unique_login_dates"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2) SELECT ""temp4"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT ""temp3"".""id"" AS ""id"" FROM (SELECT ""temp2"".""id"" AS ""id"",""temp2"".""grouping_variable"" AS ""grouping_variable"",MAX(""temp2"".""login_date"") AS ""max_login_date"",MIN(""temp2"".""login_date"") AS ""min_login_date"" FROM (SELECT *,""temp"".""login_date"" - INTERVAL '""temp"".""rownumber"" DAY' AS ""grouping_variable"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rownumber"" FROM ""unique_login_dates"") AS ""temp"") AS ""temp2"" GROUP BY ""temp2"".""id"",""temp2"".""grouping_variable"") AS ""temp3"" WHERE ""temp3"".""max_login_date"" - ""temp3"".""min_login_date""+1>=5) AS ""temp4"" ON ""a"".""id""=""temp4"".""id"" GROUP BY 1 ORDER BY 1"
59,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",DAYOFYEAR(""login_date"") AS ""doy"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""cte""), ""cte3"" AS (SELECT ""id"" FROM ""cte1"" GROUP BY ""id"",""doy""-""rn"" HAVING COUNT(1)>=5) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (""accounts"" AS ""a"") CROSS JOIN ""cte3"" AS ""c"" WHERE ""a"".""id""=""c"".""id"" ORDER BY ""id"""
60,"WITH ""cte"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins"") SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""login_date"" - INTERVAL '""rnk"" DAY' HAVING COUNT(DISTINCT ""login_date"")>=5) ORDER BY 1"
61,"WITH ""t"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""st"" FROM ""logins"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""t"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""t"".""id"" GROUP BY ""st"",""a"".""id"",""a"".""name"" HAVING COUNT(DISTINCT ""login_date"")>=5 ORDER BY 1"
62,"WITH ""sub"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""leading_date"" FROM ""logins"" GROUP BY 1,2) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""sub"" ON ""sub"".""id""=""a"".""id"" AND ""sub"".""leading_date"" - ""login_date""=4 ORDER BY 1"
63,"WITH ""lead5"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"" DESC) AS ""five_after"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""l"") SELECT DISTINCT ""l5"".""id"",""a"".""Name"" AS ""name"" FROM ""lead5"" AS ""l5"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l5"".""id""=""a"".""id"" WHERE ""login_date"" + INTERVAL '-4 DAY'=""five_after"" ORDER BY 1"
64,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" - INTERVAL '""row_num"" DAY' AS ""groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""first_login"",MAX(""login_date"") AS ""last_login"" FROM ""temp1"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4) SELECT DISTINCT ""id"",""name"" FROM ""answer_table"" JOIN ""accounts"" USING (""id"") ORDER BY ""answer_table"".""id"""
65,"SELECT DISTINCT ""temp"".""id"",""a"".""name"" FROM (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_day"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""unique_t"" ORDER BY ""id"",""login_date"") AS ""temp"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""temp"".""id"" WHERE ""lead_day"" - ""login_date""=4"
66,"SELECT DISTINCT ""Accounts"".""id"",""name"" FROM (SELECT ""l1"".""id"",""l1"".""login_date"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5) AS ""a"" LEFT JOIN ""Accounts"" ON ""Accounts"".""id""=""a"".""id"""
67,"SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM (SELECT ""id"",""login_date"",""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""group_day"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"") AS ""l"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY ""l"".""id"",""l"".""group_day"" HAVING COUNT(1)>=5"
68,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
69,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""temp1"".""id"",""login_date"",""login_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""temp"",""name"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""temp1"" LEFT JOIN ""accounts"" AS ""a"" ON ""temp1"".""id""=""a"".""id"") AS ""temp2"" GROUP BY ""id"",""temp"" HAVING COUNT(""id"")>=5"
70,"WITH ""cte"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t""), ""cte2"" AS (SELECT ""id"",COUNT(""start_dt"") OVER (PARTITION BY ""id"", ""start_dt"") AS ""cnt"" FROM (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""start_dt"" FROM ""cte"") AS ""t"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte2"" AS ""c"" LEFT JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""cnt"">=5 ORDER BY ""c"".""id"""
71,"WITH ""gaps_and_islands"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""a""), ""filled_gaps"" AS (SELECT ""id"",""login_date"",""rnk"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""nw_date"" FROM ""gaps_and_islands"") SELECT DISTINCT ""a"".""id"",""name"" FROM (SELECT ""id"" FROM ""filled_gaps"" GROUP BY ""id"",""nw_date"" HAVING COUNT(1)>=5) AS ""a"" LEFT JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"""
72,"WITH ""cte"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""ld_group"" FROM ""logins"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" GROUP BY ""id"",""ld_group"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""c"".""id"""
73,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
74,"SELECT DISTINCT ""temp"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""temp"" JOIN ""Accounts"" AS ""a"" ON ""temp"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY 1"
75,"WITH ""cte"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ld"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" ORDER BY ""id"",""login_date"") AS ""a"") SELECT DISTINCT ""cte"".""id"",""a"".""name"" FROM ""cte"" JOIN ""accounts"" AS ""a"" ON ""cte"".""id""=""a"".""id"" WHERE ""ld"" - ""login_date""=4 ORDER BY ""cte"".""id"""
76,"WITH ""temp0"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2 ORDER BY 1,2), ""temp1"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_4"" FROM ""temp0"") SELECT ""a"".""id"",""b"".""name"" FROM ""temp1"" AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""login_date"" - ""a"".""lag_4""=4 GROUP BY 1,2"
77,"WITH ""uni"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""win"" AS (SELECT ""l"".""id"",""l"".""login_date"",SUM(CASE WHEN ""r"".""login_date"" IS NULL THEN 1 ELSE 0 END) OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""con_int"" FROM ""uni"" AS ""l"" LEFT JOIN ""uni"" AS ""r"" ON ""l"".""id""=""r"".""id"" AND ""l"".""login_date"" + INTERVAL '-1 DAY'=""r"".""login_date""), ""agg"" AS (SELECT ""id"",""con_int"",COUNT(DISTINCT ""login_date"") AS ""ct_days"" FROM ""win"" GROUP BY 1,2) SELECT ""ag"".""id"",""ac"".""name"" FROM ""agg"" AS ""ag"" JOIN ""accounts"" AS ""ac"" ON ""ag"".""id""=""ac"".""id"" GROUP BY 1,2 HAVING MAX(""ag"".""ct_days"")>=5 ORDER BY 1,2"
78,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""r"" AS (SELECT ""t1"".""id"",""t1"".""login_date"",COUNT(""t2"".""login_date"") FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date""<=""t1"".""login_date"" + INTERVAL '4 DAY' AND ""t2"".""login_date"">=""t1"".""login_date"" GROUP BY 1,2 HAVING COUNT(""t2"".""login_date"")>=5) SELECT DISTINCT ""r"".""id"",""a"".""name"" FROM ""r"" JOIN ""accounts"" AS ""a"" ON ""r"".""id""=""a"".""id"" ORDER BY 1"
79,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date""<""b"".""login_date"" WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
80,"WITH ""distict_login"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") SELECT ""t"".""id"",""a"".""name"" FROM (SELECT DISTINCT (""l1"".""id"") AS ""id"" FROM (""distict_login"" AS ""l1"") CROSS JOIN ""distict_login"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"">=""l2"".""login_date"" AND ""l1"".""login_date"" - ""l2"".""login_date""<=4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(""l1"".""id"")>=5) AS ""t"" LEFT JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" ORDER BY 1"
81,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
82,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
83,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4) ORDER BY ""id"""
84,"SELECT ""a"".""id"",""name"" FROM (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""diff"",COUNT(DISTINCT ""login_date"") AS ""conse_days"" FROM (SELECT ""id"",""login_date"",(""date_inteval""-""rnk"") AS ""diff"" FROM (SELECT ""id"",""login_date"",""login_date"" - CAST('2020-01-01' AS DATE) AS ""date_inteval"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""a"") AS ""a"" GROUP BY ""id"",""diff"") AS ""a"" WHERE ""conse_days"">=5) AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" ORDER BY 1"
85,"SELECT DISTINCT ""l1"".""id"",""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l2"".""id""=""l1"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
86,"SELECT DISTINCT ""c"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
87,"SELECT DISTINCT ""a"".""id"",""Accounts"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" ON ""a"".""id""=""Accounts"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
88,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
89,"WITH ""cte1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""rk"" DAY' AS ""marking"" FROM ""cte1"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte2"" GROUP BY ""id"",""marking"" HAVING COUNT(DISTINCT ""login_date"")>=5) ORDER BY ""id"""
90,"SELECT ""sub2"".""id"",""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT ""id"",CASE WHEN LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date""=4 THEN 1 ELSE 0 END AS ""filter"" FROM (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2) AS ""sub"") AS ""sub2"" ON ""a"".""id""=""sub2"".""id"" WHERE ""filter""=1 GROUP BY ""sub2"".""id"" ORDER BY ""id"""
91,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""r"" AS (SELECT ""t1"".""id"",""t1"".""login_date"",COUNT(""t2"".""login_date"") FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date""<=""t1"".""login_date"" + INTERVAL '4 DAY' AND ""t2"".""login_date"">=""t1"".""login_date"" GROUP BY 1,2 HAVING COUNT(""t2"".""login_date"")>=5) SELECT DISTINCT ""r"".""id"",""a"".""name"" FROM ""r"" JOIN ""accounts"" AS ""a"" ON ""r"".""id""=""a"".""id"" ORDER BY 1"
92,"SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""a"".""id"" FROM ""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) ORDER BY ""id"""
93,"WITH ""tmp"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""t"") SELECT DISTINCT ""a"".* FROM ""accounts"" AS ""a"" JOIN ""tmp"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""login_date"" - ""lag_date""=4 ORDER BY 1"
94,"SELECT DISTINCT ""a"".* FROM (""accounts"" AS ""a"" JOIN ""logins"" AS ""l1"" USING (""id"")) JOIN ""logins"" AS ""l2"" ON ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""a"".""id"""
95,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
96,"WITH ""x"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2), ""two"" AS (SELECT ""x1"".""id"",""x1"".""login_date"",""a"".""name"",COUNT(DISTINCT ""x2"".""login_date"") AS ""day_cnt"" FROM (""x"" AS ""x1"" LEFT JOIN ""x"" AS ""x2"" ON ""x2"".""login_date"" BETWEEN ""x1"".""login_date"" AND ""x1"".""login_date"" + INTERVAL '4 DAY' AND ""x1"".""id""=""x2"".""id"") LEFT JOIN ""Accounts"" AS ""a"" ON ""x1"".""id""=""a"".""id"" GROUP BY 1,2,3) SELECT DISTINCT ""id"",""name"" FROM ""two"" WHERE ""day_cnt"">=5"
97,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""leading_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_date"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""leading_date""=""b"".""fifth_date"" ORDER BY ""a"".""id"""
98,"WITH ""row_logins"" AS (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"",ROW_NUMBER() OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""rn"" FROM (""logins"" AS ""l"") CROSS JOIN ""accounts"" AS ""a"" WHERE ""l"".""id""=""a"".""id"" GROUP BY ""l"".""id"",""l"".""login_date"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""row_logins"" AS ""a"" JOIN ""row_logins"" AS ""b"" ON (""a"".""id""=""b"".""id"" AND ""a"".""rn""=""b"".""rn""+4) AND ""a"".""login_date"" - ""b"".""login_date""=4"
99,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""r"" AS (SELECT ""t1"".""id"",""t1"".""login_date"",COUNT(""t2"".""login_date"") FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date""<=""t1"".""login_date"" + INTERVAL '4 DAY' AND ""t2"".""login_date"">=""t1"".""login_date"" GROUP BY 1,2 HAVING COUNT(""t2"".""login_date"")>=5) SELECT DISTINCT ""r"".""id"",""a"".""name"" FROM ""r"" JOIN ""accounts"" AS ""a"" ON ""r"".""id""=""a"".""id"" ORDER BY 1"
100,"WITH ""id_gap"" AS (SELECT DISTINCT ""id"",""login_date"",""login_date"" + INTERVAL '4 DAY' AS ""end_5_cons"" FROM ""Logins"") SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""id_gap"" AS ""a"" JOIN ""id_gap"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" BETWEEN ""a"".""login_date"" AND ""a"".""end_5_cons"") JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(1)>=5"
101,"SELECT DISTINCT ""cte"".""id"",""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_5"" FROM ""logins"" GROUP BY ""id"",""login_date"") AS ""cte"" LEFT JOIN ""Accounts"" AS ""b"" ON ""cte"".""id""=""b"".""id"" WHERE ""cte"".""date_5""=""cte"".""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
102,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_day"" FROM ""logins"" GROUP BY 1,2) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""cte"" ON ""cte"".""id""=""a"".""id"" AND ""cte"".""lead_date""=""cte"".""fifth_day"" ORDER BY ""a"".""id"""
103,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM (SELECT ""id"",""login_date"" + INTERVAL '-(ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"")) DAY' AS ""diff"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""TM1P"") AS ""TMP2"" GROUP BY ""id"",""diff"" HAVING COUNT(1)>=5) ORDER BY ""id"""
104,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
105,"SELECT ""l"".""id"",""ac"".""name"" FROM (SELECT DISTINCT ""a"".""id"" FROM ""Logins"" AS ""a"" LEFT JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4) AS ""l"" LEFT JOIN ""Accounts"" AS ""ac"" ON ""l"".""id""=""ac"".""id"""
106,"WITH ""cte"" AS (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""final"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""cte"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" WHERE ""final""=4 ORDER BY ""id"""
107,"WITH ""temp1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""temp2"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '4 DAY' AS ""five_day"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""temp1"") SELECT DISTINCT ""a"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM (SELECT ""t1"".""id"",""t1"".""login_date"",""t1"".""five_day"",""t1"".""rk"" AS ""first"",""t2"".""rk"" AS ""last"" FROM (""temp2"" AS ""t1"") CROSS JOIN ""temp2"" AS ""t2"" WHERE ""t1"".""five_day""=""t2"".""login_date"" AND ""t1"".""id""=""t2"".""id"" AND ""t2"".""rk""=""t1"".""rk""+4) AS ""t"" JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" ORDER BY ""id"""
108,"WITH ""r"" AS (SELECT ""id"",""login_date"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""t"") SELECT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" LEFT JOIN (SELECT ""r"".""id"",""r"".""login_date"" + INTERVAL '-""rk"" DAY',COUNT(1) AS ""n"" FROM ""r"" GROUP BY 1,2) AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY 1 HAVING MAX(""n"")>=5 ORDER BY 1"
109,"WITH ""t"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") SELECT ""d"".""id"",""name"" FROM (SELECT DISTINCT ""t1"".""id"" FROM (""t"" AS ""t1"") CROSS JOIN ""t"" AS ""t2"" WHERE ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"">=4 AND ""t1"".""rnk""-""t2"".""rnk"">=4 AND ""t1"".""login_date"" - ""t2"".""login_date""=""t1"".""rnk""-""t2"".""rnk"") AS ""d"" JOIN ""Accounts"" AS ""a"" ON ""d"".""id""=""a"".""id"" ORDER BY ""d"".""id"""
110,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
111,"WITH ""tbl"" AS (SELECT DISTINCT ""id"",""login_date"",""login_date"" + INTERVAL '4 DAY' AS ""end_date"" FROM ""Logins""), ""tbl2"" AS (SELECT DISTINCT ""t1"".""id"" FROM ""tbl"" AS ""t1"" JOIN ""tbl"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date"">=""t1"".""login_date"" AND ""t2"".""login_date""<=""t1"".""end_date"" GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(""t2"".""login_date"")=5) SELECT ""t"".""id"",""a"".""name"" FROM ""tbl2"" AS ""t"" JOIN ""accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" ORDER BY ""t"".""id"""
112,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""l1"".""id"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"">=""l1"".""login_date"" AND ""l2"".""login_date""<""l1"".""login_date"" + INTERVAL '5 DAY' GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5) AS ""l"" ON ""a"".""id""=""l"".""id"" ORDER BY ""a"".""id"""
113,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
114,"SELECT DISTINCT ""a"".""id"",""s"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""s"" ON ""a"".""id""=""s"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
115,"WITH ""cte"" AS (SELECT DISTINCT ""l"".""id"",""name"",""login_date"" FROM (""accounts"" AS ""a"") CROSS JOIN ""logins"" AS ""l"" WHERE ""a"".""id""=""l"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""var"" FROM ""cte"") AS ""a"" WHERE ""var"" - ""login_date""=4"
116,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"") JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
117,"WITH ""t"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""m"" AS (SELECT ""id"",""login_date"" AS ""d1"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""d5"" FROM ""t"") SELECT DISTINCT ""a"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM ""m"" JOIN ""accounts"" AS ""a"" ON ""m"".""id""=""a"".""id"" WHERE ""m"".""d1""=""m"".""d5"" - INTERVAL '4 DAY' ORDER BY ""id"""
118,"SELECT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_day"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY 1,2,3) AS ""x"") AS ""y"" WHERE ""lead_date""=""fifth_day"" GROUP BY 1,2"
119,"SELECT DISTINCT ""id"",""name"" FROM (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_day"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""l"") AS ""t"" JOIN ""Accounts"" AS ""a"" USING (""id"") WHERE ""fifth_day"" - ""login_date""=4 ORDER BY 1"
120,"WITH ""t1"" AS (SELECT * FROM ""logins"" AS ""l"" JOIN ""accounts"" AS ""a"" USING (""id"")) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (""t1"" AS ""a"") CROSS JOIN ""t1"" AS ""b"" WHERE ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 AND ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
121,"WITH ""cte"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""groupings"" FROM ""cte""), ""cte2"" AS (SELECT ""id"",""groupings"",MIN(""login_date"") AS ""start_date"",MAX(""login_date"") AS ""end_date"" FROM ""cte1"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""start_date"") SELECT DISTINCT ""c"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM ""cte2"" AS ""c"" JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
122,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
123,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_lag"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t1"" ORDER BY ""login_date"") SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM ""cte"" AS ""l"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" WHERE ""login_date"" - ""login_lag""=4 ORDER BY ""l"".""id"""
124,"SELECT DISTINCT ""a"".""id"",""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""Logins"" GROUP BY 1,2) AS ""temp"" JOIN ""Accounts"" AS ""a"" ON ""temp"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
125,"SELECT DISTINCT ""Accounts"".""id"",""name"" FROM (SELECT ""id"",""rot"" FROM (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (ORDER BY ""id"",""login_date""),(LAG(""login_date"", 4) OVER (ORDER BY ""id"",""login_date"") + INTERVAL '4 DAY'=""login_date"") AND (LAG(""id"", 4) OVER (ORDER BY ""id"",""login_date"")=""id"") AS ""rot"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""a"" ORDER BY ""id"",""login_date"") AS ""b"" WHERE ""b"".""rot""=1) AS ""c"" CROSS, ""Accounts"" WHERE ""c"".""id""=""Accounts"".""id"" ORDER BY ""Accounts"".""id"""
126,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
127,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
128,"WITH ""distinctt"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""pre"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_val"" FROM ""distinctt"") SELECT DISTINCT ""p"".""id"",""name"" FROM ""pre"" AS ""p"" JOIN ""accounts"" AS ""a"" ON ""p"".""id""=""a"".""id"" WHERE ""next_val"" - ""login_date""=4 ORDER BY ""p"".""id"""
129,"SELECT ""id"".""id"",""a"".""name"" FROM (SELECT DISTINCT ""l1"".""id"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4) AS ""id"" LEFT JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""id"".""id"""
130,"WITH ""TEMP"" AS (SELECT ""ID"",DAYOFYEAR(""LOGIN_DATE"")-CAST(ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""LOGIN_DATE"") AS INTEGER) AS ""GRP"" FROM (SELECT DISTINCT * FROM ""LOGINS"") AS ""T"") SELECT DISTINCT ""A"".""ID"",""A"".""NAME"" FROM (""ACCOUNTS"" AS ""A"") CROSS JOIN ""TEMP"" AS ""T"" WHERE ""A"".""ID""=""T"".""ID"" GROUP BY ""A"".""ID"",""A"".""NAME"",""GRP"" HAVING COUNT(1)>=5"
131,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
132,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""a"".""id"""
133,"SELECT DISTINCT ""D"".""id"",""a"".""name"" FROM (SELECT ""C"".""id"" FROM (SELECT ""B"".""id"",""B"".""consec_ref"",COUNT(""B"".""login_date"") AS ""no_consec"" FROM (SELECT ""A"".""id"",""A"".""login_date"",""A"".""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""A"".""id"" ORDER BY ""A"".""login_date"") DAY' AS ""consec_ref"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""A"") AS ""B"" GROUP BY ""B"".""id"",""B"".""consec_ref"") AS ""C"" WHERE ""C"".""no_consec"">=5) AS ""D"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""D"".""id"""
134,"WITH ""base"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"") AS ""fifth_dt"" FROM (SELECT * FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") SELECT ""p"".""id"",""q"".""name"" FROM (SELECT *,CASE WHEN (""login_date"" + INTERVAL '4 DAY'=""fifth_dt"") THEN 1 ELSE 0 END AS ""result"" FROM ""base"") AS ""p"" JOIN ""Accounts"" AS ""q"" ON ""p"".""id""=""q"".""id"" WHERE ""result""=1 GROUP BY ""p"".""id"",""q"".""name"" ORDER BY ""p"".""id"""
135,"WITH ""cte"" AS (SELECT ""c"".""id"",""name"",""ndate"" FROM (SELECT ""id"",""login_date"",""login_date"" - INTERVAL '""rn"" DAY' AS ""ndate"" FROM (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""ac"" ON ""c"".""id""=""ac"".""id"" GROUP BY ""id"",""ndate"" HAVING COUNT(1)>=5) SELECT DISTINCT ""id"",""name"" FROM ""cte"" ORDER BY ""id"""
136,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte1""), ""cte3"" AS (SELECT ""id"",""lead_date"" - ""login_date"" AS ""date_diff"" FROM ""cte2"") SELECT DISTINCT ""cte3"".""id"",""a"".""name"" FROM ""cte3"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte3"".""id"" WHERE ""cte3"".""date_diff""=4 ORDER BY 1"
137,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grp_date"" FROM (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins"") AS ""t"") SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grp_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
138,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
139,"WITH ""unique_log"" AS (SELECT * FROM ""Logins"" GROUP BY ""id"",""login_date""), ""rank_table"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""unique_log""), ""res"" AS (SELECT ""r1"".""id"" FROM ""rank_table"" AS ""r1"" JOIN ""rank_table"" AS ""r2"" ON ""r1"".""id""=""r2"".""id"" AND ""r1"".""rnk""+4=""r2"".""rnk"" AND ""r2"".""login_date"" - ""r1"".""login_date""=4 GROUP BY ""r1"".""id"") SELECT ""r3"".""id"",""a"".""name"" FROM ""res"" AS ""r3"" JOIN ""Accounts"" AS ""a"" ON ""r3"".""id""=""a"".""id"" ORDER BY ""r3"".""id"""
140,"WITH ""cte"" AS (SELECT ""l"".""id"",""l"".""login_date"" FROM ""logins"" AS ""l"" GROUP BY 1,2) SELECT DISTINCT ""temp"".""id"",""temp"".""name"" FROM (SELECT ""c"".""id"",""a"".""name"",""c"".""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""grp"" FROM ""cte"" AS ""c"" LEFT JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"") AS ""temp"" GROUP BY ""id"",""grp"" HAVING COUNT(""temp"".""id"")>=5"
141,"SELECT DISTINCT ""t"".""id"",""a"".""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_day"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""t"" LEFT JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" WHERE ""fifth_day"" - ""login_date"">=4 AND ""login_date"" + INTERVAL '4 DAY'=""fifth_day"""
142,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""five_days"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""gap"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""c"") AS ""d"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""d"".""id"" WHERE ""gap""=4 ORDER BY ""a"".""id"""
143,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
144,"SELECT DISTINCT ""A"".""ID"",""A"".""NAME"" FROM (""ACCOUNTS"" AS ""A"") CROSS JOIN ""LOGINS"" AS ""L"" WHERE ""A"".""ID""=""L"".""ID"" AND EXISTS (SELECT 'X' FROM ""LOGINS"" AS ""LL"" WHERE ""LL"".""ID""=""L"".""ID"" AND ""LL"".""LOGIN_DATE""=""L"".""LOGIN_DATE"" + INTERVAL '1 DAY') AND EXISTS (SELECT 'X' FROM ""LOGINS"" AS ""LL"" WHERE ""LL"".""ID""=""L"".""ID"" AND ""LL"".""LOGIN_DATE""=""L"".""LOGIN_DATE"" + INTERVAL '2 DAY') AND EXISTS (SELECT 'X' FROM ""LOGINS"" AS ""LL"" WHERE ""LL"".""ID""=""L"".""ID"" AND ""LL"".""LOGIN_DATE""=""L"".""LOGIN_DATE"" + INTERVAL '3 DAY') AND EXISTS (SELECT 'X' FROM ""LOGINS"" AS ""LL"" WHERE ""LL"".""ID""=""L"".""ID"" AND ""LL"".""LOGIN_DATE""=""L"".""LOGIN_DATE"" + INTERVAL '4 DAY') ORDER BY ""A"".""ID"""
145,"WITH ""Tbl"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""id"",""login_date"") AS ""rn"",""id"",""login_date"",""login_date"" - INTERVAL '(ROW_NUMBER() OVER (ORDER BY ""id"",""login_date"")) DAY' AS ""grp"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""M"") SELECT DISTINCT ""Tbl"".""id"",""A"".""name"" FROM ""Tbl"" LEFT JOIN ""Accounts"" AS ""A"" ON ""Tbl"".""id""=""A"".""id"" GROUP BY ""Tbl"".""id"",""Tbl"".""grp"",""A"".""name"" HAVING COUNT(1)>=5"
146,"SELECT DISTINCT ""sub2"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""gap"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""sub1"") AS ""sub2"" JOIN ""Accounts"" ON ""sub2"".""id""=""Accounts"".""id"" WHERE ""gap""=4 ORDER BY ""sub2"".""id"""
147,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4 ORDER BY ""l1"".""id"""
148,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4 ORDER BY ""l1"".""id"""
149,"SELECT DISTINCT ""q"".""id"",""b"".""name"" FROM (SELECT ""p"".""id"",""new_date"",COUNT(""new_date"") AS ""cnt"" FROM (SELECT ""t"".""id"",""t"".""login_date"",""t"".""login_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""t"".""id"" ORDER BY ""t"".""login_date"") DAY' AS ""new_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""LOGINS"") AS ""t"") AS ""p"" GROUP BY ""p"".""id"",""p"".""new_date"" HAVING COUNT(""new_date"")>=5) AS ""q"" JOIN ""accounts"" AS ""b"" ON ""q"".""id""=""b"".""id"" ORDER BY ""q"".""id"""
150,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) LEFT JOIN ""Accounts"" AS ""c"" ON ""c"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
151,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING (COUNT(DISTINCT ""l2"".""login_date""))=4"
152,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" AS ""ac"" WHERE ""ac"".""id""=""a"".""id"") AS ""name"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
153,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" LEFT JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""a"".""id"",""a"".""login_date"""
154,"ERROR: mysql parse error: line 1 column 238 near ""valid_users inner join Accounts on valid_users.id = Accounts.id order by id "" "
155,"WITH ""TEMP"" AS (SELECT ""A"".""ID"",""A"".""NAME"" AS ""NAME"",DAYOFYEAR(""L"".""LOGIN_DATE"")-CAST(ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""L"".""LOGIN_DATE"") AS INTEGER) AS ""GRP"" FROM (""ACCOUNTS"" AS ""A"") CROSS JOIN (SELECT DISTINCT * FROM ""LOGINS"") AS ""L"" WHERE ""A"".""ID""=""L"".""ID""), ""TEMP2"" AS (SELECT ""ID"",""NAME"",COUNT(1) AS ""CNT"" FROM ""TEMP"" GROUP BY ""ID"",""NAME"",""GRP"") SELECT DISTINCT ""ID"",""NAME"" FROM ""TEMP2"" WHERE ""CNT"">=5"
156,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
157,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
158,"WITH ""consecutive_ids"" AS (SELECT ""a"".""id"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 AND ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) SELECT DISTINCT ""x"".""id"",""y"".""name"" FROM ""consecutive_ids"" AS ""x"" JOIN ""Accounts"" AS ""y"" USING (""id"") ORDER BY ""x"".""id"""
159,"WITH ""log_lag"" AS (SELECT DISTINCT ""id"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""l2""), ""dlog"" AS (SELECT DISTINCT ""id"" FROM ""log_lag"" WHERE ""diff""=4) SELECT DISTINCT ""d"".""id"",""a"".""name"" FROM ""dlog"" AS ""d"" JOIN ""Accounts"" AS ""a"" ON ""d"".""id""=""a"".""id"" ORDER BY ""id"""
160,"SELECT DISTINCT ""t1"".""id"",""Accounts"".""name"" FROM (SELECT ""a"".""id"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) AS ""t1"" JOIN ""Accounts"" ON ""Accounts"".""id""=""t1"".""id"" ORDER BY ""t1"".""id"""
161,"WITH ""tmp"" AS (SELECT ""a"".""id"",""a"".""login_date"",""min_date"" + INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"")-1 DAY' AS ""seq_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""a"" JOIN (SELECT ""id"",MIN(""login_date"") AS ""min_date"" FROM ""logins"" GROUP BY 1) AS ""b"" ON ""a"".""id""=""b"".""id"") SELECT DISTINCT ""a"".* FROM ""accounts"" AS ""a"" JOIN ""tmp"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""login_date"" - ""seq_date"" HAVING COUNT(1)>=5 ORDER BY 1"
162,"WITH ""cte"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_day"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""unique_t"" ORDER BY ""id"",""login_date"") SELECT DISTINCT ""cte"".""id"",""a"".""name"" FROM ""cte"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" WHERE ""lead_day"" - ""login_date""=4"
163,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM (SELECT DISTINCT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Logins"" AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"") AS ""b"") SELECT DISTINCT ""c1"".""id"",""c1"".""name"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""id""=""c2"".""id"" AND ""c2"".""rn""=""c1"".""rn""+4 AND ""c2"".""login_date"" - ""c1"".""login_date""=4 ORDER BY 1"
164,"SELECT DISTINCT ""ls"".""id"",""ls"".""name"" FROM (SELECT ""p"".""id"",""p"".""name"",""p"".""date_dif"",COUNT(1) AS ""cnt_r"" FROM (SELECT ""t"".""id"",""a"".""name"",""t"".""login_date"",""t"".""login_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""t"".""id"" ORDER BY ""t"".""login_date"") DAY' AS ""date_dif"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""t"" JOIN ""accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"") AS ""p"" GROUP BY ""p"".""id"",""p"".""name"",""p"".""date_dif"") AS ""ls"" WHERE ""ls"".""cnt_r"">=5 ORDER BY ""ls"".""id"""
165,"SELECT DISTINCT ""a"".""id"",""name"" FROM ""accounts"" AS ""a"" JOIN (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""b"") AS ""c"" ON ""a"".""id""=""c"".""id"" WHERE ""diff""=4 ORDER BY ""id"""
166,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
167,"SELECT DISTINCT ""l"".""id"",""name"" FROM ""Logins"" AS ""l"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" WHERE ROW(""l"".""id"",""login_date"" - INTERVAL '1 DAY') IN (SELECT * FROM ""Logins"") AND ROW(""l"".""id"",""login_date"" - INTERVAL '2 DAY') IN (SELECT * FROM ""Logins"") AND ROW(""l"".""id"",""login_date"" - INTERVAL '3 DAY') IN (SELECT * FROM ""Logins"") AND ROW(""l"".""id"",""login_date"" - INTERVAL '4 DAY') IN (SELECT * FROM ""Logins"") ORDER BY ""id"""
168,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
169,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_Date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
170,"WITH ""acct_logins"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""accounts"" AS ""a"" JOIN ""logins"" AS ""l"" ON ""a"".""id""=""l"".""id"" ORDER BY 1,3) SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_date"" FROM ""acct_logins"" GROUP BY 1,2,3) AS ""result_table"" WHERE ""lead_date""=""fifth_date"""
171,"WITH ""cte"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t""), ""cte2"" AS (SELECT ""id"",COUNT(""start_dt"") OVER (PARTITION BY ""id"", ""start_dt"") AS ""cnt"" FROM (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""start_dt"" FROM ""cte"") AS ""t"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte2"" AS ""c"" LEFT JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""cnt"">=5 ORDER BY ""c"".""id"""
172,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN (SELECT DISTINCT ""a"".""id"",""a"".""login_date"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""a"" LEFT JOIN (SELECT DISTINCT * FROM ""logins"") AS ""b"" ON ""b"".""login_date"" - ""a"".""login_date"">=0 AND ""b"".""login_date"" - ""a"".""login_date""<=4 AND ""a"".""id""=""b"".""id"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""b"".""login_date"")=5) AS ""b"" ON ""a"".""id""=""b"".""id"" ORDER BY 1"
173,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" USING (""id"") WHERE ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4 ORDER BY ""l1"".""id"""
174,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
175,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
176,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte1""), ""cte3"" AS (SELECT ""id"",""lead_date"" - ""login_date"" AS ""date_diff"" FROM ""cte2"") SELECT DISTINCT ""cte3"".""id"",""a"".""name"" FROM ""cte3"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte3"".""id"" WHERE ""cte3"".""date_diff""=4 ORDER BY 1"
177,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (""Accounts"" AS ""a"" JOIN ""Logins"" AS ""l1"" ON ""a"".""id""=""l1"".""id"") JOIN ""Logins"" AS ""l2"" ON ""a"".""id""=""l2"".""id"" WHERE ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4 GROUP BY 1,2,""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=5"
178,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""l1"".""id"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" USING (""id"") WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4) ORDER BY ""id"""
179,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
180,"WITH ""logins_cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""temp"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_login_date"" FROM ""logins_cte"") SELECT ""id"",""name"" FROM ""accounts"" AS ""a"" WHERE ""id"" IN (SELECT ""id"" FROM ""temp"" WHERE ""fifth_login_date"" - ""login_date""=4) ORDER BY ""id"""
181,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
182,"SELECT DISTINCT ""b"".""id"",""c"".""name"" FROM (SELECT ""a"".""id"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"") AS ""nxt_date"" FROM (SELECT DISTINCT ""id"",""login_date"",COUNT(""id"") AS ""id_ct"" FROM ""logins"" GROUP BY 1,2 ORDER BY 1,2) AS ""a"") AS ""b"" LEFT JOIN ""accounts"" AS ""c"" ON ""b"".""id""=""c"".""id"" WHERE ABS(""b"".""login_date"" - ""b"".""nxt_date"")=4"
183,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=5 ORDER BY ""a"".""id"""
184,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
185,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""Logins"" AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
186,"WITH ""cte"" AS (SELECT DISTINCT * FROM ""logins""), ""temp"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""TEMP"" JOIN ""accounts"" AS ""a"" USING (""id"") WHERE ""lead_date"" - ""login_date""=4 ORDER BY ""a"".""id"""
187,"SELECT DISTINCT ""ina"".""id"",""inc"".""name"" FROM ((""Logins"" AS ""ina"") CROSS JOIN ""Logins"" AS ""inb"") CROSS JOIN ""Accounts"" AS ""inc"" WHERE ""ina"".""id""=""inb"".""id"" AND ""ina"".""login_date"" - ""inb"".""login_date"" BETWEEN 1 AND 4 AND ""ina"".""id""=""inc"".""id"" GROUP BY ""ina"".""id"",""inc"".""name"",""ina"".""login_date"" HAVING COUNT(DISTINCT ""inb"".""login_date"")=4"
188,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""l1"".""id"" AS ""id"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=5) AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"" ORDER BY ""a"".""id"""
189,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
190,"WITH ""cte_x"" AS (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""cte_x"".""id"",""name"" FROM ""cte_x"" JOIN ""Accounts"" ON ""cte_x"".""id""=""Accounts"".""id"" AND ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY 1"
191,"WITH ""temp1"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date""), ""temp2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""diff"" FROM ""temp1"") SELECT ""a"".""id"",""a"".""name"" FROM ""temp2"" AS ""t2"" JOIN ""Accounts"" AS ""a"" ON ""t2"".""id""=""a"".""id"" WHERE ""diff""=4 GROUP BY ""id"" ORDER BY ""id"""
192,"WITH ""orderlogins"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"" DESC) SELECT DISTINCT ""acct"".""id"",""acct"".""name"" FROM ""Accounts"" AS ""acct"" JOIN (SELECT ""id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""num"",""login_date"" FROM ""orderlogins"") AS ""A"" ON ""acct"".""id""=""A"".""id"" GROUP BY ""acct"".""id"",""login_date"" + INTERVAL '-""num"" DAY' HAVING COUNT(""acct"".""id"")>=5"
193,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
194,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""a"".""id"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) ORDER BY 1"
195,"SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM (SELECT DISTINCT ""id"",""login_date"",DAYOFYEAR(""login_date"")-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""grp"" FROM ""logins"") AS ""l"" JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY ""l"".""id"",""grp"" HAVING COUNT(""l"".""login_date"")>=5 ORDER BY ""l"".""id"""
196,"WITH ""logins_ranked"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"",""login_date"" - MIN(""login_date"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"")+1 AS ""date_diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""uniq_id_login"") SELECT DISTINCT ""logins_ranked"".""id"",""accounts"".""name"" FROM ""logins_ranked"" LEFT JOIN ""accounts"" ON ""logins_ranked"".""id""=""accounts"".""id"" GROUP BY ""id"",""date_diff""-""rn"" HAVING COUNT(1)>=5 ORDER BY 1"
197,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
198,"WITH ""unique_log"" AS (SELECT * FROM ""Logins"" GROUP BY ""id"",""login_date""), ""rank_table"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""unique_log""), ""res"" AS (SELECT ""r1"".""id"" FROM ""rank_table"" AS ""r1"" JOIN ""rank_table"" AS ""r2"" ON ""r1"".""id""=""r2"".""id"" AND ""r1"".""rnk""+4=""r2"".""rnk"" AND ""r2"".""login_date"" - ""r1"".""login_date""=4 GROUP BY ""r1"".""id"") SELECT ""r3"".""id"",""a"".""name"" FROM ""res"" AS ""r3"" JOIN ""Accounts"" AS ""a"" ON ""r3"".""id""=""a"".""id"" ORDER BY ""r3"".""id"""
199,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
200,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
201,"SELECT DISTINCT ""a"".* FROM (""accounts"" AS ""a"" JOIN ""logins"" AS ""l1"" USING (""id"")) JOIN ""logins"" AS ""l2"" ON ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=5 ORDER BY ""a"".""id"""
202,"SELECT DISTINCT ""L"".""id"",""A"".""name"" FROM (""Logins"" AS ""L"" JOIN ""Logins"" AS ""L2"" ON ""L"".""id""=""L2"".""id"" AND ""L"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""A"" ON ""L"".""id""=""A"".""id"" GROUP BY ""L"".""id"",""L"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")>4"
203,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
204,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
205,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
206,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
207,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
208,"WITH ""dist_logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""dist_logins"" AS ""a"") CROSS JOIN (""dist_logins"" AS ""b"" JOIN ""accounts"" AS ""c"" ON ""b"".""id""=""c"".""id"") WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date""<=""b"".""login_date"" AND ""b"".""login_date"" - ""a"".""login_date""<=4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(1)=5"
209,"SELECT DISTINCT ""a"".""id"",""a2"".""name"" FROM (SELECT ""l1"".""id"",COUNT(DISTINCT (""l2"".""login_date"")) AS ""id_count"" FROM ""Logins"" AS ""l1"" LEFT JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"") AS ""a"" JOIN ""Accounts"" AS ""a2"" ON ""a"".""id""=""a2"".""id"" WHERE ""a"".""id_count""=4 ORDER BY 1"
210,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""m"" AS (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(""l2"".""login_date"") AS ""date_count"" FROM ""t"" AS ""l1"" JOIN ""t"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date""<=""l1"".""login_date"" + INTERVAL '4 DAY' AND ""l2"".""login_date"">=""l1"".""login_date"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING ""date_count"">=5) SELECT DISTINCT ""m"".""id"",""accounts"".""name"" FROM ""m"" JOIN ""accounts"" ON ""m"".""id""=""accounts"".""id"" ORDER BY ""m"".""id"""
211,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
212,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""difference"" FROM ""Logins"" AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY 1,2,3) AS ""AA"" WHERE ""AA"".""difference""=5"
213,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""r"" AS (SELECT ""t1"".""id"",""t1"".""login_date"" FROM ""t"" AS ""t1"" JOIN ""t"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date""<=""t1"".""login_date"" + INTERVAL '4 DAY' AND ""t2"".""login_date"">=""t1"".""login_date"" GROUP BY 1,2 HAVING COUNT(""t2"".""login_date"")>=5) SELECT DISTINCT ""r"".""id"",""a"".""name"" FROM ""r"" JOIN ""accounts"" AS ""a"" ON ""r"".""id""=""a"".""id"" ORDER BY 1"
214,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
215,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
216,"WITH ""table1"" AS (SELECT DISTINCT ""l"".""id"",""l"".""login_date"",""a"".""name"" FROM ""Logins"" AS ""l"" LEFT JOIN ""Accounts"" AS ""a"" USING (""id"")), ""table2"" AS (SELECT ""id"",""login_date"",""name"",LEAD(""login_date"", 1) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead1"",LEAD(""login_date"", 2) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead2"",LEAD(""login_date"", 3) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead3"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead4"" FROM ""table1"") SELECT DISTINCT ""id"",""name"" FROM ""table2"" WHERE ""lead4"" - ""lead3""=1 AND ""lead3"" - ""lead2""=1 AND ""lead2"" - ""lead1""=1 AND ""lead1"" - ""login_date""=1 ORDER BY ""id"""
217,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
218,"WITH ""cte1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",""rnk"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""groupings"" FROM ""cte1""), ""final"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""endDate"" FROM ""cte2"" GROUP BY ""id"",""groupings"" HAVING COUNT(DISTINCT ""rnk"")>=5) SELECT DISTINCT ""f"".""id"",""name"" FROM ""final"" AS ""f"" LEFT JOIN ""Accounts"" AS ""a"" ON ""f"".""id""=""a"".""id"""
219,"WITH ""L"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""gp"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""distinctt""), ""cte"" AS (SELECT ""id"" FROM ""L"" GROUP BY ""id"",""login_date"" + INTERVAL '-""gp"" DAY' HAVING COUNT(1)>=5) SELECT DISTINCT ""cte"".""id"",""name"" FROM ""cte"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" ORDER BY 1"
220,"SELECT DISTINCT ""b"".""id"",""b"".""name"" FROM (SELECT ""a"".""id"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lead_date"",""a"".""login_date"",""a"".""name"" FROM (SELECT DISTINCT ""l"".""id"",""login_date"",""name"" FROM ""Logins"" AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"") AS ""a"") AS ""b"" WHERE ""b"".""lead_date"" - ""b"".""login_date""=4"
221,"WITH ""tmp"" AS (SELECT DISTINCT ""ina"".""id"",""name"",""login_date"" FROM (""Accounts"" AS ""ina"") CROSS JOIN ""Logins"" AS ""inb"" WHERE ""ina"".""id""=""inb"".""id"") SELECT DISTINCT ""ina"".""id"",""ina"".""name"" FROM (""tmp"" AS ""ina"") CROSS JOIN ""tmp"" AS ""inb"" WHERE ""ina"".""id""=""inb"".""id"" AND ""ina"".""login_date"" - ""inb"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""ina"".""id"",""ina"".""login_date"" HAVING COUNT(1)=5"
222,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"",""name"" FROM (SELECT DISTINCT ""l"".""id"",""login_date"",""name"" FROM ""Logins"" AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"") AS ""a"") AS ""b"" WHERE ""lead_date"" - ""login_date""=4"
223,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
224,"SELECT DISTINCT ""x"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""x"".""id"") AS ""name"" FROM (""Logins"" AS ""x"") CROSS JOIN ""Logins"" AS ""y"" WHERE ""x"".""id""=""y"".""id"" AND ""x"".""login_date"" - ""y"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""x"".""id"",""x"".""login_date"" HAVING COUNT(DISTINCT ""y"".""login_date"")=4"
225,"WITH ""t"" AS (SELECT ""id"",""login_date"",COUNT(1) AS ""con"" FROM ""Logins"" GROUP BY ""id"",""login_date""), ""result"" AS (SELECT ""t1"".""id"",""t1"".""login_date"",COUNT(1) AS ""con"" FROM (""t"" AS ""t1"") CROSS JOIN ""t"" AS ""t2"" WHERE ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING ""con"">=5) SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM ""result"") ORDER BY ""id"""
226,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"") JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
227,"WITH ""all_data"" AS (SELECT DISTINCT ""l"".""id"",""l"".""login_date"",""a"".""name"" FROM ""Logins"" AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"") SELECT ""id"",""name"" FROM (SELECT *,CASE WHEN LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date""=4 THEN 1 ELSE 0 END AS ""cons_days"" FROM ""all_data"") AS ""sub1"" GROUP BY 1,2 HAVING SUM(""cons_days"")>=1 ORDER BY 1"
228,"SELECT DISTINCT ""t1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""t1"".""id"") AS ""name"" FROM (""Logins"" AS ""t1"") CROSS JOIN ""Logins"" AS ""t2"" WHERE ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT ""t2"".""login_date"")>=4"
229,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
230,"WITH ""t"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") SELECT ""d"".""id"",""name"" FROM (SELECT DISTINCT ""t1"".""id"" FROM (""t"" AS ""t1"") CROSS JOIN ""t"" AS ""t2"" WHERE ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"">=4 AND ""t1"".""rnk""-""t2"".""rnk"">=4 AND ""t1"".""login_date"" - ""t2"".""login_date""=""t1"".""rnk""-""t2"".""rnk"") AS ""d"" JOIN ""Accounts"" AS ""a"" ON ""d"".""id""=""a"".""id"" ORDER BY ""d"".""id"""
231,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_Date"" - ""l1"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
232,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
233,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" AS ""a"" WHERE ""a"".""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 AND ""l2"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
234,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
235,"SELECT DISTINCT ""l1"".""id"" AS ""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
236,"SELECT DISTINCT ""v"".""id"",""v"".""name"" FROM (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"",DENSE_RANK() OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""rn"" FROM ""accounts"" AS ""a"" RIGHT JOIN ""logins"" AS ""l"" ON ""a"".""id""=""l"".""id"") AS ""v"" GROUP BY ""v"".""name"",""v"".""id"",(""v"".""login_date"" - INTERVAL '""rn"" DAY') HAVING COUNT(DISTINCT ""v"".""login_date"")>=5 ORDER BY ""v"".""id"""
237,"SELECT DISTINCT ""t2"".""id"",""name"" FROM (SELECT ""id"",""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""grp"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""t1"") AS ""t2"" JOIN ""accounts"" USING (""id"") GROUP BY ""id"",""grp"" HAVING COUNT(""grp"")>=5 ORDER BY ""t2"".""id"""
238,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
239,"SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day_before"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l"".""id"" WHERE ""day_before""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
240,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""Accounts"" AS ""a"" JOIN ""Logins"" AS ""l"" ON ""a"".""id""=""l"".""id"") SELECT DISTINCT ""id"",""Name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_Active_days"") AS ""t"" WHERE ""login_date"" + INTERVAL '4 DAY'=""fifth_date"""
241,"SELECT DISTINCT ""b"".""id"",""c"".""name"" FROM (SELECT ""a"".""id"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"") AS ""nxt_date"" FROM (SELECT DISTINCT ""id"",""login_date"",COUNT(""id"") AS ""id_ct"" FROM ""logins"" GROUP BY 1,2 ORDER BY 1,2) AS ""a"") AS ""b"" LEFT JOIN ""accounts"" AS ""c"" ON ""b"".""id""=""c"".""id"" WHERE ABS(""b"".""login_date"" - ""b"".""nxt_date"")=4"
242,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
243,"WITH ""cte1"" AS (SELECT DISTINCT ""a"".""id"",""a"".""login_date"" AS ""login_date1"",""b"".""login_date"" AS ""login_date2"" FROM ""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date""=""a"".""login_date"" + INTERVAL '1 DAY'), ""cte2"" AS (SELECT DISTINCT ""a"".""id"",""a"".""login_date1"",""b"".""login_date2"" FROM ""cte1"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date2""=""a"".""login_date1"" + INTERVAL '2 DAY'), ""cte3"" AS (SELECT DISTINCT ""a"".""id"",""a"".""login_date1"",""b"".""login_date2"" FROM ""cte2"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date2""=""a"".""login_date1"" + INTERVAL '4 DAY') SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" CROSS JOIN ""cte3"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" ORDER BY ""a"".""id"""
244,"WITH ""cte"" AS (SELECT DISTINCT * FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte"" ORDER BY ""id"") SELECT DISTINCT ""id"",""name"" FROM ""cte2"" LEFT JOIN ""Accounts"" USING (""id"") WHERE ""lead_date"" - ""login_date""=4"
245,"WITH ""day_logins"" AS (SELECT ""id"",""login_date"",COUNT(1) AS ""login_day_freq"" FROM ""Logins"" GROUP BY 1,2), ""lag_dt"" AS (SELECT ""a"".""id"",""login_date"",LEAD(""login_date"", 1) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead1_dt"",LEAD(""login_date"", 2) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead2_dt"",LEAD(""login_date"", 3) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead3_dt"",LEAD(""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead4_dt"" FROM ""day_logins"" AS ""a""), ""lag_dt_1"" AS (SELECT ""id"",CASE WHEN ""luser_lead1_dt""=""login_date"" + INTERVAL '1 DAY' AND ""luser_lead2_dt""=""login_date"" + INTERVAL '2 DAY' AND ""luser_lead3_dt""=""login_date"" + INTERVAL '3 DAY' AND ""luser_lead4_dt""=""login_date"" + INTERVAL '4 DAY' THEN 1 ELSE 0 END AS ""ind"" FROM ""lag_dt"") SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM ""lag_dt_1"" AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""ind""=1"
246,"WITH ""unique_logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""active_users"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""unique_logins"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""active_users"" WHERE ""day5"" - ""login_date""=4) ORDER BY ""id"""
247,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" LEFT JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""a"".""id"",""a"".""login_date"""
248,"WITH ""L"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") SELECT DISTINCT ""l3"".""id"",""a"".""name"" FROM (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(""l2"".""login_date"") AS ""cnt"" FROM ""L"" AS ""l1"" LEFT JOIN ""L"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date""<=""l1"".""login_date"" + INTERVAL '4 DAY' AND ""l2"".""login_date"">""l1"".""login_date"" GROUP BY 1,2 HAVING ""cnt"">=4) AS ""l3"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l3"".""id""=""a"".""id"" ORDER BY 1"
249,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""log4"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""tmp"") SELECT ""act"".""id"",""act"".""name"" FROM ""Accounts"" AS ""act"" JOIN ""cte"" AS ""a"" ON ""act"".""id""=""a"".""id"" AND ""login_date"" - ""log4""=4 GROUP BY 1 ORDER BY 1"
250,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
251,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""leading_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_date"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""leading_date""=""b"".""fifth_date"" ORDER BY ""a"".""id"""
252,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
253,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
254,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
255,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
256,"WITH ""cte"" AS (SELECT ""id"" FROM (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""gp"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""t1"") AS ""t"" GROUP BY ""id"",""login_date"" + INTERVAL '-""gp"" DAY' HAVING COUNT(1)>=5) SELECT DISTINCT ""cte"".""id"",""name"" FROM ""cte"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" ORDER BY 1"
257,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
258,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" AS ""a"" WHERE ""a"".""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 AND ""l2"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
259,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
260,"WITH ""temp"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" WHERE ""a"".""id"" IN (SELECT ""l1"".""id"" FROM (((""temp"" AS ""l1"" JOIN ""temp"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date""=1) JOIN ""temp"" AS ""l3"" ON ""l1"".""id""=""l3"".""id"" AND ""l1"".""login_date"" - ""l3"".""login_date""=2) JOIN ""temp"" AS ""l4"" ON ""l1"".""id""=""l4"".""id"" AND ""l1"".""login_date"" - ""l4"".""login_date""=3) JOIN ""temp"" AS ""l5"" ON ""l1"".""id""=""l5"".""id"" AND ""l1"".""login_date"" - ""l5"".""login_date""=4) ORDER BY ""id"""
261,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
262,"WITH ""t1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""t2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_4days"" FROM ""t1"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""t2"" JOIN ""Accounts"" AS ""a"" ON ""t2"".""id""=""a"".""id"" WHERE ""lead_4days"" - ""login_date""=4 ORDER BY 1"
263,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
264,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
265,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
266,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" LEFT JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
267,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
268,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
269,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5"
270,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
271,"SELECT DISTINCT ""c"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
272,"WITH ""temp"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" WHERE ""a"".""id"" IN (SELECT ""l1"".""id"" FROM (((""temp"" AS ""l1"" JOIN ""temp"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date""=1) JOIN ""temp"" AS ""l3"" ON ""l1"".""id""=""l3"".""id"" AND ""l1"".""login_date"" - ""l3"".""login_date""=2) JOIN ""temp"" AS ""l4"" ON ""l1"".""id""=""l4"".""id"" AND ""l1"".""login_date"" - ""l4"".""login_date""=3) JOIN ""temp"" AS ""l5"" ON ""l1"".""id""=""l5"".""id"" AND ""l1"".""login_date"" - ""l5"".""login_date""=4) ORDER BY ""id"""
273,"WITH ""cte"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""groupings"" FROM ""cte""), ""cte2"" AS (SELECT ""id"",""groupings"",MIN(""login_date"") AS ""start_date"",MAX(""login_date"") AS ""end_date"" FROM ""cte1"" GROUP BY ""id"",""groupings"" HAVING COUNT(DISTINCT ""login_date"")>=5 ORDER BY ""id"",""start_date"") SELECT DISTINCT ""c"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM ""cte2"" AS ""c"" JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
274,"WITH ""day_logins"" AS (SELECT ""id"",""login_date"",COUNT(1) AS ""login_day_freq"" FROM ""Logins"" GROUP BY 1,2), ""lag_dt"" AS (SELECT ""a"".""id"",""login_date"",LEAD(""login_date"", 1) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead1_dt"",LEAD(""login_date"", 2) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead2_dt"",LEAD(""login_date"", 3) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead3_dt"",LEAD(""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""luser_lead4_dt"" FROM ""day_logins"" AS ""a""), ""lag_dt_1"" AS (SELECT ""id"",CASE WHEN ""luser_lead1_dt""=""login_date"" + INTERVAL '1 DAY' AND ""luser_lead2_dt""=""login_date"" + INTERVAL '2 DAY' AND ""luser_lead3_dt""=""login_date"" + INTERVAL '3 DAY' AND ""luser_lead4_dt""=""login_date"" + INTERVAL '4 DAY' THEN 1 ELSE 0 END AS ""ind"" FROM ""lag_dt"") SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM ""lag_dt_1"" AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""ind""=1"
275,"WITH ""temp"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT DISTINCT ""eligible_id"" FROM (SELECT CASE WHEN ""t2"".""id"" IS NOT NULL AND ""t3"".""id"" IS NOT NULL AND ""t4"".""id"" IS NOT NULL AND ""t5"".""id"" IS NOT NULL THEN ""t1"".""id"" ELSE NULL END AS ""eligible_id"" FROM (((""temp"" AS ""t1"" JOIN ""temp"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND TIMESTAMPDIFF(DAY, ""t1"".""login_date"", ""t2"".""login_date"")=1) JOIN ""temp"" AS ""t3"" ON ""t1"".""id""=""t3"".""id"" AND TIMESTAMPDIFF(DAY, ""t1"".""login_date"", ""t3"".""login_date"")=2) JOIN ""temp"" AS ""t4"" ON ""t1"".""id""=""t4"".""id"" AND TIMESTAMPDIFF(DAY, ""t1"".""login_date"", ""t4"".""login_date"")=3) JOIN ""temp"" AS ""t5"" ON ""t1"".""id""=""t5"".""id"" AND TIMESTAMPDIFF(DAY, ""t1"".""login_date"", ""t5"".""login_date"")=4) AS ""p"" WHERE ""eligible_id"" IS NOT NULL) ORDER BY ""id"""
276,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
277,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" WHERE ""a"".""id"" IN (SELECT ""l1"".""id"" FROM (((""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date""=""l2"".""login_date"" + INTERVAL '1 DAY' AND ""l1"".""id""=""l2"".""id"") JOIN ""Logins"" AS ""l3"" ON ""l1"".""login_date""=""l3"".""login_date"" + INTERVAL '2 DAY' AND ""l1"".""id""=""l3"".""id"") JOIN ""Logins"" AS ""l4"" ON ""l1"".""login_date""=""l4"".""login_date"" + INTERVAL '3 DAY' AND ""l1"".""id""=""l4"".""id"") JOIN ""Logins"" AS ""l5"" ON ""l1"".""login_date""=""l5"".""login_date"" + INTERVAL '4 DAY' AND ""l1"".""id""=""l5"".""id"") ORDER BY ""a"".""id"""
278,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
279,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
280,"WITH ""temp1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""temp2"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '4 DAY' AS ""five_day"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""temp1"") SELECT DISTINCT ""a"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM (SELECT ""t1"".""id"",""t1"".""login_date"",""t1"".""five_day"",""t1"".""rk"" AS ""first"",""t2"".""rk"" AS ""last"" FROM (""temp2"" AS ""t1"") CROSS JOIN ""temp2"" AS ""t2"" WHERE ""t1"".""five_day""=""t2"".""login_date"" AND ""t1"".""id""=""t2"".""id"" AND ""t2"".""rk""=""t1"".""rk""+4) AS ""t"" JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" ORDER BY ""id"""
281,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
282,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""id"""
283,"ERROR: mysql parse error: line 1 column 83 near ""Logins AS L1 JOIN Logins AS L2 ON L1.id=L2.id AND DATEDIFF(L2.login_date,L1.login_date) BETWEEN 1 AND 4 GROUP BY L1.id,l1.login_date HAVING COUNT(DISTINCT L2.login_date)=4 "" "
284,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
285,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
286,"WITH ""uni"" AS (SELECT DISTINCT * FROM ""Logins""), ""conse"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_4"" FROM ""uni"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""conse"" AS ""c"" LEFT JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""lead_4"" - ""login_date""=4"
287,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
288,"WITH ""t"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_5"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""t2"") SELECT DISTINCT ""t"".""id"",""name"" FROM ""Accounts"" AS ""a"" LEFT JOIN ""t"" ON ""a"".""id""=""t"".""id"" WHERE ""t"".""login_date"" - ""lag_5""=4 ORDER BY ""id"""
289,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
290,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
291,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
292,"SELECT DISTINCT ""c"".""id"",""c"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""c"" ON ""c"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
293,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
294,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
295,"WITH ""cte"" AS (SELECT DISTINCT * FROM ""logins""), ""temp"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""temp"" AS ""a"" LEFT JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""lead_date"" - ""login_date""=4"
296,"SELECT DISTINCT ""l1"".""id"" AS ""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
297,"SELECT DISTINCT ""l1"".""id"" AS ""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
298,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""m"" AS (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(""l2"".""login_date"") AS ""date_count"" FROM ""t"" AS ""l1"" JOIN ""t"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date""<=""l1"".""login_date"" + INTERVAL '4 DAY' AND ""l2"".""login_date"">""l1"".""login_date"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING ""date_count"">=4) SELECT DISTINCT ""m"".""id"",""accounts"".""name"" FROM ""m"" JOIN ""accounts"" ON ""m"".""id""=""accounts"".""id"" ORDER BY ""m"".""id"""
299,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_5_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""tmp"") SELECT DISTINCT ""tmp"".""id"",""tab2"".""name"" FROM ""cte"" AS ""tmp"" JOIN ""Accounts"" AS ""tab2"" ON ""tmp"".""id""=""tab2"".""id"" WHERE ""tmp"".""lead_5_date"" - ""tmp"".""login_date""=4 ORDER BY ""id"""
300,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
301,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM ""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
302,"SELECT DISTINCT ""temp"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""temp"" JOIN ""Accounts"" AS ""a"" ON ""temp"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY 1"
303,"SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM (SELECT ""id"",""login_date"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""t"") AS ""l"" CROSS, ""accounts"" AS ""a"" WHERE ""a"".""id""=""l"".""id"" AND ""l"".""diff""=4 ORDER BY ""l"".""id"""
304,"SELECT DISTINCT ""y"".""id"",""a"".""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""x"") AS ""y"" CROSS, ""accounts"" AS ""a"" WHERE ""a"".""id""=""y"".""id"" AND ""y"".""lead_date"" - ""y"".""login_date""=4 ORDER BY 1"
305,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (SELECT ""l"".""id"" AS ""l_id"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""la"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""tmp"" JOIN ""accounts"" AS ""a"" ON ""tmp"".""l_id""=""a"".""id"" WHERE ""tmp"".""la""=4 ORDER BY ""a"".""id"""
306,"WITH ""t0"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""Logins""), ""t1"" AS (SELECT ""id"",""login_date"",""login_date"" - INTERVAL '""rk"" DAY' AS ""gp"" FROM ""t0"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""t1"" GROUP BY ""id"",""gp"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4) ORDER BY ""id"""
307,"SELECT DISTINCT ""l1"".""id"",""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l2"".""id""=""l1"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
308,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
309,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"">=1 AND ""l2"".""login_date"" - ""l1"".""login_date""<=4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
310,"WITH ""new"" AS (SELECT ""id"",""login_date"",""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""diff"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" ORDER BY ""id"") AS ""a"") SELECT DISTINCT ""new"".""id"",""name"" FROM ""new"" LEFT JOIN ""accounts"" AS ""a"" ON ""new"".""id""=""a"".""id"" GROUP BY ""new"".""id"",""diff"" HAVING COUNT(""diff"")>=5"
311,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""id"",""login_date"") - ""login_date"" AS ""diff"" FROM ""logins"" JOIN ""accounts"" USING (""id"") GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""temp"" WHERE ""diff""=4"
312,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
313,"SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT DISTINCT ""l1"".""id"" FROM ""logins"" AS ""l1"" LEFT JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING (COUNT(DISTINCT ""l2"".""login_date"")=5)) ORDER BY ""id"""
314,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(""id"")>=5) ORDER BY ""id"""
315,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""a"".""id"",""a"".""name"",""login_date"",LAG(""login_date"") OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""lag1"",LAG(""login_date"", 2) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""lag2"",LAG(""login_date"", 3) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""lag3"",LAG(""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""login_date"") AS ""lag4"" FROM ""Accounts"" AS ""a"" LEFT JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""b"" ON ""a"".""id""=""b"".""id"") AS ""A"" WHERE ""login_date"" - ""lag1""=1 AND ""login_date"" - ""lag2""=2 AND ""login_date"" - ""lag3""=3 AND ""login_date"" - ""lag4""=4"
316,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""L1"".""id"" FROM ""logins"" AS ""L1"" JOIN ""logins"" AS ""L2"" ON ""L1"".""id""=""L2"".""id"" WHERE ""L1"".""login_date"" - ""L2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""L1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")>=4) ORDER BY ""id"""
317,"WITH ""tb1"" AS (SELECT DISTINCT ""id"",""login_date"",""login_date"" - CAST('2020-05-29' AS DATE)-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""days"" FROM ""Logins"") SELECT DISTINCT ""id"",(SELECT ""A"".""name"" FROM ""Accounts"" AS ""A"" WHERE ""A"".""id""=""tb1"".""id"") AS ""name"" FROM ""tb1"" GROUP BY ""id"",""days"" HAVING COUNT(""days"")>=5"
318,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_lag"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t1"" ORDER BY ""login_date"") SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM ""cte"" AS ""l"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" WHERE ""login_date"" - ""login_lag""=4 ORDER BY ""l"".""id"""
319,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""a"".""id""=""Accounts"".""id"") AS ""name"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4 ORDER BY ""a"".""id"""
320,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""Accounts"" AS ""a"" JOIN ""Logins"" AS ""l"" ON ""a"".""id""=""l"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""Id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_active_days"") AS ""t"" WHERE ""login_date"" + INTERVAL '4 DAY'=""fifth_date"""
321,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT ""l1"".""id"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND 0<=""l1"".""login_date"" - ""l2"".""login_date"" AND ""l1"".""login_date"" - ""l2"".""login_date""<5 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l1"".""login_date"" - ""l2"".""login_date"")>=5) AS ""t"" ON ""a"".""id""=""t"".""id"" GROUP BY ""a"".""id"",""a"".""name"" ORDER BY ""a"".""id"""
322,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
323,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN (SELECT ""login_date"",""id"",LEAD(""login_Date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""dateadd_date"" FROM ""logins"" GROUP BY 1,2) AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""lead_date""=""dateadd_date"" ORDER BY 1,2"
324,"SELECT ""a"".""id"",""a"".""name"" FROM (SELECT DISTINCT ""l1"".""id"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4) AS ""t"" JOIN ""accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
325,"SELECT DISTINCT ""A"".""id"",""C"".""Name"" FROM (""Logins"" AS ""A"" JOIN ""Logins"" AS ""B"" ON ""A"".""id""=""B"".""id"" AND ""A"".""login_date"" - ""B"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""C"" ON ""A"".""id""=""C"".""id"" GROUP BY ""A"".""id"",""A"".""login_date"" HAVING COUNT(DISTINCT ""B"".""login_date"")=4"
326,"WITH ""orderlogins"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"" DESC) SELECT DISTINCT ""accts"".""id"",""accts"".""name"" FROM ""Accounts"" AS ""accts"" JOIN (SELECT ""id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"" DESC) AS ""num"",CURDATE() - ""login_date"" AS ""yrmonday"" FROM ""orderlogins"") AS ""A"" ON ""accts"".""id""=""A"".""id"" GROUP BY ""id"",(""yrmonday""-""num"") HAVING COUNT(""accts"".""id"")>=5 ORDER BY ""id"""
327,"SELECT DISTINCT ""x"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""x"".""id"") AS ""name"" FROM (""Logins"" AS ""x"") CROSS JOIN ""Logins"" AS ""y"" WHERE ""x"".""id""=""y"".""id"" AND ""x"".""login_date"" - ""y"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""x"".""id"",""x"".""login_date"" HAVING COUNT(DISTINCT ""y"".""login_date"")=4"
328,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
329,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
330,"SELECT DISTINCT ""c"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
331,"WITH ""unique_logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""active_users"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""unique_logins"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""active_users"" WHERE ""day5"" - ""login_date""=4) ORDER BY ""id"""
332,"WITH ""id_needed"" AS (SELECT ""id"" FROM (SELECT ""l"".""id"",""login_date"",""login_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""l"".""id"" ORDER BY ""login_date"") DAY' AS ""grp"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY ""l"".""id"",""login_date"") AS ""t"" GROUP BY ""id"",""grp"" HAVING COUNT(""grp"")>=5) SELECT DISTINCT ""a"".""id"",""name"" FROM ""id_needed"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" USING (""id"")"
333,"WITH ""temp"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ranking"" FROM ""Logins""), ""temp1"" AS (SELECT DISTINCT ""t"".""id"" FROM ""temp"" AS ""t"" JOIN ""temp"" AS ""u"" ON ""t"".""id""=""u"".""id"" WHERE EXTRACT(EPOCH FROM ""u"".""login_date"")-EXTRACT(EPOCH FROM ""t"".""login_date"")=4 AND ""u"".""ranking""-""t"".""ranking""=4) SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT * FROM ""temp1"") ORDER BY ""id"""
334,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
335,"SELECT DISTINCT ""c"".""id"",""c"".""name"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"",LEAD(""l"".""login_date"", 4) OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") - ""l"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""l"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l"".""id"" GROUP BY ""l"".""id"",""l"".""login_date"") AS ""c"" WHERE ""c"".""diff""=5"
336,"WITH ""e"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 1) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_n2"",LEAD(""login_date"", 2) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_n3"",LEAD(""login_date"", 3) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_n4"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_n5"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t"") SELECT DISTINCT ""e"".""id"",""a"".""name"" FROM ""e"" JOIN ""Accounts"" AS ""a"" ON ""e"".""id""=""a"".""id"" WHERE ""login_n2"" - ""login_date""=1 AND ""login_n3"" - ""login_date""=2 AND ""login_n4"" - ""login_date""=3 AND ""login_n5"" - ""login_date""=4 ORDER BY 1"
337,"SELECT DISTINCT ""concesutive_ids"".""id"" AS ""id"",""A"".""name"" FROM (SELECT ""id"",CASE WHEN ""lag_login_date"" IS NULL THEN @""counter"":=1 WHEN ""login_date"" - ""lag_login_date""=1 THEN @""counter"":=@""counter""+1 ELSE @""counter"":=1 END AS ""consistency"" FROM (SELECT ""id"",""login_date"",LAG(""login_date"") OVER (PARTITION BY ""id"") AS ""lag_login_date"" FROM (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""id_login_unique"") AS ""lagged_login"") AS ""concesutive_ids"" JOIN ""Accounts"" AS ""A"" ON ""concesutive_ids"".""id""=""A"".""id"" WHERE ""concesutive_ids"".""consistency"">=5 ORDER BY ""id"""
338,"WITH ""unique_logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""active_users"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""unique_logins"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""active_users"" WHERE ""day5"" - ""login_date""=4) ORDER BY ""id"""
339,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2), ""cte2"" AS (SELECT ""id"",""login_date"",""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""indicator"" FROM ""cte"") SELECT DISTINCT ""id"",""name"" FROM ""cte2"" LEFT JOIN ""Accounts"" USING (""id"") GROUP BY ""id"",""indicator"" HAVING COUNT(1)>=5"
340,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
341,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
342,"WITH ""cte"" AS (SELECT DISTINCT * FROM ""logins""), ""temp"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""temp"" AS ""a"" LEFT JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""lead_date"" - ""login_date""=4"
343,"WITH ""logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") SELECT DISTINCT ""b"".""id"",""b"".""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""gap"" FROM ""logins"") AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""gap""=4 ORDER BY ""a"".""id"""
344,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
345,"WITH ""CTE"" AS (SELECT ""l4"".""id"" FROM (SELECT ""l3"".""id"",""l3"".""fifthdatelog"" - ""l3"".""login_date"" AS ""datediffcount"" FROM (SELECT ""l2"".""id"",""l2"".""login_date"",LEAD(""l2"".""login_date"", 4) OVER (PARTITION BY ""l2"".""id"") AS ""fifthdatelog"" FROM (SELECT ""l"".""id"",""l"".""login_date"" FROM ""Logins"" AS ""l"" GROUP BY ""l"".""id"",""l"".""login_date"" ORDER BY ""l"".""login_date"") AS ""l2"") AS ""l3"") AS ""l4"" WHERE ""l4"".""datediffcount""=4 GROUP BY ""l4"".""id"") SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN ""CTE"" ON ""a"".""id""=""CTE"".""id"" GROUP BY ""a"".""id"" ORDER BY ""id"""
346,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM (SELECT ""id"",""login_date"" - INTERVAL '""login_row"" DAY' AS ""login_row_group"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_row"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""Z"") AS ""A"") AS ""B"" GROUP BY ""id"",""login_row_group"" HAVING COUNT(1)>=5) ORDER BY ""id"""
347,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
348,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
349,"WITH ""cte1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""rk"" DAY' AS ""marking"" FROM ""cte1"") SELECT DISTINCT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte2"" GROUP BY ""id"",""marking"" HAVING COUNT(DISTINCT ""login_date"")>=5) ORDER BY ""id"""
350,"WITH ""CTE"" AS (SELECT ""ID"",""LOGIN_DATE"",DENSE_RANK() OVER (PARTITION BY ""ID"" ORDER BY ""LOGIN_DATE"") AS ""ROW_NUM"" FROM ""LOGINS"") SELECT DISTINCT ""ID"",""NAME"" FROM ""ACCOUNTS"" WHERE ""ID"" IN (SELECT ""ID"" FROM ""CTE"" GROUP BY ""ID"",""LOGIN_DATE"" + INTERVAL '-""ROW_NUM"" DAY' HAVING COUNT(DISTINCT ""LOGIN_DATE"")>=5) ORDER BY ""ID"""
351,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
352,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
353,"SELECT DISTINCT ""a"".""id"",""ac"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" - ""a"".""login_Date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""ac"" ON ""ac"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
354,"WITH ""rt"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""cnt"" FROM ""Logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""rt"".""id"",""name"" FROM ""rt"" JOIN ""Accounts"" ON ""rt"".""id""=""Accounts"".""id"" WHERE ""cnt""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
355,"WITH ""t0"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rk"" FROM ""Logins""), ""t1"" AS (SELECT ""id"",""login_date"",""rk"",""login_date"" + INTERVAL '-""rk"" DAY' AS ""groupings"" FROM ""t0""), ""t2"" AS (SELECT ""id"",MIN(""login_date"") AS ""start_date"",MAX(""login_date"") AS ""end_date"",""rk"",""groupings"",COUNT(""id"") AS ""cnt"",MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""t1"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""start_date"") SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM ""t2"" AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" ORDER BY ""a"".""id"""
356,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
357,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
358,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""Logins"" AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
359,"WITH ""t"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" USING (""id"")) SELECT ""t"".""id"",""t"".""name"" FROM (((""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""id""=""t"".""id"" AND ""t2"".""login_date"" - ""t"".""login_date""=1) JOIN ""t"" AS ""t3"" ON ""t3"".""id""=""t"".""id"" AND ""t3"".""login_date"" - ""t"".""login_date""=2) JOIN ""t"" AS ""t4"" ON ""t4"".""id""=""t"".""id"" AND ""t4"".""login_date"" - ""t"".""login_date""=3) JOIN ""t"" AS ""t5"" ON ""t5"".""id""=""t"".""id"" AND ""t5"".""login_date"" - ""t"".""login_date""=4 GROUP BY ""t"".""id"",""t"".""name"" ORDER BY ""t"".""id"""
360,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4) ORDER BY ""id"""
361,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
362,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
363,"WITH ""cte"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""ld_group"" FROM ""logins"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" GROUP BY ""id"",""ld_group"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""c"".""id"""
364,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
365,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins"") AS ""a"") SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(""id"")>=5) ORDER BY ""id"""
366,"SELECT DISTINCT ""a1"".""id"",""name"" FROM (""logins"" AS ""a1"" JOIN ""logins"" AS ""a2"" ON ""a1"".""id""=""a2"".""id"" AND ""a2"".""login_date"" - ""a1"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" ON ""a1"".""id""=""accounts"".""id"" GROUP BY ""a1"".""id"",""a1"".""login_date"" HAVING COUNT(DISTINCT ""a2"".""login_date"")=4"
367,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" LEFT JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) LEFT JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
368,"SELECT DISTINCT ""a"".""id"" AS ""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
369,"WITH ""temp"" AS (SELECT ""a"".""id"",""a"".""login_date"" FROM ""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) SELECT DISTINCT ""a"".""id"",""name"" FROM ""accounts"" AS ""a"" JOIN ""temp"" AS ""t"" ON ""a"".""id""=""t"".""id"" ORDER BY ""id"""
370,"WITH ""unique_logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""active_users"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""unique_logins"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""active_users"" WHERE ""day5"" - ""login_date""=4) ORDER BY ""id"""
371,"SELECT ""l"".""id"",""l"".""name"" FROM ""Accounts"" AS ""l"" WHERE ""l"".""id"" IN (SELECT ""l1"".""id"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=5) ORDER BY ""l"".""id"""
372,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",DAYOFYEAR(""login_date"") AS ""doy"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""cte""), ""cte3"" AS (SELECT ""id"" FROM ""cte1"" GROUP BY ""id"",""doy""-""rn"" HAVING COUNT(1)>=5) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (""accounts"" AS ""a"") CROSS JOIN ""cte3"" AS ""c"" WHERE ""a"".""id""=""c"".""id"" ORDER BY ""id"""
373,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
374,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
375,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
376,"WITH ""base"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_dt"" FROM (SELECT * FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""a"") SELECT ""p"".""id"",""q"".""name"" FROM (SELECT *,CASE WHEN (""login_date"" + INTERVAL '4 DAY'=""fifth_dt"") THEN 1 ELSE 0 END AS ""result"" FROM ""base"") AS ""p"" JOIN ""Accounts"" AS ""q"" ON ""p"".""id""=""q"".""id"" WHERE ""result""=1 GROUP BY ""p"".""id"",""q"".""name"" ORDER BY ""p"".""id"""
377,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
378,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
379,"SELECT ""Accounts"".""id"",""Accounts"".""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""l1"".""id"" FROM (((""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date""=""l2"".""login_date"" - INTERVAL '1 DAY') JOIN ""Logins"" AS ""l3"" ON ""l3"".""id""=""l2"".""id"" AND ""l2"".""login_date""=""l3"".""login_date"" - INTERVAL '1 DAY') JOIN ""Logins"" AS ""l4"" ON ""l3"".""id""=""l4"".""id"" AND ""l3"".""login_date""=""l4"".""login_date"" - INTERVAL '1 DAY') JOIN ""Logins"" AS ""l5"" ON ""l5"".""id""=""l4"".""id"" AND ""l4"".""login_date""=""l5"".""login_date"" - INTERVAL '1 DAY') ORDER BY ""id"""
380,"WITH ""logins1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""next_four"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_f"" FROM ""logins1"") SELECT DISTINCT ""n"".""id"",""a"".""name"" FROM ""next_four"" AS ""n"" JOIN ""accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""next_f"" - ""login_date""=4 ORDER BY 1"
381,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
382,"WITH ""login_grouped"" AS (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY 1,2 ORDER BY 1,2) SELECT ""l1"".""id"",""name"" FROM ((((""login_grouped"" AS ""l1"" JOIN ""login_grouped"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date""=1) JOIN ""login_grouped"" AS ""l3"" ON ""l1"".""id""=""l3"".""id"" AND ""l3"".""login_date"" - ""l1"".""login_date""=2) JOIN ""login_grouped"" AS ""l4"" ON ""l1"".""id""=""l4"".""id"" AND ""l4"".""login_date"" - ""l1"".""login_date""=3) JOIN ""login_grouped"" AS ""l5"" ON ""l1"".""id""=""l5"".""id"" AND ""l5"".""login_date"" - ""l1"".""login_date""=4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""name"" ORDER BY ""l1"".""id"""
383,"SELECT DISTINCT ""D"".""id"",""a"".""name"" FROM (SELECT ""C"".""id"" FROM (SELECT ""B"".""id"",""B"".""consec_ref"",COUNT(""B"".""login_date"") AS ""no_consec"" FROM (SELECT ""A"".""id"",""A"".""login_date"",""A"".""login_date"" - INTERVAL 'ROW_NUMBER() OVER (PARTITION BY ""A"".""id"" ORDER BY ""A"".""login_date"") DAY' AS ""consec_ref"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""A"") AS ""B"" GROUP BY ""B"".""id"",""B"".""consec_ref"") AS ""C"" WHERE ""C"".""no_consec"">=5) AS ""D"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""D"".""id"""
384,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
385,"WITH ""unique_login"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""lead_five"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""unique_login"") SELECT DISTINCT ""lead_five"".""id"",""a"".""name"" FROM ""lead_five"" JOIN ""Accounts"" AS ""a"" ON ""lead_five"".""id""=""a"".""id"" WHERE ""lead_five"".""date_lead_five"" - ""lead_five"".""login_date""=4 ORDER BY ""lead_five"".""id"""
386,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"") JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
387,"WITH ""cte"" AS (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""d_rank"" FROM ""Logins"") AS ""temp"" GROUP BY ""id"",EXTRACT(EPOCH FROM ""login_date"")-""d_rank"" HAVING COUNT(DISTINCT ""login_date"")>=5) SELECT ""act"".""id"",""act"".""name"" FROM ""cte"" JOIN ""Accounts"" AS ""act"" ON ""cte"".""id""=""act"".""id"" ORDER BY ""act"".""id"""
388,"WITH ""t"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" USING (""id"") ORDER BY ""id"",""login_date"") SELECT ""t"".""id"",""t"".""name"" FROM (((""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""id""=""t"".""id"" AND ""t2"".""login_date"" - ""t"".""login_date""=1) JOIN ""t"" AS ""t3"" ON ""t3"".""id""=""t"".""id"" AND ""t3"".""login_date"" - ""t"".""login_date""=2) JOIN ""t"" AS ""t4"" ON ""t4"".""id""=""t"".""id"" AND ""t4"".""login_date"" - ""t"".""login_date""=3) JOIN ""t"" AS ""t5"" ON ""t5"".""id""=""t"".""id"" AND ""t5"".""login_date"" - ""t"".""login_date""=4 GROUP BY ""t"".""id"",""t"".""name"" ORDER BY ""t"".""id"""
389,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
390,"SELECT DISTINCT ""L1"".""id"",""name"" FROM (""Logins"" AS ""L1"" JOIN ""Logins"" AS ""L2"" ON ""L1"".""id""=""L2"".""id"" AND ""L2"".""login_date"" - ""L1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A1"" ON ""L1"".""id""=""A1"".""id"" GROUP BY ""L1"".""id"",""L1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")>=4 ORDER BY 1"
391,"SELECT DISTINCT ""c"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
392,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
393,"SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4) ORDER BY ""id"""
394,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
395,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT (""Logins"".""id"") FROM (((""Logins"" LEFT JOIN (SELECT ""Logins"".""id"",""Logins"".""login_date"" + INTERVAL '1 DAY' AS ""one_day_before"" FROM ""Logins"") AS ""table1"" ON ""Logins"".""login_date""=""table1"".""one_day_before"" AND ""Logins"".""id""=""table1"".""id"") LEFT JOIN (SELECT ""Logins"".""id"",""Logins"".""login_date"" + INTERVAL '2 DAY' AS ""two_day_before"" FROM ""Logins"") AS ""table2"" ON ""Logins"".""login_date""=""table2"".""two_day_before"" AND ""Logins"".""id""=""table2"".""id"") LEFT JOIN (SELECT ""Logins"".""id"",""Logins"".""login_date"" + INTERVAL '-1 DAY' AS ""one_day_after"" FROM ""Logins"") AS ""table3"" ON ""Logins"".""login_date""=""table3"".""one_day_after"" AND ""Logins"".""id""=""table3"".""id"") LEFT JOIN (SELECT ""Logins"".""id"",""Logins"".""login_date"" + INTERVAL '-2 DAY' AS ""two_day_after"" FROM ""Logins"") AS ""table4"" ON ""Logins"".""login_date""=""table4"".""two_day_after"" AND ""Logins"".""id""=""table4"".""id"" WHERE ""table1"".""one_day_before"" IS NOT NULL AND ""table2"".""two_day_before"" IS NOT NULL AND ""table3"".""one_day_after"" IS NOT NULL AND ""table4"".""two_day_after"" IS NOT NULL) ORDER BY ""id"""
396,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
397,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
398,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""L1"".""id"" FROM ""Logins"" AS ""L1"" JOIN ""Logins"" AS ""L2"" ON ""L2"".""login_date"" - ""L1"".""login_date"" BETWEEN 1 AND 4 AND ""L1"".""id""=""L2"".""id"" GROUP BY ""L1"".""id"",""L1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")>=4) ORDER BY 1,2"
399,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""t1"".""id"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT (""t2"".""login_date""))=4) ORDER BY ""id"""
400,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
401,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=5 ORDER BY ""a"".""id"""
402,"SELECT ""ID"",""NAME"" FROM ""ACCOUNTS"" WHERE ""ID"" IN (SELECT DISTINCT ""B"".""ID"" FROM (SELECT ""A"".""ID"",""A"".""LOGIN_DATE"" - INTERVAL '""A"".""CONSECT_DAYS"" DAY' AS ""GROUPED_DATE"" FROM (SELECT DISTINCT ""ID"",""LOGIN_DATE"",DENSE_RANK() OVER (PARTITION BY ""ID"" ORDER BY ""LOGIN_DATE"") AS ""CONSECT_DAYS"" FROM ""LOGINS"") AS ""A"") AS ""B"" GROUP BY ""B"".""ID"",""GROUPED_DATE"" HAVING COUNT(1)>=5) ORDER BY ""ID"""
403,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
404,"SELECT DISTINCT ""l1"".""id"",""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""Accounts"" ON ""Accounts"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY 1"
405,"SELECT DISTINCT ""a"".""id"",""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" ON ""a"".""id""=""Accounts"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
406,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""l1"".""id"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"">=""l1"".""login_date"" AND ""l2"".""login_date""<""l1"".""login_date"" + INTERVAL '5 DAY' GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5) AS ""l"" ON ""a"".""id""=""l"".""id"" ORDER BY ""a"".""id"""
407,"WITH ""tb1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""logins""), ""tb2"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""groupings"" FROM ""tb1""), ""result_tb"" AS (SELECT ""id"",MIN(""login_date"") AS ""start_date"",MAX(""login_date"") AS ""end_date"",""row_num"",""groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""tb2"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""start_date"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""result_tb"" ON ""result_tb"".""id""=""a"".""id"" ORDER BY 1"
408,"WITH ""t"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" USING (""id"")) SELECT ""t"".""id"",""t"".""name"" FROM (((""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""id""=""t"".""id"" AND ""t2"".""login_date"" - ""t"".""login_date""=1) JOIN ""t"" AS ""t3"" ON ""t3"".""id""=""t"".""id"" AND ""t3"".""login_date"" - ""t"".""login_date""=2) JOIN ""t"" AS ""t4"" ON ""t4"".""id""=""t"".""id"" AND ""t4"".""login_date"" - ""t"".""login_date""=3) JOIN ""t"" AS ""t5"" ON ""t5"".""id""=""t"".""id"" AND ""t5"".""login_date"" - ""t"".""login_date""=4 GROUP BY ""t"".""id"",""t"".""name"" ORDER BY ""t"".""id"""
409,"SELECT DISTINCT ""a"".""id"",""Accounts"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) LEFT JOIN ""Accounts"" ON ""a"".""id""=""Accounts"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
410,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""prev_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""a"" JOIN ""accounts"" AS ""b"" USING (""id"")) AS ""t"" WHERE ""login_date"" - ""prev_date""=4"
411,"WITH ""cte_logins"" AS (SELECT DISTINCT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""leading_5_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"" ORDER BY ""id"",""login_date"") AS ""d"") SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM ""cte_logins"" WHERE ""leading_5_date""=""fifth_date"") ORDER BY ""a"".""id"""
412,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
413,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
414,"WITH ""temp1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""temp2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""temp1"") SELECT DISTINCT ""t2"".""id"",""a"".""name"" FROM ""temp2"" AS ""t2"" JOIN ""Accounts"" AS ""a"" ON ""t2"".""id""=""a"".""id"" WHERE ""t2"".""date_lead_five"" - ""t2"".""login_date""=4 ORDER BY ""t2"".""id"""
415,"WITH ""subq1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""dr"" FROM ""Logins""), ""subq2"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""dr"" DAY' AS ""gr"" FROM ""subq1""), ""subq3"" AS (SELECT ""id"" FROM ""subq2"" GROUP BY ""id"",""gr"" HAVING COUNT(DISTINCT ""login_date"")>=5) SELECT DISTINCT ""s"".""id"",""a"".""name"" FROM ""subq3"" AS ""s"" JOIN ""accounts"" AS ""a"" ON ""s"".""id""=""a"".""id"" ORDER BY ""id"""
416,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
417,"WITH ""t"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" USING (""id"")) SELECT ""t"".""id"",""t"".""name"" FROM (((""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""id""=""t"".""id"" AND ""t2"".""login_date"" - ""t"".""login_date""=1) JOIN ""t"" AS ""t3"" ON ""t3"".""id""=""t"".""id"" AND ""t3"".""login_date"" - ""t"".""login_date""=2) JOIN ""t"" AS ""t4"" ON ""t4"".""id""=""t"".""id"" AND ""t4"".""login_date"" - ""t"".""login_date""=3) JOIN ""t"" AS ""t5"" ON ""t5"".""id""=""t"".""id"" AND ""t5"".""login_date"" - ""t"".""login_date""=4 GROUP BY ""t"".""id"",""t"".""name"" ORDER BY ""t"".""id"""
418,"WITH ""dedupe"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""cte"" AS (SELECT ""id"",(DENSE_RANK() OVER (ORDER BY ""login_date""))-(DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"")) AS ""diff"" FROM ""dedupe""), ""cte2"" AS (SELECT ""id"",""diff"",COUNT(""diff"") FROM ""cte"" GROUP BY 1,2 HAVING COUNT(""diff"")>=5) SELECT DISTINCT ""ac"".""id"",""ac"".""name"" FROM ""accounts"" AS ""ac"" JOIN ""cte2"" ON ""cte2"".""id""=""ac"".""id"" ORDER BY 1"
419,"SELECT DISTINCT ""a"".""id"",""Accounts"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_Date"" BETWEEN 1 AND 4) JOIN ""Accounts"" ON ""a"".""id""=""Accounts"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
420,"WITH ""tb_"" AS (SELECT ""tb1"".""id"" FROM (((""Logins"" AS ""tb1"" JOIN ""Logins"" AS ""tb2"" ON ""tb1"".""id""=""tb2"".""id"" AND ""tb1"".""login_date""=""tb2"".""login_date"" - INTERVAL '1 DAY') JOIN ""Logins"" AS ""tb3"" ON ""tb3"".""id""=""tb2"".""id"" AND ""tb1"".""login_date""=""tb3"".""login_date"" - INTERVAL '2 DAY') JOIN ""Logins"" AS ""tb4"" ON ""tb4"".""id""=""tb3"".""id"" AND ""tb1"".""login_date""=""tb4"".""login_date"" - INTERVAL '3 DAY') JOIN ""Logins"" AS ""tb5"" ON ""tb5"".""id""=""tb4"".""id"" AND ""tb1"".""login_date""=""tb5"".""login_date"" - INTERVAL '4 DAY' GROUP BY ""tb1"".""id"") SELECT ""tb_"".""id"" AS ""id"",""Accounts"".""name"" AS ""name"" FROM ""tb_"" JOIN ""Accounts"" ON ""tb_"".""id""=""Accounts"".""id"" ORDER BY ""tb_"".""id"""
421,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
422,"WITH ""CTE"" AS (SELECT ""l4"".""id"" FROM (SELECT ""l3"".""id"",""l3"".""fifthdatelog"" - ""l3"".""login_date"" AS ""datediffcount"" FROM (SELECT ""l2"".""id"",""l2"".""login_date"",LEAD(""l2"".""login_date"", 4) OVER (PARTITION BY ""l2"".""id"") AS ""fifthdatelog"" FROM (SELECT ""l"".""id"",""l"".""login_date"" FROM ""Logins"" AS ""l"" GROUP BY ""l"".""id"",""l"".""login_date"" ORDER BY ""l"".""login_date"") AS ""l2"") AS ""l3"") AS ""l4"" WHERE ""l4"".""datediffcount""=4 GROUP BY ""l4"".""id"") SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN ""CTE"" ON ""a"".""id""=""CTE"".""id"" GROUP BY ""a"".""id"" ORDER BY ""id"""
423,"SELECT DISTINCT ""c"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
424,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
425,"SELECT DISTINCT ""Logins"".""id"",""Accounts"".""name"" FROM (""Logins"" JOIN ""Logins"" AS ""next_day_login"" ON ""Logins"".""id""=""next_day_login"".""id"" AND ""next_day_login"".""login_date"" - ""Logins"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" ON ""Logins"".""id""=""Accounts"".""id"" GROUP BY ""Logins"".""id"",""Logins"".""login_date"" HAVING COUNT(DISTINCT ""next_day_login"".""login_date"")=4"
426,"WITH ""CONSEC_LOGIN"" AS (SELECT ""LOGINS"".""ID"",""NAME"",""LOGIN_DATE"",DAYOFYEAR(""LOGIN_DATE"")-DENSE_RANK() OVER (PARTITION BY ""ID"" ORDER BY ""LOGIN_DATE"") AS ""DATE_RANK"" FROM ""LOGINS"" NATURAL CROSS JOIN ""ACCOUNTS"") SELECT DISTINCT ""ID"",""NAME"" FROM ""CONSEC_LOGIN"" GROUP BY ""DATE_RANK"",""ID"" HAVING COUNT(DISTINCT ""LOGIN_DATE"")>=5 ORDER BY ""ID"""
427,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
428,"WITH ""cte"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""ld_group"" FROM ""logins"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" GROUP BY ""id"",""ld_group"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""c"".""id"""
429,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""r"" AS (SELECT ""t1"".""id"",""t1"".""login_date"",COUNT(""t2"".""login_date"") FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date""<=""t1"".""login_date"" + INTERVAL '4 DAY' AND ""t2"".""login_date"">=""t1"".""login_date"" GROUP BY 1,2 HAVING COUNT(""t2"".""login_date"")>=5) SELECT DISTINCT ""r"".""id"",""a"".""name"" FROM ""r"" JOIN ""accounts"" AS ""a"" ON ""r"".""id""=""a"".""id"" ORDER BY 1"
430,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) LEFT JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
431,"WITH ""FIVE_DAYS_TABLE"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""FIVE_DAYS_AFTER"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""UNIQUE_DATE_TABLE"") SELECT DISTINCT ""F"".""id"",""A"".""name"" FROM ""FIVE_DAYS_TABLE"" AS ""F"" JOIN ""Accounts"" AS ""A"" USING (""id"") WHERE ""FIVE_DAYS_AFTER"" - ""login_date""=4 ORDER BY ""id"""
432,"WITH ""table1"" AS (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 1) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_1"",LEAD(""login_date"", 2) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_2"",LEAD(""login_date"", 3) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_3"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_4"",LAG(""login_date"", 1) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_1"",LAG(""login_date"", 2) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_2"",LAG(""login_date"", 3) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_3"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_4"" FROM ""Logins"" LEFT JOIN ""Accounts"" USING (""id"") GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") SELECT DISTINCT ""id"",""name"" FROM ""table1"" WHERE (""lead_4"" - ""lead_3""*""lead_3"" - ""lead_2""*""lead_2"" - ""lead_1""*""lead_1"" - ""login_date"")=1 OR (""login_date"" - ""lag_1""*""lag_1"" - ""lag_2""*""lag_2"" - ""lag_3""*""lag_3"" - ""lag_4"")=1"
433,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
434,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_4_login_date"" FROM ""cte1"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte2"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""c"".""next_4_login_date"" - ""c"".""login_date""=4 ORDER BY ""c"".""id"""
435,"WITH ""tmp"" AS (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") SELECT ""a"".""id"",""name"" FROM ""tmp"" AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""lag_date"" - ""login_date""=-4 GROUP BY 1,2 ORDER BY ""id"""
436,"WITH ""tb1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""logins""), ""tb2"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""groupings"" FROM ""tb1""), ""result_tb"" AS (SELECT ""id"",MIN(""login_date"") AS ""start_date"",MAX(""login_date"") AS ""end_date"",""groupings"" FROM ""tb2"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""start_date"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""result_tb"" ON ""result_tb"".""id""=""a"".""id"" ORDER BY 1"
437,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" LEFT JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING (COUNT(DISTINCT ""l2"".""login_date""))=5 ORDER BY ""l1"".""id"""
438,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON (""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4) ORDER BY ""id"""
439,"WITH ""cte"" AS (SELECT ""l1"".""id"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_Date"")=4) SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT * FROM ""cte"") ORDER BY ""id"""
440,"WITH ""cte"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""groupings"" FROM ""cte""), ""cte2"" AS (SELECT ""id"",""groupings"",MIN(""login_date"") AS ""start_date"",MAX(""login_date"") AS ""end_date"" FROM ""cte1"" GROUP BY ""id"",""groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""start_date"") SELECT DISTINCT ""c"".""id"" AS ""id"",""a"".""name"" AS ""name"" FROM ""cte2"" AS ""c"" JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
441,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
442,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""t1"") AS ""t2"" JOIN ""accounts"" USING (""id"") WHERE ""lag_date"" - ""login_date""=4 ORDER BY ""id"""
443,"SELECT DISTINCT ""t"".""id"",""a"".""name"" FROM (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(DISTINCT ""l2"".""login_date"") AS ""cnt"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4 GROUP BY 1,2) AS ""t"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""t"".""id"" WHERE ""cnt"">=5 ORDER BY ""t"".""id"""
444,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" - INTERVAL '""row_num"" DAY' AS ""groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""id"",""name"" FROM ""answer_table"" JOIN ""accounts"" USING (""id"") ORDER BY ""answer_table"".""id"""
445,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""Accounts"" AS ""a"" JOIN ""Logins"" AS ""l"" ON ""l"".""id""=""a"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_active_days"") AS ""t"" WHERE ""login_date"" + INTERVAL ''4' DAY'=""fifth_date"""
446,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
447,"WITH ""new_logins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""login_table"" AS (SELECT ""a"".""id"",""a"".""login_date"" AS ""currentdate"",""b"".""login_date"" AS ""previous_logins"",""a"".""login_date"" - ""b"".""login_date"" AS ""days_ago"" FROM ""new_logins"" AS ""a"" JOIN ""new_logins"" AS ""b"" ON (""a"".""id""=""b"".""id"" AND ""a"".""login_date"">=""b"".""login_date"") WHERE ""a"".""login_date"" - ""b"".""login_date""<=4), ""login_past_5_day"" AS (SELECT ""id"",""previous_logins"",COUNT(DISTINCT (""currentdate"")) AS ""logins"" FROM ""login_table"" GROUP BY ""id"",""previous_logins"" HAVING COUNT(1)>=5) SELECT DISTINCT ""l"".""id"",""a"".""name"" FROM ""login_past_5_day"" AS ""l"" JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" ORDER BY ""id"""
448,"SELECT DISTINCT ""a"".* FROM (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t1"") AS ""t2"" LEFT JOIN ""Accounts"" AS ""a"" ON ""t2"".""id""=""a"".""id"" WHERE ""login_date"" - ""lag_date""=4"
449,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM ""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
450,"SELECT DISTINCT ""a"".""id"",""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""Logins"" GROUP BY 1,2) AS ""temp"" JOIN ""Accounts"" AS ""a"" ON ""temp"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
451,"WITH ""cte"" AS (SELECT *,LEAD(""login_date"", 4, NULL) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifthDay"" FROM ""Logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""cte"" AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" WHERE ""fifthDay""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""a"".""id"""
452,"SELECT ""id"",""name"" FROM (SELECT ""id"",""name"",MAX(""day_range"") AS ""max_active_days"" FROM (SELECT ""id"",""name"",""consecutive_group"",COUNT(DISTINCT ""login_date"") AS ""day_range"" FROM (SELECT ""t1"".""id"",""t2"".""name"",""t1"".""login_date"",DENSE_RANK() OVER (ORDER BY ""t1"".""login_date"")-DENSE_RANK() OVER (PARTITION BY ""t1"".""id"" ORDER BY ""t1"".""login_date"") AS ""consecutive_group"" FROM ""Logins"" AS ""t1"" LEFT JOIN ""Accounts"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" ORDER BY 1) AS ""t3"" GROUP BY 1,2,3) AS ""t4"" GROUP BY 1,2) AS ""t5"" WHERE ""max_active_days"">=5 ORDER BY 1"
453,"WITH ""t1"" AS (SELECT ""a"".""id"" FROM ""logins"" AS ""a"" LEFT JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) SELECT DISTINCT ""t1"".""id"",""name"" FROM ""t1"" LEFT JOIN ""accounts"" ON ""t1"".""id""=""accounts"".""id"""
454,"WITH ""distict_login"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") SELECT ""t"".""id"",""a"".""name"" FROM (SELECT DISTINCT (""l1"".""id"") AS ""id"" FROM (""distict_login"" AS ""l1"") CROSS JOIN ""distict_login"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"">=""l2"".""login_date"" AND ""l1"".""login_date"" - ""l2"".""login_date""<=4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(""l1"".""id"")>=5) AS ""t"" LEFT JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"""
455,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
456,"SELECT DISTINCT (""l1"".""id""),(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
457,"WITH ""L"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""gp"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""distinctt""), ""cte"" AS (SELECT ""id"" FROM (SELECT ""id"",MAX(""login_date"") AS ""endday"",MIN(""login_date"") AS ""startday"" FROM ""L"" GROUP BY ""id"",""login_date"" + INTERVAL '-""gp"" DAY') AS ""t"" WHERE ""endday"" - ""startday"">=4) SELECT DISTINCT ""cte"".""id"",""name"" FROM ""cte"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" ORDER BY 1"
458,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
459,"SELECT DISTINCT ""acc"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
460,"WITH ""cte"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""num"",""login_date"" + INTERVAL '4 DAY' AS ""diff"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""c"".""id"",""name"" FROM ""cte"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""num""=""diff"" ORDER BY ""c"".""id"""
461,"WITH ""t"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_5"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t2"") SELECT DISTINCT ""t"".""id"",""name"" FROM ""Accounts"" AS ""a"" LEFT JOIN ""t"" ON ""a"".""id""=""t"".""id"" WHERE ""t"".""login_date"" - ""lag_5""=4 ORDER BY ""id"""
462,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM (SELECT ""id"",CASE WHEN ""lag_login_date"" IS NULL THEN @""counter"":=1 WHEN ""login_date"" - ""lag_login_date""=1 THEN @""counter"":=@""counter""+1 ELSE @""counter"":=1 END AS ""consistency"" FROM (SELECT ""id"",""login_date"",LAG(""login_date"") OVER (PARTITION BY ""id"") AS ""lag_login_date"" FROM (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""id_login_unique"") AS ""lagged_login"") AS ""concesutive_ids"" WHERE ""concesutive_ids"".""consistency"">=5) ORDER BY ""id"""
463,"SELECT DISTINCT ""t4"".""id"",""t5"".""name"" FROM (SELECT ""id"",""diff_id"",COUNT(""diff_id"") AS ""total_login"" FROM (SELECT ""t2"".""id"",(CAST(""diff"" AS INTEGER)-CAST(""row_id"" AS INTEGER)) AS ""diff_id"" FROM (SELECT *,""login_date"" - CAST('2020-05-30' AS DATE) AS ""diff"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_id"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""t1"") AS ""t2"") AS ""t3"" GROUP BY ""id"",""diff_id"") AS ""t4"" JOIN ""Accounts"" AS ""t5"" ON ""t5"".""id""=""t4"".""id"" WHERE ""total_login"">=5 ORDER BY ""id"""
464,"WITH ""t"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag5"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t2"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""Accounts"" AS ""a"" LEFT JOIN ""t"" ON ""a"".""id""=""t"".""id"" WHERE ""login_date"" - ""lag5""=4 ORDER BY ""id"""
465,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
466,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
467,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(1)>=5) ORDER BY ""id"""
468,"SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM (SELECT ""id"",COUNT(1) AS ""days"" FROM (SELECT ""id"",CURDATE() - ""login_date"" AS ""diff"",@""rnk"":=@""rnk""+1 AS ""rnk"" FROM (SELECT DISTINCT * FROM ""logins"" ORDER BY 1,2 DESC) AS ""l"" CROSS, (SELECT @""rnk"":=0) AS ""r"") AS ""temp"" GROUP BY ""id"",(""diff""-""rnk"") HAVING ""days"">=5) AS ""a"" LEFT JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" ORDER BY 1"
469,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
470,"WITH ""logins_cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""temp"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_login_date"" FROM ""logins_cte"") SELECT ""id"",""name"" FROM ""accounts"" AS ""a"" WHERE ""id"" IN (SELECT ""id"" FROM ""temp"" WHERE ""fifth_login_date"" - ""login_date""=4) ORDER BY ""id"""
471,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" - INTERVAL '""row_num"" DAY' AS ""groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4) SELECT DISTINCT ""id"",""name"" FROM ""answer_table"" JOIN ""accounts"" USING (""id"") ORDER BY ""answer_table"".""id"""
472,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM (""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>3) ORDER BY ""id"""
473,"SELECT DISTINCT ""a"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""gap"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""ded_a"") AS ""a"" JOIN ""Accounts"" ON ""a"".""id""=""Accounts"".""id"" WHERE ""gap""=4 ORDER BY ""a"".""id"""
474,"WITH ""temp"" AS (SELECT ""l1"".""id"",""l1"".""login_date"",COUNT(DISTINCT ""l2"".""login_date"") AS ""cnt"" FROM ""Logins"" AS ""l1"" LEFT JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY 1,2 HAVING ""cnt"">=4) SELECT DISTINCT ""temp"".""id"",""name"" FROM ""temp"" JOIN ""Accounts"" ON ""temp"".""id""=""Accounts"".""id"" ORDER BY 1"
475,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""A"") CROSS JOIN ""Logins"" AS ""B"" WHERE ""A"".""id""=""B"".""id"" AND ""A"".""login_date"" - ""B"".""login_date"" BETWEEN 1 AND 4 GROUP BY 1,""a"".""login_date"" HAVING COUNT(DISTINCT ""B"".""login_date"")=4"
476,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
477,"WITH ""cte"" AS (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""final"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""cte"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" WHERE ""final""=4 ORDER BY ""id"""
478,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",DAYOFYEAR(""login_date"") AS ""doy"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""cte""), ""cte3"" AS (SELECT DISTINCT ""id"" FROM ""cte1"" GROUP BY ""id"",""doy""-""rn"" HAVING COUNT(1)>=5) SELECT ""a"".""id"",""a"".""name"" FROM (""accounts"" AS ""a"") CROSS JOIN ""cte3"" AS ""c"" WHERE ""a"".""id""=""c"".""id"" ORDER BY ""id"""
479,"WITH ""cte"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_4_day"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""unique_t"" ORDER BY ""id"",""login_date"") SELECT DISTINCT ""cte"".""id"",""a"".""name"" FROM ""cte"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""cte"".""id"" WHERE ""next_4_day"" - ""login_date""=4"
480,"SELECT DISTINCT ""a"".""id"",""aa"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" USING (""id"")) LEFT JOIN ""Accounts"" AS ""aa"" USING (""id"") WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
481,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
482,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
483,"WITH ""CTE"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"" ORDER BY ""id"",""login_date""), ""CTE1"" AS (SELECT *,""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM ""CTE"") SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""CTE1"" WHERE ""diff""=4) ORDER BY 1"
484,"SELECT DISTINCT ""a"".""id"",""ac"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""login_date"" - ""b"".""login_Date"" BETWEEN 1 AND 4 AND ""a"".""id""=""b"".""id"") JOIN ""accounts"" AS ""ac"" ON ""ac"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
485,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
486,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""accounts"" AS ""a"" JOIN ""logins"" AS ""l"" ON ""l"".""id""=""a"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_active_days"" AS ""uad"") AS ""t"" WHERE ""login_date"" + INTERVAL ''4' DAY'=""fifth_date"""
487,"SELECT DISTINCT ""cte"".""id"",""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_5"" FROM ""logins"" GROUP BY ""id"",""login_date"") AS ""cte"" JOIN ""Accounts"" AS ""b"" ON ""cte"".""id""=""b"".""id"" WHERE ""cte"".""date_5""=""cte"".""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
488,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""t1"".""id"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT (""t2"".""login_date""))=4) ORDER BY ""id"""
489,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
490,"WITH ""CTE1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""CTE2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_lead_five"" FROM ""CTE1"") SELECT DISTINCT ""c2"".""id"",""a"".""name"" FROM ""CTE2"" AS ""c2"" JOIN ""Accounts"" AS ""a"" ON ""c2"".""id""=""a"".""id"" WHERE ""c2"".""date_lead_five"" - ""c2"".""login_date""=4 ORDER BY ""c2"".""id"""
491,"SELECT DISTINCT ""L1"".""id"",""A"".""name"" FROM (""Accounts"" AS ""A"" JOIN ""Logins"" AS ""L1"" ON ""A"".""id""=""L1"".""id"") JOIN ""Logins"" AS ""L2"" ON ""L1"".""id""=""L2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""L1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")=4 ORDER BY ""L1"".""id"""
492,"SELECT DISTINCT ""tt1"".""id"",""name"" FROM (SELECT ""t1"".""id"",""t1"".""login_date"" FROM ""logins"" AS ""t1"" LEFT JOIN ""logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date"" - ""t1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT ""t2"".""login_date"")=4) AS ""tt1"" JOIN ""Accounts"" AS ""tt2"" ON ""tt1"".""id""=""tt2"".""id"" ORDER BY ""tt1"".""id"""
493,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
494,"WITH ""distinctlogins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" ORDER BY ""id"",""login_date""), ""firstlastdate"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"" FROM ""distinctlogins"") SELECT DISTINCT ""f"".""id"",""a"".""name"" FROM (""firstlastdate"" AS ""f"") CROSS JOIN ""accounts"" AS ""a"" WHERE ""f"".""id""=""a"".""id"" AND ""f"".""day5"" - ""f"".""login_date""=4 ORDER BY ""a"".""id"""
495,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
496,"WITH ""uni"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""win"" AS (SELECT ""l"".""id"",""l"".""login_date"",SUM(CASE WHEN ""r"".""login_date"" IS NULL THEN 1 ELSE 0 END) OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""con_int"" FROM ""uni"" AS ""l"" LEFT JOIN ""uni"" AS ""r"" ON ""l"".""id""=""r"".""id"" AND ""l"".""login_date"" + INTERVAL '-1 DAY'=""r"".""login_date""), ""agg"" AS (SELECT ""id"",""con_int"",COUNT(DISTINCT ""login_date"") AS ""ct_days"" FROM ""win"" GROUP BY 1,2) SELECT ""ag"".""id"",""ac"".""name"" FROM ""agg"" AS ""ag"" JOIN ""accounts"" AS ""ac"" ON ""ag"".""id""=""ac"".""id"" GROUP BY 1,2 HAVING MAX(""ag"".""ct_days"")>=5 ORDER BY 1,2"
497,"WITH ""cte"" AS (SELECT ""a"".""id"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4) SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"") ORDER BY 1"
498,"SELECT ""AA"".""id"",""a"".""name"" FROM (SELECT DISTINCT ""l1"".""id"" FROM (((""Logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" + INTERVAL '1 DAY'=""l2"".""login_date"") JOIN ""logins"" AS ""l3"" ON ""l2"".""id""=""l3"".""id"" AND ""l2"".""login_date"" + INTERVAL '1 DAY'=""l3"".""login_date"") JOIN ""logins"" AS ""l4"" ON ""l3"".""id""=""l4"".""id"" AND ""l3"".""login_date"" + INTERVAL '1 DAY'=""l4"".""login_date"") JOIN ""logins"" AS ""l5"" ON ""l4"".""id""=""l5"".""id"" AND ""l4"".""login_date"" + INTERVAL '1 DAY'=""l5"".""login_date"") AS ""AA"" JOIN ""Accounts"" AS ""a"" ON ""AA"".""id""=""a"".""id"" ORDER BY ""AA"".""id"""
499,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
500,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
501,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l2"".""id""=""l1"".""id"") JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" WHERE ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
502,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""logins""), ""cte2"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rn"" DAY' AS ""group_index"" FROM ""cte1"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""group_index"" HAVING COUNT(""a"".""id"")>=5 ORDER BY ""a"".""id"""
503,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" USING (""id"") WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
504,"SELECT DISTINCT ""a"".""id"",""acc"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""a"".""id""=""acc"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
505,"WITH ""a"" AS (SELECT DISTINCT * FROM ""logins"" ORDER BY ""id"",""login_Date"") SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM (SELECT ""id"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""date_diff"" FROM ""a"") AS ""b"" WHERE ""date_diff""=4) ORDER BY ""id"""
506,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""logins""), ""cte2"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rn"" DAY' AS ""group_index"" FROM ""cte1"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""group_index"" HAVING COUNT(""a"".""id"")>=5 ORDER BY ""a"".""id"""
507,"WITH ""log"" AS (SELECT *,LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ld4"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""sub""), ""active"" AS (SELECT * FROM ""log"" WHERE ""login_date"" - INTERVAL '4 DAY'=""ld4"") SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""a"".""id"" FROM ""active"" AS ""a"") ORDER BY ""id"""
508,"WITH ""active"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag4"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""t"") SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN ""active"" AS ""a1"" ON ""a"".""id""=""a1"".""id"" AND ""login_date"" - ""lag4""=4 GROUP BY 1 ORDER BY 1"
509,"SELECT DISTINCT ""z"".""id"",""name"" FROM (SELECT ""l"".""id"",""l"".""login_date"",LEAD(""l"".""login_date"", 4) OVER (PARTITION BY ""l"".""id"" ORDER BY ""login_date"") AS ""seq"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"" AS ""l"") AS ""l"") AS ""z"" LEFT JOIN ""accounts"" AS ""a"" ON ""z"".""id""=""a"".""id"" WHERE ""seq"" - ""login_date""=4"
510,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
511,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_date"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT DISTINCT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"") AS ""x"") AS ""y"" WHERE ""diff""=4"
512,"WITH ""cte"" AS (SELECT ""id"",""login_date"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""l"" ORDER BY ""id"",""login_date""), ""cte2"" AS (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""grp"" FROM ""cte"" ORDER BY ""id"",""login_date"",""grp"") SELECT DISTINCT ""cte2"".""id"",""name"" FROM ""cte2"" LEFT JOIN ""accounts"" AS ""a"" ON ""cte2"".""id""=""a"".""id"" GROUP BY ""cte2"".""id"",""grp"",""name"" HAVING COUNT(1)>=5"
513,"SELECT DISTINCT ""a"".""id"",""ac"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""ac"" ON ""ac"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
514,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""t1"".""id"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 1 AND 4 AND ""t1"".""login_date"">""t2"".""login_date"" GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING (COUNT(DISTINCT ""t2"".""login_date"")=4)) ORDER BY ""id"""
515,"SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT (""l2"".""login_date""))=4) ORDER BY ""id"""
516,"ERROR: mysql parse error: line 1 column 8 near ""Accounts where id in ( select distinct(id) from ( select id, datediff(login_date, lag(login_date,4) over ( partition by id order by login_date asc )) as diff from (select id, login_date from Logins group by id, login_date) b ) a where a.diff = 4 ) order by id "" "
517,"WITH ""distict_login"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") SELECT ""t"".""id"",""a"".""name"" FROM (SELECT DISTINCT (""l1"".""id"") AS ""id"" FROM (""distict_login"" AS ""l1"") CROSS JOIN ""distict_login"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"">=""l2"".""login_date"" AND ""l1"".""login_date"" - ""l2"".""login_date""<=4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(""l1"".""id"")>=5) AS ""t"" LEFT JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" ORDER BY 1"
518,"WITH ""t"" AS (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '1 DAY' AS ""1daydiff"",""login_date"" + INTERVAL '2 DAY' AS ""2daydiff"",""login_date"" + INTERVAL '3 DAY' AS ""3daydiff"",""login_date"" + INTERVAL '4 DAY' AS ""4daydiff"" FROM ""Logins"") AS ""sub"" WHERE (ROW(""id"",""1daydiff"") IN (SELECT ""id"",""login_date"" FROM ""Logins"") AND ROW(""id"",""2daydiff"") IN (SELECT ""id"",""login_date"" FROM ""Logins"") AND ROW(""id"",""3daydiff"") IN (SELECT ""id"",""login_date"" FROM ""Logins"") AND ROW(""id"",""4daydiff"") IN (SELECT ""id"",""login_date"" FROM ""Logins""))) SELECT ""t"".""id"",""name"" FROM (""t"") CROSS JOIN ""Accounts"" WHERE ""t"".""id""=""Accounts"".""id"" ORDER BY ""t"".""id"""
519,"WITH ""login_grouped"" AS (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY 1,2) SELECT ""l1"".""id"",""name"" FROM ((((""login_grouped"" AS ""l1"" JOIN ""login_grouped"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date""=1) JOIN ""login_grouped"" AS ""l3"" ON ""l1"".""id""=""l3"".""id"" AND ""l3"".""login_date"" - ""l1"".""login_date""=2) JOIN ""login_grouped"" AS ""l4"" ON ""l1"".""id""=""l4"".""id"" AND ""l4"".""login_date"" - ""l1"".""login_date""=3) JOIN ""login_grouped"" AS ""l5"" ON ""l1"".""id""=""l5"".""id"" AND ""l5"".""login_date"" - ""l1"".""login_date""=4) JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""name"" ORDER BY ""l1"".""id"""
520,"SELECT DISTINCT (""a"".""id"") AS ""id"",(SELECT ""accounts"".""name"" FROM ""accounts"" WHERE ""a"".""id""=""accounts"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
521,"WITH ""CTE1"" AS (SELECT ""ID"",""LOGIN_DATE"",ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""LOGIN_DATE"") AS ""RNO"" FROM (SELECT DISTINCT ""ID"",""LOGIN_DATE"" FROM ""LOGINS"") AS ""T""), ""CTE2"" AS (SELECT *,""LOGIN_DATE"" - INTERVAL '""RNO"" DAY' AS ""CONSECUTIVE"" FROM ""CTE1"" GROUP BY ""ID"",""CONSECUTIVE"" HAVING COUNT(""RNO"")>=5) SELECT DISTINCT ""ID"",""NAME"" FROM ""CTE2"" JOIN ""ACCOUNTS"" USING (""ID"") ORDER BY ""ID"""
522,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
523,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""t1"".""id"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT (""t2"".""login_date""))=4) ORDER BY ""id"""
524,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ((((""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON (""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" + INTERVAL '1 DAY'=""l2"".""login_date"")) JOIN ""Logins"" AS ""l3"" ON (""l1"".""id""=""l3"".""id"" AND ""l1"".""login_date"" + INTERVAL '2 DAY'=""l3"".""login_date"")) JOIN ""Logins"" AS ""l4"" ON (""l1"".""id""=""l4"".""id"" AND ""l1"".""login_date"" + INTERVAL '3 DAY'=""l4"".""login_date"")) JOIN ""Logins"" AS ""l5"" ON (""l1"".""id""=""l5"".""id"" AND ""l1"".""login_date"" + INTERVAL '4 DAY'=""l5"".""login_date"")) JOIN ""Accounts"" AS ""a"" ON (""l1"".""id""=""a"".""id"") ORDER BY 1"
525,"WITH ""login_info"" AS (SELECT ""a"".""id"",""a"".""login_date"" FROM ""logins"" AS ""a"" LEFT JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""b"".""login_date"" BETWEEN ""a"".""login_date"" AND ""a"".""login_date"" + INTERVAL '4 DAY' GROUP BY 1,2 HAVING COUNT(DISTINCT ""b"".""login_date"")=5) SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""login_info"") ORDER BY ""id"""
526,"SELECT DISTINCT ""a"".""id"" AS ""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
527,"SELECT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_day"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY 1,2,3 ORDER BY ""l"".""id"",""l"".""login_date"") AS ""x"") AS ""y"" WHERE ""lead_date""=""fifth_day"" GROUP BY 1,2"
528,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" WHERE ""a"".""id"" IN (SELECT ""l"".""id"" FROM (SELECT DISTINCT ""l"".""id"",""l"".""login_date"",""l"".""login_date"" - CAST('1970-01-01' AS DATE)-DENSE_RANK() OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""rk_group"" FROM ""Logins"" AS ""l"") AS ""l"" GROUP BY ""l"".""rk_group"",""l"".""id"" HAVING COUNT(""l"".""login_date"")>=5) ORDER BY ""a"".""id"""
529,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
530,"SELECT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_date"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY 1,2,3) AS ""x"") AS ""y"" WHERE ""diff""=4 GROUP BY 1,2"
531,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ((""Logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"") CROSS JOIN ""accounts"" AS ""a"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""id""=""a"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
532,"SELECT DISTINCT (""l1"".""id""),(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
533,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date""<""b"".""login_date"" WHERE ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
534,"SELECT DISTINCT ""Accounts"".""id"",""Accounts"".""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""A"") AS ""B"" JOIN ""Accounts"" ON ""Accounts"".""id""=""B"".""id"" WHERE ""lead_""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
535,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ""Logins"" AS ""l1"" LEFT JOIN ""Accounts"" AS ""a"" USING (""id"") WHERE ""login_date"" - INTERVAL '1 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"") AND ""login_date"" - INTERVAL '2 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l3"" WHERE ""l1"".""id""=""l3"".""id"") AND ""login_date"" - INTERVAL '3 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l4"" WHERE ""l1"".""id""=""l4"".""id"") AND ""login_date"" - INTERVAL '4 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l5"" WHERE ""l1"".""id""=""l5"".""id"") ORDER BY ""l1"".""id"""
536,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""logins"") SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""login_date"" - INTERVAL '""rn"" DAY' HAVING COUNT(""id"")>=5) ORDER BY ""id"""
537,"SELECT DISTINCT ""tmp3"".""id"",""Accounts"".""name"" FROM (SELECT ""l"".""id"" FROM (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day_rk"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""tmp1"" ORDER BY ""id"",""day_rk"") AS ""l"" LEFT JOIN (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day_rk"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""tmp2"" ORDER BY ""id"",""day_rk"") AS ""r"" ON ""l"".""id""=""r"".""id"" AND ""l"".""day_rk""+4=""r"".""day_rk"" WHERE ""l"".""login_date"" + INTERVAL '4 DAY'=""r"".""login_date"") AS ""tmp3"" LEFT JOIN ""Accounts"" USING (""id"")"
538,"SELECT DISTINCT ""a"".""id"",""b"".""name"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""l"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""tr"") AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""l"" - ""a"".""login_date""=4 ORDER BY ""a"".""id"""
539,"SELECT DISTINCT ""p1"".""id"",""a"".""name"" FROM (""Logins"" AS ""p1"" JOIN ""Logins"" AS ""p2"" USING (""id"")) JOIN ""accounts"" AS ""a"" USING (""id"") WHERE ""p1"".""login_date"" - ""p2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""p1"".""id"",""p1"".""login_date"" HAVING COUNT(DISTINCT ""p2"".""login_date"")=4"
540,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
541,"SELECT DISTINCT ""Accounts"".""id"",""name"" FROM (SELECT DISTINCT ""id"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""diff"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""Logins_distinct"") AS ""diff"" JOIN ""Accounts"" ON ""diff"".""id""=""Accounts"".""id"" WHERE ""diff"".""diff""=4 ORDER BY ""Accounts"".""id"""
542,"SELECT DISTINCT ""n"".""id"",""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5"",""login_date"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""n"" JOIN ""Accounts"" AS ""a"" ON ""n"".""id""=""a"".""id"" WHERE ""day5""=""login_date"" + INTERVAL '4 DAY' ORDER BY ""id"""
543,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
544,"SELECT DISTINCT (""l1"".""id""),(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
545,"SELECT DISTINCT ""c"".""id"",""c"".""name"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"",LEAD(""l"".""login_date"", 4) OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") AS ""five"",LEAD(""l"".""login_date"", 4) OVER (PARTITION BY ""l"".""id"" ORDER BY ""l"".""login_date"") - ""l"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""l"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l"".""id"" GROUP BY ""l"".""id"",""l"".""login_date"",""a"".""name"") AS ""c"" WHERE ""c"".""diff""=5"
546,"SELECT DISTINCT ""a"".""id"",""name"" FROM ""Accounts"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ROW(""a"".""id"",""login_date"" + INTERVAL '1 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '2 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '3 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '4 DAY') IN (SELECT * FROM ""logins"") ORDER BY ""a"".""id"""
547,"WITH ""cte"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lx"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""cc"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""accounts"" AS ""a"" JOIN ""cte"" AS ""c"" ON ""a"".""id""=""c"".""id"" WHERE ABS(""login_date"" - ""lx"")=4 ORDER BY ""a"".""id"""
548,"WITH ""base"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"") AS ""fifth_dt"" FROM (SELECT * FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") SELECT ""p"".""id"",""q"".""name"" FROM (SELECT *,CASE WHEN (""login_date"" + INTERVAL '4 DAY'=""fifth_dt"") THEN 1 ELSE 0 END AS ""result"" FROM ""base"") AS ""p"" JOIN ""Accounts"" AS ""q"" ON ""p"".""id""=""q"".""id"" WHERE ""result""=1 GROUP BY ""p"".""id"",""q"".""name"" ORDER BY ""p"".""id"""
549,"WITH ""lead_login_dates_cte"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""distinct_logins"") SELECT DISTINCT ""id"",""name"" FROM ""lead_login_dates_cte"" JOIN ""accounts"" USING (""id"") WHERE ""lead_date"" - ""login_date""=4 ORDER BY ""id"""
550,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
551,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""login_date"",""login_date"" - INTERVAL 'DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""grp"" FROM ""logins"") AS ""tmp"" JOIN ""accounts"" USING (""id"") GROUP BY ""tmp"".""id"",""tmp"".""grp"" HAVING COUNT(DISTINCT ""login_date"")>=5"
552,"WITH ""CTE"" AS (SELECT ""l4"".""id"" FROM (SELECT ""l3"".""id"",""l3"".""fifthdatelog"" - ""l3"".""login_date"" AS ""datediffcount"" FROM (SELECT ""l2"".""id"",""l2"".""login_date"",LEAD(""l2"".""login_date"", 4) OVER (PARTITION BY ""l2"".""id"") AS ""fifthdatelog"" FROM (SELECT ""l"".""id"",""l"".""login_date"" FROM ""Logins"" AS ""l"" GROUP BY ""l"".""id"",""l"".""login_date"" ORDER BY ""l"".""login_date"") AS ""l2"") AS ""l3"") AS ""l4"" WHERE ""l4"".""datediffcount""=4 GROUP BY ""l4"".""id"") SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN ""CTE"" ON ""a"".""id""=""CTE"".""id"" GROUP BY ""a"".""id"" ORDER BY ""id"""
553,"WITH ""t"" AS (SELECT DISTINCT * FROM ""logins""), ""r"" AS (SELECT ""t1"".""id"",""t1"".""login_date"" FROM ""t"" AS ""t1"" JOIN ""t"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date""<=""t1"".""login_date"" + INTERVAL '4 DAY' AND ""t2"".""login_date"">=""t1"".""login_date"" GROUP BY 1,2 HAVING COUNT(""t2"".""login_date"")>=5) SELECT DISTINCT ""r"".""id"",""a"".""name"" FROM ""r"" JOIN ""accounts"" AS ""a"" ON ""r"".""id""=""a"".""id"" ORDER BY 1"
554,"WITH ""a"" AS (SELECT DISTINCT * FROM ""Logins""), ""c"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""day5_login"" FROM ""a""), ""b"" AS (SELECT ""id"",""day5_login"" - ""login_date"" AS ""days_to_d5"" FROM ""c"") SELECT DISTINCT ""b"".""id"",""Accounts"".""name"" FROM ""b"" JOIN ""Accounts"" ON ""b"".""id""=""Accounts"".""id"" WHERE ""b"".""days_to_d5""=4 ORDER BY ""b"".""id"""
555,"WITH ""gaps_and_islands"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins""), ""filled_gaps"" AS (SELECT ""id"",""login_date"",""rnk"",""login_date"" + INTERVAL '-""rnk"" DAY' AS ""nw_date"" FROM ""gaps_and_islands"") SELECT DISTINCT ""a"".""id"",""name"" FROM (SELECT ""id"",MIN(""login_date""),MAX(""login_date""),""rnk"",""nw_date"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") FROM ""filled_gaps"" GROUP BY ""id"",""nw_date"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4) AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" ORDER BY ""id"""
556,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_nextdate5"" FROM ""cte1"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte2"" AS ""c"" JOIN ""Accounts"" AS ""a"" ON (""c"".""id""=""a"".""id"") WHERE ""c"".""login_nextdate5"" - ""c"".""login_date""=4 ORDER BY ""c"".""id"""
557,"SELECT DISTINCT ""id"",""name"" FROM (SELECT DISTINCT ""logins"".""id"",""logins"".""login_date"",""a"".""name"",ROW_NUMBER() OVER (PARTITION BY ""logins"".""id"" ORDER BY ""logins"".""login_date"") AS ""ranking"",LEAD(""login_date"", 4) OVER (PARTITION BY ""logins"".""id"" ORDER BY ""logins"".""login_date"") AS ""day5"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""logins"" JOIN ""accounts"" AS ""a"" ON ""logins"".""id""=""a"".""id"") AS ""asd"" WHERE ""day5"" - ""login_date""=4"
558,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""a"".""id"""
559,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
560,"WITH ""temp1"" AS (SELECT ""a"".""id"",""a"".""login_date"",""b"".""login_date"" AS ""login_date_b"" FROM ""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 AND ""a"".""id""=""b"".""id"") SELECT DISTINCT ""temp1"".""id"",""a"".""name"" FROM ""temp1"" JOIN ""accounts"" AS ""a"" ON ""temp1"".""id""=""a"".""id"" GROUP BY ""temp1"".""id"",""login_date"" HAVING COUNT(DISTINCT ""temp1"".""login_date_b"")=4"
561,"SELECT DISTINCT ""a"".""id"",""name"" FROM (SELECT ""id"",""login_date"",COUNT(""id"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"" RANGE BETWEEN INTERVAL 4 DAY PRECEDING AND CURRENT ROW) AS ""cnt"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""a"") AS ""b"" JOIN ""Accounts"" AS ""a"" ON ""b"".""id""=""a"".""id"" WHERE ""cnt"">=5 ORDER BY ""a"".""id"""
562,"WITH ""cte1"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""cte2"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_4_login_date"" FROM ""cte1"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte2"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""c"".""next_4_login_date"" - ""c"".""login_date""=4 ORDER BY ""c"".""id"""
563,"WITH ""cte"" AS (SELECT DISTINCT ""a"".""id"",""a"".""login_date"",""b"".""name"" FROM ""Logins"" AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id""), ""cte2"" AS (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""cte"") SELECT DISTINCT ""id"",""name"" FROM ""cte2"" WHERE ""fifth_date"" - ""login_date""=4"
564,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
565,"WITH ""a"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""b"" AS (SELECT *,RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""a"") SELECT DISTINCT ""b"".""id"",""a"".""name"" FROM ""b"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""b"".""id"" GROUP BY 1,""b"".""login_date"" - INTERVAL '""b"".""rnk"" DAY' HAVING COUNT(1)>=5 ORDER BY ""a"".""id"""
566,"SELECT DISTINCT ""c"".""id"",""acc"".""name"" FROM (SELECT *,""b"".""login_date"" - ""b"".""lag_date"" AS ""date_diff"" FROM (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") AS ""b"") AS ""c"" JOIN ""accounts"" AS ""acc"" ON ""acc"".""id""=""c"".""id"" WHERE ""date_diff""=4 ORDER BY ""c"".""id"""
567,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
568,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (SELECT DISTINCT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""prev5"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""b"" ORDER BY ""id"",""login_date"") AS ""a"" JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" WHERE ""login_date"" - ""prev5""=4 ORDER BY ""a"".""id"",""c"".""name"""
569,"SELECT DISTINCT ""A"".""id"",""name"" FROM (SELECT ""id"",""login_date"",COUNT(""id"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"" RANGE BETWEEN INTERVAL 4 DAY PRECEDING AND CURRENT ROW) AS ""cnt"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""T"") AS ""A"" LEFT JOIN ""Accounts"" AS ""B"" ON ""A"".""id""=""B"".""id"" WHERE ""cnt"">=5"
570,"SELECT DISTINCT ""a"".""id"",""Accounts"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" ON ""a"".""id""=""accounts"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
571,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ROW(""a"".""id"",""login_date"" + INTERVAL '1 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '2 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '3 DAY') IN (SELECT * FROM ""logins"") AND ROW(""a"".""id"",""login_date"" + INTERVAL '4 DAY') IN (SELECT * FROM ""logins"") ORDER BY 1"
572,"WITH ""distict_login"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") SELECT ""t"".""id"",""a"".""name"" FROM (SELECT DISTINCT (""l1"".""id"") AS ""id"" FROM (""distict_login"" AS ""l1"") CROSS JOIN ""distict_login"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"">=""l2"".""login_date"" AND ""l1"".""login_date"" - ""l2"".""login_date""<=4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(""l1"".""id"")>=5) AS ""t"" LEFT JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"""
573,"SELECT DISTINCT ""l1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" WHERE ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT (""l2"".""login_date""))=4"
574,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""t1"".""id"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""login_date"" - ""t2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT (""t2"".""login_date""))=4) ORDER BY ""id"""
575,"SELECT ""t5"".""id"",""Accounts"".""name"" FROM (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""d1"",COUNT(DISTINCT ""d2"") AS ""cc"" FROM (SELECT ""t1"".""id"",""t1"".""login_date"" AS ""d1"",""t2"".""login_date"" AS ""d2"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date"" - ""t1"".""login_date""<=4 AND ""t2"".""login_date"" - ""t1"".""login_date"">=1) AS ""t3"" GROUP BY ""d1"",""id"" HAVING COUNT(DISTINCT ""d2"")=4) AS ""t4"") AS ""t5"" JOIN ""Accounts"" ON ""Accounts"".""id""=""t5"".""id"" ORDER BY ""t5"".""id"""
576,"WITH ""cte"" AS (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY 1,2) SELECT DISTINCT ""temp"".""id"",""temp"".""name"" FROM (SELECT ""a"".""name"",""a"".""id"",""login_date"" + INTERVAL '-ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""grp"" FROM ""accounts"" AS ""a"" JOIN ""cte"" AS ""l"" ON ""a"".""id""=""l"".""id"") AS ""temp"" GROUP BY ""temp"".""id"",""temp"".""grp"" HAVING COUNT(1)>=5"
577,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
578,"SELECT * FROM ""ACCOUNTS"" WHERE ""ID"" IN (SELECT DISTINCT ""L1"".""ID"" FROM ""LOGINS"" AS ""L1"" JOIN ""LOGINS"" AS ""L2"" ON ""L1"".""ID""=""L2"".""ID"" AND ""L1"".""LOGIN_DATE"" - ""L2"".""LOGIN_DATE"" BETWEEN 1 AND 4 GROUP BY ""L1"".""ID"",""L1"".""LOGIN_DATE"" HAVING COUNT(DISTINCT (""L2"".""LOGIN_DATE""))=4) ORDER BY ""ID"""
579,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
580,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
581,"SELECT DISTINCT ""t1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""t1"".""id"") AS ""name"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date"" - ""t1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT ""t2"".""login_date"")=4"
582,"SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""a"".""id"" FROM ""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) ORDER BY 1,2"
583,"WITH ""t1"" AS (SELECT * FROM ""logins"" AS ""l"" JOIN ""accounts"" AS ""a"" USING (""id"")) SELECT DISTINCT (""a"".""id""),""a"".""name"" FROM (""t1"" AS ""a"") CROSS JOIN ""t1"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT (""b"".""login_date""))=4"
584,"SELECT ""id"".""id"",""a"".""name"" FROM (SELECT DISTINCT ""l1"".""id"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date""<5 AND ""l1"".""login_date"" - ""l2"".""login_date"">=0 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=5) AS ""id"" LEFT JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""id"".""id"""
585,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=5"
586,"WITH ""distinct_logins"" AS (SELECT DISTINCT * FROM ""Logins""), ""LoginsWithLag"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_4"" FROM ""distinct_logins"") SELECT DISTINCT ""id"",""name"" FROM ""LoginsWithLag"" NATURAL CROSS JOIN ""Accounts"" WHERE ""login_date"" - ""lag_4""=4 ORDER BY ""id"""
587,"WITH ""DistinctLogins"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins""), ""ConsecutiveLogin"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""Day5Login"" FROM ""DistinctLogins""), ""ActiveUserId"" AS (SELECT DISTINCT ""id"" FROM ""ConsecutiveLogin"" WHERE ""Day5Login"" - ""login_date""=4) SELECT ""A"".""id"",""A"".""name"" FROM ""Accounts"" AS ""A"" JOIN ""ActiveUserId"" AS ""AU"" ON ""AU"".""id""=""A"".""id"" ORDER BY 1"
588,"WITH ""tmp"" AS (SELECT *,LAG(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""lag_date"" FROM (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") AS ""a"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""tmp"" AS ""a"" JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""lag_date"" - ""login_date""=-4 ORDER BY ""id"""
589,"SELECT DISTINCT (""l1"".""id""),(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
590,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""Accounts"" AS ""a"" JOIN ""Logins"" AS ""l"" ON ""a"".""id""=""l"".""id"") SELECT DISTINCT ""id"",""Name"" FROM (SELECT DISTINCT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_active_days"") AS ""t"" WHERE ""login_date"" + INTERVAL '4 DAY'=""fifth_date"""
591,"SELECT DISTINCT ""L"".""id"",""Accounts"".""name"" FROM ((((""Logins"" AS ""L"" JOIN ""Logins"" AS ""L1"" ON ""L1"".""login_date"" + INTERVAL '1 DAY'=""L"".""login_date"" AND ""L"".""id""=""L1"".""id"") JOIN ""Logins"" AS ""L2"" ON ""L2"".""login_date"" + INTERVAL '2 DAY'=""L"".""login_date"" AND ""L"".""id""=""L2"".""id"") JOIN ""Logins"" AS ""L3"" ON ""L3"".""login_date"" + INTERVAL '3 DAY'=""L"".""login_date"" AND ""L"".""id""=""L3"".""id"") JOIN ""Logins"" AS ""L4"" ON ""L4"".""login_date"" + INTERVAL '4 DAY'=""L"".""login_date"" AND ""L"".""id""=""L4"".""id"") JOIN ""Accounts"" ON ""Accounts"".""id""=""L"".""id"" ORDER BY ""L"".""id"""
592,"WITH ""cte"" AS (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""cons"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""a"") SELECT DISTINCT (""cte"".""id""),""name"" FROM (""cte"") CROSS JOIN ""Accounts"" AS ""a"" WHERE ""cte"".""id""=""a"".""id"" AND ""cons""=4 ORDER BY ""cte"".""id"""
593,"SELECT DISTINCT ""a"".""id"",""ac"".""name"" FROM (""logins"" AS ""a"" JOIN ""logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_Date"" BETWEEN 1 AND 4) JOIN ""accounts"" AS ""ac"" ON ""ac"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
594,"WITH ""t"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" USING (""id"")) SELECT ""t"".""id"",""t"".""name"" FROM (((""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""id""=""t"".""id"" AND ""t2"".""login_date"" - ""t"".""login_date""=1) JOIN ""t"" AS ""t3"" ON ""t3"".""id""=""t"".""id"" AND ""t3"".""login_date"" - ""t"".""login_date""=2) JOIN ""t"" AS ""t4"" ON ""t4"".""id""=""t"".""id"" AND ""t4"".""login_date"" - ""t"".""login_date""=3) JOIN ""t"" AS ""t5"" ON ""t5"".""id""=""t"".""id"" AND ""t5"".""login_date"" - ""t"".""login_date""=4 GROUP BY ""t"".""id"",""t"".""name"" ORDER BY ""t"".""id"""
595,"SELECT DISTINCT ""id"",""name"" FROM (SELECT ""l1"".""id"",""l2"".""login_date"" - ""l1"".""login_date"" AS ""diff"" FROM ""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" USING (""id"") WHERE ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""diff"")>=4) AS ""a"" JOIN ""Accounts"" USING (""id"") ORDER BY ""id"""
596,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
597,"SELECT DISTINCT ""acc"".""id"",""acc"".""name"" FROM (SELECT ""id"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""5_day"",""login_date"",(CASE WHEN LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date""=4 THEN 1 ELSE 0 END) AS ""flag"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""logins"") AS ""A"") AS ""B"" JOIN ""accounts"" AS ""acc"" ON ""B"".""id""=""acc"".""id"" WHERE ""flag""=1 ORDER BY ""id"""
598,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""a"".""id"""
599,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
600,"WITH ""sub"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""leading_date"" FROM ""logins"" GROUP BY 1,2) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN ""sub"" ON ""sub"".""id""=""a"".""id"" AND ""sub"".""leading_date"" - ""login_date""=4 ORDER BY 1"
601,"SELECT DISTINCT ""t1"".""id"",""name"" FROM ((((""Logins"" AS ""t1"" CROSS JOIN ""Logins"" AS ""t2"") CROSS JOIN ""Logins"" AS ""t3"") CROSS JOIN ""Logins"" AS ""t4"") CROSS JOIN ""Logins"" AS ""t5"") JOIN ""Accounts"" ON ""t1"".""id""=""t2"".""id"" AND ""t3"".""id""=""t2"".""id"" AND ""t3"".""id""=""t4"".""id"" AND ""t4"".""id""=""t5"".""id"" AND ""t1"".""login_date"" + INTERVAL '1 DAY'=""t2"".""login_date"" AND ""t2"".""login_date"" + INTERVAL '1 DAY'=""t3"".""login_date"" AND ""t3"".""login_date"" + INTERVAL '1 DAY'=""t4"".""login_date"" AND ""t4"".""login_date"" + INTERVAL '1 DAY'=""t5"".""login_date"" AND ""t1"".""id""=""Accounts"".""id"" ORDER BY ""t1"".""id"""
602,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
603,"SELECT DISTINCT (""l1"".""id""),""a"".""name"" FROM (""logins"" AS ""l1"" LEFT JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 0 AND 4) JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5 ORDER BY ""l1"".""id"""
604,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
605,"SELECT DISTINCT ""L"".""id"",""Accounts"".""name"" FROM ((((""Logins"" AS ""L"" JOIN ""Logins"" AS ""L1"" ON ""L1"".""login_date"" + INTERVAL '1 DAY'=""L"".""login_date"" AND ""L"".""id""=""L1"".""id"") JOIN ""Logins"" AS ""L2"" ON ""L2"".""login_date"" + INTERVAL '2 DAY'=""L"".""login_date"" AND ""L"".""id""=""L2"".""id"") JOIN ""Logins"" AS ""L3"" ON ""L3"".""login_date"" + INTERVAL '3 DAY'=""L"".""login_date"" AND ""L"".""id""=""L3"".""id"") JOIN ""Logins"" AS ""L4"" ON ""L4"".""login_date"" + INTERVAL '4 DAY'=""L"".""login_date"" AND ""L"".""id""=""L4"".""id"") JOIN ""Accounts"" ON ""Accounts"".""id""=""L"".""id"" ORDER BY ""L"".""id"""
606,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
607,"WITH ""ids"" AS (SELECT DISTINCT ""l"".""id"",""name"",""login_date"" FROM ""logins"" AS ""l"" JOIN ""accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" ORDER BY ""id"",""login_date"") SELECT DISTINCT (""id""),""name"" FROM (SELECT DISTINCT ""id"",""name"",""login_date"",""login_date"" - INTERVAL 'DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""datediff"" FROM ""ids"") AS ""sub"" GROUP BY ""datediff"",""id"" HAVING COUNT(""id"")>=5 ORDER BY ""id"""
608,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
609,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
610,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""cte1"" AS (SELECT ""id"",DAYOFYEAR(""login_date"") AS ""doy"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM ""cte""), ""cte2"" AS (SELECT ""id"",""doy""-""rn"" AS ""diff"" FROM ""cte1""), ""cte3"" AS (SELECT ""id"" FROM ""cte2"" GROUP BY ""id"",""diff"" HAVING COUNT(1)>=5) SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (""accounts"" AS ""a"") CROSS JOIN ""cte3"" AS ""c"" WHERE ""a"".""id""=""c"".""id"" ORDER BY ""id"""
611,"SELECT DISTINCT ""t1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""t1"".""id"") AS ""name"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date"" - ""t1"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT ""t2"".""login_date"")>=5"
612,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ((((""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" + INTERVAL '1 DAY'=""l2"".""login_date"") JOIN ""logins"" AS ""l3"" ON ""l2"".""id""=""l3"".""id"" AND ""l2"".""login_date"" + INTERVAL '1 DAY'=""l3"".""login_date"") JOIN ""logins"" AS ""l4"" ON ""l3"".""id""=""l4"".""id"" AND ""l3"".""login_date"" + INTERVAL '1 DAY'=""l4"".""login_date"") JOIN ""logins"" AS ""l5"" ON ""l4"".""id""=""l5"".""id"" AND ""l4"".""login_date"" + INTERVAL '1 DAY'=""l5"".""login_date"") JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" ORDER BY 1"
613,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
614,"WITH ""T1"" AS (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ranks"" FROM ""Logins""), ""T2"" AS (SELECT ""id"",""login_date"" - INTERVAL '""ranks"" DAY' AS ""diff"",COUNT(1) AS ""num"" FROM ""T1"" GROUP BY 1,2) SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""T2"" WHERE ""num"">4) ORDER BY ""id"""
615,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""Id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
616,"SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" JOIN (SELECT ""l1"".""id"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND 0<=""l1"".""login_date"" - ""l2"".""login_date"" AND ""l1"".""login_date"" - ""l2"".""login_date""<5 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l1"".""login_date"" - ""l2"".""login_date"")>=5) AS ""t"" ON ""a"".""id""=""t"".""id"" GROUP BY ""a"".""id"",""a"".""name"" ORDER BY ""a"".""id"""
617,"SELECT ""L1"".""ID"",""A"".""NAME"" FROM ((((""LOGINS"" AS ""L1"" JOIN ""LOGINS"" AS ""L2"" ON ""L1"".""ID""=""L2"".""ID"" AND ""L1"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L2"".""LOGIN_DATE"") JOIN ""LOGINS"" AS ""L3"" ON ""L2"".""ID""=""L3"".""ID"" AND ""L2"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L3"".""LOGIN_DATE"") JOIN ""LOGINS"" AS ""L4"" ON ""L3"".""ID""=""L4"".""ID"" AND ""L3"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L4"".""LOGIN_DATE"") JOIN ""LOGINS"" AS ""L5"" ON ""L4"".""ID""=""L5"".""ID"" AND ""L4"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L5"".""LOGIN_DATE"") LEFT JOIN ""ACCOUNTS"" AS ""A"" ON ""L1"".""ID""=""A"".""ID"" GROUP BY ""L1"".""ID"",""A"".""NAME"" ORDER BY ""ID"""
618,"SELECT DISTINCT ""a"".""id"",""acc"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" GROUP BY 1,""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
619,"SELECT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_day"" FROM (SELECT ""l"".""id"",""a"".""name"",""l"".""login_date"" FROM ""logins"" AS ""l"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l"".""id""=""a"".""id"" GROUP BY 1,2,3) AS ""x"") AS ""y"" WHERE ""lead_date""=""fifth_day"" GROUP BY 1,2"
620,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""cte1"" AS (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifthdate"" FROM ""cte"") SELECT DISTINCT ""t"".""id"",""a"".""name"" FROM ""cte1"" AS ""t"" JOIN ""accounts"" AS ""a"" USING (""id"") WHERE ""t"".""fifthdate"" - ""t"".""login_date""=4 ORDER BY 1"
621,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ""Logins"" AS ""l1"" LEFT JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" WHERE ""l1"".""login_date"" + INTERVAL '1 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l2"" WHERE ""l2"".""id""=""l1"".""id"") AND ""l1"".""login_date"" + INTERVAL '2 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l3"" WHERE ""l3"".""id""=""l1"".""id"") AND ""l1"".""login_date"" + INTERVAL '3 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l4"" WHERE ""l4"".""id""=""l1"".""id"") AND ""l1"".""login_date"" + INTERVAL '4 DAY' IN (SELECT ""login_date"" FROM ""Logins"" AS ""l5"" WHERE ""l5"".""id""=""l1"".""id"") ORDER BY 1"
622,"WITH ""t"" AS (SELECT *,(DAYOFYEAR(""Login_date"")-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"")) AS ""diff"" FROM ""Logins"") SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""t"" JOIN ""Accounts"" AS ""a"" ON ""t"".""id""=""a"".""id"" GROUP BY ""a"".""id"",""t"".""diff"" HAVING COUNT(DISTINCT ""t"".""login_date"")>=5"
623,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
624,"SELECT DISTINCT (""l1"".""id""),(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM (""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
625,"SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""login_date"",LAG(""login_date"", 1) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_date_lag1"",LAG(""login_date"", 2) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_date_lag2"",LAG(""login_date"", 3) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_date_lag3"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_date_lag4"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""sub1"") AS ""sub2"" WHERE ""login_date"" - ""login_date_lag1""=1 AND ""login_date"" - ""login_date_lag2""=2 AND ""login_date"" - ""login_date_lag3""=3 AND ""login_date"" - ""login_date_lag4""=4) ORDER BY 1"
626,"SELECT DISTINCT ""Accounts"".""id"",""Accounts"".""name"" FROM (SELECT ""b"".""id"",""b"".""login_date"" - INTERVAL '""b"".""ranks"" DAY' FROM (SELECT ""a"".""id"",""a"".""login_date"",ROW_NUMBER() OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""ranks"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""a"") AS ""b"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""b"".""login_date"")>=5) AS ""c"" JOIN ""Accounts"" ON ""c"".""id""=""Accounts"".""id"" ORDER BY 1"
627,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
628,"SELECT DISTINCT ""a"".""id"",""acc"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""a"".""id""=""acc"".""id"") JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
629,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
630,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
631,"WITH ""cte"" AS (SELECT DISTINCT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth"" FROM ""Logins"" GROUP BY ""id"",""login_date"" ORDER BY ""id"",""login_date"") SELECT DISTINCT ""cte"".""id"",""a"".""name"" FROM ""cte"" JOIN ""Accounts"" AS ""a"" ON ""cte"".""id""=""a"".""id"" WHERE ""lead_date""=""fifth"" ORDER BY ""id"""
632,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ((((""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date""=""l2"".""login_date"" - INTERVAL '1 DAY' AND ""l1"".""id""=""l2"".""id"") JOIN ""Logins"" AS ""l3"" ON ""l1"".""login_date""=""l3"".""login_date"" - INTERVAL '2 DAY' AND ""l1"".""id""=""l3"".""id"") JOIN ""Logins"" AS ""l4"" ON ""l1"".""login_date""=""l4"".""login_date"" - INTERVAL '3 DAY' AND ""l1"".""id""=""l4"".""id"") JOIN ""Logins"" AS ""l5"" ON ""l1"".""login_date""=""l5"".""login_date"" - INTERVAL '4 DAY' AND ""l1"".""id""=""l5"".""id"") JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" ORDER BY ""id"""
633,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
634,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
635,"WITH ""t"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""endday"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""t"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""Accounts"" AS ""a"" JOIN ""t"" ON ""t"".""id""=""a"".""id"" WHERE ""endday"" - ""login_date""=4 ORDER BY 1"
636,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4) JOIN ""Accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5"
637,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
638,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") - ""login_date"" AS ""diff"" FROM ""logins"" GROUP BY 1,2 ORDER BY ""id"") AS ""l"" ON ""a"".""id""=""l"".""id"" WHERE ""fifth"" IS NOT NULL AND ""diff""=4 ORDER BY 1"
639,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")>=4"
640,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
641,"SELECT DISTINCT ""id"",""name"" FROM (SELECT *,LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_4days"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""l"") AS ""t"" JOIN ""Accounts"" USING (""id"") WHERE ""next_4days"" - ""login_date""=4 ORDER BY 1"
642,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
643,"WITH ""T1"" AS (SELECT DISTINCT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""ranks"" FROM ""Logins""), ""T2"" AS (SELECT ""id"",""login_date"" - INTERVAL '""ranks"" DAY' AS ""diff"",COUNT(1) AS ""num"" FROM ""T1"" GROUP BY 1,2) SELECT ""id"",""name"" FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""T2"" WHERE ""num"">4) ORDER BY ""id"""
644,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""accounts"" AS ""a"" JOIN ""logins"" AS ""l"" ON ""l"".""id""=""a"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_active_days"" AS ""uad"") AS ""t"" WHERE ""login_date"" + INTERVAL ''4' DAY'=""fifth_date"""
645,"WITH ""S0"" AS (SELECT ""Logins"".""id"",""login_date"" AS ""day1"" FROM (((""Logins"" JOIN (SELECT ""id"",""login_date"" AS ""day2"" FROM ""Logins"") AS ""S2"" ON ""Logins"".""id""=""S2"".""id"" AND ""Logins"".""login_date"" + INTERVAL '1 DAY'=""day2"") JOIN (SELECT ""id"",""login_date"" AS ""day3"" FROM ""Logins"") AS ""S3"" ON ""Logins"".""id""=""S3"".""id"" AND ""Logins"".""login_date"" + INTERVAL '2 DAY'=""day3"") JOIN (SELECT ""id"",""login_date"" AS ""day4"" FROM ""Logins"") AS ""S4"" ON ""Logins"".""id""=""S4"".""id"" AND ""Logins"".""login_date"" + INTERVAL '3 DAY'=""day4"") JOIN (SELECT ""id"",""login_date"" AS ""day5"" FROM ""Logins"") AS ""S5"" ON ""Logins"".""id""=""S5"".""id"" AND ""Logins"".""login_date"" + INTERVAL '4 DAY'=""day5"") SELECT DISTINCT (""S0"".""id"") AS ""id"",""name"" FROM ""S0"" JOIN ""Accounts"" ON ""S0"".""id""=""Accounts"".""id"" ORDER BY ""id"""
646,"WITH ""temp0"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM ""Logins""), ""temp1"" AS (SELECT ""id"",""login_date"",""row_num"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""Groupings"" FROM ""temp0""), ""answer_table"" AS (SELECT ""id"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",""row_num"",""Groupings"",COUNT(""id""),MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
647,"WITH ""cte1"" AS (SELECT ""id"",""login_date"" FROM ""logins"" GROUP BY 1,2), ""cte2"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""myrank"" FROM ""cte1"") SELECT ""c1"".""id"",""name"" FROM (""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""id""=""c2"".""id"" AND ""c1"".""myrank""+4=""c2"".""myrank"" AND ""c1"".""login_date""=""c2"".""login_date"" - INTERVAL '4 DAY') JOIN ""accounts"" AS ""a"" ON ""c1"".""id""=""a"".""id"" GROUP BY 1,2 ORDER BY 1"
648,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
649,"WITH ""base"" AS (SELECT ""l1"".""id"" FROM (((""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date""=""l2"".""login_date"" - INTERVAL '1 DAY' AND ""l1"".""id""=""l2"".""id"") JOIN ""Logins"" AS ""l3"" ON ""l1"".""login_date""=""l3"".""login_date"" - INTERVAL '2 DAY' AND ""l1"".""id""=""l3"".""id"") JOIN ""Logins"" AS ""l4"" ON ""l1"".""login_date""=""l4"".""login_date"" - INTERVAL '3 DAY' AND ""l1"".""id""=""l4"".""id"") JOIN ""Logins"" AS ""l5"" ON ""l1"".""login_date""=""l5"".""login_date"" - INTERVAL '4 DAY' AND ""l1"".""id""=""l5"".""id"") SELECT DISTINCT ""b"".""id"",""name"" FROM ""base"" AS ""b"" LEFT JOIN ""Accounts"" AS ""a"" ON ""b"".""id""=""a"".""id"" ORDER BY 1"
650,"WITH ""cte"" AS (SELECT ""l1"".""id"" FROM ((((""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"") CROSS JOIN ""logins"" AS ""l3"") CROSS JOIN ""logins"" AS ""l4"") CROSS JOIN ""logins"" AS ""l5"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l2"".""id""=""l3"".""id"" AND ""l3"".""id""=""l4"".""id"" AND ""l4"".""id""=""l5"".""id"" AND ""l1"".""login_date""=""l2"".""login_date"" - INTERVAL '1 DAY' AND ""l2"".""login_date""=""l3"".""login_date"" - INTERVAL '1 DAY' AND ""l3"".""login_date""=""l4"".""login_date"" - INTERVAL '1 DAY' AND ""l4"".""login_date""=""l5"".""login_date"" - INTERVAL '1 DAY') SELECT DISTINCT ""c"".""id"",""name"" FROM ""cte"" AS ""c"" JOIN ""accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" ORDER BY 1"
651,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ((((""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" + INTERVAL '1 DAY'=""l2"".""login_date"") JOIN ""logins"" AS ""l3"" ON ""l2"".""id""=""l3"".""id"" AND ""l2"".""login_date"" + INTERVAL '1 DAY'=""l3"".""login_date"") JOIN ""logins"" AS ""l4"" ON ""l3"".""id""=""l4"".""id"" AND ""l3"".""login_date"" + INTERVAL '1 DAY'=""l4"".""login_date"") JOIN ""logins"" AS ""l5"" ON ""l4"".""id""=""l5"".""id"" AND ""l4"".""login_date"" + INTERVAL '1 DAY'=""l5"".""login_date"") JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" ORDER BY 1"
652,"WITH ""cte"" AS (SELECT ""id"",COUNT(1) FROM (SELECT DISTINCT * FROM ""logins"") AS ""a"" GROUP BY ""id"" HAVING COUNT(1)>=5), ""cte2"" AS (SELECT ""id"",""next_login"" - ""login_date"" AS ""diff"" FROM (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_login"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""a"") AS ""b"" WHERE ""next_login"" IS NOT NULL) SELECT DISTINCT ""accounts"".""id"",""accounts"".""name"" FROM (""cte2"" JOIN ""cte"" ON (""cte"".""id""=""cte2"".""id"")) JOIN ""accounts"" ON (""cte2"".""id""=""accounts"".""id"") WHERE ""diff""=4 ORDER BY ""id"""
653,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
654,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""Accounts"".""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
655,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
656,"WITH ""uniqueValueTable"" AS (SELECT ""id"",""login_date"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""uniqueValue"" FROM (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""Logins"" GROUP BY ""id"",""login_date"") AS ""rnkTable"") SELECT DISTINCT ""usersOver5"".""id"",""a"".""name"" FROM (SELECT ""id"",COUNT(1) FROM ""uniqueValueTable"" GROUP BY ""id"",""uniqueValue"" HAVING COUNT(1)>=5) AS ""usersOver5"" LEFT JOIN ""Accounts"" AS ""a"" ON ""usersOver5"".""id""=""a"".""id"" ORDER BY 1"
657,"SELECT ""a"".""id"",""a"".""name"" FROM ""accounts"" AS ""a"" JOIN (SELECT ""x1"".""id"" FROM ((((SELECT ""id"",""login_date"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""x1"" JOIN (SELECT ""id"",""login_date"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""x2"" ON ""x1"".""id""=""x2"".""id"" AND ""x1"".""login_date"" - ""x2"".""login_date""=1) JOIN (SELECT ""id"",""login_date"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""x3"" ON ""x2"".""id""=""x3"".""id"" AND ""x2"".""login_date"" - ""x3"".""login_date""=1) JOIN (SELECT ""id"",""login_date"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""x4"" ON ""x3"".""id""=""x4"".""id"" AND ""x3"".""login_date"" - ""x4"".""login_date""=1) JOIN (SELECT ""id"",""login_date"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""x5"" ON ""x4"".""id""=""x5"".""id"" AND ""x4"".""login_date"" - ""x5"".""login_date""=1 GROUP BY ""x1"".""id"") AS ""Y"" ON ""a"".""id""=""Y"".""id"" ORDER BY ""id"""
658,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rn"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""log"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT DISTINCT ""c1"".""id"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""id""=""c2"".""id"" AND ""c2"".""login_date"" - ""c1"".""login_date""=4 AND ""c2"".""rn""=""c1"".""rn""+4) ORDER BY ""id"""
659,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
660,"SELECT ""L1"".""ID"",""A"".""NAME"" FROM ((((""LOGINS"" AS ""L1"" JOIN ""LOGINS"" AS ""L2"" ON ""L1"".""ID""=""L2"".""ID"" AND ""L1"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L2"".""LOGIN_DATE"") JOIN ""LOGINS"" AS ""L3"" ON ""L2"".""ID""=""L3"".""ID"" AND ""L2"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L3"".""LOGIN_DATE"") JOIN ""LOGINS"" AS ""L4"" ON ""L3"".""ID""=""L4"".""ID"" AND ""L3"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L4"".""LOGIN_DATE"") JOIN ""LOGINS"" AS ""L5"" ON ""L4"".""ID""=""L5"".""ID"" AND ""L4"".""LOGIN_DATE"" + INTERVAL '1 DAY'=""L5"".""LOGIN_DATE"") LEFT JOIN ""ACCOUNTS"" AS ""A"" ON ""L1"".""ID""=""A"".""ID"" GROUP BY ""L1"".""ID"",""A"".""NAME"" ORDER BY ""ID"""
661,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
662,"WITH ""cte"" AS (SELECT ""id"",""login_date"" - INTERVAL '""rnk"" DAY' AS ""grouped_date"" FROM (SELECT DISTINCT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""rnk"" FROM ""logins"") AS ""t"") SELECT * FROM ""Accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte"" GROUP BY ""id"",""grouped_date"" HAVING COUNT(""id"")>=5) ORDER BY ""id"""
663,"WITH ""user_active_days"" AS (SELECT DISTINCT ""a"".""id"",""name"",""login_date"" FROM ""accounts"" AS ""a"" JOIN ""logins"" AS ""l"" ON ""l"".""id""=""a"".""id"") SELECT DISTINCT ""id"",""name"" FROM (SELECT ""id"",""name"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""fifth_date"" FROM ""user_active_days"" AS ""uad"") AS ""t"" WHERE ""login_date"" + INTERVAL ''4' DAY'=""fifth_date"""
664,"WITH ""temp0"" AS (SELECT ""id"",""login_date"" FROM ""Logins"" GROUP BY 1,2 ORDER BY 1,2), ""temp1"" AS (SELECT ""id"",""login_date"",LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lag_4"" FROM ""temp0"") SELECT ""a"".""id"",""b"".""name"" FROM ""temp1"" AS ""a"" LEFT JOIN ""Accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""a"".""login_date"" - ""a"".""lag_4""=4 GROUP BY 1,2"
665,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
666,"WITH ""t"" AS (SELECT ""id"",""login_date"",LAG(""login_date"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""prev_login_date"" FROM ""logins""), ""sess_starts"" AS (SELECT ""login_date"" AS ""sess_start"",""id"",LEAD(""login_date"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""next_sess_start"" FROM ""t"" WHERE ""prev_login_date"" IS NULL OR ""login_date"" - ""prev_login_date"">1), ""sess_start_ends"" AS (SELECT ""s"".""sess_start"",""s"".""id"",MAX(""l"".""login_date"") AS ""sess_end"",""s"".""next_sess_start"" FROM ""logins"" AS ""l"" JOIN ""sess_starts"" AS ""s"" ON ""s"".""id""=""l"".""id"" AND ""l"".""login_date"">=""s"".""sess_start"" AND (""s"".""next_sess_start"" IS NULL OR ""l"".""login_date""<""s"".""next_sess_start"") GROUP BY 1,2) SELECT DISTINCT ""s"".""id"",""a"".""name"" FROM ""sess_start_ends"" AS ""s"" JOIN ""accounts"" AS ""a"" ON ""a"".""id""=""s"".""id"" WHERE ""sess_end"" - ""sess_start"">=4 ORDER BY ""s"".""id"""
667,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM (SELECT ""l"".""id"" AS ""l_id"",""login_date"" - LAG(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""la"" FROM ""logins"" AS ""l"" GROUP BY ""id"",""login_date"") AS ""tmp"" JOIN ""accounts"" AS ""a"" ON ""tmp"".""l_id""=""a"".""id"" WHERE ""tmp"".""la""=4 ORDER BY ""a"".""id"""
668,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM ""Logins"" AS ""a"" LEFT JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
669,"SELECT DISTINCT ""a"".""id"",""c"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""c"" ON ""a"".""id""=""c"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY ""a"".""id"",""a"".""login_date"""
670,"WITH ""consecutive_login"" AS (SELECT ""id"",""login_date"",COUNT(""login_date"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"" RANGE BETWEEN CURRENT ROW AND INTERVAL 4 DAY FOLLOWING) AS ""consecutive_days"" FROM (SELECT DISTINCT * FROM ""Logins"") AS ""tmp"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""consecutive_login"" AS ""c"" LEFT JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""c"".""id"" WHERE ""consecutive_days"">=5"
671,"WITH ""temp"" AS (SELECT ""id"",""login_date"" AS ""l"",LEAD(""login_date"") OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""l1"",LEAD(""login_date"", 2) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""l2"",LEAD(""login_date"", 3) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""l3"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""l4"" FROM ""logins"" GROUP BY ""id"",""login_date"") SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""id"" FROM ""temp"" WHERE ""l1"" - ""l""=1 AND ""l2"" - ""l1""=1 AND ""l3"" - ""l2""=1 AND ""l4"" - ""l3""=1) ORDER BY ""id"""
672,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
673,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
674,"SELECT * FROM ""accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM ((((""logins"" AS ""l1"") CROSS JOIN ""logins"" AS ""l2"") CROSS JOIN ""logins"" AS ""l3"") CROSS JOIN ""logins"" AS ""l4"") CROSS JOIN ""logins"" AS ""l5"" WHERE (""l1"".""id""=""l2"".""id"" AND ""l2"".""id""=""l3"".""id"" AND ""l3"".""id""=""l4"".""id"" AND ""l4"".""id""=""l5"".""id"") AND ""l2"".""login_date"" - ""l1"".""login_date""=1 AND ""l3"".""login_date"" - ""l2"".""login_date""=1 AND ""l4"".""login_date"" - ""l3"".""login_date""=1 AND ""l5"".""login_date"" - ""l4"".""login_date""=1) ORDER BY ""id"""
675,"SELECT DISTINCT ""t1"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""t1"".""id"") AS ""name"" FROM ""Logins"" AS ""t1"" JOIN ""Logins"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t2"".""login_date"" - ""t1"".""login_date"" BETWEEN 0 AND 4 GROUP BY ""t1"".""id"",""t1"".""login_date"" HAVING COUNT(DISTINCT ""t2"".""login_date"")=5"
676,"SELECT DISTINCT ""l1"".""id"",(SELECT DISTINCT ""name"" FROM ""Accounts"" WHERE ""id""=""l1"".""id"") AS ""name"" FROM ""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 AND ""l1"".""id""=""l2"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
677,"WITH ""cte"" AS (SELECT DISTINCT * FROM ""logins""), ""temp"" AS (SELECT ""id"",""login_date"",LEAD(""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""lead_date"" FROM ""cte"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""temp"" AS ""a"" LEFT JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE TIMESTAMPDIFF(DAY, ""login_date"", ""lead_date"")=4"
678,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""a"".""id""=""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
679,"WITH ""t"" AS (SELECT ""a"".""id"",""a"".""name"",""l"".""login_date"" FROM ""Accounts"" AS ""a"" JOIN (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""l"" USING (""id"")) SELECT ""t"".""id"",""t"".""name"" FROM (((""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""id""=""t"".""id"" AND ""t2"".""login_date"" - ""t"".""login_date""=1) JOIN ""t"" AS ""t3"" ON ""t3"".""id""=""t"".""id"" AND ""t3"".""login_date"" - ""t"".""login_date""=2) JOIN ""t"" AS ""t4"" ON ""t4"".""id""=""t"".""id"" AND ""t4"".""login_date"" - ""t"".""login_date""=3) JOIN ""t"" AS ""t5"" ON ""t5"".""id""=""t"".""id"" AND ""t5"".""login_date"" - ""t"".""login_date""=4 GROUP BY ""t"".""id"",""t"".""name"" ORDER BY ""t"".""id"""
680,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM ((((""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" + INTERVAL '1 DAY'=""l2"".""login_date"") JOIN ""logins"" AS ""l3"" ON ""l2"".""id""=""l3"".""id"" AND ""l2"".""login_date"" + INTERVAL '1 DAY'=""l3"".""login_date"") JOIN ""logins"" AS ""l4"" ON ""l3"".""id""=""l4"".""id"" AND ""l3"".""login_date"" + INTERVAL '1 DAY'=""l4"".""login_date"") JOIN ""logins"" AS ""l5"" ON ""l4"".""id""=""l5"".""id"" AND ""l4"".""login_date"" + INTERVAL '1 DAY'=""l5"".""login_date"") JOIN ""accounts"" AS ""a"" ON ""l1"".""id""=""a"".""id"" ORDER BY 1"
681,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
682,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4"
683,"SELECT DISTINCT (""b"".""id"") AS ""id"",""b"".""name"" FROM (SELECT ""id"",COUNT(1) AS ""c"" FROM (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""r"" FROM (SELECT DISTINCT * FROM ""logins"") AS ""a"") AS ""a"" GROUP BY ""id"",""login_date"" + INTERVAL '-""r"" DAY') AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" WHERE ""c"">=5 ORDER BY ""b"".""id"""
684,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (((((""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"") CROSS JOIN ""Logins"" AS ""l3"") CROSS JOIN ""Logins"" AS ""l4"") CROSS JOIN ""Logins"" AS ""l5"") CROSS JOIN ""accounts"" AS ""a"" WHERE ""l1"".""id""=""l2"".""id"" AND ""l1"".""id""=""l3"".""id"" AND ""l1"".""id""=""l4"".""id"" AND ""l1"".""id""=""l5"".""id"" AND ""l1"".""login_date"" - INTERVAL '1 DAY'=""l2"".""login_date"" AND ""l1"".""login_date"" - INTERVAL '2 DAY'=""l3"".""login_date"" AND ""l1"".""login_date"" - INTERVAL '3 DAY'=""l4"".""login_date"" AND ""l1"".""login_date"" - INTERVAL '4 DAY'=""l5"".""login_date"" AND ""l1"".""id""=""a"".""id"" ORDER BY ""id"""
685,"SELECT DISTINCT ""x"".""id"",(SELECT ""name"" FROM ""accounts"" WHERE ""id""=""x"".""id"") AS ""name"" FROM (""logins"" AS ""x"") CROSS JOIN ""logins"" AS ""y"" WHERE ""x"".""id""=""y"".""id"" AND ""x"".""login_date"" - ""y"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""x"".""id"",""x"".""login_date"" HAVING COUNT(DISTINCT ""y"".""login_date"")=4 ORDER BY ""x"".""id"""
686,"SELECT ""Z"".""id"",""Z"".""name"" FROM (SELECT DISTINCT ""A"".""id"" FROM (((""Logins"" AS ""A"" JOIN ""Logins"" AS ""B"" ON ""A"".""login_date""=""B"".""login_date"" + INTERVAL '1 DAY' AND ""A"".""id""=""B"".""id"") JOIN ""Logins"" AS ""C"" ON ""B"".""login_date""=""C"".""login_date"" + INTERVAL '1 DAY' AND ""B"".""id""=""C"".""id"") JOIN ""Logins"" AS ""D"" ON ""C"".""login_date""=""D"".""login_date"" + INTERVAL '1 DAY' AND ""C"".""id""=""D"".""id"") JOIN ""Logins"" AS ""E"" ON ""D"".""login_date""=""E"".""login_date"" + INTERVAL '1 DAY' AND ""D"".""id""=""E"".""id"") AS ""Y"" JOIN ""Accounts"" AS ""Z"" ON ""Y"".""id""=""Z"".""id"" ORDER BY ""Z"".""id"""
687,"SELECT DISTINCT ""a"".""id"",(SELECT ""name"" FROM ""Accounts"" WHERE ""id""=""a"".""id"") AS ""name"" FROM (""Logins"" AS ""a"") CROSS JOIN ""Logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")>=4"
688,"SELECT ""a"".""id"",""b"".""name"" FROM (SELECT DISTINCT ""a"".""id"" FROM (""logins"" AS ""a"") CROSS JOIN ""logins"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""login_date"" - ""b"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""a"".""id"",""a"".""login_Date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4) AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" ORDER BY 1"
689,"WITH ""cte"" AS (SELECT ""id"",""login_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"") AS ""t""), ""cte2"" AS (SELECT ""id"",COUNT(""start_dt"") OVER (PARTITION BY ""id"", ""start_dt"") AS ""cnt"" FROM (SELECT ""id"",""login_date"",""login_date"" + INTERVAL '-""row_num"" DAY' AS ""start_dt"" FROM ""cte"") AS ""t"") SELECT DISTINCT ""c"".""id"",""a"".""name"" FROM ""cte2"" AS ""c"" LEFT JOIN ""Accounts"" AS ""a"" ON ""c"".""id""=""a"".""id"" WHERE ""cnt"">=5 ORDER BY ""c"".""id"""
690,"SELECT DISTINCT ""a"".""id"",""acc"".""name"" FROM (""Logins"" AS ""a"" JOIN ""Logins"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""b"".""login_date"" - ""a"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""acc"" ON ""a"".""id""=""acc"".""id"" GROUP BY ""a"".""id"",""a"".""login_date"" HAVING COUNT(DISTINCT ""b"".""login_date"")=4 ORDER BY 1"
691,"WITH ""cte1"" AS (SELECT DISTINCT ""l"".""id"",""l"".""login_date"",""a"".""name"" FROM ""Logins"" AS ""l"" JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l"".""id""), ""cte2"" AS (SELECT ""l1"".""id"" AS ""id1"",""l1"".""name"" AS ""name1"",DATE(""l1"".""login_date"") AS ""c1"",""l2"".""login_date"" AS ""c2"",""l3"".""login_date"" AS ""c3"",""l4"".""login_date"" AS ""c4"",""l5"".""login_date"" AS ""c5"",""l2"".""name"" AS ""name2"",""l3"".""name"" AS ""name3"",""l4"".""name"" AS ""name4"",""l5"".""name"" AS ""name5"",""l2"".""id"" AS ""id2"",""l3"".""id"" AS ""id3"",""l4"".""id"" AS ""id4"",""l5"".""id"" AS ""id5"" FROM (((""cte1"" AS ""l1"" JOIN ""cte1"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND DATE(""l1"".""login_date"") + INTERVAL '1 DAY'=DATE(""l2"".""login_date"")) JOIN ""cte1"" AS ""l3"" ON ""l1"".""id""=""l3"".""id"" AND DATE(""l1"".""login_date"") + INTERVAL '2 DAY'=DATE(""l3"".""login_date"")) JOIN ""cte1"" AS ""l4"" ON ""l1"".""id""=""l4"".""id"" AND DATE(""l1"".""login_date"") + INTERVAL '3 DAY'=DATE(""l4"".""login_date"")) JOIN ""cte1"" AS ""l5"" ON ""l1"".""id""=""l5"".""id"" AND DATE(""l1"".""login_date"") + INTERVAL '4 DAY'=DATE(""l5"".""login_date"")) SELECT ""id1"" AS ""id"",""name1"" AS ""name"" FROM ""cte2"" UNION SELECT ""id2"" AS ""id"",""name2"" AS ""name"" FROM ""cte2"" UNION SELECT ""id3"" AS ""id"",""name3"" AS ""name"" FROM ""cte2"" UNION SELECT ""id4"" AS ""id"",""name4"" AS ""name"" FROM ""cte2"" UNION SELECT ""id5"" AS ""id"",""name5"" AS ""name"" FROM ""cte2"" ORDER BY ""id"""
692,"SELECT DISTINCT ""L1"".""id"",""A"".""name"" FROM ((""Logins"" AS ""L1"") CROSS JOIN ""Logins"" AS ""L2"") CROSS JOIN ""Accounts"" AS ""A"" WHERE ""L1"".""id""=""L2"".""id"" AND ""L1"".""id""=""A"".""id"" AND (""L1"".""login_date"" - ""L2"".""login_date"" BETWEEN 1 AND 4) GROUP BY ""L1"".""id"",""L1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")=4 ORDER BY ""L1"".""id"""
693,"SELECT DISTINCT ""a"".""id"",""a"".""name"" FROM ((""Logins"" AS ""l1"") CROSS JOIN ""Logins"" AS ""l2"") CROSS JOIN ""Accounts"" AS ""a"" WHERE ""a"".""id""=""l1"".""id"" AND ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4 GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
694,"WITH ""cte_logins"" AS (SELECT DISTINCT ""id"",""login_date"",""login_date"" + INTERVAL '4 DAY' AS ""fifth_date"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""login_date_rank"" FROM (SELECT DISTINCT ""id"",""login_date"" FROM ""Logins"" ORDER BY ""id"",""login_date"") AS ""d"") SELECT ""a"".""id"",""a"".""name"" FROM ""Accounts"" AS ""a"" WHERE ""id"" IN (SELECT DISTINCT ""p"".""id"" FROM ""cte_logins"" AS ""p"" JOIN ""cte_logins"" AS ""a"" ON ""p"".""id""=""a"".""id"" AND ""p"".""login_date""=""a"".""fifth_date"" AND ""p"".""login_date_rank""=""a"".""login_date_rank""+4) ORDER BY ""a"".""id"""
695,"SELECT DISTINCT ""L1"".""id"",MAX(""A"".""name"") AS ""name"" FROM (""Logins"" AS ""L1"" JOIN ""Logins"" AS ""L2"" ON ""L1"".""id""=""L2"".""id"" AND ""L2"".""login_date"" - ""L1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""A"".""id""=""L1"".""id"" GROUP BY ""L1"".""id"",""L1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")=4 ORDER BY 1"
696,"WITH ""uni"" AS (SELECT DISTINCT ""id"",""login_date"" FROM ""logins""), ""win"" AS (SELECT ""l"".""id"",""l"".""login_date"",SUM(CASE WHEN ""r"".""login_date"" IS NULL THEN 1 ELSE 0 END) OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""con_int"" FROM ""uni"" AS ""l"" LEFT JOIN ""uni"" AS ""r"" ON ""l"".""id""=""r"".""id"" AND ""l"".""login_date"" + INTERVAL '-1 DAY'=""r"".""login_date""), ""agg"" AS (SELECT ""id"",""con_int"",COUNT(DISTINCT ""login_date"") AS ""ct_days"" FROM ""win"" GROUP BY 1,2) SELECT ""ag"".""id"",""ac"".""name"" FROM ""agg"" AS ""ag"" JOIN ""accounts"" AS ""ac"" ON ""ag"".""id""=""ac"".""id"" GROUP BY 1,2 HAVING MAX(""ag"".""ct_days"")>=5 ORDER BY 1,2"
697,"SELECT DISTINCT ""x"".""id"",""x"".""name"" FROM (SELECT ""a"".""id"",""b"".""name"",""a"".""login_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""login_date"") AS ""fifth_date"",LEAD(""a"".""login_date"", 4) OVER (PARTITION BY ""id"" ORDER BY ""a"".""login_date"") - ""a"".""login_date""+1 AS ""diff"" FROM ""logins"" AS ""a"" JOIN ""accounts"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""id"",""b"".""name"",""a"".""login_date"") AS ""x"" WHERE ""x"".""diff""=5"
698,"WITH ""temp1"" AS (SELECT ""id"",""login_date"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") AS ""row_num"",""login_date"" + INTERVAL '-DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""login_date"") DAY' AS ""Groupings"" FROM ""Logins""), ""answer_table"" AS (SELECT ""id"",""Groupings"",MIN(""login_date"") AS ""startDate"",MAX(""login_date"") AS ""EndDate"",MAX(""login_date"") - MIN(""login_date"") AS ""duration"" FROM ""temp1"" GROUP BY ""id"",""Groupings"" HAVING MAX(""login_date"") - MIN(""login_date"")>=4 ORDER BY ""id"",""StartDate"") SELECT DISTINCT ""a"".""id"",""name"" FROM ""answer_table"" AS ""a"" JOIN ""Accounts"" AS ""acc"" ON ""acc"".""id""=""a"".""id"" ORDER BY ""a"".""id"""
699,"SELECT DISTINCT ""l1"".""id"",""a"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l1"".""login_date"" - ""l2"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""a"" ON ""a"".""id""=""l1"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=4"
700,"SELECT DISTINCT ""L1"".""id"",MAX(""A"".""name"") AS ""name"" FROM (""Logins"" AS ""L1"" JOIN ""Logins"" AS ""L2"" ON ""L1"".""id""=""L2"".""id"" AND ""L2"".""login_date"" - ""L1"".""login_date"" BETWEEN 1 AND 4) JOIN ""Accounts"" AS ""A"" ON ""A"".""id""=""L1"".""id"" GROUP BY ""L1"".""id"",""L1"".""login_date"" HAVING COUNT(DISTINCT ""L2"".""login_date"")=4 ORDER BY 1"
701,"SELECT DISTINCT ""l1"".""id"",""A"".""name"" FROM (""Logins"" AS ""l1"" JOIN ""Logins"" AS ""l2"" ON ""l1"".""id""=""l2"".""id"" AND ""l2"".""login_date"" - ""l1"".""login_date"" BETWEEN 0 AND 4) JOIN ""Accounts"" AS ""A"" ON ""l1"".""id""=""A"".""id"" GROUP BY ""l1"".""id"",""l1"".""login_date"" HAVING COUNT(DISTINCT ""l2"".""login_date"")=5"
702,"SELECT ""id"",""name"" FROM ""accounts"" WHERE ""id"" IN (SELECT ""l1"".""id"" FROM (((""logins"" AS ""l1"" JOIN ""logins"" AS ""l2"" ON ""l2"".""id""=""l1"".""id"" AND ""l2"".""login_date""=""l1"".""login_date"" - INTERVAL '1 DAY') JOIN ""logins"" AS ""l3"" ON ""l3"".""id""=""l2"".""id"" AND ""l3"".""login_date""=""l2"".""login_date"" - INTERVAL '1 DAY') JOIN ""logins"" AS ""l4"" ON ""l4"".""id""=""l3"".""id"" AND ""l4"".""login_date""=""l3"".""login_date"" - INTERVAL '1 DAY') JOIN ""logins"" AS ""l5"" ON ""l5"".""id""=""l4"".""id"" AND ""l5"".""login_date""=""l4"".""login_date"" - INTERVAL '1 DAY') ORDER BY ""id"""
