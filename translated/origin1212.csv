id,original query
1,"SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (WITH ""matches"" AS (SELECT ""match_id"",""host_team"",""guest_team"",""host_goals"",""guest_goals"",CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_scores"",CASE WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""guest_scores"" FROM ""matches"") SELECT ""host_team"" AS ""team_id"",SUM(""host_scores"") AS ""num_points"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_scores"") AS ""num_points"" FROM ""matches"" GROUP BY 1) AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
2,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM (SELECT SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"",""host_team"" AS ""team_id"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"",""guest_team"" AS ""team_id"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""a"" RIGHT JOIN ""Teams"" AS ""t"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
3,"SELECT ""b"".""team_id"" AS ""team_id"",""b"".""team_name"",SUM(COALESCE(""temp"".""score"", 0)) AS ""num_points"" FROM ((SELECT ""host_team"" AS ""team"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""guest_goals"">""host_goals"" THEN 0 ELSE 1 END) AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""guest_goals"">""host_goals"" THEN 3 ELSE 1 END) AS ""score"" FROM ""Matches"")) AS ""temp"" RIGHT JOIN ""Teams"" AS ""b"" ON ""temp"".""team""=""b"".""team_id"" GROUP BY ""temp"".""team"",""b"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
4,"WITH ""points"" AS (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""Points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Points"" ON ""Teams"".""team_id""=""Points"".""team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
5,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
6,"SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"") AS ""temp"" RIGHT JOIN ""teams"" ON ""temp"".""team_id""=""teams"".""team_id"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
7,"WITH ""CTE"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches""), ""CTE2"" AS (SELECT ""team_id"",SUM(""points"") AS ""win_lose_score"" FROM ""CTE"" GROUP BY ""team_id"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""c"".""win_lose_score"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""CTE2"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
8,"WITH ""t"" AS ((SELECT ""h"".""match_id"",""h"".""host_team"" AS ""team"",CASE WHEN ""h"".""host_goals"">""h"".""guest_goals"" THEN 3 WHEN ""h"".""host_goals""=""h"".""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""h"") UNION (SELECT ""g"".""match_id"",""g"".""guest_team"" AS ""team"",CASE WHEN ""g"".""guest_goals"">""g"".""host_goals"" THEN 3 WHEN ""g"".""guest_goals""=""g"".""host_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""g"")) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""z"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""t"".""team"",SUM(""score"") AS ""num_points"" FROM ""t"" GROUP BY ""t"".""team"") AS ""z"" ON ""t"".""team_id""=""z"".""team"" ORDER BY COALESCE(""z"".""num_points"", 0) DESC,""t"".""team_id"""
9,"WITH ""T"" AS ((SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""Matches"")) SELECT ""Teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""T"" RIGHT JOIN ""Teams"" ON ""Teams"".""team_id""=""T"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
10,"WITH ""t1"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_pts"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_pts"" FROM ""matches"") SELECT ""tm"".""team_id"",""tm"".""team_name"",COALESCE(SUM(""t2"".""pts""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",SUM(""host_pts"") AS ""pts"" FROM ""t1"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_pts"") AS ""pts"" FROM ""t1"" GROUP BY ""guest_team"") AS ""t2"" RIGHT JOIN ""teams"" AS ""tm"" ON ""tm"".""team_id""=""t2"".""team_id"" GROUP BY ""tm"".""team_id"",""tm"".""team_name"" ORDER BY ""num_points"" DESC,""tm"".""team_id"""
11,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
12,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""matches"" ON ""teams"".""team_id""=""matches"".""host_team"" OR ""teams"".""team_id""=""matches"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
13,"SELECT ""t"".*,COALESCE(""x"".""num_points"", 0) AS ""num_points"" FROM (SELECT ""team_id"",SUM(""score"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") AS ""x"" GROUP BY ""team_id"") AS ""x"" RIGHT JOIN ""Teams"" AS ""t"" ON ""x"".""team_id""=""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
14,"SELECT ""t"".""team_id"",""t"".""team_name"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
15,"SELECT ""Teams"".""team_id"",""Teams"".""team_name"",SUM(CASE WHEN ""Teams"".""team_id""=""Matches"".""host_team"" AND ""Matches"".""host_goals"">""Matches"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""Teams"".""team_id""=""Matches"".""guest_team"" AND ""Matches"".""host_goals""<""Matches"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""Teams"".""team_id""=""Matches"".""host_team"" AND ""Matches"".""host_goals""=""Matches"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""Teams"".""team_id""=""Matches"".""guest_team"" AND ""Matches"".""host_goals""=""Matches"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""Teams"".""team_id""=""Matches"".""host_team"" OR ""Teams"".""team_id""=""Matches"".""guest_team"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
16,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
17,"WITH ""tbl"" AS (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""s_score"" FROM ""Matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""s_score"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""s_score""), 0) AS ""num_points"" FROM ""tbl"" RIGHT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""tbl"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,""t"".""team_id"""
18,"WITH ""total_matches"" AS (SELECT * FROM ""matches"" AS ""m"" UNION ALL SELECT ""match_id"",""guest_team"",""host_team"",""guest_goals"",""host_goals"" FROM ""matches"" AS ""m""), ""match_points"" AS (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""total_matches"" AS ""t"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""match_points"" AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
19,"WITH ""t"" AS (SELECT *,(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_scores"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) AS ""guest_scores"" FROM ""Matches"") SELECT DISTINCT ""Teams"".""team_id"",""Teams"".""team_name"",SUM(COALESCE(""t2"".""team_scores"", 0)) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",""host_scores"" AS ""team_scores"" FROM ""t"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_scores"" AS ""team_scores"" FROM ""t"") AS ""t2"" ON ""Teams"".""team_id""=""t2"".""team_id"" GROUP BY ""Teams"".""team_id"",""Teams"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
20,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
21,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
22,"WITH ""zte"" AS (SELECT ""host_team"",""guest_team"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_score"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""guest_score"" FROM ""Matches"") SELECT ""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT ""team"",SUM(""score"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team"",""host_score"" AS ""score"" FROM ""zte"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_score"" AS ""score"" FROM ""zte"") AS ""temp"" GROUP BY 1) AS ""temp1"" ON ""Teams"".""team_id""=""temp1"".""team"" ORDER BY 3 DESC,1"
23,"SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(""gueat_score"", 0)+COALESCE(""host_score"", 0) AS ""num_points"" FROM (""Teams"" AS ""a"" LEFT JOIN (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_score"" FROM ""Matches"" GROUP BY ""host_team"") AS ""b"" ON ""a"".""team_id""=""b"".""host_team"") LEFT JOIN (SELECT ""guest_team"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""gueat_score"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""c"" ON ""a"".""team_id""=""c"".""guest_team"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
24,"WITH ""cte"" AS (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches""), ""cte1"" AS (SELECT ""host_team"",SUM(""points"") AS ""points"" FROM ""cte"" GROUP BY ""host_team"") SELECT ""Teams"".""team_id"" AS ""team_id"",""team_name"",COALESCE(""points"", 0) AS ""num_points"" FROM ""cte1"" RIGHT JOIN ""Teams"" ON ""Teams"".""team_id""=""cte1"".""host_team"" ORDER BY ""num_points"" DESC,""Teams"".""team_id"""
25,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN '3' WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN '3' WHEN ""team_id""=""host_team"" AND ""guest_goals""=""host_goals"" THEN '1' WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN '1' END), 0) AS ""num_points"" FROM ""matches"" AS ""m"" RIGHT JOIN ""teams"" AS ""t"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY 1 ORDER BY ""num_points"" DESC,""team_id"""
26,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON (""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"") GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
27,"WITH ""T"" AS (SELECT * FROM ""Matches"" UNION SELECT ""match_id"",""guest_team"" AS ""host_team"",""host_team"" AS ""guest_team"",""guest_goals"" AS ""host_goals"",""host_goals"" AS ""guest_goals"" FROM ""Matches"") SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""T"" RIGHT JOIN ""Teams"" ON ""host_team""=""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
28,"WITH ""hosted"" AS (SELECT ""m"".""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" AS ""m"" GROUP BY ""m"".""host_team""), ""guest"" AS (SELECT ""m"".""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" AS ""m"" GROUP BY ""m"".""guest_team""), ""combined"" AS (SELECT ""h"".""team_id"",""h"".""points"" FROM ""hosted"" AS ""h"" UNION ALL SELECT ""g"".""team_id"",""g"".""points"" FROM ""guest"" AS ""g"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""combined"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
29,"WITH ""t1"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_points"" FROM ""matches""), ""t2"" AS ((SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""t1"") UNION ALL (SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""points"" FROM ""t1"")) SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""teams"" LEFT JOIN ""t2"" ON ""t2"".""team_id""=""teams"".""team_id"" GROUP BY ""teams"".""team_id"",""teams"".""team_name"" ORDER BY ""num_points"" DESC,""teams"".""team_id"""
30,"WITH ""cte1"" AS (SELECT SUM(CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END) AS ""points"",""host_team"" AS ""team_id"" FROM ""Matches"" GROUP BY ""host_team""), ""cte2"" AS (SELECT SUM(CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END) AS ""points"",""guest_team"" AS ""team_id"" FROM ""Matches"" GROUP BY ""guest_team""), ""cte3"" AS (SELECT * FROM ""cte1"" UNION ALL SELECT * FROM ""cte2"") SELECT ""Teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""cte3"" RIGHT JOIN ""Teams"" ON ""Teams"".""team_id""=""cte3"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""Teams"".""team_id"""
31,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
32,"WITH ""cte_flat"" AS (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""scores"" FROM ""Matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""scores"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""s"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""scores"") AS ""num_points"" FROM ""cte_flat"" GROUP BY ""team_id"") AS ""s"" ON ""s"".""team_id""=""t"".""team_id"" ORDER BY COALESCE(""s"".""num_points"", 0) DESC,""t"".""team_id"""
33,"SELECT ""T1"".""team_id"",""T1"".""team_name"",COALESCE(SUM(""T2"".""goals""), 0) AS ""num_points"" FROM ""Teams"" AS ""T1"" LEFT JOIN (SELECT ""host_team"" AS ""team"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""goals"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""goals"" FROM ""Matches"") AS ""T2"" ON ""T1"".""team_id""=""T2"".""team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""T1"".""team_id"""
34,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
35,"WITH ""t1"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches""), ""t2"" AS (SELECT ""t"".*,(SELECT SUM(""t1"".""host_points"") FROM ""t1"" AS ""t1"" WHERE ""t1"".""host_team""=""t"".""team_id"") AS ""points_as_host"",(SELECT SUM(""t1"".""guest_points"") FROM ""t1"" AS ""t1"" WHERE ""t1"".""guest_team""=""t"".""team_id"") AS ""points_as_guest"" FROM ""Teams"" AS ""t""), ""t3"" AS (SELECT ""team_id"",""team_name"",COALESCE((""points_as_host""+""points_as_guest""), 0) AS ""num_points"" FROM ""t2"" ORDER BY ""num_points"" DESC,""team_id""), ""t4"" AS (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""num_points"" FROM ""t1"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""num_points"" FROM ""t1""), ""t5"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""t4"" GROUP BY 1), ""t6"" AS (SELECT ""team_id"",""team_name"",COALESCE((SELECT ""num_points"" FROM ""t5"" AS ""t5"" WHERE ""t5"".""team_id""=""t"".""team_id""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" ORDER BY ""num_points"" DESC,""team_id"") SELECT * FROM ""t6"""
36,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""o"".""host_team""=""t"".""team_id"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""o"".""guest_team""=""t"".""team_id"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"" AS ""o"" RIGHT JOIN ""Teams"" AS ""t"" ON ""o"".""host_team""=""t"".""team_id"" OR ""o"".""guest_team""=""t"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
37,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""m"".""host_team""=""t"".""team_id"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""guest_team""=""t"".""team_id"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
38,"SELECT ""Teams"".""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") AS ""T"" ON ""T"".""team_id""=""Teams"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
39,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
40,"ERROR: mysql parse error: line 1 column 3 near ""sum(case when team_id=host_team and host_goals>guest_goals then 3 else 0 end)+ sum(case when team_id=guest_team and guest_goals>host_goals then 3 else 0 end)+ sum(case when team_id=host_team and host_goals=guest_goals then 1 else 0 end)+ sum(case when team_id=guest_team and guest_goals=host_goals then 1 else 0 end) as num_points from teams left join matches on team_id = host_team or team_id = guest_team group by team_id order by num_points desc, team_id asc "" "
41,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"",""team_name"" ORDER BY 3 DESC,1"
42,"SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""score"" FROM ""matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 0 END AS ""score"" FROM ""matches"") AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY ""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
43,"WITH ""t"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_num_points"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_num_points"" FROM ""Matches"") SELECT ""team_id"",""team_name"",SUM(""num_points"") AS ""num_points"" FROM (SELECT ""t0"".""team_id"",""t0"".""team_name"",COALESCE(SUM(""t"".""host_num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t0"" LEFT JOIN ""t"" ON ""team_id""=""t"".""host_team"" GROUP BY ""t0"".""team_id"",""t0"".""team_name"" UNION ALL SELECT ""t0"".""team_id"",""t0"".""team_name"",COALESCE(SUM(""t"".""guest_num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t0"" LEFT JOIN ""t"" ON ""team_id""=""t"".""guest_team"" GROUP BY ""t0"".""team_id"",""t0"".""team_name"") AS ""t1"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
44,"SELECT ""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""teams"" LEFT JOIN (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""num_points"" FROM (SELECT ""host_team"",""guest_team"",""host_goals"",""guest_goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"",""host_team"",""guest_goals"",""host_goals"" FROM ""matches"") AS ""t"" GROUP BY 1) AS ""s"" ON ""s"".""host_team""=""teams"".""team_id"" ORDER BY 3 DESC,1"
45,"WITH ""t1"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""t2"" AS (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""t3"" AS (SELECT ""team_id"",""points"" FROM ""t1"" UNION ALL SELECT ""team_id"",""points"" FROM ""t2"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""teams"" LEFT JOIN ""t3"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
46,"WITH ""table1"" AS (SELECT ""match_id"",""host_team"",""guest_team"",""host_goals"",""guest_goals"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches""), ""table2"" AS (SELECT ""host_team"",""host_points"" FROM ""table1"" UNION ALL SELECT ""guest_team"",""guest_points"" FROM ""table1"") SELECT ""t"".""team_id"",""t"".""team_name"",SUM(COALESCE(""host_points"", 0)) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""table2"" ON ""t"".""team_id""=""table2"".""host_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
47,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
48,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
49,"SELECT ""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""a"" RIGHT JOIN ""teams"" USING (""team_id"") GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
50,"WITH ""tmp"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 END AS ""num_points"" FROM ""Matches"") SELECT ""t2"".""team_id"",""t2"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t2"" LEFT JOIN ""tmp"" AS ""t1"" ON ""t1"".""team_id""=""t2"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
51,"WITH ""Match_Score"" AS (SELECT ""host_team"",""guest_team"",""host_goals"",""guest_goals"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""Matches""), ""Team_Score"" AS (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""team_score"" FROM ""Match_Score"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""team_score"" FROM ""Match_Score"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""ts"".""team_score""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""team_score"" AS ""ts"" ON ""t"".""team_id""=""ts"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY 3 DESC,""t"".""team_id"""
52,"SELECT ""b"".""team_id"",""b"".""team_name"",SUM(CASE WHEN ""b"".""team_id""=""a"".""host_team"" AND ""a"".""host_goals"">""a"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""b"".""team_id""=""a"".""guest_team"" AND ""a"".""host_goals""<""a"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""b"".""team_id""=""a"".""host_team"" AND ""a"".""host_goals""=""a"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""b"".""team_id""=""a"".""guest_team"" AND ""a"".""host_goals""=""a"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" AS ""a"" RIGHT JOIN ""Teams"" AS ""b"" ON ""a"".""host_team""=""b"".""team_id"" OR ""a"".""guest_team""=""b"".""team_id"" GROUP BY ""b"".""team_id"" ORDER BY ""num_points"" DESC,""b"".""team_id"""
53,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""a"".""goals""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""goals"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) AS ""goals"" FROM ""Matches"") AS ""a"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
54,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
55,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""u"".""host_goals"">""u"".""guest_goals"" THEN 3 WHEN ""u"".""host_goals""=""u"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""host_goals"",""guest_goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_goals"" AS ""host_goals"",""host_goals"" AS ""guest_goals"" FROM ""matches"") AS ""u"" RIGHT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
56,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""cte"" RIGHT JOIN ""teams"" ON ""teams"".""team_id""=""cte"".""team_id"" GROUP BY ""cte"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""teams"".""team_id"""
57,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""cte"" RIGHT JOIN ""teams"" ON ""teams"".""team_id""=""cte"".""team_id"" GROUP BY ""cte"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""teams"".""team_id"""
58,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
59,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
60,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
61,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""num_points"" FROM ""Matches"") AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
62,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals"">""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals""=""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"" AS ""t"") CROSS JOIN ""Matches"" AS ""m"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
63,"WITH ""host"" AS (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""pos"" FROM ""matches"" GROUP BY 1), ""guest"" AS (SELECT ""guest_team"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""pos"" FROM ""matches"" GROUP BY 1) SELECT ""t"".""team_id"",""t"".""team_name"",CASE WHEN ""h"".""pos"" IS NULL AND ""g"".""pos"" IS NULL THEN 0 WHEN ""h"".""pos"" IS NULL AND ""g"".""pos"">=0 THEN ""g"".""pos"" WHEN ""g"".""pos"" IS NULL AND ""h"".""pos"">=0 THEN ""h"".""pos"" ELSE ""h"".""pos""+""g"".""pos"" END AS ""num_points"" FROM (""teams"" AS ""t"" LEFT JOIN ""host"" AS ""h"" ON ""t"".""team_id""=""h"".""host_team"") LEFT JOIN ""guest"" AS ""g"" ON ""t"".""team_id""=""g"".""guest_team"" ORDER BY 3 DESC,1"
64,"SELECT ""TMP"".""TEAM_ID"",""TMP"".""TEAM_NAME"",SUM(""TMP"".""POINTS"") AS ""NUM_POINTS"" FROM (SELECT ""T"".""TEAM_ID"" AS ""TEAM_ID"",""T"".""TEAM_NAME"" AS ""TEAM_NAME"",CASE WHEN (""M"".""HOST_GOALS"">""M"".""GUEST_GOALS"" AND ""T"".""TEAM_ID""=""M"".""HOST_TEAM"") OR (""M"".""HOST_GOALS""<""M"".""GUEST_GOALS"" AND ""T"".""TEAM_ID""=""M"".""GUEST_TEAM"") THEN 3 WHEN (""M"".""HOST_GOALS""=""M"".""GUEST_GOALS"" AND ""T"".""TEAM_ID""=""M"".""HOST_TEAM"") OR (""M"".""HOST_GOALS""=""M"".""GUEST_GOALS"" AND ""T"".""TEAM_ID""=""M"".""GUEST_TEAM"") THEN 1 ELSE 0 END AS ""POINTS"" FROM (""TEAMS"" AS ""T"") CROSS JOIN ""MATCHES"" AS ""M"") AS ""TMP"" GROUP BY ""TMP"".""TEAM_ID"",""TMP"".""TEAM_NAME"" ORDER BY 3 DESC,1"
65,"WITH ""cte"" AS (SELECT ""match_id"",""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""Matches"") SELECT ""y"".""team_id"",""y"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team"",""host_score"" AS ""score"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_score"" AS ""score"" FROM ""cte"") AS ""x"" RIGHT JOIN ""Teams"" AS ""y"" ON ""x"".""team""=""y"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
66,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""M"".""host_team"" AND ""M"".""host_goals"">""M"".""guest_goals"") THEN 3 WHEN (""t"".""team_id""=""M"".""host_team"" AND ""M"".""host_goals""=""M"".""guest_goals"") THEN 1 WHEN (""t"".""team_id""=""M"".""guest_team"" AND ""M"".""guest_goals"">""M"".""host_goals"") THEN 3 WHEN (""t"".""team_id""=""M"".""guest_team"" AND ""M"".""host_goals""=""M"".""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""M"" ON (""t"".""team_id""=""M"".""host_team"") OR (""t"".""team_id""=""M"".""guest_team"") GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""Num_points"" DESC,""t"".""team_id"""
67,"WITH ""team_matches"" AS (SELECT ""match_id"",""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_score"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 END AS ""guest_score"" FROM ""Matches"") SELECT ""T"".""team_id"",""T"".""team_name"",COALESCE(SUM(""TBL"".""team_score""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team_id"",SUM(""host_score"") AS ""team_score"" FROM ""team_matches"" GROUP BY 1 UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",SUM(""guest_score"") AS ""team_score"" FROM ""team_matches"" GROUP BY 1) AS ""TBL"" RIGHT JOIN ""Teams"" AS ""T"" ON ""TBL"".""team_id""=""T"".""team_id"" GROUP BY 1,2 ORDER BY COALESCE(SUM(""team_score""), 0) DESC,""team_id"""
68,"WITH ""host_team_score"" AS (SELECT ""Teams"".""team_id"",""Teams"".""team_name"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 END AS ""num_points"" FROM ""Matches"" RIGHT JOIN ""Teams"" ON ""Matches"".""host_team""=""Teams"".""team_id""), ""guest_team_score"" AS (SELECT ""Teams"".""team_id"",""Teams"".""team_name"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 WHEN ""guest_goals""=""host_goals"" THEN 1 END AS ""num_points"" FROM ""Matches"" RIGHT JOIN ""Teams"" ON ""Matches"".""guest_team""=""Teams"".""team_id""), ""combined"" AS (SELECT * FROM ""host_team_score"" UNION ALL SELECT * FROM ""guest_team_score"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""combined"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
69,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
70,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
71,"WITH ""scores"" AS (SELECT *,(CASE WHEN ""host_goals""<""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) AS ""host_score"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""guest_score"" FROM ""Matches""), ""team_wise"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""host_score"") AS ""agg"" FROM ""scores"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_score"") AS ""agg"" FROM ""scores"" GROUP BY ""guest_team""), ""tot_score"" AS (SELECT ""team_id"",SUM(""agg"") AS ""total_score"" FROM ""team_wise"" GROUP BY ""team_id"") SELECT ""team_id"",""team_name"",COALESCE(""total_score"", 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""tot_score"" USING (""team_id"") ORDER BY ""num_points"" DESC,""team_id"""
72,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""point"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""point"" FROM ""matches"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""point""), 0) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""team_id""=""b"".""team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
73,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
74,"SELECT ""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""a"" RIGHT JOIN ""teams"" USING (""team_id"") GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
75,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
76,"WITH ""tmp"" AS (SELECT * FROM ""matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""host_team"",""host_team"" AS ""guest_team"",""guest_goals"" AS ""host_goals"",""host_goals"" AS ""guest_goals"" FROM ""matches"") SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END), 0) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN ""tmp"" AS ""b"" ON ""a"".""team_id""=""b"".""host_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
77,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 WHEN ""team_id""=""guest_team"" AND ""guest_goals""<""host_goals"" THEN 0 WHEN ""guest_goals""=""host_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
78,"WITH ""cte"" AS ((SELECT ""tab1"".""team_id"",""tab1"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE NULL END) AS ""score"" FROM ""Teams"" AS ""tab1"" LEFT JOIN ""Matches"" AS ""tab2"" ON ""tab1"".""team_id""=""tab2"".""host_team"" GROUP BY ""team_id"",""team_name"") UNION ALL (SELECT ""tab1"".""team_id"",""tab1"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE NULL END) AS ""score"" FROM ""Teams"" AS ""tab1"" LEFT JOIN ""Matches"" AS ""tab2"" ON ""tab1"".""team_id""=""tab2"".""guest_team"" GROUP BY ""team_id"",""team_name"")) SELECT ""team_id"",""team_name"",""num_points"" FROM (SELECT ""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""cte"" GROUP BY ""team_name"") AS ""tmp"" ORDER BY ""num_points"" DESC,""team_id"""
79,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
80,"WITH ""points"" AS (SELECT ""match_id"",""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_team_points"",""guest_team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_team_points"" FROM ""Matches""), ""total"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""host_team_points"") AS ""num_points"" FROM ((SELECT ""host_team"",""host_team_points"" FROM ""points"") UNION ALL (SELECT ""guest_team"",""guest_team_points"" FROM ""points"")) AS ""a"" GROUP BY 1) SELECT ""t1"".""team_id"",""t1"".""team_name"",COALESCE(""t2"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t1"" LEFT JOIN ""total"" AS ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"" ORDER BY 3 DESC,1"
81,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""points"" FROM ""Matches"") AS ""temp"" ON ""t"".""team_id""=""temp"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,1"
82,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""point""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""point"" FROM ""Matches"" AS ""m1"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""point"" FROM ""Matches"" AS ""m2"") AS ""tb"" ON ""t"".""team_id""=""tb"".""team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
83,"SELECT ""M1"".""team_id"",""M1"".""team_name"",SUM(""M1"".""Num_points"") AS ""num_points"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",(CASE WHEN ""t"".""team_id""=""M"".""host_team"" AND ""M"".""host_goals"">""M"".""guest_goals"" THEN 3 ELSE 0 END)+(CASE WHEN ""t"".""team_id""=""M"".""host_team"" AND ""M"".""host_goals""=""M"".""guest_goals"" THEN 1 ELSE 0 END)+(CASE WHEN ""t"".""team_id""=""M"".""guest_team"" AND ""M"".""host_goals""<""M"".""guest_goals"" THEN 3 ELSE 0 END)+(CASE WHEN ""t"".""team_id""=""M"".""guest_team"" AND ""M"".""host_goals""=""M"".""guest_goals"" THEN 1 ELSE 0 END) AS ""Num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""M"" ON (""t"".""team_id""=""M"".""host_team"") OR (""t"".""team_id""=""M"".""guest_team"")) AS ""M1"" GROUP BY ""M1"".""team_id"",""M1"".""team_name"" ORDER BY ""Num_points"" DESC,""team_id"""
84,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
85,"WITH ""cte"" AS (SELECT *,CASE WHEN ""host_status""='win' THEN 3 WHEN ""host_status""='lose' THEN 0 ELSE 1 END AS ""host_score"",CASE WHEN ""host_status""='win' THEN 0 WHEN ""host_status""='lose' THEN 3 ELSE 1 END AS ""guest_score"" FROM (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 'win' WHEN ""host_goals""=""guest_goals"" THEN 'tie' ELSE 'lose' END AS ""host_status"" FROM ""Matches"") AS ""t"") SELECT ""T"".""team_id"",""T"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""num_points"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""num_points"" FROM ""cte"") AS ""S"" ON ""T"".""team_id""=""S"".""Team_id"" GROUP BY 1 ORDER BY ""num_points"" DESC,1"
86,"WITH ""cte"" AS (SELECT *,CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END AS ""point_host"",CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END AS ""point_guest"" FROM ""matches"") SELECT ""b"".""team_id"",""b"".""team_name"",CASE WHEN ""a"".""points"" IS NULL THEN 0 ELSE SUM(""a"".""points"") END AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""point_host"" AS ""points"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""point_guest"" AS ""points"" FROM ""cte"") AS ""a"" RIGHT JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_id"" ORDER BY ""num_points"" DESC,""b"".""team_id"""
87,"WITH ""table1"" AS (SELECT *,(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_points"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""guest_points"" FROM ""MATCHES""), ""table2"" AS (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""num_points"" FROM ""table1"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""num_points"" FROM ""table1"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""table2"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
88,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" CROSS JOIN ""Matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
89,"SELECT ""Teams"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT ""team_id"",SUM(""points"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") AS ""t3"" GROUP BY ""team_id"") AS ""t4"" ON ""t4"".""team_id""=""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
90,"SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"" AS ""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""guest_goals""<""m"".""host_goals"" THEN 3 WHEN ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""guest_team"" OR ""t"".""team_id""=""m"".""host_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
91,"WITH ""host_points"" AS (SELECT ""match_id"",""host_team"" AS ""team"",CASE WHEN (""host_goals"">""guest_goals"") THEN 3 WHEN (""host_goals""<""guest_goals"") THEN 0 ELSE 1 END AS ""points"" FROM ""matches""), ""guest_points"" AS (SELECT ""match_id"",""guest_team"" AS ""team"",CASE WHEN (""host_goals"">""guest_goals"") THEN 0 WHEN (""host_goals""<""guest_goals"") THEN 3 ELSE 1 END AS ""points"" FROM ""matches""), ""combined"" AS (SELECT ""team"" AS ""team_id"",SUM(""points"") AS ""num_points"" FROM (SELECT * FROM ""host_points"" UNION ALL SELECT * FROM ""guest_points"") AS ""joint"" GROUP BY ""team"") SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(""combined"".""num_points"", 0) AS ""num_points"" FROM ""combined"" RIGHT JOIN ""teams"" ON ""combined"".""team_id""=""teams"".""team_id"" ORDER BY ""num_points"" DESC,""teams"".""team_id"""
92,"SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(CASE WHEN ""a"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""a"".""team_id""=""m"".""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""Matches"" AS ""m"" ON ""a"".""team_id""=""m"".""host_team"" OR ""a"".""team_id""=""m"".""guest_team"" GROUP BY ""a"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
93,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""wls"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""points"") AS ""wls"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") AS ""f"" GROUP BY 1) AS ""k"" ON ""t"".""team_id""=""k"".""team_id"" ORDER BY 3 DESC,""t"".""team_id"""
94,"SELECT ""t"".""team_id"" AS ""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"") AS ""m"" RIGHT JOIN ""teams"" AS ""t"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
95,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
96,"SELECT ""a"".""team_id"",""a"".""team_name"",SUM(CASE WHEN ""a"".""team_id""=""b"".""host_team"" AND ""b"".""host_goals"">""b"".""guest_goals"" THEN 3 WHEN ""a"".""team_id""=""b"".""guest_team"" AND ""b"".""guest_goals"">""b"".""host_goals"" THEN 3 WHEN ((""a"".""team_id""=""b"".""host_team"" OR ""a"".""team_id""=""b"".""guest_team"") AND (""b"".""guest_goals""=""b"".""host_goals"")) THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""a"" CROSS JOIN ""Matches"" AS ""b"" GROUP BY ""a"".""team_id"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
97,"WITH ""scores"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""r"".""team_id"",""r"".""team_name"",COALESCE(SUM(""s"".""num_points""), 0) AS ""num_points"" FROM ""scores"" AS ""s"" RIGHT JOIN ""teams"" AS ""r"" ON ""s"".""team_id""=""r"".""team_id"" GROUP BY ""r"".""team_id"",""r"".""team_name"" ORDER BY COALESCE(SUM(""s"".""num_points""), 0) DESC,""r"".""team_id"""
98,"WITH ""team_points"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_points"" FROM ""Matches"") SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(SUM(""tpoints"".""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""teams"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""team_points"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""points"" FROM ""team_points"") AS ""tpoints"" ON ""teams"".""team_id""=""tpoints"".""team_id"" GROUP BY ""teams"".""team_id"",""teams"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
99,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""num_points"" FROM ""matches"") AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""c"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
100,"WITH ""cte"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_score"" FROM ""matches""), ""cte2"" AS (SELECT * FROM (""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"",SUM(""host_score"") AS ""tot1"" FROM ""cte"" GROUP BY 1) AS ""t1"" ON ""t"".""team_id""=""t1"".""host_team"") LEFT JOIN (SELECT ""guest_team"",SUM(""guest_score"") AS ""tot2"" FROM ""cte"" GROUP BY 1) AS ""t2"" ON ""t"".""team_id""=""t2"".""guest_team"") SELECT ""team_id"",""team_name"",COALESCE(""tot1"", 0)+COALESCE(""tot2"", 0) AS ""num_points"" FROM ""cte2"" ORDER BY 3 DESC,1"
101,"SELECT ""t0"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t0"" LEFT JOIN (SELECT ""team"",SUM(""points"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""Matches"") AS ""t"" GROUP BY ""team"") AS ""t1"" ON ""t0"".""team_id""=""t1"".""team"" ORDER BY ""num_points"" DESC,""team_id"""
102,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
103,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
104,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""Matches"" AS ""b"" ON ""a"".""team_id""=""b"".""host_team"" OR ""a"".""team_id""=""b"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
105,"WITH ""CTE"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches""), ""CTE1"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""CTE"" GROUP BY ""team_id"") SELECT ""T"".""team_id"",""T"".""team_name"",COALESCE(""C"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN ""CTE1"" AS ""C"" ON ""T"".""team_id""=""C"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
106,"WITH ""hp"" AS (SELECT ""h"".""match_id"",""h"".""host_team"",CASE WHEN ""h"".""host_goals"">""h"".""guest_goals"" THEN 3 WHEN ""h"".""host_goals""=""h"".""guest_goals"" THEN 1 WHEN ""h"".""host_goals""<""h"".""guest_goals"" THEN 0 END AS ""host_points"" FROM ""matches"" AS ""h""), ""gp"" AS (SELECT ""g"".""match_id"",""g"".""guest_team"",CASE WHEN ""g"".""host_goals"">""g"".""guest_goals"" THEN 0 WHEN ""g"".""host_goals""=""g"".""guest_goals"" THEN 1 WHEN ""g"".""host_goals""<""g"".""guest_goals"" THEN 3 END AS ""guest_points"" FROM ""matches"" AS ""g""), ""hgp"" AS (SELECT ""hp"".""match_id"",""hp"".""host_team"" AS ""team_id"",""host_points"" AS ""num_points"" FROM ""hp"" UNION SELECT ""gp"".""match_id"",""gp"".""guest_team"" AS ""team_id"",""guest_points"" AS ""num_points"" FROM ""gp"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""hgp"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""hgp"" ON ""hgp"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
107,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 0 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 0 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 END), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
108,"WITH ""res"" AS (SELECT CASE WHEN ""host_goals"">""guest_goals"" THEN ""host_team"" WHEN ""host_goals""<""guest_goals"" THEN ""guest_team"" END AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" OR ""host_goals""<""guest_goals"" THEN 3 END) AS ""num_points"" FROM ""matches"" WHERE ""host_goals""!=""guest_goals"" GROUP BY 1 UNION ALL SELECT ""host_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals"" UNION ALL SELECT ""guest_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals""), ""res_new"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""res"" GROUP BY 1) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""r"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""res_new"" AS ""r"" ON ""r"".""team_id""=""t"".""team_id"" ORDER BY 3 DESC,1"
109,"WITH ""points"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""guest_points"" FROM ""matches"") SELECT ""b"".""team_id"",""b"".""team_name"",COALESCE(SUM(""a"".""num_points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",SUM(""host_points"") AS ""num_points"" FROM ""points"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_points"") AS ""num_points"" FROM ""points"" GROUP BY ""guest_team"") AS ""a"" RIGHT JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_id"" ORDER BY ""num_points"" DESC,""b"".""team_id"""
110,"WITH ""tbl"" AS (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""s_score"" FROM ""Matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""s_score"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""s_score""), 0) AS ""num_points"" FROM ""tbl"" RIGHT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""tbl"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,""t"".""team_id"""
111,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
112,"WITH ""TEMP"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_points"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""guest_points"" FROM ""Matches""), ""TEMP2"" AS (SELECT DISTINCT ""host_team"" AS ""team_id"",SUM(""host_points"") AS ""points"" FROM ""TEMP"" GROUP BY 1 UNION ALL SELECT DISTINCT ""guest_team"" AS ""team_id"",SUM(""guest_points"") AS ""points"" FROM ""TEMP"" GROUP BY 1) SELECT DISTINCT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(""TEMP2"".""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""TEMP2"" ON ""a"".""team_id""=""TEMP2"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
113,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""tmp"".""team_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""team_points"" FROM ""matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""team_points"" FROM ""matches"")) AS ""tmp"" ON ""t"".""team_id""=""tmp"".""team"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
114,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
115,"WITH ""cte"" AS (SELECT CASE WHEN ""a"".""host_goals"">""b"".""guest_goals"" THEN ""a"".""host_team"" ELSE NULL END AS ""team"",'3' AS ""points"" FROM ""matches"" AS ""a"" JOIN ""matches"" AS ""b"" ON ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""<""b"".""guest_goals"" THEN ""a"".""GUEST_TEAM"" ELSE NULL END AS ""team"",'3' AS ""points"" FROM ""matches"" AS ""a"" JOIN ""matches"" AS ""b"" ON ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""=""b"".""guest_goals"" THEN ""a"".""HOST_TEAM"" ELSE NULL END AS ""team"",'1' AS ""points"" FROM ""matches"" AS ""a"" JOIN ""matches"" AS ""b"" ON ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""=""b"".""guest_goals"" THEN ""a"".""GUEST_TEAM"" ELSE NULL END AS ""team"",'1' AS ""points"" FROM ""matches"" AS ""a"" JOIN ""matches"" AS ""b"" ON ""a"".""match_id""=""b"".""match_id"") SELECT ""t"".""team_id"",""t"".""team_name"",CAST(COALESCE(SUM(""points""), 0) AS DECIMAL(10)) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
116,"WITH ""team_points"" AS (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY 1) SELECT ""Teams"".""team_id"",""Teams"".""team_name"",SUM(COALESCE(""points"", 0)) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""team_points"" AS ""p"" ON ""Teams"".""team_id""=""p"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""team_id"""
117,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals"">""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals""=""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"" AS ""t"") CROSS JOIN ""Matches"" AS ""m"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
118,"SELECT ""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""a"" RIGHT JOIN ""teams"" USING (""team_id"") GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
119,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
120,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
121,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"" AS ""m"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""host_team"" OR ""t"".""team_id""=""guest_team"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""team_id"""
122,"WITH ""points1"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches""), ""points"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""points1"" GROUP BY ""team_id"") SELECT ""Teams"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""points"" ON ""Teams"".""team_id""=""points"".""team_id"" ORDER BY COALESCE(""num_points"", 0) DESC,""Teams"".""team_id"""
123,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
124,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals"">""guest_goals"" THEN 0 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
125,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""host_team"" OR ""t"".""team_id""=""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
126,"SELECT ""Teams"".""team_id"" AS ""team_id"",""Teams"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""score"" FROM ""Matches"")) AS ""Team_Score"" ON ""Teams"".""team_id""=""Team_Score"".""team"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
127,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
128,"WITH ""res"" AS (SELECT CASE WHEN ""host_goals"">""guest_goals"" THEN ""host_team"" WHEN ""host_goals""<""guest_goals"" THEN ""guest_team"" END AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" OR ""host_goals""<""guest_goals"" THEN 3 END) AS ""num_points"" FROM ""matches"" WHERE ""host_goals""!=""guest_goals"" GROUP BY 1 UNION ALL SELECT ""host_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals"" UNION ALL SELECT ""guest_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals""), ""res_new"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""res"" GROUP BY 1) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""r"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""res_new"" AS ""r"" ON ""r"".""team_id""=""t"".""team_id"" ORDER BY 3 DESC,1"
129,"WITH ""cte1"" AS (SELECT ""match_id"",""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_score"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""guest_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""host_score"") AS ""num_points"" FROM ""cte1"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_score"") AS ""num_points"" FROM ""cte1"" GROUP BY ""guest_team""), ""cte3"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""cte2"" GROUP BY ""team_id"") SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(""b"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""cte3"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
130,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",SUM(COALESCE(""num_points"", 0)) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
131,"SELECT ""a"".""team_id"",""a"".""team_name"",SUM(""a"".""score"") AS ""num_points"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",""m"".""match_id"",""m"".""host_team"",""m"".""guest_team"",""m"".""host_goals"",""m"".""guest_goals"",CASE WHEN ""m"".""match_id"" IS NOT NULL AND ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""match_id"" IS NOT NULL AND ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""m"".""match_id"" IS NOT NULL AND (""t"".""team_id""=""m"".""host_team"" OR ""T"".""team_id""=""m"".""guest_team"") AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" ORDER BY ""t"".""team_id"") AS ""a"" GROUP BY ""a"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
132,"WITH ""res"" AS (SELECT CASE WHEN ""host_goals"">""guest_goals"" THEN ""host_team"" WHEN ""host_goals""<""guest_goals"" THEN ""guest_team"" END AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" OR ""host_goals""<""guest_goals"" THEN 3 END) AS ""num_points"" FROM ""matches"" WHERE ""host_goals""!=""guest_goals"" GROUP BY 1 UNION ALL SELECT ""host_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals"" UNION ALL SELECT ""guest_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals""), ""res_new"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""res"" GROUP BY 1) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""r"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""res_new"" AS ""r"" ON ""r"".""team_id""=""t"".""team_id"" ORDER BY 3 DESC,1"
133,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals"">""guest_goals"" THEN 0 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END) AS ""num_points"" FROM ""matches"" AS ""m"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
134,"SELECT ""team_id"",""team_name"",CASE WHEN ""num_points"" IS NULL THEN 0 ELSE ""num_points"" END AS ""num_points"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",SUM(""num_points"") AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 ELSE 1 END AS ""num_points"" FROM ""Matches"") AS ""a"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""a"".""team_id"",""t"".""team_name"") AS ""b"" ORDER BY ""num_points"" DESC,""team_id"""
135,"SELECT DISTINCT ""a"".""team_id"",""a"".""team_name"",SUM(CASE WHEN ""a"".""team_id""=""b"".""host_team"" AND ""b"".""host_goals"">""b"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""a"".""team_id""=""b"".""guest_team"" AND ""b"".""guest_goals"">""b"".""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""a"".""team_id""=""b"".""host_team"" AND ""b"".""host_goals""=""b"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""team_id""=""b"".""guest_team"" AND ""b"".""guest_goals""=""b"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""a"" CROSS JOIN ""matches"" AS ""b"" GROUP BY ""a"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
136,"WITH ""a"" AS (SELECT ""match_id"",""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""scores"" FROM ""matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""scores"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""a"".""scores""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""a"" ON ""t"".""team_id""=""a"".""team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
137,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
138,"WITH ""temp"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""temp"" RIGHT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY 1,2 ORDER BY 3 DESC,1"
139,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""m"".""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team"",SUM(""host_points"") AS ""points"" FROM (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches"") AS ""M1"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team"",SUM(""guest_points"") AS ""points"" FROM (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches"") AS ""M2"" GROUP BY ""guest_team"") AS ""m"" ON ""m"".""team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
140,"WITH ""tmp"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"") SELECT ""ina"".""team_id"",""ina"".""team_name"",COALESCE(SUM(""inb"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""ina"" LEFT JOIN ""tmp"" AS ""inb"" ON ""ina"".""team_id""=""inb"".""team_id"" GROUP BY ""ina"".""team_id"",""ina"".""team_name"" ORDER BY ""num_points"" DESC,""ina"".""team_id"""
141,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
142,"SELECT ""a"".""team_id"",""team_name"",COALESCE(SUM(""tot_scores""), 0) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END) AS ""tot_scores"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 0 END) AS ""tot_scores"" FROM ""matches"" GROUP BY 1) AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
143,"WITH ""temp"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""goals"" FROM ""matches"") SELECT ""teams"".""team_id"",""team_name"",COALESCE(SUM(""goals""), 0) AS ""num_points"" FROM ""teams"" LEFT JOIN ""temp"" ON ""temp"".""team_id""=""teams"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
144,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""m"".""host_team""=""t"".""team_id"" THEN CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END WHEN ""m"".""guest_team""=""t"".""team_id"" THEN CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
145,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
146,"WITH ""team_points"" AS ((SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"")) SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"" AS ""team_name"",COALESCE(""sub1"".""points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""points"") AS ""points"" FROM ""team_points"" GROUP BY 1) AS ""sub1"" ON ""t"".""team_id""=""sub1"".""team_id"" ORDER BY 3 DESC,1"
147,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
148,"WITH ""score_tb"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""Matches""), ""union_tb"" AS (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""num_points"" FROM ""score_tb"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""num_points"" FROM ""score_tb"") SELECT ""Teams"".""team_id"",""Teams"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""union_tb"" RIGHT JOIN ""Teams"" ON ""union_tb"".""team_id""=""Teams"".""team_id"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
149,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
150,"WITH ""pts"" AS ((SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_score"" FROM ""Matches"")) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""p"".""host_score""), 0) AS ""num_points"" FROM ""pts"" AS ""p"" RIGHT JOIN ""Teams"" AS ""t"" ON ""p"".""host_team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
151,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
152,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
153,"SELECT ""b"".""team_id"",""b"".""team_name"",SUM(COALESCE(""a"".""score"", 0)) AS ""num_points"" FROM ((SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""score"" FROM ""Matches"" GROUP BY 1) UNION ALL (SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 ELSE 1 END) AS ""score"" FROM ""Matches"" GROUP BY 1)) AS ""a"" RIGHT JOIN ""Teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""b"".""team_id"""
154,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
155,"SELECT DISTINCT ""a"".""team_id"",""a"".""team_name"",SUM(CASE WHEN ""a"".""team_id""=""b"".""host_team"" AND ""b"".""host_goals"">""b"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""a"".""team_id""=""b"".""guest_team"" AND ""b"".""guest_goals"">""b"".""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""a"".""team_id""=""b"".""host_team"" AND ""b"".""host_goals""=""b"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""team_id""=""b"".""guest_team"" AND ""b"".""guest_goals""=""b"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM (""teams"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" GROUP BY ""a"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
156,"WITH ""cte"" AS (SELECT CASE WHEN ""a"".""host_goals"">""b"".""guest_goals"" THEN ""a"".""host_team"" ELSE NULL END AS ""team"",'3' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""<""b"".""guest_goals"" THEN ""a"".""GUEST_TEAM"" ELSE NULL END AS ""team"",'3' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""=""b"".""guest_goals"" THEN ""a"".""HOST_TEAM"" ELSE NULL END AS ""team"",'1' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""=""b"".""guest_goals"" THEN ""a"".""GUEST_TEAM"" ELSE NULL END AS ""team"",'1' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"") SELECT ""t"".""team_id"",""t"".""team_name"",CAST(COALESCE(SUM(""points""), 0) AS DECIMAL(10)) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
157,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""team_id""=""host_team"" THEN 3 WHEN ""host_goals"">""guest_goals"" AND ""team_id""=""guest_team"" THEN 0 WHEN ""host_goals""<""guest_goals"" AND ""team_id""=""host_team"" THEN 0 WHEN ""host_goals""<""guest_goals"" AND ""team_id""=""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" AND ""team_id""=""guest_team"" THEN 1 WHEN ""host_goals""=""guest_goals"" AND ""team_id""=""host_team"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
158,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""h"".""host_points"", 0)+COALESCE(""g"".""guest_points"", 0) AS ""num_points"" FROM (""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""host_points"" FROM ""Matches"" GROUP BY 1) AS ""h"" ON ""t"".""team_id""=""h"".""host_team"") LEFT JOIN (SELECT ""guest_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END) AS ""guest_points"" FROM ""Matches"" GROUP BY 1) AS ""g"" ON ""t"".""team_id""=""g"".""guest_team"" ORDER BY ""num_points"" DESC,""team_id"""
159,"SELECT ""team_id"",""team_name"",COALESCE(SUM(""num""), 0) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN (SELECT ""host_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 0 WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END AS ""num"" FROM ""matches"" UNION ALL SELECT ""guest_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 END AS ""num"" FROM ""matches"") AS ""b"" ON ""a"".""team_id""=""b"".""host_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
160,"WITH ""t1"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""Teams"".""team_id"",""team_name"",SUM(COALESCE(""points"", 0)) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""t1"" ON ""Teams"".""team_id""=""t1"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
161,"WITH ""t"" AS ((SELECT ""h"".""match_id"",""h"".""host_team"" AS ""team"",CASE WHEN ""h"".""host_goals"">""h"".""guest_goals"" THEN 3 WHEN ""h"".""host_goals""=""h"".""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""h"") UNION (SELECT ""g"".""match_id"",""g"".""guest_team"" AS ""team"",CASE WHEN ""g"".""guest_goals"">""g"".""host_goals"" THEN 3 WHEN ""g"".""guest_goals""=""g"".""host_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""g"")), ""cte"" AS (SELECT ""t"".""team"",SUM(""score"") AS ""num_points"" FROM ""t"" GROUP BY ""t"".""team"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""z"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""z"" ON ""t"".""team_id""=""z"".""team"" ORDER BY COALESCE(""z"".""num_points"", 0) DESC,""t"".""team_id"""
162,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals"">""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals""=""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"" AS ""t"") CROSS JOIN ""Matches"" AS ""m"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
163,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""m"".""host_goals""<""m"".""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
164,"SELECT ""Teams"".""team_id"" AS ""team_id"",""Teams"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""score"" FROM ""Matches"")) AS ""Team_Score"" ON ""Teams"".""team_id""=""Team_Score"".""team"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
165,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""tmp"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""team_id"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 ELSE 1 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""team_id"") AS ""tmp"" ON ""t"".""team_id""=""tmp"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
166,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""t"".""team_id"" IN (""m"".""guest_team"",""m"".""host_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY 1 ORDER BY 3 DESC,1"
167,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(COALESCE(""num_points"", 0)) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 END AS ""num_points"" FROM ""matches"") AS ""e"" ON ""t"".""team_id""=""e"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
168,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
169,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""cte2"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"") AS ""cte"" GROUP BY ""team_id"") AS ""cte2"" ON ""t"".""team_id""=""cte2"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
170,"SELECT ""t"".""team_id"",""team_name"",COALESCE(""win_lose_score"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""points"") AS ""win_lose_score"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""f"" GROUP BY 1) AS ""f"" ON ""t"".""team_id""=""f"".""team_id"" ORDER BY 3 DESC,1"
171,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(COALESCE(""score"", 0)) AS ""num_points"" FROM (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" UNION ALL SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"") AS ""a"" RIGHT JOIN ""teams"" AS ""t"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
172,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
173,"WITH ""cte"" AS (SELECT ""match_id"",""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""matches""), ""demo"" AS (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""points"" FROM ""cte"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""demo"" AS ""d"" ON ""d"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
174,"SELECT ""d"".""team_id"" AS ""team_id"",""d"".""team_name"",COALESCE(SUM(""point""), 0) AS ""num_points"" FROM ""teams"" AS ""d"" LEFT JOIN (SELECT ""guest_team"" AS ""team"",""guest_point"" AS ""point"" FROM (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_point"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_point"" FROM ""matches"" GROUP BY 1,2) AS ""a"" UNION ALL SELECT ""host_team"" AS ""team"",""host_point"" AS ""point"" FROM (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_point"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_point"" FROM ""matches"" GROUP BY 1,2) AS ""b"") AS ""c"" ON ""c"".""team""=""d"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
175,"SELECT ""b"".""team_id"",""b"".""team_name"",COALESCE(SUM(""a"".""points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"") AS ""a"" RIGHT JOIN ""Teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_id"" ORDER BY ""num_points"" DESC,""b"".""team_id"""
176,"WITH ""temp"" AS (SELECT ""host_team"" AS ""team_id"",COALESCE(SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END), 0) AS ""points"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""team_id"",COALESCE(SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END), 0) AS ""points"" FROM ""matches"" GROUP BY 1) SELECT ""teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""teams"" LEFT JOIN ""temp"" ON ""teams"".""team_id""=""temp"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,1"
177,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""Matches"" AS ""m"" RIGHT JOIN ""Teams"" AS ""t"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
178,"WITH ""match_points"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""guest_points"" FROM ""Matches""), ""POINTS_TABLE"" AS (SELECT ""host_team"",SUM(""host_points"") AS ""host_points"" FROM ""MATCH_POINTS"" GROUP BY 1 UNION ALL SELECT ""guest_team"",SUM(""guest_points"") AS ""guest_points"" FROM ""MATCH_POINTS"" GROUP BY 1) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""pt"".""host_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"",SUM(""host_points"") AS ""host_points"" FROM ""POINTS_TABLE"" GROUP BY 1) AS ""pt"" ON ""pt"".""host_team""=""t"".""team_id"" GROUP BY 1 ORDER BY ""num_points"" DESC,""team_id"""
179,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
180,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""a"".*,COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""team_id"" ORDER BY 3 DESC,1"
181,"WITH ""all_team"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""a"".""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""all_team"" AS ""a"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
182,"WITH ""joined_cte"" AS (SELECT ""b"".""team_name"" AS ""host_team_name"",""c"".""team_name"" AS ""guest_team_name"",""b"".""team_id"" AS ""host_team"",""c"".""team_id"" AS ""guest_team"",""a"".""host_goals"",""a"".""guest_goals"" FROM (""matches"" AS ""a"" LEFT JOIN ""teams"" AS ""b"" ON ""a"".""host_team""=""b"".""team_id"") LEFT JOIN ""teams"" AS ""c"" ON ""a"".""guest_team""=""c"".""team_id"") SELECT ""a"".""team_id"",""a"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN (SELECT ""host_team"",""host_team_name"",""host_goals"",""guest_goals"" FROM ""joined_cte"" UNION ALL SELECT ""guest_team"",""guest_team_name"",""guest_goals"",""host_goals"" FROM ""joined_cte"") AS ""b"" ON ""a"".""team_id""=""b"".""host_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
183,"WITH ""team_points"" AS ((SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"")) SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"" AS ""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""team_points"" ON ""t"".""team_id""=""team_points"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
184,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""point"" FROM ""matches"" UNION ALL SELECT ""guest_team"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""point""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
185,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id"" IN (""host_team"",""guest_team"") GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY 3 DESC,1"
186,"WITH ""temp2"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 'home' WHEN ""host_goals""=""guest_goals"" THEN 'tie' WHEN ""host_goals""<""guest_goals"" THEN 'away' END AS ""match_result"" FROM ""Matches""), ""temp3"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""host_team"" AS ""team"",SUM(CASE WHEN ""match_result""='home' THEN 3 WHEN ""match_result""='tie' THEN 1 ELSE 0 END) AS ""points"" FROM ""temp2"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""team"",SUM(CASE WHEN ""match_result""='away' THEN 3 WHEN ""match_result""='tie' THEN 1 ELSE 0 END) AS ""points"" FROM ""temp2"" GROUP BY 1) AS ""g"" GROUP BY 1) SELECT ""Teams"".""team_id"" AS ""team_id"",""team_name"",COALESCE(""points"", 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""temp3"" ON ""Teams"".""team_id""=""temp3"".""team"" ORDER BY 3 DESC,1"
187,"WITH ""cte"" AS (SELECT ""t"".""team_id"",""t"".""team_name"",CASE WHEN ""m"".""host_Goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_Goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""num"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""host_team"" UNION ALL SELECT ""t"".""team_id"",""t"".""team_name"",CASE WHEN ""m2"".""host_Goals""=""m2"".""guest_goals"" THEN 1 WHEN ""m2"".""host_Goals""<""m2"".""guest_goals"" THEN 3 ELSE 0 END AS ""num"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""M2"" ON ""T"".""team_id""=""M2"".""guest_team"") SELECT ""team_id"",""team_name"",SUM(""num"") AS ""num_points"" FROM ""cte"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
188,"WITH ""cte"" AS ((SELECT ""tab1"".""team_id"",""tab1"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE NULL END) AS ""score"" FROM ""Teams"" AS ""tab1"" LEFT JOIN ""Matches"" AS ""tab2"" ON ""tab1"".""team_id""=""tab2"".""host_team"" GROUP BY ""team_id"",""team_name"") UNION ALL (SELECT ""tab1"".""team_id"",""tab1"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE NULL END) AS ""score"" FROM ""Teams"" AS ""tab1"" LEFT JOIN ""Matches"" AS ""tab2"" ON ""tab1"".""team_id""=""tab2"".""guest_team"" GROUP BY ""team_id"",""team_name"")) SELECT ""team_id"",""team_name"",""num_points"" FROM (SELECT ""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""cte"" GROUP BY ""team_name"") AS ""tmp"" ORDER BY ""num_points"" DESC,""team_id"""
189,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
190,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ((SELECT ""team_id"",SUM(CASE WHEN ""Matches"".""host_goals"">""Matches"".""guest_goals"" THEN 3 WHEN ""Matches"".""host_goals""=""Matches"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"") CROSS JOIN ""Matches"" WHERE ""Teams"".""team_id""=""Matches"".""host_team"" GROUP BY ""Teams"".""team_id"",""Teams"".""team_name"") UNION ALL (SELECT ""team_id"",SUM(CASE WHEN ""Matches"".""guest_goals"">""Matches"".""host_goals"" THEN 3 WHEN ""Matches"".""guest_goals""=""Matches"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"") CROSS JOIN ""Matches"" WHERE ""Teams"".""team_id""=""Matches"".""guest_team"" GROUP BY ""Teams"".""team_id"",""Teams"".""team_name"")) AS ""goals"" ON ""t"".""team_id""=""goals"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
191,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches""), ""cte2"" AS (SELECT ""team_id"",SUM(""points"") AS ""num_points"" FROM ""cte"" GROUP BY ""team_id"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""cte2"" USING (""team_id"") ORDER BY ""num_points"" DESC,""t"".""team_id"""
192,"WITH ""a"" AS (SELECT ""host_team"",""guest_team"",""host_rewards"",""guest_rewards"" FROM (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_rewards"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 END AS ""guest_rewards"" FROM ""matches"") AS ""t""), ""b"" AS (SELECT ""host_team"" AS ""team"",""host_rewards"" AS ""reward"" FROM ""a"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_rewards"" AS ""reward"" FROM ""a"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""reward""), 0) AS ""num_points"" FROM ""b"" RIGHT JOIN ""teams"" AS ""t"" ON ""b"".""team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
193,"SELECT ""t"".""team_id"",""t"".""team_name"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
194,"WITH ""with_diff"" AS (SELECT ""Matches"".*,""host_goals""-""guest_goals"" AS ""difference"" FROM ""Matches""), ""teams_diff"" AS (SELECT ""host_team"",""difference"" FROM ""with_diff"" UNION ALL SELECT ""guest_team"",0-""difference"" FROM ""with_diff""), ""add_additional"" AS (SELECT * FROM ""teams_diff"" UNION ALL (SELECT ""team_id"",-1 AS ""with_diff"" FROM ""Teams"" WHERE ""team_id"" NOT IN (SELECT ""host_team"" FROM ""teams_diff""))) SELECT ""d"".""host_team"" AS ""team_id"",""t"".""team_name"",SUM(CASE WHEN ""difference"">0 THEN 3 WHEN ""difference""<0 THEN 0 ELSE 1 END) AS ""num_points"" FROM ""Teams"" AS ""t"" JOIN ""add_additional"" AS ""d"" ON ""t"".""team_id""=""d"".""host_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
195,"SELECT ""t"".*,CASE WHEN ""m1"".""host_team"" IS NULL THEN 0 ELSE SUM(CASE WHEN ""team_id""!=(""m1"".""host_team"") THEN CASE WHEN ""m1"".""guest_goals"">""m1"".""host_goals"" THEN 3 WHEN ""m1"".""guest_goals""=""m1"".""host_goals"" THEN 1 ELSE 0 END ELSE CASE WHEN ""m1"".""guest_goals"">""m1"".""host_goals"" THEN 0 WHEN ""m1"".""guest_goals""=""m1"".""host_goals"" THEN 1 ELSE 3 END END) END AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m1"" ON ""t"".""team_id""=""m1"".""host_team"" OR ""t"".""team_id""=""m1"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
196,"WITH ""host_team_points"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches""), ""guest_team_points"" AS (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches""), ""all_matches_points"" AS (SELECT ""team_id"",""points"" FROM ""host_team_points"" UNION ALL SELECT ""team_id"",""points"" FROM ""guest_team_points"") SELECT ""temp"".""team_id"" AS ""team_id"",""temp"".""team_name"" AS ""team_name"",SUM(""temp"".""points"") AS ""num_points"" FROM (SELECT ""t"".""team_id"" AS ""team_id"",CASE WHEN ""ap"".""points"" IS NULL THEN 0 ELSE ""ap"".""points"" END AS ""points"",""t"".""team_name"" AS ""team_name"" FROM ""Teams"" AS ""t"" LEFT JOIN ""all_matches_points"" AS ""ap"" ON ""t"".""team_id""=""ap"".""team_id"") AS ""temp"" GROUP BY 1 ORDER BY 3 DESC,1"
197,"WITH ""s1"" AS (SELECT ""m1"".""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" AS ""m1"" GROUP BY ""m1"".""host_team""), ""s2"" AS (SELECT ""m2"".""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" AS ""m2"" GROUP BY ""m2"".""guest_team"") SELECT ""Teams"".""team_id"",""Teams"".""team_name"",COALESCE(SUM(""s3"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT * FROM ""s1"" UNION ALL SELECT * FROM ""s2"") AS ""s3"" ON ""Teams"".""team_id""=""s3"".""team_id"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
198,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
199,"SELECT DISTINCT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
200,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""teams"" LEFT JOIN (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""cte"" GROUP BY ""team_id"") AS ""c"" ON ""teams"".""team_id""=""c"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
201,"SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(""t"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""t"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY ""t"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
202,"WITH ""p_table"" AS (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""p"".""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""p_table"" AS ""p"" ON ""p"".""team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY COALESCE(SUM(""p"".""points""), 0) DESC,""t"".""team_id"""
203,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""goal_host"">""goal_guest"" THEN 3 WHEN ""goal_host""=""goal_guest"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT 'host' AS ""type"",""host_team"" AS ""team_id"",""host_goals"" AS ""goal_host"",""guest_goals"" AS ""goal_guest"" FROM ""matches"" UNION ALL SELECT 'guest' AS ""type"",""guest_team"" AS ""team_id"",""guest_goals"" AS ""goal_host"",""host_goals"" AS ""goal_guest"" FROM ""matches"") AS ""m"" ON ""t"".""team_id""=""m"".""team_id"" GROUP BY 1 ORDER BY ""num_points"" DESC,1"
204,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""temp"".""point"" IS NULL THEN 0 ELSE ""temp"".""point"" END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""point"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""point"" FROM ""Matches"")) AS ""temp"" ON ""t"".""team_id""=""temp"".""team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
205,"WITH ""s"" AS (SELECT ""host_team"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""host_score"" FROM ""Matches"" UNION ALL SELECT ""guest_team"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END) AS ""guest_score"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""host_score""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""s"" ON ""t"".""team_id""=""s"".""host_team"" GROUP BY 1 ORDER BY 3 DESC,1"
206,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""guest_points"" FROM ""Matches""), ""cte2"" AS (SELECT ""host_team"" AS ""team"",""host_points"" AS ""num_points"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_points"" AS ""num_points"" FROM ""cte"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""cte2"" RIGHT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""cte2"".""team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
207,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""host_team""), ""target"" AS (SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""guest_team""), ""common"" AS (SELECT * FROM ""cte"" UNION ALL SELECT * FROM ""target"") SELECT ""t"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""common"" GROUP BY ""team_id"") AS ""p"" ON (""t"".""team_id""=""p"".""team_id"") ORDER BY ""num_points"" DESC,""t"".""team_id"""
208,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""team_id""=""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""team_id""=""guest_team"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""Teams"" CROSS JOIN ""Matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
209,"SELECT ""T"".""team_id"",""T"".""team_name"",SUM(CASE WHEN ""host_team""=""team_id"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""guest_team""=""team_id"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""host_team"" OR ""T"".""team_id""=""M"".""guest_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
210,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""pts"" IS NULL THEN 0 ELSE ""pts"" END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""pts"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""pts"" FROM ""Matches"") AS ""all_matches"" ON ""t"".""team_id""=""all_matches"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
211,"WITH ""s"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""matches""), ""h"" AS (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""s""), ""g"" AS (SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""points"" FROM ""s""), ""u"" AS (SELECT * FROM ""h"" UNION ALL SELECT * FROM ""g""), ""j"" AS (SELECT ""team_id"",""team_name"",SUM(""points"") AS ""num_points"" FROM ""u"" JOIN ""teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY SUM(""points"") DESC) SELECT ""team_id"",""t"".""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""j"" USING (""team_id"") ORDER BY ""num_points"" DESC,""team_id"""
212,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
213,"SELECT ""t1"".""team_id"",""t1"".""team_name"",SUM(CASE WHEN ""t1"".""team_id""=""t2"".""host_team"" AND ""t2"".""host_goals"">""t2"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t1"".""team_id""=""t2"".""guest_team"" AND ""t2"".""host_goals""<""t2"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t1"".""team_id""=""t2"".""host_team"" AND ""t2"".""host_goals""=""t2"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""t1"".""team_id""=""t2"".""guest_team"" AND ""t2"".""host_goals""=""t2"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t1"" LEFT JOIN ""Matches"" AS ""t2"" ON ""t1"".""team_id""=""t2"".""host_team"" OR ""t1"".""team_id""=""t2"".""guest_team"" GROUP BY ""t1"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
214,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""total"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 0 END AS ""total"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""total""), 0) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
215,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
216,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
217,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
218,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
219,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
220,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""Teams"".""team_id""=""Matches"".""host_team"" OR ""Teams"".""team_id""=""Matches"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
221,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id"" IN (""host_team"",""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""guest_team"" OR ""t"".""team_id""=""m"".""host_team"" GROUP BY 1 ORDER BY ""num_points"" DESC,""team_id"""
222,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
223,"WITH ""a"" AS (SELECT ""host_team"",""guest_team"",""host_rewards"",""guest_rewards"" FROM (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_rewards"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 END AS ""guest_rewards"" FROM ""matches"") AS ""t""), ""b"" AS (SELECT ""host_team"" AS ""team"",""host_rewards"" AS ""reward"" FROM ""a"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_rewards"" AS ""reward"" FROM ""a"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""reward""), 0) AS ""num_points"" FROM ""b"" RIGHT JOIN ""teams"" AS ""t"" ON ""b"".""team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
224,"SELECT ""Agg_guest"".""team_id"",""Agg_guest"".""team_name"",(""Agg_guest"".""agg_guest_points""+""Agg_host"".""agg_host_points"") AS ""num_points"" FROM (SELECT ""Guest"".""team_id"",""Guest"".""team_name"",SUM(""Guest"".""guest_points"") AS ""agg_guest_points"" FROM (SELECT ""Teams"".""team_id"",""Teams"".""team_name"",CASE WHEN ""Matches"".""host_goals""<""Matches"".""guest_goals"" THEN 3 WHEN ""Matches"".""host_goals""=""Matches"".""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""Matches"".""guest_team""=""Teams"".""team_id"") AS ""Guest"" GROUP BY ""Guest"".""team_id"") AS ""Agg_guest"" JOIN (SELECT ""Host"".""team_id"",""Host"".""team_name"",SUM(""Host"".""host_points"") AS ""agg_host_points"" FROM (SELECT ""Teams"".""team_id"",""Teams"".""team_name"",CASE WHEN ""Matches"".""host_goals"">""Matches"".""guest_goals"" THEN 3 WHEN ""Matches"".""host_goals""=""Matches"".""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""Matches"".""host_team""=""Teams"".""team_id"") AS ""Host"" GROUP BY ""Host"".""team_id"") AS ""Agg_host"" ON ""Agg_guest"".""team_id""=""Agg_host"".""team_id"" ORDER BY ""num_points"" DESC,""Agg_guest"".""team_id"""
225,"SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(CASE WHEN ""a"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""a"".""team_id""=""m"".""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""Matches"" AS ""m"" ON ""a"".""team_id""=""m"".""host_team"" OR ""a"".""team_id""=""m"".""guest_team"" GROUP BY ""a"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""a"".""team_id"""
226,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 WHEN ""team_id""=""guest_team"" AND ""host_goals"">""guest_goals"" THEN 0 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
227,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
228,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id"" IN (""host_team"",""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
229,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
230,"SELECT DISTINCT ""t2"".""team_id"" AS ""team_id"",""t2"".""team_name"",COALESCE(SUM(""scores""), 0) AS ""num_points"" FROM ""TEAMS"" AS ""t2"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",""guest_team"" AS ""comp"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END) AS ""scores"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",""host_team"" AS ""comp"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 0 END) AS ""scores"" FROM ""Matches"")) AS ""t"" ON ""t"".""team""=""t2"".""team_id"" GROUP BY ""t2"".""team_id"" ORDER BY ""num_points"" DESC,""t2"".""team_id"""
231,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
232,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""scores"" IS NULL THEN 0 ELSE ""scores"" END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""scores"" FROM ""Matches"" AS ""m"") UNION ALL (SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""scores"" FROM ""Matches"" AS ""m"")) AS ""totalscore"" ON ""t"".""team_id""=""totalscore"".""team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
233,"WITH ""cte"" AS (SELECT ""match_id"",""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""c"".""team""=""t"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
234,"WITH ""a"" AS (SELECT ""host_team"" AS ""team_id"",""host_goals""-""guest_goals"" AS ""diff"" FROM ""matches"" UNION ALL SELECT ""guest_team"",-""host_goals""+""guest_goals"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""diff"">0 THEN 3 WHEN ""diff""=0 THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""a"" RIGHT JOIN ""teams"" AS ""t"" ON (""a"".""team_id""=""t"".""team_id"") GROUP BY ""t"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
235,"WITH ""a"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"" FROM (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 ELSE 1 END) AS ""point"" FROM ""matches"") AS ""x"" GROUP BY ""team_id"") SELECT ""t"".""team_id"",""team_name"",COALESCE(""points"", 0) AS ""num_points"" FROM ""a"" RIGHT JOIN ""teams"" AS ""t"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,1"
236,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
237,"WITH ""CTE1"" AS (SELECT ""match_id"",""host_team"",""guest_team"",""host_goals"",""guest_goals"" FROM ""matches"" UNION SELECT ""match_id""+5 AS ""match_id"",""guest_team"",""host_team"",""guest_goals"",""host_goals"" FROM ""matches""), ""CTE2"" AS (SELECT ""match_id"",""host_team"",""guest_team"",""host_goals"",""guest_goals"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""CTE1"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""Points""), 0) AS ""num_points"" FROM ""TEAMS"" AS ""a"" LEFT JOIN ""CTE2"" AS ""b"" ON ""host_team""=""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
238,"WITH ""team_points"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""cumulative_points"" AS (SELECT ""team_id"",SUM(""points"") AS ""num_points"" FROM ""team_points"" GROUP BY ""team_id"") SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN ""cumulative_points"" AS ""b"" ON (""a"".""team_id""=""b"".""team_id"") ORDER BY COALESCE(""num_points"", 0) DESC,""a"".""team_id"""
239,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END) AS ""hst_pts"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 END) AS ""gst_pts"" FROM ""matches""), ""cte_host"" AS (SELECT ""host_team"",SUM(""hst_pts"") AS ""hst_pts"" FROM ""cte"" GROUP BY ""host_team""), ""cte_guest"" AS (SELECT ""guest_team"",SUM(""gst_pts"") AS ""gst_pts"" FROM ""cte"" GROUP BY ""guest_team""), ""team_pts"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""hst_pts"") AS ""pts"" FROM (SELECT ""a"".* FROM ""cte_host"" AS ""a"" UNION ALL SELECT ""b"".* FROM ""cte_guest"" AS ""b"") AS ""temp"" GROUP BY 1) SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(""b"".""pts"", 0) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN ""team_pts"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
240,"WITH ""mer"" AS (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_team_point"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""guest_team_point"" FROM ""Matches"" GROUP BY ""guest_team"") SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"",COALESCE(SUM(""m"".""host_team_point""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""mer"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
241,"WITH ""points_matches"" AS (SELECT *,CASE WHEN ""guest_goals""<""host_goals"" THEN 0 WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals"">""host_goals"" THEN 3 END AS ""guest_points"",CASE WHEN ""guest_goals""<""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals"">""host_goals"" THEN 0 END AS ""host_points"" FROM ""Matches""), ""host"" AS (SELECT ""team_id"",""team_name"" AS ""team_name"",COALESCE(""host_points"", 0) AS ""points"" FROM ""points_matches"" RIGHT JOIN ""Teams"" ON ""points_matches"".""host_team""=""Teams"".""team_id""), ""guest"" AS (SELECT ""team_id"",""team_name"",COALESCE(""guest_points"", 0) AS ""points"" FROM ""points_matches"" RIGHT JOIN ""Teams"" ON ""points_matches"".""guest_team""=""Teams"".""team_id""), ""unioned"" AS (SELECT * FROM ""host"" UNION ALL SELECT * FROM ""guest"") SELECT ""team_id"",""team_name"",SUM(""points"") AS ""num_points"" FROM ""unioned"" GROUP BY ""team_id"",""team_name"" ORDER BY SUM(""points"") DESC,""team_id"""
242,"WITH ""temp"" AS (SELECT ""match_id"",""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""points"",""guest_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 0 END AS ""guest_points"" FROM ""matches""), ""temp2"" AS (SELECT ""host_team"",""points"" FROM ""temp"" UNION ALL (SELECT ""guest_Team"",""guest_points"" FROM ""temp"")) SELECT ""teams"".""team_id"",""team_name"",COALESCE(""t"".""num_points"", 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",SUM(""points"") AS ""num_points"" FROM ""temp2"" GROUP BY ""host_team"") AS ""t"" RIGHT JOIN ""teams"" ON ""teams"".""team_id""=""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
243,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""team_id""=""host_team"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""guest_goals"">""host_goals"" AND ""team_id""=""guest_team"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""host_goals""=""guest_goals"" AND ""team_id""=""host_team"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""host_goals""=""guest_goals"" AND ""team_id""=""guest_team"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""Matches"".""host_team""=""Teams"".""team_id"" OR ""Matches"".""guest_team""=""Teams"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
244,"SELECT ""b"".""team_id"",""b"".""team_name"",SUM(CASE WHEN ""a"".""team_name_id"" IS NULL THEN 0 ELSE ""a"".""pt"" END) AS ""num_points"" FROM ""teams"" AS ""b"" LEFT JOIN (WITH ""tmpPt"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_pt"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_pt"" FROM ""Matches"") SELECT ""host_team"" AS ""team_name_id"",""host_pt"" AS ""pt"" FROM ""tmpPt"" UNION ALL SELECT ""guest_team"" AS ""team_name_id"",""guest_pt"" AS ""pt"" FROM ""tmpPt"") AS ""a"" ON ""a"".""team_name_id""=""b"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""b"".""team_id"""
245,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
246,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
247,"SELECT ""team_id"",""team_name"",CASE WHEN SUM(""num_points"")>0 THEN SUM(""num_points"") ELSE 0 END AS ""num_points"" FROM (SELECT ""host_team"" AS ""team"",SUM(CASE WHEN (""host_goals""-""guest_goals"")>=1 THEN 3 WHEN (""host_goals""=""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team"",SUM(CASE WHEN (""guest_goals""-""host_goals"")>=1 THEN 3 WHEN (""host_goals""=""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""a"" RIGHT JOIN ""Teams"" ON ""Teams"".""team_id""=""a"".""team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
248,"WITH ""host"" AS (SELECT ""m"".""match_id"",""t"".""team_id"",""t"".""team_name"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" AS ""m"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""m"".""host_team""), ""guest"" AS (SELECT ""m"".""match_id"",""t"".""team_id"",""t"".""team_name"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" AS ""m"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""m"".""guest_team""), ""total_points"" AS (SELECT ""team_id"",""points"" FROM ""host"" UNION ALL SELECT ""team_id"",""points"" FROM ""guest"") SELECT DISTINCT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""points"") OVER (PARTITION BY ""team_id""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""total_points"" AS ""tp"" ON ""t"".""team_id""=""tp"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
249,"SELECT ""team_id"",""Team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"" AS ""m"" RIGHT JOIN ""teams"" AS ""t"" ON (""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"") GROUP BY 1 ORDER BY 3 DESC,1"
250,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
251,"SELECT ""t"".""team_id"",""t"".""team_name"",(SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
252,"SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""score"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END END AS ""score"" FROM ""matches"") AS ""temp"" RIGHT JOIN ""teams"" AS ""t"" ON ""temp"".""team""=""t"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
253,"SELECT ""T"".""team_id"",""T"".""Team_name"",COALESCE(SUM(CASE WHEN ""T"".""team_id""=""M"".""host_team"" AND ""M"".""host_goals"">""M"".""guest_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""host_team"" AND ""M"".""host_goals""=""M"".""guest_goals"" THEN 1 WHEN ""T"".""team_id""=""M"".""Guest_team"" AND ""M"".""host_goals""<""M"".""guest_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""Guest_team"" AND ""M"".""host_goals""=""M"".""guest_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""host_team"" OR ""T"".""team_id""=""M"".""guest_team"" GROUP BY ""T"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
254,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
255,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""num"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""num"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""cte"".""num""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""cte"" ON ""t"".""team_id""=""cte"".""team_id"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
256,"SELECT ""team_id"",""team_name"",(COALESCE(""host_points"", 0)+COALESCE(""guest_points"", 0)) AS ""num_points"" FROM (""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_points"" FROM ""Matches"" GROUP BY ""host_team"") AS ""h"" ON ""t"".""team_id""=""h"".""host_team"") LEFT JOIN (SELECT ""guest_team"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""guest_points"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""g"" ON ""t"".""team_id""=""g"".""guest_team"" ORDER BY ""num_points"" DESC,""team_id"""
257,"WITH ""t1"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",SUM(COALESCE(""t1"".""num_points"", 0)) AS ""num_points"" FROM ""t1"" RIGHT JOIN ""teams"" AS ""t"" ON ""t1"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
258,"WITH ""cte"" AS (SELECT ""a"".""team_name"" AS ""team_name"",SUM(""a"".""score"") AS ""score"" FROM (SELECT ""host_team"" AS ""team_name"",3 AS ""score"" FROM ""Matches"" AS ""m1"" WHERE ""m1"".""host_goals"">""m1"".""guest_goals"" UNION ALL SELECT ""guest_team"" AS ""team_name"",3 AS ""score"" FROM ""Matches"" AS ""m1"" WHERE ""m1"".""guest_goals"">""m1"".""host_goals"" UNION ALL SELECT ""host_team"" AS ""team_name"",1 AS ""score"" FROM ""Matches"" AS ""m1"" WHERE ""m1"".""host_goals""=""m1"".""guest_goals"" UNION ALL SELECT ""guest_team"" AS ""team_name"",1 AS ""score"" FROM ""Matches"" AS ""m1"" WHERE ""m1"".""host_goals""=""m1"".""guest_goals"") AS ""a"" GROUP BY ""a"".""team_name"") SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"" AS ""team_name"",COALESCE(""e"".""score"", 0) AS ""num_points"" FROM ""cte"" AS ""e"" RIGHT JOIN ""Teams"" AS ""t"" ON ""e"".""team_name""=""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
259,"SELECT ""team_id"",""team_name"",SUM(""num_points"") AS ""num_points"" FROM (SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"" AS ""team_name"",CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" AS ""m"" RIGHT JOIN ""Teams"" AS ""t"" ON ""m"".""host_team""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"" AS ""team_name"",CASE WHEN ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""m"".""guest_goals""=""m"".""host_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" AS ""m"" RIGHT JOIN ""Teams"" AS ""t"" ON ""m"".""guest_team""=""t"".""team_id"") AS ""sub"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
260,"SELECT ""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT ""host_team"" AS ""team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""t"" ON ""Teams"".""team_id""=""t"".""team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
261,"WITH ""Match_Score"" AS (SELECT ""host_team"",""guest_team"",""host_goals"",""guest_goals"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""Matches""), ""Team_Score"" AS (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""team_score"" FROM ""Match_Score"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""team_score"" FROM ""Match_Score"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""ts"".""team_score""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""team_score"" AS ""ts"" ON ""t"".""team_id""=""ts"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY 3 DESC,""t"".""team_id"""
262,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team"",""guest_team"" AS ""op"",""host_goals"" AS ""team_goals"",""guest_goals"" AS ""op_goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team"",""host_team"" AS ""op"",""guest_goals"" AS ""team_goals"",""host_goals"" AS ""op_goals"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""c"".""team_goals"">""c"".""op_goals"" THEN 3 WHEN ""c"".""team_goals""=""c"".""op_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
263,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN (""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"") AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" CROSS JOIN ""matches"" AS ""m"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
264,"WITH ""match_points"" AS (SELECT ""match_id"",""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",""guest_team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches""), ""team_points"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""host_points"") AS ""num_points"" FROM ""match_points"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"",SUM(""guest_points"") FROM ""match_points"" GROUP BY ""guest_team"") SELECT ""Teams"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""team_points"" RIGHT JOIN ""Teams"" ON ""team_points"".""team_id""=""Teams"".""team_id"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
265,"WITH ""t1"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""host_team"" AS ""team"",3 AS ""points"" FROM ""matches"" WHERE ""host_goals"">""guest_goals"") AS ""t"" GROUP BY ""team""), ""t2"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""guest_team"" AS ""team"",3 AS ""points"" FROM ""matches"" WHERE ""guest_goals"">""host_goals"") AS ""t"" GROUP BY ""team""), ""t3"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""guest_team"" AS ""team"",1 AS ""points"" FROM ""matches"" WHERE ""guest_goals""=""host_goals"") AS ""t10"" GROUP BY ""team"" UNION ALL SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""host_team"" AS ""team"",1 AS ""points"" FROM ""matches"" WHERE ""guest_goals""=""host_goals"") AS ""t11"" GROUP BY ""team"") AS ""t"" GROUP BY ""team""), ""t4"" AS (SELECT ""t1"".""team"",""t1"".""points"" FROM ""t1"" UNION ALL SELECT ""t2"".""team"",""t2"".""points"" FROM ""t2"" UNION ALL SELECT ""t3"".""team"",""t3"".""points"" FROM ""t3""), ""t5"" AS (SELECT ""team_id"" AS ""team"",0 AS ""points"" FROM ""teams"" WHERE ""team_id"" NOT IN (SELECT DISTINCT (""team"") FROM ""t4"" AS ""team_id"")), ""t6"" AS (SELECT ""t4"".""team"",SUM(""t4"".""points"") AS ""points"" FROM ""t4"" GROUP BY ""team"" UNION ALL SELECT ""t5"".""team"",SUM(""t5"".""points"") AS ""points"" FROM ""t5"" GROUP BY ""team"") SELECT ""t7"".""team_id"",""t7"".""team_name"",""t6"".""points"" AS ""num_points"" FROM ""teams"" AS ""t7"" JOIN ""t6"" ON ""t7"".""team_id""=""t6"".""team"" ORDER BY ""num_points"" DESC,""team_id"""
266,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
267,"SELECT ""teams"".""team_id"",""teams"".""team_name"",SUM(CASE WHEN ""sub"".""guest_host""='tie' THEN 1 WHEN ""sub"".""host_team""=""teams"".""team_id"" AND ""guest_host""='host' THEN 3 WHEN ""sub"".""guest_team""=""teams"".""team_id"" AND ""guest_host""='guest' THEN 3 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN (SELECT *,CASE WHEN ""matches"".""host_goals"">""matches"".""guest_goals"" THEN 'host' WHEN ""matches"".""host_goals""=""matches"".""guest_goals"" THEN 'tie' ELSE 'guest' END AS ""guest_host"" FROM ""matches"") AS ""sub"" ON ""sub"".""host_team""=""teams"".""team_id"" OR ""sub"".""guest_team""=""teams"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
268,"WITH ""tmp"" AS ((SELECT ""match_id"",""guest_team"" AS ""host_team"",""host_team"" AS ""guest_team"",""guest_goals"" AS ""host_goals"",""host_goals"" AS ""guest_goals"" FROM ""Matches"") UNION ALL (SELECT * FROM ""Matches"")) SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"",COALESCE(SUM(""a"".""score""), 0) AS ""num_points"" FROM (SELECT (CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"",""host_team"" FROM ""tmp"") AS ""a"" RIGHT JOIN ""Teams"" AS ""t"" ON ""a"".""host_team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
269,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"") OR (""t"".""team_id""=""m"".""guest_team"" AND ""guest_goals"">""host_goals"") THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
270,"WITH ""temp"" AS ((SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") UNION ALL (SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"")) SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""temp"" AS ""p"" ON ""t"".""team_id""=""p"".""team_id"" GROUP BY ""t"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
271,"WITH ""CTE"" AS (SELECT ""TM"",SUM(""SCORE"") AS ""SC"" FROM (SELECT ""HOST_TEAM"" AS ""TM"",CASE WHEN ""HOST_GOALS"">""GUEST_GOALS"" THEN 3 WHEN ""HOST_GOALS""=""GUEST_GOALS"" THEN 1 ELSE 0 END AS ""SCORE"" FROM ""MATCHES"" UNION ALL SELECT ""GUEST_TEAM"" AS ""TM"",CASE WHEN ""HOST_GOALS""<""GUEST_GOALS"" THEN 3 WHEN ""HOST_GOALS""=""GUEST_GOALS"" THEN 1 ELSE 0 END AS ""SCORE"" FROM ""MATCHES"") AS ""X"" GROUP BY ""TM"") SELECT ""TEAM_ID"",""TEAM_NAME"",COALESCE(""SC"", 0) AS ""NUM_POINTS"" FROM ""TEAMS"" LEFT JOIN ""CTE"" ON ""TEAMS"".""TEAM_ID""=""CTE"".""TM"" ORDER BY ""NUM_POINTS"" DESC,""TEAM_ID"""
272,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
273,"WITH ""cte"" AS (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""points""), 0) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""Teams"" AS ""t"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
274,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""<""host_goals"" THEN 0 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""matches"" ON ""teams"".""team_id""=""matches"".""host_team"" OR ""teams"".""team_id""=""matches"".""guest_team"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""team_id"""
275,"WITH ""team_score"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END END AS ""host_score"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END END AS ""guest_score"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""num_points"" FROM ""team_score"" UNION ALL SELECT ""guest_team"",""guest_score"" FROM ""team_score"") AS ""tmp"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""tmp"".""team_id"" GROUP BY 1 ORDER BY ""num_points"" DESC,""team_id"""
276,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
277,"SELECT ""Teams"".""team_id"",""Teams"".""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""Teams"".""team_id""=""Matches"".""host_team"" OR ""Teams"".""team_id""=""Matches"".""guest_team"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""Teams"".""team_id"""
278,"WITH ""cte1"" AS (SELECT ""m"".""match_id"",""t"".""team_name"" AS ""home"",""t2"".""team_name"" AS ""away"",""m"".""host_goals"" AS ""home_goals"",""m"".""guest_goals"" AS ""away_goals"" FROM (""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""host_team""=""t"".""team_id"") LEFT JOIN ""Teams"" AS ""t2"" ON ""m"".""guest_team""=""t2"".""team_id""), ""cte2"" AS (SELECT *,CASE WHEN ""home_goals"">""away_goals"" THEN 3 WHEN ""home_goals""=""away_goals"" THEN 1 WHEN ""home_goals""<""away_goals"" THEN 0 END AS ""home_pts"",CASE WHEN ""away_goals"">""home_goals"" THEN 3 WHEN ""away_goals""=""home_goals"" THEN 1 WHEN ""away_goals""<""home_goals"" THEN 0 END AS ""away_pts"" FROM ""cte1"") SELECT ""t1"".""team_id"",""t1"".""team_name"",COALESCE(SUM(""t2"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t1"" LEFT JOIN (SELECT ""home"" AS ""team"",SUM(""home_pts"") AS ""num_points"" FROM ""cte2"" GROUP BY ""home"" UNION ALL SELECT ""away"" AS ""team"",SUM(""away_pts"") AS ""num_points"" FROM ""cte2"" GROUP BY ""away"") AS ""t2"" ON ""t1"".""team_name""=""t2"".""team"" GROUP BY ""t1"".""team_name"" ORDER BY ""num_points"" DESC,""t1"".""team_id"""
279,"WITH ""data_cte"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""data_cte"" AS ""d"" ON ""d"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY COALESCE(SUM(""num_points""), 0) DESC,""t"".""team_id"""
280,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
281,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""points""), 0) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
282,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON (""t"".""team_id""=""m"".""host_team"") OR (""t"".""team_id""=""m"".""guest_team"") GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
283,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""Matches"" ON ""teams"".""team_id""=""Matches"".""host_team"" OR ""teams"".""team_id""=""Matches"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
284,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""m"".""guest_goals"">""m"".""host_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" AND (""t"".""team_id""=""m"".""guest_team"" OR ""t"".""team_id""=""m"".""host_team"") THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" CROSS JOIN ""Matches"" AS ""m"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
285,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""T"".""team_id""=""M"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 WHEN ""T"".""team_id""=""M"".""guest_team"" AND ""host_goals"">""guest_goals"" THEN 0 WHEN ""T"".""team_id""=""M"".""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""host_team"" OR ""T"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
286,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
287,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE((SELECT SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) FROM ""Matches"" WHERE ""host_team""=""t"".""team_id""), 0)+COALESCE((SELECT SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) FROM ""Matches"" WHERE ""guest_team""=""t"".""team_id""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" ORDER BY ""num_points"" DESC,""team_id"""
288,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""m"".""host_goals""<""m"".""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
289,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
290,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""a"".""points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""id"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"") AS ""a"" ON ""t"".""team_id""=""a"".""id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
291,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"",""guest_team"",""host_goals"",""guest_goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""host_team"",""host_team"" AS ""guest_team"",""guest_goals"" AS ""host_goals"",""host_goals"" AS ""guest_goals"" FROM ""matches"") AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
292,"SELECT ""team_id"",""team_name"",CASE WHEN ""g_score"" IS NULL THEN 0 ELSE ""g_score"" END+CASE WHEN ""h_score"" IS NULL THEN 0 ELSE ""h_score"" END AS ""num_points"" FROM (""teams"" LEFT JOIN (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END) AS ""h_score"" FROM ""matches"" GROUP BY ""host_team"") AS ""h_score"" ON ""teams"".""team_id""=""h_score"".""host_team"") LEFT JOIN (SELECT ""guest_team"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END) AS ""g_score"" FROM ""matches"" GROUP BY ""guest_team"") AS ""g_score"" ON ""teams"".""team_id""=""g_score"".""guest_team"" ORDER BY ""num_points"" DESC,""team_id"""
293,"WITH ""s"" AS (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_score"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""num_points"" FROM ""s"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""num_points"" FROM ""s"") AS ""m"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
294,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""guest_goals"">""host_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
295,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" CROSS JOIN ""Matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
296,"SELECT ""t"".""team_id"" AS ""team_id"",""t"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""h"" UNION SELECT ""match_id"",""guest_team"" AS ""team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""g"") AS ""a"" RIGHT JOIN ""teams"" AS ""t"" ON ""a"".""team""=""t"".""team_id"" GROUP BY 1 ORDER BY COALESCE(""num_points"", 0) DESC,1"
297,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
298,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
299,"WITH ""CTE1"" AS (SELECT ""match_id"",""host_team"",""guest_team"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_pts"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) AS ""guest_pts"" FROM ""Matches""), ""CTE2"" AS (SELECT ""host_team"" AS ""team"",""host_pts"" AS ""pts"" FROM ""CTE1"" UNION ALL SELECT ""guest_team"",""guest_pts"" FROM ""CTE1""), ""CTE3"" AS (SELECT ""team"",SUM(""pts"") AS ""num_points"" FROM ""CTE2"" GROUP BY ""team"") SELECT ""Teams"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""CTE3"" ON ""Teams"".""team_id""=""CTE3"".""team"" ORDER BY ""num_points"" DESC,""team_id"""
300,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
301,"WITH ""s"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""host_score"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""Matches"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""score"" FROM ""s"" UNION ALL SELECT ""guest_team"",""guest_score"" FROM ""s"") AS ""sub"" RIGHT JOIN ""Teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
302,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
303,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
304,"WITH ""s1"" AS (SELECT ""m1"".""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" AS ""m1"" GROUP BY ""m1"".""host_team""), ""s2"" AS (SELECT ""m2"".""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" AS ""m2"" GROUP BY ""m2"".""guest_team"") SELECT ""Teams"".""team_id"",""Teams"".""team_name"",COALESCE(SUM(""s3"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT * FROM ""s1"" UNION ALL SELECT * FROM ""s2"") AS ""s3"" ON ""Teams"".""team_id""=""s3"".""team_id"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
305,"WITH ""scores"" AS (SELECT ""match_id"",""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_score"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""guest_score"" FROM ""Matches""), ""host"" AS (SELECT ""host_team"",SUM(""host_score"") AS ""sum_host_score"" FROM ""scores"" GROUP BY ""host_team""), ""guest"" AS (SELECT ""guest_team"",SUM(""guest_score"") AS ""sum_guest_score"" FROM ""scores"" GROUP BY ""guest_team"") SELECT ""Teams"".""team_id"",""team_name"",COALESCE(""sum_guest_score"", 0)+COALESCE(""sum_host_score"", 0) AS ""num_points"" FROM (""Teams"" LEFT JOIN ""host"" ON ""host"".""host_team""=""Teams"".""team_id"") LEFT JOIN ""guest"" ON ""guest"".""guest_team""=""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""Teams"".""team_id"""
306,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
307,"SELECT ""t1"".""team_id"",""t1"".""team_name"",SUM(CASE WHEN ""t1"".""team_id""=""t2"".""host_team"" AND ""t2"".""host_goals"">""t2"".""guest_goals"" THEN 3 WHEN ""t1"".""team_id""=""t2"".""host_team"" AND ""t2"".""host_goals""=""t2"".""guest_goals"" THEN 1 WHEN ""t1"".""team_id""=""t2"".""host_team"" AND ""t2"".""host_goals""<""t2"".""guest_goals"" THEN 0 WHEN ""t1"".""team_id""=""t2"".""guest_team"" AND ""t2"".""host_goals"">""t2"".""guest_goals"" THEN 0 WHEN ""t1"".""team_id""=""t2"".""guest_team"" AND ""t2"".""host_goals""=""t2"".""guest_goals"" THEN 1 WHEN ""t1"".""team_id""=""t2"".""guest_team"" AND ""t2"".""host_goals""<""t2"".""guest_goals"" THEN 3 ELSE 0 END) AS ""num_points"" FROM (""teams"" AS ""t1"") CROSS JOIN ""Matches"" AS ""t2"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
308,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""T1"" LEFT JOIN ""Matches"" AS ""M1"" ON ""T1"".""team_id""=""M1"".""host_team"" OR ""T1"".""team_id""=""M1"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
309,"WITH ""new"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""new"" AS ""n"" ON ""t"".""team_id""=""n"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
310,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
311,"SELECT DISTINCT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""sub"".""num_points"") OVER (PARTITION BY ""sub"".""team_id""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END AS ""num_points"" FROM ""matches"") AS ""sub"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""sub"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
312,"WITH ""cte"" AS (SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""m"".""host_Goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_Goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""host_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num"" DESC,""t"".""team_id"") SELECT ""t"".""team_id"",""t"".""team_name"",""num""+SUM(CASE WHEN ""m2"".""host_Goals""=""m2"".""guest_goals"" THEN 1 WHEN ""m2"".""host_Goals""<""m2"".""guest_goals"" THEN 3 ELSE 0 END) AS ""num_points"" FROM ""cte"" AS ""t"" LEFT JOIN ""Matches"" AS ""M2"" ON ""T"".""team_id""=""M2"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
313,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals"">""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""host_team"" AND ""host_goals""=""guest_goals"") OR (""t"".""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"") THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"" AS ""t"") CROSS JOIN ""Matches"" AS ""m"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
314,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END) AS ""score"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""teams"" AS ""t"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
315,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_label"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""guest_label"" FROM ""Matches""), ""cte2"" AS (SELECT ""host_team"" AS ""team_id"",""host_label"" AS ""score"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_label"" AS ""score"" FROM ""cte"") SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""cte2"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
316,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""m"".""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""m"".""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY 1 ORDER BY 3 DESC,1"
317,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
318,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM (SELECT ""team_id"",SUM(""points"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""points"" FROM ""cte"") AS ""sub"" GROUP BY ""team_id"") AS ""sub1"" RIGHT JOIN ""teams"" AS ""t"" ON ""sub1"".""team_id""=""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
319,"WITH ""cte_1"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""points"" FROM ""Matches"") SELECT ""Teams"".""team_id"",""team_name"",SUM(COALESCE(""points"", 0)) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""cte_1"" USING (""team_id"") GROUP BY 1,2 ORDER BY 3 DESC,1"
320,"WITH ""host"" AS (SELECT ""match_id"",""host_team"" AS ""team_id"",3 AS ""num_points"" FROM ""Matches"" WHERE ""host_goals"">""guest_goals""), ""guest"" AS (SELECT ""match_id"",""guest_team"" AS ""team_id"",3 AS ""num_points"" FROM ""Matches"" WHERE ""host_goals""<""guest_goals""), ""equalguest"" AS (SELECT ""match_id"",""guest_team"" AS ""team_id"",1 AS ""num_points"" FROM ""Matches"" WHERE ""host_goals""=""guest_goals""), ""equalhost"" AS (SELECT ""match_id"",""host_team"" AS ""team_id"",1 AS ""num_points"" FROM ""Matches"" WHERE ""host_goals""=""guest_goals"") SELECT ""Teams"".""team_id"",""team_name"",SUM(COALESCE(""num_points"", 0)) AS ""num_points"" FROM ""Teams"" LEFT JOIN (SELECT ""team_id"",""num_points"" FROM ""host"" UNION ALL SELECT ""team_id"",""num_points"" FROM ""guest"" UNION ALL SELECT ""team_id"",""num_points"" FROM ""equalhost"" UNION ALL SELECT ""team_id"",""num_points"" FROM ""equalguest"") AS ""b"" ON ""Teams"".""team_id""=""b"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
321,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
322,"WITH ""TeamPoints"" AS (SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""team_id""=""h"".""host_team"" AND ""h"".""host_goals"">""h"".""guest_goals"" THEN 3 WHEN ""team_id""=""h"".""host_team"" AND ""h"".""host_goals""=""h"".""guest_goals"" THEN 1 WHEN ""team_id""=""h"".""host_team"" AND ""h"".""host_goals""<""h"".""guest_goals"" THEN 0 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""h"" ON ""t"".""team_id""=""h"".""host_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" UNION ALL SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""team_id""=""g"".""guest_team"" AND ""g"".""guest_goals"">""g"".""host_goals"" THEN 3 WHEN ""team_id""=""g"".""guest_team"" AND ""g"".""guest_goals""=""g"".""host_goals"" THEN 1 WHEN ""team_id""=""g"".""guest_team"" AND ""g"".""guest_goals""<""g"".""host_goals"" THEN 0 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""g"" ON ""t"".""team_id""=""g"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"") SELECT ""team_id"",""team_name"",SUM(""num_points"") AS ""num_points"" FROM ""TeamPoints"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
323,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""host_team""=""team_id"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""guest_team""=""team_id"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""guest_team""=""team_id"" OR ""host_team""=""team_id"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
324,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
325,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
326,"WITH ""temp"" AS (SELECT *,(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 END) AS ""host_score"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END) AS ""guest_score"" FROM ""Matches"") SELECT ""Teams"".""team_id"",""Teams"".""team_name"",SUM(COALESCE(""score_table"".""team_score"", 0)) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""team_score"" FROM ""temp"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""team_score"" FROM ""temp"") AS ""score_table"" RIGHT JOIN ""Teams"" ON ""score_table"".""team_id""=""Teams"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,1"
327,"WITH ""point_tab"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches""), ""host_table"" AS (SELECT ""t"".""team_id"",""t"".""team_name"",SUM(""p"".""host_points"") AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""point_tab"" AS ""p"" ON ""t"".""team_id""=""p"".""host_team"" GROUP BY ""t"".""team_id""), ""guest_table"" AS (SELECT ""t"".""team_id"",""t"".""team_name"",SUM(""p"".""guest_points"") AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""point_tab"" AS ""p"" ON ""t"".""team_id""=""p"".""guest_team"" GROUP BY ""t"".""team_id""), ""union_tab"" AS (SELECT * FROM ""guest_table"" UNION ALL SELECT * FROM ""host_table"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""union_tab"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
328,"WITH ""host_points"" AS (SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""Matches"" RIGHT JOIN ""Teams"" ON ""host_team""=""team_id"" GROUP BY ""team_id"",""team_name""), ""guest_points"" AS (SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END), 0) AS ""num_points"" FROM ""Matches"" RIGHT JOIN ""Teams"" ON ""guest_team""=""team_id"" GROUP BY ""team_id"",""team_name""), ""host_guest_comb"" AS (SELECT * FROM ""host_points"" UNION ALL SELECT * FROM ""guest_points"") SELECT ""team_id"",""team_name"",SUM(""num_points"") AS ""num_points"" FROM ""host_guest_comb"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
329,"WITH ""CET"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"") SELECT ""T"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""CET"" AS ""C"" RIGHT JOIN ""Teams"" AS ""T"" ON ""C"".""team_id""=""T"".""team_id"" GROUP BY ""T"".""team_id"" ORDER BY 3 DESC,1"
330,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
331,"WITH ""Scores"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_team_score"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""guest_team_score"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""s1"".""tot"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""t3"".""team_id"",SUM(""t3"".""score"") AS ""tot"" FROM (SELECT ""t1"".""host_team"" AS ""team_id"",""t1"".""host_team_score"" AS ""score"" FROM ""Scores"" AS ""t1"" UNION ALL SELECT ""t2"".""guest_team"" AS ""team_id"",""t2"".""guest_team_score"" AS ""score"" FROM ""Scores"" AS ""t2"") AS ""t3"" GROUP BY 1) AS ""S1"" ON ""t"".""team_id""=""S1"".""team_id"" ORDER BY 3 DESC,1"
332,"WITH ""cte"" AS (SELECT ""team_name"",""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" UNION ALL SELECT ""team_name"",""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""guest_team"") SELECT ""team_id"",""team_name"",SUM(""num_points"") AS ""num_points"" FROM ""cte"" GROUP BY 1,2 ORDER BY 3 DESC,1"
333,"WITH ""cte"" AS (SELECT ""id"",SUM(""num_points"") AS ""n"" FROM (SELECT ""host_team"" AS ""id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""num_points"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END) AS ""num_points"" FROM ""matches"" GROUP BY 1) AS ""b"" GROUP BY ""id"") SELECT ""team_id"",""team_name"",COALESCE(""n"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""id"" ORDER BY 3 DESC,1"
334,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Matches"" AS ""m"" RIGHT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY 3 DESC,1"
335,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""t"".""team_id""=""host_team"" THEN 3 WHEN ""host_goals""<""guest_goals"" AND ""t"".""team_id""=""guest_team"" THEN 3 WHEN ""host_goals""=""guest_goals"" AND (""t"".""team_id""=""host_team"" OR ""t"".""team_id""=""guest_team"") THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
336,"WITH ""temp1"" AS (SELECT *,(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""host_point"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""guest_point"" FROM ""Matches""), ""temp2"" AS (SELECT ""host_team"" AS ""team"",""host_point"" AS ""point"" FROM ""temp1"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_point"" AS ""point"" FROM ""temp1"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""point""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""temp2"" ON ""Teams"".""team_id""=""temp2"".""team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
337,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
338,"WITH ""cte"" AS (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",""guest_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""c"".""host_team"" AS ""id"",""c"".""host_score"" AS ""score"" FROM ""cte"" AS ""c"" UNION ALL SELECT ""c1"".""guest_team"" AS ""id"",""c1"".""guest_score"" AS ""socre"" FROM ""cte"" AS ""c1"") AS ""temp"" RIGHT JOIN ""teams"" AS ""t"" ON ""temp"".""id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
339,"WITH ""cte"" AS (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END) AS ""host_points"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END) AS ""guest_points"" FROM ""Matches"" GROUP BY ""guest_team""), ""cte2"" AS (SELECT ""host_team"",SUM(""host_points"") AS ""total_points"" FROM ""cte"" GROUP BY ""host_team"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""total_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""cte2"" ON ""t"".""team_id""=""cte2"".""host_team"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
340,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
341,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" CROSS JOIN ""Matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
342,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_team""=""team_id"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""guest_team""=""team_id"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""host_team""=""team_id"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""guest_team""=""team_id"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN ""matches"" AS ""b"" ON ""a"".""team_id""=""b"".""host_team"" OR ""a"".""team_id""=""b"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
343,"WITH ""Points"" AS (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_point"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 END AS ""guest_point"" FROM ""Matches"" AS ""m"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""host_point""), 0) AS ""num_points"" FROM (SELECT ""t1"".""team_id"",""t1"".""team_name"",""p1"".""host_point"" FROM ""Teams"" AS ""t1"" LEFT JOIN ""Points"" AS ""p1"" ON ""t1"".""team_id""=""p1"".""host_team"" UNION ALL SELECT ""t2"".""team_id"",""t2"".""team_name"",""p2"".""guest_point"" FROM ""Teams"" AS ""t2"" LEFT JOIN ""Points"" AS ""p2"" ON ""t2"".""team_id""=""p2"".""guest_team"") AS ""subt"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
344,"WITH ""home_scores"" AS (SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""home_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" GROUP BY 1,2), ""away_scores"" AS (SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""guest_team"" GROUP BY 1,2) SELECT ""h"".""team_id"",""h"".""team_name"",""home_points""+""away_points"" AS ""num_points"" FROM ""home_scores"" AS ""h"" JOIN ""away_scores"" USING (""team_id"") ORDER BY 3 DESC,1"
345,"SELECT ""t"".""team_id"",""team_name"",COALESCE(""win_lose_score"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT DISTINCT ""team_id"",SUM(""points"") AS ""win_lose_score"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""f"" GROUP BY 1) AS ""f"" ON ""t"".""team_id""=""f"".""team_id"" ORDER BY 3 DESC,1"
346,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
347,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""host_goals""<""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
348,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",""host_goals"",""guest_goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"",""host_team"",""guest_goals"",""host_goals"" FROM ""matches"") SELECT ""teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""cte"") AS ""sub1"" RIGHT JOIN ""teams"" ON ""sub1"".""team_id""=""teams"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""team_id"""
349,"WITH ""CTE_POINTS"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches""), ""CTE_SUMSCORE"" AS (SELECT ""team_id"",SUM(""score"") AS ""score"" FROM ""CTE_POINTS"" GROUP BY ""team_id"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""s"".""score"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""CTE_SUMSCORE"" AS ""s"" ON ""t"".""team_id""=""s"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
350,"WITH ""points_tbl"" AS (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" GROUP BY ""guest_team"") SELECT ""t1"".""team_id"",""t1"".""team_name"",COALESCE(""points_ttl"", 0) AS ""num_points"" FROM ""teams"" AS ""t1"" LEFT JOIN (SELECT ""team_id"",SUM(""points"") AS ""points_ttl"" FROM ""points_tbl"" GROUP BY ""team_id"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"" GROUP BY ""t1"".""team_id"",""t1"".""team_name"" ORDER BY COALESCE(""points_ttl"", 0) DESC,""t1"".""team_id"""
351,"SELECT ""Teams"".""team_id"" AS ""team_id"",""Teams"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ((SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") UNION ALL (SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""score"" FROM ""Matches"")) AS ""Team_Score"" ON ""Teams"".""team_id""=""Team_Score"".""team"" GROUP BY ""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
352,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""m"".""host_team""=""t"".""team_id"" OR ""m"".""guest_team""=""t"".""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
353,"SELECT ""main_team"".""team_id"",""main_team"".""team_name"",COALESCE(""data_final"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""main_team"" LEFT JOIN (SELECT ""data_host"".""team_id"",(""data_host"".""num_points""+""data_guest"".""num_points"") AS ""num_points"" FROM (SELECT ""T"".""team_id"",""T"".""team_name"",COALESCE(""T1"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN (SELECT ""host_team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""host_team"") AS ""T1"" ON ""T"".""team_id""=""T1"".""host_team"") AS ""data_host"" LEFT JOIN (SELECT ""T"".""team_id"",""T"".""team_name"",COALESCE(""T2"".""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN (SELECT ""guest_team"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""T2"" ON ""T"".""team_id""=""T2"".""guest_team"") AS ""data_guest"" ON ""data_host"".""team_id""=""data_guest"".""team_id"") AS ""data_final"" ON ""main_team"".""team_id""=""data_final"".""team_id"" ORDER BY ""num_points"" DESC,""main_team"".""team_id"""
354,"WITH ""u"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""u"" RIGHT JOIN ""teams"" AS ""t"" ON ""u"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
355,"WITH ""points"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""guest_goals"">""host_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""p"".""points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""points"" AS ""p"" ON ""t"".""team_id""=""p"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY 3 DESC,1"
356,"SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Matches"" GROUP BY ""guest_team"") AS ""b"" GROUP BY ""team_id"") AS ""c"" ON ""a"".""team_id""=""c"".""team_id"" GROUP BY ""a"".""team_id"",""a"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
357,"SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""p"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_Id""=""p"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,1"
358,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN (""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"") OR (""t"".""team_id""=""m"".""guest_team"" AND ""m"".""guest_goals"">""m"".""host_goals"") THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
359,"SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(SUM(""team_points""), 0) AS ""num_points"" FROM (SELECT ""match_id"",""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""team_points"" FROM ""matches"" UNION ALL SELECT ""match_id"",""guest_team"" AS ""team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""team_points"" FROM ""matches"") AS ""temp"" RIGHT JOIN ""teams"" ON ""temp"".""team""=""teams"".""team_id"" GROUP BY ""team"",""teams"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
360,"WITH ""cte"" AS (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""rt"" FROM ""matches"" UNION ALL SELECT ""guest_team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""rt"" FROM ""matches""), ""cte2"" AS (SELECT ""teams"".""team_id"",""teams"".""team_name"",COALESCE(""score"", 0) AS ""num_points"" FROM (SELECT ""host_team"",SUM(""rt"") AS ""score"" FROM ""cte"" GROUP BY ""host_team"") AS ""d"" RIGHT JOIN ""teams"" ON ""d"".""host_team""=""teams"".""team_id"") SELECT * FROM ""cte2"" ORDER BY ""num_points"" DESC,""team_id"""
361,"WITH ""temp"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches""), ""temp1"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""temp"" GROUP BY ""team_id"") SELECT ""t"".""team_id"",""team_name"",CASE WHEN ""temp1"".""num_points"" IS NULL THEN 0 ELSE ""temp1"".""num_points"" END AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""temp1"" ON ""t"".""team_id""=""temp1"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
362,"WITH ""score_table"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches""), ""team_scores"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""score_table"" GROUP BY ""team_id"") SELECT ""results"".""team_id"",""team_name"",""num_points"" FROM (SELECT ""team_id"",0 AS ""num_points"" FROM ""Teams"" WHERE ""team_id"" NOT IN (SELECT DISTINCT ""team_id"" FROM ""team_scores"") UNION SELECT * FROM ""team_scores"") AS ""results"" JOIN ""Teams"" ON ""results"".""team_id""=""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
363,"WITH ""res"" AS (SELECT CASE WHEN ""host_goals"">""guest_goals"" THEN ""host_team"" WHEN ""host_goals""<""guest_goals"" THEN ""guest_team"" END AS ""team_id"",SUM(CASE WHEN ""host_goals"">""guest_goals"" OR ""host_goals""<""guest_goals"" THEN 3 END) AS ""num_points"" FROM ""matches"" WHERE ""host_goals""!=""guest_goals"" GROUP BY 1 UNION ALL SELECT ""host_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals"" UNION ALL SELECT ""guest_team"" AS ""team_id"",1 AS ""num_points"" FROM ""matches"" WHERE ""host_goals""=""guest_goals""), ""res_new"" AS (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM ""res"" GROUP BY 1) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""r"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""res_new"" AS ""r"" ON ""r"".""team_id""=""t"".""team_id"" ORDER BY 3 DESC,1"
364,"SELECT ""a"".""team_id"",""a"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" AND ""a"".""team_id""=""b"".""host_team"" THEN 3 WHEN ""guest_goals"">""host_goals"" AND ""a"".""team_id""=""b"".""guest_team"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""a"" LEFT JOIN ""matches"" AS ""b"" ON ""a"".""team_id""=""b"".""host_team"" OR ""a"".""team_id""=""b"".""guest_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
365,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
366,"WITH ""match_data"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_points"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""sub1"".""points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""match_data"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_points"" AS ""points"" FROM ""match_data"") AS ""sub1"" RIGHT JOIN ""Teams"" AS ""t"" ON ""sub1"".""team_id""=""t"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""t"".""team_id"""
367,"WITH ""host"" AS (SELECT ""host_team"" AS ""team"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"" GROUP BY 1), ""guest"" AS (SELECT ""guest_team"" AS ""team"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"" GROUP BY 1), ""id_points"" AS (SELECT ""team"" AS ""team_id"",SUM(""points"") AS ""num_points"" FROM (SELECT ""team"",""points"" FROM ""host"" UNION ALL SELECT ""team"",""points"" FROM ""guest"") AS ""id_points"" GROUP BY 1) SELECT ""team_id"",""team_name"",CASE WHEN ""num_points"" IS NULL THEN 0 ELSE ""num_points"" END AS ""num_points"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",""i"".""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""id_points"" AS ""i"" ON ""t"".""team_id""=""i"".""team_id"") AS ""final"" ORDER BY ""num_points"" DESC,""team_id"""
368,"WITH ""scores"" AS (SELECT ""host_team"" AS ""Team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""Score"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""Team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""Score"" FROM ""matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""Score""), 0) AS ""num_points"" FROM ""scores"" AS ""s"" RIGHT JOIN ""teams"" AS ""t"" ON ""s"".""Team""=""t"".""team_id"" GROUP BY ""s"".""Team"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
369,"SELECT ""team_id"",""team_name"",(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
370,"WITH ""MatchesScores"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_team_score"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""guest_team_score"" FROM ""Matches""), ""TeamScores"" AS ((SELECT ""host_team"" AS ""team_id"",""host_team_score"" AS ""num_points"" FROM ""MatchesScores"" WHERE ""host_team_score""!=0) UNION ALL (SELECT ""guest_team"" AS ""team_id"",""guest_team_score"" AS ""num_points"" FROM ""MatchesScores"" WHERE ""guest_team_score""!=0)) SELECT ""a"".""team_id"",""a"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""a"" LEFT JOIN ""TeamScores"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""a"".""team_id"""
371,"SELECT ""t"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (WITH ""matches"" AS (SELECT ""match_id"",""host_team"",""guest_team"",""host_goals"",""guest_goals"",CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_scores"",CASE WHEN ""guest_goals""=""host_goals"" THEN 1 WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""guest_scores"" FROM ""matches"") SELECT ""host_team"" AS ""team_id"",SUM(""host_scores"") AS ""num_points"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_scores"") AS ""num_points"" FROM ""matches"" GROUP BY 1) AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
372,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
373,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""T"".""team_id""=""M"".""HOST_TEAM"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 WHEN ""T"".""team_id""=""M"".""HOST_TEAM"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END), 0) AS ""NUM_POINTS"" FROM ""TEAMS"" AS ""T"" LEFT JOIN ""MATCHES"" AS ""M"" ON ""T"".""team_id""=""M"".""HOST_TEAM"" OR ""T"".""team_id""=""M"".""guest_team"" GROUP BY 1 ORDER BY 3 DESC,1"
374,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ((SELECT ""team_id"",SUM(CASE WHEN ""Matches"".""host_goals"">""Matches"".""guest_goals"" THEN 3 WHEN ""Matches"".""host_goals""=""Matches"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"") CROSS JOIN ""Matches"" WHERE ""Teams"".""team_id""=""Matches"".""host_team"" GROUP BY ""Teams"".""team_id"",""Teams"".""team_name"") UNION ALL (SELECT ""team_id"",SUM(CASE WHEN ""Matches"".""guest_goals"">""Matches"".""host_goals"" THEN 3 WHEN ""Matches"".""guest_goals""=""Matches"".""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM (""Teams"") CROSS JOIN ""Matches"" WHERE ""Teams"".""team_id""=""Matches"".""guest_team"" GROUP BY ""Teams"".""team_id"",""Teams"".""team_name"")) AS ""goals"" ON ""t"".""team_id""=""goals"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
375,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
376,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""ss"".""points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""ss"" ON ""t"".""team_id""=""ss"".""team"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY COALESCE(SUM(""ss"".""points""), 0) DESC,""t"".""team_id"""
377,"WITH ""cte"" AS (SELECT ""m"".""host_team"",""m"".""guest_team"",CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""host_score"",CASE WHEN ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""guest_score"" FROM ""Matches"" AS ""m"") SELECT ""temp"".""team_id"",""temp"".""team_name"",COALESCE(SUM(""score""), 0) AS ""num_points"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",""cte"".""host_score"" AS ""score"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" ON ""cte"".""host_team""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_id"",""t"".""team_name"",""cte"".""guest_score"" AS ""score"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" ON ""cte"".""guest_team""=""t"".""team_id"") AS ""temp"" GROUP BY ""temp"".""team_id"" ORDER BY 3 DESC,""team_id"""
378,"WITH ""t"" AS ((SELECT ""h"".""match_id"",""h"".""host_team"" AS ""team"",CASE WHEN ""h"".""host_goals"">""h"".""guest_goals"" THEN 3 WHEN ""h"".""host_goals""=""h"".""guest_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""h"") UNION (SELECT ""g"".""match_id"",""g"".""guest_team"" AS ""team"",CASE WHEN ""g"".""guest_goals"">""g"".""host_goals"" THEN 3 WHEN ""g"".""guest_goals""=""g"".""host_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""matches"" AS ""g"")) SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(""z"".""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""t"".""team"",SUM(""score"") AS ""num_points"" FROM ""t"" GROUP BY ""t"".""team"") AS ""z"" ON ""t"".""team_id""=""z"".""team"" ORDER BY COALESCE(""z"".""num_points"", 0) DESC,""t"".""team_id"""
379,"SELECT ""t1"".""team_id"",""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t1"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
380,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN '3' WHEN ""host_goals""=""guest_goals"" THEN '1' ELSE '0' END AS ""pointhost"",CASE WHEN ""host_goals"">""guest_goals"" THEN '0' WHEN ""host_goals""=""guest_goals"" THEN '1' ELSE '3' END AS ""pointguest"" FROM ""Matches""), ""cte2"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""pointhost"") AS ""num_points"" FROM ""cte"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""pointguest"") AS ""num_points"" FROM ""cte"" GROUP BY ""guest_team"") SELECT ""t"".""team_id"",""t"".""team_name"",CAST(COALESCE(SUM(""cte2"".""num_points""), 0) AS DECIMAL(10)) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""cte2"" ON ""cte2"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
381,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""num_points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"") AS ""l"" RIGHT JOIN ""Teams"" AS ""t"" ON ""l"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
382,"WITH ""cte"" AS (SELECT (CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END) AS ""host_score"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END) AS ""guest_score"",""match_id"",""host_team"",""guest_team"" FROM ""Matches"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""c"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",""host_score"" AS ""num_points"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_score"" AS ""num_points"" FROM ""cte"") AS ""c"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
383,"WITH ""points"" AS (SELECT ""m"".""host_team"" AS ""team"",CASE WHEN ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" AS ""m"" UNION ALL SELECT ""m"".""guest_team"" AS ""team"",CASE WHEN ""m"".""guest_goals"">""m"".""host_goals"" THEN 3 WHEN ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" AS ""m"") SELECT ""t"".""team_id"",MIN(""t"".""team_name"") AS ""team_name"",SUM(""p"".""points"") AS ""num_points"" FROM ""points"" AS ""p"" JOIN ""teams"" AS ""t"" ON ""p"".""team""=""t"".""team_id"" GROUP BY ""t"".""team_id"" UNION ALL SELECT ""t"".""team_id"",""t"".""team_name"",0 FROM ""teams"" AS ""t"" LEFT JOIN ""points"" AS ""p"" ON ""p"".""team""=""t"".""team_id"" WHERE ""p"".""points"" IS NULL ORDER BY 3 DESC,""team_id"""
384,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" LEFT JOIN ""matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
385,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 3 END AS ""guest_points"" FROM ""Matches""), ""cte1"" AS (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""points"" FROM ""cte"" UNION ALL SELECT ""guest_team"",""guest_points"" FROM ""cte""), ""cte2"" AS (SELECT ""team_id"",SUM(""points"") AS ""num_points"" FROM ""cte1"" GROUP BY 1) SELECT ""Teams"".""team_id"",""Teams"".""team_name"",COALESCE(""cte2"".""num_points"", 0) AS ""num_points"" FROM ""cte2"" RIGHT JOIN ""Teams"" ON ""cte2"".""team_id""=""Teams"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
386,"SELECT ""t"".""team_id"",""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""num_points"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""num_points"" FROM ""Matches"" AS ""m1"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 0 END AS ""num_points"" FROM ""Matches"" AS ""m2"") AS ""test"" GROUP BY ""team_id"") AS ""test1"" ON ""test1"".""team_id""=""t"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
387,"SELECT ""team_id"",""team_name"",SUM(COALESCE(""host_points"", 0)) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"" FROM (SELECT ""host_team"",""host_goals"",""guest_goals"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""host_team"",""guest_goals"" AS ""host_goals"",""host_goals"" AS ""guest_goals"" FROM ""matches"") AS ""temp1"") AS ""temp2"" ON ""t"".""team_id""=""temp2"".""host_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
388,"WITH ""points"" AS (SELECT *,CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""host_points"",CASE WHEN ""host_goals"">""guest_goals"" THEN 0 WHEN ""host_goals""<""guest_goals"" THEN 3 ELSE 1 END AS ""guest_points"" FROM ""matches"") SELECT ""b"".""team_id"",""b"".""team_name"",COALESCE(SUM(""a"".""num_points""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",SUM(""host_points"") AS ""num_points"" FROM ""points"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""guest_points"") AS ""num_points"" FROM ""points"" GROUP BY ""guest_team"") AS ""a"" RIGHT JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_id"" ORDER BY ""num_points"" DESC,""b"".""team_id"""
389,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 0 WHEN ""t"".""team_id""=""m"".""host_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 0 WHEN ""t"".""team_id""=""m"".""guest_team"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY 1 ORDER BY 3 DESC,1"
390,"WITH ""CTE_1"" AS (SELECT ""HOST_TEAM"",SUM(CASE WHEN ""HOST_GOALS"">""GUEST_GOALS"" THEN 3 WHEN ""HOST_GOALS""=""GUEST_GOALS"" THEN 1 ELSE 0 END) AS ""HOST_POINTS"" FROM ""MATCHES"" GROUP BY ""HOST_TEAM""), ""CTE_2"" AS (SELECT ""GUEST_TEAM"",SUM(CASE WHEN ""GUEST_GOALS"">""HOST_GOALS"" THEN 3 WHEN ""GUEST_GOALS""=""HOST_GOALS"" THEN 1 ELSE 0 END) AS ""GUEST_POINTS"" FROM ""MATCHES"" GROUP BY ""GUEST_TEAM""), ""CTE_3"" AS (SELECT ""C1"".""HOST_TEAM"",COALESCE(""HOST_POINTS"", 0)+COALESCE(""GUEST_POINTS"", 0) AS ""NUM_POINTS"" FROM ""CTE_1"" AS ""C1"" LEFT JOIN ""CTE_2"" AS ""C2"" ON ""C1"".""HOST_TEAM""=""C2"".""GUEST_TEAM"" UNION SELECT ""C2"".""GUEST_TEAM"",COALESCE(""HOST_POINTS"", 0)+COALESCE(""GUEST_POINTS"", 0) AS ""NUM_POINTS"" FROM ""CTE_1"" AS ""C1"" RIGHT JOIN ""CTE_2"" AS ""C2"" ON ""C1"".""HOST_TEAM""=""C2"".""GUEST_TEAM"") SELECT ""T"".""TEAM_ID"",""T"".""TEAM_NAME"",COALESCE(""NUM_POINTS"", 0) AS ""NUM_POINTS"" FROM ""TEAMS"" AS ""T"" LEFT JOIN ""CTE_3"" AS ""C"" ON ""T"".""TEAM_ID""=""C"".""HOST_TEAM"" ORDER BY ""NUM_POINTS"" DESC,""T"".""TEAM_ID"""
391,"WITH ""t"" AS (SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""host_team"" GROUP BY 1,2 UNION ALL SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""guest_team"" GROUP BY 1,2) SELECT ""teams"".""team_id"",""teams"".""team_name"",SUM(COALESCE(""score"", 0)) AS ""num_points"" FROM ""teams"" LEFT JOIN ""t"" ON ""teams"".""team_id""=""t"".""team_id"" GROUP BY 1,2 ORDER BY ""num_points"" DESC,""team_id"""
392,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN (""team_id""=""host_team"" OR ""team_id""=""guest_team"") AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" CROSS JOIN ""matches"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
393,"SELECT ""t1"".""team_id"",""t1"".""team_name"",COALESCE(""num_points"", 0) AS ""num_points"" FROM ""teams"" AS ""t1"" LEFT JOIN (SELECT ""team_id"",SUM(""scores"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""scores"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 END) AS ""scores"" FROM ""matches"") AS ""m"" GROUP BY ""m"".""team_id"") AS ""f"" ON ""t1"".""team_id""=""f"".""team_id"" ORDER BY ""num_points"" DESC,""t1"".""team_id"""
394,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 WHEN ""team_id""=""guest_team"" AND ""guest_goals""<""host_goals"" THEN 0 WHEN ""guest_goals""=""host_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
395,"SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""t3"".""num_points""), 0) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN (SELECT ""host_team"" AS ""team_id"",""host_points"" AS ""num_points"" FROM (SELECT ""match_id"",""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_points"",""guest_team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""guest_points"" FROM ""matches"") AS ""t1"" UNION ALL SELECT ""guest_team"",""guest_points"" FROM (SELECT ""match_id"",""host_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 END AS ""host_points"",""guest_team"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 END AS ""guest_points"" FROM ""matches"") AS ""t2"") AS ""t3"" ON ""t"".""team_id""=""t3"".""team_id"" GROUP BY ""t3"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
396,"SELECT ""t"".""team_id"",""t"".""team_name"",SUM(CASE WHEN ""m"".""host_team""=""t"".""team_id"" AND ""m"".""host_goals"">""m"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""host_team""=""t"".""team_id"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""m"".""guest_team""=""t"".""team_id"" AND ""m"".""host_goals""<""m"".""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""guest_team""=""t"".""team_id"" AND ""m"".""host_goals""=""m"".""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""t"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
397,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
398,"WITH ""cte"" AS (SELECT ""match_id"",""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_point"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""guest_point"" FROM ""Matches""), ""cte2"" AS (SELECT ""host_team"" AS ""team_id"",""host_point"" AS ""point"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team_id"",""guest_point"" AS ""point"" FROM ""cte"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""point""), 0) AS ""num_points"" FROM ""cte2"" RIGHT JOIN ""teams"" USING (""team_id"") GROUP BY 1 ORDER BY ""num_points"" DESC,""team_id"""
399,"SELECT ""team_id"",""team_name"",SUM(""points"") AS ""num_points"" FROM ((SELECT ""t1"".""team_id"",""t1"".""team_name"",SUM(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Teams"" AS ""t1"" LEFT JOIN ""Matches"" AS ""m1"" ON ""t1"".""team_id""=""m1"".""host_team"" GROUP BY ""t1"".""team_id"") UNION ALL (SELECT ""t2"".""team_id"",""t2"".""team_name"",SUM(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Teams"" AS ""t2"" LEFT JOIN ""Matches"" AS ""m2"" ON ""t2"".""team_id""=""m2"".""guest_team"" GROUP BY ""t2"".""team_id"")) AS ""n"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
400,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN '3' WHEN ""host_goals""=""guest_goals"" THEN '1' ELSE '0' END AS ""pointhost"",CASE WHEN ""host_goals"">""guest_goals"" THEN '0' WHEN ""host_goals""=""guest_goals"" THEN '1' ELSE '3' END AS ""pointguest"" FROM ""Matches""), ""cte2"" AS (SELECT ""host_team"" AS ""team_id"",SUM(""pointhost"") AS ""num_points"" FROM ""cte"" GROUP BY ""host_team"" UNION ALL SELECT ""guest_team"" AS ""team_id"",SUM(""pointguest"") AS ""num_points"" FROM ""cte"" GROUP BY ""guest_team"") SELECT ""t"".""team_id"",""t"".""team_name"",COALESCE(SUM(""cte2"".""num_points""), 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""cte2"" ON ""cte2"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,1"
401,"SELECT DISTINCT ""T"".""team_id"",""team_name"",CASE WHEN ""score"" IS NOT NULL THEN SUM(""score"") OVER (PARTITION BY ""team_id"") ELSE 0 END AS ""num_points"" FROM ""Teams"" AS ""T"" LEFT JOIN (SELECT ""match_id"",""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 0 END) AS ""score"" FROM ""Matches"" UNION SELECT ""match_id"",""guest_team"" AS ""team_id"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 WHEN ""guest_goals""<""host_goals"" THEN 0 ELSE 0 END) AS ""score"" FROM ""Matches"") AS ""A"" ON ""A"".""team_id""=""T"".""team_id"" ORDER BY ""num_points"" DESC,""t"".""team_id"""
402,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""guest_team"" AND ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
403,"SELECT ""team_id"",""team_name"",COALESCE(SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""team_id""=""host_team"" AND ""host_goals""<""guest_goals"" THEN 0 WHEN ""team_id""=""guest_team"" AND ""guest_goals""<""host_goals"" THEN 0 WHEN ""guest_goals""=""host_goals"" THEN 1 END), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""Matches"" ON ""team_id""=""host_team"" OR ""team_id""=""guest_team"" GROUP BY ""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""team_id"""
404,"WITH ""tab1"" AS (SELECT ""host_team"" AS ""team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""Teams"" LEFT JOIN ""tab1"" ON ""tab1"".""team""=""team_id"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
405,"WITH ""cte"" AS (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""<""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""host_goals""<""guest_goals"" THEN 3 WHEN ""host_goals"">""guest_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""teams"".""team_id"",""team_name"",COALESCE(SUM(""points""), 0) AS ""num_points"" FROM ""cte"" RIGHT JOIN ""teams"" ON ""teams"".""team_id""=""cte"".""team_id"" GROUP BY ""cte"".""team_id"",""team_name"" ORDER BY ""num_points"" DESC,""teams"".""team_id"""
406,"SELECT ""team_id"",""team_name"",SUM(CASE WHEN ""team_id""=""host_team"" AND ""host_goals"">""guest_goals"" THEN 3 WHEN ""team_id""=""guest_team"" AND ""guest_goals"">""host_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""host_team"" OR ""t"".""team_id""=""m"".""guest_team"" GROUP BY ""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
407,"WITH ""cte"" AS (SELECT CASE WHEN ""a"".""host_goals"">""b"".""guest_goals"" THEN ""a"".""host_team"" ELSE NULL END AS ""winning_team"",'3' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""<""b"".""guest_goals"" THEN ""a"".""GUEST_TEAM"" ELSE NULL END AS ""winning_team"",'3' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""=""b"".""guest_goals"" THEN ""a"".""HOST_TEAM"" ELSE NULL END AS ""winning_team"",'1' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"" UNION ALL SELECT CASE WHEN ""a"".""host_goals""=""b"".""guest_goals"" THEN ""a"".""GUEST_TEAM"" ELSE NULL END AS ""winning_team"",'1' AS ""points"" FROM (""matches"" AS ""a"") CROSS JOIN ""matches"" AS ""b"" WHERE ""a"".""match_id""=""b"".""match_id"") SELECT ""t"".""team_id"",""t"".""team_name"",CAST(COALESCE(SUM(""points""), 0) AS DECIMAL(10)) AS ""num_points"" FROM ""cte"" AS ""c"" RIGHT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""winning_team"" GROUP BY 1,2 ORDER BY 3 DESC,1"
408,"WITH ""comb_data"" AS (SELECT ""host_team"" AS ""team_id"",(CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",(CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END) AS ""score"" FROM ""Matches"") SELECT ""t"".""team_id"",""team_name"",COALESCE(""s"".""score"", 0) AS ""num_points"" FROM ""Teams"" AS ""t"" LEFT JOIN (SELECT ""team_id"",SUM(""score"") AS ""score"" FROM ""comb_data"" GROUP BY ""team_id"") AS ""s"" ON ""t"".""team_id""=""s"".""team_id"" ORDER BY ""num_points"" DESC,""team_id"""
409,"SELECT * FROM ((SELECT ""Teams"".""team_id"",""Teams"".""team_name"",""t2"".""num_points"" FROM (""Teams"") CROSS JOIN (SELECT ""t1"".""team_id"",SUM(""t1"".""pts"") AS ""num_points"" FROM (SELECT ""host_team"" AS ""team_id"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""pts"" FROM ""Matches"" UNION ALL SELECT ""guest_team"" AS ""team_id"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 ELSE CASE WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END END AS ""pts"" FROM ""Matches"") AS ""t1"" GROUP BY ""t1"".""team_id"") AS ""t2"" WHERE ""Teams"".""team_id""=""t2"".""team_id"") UNION (SELECT ""team_id"",""team_name"",0 AS ""num_points"" FROM ""Teams"" WHERE ""team_id"" NOT IN (SELECT ""host_team"" AS ""team_id"" FROM ""matches"" UNION SELECT ""guest_team"" AS ""team_id"" FROM ""matches""))) AS ""tlast"" ORDER BY ""num_points"" DESC,""team_id"""
410,"WITH ""cte"" AS (SELECT ""host_team"",""guest_team"",CASE WHEN ""host_goals"">""guest_goals"" THEN 3 WHEN ""host_goals""=""guest_goals"" THEN 1 ELSE 0 END AS ""host_points"",CASE WHEN ""guest_goals"">""host_goals"" THEN 3 WHEN ""guest_goals""=""host_goals"" THEN 1 ELSE 0 END AS ""guest_points"" FROM ""Matches"") SELECT ""b"".""team_id"" AS ""team_id"",""b"".""team_name"",COALESCE(SUM(""a"".""score""), 0) AS ""num_points"" FROM (SELECT ""host_team"" AS ""team"",""host_points"" AS ""score"" FROM ""cte"" UNION ALL SELECT ""guest_team"" AS ""team"",""guest_points"" AS ""score"" FROM ""cte"") AS ""a"" RIGHT JOIN ""Teams"" AS ""b"" ON ""a"".""team""=""b"".""team_id"" GROUP BY 1,2 ORDER BY 3 DESC,1"
