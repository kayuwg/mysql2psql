id,original query
1,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
2,"SELECT ""ad_id"",ROUND((CASE WHEN ""total_click""=0 AND ""total_view""=0 THEN 0 ELSE 100*""total_click""/(""total_click""+""total_view"") END), 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_click"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_view"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY ""ctr"" DESC,""ad_id"""
3,"SELECT ""ad_id"",COALESCE(ROUND(""c""*100/(""c""+""v""), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM((CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)) AS ""c"",SUM((CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)) AS ""v"" FROM ""ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY 2 DESC,1"
4,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(""action""='Clicked')/SUM(""action""!='Ignored'), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
5,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
6,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""views"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clicks""+""views""=0 THEN 0 ELSE ROUND(""clicks""*100/(""clicks""+""views""), 2) END AS ""ctr"" FROM ""cte"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
7,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
8,"SELECT ""ad_id"",COALESCE(ROUND(100*AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
9,"SELECT ""ad_id"",COALESCE(ROUND((""c""*100/(""c""+""v"")), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY 2 DESC,1"
10,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE ""action"" WHEN 'Clicked' THEN 1 END)/(SUM(CASE ""action"" WHEN 'Clicked' THEN 1 END)+SUM(CASE ""action"" WHEN 'Viewed' THEN 1 ELSE 0 END))*100.0, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
11,"SELECT ""ad_id"",COALESCE(ROUND((""c""*100/(""c""+""v"")), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY 2 DESC,1"
12,"WITH ""ad"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND((""clicked""/(""clicked""+""viewed"")*100), 2), 0) AS ""ctr"" FROM ""ad"" ORDER BY ""ctr"" DESC,""ad_id"""
13,"WITH ""temp"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""num_clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""num_viewed"" FROM ""Ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND(""num_clicked""/(""num_clicked""+""num_viewed"")*100, 2), 0) AS ""ctr"" FROM ""temp"" ORDER BY 2 DESC,1"
14,"SELECT ""ad_id"",ROUND(COALESCE(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""Ads"" WHERE 1=1 GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
15,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
16,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
17,"SELECT ""ad_id"",CASE WHEN SUM(""action""='Clicked' OR ""action""='Viewed')=0 THEN 0 ELSE ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2) END AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
18,"SELECT ""ad_id"",ROUND(CASE WHEN (""num_clicked""+""num_viewed"")=0 THEN 0.00 ELSE 100.0*""num_clicked""/(""num_clicked""+""num_viewed"") END, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""num_clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""num_viewed"" FROM ""Ads"" GROUP BY 1) AS ""a"" ORDER BY ""ctr"" DESC,""ad_id"""
19,"SELECT ""t"".""ad_id"",CASE WHEN ""t"".""num_of_clicks""+""t"".""num_of_views""=0 THEN 0 ELSE ROUND((""t"".""num_of_clicks""*100/(""t"".""num_of_clicks""+""t"".""num_of_views"")), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""num_of_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""num_of_views"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY CASE WHEN ""t"".""num_of_clicks""+""t"".""num_of_views""=0 THEN 0 ELSE ROUND((""t"".""num_of_clicks""*100/(""t"".""num_of_clicks""+""t"".""num_of_views"")), 2) END DESC,""ad_id"""
20,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed'), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
21,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
22,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
23,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')*100/(SUM(""action""='Viewed')+SUM(""action""='Clicked')), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
24,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)=0 THEN 0 ELSE ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)*100, 2) END AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1"
25,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
26,"SELECT ""AD_ID"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
27,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clk"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""vw"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clk""+""vw""!=0 THEN ROUND((""clk""/(""clk""+""vw""))*100, 2) ELSE 0 END AS ""ctr"" FROM ""cte"" ORDER BY ""ctr"" DESC,""ad_id"""
28,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)=0 THEN 0.00 ELSE ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END), 2) END AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
29,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
30,"SELECT ""ad_id"",ROUND(COALESCE(100*AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY ""ctr"" DESC,""ad_id"""
31,"WITH ""ad"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND((""clicked""/(""clicked""+""viewed"")*100), 2), 0) AS ""ctr"" FROM ""ad"" ORDER BY ""ctr"" DESC,""ad_id"""
32,"WITH ""c"" AS (SELECT ""ad_id"",(COUNT(1)) AS ""tc"" FROM ""ads"" WHERE ""action""='clicked' GROUP BY ""ad_id""), ""v"" AS (SELECT ""ad_id"",COUNT(""action"") AS ""tv"" FROM ""ads"" WHERE ""action""='Viewed' GROUP BY ""ad_id"") SELECT DISTINCT ""a"".""ad_id"",CASE WHEN (""c"".""tc"" IS NOT NULL AND ""v"".""tv"" IS NOT NULL) THEN ROUND(""c"".""tc""/(""c"".""tc""+""v"".""tv"")*100, 2) WHEN ""c"".""tc"" IS NULL THEN 0.00 WHEN ""v"".""tv"" IS NULL THEN 100.00 ELSE 0.00 END AS ""ctr"" FROM (""ads"" AS ""a"" LEFT JOIN ""c"" USING (""ad_id"")) LEFT JOIN ""v"" USING (""ad_id"") ORDER BY 2 DESC,1"
33,"WITH ""t1"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""total_clicks""+""total_views""=0 THEN 0 ELSE ROUND(""total_clicks""/(""total_clicks""+""total_views"")*100, 2) END AS ""ctr"" FROM ""t1"" ORDER BY ""ctr"" DESC,""ad_id"""
34,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
35,"SELECT ""ad_id"",ROUND((CASE WHEN ""c""+""v""=0 THEN 0 ELSE ""c""*100/(""c""+""v"") END), 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""A"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
36,"SELECT ""ad_id"",ROUND(COALESCE(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
37,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
38,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
39,"SELECT ""ad_id"",CASE WHEN ""sum_click""=0 THEN 0 ELSE ROUND(100*""sum_click""/(""sum_click""+""sum_view""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(""action_click"") AS ""sum_click"",SUM(""action_view"") AS ""sum_view"" FROM (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""action_click"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""action_view"" FROM ""Ads"") AS ""a"" GROUP BY ""ad_id"") AS ""b"" ORDER BY ""ctr"" DESC,""ad_id"""
40,"WITH ""ad_click_view"" AS (SELECT ""a"".""ad_id"",SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicked"",SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_viewed"" FROM ""Ads"" AS ""a"" GROUP BY ""a"".""ad_id"") SELECT ""ad_id"",CASE WHEN ""total_clicked""+""total_viewed""=0 THEN 0 ELSE (ROUND((""total_clicked""/(""total_clicked""+""total_viewed"")*100), 2)) END AS ""ctr"" FROM ""ad_click_view"" ORDER BY ""ctr"" DESC,""ad_id"""
41,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""!='ignored')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
42,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicking"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewing"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clicking""+""viewing""=0 THEN 0.00 ELSE ROUND(""clicking""/(""clicking""+""viewing"")*100, 2) END AS ""ctr"" FROM ""cte"" ORDER BY ""ctr"" DESC,""ad_id"""
43,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
44,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""!='ignored')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
45,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action"" LIKE 'Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" LIKE 'Clicked' OR ""action"" LIKE 'Viewed' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
46,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
47,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
48,"SELECT ""ad_id"",COALESCE(ROUND((""c""*100/(""c""+""v"")), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY 2 DESC,1"
49,"WITH ""action_count"" AS (SELECT DISTINCT ""a"".""ad_id"",SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""Ads"" AS ""a"" GROUP BY ""a"".""ad_id"") SELECT DISTINCT ""ad_id"",CASE WHEN ""total_clicks""+""total_views""=0 THEN 0 ELSE ROUND((""total_clicks""*100/(""total_clicks""+""total_views"")), 2) END AS ""ctr"" FROM ""action_count"" ORDER BY ""ctr"" DESC,""ad_id"""
50,"SELECT ""ad_id"",(CASE WHEN ""clicks""+""views""=0 THEN 0 ELSE ROUND(""clicks""/(""clicks""+""views"")*100, 2) END) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""views"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
51,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
52,"SELECT ""ad_id"",ROUND(COALESCE(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
53,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END) THEN ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END), 2) ELSE 0 END AS ""ctr"" FROM ""Ads"" AS ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
54,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
55,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
56,"SELECT ""ad_id"",CASE WHEN ""sum_click""=0 THEN 0 ELSE ROUND(100*""sum_click""/(""sum_click""+""sum_view""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(""action_click"") AS ""sum_click"",SUM(""action_view"") AS ""sum_view"" FROM (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""action_click"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""action_view"" FROM ""Ads"") AS ""a"" GROUP BY ""ad_id"") AS ""b"" ORDER BY ""ctr"" DESC,""ad_id"""
57,"SELECT ""ad_id"",CASE WHEN (ROUND(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END))*100, 2)) IS NOT NULL THEN (ROUND(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END))*100, 2)) ELSE 0 END AS ""ctr"" FROM ""Ads"" AS ""a"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
58,"SELECT ""aa"".""ad_id"",ROUND(COALESCE(100*""aa"".""clk""/(""aa"".""clk""+""aa"".""view""), 0), 2) AS ""ctr"" FROM (SELECT *,SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END) AS ""clk"",SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END) AS ""view"" FROM ""Ads"" AS ""a"" GROUP BY ""a"".""ad_id"") AS ""aa"" ORDER BY ""ctr"" DESC,""ad_id"""
59,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
60,"SELECT ""ad_id"",ROUND(COALESCE((""total_clicks""/(""total_clicks""+""total_views""))*100, 0), 2) AS ""CTR"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""ads"" GROUP BY ""ad_id"") AS ""c"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
61,"SELECT ""ad_id"",COALESCE(ROUND((""click""/(""click""+""viewed"")*100), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click"" FROM ""Ads"" GROUP BY 1) AS ""T"" ORDER BY 2 DESC,1"
62,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)!=0 THEN ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2) ELSE 0.00 END AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
63,"SELECT ""ad_id"",COALESCE(ROUND(""click_sum""/""total_sum""*100, 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click_sum"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_sum"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""inner_ads"" ORDER BY ""ctr"" DESC,""ad_id"""
64,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
65,"WITH ""base"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click_count"",SUM(CASE WHEN ""action"" IN ('Viewed','Clicked') THEN 1 ELSE 0 END) AS ""total_count"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND((""click_count""/""total_count"")*100, 2), 0) AS ""ctr"" FROM ""base"" ORDER BY ""ctr"" DESC,""ad_id"""
66,"SELECT ""ad_id"",ROUND(CASE WHEN ""num_cliks""+""num_views""=0 THEN 0 ELSE ""num_cliks""*100/(""num_cliks""+""num_views"") END, 2) AS ""ctr"" FROM (SELECT ""ad_id"",COUNT(CASE WHEN ""action""='Clicked' THEN 1 END) AS ""num_cliks"",COUNT(CASE WHEN ""action""='Viewed' THEN 1 END) AS ""num_views"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""cliks_views"" ORDER BY ""ctr"" DESC,""ad_id"""
67,"SELECT ""ad_id"",CASE WHEN (ROUND(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END))*100, 2)) IS NOT NULL THEN (ROUND(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END))*100, 2)) ELSE 0 END AS ""ctr"" FROM ""Ads"" AS ""a"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
68,"SELECT ""ad_id"",CASE WHEN ""sum_click""=0 THEN 0 ELSE ROUND(100*""sum_click""/(""sum_click""+""sum_view""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(""action_click"") AS ""sum_click"",SUM(""action_view"") AS ""sum_view"" FROM (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""action_click"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""action_view"" FROM ""Ads"") AS ""a"" GROUP BY ""ad_id"") AS ""b"" ORDER BY ""ctr"" DESC,""ad_id"""
69,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""!='ignored')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
70,"SELECT ""a"".""ad_id"",ROUND(CASE WHEN ""a"".""tot_cnt""=0 THEN 0 ELSE ""a"".""clk_cnt""/""a"".""tot_cnt""*100 END, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clk_cnt"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""tot_cnt"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY ""ctr"" DESC,""ad_id"""
71,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)), 0), 4)*100 AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
72,"WITH ""ad"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND((""clicked""/(""clicked""+""viewed"")*100), 2), 0) AS ""ctr"" FROM ""ad"" ORDER BY ""ctr"" DESC,""ad_id"""
73,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
74,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)!=0 THEN ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100.00/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 END), 2) ELSE 0.00 END AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
75,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
76,"SELECT ""ad_id"",COALESCE(ROUND((""click""/(""click""+""viewed"")*100), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click"" FROM ""Ads"" GROUP BY 1) AS ""T"" ORDER BY 2 DESC,1"
77,"SELECT ""ad_id"",ROUND(COALESCE((""clicks""/""total"")*100, 0), 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""table1"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
78,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Ignored' THEN 0 ELSE 1 END)*100, 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1"
79,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
80,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)=0 THEN 0 ELSE ROUND((SUM(CASE WHEN ""action"" IN ('Clicked') THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END))*100, 2) END AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
81,"WITH ""nt"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""Clicked"",SUM(CASE WHEN ""action""='viewed' THEN 1 ELSE 0 END) AS ""Viewed"" FROM ""ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND(""clicked""*100/(""clicked""+""viewed""), 2), 0) AS ""ctr"" FROM ""nt"" ORDER BY ""ctr"" DESC,""ad_id"""
82,"SELECT ""ad_id"",COALESCE(ROUND(COUNT(CASE WHEN ""action""='Clicked' THEN ""user_id"" END)/COUNT(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN ""user_id"" END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
83,"WITH ""stats"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""click_view"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",ROUND(CASE WHEN ""click_view"">0 THEN 100*""click""/""click_view"" ELSE 0 END, 2) AS ""ctr"" FROM ""stats"" ORDER BY ""ctr"" DESC,""ad_id"""
84,"SELECT ""ad_id"",ROUND(100*COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1"
85,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
86,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
87,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
88,"WITH ""ad"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND((""clicked""/(""clicked""+""viewed"")*100), 2), 0) AS ""ctr"" FROM ""ad"" ORDER BY ""ctr"" DESC,""ad_id"""
89,"SELECT ""ad_id"",ROUND(COALESCE(100*SUM(CASE WHEN ""action"" IN ('Clicked') THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
90,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
91,"SELECT ""ad_id"",COALESCE(ROUND(""clicked""/""total""*100, 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
92,"SELECT ""ad_id"",COALESCE(CAST((SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='clicked' OR ""action""='viewed' THEN 1 ELSE 0 END))*100 AS DECIMAL(5, 2)), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY ""ctr"" DESC,""ad_id"""
93,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
94,"WITH ""a1"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total"" FROM ""Ads"" GROUP BY ""ad_id""), ""a2"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""n_clicks"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""a1"".""ad_id"",CASE WHEN ""total"">0 THEN ROUND(""n_clicks""*100/""total"", 2) ELSE 0 END AS ""ctr"" FROM ""a1"" JOIN ""a2"" USING (""ad_id"") ORDER BY ""ctr"" DESC,""a1"".""ad_id"""
95,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
96,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)*100/(SUM(CASE WHEN ""action""='viewed' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
97,"SELECT ""ad_id"",ROUND(CASE WHEN ""total_clicks""+""total_views""=0 THEN 0 ELSE (""total_clicks""*100)/(""total_clicks""+""total_views"") END, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""ads"" GROUP BY 1) AS ""a"" ORDER BY 2 DESC,""ad_id"""
98,"SELECT ""ad_id"",CASE WHEN (ROUND(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END))*100, 2)) IS NOT NULL THEN (ROUND(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""a"".""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""a"".""action""='Viewed' THEN 1 ELSE 0 END))*100, 2)) ELSE 0 END AS ""ctr"" FROM ""Ads"" AS ""a"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
99,"WITH ""ads_pivot"" AS (SELECT ""ad_id"",""user_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"",SUM(CASE WHEN ""action""='Ignored' THEN 1 ELSE 0 END) AS ""ignored"" FROM ""Ads"" GROUP BY ""ad_id"",""user_id"") SELECT ""ad_id"",ROUND(CASE WHEN SUM(""clicked"")+SUM(""viewed"")=0 THEN 0 ELSE (SUM(""clicked"")/(SUM(""clicked"")+SUM(""viewed"")))*100 END, 2) AS ""ctr"" FROM ""ads_pivot"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
100,"SELECT ""ad_id"",COALESCE(ROUND(COUNT(CASE WHEN ""action""='Clicked' THEN 1 ELSE NULL END)/((COUNT(CASE WHEN ""action""='Viewed' THEN 1 ELSE NULL END))+(COUNT(CASE WHEN ""action""='Clicked' THEN 1 ELSE NULL END)))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
101,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
102,"SELECT ""ad_id"",(CASE WHEN (""clicks""+""views"")=0 THEN 0 ELSE ROUND(""clicks""/(""clicks""+""views"")*100, 2) END) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""views"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""Ads2"" ORDER BY ""ctr"" DESC,""ad_id"""
103,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
104,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
105,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Ignored' THEN 0 ELSE 1 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
106,"WITH ""cte1"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_viewed"" FROM ""Ads"" GROUP BY ""ad_id""), ""cte2"" AS (SELECT ""ad_id"",ROUND(((""total_clicked""/(""total_clicked""+""total_viewed""))*100), 2) AS ""ctr"" FROM ""cte1"") SELECT DISTINCT ""a"".""ad_id"",COALESCE(""ctr"", 0) AS ""ctr"" FROM ""Ads"" AS ""a"" LEFT JOIN ""cte2"" ON ""a"".""ad_id""=""cte2"".""ad_id"" ORDER BY COALESCE(""ctr"", 0) DESC,""ad_id"""
107,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='clicked' THEN 1 WHEN ""action""='viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
108,"WITH ""cte"" AS (SELECT *,CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""clicks"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""views"" FROM ""ads"") SELECT ""ad_id"",COALESCE(ROUND(SUM(""clicks"")/(SUM(""clicks"")+SUM(""views""))*100, 2), 0) AS ""ctr"" FROM ""cte"" GROUP BY 1 ORDER BY 2 DESC,1"
109,"WITH ""cte"" AS (SELECT ""ad_id"",COUNT(1) AS ""cnt"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""num_click"" FROM ""Ads"" WHERE ""action""='Clicked' OR ""action""='Viewed' GROUP BY ""ad_id""), ""cte1"" AS (SELECT DISTINCT ""ad_id"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""a"".""ad_id"",ROUND(COALESCE(""b"".""num_click""/""b"".""cnt""*100, 0), 2) AS ""ctr"" FROM ""cte1"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" USING (""ad_id"") ORDER BY 2 DESC,1"
110,"WITH ""click_view"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' OR ""action""='viewed' THEN 1 ELSE 0 END) AS ""click_view"" FROM ""ads"" GROUP BY ""ad_id""), ""click"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""clicked"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""click"".""ad_id"",ROUND(COALESCE(""clicked""/""click_view""*100, 0), 2) AS ""ctr"" FROM ""click_view"" JOIN ""click"" ON ""click_view"".""ad_id""=""click"".""ad_id"" GROUP BY ""click"".""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
111,"WITH ""ctr"" AS (SELECT ""ad_id"",ROUND(CASE WHEN SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)=0 THEN 0 ELSE SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100 END, 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,""ad_id"") SELECT * FROM ""ctr"""
112,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored'))*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
113,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
114,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click_num"",SUM(CASE WHEN ""action""='Viewed' OR ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_num"" FROM ""ads"" GROUP BY 1) SELECT ""ad_id"",ROUND(CASE WHEN ""total_num""=0 THEN 0 ELSE ""click_num""/""total_num"" END*100, 2) AS ""ctr"" FROM ""cte"" ORDER BY 2 DESC,1"
115,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Ignored' THEN 0 ELSE 1 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1"
116,"SELECT ""ad_id"",COALESCE(ROUND(""clicked""/(""clicked""+""viewed"")*100, 2), 0.0) AS ""ctr"" FROM (SELECT SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"",""ad_id"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""xx"" ORDER BY ""ctr"" DESC,""ad_id"""
117,"SELECT ""ad_id"",ROUND(""ctr"", 2) AS ""ctr"" FROM (SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action""='clicked' OR ""action""='Viewed' THEN 1.00 ELSE 0.00 END)=0.00 THEN 0.00 ELSE (SUM(CASE WHEN ""action""='clicked' THEN 1.0 ELSE 0.0 END)/SUM(CASE WHEN ""action""='clicked' OR ""action""='Viewed' THEN 1.0 ELSE 0.0 END))*100 END AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY ""ctr"" DESC,""ad_id"""
118,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
119,"SELECT ""tb"".""ad_id"",ROUND(CASE WHEN ""clicks""=0 THEN 0 ELSE ""clicks""/""impressions"" END*100, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""impressions"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""tb"" ORDER BY ROUND(CASE WHEN ""clicks""=0 THEN 0 ELSE ""clicks""/""impressions"" END*100, 2) DESC,""ad_id"""
120,"WITH ""foo"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""cnt_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""cnt_views"",ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100, 2) AS ""ctr2"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""cnt_clicks""+""cnt_views""=0 THEN 0 ELSE ROUND(""cnt_clicks""/(""cnt_clicks""+""cnt_views"")*100, 2) END AS ""ctr"" FROM ""foo"" ORDER BY ""ctr"" DESC,""ad_id"""
121,"WITH ""t1"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""total_clicks""+""total_views""=0 THEN 0 ELSE ROUND(""total_clicks""/(""total_clicks""+""total_views"")*100, 2) END AS ""ctr"" FROM ""t1"" ORDER BY ""ctr"" DESC,""ad_id"""
122,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""Clicked"")*100/(SUM(""Clicked"")+SUM(""Viewed"")), 0), 2) AS ""ctr"" FROM (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""Clicked"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""Viewed"",CASE WHEN ""action""='Ignored' THEN 1 ELSE 0 END AS ""Ignored"" FROM ""Ads"") AS ""sub"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
123,"SELECT DISTINCT ""ads"".""ad_id"",COALESCE(""summary"".""ctr"", 0) AS ""ctr"" FROM ""ads"" LEFT JOIN (SELECT ""ad_id"",ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/COUNT(""action"")*100, 2) AS ""ctr"" FROM ""ads"" WHERE ""action""!='Ignored' GROUP BY ""ad_id"") AS ""summary"" ON ""ads"".""ad_id""=""summary"".""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
124,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
125,"SELECT ""ad_id"",CASE WHEN (""clicked""+""viewed"")=0 THEN 0 ELSE ROUND(100*""clicked""/(""clicked""+""viewed""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY 1) AS ""temp"" ORDER BY ""ctr"" DESC,1"
126,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""!='Ignored'))*100, 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
127,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
128,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
129,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
130,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
131,"SELECT ""ad_id"",ROUND(CASE WHEN ""click_cnt""+""view_cnt""=0 THEN 0 ELSE ""click_cnt""*100/(""click_cnt""+""view_cnt"") END, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""click_cnt"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""view_cnt"" FROM ""ads"" GROUP BY ""ad_id"") AS ""x"" ORDER BY ""ctr"" DESC,""ad_id"""
132,"SELECT ""ad_id"",ROUND(COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END), 4)*100, 0), 5) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
133,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='clicked')/SUM(""action""='clicked' OR ""action""='viewed')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
134,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
135,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
136,"SELECT ""ad_id"",ROUND(COALESCE(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""Ads"" WHERE 1=1 GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
137,"SELECT ""ad_id"",ROUND(COALESCE(""clickedSum""/""viewedSum""*100, 0), 2) AS ""ctr"" FROM (SELECT DISTINCT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) OVER (PARTITION BY ""ad_id"") AS ""clickedSum"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) OVER (PARTITION BY ""ad_id"") AS ""viewedSum"" FROM ""Ads"") AS ""sub"" ORDER BY ""ctr"" DESC,""ad_id"""
138,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
139,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Viewed','Clicked') THEN 1 ELSE 0 END)*100), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
140,"SELECT ""ad_id"",ROUND(COALESCE(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
141,"WITH ""table1"" AS (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""is_clicked"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""is_viewed"" FROM ""ads"") SELECT ""ad_id"",ROUND(100*COALESCE(SUM(""is_clicked"")/(SUM(""is_clicked"")+SUM(""is_viewed"")), 0), 2) AS ""ctr"" FROM ""table1"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
142,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""numerator"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""denominator"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(((""numerator""/""denominator"")*100), 2), 0.00) AS ""ctr"" FROM ""cte"" ORDER BY ""ctr"" DESC,""ad_id"""
143,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
144,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='clicked')/SUM(""action""='clicked' OR ""action""='viewed')*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
145,"SELECT ""ad_id"",CASE WHEN ""clicked_count""+""viewed_count""=0 THEN 0.00 ELSE ROUND((""clicked_count""/(""clicked_count""+""viewed_count""))*100, 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked_count"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed_count"" FROM ""ads"" GROUP BY ""ad_id"") AS ""tempt"" ORDER BY ""ctr"" DESC,""ad_id"""
146,"SELECT ""otr"".""ad_id"",ROUND(COALESCE((""otr"".""cnt""/(""otr"".""cnt""+""otr"".""v_cnt"")*100), 0), 2) AS ""ctr"" FROM (SELECT ""c"".""ad_id"",""c"".""cnt"",COALESCE(""v"".""cnt"", 0) AS ""v_cnt"" FROM (SELECT ""ad_id"",""action"",COUNT(1) AS ""cnt"" FROM ""Ads"" WHERE ""action"" IN ('Clicked') GROUP BY ""ad_id"",""action"" ORDER BY ""ad_id"") AS ""c"" LEFT JOIN (SELECT ""ad_id"",""action"",COUNT(1) AS ""cnt"" FROM ""Ads"" WHERE ""action"" IN ('Viewed') GROUP BY ""ad_id"",""action"" ORDER BY ""ad_id"") AS ""v"" ON ""c"".""ad_id""=""v"".""ad_id"" UNION SELECT ""v"".""ad_id"",0 AS ""cnt"",0 AS ""v_cnt"" FROM (SELECT ""ad_id"",""action"",COUNT(1) AS ""cnt"" FROM ""Ads"" WHERE ""action"" IN ('Clicked') GROUP BY ""ad_id"",""action"" ORDER BY ""ad_id"") AS ""c"" RIGHT JOIN (SELECT ""ad_id"",""action"",COUNT(1) AS ""cnt"" FROM ""Ads"" WHERE ""action"" IN ('Viewed') GROUP BY ""ad_id"",""action"" ORDER BY ""ad_id"") AS ""v"" ON ""c"".""ad_id""=""v"".""ad_id"" WHERE ""c"".""ad_id"" IS NULL) AS ""otr"" UNION SELECT ""ad_id"",ROUND(0, 2) FROM ""Ads"" WHERE ""action"" IN ('Ignored') AND ""ad_id"" NOT IN (SELECT ""ad_id"" FROM ""Ads"" WHERE ""action""='Clicked' OR (""action""='Clicked' AND ""action""='Viewed')) ORDER BY ""ctr"" DESC,""ad_id"""
147,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
148,"SELECT ""ad_id"",CASE WHEN ""clicks""+""views""=0 THEN 0 ELSE ROUND((""clicks""/(""clicks""+""views""))*100, 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""views"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
149,"SELECT ""ad_id"",CASE WHEN ""total_clicks""+""total_views""=0 THEN 0.00 ELSE ROUND(""total_clicks""/(""total_clicks""+""total_views"")*100, 2) END AS ""ctr"" FROM (SELECT DISTINCT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) OVER (PARTITION BY ""ad_id"") AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) OVER (PARTITION BY ""ad_id"") AS ""total_views"" FROM ""Ads"") AS ""a"" ORDER BY ""ctr"" DESC,""ad_id"""
150,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
151,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
152,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action"" IN ('clicked','viewed') THEN 1 ELSE 0 END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
153,"SELECT ""ad_id"",COALESCE(ROUND(""c""/(""c""+""v"")*100, 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""temp"" ORDER BY ""ctr"" DESC,""ad_id"""
154,"WITH ""tb"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(""clicked""/(""clicked""+""viewed"")*100, 2), 0) AS ""ctr"" FROM ""tb"" ORDER BY ""ctr"" DESC,""ad_id"""
155,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
156,"WITH ""t"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clk_num"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""view_num"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",ROUND((CASE WHEN ""clk_num""+""view_num""=0 THEN 0 ELSE ""clk_num""/(""clk_num""+""view_num"") END)*100, 2) AS ""ctr"" FROM ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
157,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
158,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
159,"WITH ""temp"" AS (SELECT ""ad_id"",""user_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""clicked"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""viewed"" FROM ""Ads"") SELECT ""ad_id"",ROUND(COALESCE(SUM(""clicked"")/(SUM(""clicked"")+SUM(""viewed"")), 0)*100, 2) AS ""ctr"" FROM ""temp"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
160,"SELECT ""ad_id"",COALESCE(ROUND(100*COUNT(CASE WHEN ""action""='Clicked' THEN ""user_id"" END)/COUNT(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN ""user_id"" END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
161,"SELECT ""ad_id"",CASE WHEN COUNT(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN ""user_id"" ELSE NULL END)=0 THEN 0 ELSE ROUND(COUNT(CASE WHEN ""action"" IN ('Clicked') THEN ""user_id"" ELSE NULL END)/COUNT(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN ""user_id"" ELSE NULL END)*100, 2) END AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
162,"SELECT ""ad_id"",ROUND(COALESCE(100.0*SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed'), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
163,"SELECT DISTINCT ""e"".""ad_id"",ROUND(COALESCE(""c""/""d""*100, 0), 2) AS ""ctr"" FROM (""ads"" AS ""e"" LEFT JOIN (SELECT ""ad_id"",COUNT(""user_id"") AS ""c"" FROM ""ads"" WHERE ""action""='Clicked' GROUP BY ""ad_id"") AS ""a"" ON ""e"".""ad_id""=""a"".""ad_id"") LEFT JOIN (SELECT ""ad_id"",COUNT(""user_id"") AS ""d"" FROM ""ads"" WHERE ""action""='Clicked' OR ""action""='Viewed' GROUP BY ""ad_id"") AS ""b"" ON ""a"".""ad_id""=""b"".""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
164,"SELECT ""ad_id"",COALESCE(ROUND(COUNT(CASE WHEN ""action""='Clicked' THEN 1 ELSE NULL END)*100/COUNT(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE NULL END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
165,"SELECT ""ad_id"",COALESCE(ROUND((""c""*100/(""c""+""v"")), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY 2 DESC,1"
166,"SELECT ""ad_id"",COALESCE(ROUND(100*(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
167,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
168,"SELECT ""ad_id"",CASE WHEN ""action_click""=0 AND ""action_view""=0 THEN 0 ELSE ROUND(100*""action_click""/(""action_click""+""action_view""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""action_click"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""action_view"" FROM ""Ads"" GROUP BY 1) AS ""t"" ORDER BY 2 DESC,1"
169,"SELECT ""ad_id"",CASE WHEN ""clicked""+""viewed""=0 THEN 0 ELSE ROUND((""clicked""/(""clicked""+""viewed""))*100, 2) END AS ""CTR"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"",SUM(CASE WHEN ""action""='Ignored' THEN 1 ELSE 0 END) AS ""ignored"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY ""CTR"" DESC,""ad_id"""
170,"SELECT ""t3"".""ad_id"",ROUND(COALESCE(""total_click""/""total_view""*100, 0), 2) AS ""ctr"" FROM ((SELECT DISTINCT ""ad_id"" FROM ""ads"") AS ""t3"" LEFT JOIN (SELECT ""ad_id"",COALESCE(COUNT(1), 0) AS ""total_view"" FROM ""ads"" WHERE ""action"" IN ('Clicked','Viewed') GROUP BY 1) AS ""t1"" ON ""t3"".""ad_id""=""t1"".""ad_id"") LEFT JOIN (SELECT ""ad_id"",COALESCE(COUNT(1), 0) AS ""total_click"" FROM ""ads"" WHERE ""action""='Clicked' GROUP BY 1) AS ""t2"" ON ""t1"".""ad_id""=""t2"".""ad_id"" ORDER BY ""ctr"" DESC,1"
171,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
172,"SELECT ""ad_id"",COALESCE(ROUND(100*AVG((""action""='Clicked')/(""action""='Clicked' OR ""action""='Viewed')), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
173,"WITH ""tmp"" AS (SELECT ""ad_id"",""action"",COUNT(1) AS ""num"" FROM ""ads"" WHERE ""action""!='Ignored' GROUP BY 1,2), ""cte"" AS (SELECT *,SUM(""num"") OVER (PARTITION BY ""ad_id"") AS ""total"" FROM ""tmp""), ""cte1"" AS (SELECT ""ad_id"",""num"",""total"" FROM ""cte"" WHERE ""action""='Clicked'), ""unique_id"" AS (SELECT DISTINCT ""ad_id"" FROM ""ads""), ""cte2"" AS (SELECT ""ad_id"",ROUND(""num""*100/""total"", 2) AS ""ctr"" FROM ""cte1""), ""res"" AS (SELECT ""a"".""ad_id"",""b"".""ctr"" FROM ""unique_id"" AS ""a"" LEFT JOIN ""cte2"" AS ""b"" ON ""a"".""ad_id""=""b"".""ad_id"") SELECT ""ad_id"",CASE WHEN ""ctr"" IS NOT NULL THEN ""ctr"" ELSE 0.00 END AS ""ctr"" FROM ""res"" ORDER BY ""ctr"" DESC,""ad_id"""
174,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
175,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
176,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
177,"WITH ""t"" AS (SELECT ""ad_id"",SUM(""action""='Clicked') AS ""n_click"",SUM(""action""='Viewed') AS ""n_view"" FROM ""Ads"" GROUP BY 1) SELECT ""ad_id"",COALESCE(ROUND((""n_click""/(""n_click""+""n_view""))*100, 2), 0) AS ""ctr"" FROM ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
178,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
179,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
180,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
181,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100, 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
182,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
183,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1"
184,"SELECT ""ad_id"",ROUND((CASE WHEN SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)=0 THEN 0 ELSE SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)*100 END), 2) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
185,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
186,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY ""ctr"" DESC,1"
187,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""ClickCnt"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""ViewCnt"" FROM ""Ads"" GROUP BY ""ad_id""), ""cte1"" AS (SELECT ""ad_id"",CASE WHEN ""ClickCnt""+""ViewCnt""=0 THEN 0 ELSE ROUND(100*""ClickCnt""/(""ClickCnt""+""ViewCnt""), 2) END AS ""ctr"" FROM ""cte"") SELECT * FROM ""cte1"" ORDER BY ""ctr"" DESC,""ad_id"""
188,"SELECT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
189,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed')), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
190,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
191,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
192,"SELECT ""ad_id"",CASE WHEN (""clicked""+""viewed"")=0 THEN 0 ELSE ROUND(100*""clicked""/(""clicked""+""viewed""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY 1) AS ""temp"" ORDER BY ""ctr"" DESC,1"
193,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
194,"SELECT ""ad_id"",(CASE WHEN ROUND(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='viewed' THEN 1 ELSE 0 END))*100, 2) IS NULL THEN 0.00 ELSE ROUND(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='viewed' THEN 1 ELSE 0 END))*100, 2) END) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY (CASE WHEN ROUND(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='viewed' THEN 1 ELSE 0 END))*100, 2) IS NULL THEN 0.00 ELSE ROUND(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='viewed' THEN 1 ELSE 0 END))*100, 2) END) DESC,""ad_id"""
195,"SELECT ""ad_id"",COALESCE(ROUND(""total_clicks""*100/(""total_clicks""+""total_views""), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY 2 DESC,1"
196,"SELECT ""ad_id"",ROUND(CASE WHEN ""ad_click""+""ad_view""=0 THEN 0 ELSE ""ad_click""/(""ad_click""+""ad_view"") END*100, 2) AS ""ctr"" FROM (SELECT ""ad_id"",COUNT(CASE WHEN ""action""='Clicked' THEN ""user_id"" ELSE NULL END) AS ""ad_click"",COUNT(CASE WHEN ""action""='Viewed' THEN ""user_id"" ELSE NULL END) AS ""ad_view"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""temp"" ORDER BY ""ctr"" DESC,""ad_id"""
197,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
198,"SELECT ""ad_id"",CASE WHEN (""total_views""=0 AND ""clicked""=0) THEN 0 ELSE ROUND(""clicked""*100/(""total_views""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action"" IN ('Viewed','Clicked') THEN 1 ELSE 0 END) AS ""total_views"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"" FROM ""Ads"" GROUP BY 1) AS ""x"" ORDER BY ""ctr"" DESC,""ad_id"""
199,"SELECT ""ad_id"",ROUND(COALESCE(100.0*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
200,"SELECT ""ad_id"",COALESCE(ROUND(COUNT(CASE WHEN ""action""='Clicked' THEN 1 END)/(COUNT(CASE WHEN ""action""='Clicked' THEN 1 END)+COUNT(CASE WHEN ""action""='Viewed' THEN 1 END))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
201,"WITH ""ad_ids"" AS (SELECT DISTINCT (""ad_id"") AS ""ad_id"" FROM ""Ads""), ""ad_ctr"" AS (SELECT ""ad_id"",""action"",ROUND(""action_count""/""total_count""*100, 2) AS ""ctr"" FROM (SELECT ""ad_id"",""action"",""action_count"",SUM(""action_count"") OVER (PARTITION BY ""ad_id"") AS ""total_count"" FROM (SELECT ""Ads"".""ad_id"",""Ads"".""action"",COUNT(DISTINCT (""user_id"")) AS ""action_count"" FROM ""Ads"" WHERE ""action""='Viewed' OR ""action""='Clicked' GROUP BY ""ad_id"",""Ads"".""action"") AS ""t1"") AS ""t2"" WHERE ""action""='Clicked' GROUP BY ""ad_id"",""ctr"") SELECT ""ad_ids"".""ad_id"",COALESCE(""ctr"", 0.00) AS ""ctr"" FROM ""ad_ids"" LEFT JOIN ""ad_ctr"" ON ""ad_ids"".""ad_id""=""ad_ctr"".""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
202,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
203,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
204,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
205,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
206,"SELECT ""ad_id"" AS ""ad_id"",COALESCE(ROUND(AVG(100*(""ACTION""='Clicked')/(""ACTION""!='Ignored')), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_ID"""
207,"SELECT ""ad_id"",COALESCE(ROUND((""clicked""/(""clicked""+""viewed"")*100), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY ""ad_id"") AS ""b"" ORDER BY ""ctr"" DESC,""ad_id"""
208,"SELECT ""ad_id"",COALESCE(ROUND((1*SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
209,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""click_only"")/SUM(""click_or_view"")*100, 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click_only"",(CASE WHEN ""action""='Ignored' THEN 0 ELSE 1 END) AS ""click_or_view"" FROM ""ads"") AS ""temp1"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
210,"SELECT ""ad_id"" AS ""ad_id"",COALESCE(ROUND(100*(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,""ad_id"""
211,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
212,"SELECT ""ad_id"",COALESCE(ROUND((""c""*100/(""c""+""v"")), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY 2 DESC,1"
213,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100)/(SUM(CASE WHEN ""action""='Clicked' OR ""action""='viewed' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
214,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
215,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 0), 2) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY ""ctr"" DESC,""ad_id"""
216,"SELECT ""ad_id"",CASE WHEN (""clicked""+""viewed"")=0 THEN 0 ELSE ROUND(""clicked""*100.00/(""clicked""+""viewed""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY 2 DESC,1"
217,"SELECT ""ad_id"",CASE WHEN SUM(""action""!='Ignored')=0 THEN 0 ELSE ROUND(SUM(""action""='Clicked')*100/SUM(""action""!='Ignored'), 2) END AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
218,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
219,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
220,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/(SUM(""action""='Clicked')+SUM(""action""='Viewed')), 0.00), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ROUND(COALESCE(SUM(""action""='Clicked')*100/(SUM(""action""='Clicked')+SUM(""action""='Viewed')), 0.00), 2) DESC,""ad_id"""
221,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action"" IN ('Clicked','Viewed')))*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
222,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
223,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
224,"SELECT DISTINCT ""f1"".""ad_id"",ROUND((CASE WHEN ""c_num"" IS NULL AND ""v_num"" IS NULL THEN 0 WHEN ""c_num"" IS NULL AND ""v_num"" IS NOT NULL THEN 0 WHEN ""c_num"" IS NOT NULL AND ""v_num"" IS NULL THEN 1 ELSE ""c_num""/(""c_num""+""v_num"") END*100), 2) AS ""ctr"" FROM ((SELECT ""ad_id"" FROM ""ads"") AS ""f1"" LEFT JOIN (SELECT ""ad_id"",COUNT(""action"") AS ""c_num"" FROM ""ads"" GROUP BY ""ad_id"",""action"" HAVING ""action""='clicked') AS ""f2"" ON ""f1"".""ad_id""=""f2"".""ad_id"") LEFT JOIN (SELECT ""ad_id"",COUNT(""action"") AS ""v_num"" FROM ""ads"" GROUP BY ""ad_id"",""action"" HAVING ""action""='viewed') AS ""f3"" ON ""f1"".""ad_id""=""f3"".""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
225,"SELECT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)!=0 THEN ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2) ELSE 0.00 END AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
226,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
227,"SELECT ""ad_id"",COALESCE(ROUND(COUNT(CASE WHEN ""action""='Clicked' THEN 1 END)/COUNT(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 END)*100, 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
228,"WITH ""cte"" AS (SELECT ""ad_id"",ROUND(CASE WHEN SUM(""ccount""+""vcount"")=0 THEN 0 ELSE ((""ccount""/(""ccount""+""vcount""))*100) END, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""ccount"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""vcount"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""sq"" GROUP BY ""ad_id"") SELECT ""ad_id"",""ctr"" FROM ""cte"" ORDER BY ""ctr"" DESC,""ad_id"""
229,"ERROR: mysql parse error: line 1 column 269 near ""t1 LEFT JOIN (SELECT ad_id, COUNT(action) AS clicked FROM Ads WHERE action = 'Clicked' GROUP BY ad_id) t2 ON t1.ad_id = t2.ad_id LEFT JOIN (SELECT ad_id, COUNT(action) AS viewed FROM Ads WHERE action = 'Viewed' GROUP BY ad_id) t3 ON t2.ad_id = t3.ad_id) ORDER BY ctr DESC, ad_id"" "
230,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
231,"WITH ""tmp"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(""clicked""/(""clicked""+""viewed"")*100, 2), 0) AS ""ctr"" FROM ""tmp"" ORDER BY ""ctr"" DESC,""ad_id"""
232,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
233,"SELECT ""ad_id"",ROUND(CASE WHEN ""ad_click""+""ad_view""=0 THEN 0 ELSE ""ad_click""/(""ad_click""+""ad_view"") END*100, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""ad_click"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""ad_view"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""temp"" ORDER BY ""ctr"" DESC,""ad_id"""
234,"WITH ""CTE_CV"" AS (SELECT ""ad_id"" AS ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""cl_cnt"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""vw_cnt"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND((""cl_cnt""/(""cl_cnt""+""vw_cnt""))*100, 2), 0) AS ""ctr"" FROM ""CTE_CV"" ORDER BY 2 DESC,1"
235,"SELECT ""ad_id"",ROUND(""ctr"", 2) AS ""ctr"" FROM (SELECT ""ad_id"",COALESCE(SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100, 0) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1) AS ""a"""
236,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
237,"SELECT ""ad_id"",COALESCE(ROUND(100*AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
238,"SELECT ""ad_id"",CASE WHEN ""sub_ctr"" IS NULL THEN 0 ELSE ""sub_ctr"" END AS ""ctr"" FROM (SELECT ""ad_id"",ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2) AS ""sub_ctr"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""sub"" ORDER BY ""ctr"" DESC,""ad_id"""
239,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Viewed' OR ""action""='Clicked' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
240,"SELECT ""ad_id"",ROUND((CASE WHEN ""clicked""+""viewed""=0 THEN 0 ELSE ""clicked""/(""clicked""+""viewed"") END)*100, 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY 1) AS ""t"" ORDER BY 2 DESC,1"
241,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
242,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='CLicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""clickView"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clickView""=0 THEN 0.00 ELSE ROUND(""clicks""*100/""clickView"", 2) END AS ""ctr"" FROM ""cte"" ORDER BY CASE WHEN ""clickView""=0 THEN 0.00 ELSE ROUND(""clicks""*100/""clickView"", 2) END DESC,""ad_id"""
243,"WITH ""cte"" AS (SELECT ""ad_id"",ROUND(100*SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""ctr"" FROM ""Ads"" WHERE ""action"" IN ('Clicked','Viewed') GROUP BY 1 ORDER BY ""ctr"" DESC) SELECT ""a"".""ad_id"",COALESCE(AVG(""b"".""ctr""), 0) AS ""ctr"" FROM ""Ads"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""ad_id""=""b"".""ad_id"" GROUP BY 1 ORDER BY ""ctr"" DESC,""ad_id"""
244,"SELECT ""ad_id"",COALESCE(ROUND(100*SUM(""action""='Clicked')/SUM(""action""!='Ignored'), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
245,"WITH ""temp"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""Clickedcount"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""Viewedcount"",SUM(CASE WHEN ""action""='Ignored' THEN 0 ELSE 0 END) AS ""Ignoredcount"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(""Clickedcount""*100/(""Clickedcount""+""Viewedcount""), 2), 0) AS ""ctr"" FROM ""temp"" ORDER BY ""ctr"" DESC,""ad_id"""
246,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY ""ctr"" DESC,1"
247,"WITH ""cte1"" AS (SELECT ""ad_id"",COUNT(1) AS ""c1"" FROM ""Ads"" WHERE ""action""='Clicked' OR ""action""='Viewed' GROUP BY ""ad_id""), ""cte2"" AS (SELECT ""ad_id"",COUNT(1) AS ""c2"" FROM ""Ads"" WHERE ""action""='Clicked' GROUP BY ""ad_id"") SELECT DISTINCT ""b"".""ad_id"",COALESCE(""ctr"", 0) AS ""ctr"" FROM (SELECT ""cte1"".""ad_id"",ROUND(100*""c2""/""c1"", 2) AS ""ctr"" FROM ""cte1"" JOIN ""cte2"" ON ""cte1"".""ad_id""=""cte2"".""ad_id"") AS ""a"" RIGHT JOIN (SELECT DISTINCT ""ad_id"" FROM ""Ads"") AS ""b"" USING (""ad_id"") ORDER BY ""ctr"" DESC,""ad_id"""
248,"SELECT ""ad_id"",COALESCE(ROUND(100*""click_count""/(""click_count""+""view_count""), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click_count"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""view_count"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""temp"" ORDER BY ""ctr"" DESC,""ad_id"""
249,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)))*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
250,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
251,"WITH ""table1"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicksc"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewsc"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",(CASE ""clicksc""+""viewsc"" WHEN 0 THEN 0 ELSE ROUND(""clicksc""*100/(""clicksc""+""viewsc""), 2) END) AS ""ctr"" FROM ""table1"" ORDER BY ""ctr"" DESC,""ad_id"""
252,"SELECT ""ad_id"",ROUND(COALESCE(""count_clicks""*100/(""count_views""+""count_clicks""), 0), 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(""action""='Viewed') AS ""count_views"",SUM(""action""='Clicked') AS ""count_clicks"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""sub"" ORDER BY ""ctr"" DESC,""ad_id"""
253,"SELECT ""ad_id"",COALESCE(ROUND(((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END))/((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END))+(SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
254,"WITH ""tmp"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(""clicked""/(""clicked""+""viewed"")*100, 2), 0) AS ""ctr"" FROM ""tmp"" ORDER BY ""ctr"" DESC,""ad_id"""
255,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100)/(SUM(CASE WHEN ""action""='Clicked' OR ""action""='viewed' THEN 1 ELSE 0 END)), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
256,"SELECT ""ad_id"",CASE WHEN ""count_click""=0 AND ""count_view""=0 THEN 0 ELSE ROUND((""count_click""*100/(""count_click""+""count_view"")), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""count_click"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""count_view"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""new"" ORDER BY ""ctr"" DESC,""ad_id"""
257,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END)*100, 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
258,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
259,"SELECT ""ad_id"",ROUND((CASE WHEN SUM(CASE WHEN ""action"" LIKE 'Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)=0 THEN 0 ELSE SUM(CASE WHEN ""action"" LIKE 'Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) END), 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
260,"WITH ""temp"" AS (SELECT ""ad_id"",COUNT(""user_id"") AS ""count1"" FROM ""Ads"" WHERE ""action""!='Ignored' GROUP BY 1), ""temp2"" AS (SELECT ""ad_id"",COUNT(DISTINCT ""user_id"") AS ""count2"" FROM ""Ads"" WHERE ""action""='Clicked' GROUP BY 1) SELECT ""a"".""ad_id"",ROUND(COALESCE((""temp2"".""count2""/""temp"".""count1"")*100, 0), 2) AS ""ctr"" FROM (""Ads"" AS ""a"" LEFT JOIN ""temp"" USING (""ad_id"")) LEFT JOIN ""temp2"" USING (""ad_id"") GROUP BY 1 ORDER BY ""ctr"" DESC,1"
261,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
262,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clk"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""vw"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clk""+""vw""!=0 THEN ROUND((""clk""/(""clk""+""vw""))*100, 2) ELSE 0 END AS ""ctr"" FROM ""cte"" ORDER BY ""ctr"" DESC,""ad_id"""
263,"SELECT ""ad_id"",(CASE WHEN ""clicks""+""views""=0 THEN 0 ELSE ROUND(""clicks""/(""clicks""+""views"")*100, 2) END) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""views"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
264,"WITH ""base"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_exposure"" FROM ""Ads"" GROUP BY 1) SELECT ""ad_id"",ROUND(CASE WHEN ""total_exposure""=0 THEN 0 ELSE (""total_clicks""/""total_exposure"")*100 END, 2) AS ""ctr"" FROM ""base"" ORDER BY 2 DESC,1"
265,"SELECT ""ad_id"",ROUND(COALESCE((""total_clicked""/(""total_clicked""+""total_viewed""))*100, 0.00), 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_viewed"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""a"" ORDER BY ""ctr"" DESC,""ad_id"""
266,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
267,"SELECT ""ad_id"",ROUND(COALESCE(COUNT(CASE WHEN ""action"" IN ('Clicked') THEN ""user_id"" END)/COUNT(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN ""user_id"" END), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,""ad_id"""
268,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Viewed' THEN 1 WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,""ad_id"""
269,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action""!='Ignored')), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
270,"SELECT ""ad_id"",ROUND(CASE WHEN SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)=0 THEN 0 ELSE SUM(CASE WHEN ""action"" IN ('Clicked') THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)*100 END, 2) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY 2 DESC,1"
271,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
272,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
273,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
274,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""Clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""Viewed"" FROM ""Ads"" GROUP BY 1) SELECT ""ad_id"",ROUND(CASE WHEN ""Clicked""+""Viewed""=0 THEN 0 ELSE 100*""Clicked""/(""Clicked""+""Viewed"") END, 2) AS ""ctr"" FROM ""cte"" ORDER BY 2 DESC,1"
275,"SELECT DISTINCT ""t1"".""ad_id"",CASE WHEN ""t2"".""action"" IS NULL AND ""t3"".""action"" IS NULL THEN 0.00 WHEN ""t2"".""action"" IS NOT NULL AND ""t3"".""action"" IS NULL THEN 100.00 WHEN ""t2"".""action"" IS NULL AND ""t3"".""action"" IS NOT NULL THEN 0.00 ELSE ROUND(""t2"".""ct""/(""t2"".""ct""+""t3"".""ct"")*100, 2) END AS ""ctr"" FROM (""Ads"" AS ""t1"" LEFT JOIN (SELECT ""ad_id"",""action"",COUNT(""user_id"") AS ""ct"" FROM ""Ads"" WHERE ""action""='Clicked' GROUP BY ""ad_id"",""action"") AS ""t2"" ON ""t1"".""ad_id""=""t2"".""ad_id"") LEFT JOIN (SELECT ""ad_id"",""action"",COUNT(""user_id"") AS ""ct"" FROM ""Ads"" WHERE ""action""='Viewed' GROUP BY ""ad_id"",""action"") AS ""t3"" ON ""t1"".""ad_id""=""t3"".""ad_id"" ORDER BY ""ctr"" DESC,""t1"".""ad_id"""
276,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
277,"SELECT DISTINCT ""ad_id"",ROUND(COALESCE((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 1 ELSE 0 END)), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
278,"WITH ""clicked_and_viewed_per_ad"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clicked""+""viewed""=0 THEN 0 ELSE ROUND(""clicked""*100.0/(""clicked""+""viewed""), 2) END AS ""ctr"" FROM ""clicked_and_viewed_per_ad"" ORDER BY ""ctr"" DESC,""ad_id"""
279,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
280,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
281,"WITH ""cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""tot_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""tot_views"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",ROUND(COALESCE(""tot_clicks""/(""tot_clicks""+""tot_views"")*100, 0), 2) AS ""ctr"" FROM ""cte"" ORDER BY ""ctr"" DESC,""ad_id"""
282,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
283,"SELECT ""ad_id"",ROUND(COALESCE(""clicks""/""total""*100, 0), 2) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicks"",SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total"" FROM ""ads"" GROUP BY ""ad_id"") AS ""tb2"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
284,"WITH ""temp"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""clicked""+""viewed""=0 THEN 0 ELSE ROUND((""clicked""/(""clicked""+""viewed""))*100, 2) END AS ""ctr"" FROM ""temp"" ORDER BY ""ctr"" DESC,""ad_id"""
285,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
286,"WITH ""t"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",ROUND(COALESCE(""clicked""/(""clicked""+""viewed"")*100, 0), 2) AS ""ctr"" FROM ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
287,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
288,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
289,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
290,"SELECT ""ad_id"",ROUND(CASE WHEN SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)=0 THEN 0 ELSE SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100 END, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
291,"SELECT ""ad_id"",ROUND(COALESCE(100*(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY ""ctr"" DESC,""ad_id"""
292,"SELECT ""ad_id"",COALESCE(ROUND(100*COUNT(CASE WHEN ""action""='clicked' THEN ""action"" ELSE NULL END)/COUNT(CASE WHEN ""action""='clicked' OR ""action""='viewed' THEN ""action"" ELSE NULL END), 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
293,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
294,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
295,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
296,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
297,"WITH ""ads_totals"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END) AS ""clicked_or_viewed"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(100*(""clicked""/""clicked_or_viewed""), 2), 0) AS ""ctr"" FROM ""ads_totals"" ORDER BY ""ctr"" DESC,""ad_id"""
298,"WITH ""click_view"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND(100*""clicked""/(""clicked""+""viewed""), 2), 0) AS ""ctr"" FROM ""click_view"" ORDER BY ""ctr"" DESC,""ad_id"""
299,"WITH ""temp"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END) AS ""denumerator"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""numerator"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""temp"".""ad_id"",CASE WHEN ""denumerator""=0 THEN 0.00 ELSE ROUND(100.00*""numerator""/""denumerator"", 2) END AS ""ctr"" FROM ""temp"" ORDER BY 2 DESC,""temp"".""ad_id"""
300,"SELECT ""x"".""ad_id"",CASE WHEN SUM(""den"")=0 THEN 0 ELSE ROUND((SUM(""num"")*100.0/SUM(""den"")), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""num"",CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""den"" FROM ""ads"") AS ""x"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
301,"SELECT ""ad_id"",CASE WHEN ""cl""+""vi""=0 THEN 0 ELSE ROUND(100*""cl""/(""cl""+""vi""), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""cl"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""vi"" FROM ""ads"" GROUP BY ""ad_id"") AS ""dudu"" ORDER BY ""ctr"" DESC,""ad_id"""
302,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')/(SUM(""action""='Viewed')+SUM(""action""='Clicked')), 0)*100, 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
303,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('Clicked','Viewed') THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
304,"WITH ""firstTable"" AS (SELECT ""ad_id"",COUNT(CASE WHEN ""action""='Clicked' THEN 1 END) AS ""total_clicks"",COUNT(CASE WHEN ""action""='Viewed' THEN 1 END) AS ""total_views"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",CASE WHEN ""total_clicks""+""total_views""=0 THEN 0 ELSE ROUND((""total_clicks""/(""total_clicks""+""total_views""))*100, 2) END AS ""ctr"" FROM ""firstTable"" ORDER BY ""ctr"" DESC,""ad_id"""
305,"SELECT ""ad_id"",ROUND(COALESCE(SUM(""action""='Clicked')*100.0/SUM(""action""='Clicked' OR ""action""='Viewed'), 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
306,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
307,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
308,"SELECT ""C"".""ad_id"",ROUND(""C"".""ctr"", 2) AS ""ctr"" FROM (SELECT ""B"".""ad_id"",CASE WHEN ""B"".""Ad_total_clicks""+""B"".""Ad_Total_views""=0 THEN 0 ELSE (""B"".""Ad_total_clicks""/(""B"".""Ad_total_clicks""+""B"".""Ad_Total_views""))*100 END AS ""ctr"" FROM (SELECT ""A"".""ad_id"",SUM(""A"".""Ad_clicks"") AS ""Ad_total_clicks"",SUM(""A"".""Ad_views"") AS ""Ad_total_views"" FROM (SELECT ""ad_id"",""user_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""Ad_clicks"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""Ad_views"" FROM ""Ads"") AS ""A"" GROUP BY ""A"".""ad_id"") AS ""B"" ORDER BY ""ctr"" DESC,""ad_id"") AS ""C"""
309,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1*100 ELSE 0 END))/(SUM(CASE WHEN ""action""='Viewed' THEN 1 WHEN ""action""='Clicked' THEN 1 ELSE 0 END)), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
310,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
311,"SELECT ""B"".""ad_id"",""B"".""ctr"" FROM (SELECT ""A"".""ad_id"",ROUND(""A"".""ctr""*100, 2) AS ""ctr"",ROW_NUMBER() OVER (PARTITION BY ""A"".""ad_id"" ORDER BY ""A"".""ranking"" DESC) AS ""ranking"" FROM (SELECT ""ad_id"",COALESCE(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) OVER (PARTITION BY ""ad_id"" ORDER BY ""user_id"")/SUM(CASE WHEN ""action""!='Ignored' THEN 1 ELSE 0 END) OVER (PARTITION BY ""ad_id"" ORDER BY ""user_id""), 0) AS ""ctr"",ROW_NUMBER() OVER (PARTITION BY ""ad_id"" ORDER BY ""user_id"") AS ""ranking"" FROM ""Ads"") AS ""A"") AS ""B"" WHERE ""B"".""ranking""=1 ORDER BY ""B"".""ctr"" DESC,""B"".""ad_id"""
312,"WITH ""ad_cte"" AS (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""total_clicks"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""total_views"" FROM ""Ads"" GROUP BY ""ad_id"") SELECT ""ad_id"",COALESCE(ROUND((""total_clicks""/(""total_views""+""total_clicks"")*100), 2), 0) AS ""ctr"" FROM ""ad_cte"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
313,"SELECT ""ad_id"",CASE WHEN (""clicked""+""viewed""=0) THEN 0 ELSE ROUND((""clicked""*100/(""clicked""+""viewed"")), 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""clicked"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""viewed"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""abc"" ORDER BY ""ctr"" DESC,""ad_id"""
314,"SELECT DISTINCT ""ad_id"",CASE WHEN SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END)!=0 THEN ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2) ELSE 0.00 END AS ""ctr"" FROM ""Ads"" GROUP BY 1 ORDER BY 2 DESC,1"
315,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
316,"SELECT ""ad_id"",CASE WHEN (""clicked""+""viewed""=0) THEN 0 ELSE ROUND(""clicked""/(""clicked""+""viewed"")*100, 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(""action""='Viewed') AS ""viewed"",SUM(""action""='Clicked') AS ""clicked"",SUM(""action""='Ignored') AS ""ignored"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""tmp"" ORDER BY ""ctr"" DESC,""ad_id"""
317,"SELECT ""ad_id"",COALESCE(ROUND((SUM(""action""='Clicked')/SUM(""action""!='Ignored')*100), 2), 0.00) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
318,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100, 2), 0) AS ""ctr"" FROM ""ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
319,"SELECT ""ad_id"",COALESCE(ROUND(AVG(CASE WHEN ""action""='Clicked' THEN 1 WHEN ""action""='Viewed' THEN 0 ELSE NULL END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
320,"SELECT ""ad_id"",CASE WHEN COUNT(CASE WHEN ""action""='Clicked' THEN 1 END)=0 THEN 0.00 ELSE ROUND(COUNT(CASE WHEN ""action""='Clicked' THEN 1 END)/(COUNT(CASE WHEN ""action""!='Ignored' THEN 1 END))*100, 2) END AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
321,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END)*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
322,"SELECT ""ad_id"",ROUND(COALESCE(SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='clicked' OR ""action""='viewed' THEN 1 ELSE 0 END)*100, 0), 2) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
323,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/SUM(""action""='Clicked' OR ""action""='Viewed')*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
324,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""click_no"",(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""view_no"" FROM ""Ads"") SELECT ""ad_id"",(CASE WHEN (SUM(""click_no"")+SUM(""view_no""))=0 THEN 0 ELSE ROUND(SUM(""click_no"")/(SUM(""click_no"")+SUM(""view_no""))*100, 2) END) AS ""ctr"" FROM ""cte"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
325,"SELECT ""ad_id"",CASE WHEN ""viewedClicked""=0 THEN 0 ELSE ROUND(""totalClicks""*100/""viewedClicked"", 2) END AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='clicked' THEN 1 ELSE 0 END) AS ""totalClicks"",SUM(CASE WHEN ""action""='clicked' OR ""action""='viewed' THEN 1 ELSE 0 END) AS ""viewedClicked"" FROM ""ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
326,"WITH ""T1"" AS (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""Clicks"",CASE WHEN ""action""='Viewed' OR ""action""='Clicked' THEN 1 ELSE 0 END AS ""Total_actions"" FROM ""ads"") SELECT ""ad_id"",COALESCE(ROUND(SUM(""Clicks"")/SUM(""Total_actions"")*100, 2), 0) AS ""ctr"" FROM ""T1"" GROUP BY 1 ORDER BY ""ctr"" DESC,""ad_id"""
327,"SELECT ""ad_id"",COALESCE(ROUND(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)*100.0/SUM(CASE WHEN ""action""='Clicked' OR ""action""='Viewed' THEN 1 ELSE 0 END), 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
328,"SELECT ""ad_id"",COALESCE(ROUND((""c""*100/(""c""+""v"")), 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""t"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
329,"WITH ""table1"" AS (SELECT ""ad_id"",CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END AS ""is_clicked"",CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END AS ""is_viewed"",CASE WHEN ""action""='Ignored' THEN 1 ELSE 0 END AS ""is_ignored"" FROM ""ads"") SELECT ""ad_id"",ROUND(100*COALESCE(SUM(""is_clicked"")/(SUM(""is_clicked"")+SUM(""is_viewed"")), 0), 2) AS ""ctr"" FROM ""table1"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
330,"SELECT ""ad_id"",COALESCE(ROUND(""c""/(""c""+""v"")*100, 2), 0) AS ""ctr"" FROM (SELECT ""ad_id"",SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END) AS ""c"",SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END) AS ""v"" FROM ""Ads"" GROUP BY ""ad_id"") AS ""t"" ORDER BY ""ctr"" DESC,""ad_id"""
331,"SELECT ""ad_id"",COALESCE(ROUND(SUM(""action""='Clicked')/(SUM(""action""='Clicked')+SUM(""action""='Viewed'))*100, 2), 0) AS ""ctr"" FROM ""Ads"" GROUP BY ""ad_id"" ORDER BY ""ctr"" DESC,""ad_id"""
332,"SELECT ""ad_id"",COALESCE(ROUND((SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)/(SUM(CASE WHEN ""action""='Clicked' THEN 1 ELSE 0 END)+SUM(CASE WHEN ""action""='Viewed' THEN 1 ELSE 0 END))*100), 2), 0.00) AS ""ctr"" FROM ""ads"" GROUP BY 1 ORDER BY 2 DESC,1"
