id,original query
1,"SELECT ""d"".""Name"" AS ""Department"",""rank_list1"".""Name"" AS ""Employee"",""rank_list1"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""RankP"" FROM ""Employee"") AS ""rank_list1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""rank_list1"".""DepartmentId"" WHERE ""RankP""<=3"
2,"SELECT ""d"".""Name"" AS ""Department"",""e2"".""Name"" AS ""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salaryrank"" FROM ""Employee"" AS ""e"") AS ""e2"" JOIN ""Department"" AS ""d"" ON ""e2"".""DepartmentId""=""d"".""Id"" WHERE ""salaryrank""<=3"
3,"SELECT ""dept"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".""Id"",""e"".""Name"",""e"".""Salary"",""e"".""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""DeptRank"" FROM ""Employee"" AS ""e"") AS ""emp"" JOIN ""Department"" AS ""dept"" ON ""emp"".""DepartmentId""=""dept"".""Id"" WHERE ""DeptRank""<=3"
4,"WITH ""top_three_salaries"" AS (SELECT ""name"",""salary"",""departmentId"",DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""salary"" DESC) AS ""dr"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""tts"".""name"" AS ""Employee"",""tts"".""salary"" AS ""Salary"" FROM ""top_three_salaries"" AS ""tts"" JOIN ""department"" AS ""d"" ON ""tts"".""departmentId""=""d"".""id"" WHERE ""dr""<4"
5,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" FROM ""department"" AS ""d"" JOIN (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") AS ""e"" ON ""d"".""id""=""e"".""departmentid"" WHERE ""e"".""rnk"" IN (1,2,3)"
6,"WITH ""ranking_finder"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rk"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""rf"".""Name"" AS ""Employee"",""rf"".""Salary"" FROM ""ranking_finder"" AS ""rf"" JOIN ""Department"" AS ""d"" ON ""rf"".""DepartmentId""=""d"".""Id"" AND ""rf"".""salary_rk""<=3"
7,"SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""ranks""<=3"
8,"WITH ""top_salary"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""t"".""Name"" AS ""Employee"",""t"".""Salary"" AS ""Salary"" FROM ""top_salary"" AS ""t"" JOIN ""Department"" AS ""d"" ON ""t"".""DepartmentId""=""d"".""id"" WHERE ""t"".""ranking""<=3"
9,"SELECT ""Name"" AS ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rank1"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""d"".""Id"" IS NOT NULL) AS ""T"" WHERE ""rank1""<=3"
10,"WITH ""DepartmentSalaryRanking"" AS (SELECT ""DepartmentId"",""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rk"" FROM ""Employee"") SELECT ""D"".""Name"" AS ""Department"",""DSR"".""Employee"",""DSR"".""Salary"" FROM ""DepartmentSalaryRanking"" AS ""DSR"" JOIN ""Department"" AS ""D"" ON ""D"".""Id""=""DSR"".""DepartmentId"" WHERE ""Rk""<=3"
11,"SELECT ""Department"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM (SELECT ""Employee"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Employee"".""Salary"" DESC) AS ""sal_rank"" FROM ""Employee"") AS ""E"" JOIN ""Department"" ON ""E"".""DepartmentId""=""Department"".""Id"" WHERE ""sal_rank""<=3"
12,"WITH ""ranking"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""Salary"" DESC) AS ""Salary_Rank"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""ranking"" WHERE ""salary_rank""<=3"
13,"WITH ""rankings"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""pos"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""r"".""Name"" AS ""Employee"",""r"".""Salary"" FROM (""Department"" AS ""d"") JOIN ""rankings"" AS ""r"" WHERE ""r"".""pos""<4 AND ""d"".""Id""=""r"".""DepartmentId"""
14,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""salary"" DESC) AS ""salary_rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""salary_rank""<4"
15,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE ROW(""E"".""DepartmentId"",""E"".""Salary"") IN (SELECT ""DepartmentId"",""Salary"" FROM (SELECT *,@""rank"":=CASE WHEN @""placehold""=""Salary"" AND @""placehold1""=""DepartmentId"" THEN @""rank"" WHEN @""placehold""!=""Salary"" AND @""placehold1""=""DepartmentId"" THEN @""rank""+1 ELSE @""rank"":=1 END AS ""r"",@""placehold"":=""Salary"",@""placehold1"":=""DepartmentId"" FROM (""Employee"") JOIN (SELECT @""rank"":=1,@""placehold"":=0,@""placehold1"":=0) AS ""init"" ORDER BY ""DepartmentId"",""Salary"" DESC) AS ""temp"" WHERE ""r""<=3)"
16,"WITH ""ranking"" AS (SELECT ""a"".""Name"" AS ""Employee"",""a"".""Salary"",""b"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""r"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""ranking"" WHERE ""r""<=3"
17,"WITH ""table1"" AS (SELECT ""Id"",""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""EMPLOYEE""), ""table2"" AS (SELECT ""Id"",""Name"",""Salary"",""DepartmentId"",""ranking"" FROM ""table1"" WHERE (""ranking""=1) OR (""ranking""=2) OR (""ranking""=3)) SELECT ""Department"".""Name"" AS ""Department"",""table2"".""Name"" AS ""Employee"",""table2"".""Salary"" FROM ""table2"" JOIN ""Department"" ON ""Department"".""Id""=""table2"".""DepartmentId"""
18,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rowNum"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""rowNum""<=3"
19,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""sal_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""ID"") AS ""T"" WHERE ""sal_rank""<=3"
20,"SELECT ""t1"".""Department"",""t1"".""Employee"",""t1"".""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""name"" ORDER BY ""e"".""Salary"" DESC) AS ""salaryrank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t1"" WHERE ""t1"".""salaryrank""<=3"
21,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""row_num"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""t"" WHERE ""row_num""<4"
22,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
23,"SELECT ""Name"" AS ""Department"",""Employee"",""Salary"" FROM (SELECT ""Salary"",""Name"" AS ""Employee"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salaryRank"" FROM ""Employee"") AS ""withSalaryRank"" LEFT JOIN ""Department"" ON ""withSalaryRank"".""DepartmentId""=""Department"".""Id"" WHERE ""salaryRank""<4 AND ""Name"" IS NOT NULL"
24,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"" FROM (""department"" AS ""d"") JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank_s"" FROM ""employee"") AS ""e"" WHERE ""d"".""id""=""e"".""departmentid"" AND ""e"".""rank_s""<=3"
25,"SELECT ""B"".""Department"",""B"".""Employee"",""B"".""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""E"".""DepartmentId"" ORDER BY ""E"".""Salary"" DESC) AS ""Rk"" FROM ""Employee"" AS ""E"" LEFT JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""B"" WHERE ""B"".""RK""<=3 AND ""B"".""Department"" IS NOT NULL"
26,"SELECT ""d"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" FROM (SELECT ""Name"",""Salary"",""Departmentid"",DENSE_RANK() OVER (PARTITION BY ""Departmentid"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM ""Employee"") AS ""a"" JOIN ""department"" AS ""d"" ON ""a"".""departmentid""=""d"".""id"" WHERE ""rk""<=3"
27,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
28,"SELECT ""aa"".""Department"",""aa"".""Employee"",""aa"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""Salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""aa"" WHERE ""Salary_rank"" IN (1,2,3)"
29,"WITH ""highest_salary"" AS (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""Employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentId""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""highest_salary"" WHERE ""r""<=3"
30,"WITH ""highestsalary"" AS (SELECT ""department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""employee"".""departmentId"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""employee"" JOIN ""department"" ON ""employee"".""departmentid""=""department"".""id"") SELECT ""Department"",""Employee"",""salary"" FROM ""highestsalary"" WHERE ""r""<=3"
31,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
32,"WITH ""CTE"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""d"".""name"" AS ""department"",""c"".""name"" AS ""employee"",""c"".""salary"" FROM ""cte"" AS ""c"" JOIN ""department"" AS ""d"" ON ""c"".""DepartmentId""=""d"".""id"" WHERE ""rnk""<=3"
33,"SELECT ""tD"".""Name"" AS ""Department"",""tE1"".""Name"" AS ""Employee"",""tE1"".""Salary"" FROM (""Employee"" AS ""tE1"" JOIN ""Department"" AS ""tD"" ON ""tE1"".""DepartmentId""=""tD"".""Id"") LEFT JOIN ""Employee"" AS ""tE2"" ON ""tE1"".""DepartmentId""=""tE2"".""DepartmentId"" AND ""tE1"".""Salary""<=""tE2"".""Salary"" GROUP BY ""tE1"".""Id"" HAVING COUNT(DISTINCT ""tE2"".""Salary"")<=3 ORDER BY ""tE1"".""DepartmentId"",""tE1"".""Salary"" DESC"
34,"SELECT ""temp"".""Name"" AS ""Employee"",""temp"".""Salary"",""d"".""Name"" AS ""Department"" FROM (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank_sal"" FROM ""Employee"") AS ""temp"", ""Department"" AS ""d"" WHERE ""temp"".""DepartmentId""=""d"".""Id"" AND ""rank_sal""<4"
35,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
36,"WITH ""ED"" AS (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""E"".""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""SALRANK"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") SELECT ""ED"".""DEPARTMENT"",""ED"".""EMPLOYEE"",""ED"".""SALARY"" FROM ""ED"" WHERE ""ED"".""SALRANK""<=3"
37,"SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""a"".""rank""<4"
38,"WITH ""solution_stg"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""solution_stg"" WHERE ""rnk""<=3"
39,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""Salary"",""Name"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") AS ""a"" LEFT JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""a"".""rank""<=3 AND ""d"".""Name"" IS NOT NULL"
40,"WITH ""cte"" AS (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""R"" FROM ""Employee"" AS ""e"") SELECT ""D"".""Name"" AS ""Department"",""cte"".""Name"" AS ""Employee"",""Salary"" FROM ""cte"" JOIN ""Department"" AS ""D"" ON ""cte"".""DepartmentId""=""D"".""Id"" WHERE ""R""<=3"
41,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""e"".""name"" AS ""employee"",""d"".""name"" AS ""department"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranka"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""departmentid"") AS ""x"" WHERE ""x"".""ranka""<=3"
42,"WITH ""rank_employees"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""re"".""Name"" AS ""Employee"",""re"".""Salary"" FROM ""rank_employees"" AS ""re"" JOIN ""Department"" AS ""d"" ON ""re"".""DepartmentId""=""d"".""ID"" WHERE ""salary_rank""<=3"
43,"WITH ""cte1"" AS (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""salary"" DESC) AS ""ranking"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentId""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte1"" WHERE ""ranking""<=3"
44,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",""d"".""name"" AS ""department"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""temp"" WHERE ""rk""<4"
45,"WITH ""highestThree"" AS (SELECT ""D"".""name"" AS ""Department"",""E"".""name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""name"" ORDER BY ""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""highestThree"" WHERE ""rank_num""=1 OR ""rank_num""=2 OR ""rank_num""=3"
46,"WITH ""rank_employees"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""re"".""Name"" AS ""Employee"",""re"".""Salary"" FROM ""rank_employees"" AS ""re"" JOIN ""Department"" AS ""d"" ON ""re"".""DepartmentId""=""d"".""ID"" WHERE ""salary_rank""<=3"
47,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_level"" FROM ""employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""id"") AS ""c"" WHERE ""salary_level""<=3"
48,"WITH ""sal_ranking"" AS (SELECT ""DepartmentId"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""d"".""name"" AS ""department"",""s"".""name"" AS ""employee"",""s"".""salary"" FROM ""sal_ranking"" AS ""s"" JOIN ""department"" AS ""d"" ON ""s"".""DepartmentId""=""d"".""id"" WHERE ""s"".""rnk""<=3 ORDER BY ""s"".""salary"""
49,"SELECT ""Department"",""Employee"",""salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""salaryorder"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""foo"" WHERE ""salaryorder""<=3"
50,"SELECT ""d"".""name"" AS ""Department"",""r1"".""name"" AS ""Employee"",""r1"".""salary"" AS ""Salary"" FROM (SELECT ""departmentid"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""RK"" FROM ""employee"") AS ""r1"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""r1"".""departmentid"" WHERE ""r1"".""RK""<=3 ORDER BY ""d"".""name"""
51,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""a"".""DeptRank""<=3"
52,"WITH ""CTE"" AS (SELECT DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rid"",""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""CTE"" WHERE ""rid""<=3"
53,"SELECT ""d"".""name"" AS ""Department"",""y"".""name"" AS ""Employee"",""y"".""salary"" FROM (SELECT * FROM ""employee"" AS ""e"" WHERE ROW(""departmentid"",""salary"") IN (SELECT ""x"".""departmentid"",""x"".""salary"" FROM (SELECT ""departmentid"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""s_rank"" FROM ""employee"") AS ""x"" WHERE ""s_rank"" IN (1,2,3))) AS ""y"" JOIN ""department"" AS ""d"" ON (""y"".""departmentid""=""d"".""id"")"
54,"WITH ""cte"" AS (SELECT ""Name"" AS ""Employee"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""Salary"" DESC) AS ""rank_n"" FROM ""Employee"" ORDER BY ""Departmentid"",""salary"" DESC) SELECT ""a"".""Name"" AS ""Department"",""b"".""Employee"",""b"".""Salary"" FROM ""Department"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""Id""=""b"".""departmentid"" WHERE ""b"".""rank_n""<=3 ORDER BY ""department"",""b"".""Salary"" DESC"
55,"WITH ""a"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""c"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"") JOIN ""Employee"" AS ""c"" ON ""c"".""Id""=""a"".""Id"" WHERE ""ranks""<=3"
56,"SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""max_salary"" FROM ""Employee"") AS ""a"", ""Department"" AS ""b"" WHERE ""a"".""departmentid""=""b"".""id"" AND ""a"".""max_salary""<=3"
57,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""emp"" WHERE ""salary_rank""<=3 ORDER BY ""Department"",""Salary"" DESC,""Employee"""
58,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""salary"" AS ""Salary"" FROM (SELECT ""NAME"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""row_num"" FROM ""EMPLOYEE"") AS ""e"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""e"".""DEPARTMENTID""=""D"".""ID"" WHERE ""row_num""<=3 AND ""d"".""name"" IS NOT NULL ORDER BY 3"
59,"SELECT ""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"" FROM (SELECT ""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"") AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"" WHERE ""rank""<=3"
60,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""t2"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""t1"".""DepartmentId"" ORDER BY ""t1"".""salary"" DESC) AS ""rk"" FROM ""Employee"" AS ""t1"" JOIN ""Department"" AS ""t2"" ON ""t1"".""DepartmentID""=""t2"".""Id"") AS ""t"" WHERE ""rk""<4"
61,"SELECT ""DEP"".""NAME"" AS ""DEPARTMENT"",""EMP"".""NAME"" AS ""EMPLOYEE"",""SALARY"" FROM (SELECT ""NAME"",""SALARY"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""SALARY_RANK"" FROM ""EMPLOYEE"") AS ""EMP"" JOIN ""DEPARTMENT"" AS ""DEP"" ON ""EMP"".""DEPARTMENTID""=""DEP"".""ID"" WHERE ""SALARY_RANK""<=3"
62,"SELECT ""Department"".""NAME"" AS ""Department"",""Employee_partition"".""Name"" AS ""Employee"",""Employee_partition"".""Salary"" AS ""Salary"" FROM (SELECT ""Name"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""R"" FROM ""Employee"") AS ""Employee_partition"" JOIN ""Department"" ON ""Department"".""Id""=""Employee_partition"".""DepartmentId"" WHERE ""R"">=1 AND ""R""<=3"
63,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rk"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""rk""<=3"
64,"WITH ""sub"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentID"" ORDER BY ""salary"" DESC) AS ""ranking"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""s"".""name"" AS ""Employee"",""salary"" AS ""Salary"" FROM ""sub"" AS ""s"" JOIN ""department"" AS ""d"" ON ""s"".""departmentid""=""d"".""id"" WHERE ""ranking""<=3"
65,"SELECT ""DE"".""Department"",""DE"".""Employee"",""DE"".""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""E"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank_ID"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""DE"" WHERE ""Rank_ID""<=3 ORDER BY ""DE"".""Salary"" DESC"
66,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ((""Employee"" AS ""e"") JOIN ""Employee"" AS ""e1"") JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"" AND ""e1"".""DepartmentId""=""e"".""DepartmentId"" AND ""e1"".""Salary"">=""e"".""Salary"" GROUP BY ""e"".""Id"" HAVING COUNT(DISTINCT ""e1"".""Salary"")<=3"
67,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"") AS ""E"" JOIN ""Department"" AS ""D"" WHERE ""E"".""DepartmentId""=""D"".""Id"" AND ""r""<=3"
68,"SELECT ""c"".""name"" AS ""Department"",""final"".""name"" AS ""Employee"",""final"".""salary"" AS ""Salary"" FROM (SELECT ""a"".* FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rn"" FROM (SELECT DISTINCT ""salary"",""departmentid"" FROM ""employee"") AS ""dis"") AS ""top"" JOIN ""employee"" AS ""a"" ON ""a"".""salary""=""top"".""salary"" AND ""a"".""departmentid""=""top"".""departmentid"" WHERE ""top"".""rn""<=3) AS ""final"" JOIN ""department"" AS ""c"" ON ""final"".""departmentid""=""c"".""id"""
69,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".""DepartmentId"",""e"".""Name"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""RNK"" FROM ""Employee"" AS ""e"") AS ""A"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""A"".""DepartmentId"" WHERE ""RNK""<=3"
70,"SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"" AS ""salary"" FROM (SELECT ""name"",""departmentid"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""rk""<4"
71,"SELECT ""Department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""e"".""salary"" DESC) AS ""drk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""drk""<=3"
72,"SELECT ""B"".""Name"" AS ""Department"",""A"".""name"" AS ""Employee"",""A"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank1"" FROM ""employee"") AS ""A"" JOIN ""Department"" AS ""B"" ON ""A"".""DepartmentId""=""B"".""Id"" WHERE ""A"".""Rank1""<4"
73,"WITH ""temp"" AS (SELECT ""Name"",""Salary"",""DEpartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""temp"".""Name"" AS ""Employee"",""temp"".""Salary"" FROM ""Department"" AS ""d"" LEFT JOIN ""temp"" ON ""d"".""Id""=""temp"".""DepartmentID"" WHERE ""rnk""<=3"
74,"WITH ""added_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""SALARY"" DESC) AS ""rank_number"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""added_rank"" WHERE ""rank_number""<=3"
75,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""a"".""Department"" ORDER BY ""Salary"" DESC) AS ""r"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" JOIN ""Department"" ON ""DepartmentID""=""Department"".""ID"") AS ""a"") AS ""q"" WHERE ""q"".""r""=1 OR ""q"".""r""=2 OR ""q"".""r""=3"
76,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
77,"SELECT ""d"".""Name"" AS ""Department"",""sub"".""Name"" AS ""Employee"",""sub"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""Deprank"" FROM ""Employee"" AS ""e"") AS ""sub"" JOIN ""Department"" AS ""d"" ON ""sub"".""DepartmentId""=""d"".""Id"" WHERE ""Deprank""<=3"
78,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Department"" AS ""d"" RIGHT JOIN (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"",""Id"",""Name"",""Salary"",""DepartmentId"" FROM ""Employee"") AS ""e"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""salary_rank""<=3 AND ""d"".""Name"" IS NOT NULL"
79,"SELECT ""c"".""department"",""c"".""employee"",""c"".""salary"" FROM (SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") AS ""c"" WHERE ""rnk""<4"
80,"WITH ""dataset"" AS (SELECT ""e"".""id"",""e"".""name"" AS ""employee"",""salary"",""departmentid"",""d"".""name"" AS ""department"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""dept_sal_rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""dataset"" WHERE ""dept_sal_rank""<=3"
81,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""a"".""Name"" AS ""Department"",""b"".""Name"" AS ""Employee"",""b"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""DepartmentId"" ORDER BY ""b"".""Salary"" DESC) AS ""rk"" FROM ""Department"" AS ""a"" JOIN ""Employee"" AS ""b"" ON ""a"".""Id""=""b"".""DepartmentId"") AS ""c"" WHERE ""rk""<=3"
82,"WITH ""cte"" AS (SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""name"" ORDER BY ""a"".""salary"" DESC) AS ""rn"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""cte"" WHERE ""rn""<=3"
83,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""employee"",""e"".""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""salary_rank"" FROM ""employee"") AS ""e"", ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""id"" AND ""salary_rank""<=3"
84,"WITH ""top_three_salary"" AS (SELECT ""departmentid"",""salary"",RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""salary_rank"" FROM (SELECT DISTINCT ""departmentid"",""salary"" FROM ""employee"") AS ""s"") SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM (""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") JOIN (SELECT DISTINCT ""departmentid"",""salary"" FROM ""top_three_salary"" WHERE ""salary_rank""<=3) AS ""t"" ON ""e"".""departmentid""=""t"".""departmentid"" AND ""e"".""salary""=""t"".""salary"""
85,"WITH ""cte"" AS (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rnk"" IN (1,2,3)"
86,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""salary"" DESC) AS ""dRank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""departmentId""=""d"".""id"") AS ""k"" WHERE ""dRank""<=3"
87,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",COALESCE(""e"".""Salary"", 0) AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""emp_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t1"" WHERE ""emp_rank""<4"
88,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""DeptPayRank""<=3"
89,"SELECT ""tmp"".""Department"",""tmp"".""Employee"",""tmp"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""Rnk"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""tmp"" WHERE ""tmp"".""Rnk""=1 OR ""tmp"".""Rnk""=2 OR ""tmp"".""Rnk""=3"
90,"SELECT ""dp"".""Name"" AS ""Department"",""ep"".""Name"" AS ""Employee"",""ep"".""Salary"" AS ""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""ep"" JOIN ""Department"" AS ""dp"" ON ""dp"".""Id""=""ep"".""DepartmentId"" AND ""ep"".""rnk""<4 ORDER BY ""DepartmentId"",""Salary"""
91,"SELECT ""department"",""name"" AS ""employee"",""salary"" FROM (SELECT ""b"".""name"" AS ""department"",""a"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""id"") AS ""t"" WHERE ""rnk""<=3"
92,"WITH ""cte"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""cte"".""Name"" AS ""Employee"",""Salary"" FROM ""cte"" JOIN ""Department"" AS ""d"" ON ""d"".""id""=""cte"".""DepartmentId"" WHERE ""rnk""<4"
93,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Id"" ORDER BY ""Salary"" DESC) AS ""dsrnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""temp"" WHERE ""dsrnk""<=3"
94,"SELECT ""e"".""Salary"",""Department"",""Employee"" FROM (SELECT ""e"".""DepartmentId"",""e"".""Salary"",""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""Ranking"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""E"".""DepartmentId"" WHERE ""Ranking""<=3"
95,"SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" AS ""Salary"" FROM (SELECT * FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""sal_rank"",""name"",""salary"",""departmentid"" FROM ""employee"") AS ""t"" WHERE ""t"".""sal_rank""<=3) AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"""
96,"SELECT ""d"".""Name"" AS ""Department"",""x"".""Name"" AS ""Employee"",""x"".""salary"" AS ""salary"" FROM (SELECT ""e"".""Name"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"") AS ""x"" JOIN ""Department"" AS ""d"" ON ""x"".""DepartmentId""=""d"".""ID"" WHERE ""rnk""<=3"
97,"WITH ""rnk_tb"" AS (SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM (""employee"" AS ""a"") JOIN ""department"" AS ""b"" WHERE ""a"".""departmentid""=""b"".""id"") SELECT ""t"".""department"",""t"".""employee"",""t"".""salary"" FROM ""rnk_tb"" AS ""t"" WHERE ""rnk""<=3"
98,"SELECT ""SalaryRank"".""DepartmentName"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" FROM (""Employee"") JOIN (SELECT ""Department"".""Id"" AS ""DepartmentId"",""Department"".""Name"" AS ""DepartmentName"",RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"",""Employee"".""Salary"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"" GROUP BY ""DepartmentId"",""Salary"" ORDER BY ""DepartmentId"",""Salary"" DESC) AS ""SalaryRank"" WHERE ""Employee"".""Salary""=""SalaryRank"".""Salary"" AND ""Employee"".""DepartmentId""=""SalaryRank"".""DepartmentId"" AND ""SalaryRank"".""Rank""<=3 ORDER BY ""Employee"".""DepartmentId"",""Employee"".""Salary"" DESC,""Employee"".""Id"" DESC"
99,"SELECT ""d"".""Name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>=(SELECT COUNT(1) AS ""rnk"" FROM (SELECT DISTINCT ""Salary"" AS ""x"",""DepartmentId"" AS ""y"" FROM ""Employee"") AS ""t"" WHERE ""Salary""<=""x"" AND ""DepartmentId""=""y"")"
100,"SELECT ""n2"" AS ""Department"",""n1"" AS ""Employee"",""Salary"" FROM (SELECT ""a"".""Salary"",""a"".""name"" AS ""n1"",""b"".""name"" AS ""n2"",""departmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""departmentId""=""b"".""id"") AS ""temp"" WHERE ""r""<4"
101,"WITH ""minSalary"" AS (WITH ""salRank"" AS (WITH ""depSal"" AS (SELECT DISTINCT ""ee"".""salary"" AS ""salary"",""ee"".""departmentid"" AS ""did"" FROM ""Employee"" AS ""ee"") SELECT ""salary"" AS ""salary"",""did"" AS ""did"",RANK() OVER (PARTITION BY ""did"" ORDER BY ""salary"" DESC) AS ""ranknum"" FROM ""depSal"") SELECT ""did"",MIN(""salary"") AS ""mins"" FROM ""salRank"" WHERE ""ranknum""<=3 GROUP BY ""did"") SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM (""Employee"" AS ""e"" JOIN ""Department"" AS ""d"") JOIN ""minSalary"" AS ""m"" ON ""m"".""did""=""e"".""DepartmentId"" AND ""d"".""id""=""m"".""did"" WHERE ""e"".""salary"">=""m"".""mins"""
102,"SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""SALARY"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""RANKS"" FROM ""EMPLOYEE"") AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"" WHERE ""RANKS""<=3"
103,"WITH ""highestThree"" AS (SELECT ""D"".""name"" AS ""Department"",""E"".""name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""name"" ORDER BY ""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""highestThree"" WHERE ""rank_num""=1 OR ""rank_num""=2 OR ""rank_num""=3"
104,"WITH ""w1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""w1"".""Name"" AS ""Employee"",""w1"".""Salary"" AS ""Salary"" FROM ""w1"" JOIN ""Department"" ON ""Department"".""Id""=""w1"".""DepartmentId"" WHERE ""w1"".""Rank""=1 OR ""w1"".""Rank""=2 OR ""w1"".""Rank""=3 ORDER BY ""Department"".""Name"",""w1"".""Salary"" DESC"
105,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""z"" WHERE ""rnk""<=3"
106,"SELECT ""D"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""E"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ERank"" FROM ""Employee"" AS ""E"") AS ""a"" JOIN ""Department"" AS ""D"" ON ""a"".""DepartmentId""=""D"".""Id"" WHERE ""ERank""<4"
107,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""n"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""Departmentid""=""d"".""id"" WHERE ""e"".""n""<=3"
108,"SELECT ""e"".""Department"" AS ""Department"",""e"".""Employee"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""d"".""Id"" AS ""DepartmentId"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (ORDER BY ""e"".""DepartmentId"",""e"".""Salary"" DESC) AS ""my_rank"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"" ORDER BY ""e"".""DepartmentId"",""e"".""Salary"" DESC) AS ""e"", (SELECT ""t"".""DepartmentId"",MIN(""t"".""my_rank"") AS ""top_rank"" FROM (SELECT ""d"".""Id"" AS ""DepartmentId"",DENSE_RANK() OVER (ORDER BY ""e"".""DepartmentId"",""e"".""Salary"" DESC) AS ""my_rank"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"" ORDER BY ""e"".""DepartmentId"",""e"".""Salary"" DESC) AS ""t"" GROUP BY ""DepartmentId"") AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""DepartmentId"" AND ""my_rank""<=""top_rank""+2"
109,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""a"" LEFT JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") AS ""c"" WHERE ""rnk"" IN (1,2,3) AND ""department"" IS NOT NULL"
110,"SELECT ""Department"",""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""a"".*,""b"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""c"" WHERE ""rk""<=3 AND ""Department"" IS NOT NULL"
111,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rank_inner"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""a"".""rank_inner""<=3"
112,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""ran"" FROM ""employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""ran""<=3"
113,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
114,"WITH ""cte"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rk""<=3"
115,"WITH ""salary"" AS (SELECT ""ID"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""ID""=""e"".""DepartmentID"") JOIN ""salary"" AS ""s"" ON ""s"".""ID""=""e"".""ID"" WHERE ""rnk"" IN (1,2,3) ORDER BY ""d"".""Name"",""rnk"""
116,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""e1"".""id"",""e1"".""name"" AS ""employee"",""e1"".""salary"",""e1"".""departmentid"",DENSE_RANK() OVER (PARTITION BY ""e1"".""departmentid"" ORDER BY ""e1"".""salary"" DESC) AS ""rk"",COALESCE(""e2"".""name"", NULL) AS ""department"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""e2"" ON ""e1"".""departmentid""=""e2"".""id"") AS ""t"" WHERE ""rk""<4"
117,"SELECT ""Department"".""Name"" AS ""Department"",""x"".""Name"" AS ""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") AS ""x"" JOIN ""Department"" ON ""x"".""departmentId""=""Department"".""id"" WHERE ""rank""<=3"
118,"ERROR: mysql parse error: line 1 column 10 near ""dense_rank() over(partition by Department.Name order by Employee.Salary desc) as rank_count from Employee join Department on Employee.DepartmentId = Department.Id) as mytable where mytable.rank_count<=3 "" "
119,"SELECT ""t"".""Department"",""t"".""Employee"",""t"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""r""<=3"
120,"WITH ""cte"" AS (SELECT * FROM (SELECT ""Name"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""d_rnk"" FROM ""Employee"") AS ""t"" WHERE ""t"".""d_rnk""<=3) SELECT ""d"".""name"" AS ""Department"",""c"".""Name"" AS ""Employee"",""c"".""Salary"" AS ""Salary"" FROM ""cte"" AS ""c"" JOIN ""Department"" AS ""d"" ON ""c"".""DepartmentId""=""d"".""Id"""
121,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
122,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""Salary"" FROM (SELECT * FROM (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""sub"" WHERE ""rnk""<=3) AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"""
123,"WITH ""CTE"" AS (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Employee"".""Salary"" DESC) AS ""Ranking"" FROM ""Employee"" JOIN ""Department"" ON ""Department"".""Id""=""Employee"".""DepartmentId"") SELECT ""Department"",""Employee"",""Salary"" FROM ""CTE"" WHERE ""Ranking""=1 OR ""Ranking""=2 OR ""Ranking""=3"
124,"SELECT ""a"".""department"" AS ""department"",""a"".""employee"" AS ""employee"",""a"".""salary"" AS ""salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""salary"" DESC) AS ""ranking"",""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""a"".""ranking""<=3"
125,"WITH ""table1"" AS (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" JOIN ""Department"" ON ""DepartmentId""=""Department"".""Id""), ""table2"" AS (SELECT * FROM (SELECT ""Department"",""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"" ORDER BY ""Salary"" DESC) AS ""ran"" FROM ""table1"") AS ""t"" WHERE ""ran""<=3) SELECT ""Department"",""Employee"",""Salary"" FROM ""table2"""
126,"SELECT ""t"".""Department"",""t"".""Employee"",""t"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentID""=""b"".""ID"") AS ""t"" WHERE ""rnk""<=3 AND ""Department"" IS NOT NULL"
127,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d2"".""name"" AS ""Department"",""d1"".""Name"" AS ""Employee"",""d1"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""Employee"" AS ""d1"" JOIN ""Department"" AS ""d2"" ON ""d1"".""DepartmentId""=""d2"".""Id"") AS ""sub"" WHERE ""ranking"" IN (1,2,3)"
128,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ((SELECT DISTINCT ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""SALARY"" DESC) AS ""rankk"",""DepartmentId"" FROM ""Employee"") AS ""topbydep"" JOIN ""Employee"" AS ""e"" ON ""e"".""Salary""=""topbydep"".""Salary"" AND ""e"".""DepartmentId""=""topbydep"".""DepartmentId"") JOIN ""Department"" AS ""d"" ON ""topbydep"".""DepartmentId""=""d"".""Id"" WHERE ""topbydep"".""rankk""<4"
129,"SELECT ""D"".""NAME"" AS ""Department"",""E"".""NAME"" AS ""Employee"",""E"".""Salary"" FROM ""DEPARTMENT"" AS ""D"" JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""ROW_NUM"" FROM ""EMPLOYEE"") AS ""E"" ON ""D"".""ID""=""E"".""DEPARTMENTID"" AND ""E"".""ROW_NUM""<=3"
130,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""dept_rk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentID""=""d"".""ID"") AS ""a"" WHERE ""dept_rk""<=3"
131,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank_num"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""rank_num""<=3"
132,"SELECT ""tD"".""Name"" AS ""Department"",""tE1"".""Name"" AS ""Employee"",""tE1"".""Salary"" FROM (""Employee"" AS ""tE1"" JOIN ""Department"" AS ""tD"" ON ""tE1"".""DepartmentId""=""tD"".""Id"") LEFT JOIN ""Employee"" AS ""tE2"" ON ""tE1"".""DepartmentId""=""tE2"".""DepartmentId"" AND ""tE1"".""Salary""<=""tE2"".""Salary"" GROUP BY ""tE1"".""Id"" HAVING COUNT(DISTINCT ""tE2"".""Salary"")<=3 ORDER BY ""tE1"".""DepartmentId"",""tE1"".""Salary"" DESC"
133,"SELECT ""Department"",""Employee"",""salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""name"" AS ""Employee"",""E"".""salary"",DENSE_RANK() OVER (PARTITION BY ""E"".""DepartmentId"" ORDER BY ""E"".""salary"" DESC) AS ""Rowno"" FROM ""employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""K"" WHERE ""Rowno""<=3"
134,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Department"" AS ""d"" JOIN ""Employee"" AS ""e1"" ON ""d"".""Id""=""e1"".""DepartmentId"") JOIN ""Employee"" AS ""e2"" ON ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" GROUP BY ""e1"".""DepartmentId"",""e1"".""Id"" HAVING COUNT(DISTINCT ""e2"".""Salary"")<=3"
135,"SELECT ""Department"".""Name"" AS ""Department"",""r"".""Name"" AS ""Employee"",""r"".""Salary"" AS ""Salary"" FROM (SELECT ""Employee"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"") AS ""r"" JOIN ""Department"" ON ""r"".""DepartmentId""=""Department"".""Id"" WHERE ""r"".""Rank""<=3"
136,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
137,"WITH ""TEMP"" AS (SELECT ""D"".""Name"" AS ""DEPARTMENT"",""E"".""Name"" AS ""EMPLOYEE"",""E"".""salary"" AS ""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""PRIORITY"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM ""TEMP"" WHERE ""PRIORITY"" IN (1,2,3)"
138,"WITH ""T"" AS (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""T"" WHERE ""rank_num""<=3"
139,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""DeptPayRank""<=3"
140,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT ""e1"".""Name"",""e1"".""Salary"",""e1"".""DepartmentId"" FROM ""Employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" GROUP BY ""e1"".""Id"" HAVING COUNT(DISTINCT ""e2"".""Salary"")<=3) AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" ORDER BY ""d"".""Name"",""e"".""Salary"" DESC"
141,"WITH ""top_salaries"" AS (SELECT *,RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank_salary"" FROM (SELECT DISTINCT ""Salary"",""DepartmentId"" FROM ""Employee"") AS ""temp_a"") SELECT ""b"".""name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE ROW(""DepartmentId"",""Salary"") IN (SELECT ""DepartmentId"",""Salary"" FROM ""top_salaries"" WHERE ""rank_salary""<=3) AND ""b"".""name"" IS NOT NULL"
142,"SELECT ""d"".""Name"" AS ""Department"",""tmp"".""Name"" AS ""Employee"",""tmp"".""Salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""drk"" FROM ""Employee"") AS ""tmp"" JOIN ""Department"" AS ""d"" ON ""tmp"".""DepartmentId""=""d"".""Id"" WHERE ""tmp"".""drk""<=3"
143,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""T1"" WHERE ""rnk""<=3"
144,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""ranking"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""t"" WHERE ""ranking""<=3"
145,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ((""Department"" AS ""D"") JOIN ""Employee"" AS ""E"") JOIN ""Employee"" AS ""E2"" WHERE ""d"".""Id""=""E"".""DepartmentId"" AND ""E"".""departmentId""=""E2"".""DepartmentId"" AND ""E"".""Salary""<=""E2"".""Salary"" GROUP BY ""E"".""Name"" HAVING COUNT(DISTINCT ""E2"".""Salary"")<=3 ORDER BY ""D"".""name"",""E"".""salary"" DESC"
146,"SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""ranks""<=3"
147,"SELECT ""d"".""Name"" AS ""Department"",""rank_table"".""Name"" AS ""Employee"",""rank_table"".""Salary"" AS ""Salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER ""w"" AS ""salary_rank"" FROM ""Employee"" WINDOW ""w"" AS (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC)) AS ""rank_table"" JOIN ""Department"" AS ""d"" ON ""rank_table"".""DepartmentId""=""d"".""Id"" WHERE ""salary_rank""<4"
148,"WITH ""cte"" AS (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rnk""<=3"
149,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
150,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rnk"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""t"" WHERE ""rnk""<=3"
151,"SELECT ""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"" FROM (SELECT ""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"" WHERE ""ranks""<=3"
152,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""Salary"" DESC) AS ""r"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""temp"" WHERE ""r""<=3"
153,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""e"".""salary"" DESC) AS ""salary_order"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""b"" ON ""e"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""salary_order""<=3 AND ""department"" IS NOT NULL ORDER BY ""Department"",""Salary"" DESC"
154,"SELECT ""d"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""a"".""departmentid"" WHERE ""rk""<=3"
155,"WITH ""Employee_salary_rank"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""Employee_salary_rank"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee_salary_rank"" JOIN ""Department"" ON (""Department"".""Id""=""Employee_salary_rank"".""DepartmentId"") WHERE ""salary_rank""<=3"
156,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""Departmentid""=""b"".""id"") AS ""x"" WHERE ""rnk""<=3"
157,"SELECT ""T"".""DepartmentName"" AS ""Department"",""T"".""EmployeeName"" AS ""Employee"",""T"".""Salary"" AS ""Salary"" FROM (SELECT ""E"".""Name"" AS ""EmployeeName"",""E"".""Salary"" AS ""Salary"",""E"".""DepartmentId"" AS ""DepartmentId"",""D"".""Name"" AS ""DepartmentName"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentID""=""D"".""Id"") AS ""T"" WHERE ""salary_rank""<=3"
158,"WITH ""cte"" AS (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""departmentID""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rnk""<=3"
159,"SELECT ""E"".""Salary"",""Department"",""Employee"" FROM (SELECT ""E"".""DepartmentId"",""E"".""Salary"",""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""Ranking"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE ""E"".""DepartmentId"" IN (SELECT ""Id"" FROM ""Department"")) AS ""E"" JOIN ""Department"" AS ""D"" ON ""D"".""Id""=""E"".""DepartmentId"" WHERE ""Ranking""<=3"
160,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""sal_rank"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""d"".""Id"" IS NOT NULL) AS ""a"" WHERE ""sal_rank""<=3"
161,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rownum"",""DepartmentId"",""Salary"",""Name"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rownum""<4 ORDER BY ""department"""
162,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""ranking""<=3"
163,"WITH ""CTE"" AS (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""R1"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""CTE"" WHERE ""R1"" IN (1,2,3)"
164,"WITH ""cte"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""Rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""Rnk""<=3"
165,"SELECT DISTINCT ""R"".""Department"",""Employee"".""Name"" AS ""Employee"",""R"".""Salary"" AS ""Salary"" FROM (SELECT ""DepartmentId"",""Department"".""Name"" AS ""Department"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Employee"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rankedSalary"" FROM ""Employee"" JOIN ""Department"" ON ""Department"".""Id""=""Employee"".""DepartmentId"") AS ""R"" LEFT JOIN ""Employee"" ON ""Employee"".""Salary""=""R"".""Salary"" AND ""Employee"".""DepartmentId""=""R"".""DepartmentId"" WHERE ""rankedSalary""<4"
166,"WITH ""w1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""w1"".""Name"" AS ""Employee"",""w1"".""Salary"" AS ""Salary"" FROM ""w1"" JOIN ""Department"" ON ""Department"".""Id""=""w1"".""DepartmentId"" WHERE ""w1"".""Rank""<=3 ORDER BY ""Department"".""Name"",""w1"".""Salary"" DESC"
167,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""inb"".""Name"" AS ""Department"",""ina"".""Name"" AS ""Employee"",""ina"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""ina"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r_number"" FROM ""Employee"" AS ""ina"" JOIN ""Department"" AS ""inb"" ON ""ina"".""DepartmentId""=""inb"".""Id"") AS ""inc"" WHERE ""r_number""<=3"
168,"SELECT ""D"".""Name"" AS ""Department"",""Em"".""Name"" AS ""Employee"",""Em"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Deptrank"" FROM ""Employee"" AS ""e"") AS ""Em"" JOIN ""Department"" AS ""D"" ON ""Em"".""DepartmentId""=""D"".""id"" WHERE ""Deptrank""<=3"
169,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""SALARY_RANK"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""ED"" WHERE ""SALARY_RANK""<=3"
170,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""D"".""NAME"" AS ""Department"",""E"".""NAME"" AS ""employee"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""E"".""departmentid"" ORDER BY ""salary"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""X"" WHERE ""RNK""<=3"
171,"SELECT ""t1"".""Department"",""t1"".""Employee"",""t1"".""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""myrank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""t1"" WHERE ""t1"".""myrank""<=3 ORDER BY 3 DESC"
172,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""r""<=3"
173,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""Rank"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE ""b"".""Name"" IS NOT NULL) AS ""t"" WHERE ""t"".""Rank""<=3"
174,"WITH ""temp"" (""name"", ""id"", ""salary"", ""rnk"") AS (SELECT ""name"",""departmentid"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""t"".""name"" AS ""Employee"",""t"".""salary"" AS ""Salary"" FROM (""department"" AS ""d"") JOIN ""temp"" AS ""t"" WHERE ""t"".""id""=""d"".""id"" AND ""t"".""rnk""<4 ORDER BY ""department"",""salary"" DESC"
175,"WITH ""Employee_salary_ranked"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""SALARY"" DESC) AS ""salary_rank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee_salary_ranked"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""salary_rank""<4 ORDER BY 3 DESC"
176,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT ""DepartmentId"",""Salary"",""Name"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnum"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rnum""<4 ORDER BY ""department"""
177,"SELECT ""dept"".""name"" AS ""Department"",""emp"".""name"" AS ""employee"",""emp"".""salary"" AS ""salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentID"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""salary"" DESC) AS ""dnsrnk"" FROM ""Employee"") AS ""emp"" JOIN ""Department"" AS ""dept"" ON ""dept"".""id""=""emp"".""DepartmentID"" WHERE ""emp"".""dnsrnk""<4"
178,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_level"" FROM ""employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""id"") AS ""c"" WHERE ""salary_level""<=3"
179,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""NAME"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""rk""<=3"
180,"WITH ""cte"" AS (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rnk""<4"
181,"WITH ""tE"" AS (SELECT ""e1"".""departmentid"",""e1"".""salary"",""e1"".""name"" FROM ""employee"" AS ""e1"" LEFT JOIN ""employee"" AS ""e2"" ON ""e1"".""departmentid""=""e2"".""departmentid"" AND ""e1"".""salary""<""e2"".""salary"" GROUP BY ""e1"".""departmentid"",""e1"".""salary"",""e1"".""name"" HAVING COUNT(DISTINCT ""e2"".""salary"")<3) SELECT ""d"".""name"" AS ""Department"",""tE"".""name"" AS ""Employee"",""tE"".""salary"" AS ""Salary"" FROM ""tE"" JOIN ""department"" AS ""d"" ON ""tE"".""departmentid""=""d"".""id"""
182,"WITH ""E"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ""Department"" AS ""D"" JOIN ""E"" ON ""D"".""Id""=""E"".""DepartmentId"" WHERE ""E"".""rnk""<=3"
183,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""t"" WHERE ""salary_rank""<=3"
184,"SELECT ""Employee"",""Department"",""Salary"" FROM (SELECT ""Employee"".""Name"" AS ""Employee"",""Department"".""Name"" AS ""Department"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Salary"" DESC) AS ""Ranking"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"") AS ""Emp2"" WHERE ""Ranking""=1 OR ""Ranking""=2 OR ""Ranking""=3"
185,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""rango"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""ID""=""e"".""DepartmentID"") AS ""a"" WHERE ""a"".""rango""<4"
186,"SELECT ""dp"".""Name"" AS ""Department"",""ep"".""Name"" AS ""Employee"",""ep"".""Salary"" AS ""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""ep"" JOIN ""Department"" AS ""dp"" ON ""dp"".""Id""=""ep"".""DepartmentId"" WHERE ""ep"".""rnk""<4 ORDER BY ""DepartmentId"",""Salary"""
187,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Department"" AS ""d"") JOIN (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rn"",""Name"",""Salary"",""DepartmentId"" FROM ""Employee"") AS ""e"" WHERE ""e"".""DepartmentId""=""d"".""Id"" AND ""e"".""rn""<=3"
188,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""E"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" ORDER BY 1) AS ""tab1"" WHERE ""rnk"" IN (1,2,3)"
189,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""rn"" FROM ""department"" AS ""d"" JOIN ""employee"" AS ""e"" ON ""d"".""id""=""e"".""departmentid"") AS ""a"" WHERE ""rn""<=3"
190,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""DeptPayRank""<=3"
191,"SELECT ""r"".""dept"" AS ""Department"",""r"".""name"" AS ""Employee"",""r"".""salary"" AS ""Salary"" FROM (SELECT ""e"".""Name"" AS ""name"",""e"".""Salary"" AS ""salary"",""d"".""Name"" AS ""dept"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""r"" WHERE ""r"".""salary_rank""<=3"
192,"WITH ""CTE"" AS (SELECT ""d1"".""Name"" AS ""Employee"",""d1"".""Salary"",""d2"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""d2"".""Name"" ORDER BY ""d1"".""Salary"" DESC) AS ""ranking"" FROM ""Employee"" AS ""d1"" JOIN ""Department"" AS ""d2"" ON ""d1"".""DepartmentId""=""d2"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""CTE"" WHERE ""ranking"" IN (1,2,3)"
193,"WITH ""base"" AS (SELECT ""a"".*,""b"".""Name"" AS ""Department"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"",""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""base"") AS ""a"" WHERE ""rnk""<=3"
194,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Department"" AS ""d"" JOIN ""Employee"" AS ""e1"" ON ""d"".""Id""=""e1"".""DepartmentId"") JOIN ""Employee"" AS ""e2"" ON ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" GROUP BY 1,""e1"".""DepartmentId"",""e1"".""Name"" HAVING COUNT(DISTINCT ""e2"".""Salary"")<=3"
195,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""de"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""de""<=3"
196,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""temp"" WHERE ""rnk""<=3"
197,"WITH ""t1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salaryRank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM ""t1"" JOIN ""Department"" ON ""Department"".""Id""=""t1"".""DepartmentId"" WHERE ""salaryRank""<=3 ORDER BY ""Department"",""Salary"" DESC"
198,"WITH ""TEMP"" AS (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"" AS ""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM (""EMPLOYEE"" AS ""E"") JOIN ""DEPARTMENT"" AS ""D"" WHERE ""E"".""DEPARTMENTID""=""D"".""ID"") SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM ""TEMP"" WHERE ""RNK""<=3"
199,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rownum"",""DepartmentId"",""Salary"",""Name"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rownum""<4 ORDER BY ""department"""
200,"WITH ""temp_tbl"" AS (SELECT ""d"".""name"" AS ""Department"",""i"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM (""employee"" AS ""i"") JOIN ""department"" AS ""d"" WHERE ""i"".""departmentid""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""temp_tbl"" WHERE ""rnk""<4"
201,"SELECT ""ranked"".""Department"",""ranked"".""NAME"" AS ""Employee"",""ranked"".""Salary"" AS ""Salary"" FROM (SELECT ""Employee"".*,""Department"".""NAME"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""ID"") AS ""ranked"" WHERE ""ranks""<=3"
202,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""number"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""x"" WHERE ""number""=1 OR ""number""=2 OR ""number""=3"
203,"WITH ""t"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""t"" WHERE ""rnk""<=3"
204,"SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"" WHERE ROW(""Employee"".""ID"",""Employee"".""Salary"") IN (SELECT ""ID"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"") AS ""temp"" WHERE ""salary_rank""<=3)"
205,"SELECT ""Department"".""Name"" AS ""Department"",""Ranked"".""Name"" AS ""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""PayRank"" FROM ""EMPLOYEE"") AS ""RANKED"" JOIN ""DEPARTMENT"" ON ""RANKED"".""DEPARTMENTID""=""DEPARTMENT"".""ID"" WHERE ""PayRank""<=3"
206,"WITH ""Dept_Emp"" AS (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""Salary"" FROM ""Department"" AS ""D"" JOIN ""Employee"" AS ""E"" ON ""D"".""Id""=""E"".""DepartmentId"") SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"",""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Dept_Emp"") AS ""aa"" WHERE ""aa"".""ranks""<=3"
207,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salaryRank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""s"" WHERE ""salaryRank""<4"
208,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""rn"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""ID"") AS ""z"" WHERE ""rn"" IN (1,2,3)"
209,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rank_inner"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""a"".""rank_inner""<=3"
210,"SELECT ""c"".""Department"",""c"".""Employee"",""c"".""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""dept_salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""id"") AS ""c"" WHERE ""c"".""dept_salary_rank""<=3"
211,"WITH ""emp_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""emp_rank"" WHERE ""salary_rank""<4"
212,"SELECT ""d"".""name"" AS ""Department"",""tab"".""name"" AS ""Employee"",""tab"".""salary"" AS ""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank_aa"" FROM ""employee"") AS ""tab"" JOIN ""department"" AS ""d"" ON ""tab"".""DepartmentId""=""d"".""id"" WHERE ""tab"".""rank_aa""<4"
213,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""DeptPayRank""<=3"
214,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""ranked_salaries"" WHERE ""salary_rank""<=3"
215,"SELECT ""d"".""name"" AS ""Department"",""A"".""name"" AS ""Employee"",""A"".""salary"" AS ""Salary"" FROM (SELECT ""departmentid"",""name"",""id"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""salary_order"" FROM ""employee"" AS ""e"") AS ""A"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""A"".""departmentid"" WHERE ""A"".""salary_order""<=3"
216,"WITH ""cte"" AS (SELECT ""a"".""name"" AS ""Employee"",""a"".""salary"",""b"".""name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""b"".""name"" ORDER BY ""a"".""salary"" DESC) AS ""rank_s"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""id"") SELECT ""Department"",""Employee"",""salary"" FROM ""cte"" WHERE ""rank_s""<=3 ORDER BY ""Department"",""rank_s"""
217,"WITH ""Final"" AS (SELECT ""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"",""D"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""rk"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""Final"" WHERE ""rk""<=3"
218,"WITH ""RANKING"" AS (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Employee"".""Salary"" DESC) AS ""RANKS"" FROM (""Department"") JOIN ""Employee"" WHERE ""Employee"".""DepartmentId""=""Department"".""ID"") SELECT ""Department"",""Employee"",""Salary"" FROM ""Ranking"" WHERE ""ranks""<4"
219,"WITH ""Sal_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",(DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC)) AS ""rk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""s"".""Department"",""s"".""Employee"",""s"".""Salary"" FROM ""Sal_rank"" AS ""s"" WHERE ""rk""<=3"
220,"WITH ""temp"" AS (SELECT ""a"".""name"",""a"".""salary"",""departmentid"",CASE WHEN @""c""=0 THEN @""b"":=1 WHEN @""a""=""departmentid"" AND @""d""!=""salary"" THEN @""b"":=@""b""+1 WHEN @""a""=""departmentid"" AND @""d""=""salary"" THEN @""b"":=@""b"" ELSE @""b"":=1 END AS ""counter"",@""a"":=""departmentid"",@""d"":=""salary"",@""c"":=@""c""+1 FROM (""Employee"" AS ""a"") JOIN (SELECT @""a"":=0,@""b"":=0,@""c"":=0,@""d"":=0) AS ""x"" ORDER BY ""a"".""departmentid"",""a"".""salary"" DESC) SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" AS ""Salary"" FROM ""temp"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""a"".""counter""<=3"
221,"WITH ""employee_salary_rank"" AS (SELECT ""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""salary_rank"",""b"".""name"" AS ""Department"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""employee_salary_rank"" WHERE ""salary_rank""<=3"
222,"SELECT ""dep"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" AS ""Salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""emp"" JOIN (SELECT * FROM ""Department"") AS ""dep"" ON ""emp"".""DepartmentId""=""dep"".""Id"" WHERE ""emp"".""rnk""<4"
223,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""dense_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""sub"" WHERE ""dense_rank""<=3"
224,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""r"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""tmp"" WHERE ""r""<=3"
225,"SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""employee"",""a"".""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""id"" WHERE ""a"".""rnk""<=3"
226,"SELECT ""B"".""Name"" AS ""Department"",""A"".""Name"" AS ""Employee"",""A"".""Salary"" FROM (SELECT ""ID"",""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salrank"" FROM ""Employee"") AS ""A"" JOIN ""Department"" AS ""B"" ON (""A"".""DepartmentId""=""B"".""Id"") WHERE ""A"".""salrank""<4"
227,"WITH ""T1"" AS (SELECT ""departmentid"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank1"" FROM ""employee"") SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"" FROM ""T1"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""a"".""rank1""<=3"
228,"WITH ""CTE"" AS (SELECT ""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""Salary"" DESC) AS ""ranked_sal_by_dept"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""cte"".""name"" AS ""Employee"",""Salary"" FROM ""CTE"" JOIN ""department"" AS ""d"" ON ""cte"".""departmentid""=""d"".""id"" WHERE ""ranked_sal_by_dept""<=3"
229,"SELECT ""temp"".""Name"" AS ""Employee"",""temp"".""Salary"",""d"".""Name"" AS ""Department"" FROM (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank_sal"" FROM ""Employee"") AS ""temp"" JOIN ""Department"" AS ""d"" ON ""temp"".""DepartmentId""=""d"".""Id"" AND ""rank_sal""<4"
230,"SELECT ""D"".""Name"" AS ""Department"",""Em"".""Name"" AS ""Employee"",""Em"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Deptrank"" FROM ""Employee"" AS ""e"") AS ""Em"" JOIN ""Department"" AS ""D"" ON ""Em"".""DepartmentId""=""D"".""id"" WHERE ""Deptrank""<=3"
231,"SELECT ""d"".""name"" AS ""department"",""t"".""name"" AS ""employee"",""salary"" FROM (SELECT ""departmentId"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""salary"" DESC) AS ""ranking"" FROM ""employee"") AS ""t"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""t"".""departmentid"" WHERE ""ranking""<=3 ORDER BY ""department"""
232,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Salary_Rank"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""subquery"" WHERE ""subquery"".""Salary_Rank""<=3 ORDER BY ""Department"",""Salary_Rank"""
233,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM ((""Department"" AS ""D"") JOIN ""Employee"" AS ""E"") JOIN ""Employee"" AS ""E2"" WHERE ""D"".""id""=""e"".""departmentid"" AND ""e"".""departmentid""=""e2"".""departmentid"" AND ""e"".""salary""<=""e2"".""salary"" GROUP BY ""d"".""id"",""e"".""name"" HAVING COUNT(DISTINCT ""e2"".""salary"")<=3 ORDER BY ""d"".""name"",""e"".""salary"" DESC"
234,"WITH ""T1"" AS (SELECT * FROM (SELECT ""Salary"",""DepartmentId"",ROW_NUMBER() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"") AS ""Rownum"" FROM (SELECT ""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"") AS ""X"" WHERE ""r""<=3) AS ""Y"" WHERE ""Y"".""Rownum""=1) SELECT ""e"".""Name"" AS ""Employee"",""d"".""Name"" AS ""Department"",""e"".""Salary"" FROM (""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") LEFT JOIN ""T1"" AS ""t"" ON ""e"".""DepartmentId""=""t"".""DepartmentId"" WHERE ""e"".""Salary"">=""t"".""Salary"" AND ""d"".""Name"" IS NOT NULL"
235,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SalaryRank"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""D"".""ID""=""E"".""DepartmentId"") AS ""a"" WHERE ""SalaryRank""<=3"
236,"SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" FROM (""Employee"" JOIN ""Department"" ON ""Department"".""Id""=""Employee"".""DepartmentId"") JOIN (SELECT ""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""RowRank"" FROM ""Employee"") AS ""RK"" ON ""RK"".""DepartmentId""=""Department"".""Id"" AND ""Employee"".""Salary""=""RK"".""Salary"" WHERE ""RK"".""RowRank""<=3 GROUP BY ""Department"".""Name"",""Employee"".""Salary"",""Employee"".""Name"""
237,"SELECT ""tb"".""Name"" AS ""Department"",""tc"".""Name"" AS ""Employee"",""tc"".""topsalary"" AS ""Salary"" FROM (SELECT ""departmentid"",""salary"" AS ""topsalary"",""name"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""num"" FROM ""employee"") AS ""tc"" JOIN ""Department"" AS ""tb"" ON ""tc"".""departmentid""=""tb"".""id"" WHERE ""tc"".""num""<=3"
238,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Employee"" AS ""e1"" LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""Salary""<=""e2"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" GROUP BY ""d"".""Name"",""e1"".""Name"" HAVING COUNT(DISTINCT ""e2"".""DepartmentId"", ""e2"".""Salary"")<=3"
239,"SELECT ""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"" WHERE ""ranks""<=3"
240,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""tmp"" WHERE ""rnk""<=3"
241,"SELECT ""ranked"".""Department"",""ranked"".""NAME"" AS ""Employee"",""ranked"".""Salary"" AS ""Salary"" FROM (SELECT ""Employee"".*,""Department"".""NAME"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""ID"") AS ""ranked"" WHERE ""ranks""<=3"
242,"WITH ""added_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""SALARY"" DESC) AS ""rank_number"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""added_rank"" WHERE ""rank_number""<=3"
243,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""a"".""DeptRank""<=3"
244,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""Id"" ORDER BY ""E"".""Salary"" DESC) AS ""Rnk"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""T"" WHERE ""Rnk""<=3"
245,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""e"".""departmentid"") AS ""x"" WHERE ""x"".""rnk""<=3"
246,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
247,"SELECT ""D"".""name"" AS ""department"",""E"".""name"" AS ""employee"",""E"".""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank_sal"" FROM ""employee"") AS ""E"" JOIN ""department"" AS ""d"" ON ""D"".""id""=""E"".""departmentid"" WHERE ""rank_sal""<=3"
248,"WITH ""ranking"" AS (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""salary"" DESC) AS ""r"" FROM ""department"" AS ""d"" JOIN ""employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"") SELECT ""department"",""employee"",""salary"" FROM ""ranking"" WHERE ""r""<=3"
249,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
250,"SELECT ""RES"".""Department"",""RES"".""Employee"",""RES"".""Salary"" FROM (SELECT ""D"".""NAME"" AS ""Department"",""E"".""NAME"" AS ""Employee"",""E"".""SALARY"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""DEP_TOP"" FROM (""EMPLOYEE"" AS ""E"") JOIN ""DEPARTMENT"" AS ""D"" WHERE ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""RES"" WHERE ""RES"".""DEP_TOP""<=3"
251,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ((""Department"" AS ""D"") JOIN ""Employee"" AS ""E"") JOIN ""Employee"" AS ""E2"" WHERE ""D"".""Id""=""E"".""DepartmentId"" AND ""E"".""departmentId""=""E2"".""DepartmentId"" AND ""E"".""Salary""<=""E2"".""Salary"" GROUP BY ""D"".""Name"",""E"".""Name"",""E"".""Salary"" HAVING COUNT(DISTINCT ""E2"".""Salary"")<=3 ORDER BY ""D"".""name"",""E"".""salary"" DESC"
252,"WITH ""cte"" AS (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""SALARY"" DESC) AS ""rnk"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""cte"".""Department"",""cte"".""Employee"",""cte"".""Salary"" FROM ""cte"" WHERE ""cte"".""rnk""<=3"
253,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"") LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" GROUP BY ""e1"".""Id"" HAVING COUNT(DISTINCT ""e2"".""Salary"")<=3 ORDER BY ""e1"".""DepartmentId"",""e1"".""Salary"" DESC"
254,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""S_Rank"" FROM ""Employee"") AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE ""S_Rank"" BETWEEN 1 AND 3"
255,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""DR"",""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""DR"" IN (1,2,3)"
256,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM ""Department"" AS ""d"" JOIN (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE ""rnk""<4"
257,"SELECT ""t1"".""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""t1"" WHERE ""t1"".""rnk""<=3"
258,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""a"".""DeptRank""<=3"
259,"SELECT ""department"",""Employee"",""salary"" FROM (SELECT ""d"".""Name"" AS ""department"",""e"".""Name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ran"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""ran""<4"
260,"SELECT ""d"".""Name"" AS ""Department"",""tmp"".""Employee"" AS ""Employee"",""tmp"".""Salary"" AS ""Salary"" FROM ""Department"" AS ""d"" JOIN (SELECT ""e1"".""Name"" AS ""Employee"",""e1"".""Salary"",""e1"".""DepartmentId"" FROM (""Employee"" AS ""e1"") JOIN ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">=""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"" GROUP BY ""e1"".""Id"" HAVING COUNT(DISTINCT ""e2"".""Salary"")<=3) AS ""tmp"" ON ""tmp"".""DepartmentId""=""d"".""Id"""
261,"SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" FROM ((SELECT ""DepartmentId"",MIN(""Salary"") AS ""Salary"" FROM (SELECT ""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""row_num"" FROM ""Employee"") AS ""temp_temp_table"" WHERE ""row_num""<4 GROUP BY ""DepartmentId"") AS ""temp_table"" JOIN ""Department"") JOIN ""Employee"" ON ""temp_table"".""DepartmentId""=""Department"".""Id"" AND ""Employee"".""DepartmentId""=""temp_table"".""DepartmentId"" AND ""Employee"".""Salary"">=""temp_table"".""Salary"""
262,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
263,"WITH ""topThree"" AS (SELECT ""e"".""salary"" AS ""Salary"",""e"".""Name"" AS ""Employee"",""d"".""name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentId"" ORDER BY ""e"".""salary"" DESC) AS ""ranking"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""topThree"" WHERE ""ranking"" IN (1,2,3)"
264,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",""E"".""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""table_rank"" WHERE ""ranking""<=3"
265,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"") JOIN (SELECT ""Id"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") AS ""r"" ON ""e"".""Id""=""r"".""Id"" AND ""d"".""Id""=""r"".""DepartmentId"" WHERE ""r"".""rank""=1 OR ""r"".""rank""=2 OR ""r"".""rank""=3"
266,"WITH ""cte"" AS (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rank_num"" IN (1,2,3)"
267,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
268,"WITH ""top_3"" AS (SELECT ""a"".""Id"",""a"".""Salary"",""a"".""DepartmentId"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Employee"" AS ""b"" ON ""a"".""Salary""<""b"".""Salary"" AND ""a"".""DepartmentId""=""b"".""DepartmentId"" GROUP BY ""a"".""Id"" HAVING COUNT(DISTINCT ""b"".""Salary"")+1<=3) SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE ROW(""a"".""Salary"",""a"".""DepartmentId"") IN (SELECT ""Salary"",""DepartmentId"" FROM ""top_3"")"
269,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""e"" JOIN (SELECT ""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""row_cnt"" FROM (SELECT ""DepartmentId"",""Salary"" FROM ""Employee"" GROUP BY ""DepartmentId"",""Salary"") AS ""a"") AS ""b"" ON ""e"".""DepartmentId""=""b"".""DepartmentId"" AND ""e"".""Salary""=""b"".""Salary"") JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""b"".""row_cnt""<=3"
270,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Employee"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"") AS ""e"" WHERE ""rnk""<=3"
271,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ((""Department"" AS ""D"") JOIN ""Employee"" AS ""E"") JOIN ""Employee"" AS ""E2"" WHERE ""D"".""Id""=""E"".""DepartmentId"" AND ""E"".""departmentId""=""E2"".""DepartmentId"" AND ""E"".""Salary""<=""E2"".""Salary"" GROUP BY ""D"".""Name"",""E"".""Name"",""E"".""Salary"" HAVING COUNT(DISTINCT ""E2"".""Salary"")<=3 ORDER BY ""D"".""name"",""E"".""salary"" DESC"
272,"WITH ""rank_sal_dt"" AS (SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""name"" ORDER BY ""a"".""salary"" DESC) AS ""rank_salary"" FROM ""Employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""rank_sal_dt"" WHERE ""rank_salary""<=3 ORDER BY ""Department"",""Salary"" DESC,""Employee"""
273,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
274,"SELECT ""d"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"") JOIN ""Department"" AS ""d"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" AND ""d"".""id""=""e2"".""DepartmentId"" GROUP BY ""d"".""name"",""e1"".""id"" HAVING COUNT(DISTINCT (""e2"".""Salary""))<=3 ORDER BY ""d"".""name"",""salary"" DESC"
275,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>=(SELECT COUNT(1) FROM (SELECT DISTINCT ""Salary"" AS ""s"",""DepartmentId"" AS ""y"" FROM ""Employee"") AS ""t"" WHERE ""e"".""Salary""<=""s"" AND ""e"".""DepartmentId""=""y"")"
276,"WITH ""emp"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"") SELECT ""A"".""Name"" AS ""Department"",""B"".""Name"" AS ""Employee"",""B"".""Salary"" AS ""Salary"" FROM ""Department"" AS ""A"" JOIN ""emp"" AS ""B"" ON ""B"".""Rank""<=3 AND ""A"".""Id""=""B"".""DepartmentId"""
277,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""RANK_SALARY"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"") AS ""SQ"" WHERE ""SQ"".""RANK_SALARY""<=3 ORDER BY ""Department"""
278,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""e"".""salary"" DESC) AS ""salary_order"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""b"" ON ""e"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""salary_order""<=3 AND ""department"" IS NOT NULL ORDER BY ""Department"",""Salary"" DESC"
279,"WITH ""salary_rank"" (""Id"", ""Ranking"") AS (SELECT ""Id"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) FROM ""Employee"") SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""E"" NATURAL JOIN ""salary_rank"") JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE ""salary_rank"".""Ranking""<=3"
280,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rownum"",""DepartmentId"",""Salary"",""Name"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rownum""<4 ORDER BY ""department"""
281,"SELECT ""d"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"") JOIN ""Department"" AS ""d"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" AND ""d"".""Id""=""e2"".""DepartmentId"" GROUP BY ""d"".""name"",""e1"".""id"" HAVING COUNT(DISTINCT (""e2"".""Salary""))<=3 ORDER BY ""d"".""name"",""salary"" DESC"
282,"SELECT ""d"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"") JOIN ""Department"" AS ""d"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" AND ""d"".""id""=""e2"".""DepartmentId"" GROUP BY ""d"".""name"",""e1"".""id"" HAVING COUNT(DISTINCT (""e2"".""Salary""))<=3 ORDER BY ""d"".""name"",""salary"" DESC"
283,"WITH ""mmm"" AS (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""mmm"" WHERE ""rnk"" IN (1,2,3)"
284,"SELECT ""d"".""name"" AS ""Department"",""temp"".""name"" AS ""Employee"",""temp"".""salary"" FROM (SELECT ""name"",""salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""temp"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""temp"".""DepartmentId"" WHERE ""ranks""<=3"
285,"WITH ""a"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" AS ""Salary"" FROM ""department"" AS ""d"" LEFT JOIN ""a"" ON ""d"".""id""=""a"".""departmentid"" WHERE ""rk""<=3"
286,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT ""name"",""salary"",""departmentId"",DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"") AS ""e"" LEFT JOIN ""department"" AS ""d"" ON ""d"".""id""=""e"".""departmentid"" WHERE ""e"".""rk""<=3 AND ""d"".""name"" IS NOT NULL"
287,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Employee"",""E"".""Salary"" FROM (SELECT ""Name"" AS ""Employee"",""Salary"" AS ""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""myrank"" FROM ""Employee"") AS ""E"" JOIN ""Department"" AS ""D"" ON ""D"".""Id""=""E"".""DepartmentId"" WHERE ""myrank""<4"
288,"WITH ""Top3_Salary"" AS (SELECT * FROM (SELECT *,RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM (SELECT DISTINCT ""Salary"",""DepartmentId"" FROM ""Employee"") AS ""t"") AS ""t1"" WHERE ""salary_rank""<=3) SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ROW(""Salary"",""DepartmentId"") IN (SELECT ""Salary"",""DepartmentId"" FROM ""Top3_Salary"")"
289,"SELECT ""d"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"" AS ""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""id"" WHERE ""rnk""<=3 GROUP BY 1,2,3 ORDER BY 1,2,3 DESC"
290,"SELECT DISTINCT ""t3"".""Department"",""t4"".""Name"" AS ""Employee"",""t4"".""Salary"" FROM (SELECT ""t2"".""Name"" AS ""Department"",""t2"".""Id"" AS ""DepartmentId"",""t1"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""t2"".""Id"" ORDER BY ""t1"".""Salary"" DESC) AS ""Salary_rank"" FROM ""Employee"" AS ""t1"" JOIN ""Department"" AS ""t2"" ON ""t1"".""DepartmentId""=""t2"".""Id"") AS ""t3"" JOIN ""Employee"" AS ""t4"" ON ""t3"".""DepartmentId""=""t4"".""DepartmentId"" AND ""t4"".""Salary"">=""t3"".""Salary"" AND ""t3"".""Salary_rank""<=3"
291,"WITH ""max_salaries"" AS (SELECT ""id"",""salary"" FROM (SELECT ""departmentId"" AS ""id"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rn"" FROM ""Employee"" GROUP BY 1,2) AS ""a"" WHERE ""rn""<4) SELECT DISTINCT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM (""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") LEFT JOIN ""max_salaries"" AS ""ms"" ON ""e"".""DepartmentId""=""ms"".""id"" WHERE ""e"".""salary"">=""ms"".""salary"""
292,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Department"" AS ""d"" JOIN ""Employee"" AS ""e1"" ON ""d"".""Id""=""e1"".""DepartmentId"") JOIN ""Employee"" AS ""e2"" ON ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" GROUP BY ""e1"".""Id"" HAVING COUNT(DISTINCT ""e2"".""Salary"")<=3"
293,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ((""Department"" AS ""D"") JOIN ""Employee"" AS ""E"") JOIN ""Employee"" AS ""E2"" WHERE ""D"".""ID""=""E"".""DepartmentId"" AND ""E"".""DepartmentId""=""E2"".""DepartmentId"" AND ""E"".""Salary""<=""E2"".""Salary"" GROUP BY ""D"".""ID"",""E"".""Name"" HAVING COUNT(DISTINCT ""E2"".""Salary"")<=3 ORDER BY ""D"".""Name"",""E"".""Salary"" DESC"
294,"WITH ""Sal_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",(DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC)) AS ""rk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""s"".""Department"",""s"".""Employee"",""s"".""Salary"" FROM ""Sal_rank"" AS ""s"" WHERE ""rk""<=3"
295,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"") AS ""tmp"" WHERE ""rk""<=3"
296,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE ""salary_rank""<4"
297,"SELECT ""top"".""Department"",""top"".""Employee"",""top"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Salary"",""e"".""Name"" AS ""Employee"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""d_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""top"" WHERE ""d_rank""<=3"
298,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""ranks""<=3"
299,"WITH ""rank_salary"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""dr"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""rs"".""name"" AS ""Employee"",""rs"".""Salary"" FROM ""rank_salary"" AS ""rs"" JOIN ""department"" AS ""d"" ON ""rs"".""departmentid""=""d"".""id"" WHERE ""rs"".""dr"" IN (1,2,3)"
300,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"") AS ""X"" WHERE ""X"".""Rank""<=3"
301,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""Salary"" DESC) AS ""Salary_rank"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""Salary_rank""<=3 AND ""Department"" IS NOT NULL AND ""Employee"" IS NOT NULL"
302,"SELECT ""t2"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"" AS ""e"") AS ""t1"" JOIN ""Department"" AS ""t2"" ON ""t2"".""Id""=""t1"".""DepartmentId"" WHERE ""DeptPayRank""<=3"
303,"WITH ""ranked_salaries"" AS (SELECT ""Name"" AS ""Employee"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""Employee"",""Salary"" FROM ""ranked_salaries"" JOIN ""Department"" ON (""ranked_salaries"".""DepartmentId""=""Department"".""Id"") WHERE ""rank""<=3"
304,"SELECT ""tbl"".""Department"",""tbl"".""Employee"",""tbl"".""Salary"" FROM (SELECT ""dep"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""dep"".""Name"" ORDER BY ""emp"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""emp"" JOIN ""Department"" AS ""dep"" ON ""dep"".""id""=""emp"".""DepartmentId"") AS ""tbl"" WHERE ""tbl"".""rnk""<=3"
305,"SELECT ""d"".""name"" AS ""department"",""a"".""name"" AS ""Employee"",""Salary"" FROM ""Department"" AS ""d"" JOIN (SELECT ""Id"",""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""Rank_"" FROM ""Employee"") AS ""a"" ON ""d"".""id""=""a"".""departmentId"" WHERE ""Rank_""<=3"
306,"WITH ""ranked"" AS (SELECT ""id"",""name"",""Salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""sal_rank"" FROM ""employee""), ""high_earners"" AS (SELECT ""id"",""name"",""salary"",""departmentid"" FROM ""ranked"" WHERE ""sal_rank""<=3) SELECT ""d"".""Name"" AS ""Department"",""h"".""name"" AS ""Employee"",""h"".""Salary"" AS ""Salary"" FROM ""high_earners"" AS ""h"" JOIN ""department"" AS ""d"" ON ""h"".""departmentid""=""d"".""id"""
307,"SELECT ""q"".""department"",""q"".""employee"",""q"".""Salary"" FROM (SELECT ""salary"" AS ""Salary"",""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranking"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""q"" WHERE ""q"".""ranking"" IN (1,2,3)"
308,"SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"" FROM (""Employee"") JOIN ""Department"" WHERE ""Employee"".""DepartmentId""=""Department"".""Id"" AND ""Employee"".""Id"" NOT IN (SELECT ""D"".""Id"" FROM (((""Employee"" AS ""A"") JOIN ""Employee"" AS ""B"") JOIN ""Employee"" AS ""C"") JOIN ""Employee"" AS ""D"" WHERE ""A"".""Salary"">""B"".""Salary"" AND ""B"".""Salary"">""C"".""Salary"" AND ""C"".""Salary"">""D"".""Salary"" AND ""A"".""DepartmentId""=""B"".""DepartmentId"" AND ""A"".""DepartmentId""=""C"".""DepartmentId"" AND ""A"".""DepartmentId""=""D"".""DepartmentId"")"
309,"SELECT ""SQ2"".""Name"" AS ""Department"",""SQ2"".""EName"" AS ""Employee"",""SQ2"".""Salary"" FROM (SELECT ""SQ1"".""Name"",""SQ1"".""EName"",""SQ1"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""SQ1"".""Name"" ORDER BY ""SQ1"".""SALARY"" DESC) AS ""sal_rank"" FROM (SELECT ""E"".""ID"" AS ""EID"",""E"".""Name"" AS ""EName"",""E"".""Salary"",""E"".""DepartmentID"",""D"".""Id"",""D"".""Name"" FROM ""Employee"" AS ""E"" LEFT JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentID""=""D"".""ID"") AS ""SQ1"" ORDER BY ""SQ1"".""Name"",""SQ1"".""Salary"" DESC,""SQ1"".""EName"") AS ""SQ2"" WHERE ""SQ2"".""sal_rank""<=3 AND ""SQ2"".""Name"" IS NOT NULL"
310,"SELECT ""tmpRNk"".""DeptName"" AS ""Department"",""tmpRNK"".""Name"" AS ""Employee"",""tmpRNK"".""Salary"" AS ""Salary"" FROM (SELECT ""Employee"".""Name"",""Salary"",""Department"".""Name"" AS ""DeptName"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM (""Employee"") JOIN ""Department"" WHERE ""Employee"".""DepartmentId""=""Department"".""Id"") AS ""tmpRNK"" WHERE ""rnk""<=3"
311,"SELECT ""Department"".""Name"" AS ""Department"",""rankTbl"".""Name"" AS ""Employee"",""rankTbl"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SalRank"" FROM ""Employee"") AS ""rankTbl"" JOIN ""Department"" ON ""rankTbl"".""DepartmentId""=""Department"".""Id"" WHERE ""rankTbl"".""SalRank""<=3"
312,"WITH ""All_Employee"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentID"" ORDER BY ""salary"" DESC) AS ""rank_employee"" FROM ""Employee"") SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ""All_Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentID""=""D"".""ID"" WHERE ""rank_employee""<=3"
313,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Id"",""e"".""Name"" AS ""Employee"",""d"".""Name"" AS ""Department"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""SALARY"" DESC) AS ""rank1"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""d1"" WHERE ""rank1""<=3"
314,"SELECT ""Department"",""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""e"".*,""d"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""rnk""=1 OR ""rnk""=2 OR ""rnk""=3"
315,"WITH ""Employee_salary_ranked"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""SALARY"" DESC) AS ""salary_rank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee_salary_ranked"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""salary_rank"" IN (1,2,3) ORDER BY 3 DESC"
316,"SELECT ""d"".""Name"" AS ""Department"",""t1"".""Employee"" AS ""Employee"",""t1"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".""DepartmentId"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rank_"" FROM ""Employee"" AS ""e"") AS ""t1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""t1"".""DepartmentId"" WHERE ""t1"".""rank_""<=3"
317,"SELECT ""D"".""Name"" AS ""Department"",""A"".""Name"" AS ""Employee"",""A"".""Salary"" FROM ""Department"" AS ""D"" JOIN (SELECT ""E1"".""DepartmentID"",""E1"".""Name"",""E1"".""Salary"",COUNT(DISTINCT ""E2"".""SALARY"") AS ""rnk"" FROM ""Employee"" AS ""E1"" JOIN ""Employee"" AS ""E2"" ON ""E1"".""DepartmentID""=""E2"".""DepartmentID"" WHERE ""E1"".""Salary""<=""E2"".""Salary"" GROUP BY ""E1"".""DepartmentId"",""E1"".""Name"",""E1"".""Salary"") AS ""A"" ON ""D"".""Id""=""A"".""DepartmentID"" WHERE ""rnk""<=3 ORDER BY ""Department"",""Salary"" DESC,""Employee"""
318,"SELECT ""dept"".""department"",""dept"".""employee"",""dept"".""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""dept"" WHERE ""dept"".""rank""<=3"
319,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""subquery"" WHERE ""rnk""<=3"
320,"WITH ""cte"" AS (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rank_num""=1 OR ""rank_num""=2 OR ""rank_num""=3"
321,"SELECT ""Department"",""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""e"".""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""ranked_salary"",""d"".""Name"" AS ""Department"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""tmp"" WHERE ""ranked_salary""<=3 ORDER BY 1,3 DESC"
322,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""rank""<4"
323,"WITH ""new"" AS (SELECT ""e"".""id"",""e"".""name"",""e"".""salary"",""e"".""departmentid"",""d"".""name"" AS ""department_name"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""ranking"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""department_name"" AS ""Department"",""name"" AS ""Employee"",""salary"" FROM ""new"" WHERE ""ranking""<=3 ORDER BY ""department_name"""
324,"WITH ""d1"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""drank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""d1"".""Salary"" FROM (""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") JOIN ""d1"" ON ""d1"".""DepartmentId""=""e"".""DepartmentId"" AND ""d1"".""Name""=""e"".""Name"" WHERE ""d1"".""drank""<=3"
325,"SELECT ""D"".""name"" AS ""department"",""E"".""name"" AS ""employee"",""E"".""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""D_rank"" FROM ""employee"" AS ""E"" ORDER BY ""departmentid"",""D_rank"") AS ""E"" JOIN ""department"" AS ""D"" ON ""D"".""id""=""E"".""departmentid"" WHERE ""D_rank""<=3"
326,"WITH ""cte"" AS (SELECT ""Name"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""c"".""Name"" AS ""Employee"",""c"".""Salary"" AS ""Salary"" FROM ""cte"" AS ""c"" JOIN ""Department"" AS ""d"" ON ""c"".""DepartmentId""=""d"".""id"" WHERE ""rnk""<4"
327,"WITH ""ranked"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""ranked"".""name"" AS ""Employee"",""ranked"".""Salary"" FROM ""ranked"" JOIN ""Department"" ON ""ranked"".""DepartmentId""=""Department"".""Id"" WHERE ""ranks"" IN (1,2,3)"
328,"WITH ""tbl"" AS (SELECT ""name"",""DepartmentId"",""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rn"" FROM ""employee"") SELECT ""d"".""name"" AS ""Department"",""tbl"".""name"" AS ""Employee"",""salary"" FROM ""tbl"" JOIN ""department"" AS ""d"" ON ""tbl"".""DepartmentId""=""d"".""id"" WHERE ""rn""=1 OR ""rn""=2 OR ""rn""=3"
329,"SELECT ""d"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" AS ""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""departmentID"" ORDER BY ""salary"" DESC) AS ""rank1"" FROM ""employee"" AS ""e"") AS ""a"" JOIN ""department"" AS ""d"" ON ""a"".""departmentid""=""d"".""id"" WHERE ""a"".""rank1""<=3"
330,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
331,"SELECT ""c"".""Department"",""c"".""Employee"",""c"".""Salary"" FROM (SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM (""employee"" AS ""a"") JOIN ""department"" AS ""b"" WHERE ""a"".""departmentid""=""b"".""id"") AS ""c"" WHERE ""rnk""<=3"
332,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM (""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") JOIN (SELECT ""e1"".""Id"",COUNT(DISTINCT ""e2"".""Salary"") AS ""rk"" FROM ""Employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""Salary""<=""e2"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"" GROUP BY 1) AS ""temp"" ON ""temp"".""Id""=""e"".""Id"" WHERE ""rk""<=3"
333,"SELECT ""Department"",""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SortedSalaryRank"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"") AS ""sub1"" WHERE ""SortedSalaryRank""<=3"
334,"SELECT ""d"".""department"",""d"".""employee"",""d"".""salary"" FROM (SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""name"" ORDER BY ""salary"" DESC) AS ""c"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") AS ""d"" WHERE ""c""<4"
335,"WITH ""E"" AS (SELECT ""e"".""Name"",""e"".""Salary"",""e"".""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""RNK"" FROM ""Employee"" AS ""e"") SELECT ""d"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ""E"" JOIN ""Department"" AS ""d"" ON ""E"".""DepartmentId""=""d"".""Id"" WHERE ""E"".""RNK""<=3"
336,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE (SELECT COUNT(DISTINCT (""Salary"")) FROM ""Employee"" WHERE ""DepartmentId""=""E"".""DepartmentId"" AND ""salary"">""E"".""Salary"")<3 ORDER BY ""E"".""DepartmentId"",""E"".""Salary"" DESC"
337,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""t"" WHERE ""t"".""rank""<=3"
338,"SELECT ""anon_1"".""department"" AS ""Department"",""anon_1"".""name"" AS ""Employee"",""anon_1"".""salary"" AS ""Salary"" FROM (SELECT ""e"".""name"",""e"".""salary"",""d"".""name"" AS ""department"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""salary_rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""anon_1"" WHERE ""anon_1"".""salary_rank""<=3"
339,"WITH ""tbl"" AS (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""tbl"" WHERE ""rnk""=1 OR ""rnk""=2 OR ""rnk""=3 ORDER BY ""department"",""salary"""
340,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"") AS ""e"", ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"" AND ""e"".""Rank""<4"
341,"WITH ""cte"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""RNK"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""RNK""<=3"
342,"SELECT ""t1"".""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Name"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""df"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t1"" WHERE ""t1"".""df""<=3"
343,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
344,"SELECT ""d"".""Name"" AS ""Department"",""f"".""Name"" AS ""Employee"",""f"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".""Name"",""e"".""Salary"",""e"".""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""Rank"" FROM ""Employee"" AS ""e"") AS ""f"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""f"".""DepartmentId"" WHERE ""f"".""Rank""<=3"
345,"WITH ""cte"" AS (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rank_num""=1 OR ""rank_num""=2 OR ""rank_num""=3"
346,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""c"".""Name"" AS ""Employee"",""c"".""Salary"" AS ""Salary"" FROM ""cte"" AS ""c"" JOIN ""Department"" AS ""d"" ON (""c"".""DepartmentId""=""d"".""Id"") WHERE ""c"".""rnk""<4"
347,"WITH ""distinct_salaries"" AS (SELECT DISTINCT ""DepartmentId"",""Salary"" FROM ""Employee"" ORDER BY ""Salary"" DESC), ""dept_sal_rank"" AS (SELECT ""DepartmentId"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Salary_Rank"" FROM ""distinct_salaries"") SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") JOIN ""dept_sal_rank"" AS ""c"" ON ""a"".""DepartmentId""=""c"".""DepartmentId"" AND ""a"".""Salary""=""c"".""Salary"" WHERE ""c"".""Salary_Rank""<=3"
348,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
349,"SELECT ""Department"",""Employee"",""salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""salary"" DESC) AS ""r"",""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""ranked"" WHERE ""r""<=3"
350,"SELECT ""Name"" AS ""Department"",""Employee"",""Salary"" FROM (SELECT ""Employee"",""DepartmentId"",""Salary"" FROM (SELECT ""Name"" AS ""Employee"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""RankVal"" FROM ""Employee"") AS ""a"" WHERE ""RankVal""<=3) AS ""b"" JOIN ""Department"" AS ""c"" ON (""b"".""DepartmentId""=""c"".""Id"")"
351,"SELECT ""d"".""Name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"",""Name"",""salary"",""departmentId"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""a"".""departmentid"" WHERE ""a"".""ranking""<=3"
352,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
353,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""departmentId""=""d"".""id"") AS ""a"" WHERE ""r""<=3 ORDER BY 1,3"
354,"SELECT ""d"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"") JOIN ""Department"" AS ""d"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<=""e2"".""Salary"" AND ""d"".""id""=""e2"".""DepartmentId"" GROUP BY ""d"".""name"",""e1"".""id"" HAVING COUNT(DISTINCT (""e2"".""Salary""))<=3"
355,"SELECT ""c"".""Department"",""c"".""Employee"",""c"".""Salary"" FROM (SELECT ""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""rnk"",""b"".""Name"" AS ""Department"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""ID"") AS ""c"" WHERE ""c"".""rnk""<=3"
356,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""a"".""Name"" AS ""Employee"",""b"".""Name"" AS ""Department"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""row_num"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""row_num""<=3 GROUP BY 1,2,3"
357,"WITH ""dense_prep"" AS (SELECT ""DepartmentId"",""Salary"" FROM ""Employee"" GROUP BY ""DepartmentId"",""Salary""), ""salary_rnk"" AS (SELECT ""DepartmentId"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""sal_dense_rnk"" FROM ""dense_prep"") SELECT ""c"".""Name"" AS ""Department"",""b"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (""salary_rnk"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""DepartmentId"" AND ""a"".""Salary""=""b"".""Salary"") JOIN ""Department"" AS ""c"" ON ""a"".""DepartmentId""=""c"".""Id"" WHERE ""a"".""sal_dense_rnk""<=3"
358,"WITH ""CTE"" AS (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM ""CTE"" WHERE ""RNK""<=3"
359,"SELECT ""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"" WHERE ""ranks""<=3"
360,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM (""department"" AS ""d"") JOIN (SELECT ""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""topsal"" FROM ""employee"") AS ""e"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""e"".""topsal"" IN (1,2,3)"
361,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
362,"SELECT ""t3"".""name"" AS ""department"",""t1"".""name"" AS ""employee"",""t1"".""salary"" FROM ""employee"" AS ""t1"" JOIN ""department"" AS ""t3"" ON ""t1"".""departmentid""=""t3"".""id"" WHERE (SELECT COUNT(DISTINCT ""t2"".""salary"") FROM ""employee"" AS ""t2"" WHERE ""t1"".""departmentid""=""t2"".""departmentid"" AND ""t2"".""salary"">""t1"".""salary"")<3"
363,"SELECT ""tD"".""Name"" AS ""Department"",""tE1"".""Name"" AS ""Employee"",""tE1"".""Salary"" FROM (""Employee"" AS ""tE1"" JOIN ""Department"" AS ""tD"" ON ""tE1"".""DepartmentId""=""tD"".""Id"") LEFT JOIN ""Employee"" AS ""tE2"" ON ""tE1"".""DepartmentId""=""tE2"".""DepartmentId"" AND ""tE1"".""Salary""<=""tE2"".""Salary"" GROUP BY ""tE1"".""DepartmentId"",""tE1"".""Id"" HAVING COUNT(DISTINCT ""tE2"".""Salary"")<=3 ORDER BY ""tE1"".""DepartmentId"",""tE1"".""Salary"" DESC"
364,"SELECT ""d"".""Name"" AS ""Department"",""t"".""name"" AS ""Employee"",""t"".""Salary"" FROM (SELECT ""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") AS ""t"" JOIN ""department"" AS ""d"" ON ""t"".""departmentid""=""d"".""id"" WHERE ""t"".""rnk""<4"
365,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Employee"" AS ""e"" RIGHT JOIN (SELECT ""Salary"",""DepartmentId"" FROM (SELECT ""Salary"",""DepartmentId"",COUNT(1) OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM (SELECT DISTINCT ""Salary"",""DepartmentId"" FROM ""Employee"") AS ""unique_salary"") AS ""with_rank"" WHERE ""rk""<=3) AS ""top_3"" ON ""e"".""Salary""=""top_3"".""Salary"" AND ""e"".""DepartmentId""=""top_3"".""DepartmentId"") LEFT JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE ""d"".""Name"" IS NOT NULL"
366,"SELECT ""d"".""Name"" AS ""Department"",""t1"".""Employee"" AS ""Employee"",""t1"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".""DepartmentId"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rank_"" FROM ""Employee"" AS ""e"") AS ""t1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""t1"".""DepartmentId"" WHERE ""t1"".""rank_""<=3"
367,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rownum"",""DepartmentId"",""Salary"",""Name"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rownum""<4 ORDER BY ""department"""
368,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""salary"" AS ""Salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""e"".""departmentId"" WHERE ROW(""departmentId"",""salary"") IN (SELECT DISTINCT ""departmentID"",""salary"" FROM (SELECT ""departmentId"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""salary"" DESC) AS ""salary_rank"" FROM ""employee"") AS ""a"" WHERE ""salary_rank""<=3)"
369,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
370,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""Salary"",""E"".""Name"" AS ""Employee"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""Salary"" DESC) AS ""ran"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""a"" WHERE ""ran""<=3"
371,"SELECT ""dp"".""Name"" AS ""Department"",""ep"".""Name"" AS ""Employee"",""ep"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Deptpayrank"" FROM ""Employee"" AS ""e"") AS ""ep"" JOIN ""Department"" AS ""dp"" ON ""dp"".""Id""=""ep"".""DepartmentID"" WHERE ""Deptpayrank""<=3"
372,"SELECT ""SalaryReport"".""Department"",""SalaryReport"".""Employee"",""SalaryReport"".""Salary"" FROM (SELECT ""B"".""Name"" AS ""Department"",""A"".""Name"" AS ""Employee"",COALESCE(""A"".""Salary"", 0) AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""A"".""DepartmentId"" ORDER BY COALESCE(""A"".""salary"", 0) DESC) AS ""Ranked_Salaries"" FROM ""Employee"" AS ""A"" LEFT JOIN ""Department"" AS ""B"" ON ""A"".""DepartmentId""=""B"".""ID"" WHERE ""B"".""Name"" IS NOT NULL) AS ""SalaryReport"" WHERE ""Ranked_Salaries""<4"
373,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""e1"".""DepartmentId"" AND ""e2"".""Salary"">""e1"".""Salary"")<3"
374,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rownum"",""DepartmentId"",""Salary"",""Name"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rownum""<4 ORDER BY ""department"""
375,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""tmp"" WHERE ""tmp"".""rnk""<=3"
376,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""DeptPayRank""<=3"
377,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""tmp"" WHERE ""tmp"".""rnk""<=3"
378,"WITH ""cte1"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""cte1"".""Name"" AS ""Employee"",""cte1"".""Salary"" AS ""Salary"" FROM ""cte1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""cte1"".""DepartmentId"" WHERE ""cte1"".""r"" IN (1,2,3)"
379,"WITH ""T"" AS (SELECT COALESCE(""d"".""Name"") AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""R"" FROM ""employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentID""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""t"" WHERE ""R""<=3 AND ""Department"" IS NOT NULL"
380,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""s"" WHERE ""rnk""<=3"
381,"SELECT ""d"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""salary"" FROM ""Employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""departmentId""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""departmentid""=""e2"".""departmentid"")"
382,"WITH ""dep_emp"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id""), ""ranking"" AS (SELECT ""Department"",""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""department"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""dep_emp"") SELECT ""Department"",""Employee"",""Salary"" FROM ""ranking"" WHERE ""r""<=3"
383,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e2"".""Salary"">""e1"".""Salary"")"
384,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE (SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")<3"
385,"SELECT ""t"".""Department"",""t"".""Employee"",""t"".""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""cnt"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""t"" WHERE ""t"".""cnt""<=3"
386,"ERROR: mysql parse error: line 1 column 5 near ""inner join Department d1 on e1.DepartmentId = d1.ID where 3 > (select count(distinct e2.salary) from Employee e2 where e2.Salary > e1.Salary and e1.DepartmentId = e2.DepartmentId)"" "
387,"SELECT ""Department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""drk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""drk""<=3"
388,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE (SELECT COUNT(DISTINCT (""Salary"")) FROM ""Employee"" WHERE ""DepartmentId""=""E"".""DepartmentId"" AND ""Salary"">""E"".""Salary"")<3 ORDER BY ""E"".""DepartmentId"",""E"".""Salary"" DESC"
389,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""salary"" DESC) AS ""salaryRank"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentId""=""d"".""id"" WHERE ""e"".""salaryRank""<=3"
390,"WITH ""sal_dept"" AS (SELECT ""Name"" AS ""employee"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""dept_rank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""e"".""employee"" AS ""Employee"",""e"".""Salary"" FROM ""sal_dept"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""dept_rank""<=3"
391,"SELECT ""d"".""Name"" AS ""Department"",""e2"".""Name"" AS ""Employee"",""e2"".""Salary"" FROM ""Department"" AS ""d"" LEFT JOIN (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""r"" FROM ""Employee"" AS ""e"") AS ""e2"" ON ""e2"".""DepartmentId""=""d"".""Id"" WHERE ""e2"".""r""<=3"
392,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"") ORDER BY ""Department"",""Salary"" DESC"
393,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
394,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
395,"SELECT ""t2"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"") AS ""t1"" JOIN ""Department"" AS ""t2"" ON ""t1"".""DepartmentId""=""t2"".""Id"" WHERE ""r""<=3"
396,"SELECT ""d"".""Name"" AS ""Department"",""RankData"".""Name"" AS ""Employee"",""RankData"".""Salary"" FROM (SELECT ""Id"",""Name"",""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SalaryRank"" FROM ""Employee"") AS ""RankData"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""RankData"".""DepartmentId"" WHERE ""RankData"".""SalaryRank""<=3"
397,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentID""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
398,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""Employee"".""DepartmentId"")"
399,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e"".""departmentid""=""e2"".""departmentid"" AND ""e"".""salary""<""e2"".""salary"")"
400,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""ESQ"" WHERE ""E"".""DepartmentId""=""ESQ"".""DepartmentId"" AND ""E"".""Salary""<""ESQ"".""Salary"")"
401,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
402,"WITH ""temp_table"" AS (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""Id"" ORDER BY ""Salary"" DESC) AS ""rn"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""temp_table"" WHERE ""rn""<=3"
403,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
404,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
405,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
406,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") LEFT JOIN (SELECT ""Salary"",""DepartmentId"",RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" GROUP BY ""DepartmentId"",""Salary"") AS ""t"" ON ""t"".""Salary""=""e"".""Salary"" AND ""t"".""DepartmentId""=""e"".""DepartmentId"" WHERE ""t"".""rnk""<=3"
407,"SELECT ""A"".""Name"" AS ""Department"",""B"".""Name"" AS ""Employee"",""B"".""Salary"" FROM ""Department"" AS ""A"" JOIN (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"") AS ""B"" ON ""A"".""Id""=""B"".""DepartmentId"" AND ""r""<=3"
408,"SELECT ""m"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN (SELECT (DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC)) AS ""r"",""d"".""Name"",""e2"".""Id"" FROM ""Employee"" AS ""e2"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e2"".""DepartmentId"") AS ""m"" ON ""m"".""Id""=""e"".""Id"" WHERE ""r""<=3"
409,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<""e2"".""Salary"") ORDER BY ""e1"".""Name"",""e1"".""Salary"" DESC"
410,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
411,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""departmentid""=""d"".""id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e2"".""departmentid""=""e1"".""departmentid"")<3"
412,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""Salary"" FROM ""department"" AS ""d"" JOIN ""employee"" AS ""e1"" ON ""d"".""id""=""e1"".""departmentid"" WHERE (SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e2"".""departmentid""=""e1"".""departmentid"")<3"
413,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",SUM(""e"".""salary"") AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY SUM(""e"".""salary"") DESC) AS ""dr"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" GROUP BY 1,2) AS ""sub"" WHERE ""sub"".""dr""<=3"
414,"SELECT ""d"".""Name"" AS ""Department"",""sub"".""Employee"",""sub"".""Salary"" FROM (SELECT ""e"".""DepartmentId"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""ranks"" FROM ""Employee"" AS ""e"") AS ""sub"" JOIN ""Department"" AS ""d"" ON ""sub"".""DepartmentId""=""d"".""Id"" WHERE ""ranks""<=3 ORDER BY ""Department"",""Salary"" DESC"
415,"SELECT ""D"".""Name"" AS ""Department"",""E1"".""name"" AS ""Employee"",""E1"".""salary"" AS ""Salary"" FROM ""Employee"" AS ""E1"" JOIN ""Department"" AS ""D"" ON ""E1"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""E2"".""salary"") FROM ""Employee"" AS ""E2"" WHERE ""E2"".""salary"">""E1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
416,"WITH ""TEMP"" AS (SELECT ""D"".""Name"" AS ""DEPARTMENT"",""E"".""Name"" AS ""EMPLOYEE"",""E"".""salary"" AS ""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""PRIORITY"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM ""TEMP"" WHERE ""PRIORITY"" IN (1,2,3)"
417,"SELECT DISTINCT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM ((""Department"" AS ""b"") JOIN ""Employee"" AS ""a"") JOIN (SELECT ""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""c"" WHERE ""b"".""Id""=""a"".""DepartmentId"" AND ""c"".""rnk""<=3 AND ""c"".""DepartmentId""=""a"".""DepartmentId"" AND ""a"".""Salary"">=""c"".""Salary"" ORDER BY 1,3 DESC,2 DESC"
418,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
419,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Department"" AS ""d"") JOIN ""Employee"" AS ""e"" WHERE ""e"".""DepartmentId""=""d"".""Id"" AND (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""DepartmentId""=""d"".""Id"" AND ""Salary"">""e"".""Salary"")<3 ORDER BY ""e"".""departmentid"",""e"".""salary"" DESC"
420,"SELECT ""dep"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" FROM (""Department"" AS ""dep"") JOIN ""Employee"" AS ""emp"" WHERE ""emp"".""DepartmentId""=""dep"".""Id"" AND (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""DepartmentId""=""dep"".""Id"" AND ""Salary"">""emp"".""Salary"")<3"
421,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
422,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
423,"WITH ""order_salary"" AS (SELECT DISTINCT ""salary"",""DepartmentId"" FROM ""employee""), ""adding_rown"" AS (SELECT ""T1"".*,ROW_NUMBER() OVER (ORDER BY ""DepartmentId"",""salary"" DESC) AS ""sorder"" FROM ""order_salary"" AS ""t1""), ""max_oder_dep"" AS (SELECT ""departmentid"",MIN(""sorder"") AS ""minsorder"",MAX(""sorder"") AS ""maxsorder"" FROM ""adding_rown"" GROUP BY ""departmentid""), ""third_max"" AS (SELECT ""t1"".* FROM ""adding_rown"" AS ""t1"" JOIN ""max_oder_dep"" AS ""t2"" ON ""t1"".""departmentid""=""t2"".""departmentid"" AND (""t1"".""sorder""=""t2"".""minsorder""+2 OR (""t2"".""minsorder""+2>""t2"".""maxsorder"" AND ""t1"".""sorder""=""t2"".""maxsorder""))) SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" FROM (""employee"" AS ""e"" JOIN ""third_max"" AS ""t"" ON ""e"".""departmentid""=""t"".""departmentid"" AND ""e"".""salary"">=""t"".""salary"") LEFT JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE ""d"".""id"" IS NOT NULL"
424,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
425,"WITH ""sals"" AS (SELECT DISTINCT ""departmentid"",""salary"" FROM ""employee"" ORDER BY ""departmentid"",""salary"" DESC), ""topdistinct"" AS (SELECT DISTINCT ""departmentid"",""salary"",ROW_NUMBER() OVER ""w"" AS ""rnk"" FROM ""sals"" WINDOW ""w"" AS (PARTITION BY ""departmentid"" ORDER BY ""departmentid"",""salary"" DESC)) SELECT ""d1"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" AS ""Salary"" FROM (""topdistinct"" AS ""tp"" LEFT JOIN ""employee"" AS ""e1"" ON ""tp"".""departmentid""=""e1"".""departmentid"" AND ""tp"".""salary""=""e1"".""salary"") LEFT JOIN ""department"" AS ""d1"" ON ""tp"".""departmentid""=""d1"".""id"" WHERE ""tp"".""rnk""<4 AND ""d1"".""name"" IS NOT NULL ORDER BY ""tp"".""departmentid"",""e1"".""salary"" DESC"
426,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")"
427,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e"".""salary""<""e2"".""salary"" AND ""e2"".""DepartmentId""=""e"".""DepartmentId"")"
428,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
429,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""E2"" WHERE ""E2"".""Salary"">""E"".""Salary"" AND ""E2"".""DepartmentId""=""E"".""DepartmentId"") ORDER BY ""E"".""Salary"" DESC"
430,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
431,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""employee"",""e"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""DepartmentId""=""e"".""DepartmentId"" AND ""Salary"">""e"".""Salary"")<=2 AND ""d"".""Id"" IS NOT NULL"
432,"SELECT ""d"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""d"" ON ""E"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""E1"" WHERE ""E1"".""DepartmentId""=""E"".""DepartmentId"" AND ""E1"".""Salary"">=""E"".""Salary"")<=3"
433,"SELECT ""D"".""Name"" AS ""Department"",""E1"".""Name"" AS ""Employee"",""E1"".""Salary"" FROM ""Employee"" AS ""E1"" JOIN ""Department"" AS ""D"" ON ""E1"".""DepartmentId""=""D"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""E2"" WHERE ""E2"".""Salary"">""E1"".""Salary"" AND ""E2"".""DepartmentId""=""E1"".""DepartmentId"")<3"
434,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")"
435,"SELECT ""c"".""Department"",""c"".""Employee"",""c"".""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""dept_salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""id"") AS ""c"" WHERE ""c"".""dept_salary_rank""<=3"
436,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e1"".""Salary"") FROM ""Employee"" AS ""e1"" WHERE ""e1"".""Salary"">""e"".""Salary"" AND ""e1"".""DepartmentID""=""e"".""DepartmentID"") ORDER BY ""d"".""id"",""e"".""salary"" DESC"
437,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""e1"".""DepartmentId"" AND ""e2"".""Salary"">""e1"".""Salary"")"
438,"SELECT ""a"".""department_name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" FROM (SELECT ""e"".""name"",""d"".""name"" AS ""department_name"",""e"".""salary"",""e"".""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""a"".""rnk""<=3"
439,"SELECT ""a"".""DeptName"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"" FROM (SELECT ""e"".""Name"" AS ""Name"",""e"".""Salary"" AS ""Salary"",""d"".""Name"" AS ""DeptName"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""Rank"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" ORDER BY 'Rank') AS ""a"" WHERE (""a"".""Rank""<=3) AND (""a"".""DeptName"" IS NOT NULL)"
440,"SELECT ""department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""d"".""id""=""e"".""departmentid"") AS ""t1"" WHERE ""r"" BETWEEN 1 AND 3 AND ""department"" IS NOT NULL"
441,"SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" AND 3>(SELECT COUNT(DISTINCT ""e"".""Salary"") FROM ""Employee"" AS ""e"" WHERE ""a"".""DepartmentId""=""e"".""DepartmentId"" AND ""e"".""Salary"">""a"".""Salary"")"
442,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"" FROM (SELECT ""e1"".""name"" AS ""name"",""e1"".""salary"",""departmentid"" AS ""id"" FROM ""employee"" AS ""e1"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""departmentid""=""e2"".""departmentid"")) AS ""E"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""e"".""id"""
443,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rownum"",""DepartmentId"",""Salary"",""Name"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rownum""<4 ORDER BY ""department"""
444,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
445,"SELECT ""D"".""Name"" AS ""Department"",""E1"".""name"" AS ""Employee"",""E1"".""salary"" AS ""Salary"" FROM ""Employee"" AS ""E1"" JOIN ""Department"" AS ""D"" ON ""E1"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""E2"".""salary"") FROM ""Employee"" AS ""E2"" WHERE ""E2"".""salary"">""E1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
446,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""t"" WHERE ""ranking""<=3 ORDER BY ""Department"",""Salary"" DESC"
447,"SELECT ""dp"".""Name"" AS ""Department"",""ep"".""Name"" AS ""Employee"",""ep"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""ep"" JOIN ""Department"" AS ""dp"" ON ""dp"".""Id""=""ep"".""DepartmentID"" WHERE 3>(SELECT COUNT(DISTINCT ""epe"".""Salary"") FROM ""Employee"" AS ""epe"" WHERE ""epe"".""Salary"">""ep"".""Salary"" AND ""ep"".""DepartmentId""=""epe"".""DepartmentId"")"
448,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""Name"" ORDER BY ""E"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""inner_table"" WHERE ""salary_rank""<=3"
449,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
450,"WITH ""CTE"" AS (SELECT ""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",""d"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""CTE"" WHERE ""rnk""<=3"
451,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT ""DepartmentId"",""Salary"",""Name"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnum"" FROM ""employee"") AS ""e"" JOIN ""department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"" AND ""rnum""<4 ORDER BY ""department"""
452,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
453,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptPayRank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE ""DeptPayRank""<=3"
454,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
455,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
456,"SELECT ""d"".""name"" AS ""department"",""e1"".""name"" AS ""employee"",""e1"".""salary"" AS ""salary"" FROM (""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"") JOIN ""department"" AS ""d"" ON ""e1"".""departmentid""=""e2"".""departmentid"" AND ""e1"".""salary""<=""e2"".""salary"" AND ""d"".""id""=""e2"".""departmentid"" GROUP BY 1,2,3 HAVING COUNT(DISTINCT (""e2"".""salary""))<=3"
457,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e"".""Salary""<""e2"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
458,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentID""=""d"".""Id"" WHERE 3>(SELECT (COUNT(DISTINCT ""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
459,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""e1"".""DepartmentId"" AND ""e1"".""Salary""<""e2"".""Salary"")<3"
460,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e1"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e1"".""Salary""<""e2"".""Salary"")"
461,"SELECT ""b"".""name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM ""Employee"") AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE ""a"".""rk""<=3"
462,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") ORDER BY ""Department"".""Name"",""Salary"" DESC"
463,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE (SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e2"".""DepartmentId""=""e"".""DepartmentId"")<3 ORDER BY ""Salary"" DESC"
464,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""name"" ORDER BY ""a"".""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""id"") AS ""rankings"" WHERE ""rnk""<4"
465,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""salary"" DESC) AS ""ranky"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""ranky""<=3"
466,"SELECT ""t2"".""name"" AS ""department"",""t1"".""name"" AS ""employee"",""t1"".""salary"" AS ""salary"" FROM ""employee"" AS ""t1"" JOIN ""department"" AS ""t2"" ON ""t2"".""id""=""t1"".""departmentid"" WHERE (SELECT COUNT(DISTINCT ""t3"".""salary"") FROM ""employee"" AS ""t3"" WHERE ""t3"".""departmentid""=""t1"".""departmentid"" AND ""t3"".""salary"">""t1"".""salary"")<=2"
467,"SELECT ""d"".""name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""salary"") FROM ""Employee"" WHERE ""e"".""DepartmentId""=""DepartmentId"" AND ""salary"">""e"".""salary"")<3"
468,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT ""Id"",""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""sal_rank"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""id"" WHERE ""e"".""sal_rank""<=3"
469,"SELECT ""d"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" FROM (SELECT ""e"".""Name"",""e"".""DepartmentId"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""R"" FROM ""Employee"" AS ""e"") AS ""emp"" JOIN ""Department"" AS ""d"" WHERE ""d"".""Id""=""emp"".""DepartmentId"" AND ""emp"".""R""<=3"
470,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
471,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
472,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
473,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""E"") JOIN ""Department"" AS ""D"" WHERE (SELECT COUNT(DISTINCT (""Salary"")) FROM ""Employee"" WHERE ""DepartmentId""=""E"".""DepartmentId"" AND ""Salary"">""E"".""Salary"") IN (0,1,2) AND ""E"".""DepartmentId""=""D"".""Id"" ORDER BY ""E"".""DepartmentId"",""E"".""Salary"" DESC"
474,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
475,"SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""sal_rank"" FROM ""Employee"" AS ""e"") AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE ""sal_rank""<=3"
476,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
477,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
478,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""Salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE (SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" WHERE ""departmentid""=""e"".""departmentid"" AND ""salary"">""e"".""salary"")<3 ORDER BY ""e"".""departmentid"",""e"".""salary"" DESC"
479,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
480,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""departmentid""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_rank""<=3"
481,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
482,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
483,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" FROM (""employee"" AS ""e"") JOIN ""department"" AS ""d"" WHERE (SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" WHERE ""departmentid""=""e"".""departmentid"" AND ""salary"">""e"".""salary"")<3 AND ""e"".""departmentid""=""d"".""id"" ORDER BY ""e"".""salary"" DESC"
484,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""salary"")) FROM ""employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
485,"SELECT ""ed"".""Department"",""ed"".""Employee"",""ed"".""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""ed"" WHERE ""ed"".""Rank""<=3"
486,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""rk""<=3"
487,"WITH ""etc"" AS (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""etc"" WHERE ""rnk""<=3"
488,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
489,"SELECT ""dep"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" FROM (""Department"" AS ""dep"") JOIN ""Employee"" AS ""emp"" WHERE ""emp"".""DepartmentId""=""dep"".""Id"" AND (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""DepartmentId""=""dep"".""Id"" AND ""Salary"">""emp"".""Salary"")<3"
490,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
491,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
492,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT (""salary"")) FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e2"".""departmentid""=""e"".""departmentid"")"
493,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
494,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""e"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""emp"" WHERE ""salary_rank""<=3"
495,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE NOT EXISTS (SELECT 1 FROM ""Employee"" AS ""ex"" WHERE ""ex"".""DepartmentId""=""e"".""DepartmentId"" AND ""ex"".""Salary"">""e"".""Salary"" HAVING COUNT(DISTINCT ""ex"".""Salary"")>=3)"
496,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""Department"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM (SELECT ""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",""d"".""Name"" AS ""Department"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"") AS ""tt"" WHERE ""salary_rank""<=3 AND ""Department"" IS NOT NULL"
497,"SELECT ""t"".""Department"",""t"".""Employee"",""t"".""Salary"" FROM (SELECT ""e"".""Name"" AS ""Employee"",""e"".""Salary"",""d"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""rnk""<=3"
498,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
499,"SELECT ""dep"".""Name"" AS ""Department"",""emp1"".""Name"" AS ""Employee"",""emp1"".""Salary"" FROM ""Employee"" AS ""emp1"" JOIN ""Department"" AS ""dep"" ON ""dep"".""Id""=""emp1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""emp2"".""Salary"") FROM ""Employee"" AS ""emp2"" WHERE ""emp2"".""Salary"">""emp1"".""Salary"" AND ""emp2"".""DepartmentId""=""emp1"".""DepartmentId"")"
500,"WITH ""top_three_salary"" AS (SELECT ""departmentid"",""salary"",RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""salary_rank"" FROM (SELECT DISTINCT ""departmentid"",""salary"" FROM ""employee"") AS ""s"") SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM (""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") JOIN (SELECT DISTINCT ""departmentid"",""salary"" FROM ""top_three_salary"" WHERE ""salary_rank""<=3) AS ""t"" ON ""e"".""departmentid""=""t"".""departmentid"" AND ""e"".""salary""=""t"".""salary"""
501,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
502,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
503,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
504,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""Department"".""Id""=""e1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""e1"".""DepartmentId"" AND ""e2"".""Salary"">""e1"".""Salary"")"
505,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
506,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
507,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
508,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e1"".""Departmentid""=""e2"".""DepartmentId"" AND ""e2"".""Salary"">""e1"".""Salary"")"
509,"WITH ""dept_top_3"" AS (SELECT * FROM (SELECT ""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""salary"" DESC) AS ""d_rank"",""salary"" FROM ""employee"") AS ""table1"" WHERE ""d_rank""<=3) SELECT DISTINCT ""department"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" FROM (""employee"" AS ""e"" JOIN ""dept_top_3"" AS ""d"" ON ""e"".""departmentId""=""d"".""departmentId"" AND ""e"".""salary"">=""d"".""salary"") JOIN ""department"" ON ""e"".""departmentid""=""department"".""id"""
510,"SELECT ""t2"".""name"" AS ""department"",""t1"".""name"" AS ""employee"",""t1"".""salary"" AS ""salary"" FROM ""employee"" AS ""t1"" JOIN ""department"" AS ""t2"" ON ""t2"".""id""=""t1"".""departmentid"" WHERE (SELECT COUNT(DISTINCT ""t3"".""salary"") FROM ""employee"" AS ""t3"" WHERE ""t3"".""departmentid""=""t1"".""departmentid"" AND ""t3"".""salary"">""t1"".""salary"")<=2"
511,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
512,"WITH ""emp_w_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rank_id"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""emp_w_rank"" WHERE ""rank_id""<=3"
513,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
514,"WITH ""added_rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""SALARY"" DESC) AS ""rank_number"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""added_rank"" WHERE ""rank_number""<=3"
515,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Employee"",""e"".""Salary"" FROM (SELECT ""Name"" AS ""Employee"",""Salary"",""DepartmentID"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""rn"" FROM ""Employee"") AS ""e"", ""Department"" AS ""d"" WHERE ""e"".""DepartmentID""=""d"".""ID"" AND ""rn""<4"
516,"WITH ""DeptSalaryRank"" AS (SELECT ""DepartmentId"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DeptRank"" FROM ""Employee""), ""EmployeeSubset"" AS (SELECT DISTINCT ""A"".""Name"",""A"".""DepartmentId"",""A"".""Salary"" FROM ""Employee"" AS ""A"" LEFT JOIN ""DeptSalaryRank"" AS ""B"" ON (""A"".""DepartmentId""=""B"".""DepartmentId"") AND (""A"".""Salary""=""B"".""Salary"") WHERE ""B"".""DeptRank""<=3) SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Department"" AS ""D"" JOIN ""EmployeeSubset"" AS ""E"" ON ""E"".""DepartmentId""=""D"".""Id"""
517,"SELECT ""d"".""Name"" AS ""Department"",""e3"".""Name"" AS ""Employee"",""e3"".""Salary"" FROM (SELECT * FROM ""Employee"" AS ""e1"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")) AS ""e3"" JOIN ""Department"" AS ""d"" ON ""e3"".""DepartmentId""=""d"".""Id"""
518,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") ORDER BY ""d"".""Name"",""e1"".""Salary"" DESC"
519,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") ORDER BY ""Department"",""Salary"" DESC"
520,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
521,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""E"".""DepartmentId"" ORDER BY ""E"".""Salary"" DESC) AS ""cnt"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") AS ""S1"" WHERE ""cnt"" BETWEEN 1 AND 3"
522,"WITH ""agg"" AS (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"" FROM ""agg"" AS ""a"" JOIN ""department"" AS ""d"" ON ""a"".""departmentid""=""d"".""id"" WHERE ""a"".""salary_rank""<=3"
523,"WITH ""cte"" AS (SELECT ""e"".""name"" AS ""Employee"",""e"".""salary"",""d"".""name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranking"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""cte"" WHERE ""ranking""<=3"
524,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e1"".""Salary"") FROM ""Employee"" AS ""e1"" WHERE ""e1"".""DepartmentId""=""e"".""DepartmentId"" AND ""e1"".""Salary"">""e"".""Salary"")<3 ORDER BY ""d"".""Name"",""e"".""Salary"" DESC"
525,"SELECT ""d"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Department"" AS ""d"" ON ""t1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""t2"" WHERE ""t2"".""Salary"">""t1"".""Salary"" AND ""t1"".""DepartmentId""=""t2"".""DepartmentId"")"
526,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
527,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""departmentid"",""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rank"" FROM ""employee"" AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"") AS ""t"" WHERE ""rank""<=3"
528,"WITH ""cte"" AS (SELECT ""e"".""name"" AS ""Employee"",""salary"",""d"".""name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""departmentid""=""d"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""cte"" WHERE ""rnk""<=3"
529,"SELECT ""d"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""e"".""departmentID"" ORDER BY ""salary"" DESC) AS ""deptrank"" FROM ""employee"" AS ""e"") AS ""a"" JOIN ""department"" AS ""d"" ON ""a"".""departmentid""=""d"".""id"" WHERE ""deptrank""<=3"
530,"SELECT ""dp"".""Name"" AS ""Department"",""ep"".""Name"" AS ""Employee"",""ep"".""Salary"" AS ""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""ep"" JOIN ""Department"" AS ""dp"" ON ""dp"".""Id""=""ep"".""DepartmentId"" AND ""ep"".""rnk""<4 ORDER BY ""DepartmentId"",""Salary"""
531,"SELECT ""a"".""Dept"" AS ""Department"",""a"".""Empl"" AS ""Employee"",""a"".""Sal"" AS ""Salary"" FROM (SELECT ""D"".""Name"" AS ""Dept"",""E"".""Name"" AS ""Empl"",""E"".""Salary"" AS ""Sal"",DENSE_RANK() OVER (PARTITION BY ""E"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""abcd"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""D"".""Id""=""E"".""DepartmentID"") AS ""a"" WHERE ""abcd""<=3"
532,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM (""department"" AS ""d"") JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""employee"") AS ""e"" WHERE ""d"".""id""=""e"".""departmentid"" AND ""e"".""r"" IN (1,2,3)"
533,"SELECT DISTINCT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE ""e"".""Salary"" IN (SELECT ""Top3Salary"" FROM (SELECT DISTINCT ""e2"".""Salary"" AS ""Top3Salary"" FROM ""Employee"" AS ""e2"" WHERE ""e"".""DepartmentId""=""e2"".""DepartmentId"" ORDER BY ""e2"".""Salary"" DESC LIMIT 3 OFFSET 0) AS ""t"") ORDER BY ""Department"",""Salary"" DESC"
534,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e_t"".""Salary"") FROM ""Employee"" AS ""e_t"" WHERE ""e_t"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e_t"".""DepartmentId"")<3"
535,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""es"".""salary"") FROM ""employee"" AS ""es"" WHERE ""es"".""salary"">""e"".""salary"" AND ""e"".""DepartmentId""=""es"".""DepartmentId"")"
536,"WITH ""temp"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""employee"") SELECT ""d"".""name"" AS ""department"",""t"".""name"" AS ""employee"",""salary"" FROM ""temp"" AS ""t"" JOIN ""department"" AS ""d"" ON ""t"".""departmentid""=""d"".""id"" WHERE ""t"".""salary_rank""<=3 ORDER BY ""department"",""salary"" DESC"
537,"WITH ""emp_w_sal_rank"" AS (SELECT ""DepartmentId"",""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""drnk"" FROM ""Employee"") SELECT ""dept"".""Name"" AS ""Department"",""emp"".""Employee"",""emp"".""Salary"" FROM (SELECT * FROM ""emp_w_sal_rank"" WHERE ""drnk""<=3) AS ""emp"" JOIN ""Department"" AS ""dept"" ON (""emp"".""DepartmentId""=""dept"".""id"")"
538,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")<3"
539,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""Employee"",""e"".""salary"" FROM (""employee"" AS ""e"" JOIN (SELECT ""id"",""departmentid"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") AS ""A"" ON ""e"".""departmentid""=""A"".""departmentid"" AND ""e"".""id""=""A"".""id"") JOIN ""department"" AS ""d"" ON ""d"".""id""=""e"".""departmentid"" WHERE ""A"".""rnk""<=3"
540,"SELECT ""de"".""name"" AS ""department"",""em"".""name"" AS ""employee"",""salary"" FROM (SELECT ""departmentid"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""employee"") AS ""em"" JOIN ""department"" AS ""de"" ON ""de"".""id""=""em"".""departmentid"" WHERE ""r""<=3"
541,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
542,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""ID"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
543,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
544,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
545,"SELECT ""t2"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Department"" AS ""t2"" ON ""t1"".""DepartmentId""=""t2"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""t3"".""Salary"") FROM ""Employee"" AS ""t3"" WHERE ""t3"".""Salary"">""t1"".""Salary"" AND ""t1"".""DepartmentId""=""t3"".""DepartmentId"")"
546,"SELECT ""D"".""NAME"" AS ""Department"",""E"".""NAME"" AS ""Employee"",""E"".""SALARY"" AS ""Salary"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"" WHERE (SELECT COUNT(DISTINCT ""E2"".""SALARY"") FROM ""EMPLOYEE"" AS ""E2"" WHERE ""E2"".""SALARY"">""E"".""SALARY"" AND ""E2"".""DEPARTMENTID""=""E"".""DEPARTMENTID"")<3 ORDER BY ""D"".""NAME"",""Salary"" DESC"
547,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e1"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
548,"SELECT ""C"".""Department"",""C"".""Name"" AS ""Employee"",""C"".""Salary"" FROM (SELECT ""A"".""Name"",""A"".""Salary"",""A"".""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""A"".""DepartmentID"" ORDER BY ""A"".""Salary"" DESC) AS ""r_n"",""B"".""Name"" AS ""Department"" FROM (""Employee"" AS ""A"") JOIN ""Department"" AS ""B"" WHERE ""A"".""DepartmentId""=""B"".""Id"") AS ""C"" WHERE ""C"".""r_n""<=3"
549,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""a"".""Salary"") FROM ""Employee"" AS ""a"" WHERE ""a"".""DepartmentId""=""e"".""DepartmentId"" AND ""a"".""Salary"">""e"".""Salary"")<3"
550,"ERROR: mysql parse error: line 1 column 10 near ""dense_rank() over(partition by Department.Name order by Employee.Salary desc) as rank_count from Employee join Department on Employee.DepartmentId = Department.Id) as mytable where mytable.rank_count<=3 "" "
551,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""rank""<=3 ORDER BY ""d"".""id"",""e"".""rank"""
552,"WITH ""Salary_Rank"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""s_rank"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""Salary_Rank"" WHERE ""s_rank""<=3 AND ""Department"" IS NOT NULL"
553,"WITH ""cte"" AS (SELECT ""Name"",""salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""d"".""Name"" AS ""Department"",""cte"".""Name"" AS ""Employee"",""salary"" FROM ""cte"" JOIN ""Department"" AS ""d"" ON ""cte"".""DepartmentId""=""d"".""Id"" WHERE ""rnk""<=3"
554,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
555,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentId""=""d"".""id"") AS ""tmp"" WHERE ""tmp"".""salary_rank""<=3"
556,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
557,"WITH ""ranking"" AS (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""id"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""department"" AS ""d"" JOIN ""employee"" AS ""e"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""ranking"" WHERE ""r""<=3"
558,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
559,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
560,"WITH ""fulltable"" AS (SELECT ""d"".""Name"" AS ""department_name"",""d"".""Id"" AS ""department_id"",""e"".""Name"" AS ""employee_name"",""Salary"",""e"".""Id"" AS ""employee_id"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""department_name"" AS ""Department"",""employee_name"" AS ""Employee"",""Salary"" FROM (SELECT ""department_name"",""employee_name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""department_name"" ORDER BY ""Salary"" DESC) AS ""r"" FROM ""fulltable"") AS ""a"" WHERE ""r""<=3"
561,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Employee"" AS ""e1"") JOIN ""department"" AS ""d"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") AND ""e1"".""DepartmentId""=""d"".""Id"""
562,"SELECT ""d"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
563,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""e"".""DepartmentId""=""DepartmentId"" AND ""Salary"">""e"".""Salary"")"
564,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentID"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""d"" ON ""a"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""r""<=3"
565,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
566,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentID""=""e2"".""DepartmentID"")"
567,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""e"".""DepartmentId"" AND ""e2"".""salary"">""e"".""salary"")<3"
568,"SELECT ""Department"",""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""e"".*,""d"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""e"".""DePartmentID"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""salary_rank""<=3"
569,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""rango"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""ID""=""e"".""DepartmentID"") AS ""a"" WHERE ""a"".""rango""<4"
570,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM (""Department"" AS ""d"") JOIN ""Employee"" AS ""e"" WHERE ""d"".""id""=""e"".""DepartmentId"" AND 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""Employee"" WHERE ""e"".""DepartmentId""=""Employee"".""DepartmentId"" AND ""Employee"".""Salary"">""e"".""Salary"")"
571,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
572,"SELECT ""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"" WHERE ""ranks""<=3"
573,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" FROM ""department"" AS ""d"" JOIN (SELECT ""id"",""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""temprank"" FROM ""Employee"") AS ""e"" ON ""d"".""id""=""e"".""departmentid"" WHERE ""temprank""<=3"
574,"SELECT ""B"".""NAME"" AS ""Department"",""A"".""NAME"" AS ""EMPLOYEE"",""A"".""SALARY"" AS ""SALARY"" FROM (SELECT ""ID"",""NAME"",""SALARY"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""RNK"" FROM ""Employee"") AS ""A"" JOIN ""Department"" AS ""B"" ON ""A"".""DepartmentId""=""B"".""ID"" WHERE ""RNK""<=3"
575,"SELECT ""d"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""d"" ON ""a"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""a"".""Salary"" AND ""a"".""DepartmentId""=""e2"".""DepartmentId"")"
576,"WITH ""ROW_EMPLOYEE"" AS (SELECT ""ID"",""NAME"",""SALARY"",""DEPARTMENTID"",DENSE_RANK() OVER (PARTITION BY ""DEPARTMENTID"" ORDER BY ""SALARY"" DESC) AS ""RANKING"" FROM ""EMPLOYEE"") SELECT ""DEPARTMENT"".""NAME"" AS ""DEPARTMENT"",""ROW_EMPLOYEE"".""NAME"" AS ""EMPLOYEE"",""ROW_EMPLOYEE"".""SALARY"" AS ""SALARY"" FROM ""ROW_EMPLOYEE"" JOIN ""DEPARTMENT"" ON ""ROW_EMPLOYEE"".""DEPARTMENTID""=""DEPARTMENT"".""ID"" WHERE ""RANKING""<=3"
577,"SELECT ""department"",""name"" AS ""Employee"",""salary"" FROM (SELECT ""e"".*,""d"".""name"" AS ""department"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""salary"" DESC) AS ""dr"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON (""e"".""departmentid""=""d"".""id"")) AS ""a"" WHERE ""dr""<=3"
578,"SELECT ""dep"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" FROM (""Department"" AS ""dep"") JOIN ""Employee"" AS ""emp"" WHERE ""emp"".""DepartmentId""=""dep"".""Id"" AND (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""DepartmentId""=""dep"".""Id"" AND ""Salary"">""emp"".""Salary"")<3"
579,"SELECT ""t"".""Department"",""Employee"",""t"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentID"" ORDER BY ""e"".""salary"" DESC) AS ""Max_salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""Max_salary""<4"
580,"SELECT ""t"".""Department"",""t"".""Employee"",""t"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Id"" ORDER BY ""e"".""Salary"" DESC) AS ""rk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""rk""<4"
581,"WITH ""Ranking"" AS (SELECT ""name"",""salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranks"" FROM ""Employee"") SELECT ""d"".""Name"" AS ""Department"",""r"".""name"" AS ""Employee"",""r"".""salary"" FROM ""Ranking"" AS ""r"" JOIN ""Department"" AS ""d"" ON ""r"".""DepartmentId""=""d"".""Id"" WHERE ""ranks""<=3"
582,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE ""e"".""rank""<=3 ORDER BY ""d"".""Name"",""Salary"" DESC"
583,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
584,"SELECT ""c"".""Department"",""c"".""Employee"",""c"".""Salary"" FROM (SELECT ""e"".""Name"" AS ""Employee"",""Salary"",""d"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""Id"") AS ""c"" WHERE ""salary_rank""<=3"
585,"SELECT ""D"".""Name"" AS ""Department"",""T"".""Name"" AS ""Employee"",""T"".""Salary"" AS ""Salary"" FROM (SELECT ""Id"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"",""DepartmentId"" FROM ""Employee"") AS ""T"" JOIN ""Department"" AS ""D"" ON ""T"".""DepartmentId""=""D"".""Id"" WHERE ""T"".""ranking""<4"
586,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
587,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
588,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
589,"SELECT ""d"".""name"" AS ""department"",""y"".""name"" AS ""employee"",""y"".""salary"" AS ""salary"" FROM (SELECT * FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rk"" FROM ""employee"") AS ""x"" WHERE ""x"".""rk""<=3) AS ""y"" JOIN ""department"" AS ""d"" ON ""y"".""departmentid""=""d"".""id"""
590,"WITH ""E"" AS (SELECT ""e"".""Name"",""e"".""Salary"",""e"".""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""e"".""Salary"" DESC) AS ""RNK"" FROM ""Employee"" AS ""e"") SELECT ""d"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" FROM ""E"" JOIN ""Department"" AS ""d"" ON ""E"".""DepartmentId""=""d"".""Id"" WHERE ""E"".""RNK""<=3"
591,"WITH ""rankit"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") SELECT ""Department"",""Employee"",""Salary"" FROM ""rankit"" WHERE ""rank_num"" BETWEEN 1 AND 3 ORDER BY ""Department"" DESC"
592,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
593,"WITH ""T1"" AS (SELECT ""E"".""name"" AS ""employee"",""E"".""salary"",""D"".""name"" AS ""department"",DENSE_RANK() OVER (PARTITION BY ""D"".""name"" ORDER BY ""E"".""salary"" DESC) AS ""d_rnk"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"") SELECT ""department"",""employee"",""salary"" FROM ""T1"" WHERE ""d_rnk""<=3"
594,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON (""e"".""DepartmentId""=""d"".""Id"") WHERE (SELECT COUNT(DISTINCT ""e1"".""Salary"") FROM ""Employee"" AS ""e1"" WHERE ""e"".""DepartmentId""=""e1"".""DepartmentId"" AND ""e1"".""Salary"">""e"".""Salary"")<3"
595,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" ON ""e1"".""DepartmentId""=""Department"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
596,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""Department"",""E"".""NAME"" AS ""Employee"",""SALARY"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""A"" WHERE ""RNK""<=3"
597,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
598,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
599,"ERROR: mysql parse error: line 1 column 4 near ""from Employee e, Department d where e.DepartmentID=d.Id and 3>( select count(distinct Salary) from Employee where Salary > e.Salary and DepartmentId=e.DepartmentId ) "" "
600,"WITH ""THREE"" (""Salary"", ""DepartmentId"", ""Srank"") AS (SELECT ""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""srank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"" AS ""Salary"" FROM (""Employee"" JOIN (SELECT MIN(""Salary"") AS ""Salary"",""DepartmentId"" FROM ""THREE"" WHERE ""srank""<=3 GROUP BY ""DepartmentId"") AS ""THIRD_SALARY"" ON ""Employee"".""DepartmentId""=""THIRD_SALARY"".""DepartmentId"") JOIN ""Department"" ON ""Department"".""Id""=""Employee"".""DepartmentId"" WHERE ""Employee"".""Salary"">=""THIRD_SALARY"".""Salary"""
601,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e2"".""DepartmentId""=""e"".""DepartmentId"")<3"
602,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""d"".""id""=""e1"".""DepartmentId"" WHERE (SELECT COUNT(DISTINCT (""e2"".""salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""departmentId""=""e2"".""departmentId"")<3"
603,"SELECT ""tb2"".""Name"" AS ""Department"",""tb1"".""Name"" AS ""Employee"",""tb1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""tb1"" JOIN ""Department"" AS ""tb2"" ON ""tb1"".""DepartmentId""=""tb2"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""tb3"" WHERE ""tb3"".""DepartmentId""=""tb1"".""DepartmentId"" AND ""tb3"".""Salary"">""tb1"".""Salary"")<3"
604,"SELECT ""D"".""Name"" AS ""Department"",""E1"".""Name"" AS ""Employee"",""E1"".""Salary"" FROM (""Employee"" AS ""E1"") JOIN ""Department"" AS ""D"" WHERE ""E1"".""DepartmentId""=""D"".""Id"" AND (SELECT COUNT(DISTINCT ""E2"".""Salary"") FROM ""Employee"" AS ""E2"" WHERE ""E2"".""Salary"">""E1"".""Salary"" AND ""E1"".""DepartmentId""=""E2"".""DepartmentId"")<3"
605,"SELECT ""d"".""Name"" AS ""Department"",""t1"".""Name"" AS ""Employee"",""t1"".""Salary"" FROM (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""employee"") AS ""t1"" JOIN ""department"" AS ""d"" ON ""t1"".""DepartmentId""=""d"".""id"" WHERE ""t1"".""rank""<=3"
606,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
607,"SELECT ""d"".""name"" AS ""department"",""e2"".""name"" AS ""employee"",""e2"".""salary"" FROM ""employee"" AS ""e2"" JOIN ""department"" AS ""d"" ON ""e2"".""departmentid""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" AS ""e1"" WHERE ""e2"".""salary""<""e1"".""salary"" AND ""e1"".""departmentid""=""e2"".""departmentid"")"
608,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
609,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rank1"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""rank1""<=3"
610,"SELECT ""DEPARTMENT"",""EMPLOYEE"",""SALARY"" FROM (SELECT ""D"".""NAME"" AS ""DEPARTMENT"",""E"".""NAME"" AS ""EMPLOYEE"",""E"".""SALARY"",DENSE_RANK() OVER (PARTITION BY ""D"".""NAME"" ORDER BY ""E"".""SALARY"" DESC) AS ""RNK"" FROM ""EMPLOYEE"" AS ""E"" LEFT JOIN ""DEPARTMENT"" AS ""D"" ON ""E"".""DEPARTMENTID""=""D"".""ID"") AS ""T"" WHERE ""RNK""<=3 AND ""DEPARTMENT"" IS NOT NULL"
611,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"" FROM (""department"" AS ""d"") JOIN ""employee"" AS ""e"" WHERE ""d"".""id""=""e"".""departmentid"" AND (SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" WHERE ""departmentid""=""e"".""departmentid"" AND ""salary"">""e"".""salary"")<3"
612,"SELECT ""d"".""Name"" AS ""Department"",""tmp"".""Name"" AS ""Employee"",""tmp"".""Salary"" FROM ""Department"" AS ""d"" LEFT JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SalaryRank"" FROM ""Employee"") AS ""tmp"" ON ""d"".""Id""=""tmp"".""DepartmentId"" WHERE ""SalaryRank""<=3"
613,"WITH ""pay_by_department"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""pay_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") SELECT ""Department"",""Employee"",""Salary"" FROM ""pay_by_department"" WHERE ""pay_rank""<=3"
614,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rn"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""rn"" IN (1,2,3)"
615,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Department"" AS ""d"" LEFT JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""d_sal_rank"" FROM ""Employee"") AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE ""d_sal_rank""<=3 ORDER BY ""Department"",""Salary"" DESC"
616,"SELECT ""anon_1"".""department"" AS ""Department"",""anon_1"".""name"" AS ""Employee"",""anon_1"".""salary"" AS ""Salary"" FROM (SELECT ""e"".""name"",""e"".""salary"",""d"".""name"" AS ""department"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""salary_rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""anon_1"" WHERE ""anon_1"".""salary_rank""<=3"
617,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
618,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank_num"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""rank_num""<=3 ORDER BY 1,3 DESC"
619,"SELECT ""h"".""department"",""h"".""employee"",""h"".""salary"" FROM (SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""a"".""salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""name"" ORDER BY ""a"".""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""a"" LEFT JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""b"".""name"" IS NOT NULL) AS ""h"" WHERE ""h"".""rnk""<=3"
620,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
621,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""departmentID""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""departmentid""=""e2"".""departmentid"")"
622,"SELECT ""dept"".""name"" AS ""Department"",""emp"".""name"" AS ""Employee"",""emp"".""salary"" AS ""Salary"" FROM (SELECT ""departmentid"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranking"" FROM ""employee"") AS ""emp"", ""department"" AS ""dept"" WHERE ""dept"".""id""=""emp"".""departmentid"" AND ""emp"".""ranking""<4"
623,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Id"" ORDER BY ""e"".""Salary"" DESC) AS ""dr"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""tmp"" WHERE ""dr""<=3"
624,"SELECT ""b"".""Name"" AS ""department"",""t"".""Name"" AS ""employee"",""t"".""salary"" FROM ""Employee"" AS ""t"" JOIN ""Department"" AS ""b"" ON ""t"".""DepartmentID""=""b"".""ID"" WHERE (SELECT COUNT(DISTINCT ""e"".""salary"") FROM ""Employee"" AS ""e"" WHERE ""e"".""salary"">""t"".""salary"" AND ""t"".""DepartmentID""=""e"".""DepartmentID"")<3"
625,"SELECT ""a"".""Department"",""a"".""Employee"",""a"".""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""b"".""Name"" ORDER BY ""a"".""Salary"" DESC) AS ""dept_sal_rank"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""a"" WHERE ""a"".""dept_sal_Rank""<=3"
626,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t1"" WHERE ""t1"".""rank""<=3"
627,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""ee"" WHERE ""ee"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""ee"".""DepartmentId"")"
628,"SELECT ""j"".""Department"",""j"".""Employee"",""j"".""salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""ranking"" FROM (""employee"" AS ""e"") JOIN ""department"" AS ""d"" WHERE ""e"".""DepartmentId""=""d"".""id"") AS ""j"" WHERE ""ranking""<=3"
629,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
630,"SELECT ""c"".""Department"" AS ""Department"",""c"".""Name"" AS ""Employee"",""c"".""Salary"" FROM (SELECT ""a"".""Name"",""a"".""Salary"",""b"".""Name"" AS ""Department"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""c"" WHERE ""rnk""<=3 AND ""Department"" IS NOT NULL"
631,"WITH ""cte"" AS (SELECT ""Employee"".""Name"" AS ""Employee"",""Employee"".""salary"",""Department"".""Name"" AS ""Department"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"" ORDER BY ""Department"".""Name"") SELECT ""e1"".""Department"",""e1"".""Employee"",""e1"".""Salary"" FROM ""cte"" AS ""e1"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""cte"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e2"".""Department""=""e1"".""department"")"
632,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Department"" JOIN ""Employee"" AS ""e1"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
633,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SalaryRnk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""SalaryRnk""<4"
634,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Department"" JOIN ""Employee"" AS ""e1"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
635,"SELECT ""Employee"",""Department"",""Salary"" FROM (SELECT ""e"".""name"" AS ""Employee"",""d"".""name"" AS ""Department"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""ranking"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""new"" WHERE ""new"".""ranking""<=3"
636,"SELECT ""depTable"".""Name"" AS ""Department"",""empTable"".""Name"" AS ""Employee"",""empTable"".""Salary"" AS ""Salary"" FROM ""Department"" AS ""depTable"" JOIN ""Employee"" AS ""empTable"" ON ""empTable"".""DepartmentId""=""depTable"".""Id"" WHERE ""Salary"" IN (SELECT ""empTable2"".""Salary"" FROM ""Employee"" AS ""empTable2"" JOIN (SELECT ""empTable3"".""Salary"" AS ""salary2"" FROM ""Employee"" AS ""empTable3"" JOIN ""Department"" AS ""depTable2"" ON ""empTable3"".""DepartmentId""=""depTable2"".""Id"" WHERE ""depTable"".""Id""=""depTable2"".""Id"" GROUP BY ""empTable3"".""Salary"" ORDER BY ""empTable3"".""Salary"" DESC LIMIT 3 OFFSET 0) AS ""any"" ON ""empTable2"".""Salary""=""any"".""salary2"" AND ""depTable"".""Id""=""empTable2"".""DepartmentId"")"
637,"SELECT ""D"".""Name"" AS ""Department"",""T"".""Name"" AS ""Employee"",""Salary"" FROM (SELECT ""Employee"".""Name"" AS ""Name"",""Employee"".""Salary"" AS ""Salary"",""DepartmentId"" AS ""Id"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""SalaryRank"" FROM ""Employee"") AS ""T"" JOIN ""Department"" AS ""D"" ON ""T"".""Id""=""D"".""Id"" WHERE ""T"".""SalaryRank""<=3 ORDER BY ""T"".""SalaryRank"""
638,"WITH ""CTE"" AS (SELECT ""Employee"".""Name"" AS ""Employee"",""Employee"".""DepartmentId"",""Employee"".""Salary"",""Department"".""ID"",""Department"".""Name"" AS ""Department_name"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id""), ""CTE2"" AS (SELECT ""Department_name"" AS ""Department"",""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department_name"" ORDER BY ""Salary"" DESC) AS ""Ranking"" FROM ""CTE"") SELECT ""Department"",""Employee"",""Salary"" FROM ""CTE2"" WHERE ""Ranking""=1 OR ""Ranking""=2 OR ""Ranking""=3"
639,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
640,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" AS ""Salary"" FROM ""EMPLOYEE"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""EMPLOYEE"" AS ""e2"" WHERE ""e1"".""DepartmentId""=""e2"".""departmentId"" AND ""e1"".""salary""<""e2"".""salary"")"
641,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e"".""DepartmentId""=""e2"".""DepartmentId"" AND ""e"".""Salary""<""e2"".""Salary"")<3"
642,"WITH ""cte"" AS (SELECT ""b"".""name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""a"".""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentID""=""b"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""rnk""<=3"
643,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
644,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
645,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""row_num"",""d"".""name"" AS ""department"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""row_num""<=3"
646,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""d"".""id""=""e1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
647,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""Salary"">""e"".""Salary"" AND ""DepartmentId""=""d"".""Id"")<3 ORDER BY ""d"".""Name"",""e"".""Salary"" DESC"
648,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
649,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""Salary"" DESC) AS ""rank_salary"",""d"".""Name"" AS ""Department"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""rank_salary""<4"
650,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""Salary"" FROM (""Employee"" AS ""e1"") JOIN ""Department"" AS ""d"" WHERE ""e1"".""DepartmentId""=""d"".""Id"" AND 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
651,"WITH ""joined"" AS (SELECT ""department"".""name"" AS ""department"",""employee"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""salary_rank"" FROM ""employee"" JOIN ""department"" ON ""employee"".""departmentid""=""department"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""joined"" WHERE ""salary_rank""<4"
652,"WITH ""emp_w_sal_rank"" AS (SELECT ""DepartmentId"",""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""drnk"" FROM ""Employee"") SELECT ""dept"".""Name"" AS ""Department"",""emp_w_sal_rank"".""Employee"",""emp_w_sal_rank"".""Salary"" FROM ""emp_w_sal_rank"" JOIN ""Department"" AS ""dept"" ON (""emp_w_sal_rank"".""DepartmentId""=""dept"".""id"") WHERE ""drnk""<=3"
653,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
654,"SELECT ""Department"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""Salary"" FROM ""Department"" JOIN ""Employee"" AS ""e1"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
655,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") ORDER BY ""d"".""Name"",""e1"".""Salary"" DESC"
656,"SELECT ""c"".""department"",""c"".""employee"",""c"".""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""dept_salary_rank"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""c"" WHERE ""c"".""dept_salary_rank""<=3"
657,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""Salary"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""employee"" WHERE ""salary"">""e"".""salary"" AND ""DepartmentId""=""e"".""DepartmentId"")"
658,"WITH ""tmp"" AS (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Department"" JOIN ""Employee"" ON ""Department"".""Id""=""DepartmentId"") SELECT ""Department"",""Employee"",""Salary"" FROM ""tmp"" WHERE ""rnk""<=3"
659,"SELECT ""a"".""name"" AS ""department"",""b"".""name"" AS ""employee"",""salary"" FROM (SELECT ""name"",""salary"",""departmentid"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""ranks"" FROM ""employee"") AS ""b"" JOIN ""department"" AS ""a"" ON ""a"".""id""=""b"".""departmentid"" WHERE ""ranks""<=3"
660,"SELECT ""dep"".""Name"" AS ""Department"",""emp"".""Name"" AS ""Employee"",""emp"".""Salary"" FROM (""Department"" AS ""dep"") JOIN ""Employee"" AS ""emp"" WHERE ""emp"".""DepartmentId""=""dep"".""Id"" AND (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""DepartmentId""=""dep"".""Id"" AND ""Salary"">""emp"".""Salary"")<3"
661,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""salary"")) FROM ""Employee"" AS ""E2"" WHERE ""E"".""salary""<""E2"".""salary"" AND ""E"".""DepartmentId""=""E2"".""DepartmentId"")"
662,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Department"" AS ""d"") JOIN ""Employee"" AS ""e"" WHERE ""d"".""id""=""e"".""departmentid"" AND (SELECT COUNT(DISTINCT ""e1"".""salary"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""departmentid""=""d"".""id"" AND ""e"".""salary""<""e1"".""salary"")<3"
663,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""Salary"">""e"".""Salary"" AND ""DepartmentId""=""d"".""Id"")<3 ORDER BY ""d"".""Name"",""e"".""Salary"" DESC"
664,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
665,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
666,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"" FROM (""employee"" AS ""e"") JOIN ""department"" AS ""d"" WHERE ""d"".""id""=""e"".""departmentid"" AND 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e2"".""departmentid""=""e"".""departmentid"")"
667,"SELECT ""d"".""Name"" AS ""Department"",""T"".""Name"" AS ""Employee"",""T"".""Salary"" FROM (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentID"" ORDER BY ""Salary"" DESC) AS ""A"" FROM ""Employee"") AS ""T"" JOIN ""Department"" AS ""d"" ON ""T"".""DepartmentId""=""d"".""Id"" WHERE ""T"".""A""<4"
668,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
669,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e1"".""salary"") FROM ""employee"" AS ""e1"" WHERE ""e"".""salary""<""e1"".""salary"" AND ""e"".""departmentid""=""e1"".""departmentid"")"
670,"WITH ""total"" AS (SELECT ""e"".*,""d"".""Name"" AS ""Department"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""t"".""Department"",""t"".""Name"" AS ""Employee"",""t"".""Salary"" FROM ""total"" AS ""t"" JOIN ""total"" AS ""u"" ON ""t"".""Department""=""u"".""Department"" WHERE ""t"".""Salary""<=""u"".""Salary"" GROUP BY ""t"".""Department"",""Employee"",""t"".""Salary"" HAVING COUNT(DISTINCT ""u"".""Salary"")<=3"
671,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" AS ""Salary"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""e1"".""departmentid"" WHERE (SELECT COUNT(DISTINCT (""e2"".""salary"")) FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""departmentid""=""e2"".""departmentid"")<3"
672,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
673,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
674,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""A"" FROM ""employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""A""<4"
675,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
676,"WITH ""ranking"" AS (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""r"" FROM ""department"" AS ""d"" JOIN ""employee"" AS ""e"" ON ""e"".""departmentid""=""d"".""id"") SELECT ""department"",""employee"",""salary"" FROM ""ranking"" WHERE ""r""<4"
677,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
678,"WITH ""topSalary"" AS (SELECT ""DepartmentId"",""Name"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Top"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""topSalary"".""Name"" AS ""Employee"",""topSalary"".""Salary"" FROM ""topSalary"" JOIN ""Department"" ON ""topSalary"".""DepartmentId""=""Department"".""Id"" WHERE ""topSalary"".""Top""<4"
679,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e1"" ON ""d"".""Id""=""e1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT (""SALARY"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
680,"SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""c"".""Salary"") FROM ""Employee"" AS ""c"" WHERE ""c"".""Salary"">""a"".""Salary"" AND ""c"".""DepartmentId""=""a"".""DepartmentId"")"
681,"WITH ""t1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""denserank"" FROM ""employee"") SELECT ""d1"".""name"" AS ""Department"",""t1"".""name"" AS ""Employee"",""t1"".""salary"" AS ""Salary"" FROM ""department"" AS ""d1"" JOIN ""t1"" ON ""t1"".""departmentid""=""d1"".""id"" WHERE ""t1"".""denserank"" IN (1,2,3)"
682,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""salary"" FROM ""employee"" AS ""e"" LEFT JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE 3>=(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">=""e"".""salary"" AND ""e2"".""departmentid""=""e"".""departmentid"") AND ""d"".""name"" IS NOT NULL"
683,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""e"".""departmentid"") AS ""tmp"" WHERE ""tmp"".""rnk""<=3"
684,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
685,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON (""d"".""Id""=""e1"".""DepartmentId"") WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")"
686,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
687,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
688,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""rnk""<=3"
689,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
690,"SELECT ""d"".""Name"" AS ""Department"",""t"".""Name"" AS ""Employee"",""t"".""Salary"" FROM ""Department"" AS ""d"" JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""t"" ON ""d"".""Id""=""t"".""DepartmentId"" WHERE ""rnk""<=3"
691,"WITH ""a"" AS (SELECT ""Employee"".""Name"",""salary"",""department"".""name"" AS ""department"" FROM ""Employee"" JOIN ""department"" ON ""Employee"".""departmentid""=""department"".""id""), ""b"" AS (SELECT ""department"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""department"" ORDER BY ""salary"" DESC) AS ""rks"" FROM ""a"") SELECT ""department"",""name"" AS ""employee"",""salary"" FROM ""b"" WHERE ""rks""<4"
692,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""r"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""r""<4 ORDER BY ""Department"""
693,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
694,"SELECT ""B"".""Name"" AS ""department"",""A"".""Name"" AS ""Employee"",""A"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""sal_rank"" FROM ""employee"" AS ""e"") AS ""A"" JOIN ""department"" AS ""B"" ON ""A"".""departmentid""=""b"".""id"" WHERE ""A"".""sal_rank""<=3"
695,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON (""e"".""departmentId""=""d"".""id"") WHERE (SELECT COUNT(DISTINCT ""e1"".""salary"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""departmentId""=""d"".""id"" AND ""e"".""salary""<""e1"".""salary"")<3"
696,"SELECT ""D"".""Name"" AS ""Department"",""E1"".""Name"" AS ""Employee"",""E1"".""Salary"" FROM ""Employee"" AS ""E1"" JOIN ""Department"" AS ""D"" ON ""D"".""Id""=""E1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT (""E2"".""Salary"")) FROM ""Employee"" AS ""E2"" WHERE ""E2"".""Salary"">""E1"".""Salary"" AND ""E2"".""DepartmentId""=""E1"".""DepartmentId"")"
697,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
698,"ERROR: mysql parse error: line 1 column 217 near "";&amp; DepartmentId = e.DepartmentId)"" "
699,"SELECT ""D"".""name"" AS ""Department"",""E"".""name"" AS ""Employee"",""E"".""salary"" FROM ""employee"" AS ""E"" JOIN ""department"" AS ""D"" ON ""E"".""departmentid""=""D"".""id"" WHERE (SELECT COUNT(DISTINCT (""E1"".""salary"")) FROM ""employee"" AS ""E1"" WHERE ""E"".""salary""<""E1"".""salary"" AND ""D"".""id""=""E1"".""departmentid"")<3"
700,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
701,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM (""Department"" AS ""d"") JOIN ""Employee"" AS ""e"" WHERE ""d"".""Id""=""e"".""DepartmentId"" AND 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""Salary"">""e"".""Salary"" AND ""DepartmentId""=""e"".""DepartmentId"")"
702,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
703,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"".""Name"" ORDER BY ""Salary"" DESC) AS ""d_rank"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""ID"") AS ""R"" WHERE ""d_rank""<4"
704,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""a"".""Salary"" DESC) AS ""num"" FROM ""Employee"" AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"") AS ""c"" WHERE ""num""<=3"
705,"SELECT ""e1"".""Name"" AS ""Employee"",""e1"".""Salary"",""d"".""Name"" AS ""Department"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")"
706,"SELECT ""Department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""employee"",""e"".""salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""name"" ORDER BY ""e"".""salary"" DESC) AS ""drk"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""drk""<=3"
707,"SELECT ""D"".""Name"" AS ""Department"",""E1"".""Name"" AS ""Employee"",""E1"".""Salary"" AS ""Salary"" FROM (""Employee"" AS ""E1"") JOIN ""Department"" AS ""D"" WHERE (SELECT COUNT(DISTINCT ""E2"".""Salary"") FROM ""Employee"" AS ""E2"" WHERE ""E1"".""DepartmentId""=""E2"".""DepartmentId"" AND ""E2"".""Salary"">""E1"".""Salary"")<3 AND ""E1"".""DepartmentId""=""D"".""Id"""
708,"SELECT ""Department"".""name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Department"" JOIN ""Employee"" AS ""e1"" ON ""e1"".""DepartmentId""=""Department"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
709,"SELECT ""b"".""name"" AS ""department"",""a"".""name"" AS ""employee"",""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""employee"") AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentid""=""b"".""id"" WHERE ""rnk"" BETWEEN 1 AND 3"
710,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
711,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
712,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")<3"
713,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e"".""salary""<""e2"".""salary"" AND ""e2"".""DepartmentId""=""e"".""DepartmentId"")"
714,"SELECT ""b"".""Name"" AS ""Department"",""a"".""Name"" AS ""Employee"",""a"".""Salary"" FROM (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""DR"" FROM ""Employee"") AS ""a"" JOIN ""Department"" AS ""b"" ON ""a"".""DepartmentId""=""b"".""Id"" WHERE ""DR""<=3"
715,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"",""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Department"" ORDER BY ""Salary"" DESC) AS ""rk"" FROM (SELECT ""e"".""Name"" AS ""Employee"",""e"".""Salary"",""d"".""Name"" AS ""Department"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"") AS ""b"" WHERE ""rk""<=3"
716,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
717,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
718,"SELECT ""department"",""employee"",""salary"" FROM (SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentId"" ORDER BY ""salary"" DESC) AS ""rn"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"") AS ""a"" WHERE ""rn""<4"
719,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""d"".""Id"")"
720,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") AS ""s2"" FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e2"".""DepartmentId""=""e"".""DepartmentId"")"
721,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""Salary"">""e"".""Salary"" AND ""DepartmentId""=""d"".""Id"")<3 ORDER BY ""e"".""Salary"" DESC"
722,"SELECT ""D"".""name"" AS ""department"",""E"".""name"" AS ""employee"",""E"".""salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""D_rank"" FROM ""employee"" AS ""E"" ORDER BY ""departmentid"",""D_rank"") AS ""E"" JOIN ""department"" AS ""D"" ON ""D"".""id""=""E"".""departmentid"" WHERE ""D_rank""<=3"
723,"SELECT ""t2"".""name"" AS ""department"",""t1"".""name"" AS ""employee"",""t1"".""salary"" AS ""salary"" FROM ""employee"" AS ""t1"" JOIN ""department"" AS ""t2"" ON ""t2"".""id""=""t1"".""departmentid"" WHERE (SELECT COUNT(DISTINCT ""t3"".""salary"") FROM ""employee"" AS ""t3"" WHERE ""t3"".""departmentid""=""t1"".""departmentid"" AND ""t3"".""salary"">""t1"".""salary"")<=2"
724,"SELECT ""d"".""name"" AS ""Department"",""f"".""name"" AS ""Employee"",""f"".""salary"" FROM (SELECT ""e"".*,DENSE_RANK() OVER (PARTITION BY ""e"".""departmentid"" ORDER BY ""e"".""salary"" DESC) AS ""ranking"" FROM ""employee"" AS ""e"") AS ""f"" JOIN ""department"" AS ""d"" ON ""d"".""id""=""f"".""departmentid"" WHERE ""f"".""ranking""<=3"
725,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE (SELECT COUNT(DISTINCT ""T"".""Salary"") FROM ""Employee"" AS ""T"" WHERE ""T"".""DepartmentId""=""E"".""DepartmentId"" AND ""Salary"">""E"".""Salary"")<=2"
726,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""departmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""e1"".""DepartmentId"" AND ""e2"".""Salary"">""e1"".""Salary"")"
727,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e"".""Salary"" AND ""e"".""DepartmentId""=""e2"".""DepartmentId"")"
728,"SELECT ""D"".""Name"" AS ""Department"",""E"".""Name"" AS ""Employee"",""E"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""E"" JOIN ""Department"" AS ""D"" ON ""E"".""DepartmentId""=""D"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""E2"".""Salary"") FROM ""Employee"" AS ""E2"" WHERE ""E2"".""Salary"">""E"".""Salary"" AND ""E"".""DepartmentId""=""E2"".""DepartmentId"")"
729,"SELECT ""B"".""Name"" AS ""Department"",""A"".""Name"" AS ""Employee"",""A"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""A"" JOIN ""Department"" AS ""B"" ON ""A"".""DepartmentId""=""B"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""A"".""Salary"" AND ""A"".""DepartmentId""=""e2"".""DepartmentId"")"
730,"SELECT ""d"".""name"" AS ""department"",""e1"".""Name"" AS ""employee"",""e1"".""Salary"" AS ""salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""departmentId""=""d"".""id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e1"".""departmentId""=""e2"".""departmentId"" AND ""e2"".""salary"">""e1"".""salary"")<3"
731,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""DepartmentId""=""d"".""Id"" AND ""e2"".""Salary"">""e"".""Salary"")<3 ORDER BY ""e"".""departmentid"",""e"".""salary"" DESC"
732,"SELECT ""D"".""Name"" AS ""Department"",""T"".""Employee"",""T"".""Salary"" FROM (SELECT ""E"".""DepartmentId"",""E"".""Name"" AS ""Employee"",""E"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""E"".""DepartmentId"" ORDER BY ""E"".""Salary"" DESC) AS ""Rnk"" FROM ""Employee"" AS ""E"") AS ""T"" JOIN ""Department"" AS ""D"" ON ""T"".""DepartmentId""=""D"".""Id"" WHERE ""T"".""Rnk""<=3"
733,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ((""Employee"" AS ""e"") JOIN ""Department"" AS ""d"") JOIN (SELECT MIN(""Salary"") AS ""Salary"",""DepartmentId"" FROM (SELECT ""Salary"",""DepartmentId"" FROM (SELECT ""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""Num"" FROM ""Employee"") AS ""m"" WHERE ""m"".""Num""<=3) AS ""t"" GROUP BY ""DepartmentId"") AS ""r"" WHERE ""e"".""DepartmentId""=""d"".""Id"" AND ""r"".""DepartmentId""=""d"".""Id"" AND ""r"".""Salary""<=""e"".""Salary"""
734,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM (""Employee"" AS ""e1"") JOIN ""Department"" AS ""d"" WHERE ""e1"".""DepartmentId""=""d"".""Id"" AND 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
735,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
736,"SELECT ""d"".""name"" AS ""department"",""e1"".""name"" AS ""employee"",""e1"".""salary"" AS ""salary"" FROM (""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"") JOIN ""department"" AS ""d"" ON ""e1"".""departmentid""=""e2"".""departmentid"" AND ""e1"".""salary""<=""e2"".""salary"" AND ""d"".""id""=""e2"".""departmentid"" GROUP BY 1,2,3 HAVING COUNT(DISTINCT (""e2"".""salary""))<=3"
737,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
738,"SELECT ""b"".""name"" AS ""Department"",""a"".""name"" AS ""Employee"",""a"".""salary"" FROM ""employee"" AS ""a"" JOIN ""department"" AS ""b"" ON ""a"".""departmentId""=""b"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""c"".""salary"") FROM ""employee"" AS ""c"" WHERE ""c"".""salary"">""a"".""salary"" AND ""a"".""departmentId""=""c"".""departmentId"")"
739,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
740,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")"
741,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
742,"SELECT ""d"".""name"" AS ""Department"",""e1"".""name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e1"".""DepartmentId"" WHERE (SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")<3"
743,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"") ORDER BY ""Department"",""Salary"" DESC"
744,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")<3"
745,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""Department"".""Name"" AS ""Department"",""Employee"".""Name"" AS ""Employee"",""Employee"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""Employee"".""DepartmentId"" ORDER BY ""Employee"".""Salary"" DESC) AS ""salary_rank"" FROM ""Employee"" JOIN ""Department"" ON ""Employee"".""DepartmentId""=""Department"".""Id"" GROUP BY ""Employee"".""Salary"",""Employee"".""DepartmentId"",""Employee"".""Name"") AS ""temp_table"" WHERE ""salary_rank""<=3"
746,"SELECT ""a"" AS ""Department"",""b"" AS ""Employee"",""Salary"" FROM (SELECT ""department"".""name"" AS ""a"",""employee"".""name"" AS ""b"",""salary"",DENSE_RANK() OVER (PARTITION BY ""department"".""name"" ORDER BY ""salary"" DESC) AS ""Rnk"" FROM ""employee"" JOIN ""department"" ON ""employee"".""departmentid""=""department"".""id"") AS ""NEwTable"" WHERE ""Newtable"".""rnk""<=3 ORDER BY ""rnk"""
747,"WITH ""temp_tbl"" AS (SELECT ""d"".""name"" AS ""Department"",""i"".""name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM (""employee"" AS ""i"") JOIN ""department"" AS ""d"" WHERE ""i"".""departmentid""=""d"".""id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""temp_tbl"" WHERE ""rnk""<4"
748,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT (""e2"".""Salary"")) FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
749,"WITH ""cte"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""e"".""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""ranking"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""cte"" WHERE ""ranking""=1 OR ""ranking""=2 OR ""ranking""=3"
750,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
751,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""Salary"" DESC) AS ""rank_a"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""a"" WHERE ""rank_a""<=3"
752,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
753,"SELECT ""name"" AS ""Department"",""Employee"",""Salary"" FROM (SELECT ""e1"".""Name"" AS ""Employee"",""e1"".""Salary"",""e1"".""departmentId"" FROM ""Employee"" AS ""e1"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")) AS ""e"" JOIN ""department"" ON ""department"".""id""=""e"".""departmentId"""
754,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE (SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")<3"
755,"SELECT ""Department"",""Employee"",""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rn"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"") AS ""temp"" WHERE ""rn""<=3 AND ""Department"" IS NOT NULL"
756,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""Salary"") FROM ""Employee"" WHERE ""Salary"">""e"".""Salary"" AND ""DepartmentId""=""e"".""DepartmentId"") HAVING ""d"".""Name"" IS NOT NULL"
757,"WITH ""ranked_salaries"" AS (SELECT ""Name"" AS ""Employee"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""rank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""Employee"",""Salary"" FROM ""ranked_salaries"" JOIN ""Department"" ON (""ranked_salaries"".""DepartmentId""=""Department"".""Id"") WHERE ""rank""<=3"
758,"SELECT ""d"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" AS ""Salary"" FROM (""Employee"" AS ""e"") JOIN ""Department"" AS ""d"" WHERE ""e"".""departmentId""=""d"".""id"" AND 3>(SELECT COUNT(DISTINCT ""e1"".""salary"") FROM ""Employee"" AS ""e1"" WHERE ""e"".""salary""<""e1"".""salary"" AND ""e1"".""departmentId""=""d"".""id"")"
759,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
760,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""d"".""Id""=""e1"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e2"".""DepartmentId""=""e1"".""DepartmentId"")"
761,"WITH ""ranked_salary"" AS (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""s_rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") SELECT ""Department"",""Employee"",""Salary"" FROM ""ranked_salary"" WHERE ""s_rank""<=3"
762,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
763,"SELECT ""department"".""name"" AS ""Department"",""e"".""name"" AS ""Employee"",""e"".""salary"" FROM (SELECT ""departmentid"",""name"",""salary"",DENSE_RANK() OVER (PARTITION BY ""departmentid"" ORDER BY ""salary"" DESC) AS ""r"" FROM ""employee"") AS ""e"" JOIN ""department"" ON ""department"".""id""=""e"".""departmentid"" WHERE ""r""<=3"
764,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
765,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
766,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
767,"SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"" FROM ""Department"" AS ""d"" JOIN ""Employee"" AS ""e"" ON ""d"".""Id""=""e"".""DepartmentId"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""Employee"" AS ""e2"" WHERE ""e"".""salary""<""e2"".""salary"" AND ""e2"".""DepartmentId""=""e"".""DepartmentId"")"
768,"SELECT ""d"".""name"" AS ""department"",""e"".""name"" AS ""employee"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN ""department"" AS ""d"" ON ""e"".""departmentid""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e"".""salary"" AND ""e2"".""departmentid""=""e"".""departmentid"")"
769,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
770,"SELECT ""t"".""Department"",""t"".""Employee"",""t"".""Salary"" FROM (SELECT ""d"".""Name"" AS ""Department"",""e"".""Name"" AS ""Employee"",""e"".""Salary"",DENSE_RANK() OVER (PARTITION BY ""d"".""Name"" ORDER BY ""e"".""Salary"" DESC) AS ""rank"" FROM ""Employee"" AS ""e"" JOIN ""Department"" AS ""d"" ON ""e"".""DepartmentId""=""d"".""Id"") AS ""t"" WHERE ""t"".""rank""<=3"
771,"SELECT ""d"".""name"" AS ""department"",""e1"".""name"" AS ""Employee"",""e1"".""Salary"" FROM ""employee"" AS ""e1"" JOIN ""department"" AS ""d"" ON ""e1"".""departmentid""=""d"".""id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""salary"">""e1"".""salary"" AND ""e2"".""departmentid""=""e1"".""departmentid"")"
772,"WITH ""top_salary1"" AS (SELECT ""Name"",""Salary"",""DepartmentId"",DENSE_RANK() OVER (PARTITION BY ""DepartmentId"" ORDER BY ""Salary"" DESC) AS ""dnse_rank"" FROM ""Employee"") SELECT ""Department"".""Name"" AS ""Department"",""top_salary1"".""Name"" AS ""Employee"",""top_salary1"".""Salary"" FROM ""top_salary1"" JOIN ""Department"" ON ""top_salary1"".""DepartmentId""=""Department"".""Id"" WHERE ""dnse_rank""<=3"
773,"SELECT ""d"".""Name"" AS ""Department"",""e1"".""Name"" AS ""Employee"",""e1"".""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Department"" AS ""d"" ON ""e1"".""DepartmentId""=""d"".""Id"" WHERE 3>(SELECT COUNT(DISTINCT ""e2"".""Salary"") FROM ""Employee"" AS ""e2"" WHERE ""e2"".""Salary"">""e1"".""Salary"" AND ""e1"".""DepartmentId""=""e2"".""DepartmentId"")"
