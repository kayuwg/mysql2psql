id,original query
1,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
2,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
3,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"") SELECT ""PERSON1"" AS ""person1"",""PERSON2"" AS ""person2"",COUNT(""PERSON1"") AS ""call_count"",SUM(""DURATION"") AS ""total_duration"" FROM ""CTE"" WHERE ""PERSON1""<""PERSON2"" GROUP BY ""PERSON1"",""PERSON2"""
4,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ((SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"") UNION ALL (SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"")) AS ""tb"" GROUP BY ""person1"",""person2"""
5,"WITH ""cte1"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte1"" GROUP BY ""from_id"",""to_id"""
6,"WITH ""CTE"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""from_id"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE"" GROUP BY ""from_id"",""to_id"""
7,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls"") AS ""temp"" GROUP BY ""person1"",""person2"""
8,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""t1"" GROUP BY 1,2"
9,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
10,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
11,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""duration"",CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"" FROM ""Calls"") AS ""sub1"" GROUP BY ""person1"",""person2"""
12,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person2"",""person1"""
13,"WITH ""temp1"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""temp1"" GROUP BY ""person1"",""person2"""
14,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""from_id"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
15,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
16,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person2"",""person1"""
17,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
18,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY LEAST(""from_id"", ""to_id""),GREATEST(""from_id"", ""to_id"")"
19,"WITH ""getCalls"" AS (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"" UNION ALL SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""getCalls"" GROUP BY 1,2 ORDER BY 1,2"
20,"SELECT (CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
21,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
22,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2 ORDER BY 1,2"
23,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
24,"WITH ""TEMP"" AS (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""TEMP"" GROUP BY 1,2 HAVING ""from_id""<""to_id"""
25,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""c"".""duration"") AS ""total_duration"" FROM ""calls"" AS ""c"" GROUP BY 1,2"
26,"SELECT ""sub"".""person1"",""sub"".""person2"",COUNT(1) AS ""call_count"",SUM(""sub"".""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""sub"" GROUP BY ""sub"".""person1"",""sub"".""person2"" HAVING ""sub"".""person1""<""sub"".""person2"""
27,"SELECT ""a"".""from_id"" AS ""person1"",""a"".""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""a"".""duration"") AS ""total_duration"" FROM (SELECT (CASE WHEN ""c"".""from_id""<""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END) AS ""from_id"",(CASE WHEN ""c"".""from_id""<""c"".""to_id"" THEN ""c"".""to_id"" ELSE ""c"".""from_id"" END) AS ""to_id"",""c"".""duration"" FROM ""calls"" AS ""c"") AS ""a"" GROUP BY ""a"".""from_id"",""a"".""to_id"""
28,"WITH ""cte"" AS (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
29,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
30,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
31,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END,CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END"
32,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
33,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(CASE WHEN ""from_id""<""to_id"" THEN CONCAT(""from_id"", ""to_id"") ELSE 0 END) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE CASE WHEN ""from_id""<""to_id"" THEN CONCAT(""from_id"", ""to_id"") WHEN ""to_id""<""from_id"" THEN CONCAT(""to_id"", ""from_id"") END GROUP BY CASE WHEN ""from_id""<""to_id"" THEN CONCAT(""from_id"", ""to_id"") WHEN ""to_id""<""from_id"" THEN CONCAT(""to_id"", ""from_id"") END"
34,"WITH ""tb1"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""tb1"" GROUP BY ""person1"",""person2"""
35,"WITH ""tab"" AS (SELECT * FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""tab"" WHERE ""from_id""<""to_id"" GROUP BY 1,2 ORDER BY 1,2"
36,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END,CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END"
37,"SELECT DISTINCT ""PERSON1"",""PERSON2"",COUNT(""C"".""DURATION"") AS ""CALL_COUNT"",SUM(""C"".""DURATION"") AS ""TOTAL_DURATION"" FROM (SELECT (CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""FROM_ID"" ELSE ""TO_ID"" END) AS ""PERSON1"",(CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""TO_ID"" ELSE ""FROM_ID"" END) AS ""PERSON2"",""DURATION"" FROM ""CALLS"") AS ""C"" GROUP BY ""PERSON1"",""PERSON2"" ORDER BY ""PERSON1"""
38,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""from_id"",""to_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") AS ""t"" GROUP BY ""from_id"",""to_id"""
39,"SELECT ""id1"" AS ""person1"",""id2"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""id1"",""to_id"" AS ""id2"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""id1"",""from_id"" AS ""id2"",""duration"" FROM ""calls"") AS ""temp"" WHERE ""id1""<""id2"" GROUP BY ""id1"",""id2"""
40,"SELECT ""t2"".""person1"" AS ""Person1"",""t2"".""person2"" AS ""Person2"",COUNT(1) AS ""call_count"",SUM(""t2"".""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""t2"" GROUP BY ""t2"".""person1"",""t2"".""person2"""
41,"SELECT CASE WHEN ""to_id"">""from_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
42,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
43,"WITH ""t"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" GROUP BY 1,2"
44,"SELECT ""a"".""person1"",""a"".""person2"",COUNT(1) AS ""call_count"",SUM(""a"".""duration"") AS ""total_duration"" FROM (SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",""duration"" FROM ""calls"") AS ""a"" GROUP BY ""a"".""person1"",""a"".""person2"""
45,"SELECT DISTINCT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""a"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
46,"WITH ""cte_summary"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte_summary"" GROUP BY ""person1"",""person2"""
47,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
48,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
49,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""to_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2 ORDER BY 1,2"
50,"SELECT ""temp"".""from_id"" AS ""person1"",""temp"".""to_id"" AS ""person2"",COUNT(""temp"".""from_id"") AS ""call_count"",SUM(""temp"".""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"") AS ""temp"" WHERE ""temp"".""from_id""<""temp"".""to_id"" GROUP BY ""temp"".""from_id"",""temp"".""to_id"""
51,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
52,"SELECT DISTINCT ""PERSON1"",""PERSON2"",COUNT(""C"".""DURATION"") AS ""CALL_COUNT"",SUM(""C"".""DURATION"") AS ""TOTAL_DURATION"" FROM (SELECT (CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""FROM_ID"" ELSE ""TO_ID"" END) AS ""PERSON1"",(CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""TO_ID"" ELSE ""FROM_ID"" END) AS ""PERSON2"",""DURATION"" FROM ""CALLS"") AS ""C"" GROUP BY ""PERSON1"",""PERSON2"" ORDER BY ""PERSON1"""
53,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
54,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""tmp"" GROUP BY 1,2"
55,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
56,"SELECT DISTINCT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""a"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
57,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
58,"WITH ""temp"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""temp"" GROUP BY 1,2"
59,"WITH ""a"" AS (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""a"" GROUP BY ""person1"",""person2"" HAVING ""person1""<""person2"""
60,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
61,"SELECT ""A"".""person1"",""A"".""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""A"" WHERE ""A"".""person1""<""A"".""person2"" GROUP BY 1,2"
62,"WITH ""cte"" AS (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
63,"WITH ""cte"" AS (SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
64,"WITH ""t"" AS (SELECT ""from_id"",""to_id"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""from_id"",""to_id"") SELECT DISTINCT CASE WHEN ""t1"".""from_id""<""t1"".""to_id"" THEN ""t1"".""from_id"" ELSE ""t1"".""to_id"" END AS ""person1"",CASE WHEN ""t1"".""from_id""<""t1"".""to_id"" THEN ""t1"".""to_id"" ELSE ""t1"".""from_id"" END AS ""person2"",CASE WHEN ""t2"".""from_id"" IS NULL THEN ""t1"".""call_count"" ELSE ""t1"".""call_count""+""t2"".""call_count"" END AS ""call_count"",CASE WHEN ""t2"".""from_id"" IS NULL THEN ""t1"".""total_duration"" ELSE ""t1"".""total_duration""+""t2"".""total_duration"" END AS ""total_duration"" FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""from_id""=""t2"".""to_id"" AND ""t1"".""to_id""=""t2"".""from_id"""
65,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN (""from_id""<""to_id"") THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN (""from_id""<""to_id"") THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""CallsProcessed"" GROUP BY ""person1"",""person2"""
66,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
67,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
68,"WITH ""CTE1"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE1"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"""
69,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
70,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
71,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"" UNION ALL SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"") AS ""t"" GROUP BY 1,2 ORDER BY ""person1"""
72,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
73,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
74,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
75,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT (CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""from_id"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""to_id"",""duration"" FROM ""Calls"") AS ""t"" GROUP BY ""from_id"",""to_id"""
76,"SELECT CASE WHEN ""c"".""from_id""<""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person1"",CASE WHEN ""c"".""from_id"">""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" AS ""c"" GROUP BY ""person1"",""person2"""
77,"WITH ""pairs"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"" UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"") SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""pairs"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
78,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
79,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""from_id"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id"",""duration"" FROM ""Calls"") AS ""temp"" GROUP BY ""from_id"",""to_id"""
80,"WITH ""t1"" AS (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t1"" GROUP BY 1,2"
81,"SELECT DISTINCT ""Person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT DISTINCT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" UNION ALL SELECT DISTINCT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"" GROUP BY ""from_id"",""to_id"") AS ""f"" GROUP BY ""person1"",""person2"""
82,"WITH ""TEMP"" AS (SELECT (CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""FROM_ID"" ELSE ""TO_ID"" END) AS ""PERSON1"",(CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""TO_ID"" ELSE ""FROM_ID"" END) AS ""PERSON2"",""DURATION"" FROM ""CALLS"" AS ""C"") SELECT DISTINCT ""PERSON1"",""PERSON2"",COUNT(""DURATION"") AS ""CALL_COUNT"",SUM(""DURATION"") AS ""TOTAL_DURATION"" FROM ""TEMP"" GROUP BY ""PERSON1"",""PERSON2"""
83,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
84,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"") AS ""a"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"""
85,"WITH ""t"" AS (SELECT ""from_id"" AS ""p1"",""to_id"" AS ""p2"",""duration"" FROM ""calls"" WHERE ""to_id"">""from_id"" UNION ALL SELECT ""to_id"" AS ""p1"",""from_id"" AS ""p2"",""duration"" FROM ""calls"" WHERE ""to_id""<""from_id"") SELECT ""p1"" AS ""person1"",""p2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM ""t"" GROUP BY ""person1"",""person2"""
86,"WITH ""reorder_tb"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""reorder_tb"" GROUP BY ""person1"",""person2"""
87,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
88,"WITH ""temp"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""temp"" GROUP BY ""from_id"",""to_id"""
89,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
90,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person1"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""all_ordered"" GROUP BY ""person1"",""person2"""
91,"SELECT ""t"".""person1"",""t"".""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""t"" WHERE ""t"".""person1""<""t"".""person2"" GROUP BY 1,2"
92,"WITH ""base"" AS (SELECT * FROM (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"") AS ""t"" UNION ALL (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"")) SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""base"" GROUP BY 1,2"
93,"WITH ""cte"" AS (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
94,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"") AS ""tmp"" GROUP BY ""person1"",""person2"""
95,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
96,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
97,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
98,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
99,"WITH ""X"" AS (SELECT DISTINCT * FROM ""Calls""), ""CTE1"" AS (SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE1"" GROUP BY ""person1"",""person2"""
100,"SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"" GROUP BY ""to_id"",""from_id"") AS ""A"" GROUP BY ""person1"",""person2"""
101,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" WHEN ""from_id"">""to_id"" THEN ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" WHEN ""from_id"">""to_id"" THEN ""from_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
102,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
103,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
104,"SELECT ""id1"" AS ""person1"",""id2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT LEAST(""from_id"", ""to_id"") AS ""id1"",GREATEST(""from_id"", ""to_id"") AS ""id2"",""duration"" FROM ""Calls"") AS ""t1"" GROUP BY ""id1"",""id2"""
105,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""t"" GROUP BY ""person1"",""person2"""
106,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"" WHERE ""to_id""<""from_id"") AS ""a"" GROUP BY ""from_id"",""to_id"""
107,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""T1"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" ORDER BY 1"
108,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
109,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
110,"WITH ""CTE1"" AS (SELECT ""FROM_ID"" AS ""PERSON1"",""TO_ID"" AS ""PERSON2"",""DURATION"" FROM ""CALLS"" WHERE ""FROM_ID""<""TO_ID"" UNION ALL SELECT ""TO_ID"" AS ""PERSON1"",""FROM_ID"" AS ""PERSON2"",""DURATION"" FROM ""CALLS"" WHERE ""TO_ID""<""FROM_ID"") SELECT ""PERSON1"",""PERSON2"",COUNT(1) AS ""CALL_COUNT"",SUM(""DURATION"") AS ""TOTAL_DURATION"" FROM ""CTE1"" GROUP BY ""PERSON1"",""PERSON2"""
111,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
112,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""from_id"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""to_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
113,"WITH ""t"" AS (SELECT ""from_id"" AS ""p1"",""to_id"" AS ""p2"",""duration"" FROM ""calls"" WHERE ""to_id"">""from_id"" UNION ALL SELECT ""to_id"" AS ""p1"",""from_id"" AS ""p2"",""duration"" FROM ""calls"" WHERE ""to_id""<""from_id"") SELECT ""p1"" AS ""person1"",""p2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM ""t"" GROUP BY ""person1"",""person2"""
114,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
115,"SELECT ""A"".""person1"",""A"".""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""A"" WHERE ""A"".""person1""<""A"".""person2"" GROUP BY 1,2"
116,"WITH ""main"" (""person1"", ""person2"", ""duration"") AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_Count"",SUM(""duration"") AS ""total_duration"" FROM ""main"" GROUP BY ""person1"",""person2"""
117,"WITH ""allrows"" AS (SELECT CASE WHEN ""from_id""<=""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<=""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""allrows"" GROUP BY ""person1"",""person2"" ORDER BY ""person1"",""person2"""
118,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""Person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""Person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"" ORDER BY ""person1"",""person2"""
119,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" WHEN ""from_id"">""to_id"" THEN ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" WHEN ""from_id"">""to_id"" THEN ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
120,"WITH ""CTE"" AS (SELECT *,CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE"" GROUP BY ""person1"",""person2"""
121,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""from_id"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""to_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""from_id"",""to_id"""
122,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
123,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
124,"WITH ""t1"" AS (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t1"" GROUP BY ""person1"",""person2"""
125,"WITH ""t"" AS (SELECT ""t1"".""from_id"",""t1"".""to_id"",""t1"".""duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"") AS ""t1"" WHERE ""t1"".""to_id"">""t1"".""from_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" GROUP BY ""from_id"",""to_id"""
126,"SELECT DISTINCT ""PERSON1"",""PERSON2"",COUNT(""C"".""DURATION"") AS ""CALL_COUNT"",SUM(""C"".""DURATION"") AS ""TOTAL_DURATION"" FROM (SELECT (CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""FROM_ID"" ELSE ""TO_ID"" END) AS ""PERSON1"",(CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""TO_ID"" ELSE ""FROM_ID"" END) AS ""PERSON2"",""DURATION"" FROM ""CALLS"") AS ""C"" GROUP BY ""PERSON1"",""PERSON2"" ORDER BY ""PERSON1"""
127,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"") SELECT ""PERSON1"" AS ""person1"",""PERSON2"" AS ""person2"",COUNT(""PERSON1"") AS ""call_count"",SUM(""DURATION"") AS ""total_duration"" FROM ""CTE"" WHERE ""PERSON1""<""PERSON2"" GROUP BY ""PERSON1"",""PERSON2"""
128,"SELECT ""base"".""person1"",""base"".""person2"",COUNT(1) AS ""call_count"",SUM(""base"".""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""base"" WHERE ""base"".""person1""<""base"".""person2"" GROUP BY ""base"".""person1"",""base"".""person2"""
129,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",SUM(""ct"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",COUNT(1) AS ""ct"",SUM(""duration"") AS ""duration"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"" HAVING ""from_id""<""to_id"" UNION SELECT ""to_id"",""from_id"",COUNT(1) AS ""ct"",SUM(""duration"") AS ""duration"" FROM ""Calls"" GROUP BY ""to_id"",""from_id"" HAVING ""to_id""<""from_id"") AS ""sub"" GROUP BY ""from_id"",""to_id"""
130,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
131,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
132,"SELECT MIN(""from_id"") AS ""person1"",MAX(""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CONCAT(LEAST(""from_id"", ""to_id""), '-', GREATEST(""from_id"", ""to_id"")) AS ""persons"",""from_id"",""to_id"",""duration"" FROM ""Calls"") AS ""a"" GROUP BY ""persons"""
133,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
134,"SELECT ""t"".""from_id"" AS ""person1"",""t"".""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""t"" WHERE ""t"".""from_id""<""t"".""to_id"" GROUP BY ""person1"",""person2"""
135,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",""duration"" FROM ""Calls"" AS ""c"") AS ""temp"" GROUP BY ""person1"",""person2"""
136,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
137,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls"") AS ""x"" GROUP BY ""person1"",""person2"""
138,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
139,"WITH ""final"" AS (WITH ""other1"" AS (WITH ""other"" AS (WITH ""cte"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""from_id"", ""to_id"") AS ""calls_between"" FROM ""Calls"") SELECT *,SUM(""duration"") AS ""initial_sum"" FROM ""cte"" GROUP BY ""from_id"",""to_id"") SELECT ""o1"".""from_id"" AS ""first_from"",""o1"".""to_id"" AS ""first_to"",""o2"".""from_id"" AS ""second_from"",""o2"".""to_id"" AS ""second_to"",""o1"".""calls_between"",""o1"".""initial_sum"" AS ""first_sum"",""o2"".""initial_sum"" AS ""second_sum"" FROM ""other"" AS ""o1"" LEFT JOIN ""other"" AS ""o2"" ON ""o1"".""to_id""=""o2"".""from_id"" AND ""o1"".""from_id""=""o2"".""to_id"" WHERE (""o2"".""from_id"" IS NULL AND ""o2"".""to_id"" IS NULL) OR (""o1"".""from_id""<""o2"".""from_id"" AND ""o1"".""to_id"">""o2"".""to_id"")) SELECT *,CASE WHEN (""first_from""=""second_to"" AND ""first_to""=""second_from"") THEN ""calls_between""+1 WHEN ""second_from"" IS NULL AND ""second_to"" IS NULL THEN ""calls_between"" END AS ""updated_call_count"",CASE WHEN (""first_from""=""second_to"" AND ""first_to""=""second_from"") THEN ""first_sum""+""second_sum"" WHEN ""second_from"" IS NULL AND ""second_to"" IS NULL THEN ""first_sum"" END AS ""updated_sum"" FROM ""other1"") SELECT ""first_from"" AS ""person1"",""first_to"" AS ""person2"",""updated_call_count"" AS ""call_count"",""updated_sum"" AS ""total_duration"" FROM ""final"""
140,"WITH ""CTE1"" AS (SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE1"" GROUP BY ""person1"",""person2"""
141,"WITH ""cte"" AS (SELECT ""from_id"",""to_id"",COUNT(1) AS ""cnt"",SUM(""duration"") AS ""dur"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"") SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",SUM(""cnt"") AS ""call_count"",SUM(""dur"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
142,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
143,"SELECT (CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
144,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
145,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""t1"" WHERE ""from_id""<""to_id"" GROUP BY ""person1"",""person2"""
146,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""to_id"", ""from_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
147,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
148,"SELECT ""id1"" AS ""person1"",""id2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""id1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""id2"",""duration"" FROM ""Calls"") AS ""t1"" GROUP BY ""id1"",""id2"""
149,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""from_id""+""to_id"",""from_id""*""to_id"" ORDER BY 1,2"
150,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
151,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
152,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
153,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
154,"SELECT DISTINCT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""a"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
155,"WITH ""cte"" AS (SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
156,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"" ORDER BY ""person1"""
157,"WITH ""summaryTable"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c1"" GROUP BY ""from_id"",""to_id"") SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""summaryTable"" AS ""st"" GROUP BY ""person1"",""person2"""
158,"WITH ""cte"" AS ((SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"") UNION ALL (SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"")) SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
159,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
160,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
161,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
162,"WITH ""cte"" AS (SELECT DISTINCT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) OVER (PARTITION BY ""from_id"", ""to_id"") AS ""call_count"",SUM(""duration"") OVER (PARTITION BY ""from_id"", ""to_id"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION SELECT DISTINCT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) OVER (PARTITION BY ""to_id"", ""from_id"") AS ""call_count"",SUM(""duration"") OVER (PARTITION BY ""to_id"", ""from_id"") AS ""total_duration"" FROM ""calls"" WHERE ""to_id""<""from_id"") SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
163,"WITH ""cte"" AS (SELECT * FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
164,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
165,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
166,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
167,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
168,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls""), ""cte_1"" AS (SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"") SELECT * FROM ""cte_1"""
169,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""to_id""<""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""from_id"",CASE WHEN ""to_id""<""from_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id"",""duration"" FROM ""Calls"") AS ""a"" GROUP BY ""from_id"",""to_id"""
170,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
171,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
172,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
173,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
174,"WITH ""ct"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id"">""to_id"" GROUP BY ""to_id"",""from_id"") SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""ct"" GROUP BY ""person1"",""person2"""
175,"WITH ""t"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" GROUP BY ""person1"",""person2"""
176,"SELECT CASE WHEN ""c"".""from_id""<""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person1"",CASE WHEN ""c"".""from_id"">""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" AS ""c"" GROUP BY ""person1"",""person2"""
177,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
178,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
179,"WITH ""person_single"" AS (SELECT * FROM (SELECT DISTINCT ""from_id"" AS ""person"" FROM ""Calls"" UNION SELECT DISTINCT ""to_id"" AS ""person"" FROM ""Calls"") AS ""sub""), ""duration_sub"" AS (SELECT * FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""sub2""), ""combo_pair"" AS (SELECT ""p1"".""person"" AS ""person1"",""p2"".""person"" AS ""person2"" FROM ""person_single"" AS ""p1"" JOIN ""person_single"" AS ""p2"" ON ""p1"".""person""<""p2"".""person"") SELECT ""d"".""person1"",""d"".""person2"",COUNT(""d"".""duration"") AS ""call_count"",SUM(""d"".""duration"") AS ""total_duration"" FROM ""combo_pair"" AS ""p"" JOIN ""duration_sub"" AS ""d"" ON ""p"".""person1""=""d"".""person1"" AND ""p"".""person2""=""d"".""person2"" GROUP BY 1,2"
180,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2 ORDER BY 1,2"
181,"SELECT DISTINCT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
182,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") AS ""t"" GROUP BY 1,2"
183,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(CASE WHEN ""from_id""<""to_id"" THEN CONCAT(""from_id"", ""to_id"") ELSE 0 END) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE CASE WHEN ""from_id""<""to_id"" THEN CONCAT(""from_id"", ""to_id"") WHEN ""to_id""<""from_id"" THEN CONCAT(""to_id"", ""from_id"") END GROUP BY CASE WHEN ""from_id""<""to_id"" THEN CONCAT(""from_id"", ""to_id"") WHEN ""to_id""<""from_id"" THEN CONCAT(""to_id"", ""from_id"") END"
184,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
185,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",SUM(""duration"") AS ""total_duration"",COUNT(""duration"") AS ""call_count"" FROM ""Calls"" GROUP BY ""person1"",""person2"" ORDER BY ""person1"",""person2"""
186,"WITH ""all_calls"" AS (SELECT DISTINCT ""from_id"",""to_id"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" UNION ALL SELECT DISTINCT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"" GROUP BY ""from_id"",""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""all_calls"" GROUP BY ""person1"",""person2"""
187,"SELECT ""t"".""from_id"" AS ""person1"",""t"".""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""t"" GROUP BY 1,2"
188,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
189,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
190,"WITH ""CET"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CET"" GROUP BY 1,2"
191,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
192,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
193,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""all_records"" GROUP BY ""person1"",""person2"""
194,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" AS ""a"" GROUP BY ""person1"",""person2"""
195,"SELECT DISTINCT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""a"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
196,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
197,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY LEAST(""from_id"", ""to_id""),GREATEST(""from_id"", ""to_id"")"
198,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
199,"WITH ""t"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT DISTINCT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" GROUP BY ""person1"",""person2"""
200,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
201,"WITH ""CTE"" AS (SELECT * FROM ""calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"""
202,"WITH ""CTE"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
203,"SELECT (CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
204,"SELECT ""t"".""from_id"" AS ""person1"",""t"".""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM ((SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"") UNION ALL (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"")) AS ""t"" GROUP BY 1,2"
205,"SELECT ""t"".""from_id"" AS ""person1"",""t"".""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""t"" WHERE ""t"".""from_id""<""t"".""to_id"" GROUP BY ""person1"",""person2"""
206,"SELECT ""c3"".""to_id"" AS ""person1"",""c3"".""from_id"" AS ""person2"",COUNT(""c3"".""duration"") AS ""call_count"",SUM(""c3"".""duration"") AS ""total_duration"" FROM (SELECT ""c1"".""to_id"",""c1"".""from_id"",""c1"".""duration"" FROM ""Calls"" AS ""c1"" UNION ALL SELECT ""c2"".""from_id"" AS ""to_id"",""c2"".""to_id"" AS ""from_id"",""c2"".""duration"" FROM ""Calls"" AS ""c2"") AS ""c3"" WHERE ""to_id""<""from_id"" GROUP BY ""to_id"",""from_id"""
207,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
208,"WITH ""main"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""main"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"""
209,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
210,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"") AS ""t"" GROUP BY ""person1"",""person2"""
211,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
212,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""temp"" GROUP BY ""person1"",""person2"""
213,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"" UNION ALL SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"") AS ""a"" GROUP BY ""from_id"",""to_id"""
214,"WITH ""t"" AS (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" WHERE ""from_id""<""to_id"" GROUP BY 1,2"
215,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
216,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""all_records"" GROUP BY ""person1"",""person2"""
217,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person2"",""person1"""
218,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""t1"" WHERE ""from_id""<""to_id"" GROUP BY ""person1"",""person2"""
219,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
220,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
221,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
222,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""to_id""<""from_id"") AS ""a"" GROUP BY ""person1"",""person2"""
223,"WITH ""tab"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""tab"" GROUP BY ""person1"",""person2"""
224,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
225,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
226,"WITH ""c"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""from_id"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""to_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""c"" GROUP BY ""from_id"",""to_id"""
227,"WITH ""t"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" GROUP BY 1,2"
228,"WITH ""temp"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""temp"" GROUP BY ""from_id"",""to_id"""
229,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""from_id"",CASE WHEN ""to_id""<""from_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id"",""duration"" FROM ""Calls"") AS ""t1"" GROUP BY ""from_id"",""to_id"""
230,"WITH ""cte1"" AS (SELECT * FROM ""Calls"" WHERE ""from_id""<""to_id""), ""cte2"" AS (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id""), ""cte3"" AS (SELECT * FROM ""cte1"" UNION ALL SELECT * FROM ""cte2"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte3"" GROUP BY ""person1"",""person2"""
231,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
232,"WITH ""clean_calls"" AS (SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""clean_calls"" GROUP BY ""person1"",""person2"""
233,"SELECT DISTINCT ""PERSON1"",""PERSON2"",COUNT(""C"".""DURATION"") AS ""CALL_COUNT"",SUM(""C"".""DURATION"") AS ""TOTAL_DURATION"" FROM (SELECT (CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""FROM_ID"" ELSE ""TO_ID"" END) AS ""PERSON1"",(CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""TO_ID"" ELSE ""FROM_ID"" END) AS ""PERSON2"",""DURATION"" FROM ""CALLS"") AS ""C"" GROUP BY ""PERSON1"",""PERSON2"" ORDER BY ""PERSON1"""
234,"SELECT CASE WHEN ""c"".""from_id""<""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person1"",CASE WHEN ""c"".""from_id"">""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" AS ""c"" GROUP BY ""person1"",""person2"""
235,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
236,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
237,"WITH ""tmp"" AS ((SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"") UNION ALL (SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"")) SELECT ""person1"",""person2"",COUNT(""person1"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""tmp"" GROUP BY ""person1"",""person2"""
238,"WITH ""cte"" AS (SELECT ""c1"".""from_id"",""c1"".""to_id"",""c1"".""duration"" FROM ""calls"" AS ""c1"" UNION ALL SELECT ""c2"".""to_id"" AS ""from_id"",""c2"".""from_id"" AS ""to_id"",""c2"".""duration"" FROM ""calls"" AS ""c2"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""from_id"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" WHERE ""from_id""<""to_id"" GROUP BY 1,2"
239,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
240,"WITH ""cte"" AS (SELECT ""from_id"",""to_id"",SUM(""duration"") AS ""dur"",COUNT(""from_id"") AS ""cnt"" FROM ""calls"" GROUP BY 1,2 ORDER BY 1,2) SELECT ""c1"".""from_id"" AS ""person1"",""c1"".""to_id"" AS ""person2"",SUM(COALESCE(""c1"".""cnt"", 0)+COALESCE(""c2"".""cnt"", 0)) AS ""call_count"",SUM(COALESCE(""c1"".""dur"", 0)+COALESCE(""c2"".""dur"", 0)) AS ""total_duration"" FROM ""cte"" AS ""c1"" LEFT JOIN ""cte"" AS ""c2"" ON ""c1"".""to_id""=""c2"".""from_id"" AND ""c2"".""to_id""=""c1"".""from_id"" WHERE ""c1"".""from_id""<""c2"".""from_id"" OR ""c2"".""to_id"" IS NULL GROUP BY 1,2"
241,"WITH ""main"" (""person1"", ""person2"", ""duration"") AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_Count"",SUM(""duration"") AS ""total_duration"" FROM ""main"" GROUP BY ""person1"",""person2"""
242,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
243,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""from_id1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""to_id1"",""duration"" FROM ""calls"") SELECT ""from_id1"" AS ""person1"",""to_id1"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
244,"WITH ""a"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""id1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""id2"",""duration"" FROM (SELECT * FROM ""calls"" WHERE ""from_id""!=""to_id"") AS ""t"") SELECT ""id1"" AS ""person1"",""id2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""a"" GROUP BY ""id1"",""id2"""
245,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
246,"SELECT CASE WHEN ""calls"".""from_id""<""calls"".""to_id"" THEN ""calls"".""from_id"" ELSE ""calls"".""to_id"" END AS ""person1"",CASE WHEN ""calls"".""from_id""<""calls"".""to_id"" THEN ""calls"".""to_id"" ELSE ""calls"".""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
247,"WITH ""table1"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""table1"" GROUP BY ""person1"",""person2"""
248,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
249,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
250,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
251,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2 ORDER BY 1,2"
252,"SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""callA"" GROUP BY ""person1"",""person2"""
253,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
254,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
255,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
256,"WITH ""t"" AS (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""t"".""person1"",""t"".""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""t"" GROUP BY ""person1"",""person2"""
257,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
258,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
259,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"") AS ""a"" WHERE 1=1 AND ""person1""<""person2"" GROUP BY ""person1"",""person2"""
260,"SELECT ""person1"",""person2"",COUNT(""c"".""duration"") AS ""call_count"",SUM(""c"".""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""c"" GROUP BY ""person1"",""person2"""
261,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
262,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
263,"WITH ""cte"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
264,"ERROR: mysql parse error: line 1 column 4 near ""CASE WHEN from_id < to_id THEN from_id ELSE to_id END AS person1, CASE WHEN from_id < to_id THEN to_id ELSE from_id END AS person2, COUNT(*) call_count, SUM(duration) total_duration FROM Calls c GROUP BY 1, 2 "" "
265,"SELECT ""c"".""person1"",""c"".""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c"" WHERE ""from_id""<""to_id"" GROUP BY 1,2 UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c"" WHERE ""from_id"">""to_id"" GROUP BY 1,2) AS ""c"" GROUP BY 1,2"
266,"SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""tmp"" GROUP BY 1,2"
267,"WITH ""tot"" AS (SELECT ""c1"".""from_id"" AS ""person1"",""c1"".""to_id"" AS ""person2"",COUNT(""c1"".""duration"") AS ""ct"",SUM(""c1"".""duration"") AS ""dur"" FROM ""calls"" AS ""c1"" WHERE ""c1"".""from_id""<""c1"".""to_id"" GROUP BY ""c1"".""from_id"",""c1"".""to_id"" UNION SELECT ""c2"".""to_id"" AS ""person1"",""c2"".""from_id"" AS ""person1"",COUNT(""c2"".""duration"") AS ""ct"",SUM(""c2"".""duration"") AS ""dur"" FROM ""calls"" AS ""c2"" WHERE ""c2"".""to_id""<""c2"".""from_id"" GROUP BY ""c2"".""to_id"",""c2"".""from_id"") SELECT ""person1"",""person2"",SUM(""ct"") AS ""call_count"",SUM(""dur"") AS ""total_duration"" FROM ""tot"" GROUP BY ""person1"",""person2"""
268,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") AS ""t"" GROUP BY ""person1"",""person2"""
269,"SELECT CASE WHEN (""from_id"">""to_id"") THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN (""from_id"">""to_id"") THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
270,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
271,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
272,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
273,"SELECT ""c"".""person1"",""c"".""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c"" WHERE ""from_id""<""to_id"" GROUP BY 1,2 UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c"" WHERE ""from_id"">""to_id"" GROUP BY 1,2) AS ""c"" GROUP BY 1,2"
274,"SELECT DISTINCT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") AS ""t"" GROUP BY 1,2"
275,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") AS ""a"" GROUP BY ""person1"",""person2"""
276,"WITH ""temp"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""temp"" GROUP BY ""from_id"",""to_id"""
277,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
278,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
279,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
280,"SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2 UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2) AS ""sub"" GROUP BY 1,2 HAVING ""person1""<""person2"""
281,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
282,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
283,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2 ORDER BY 1,2"
284,"SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id"">""to_id"" GROUP BY ""from_id"",""to_id"") AS ""t"" GROUP BY ""person1"",""person2"" ORDER BY ""person1"""
285,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""temp"" WHERE ""from_id""<""to_id"" GROUP BY ""person1"",""person2"""
286,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"" WHERE ""to_id""<""from_id"") AS ""t"" GROUP BY 1,2 ORDER BY 1,2"
287,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") AS ""a"" GROUP BY ""from_id"",""to_id"""
288,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
289,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
290,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2 ORDER BY 1,2"
291,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
292,"WITH ""base"" AS (SELECT ""from_id"" AS ""id1"",""to_id"" AS ""id2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""id1"",""from_id"" AS ""id2"",""duration"" FROM ""Calls"") SELECT ""id1"" AS ""person1"",""id2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""base"" WHERE ""id1""<""id2"" GROUP BY 1,2"
293,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
294,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"" ORDER BY ""person1"",""person2"""
295,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
296,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""to_id""<""from_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
297,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END,CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END"
298,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
299,"WITH ""cte"" AS (SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
300,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"") AS ""A"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"""
301,"SELECT DISTINCT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
302,"SELECT ""c"".""person1"",""c"".""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c"" WHERE ""from_id""<""to_id"" GROUP BY 1,2 UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" AS ""c"" WHERE ""from_id"">""to_id"" GROUP BY 1,2) AS ""c"" GROUP BY 1,2"
303,"WITH ""CTE"" AS (SELECT *,CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""CTE"" GROUP BY ""person1"",""person2"""
304,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
305,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
306,"WITH ""c1"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""c1"" GROUP BY ""from_id"",""to_id"""
307,"SELECT CASE WHEN (""from_id"">""to_id"") THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN (""from_id"">""to_id"") THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
308,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
309,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
310,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
311,"WITH ""tmp"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""tmp"" GROUP BY 1,2"
312,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
313,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
314,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
315,"WITH ""t"" AS (SELECT ""from_id"",""to_id"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""duration"" FROM ""calls"" GROUP BY ""from_id"",""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""call_count"",""duration"" AS ""total_duration"" FROM ""t"" WHERE ROW(""from_id"",""to_id"") NOT IN (SELECT ""t1"".""from_id"",""t1"".""to_id"" FROM (""t"" AS ""t1"") CROSS JOIN ""t"" AS ""t2"" WHERE ""t1"".""from_id""=""t2"".""to_id"" AND ""t1"".""to_id""=""t2"".""from_id"") UNION ALL SELECT ""t1"".""from_id"",""t1"".""to_id"",(""t1"".""call_count""+""t2"".""call_count"") AS ""call_count"",(""t1"".""duration""+""t2"".""duration"") AS ""total_duration"" FROM (""t"" AS ""t1"") CROSS JOIN ""t"" AS ""t2"" WHERE ""t1"".""from_id""=""t2"".""to_id"" AND ""t1"".""to_id""=""t2"".""from_id"" AND ""t1"".""from_id""<""t1"".""to_id"""
316,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
317,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
318,"WITH ""cte1"" AS (SELECT *,CASE WHEN ""from_id"">""to_id"" THEN CAST(""to_id""+""from_id""*POWER(2, 32) AS INTEGER) ELSE CAST(""from_id""+""to_id""*POWER(2, 32) AS INTEGER) END AS ""combo"" FROM ""Calls"") SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""combo"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte1"" GROUP BY ""combo"" ORDER BY ""person1"",""person2"""
319,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
320,"WITH ""all_calls"" AS (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""all_calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"""
321,"WITH ""union_pair"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""num_calls"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" GROUP BY 1,2 UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""num_calls"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"" GROUP BY 1,2) SELECT ""person1"",""person2"",SUM(""num_calls"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""union_pair"" GROUP BY 1,2"
322,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
323,"WITH ""CTE"" AS (SELECT ""FROM_ID"" AS ""PERSON1"",""TO_ID"" AS ""PERSON2"",""DURATION"" FROM ""CALLS"" WHERE ""FROM_ID""<""TO_ID"" UNION ALL SELECT ""TO_ID"" AS ""PERSON1"",""FROM_ID"" AS ""PERSON2"",""DURATION"" FROM ""CALLS"" WHERE ""FROM_ID"">""TO_ID"") SELECT ""PERSON1"",""PERSON2"",COUNT(1) AS ""CALL_COUNT"",SUM(""DURATION"") AS ""total_duration"" FROM ""CTE"" GROUP BY ""PERSON1"",""PERSON2"""
324,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
325,"WITH ""combo"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""combo"" GROUP BY ""from_id"",""to_id"" ORDER BY ""from_id"",""to_id"""
326,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY LEAST(""from_id"", ""to_id""),GREATEST(""from_id"", ""to_id"")"
327,"WITH ""cte"" AS (SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""from_id"",(CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""to_id"",""duration"" FROM ""calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""from_id"",""to_id"""
328,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" GROUP BY 1,2 UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id"">""to_id"" GROUP BY 1,2) SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM ""cte"" GROUP BY 1,2"
329,"WITH ""temp"" AS (SELECT ""a"".""from_id"" AS ""person1"",""a"".""to_id"" AS ""person2"",COUNT(1) AS ""cnt"",SUM(""duration"") AS ""duration"" FROM ""calls"" AS ""a"" GROUP BY ""a"".""from_id"",""a"".""to_id""), ""temp2"" AS (SELECT ""t1"".""person1"",""t1"".""person2"",COALESCE(SUM(""t1"".""cnt""), 0)+COALESCE(SUM(""t2"".""cnt""), 0) AS ""call_count"",COALESCE(SUM(""t1"".""duration""), 0)+COALESCE(SUM(""t2"".""duration""), 0) AS ""total_duration"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""person1""=""t2"".""person2"" AND ""t1"".""person2""=""t2"".""person1"" WHERE ""t1"".""person1""<""t1"".""person2"" GROUP BY 1,2) SELECT * FROM ""temp2"" UNION SELECT ""person2"",""person1"",""cnt"",""duration"" FROM ""temp"" WHERE ""person2""<""person1"" AND ROW(""person2"",""person1"") NOT IN (SELECT ""person1"",""person2"" FROM ""temp2"")"
330,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
331,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
332,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"" UNION ALL SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"") AS ""t"" GROUP BY 1,2"
333,"SELECT ""a"" AS ""person1"",""b"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ((SELECT ""from_id"" AS ""a"",""to_id"" AS ""b"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"") UNION ALL (SELECT ""to_id"" AS ""a"",""from_id"" AS ""b"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"")) AS ""t1"" GROUP BY ""a"",""b"""
334,"WITH ""calls_cte"" AS (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""from_id"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id"",""duration"" FROM ""Calls"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls_cte"" GROUP BY ""from_id"",""to_id"""
335,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""t"" GROUP BY 1,2"
336,"WITH ""cte1"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte1"" GROUP BY 1,2"
337,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
338,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
339,"WITH ""a"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""id1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""id2"",""duration"" FROM (SELECT * FROM ""calls"" WHERE ""from_id""!=""to_id"") AS ""t"") SELECT ""id1"" AS ""person1"",""id2"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""a"" GROUP BY ""id1"",""id2"""
340,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY LEAST(""from_id"", ""to_id""),GREATEST(""from_id"", ""to_id"")"
341,"WITH ""new"" AS (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""new"" GROUP BY 1,2"
342,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
343,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""t1"" GROUP BY ""person1"",""person2"""
344,"WITH ""cte1"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id""), ""cte2"" AS (SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id""), ""cte3"" AS (SELECT ""person1"",""person2"",""duration"" FROM ""cte1"" UNION ALL SELECT ""person1"",""person2"",""duration"" FROM ""cte2"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte3"" GROUP BY 1,2"
345,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""duration"",CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"" FROM ""Calls"") AS ""Table1"" GROUP BY ""Table1"".""person1"",""Table1"".""person2"""
346,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
347,"SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""person1"",""person2"",""duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""t1"" WHERE ""person1""<""person2"") AS ""t2"" GROUP BY 1,2"
348,"WITH ""same_calls"" AS (SELECT ""from_id"",""to_id"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""from_id"",""to_id""), ""temp_data"" AS (SELECT ""C1"".""from_id"",""C1"".""to_id"",""C2"".""from_id"" AS ""c2_from_id"",(COALESCE(""C1"".""call_count"", 0)+COALESCE(""C2"".""call_count"", 0)) AS ""call_count"",(COALESCE(""C1"".""total_duration"", 0)+COALESCE(""C2"".""total_duration"", 0)) AS ""total_duration"" FROM ""same_calls"" AS ""C1"" LEFT JOIN ""same_calls"" AS ""C2"" ON ""C1"".""from_id""=""C2"".""to_id"" AND ""C1"".""to_id""=""C2"".""from_id"" ORDER BY ""C1"".""from_id"",""C1"".""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""call_count"",""total_duration"" FROM ""temp_data"" WHERE (""from_id""<""c2_from_id"" OR ""c2_from_id"" IS NULL)"
349,"SELECT ""t"".""from_id"" AS ""person1"",""t"".""to_id"" AS ""person2"",SUM(""t"".""call_count"") AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM ((SELECT ""from_id"",""to_id"",SUM(""duration"") AS ""duration"",COUNT(1) AS ""call_count"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"") UNION ALL (SELECT ""to_id"",""from_id"",SUM(""duration"") AS ""duration"",COUNT(1) AS ""call_count"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"")) AS ""t"" WHERE ""t"".""from_id""<""t"".""to_id"" GROUP BY ""t"".""from_id"",""t"".""to_id"""
350,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
351,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
352,"SELECT (CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END) AS ""person1"",(CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END) AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
353,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
354,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
355,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
356,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id"">""to_id"") AS ""A"" GROUP BY ""person1"",""person2"""
357,"SELECT ""t"".""person1"",""t"".""person2"",COUNT(""t"".""duration"") AS ""call_count"",SUM(""t"".""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""c"".""from_id"">""c"".""to_id"" THEN ""c"".""to_id"" ELSE ""c"".""from_id"" END AS ""person1"",CASE WHEN ""c"".""from_id"">""c"".""to_id"" THEN ""c"".""from_id"" ELSE ""c"".""to_id"" END AS ""person2"",""c"".""duration"" FROM ""Calls"" AS ""c"") AS ""t"" GROUP BY ""t"".""person1"",""t"".""person2"""
358,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""c"" GROUP BY ""person1"",""person2"""
359,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
360,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") AS ""tmp"" GROUP BY ""from_id"",""to_id"""
361,"SELECT ""c"".""from_id"" AS ""person1"",""c"".""to_id"" AS ""person2"",SUM(""c"".""call_count"") AS ""call_count"",SUM(""c"".""duration"") AS ""total_duration"" FROM (SELECT ""from_id"",""to_id"",SUM(""duration"") AS ""duration"",COUNT(1) AS ""call_count"" FROM ""Calls"" AS ""c1"" WHERE ""c1"".""from_id""<""c1"".""to_id"" GROUP BY ""from_id"",""to_id"" UNION SELECT ""to_id"" AS ""from_id"",""from_id"" AS ""to_id"",SUM(""duration"") AS ""duration"",COUNT(1) AS ""call_count"" FROM ""Calls"" AS ""c2"" WHERE ""c2"".""from_id"">""c2"".""to_id"" GROUP BY ""from_id"",""to_id"") AS ""c"" GROUP BY ""person1"",""person2"""
362,"SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT * FROM ""Calls"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""Calls"") AS ""t"" WHERE ""from_id""<""to_id"" GROUP BY ""person1"",""person2"""
363,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
364,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
365,"SELECT ""from_"" AS ""person1"",""to_"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""from_"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_"",""duration"" FROM ""Calls"") AS ""t1"" GROUP BY ""from_"",""to_"""
366,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY 1,2"
367,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
368,"WITH ""TEMP"" AS (SELECT (CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""FROM_ID"" ELSE ""TO_ID"" END) AS ""PERSON1"",(CASE WHEN ""FROM_ID""<""TO_ID"" THEN ""TO_ID"" ELSE ""FROM_ID"" END) AS ""PERSON2"",""DURATION"" FROM ""CALLS"" AS ""C"") SELECT DISTINCT ""PERSON1"",""PERSON2"",COUNT(1) AS ""CALL_COUNT"",SUM(""DURATION"") AS ""TOTAL_DURATION"" FROM ""TEMP"" GROUP BY ""PERSON1"",""PERSON2"""
369,"SELECT DISTINCT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"") AS ""c"" WHERE ""person1""<""person2"" GROUP BY ""person1"",""person2"""
370,"SELECT DISTINCT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
371,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
372,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
373,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
374,"WITH ""temp"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""temp"" GROUP BY ""person1"",""person2"""
375,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
376,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
377,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
378,"SELECT ""person1"",""person2"",""call_count"",""total_duration"" FROM (SELECT ""person1"",""person2"",SUM(""c1"") AS ""call_count"",SUM(""d1"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""c1"",SUM(""duration"") AS ""d1"" FROM ""Calls"" GROUP BY 1,2 UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""c1"",SUM(""duration"") AS ""d1"" FROM ""Calls"" GROUP BY 1,2) AS ""a"" GROUP BY 1,2) AS ""b"" WHERE ""person1""<""person2"""
379,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person2"",""person1"""
380,"SELECT ""from_id_"" AS ""person1"",""to_id_"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""from_id_"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""to_id_"",""duration"" FROM ""Calls"") AS ""a"" GROUP BY ""from_id_"",""to_id_"""
381,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",""duration"" FROM ""Calls"") AS ""temp"" GROUP BY ""person1"",""person2"""
382,"SELECT CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
383,"WITH ""cte"" AS (SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",""duration"" FROM ""Calls"") SELECT ""person1"",""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
384,"SELECT CASE WHEN ""to_id""<""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""to_id"">""from_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY ""person1"",""person2"""
385,"WITH ""all_users"" AS (SELECT DISTINCT ""from_id"" AS ""id"" FROM ""calls"" UNION SELECT DISTINCT ""to_id"" AS ""id"" FROM ""calls"") SELECT ""a"".""id"" AS ""person1"",""b"".""id"" AS ""person2"",COUNT(""duration"") AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (""all_users"" AS ""a"" JOIN ""all_users"" AS ""b"" ON ""a"".""id""<""b"".""id"") JOIN ""calls"" AS ""c"" ON (""a"".""id""=""c"".""from_id"" AND ""b"".""id""=""c"".""to_id"") OR (""a"".""id""=""c"".""to_id"" AND ""b"".""id""=""c"".""from_id"") GROUP BY 1,2"
386,"SELECT ""person1"",""person2"",SUM(""call_count"") AS ""call_count"",SUM(""total_duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" GROUP BY ""from_id"",""to_id"" UNION SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" WHERE ""from_id"">""to_id"" GROUP BY ""to_id"",""from_id"") AS ""t"" GROUP BY ""t"".""person1"",""t"".""person2"""
387,"WITH ""cte"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""person1"",""person2"""
388,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""Calls"" GROUP BY 1,2"
389,"SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person2"",""duration"" FROM ""Calls"" WHERE ""to_id""<""from_id"") AS ""a"" GROUP BY 1,2"
390,"SELECT CASE WHEN ""from_id""<""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
391,"WITH ""new"" AS (SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"" AS ""person1"",""from_id"" AS ""person1"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""person1"",""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""new"" GROUP BY ""person1"",""person2"""
392,"WITH ""temp"" AS (SELECT ""from_id"",""to_id"",COUNT(1) AS ""ct"",SUM(""duration"") AS ""du"" FROM ""Calls"" GROUP BY ""from_id"",""to_id"") SELECT CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END AS ""person1"",CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END AS ""person2"",SUM(""ct"") AS ""call_count"",SUM(""du"") AS ""total_duration"" FROM ""temp"" GROUP BY CASE WHEN ""from_id"">""to_id"" THEN ""to_id"" ELSE ""from_id"" END,CASE WHEN ""from_id"">""to_id"" THEN ""from_id"" ELSE ""to_id"" END"
393,"WITH ""cte"" AS (SELECT ""from_id"",""to_id"",""duration"" FROM ""calls"" WHERE ""from_id""<""to_id"" UNION ALL SELECT ""to_id"",""from_id"",""duration"" FROM ""calls"" WHERE ""from_id"">""to_id"") SELECT ""from_id"" AS ""person1"",""to_id"" AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""cte"" GROUP BY ""from_id"",""to_id"""
394,"SELECT LEAST(""from_id"", ""to_id"") AS ""person1"",GREATEST(""from_id"", ""to_id"") AS ""person2"",COUNT(1) AS ""call_count"",SUM(""duration"") AS ""total_duration"" FROM ""calls"" GROUP BY ""person1"",""person2"""
