id,original query
1,"WITH ""user_session"" AS (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""num"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""num""), 2), 0) AS ""average_sessions_per_user"" FROM ""user_session"""
2,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
3,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
4,"SELECT ROUND(COALESCE(AVG(""num""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""A"""
5,"SELECT COALESCE(ROUND(SUM(""session_per_user_cnt"")/""user_cnt"", 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""user_id"") AS ""user_cnt"",COUNT(DISTINCT ""session_id"") AS ""session_per_user_cnt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-26') AS ""a"""
6,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
7,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27'"
8,"WITH ""t1"" AS (SELECT COUNT(DISTINCT (""session_id"")) AS ""session_total"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""session_total""), 2), 0) AS ""average_sessions_per_user"" FROM ""t1"""
9,"WITH ""d"" AS (SELECT * FROM ""Activity"" AS ""a"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27') SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""USER_ID""), 2), 0) AS ""average_sessions_per_user"" FROM ""d"""
10,"SELECT COALESCE(ROUND(SUM(""t"".""cnt"")/COUNT(1), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""t"""
11,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
12,"WITH ""t"" AS (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_sessions"" FROM ""Activity"" WHERE ""activity_date""<=DATE('2019-07-27') AND ""activity_date"">=CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""num_sessions"")/COUNT(""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""t"""
13,"WITH ""sessions"" AS (SELECT ""user_id"",COALESCE(COUNT(DISTINCT ""session_id""), 0) AS ""total_sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") SELECT ROUND(COALESCE((SUM(""total_sessions"")/COUNT(""user_id"")), 0), 2) AS ""average_sessions_per_user"" FROM ""sessions"""
14,"SELECT COALESCE(ROUND(SUM(""ct"")/COUNT(""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""ct"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date"" BETWEEN 0 AND 29 GROUP BY ""user_id"") AS ""t"""
15,"SELECT COALESCE(ROUND(COUNT(DISTINCT (""session_id""))/COUNT(DISTINCT (""user_id"")), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
16,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29"
17,"SELECT ROUND(COALESCE(AVG(""cnt""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""t"""
18,"SELECT ROUND(COALESCE(AVG(""_count""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""_count"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""a"""
19,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
20,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
21,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_session"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT ROUND(COALESCE(SUM(""num_session"")/COUNT(DISTINCT ""user_id""), 0.00), 2) AS ""average_sessions_per_user"" FROM ""cte"""
22,"SELECT COALESCE(ROUND(SUM(""sumc"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sumc"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""a"""
23,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
24,"SELECT COALESCE((ROUND(SUM(""cs"")/COUNT(""user_id""), 2)), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cs"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY 1 HAVING COUNT(DISTINCT ""session_id"")>=1) AS ""t"""
25,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
26,"SELECT COALESCE(ROUND(AVG((""SESSIONS"")), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""SESSION_ID"") AS ""SESSIONS"" FROM ""ACTIVITY"" WHERE ""ACTIVITY_DATE"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""USER_ID"") AS ""X"""
27,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
28,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29"
29,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
30,"SELECT COALESCE(ROUND(AVG(""sessions""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""sessions"" FROM ""activity"" WHERE (""activity_date""<=CAST('2019-07-27' AS DATE)) AND (""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY') GROUP BY ""user_id"") AS ""activity_filtered"""
31,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")*1.0/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
32,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
33,"SELECT COALESCE(ROUND(COUNT(""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",""session_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY 1,2) AS ""z"""
34,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
35,"SELECT ROUND(COALESCE(AVG(""session""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"" HAVING ""session"">=1) AS ""tb1"""
36,"SELECT ROUND(COALESCE(SUM(""session_num"")/COUNT(""session_num""), 0.00), 2) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""session_num"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""new_table"""
37,"SELECT COALESCE(ROUND(AVG(""ct""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""ct"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date"" BETWEEN 0 AND 29 GROUP BY ""user_id"") AS ""t"""
38,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""countofsessions"" FROM ""activity"" WHERE ""activity_date""<'2019-07-28' AND ""activity_date"">'2019-06-27' GROUP BY ""user_id"") SELECT (CASE WHEN ROUND(SUM(""countofsessions"")/COUNT(""user_id""), 2) IS NULL THEN 0 ELSE ROUND(SUM(""countofsessions"")/COUNT(""user_id""), 2) END) AS ""average_sessions_per_user"" FROM ""cte"""
39,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
40,"WITH ""user_session_counts"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 AND CAST('2019-07-27' AS DATE) - ""activity_date"">=0 GROUP BY 1) SELECT ROUND(CASE WHEN AVG(""sessions"") IS NULL THEN 0 ELSE AVG(""sessions"") END, 2) AS ""average_sessions_per_user"" FROM ""user_session_counts"""
41,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
42,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
43,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">'2019-06-27'"
44,"WITH ""cte_cleaned"" AS (SELECT DISTINCT * FROM ""Activity""), ""agg"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""cte_cleaned"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">'2019-06-27' GROUP BY 1) SELECT COALESCE(ROUND(AVG(""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM ""agg"""
45,"WITH ""temp"" (""tot_sessions"", ""user_id"") AS (SELECT COUNT(DISTINCT ""session_id"") AS ""tot_sessions"",""user_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") SELECT CASE WHEN ROUND(SUM(""tot_sessions"")/COUNT(""user_id""), 2) IS NULL THEN 0 ELSE ROUND(SUM(""tot_sessions"")/COUNT(""user_id""), 2) END AS ""average_sessions_per_user"" FROM ""temp"""
46,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date"" BETWEEN 0 AND 29"
47,"WITH ""user_count"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""activity"" WHERE ""activity_date"">=CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM ""user_count"""
48,"SELECT COALESCE(ROUND(SUM(""session"")/COUNT(1), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""session"" FROM ""Activity"" WHERE ""activity_date""<=DATE('2019-07-27') AND ""activity_date"">=DATE('2019-06-28') GROUP BY ""user_id"") AS ""A"""
49,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
50,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">='2019-06-28'"
51,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0.00), 2) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' ORDER BY ""user_id"""
52,"WITH ""sessions_per_user"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt_session"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""cnt_session"")/COUNT(""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""sessions_per_user"""
53,"SELECT COALESCE(ROUND((COUNT(DISTINCT CONCAT(""user_id"", ""session_id""))/COUNT(DISTINCT ""user_id"")), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
54,"SELECT COALESCE(ROUND(SUM(""session"")/COUNT(1), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""session"" FROM ""Activity"" WHERE ""activity_date""<=DATE('2019-07-27') AND ""activity_date"">DATE('2019-06-27') GROUP BY ""user_id"") AS ""A"""
55,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
56,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
57,"SELECT ROUND(COALESCE(AVG(""ct""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(""session_id"") AS ""ct"" FROM (SELECT ""user_id"",""session_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"",""session_id"") AS ""sub"" GROUP BY ""user_id"") AS ""sub"""
58,"WITH ""T"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_session"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""T"".""num_session"")/COUNT(""T"".""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""T"""
59,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM (SELECT ""user_id"",""session_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"",""session_id"") AS ""t"" GROUP BY ""user_id"") AS ""t"""
60,"SELECT ROUND(COALESCE(SUM(""b"".""num_sessions"")/COUNT(""b"".""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""a"".""user_id"",COUNT(1) AS ""num_sessions"" FROM (SELECT ""user_id"",""session_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' AND ""activity_type"" IN ('open_session','end_session','scroll_down','send_message') GROUP BY 1,2) AS ""a"" GROUP BY ""a"".""user_id"") AS ""b"""
61,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
62,"WITH ""new"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM ""new"""
63,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
64,"SELECT ROUND(COALESCE((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27'"
65,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
66,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
67,"WITH ""session_date"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT ROUND(COALESCE(AVG(""count_session""), 0), 2) AS ""average_sessions_per_user"" FROM ""session_date"""
68,"SELECT COALESCE(ROUND(AVG(""num""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY 1) AS ""T1"""
69,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
70,"SELECT COALESCE(ROUND(AVG(""n_sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""n_sessions"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""a"""
71,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
72,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT * FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30) AS ""temp"""
73,"WITH ""temp"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""dissession"",""user_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""dissession"")/COUNT(""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
74,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
75,"SELECT COALESCE(ROUND(SUM(""ct"")/COUNT(""ct""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""ct"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date"" BETWEEN 0 AND 29 GROUP BY ""user_id"") AS ""t"""
76,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
77,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
78,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
79,"SELECT COALESCE(ROUND(AVG(""number""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"" AS ""id"",COUNT(DISTINCT ""session_id"") AS ""number"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") AS ""tb1"""
80,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
81,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
82,"SELECT COALESCE(ROUND(AVG(""session_cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_cnt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY 1 HAVING COUNT(1)>=1) AS ""sess"""
83,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
84,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""activity"" WHERE TIMESTAMPDIFF(DAY, ""activity_date"", '2019-07-28')<=30"
85,"SELECT COALESCE(ROUND(SUM(""total"")/COUNT(1), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""total"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""T"""
86,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""User_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
87,"SELECT COALESCE(ROUND(AVG(""sess""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY 1) AS ""x"""
88,"SELECT COALESCE(ROUND((COUNT(DISTINCT (CONCAT(""user_id"", '_', ""session_id"")))/COUNT(DISTINCT (""user_id""))), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
89,"WITH ""user_count"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""activity"" WHERE ""activity_date"">=CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM ""user_count"""
90,"SELECT COALESCE(ROUND(AVG(""sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"") AS ""t"""
91,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_session"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""num_session"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""cte"""
92,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE TIMESTAMPDIFF(DAY, ""activity_date"", '2019-07-28')<=30"
93,"WITH ""pre"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_session"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""num_session"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""pre"""
94,"SELECT COALESCE(ROUND((SELECT SUM(""numerator"".""total_sessions"") FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""total_sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""numerator"")/(SELECT COUNT(DISTINCT ""denominator"".""total_users"") FROM (SELECT DISTINCT ""user_id"" AS ""total_users"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND '2019-07-27') AS ""denominator""), 2), 0) AS ""average_sessions_per_user"""
95,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE ""activity_date"">(CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY') GROUP BY ""user_id"") AS ""temp"""
96,"SELECT ROUND(COALESCE(AVG(COALESCE(""n"", 0)), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""n"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""t"""
97,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
98,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0.00), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27'"
99,"WITH ""user_sessions"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 AND CAST('2019-07-27' AS DATE) - ""activity_date"">=0 GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""sessions"")/COUNT(""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""user_sessions"""
100,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
101,"WITH ""ct"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""ag"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY 1 HAVING COUNT(DISTINCT ""activity_type"")>=1) SELECT COALESCE(ROUND(SUM(""ag"")/COUNT(""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""ct"""
102,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
103,"SELECT COALESCE(ROUND(AVG(""num_sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND DATE('2019-07-27') GROUP BY ""user_id"") AS ""ctv"""
104,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
105,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
106,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
107,"SELECT COALESCE(ROUND(AVG(""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_Id"")) AS ""session_count"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""r"""
108,"SELECT COALESCE(ROUND(COUNT(""t"".""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",""session_id"",COUNT(""session_id"") AS ""id_num"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY ""session_id"") AS ""t"""
109,"WITH ""cte1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_num"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY 1), ""cte2"" AS (SELECT COUNT(DISTINCT ""user_id"") AS ""user_num"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27') SELECT ROUND(COALESCE(SUM(""c1"".""session_num"")/""c2"".""user_num"", 0), 2) AS ""average_sessions_per_user"" FROM ""cte1"" AS ""c1"" JOIN ""cte2"" AS ""c2"""
110,"SELECT COALESCE(ROUND(AVG(""Count_""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""Count_"" FROM ""Activity"" WHERE ""activity_date"">=CAST('2019-06-28' AS DATE) GROUP BY ""user_id"") AS ""Activity_"""
111,"SELECT COALESCE(ROUND(AVG(""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""t1"""
112,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""temp"""
113,"WITH ""x"" AS (SELECT ""user_id"" AS ""users"",COUNT(DISTINCT ""session_id"") AS ""total"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""total"")/COUNT(DISTINCT ""users""), 2), 0) AS ""average_sessions_per_user"" FROM ""x"""
114,"WITH ""t1"" AS (SELECT COUNT(DISTINCT (""session_id"")) AS ""session_total"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">'2019-06-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""session_total""), 2), 0) AS ""average_sessions_per_user"" FROM ""t1"""
115,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
116,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_sessions"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY 1) SELECT ROUND(COALESCE(SUM(""num_sessions"")/COUNT(1), 0), 2) AS ""average_sessions_per_user"" FROM ""cte"""
117,"SELECT COALESCE(CAST(AVG(""sessionids"") AS DECIMAL(5, 2)), 0.0000) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessionids"" FROM ""activity"" AS ""a"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY 1) AS ""a"""
118,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT (""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
119,"SELECT COALESCE(ROUND((SELECT COUNT(DISTINCT ""session_id"") FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29)/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29"
120,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
121,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_uniq_id"",SUM(CASE WHEN ""activity_type"" IS NOT NULL THEN 1 ELSE 0 END) AS ""activity_bool"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""session_uniq_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""cte"" WHERE ""activity_bool""!=0"
122,"WITH ""temp"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""sess""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
123,"SELECT COALESCE(ROUND((SUM(""sessions"")/COUNT(""user_id"")), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""a"""
124,"WITH ""t1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sd"" FROM ""activity"" WHERE ""activity_date"">=CAST('2019-07-28' AS DATE) + INTERVAL '-30 DAY' GROUP BY ""user_id"" HAVING ""sd"">0) SELECT COALESCE(ROUND(AVG(""sd""), 2), 0) AS ""average_sessions_per_user"" FROM ""t1"""
125,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
126,"SELECT ROUND(COALESCE(AVG(""sessions""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""f"""
127,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
128,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
129,"SELECT COALESCE(ROUND(AVG(""number_sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""number_sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '(29) DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""result"""
130,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
131,"SELECT COALESCE(ROUND(AVG(""session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""session"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""c"""
132,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
133,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN DATE('2019-07-27') - INTERVAL '29 DAY' AND DATE('2019-07-27')"
134,"SELECT ROUND(COALESCE(AVG(""sessions""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY 1) AS ""f"""
135,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
136,"WITH ""sessions"" AS (SELECT DISTINCT ""user_id"" AS ""active_users"",COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""ACTIVITY"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""session_count"")/COUNT(""active_users""), 2), 0) AS ""average_sessions_per_user"" FROM ""sessions"""
137,"SELECT COALESCE(ROUND(COUNT(DISTINCT (""session_id""))/COUNT(DISTINCT (""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
138,"SELECT COALESCE(ROUND(AVG(""n_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""n_session"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN DATE('2019-07-27') - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""a"""
139,"SELECT COALESCE(ROUND(AVG(""num""), 2), 0.00000) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""num"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' AND ""activity_type"" IS NOT NULL GROUP BY ""user_id"") AS ""temp"""
140,"WITH ""temp1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""cnt"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp1"""
141,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
142,"WITH ""temp"" AS (SELECT ""user_id"",(COUNT(DISTINCT ""session_id"")) AS ""count1"",COUNT(DISTINCT ""user_id"") AS ""counts"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"" HAVING COUNT(""activity_type"")>=1) SELECT COALESCE(ROUND(SUM(""temp"".""count1"")/SUM(""counts""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
143,"SELECT ROUND(COALESCE(AVG(""a"".""count""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""count"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) + INTERVAL '-30 DAY' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""session_id"")>=1) AS ""a"""
144,"SELECT ROUND(COALESCE(COUNT(DISTINCT (""session_id""))/COUNT(DISTINCT (""user_id"")), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
145,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/(COUNT(DISTINCT ""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
146,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""temp"""
147,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
148,"WITH ""pre"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_session"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""num_session"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""pre"""
149,"WITH ""a"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sess_num"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""sess_num"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""a"""
150,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""temp"""
151,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
152,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
153,"SELECT COALESCE(ROUND(AVG(""t""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""activity_date"",COUNT(DISTINCT ""session_id"") AS ""t"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-06-27' AS DATE) AND ""activity_date""<CAST('2019-07-27' AS DATE) GROUP BY ""user_id"") AS ""t"""
154,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
155,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
156,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""count_session"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""cte"""
157,"SELECT COALESCE(ROUND(AVG(""a"".""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""a"""
158,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27'"
159,"SELECT COALESCE(ROUND(SUM(""sub"".""sess"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""sub"""
160,"SELECT COALESCE(ROUND(AVG(""Count_""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""Count_"" FROM ""Activity"" WHERE ""activity_date"">=CAST('2019-06-28' AS DATE) GROUP BY ""user_id"") AS ""Activity_"""
161,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
162,"WITH ""user_sessions"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""sessions"",""user_id"" FROM ""Activity"" WHERE ""activity_date"">'2019-6-27' AND ""activity_date""<'2019-7-28' GROUP BY ""user_id"") SELECT CASE WHEN ""sessions"" IS NULL THEN 0 ELSE ROUND(AVG(""sessions""), 2) END AS ""average_sessions_per_user"" FROM ""user_sessions"""
163,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">='2019-06-28'"
164,"WITH ""t"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num_sess"" FROM ""activity"" WHERE ""activity_date"">=CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND ""activity_date""<='2019-07-27' GROUP BY 1) SELECT COALESCE(CAST(AVG(""num_sess"") AS DECIMAL(65, 2)), 0) AS ""average_sessions_per_user"" FROM ""t"""
165,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '1 MONTH'"
166,"SELECT COALESCE(ROUND(AVG(""num_sess""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""num_sess"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""tmp"""
167,"WITH ""new_table"" AS (SELECT COUNT(DISTINCT (""session_id"")) AS ""sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""sessions_per_user""), 2), 0) AS ""average_sessions_per_user"" FROM ""new_table"""
168,"WITH ""cte_getActivity"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM ""cte_getActivity"""
169,"SELECT ROUND(COALESCE(SUM(""b"".""req"")*1.0/COUNT(""b"".""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""a"".""user_id"",COALESCE(COUNT(DISTINCT ""a"".""session_id""), 0) AS ""req"" FROM (SELECT DISTINCT * FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_Date""<30) AS ""a"" GROUP BY ""a"".""user_id"") AS ""b"""
170,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""t"""
171,"WITH ""temp"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""sess""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
172,"WITH ""temp"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""sess""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
173,"SELECT COALESCE(ROUND(AVG(""table2"".""session_number""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""table1"".""user_id"",COUNT(DISTINCT (""table1"".""session_id"")) AS ""session_number"" FROM (SELECT * FROM ""Activity"" WHERE ""activity_date"">'2019-06-27' AND ""activity_date""<='2019-07-27') AS ""table1"" GROUP BY ""table1"".""user_id"") AS ""table2"""
174,"SELECT COALESCE(ROUND(AVG(""Count_""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""Count_"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""Activity_"""
175,"SELECT COALESCE(ROUND(SUM(""x"".""b"")/COUNT(""x"".""a""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"" AS ""a"",COUNT(DISTINCT ""session_id"") AS ""b"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""x"""
176,"SELECT COALESCE(ROUND(AVG(""new"".""a""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"") AS ""a"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27') AS ""new"""
177,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""SESSION_ID"")/COUNT(DISTINCT ""USER_ID""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""ACTIVITY"" WHERE ""ACTIVITY_DATE"">='2019-06-28' AND ""ACTIVITY_DATE""<='2019-07-27'"
178,"SELECT COALESCE(ROUND(AVG(""nb_sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (""session_id"")) AS ""nb_sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY ""user_id"" HAVING COUNT(DISTINCT (""session_id""))>0) AS ""t"""
179,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">=CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY'"
180,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
181,"SELECT COALESCE(ROUND(AVG(""number""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"" AS ""id"",COUNT(DISTINCT ""session_id"") AS ""number"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") AS ""tb1"""
182,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-6-28' AND '2019-07-27'"
183,"WITH ""cte"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""numofsession"" FROM ""Activity"" WHERE DATE('2019-07-27') - ""activity_date""<=29 GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""numofsession"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""cte"""
184,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27'"
185,"SELECT (CASE WHEN COUNT(DISTINCT ""user_id"")=0 THEN 0 ELSE ROUND(CAST(COUNT(DISTINCT ""session_id"") AS FLOAT)/COUNT(DISTINCT ""user_id""), 2) END) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
186,"SELECT ROUND(COALESCE(AVG(""n""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""n"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""t"""
187,"SELECT (CASE WHEN COUNT(DISTINCT ""user_id"")=0 THEN 0 ELSE ROUND(CAST(COUNT(DISTINCT ""session_id"") AS FLOAT)/COUNT(DISTINCT ""user_id""), 2) END) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
188,"SELECT CASE WHEN ROUND(AVG(""totalsession""), 2) IS NULL THEN ROUND(0, 2) ELSE ROUND(AVG(""totalsession""), 2) END AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""totalsession"" FROM ""activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">CAST('2019-07-27' AS DATE) + INTERVAL '-30 DAY' GROUP BY ""user_id"") AS ""a"""
189,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""Average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN (CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY') AND '2019-07-27'"
190,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
191,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" AS ""act"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
192,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
193,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
194,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
195,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
196,"SELECT COALESCE(ROUND(SUM(""num"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""num"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY 1) AS ""tempt"""
197,"SELECT COALESCE(ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
198,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
199,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
200,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">'2019-06-27' AND ""activity_date""<='2019-07-27'"
201,"SELECT COALESCE((SELECT ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) + INTERVAL '-30 DAY' AND ""activity_date""<='2019-07-27'), 0) AS ""average_sessions_per_user"""
202,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
203,"SELECT CASE WHEN COUNT(DISTINCT ""user_id"")=0 THEN 0.00 ELSE ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2) END AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN DATE '2019-06-28' AND DATE '2019-07-27'"
204,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
205,"WITH ""CTE_1"" AS (SELECT ""user_id"",""session_id"",""activity_type"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27'), ""CTE_2"" AS (SELECT ""user_id"",COALESCE(COUNT(DISTINCT ""session_id""), 0) AS ""num_sessions"" FROM ""CTE_1"" GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""num_sessions"")/COUNT(1), 2), 0) AS ""average_sessions_per_user"" FROM ""CTE_2"""
206,"SELECT COALESCE(ROUND(AVG(""number_sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""number_sessions"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '(30-1) DAY' AND '2019-07-27' GROUP BY 1) AS ""a"""
207,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
208,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
209,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27'"
210,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""t"""
211,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' AND ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"" HAVING COUNT(""activity_type"")>=1)"
212,"WITH ""temp"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""count"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""count""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
213,"SELECT ROUND((CASE WHEN COUNT(DISTINCT ""A1"".""user_id"")=0 THEN 0 ELSE SUM(""A1"".""sessionCount"")/COUNT(DISTINCT ""A1"".""user_id"") END), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT (CASE WHEN ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' THEN ""session_id"" END)) AS ""sessionCount"" FROM ""Activity"" GROUP BY ""user_id"") AS ""A1"" WHERE ""A1"".""sessionCount"">0"
214,"WITH ""t1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id""), ""t2"" AS (SELECT COALESCE(ROUND(AVG(""sess""), 2), 0) AS ""average_sessions_per_user"" FROM ""t1"") SELECT * FROM ""t2"""
215,"SELECT COALESCE(ROUND(AVG(""a"".""num""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""num"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 AND CAST('2019-07-27' AS DATE) - ""activity_date"">0 GROUP BY ""user_id"") AS ""a"""
216,"SELECT COALESCE(ROUND(AVG(""sess_no""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""sess_no"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""tmp"""
217,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
218,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""user_id"", ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
219,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
220,"WITH ""cte"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""totalSessions"",COUNT(DISTINCT ""user_id"") AS ""totalUsers"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27') SELECT COALESCE(ROUND(""totalSessions""/""totalUsers"", 2), 0) AS ""average_sessions_per_user"" FROM ""cte"""
221,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"") AS ""f"""
222,"SELECT COALESCE(ROUND(AVG(""session""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""T"""
223,"WITH ""t1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sd"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"" HAVING ""sd"">0) SELECT COALESCE(ROUND(AVG(""sd""), 2), 0) AS ""average_sessions_per_user"" FROM ""t1"""
224,"WITH ""cte"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM ""cte"""
225,"WITH ""cte"" AS (SELECT COUNT(DISTINCT ""user_id"") AS ""eachuser"",COUNT(DISTINCT ""session_id"") AS ""sessioncount"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30) SELECT COALESCE(ROUND(""sessioncount""/""eachuser"", 2), 0) AS ""average_sessions_per_user"" FROM ""cte"""
226,"SELECT ROUND(COALESCE(AVG(""c""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""c"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY 1) AS ""k"""
227,"SELECT COALESCE(ROUND(AVG(""sessions""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",(COUNT(DISTINCT (""session_id""))) AS ""sessions"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY 1) AS ""X"""
228,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
229,"SELECT COALESCE(ROUND(AVG(""ct""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""ct"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""a"""
230,"SELECT COALESCE(ROUND(AVG(""tem"".""a""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT (""s"".""session_id"")) AS ""a"" FROM ""Activity"" AS ""s"" WHERE ""s"".""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""tem"""
231,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
232,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id"")), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
233,"SELECT (CASE WHEN COUNT(DISTINCT ""user_id"")=0 THEN 0 ELSE ROUND(CAST(COUNT(DISTINCT ""session_id"") AS FLOAT)/COUNT(DISTINCT ""user_id""), 2) END) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
234,"SELECT ROUND(COALESCE(AVG(""c"".""a""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""a"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""c"""
235,"WITH ""total"" AS (SELECT ""session_id"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND '2019-07-27' GROUP BY ""session_id"") SELECT COALESCE(ROUND(COUNT(""total"".""session_id"")/""B"".""avgt"", 2), 0.00) AS ""average_sessions_per_user"" FROM (""total"") JOIN (SELECT COUNT(DISTINCT ""user_id"") AS ""avgt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND '2019-07-27') AS ""B"""
236,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""tb1"""
237,"SELECT COALESCE(ROUND(AVG(""cnt""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""activity"" AS ""a"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""tmp"""
238,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")*1.0/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
239,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27'"
240,"SELECT ROUND(COALESCE(SUM(""ses_count"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""ses_count"" FROM ""activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">'2019-06-27' GROUP BY ""user_id"") AS ""T"""
241,"SELECT COALESCE(ROUND(AVG(""session_number""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_number"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"" HAVING ""session_number"">=1) AS ""c"""
242,"SELECT ROUND(COALESCE(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 0), 2) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
243,"SELECT COALESCE(ROUND(AVG(""c""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""c"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""t"""
244,"WITH ""temp"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""sess"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""sess""), 2), 0) AS ""average_sessions_per_user"" FROM ""temp"""
245,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT *,COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""cte"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""Activity"" GROUP BY ""user_id"",""activity_type"" HAVING COUNT(""activity_type"")>=1)"
246,"WITH ""total"" AS (SELECT ""session_id"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND '2019-07-27' GROUP BY ""session_id"") SELECT COALESCE(ROUND(COUNT(""total"".""session_id"")/""B"".""avgt"", 2), 0.00) AS ""average_sessions_per_user"" FROM (""total"") JOIN (SELECT COUNT(DISTINCT ""user_id"") AS ""avgt"" FROM ""activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-28' AS DATE) - INTERVAL '30 DAY' AND '2019-07-27') AS ""B"""
247,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29"
248,"SELECT COALESCE(ROUND(AVG(""CNT""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""CNT"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"") AS ""A"""
249,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
250,"WITH ""user_session_counts"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sessions"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27' GROUP BY 1) SELECT ROUND(CASE WHEN AVG(""sessions"") IS NULL THEN 0 ELSE AVG(""sessions"") END, 2) AS ""average_sessions_per_user"" FROM ""user_session_counts"""
251,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27 '"
252,"WITH ""cte"" AS (SELECT DISTINCT ""session_id"",""user_id"" FROM ""Activity"" WHERE ""Activity"".""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27') SELECT ROUND(COALESCE((COUNT(""session_id""))/(COUNT(DISTINCT ""user_id"")), 0), 2) AS ""average_sessions_per_user"" FROM ""cte"""
253,"SELECT CASE WHEN COUNT(DISTINCT ""session_id"")=0 THEN 0.00 ELSE ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2) END AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 AND CAST('2019-07-27' AS DATE) - ""activity_date"">=0"
254,"WITH ""t1"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""total"" FROM ""activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<=29 GROUP BY 1) SELECT COALESCE(ROUND(SUM(""total"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""t1"""
255,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">=CAST('2019-07-27' AS DATE) + INTERVAL '-29 DAY'"
256,"SELECT COALESCE(ROUND(AVG(""Count_""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""Count_"" FROM ""Activity"" WHERE ""activity_date"">=CAST('2019-06-28' AS DATE) GROUP BY ""user_id"") AS ""Activity_"""
257,"SELECT ROUND(COALESCE(AVG(""s_id""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""s_id"" FROM ""activity"" WHERE 1=1 AND ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND CAST('2019-07-27' AS DATE) GROUP BY ""user_id"") AS ""a"""
258,"SELECT COALESCE(ROUND(AVG((""SESSIONS"")), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""SESSION_ID"") AS ""SESSIONS"" FROM ""ACTIVITY"" WHERE ""ACTIVITY_DATE"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""USER_ID"") AS ""X"""
259,"SELECT COALESCE(ROUND((COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id"")), 2), 0) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' AND ""activity_date""<='2019-07-27'"
260,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<='2019-07-27'"
261,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'"
262,"SELECT COALESCE(ROUND(SUM(""A"".""USER_SESSION"")/COUNT(1), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""USER_ID"",COUNT(DISTINCT ""SESSION_ID"") AS ""USER_SESSION"" FROM ""ACTIVITY"" WHERE ""activity_date"">'2019-06-27' AND ""activity_date""<'2019-07-28' GROUP BY ""USER_ID"") AS ""A"""
263,"WITH ""user_count"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""session_count"" FROM ""activity"" WHERE ""activity_date"">=CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND ""activity_date""<='2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""session_count""), 2), 0) AS ""average_sessions_per_user"" FROM ""user_count"""
264,"SELECT COALESCE(ROUND(AVG(""number""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT DISTINCT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""number"" FROM ""activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">='2019-06-28' GROUP BY ""user_id"") AS ""t"""
265,"WITH ""filtered"" AS (SELECT ""user_id"",""session_id"" FROM ""Activity"" WHERE ""activity_date""<='2019-07-27' AND ""activity_date"">'2019-06-27' GROUP BY 1,2) SELECT ROUND(COALESCE(AVG(""sessions""), 0), 2) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(""session_id"") AS ""sessions"" FROM ""filtered"" GROUP BY 1) AS ""a"""
266,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">'2019-06-27' AND ""activity_date""<='2019-07-27'"
267,"SELECT COALESCE(ROUND(AVG(""count_session""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""count_session"" FROM ""activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' GROUP BY ""user_id"" HAVING ""count_session"">0) AS ""f"""
268,"SELECT COALESCE(ROUND(SUM(""ct"")/COUNT(""user_id""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""ct"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") AS ""a"""
269,"SELECT COALESCE(ROUND(SUM(""t"".""cnt"")/COUNT(1), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""cnt"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30 GROUP BY ""user_id"") AS ""t"""
270,"WITH ""a"" AS (SELECT ""user_id"",COUNT(DISTINCT ""session_id"") AS ""sc"" FROM ""activity"" WHERE ""activity_date"">='2019-06-28' AND ""activity_date""<'2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(SUM(""sc"")/COUNT(DISTINCT ""user_id""), 2), 0.00000) AS ""average_sessions_per_user"" FROM ""a"""
271,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY' AND ""activity_date""<='2019-07-27'"
272,"WITH ""cte"" AS (SELECT COUNT(DISTINCT ""session_id"") AS ""tot"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN CAST('2019-07-27' AS DATE) - INTERVAL '29 DAY' AND '2019-07-27' GROUP BY ""user_id"") SELECT COALESCE(ROUND(AVG(""tot""), 2), 0) AS ""average_sessions_per_user"" FROM ""cte"""
273,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date""<30"
274,"SELECT COALESCE((SELECT ROUND(((COUNT(DISTINCT ""session_id""))/(COUNT(DISTINCT ""user_id""))), 2) FROM ""activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27'), 0) AS ""average_sessions_per_user"""
275,"SELECT COALESCE(ROUND(AVG(""Count_""), 2), 0) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""Count_"" FROM ""Activity"" WHERE ""activity_date"">=CAST('2019-06-28' AS DATE) GROUP BY ""user_id"") AS ""Activity_"""
276,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""session_id"")/COUNT(DISTINCT ""user_id""), 2), 0.00) AS ""average_sessions_per_user"" FROM ""Activity"" WHERE ""activity_date"">CAST('2019-07-27' AS DATE) - INTERVAL '30 DAY'"
277,"SELECT COALESCE(ROUND(SUM(""ct"")/COUNT(""ct""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""ct"" FROM ""Activity"" WHERE CAST('2019-07-27' AS DATE) - ""activity_date"" BETWEEN 0 AND 29 GROUP BY ""user_id"") AS ""t"""
278,"SELECT COALESCE(ROUND(SUM(""N"")/SUM(""D""), 2), 0.00) AS ""average_sessions_per_user"" FROM (SELECT COUNT(DISTINCT ""session_id"") AS ""N"",1 AS ""D"" FROM ""Activity"" WHERE ""activity_date"" BETWEEN '2019-06-28' AND '2019-07-27' GROUP BY ""user_id"") AS ""t"""
