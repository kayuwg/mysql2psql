id,original query
1,"SELECT ""us"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""us"" JOIN ""prices"" AS ""p"" ON ""us"".""product_id""=""p"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
2,"WITH ""TEMP"" AS (SELECT ""a"".""product_id"",""a"".""purchase_date"",""a"".""units"",""b"".""price"" FROM (""UnitsSold"" AS ""a"") CROSS JOIN ""Prices"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"") SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""TEMP"" GROUP BY ""product_id"""
3,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
4,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
5,"SELECT ""product_id"",ROUND(SUM(""a"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""price"",""units"",""price""*""units"" AS ""a"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"")) AS ""t"" GROUP BY ""product_id"""
6,"SELECT ""t"".""id"" AS ""product_id"",ROUND(""prod""/""sums"", 2) AS ""average_price"" FROM (SELECT SUM(""p"".""price""*""u"".""units"") AS ""prod"",""p"".""product_id"" AS ""id"",SUM(""u"".""units"") AS ""sums"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""u"" ON ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""p"".""product_id"") AS ""t"""
7,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
8,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
9,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
10,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""cost"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM (SELECT ""UnitsSold"".""product_id"" AS ""product_id"",""units"",(""units""*""Prices"".""price"") AS ""cost"" FROM ""UnitsSold"" LEFT JOIN ""Prices"" ON ""UnitsSold"".""product_id""=""Prices"".""product_id"" WHERE ""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"") AS ""a"" GROUP BY ""product_id"""
11,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""p"".""product_id"""
12,"WITH ""revenue"" AS (SELECT ""a"".*,""b"".""purchase_date"",""b"".""units"",""a"".""price""*""b"".""units"" AS ""revenue"" FROM ""Prices"" AS ""a"" LEFT JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""start_date""<=""b"".""purchase_date"" AND ""a"".""end_date"">=""b"".""purchase_date"") SELECT ""product_id"",ROUND(SUM(""revenue"")/SUM(""units""), 2) AS ""average_price"" FROM ""revenue"" GROUP BY ""product_id"""
13,"SELECT ""UnitsSold"".""product_id"",ROUND(SUM(""Prices"".""price""*""UnitsSold"".""units"")/SUM(""UnitsSold"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" JOIN ""Prices"" ON ""UnitsSold"".""product_id""=""Prices"".""product_id"" AND (""UnitsSold"".""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"") GROUP BY ""UnitsSold"".""product_id"""
14,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
15,"WITH ""cte"" AS (SELECT ""p"".""product_id"",""p"".""price""*""u"".""units"" AS ""total"",""u"".""units"" AS ""units"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
16,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""product_id"""
17,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
18,"SELECT ""Prices"".""product_id"",ROUND(SUM(""Prices"".""price""*""UnitsSold"".""units"")/SUM(""UnitsSold"".""units""), 2) AS ""average_price"" FROM ""Prices"" LEFT JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND ""Prices"".""start_date""<=""UnitsSold"".""purchase_date"" AND ""UnitsSold"".""purchase_date""<=""Prices"".""end_date"" GROUP BY ""Prices"".""product_id"""
19,"SELECT ""product_id"",ROUND(COALESCE(SUM(""price""*""units"")/SUM(""units""), 0), 2) AS ""average_price"" FROM (SELECT * FROM (SELECT ""a"".""product_id"",""a"".""start_date"",""a"".""end_date"",""a"".""price"",""b"".""purchase_date"",""b"".""units"" FROM ""Prices"" AS ""a"" LEFT JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" WHERE ""purchase_date"">=""start_date"" AND ""purchase_date""<=""end_date"") AS ""d"" GROUP BY ""product_id"""
20,"WITH ""CTE"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""c"".""product_id"",ROUND(SUM(""c"".""units""*""c"".""price"")/SUM(""c"".""units""), 2) AS ""average_price"" FROM ""CTE"" AS ""c"" GROUP BY ""c"".""product_id"""
21,"SELECT ""A"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""A"" LEFT JOIN ""UnitsSold"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" AND ""B"".""purchase_date"" BETWEEN ""A"".""start_date"" AND ""A"".""end_date"" GROUP BY 1"
22,"SELECT ""u"".""product_id"",CAST(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
23,"SELECT ""P"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""P"".""product_id"""
24,"SELECT ""a"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"">=""a"".""start_date"" AND ""b"".""purchase_date""<=""a"".""end_date"" GROUP BY ""a"".""product_id"""
25,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""product_id"""
26,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
27,"SELECT ""d"".""product_id"",ROUND((SUM(""price""*""units"")+0.00)/(SUM(""units"")+0.00), 2) AS ""average_price"" FROM (SELECT * FROM ""prices"" AS ""p"" NATURAL CROSS JOIN ""unitssold"" AS ""u"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""d"" GROUP BY ""d"".""product_id"""
28,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
29,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" AND ""u"".""product_id""=""p"".""product_id"" GROUP BY ""product_id"""
30,"SELECT ""a"".""product_id"",ROUND((SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""unitssold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""a"".""product_id"""
31,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
32,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
33,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_Date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
34,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
35,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""unitssold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""a"".""product_id"""
36,"SELECT ""p"".""product_id"",ROUND((SUM(""units""*""price"")/SUM(""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
37,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
38,"SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" USING (""product_Id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
39,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" LEFT JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
40,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
41,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY ""P"".""product_id"""
42,"SELECT ""p"".""product_id"",ROUND(SUM(""total_units""*""price"")/SUM(""total_units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN (SELECT ""product_id"",""purchase_date"",SUM(""units"") AS ""total_units"" FROM ""unitssold"" GROUP BY 1,2) AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
43,"SELECT ""t"".""id"" AS ""product_id"",ROUND(""prod""/""sums"", 2) AS ""average_price"" FROM (SELECT SUM(""p"".""price""*""u"".""units"") AS ""prod"",""p"".""product_id"" AS ""id"",SUM(""u"".""units"") AS ""sums"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""u"" ON ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""p"".""product_id"") AS ""t"""
44,"WITH ""PPUS"" AS (SELECT ""Prices"".""product_id"",""start_date"",""end_date"",""price"",""purchase_date"",""units"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""PPUS"" GROUP BY ""product_id"""
45,"SELECT ""Prices"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM (""Prices"") CROSS JOIN ""UnitsSold"" WHERE ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND ""UnitsSold"".""purchase_date""<=""Prices"".""end_date"" AND ""UnitsSold"".""purchase_date"">=""Prices"".""start_date"" GROUP BY ""Prices"".""product_id"""
46,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
47,"SELECT ""U"".""product_id"",ROUND(SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""U"" LEFT JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""U"".""product_id"""
48,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
49,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
50,"SELECT ""T"".""product_id"",ROUND(""total_p""/""total_q"", 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"",SUM(""price""*""units"") AS ""total_p"",SUM(""units"") AS ""total_q"" FROM ""prices"" AS ""P"" JOIN ""unitssold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""P"".""product_id"") AS ""T"" ORDER BY ""T"".""product_id"""
51,"SELECT ""b"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""b"" LEFT JOIN ""Prices"" AS ""a"" ON ""b"".""product_id""=""a"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""end_date"" GROUP BY 1"
52,"SELECT ""product_id"",ROUND(SUM(""price"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""x"".""product_id"",""x"".""purchase_date"",""x"".""units"",""x"".""units""*""y"".""price"" AS ""price"" FROM ""UnitsSold"" AS ""x"" JOIN ""Prices"" AS ""y"" ON ""x"".""product_id""=""y"".""product_id"" AND ""x"".""purchase_date"" BETWEEN ""y"".""start_date"" AND ""y"".""end_date"") AS ""a"" GROUP BY 1"
53,"WITH ""cte"" AS (SELECT ""p"".""product_id"",""price"",""units"",""price""*""units"" AS ""total"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
54,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
55,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
56,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
57,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
58,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""Start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
59,"SELECT ""prices"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" JOIN ""unitssold"" ON ""prices"".""product_id""=""unitssold"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""prices"".""product_id"""
60,"WITH ""raw_data"" AS (SELECT ""U"".*,""price"",""units""*""price"" AS ""value"" FROM ""UnitsSold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""value"")/SUM(""units""), 2) AS ""average_price"" FROM ""raw_data"" GROUP BY ""product_id"""
61,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM (""Prices"" AS ""p"") CROSS JOIN ""UnitsSold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
62,"SELECT DISTINCT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
63,"SELECT ""a"".""product_id"",ROUND((SUM(""a"".""price""*""b"".""units"")+0.00)/(SUM(""b"".""units"")+0.00), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" USING (""product_id"") WHERE ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""a"".""product_id"""
64,"SELECT ""p"".""product_id"" AS ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""us"" LEFT JOIN ""Prices"" AS ""p"" ON ""us"".""product_id""=""p"".""product_id"" AND ""p"".""start_date""<=""us"".""purchase_date"" AND ""p"".""end_date"">=""us"".""purchase_date"" GROUP BY ""p"".""product_id"" ORDER BY ""p"".""product_id"""
65,"WITH ""temp"" AS (SELECT ""U"".""product_id"",SUM(""P"".""price""*""U"".""units"") AS ""total_price"",SUM(""U"".""units"") AS ""total_units"" FROM ""UnitsSold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""U"".""product_id"") SELECT ""product_id"",ROUND(""total_price""/""total_units"", 2) AS ""average_price"" FROM ""temp"""
66,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
67,"WITH ""cte"" AS (SELECT ""u"".""product_id"",""u"".""purchase_date"",""u"".""units"",""p"".""price"" FROM ""UnitsSold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"")) SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"" ORDER BY ""product_id"""
68,"SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" LEFT JOIN ""UnitsSold"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
69,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
70,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
71,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""s"".""units"")/SUM(""s"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""s"" ON (""p"".""product_id""=""s"".""product_id"" AND ""s"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY 1"
72,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
73,"WITH ""temp"" AS (SELECT ""a"".""product_id"",""price"",""units"",SUM(""a"".""price""*""b"".""units"") AS ""tot"",SUM(""b"".""units"") AS ""a"" FROM ""prices"" AS ""a"" JOIN ""unitssold"" AS ""b"" USING (""product_id"") WHERE ""b"".""purchase_Date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""a"".""product_id"") SELECT ""product_id"",COALESCE(ROUND((""tot""/""a""), 2), 0) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
74,"WITH ""CTE1"" AS (SELECT DISTINCT * FROM ""UnitsSold""), ""CTE2"" AS (SELECT ""p"".""product_id"",""start_date"",""end_date"",""purchase_date"",""price"",""units"" FROM ""Prices"" AS ""p"" JOIN ""CTE1"" AS ""U"" ON ""p"".""product_id""=""u"".""product_id"" HAVING ""start_date""<=""purchase_date"" AND ""end_date"">=""purchase_date"") SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""CTE2"" GROUP BY ""product_id"""
75,"SELECT ""u"".""product_id"",ROUND((SUM(""units""*""price"")/SUM(""units"")), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
76,"SELECT ""B"".""product_id"",ROUND(SUM(""B"".""units""*""A"".""price"")/SUM(""B"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""B"" LEFT JOIN ""Prices"" AS ""A"" ON ""A"".""product_id""=""B"".""product_id"" AND ""A"".""start_date""<=""B"".""purchase_date"" AND ""B"".""purchase_date""<=""A"".""end_date"" GROUP BY 1"
77,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" LEFT JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
78,"WITH ""temp"" (""product_id"", ""price"", ""units"") AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
79,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY ""p"".""product_id"""
80,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
81,"SELECT ""u"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
82,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
83,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""product_id"""
84,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
85,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1 ORDER BY 1"
86,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
87,"WITH ""t1"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""t1"" GROUP BY 1"
88,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""a"" JOIN ""prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY ""a"".""product_id"""
89,"WITH ""u"" AS (SELECT ""Prices"".""product_id"",""Prices"".""price"",""UnitsSold"".""units"" FROM (""Prices"") CROSS JOIN ""UnitsSold"" WHERE ""Prices"".""start_date""<=""UnitsSold"".""purchase_date"" AND ""Prices"".""end_date"">=""UnitsSold"".""purchase_date"" AND ""Prices"".""product_id""=""UnitsSold"".""product_id"") SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""u"" GROUP BY ""product_id"""
90,"SELECT ""a"".""product_id"" AS ""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" LEFT JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY 1"
91,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" LEFT JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY 1"
92,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") GROUP BY ""p"".""product_id"""
93,"WITH ""cte"" AS (SELECT ""p"".""product_id"",""p"".""start_date"",""p"".""end_date"",""u"".""units"" AS ""quantity"",(""p"".""price""*""u"".""units"") AS ""selling_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND((SUM(""selling_price"")*1.00/SUM(""quantity"")), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
94,"SELECT ""Prices"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND (""UnitsSold"".""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"") GROUP BY ""Prices"".""product_id"""
95,"WITH ""cte"" AS (SELECT ""p"".""product_id"" AS ""id"",""price"",""units"",""u"".""product_id"" AS ""id2"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""id"" AS ""product_id"",ROUND((SUM(""price""*""units""))/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
96,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
97,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
98,"WITH ""temp"" AS (SELECT ""p"".""product_id"",""price"",""units"",""price""*""units"" AS ""tot_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""tot_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
99,"WITH ""t1"" AS (SELECT ""product_id"",""purchase_date"",SUM(""units"") AS ""total_sold"" FROM ""unitssold"" GROUP BY ""product_id""), ""t2"" AS (SELECT ""prices"".""product_id"",SUM(""price""*""units"") AS ""total_dollar_amount"" FROM ""prices"" JOIN ""unitssold"" ON ""purchase_date"">=""start_date"" AND ""purchase_date""<=""end_date"" AND ""prices"".""product_id""=""unitssold"".""product_id"" GROUP BY ""product_id"") SELECT ""t1"".""product_id"",ROUND(""t2"".""total_dollar_amount""/""t1"".""total_sold"", 2) AS ""average_price"" FROM ""t1"" JOIN ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"""
100,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
101,"SELECT ""product_id"",ROUND((""total"")/""total_units"", 2) AS ""average_price"" FROM (SELECT SUM(""price""*""units"") AS ""total"",""p"".""product_id"",SUM(""units"") AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"") AS ""a"""
102,"SELECT ""P"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" LEFT JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
103,"SELECT ""product_id"",ROUND((SUM(""price""*""units"")/SUM(""units"")), 2) AS ""average_price"" FROM ""prices"" JOIN ""unitssold"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
104,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""S"".""units"")/SUM(""S"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""S"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY 1"
105,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" JOIN ""Prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY ""a"".""product_id"""
106,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY ""p"".""product_id"""
107,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
108,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
109,"SELECT ""T"".""id"" AS ""product_id"",ROUND(SUM(""T"".""unit""*""T"".""price"")/SUM(""T"".""unit""), 2) AS ""average_price"" FROM (SELECT ""U"".""product_id"" AS ""id"",""U"".""units"" AS ""unit"",""P"".""price"" AS ""price"" FROM (""Prices"" AS ""P"") CROSS JOIN ""UnitsSold"" AS ""U"" WHERE (""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") AND ""P"".""product_id""=""U"".""product_id"") AS ""T"" GROUP BY ""T"".""id"""
110,"SELECT ""prices"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" JOIN ""unitssold"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1 ORDER BY 1"
111,"SELECT ""Prices"".""product_id"",ROUND(SUM(""UnitsSold"".""units""*""Prices"".""price"")/SUM(""UnitsSold"".""units""), 2) AS ""average_price"" FROM ""Prices"" LEFT JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND ""UnitsSold"".""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"" GROUP BY ""Prices"".""product_id"""
112,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
113,"SELECT ""u"".""product_id"",ROUND(SUM(""units""*""p"".""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
114,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM (SELECT DISTINCT * FROM ""prices"") AS ""a"" JOIN ""unitssold"" AS ""b"" ON ""a"".""start_date""<=""b"".""purchase_date"" AND ""a"".""end_date"">=""b"".""purchase_date"" AND ""a"".""product_id""=""b"".""product_id"" GROUP BY 1"
115,"SELECT ""u"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
116,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
117,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""U"" ON ""p"".""product_id""=""u"".""product_id"" WHERE DATE(""purchase_date"") BETWEEN DATE(""start_date"") AND DATE(""end_date"") GROUP BY ""product_id"""
118,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""s"".""units"")/SUM(""s"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" AND ""s"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
119,"WITH ""cte"" AS (SELECT ""p"".""product_id"",""p"".""price""*""u"".""units"" AS ""sales"",""u"".""units"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""u"" ON ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" AND ""p"".""product_id""=""u"".""product_id"") SELECT ""product_id"",ROUND(SUM(""sales"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
120,"WITH ""temp"" AS (SELECT ""u"".""product_id"",""u"".""purchase_date"",""u"".""units"",""p"".""price"",""u"".""units""*""p"".""price"" AS ""tot_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""tot_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY 1"
121,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
122,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
123,"WITH ""temp_price"" AS (SELECT ""u"".""product_id"",""p"".""price""*""u"".""units"" AS ""t_price"",""u"".""units"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""t_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp_price"" GROUP BY ""product_id"""
124,"SELECT ""a"".""product_id"",ROUND(COALESCE(SUM(""units""*""price"")/SUM(""units""), 0), 2) AS ""average_price"" FROM ""prices"" AS ""a"" LEFT JOIN ""unitssold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY 1"
125,"SELECT ""product_id"",ROUND(SUM(""a"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""price"",""units"",""price""*""units"" AS ""a"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"")) AS ""t"" GROUP BY ""product_id"""
126,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND (""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") GROUP BY ""P"".""product_id"""
127,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
128,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
129,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
130,"SELECT ""product_id"",ROUND(SUM(""revenue"")/SUM(""total_units""), 2) AS ""average_price"" FROM (SELECT ""prices"".""product_id"",SUM(""price""*""units"") AS ""revenue"",SUM(""units"") AS ""total_units"" FROM ""prices"" JOIN ""UnitsSold"" ON ""prices"".""product_id""=""UnitsSold"".""product_id"" WHERE ""UnitsSold"".""purchase_date"" BETWEEN ""prices"".""start_date"" AND ""prices"".""end_date"" GROUP BY ""prices"".""product_id"",""purchase_date"") AS ""tem"" GROUP BY ""product_id"""
131,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"")) GROUP BY ""product_id"""
132,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""a"" JOIN ""prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY 1 ORDER BY 1"
133,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""Price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND (""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") GROUP BY ""product_id"""
134,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""S"".""units"")/SUM(""S"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""S"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY 1"
135,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
136,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
137,"WITH ""temp"" AS (SELECT ""u"".""product_id"",SUM(""units"") AS ""tot_units"",SUM(""price""*""units"") AS ""total"" FROM ""UnitsSold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1) SELECT ""product_id"",ROUND(""total""/""tot_units"", 2) AS ""average_price"" FROM ""temp"""
138,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
139,"SELECT ""u"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""u"".""product_id"""
140,"SELECT ""Prices"".""product_id"",ROUND((SUM(""price""*""units"")/SUM(""units"")), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""UnitsSold"".""product_id""=""Prices"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
141,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
142,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
143,"SELECT ""p"".""product_id"" AS ""product_id"",ROUND((SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
144,"WITH ""cte"" AS (SELECT ""product_id"",SUM(""units"") AS ""summ"" FROM ""unitssold"" AS ""u"" GROUP BY 1) SELECT ""z"".""product_id"",ROUND(""average_price""/""c"".""summ"", 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"",SUM(CASE WHEN ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" THEN ""price""*""units"" END) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""u"".""product_id""=""p"".""product_id"" GROUP BY 1) AS ""z"" CROSS, ""cte"" AS ""c"" WHERE ""c"".""product_id""=""z"".""product_id"""
145,"WITH ""combined"" AS (SELECT ""p"".""product_id"",""price"",""units"",""start_date"",""end_date"",""purchase_date"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"") SELECT ""product_id"",ROUND(SUM(""tol"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""product_id"",""price""*""units"" AS ""tol"",""units"" FROM ""combined"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") AS ""t"" GROUP BY ""product_id"""
146,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
147,"WITH ""cte"" AS (SELECT ""u"".""product_id"",""u"".""purchase_date"",""u"".""units"",""p"".""price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY 1"
148,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""product_id"""
149,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
150,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
151,"SELECT ""p"".""product_id"" AS ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""us"" LEFT JOIN ""Prices"" AS ""p"" ON ""us"".""product_id""=""p"".""product_id"" AND ""p"".""start_date""<=""us"".""purchase_date"" AND ""p"".""end_date"">=""us"".""purchase_date"" GROUP BY ""p"".""product_id"" ORDER BY ""p"".""product_id"""
152,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"") AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY 1"
153,"WITH ""tb"" AS (SELECT ""p"".""product_id"",""u"".""units"",""p"".""price""*""u"".""units"" AS ""sales"" FROM ""Prices"" AS ""p"" JOIN ""Unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""sales"")/SUM(""units""), 2) AS ""average_price"" FROM ""tb"" GROUP BY 1"
154,"SELECT ""t"".""id"" AS ""product_id"",ROUND(""prod""/""sums"", 2) AS ""average_price"" FROM (SELECT SUM(""p"".""price""*""u"".""units"") AS ""prod"",""p"".""product_id"" AS ""id"",SUM(""u"".""units"") AS ""sums"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""u"" ON ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""p"".""product_id"") AS ""t"""
155,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" USING (""product_id"") WHERE ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""a"".""product_id"""
156,"WITH ""cte"" AS (SELECT ""u"".""product_id"",""u"".""units"",""p"".""price"",""u"".""units""*""p"".""price"" AS ""total"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
157,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY ""product_id"""
158,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
159,"SELECT ""u"".""product_id"",ROUND((SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
160,"SELECT ""u"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" AND ""u"".""product_id""=""p"".""product_id"" GROUP BY 1"
161,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
162,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
163,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""product_id"""
164,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
165,"SELECT ""U"".""product_id"",CAST(SUM(""units""*""price"")/SUM(""units"") AS DECIMAL(36, 2)) AS ""average_price"" FROM ""Unitssold"" AS ""U"" LEFT JOIN ""Prices"" AS ""P"" ON ""P"".""product_id""=""U"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""U"".""product_id"""
166,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
167,"SELECT ""product_id"",ROUND(SUM(""total_daily_price"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""uni"".""product_id"",""uni"".""purchase_date"",""uni"".""units"",""P"".""price""*""uni"".""units"" AS ""total_daily_price"" FROM ""UnitsSold"" AS ""uni"" JOIN ""Prices"" AS ""P"" ON ""P"".""product_id""=""uni"".""product_id"" AND ""uni"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") AS ""sub"" GROUP BY ""product_id"""
168,"SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""u"".""product_id"",""u"".""units"",""p"".""price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" USING (""product_id"") WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""sub"" GROUP BY ""product_id"""
169,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY 1"
170,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_Date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
171,"SELECT ""p"".""product_id"",ROUND((SUM(""price""*""units"")/SUM(""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
172,"WITH ""temp"" AS (SELECT ""p"".""product_id"",""price"",""units"",""price""*""units"" AS ""tot_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""tot_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
173,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
174,"SELECT ""P"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" LEFT JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
175,"SELECT ""P"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""P"".""product_id"""
176,"SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""product_id"",""purchase_date"",(SELECT ""price"" FROM ""prices"" AS ""p"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" AND ""p"".""product_id""=""u"".""product_id"") AS ""price"",""units"" FROM ""unitssold"" AS ""u"") AS ""T"" GROUP BY ""product_id"""
177,"WITH ""total_units"" AS (SELECT ""u1"".""product_id"",SUM(""u1"".""units"") AS ""total_units"" FROM ""UnitsSold"" AS ""u1"" GROUP BY ""u1"".""product_id""), ""total_daily_revenue"" AS (SELECT ""p"".""product_id"",""u2"".""purchase_date"",(""p"".""price""*""u2"".""units"") AS ""total_daily_revenue"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u2"" ON ""p"".""product_id""=""u2"".""product_id"" WHERE ""u2"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date""), ""total_revenue"" AS (SELECT ""total_daily_revenue"".""product_id"",SUM(""total_daily_revenue"".""total_daily_revenue"") AS ""total_revenue"" FROM ""total_daily_revenue"" GROUP BY ""total_daily_revenue"".""product_id"") SELECT ""total_units"".""product_id"",ROUND((""total_revenue"".""total_revenue""/""total_units"".""total_units""), 2) AS ""average_price"" FROM ""total_units"" JOIN ""total_revenue"" ON ""total_units"".""product_id""=""total_revenue"".""product_id"""
178,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON (""P"".""product_id""=""U"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") GROUP BY ""P"".""product_id"""
179,"SELECT ""Prices"".""product_id"",ROUND((SUM(""units""*""price"")/SUM(""units"")), 2) AS ""average_price"" FROM (""Prices"") CROSS JOIN ""UnitsSold"" WHERE ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND ""UnitsSold"".""purchase_date"">=""Prices"".""start_date"" AND ""UnitsSold"".""purchase_date""<=""Prices"".""end_date"" GROUP BY ""product_id"""
180,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"") GROUP BY ""product_id"""
181,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
182,"WITH ""temp"" AS (SELECT ""p"".""product_id"",""price"",""units"",""price""*""units"" AS ""tot_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""tot_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
183,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""product_id"""
184,"SELECT ""a"".""product_id"",ROUND(SUM((""a"".""price""*""b"".""units""))/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
185,"SELECT ""Prices"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
186,"SELECT ""A"".""product_id"",ROUND(SUM(""A"".""price""*""B"".""units"")/SUM(""B"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""A"" LEFT JOIN ""UnitsSold"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" WHERE ""B"".""purchase_date"">=""A"".""start_date"" AND ""B"".""purchase_date""<=""A"".""end_date"" GROUP BY ""A"".""product_id"""
187,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
188,"SELECT ""a"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""a"" JOIN ""prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""a"".""product_id"""
189,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""a"" JOIN ""unitssold"" AS ""b"" ON ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" AND ""a"".""product_id""=""b"".""product_id"" GROUP BY 1"
190,"SELECT ""prices"".""product_id"",ROUND(SUM(""prices"".""price""*""unitssold"".""units"")/SUM(""unitssold"".""units""), 2) AS ""average_price"" FROM ""prices"" JOIN ""unitssold"" ON ""prices"".""product_id""=""unitssold"".""product_id"" AND ""unitssold"".""purchase_date"" BETWEEN ""prices"".""start_date"" AND ""prices"".""end_date"" GROUP BY ""product_id"""
191,"SELECT ""p"".""product_id"",ROUND(((SUM(""p"".""price""*""u"".""units""))/(SUM(""u"".""units""))), 2) AS ""average_price"" FROM ""prices"" AS ""p"" CROSS JOIN ""UnitsSold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"" ORDER BY ""p"".""product_id"""
192,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
193,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
194,"WITH ""temp"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"",(""price""*""units"") AS ""total"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"",""start_date"",""end_date"",""purchase_date"",""p"".""price"",""u"".""units"") SELECT ""product_id"",ROUND((SUM(""temp"".""total"")/SUM(""temp"".""units"")), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
195,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
196,"SELECT ""us"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""us"" JOIN ""prices"" AS ""p"" ON ""us"".""product_id""=""p"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
197,"SELECT ""p"".""product_id"" AS ""product_id"",ROUND((SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
198,"SELECT ""A"".""product_id"",ROUND(SUM(""A"".""price""*""B"".""units"")/SUM(""B"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""A"" LEFT JOIN ""UnitsSold"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" WHERE ""B"".""purchase_date"" BETWEEN ""A"".""start_date"" AND ""A"".""end_date"" GROUP BY ""A"".""product_id"""
199,"WITH ""w"" AS (SELECT ""a"".*,""b"".""units"",""a"".""price""*""b"".""units"" AS ""total_price"" FROM ""prices"" AS ""a"" JOIN ""unitssold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""w"" GROUP BY ""product_id"""
200,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
201,"SELECT ""t1"".""id"" AS ""product_id"",ROUND(SUM(""t1"".""prod""/""t2"".""sums""), 2) AS ""average_price"" FROM (SELECT (""p"".""price""*""u"".""units"") AS ""prod"",""p"".""product_id"" AS ""id"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""u"" ON ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""p"".""product_id""=""u"".""product_id"") AS ""t1"" JOIN (SELECT SUM(""u"".""units"") AS ""sums"",""p"".""product_id"" FROM ""prices"" AS ""p"" JOIN ""unitsSold"" AS ""u"" ON ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""u"".""product_id"") AS ""t2"" ON ""t1"".""id""=""t2"".""product_id"" GROUP BY ""t1"".""id"""
202,"WITH ""cte"" AS (SELECT ""P"".""product_id"",""price"",""units"",(""price""*""units"") AS ""total_price"" FROM ""Prices"" AS ""P"" LEFT JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") SELECT DISTINCT ""product_id"",ROUND(SUM(""total_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
203,"SELECT ""us"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""us"" JOIN ""prices"" AS ""p"" ON ""us"".""product_id""=""p"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
204,"SELECT ""t1"".""product_id"" AS ""product_id"",ROUND(SUM(""t1"".""total_price"")/SUM(""t1"".""units""), 2) AS ""average_price"" FROM (SELECT ""Prices"".""product_id"" AS ""product_id"",""Prices"".""price""*""UnitsSold"".""units"" AS ""total_price"",""UnitsSold"".""units"" AS ""units"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND ""UnitsSold"".""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"") AS ""t1"" GROUP BY ""product_id"""
205,"SELECT ""a"".""product_id"" AS ""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" JOIN ""Prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY 1"
206,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
207,"SELECT ""Prices"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""Prices"".""product_id"""
208,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""product_id"""
209,"SELECT ""A"".""PRODUCT_ID"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""AVERAGE_PRICE"" FROM ""PRICES"" AS ""A"" JOIN ""UNITSSOLD"" AS ""B"" ON ""A"".""PRODUCT_ID""=""B"".""PRODUCT_ID"" AND ""B"".""PURCHASE_DATE"" BETWEEN ""A"".""START_DATE"" AND ""A"".""END_DATE"" GROUP BY ""A"".""PRODUCT_ID"""
210,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_Date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""p"".""product_id"""
211,"SELECT DISTINCT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
212,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
213,"WITH ""temp"" AS (SELECT ""p"".""product_id"",""price"",""units"",""price""*""units"" AS ""tot_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""tot_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
214,"WITH ""t"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"",""p"".""price""*""u"".""units"" AS ""total_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""t"" GROUP BY ""product_id"""
215,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
216,"WITH ""t"" AS (SELECT ""product_id"",""price""*""units"" AS ""total"",""units"" FROM ""prices"" JOIN ""unitssold"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""total"")/SUM(""units""), 2) AS ""average_price"" FROM ""t"" GROUP BY ""product_id"" ORDER BY ""product_id"""
217,"SELECT ""b"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM (""prices"" AS ""a"") CROSS JOIN ""unitsSold"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""b"".""product_id"""
218,"SELECT ""p"".""product_id"",ROUND(SUM(""s"".""units""*""p"".""price"")/SUM(""s"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" AND ""s"".""purchase_Date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
219,"SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" JOIN ""prices"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
220,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM (""Prices"" AS ""p"") CROSS JOIN ""UnitsSold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""p"".""product_id"""
221,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
222,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
223,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units""))/(SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" LEFT JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
224,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY 1"
225,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_Date"" GROUP BY ""p"".""product_id"""
226,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""a"".""product_id"""
227,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
228,"WITH ""sales"" AS (SELECT ""prices"".""product_id"",(""prices"".""price""*""unitssold"".""units"") AS ""total_price"",""unitssold"".""units"" FROM ""prices"" JOIN ""unitssold"" ON ""prices"".""product_id""=""unitssold"".""product_id"" AND ""unitssold"".""purchase_date"" BETWEEN ""prices"".""start_date"" AND ""prices"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""sales"" GROUP BY ""product_id"""
229,"SELECT ""product_id"",ROUND(SUM(""x"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""a"".""product_id"",SUM(""price""*""units"") AS ""x"",SUM(""units"") AS ""units"" FROM ""UnitsSold"" AS ""a"" JOIN ""prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY 1) AS ""x"" GROUP BY 1"
230,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY 1"
231,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AND (""u"".""product_id""=""p"".""product_id"") GROUP BY ""p"".""product_id"" ORDER BY ""p"".""product_id"""
232,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
233,"SELECT ""u"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""prices"" AS ""p"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
234,"SELECT ""T"".""product_id"",ROUND(SUM(""T"".""total_price"")/SUM(""T"".""units""), 2) AS ""average_price"" FROM (SELECT ""P"".""product_id"",(""units""*""price"") AS ""total_price"",""price"",""units"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""US"" ON ""P"".""product_id""=""US"".""product_id"" WHERE ""purchase_date"" BETWEEN ""Start_date"" AND ""end_date"") AS ""T"" GROUP BY ""T"".""product_id"""
235,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
236,"WITH ""temp"" AS (SELECT ""U"".""product_id"",""U"".""units"" AS ""totalunits"",""U"".""units""*""P"".""price"" AS ""totalprice"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" AND ""P"".""product_id""=""U"".""product_id"") SELECT ""product_id"",ROUND(SUM(""totalprice"")/SUM(""totalunits""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
237,"SELECT ""t1"".""product_id"",ROUND(SUM(""t2"".""units""*""t1"".""price"")/SUM(""t2"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""t1"" JOIN ""UnitsSold"" AS ""t2"" USING (""product_id"") WHERE ""t2"".""purchase_date"" BETWEEN ""t1"".""start_date"" AND ""t1"".""end_date"" GROUP BY ""product_id"""
238,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""u"".""product_id"""
239,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
240,"SELECT ""p"".""product_id"" AS ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
241,"SELECT ""P"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""S"" JOIN ""Prices"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" AND (""S"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") GROUP BY ""P"".""product_id"""
242,"SELECT ""p"".""product_id"",ROUND((SUM(""u"".""units""*""p"".""price"")/SUM(""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
243,"WITH ""combined"" AS (SELECT ""p"".""product_id"",""price"",""units"",""start_date"",""end_date"",""purchase_date"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"") SELECT ""product_id"",ROUND(SUM(""tol"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""product_id"",""price""*""units"" AS ""tol"",""units"" FROM ""combined"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") AS ""t"" GROUP BY ""product_id"""
244,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
245,"WITH ""tcte"" AS (SELECT ""p"".""product_id"",""u"".""purchase_date"",(""p"".""price""*""u"".""units"") AS ""total"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""t"".""product_id"",ROUND(SUM(""t"".""total"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM (""tcte"" AS ""t"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""t"".""product_id""=""u"".""product_id"" AND ""t"".""purchase_date""=""u"".""purchase_date"" GROUP BY ""t"".""product_id"""
246,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/COALESCE(SUM(""units""), 1), 2) AS ""average_price"" FROM ""prices"" AS ""p"" LEFT JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"">=""start_date"" AND ""purchase_date""<=""end_date"" GROUP BY ""p"".""product_id"""
247,"SELECT DISTINCT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""a"".""product_id"""
248,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"") WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
249,"SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"",""price"",""units"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""a"" GROUP BY ""product_id"""
250,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
251,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM (""Prices"" AS ""a"") CROSS JOIN ""UnitsSold"" AS ""b"" WHERE ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" AND ""a"".""product_id""=""b"".""product_id"" GROUP BY ""product_id"""
252,"WITH ""temp"" (""product_id"", ""price_unit"", ""units"") AS (SELECT ""a"".""product_id"",(""a"".""price""*""b"".""units"") AS ""price_unit"",""b"".""units"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""price_unit"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"" ORDER BY ""product_id"""
253,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""p"".""product_id"""
254,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""start_date""<=""b"".""purchase_date"" AND ""a"".""end_date"">=""b"".""purchase_date"" GROUP BY ""a"".""product_id"""
255,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
256,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"") GROUP BY 1"
257,"SELECT DISTINCT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Unitssold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
258,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
259,"SELECT ""P"".""product_id"",ROUND(SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" LEFT JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND (""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"") GROUP BY ""product_id"""
260,"WITH ""c"" AS (SELECT ""p"".""product_id"",""start_date"",""end_date"",""purchase_date"",""units"",""price"",""units""*""price"" AS ""tot_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date""), ""b"" AS (SELECT ""product_id"",SUM(""units"") AS ""tot_units"" FROM ""c"" GROUP BY ""product_id""), ""a"" AS (SELECT ""c"".""product_id"",""tot_price"",""tot_units"" FROM (""c"") CROSS JOIN ""b"" WHERE ""c"".""product_id""=""b"".""product_id"") SELECT ""a"".""product_id"",ROUND(SUM(""tot_price"")*1.0/MIN(""tot_units""), 2) AS ""average_price"" FROM ""a"" GROUP BY ""product_id"""
261,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
262,"WITH ""total_dollar_step1"" AS (SELECT ""u"".""product_id"",""p"".""price""*""u"".""units"" AS ""total_lines"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date""), ""total_dollar_step2"" AS (SELECT ""product_id"",SUM(""total_lines"") AS ""total_price"" FROM ""total_dollar_step1"" GROUP BY ""product_id""), ""units_total"" AS (SELECT ""product_id"",SUM(""units"") AS ""total_u"" FROM ""unitssold"" GROUP BY ""product_id"") SELECT ""a"".""product_id"",ROUND(""a"".""total_price""/""b"".""total_u"", 2) AS ""average_price"" FROM ""total_dollar_step2"" AS ""a"" JOIN ""units_total"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"""
263,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM (""unitsSold"" AS ""a"") CROSS JOIN ""prices"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY ""a"".""product_id"""
264,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM (""Prices"" AS ""p"") CROSS JOIN ""UnitsSold"" AS ""s"" WHERE ""p"".""product_id""=""s"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
265,"SELECT ""u"".""product_id"",ROUND(SUM(CASE WHEN ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" THEN ""p"".""price"" ELSE 0 END*""u"".""units"")/SUM(CASE WHEN ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" THEN ""u"".""units"" ELSE 0 END), 2) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""u"".""product_id""=""p"".""product_id"" GROUP BY ""u"".""product_id"""
266,"SELECT ""p"".""product_id"",COALESCE(ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2), 0) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""purchase_date"">=""p"".""start_date"" GROUP BY ""p"".""product_id"" ORDER BY 1"
267,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""price""*""b"".""units"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"" GROUP BY ""a"".""product_id"""
268,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
269,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitsSold"" AS ""u"" WHERE ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
270,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
271,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""u"".""product_id"""
272,"SELECT ""product_id"",ROUND(""total_cost""/""units"", 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"",SUM(""units""*""price"") AS ""total_cost"",SUM(""units"") AS ""units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""product_id"") AS ""T"""
273,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
274,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
275,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
276,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""P"".""product_id"""
277,"SELECT ""P"".""product_id"",ROUND(SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""p"".""product_id"" ORDER BY ""P"".""product_id"""
278,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
279,"WITH ""CTE"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""c"".""product_id"",ROUND(SUM(""c"".""units""*""c"".""price"")/SUM(""c"".""units""), 2) AS ""average_price"" FROM ""CTE"" AS ""c"" GROUP BY ""c"".""product_id"""
280,"SELECT ""product_id"",ROUND(SUM(""temp_sum"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""p1"".""product_id"",(""p1"".""price""*""u1"".""units"") AS ""temp_sum"",""u1"".""units"" FROM ""Prices"" AS ""p1"" JOIN ""UnitsSold"" AS ""u1"" ON ""p1"".""product_id""=""u1"".""product_id"" AND ""u1"".""purchase_date"" BETWEEN ""p1"".""start_date"" AND ""p1"".""end_date"") AS ""a"" GROUP BY ""a"".""product_id"""
281,"SELECT ""prices"".""product_id"",ROUND(SUM(""prices"".""price""*""unitssold"".""units"")/SUM(""unitssold"".""units""), 2) AS ""average_price"" FROM ""prices"" JOIN ""unitssold"" ON ""prices"".""product_id""=""unitssold"".""product_id"" WHERE ""unitssold"".""purchase_date"" BETWEEN ""prices"".""start_date"" AND ""prices"".""end_date"" GROUP BY ""prices"".""product_id"""
282,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
283,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"" GROUP BY ""p"".""product_id"""
284,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""Unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
285,"SELECT ""u"".""product_id"",ROUND((SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""u"".""product_id"""
286,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" AND ""s"".""purchase_date"">=""start_date"" AND ""s"".""purchase_date""<=""end_date"" GROUP BY 1"
287,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""U"".""units"")/SUM(""U"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
288,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" - ""p"".""start_date"">=0 AND ""p"".""end_date"" - ""u"".""purchase_date"">=0 GROUP BY ""product_id"""
289,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
290,"SELECT ""p"".""product_id"",ROUND((SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
291,"SELECT ""p"".""product_id"",CAST(SUM(""sold"".""units""*""p"".""price"")/SUM(""sold"".""units"") AS DECIMAL(18, 2)) AS ""average_price"" FROM ""UnitsSold"" AS ""sold"" JOIN ""Prices"" AS ""p"" ON ""p"".""product_id""=""sold"".""product_id"" AND ""sold"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
292,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
293,"SELECT ""product_id"",ROUND(SUM(""sellingprice"")/SUM(""units""), 2) AS ""average_price"" FROM ((SELECT ""u"".""product_id"",""u"".""purchase_date"",""u"".""units"",""p"".""price"",""units""*""price"" AS ""sellingprice"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"")) AS ""a"" GROUP BY 1"
294,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""U"".""product_id""=""P"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""P"".""product_id"""
295,"SELECT ""product_id"",ROUND(SUM(""price"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""x"".""product_id"",""x"".""purchase_date"",""x"".""units"",""x"".""units""*""y"".""price"" AS ""price"" FROM ""UnitsSold"" AS ""x"" JOIN ""Prices"" AS ""y"" ON ""x"".""product_id""=""y"".""product_id"" AND ""x"".""purchase_date"" BETWEEN ""y"".""start_date"" AND ""y"".""end_date"") AS ""a"" GROUP BY 1"
296,"SELECT DISTINCT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
297,"WITH ""x"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"",(""p"".""price""*""u"".""units"") AS ""total_money"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total_money"")/SUM(""units""), 2) AS ""average_price"" FROM ""x"" GROUP BY ""product_id"""
298,"SELECT ""Prices"".""product_id"",ROUND(SUM(""Prices"".""price""*""UnitsSold"".""units"")/SUM(""UnitsSold"".""units""), 2) AS ""average_price"" FROM ""Prices"" JOIN (SELECT DISTINCT * FROM ""UnitsSold"") AS ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" WHERE ""purchase_date"">=""start_date"" AND ""purchase_date""<=""end_date"" GROUP BY ""Prices"".""product_id"""
299,"WITH ""cost"" AS (SELECT ""p"".""product_id"",(""p"".""price""*""u"".""units"") AS ""total_cost"",""u"".""units"",""u"".""purchase_date"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"",""u"".""purchase_date"") SELECT ""product_id"",ROUND(SUM(""total_cost"")/SUM(""units""), 2) AS ""average_price"" FROM ""cost"" GROUP BY ""product_id"""
300,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
301,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
302,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
303,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"" GROUP BY ""p"".""product_id"""
304,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM (""UnitsSold"" AS ""u"") CROSS JOIN ""Prices"" AS ""p"" WHERE (""p"".""product_id""=""u"".""product_id"") AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
305,"SELECT ""prices"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" JOIN ""unitssold"" ON ""prices"".""product_id""=""unitssold"".""product_id"" AND ""unitssold"".""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""prices"".""product_id"""
306,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""p"".""start_date""<=""us"".""purchase_date"" AND ""us"".""purchase_date""<=""p"".""end_date"" GROUP BY ""p"".""product_id"""
307,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" LEFT JOIN ""Prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY 1"
308,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""start_date"" AND ""u"".""purchase_date""<=""end_date"" GROUP BY 1"
309,"WITH ""temp"" AS (SELECT ""u"".""product_id"",""u"".""units"",""p"".""price""*""u"".""units"" AS ""total_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""total_price"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
310,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
311,"SELECT ""U"".""product_id"",ROUND(SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""U"".""product_id"" ORDER BY ""U"".""product_id"""
312,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
313,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY 1"
314,"SELECT ""p"".""product_id"",ROUND(COALESCE(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 0), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
315,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
316,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM (""Prices"" AS ""p"") CROSS JOIN ""UnitsSold"" AS ""u"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""u"".""product_id"""
317,"SELECT ""product_id"",ROUND(SUM(""units""*(SELECT ""price"" FROM ""prices"" WHERE ""product_id""=""a"".""product_id"" AND ""start_date""<=""a"".""purchase_date"" AND ""end_date"">=""a"".""purchase_date""))/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" GROUP BY ""product_id"""
318,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
319,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
320,"SELECT ""a"".""product_id"",ROUND((SUM((""a"".""price""*""b"".""units""))/SUM(""b"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"">=""a"".""start_date"" AND ""b"".""purchase_date""<=""a"".""end_date"") GROUP BY ""a"".""product_id"""
321,"SELECT ""U"".""product_id"",ROUND((SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units"")), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""U"" JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" AND ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""U"".""product_id"""
322,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
323,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
324,"WITH ""cte"" AS (SELECT ""p"".""product_id"",""p"".""price"",""u"".""units"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_Id"""
325,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
326,"SELECT ""U"".""product_id"",ROUND(SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""U"" LEFT JOIN ""Prices"" AS ""P"" ON ""U"".""product_id""=""P"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""U"".""product_id"" ORDER BY ""U"".""product_id"""
327,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
328,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
329,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
330,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
331,"SELECT ""u"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" CROSS JOIN ""prices"" AS ""p"" WHERE ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""u"".""product_id"""
332,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
333,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
334,"WITH ""cte"" AS (SELECT ""u"".""product_id"",""u"".""units"",""p"".""price"",""u"".""units""*""p"".""price"" AS ""total"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
335,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""p"".""start_date""<=""u"".""purchase_date"" AND ""p"".""end_date"">=""u"".""purchase_date"" GROUP BY ""p"".""product_id"""
336,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units"")), 2) AS ""average_price"" FROM (""prices"" AS ""p"") CROSS JOIN ""unitssold"" AS ""u"" WHERE ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" GROUP BY ""p"".""product_id"""
337,"SELECT ""product_id"",ROUND((SUM(""price""*""units"")/SUM(""units"")), 2) AS ""average_price"" FROM (SELECT * FROM ""prices"" LEFT JOIN ""unitssold"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") AS ""t"" GROUP BY ""product_id"""
338,"SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" USING (""product_id"") WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
339,"SELECT ""P"".""product_id"",ROUND(SUM(""U"".""units""*""P"".""price"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""product_id"""
340,"WITH ""cte"" AS (SELECT ""u"".""product_id"",(""units""*""price"") AS ""price"",SUM(""units"") OVER (PARTITION BY ""product_id"") AS ""units_sold"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON ""u"".""purchase_date"">=""p"".""start_date"" AND ""u"".""purchase_date""<=""p"".""end_date"" AND ""u"".""product_id""=""p"".""product_id"") SELECT ""product_id"",ROUND(SUM(""price"")/MAX(""units_sold""), 2) AS ""average_price"" FROM ""cte"" GROUP BY ""product_id"""
341,"SELECT ""Prices"".""product_id"",ROUND(SUM(""Price""*""units"")/SUM(""Units""), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" USING (""product_id"") WHERE ""UnitsSold"".""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"" GROUP BY ""Prices"".""product_id"""
342,"SELECT ""u"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"" GROUP BY ""product_id"""
343,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" LEFT JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
344,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units"")), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
345,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
346,"SELECT ""u"".""product_id"",ROUND((SUM((""u"".""units""*""p"".""price"")))/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
347,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
348,"SELECT ""product_id"",ROUND(SUM(""a"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""price"",""units"",""price""*""units"" AS ""a"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date""<=""end_date"" AND ""purchase_date"">=""start_date"")) AS ""t"" GROUP BY ""product_id"""
349,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""p"".""product_id"""
350,"SELECT DISTINCT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"""
351,"SELECT ""p"".""product_id"",ROUND((SUM(""p"".""price""*""s"".""units"")/SUM(""s"".""units"")), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" AND ""s"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""product_id"""
352,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_Date"" GROUP BY ""u"".""product_id"""
353,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
354,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" JOIN ""Prices"" AS ""p"" ON (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AND ""p"".""product_id""=""u"".""product_id"" GROUP BY ""u"".""product_id"""
355,"WITH ""cte"" AS (SELECT ""u"".""product_id"",""u"".""units"",""p"".""price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON (""u"".""product_id""=""p"".""product_id"") AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"")) SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""cte"" GROUP BY 1"
356,"SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""Prices"".""product_id"" AS ""product_id"",""units"",""price"" FROM ""Prices"" JOIN ""UnitsSold"" ON ""Prices"".""product_id""=""UnitsSold"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") AS ""t1"" GROUP BY ""product_id"""
357,"SELECT ""a"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""a"" JOIN ""prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""a"".""product_id"""
358,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
359,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""end_date"") GROUP BY ""product_id"""
360,"WITH ""TA"" AS (SELECT ""P"".""product_id"",""U"".""purchase_date"",""price"",""Units"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""Start_date"" AND ""P"".""end_date"") SELECT ""product_id"",ROUND(SUM(""price""*""Units"")/SUM(""units""), 2) AS ""average_price"" FROM ""TA"" GROUP BY ""product_id"""
361,"SELECT ""us"".""product_id"",ROUND(SUM(""p"".""price""*""us"".""units"")/SUM(""us"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""us"" LEFT JOIN ""Prices"" AS ""p"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""us"".""product_id"""
362,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"" ORDER BY ""product_id"""
363,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
364,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""u"".""product_id""=""p"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
365,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY 1 ORDER BY 1"
366,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" LEFT JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
367,"WITH ""temp"" AS (SELECT ""pr"".""product_id"",""pr"".""start_date"",""pr"".""end_date"",""pr"".""price"",""un"".""purchase_date"",""un"".""units"",""pr"".""price""*""un"".""units"" AS ""sales"" FROM ""Prices"" AS ""pr"" JOIN ""UnitsSold"" AS ""un"" ON ""un"".""product_id""=""pr"".""product_id"" HAVING ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") SELECT ""product_id"",ROUND(SUM(""sales"")/SUM(""units""), 2) AS ""average_price"" FROM ""temp"" GROUP BY ""product_id"""
368,"SELECT ""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"",""price"",""units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""a"" GROUP BY ""product_id"""
369,"WITH ""totalPurchase"" AS (SELECT ""pri"".""product_id"",SUM(""price""*""units"") AS ""totalPrice"",SUM(""units"") AS ""totalUnits"" FROM ""Prices"" AS ""pri"" JOIN ""UnitsSold"" AS ""Us"" ON ""pri"".""product_id""=""Us"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""pri"".""product_id"") SELECT ""product_id"",ROUND(""totalPrice""/""totalUnits"", 2) AS ""average_price"" FROM ""totalPurchase"""
370,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
371,"SELECT ""Prices"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" JOIN ""UnitsSold"" AS ""us"" ON ""Prices"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""Prices"".""start_date"" AND ""Prices"".""end_date"" GROUP BY ""Prices"".""product_id"""
372,"SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM (SELECT DISTINCT ""a"".""product_id"",""a"".""purchase_date"",""a"".""units"",""b"".""price"" FROM ""UnitsSold"" AS ""a"" JOIN ""Prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"">=""b"".""start_date"" AND ""a"".""purchase_date""<=""b"".""end_date"") AS ""t1"" GROUP BY ""product_id"" ORDER BY ""product_id"""
373,"SELECT ""product_id"",COALESCE(ROUND(SUM(""temp_sum"")/SUM(""units""), 2), 0) AS ""average_price"" FROM (SELECT ""p1"".""product_id"",(""p1"".""price""*""u1"".""units"") AS ""temp_sum"",""u1"".""units"" FROM ""Prices"" AS ""p1"" JOIN ""UnitsSold"" AS ""u1"" ON ""p1"".""product_id""=""u1"".""product_id"" AND ""u1"".""purchase_date"" BETWEEN ""p1"".""start_date"" AND ""p1"".""end_date"") AS ""a"" GROUP BY ""a"".""product_id"""
374,"SELECT ""a"".""product_id"",ROUND(CAST(SUM(""a"".""units""*""b"".""price"") AS DECIMAL(7, 2))/CAST(SUM(""a"".""units"") AS DECIMAL(7, 2)), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" LEFT JOIN ""Prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""purchase_date"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" GROUP BY ""a"".""product_id"""
375,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
376,"SELECT ""p"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""u"".""product_id"" ORDER BY ""u"".""product_id"""
377,"SELECT ""product_id"",CAST(SUM(""total_price"")/SUM(""total_units"") AS DECIMAL(10, 2)) AS ""average_price"" FROM (SELECT ""p"".""product_id"" AS ""product_id"",""p"".""price""*""u"".""units"" AS ""total_price"",""u"".""units"" AS ""total_units"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") AS ""s"" GROUP BY ""s"".""product_id"""
378,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" CROSS JOIN ""UnitsSold"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
379,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
380,"SELECT ""u"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY 1"
381,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""purchase_Date"" BETWEEN ""start_Date"" AND ""end_Date"" GROUP BY ""p"".""product_id"""
382,"WITH ""new"" AS (SELECT ""u"".""product_id"",""u"".""purchase_date"",""u"".""units"",""p"".""price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") SELECT ""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""new"" GROUP BY ""product_id"" ORDER BY ""product_id"""
383,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""P"".""product_id"""
384,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" LEFT JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""p"".""product_id"""
385,"SELECT ""t2"".""product_id"",ROUND((""t1"".""mul""/""t2"".""sum""), 2) AS ""average_price"" FROM (SELECT ""p"".""product_id"",SUM((""p"".""price""*""units"")) AS ""mul"" FROM ""prices"" AS ""p"" LEFT JOIN ""unitsSold"" AS ""u"" ON (""p"".""product_id""=""u"".""product_id"") WHERE ""start_date""<=""purchase_date"" AND ""end_date"">=""purchase_date"" GROUP BY ""p"".""product_id"") AS ""t1"" LEFT JOIN (SELECT ""product_id"",SUM(""units"") AS ""sum"" FROM ""UnitsSold"" GROUP BY ""product_id"") AS ""t2"" ON (""t1"".""product_id""=""t2"".""product_id"")"
386,"SELECT ""p"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" WHERE ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""product_id"""
387,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_Date"" BETWEEN ""p"".""start_Date"" AND ""p"".""end_Date"" GROUP BY ""p"".""product_id"""
388,"SELECT ""P"".""product_id"",ROUND(SUM(""P"".""price""*""U"".""units"")/SUM(""U"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""P"" JOIN ""UnitsSold"" AS ""U"" ON ""P"".""product_id""=""U"".""product_id"" WHERE ""U"".""purchase_date"" BETWEEN ""P"".""start_date"" AND ""P"".""end_date"" GROUP BY ""P"".""product_id"""
389,"SELECT ""u"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""u"" LEFT JOIN ""Prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND (""purchase_date"" BETWEEN ""start_date"" AND ""end_date"") GROUP BY ""u"".""product_id"""
390,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" AND ""p"".""product_id""=""u"".""product_id"" GROUP BY 1 ORDER BY 1"
391,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""p"".""product_id""=""u"".""product_id"" AND (""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"") GROUP BY ""product_id"""
392,"SELECT ""a"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" JOIN ""Prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""purchase_date"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY 1"
393,"SELECT ""us"".""product_id"",ROUND(SUM(""units""*""price"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""us"" ON ""p"".""product_id""=""us"".""product_id"" AND ""us"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
394,"SELECT ""a"".""product_id"",ROUND(SUM(""a"".""units""*""b"".""price"")/SUM(""a"".""units""), 2) AS ""average_price"" FROM ""UnitsSold"" AS ""a"" LEFT JOIN ""prices"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""start_date""<=""a"".""purchase_date"" AND ""end_date"">=""a"".""purchase_date"" GROUP BY ""a"".""product_id"""
395,"SELECT ""p"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""prices"" AS ""p"" JOIN ""unitssold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY ""p"".""product_id"""
396,"SELECT ""u"".""product_id"",ROUND(SUM(""p"".""price""*""u"".""units"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
397,"SELECT ""a"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""start_date""<=""b"".""purchase_date"" AND ""a"".""end_date"">=""b"".""purchase_date"" GROUP BY ""a"".""product_id"""
398,"SELECT ""a"".""product_id"",ROUND(SUM(""b"".""units""*""a"".""price"")/SUM(""b"".""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""a"" JOIN ""UnitsSold"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND (""b"".""purchase_date"" BETWEEN ""a"".""start_date"" AND ""a"".""end_date"") GROUP BY ""product_id"""
399,"SELECT ""u"".""product_id"",ROUND(SUM(""u"".""units""*""p"".""price"")/SUM(""u"".""units""), 2) AS ""average_price"" FROM ""unitssold"" AS ""u"" JOIN ""prices"" AS ""p"" ON ""u"".""product_id""=""p"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1 ORDER BY 1"
400,"SELECT ""p"".""product_id"",ROUND(SUM(""price""*""units"")/SUM(""units""), 2) AS ""average_price"" FROM ""Prices"" AS ""p"" JOIN ""UnitsSold"" AS ""u"" ON ""p"".""product_id""=""u"".""product_id"" AND ""u"".""purchase_date"" BETWEEN ""p"".""start_date"" AND ""p"".""end_date"" GROUP BY 1"
