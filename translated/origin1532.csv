id,original query
1,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""o"".""customer_id"",""name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"")) AS ""temp"" WHERE ""ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
2,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranki"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""ranki""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
3,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" JOIN ""Customers"" USING (""customer_id"")) AS ""a"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
4,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""c"".""name"" AS ""customer_name"",""o"".""order_date"",""o"".""order_id"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
5,"WITH ""ranktable"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""r"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM (""ranktable"" AS ""r"") CROSS JOIN ""customers"" AS ""c"" WHERE ""r"".""customer_id""=""c"".""customer_id"" AND ""r"".""rnk""<=3 ORDER BY ""c"".""name"",""r"".""customer_id"",""r"".""order_date"" DESC"
6,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t1"".""order_id"",""t1"".""order_date"" FROM (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""t1"" LEFT JOIN ""customers"" AS ""c"" ON ""t1"".""customer_id""=""c"".""customer_id"" WHERE ""t1"".""rnk""<=3 ORDER BY ""customer_name"",""c"".""customer_id"",""t1"".""order_date"" DESC"
7,"WITH ""cte"" AS (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""Ranks"" FROM ""Orders"") SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""cte"" AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""Ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
8,"SELECT ""t"".""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rnk""<4 ORDER BY ""t"".""customer_name"",""t"".""customer_id"",""t"".""order_date"" DESC"
9,"SELECT ""sub"".""name"" AS ""customer_name"",""sub"".""customer_id"",""sub"".""order_id"",""sub"".""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranked"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""sub"" WHERE ""sub"".""ranked""<=3 ORDER BY 1,2,4 DESC"
10,"WITH ""temp"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""cost"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""row_num"" FROM ""Orders"") SELECT ""Customers"".""name"" AS ""customer_name"",""temp"".""customer_id"",""temp"".""order_id"",""temp"".""order_date"" FROM ""temp"" JOIN ""Customers"" ON ""temp"".""customer_id""=""Customers"".""customer_id"" WHERE ""row_num""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
11,"SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""t"".""rk""<=3 ORDER BY 1,2,4 DESC"
12,"SELECT ""c"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""a"" JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""c"".""name"",""a"".""customer_id"",""a"".""order_date"" DESC"
13,"SELECT ""name"" AS ""customer_name"",""A"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""orders"") AS ""A"" JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""A"".""customer_id"" AND ""A"".""order_rank""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
14,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"" AS ""customer_id"",""order_id"",""order_date"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
15,"WITH ""t"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rak"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rak""<=3 ORDER BY 1,2,""order_date"" DESC"
16,"WITH ""data_2"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rn"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" ORDER BY 1,2,4 DESC) SELECT ""dd"".""customer_name"",""dd"".""customer_id"",""dd"".""order_id"",""dd"".""order_date"" FROM ""data_2"" AS ""dd"" WHERE ""rn""<4"
17,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RN"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"" FROM ""cte"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""RN"" IN (1,2,3) ORDER BY ""name"",""a"".""customer_id"",""order_date"" DESC"
18,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""customer_id"",""order_date"" DESC) AS ""ranknum"" FROM ""orders"") AS ""a"" WHERE ""a"".""ranknum""<=3) SELECT ""c"".""name"" AS ""customer_name"",""a"".* FROM ""customers"" AS ""c"" JOIN ""cte"" AS ""a"" ON ""c"".""customer_id""=""a"".""customer_id"" ORDER BY 1,""a"".""customer_id"",""a"".""order_date"" DESC"
19,"SELECT ""name"" AS ""Customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""x"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
20,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rn"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""a"".""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
21,"SELECT ""C"".""name"" AS ""customer_name"",""T"".""customer_id"",""T"".""order_id"",""T"".""order_date"" FROM (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""most_recent"" FROM ""Orders"") AS ""T"" LEFT JOIN ""Customers"" AS ""C"" ON ""T"".""customer_id""=""C"".""customer_id"" WHERE ""T"".""most_recent""<=3 ORDER BY ""C"".""name"",""T"".""customer_id"",""T"".""order_date"" DESC"
22,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
23,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) AS ""tmp"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
24,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""A"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
25,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" USING (""customer_id"") WHERE ""rnk""<=3 GROUP BY 1,2,3 ORDER BY 1,2,4 DESC"
26,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
27,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 AND ""order_id"" IS NOT NULL ORDER BY 1,2,4 DESC"
28,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""cte"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""c"" JOIN ""cte"" USING (""customer_id"") WHERE ""RNK""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
29,"WITH ""t"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_o"" FROM ""Orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""c"" JOIN ""t"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rank_o""<4 ORDER BY 1,2,4 DESC"
30,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""dr"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""dr""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
31,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""a"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
32,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"") AS ""tmp"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
33,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"") AS ""tmp"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
34,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""r""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""t"".""order_date"" DESC"
35,"SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""the_rank"" FROM ""Orders"") AS ""a"" WHERE ""the_rank""<=3) AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" ORDER BY ""b"".""name"",""a"".""customer_id"",""order_date"" DESC"
36,"WITH ""most_recent"" AS (SELECT ""a"".""name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""b"".""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""most_recent"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
37,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""customers"" AS ""c"" JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""Ranks"" FROM ""orders"") AS ""a"" ON ""c"".""customer_id""=""a"".""customer_id"" WHERE ""ranks""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
38,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""customers"" USING (""customer_id"") WHERE ""ranking""<=3 ORDER BY 1,2,4 DESC"
39,"WITH ""tmp"" AS (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"" FROM ""tmp"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""rk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
40,"WITH ""ordered_orders"" AS (SELECT ""o"".*,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""row_n"" FROM ""orders"" AS ""o"") SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""ordered_orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""row_n""<=3 ORDER BY 1,2,4 DESC"
41,"WITH ""OrderRanking"" AS (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""Rk"" FROM ""Orders"") SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"",""OdR"".""order_id"",""OdR"".""order_date"" FROM ""Customers"" AS ""C"" JOIN ""OrderRanking"" AS ""OdR"" ON ""Odr"".""customer_id""=""C"".""customer_id"" AND ""Rk""<=3 ORDER BY 1,2,4 DESC"
42,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"") AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""rn""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
43,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
44,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""order_rank"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""ranked_orders"" WHERE ""order_rank""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
45,"WITH ""cte"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
46,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""c"".""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""s"" WHERE ""rnk""<4 ORDER BY 1,2,4 DESC"
47,"WITH ""t"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
48,"SELECT ""NAME"" AS ""CUSTOMER_NAME"",""CUSTOMER_ID"",""ORDER_ID"",""ORDER_DATE"" FROM (SELECT ""C"".""NAME"",""C"".""CUSTOMER_ID"",""O"".""ORDER_ID"",""O"".""ORDER_DATE"",RANK() OVER (PARTITION BY ""O"".""CUSTOMER_ID"" ORDER BY ""O"".""ORDER_DATE"" DESC) AS ""ORD_RANK"" FROM (""ORDERS"" AS ""O"") CROSS JOIN ""CUSTOMERS"" AS ""C"" WHERE ""O"".""CUSTOMER_ID""=""C"".""CUSTOMER_ID"") AS ""X"" WHERE ""X"".""ORD_RANK""<=3 ORDER BY ""NAME"",""CUSTOMER_ID"",""ORDER_DATE"" DESC"
49,"SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"" FROM ""customers"" AS ""a"" JOIN (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""b"" USING (""customer_id"") WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
50,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ordrank"" FROM ""orders"") AS ""o"" USING (""customer_id"") WHERE ""ordrank""<=3 ORDER BY ""customer_name"",""o"".""customer_id"",""o"".""order_date"" DESC"
51,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""reverse_order_index"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_index"",COUNT(1) OVER (PARTITION BY ""customer_id"") AS ""num_orders"" FROM ""orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE NOT (""order_index""=1 AND ""num_orders"">3)) AS ""b"" WHERE ""reverse_order_index""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
52,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""p1"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
53,"WITH ""cust_rank"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cust_rank"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
54,"SELECT ""A"".""customer_name"",""A"".""customer_id"",""A"".""order_id"",""A"".""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rank_date"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""A"" WHERE ""A"".""rank_date""<=3 ORDER BY ""A"".""customer_name"",""A"".""customer_id"",""A"".""order_date"" DESC"
55,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""r"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
56,"WITH ""table1"" AS (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""table1"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
57,"SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""hr"" FROM ""Orders"" GROUP BY 1,2,3) AS ""a"" JOIN ""Customers"" AS ""b"" USING (""customer_id"") WHERE ""hr""<=3 ORDER BY 1,2,""a"".""order_date"" DESC"
58,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""customers"" AS ""c"" JOIN (SELECT RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC,""order_id"") AS ""rown"",""customer_id"",""order_date"",""order_id"",""cost"" FROM ""orders"") AS ""t"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""rown""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""t"".""order_date"" DESC"
59,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""customers"" AS ""c"" LEFT JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""t"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY 1,""customer_id"",""order_date"" DESC"
60,"WITH ""cte"" AS (SELECT ""orders"".""customer_id"",""orders"".""order_id"",""orders"".""order_date"",RANK() OVER (PARTITION BY ""orders"".""customer_id"" ORDER BY ""orders"".""order_date"" DESC) AS ""rnk"",""Customers"".""name"" AS ""customer_name"" FROM ""orders"" JOIN ""Customers"" ON ""customers"".""customer_id""=""orders"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY 1,2,""order_date"" DESC"
61,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk_order"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""rnk_order""<=3 ORDER BY 1,2,4 DESC"
62,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""orders"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rownum"" FROM ""orders"" LEFT JOIN ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"") AS ""a"" WHERE ""rownum""<=3 ORDER BY 1,2,4 DESC"
63,"WITH ""all_orders"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranking"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""all_orders"" WHERE ""ranking""<4 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
64,"SELECT ""b"".""name"" AS ""customer_name"",""a"".* FROM (SELECT ""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""T"" WHERE ""rk""<=3) AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
65,"SELECT ""t"".""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""t"".""rnk""<=3 ORDER BY ""t"".""customer_name"",""t"".""customer_id"",""t"".""order_date"" DESC"
66,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
67,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""seq"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""x"" WHERE ""seq""<4 ORDER BY 1,2,4 DESC"
68,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""tab"".""order_id"" AS ""order_id"",""tab"".""order_date"" AS ""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"") AS ""tab"" ON ""c"".""customer_id""=""tab"".""customer_id"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
69,"WITH ""RankedOrders"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""OrderRank"" FROM ""Orders"") SELECT ""Customers"".""name"" AS ""customer_name"",""RankedOrders"".""customer_id"",""RankedOrders"".""order_id"",""RankedOrders"".""order_date"" FROM ""RankedOrders"" JOIN ""Customers"" ON ""Customers"".""customer_id""=""RankedOrders"".""customer_id"" WHERE ""OrderRank""<=3 ORDER BY 1,2,4 DESC"
70,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""Customers"" JOIN ""Orders"" USING (""customer_id"")) AS ""temp"" WHERE ""ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
71,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""a"".""r""<=3 ORDER BY 1,2,4 DESC"
72,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"" AS ""customer_name"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT *,COUNT(""order_id"") OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""cte"") AS ""tmp"" WHERE ""order_rank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
73,"WITH ""t"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""orank"" FROM ""customers"" AS ""c"" RIGHT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""orank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
74,"WITH ""cte"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_date"",""o"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" ORDER BY 1,2,3 DESC) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<=3"
75,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2,4 ORDER BY 1,2,4 DESC) AS ""result"" WHERE ""rnk""<4"
76,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") WHERE ""rnk"" BETWEEN 1 AND 3 ORDER BY 1,2,4 DESC"
77,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" RIGHT JOIN (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""rnk""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
78,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
79,"SELECT ""t"".""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""t"".""rnk""<=3 ORDER BY ""t"".""customer_name"",""t"".""customer_id"",""t"".""order_date"" DESC"
80,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM (SELECT ""order_id"",""customer_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""row_num"" FROM ""Orders"") AS ""r"" JOIN ""Customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" WHERE ""r"".""row_num""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""r"".""order_date"" DESC"
81,"WITH ""x"" AS (SELECT ""o"".*,""name"",ROW_NUMBER() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""x"" WHERE ""rn""<=3 ORDER BY 1,2,4 DESC"
82,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""<=3 ORDER BY 1,2,4 DESC"
83,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""customers"" AS ""c"" LEFT JOIN (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""orders"") AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""order_rank""<=3 ORDER BY ""name"",""c"".""customer_id"",""order_date"" DESC"
84,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""Orders"".*,""Customers"".""name"",RANK() OVER (PARTITION BY ""Orders"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM (""Orders"") CROSS JOIN ""Customers"" WHERE ""Orders"".""customer_id""=""Customers"".""customer_id"") AS ""t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
85,"WITH ""CTE"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""CTE"".""order_id"",""CTE"".""order_date"" FROM ""Customers"" AS ""c"" JOIN ""CTE"" ON ""c"".""customer_id""=""CTE"".""customer_id"" WHERE ""CTE"".""rk"" BETWEEN 1 AND 3 ORDER BY ""c"".""name"",""c"".""customer_id"",""CTE"".""order_date"" DESC"
86,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""cusinfo"".""name"" AS ""customer_name"",""ord"".""customer_id"",""ord"".""order_id"",""ord"".""order_date"",RANK() OVER (PARTITION BY ""ord"".""customer_id"" ORDER BY ""ord"".""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""ord"" LEFT JOIN ""Customers"" AS ""cusinfo"" ON ""ord"".""customer_id""=""cusinfo"".""customer_id"") AS ""tmp"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
87,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
88,"SELECT ""c"".""name"" AS ""customer_name"",""r"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"") AS ""r"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""r"".""customer_id"" WHERE ""r"".""ranking""<=3 ORDER BY ""c"".""name"",""r"".""customer_id"",""r"".""order_date"" DESC"
89,"WITH ""cust_rank"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cust_rank"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
90,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranks"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
91,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o1"".""order_id"",""o1"".""customer_id"",""o1"".""order_date"" FROM ""Orders"" AS ""o1"" JOIN ""Orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<=""o2"".""order_date"" GROUP BY ""o1"".""order_id"" HAVING COUNT(""o2"".""order_id"")<=3) AS ""a"" JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" ORDER BY ""customer_name"",""c"".""customer_id"",""order_date"" DESC"
92,"WITH ""tmp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"" NATURAL CROSS JOIN ""customers"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""tmp"" WHERE ""rn""<=3 ORDER BY 1,2,4 DESC"
93,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC,""order_id"") AS ""rnk"" FROM ""Orders"") SELECT ""name"" AS ""customer_name"",""cte"".""customer_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""cte"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
94,"WITH ""CTE"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""CTE"" WHERE ""RNK""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
95,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
96,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""cte"".""order_id"",""cte"".""order_date"" FROM ""customers"" AS ""c"" JOIN ""cte"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""ranking""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""cte"".""order_date"" DESC"
97,"WITH ""CTE1"" AS (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rks"" FROM ""Orders""), ""CTE2"" AS (SELECT ""order_id"",""customer_id"",""order_date"" FROM ""CTE1"" WHERE ""rks""<=3) SELECT ""name"" AS ""customer_name"",""CTE2"".""customer_id"",""order_id"",""order_date"" FROM ""CTE2"" JOIN ""Customers"" ON ""Customers"".""customer_id""=""CTE2"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
98,"WITH ""a"" AS (SELECT ""order_id"",""order_date"",""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ct"" FROM ""ORDERS""), ""b"" AS (SELECT * FROM ""a"" WHERE ""ct""<4) SELECT ""Customers"".""name"" AS ""customer_name"",""b"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM ""b"" JOIN ""Customers"" ON ""b"".""customer_id""=""Customers"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
99,"WITH ""t"" AS (SELECT ""name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
100,"SELECT ""name"" AS ""customer_name"",""f"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranked"" FROM ""orders"") AS ""f"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""f"".""customer_id"" WHERE ""f"".""ranked""<=3 ORDER BY 1,2,4 DESC"
101,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""c"".""name"" AS ""customer_name"",""o"".""order_date"",""o"".""order_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
102,"WITH ""a"" AS (SELECT ""customer_id"",""order_id"",""order_date"",(RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC)) AS ""nr"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""a"" JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a"".""nr""<=3 ORDER BY 1,2,4 DESC"
103,"WITH ""RecentOrders"" AS (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""Rk"" FROM ""Orders"") SELECT ""C"".""name"" AS ""customer_name"",""RO"".""customer_id"",""RO"".""order_id"",""RO"".""order_date"" FROM ""RecentOrders"" AS ""RO"" JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""RO"".""customer_id"" WHERE ""Rk""<=3 ORDER BY 1,2,4 DESC"
104,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
105,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_date_rank"" FROM (""Customers"" AS ""c"") CROSS JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"") AS ""tmp"" WHERE ""order_date_rank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
106,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""C"" JOIN (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Orders"") AS ""O"" USING (""customer_id"") WHERE ""RNK""<=3 ORDER BY 1,2,4 DESC"
107,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""cust"".""name"",""ord"".""customer_id"",""ord"".""order_id"",""ord"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM (""Orders"" AS ""ord"") CROSS JOIN ""Customers"" AS ""cust"" WHERE ""cust"".""customer_id""=""ord"".""customer_id"") AS ""a"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
108,"WITH ""cte"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_date"",""o"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" ORDER BY 1,2,3 DESC) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<=3"
109,"WITH ""customer_recent"" AS (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnks"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""cr"".""customer_id"",""order_id"",""order_date"" FROM ""customer_recent"" AS ""cr"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""cr"".""customer_id"" WHERE ""rnks""<=3 ORDER BY 1,2,4 DESC"
110,"WITH ""CTE"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""CTE"" AS ""a"" JOIN ""customers"" AS ""b"" USING (""customer_id"") WHERE ""a"".""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
111,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""c_rank"",'3' AS ""num_set"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""A"" WHERE ""num_set""-""c_rank"">=0 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
112,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" RIGHT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t1"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
113,"SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",DATE(""order_date"") AS ""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") AS ""a"" JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""rk""<=3 ORDER BY ""name"",""a"".""customer_id"",""order_date"" DESC"
114,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""recent""<=3 ORDER BY ""customer_name"",""t"".""customer_id"",""order_date"" DESC"
115,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""o"".""customer_id"",""name"" AS ""customer_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rnk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
116,"WITH ""order_ranking"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""order_ranking"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""rn""<=3 ORDER BY ""c"".""name"",""customer_id"",""order_date"" DESC"
117,"SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranked"" FROM ""Orders"") AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""ranked""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
118,"SELECT ""a"".""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranking"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""a"".""ranking""<=3 ORDER BY ""a"".""customer_name"",""a"".""customer_id"",""a"".""order_date"" DESC"
119,"WITH ""t"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""dr"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""dr""<=3 ORDER BY 1,2,4 DESC"
120,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
121,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank1"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""rank1""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
122,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) AS ""t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
123,"WITH ""TEMP"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""row_num"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""TEMP"" WHERE ""row_num""='1' OR ""row_num""='2' OR ""row_num""='3' ORDER BY 1,2,4 DESC"
124,"WITH ""CTE"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""CTE"".""order_id"",""CTE"".""order_date"" FROM ""Customers"" AS ""c"" JOIN ""CTE"" ON ""c"".""customer_id""=""CTE"".""customer_id"" WHERE ""CTE"".""rk"" BETWEEN 1 AND 3 ORDER BY ""c"".""name"",""c"".""customer_id"",""CTE"".""order_date"" DESC"
125,"WITH ""main"" AS (SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" USING (""customer_id"")) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""main"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
126,"WITH ""x"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""x"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
127,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""A"".""name"" AS ""customer_name"",""A"".""customer_id"",""B"".""order_id"",""B"".""order_date"",RANK() OVER (PARTITION BY ""A"".""customer_id"" ORDER BY ""B"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""A"" JOIN ""Orders"" AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC) AS ""sub"" WHERE ""sub"".""rnk""<=3"
128,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""tmp"" WHERE ""tmp"".""rnk""<=3 ORDER BY 1,2,4 DESC"
129,"WITH ""x"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""x"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
130,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" USING (""customer_id"")) AS ""t"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
131,"WITH ""OrderRanking"" AS (SELECT ""order_id"",""customer_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""Rk"" FROM ""Orders"") SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"",""ORR"".""order_id"",""ORR"".""order_date"" FROM ""Customers"" AS ""C"" JOIN ""OrderRanking"" AS ""ORR"" ON ""ORR"".""customer_id""=""C"".""customer_id"" AND ""ORR"".""Rk""<=3 ORDER BY 1,2,4 DESC"
132,"SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""row_n"" FROM ""Orders"") AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""row_n""<=3 GROUP BY ""b"".""name"",""a"".""customer_id"",""a"".""order_id"" ORDER BY ""b"".""name"",""a"".""customer_id"",""a"".""order_date"" DESC"
133,"WITH ""cte"" AS (SELECT ""c"".""name"",""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
134,"WITH ""cte"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""c"".""name"",""o"".""customer_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk1"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk1""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
135,"SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_r"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""order_r""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
136,"WITH ""CTE"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""CTE"".""order_id"",""CTE"".""order_date"" FROM ""Customers"" AS ""c"" JOIN ""CTE"" ON ""c"".""customer_id""=""CTE"".""customer_id"" WHERE ""CTE"".""rk"" BETWEEN 1 AND 3 ORDER BY ""c"".""name"",""c"".""customer_id"",""CTE"".""order_date"" DESC"
137,"SELECT ""name"" AS ""customer_name"",""f"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranked"" FROM ""orders"") AS ""f"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""f"".""customer_id"" WHERE ""f"".""ranked""<=3 ORDER BY 1,2,4 DESC"
138,"WITH ""etc"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",STR_TO_DATE(""o"".""order_date"", '%Y-%m-%d') AS ""order_date"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id""), ""etc2"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_date"" DESC) AS ""ranking"" FROM ""etc"" AS ""a"") SELECT ""etc2"".""name"" AS ""customer_name"",""etc2"".""customer_id"",""etc2"".""order_id"",""etc2"".""order_date"" FROM ""etc2"" WHERE ""etc2"".""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
139,"WITH ""t1"" AS (SELECT ""o"".*,""c"".""name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t1"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
140,"SELECT ""a"".""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranking"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""a"".""ranking""<=3 ORDER BY ""a"".""customer_name"",""a"".""customer_id"",""a"".""order_date"" DESC"
141,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""Rank_"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""O"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""Rank_""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
142,"WITH ""order_results"" AS (SELECT ""customer_id"",""order_id"",""order_date"",(RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC)) AS ""order_rank"" FROM ""Orders"") SELECT ""Customers"".""name"" AS ""customer_name"",""order_results"".""customer_id"",""order_results"".""order_id"",""order_results"".""order_date"" FROM ""order_results"" JOIN ""Customers"" ON (""order_results"".""customer_id""=""Customers"".""customer_id"") WHERE ""order_results"".""order_rank""<4 ORDER BY ""Customers"".""name"",""order_results"".""customer_id"",""order_results"".""order_date"" DESC"
143,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""orders"".*,""Customers"".""name"",RANK() OVER (PARTITION BY ""orders"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk_o"" FROM (""orders"") CROSS JOIN ""Customers"" WHERE ""orders"".""customer_id""=""Customers"".""customer_id"") AS ""temp"" WHERE ""rk_o""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
144,"WITH ""orders_rnk"" AS (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""customers"" AS ""c"" JOIN ""orders_rnk"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
145,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""c"" WHERE ""r""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
146,"SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""rnk"" IN (1,2,3) ORDER BY ""c"".""name"",""t"".""customer_id"",""t"".""order_date"" DESC"
147,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rk"",""c"".""name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
148,"SELECT ""Customers"".""name"" AS ""customer_name"",""Customers"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") AS ""ranked_orders"" JOIN ""Customers"" ON ""Customers"".""customer_id""=""ranked_orders"".""customer_id"" AND ""ranked_orders"".""order_rank""<=3 ORDER BY ""customer_name"",""Customers"".""customer_id"",""ranked_orders"".""order_rank"""
149,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk"" IN (1,2,3) ORDER BY 1,2,4 DESC"
150,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rr"" FROM ""Orders"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") WHERE ""rr""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
151,"WITH ""cte"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
152,"SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent_order"" FROM ""orders"") AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""recent_order""<=3 ORDER BY ""b"".""name"",""a"".""customer_id"",""a"".""order_date"" DESC"
153,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""a"".""customer_id"",""name"",""cost"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""c"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
154,"SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
155,"WITH ""T"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""R"" FROM ""customers"" AS ""c"" RIGHT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""T"" WHERE ""R""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
156,"SELECT ""name"" AS ""customer_name"",""s"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"") AS ""t"" WHERE ""ranking""<=3) AS ""s"" JOIN ""customers"" ON ""customers"".""customer_id""=""s"".""customer_id"" ORDER BY 1,2,4 DESC"
157,"WITH ""cte_order_seq"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent_order_seq"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte_order_seq"" WHERE ""recent_order_seq""<=3 ORDER BY 1,2,4 DESC"
158,"WITH ""t"" AS (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""serial_num"" FROM ""Orders"") SELECT ""t1"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""t"" LEFT JOIN ""Customers"" AS ""t1"" USING (""customer_id"") WHERE ""serial_num""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
159,"WITH ""filter"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""f"".""customer_id"",""f"".""order_id"",""f"".""order_date"" FROM ""filter"" AS ""f"" JOIN ""Customers"" AS ""c"" ON ""f"".""customer_id""=""c"".""customer_id"" WHERE ""f"".""rnk""<=3 ORDER BY 1,2,4 DESC"
160,"SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",""cost"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""Ranking"" FROM ""Orders"") AS ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""Ranking""<=3 ORDER BY ""c"".""name"",""t"".""customer_id"",""t"".""order_date"" DESC"
161,"WITH ""ranked_orders"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""cost"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" LEFT JOIN ""ranked_orders"" AS ""o"" ON (""o"".""customer_id""=""c"".""customer_id"") WHERE ""o"".""order_rank""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
162,"SELECT ""c"".""name"" AS ""customer_name"",""t2"".""customer_id"",""t2"".""order_id"",""t2"".""order_date"" FROM (SELECT ""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""t"" WHERE ""t"".""rnk""<=3) AS ""t2"" JOIN ""Customers"" AS ""c"" ON ""t2"".""customer_id""=""c"".""customer_id"" ORDER BY ""customer_name"",""t2"".""customer_id"",""t2"".""order_date"" DESC"
163,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""name"",""customer_id"",""order_date"" DESC) AS ""ranking"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC) AS ""A"" WHERE ""ranking""<=3"
164,"WITH ""t"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""r""<=3 ORDER BY 1,2,4 DESC"
165,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""c_rank"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""A"" WHERE ""c_rank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
166,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank1"" FROM ""Orders"") AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""rank1""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
167,"WITH ""CTE"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""cost"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""CTE"" AS ""c"" LEFT JOIN ""customers"" AS ""d"" ON ""c"".""customer_id""=""d"".""customer_id"" WHERE ""rnk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
168,"WITH ""cte"" AS (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
169,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""customers"" AS ""c"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",""cost"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""orders"") AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""order_rank""<4 ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
170,"WITH ""t1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""c"" LEFT JOIN ""t1"" ON ""c"".""customer_id""=""t1"".""customer_id"" WHERE ""rk""<4 ORDER BY 1,2,4 DESC"
171,"WITH ""temp1"" AS (SELECT ""a"".*,""b"".""name"" AS ""customer_name"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp1"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
172,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
173,"WITH ""all_orders"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranking"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""all_orders"" WHERE ""ranking""<4 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
174,"SELECT ""Customers"".""name"" AS ""customer_name"",""sub2"".""customer_id"",""sub2"".""order_id"",""sub2"".""order_date"" FROM ""Customers"" JOIN (SELECT ""sub1"".* FROM (SELECT ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"",""customer_id"",""order_id"",""order_date"" FROM ""Orders"") AS ""sub1"" WHERE ""sub1"".""r""<=3) AS ""sub2"" ON ""Customers"".""customer_id""=""sub2"".""customer_id"" ORDER BY ""Customers"".""name"",""sub2"".""customer_id"",""sub2"".""order_date"" DESC"
175,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""orders"".""customer_id"" AS ""customer_id"",""order_id"" AS ""order_id"",""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" JOIN ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"") AS ""temp"" WHERE ""rnk""=1 OR ""rnk""=2 OR ""rnk""=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
176,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""r""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""t"".""order_date"" DESC"
177,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""Order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""order_rank"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""r"" WHERE ""order_rank""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
178,"SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY 1,""t"".""customer_id"",""order_date"" DESC"
179,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""customers"" AS ""c"" JOIN (SELECT RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC,""order_id"") AS ""rown"",""customer_id"",""order_date"",""order_id"",""cost"" FROM ""orders"") AS ""t"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""rown""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""t"".""order_date"" DESC"
180,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"") AS ""tmp"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
181,"WITH ""table1"" AS (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""table1"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
182,"WITH ""t1"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"")) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t1"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
183,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"" AS ""customer_id"",""O"".""order_id"" AS ""order_id"",""O"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""C"".""customer_id"" ORDER BY ""O"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") AS ""Temp"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
184,"WITH ""temp"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""temp"" AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""c"".""name"",""t"".""customer_id"",""t"".""order_date"" DESC"
185,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""Orders"") SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""cte"" AS ""a"" JOIN ""Customers"" AS ""b"" ON (""a"".""customer_id""=""b"".""customer_id"") WHERE ""r""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
186,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM (""customers"" AS ""c"") CROSS JOIN (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""rk""<=3 ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
187,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""cc"".""name"" AS ""customer_name"",""c"".""customer_id"",""c"".""order_id"",""c"".""order_date"" FROM ""cte"" AS ""c"" JOIN ""Customers"" AS ""cc"" ON ""cc"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
188,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank1"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""rank1""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
189,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" ORDER BY ""customer_id"",""order_date"" DESC) AS ""a"" WHERE ""rnk""<4) SELECT ""name"" AS ""customer_name"",""cte"".""customer_id"",""order_id"",""order_date"" FROM ""CTE"" JOIN ""customers"" USING (""customer_id"") ORDER BY ""name"",""customer_id"",""order_date"" DESC"
190,"WITH ""orderRank"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""orderRank"" WHERE ""ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
191,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""order_date_rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""sorted_orders"" WHERE ""order_date_rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
192,"WITH ""helper_rank"" AS (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""helper_rank"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""rank""<4 ORDER BY ""customer_name"",""o"".""customer_id"",""o"".""order_date"" DESC"
193,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""T"" WHERE ""r""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
194,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""CustOrderNumSequece"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") AS ""Orders_Customer_Seq"" WHERE ""CustOrderNumSequece""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
195,"WITH ""c_order"" AS (SELECT ""name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""c_order"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
196,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<""o2"".""order_date"") JOIN ""customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""o1"".""order_id"" HAVING COUNT(""o2"".""order_date"")<=2 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
197,"WITH ""t"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
198,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""order_date"",""o"".""customer_id"",""o"".""order_id"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""tab1"" WHERE ""r""=1 OR ""r""=2 OR ""r""=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
199,"SELECT ""name"" AS ""customer_name"",""cust"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""cust"" JOIN (SELECT ""order_date"",""customer_id"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""temp"" ON ""rnk""<4 AND ""cust"".""customer_id""=""temp"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
200,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""customer_rank"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
201,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) AS ""a"" WHERE ""a"".""rnk""<=3 ORDER BY 1,2,4 DESC"
202,"WITH ""t"" AS (SELECT ""o"".*,(SELECT ""name"" FROM ""Customers"" WHERE ""customer_id""=""o"".""customer_id"") AS ""customer_name"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""row_i"" FROM ""Orders"" AS ""o"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""row_i""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
203,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",""o"".""order_date"",""o"".""order_id"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
204,"WITH ""temp"" AS (SELECT ""order_id"",""order_date"",""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""temp"" JOIN ""customers"" AS ""c"" ON ""temp"".""customer_id""=""c"".""customer_id"" WHERE ""r""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
205,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent_order_rank"" FROM ""Orders"" JOIN ""Customers"" USING (""customer_id"") GROUP BY 1,2,3,4) AS ""base"" WHERE ""recent_order_rank""<=3 ORDER BY 1,2,4 DESC"
206,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM (""t"") CROSS JOIN ""customers"" WHERE ""t"".""customer_id""=""customers"".""customer_id"" AND ""ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
207,"WITH ""T"" AS (SELECT ""customer_id"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING COUNT(""order_id"")<=3), ""G"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""customer_id"" NOT IN (SELECT * FROM ""T"")), ""M"" AS (SELECT ""O"".""order_id"",""O"".""order_date"",""O"".""customer_id"",RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY ""O"".""order_date"" DESC) AS ""r"" FROM ""G"" JOIN ""Orders"" AS ""O"" USING (""customer_id"")), ""A"" AS (SELECT ""O"".""order_id"",""O"".""order_date"",""O"".""customer_id"" FROM ""T"" JOIN ""Orders"" AS ""O"" ON ""T"".""customer_id""=""O"".""customer_id"" UNION SELECT ""M"".""order_id"",""M"".""order_date"",""M"".""customer_id"" FROM ""M"" WHERE ""r""<=3) SELECT ""C"".""name"" AS ""customer_name"",""A"".""customer_id"",""A"".""order_id"",""A"".""order_date"" FROM ""A"" JOIN ""Customers"" AS ""C"" ON ""A"".""customer_id""=""C"".""customer_id"" ORDER BY ""customer_name"",""A"".""customer_id"",""A"".""order_date"" DESC"
208,"WITH ""ranktb"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranknumber"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""ranktb"" JOIN ""Customers"" AS ""c"" ON ""ranktb"".""customer_id""=""c"".""customer_id"" WHERE ""ranknumber""<=3 ORDER BY ""customer_name"",""c"".""customer_id"",""order_date"" DESC"
209,"SELECT ""name"" AS ""customer_name"",""r_ord"".""customer_id"",""r_ord"".""order_id"",""r_ord"".""order_date"" FROM ""Customers"" AS ""cust"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r_cust"" FROM ""orders"") AS ""r_ord"" ON ""cust"".""customer_id""=""r_ord"".""customer_id"" WHERE ""r_cust""<=3 ORDER BY ""name"",""r_ord"".""customer_id"",""r_ord"".""order_date"" DESC"
210,"SELECT ""name"" AS ""customer_name"",""main"".""customer_id"",""main"".""order_id"",""main"".""order_date"" FROM (""orders"" AS ""main"" JOIN ""orders"" AS ""newest"" ON ""main"".""order_date""<=""newest"".""order_date"" AND ""main"".""customer_id""=""newest"".""customer_id"") JOIN ""customers"" ON ""main"".""customer_id""=""customers"".""customer_id"" GROUP BY ""main"".""order_id"" HAVING COUNT(""newest"".""order_id"")<=3 ORDER BY ""customer_name"",""main"".""customer_id"",""main"".""order_date"" DESC"
211,"WITH ""ord"" AS (SELECT ""customer_id"",""order_id"",""order_Date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_Date"" DESC) AS ""r"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_Date"" FROM ""ord"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""r""<=3 ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_Date"" DESC"
212,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""c"") CROSS JOIN (SELECT * FROM (SELECT ""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC,""order_id"") AS ""rn"" FROM ""orders"" AS ""o"") AS ""a"" WHERE ""rn""<=3 ORDER BY ""order_date"") AS ""b"" WHERE ""c"".""customer_id""=""b"".""customer_id"" ORDER BY ""c"".""name"",""customer_id"",""order_date"" DESC"
213,"SELECT ""customers"".""name"" AS ""customer_name"",""customers"".""customer_id"" AS ""customer_id"",""orders"".""order_id"" AS ""order_id"",""orders"".""order_date"" AS ""order_date"" FROM (""Customers"" AS ""customers"" JOIN (SELECT ""order1"".""customer_id"",""order1"".""order_date"",COUNT(DISTINCT ""order2"".""order_date"") AS ""cnt"" FROM ""Orders"" AS ""order1"" JOIN ""Orders"" AS ""order2"" ON ""order1"".""customer_id""=""order2"".""customer_id"" AND ""order1"".""order_date""<=""order2"".""order_date"" GROUP BY ""customer_id"",""order1"".""order_date"" HAVING ""cnt""<=3) AS ""ro"" ON ""customers"".""customer_id""=""ro"".""customer_id"") JOIN ""Orders"" AS ""orders"" ON ""orders"".""customer_id""=""ro"".""customer_id"" AND ""orders"".""order_date""=""ro"".""order_date"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
214,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" USING (""customer_id"") WHERE ""rnk""<=3 GROUP BY 1,2,3 ORDER BY 1,2,4 DESC"
215,"SELECT ""name"" AS ""customer_name"",""u"".""customer_id"",""order_id"",""order_date"" FROM ""customers"" AS ""u"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""orderr"" FROM ""orders"") AS ""o"" ON ""u"".""customer_id""=""o"".""customer_id"" WHERE ""orderr""<4 ORDER BY 1,2,4 DESC"
216,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""O"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranker"" FROM ""customers"" AS ""C"" JOIN ""orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") AS ""T"" WHERE ""ranker""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
217,"WITH ""cte"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_date"",""o"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" ORDER BY 1,2,3 DESC) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<=3"
218,"WITH ""cte_t"" AS (SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte_t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
219,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""CustOrderNumSequece"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") AS ""Orders_Customer_Seq"" WHERE ""CustOrderNumSequece""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
220,"WITH ""t"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
221,"WITH ""rank1"" AS (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_date"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM (""Customers"" AS ""c"") CROSS JOIN ""rank1"" AS ""r"" WHERE ""c"".""customer_id""=""r"".""customer_id"" AND ""r"".""rank_date""<=3 ORDER BY 1,2,4 DESC"
222,"WITH ""result"" AS (SELECT ""customer_id"",""order_date"",""order_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""R"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""r"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM ""result"" AS ""r"" LEFT JOIN ""customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" WHERE ""R""<=3 ORDER BY 1,2,4 DESC"
223,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
224,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""Orders"".*,""Customers"".""name"",RANK() OVER (PARTITION BY ""Orders"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM (""Orders"") CROSS JOIN ""Customers"" WHERE ""Orders"".""customer_id""=""Customers"".""customer_id"") AS ""t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
225,"WITH ""r"" AS (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM ""Customers"" AS ""c"" JOIN ""r"" ON ""c"".""customer_id""=""r"".""customer_id"" WHERE ""r"".""rnk""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""r"".""order_date"" DESC"
226,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" LEFT JOIN ""customers"" USING (""customer_id"")) AS ""a"" WHERE ""rnk""=1 OR ""rnk""=2 OR ""rnk""=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
227,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""ranks""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
228,"SELECT ""c"".""name"" AS ""customer_name"",""t1"".""customer_id"" AS ""customer_id"",""t1"".""order_id"" AS ""order_id"",""t1"".""order_date"" AS ""order_date"" FROM (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_order"" FROM ""Orders"" ORDER BY ""customer_id"") AS ""t1"" LEFT JOIN ""Customers"" AS ""c"" ON ""t1"".""customer_id""=""c"".""customer_id"" WHERE ""t1"".""rank_order""<=3 ORDER BY ""c"".""name"",""t1"".""customer_id"",""t1"".""order_date"" DESC"
229,"SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""nrank"" FROM ""Orders"") AS ""t"" LEFT JOIN ""Customers"" ON ""t"".""customer_id""=""Customers"".""customer_id"" WHERE ""nrank""<=3 ORDER BY 1,2,4 DESC"
230,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""o1"".""customer_id"",""o1"".""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o1"".""customer_id"" ORDER BY ""o1"".""order_date"" DESC) AS ""row_"" FROM ""Orders"" AS ""o1"") AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""row_""<4 ORDER BY ""customer_name"",""c"".""customer_id"",""order_date"" DESC"
231,"SELECT ""p"".""name"" AS ""customer_name"",""p"".""customer_id"",""p"".""order_id"",""p"".""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) AS ""p"" WHERE ""p"".""rk""<=3 ORDER BY ""p"".""name"",""p"".""customer_id"",""p"".""order_date"" DESC"
232,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rank_""<=3 ORDER BY 1,2,4 DESC"
233,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
234,"SELECT ""b"".""name"" AS ""customer_name"",""b"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RK"" FROM ""orders"") AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""RK""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
235,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""CustOrderNumSequece"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") AS ""Orders_Customer_Seq"" WHERE ""CustOrderNumSequece""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
236,"SELECT ""c"".""name"" AS ""customer_name"",""b"".""customer_id"" AS ""customer_id"",""b"".""order_id"" AS ""order_id"",""b"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ran"" FROM ""orders"") AS ""b"" JOIN ""customers"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" WHERE ""b"".""ran""<=3 ORDER BY ""c"".""name"",""b"".""customer_id"",""b"".""order_date"" DESC"
237,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""temp"".""order_id"",""temp"".""order_date"" FROM ""CUstomers"" AS ""c"" JOIN (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""temp"" ON ""c"".""customer_id""=""temp"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""order_date"" DESC"
238,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
239,"SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""hr"" FROM ""Orders"" GROUP BY 1,2,3) AS ""a"" JOIN ""Customers"" AS ""b"" USING (""customer_id"") WHERE ""hr""<=3 ORDER BY 1,2,""a"".""order_date"" DESC"
240,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""aa"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
241,"WITH ""tb1"" AS (SELECT ""customer_id"",""order_date"",""order_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""tb2"".""customer_id"",""tb2"".""order_id"",""tb2"".""order_date"" FROM (SELECT * FROM ""tb1"" WHERE ""rnk""<=3) AS ""tb2"" LEFT JOIN ""Customers"" AS ""c"" ON ""tb2"".""customer_id""=""c"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
242,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""RNK""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
243,"WITH ""t1"" AS (SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""b"".""customer_ID"" ORDER BY ""name"",""a"".""customer_id"",""order_date"" DESC) AS ""rn"" FROM ""customers"" AS ""a"" RIGHT JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t1"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
244,"WITH ""tmp"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""tmp"".""order_id"",""tmp"".""order_date"" FROM ""Customers"" AS ""c"" LEFT JOIN ""tmp"" ON ""c"".""customer_id""=""tmp"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""order_date"" DESC"
245,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""a"".""rnk""<4 ORDER BY ""a"".""name"",""a"".""customer_id"",""a"".""order_date"" DESC"
246,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"" JOIN ""Customers"" USING (""customer_id"")) AS ""temp"" WHERE ""order_rank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
247,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
248,"WITH ""temp"" AS (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""temp"" AS ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""order_rk""<=3 ORDER BY ""c"".""name"",""t"".""customer_id"",""t"".""order_date"" DESC"
249,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""r""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
250,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranking"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""r"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
251,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""t"" WHERE ""t"".""rnk""=1 OR ""t"".""rnk""=2 OR ""t"".""rnk""=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
252,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""t"".""r""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
253,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ran"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""ran""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
254,"SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o1"".""customer_id"",""o1"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"",""o1"".""order_date"" FROM ""Orders"" AS ""o1"" LEFT JOIN ""Orders"" AS ""o2"" ON ""o1"".""order_date"">=""o2"".""order_date"" GROUP BY ""o1"".""customer_id"",""o1"".""order_date"") AS ""a"" LEFT JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""r""<=3 ORDER BY 1,2,4 DESC"
255,"SELECT ""C"".""name"" AS ""customer_name"",""A"".""customer_id"",""A"".""order_id"",""A"".""order_date"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recentOrder"" FROM ""Orders"") AS ""A"" JOIN ""Customers"" AS ""C"" ON ""A"".""customer_id""=""C"".""customer_id"" WHERE ""recentOrder"" BETWEEN 1 AND 3 ORDER BY ""C"".""name"",""A"".""customer_id"",""A"".""order_date"" DESC"
256,"SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
257,"SELECT ""c"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"") AS ""a"" JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""a"".""rn""<=3 ORDER BY 1,2,4 DESC"
258,"WITH ""cte"" AS (SELECT ""name"" AS ""customer_name"",""orders"".""customer_id"",""orders"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"",""orders"".""order_date"" FROM ""orders"" LEFT JOIN ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
259,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<""o2"".""order_date"") JOIN ""customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""c"".""name"",""o1"".""order_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=2 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
260,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o1"" ON ""c"".""customer_id""=""o1"".""customer_id"") JOIN ""Orders"" AS ""o2"" ON (""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<=""o2"".""order_date"") GROUP BY ""c"".""customer_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
261,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" USING (""customer_id"")) AS ""t"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
262,"WITH ""CTE"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""CTE"" AS ""a"" JOIN ""customers"" AS ""b"" USING (""customer_id"") WHERE ""a"".""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
263,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rown"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""ord"" WHERE ""rown""<4 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
264,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""C"".""name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""CustOrderNumSequece"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" USING (""customer_id"")) AS ""Orders_Customer_Seq"" WHERE ""CustOrderNumSequece""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
265,"WITH ""cte"" AS (SELECT ""a"".*,""b"".""name"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_order_date"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" GROUP BY ""customer_id"" HAVING MAX(""rank_order_date"")<3) UNION SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" GROUP BY ""customer_id"" HAVING MAX(""rank_order_date"")>=3) AND ""rank_order_date""<=3) AS ""temp"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
266,"SELECT DISTINCT ""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent_order_rank"" FROM ""Orders"" ORDER BY ""customer_id"",""order_date"" DESC) AS ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""recent_order_rank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
267,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""c"".""name"" AS ""customer_name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
268,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""r""<4 ORDER BY 1,2,4 DESC"
269,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""order_id"",""order_date"",""c"".""name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""ranks""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
270,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) AS ""sub"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
271,"WITH ""orders_rnked"" AS (SELECT ""o"".*,""c"".""name"" AS ""customer_name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""dt_rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""orders_rnked"" WHERE ""dt_rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
272,"SELECT ""name"" AS ""customer_name"",""T"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Orders"") AS ""T"" JOIN ""Customers"" AS ""C"" ON ""T"".""customer_id""=""C"".""customer_id"" WHERE ""RNK""<=3 ORDER BY ""customer_name"",""T"".""customer_id"",""order_date"" DESC"
273,"SELECT ""c1"".""name"" AS ""customer_name"",""c1"".""customer_id"",""c1"".""order_id"",""c1"".""order_date"" FROM (SELECT ""name"",""order_id"",""order_date"",""o"".""customer_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""c1"" WHERE ""c1"".""order_rank""<4 ORDER BY ""c1"".""name"",""c1"".""customer_id"",""c1"".""order_date"" DESC"
274,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"" AS ""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""customers"" AS ""c"" RIGHT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""a"".""r""<=3 ORDER BY 1,2,4 DESC"
275,"WITH ""t"" AS (SELECT ""order_id"" AS ""ori"",""order_date"" AS ""ord"",""customer_id"" AS ""cus"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ran"" FROM ""orders"" AS ""o"") SELECT ""c"".""name"" AS ""customer_name"",""t"".""cus"" AS ""customer_id"",""t"".""ori"" AS ""order_id"",""t"".""ord"" AS ""order_date"" FROM ""customers"" AS ""c"" JOIN ""t"" ON ""c"".""customer_id""=""t"".""cus"" WHERE ""t"".""ran""<4 ORDER BY ""c"".""name"",""t"".""cus"",""t"".""ord"" DESC"
276,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""a"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" USING (""customer_id"")) AS ""t"" WHERE ""ranks""<=3 ORDER BY 1,2,4 DESC"
277,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""d2"".""name"",""d1"".""customer_id"",""d1"".""order_id"",""d1"".""order_date"",RANK() OVER (PARTITION BY ""d1"".""customer_id"" ORDER BY ""d1"".""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""d1"" JOIN ""Customers"" AS ""d2"" ON ""d1"".""customer_id""=""d2"".""customer_id"") AS ""sub"" WHERE ""ranking"" IN (1,2,3) ORDER BY 1,2,4 DESC"
278,"SELECT ""t1"".""name"" AS ""customer_name"",""t1"".""customer_id"",""t2"".""order_id"",""t2"".""order_date"" FROM ""Customers"" AS ""t1"" LEFT JOIN (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
279,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""date_rank"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2,4 ORDER BY 1,2,4 DESC) AS ""result_table"" WHERE ""date_rank""<4"
280,"SELECT ""C"".""NAME"" AS ""CUSTOMER_NAME"",""C"".""CUSTOMER_ID"",""ORDER_ID"",""ORDER_DATE"" FROM (SELECT ""CUSTOMER_ID"",""ORDER_ID"",""ORDER_DATE"",ROW_NUMBER() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""ORDER_DATE"" DESC) AS ""RO"" FROM ""ORDERS"") AS ""O"" JOIN ""CUSTOMERS"" AS ""C"" ON ""O"".""CUSTOMER_ID""=""C"".""CUSTOMER_ID"" WHERE ""RO""<4 ORDER BY ""C"".""NAME"",""C"".""CUSTOMER_ID"",""ORDER_DATE"" DESC"
281,"WITH ""ranked"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rn"" FROM ""orders""), ""top_orders"" AS (SELECT ""customer_id"",""order_id"",""order_date"" FROM ""ranked"" WHERE ""order_rn""<=3) SELECT ""c"".""name"" AS ""customer_name"",""r"".""customer_id"",""r"".""order_id"",""r"".""order_date"" FROM ""top_orders"" AS ""r"" JOIN ""customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" ORDER BY ""c"".""name"",""r"".""customer_id"",""r"".""order_date"" DESC"
282,"WITH ""O"" AS (SELECT ""order_id"",""order_date"",""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"") SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"",""O"".""order_id"",""O"".""order_date"" FROM ""Customers"" AS ""C"" JOIN ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" WHERE ""O"".""rn""<=3 ORDER BY ""C"".""name"",""C"".""customer_id"",""O"".""order_date"" DESC"
283,"WITH ""t1"" AS (SELECT ""a"".""customer_id"",""name"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t1"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
284,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ((SELECT ""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_date_rank"" FROM ""Orders"") AS ""order_date_ranks"" JOIN ""Orders"" AS ""o"" ON ""order_date_ranks"".""order_id""=""o"".""order_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""order_date_rank""<=3 ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
285,"WITH ""cte"" AS (SELECT ""order_id"",""order_date"",""o"".""customer_id"",""c"".""name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"",COUNT(""order_id"") OVER (PARTITION BY ""o"".""customer_id"") AS ""cnt"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
286,"SELECT ""cust"".""name"" AS ""customer_name"",""cust"".""customer_id"" AS ""customer_id"",""ord"".""order_id"" AS ""order_id"",""ord"".""order_date"" AS ""order_date"" FROM ""Customers"" AS ""cust"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""ord"" ON ""cust"".""customer_id""=""ord"".""customer_id"" WHERE ""ord"".""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
287,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""z"" WHERE ""rnk"" IN (1,2,3) ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
288,"WITH ""t"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""rnk""<=3 ORDER BY ""customer_name"",""t"".""customer_id"",""t"".""order_date"" DESC"
289,"WITH ""t"" AS (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM ""customers"" AS ""c"" JOIN ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" AND ""r""<=3 ORDER BY 1,2,4 DESC"
290,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""customer_id"",""order_id"",""order_date"",""ranks"",MAX(""ranks"") OVER (PARTITION BY ""customer_id"") AS ""max_rank"" FROM (SELECT ""name"",""a"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranks"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" USING (""customer_id"")) AS ""t1"") AS ""t2"" WHERE (CASE WHEN ""max_rank""<=3 THEN ""ranks""<=""max_rank"" ELSE ""ranks""<=""max_rank"" AND ""ranks"">""max_rank""-3 END) ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
291,"WITH ""temp"" AS (SELECT ""name"",""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Customers"" JOIN ""Orders"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
292,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""name"", ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_"" FROM (""customers"" AS ""c"") CROSS JOIN ""orders"" AS ""o"" WHERE ""o"".""customer_id""=""c"".""customer_id"") AS ""A"" WHERE ""rank_""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
293,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""a"".""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
294,"WITH ""t"" AS (SELECT ""order_id"",""order_date"",""o"".""customer_id"",""name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
295,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""C"".""name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""CustOrderNumSequece"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" USING (""customer_id"")) AS ""Orders_Customer_Seq"" WHERE ""CustOrderNumSequece""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
296,"SELECT ""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<=""o2"".""order_date"") JOIN ""customers"" ON ""o1"".""customer_id""=""customers"".""customer_id"" GROUP BY ""o1"".""order_id"",""o1"".""order_date"",""o1"".""customer_id"" HAVING COUNT(""o2"".""order_date"")<=3 ORDER BY ""customer_name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
297,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""customers"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"") AS ""t"" USING (""customer_id"") WHERE ""ranking""<=3 ORDER BY 1,2,4 DESC"
298,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",""c"".""name"" AS ""customer_name"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""holder"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""temp"" WHERE ""holder""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
299,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" RIGHT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t1"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
300,"WITH ""tmp"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" ORDER BY ""order_date"" DESC) SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""tmp"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""o"".""customer_id"",""o"".""order_date"" DESC"
301,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""Orders"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_num"" FROM ""Orders"" LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") AS ""tbl"" WHERE ""rank_num""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
302,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
303,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""Orders"" AS ""o1"" JOIN ""Orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<=""o2"".""order_date"") JOIN ""Customers"" AS ""C"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=3 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
304,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE 3>(SELECT COUNT(""t"".""order_date"") FROM ""orders"" AS ""t"" WHERE ""o"".""order_date""<""t"".""order_date"" AND ""o"".""customer_id""=""t"".""customer_id"") ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
305,"WITH ""C"" AS (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM (""Orders"" AS ""o"") CROSS JOIN ""Customers"" AS ""c"" WHERE ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""C"" WHERE ""rk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
306,"WITH ""cte"" AS (SELECT ""order_date"",""customer_id"",""order_id"" FROM (SELECT ""order_date"",""customer_id"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""temp"" WHERE ""rnk""<4) SELECT ""name"" AS ""customer_name"",""cust"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""cust"" JOIN ""cte"" ON ""cust"".""customer_id""=""cte"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
307,"SELECT ""c"".""name"" AS ""customer_name"",""b"".""customer_id"" AS ""customer_id"",""b"".""order_id"" AS ""order_id"",""b"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ran"" FROM ""orders"") AS ""b"" JOIN ""customers"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" WHERE ""b"".""ran""<=3 ORDER BY ""c"".""name"",""b"".""customer_id"",""b"".""order_date"" DESC"
308,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"" AS ""customer_id"",""order_id"",""order_date"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
309,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
310,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
311,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rank1"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""xx"" WHERE ""rank1""<4 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
312,"SELECT ""b"".""name"" AS ""customer_name"",""b"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rownums"" FROM ""orders"") AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""rownums""<4 ORDER BY ""customer_name"",""b"".""customer_id"",""order_date"" DESC"
313,"WITH ""temp"" AS (SELECT ""customers"".""name"",""customers"".""customer_id"",""order_id"",""orders"".""order_date"",RANK() OVER (PARTITION BY ""orders"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"",COUNT(""order_id"") OVER (PARTITION BY ""orders"".""customer_id"") AS ""num_orders"" FROM ""customers"" JOIN ""orders"" ON ""customers"".""customer_id""=""orders"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""ranking"" BETWEEN 1 AND 3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
314,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
315,"SELECT ""name"" AS ""Customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""x"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
316,"WITH ""cte"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
317,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
318,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""temp"".""order_id"",""temp"".""order_date"" FROM ""CUstomers"" AS ""c"" JOIN (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""temp"" ON ""c"".""customer_id""=""temp"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""order_date"" DESC"
319,"WITH ""tb1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rw"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""tb1"".""customer_id"",""tb1"".""order_id"",""tb1"".""order_date"" FROM ""tb1"" JOIN ""customers"" AS ""c"" ON ""tb1"".""customer_id""=""c"".""customer_id"" WHERE ""rw""<=3 ORDER BY ""c"".""name"",""tb1"".""customer_id"",""order_date"" DESC"
320,"SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM (""orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""orders"" AS ""o1"" ON ""o"".""customer_id""=""o1"".""customer_id"" AND ""o1"".""order_date"">=""o"".""order_date"" GROUP BY ""o"".""customer_id"",""o"".""order_date"" HAVING COUNT(DISTINCT ""o1"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
321,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"") ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC) AS ""a"" WHERE ""rnk""<=3"
322,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
323,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_num"" FROM ""orders"") AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""order_num""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
324,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""a"" ON ""a"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
325,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""CustOrderNumSequece"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" USING (""customer_id"")) AS ""Orders_Customer_Seq"" WHERE ""CustOrderNumSequece""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
326,"SELECT ""t1"".""name"" AS ""Customer_name"",""t1"".""customer_id"",""t1"".""order_id"",""t1"".""order_date"" FROM (SELECT ""C"".""Customer_id"",""C"".""name"",""O"".""Order_date"",""O"".""order_id"",RANK() OVER (PARTITION BY ""C"".""customer_id"" ORDER BY ""O"".""Order_date"" DESC) AS ""Order_rank"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""O"".""Customer_id""=""C"".""Customer_id"") AS ""t1"" WHERE ""t1"".""Order_rank""<=3 ORDER BY ""t1"".""name"",""t1"".""customer_id"",""t1"".""order_date"" DESC"
327,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o1"" ON ""c"".""customer_id""=""o1"".""customer_id"") JOIN ""Orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<=""o2"".""order_date"" GROUP BY ""c"".""name"",""c"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""o1"".""order_date"" DESC"
328,"WITH ""cte_t"" AS (SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte_t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
329,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""temp"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
330,"SELECT ""name"" AS ""customer_name"",""new"".""customer_id"",""new"".""order_id"",""new"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"") AS ""new"" JOIN ""customers"" AS ""c"" ON ""new"".""customer_id""=""c"".""customer_id"" WHERE ""ranks"" IN (1,2,3) ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
331,"WITH ""t"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" AND ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
332,"SELECT ""sub"".""name"" AS ""customer_name"",""sub"".""customer_id"",""sub"".""order_id"",""sub"".""order_date"" FROM (SELECT ""name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" LEFT JOIN ""Customers"" USING (""customer_id"")) AS ""sub"" WHERE ""sub"".""rnk""<=3 ORDER BY 1,2,4 DESC"
333,"WITH ""sub"" AS (SELECT ""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""order_id"" IN (SELECT ""order_id"" FROM ""sub"" WHERE ""order_rank""<=3) ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
334,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn_c"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""ct"".""customer_id"",""ct"".""order_id"",""ct"".""order_date"" FROM ""cte"" AS ""ct"" JOIN ""Customers"" AS ""c"" ON ""ct"".""customer_id""=""c"".""customer_id"" WHERE ""rn_c""<=3 ORDER BY ""c"".""name"",""ct"".""customer_id"",""ct"".""order_date"" DESC"
335,"SELECT ""name"" AS ""customer_name"",""temp"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") AS ""temp"" JOIN ""customers"" ON ""temp"".""customer_id""=""customers"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
336,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE (SELECT COUNT(1) FROM ""Orders"" AS ""c"" WHERE ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<""c"".""order_date"")<=2 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
337,"SELECT ""name"" AS ""customer_name"",""r"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranked"" FROM ""Orders"") AS ""r"" JOIN ""Customers"" ON ""r"".""customer_id""=""Customers"".""customer_id"" WHERE ""ranked""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
338,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""num"" FROM ""ORDERS"") AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""num""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
339,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE (SELECT COUNT(""order_id"") FROM ""Orders"" AS ""c"" WHERE ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
340,"WITH ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""date_rnk"" FROM ""orders"") SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""t1"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""date_rnk""<4 ORDER BY 1,2,4 DESC"
341,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""order_date"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN (SELECT ""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""o_rank"" FROM ""orders"") AS ""r"" ON ""r"".""order_id""=""o"".""order_id"" WHERE ""o_rank""<=3 ORDER BY 1,2,4 DESC"
342,"WITH ""CUST_ORDER"" AS (SELECT ""C"".""NAME"" AS ""CUSTOMER_NAME"",""C"".""CUSTOMER_ID"",""O"".""ORDER_ID"",""O"".""ORDER_DATE"",RANK() OVER (PARTITION BY ""C"".""CUSTOMER_ID"" ORDER BY ""ORDER_DATE"" DESC) AS ""RN"" FROM ""CUSTOMERS"" AS ""C"" JOIN ""ORDERS"" AS ""O"" ON ""C"".""CUSTOMER_ID""=""O"".""CUSTOMER_ID"") SELECT ""CUSTOMER_NAME"",""CUSTOMER_ID"",""ORDER_ID"",""ORDER_DATE"" FROM ""CUST_ORDER"" WHERE ""RN""<=3 ORDER BY ""CUSTOMER_NAME"",""CUSTOMER_ID"",""ORDER_dATE"" DESC"
343,"SELECT ""C"".""name"" AS ""customer_name"",""T"".""customer_id"",""T"".""order_id"",""T"".""order_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""RN"" FROM ""Orders"") AS ""T"" JOIN ""Customers"" AS ""C"" ON ""T"".""customer_id""=""C"".""customer_id"" WHERE ""RN""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
344,"SELECT ""c"".""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""a"" JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""rnk"" IN (1,2,3) ORDER BY 1,2,4 DESC"
345,"WITH ""CTE"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""CTE"" AS ""a"" JOIN ""customers"" AS ""b"" USING (""customer_id"") WHERE ""a"".""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
346,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""t1"".""name"" AS ""customer_name"",""t1"".""customer_id"",""t2"".""order_id"",""t2"".""order_date"" FROM ""Customers"" AS ""t1"" JOIN ""cte"" AS ""t2"" ON (""t1"".""customer_id""=""t2"".""customer_id"") WHERE ""t2"".""rnk""<=3 ORDER BY ""t1"".""name"",""t1"".""customer_id"",""t2"".""order_date"" DESC"
347,"SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"",""O1"".""order_id"",""O1"".""order_date"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O1"" ON ""C"".""customer_id""=""O1"".""customer_id"") JOIN ""Orders"" AS ""O2"" ON ""O1"".""customer_id""=""O2"".""customer_id"" AND ""O1"".""order_date""<=""O2"".""order_date"" GROUP BY 1,2,3,4 HAVING COUNT(""O2"".""order_date"")<=3 ORDER BY 1,2,4 DESC"
348,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
349,"WITH ""cte"" AS (SELECT ""c"".""name"",""order_id"",""order_date"",""o"".""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""<=3 ORDER BY 1,2,4 DESC"
350,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" USING (""customer_id"") WHERE ""rnk""<=3 GROUP BY 1,2,3 ORDER BY 1,2,4 DESC"
351,"WITH ""cte"" AS (SELECT ""c"".""name"",""o1"".""customer_id"",""o1"".""order_id"",COUNT(1) AS ""c"",""o1"".""order_date"" FROM (""Orders"" AS ""o1"" LEFT JOIN ""Orders"" AS ""o2"" ON ""o1"".""order_date"">=""o2"".""order_date"") LEFT JOIN ""Customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""o1"".""order_date""), ""cte_2"" AS (SELECT ""name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""r"" FROM ""cte"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte_2"" WHERE ""r""<=3 ORDER BY 1,2,4 DESC"
352,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE (SELECT COUNT(1) FROM ""Orders"" AS ""c"" WHERE ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<""c"".""order_date"")<=2 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
353,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""b"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
354,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<""o2"".""order_date"") JOIN ""customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=2 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
355,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Orders"" AS ""O1"" ON ""O1"".""customer_id""=""O"".""customer_id"" AND ""O"".""order_date""<=""O1"".""order_date"" GROUP BY ""customer_name"",""c"".""customer_id"",""o"".""order_date"",""o"".""order_id"" HAVING COUNT(""o1"".""order_date"")<=3 ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
356,"SELECT ""name"" AS ""customer_name"",""cust"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""cust"" JOIN (SELECT ""order_date"",""customer_id"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""temp"" ON ""cust"".""customer_id""=""temp"".""customer_id"" WHERE ""rnk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
357,"SELECT ""Customers"".""name"" AS ""customer_name"",""rank_ordered_table"".""customer_id"",""rank_ordered_table"".""order_id"",""rank_ordered_table"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank_ordered"" FROM ""Orders"") AS ""rank_ordered_table"" JOIN ""Customers"" ON ""rank_ordered_table"".""customer_id""=""Customers"".""customer_id"" WHERE ""rank_ordered""<=3 ORDER BY 1,2,4 DESC"
358,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
359,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
360,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
361,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""c"" WHERE ""r""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
362,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
363,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rank1"" FROM ""Customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""rank1""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
364,"WITH ""cte_order_seq"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent_order_seq"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte_order_seq"" WHERE ""recent_order_seq""<=3 ORDER BY 1,2,4 DESC"
365,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""c"".""name"" AS ""customer_name"",""o"".""order_date"",""o"".""order_id"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
366,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""cte"".""customer_id"",""cte"".""order_id"",""cte"".""order_date"" FROM ""cte"" JOIN ""customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
367,"WITH ""cte"" AS (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""cte"".""customer_id"",""cte"".""order_id"",""cte"".""order_date"" FROM ""cte"" LEFT JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
368,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""Order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"") AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
369,"WITH ""order_rank_table"" AS (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_order"" FROM ""Orders"") SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"" FROM ""order_rank_table"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""order_order""<=3 ORDER BY 1,2,4 DESC"
370,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rank"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""rank""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
371,"SELECT ""customer_name"",""t1"".""customer_id"",""t1"".""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t1"" WHERE ""t1"".""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
372,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""C"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""cte"" AS ""t"" JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""rnk"" BETWEEN 1 AND 3 ORDER BY 1,2,4 DESC"
373,"WITH ""t"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""rk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
374,"WITH ""cte"" AS (SELECT ""c"".""name"",""o1"".""customer_id"",""o1"".""order_id"",COUNT(1) AS ""c"",""o1"".""order_date"" FROM (""Orders"" AS ""o1"" LEFT JOIN ""Orders"" AS ""o2"" ON ""o1"".""order_date"">=""o2"".""order_date"") LEFT JOIN ""Customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""o1"".""order_date""), ""cte_2"" AS (SELECT ""name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""c"" DESC) AS ""r"" FROM ""cte"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte_2"" WHERE ""r""<=3 ORDER BY 1,2,4 DESC"
375,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""recent_ord"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""t"".""recent_ord""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
376,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""b"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""a"".""order_date"" DESC) AS ""latest"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""d"" WHERE ""latest""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
377,"WITH ""cte"" AS (SELECT ""order_id"",""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""recency"" FROM ""Orders"") SELECT ""name"" AS ""customer_name"",""C"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""C"" LEFT JOIN ""cte"" AS ""T"" ON ""C"".""customer_id""=""T"".""customer_id"" WHERE ""recency""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
378,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" USING (""customer_id"")) AS ""t"" WHERE ""rnk""=1 OR ""rnk""=2 OR ""rnk""=3 ORDER BY 1,2,4 DESC"
379,"WITH ""TEMP"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""Rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""Rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
380,"SELECT ""m"".""customer_name"",""m"".""customer_id"",""m"".""order_id"",""m"".""order_date"" FROM (SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""b"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") AS ""m"" WHERE ""m"".""rnk"" IN (1,2,3) ORDER BY ""m"".""customer_name"",""m"".""customer_id"",""m"".""order_date"" DESC"
381,"WITH ""recent_order"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""r"".""customer_id"",""order_id"",""order_date"" FROM ""recent_order"" AS ""r"" JOIN ""customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" WHERE ""ranks""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
382,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""name"", ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""drnk"" FROM ""Customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" ORDER BY 1,2,4 DESC) AS ""tab1"" WHERE ""drnk""=1 OR ""drnk""=2 OR ""drnk""=3"
383,"WITH ""TEMP"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""Rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""Rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
384,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM ""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE (SELECT COUNT(1) FROM ""Orders"" AS ""c"" WHERE ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<""c"".""order_date"")<=2 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
385,"WITH ""cte1"" AS (SELECT ""sub1"".""customer_id"",""sub1"".""order_id"",""sub1"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""od"".""customer_id"" ORDER BY ""od"".""order_date"" DESC) AS ""orderrank"" FROM ""orders"" AS ""od"") AS ""sub1"" WHERE ""sub1"".""orderrank""<=3) SELECT ""cs"".""name"" AS ""customer_name"",""ct1"".""customer_id"",""ct1"".""order_id"",""ct1"".""order_date"" FROM ""cte1"" AS ""ct1"" LEFT JOIN ""customers"" AS ""cs"" ON ""cs"".""customer_id""=""ct1"".""customer_id"" ORDER BY 1,2,4 DESC"
386,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<""o2"".""order_date"") JOIN ""customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""c"".""name"",""o1"".""order_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=2 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
387,"SELECT ""t1"".""name"" AS ""customer_name"",""t1"".""customer_id"",""t2"".""order_id"",""t2"".""order_date"" FROM ""Customers"" AS ""t1"" LEFT JOIN (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
388,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""t"".""customer_id"",""order_id"",""order_date"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" AND ""t"".""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
389,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""CTE"".""customer_id"" AS ""customer_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""cte"".""rnk""<=3 ORDER BY 1,2,4 DESC"
390,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""c"".""name"" AS ""customer_name"",""o"".""order_date"",""o"".""order_id"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
391,"SELECT ""c"".""NAME"" AS ""CUSTOMER_NAME"",""t"".""CUSTOMER_ID"",""t"".""ORDER_ID"",""t"".""ORDER_DATE"" FROM (SELECT ""CUSTOMER_ID"",""ORDER_ID"",""ORDER_DATE"",RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""ORDER_DATE"" DESC) AS ""DATE_RANK"" FROM ""ORDERS"") AS ""t"" JOIN ""CUSTOMERS"" AS ""c"" ON ""t"".""CUSTOMER_ID""=""c"".""CUSTOMER_ID"" WHERE ""t"".""DATE_RANK""<=3 ORDER BY ""c"".""NAME"",""t"".""CUSTOMER_ID"",""t"".""ORDER_DATE"" DESC"
392,"WITH ""tmp_table"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""tmp_table"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
393,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",(""o"".""order_id""),""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC) AS ""a"" WHERE ""rnk""<=3"
394,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""cte"".""customer_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<=3 ORDER BY 1,2,""order_date"" DESC"
395,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC,""name"",""customer_id"",""order_date"" DESC) AS ""rn"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""a"" WHERE ""a"".""rn""<4 ORDER BY 1,2,4 DESC"
396,"ERROR: mysql parse error: line 1 column 85 near ""AS O1 JOIN Customers AS C ON O1.customer_id=C.customer_id JOIN ( SELECT customer_id,IF(COUNT(order_id)>3,3,COUNT(order_id)) AS maxnum FROM Orders GROUP BY customer_id ) AS tmp ON O1.customer_id=tmp.customer_id JOIN Orders AS O2 ON O1.customer_id=O2.customer_id AND O1.order_date<=O2.Order_date GROUP BY O1.customer_id,O1.order_date HAVING COUNT(O2.Order_date)<=3 ORDER BY customer_name,customer_id,o1.order_date DESC "" "
397,"WITH ""temp"" AS (SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""b"".""order_date"" DESC) AS ""seq"" FROM ""Customers"" AS ""a"" RIGHT JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""seq""<=3 ORDER BY 1,2,4 DESC"
398,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""tb"".""order_id"",""tb"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""tb"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""tb"".""customer_id"" WHERE ""rnk""<4 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
399,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""num"",""name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""num""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
400,"WITH ""TEMP"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""row_num"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""TEMP"" WHERE ""row_num""<='3' ORDER BY 1,2,4 DESC"
401,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o1"" ON ""c"".""customer_id""=""o1"".""customer_id"") JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<=""o2"".""order_date"" GROUP BY 1,2,3,4 HAVING COUNT(""o2"".""order_date"")<=3 ORDER BY 1,2,4 DESC"
402,"WITH ""cte"" AS (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""cte"".""order_id"",""cte"".""order_date"" FROM ""cte"" JOIN ""customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
403,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""flag"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""flag""<=3 GROUP BY ""customer_id"",""order_id"",""order_date"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
404,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<=3"
405,"WITH ""temp"" AS (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""temp"" AS ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""order_rk""<=3 ORDER BY ""c"".""name"",""t"".""customer_id"",""t"".""order_date"" DESC"
406,"SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"",""O"".""order_id"",""O"".""order_date"" FROM ""Customers"" AS ""C"" JOIN (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" WHERE ""order_rank""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
407,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""subq"" WHERE ""rn""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
408,"SELECT ""C"".""name"" AS ""customer_name"",""O"".""customer_id"",""order_id"",""order_date"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" WHERE ROW(""O"".""customer_id"",""order_id"") IN (SELECT ""customer_id"",""order_id"" FROM (SELECT ""customer_id"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""temp1"" WHERE ""rk""<4) ORDER BY ""customer_name"",""O"".""customer_id"",""order_date"" DESC"
409,"WITH ""sort_order"" AS (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"" AS ""customer_id"",""s"".""order_id"" AS ""order_id"",""s"".""order_date"" AS ""order_date"" FROM ""sort_order"" AS ""s"" JOIN ""Customers"" AS ""c"" ON ""s"".""customer_id""=""c"".""customer_id"" WHERE ""rnk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
410,"SELECT ""name"" AS ""customer_name"",""r_ord"".""customer_id"",""r_ord"".""order_id"",""r_ord"".""order_date"" FROM ""Customers"" AS ""cust"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r_cust"" FROM ""orders"") AS ""r_ord"" ON ""cust"".""customer_id""=""r_ord"".""customer_id"" WHERE ""r_cust""<=3 ORDER BY ""name"",""r_ord"".""customer_id"",""r_ord"".""order_date"" DESC"
411,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""C"".""name"" AS ""customer_name"",""O"".""customer_id"",""O"".""order_id"",""O"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""O"".""customer_id"" ORDER BY ""O"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") AS ""TBL"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
412,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""customer_id"" FROM (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn_max"" FROM ""orders"") AS ""a"" WHERE ""rn_max""<=3) AS ""b"" JOIN (SELECT ""customer_id"",""name"" FROM ""customers"" GROUP BY 1,2) AS ""c"" USING (""customer_id"") ORDER BY 1,2,4 DESC"
413,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""order_date"",""b"".""name"",""a"".""order_id"",DENSE_RANK() OVER (PARTITION BY ""a"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
414,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""rnk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
415,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""src"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
416,"SELECT ""c"".""name"" AS ""customer_name"",""t1"".""customer_id"",""t1"".""order_id"",""t1"".""order_date"" FROM ""Customers"" AS ""c"" LEFT JOIN (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""o"") AS ""t1"" ON ""c"".""customer_id""=""t1"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
417,"WITH ""cte"" AS (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""purchase"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""purchase""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
418,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE 3>(SELECT COUNT(DISTINCT ""order_date"") FROM ""customers"" AS ""c1"" JOIN ""orders"" AS ""o1"" ON ""c1"".""customer_id""=""o1"".""customer_id"" WHERE ""c"".""customer_id""=""c1"".""customer_id"" AND ""o1"".""order_date"">""o"".""order_date"") ORDER BY ""name"",""c"".""customer_id"",""order_date"" DESC"
419,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""x"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
420,"SELECT ""c"".""name"" AS ""customer_name"",""t1"".""customer_id"",""t1"".""order_id"",""t1"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") AS ""t1"" ON ""c"".""customer_id""=""t1"".""customer_id"" AND ""t1"".""order_rank""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""t1"".""order_date"" DESC"
421,"WITH ""CTE"" AS (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""value"" FROM ""Orders"" ORDER BY ""customer_id"") SELECT ""name"" AS ""customer_name"",""c1"".""customer_id"",""order_id"",""order_date"" FROM ""CTE"" JOIN ""Customers"" AS ""c1"" ON ""CTE"".""customer_id""=""c1"".""customer_id"" WHERE ""value"" IN (1,2,3) ORDER BY ""name"",""customer_id"",""order_date"" DESC"
422,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""sub"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
423,"WITH ""t"" AS (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""r""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
424,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""cte"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
425,"WITH ""tmp_table"" AS (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""customer_id"",""o"".""cost"",""c"".""name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""tmp_table"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
426,"SELECT ""A"".""name"" AS ""customer_name"",""A"".""customer_id"",""B"".""order_id"",""B"".""order_date"" FROM (""Customers"" AS ""A"" JOIN ""Orders"" AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"") JOIN ""Orders"" AS ""C"" ON ""B"".""customer_id""=""C"".""customer_id"" AND ""B"".""order_date""<=""C"".""order_date"" GROUP BY ""A"".""name"",""A"".""customer_id"",""B"".""order_id"",""B"".""order_date"" HAVING COUNT(""C"".""order_date"")<=3 ORDER BY ""A"".""name"",""A"".""customer_id"",""B"".""order_date"" DESC"
427,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
428,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""t1"".""name"",""t1"".""customer_id"",""t2"".""order_id"",""t2"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Customers"" AS ""t1"" JOIN ""Orders"" AS ""t2"" ON (""t1"".""customer_id""=""t2"".""customer_id"")) AS ""t"" WHERE ""ranking""<=3 ORDER BY 1,2,4 DESC"
429,"SELECT ""a"".""name"" AS ""customer_name"",""b"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM ""customers"" AS ""a"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"") AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""ranking""<=3 ORDER BY ""a"".""name"",""b"".""customer_id"",""b"".""order_date"" DESC"
430,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" USING (""customer_id"") WHERE ""rnk""<=3 GROUP BY 1,2,3 ORDER BY 1,2,4 DESC"
431,"WITH ""temp"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" JOIN ""customers"" USING (""customer_id"") WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
432,"WITH ""cte"" AS (SELECT ""order_id"",""order_date"",""name"",""c"".""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""<=3 ORDER BY 1,2,4 DESC"
433,"SELECT ""a"".""name"" AS ""customer_name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Orders"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""order_date""<=""c"".""order_date"" GROUP BY ""a"".""name"",""a"".""customer_id"",""b"".""order_id"",""b"".""order_date"" HAVING COUNT(""c"".""order_date"")<=3 ORDER BY ""a"".""name"",""a"".""customer_id"",""b"".""order_date"" DESC"
434,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"" AS ""customer_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE 3>(SELECT COUNT(DISTINCT ""order_date"") FROM ""orders"" WHERE ""customer_id""=""o"".""customer_id"" AND ""order_date"">""o"".""order_date"") ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
435,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""t1"".""order_id"",""t1"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") AS ""t1"" JOIN ""customers"" AS ""c"" ON ""t1"".""customer_id""=""c"".""customer_id"" WHERE ""t1"".""rk""<=3 ORDER BY ""c"".""name"",""c"".""customer_id"",""t1"".""order_date"" DESC"
436,"WITH ""orderRank"" AS (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""orderRank"" WHERE ""ranks""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
437,"SELECT ""c"".""name"" AS ""customer_name"",""t"".""customer_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""t"" RIGHT JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""t"".""rnk"" BETWEEN 1 AND 3 ORDER BY 1,2,4 DESC"
438,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".*,""c"".""name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""temp"" WHERE ""rk"" BETWEEN 1 AND 3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
439,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""name"" AS ""customer_name"",""o"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""name"",""customer_id"",""order_date"" DESC) AS ""rn"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
440,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""customer_id"",""order_id"",""order_date"",""c"".""name"" AS ""customer_name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""tb"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
441,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE 2>=(SELECT COUNT(DISTINCT ""order_date"") FROM ""orders"" WHERE ""o"".""customer_id""=""customer_id"" AND ""o"".""order_date""<""order_date"") ORDER BY 1,2,4 DESC"
442,"WITH ""cte"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM (""Customers"" AS ""c"") CROSS JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk"" IN (1,2,3) ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
443,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<""o2"".""order_date"") JOIN ""customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""c"".""name"",""o1"".""order_id"",""o1"".""order_date"" HAVING COUNT(""o2"".""order_date"")<=2 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
444,"WITH ""sub"" AS (SELECT ""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""order_id"" IN (SELECT ""order_id"" FROM ""sub"" WHERE ""order_rank""<=3) ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC"
445,"WITH ""cte"" AS (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_date"",""o"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
446,"WITH ""CTE"" AS (SELECT ""order_id"",""order_date"",""customer_id"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""value"" FROM ""Orders"" ORDER BY ""customer_id"") SELECT ""name"" AS ""customer_name"",""c1"".""customer_id"",""order_id"",""order_date"" FROM ""CTE"" JOIN ""Customers"" AS ""c1"" ON ""CTE"".""customer_id""=""c1"".""customer_id"" WHERE ""value"" IN (1,2,3) ORDER BY ""name"",""customer_id"",""order_date"" DESC"
447,"WITH ""cte"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
448,"WITH ""cte"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""cost"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rownumber"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""cte"" AS ""o"" JOIN ""Customers"" AS ""c"" ON (""o"".""customer_id""=""c"".""customer_id"") WHERE ""rownumber""<=3 ORDER BY ""c"".""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
449,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""name"", ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""order_rank"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""ranked_orders"" WHERE ""order_rank""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
450,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",ROW_NUMBER() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""nrow"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" USING (""customer_id"")) AS ""sub"" WHERE ""nrow""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
451,"WITH ""T1"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""r1"" FROM ""customers"" AS ""c"" JOIN ""orders"" USING (""customer_id"") ORDER BY ""customer_name"",""c"".""customer_id"",""order_date"" DESC) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""T1"" WHERE ""r1""<=3"
452,"WITH ""o_rank"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""orders""), ""list_df"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""customers"" AS ""c"" LEFT JOIN (SELECT * FROM ""o_rank"" WHERE ""order_rank""<4) AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" ORDER BY ""c"".""name"",""c"".""customer_id"",""o"".""order_date"" DESC) SELECT * FROM ""list_df"" WHERE ""order_id"" IS NOT NULL"
453,"WITH ""sub1"" AS (SELECT ""customer_id"",""order_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""sub1"".""customer_id"",""sub1"".""order_id"",""sub1"".""order_date"" FROM ""sub1"" JOIN ""Customers"" AS ""c"" ON ""sub1"".""customer_id""=""c"".""customer_id"" WHERE ""sub1"".""order_rank""<=3 ORDER BY 1,2,4 DESC"
454,"SELECT ""Customers"".""name"" AS ""customer_name"",""Orders"".""customer_id"",""tbl1"".""order_id"",""order_date"" FROM (""Orders"" JOIN (SELECT ""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""tbl1"" ON ""Orders"".""order_id""=""tbl1"".""order_id"") JOIN ""Customers"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE ""tbl1"".""rnk""<4 ORDER BY ""Customers"".""name"",""Orders"".""customer_id"",""order_date"" DESC"
455,"SELECT ""name"" AS ""customer_name"",""temp1"".""customer_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") AS ""temp1"" JOIN ""Customers"" ON ""temp1"".""customer_id""=""Customers"".""customer_id"" WHERE ""rk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
456,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""order_date"" IN (SELECT ""order_date"" FROM (SELECT ""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""nr"" FROM ""Orders"" AS ""o2"" WHERE ""o2"".""customer_id""=""o"".""customer_id"") AS ""temp"" WHERE ""nr"" IN (1,2,3)) ORDER BY ""name"",""customer_id"",""order_date"" DESC"
457,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""o"".""customer_id"",""name"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""t"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
458,"WITH ""r"" AS (SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"") ORDER BY 1,2,4 DESC) SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""r"" WHERE ""rnk""<=3"
459,"SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""rnk""<4 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
460,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""customers"" AS ""c"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""count_value"" FROM ""orders"") AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""count_value""<=3 ORDER BY ""customer_name"",""c"".""customer_id"",""o"".""order_date"" DESC"
461,"SELECT ""C"".""name"" AS ""customer_name"",""R"".""customer_id"",""R"".""order_id"",""R"".""order_date"" FROM ""Customers"" AS ""C"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",""cost"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""R"" ON ""C"".""customer_id""=""R"".""customer_id"" WHERE ""rnk""<=3 ORDER BY 1,""C"".""customer_id"",""R"".""order_date"" DESC"
462,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY 1,2,4 DESC"
463,"WITH ""order_ranking"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"") SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""order_ranking"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""rn""<=3 ORDER BY ""c"".""name"",""customer_id"",""order_date"" DESC"
464,"SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Customers"" JOIN ""Orders"" USING (""customer_id"")) AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
465,"WITH ""temp"" AS (SELECT ""name"",""customer_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Customers"" JOIN ""Orders"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""rk""<=3 ORDER BY 1,2,4 DESC"
466,"WITH ""a"" AS (SELECT ""customer_id"",""order_id"",""order_date"" FROM (SELECT ""customer_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""t"" WHERE ""rnk""<=3) SELECT ""c"".""name"" AS ""customer_name"",""a"".""customer_id"",""a"".""order_id"",""a"".""order_date"" FROM ""a"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""a"".""customer_id"" ORDER BY 1,2,4 DESC"
467,"SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Orders"") AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" AND ""rn""<=3 ORDER BY ""c"".""name"",""o"".""customer_id"",""order_date"" DESC"
468,"SELECT ""B"".""name"" AS ""customer_name"",""A"".""customer_id"",""A"".""order_id"",""A"".""order_date"" FROM (SELECT ""customer_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"") AS ""A"" JOIN ""Customers"" AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" AND ""A"".""ranking""<=3 ORDER BY ""B"".""name"",""A"".""customer_id"",""A"".""order_date"" DESC"
469,"SELECT ""C"".""name"" AS ""customer_name"",""C"".""customer_id"",""O1"".""order_id"",""O1"".""order_date"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O1"" ON ""C"".""customer_id""=""O1"".""customer_id"") LEFT JOIN ""Orders"" AS ""O2"" ON ""O1"".""customer_id""=""O2"".""customer_id"" AND ""O1"".""order_date""<=""O2"".""order_date"" GROUP BY 1,2,3,4 HAVING COUNT(""O2"".""order_date"")<=3 ORDER BY 1,2,4 DESC"
470,"SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM (SELECT ""c"".""name"" AS ""customer_name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") AS ""t"" WHERE ""rnk""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
471,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""c"".""customer_id"" ORDER BY ""o"".""order_date"" DESC) AS ""ranking"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""ranking""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
472,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""RNK""<=3 ORDER BY ""customer_name"",""customer_id"",""order_date"" DESC"
473,"WITH ""cte"" AS (SELECT ""order_id"",""order_date"",""o"".""customer_id"",""c"".""name"",DENSE_RANK() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rnk""<=3 ORDER BY ""name"",""customer_id"",""order_date"" DESC"
474,"SELECT ""name"" AS ""customer_name"",""a"".""customer_id"",""order_id"",""order_date"" FROM (SELECT ""o1"".""customer_id"",""o1"".""order_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"" DESC) AS ""r"",""o1"".""order_date"" FROM ""Orders"" AS ""o1"" LEFT JOIN ""Orders"" AS ""o2"" ON ""o1"".""order_date"">=""o2"".""order_date"" GROUP BY ""o1"".""customer_id"",""o1"".""order_date"") AS ""a"" LEFT JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""r""<=3 ORDER BY 1,2,4 DESC"
475,"SELECT ""c"".""name"" AS ""customer_name"",""o1"".""customer_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""order_date""<""o2"".""order_date"") JOIN ""customers"" AS ""c"" ON ""o1"".""customer_id""=""c"".""customer_id"" GROUP BY ""o1"".""customer_id"",""o1"".""order_id"" HAVING COUNT(""o2"".""order_date"")<=2 ORDER BY ""c"".""name"",""o1"".""customer_id"",""o1"".""order_date"" DESC"
476,"SELECT ""name"" AS ""customer_name"",""c"".""customer_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Orders"" AS ""r"" ON ""r"".""customer_id""=""o"".""customer_id"" AND ""o"".""order_date""<=""r"".""order_date"" GROUP BY ""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"" HAVING COUNT(""r"".""order_date"")<=3 ORDER BY ""name"",""o"".""customer_id"",""o"".""order_date"" DESC"
477,"WITH ""cte"" AS (SELECT ""c"".""name"",""o"".""customer_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""name"", ""o"".""customer_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" USING (""customer_id"")) SELECT ""name"" AS ""customer_name"",""customer_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""ranking""<=3 ORDER BY 1,2,4 DESC"
