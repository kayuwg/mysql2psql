id,original query
1,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total_sold"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' AND COALESCE(""o"".""total_sold"", 0)<10 ORDER BY ""b"".""book_id"""
2,"WITH ""consider_books"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23') SELECT ""book_id"",""name"" FROM (SELECT ""a"".""book_id"",""a"".""name"",SUM(CASE WHEN ""b"".""dispatch_date"">'2018-06-23' THEN ""b"".""quantity"" ELSE 0 END) AS ""number_of_orders"" FROM ""consider_books"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" USING (""book_id"") GROUP BY ""a"".""book_id"",""a"".""name"") AS ""sub"" WHERE ""sub"".""number_of_orders""<10"
3,"SELECT ""book_id"",""name"" FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
4,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
5,"SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""copies_sold"" FROM ""orders"" AS ""o"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1) AS ""m"" ON ""b"".""book_id""=""m"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' AND (""copies_sold""<10 OR ""copies_sold"" IS NULL)"
6,"WITH ""cte"" AS (SELECT ""book_id"",""name"",""available_from"" FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""cte1"" AS (SELECT ""book_id"",""quantity"" FROM ""Orders"" WHERE ""dispatch_date""<='2019-06-23' AND ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') SELECT ""book_id"",""name"" FROM (SELECT ""cte"".""book_id"" AS ""book_id"",""cte"".""name"" AS ""name"",COALESCE(""cte1"".""quantity"", 0) AS ""quantity"" FROM ""cte"" LEFT JOIN ""cte1"" ON ""cte"".""book_id""=""cte1"".""book_id"") AS ""a"" GROUP BY ""book_id"",""name"" HAVING SUM(""quantity"")<10"
7,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<='2019-05-23'"
8,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' AND ""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
9,"WITH ""t1"" AS (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10), ""t2"" AS (SELECT ""book_id"",""name"",""available_from"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT * FROM ""t1"")) SELECT ""book_id"",""name"" FROM ""t2"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'"
10,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-30 DAY' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
11,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total_sold"" FROM ""orders"" WHERE ""dispatch_date"">='2018-06-24' AND ""dispatch_date""<='2019-06-23' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE (""total_sold""<10 OR ""total_sold"" IS NULL) AND ""available_from""<='2019-05-23'"
12,"SELECT ""name"",""book_id"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
13,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""sum_copies"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""sum_copies""<10 OR ""sum_copies"" IS NULL)"
14,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""Books"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE ""a"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"">'2019_05-23') AND ""a"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018_06_23' GROUP BY 1 HAVING SUM(""quantity"")>=10) GROUP BY 1,2"
15,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY 1,2 HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
16,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
17,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" USING (""book_id"") WHERE ""available_from""<='2019-05-23' AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""b"".""book_id"" HAVING SUM(""quantity"")<10 UNION SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" USING (""book_id"") WHERE ""quantity"" IS NULL UNION SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" USING (""book_id"") WHERE ""dispatch_date""<'2018-06-23' AND ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23')"
18,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
19,"SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""order_counts"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN CAST('2018-06-23' AS DATE) AND CAST('2019-06-23' AS DATE) GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE COALESCE(""order_counts"", 0)<10"
20,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""sum_copies"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""sum_copies""<10 OR ""sum_copies"" IS NULL)"
21,"WITH ""CTE1"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""Orders"" WHERE ""dispatch_date""<='2019-06-23' AND ""dispatch_date"">CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' GROUP BY ""book_id"" HAVING ""total"">=10) SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""CTE1"")"
22,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""Books"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""available_from""<='2019-05-23' GROUP BY 1,2 HAVING SUM(COALESCE(""b"".""quantity"", 0))<10"
23,"WITH ""adj_books"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""orders_book"" AS (SELECT ""book_id"",""quantity"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23') SELECT ""b"".""book_id"",""b"".""name"" FROM ""adj_books"" AS ""b"" LEFT JOIN ""orders_book"" AS ""o"" USING (""book_id"") GROUP BY ""book_id"" HAVING SUM(COALESCE(""quantity"", 0))<10"
24,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<='2019-05-23' GROUP BY 1 HAVING COALESCE(SUM(""quantity""), 0)<10"
25,"WITH ""cte"" AS (SELECT ""b"".""book_id"" AS ""bi"",""b"".""name"" AS ""n"",""quantity"" AS ""q"",""dispatch_date"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23') SELECT ""bi"" AS ""book_id"",""n"" AS ""name"" FROM ""cte"" GROUP BY ""bi"" HAVING SUM(CASE WHEN ""dispatch_date"">'2018-06-23' THEN ""q"" ELSE 0 END)<10"
26,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""Books"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""b"".""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' WHERE ""a"".""available_from""<'2019-05-23' GROUP BY ""a"".""book_id"" HAVING COALESCE(SUM(""b"".""quantity""), 0)<10"
27,"SELECT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY 1,2 HAVING COALESCE(SUM(""quantity""), 0)<10"
28,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
29,"SELECT DISTINCT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" USING (""book_id"") WHERE ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
30,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
31,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""book_id""=""B"".""book_id"" AND ""O"".""dispatch_date"">'2018-06-23' WHERE ""B"".""available_from""<='2019-05-23' GROUP BY ""B"".""book_id"" HAVING SUM(""O"".""quantity"")<10 OR SUM(""O"".""quantity"") IS NULL"
32,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
33,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total_orders"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<='2019-05-23' AND COALESCE(""o"".""total_orders"", 0)<10 ORDER BY ""b"".""book_id"""
34,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
35,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""book_sold"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""book_sold"" IS NULL OR ""book_sold""<10) ORDER BY ""b"".""book_id"""
36,"SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" USING (""book_id"") WHERE ""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
37,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' AND ""dispatch_date""<'2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
38,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" - CAST('2018-06-23' AS DATE)>0) AS ""o"" GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND CAST('2019-05-23' AS DATE) - ""available_from"">0"
39,"SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""name"",COALESCE(SUM(""quantity""), 0) AS ""num"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '365 DAY' WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '30 DAY' GROUP BY ""book_id"",""name"") AS ""a"" WHERE ""num""<10"
40,"WITH ""x"" AS (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT * FROM ""x"")"
41,"SELECT ""sub_older_books"".""book_id"",""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""sub_older_books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_older_books"".""book_id""=""sub_count_sold"".""book_id"" WHERE ""count_books"" IS NULL OR ""count_books""<10"
42,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
43,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
44,"WITH ""qty"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""quantity"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""qty"" ON ""b"".""book_id""=""qty"".""book_id"" WHERE ""available_from""<'2019-05-23' AND COALESCE(""quantity"", 0)<10"
45,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""t"".""book_id"" FROM (SELECT ""b"".""book_id"",COALESCE(SUM(""o"".""quantity""), 0) AS ""sales"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<='2019-05-23' AND ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""b"".""book_id"" HAVING SUM(""o"".""quantity"")>=10) AS ""t"") AND ""available_from""<='2019-05-23'"
46,"WITH ""cte1"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23') GROUP BY 1), ""cte2"" AS (SELECT ""c"".""book_id"",""c"".""name"",SUM(""o"".""quantity"") AS ""sales"" FROM ""cte1"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" ON ""c"".""book_id""=""o"".""book_id"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1,2) SELECT ""c1"".""book_id"",""c1"".""name"" FROM ""cte1"" AS ""c1"" LEFT JOIN ""cte2"" AS ""c2"" ON ""c1"".""book_id""=""c2"".""book_id"" WHERE ""c1"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""cte2"" WHERE ""sales"">=10)"
47,"SELECT ""B"".""book_id"",""B"".""name"" FROM (SELECT * FROM ""Books"" WHERE ""available_from""<'2019-05-23') AS ""B"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<'2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
48,"SELECT ""sub_older_books"".""book_id"",""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""sub_older_books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_older_books"".""book_id""=""sub_count_sold"".""book_id"" WHERE ""count_books"" IS NULL OR ""count_books""<10"
49,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""B"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
50,"SELECT ""sub_older_books"".""book_id"",""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""sub_older_books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_older_books"".""book_id""=""sub_count_sold"".""book_id"" WHERE ""count_books"" IS NULL OR ""count_books""<10"
51,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
52,"SELECT ""sub_older_books"".""book_id"",""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""sub_older_books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_older_books"".""book_id""=""sub_count_sold"".""book_id"" WHERE ""count_books"" IS NULL OR ""count_books""<10"
53,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT *,(CASE WHEN ""dispatch_date"" BETWEEN DATE('2018-06-23') AND DATE('2019-06-23') THEN ""quantity"" ELSE 0 END) AS ""quant"" FROM ""Orders"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE DATE('2019-06-23') - ""b"".""available_from"">30 GROUP BY ""b"".""book_id"" HAVING SUM(COALESCE(""o"".""quant"", 0))<10"
54,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""book_sold"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""book_sold"" IS NULL OR ""book_sold""<10) ORDER BY ""b"".""book_id"""
55,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""b"".""book_id"" IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH') GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' THEN ""quantity"" ELSE 0 END)<10"
56,"SELECT ""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" USING (""book_id"") WHERE ""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
57,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
58,"WITH ""t"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""nc"" FROM ""orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY 1) SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE (""nc"" IS NULL OR ""nc""<10) AND CAST('2019-06-23' AS DATE) - ""available_from"">=31"
59,"WITH ""cte_final"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""o"".""dispatch_date""<='2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte_final"""
60,"SELECT ""Books"".""book_id"",""Books"".""name"" FROM ""Books"" LEFT JOIN ""Orders"" ON ""Books"".""book_id""=""Orders"".""book_id"" AND ""Orders"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""Books"".""available_from""<'2019-05-23' GROUP BY ""Books"".""book_id"" HAVING COALESCE(SUM(""Orders"".""quantity""), 0)<10"
61,"SELECT ""book_id"",""name"" FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
62,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
63,"WITH ""cte"" AS (SELECT ""b"".""book_id"",""b"".""name"",SUM(""quantity"") FROM ""books"" AS ""b"" JOIN ""orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""b"".""book_id"" HAVING SUM(""quantity"")>=10) SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""cte"") AND ""available_from""<='2019-05-23'"
64,"WITH ""eligible_books"" AS (SELECT ""book_id"",""name"",""available_from"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""eligible_orders"" AS (SELECT ""book_id"",""quantity"",""dispatch_date"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23') SELECT ""temp"".""book_id"" AS ""book_id"",""temp"".""name"" AS ""name"" FROM (SELECT ""eb"".""book_id"" AS ""book_id"",""eb"".""name"" AS ""name"",""eo"".""quantity"" AS ""quantity"",""eo"".""dispatch_date"" AS ""dispatch_date"" FROM ""eligible_books"" AS ""eb"" LEFT JOIN ""eligible_orders"" AS ""eo"" ON ""eb"".""book_id""=""eo"".""book_id"") AS ""temp"" GROUP BY 1 HAVING SUM(CASE WHEN ""temp"".""quantity"" IS NOT NULL THEN ""temp"".""quantity"" ELSE 0 END)<10"
65,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<='2019-05-23' GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""dispatch_date""<'2018-06-23' THEN 0 WHEN ""dispatch_date"" IS NULL THEN 0 ELSE ""quantity"" END)<10"
66,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
67,"WITH ""E"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30), ""O1"" AS (SELECT ""book_id"" FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) SELECT ""book_id"",""name"" FROM ""E"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""O1"")"
68,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
69,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
70,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
71,"SELECT ""sub_older_books"".""book_id"",""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""sub_older_books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_older_books"".""book_id""=""sub_count_sold"".""book_id"" WHERE ""count_books"" IS NULL OR ""count_books""<10"
72,"WITH ""table1"" AS (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') SELECT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""table1"" USING (""book_id"") WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""book_id"" HAVING SUM(COALESCE(""quantity"", 0))<10"
73,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
74,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" - CAST('2018-06-23' AS DATE)>0) AS ""o"" GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND CAST('2019-05-23' AS DATE) - ""available_from"">0"
75,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""book_sold"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""book_sold"" IS NULL OR ""book_sold""<10) ORDER BY ""b"".""book_id"""
76,"WITH ""avail"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') SELECT ""avail"".""book_id"",""name"" FROM ""avail"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_Date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23') AS ""o"" ON ""avail"".""book_id""=""o"".""book_id"" GROUP BY 1 HAVING SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL"
77,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=(CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=(CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
78,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' THEN ""o"".""quantity"" ELSE 0 END)<10"
79,"SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",SUM(CASE WHEN ""dispatch_date"" BETWEEN STR_TO_DATE('2019-06-23', '%Y-%m-%d') - INTERVAL '1 YEAR' AND STR_TO_DATE('2019-06-23', '%Y-%m-%d') THEN ""quantity"" ELSE 0 END) AS ""qty"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""a"" ON ""a"".""book_id""=""b"".""book_id"" WHERE ""available_from""<=STR_TO_DATE('2019-06-23', '%Y-%m-%d') - INTERVAL '1 MONTH' GROUP BY 1,2) AS ""t"" WHERE ""qty""<10"
80,"WITH ""filtered_books"" AS (SELECT ""book_id"",""name"",""available_from"" FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH') SELECT ""fb"".""book_id"",""fb"".""name"" FROM ""filtered_books"" AS ""fb"" LEFT JOIN ""Orders"" AS ""od"" ON ""fb"".""book_id""=""od"".""book_id"" AND ""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' GROUP BY ""fb"".""book_id"",""fb"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
81,"SELECT ""tempt1"".""book_id"",""tempt1"".""name"" FROM (SELECT * FROM ""Books"" WHERE ""available_from""<'2019-05-23') AS ""tempt1"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE TIMESTAMPDIFF(DAY, ""dispatch_date"", '2019-06-23')<365) AS ""tempt2"" ON ""tempt1"".""book_id""=""tempt2"".""book_id"" GROUP BY 1 HAVING SUM(""tempt2"".""quantity"")<10 OR SUM(""tempt2"".""quantity"") IS NULL"
82,"SELECT ""sub"".""book_id"",""sub"".""name"" FROM (SELECT ""b"".* FROM ""Books"" AS ""b"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""sub"" LEFT JOIN (SELECT * FROM ""Orders"" AS ""o"" WHERE ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND CAST('2019-06-23' AS DATE)) AS ""sub2"" ON ""sub2"".""book_id""=""sub"".""book_id"" GROUP BY ""sub"".""book_id"" HAVING COALESCE(SUM(""sub2"".""quantity""), 0)<10"
83,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""b"".""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""quantity"", 0))<10"
84,"WITH ""cte"" AS (SELECT ""b"".""book_id"",""b"".""name"",SUM(COALESCE(""t"".""quantity"", 0)) AS ""total_quantity"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE TIMESTAMPDIFF(YEAR, ""dispatch_date"", '2019-06-23')<1) AS ""t"" ON ""t"".""book_id""=""b"".""book_id"" GROUP BY ""b"".""book_id"",""b"".""name"") SELECT ""book_id"",""name"" FROM ""cte"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Books"" WHERE TIMESTAMPDIFF(MONTH, ""available_from"", '2019-06-23')<1) AND ""total_quantity""<10"
85,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
86,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
87,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
88,"SELECT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""name"" HAVING SUM(CASE WHEN ""dispatch_date"">'2018-06-23' THEN COALESCE(""quantity"", 0) ELSE 0 END)<10"
89,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
90,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
91,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30) AS ""b"" LEFT JOIN (SELECT ""book_id"" FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AS ""a"" ON ""a"".""book_id""=""b"".""book_id"" WHERE ""a"".""book_id"" IS NULL"
92,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(SUM(""o"".""quantity""), 0) AS ""items_sold"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""b"".""book_id"") AS ""ab"" ON ""b"".""book_id""=""ab"".""book_id"" AND ""b"".""available_from""<='2019-05-23' AND ""ab"".""items_sold""<10"
93,"SELECT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"" HAVING SUM(COALESCE(""quantity"", 0))<10"
94,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""sales"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""s"" ON ""b"".""book_id""=""s"".""book_id"" WHERE COALESCE(""sales"", 0)<10"
95,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
96,"WITH ""t1"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""sold"" FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10), ""t2"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23') SELECT ""book_id"",""name"" FROM ""t2"" WHERE ""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""t1"") ORDER BY ""book_id"""
97,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
98,"SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(""o"".""total_quantity"", 0) AS ""quant"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '30 DAY') AS ""b"" LEFT JOIN (SELECT ""book_id"",COALESCE(SUM(""quantity""), 0) AS ""total_quantity"",""dispatch_date"" FROM ""Orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '365 DAY' GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"") AS ""result"" WHERE ""quant""<10"
99,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-22' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
100,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
101,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING (SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL)"
102,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""Books"" AS ""a"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' AND ""a"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
103,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
104,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
105,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
106,"WITH ""books_avail"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH'), ""books_sold"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""ttl"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-12 MONTH' AND '2019-06-23' GROUP BY ""book_id"") SELECT ""ba"".""book_id"",""ba"".""name"" FROM ""books_avail"" AS ""ba"" LEFT JOIN ""books_sold"" AS ""bs"" ON ""ba"".""book_id""=""bs"".""book_id"" WHERE COALESCE(""ttl"", 0)<10"
107,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
108,"WITH ""cte_final"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""o"".""dispatch_date""<='2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte_final"""
109,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
110,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
111,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
112,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
113,"SELECT ""B"".""book_id"",""B"".""name"" FROM (SELECT * FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"">'2019-05-23')) AS ""B"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23') AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" GROUP BY ""B"".""Book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
114,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-22' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
115,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND (CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date""<365) WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
116,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
117,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""books"" WHERE ""available_from"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH') GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
118,"WITH ""cte_final"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT (""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte_final"""
119,"WITH ""base"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_From""<'2019-05-23') SELECT ""b"".""book_id"",""b"".""name"" FROM ""base"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
120,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""Books"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""available_from""<='2019-05-23' GROUP BY 1,2 HAVING SUM(COALESCE(""b"".""quantity"", 0))<10"
121,"SELECT ""c"".""book_id"",""c"".""name"" FROM (SELECT ""a"".""book_id"",""a"".""name"",COALESCE(SUM(""b"".""quantity""), 0) AS ""total"" FROM (SELECT * FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30) AS ""a"" LEFT JOIN (SELECT * FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365) AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" GROUP BY 1,2) AS ""c"" WHERE ""c"".""total""<10"
122,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE TIMESTAMPDIFF(MONTH, ""available_from"", '2019-06-23')>1 GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN TIMESTAMPDIFF(YEAR, ""dispatch_date"", '2019-06-23')=0 THEN ""quantity"" ELSE 0 END)<10"
123,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT ""book_id"",SUM(""quantity"") AS ""sold_qty_last_year"" FROM ""Orders"" WHERE TIMESTAMPDIFF(DAY, ""dispatch_date"", '2019-06-23')<=365 GROUP BY ""book_id"") AS ""O1"" WHERE ""O1"".""sold_qty_last_year"">=10 UNION ALL (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"">='2019-05-23'))"
124,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
125,"SELECT ""b"".""book_id"" AS ""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""quantity"" FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23' GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""available_from""<='2019-05-23' AND COALESCE(""quantity"", 0)<10"
126,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
127,"SELECT ""b"".""book_id"" AS ""book_id"",""b"".""name"" AS ""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<='2019-05-23' GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' THEN ""quantity"" ELSE 0 END)<10"
128,"WITH ""cte_final"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""o"".""dispatch_date""<='2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte_final"""
129,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""book_id""=""B"".""book_id"" AND ""O"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">=30 GROUP BY ""B"".""book_id"",""B"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10 ORDER BY 1"
130,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
131,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
132,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'"
133,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""Books"".""book_id"" FROM ""Orders"" JOIN ""Books"" ON ""Orders"".""book_id""=""Books"".""book_id"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""books"".""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
134,"SELECT ""a"".""book_id"",""a"".""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">30) AS ""a"" LEFT JOIN (SELECT ""o"".""book_id"",SUM(""o"".""quantity"") AS ""total"" FROM ""orders"" AS ""o"" WHERE ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""o"".""book_id"") AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE ""b"".""total""<10 OR ""b"".""total"" IS NULL"
135,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
136,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
137,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""q"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" USING (""book_id"") WHERE ""o"".""q""<10 OR ""o"".""q"" IS NULL"
138,"WITH ""a"" AS (SELECT * FROM ""Books"" WHERE ""available_from""<'2019-05-23'), ""b"" AS (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') SELECT ""a"".""book_id"",""name"" FROM ""a"" LEFT JOIN ""b"" USING (""book_id"") GROUP BY 1,2 HAVING COALESCE(SUM(""quantity""), 0)<10"
139,"SELECT ""book_id"",""name"" FROM ""Books"" AS ""b"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" AS ""o"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
140,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
141,"SELECT ""books"".""book_id"",""name"" FROM ""books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""sold"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""orders"" ON ""books"".""book_id""=""orders"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""sold"" IS NULL OR ""sold""<10)"
142,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
143,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_count_sold"".""book_id""=""B"".""book_id"" WHERE ""B"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND (""sub_count_sold"".""count_books"" IS NULL OR ""sub_count_sold"".""count_books""<10)"
144,"WITH ""old_books"" AS (SELECT * FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""sold"" AS (SELECT ""a"".""book_id"",""a"".""name"",COALESCE((""quantity""), 0) AS ""quantity"" FROM ""old_books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""b"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' OR ""b"".""dispatch_date"" IS NULL) SELECT ""book_id"",""name"" FROM ""sold"" GROUP BY 1,2 HAVING SUM(""quantity"")<10"
145,"SELECT ""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" USING (""book_id"") WHERE ""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
146,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-6-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
147,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<365 GROUP BY 1 HAVING SUM(""quantity"")>9) AND CAST('2019-06-23' AS DATE) - ""available_from"">30"
148,"SELECT ""t"".""book_id"",""t"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""t"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') AS ""orders"" ON ""t"".""book_id""=""orders"".""book_id"" GROUP BY ""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
149,"WITH ""temp"" AS (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(""o"".""quantity"", 0) AS ""quantity"",CASE WHEN ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' THEN 1 ELSE 0 END AS ""lastyear"" FROM ""books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23'), ""t1"" AS (SELECT DISTINCT ""book_id"",""name"",SUM(""quantity""*""lastyear"") AS ""sold"" FROM ""temp"" GROUP BY ""book_id"") SELECT ""book_id"",""name"" FROM ""t1"" WHERE ""sold""<10"
150,"SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' WHERE ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23') GROUP BY ""b"".""book_id"" HAVING SUM(""o"".""quantity"") IS NULL OR SUM(""o"".""quantity"")<10"
151,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
152,"SELECT ""book_id"",""name"" FROM ""books"" WHERE CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH'>=""available_from"" AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
153,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
154,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""dispatch_date"", 0)<365 WHERE ""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
155,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""num_sold"" FROM ""Orders"" AS ""o"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' GROUP BY ""book_id"") AS ""o1"" ON ""b"".""book_id""=""o1"".""book_id"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' AND (""num_sold""<10 OR ""num_sold"" IS NULL)"
156,"WITH ""T1"" AS (SELECT ""book_id"",""name"",""available_from"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30), ""T2"" AS (SELECT ""T1"".""book_id"",""T1"".""name"",SUM(CASE WHEN ""O"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' THEN ""O"".""quantity"" ELSE 0 END) AS ""NUM"" FROM ""T1"" LEFT JOIN ""Orders"" AS ""O"" ON ""T1"".""book_id""=""O"".""book_id"" GROUP BY ""T1"".""book_id"",""T1"".""name"") SELECT ""book_id"",""name"" FROM ""T2"" WHERE ""NUM""<10"
157,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""o"".""book_id"",SUM(""quantity"") AS ""total_quantity"" FROM ""Orders"" AS ""o"" WHERE ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""o"".""book_id"") AS ""b_less"" ON ""b"".""book_id""=""b_less"".""book_id"" WHERE COALESCE(""total_quantity"", 0)<10 AND ""b"".""available_from""<='2019-05-23'"
158,"WITH ""cte"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH'), ""cte1"" AS (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10) SELECT * FROM ""cte"" WHERE ""book_id"" NOT IN (SELECT * FROM ""cte1"")"
159,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
160,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
161,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""books"" WHERE ""available_from"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH') GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' THEN ""quantity"" ELSE 0 END)<10"
162,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""ORDERS"" AS ""o"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""a"" USING (""book_id"") WHERE ""available_from""<'2019-05-23' AND (""total""<10 OR ""TOTAL"" IS NULL)"
163,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""book_id"" HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
164,"WITH ""bookst"" AS (SELECT * FROM ""books"" WHERE (""available_from""<=STR_TO_DATE('2019-05-23', '%Y-%m-%d'))), ""orderst"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""quantity"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN STR_TO_DATE('2018-06-23', '%Y-%m-%d') AND STR_TO_DATE('2019-06-23', '%Y-%m-%d') GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""orderst"" AS ""o"" RIGHT JOIN ""bookst"" AS ""b"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""o"".""quantity""<10 OR ""o"".""quantity"" IS NULL"
165,"SELECT ""book_id"",""name"" FROM (SELECT ""books"".""book_id"",""name"",COALESCE(SUM(""quantity""), 0) AS ""b"" FROM ""books"" LEFT JOIN ""orders"" AS ""t"" ON ""books"".""book_id""=""t"".""book_id"" AND ""dispatch_date"">'2018-06-23' WHERE ""available_from""<'2019-05-23' GROUP BY ""books"".""book_id"" HAVING ""b""<10) AS ""m"""
166,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' WHERE ""b"".""available_from""<='2019-05-23' GROUP BY 1,2 HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
167,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
168,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
169,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""Books"" AS ""a"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""n_sold"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' GROUP BY ""book_id"") AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE COALESCE(""n_sold"", 0)<10 AND ""a"".""available_from""<='2019-05-24'"
170,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
171,"WITH ""o"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""Orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1), ""b"" AS (SELECT * FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""name"",COALESCE(""total"", 0) AS ""total"" FROM ""b"" LEFT JOIN ""o"" ON ""b"".""book_id""=""o"".""book_id"") AS ""temp"" WHERE ""total""<10"
172,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""Books"" AS ""b"" ON ""o"".""book_id""=""b"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
173,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""Books"" WHERE ""available_from""<'2019-05-23') AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""b"".""book_id"" HAVING SUM(""o"".""quantity"")<10 OR SUM(""o"".""quantity"") IS NULL"
174,"WITH ""t"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""t"" USING (""book_id"") WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND (""t"".""total""<10 OR ""t"".""total"" IS NULL)"
175,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(SUM(""o"".""quantity""), 0) AS ""quantity"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""b"".""book_id"") AS ""temp"" ON ""b"".""book_id""=""temp"".""book_id"" AND ""b"".""available_from""<='2019-05-23' AND ""temp"".""quantity""<10"
176,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
177,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(SUM(""o"".""quantity""), 0) AS ""quantity"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""b"".""book_id"") AS ""temp"" ON ""b"".""book_id""=""temp"".""book_id"" AND ""b"".""available_from""<='2019-05-23' AND ""temp"".""quantity""<10"
178,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
179,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT ""book_id"",SUM(""quantity"") AS ""q"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-24' GROUP BY ""book_id"" HAVING ""q"">=10) AS ""t1"") AND ""book_id"" IN (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from""<'2019-05-23')"
180,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
181,"WITH ""avail"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH'), ""sold"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") SELECT ""a"".""book_id"",""a"".""name"" FROM ""avail"" AS ""a"" LEFT JOIN ""sold"" AS ""s"" ON ""a"".""book_id""=""s"".""book_id"" WHERE COALESCE(""s"".""total"", 0)<10"
182,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<'2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""o"".""quantity"") IS NULL OR SUM(""o"".""quantity"")<10"
183,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
184,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY 1,2 HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
185,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
186,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total_sold"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' AND COALESCE(""o"".""total_sold"", 0)<10 ORDER BY ""b"".""book_id"""
187,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
188,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY 1,2 HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
189,"SELECT ""book_id"",""name"" FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
190,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY 1,2 HAVING COALESCE(SUM(""quantity""), 0)<10"
191,"WITH ""book_sales"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""qty"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' GROUP BY 1) SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""book_sales"" AS ""bs"" ON ""b"".""book_id""=""bs"".""book_id"" WHERE (""qty""<10 OR ""qty"" IS NULL) AND ""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH'"
192,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" AS ""o"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND CAST('2019-06-23' AS DATE) - ""available_from"">30"
193,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
194,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""b"".""name"",""o"".""dispatch_date"",""o"".""quantity"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH') AS ""tmp"" ON ""tmp"".""book_id""=""b"".""book_id"" GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""tmp"".""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' THEN ""tmp"".""quantity"" ELSE 0 END)<10"
195,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""o"".""book_id"" IS NULL"
196,"WITH ""temp"" AS (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) SELECT ""books"".""book_id"",""name"" FROM ""Books"" LEFT JOIN ""temp"" ON ""books"".""book_id""=""temp"".""book_id"" WHERE ""available_from""<'2019-05-23' AND ""temp"".""book_id"" IS NULL"
197,"WITH ""book2"" AS (SELECT * FROM ""books"" WHERE ""available_from"" NOT BETWEEN '2019-05-23' AND '2019-06-23'), ""order2"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total_quantity"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""book2"" AS ""b"" LEFT JOIN ""order2"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE COALESCE(""o"".""total_quantity"", 0)<10"
198,"WITH ""t_avail"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23'), ""t_qty"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""quantity"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' GROUP BY ""book_id""), ""t_final"" AS (SELECT ""t_avail"".""book_id"",""t_avail"".""name"",COALESCE(""t_qty"".""quantity"", 0) AS ""QTY"" FROM ""t_avail"" LEFT JOIN ""t_qty"" ON ""t_qty"".""book_id""=""t_avail"".""book_id"") SELECT ""book_id"",""name"" FROM ""t_final"" WHERE ""QTY""<10"
199,"WITH ""T1"" AS (SELECT * FROM ""Books"" WHERE '2019-06-23'>""available_from"" + INTERVAL '1 MONTH') SELECT ""book_id"",""name"" FROM ""T1"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" + INTERVAL '1 YEAR'>='2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) ORDER BY ""book_id"""
200,"WITH ""cte"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""num"" FROM ""orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"" HAVING ""num"">=10) SELECT ""a"".""book_id"",""a"".""name"" FROM ""books"" AS ""a"" WHERE ""a"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""cte"") AND ""available_from""<'2019-05-23'"
201,"SELECT ""book_id"",""name"" FROM ""Books"" AS ""b"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" AS ""o"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-22' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
202,"SELECT ""t1"".""book_id"",""t1"".""name"" FROM ""books"" AS ""t1"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""book_sold"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""t2"" ON ""t1"".""book_id""=""t2"".""book_id"" WHERE ""available_from""<'2019-05-23' AND (""book_sold"" IS NULL OR ""book_sold""<10) ORDER BY ""t1"".""book_id"""
203,"SELECT ""book_id"",""name"" FROM ""books"" WHERE (""book_id"" IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from""<'2019-05-23')) AND (""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10))"
204,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""Books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(COALESCE(""quantity"", 0))<10"
205,"SELECT ""C"".""BOOK_ID"",""C"".""NAME"" FROM (SELECT ""A"".""BOOK_ID"",""A"".""NAME"",SUM(""B"".""QUANTITY"") AS ""TOTAL"" FROM (SELECT * FROM ""BOOKS"" WHERE ""available_from""<'2019-05-23') AS ""A"" LEFT JOIN (SELECT * FROM ""ORDERS"" WHERE ""dispatch_date"">'2018-06-23') AS ""B"" ON ""A"".""BOOK_ID""=""B"".""BOOK_ID"" GROUP BY ""A"".""BOOK_ID"") AS ""C"" WHERE ""C"".""TOTAL"" IS NULL OR ""C"".""TOTAL""<10"
206,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
207,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23') AS ""o"" USING (""book_id"") GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
208,"SELECT ""Books"".""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" ON ""Books"".""book_id""=""Orders"".""book_id"" WHERE ""Books"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""Books"".""book_id"",""Books"".""name"" HAVING SUM(CASE WHEN (""Orders"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""Orders"".""quantity"", 0)) ELSE 0 END)<10"
209,"WITH ""cte"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""ct"" FROM ""Orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(""cte"".""ct"", 0) FROM (SELECT * FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""b"" LEFT JOIN ""cte"" USING (""book_id"") WHERE COALESCE(""cte"".""ct"", 0)<10) AS ""c"""
210,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<='2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
211,"WITH ""cte"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23') SELECT ""cte"".""book_id"",""cte"".""name"" FROM ""cte"" LEFT JOIN ""orders"" ON ""orders"".""book_id""=""cte"".""book_id"" AND (""orders"".""dispatch_date""<'2019-06-23' AND ""orders"".""dispatch_date"">'2018-06-23') GROUP BY 1 HAVING SUM(COALESCE(""orders"".""quantity"", 0))<10"
212,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
213,"WITH ""cte_final"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""o"".""dispatch_date""<='2019-06-23' WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte_final"""
214,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
215,"WITH ""temp_book"" AS (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23') SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""temp_book"" AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""quantity""), 0)<10"
216,"WITH ""S0"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""quantity"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-23' GROUP BY ""book_id""), ""S1"" AS (SELECT ""Books"".""book_id"",COALESCE(""quantity"", 0) AS ""quantity"" FROM ""S0"" RIGHT JOIN ""Books"" ON ""S0"".""book_id""=""Books"".""book_id""), ""S2"" AS (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"">='2019-05-23'), ""S3"" AS (SELECT ""book_id"" FROM ""S1"" WHERE ""quantity""<10 AND ""book_id"" NOT IN (SELECT * FROM ""S2"")) SELECT ""S3"".""book_id"",""name"" FROM ""S3"" JOIN ""Books"" ON ""Books"".""book_id""=""S3"".""book_id"""
217,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
218,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""count_books"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""sub_count_sold"" ON ""sub_count_sold"".""book_id""=""B"".""book_id"" WHERE ""B"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND (""sub_count_sold"".""count_books"" IS NULL OR ""sub_count_sold"".""count_books""<10)"
219,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY ""b"".""book_id"" HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
220,"WITH ""quantity"" AS (SELECT ""book_id"",SUM(""date_ck"") AS ""ttl"" FROM (SELECT ""book_id"",CASE WHEN ""dispatch_date"">'2018-06-23' THEN ""quantity"" ELSE 0 END AS ""date_ck"" FROM ""orders"") AS ""t1"" GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""quantity"" AS ""q"" ON ""b"".""book_id""=""q"".""book_id"" WHERE COALESCE(""q"".""ttl"", 0)<10 AND ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
221,"WITH ""book_recent"" AS (SELECT * FROM ""Books"" WHERE ""available_from""<'2019-05-23') SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<365) AS ""o"" RIGHT JOIN ""book_recent"" AS ""b"" ON ""o"".""book_id""=""b"".""book_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""o"".""quantity"" IS NOT NULL THEN ""o"".""quantity"" ELSE 0 END)<10"
222,"SELECT ""books"".""book_id"",""books"".""name"" FROM ""books"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"">'2018-06-23') AS ""s"" ON ""books"".""book_id""=""s"".""book_id"" WHERE ""available_from""<'2019-05-23' GROUP BY ""books"".""book_id"",""name"" HAVING SUM(COALESCE(""quantity"", 0))<10"
223,"SELECT ""B"".""book_id"",""B"".""name"" FROM (""Books"" AS ""B"") CROSS JOIN ""Orders"" AS ""O"" WHERE ""available_from""<='2019-05-23' AND ""B"".""book_id""=""O"".""book_id"" GROUP BY ""B"".""book_id"" HAVING SUM(""quantity""*(""dispatch_date"">='2018-06-23'))<10 UNION SELECT ""book_id"",""name"" FROM ""Books"" AS ""B"" WHERE ""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""Orders"" AS ""O"")"
224,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
225,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON (""o"".""book_id""=""b"".""book_id"" AND (""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23')) WHERE ""b"".""available_from"" + INTERVAL '1 MONTH'<=STR_TO_DATE('2019-06-23', '%Y-%m-%d') GROUP BY ""b"".""book_id"",""b"".""name"" HAVING 10>SUM(""o"".""quantity"") OR SUM(""o"".""quantity"") IS NULL"
226,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
227,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""book_sold"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE (""book_sold"" IS NULL OR ""book_sold""<10) AND ""b"".""available_from""<'2019-05-23'"
228,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
229,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",""quantity"" FROM ""orders"" WHERE ""dispatch_date"">'2018-06-23') AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE ""b"".""available_from"" NOT BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '29 DAY' AND '2019-06-23' GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""t"".""quantity""), 0)<10"
230,"WITH ""t"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""t"" USING (""book_id"") WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND (""t"".""total""<10 OR ""t"".""total"" IS NULL)"
231,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""quantity""), 0)<10"
232,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND CAST('2019-06-23' AS DATE) - ""o"".""dispatch_date""<=365 WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">=30 GROUP BY 1,2 HAVING SUM(""o"".""quantity"")<10 OR SUM(""o"".""quantity"") IS NULL"
233,"SELECT ""Books"".""book_id"",""name"" FROM ""Books"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""num_total"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1) AS ""l"" ON ""l"".""book_id""=""Books"".""book_id"" WHERE (""l"".""num_total""<10 OR ""l"".""num_total"" IS NULL) AND ""Books"".""available_from""<='2019-05-23'"
234,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
235,"SELECT ""books"".""book_id"",""name"" FROM ""books"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') AS ""o1"" ON ""books"".""book_id""=""o1"".""book_id"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""books"".""book_id"" HAVING SUM(COALESCE(""quantity"", 0))<10"
236,"SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' AND ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
237,"WITH ""cte"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""ct"" FROM ""orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(""cte"".""ct"", 0) FROM (SELECT * FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""b"" LEFT JOIN ""cte"" USING (""book_id"") WHERE COALESCE(""cte"".""ct"", 0)<10) AS ""c"""
238,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" WHERE ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10) AND ""b"".""available_from""<='2019-05-23' GROUP BY 1,2"
239,"SELECT ""book_id"",""name"" FROM ""books"" AS ""b"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
240,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
241,"WITH ""x"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""quantity_sold"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23' GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""x"" AS ""a"" RIGHT JOIN ""books"" AS ""b"" USING (""book_id"") WHERE COALESCE(""a"".""quantity_sold"", 0)<10 AND ""b"".""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH'"
242,"SELECT ""BOOK_ID"",""NAME"" FROM (SELECT ""B"".""BOOK_ID"",""NAME"",COALESCE(""TTL"", 0) AS ""TTL2"",""AVAILABLE_FROM"" FROM ""BOOKS"" AS ""B"" LEFT JOIN (SELECT ""BOOK_ID"",SUM(""QUANTITY"") AS ""TTL"" FROM ""ORDERS"" WHERE ""DISPATCH_DATE"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""BOOK_ID"") AS ""X"" ON ""B"".""BOOK_ID""=""X"".""BOOK_ID"") AS ""Y"" WHERE ""TTL2""<10 AND CAST('2019-06-23' AS DATE) - ""AVAILABLE_FROM"">30"
243,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE TIMESTAMPDIFF(MONTH, ""available_from"", '2019-06-23')>1 GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN TIMESTAMPDIFF(YEAR, ""dispatch_date"", '2019-06-23')=0 THEN ""quantity"" ELSE 0 END)<10"
244,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""B"".""book_id"" HAVING COALESCE(SUM(CASE WHEN CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 THEN ""quantity"" ELSE 0 END), 0)<10"
245,"WITH ""cte"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""o"".""dispatch_date""<='2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte"""
246,"SELECT ""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" USING (""book_id"") WHERE ""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
247,"SELECT DISTINCT ""Books"".""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" ON ""Orders"".""book_id""=""Books"".""book_id"" AND ""dispatch_date"">CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' WHERE ""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY 1,2 HAVING COALESCE(SUM(""quantity""), 0)<10"
248,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
249,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
250,"WITH ""a"" AS (SELECT * FROM ""books"" WHERE ""available_from""<'2019-05-23'), ""b"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""sales"" FROM ""orders"" WHERE ""dispatch_date""<='2019-06-23' AND ""dispatch_date"">='2018-06-23' GROUP BY ""book_id"") SELECT ""a"".""book_id"",""name"" FROM ""a"" LEFT JOIN ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE ""sales""<10 OR ""sales"" IS NULL"
251,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
252,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY 1,2 HAVING COALESCE(SUM(""quantity""), 0)<10"
253,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">DATE('2018-06-23') WHERE ""b"".""available_from""+30<=DATE('2019-06-23') GROUP BY ""b"".""book_id"" HAVING SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL"
254,"WITH ""temp"" AS (SELECT ""book_id"",""quantity"",SUM(""quantity"") AS ""tt"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1), ""temp2"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23') SELECT ""a"".""book_id"",""a"".""name"" FROM ""temp2"" AS ""a"" LEFT JOIN ""temp"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE COALESCE(""tt"", 0)<10"
255,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
256,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
257,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
258,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""o"".""quantity"") IS NULL OR SUM(""quantity"")<10"
259,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(SUM(""o"".""quantity""), 0) AS ""quantity"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""b"".""book_id"") AS ""temp"" ON ""b"".""book_id""=""temp"".""book_id"" AND ""b"".""available_from""<='2019-05-23' AND ""temp"".""quantity""<10"
260,"SELECT ""b"".""book_id"" AS ""book_id"",""b"".""name"" AS ""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
261,"SELECT ""a"".""book_id"",""a"".""name"" FROM (SELECT * FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30) AS ""a"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date"" BETWEEN 0 AND 365) AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" GROUP BY ""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
262,"WITH ""cte"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""ct"" FROM ""Orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(""cte"".""ct"", 0) FROM (SELECT * FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""b"" LEFT JOIN ""cte"" USING (""book_id"") WHERE COALESCE(""cte"".""ct"", 0)<10) AS ""c"""
263,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
264,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-6-23' WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">30 GROUP BY ""book_id"" HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
265,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
266,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
267,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
268,"SELECT DISTINCT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23') AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
269,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1 HAVING SUM(""quantity"")>=10) AND ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'"
270,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"") AS ""ctp"" ON ""b"".""book_id""=""ctp"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""total""<10 OR ""total"" IS NULL"
271,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from"" NOT BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '30 DAY' AND '2019-06-23') AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '365 DAY' AND '2019-06-23' GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
272,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""Books"" AS ""b"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL ''1' MONTH' GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL ''1' YEAR' AND '2019-06-23' THEN ""o"".""quantity"" ELSE 0 END)<10"
273,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
274,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" - CAST('2018-06-23' AS DATE)>0) AS ""o"" GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND CAST('2019-05-23' AS DATE) - ""available_from"">0"
275,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<CAST('2019-05-23' AS DATE) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">=CAST('2018-06-23' AS DATE) GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
276,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
277,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
278,"SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from""<=30) GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date""<=365 THEN ""quantity"" ELSE 0 END)<10"
279,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
280,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
281,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
282,"WITH ""cte"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""ct"" FROM ""Orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",COALESCE(""cte"".""ct"", 0) FROM (SELECT * FROM ""Books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') AS ""b"" LEFT JOIN ""cte"" USING (""book_id"") WHERE COALESCE(""cte"".""ct"", 0)<10) AS ""c"""
283,"SELECT ""Books"".""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" ON ""Books"".""book_id""=""Orders"".""book_id"" AND CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30 GROUP BY 1 HAVING (SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL)"
284,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
285,"WITH ""T1"" AS (SELECT ""a"".""book_id"",""a"".""name"",SUM(""quantity"") AS ""count1"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""b"".""dispatch_date""<=365 GROUP BY ""a"".""book_id"") SELECT ""a"".""book_id"",""a"".""name"" FROM ""books"" AS ""a"" LEFT JOIN ""T1"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""a"".""available_from"">=30 AND ""b"".""count1""<10 OR ""b"".""count1"" IS NULL"
286,"WITH ""cte"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""qty"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' GROUP BY 1) SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""name"",COALESCE(""qty"", 0) AS ""qty"" FROM ""Books"" AS ""b"" LEFT JOIN ""cte"" USING (""book_id"") WHERE ""available_from""<='2019-05-24') AS ""t"" WHERE ""qty""<10"
287,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" WHERE ""B"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10) AND ""available_from""<'2019-05-23'"
288,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
289,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' WHERE ""b"".""book_id"" IS NULL OR ""a"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL"
290,"SELECT ""a"".""book_id"",""name"" FROM ""Books"" AS ""a"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""s"" FROM ""Orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY 1) AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND (""s"" IS NULL OR ""s""<10)"
291,"WITH ""s"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""copies"" FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY 1) SELECT ""b"".""book_id"",""b"".""name"" FROM ""s"" RIGHT JOIN ""books"" AS ""b"" ON ""b"".""book_id""=""s"".""book_id"" WHERE (""copies""<10 OR ""copies"" IS NULL) AND CAST('2019-06-23' AS DATE) - ""available_from"">=31"
292,"WITH ""exclude"" AS (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"">=DATE('2019-06-23') + INTERVAL '-1 MONTH' UNION SELECT ""two"".""book_id"" FROM (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN DATE('2018-06-23') AND DATE('2019-06-23')) AS ""two"" GROUP BY ""two"".""book_id"" HAVING SUM(""two"".""quantity"")>=10) SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""exclude"")"
293,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
294,"SELECT DISTINCT ""b"".""book_id"" AS ""book_id"",""b"".""name"" AS ""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""b"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">(CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
295,"SELECT ""name"",""book_id"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
296,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""b"".""book_id"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""quantity"" IS NULL THEN 0 ELSE ""quantity"" END)<10) AS ""a"" JOIN ""Books"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30"
297,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<'2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""o"".""quantity"") IS NULL OR SUM(""o"".""quantity"")<10"
298,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
299,"WITH ""final"" AS (WITH ""updated"" AS (WITH ""not_latest"" AS (SELECT * FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""b"".""book_id"" FROM ""Books"" AS ""b"" WHERE CAST('2019-06-23' AS DATE) - ""available_from""<30)) SELECT ""n"".""book_id"",""n"".""name"",""o"".""quantity"",""o"".""dispatch_date"" FROM ""not_latest"" AS ""n"" LEFT JOIN ""Orders"" AS ""o"" ON ""n"".""book_id""=""o"".""book_id"") SELECT ""book_id"",""name"",""dispatch_date"",CASE WHEN CAST('2019-06-23' AS DATE) - ""dispatch_date"">365 THEN 0 WHEN ""dispatch_date"" IS NULL THEN 0 ELSE ""quantity"" END AS ""updated_quantity"" FROM ""updated"") SELECT ""book_id"",""name"" FROM ""final"" GROUP BY ""book_id"" HAVING SUM(""updated_quantity"")<=9"
300,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" - CAST('2018-06-23' AS DATE)>0) AS ""o"" GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND CAST('2019-05-23' AS DATE) - ""available_from"">0"
301,"WITH ""BOOKS_ELEGIBLE"" AS (SELECT ""BOOK_ID"",""NAME"" FROM ""BOOKS"" WHERE ""AVAILABLE_FROM""<'2019-05-23') SELECT ""BOOKS_ELEGIBLE"".""BOOK_ID"",""BOOKS_ELEGIBLE"".""NAME"" FROM ""BOOKS_ELEGIBLE"" LEFT JOIN ""ORDERS"" ON ""BOOKS_ELEGIBLE"".""BOOK_ID""=""ORDERS"".""BOOK_ID"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""DISPATCH_DATE"">'2018-06-23' THEN ""QUANTITY"" ELSE 0 END)<10"
302,"WITH ""book_fliter"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23'), ""order_count"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""num_buy"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") SELECT ""f"".""book_id"",""name"" FROM ""book_fliter"" AS ""f"" LEFT JOIN ""order_count"" AS ""o"" ON ""f"".""book_id""=""o"".""book_id"" WHERE COALESCE(""num_buy"", 0)<10"
303,"SELECT DISTINCT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" WHERE ""B"".""available_from""<='2019-05-23' GROUP BY ""B"".""book_id"" HAVING SUM(CASE WHEN ""O"".""dispatch_date"" IS NULL THEN 0 WHEN ""O"".""dispatch_date"">='2018-06-23' THEN ""O"".""quantity"" ELSE 0 END)<10"
304,"SELECT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""b"".""name"",SUM(CASE WHEN ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND DATE('2019-06-23') THEN ""quantity"" ELSE 0 END) AS ""sold"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from"" NOT BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND DATE('2019-06-23') GROUP BY ""b"".""book_id"") AS ""t"" WHERE ""sold""<10"
305,"SELECT DISTINCT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""book_id""=""B"".""book_id"" WHERE ""B"".""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
306,"SELECT ""A"".""BOOK_ID"",""A"".""NAME"" FROM (SELECT * FROM ""BOOKS"" WHERE ""available_from""<'2019-05-23') AS ""A"" LEFT JOIN (SELECT * FROM ""ORDERS"" WHERE ""dispatch_date"">'2018-06-23') AS ""B"" ON ""A"".""BOOK_ID""=""B"".""BOOK_ID"" GROUP BY ""A"".""BOOK_ID"" HAVING SUM(""B"".""QUANTITY"") IS NULL OR SUM(""B"".""QUANTITY"")<10"
307,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
308,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""b"".""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' WHERE ""a"".""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""quantity"", 0))<10"
309,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from"" NOT BETWEEN '2019-05-23' AND '2019-06-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
310,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
311,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
312,"SELECT ""t1"".""book_id"",""t1"".""name"" FROM ""books"" AS ""t1"" LEFT JOIN ""orders"" AS ""t2"" ON ""t1"".""book_id""=""t2"".""book_id"" AND CAST('2019-06-23' AS DATE) - ""t2"".""dispatch_date""<=365 WHERE ABS(CAST('2019-06-23' AS DATE) - ""t1"".""available_from"")>30 GROUP BY ""t1"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
313,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=31 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
314,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23') AS ""o"" USING (""book_id"") GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
315,"WITH ""cte"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from"" NOT BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '31 DAY' AND '2019-06-23') SELECT ""book_id"",""name"" FROM ""cte"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" USING (""book_id"") GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' THEN ""quantity"" ELSE 0 END)<10"
316,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"" HAVING SUM(""o"".""quantity"")<10 OR SUM(""o"".""quantity"") IS NULL"
317,"SELECT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""dispatch_date"", 0)<=365 WHERE COALESCE(CAST('2019-06-23' AS DATE) - ""available_from"", 0)>30 GROUP BY 1 HAVING COALESCE(SUM(""quantity""), 0)<10"
318,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""name"",COALESCE(SUM(""quantity""), 0) AS ""quantity"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">='2018-06-23' GROUP BY ""book_id"",""name"") AS ""n"" ON ""b"".""book_id""=""n"".""book_id"" AND ""b"".""available_from""<='2019-05-23' AND ""quantity""<10"
319,"WITH ""tmp"" AS (SELECT ""a"".""book_id"",""name"",SUM(COALESCE(""quantity"", 0)) AS ""total"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""dispatch_date"" + INTERVAL '1 YEAR'>=DATE('2019-06-23') GROUP BY ""a"".""book_id"",""name"") SELECT ""book_id"",""name"" FROM ""tmp"" WHERE ""total""<10 AND ""book_id"" NOT IN (SELECT ""b"".""book_id"" FROM ""books"" AS ""b"" WHERE ""available_from"" + INTERVAL '1 MONTH'>DATE('2019-06-23'))"
320,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT ""book_id"",""quantity"" FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" GROUP BY ""b"".""book_id"" HAVING SUM(CASE WHEN ""o"".""quantity"" IS NOT NULL THEN ""o"".""quantity"" ELSE 0 END)<10"
321,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""nsold"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE (""o"".""nsold""<10 OR ""o"".""nsold"" IS NULL) AND CAST('2019-06-23' AS DATE) - ""b"".""available_from"">30"
322,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""quantity"") IS NULL OR SUM(""quantity"")<10"
323,"SELECT DISTINCT ""book_id"",""name"" FROM (SELECT ""b"".""book_id"",""name"",""available_from"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND CAST('2019-06-23' AS DATE) - ""dispatch_date""<=364 GROUP BY 1 HAVING SUM(COALESCE(""quantity"", 0))<10) AS ""t"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30"
324,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
325,"WITH ""t"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"") SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""t"" USING (""book_id"") WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND (""t"".""total""<10 OR ""t"".""total"" IS NULL)"
326,"WITH ""cte"" AS (SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10) SELECT * FROM ""cte"""
327,"SELECT ""b"".""book_id"",""name"" FROM ""Books"" AS ""b"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT DISTINCT ""b"".""book_id"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""b"".""book_id"" HAVING SUM(""quantity"")>=10)"
328,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT * FROM ""Books"" WHERE ""available_from""<='2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23') AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" GROUP BY ""b"".""book_id"" HAVING SUM(""o"".""quantity"") IS NULL OR SUM(""o"".""quantity"")<10"
329,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND CAST('2019-6-23' AS DATE) - ""o"".""dispatch_date""<=365 WHERE ""b"".""available_from""<'2019-5-23' GROUP BY ""b"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
330,"WITH ""sold"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""q"" FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")<10), ""sold_10"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""q"" FROM ""orders"" WHERE ""dispatch_date"">='2018-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10), ""b"" AS (SELECT ""book_id"",""name"",""available_from"" FROM ""books"" WHERE ""available_from""<='2019-05-23') SELECT ""b"".""book_id"" AS ""book_id"",""b"".""name"" AS ""name"" FROM ""sold"" JOIN ""b"" ON ""sold"".""book_id""=""b"".""book_id"" UNION SELECT ""b1"".""book_id"" AS ""book_id"",""b1"".""name"" FROM ""b"" AS ""b1"" WHERE ""b1"".""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""sold_10"")"
331,"WITH ""cte"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""cte1"" AS (SELECT ""order_id"",""book_id"",""quantity"" FROM ""orders"" WHERE ""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""dispatch_date""<'2019-06-23') SELECT ""cte"".""book_id"",""cte"".""name"" FROM ""cte1"" RIGHT JOIN ""cte"" ON ""cte1"".""book_id""=""cte"".""book_id"" GROUP BY 1,2 HAVING SUM(COALESCE(""cte1"".""quantity"", 0))<10"
332,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
333,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" JOIN (SELECT ""b"".""book_id"",""b"".""name"",""o"".""dispatch_date"",""o"".""quantity"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" WHERE ""b"".""available_from""<CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH') AS ""tmp"" ON ""tmp"".""book_id""=""b"".""book_id"" GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""tmp"".""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' THEN ""tmp"".""quantity"" ELSE 0 END)<10"
334,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
335,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE ""b"".""available_from""<'2019-05-23' AND (""t"".""total""<10 OR ""t"".""total"" IS NULL)"
336,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
337,"SELECT ""BOOKS"".""BOOK_ID"",""NAME"" FROM ""BOOKS"" LEFT JOIN ""ORDERS"" USING (""BOOK_ID"") WHERE ""available_from""<'2019-05-23' GROUP BY ""BOOKS"".""BOOK_ID"" HAVING SUM(CASE WHEN ""DISPATCH_DATE"" BETWEEN '2018-06-23' AND '2019-06-23' THEN ""QUANTITY"" ELSE 0 END)<10"
338,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
339,"WITH ""CTE"" AS (SELECT ""d1"".""book_id"",""d1"".""name"",SUM(CASE WHEN ""dispatch_date"">=DATE('2018-06-24') AND ""dispatch_date""<=DATE('2019-06-23') THEN ""quantity"" ELSE 0 END) AS ""total_quantity"" FROM ""Books"" AS ""d1"" LEFT JOIN ""Orders"" AS ""d2"" ON ""d1"".""book_id""=""d2"".""book_id"" GROUP BY ""d1"".""book_id"",""d1"".""name"" HAVING SUM(CASE WHEN ""dispatch_date"">=DATE('2018-06-24') AND ""dispatch_date""<=DATE('2019-06-23') THEN ""quantity"" ELSE 0 END)<10) SELECT ""book_id"",""name"" FROM ""CTE"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' AND DATE('2019-06-23'))"
340,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
341,"WITH ""available"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""sold"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""total"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"") SELECT ""a"".""book_id"",""a"".""name"" FROM ""available"" AS ""a"" LEFT JOIN ""sold"" AS ""s"" ON ""a"".""book_id""=""s"".""book_id"" WHERE COALESCE(""total"", 0)<10"
342,"WITH ""tmp"" AS (SELECT ""a"".""book_id"",""name"",SUM(COALESCE(""quantity"", 0)) AS ""total"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""dispatch_date"" + INTERVAL '1 YEAR'>=DATE('2019-06-23') GROUP BY ""a"".""book_id"",""name"") SELECT ""book_id"",""name"" FROM ""tmp"" WHERE ""total""<10 AND ""book_id"" NOT IN (SELECT ""b"".""book_id"" FROM ""books"" AS ""b"" WHERE ""available_from"" + INTERVAL '1 MONTH'>DATE('2019-06-23'))"
343,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
344,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
345,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"">'2018-06-23' GROUP BY 1 HAVING SUM(""quantity"")>=10)"
346,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
347,"WITH ""old_books"" AS (SELECT * FROM ""books"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH'), ""sold"" AS (SELECT ""a"".""book_id"",""a"".""name"",COALESCE((""quantity""), 0) AS ""quantity"" FROM ""old_books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""b"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23') SELECT ""book_id"",""name"" FROM ""sold"" GROUP BY 1,2 HAVING SUM(""quantity"")<10"
348,"SELECT ""a"".""book_id"",""name"" FROM (SELECT * FROM ""Books"" WHERE ""available_from""<'2019-05-23') AS ""a"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-24' AND '2019-06-23') AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" GROUP BY 1 HAVING SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL"
349,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
350,"SELECT ""book_id"",""name"" FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">31 AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<365 GROUP BY 1 HAVING SUM(""quantity"")>=10)"
351,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM (SELECT ""book_id"",SUM(""quantity"") AS ""sold_qty_2018"" FROM ""Orders"" WHERE TIMESTAMPDIFF(DAY, ""dispatch_date"", '2019-06-23')<=365 GROUP BY ""book_id"") AS ""O1"" WHERE ""O1"".""sold_qty_2018"">=10 UNION ALL (SELECT ""book_id"" FROM ""Books"" WHERE ""available_from"">='2019-05-23'))"
352,"WITH ""valid_books"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ABS(""available_from"" - CAST('2019-06-23' AS DATE))>30), ""valid_orders"" AS (SELECT * FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' AND '2019-06-23') SELECT ""b"".""book_id"",""b"".""name"" FROM ""valid_books"" AS ""b"" LEFT JOIN ""valid_orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
353,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
354,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""name"" HAVING COALESCE(SUM(""quantity""), 0)<10"
355,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND (CAST('2019-06-23' AS DATE) - ""o"".""dispatch_date"">=0 AND CAST('2019-06-23' AS DATE) - ""o"".""dispatch_date""<=365) WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">=30 GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN ""o"".""quantity"" IS NOT NULL THEN ""o"".""quantity"" ELSE 0 END)<10"
356,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""a"" ON ""a"".""book_id""=""b"".""book_id"" AND ""a"".""dispatch_date"">=CAST('2019-06-23' AS DATE) + INTERVAL '-1 YEAR' WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) + INTERVAL '-1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(COALESCE(""quantity"", 0))<10"
357,"SELECT ""book_id"",""name"" FROM ""Books"" LEFT JOIN ""Orders"" USING (""book_id"") WHERE ""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
358,"SELECT ""books"".""book_id"",""books"".""name"" FROM ""books"" LEFT JOIN ""orders"" ON ""books"".""book_id""=""orders"".""book_id"" WHERE ""available_from""<CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""books"".""book_id"",""books"".""name"" HAVING SUM(CASE WHEN ""orders"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN (COALESCE(""orders"".""quantity"", 0)) ELSE 0 END)<10"
359,"SELECT ""c"".""book_id"",""c"".""name"" FROM (SELECT ""a"".""book_id"",""a"".""name"",COALESCE(SUM(""b"".""quantity""), 0) AS ""total"" FROM (SELECT * FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30) AS ""a"" LEFT JOIN (SELECT * FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365) AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" GROUP BY 1,2) AS ""c"" WHERE ""c"".""total""<10"
360,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10)"
361,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""o"".""dispatch_date"">CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND ""o"".""dispatch_date""<='2019-06-23' WHERE ""available_from""<='2019-06-23' AND NOT ""available_from"">CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY 1,2 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
362,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"">='2018-06-23' AND ""dispatch_date""<='2019-06-23' WHERE ""available_from""<'2019-05-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""quantity"")<10 OR SUM(""quantity"") IS NULL"
363,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE ""b"".""available_from""<'2019-05-23' GROUP BY 1 HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
364,"SELECT ""books"".""book_id"",""books"".""name"" FROM ""Books"" LEFT JOIN ""Orders"" AS ""o"" ON ""Books"".""book_id""=""o"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY ""books"".""book_id"" HAVING COALESCE(SUM(""quantity""), 0)<10"
365,"WITH ""cte"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">=30), ""cte2"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""quantity"" FROM ""orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id"") SELECT ""a"".""book_id"",""name"" FROM ""cte"" AS ""a"" LEFT JOIN ""cte2"" AS ""b"" USING (""book_id"") WHERE ""quantity""<10 OR ""quantity"" IS NULL"
366,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""books"" AS ""b"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""book_id""=""b"".""book_id"" AND (""o"".""dispatch_date"") BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""b"".""available_from"">=31 GROUP BY 1 HAVING SUM(COALESCE(""o"".""quantity"", 0))<10"
367,"WITH ""a"" AS (SELECT * FROM ""Books"" WHERE ""available_from""<='2019-5-23'), ""b"" AS (SELECT ""a"".""book_id"",""a"".""name"",CASE WHEN ""o"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-6-23' THEN ""quantity"" ELSE 0 END AS ""q"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""a"" ON ""o"".""book_id""=""a"".""book_id"") SELECT ""book_id"",""name"" FROM ""b"" GROUP BY ""book_id"" HAVING SUM(""q"")<10"
368,"WITH ""cte1"" AS (SELECT ""book_id"",SUM(""quantity"") AS ""k1"" FROM ""Orders"" WHERE CAST('2019-06-23' AS DATE) - ""dispatch_date""<=365 GROUP BY ""book_id""), ""cte2"" AS (SELECT DISTINCT ""o"".""book_id"",""b"".""name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Books"" AS ""b"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""o"".""book_id"" NOT IN (SELECT ""book_id"" FROM ""cte1"" WHERE ""k1"">=10)), ""cte4"" AS (SELECT DISTINCT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""B"" WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30) SELECT ""cte4"".""book_id"",""cte4"".""name"" FROM ""cte4"" LEFT JOIN ""cte2"" ON ""cte2"".""book_id""=""cte4"".""book_id"" WHERE ""cte2"".""book_id"" IS NOT NULL OR ""cte4"".""book_id"" NOT IN (SELECT DISTINCT ""book_id"" FROM ""orders"")"
369,"SELECT DISTINCT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""book_id""=""B"".""book_id"" WHERE ""B"".""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">='2018-06-23' THEN ""quantity"" ELSE 0 END)<10"
370,"SELECT ""a"".""book_id"",""a"".""name"" FROM ""books"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""b"".""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE CAST('2019-06-23' AS DATE) - ""available_from"">30 GROUP BY 1,2 HAVING COALESCE(SUM(""b"".""quantity""), 0)<10"
371,"SELECT ""b"".""book_id"",""name"" FROM ""books"" AS ""b"" LEFT JOIN (SELECT ""book_id"",SUM(""quantity"") AS ""sold"" FROM ""orders"" WHERE ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' GROUP BY ""book_id"") AS ""t"" ON ""b"".""book_id""=""t"".""book_id"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' AND ""sold""<10 OR ""sold"" IS NULL"
372,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" WHERE ""b"".""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(CASE WHEN (""o"".""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR') THEN (COALESCE(""o"".""quantity"", 0)) ELSE 0 END)<10"
373,"WITH ""book"" AS (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<=CAST('2019-06-23' AS DATE) - INTERVAL '1 MONTH') SELECT ""b"".""book_id"",""b"".""name"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""book"" AS ""b"" ON ""a"".""book_id""=""b"".""book_id"" AND ""a"".""dispatch_date"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' AND '2019-06-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""a"".""quantity"")<10 OR SUM(""a"".""quantity"") IS NULL"
374,"SELECT ""b"".""book_id"",""b"".""name"" FROM ""Books"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""book_id""=""o"".""book_id"" AND ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' WHERE NOT ""b"".""available_from"" BETWEEN CAST('2019-06-23' AS DATE) - INTERVAL '31 DAY' AND '2019-06-23' GROUP BY ""b"".""book_id"",""b"".""name"" HAVING COALESCE(SUM(""o"".""quantity""), 0)<10"
375,"SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"">'2019-05-23')"
376,"SELECT ""b"".""book_id"",""b"".""name"" FROM (SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""available_from""<'2019-05-23') AS ""b"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""dispatch_date"">='2018-06-23') AS ""o"" USING (""book_id"") GROUP BY ""b"".""book_id"",""b"".""name"" HAVING SUM(""o"".""quantity"") IS NULL OR SUM(""o"".""quantity"")<10"
377,"SELECT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""B"".""book_id""=""O"".""book_id"" AND COALESCE(CAST('2019-06-23' AS DATE) - ""O"".""dispatch_date"", 0)<365 WHERE CAST('2019-06-23' AS DATE) - ""B"".""available_from"">30 GROUP BY 1 HAVING COALESCE(SUM(""O"".""quantity""), 0)<10"
378,"SELECT DISTINCT ""B"".""book_id"",""B"".""name"" FROM ""Books"" AS ""B"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""book_id""=""B"".""book_id"" WHERE ""B"".""available_from""<'2019-05-23' GROUP BY ""book_id"" HAVING SUM(CASE WHEN ""dispatch_date"">=CAST('2019-06-23' AS DATE) - INTERVAL '1 YEAR' THEN ""quantity"" ELSE 0 END)<10"
379,"WITH ""a"" AS (SELECT ""book_id"",""name"" FROM ""books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""books"" WHERE ""available_from"" BETWEEN '2019-05-23' AND '2019-06-23')), ""b"" AS (SELECT ""book_id"",""quantity"" FROM ""orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23') SELECT ""a"".""book_id"",""a"".""name"" FROM ""a"" LEFT JOIN ""b"" ON ""a"".""book_id""=""b"".""book_id"" GROUP BY 1 HAVING SUM(COALESCE(""quantity"", 0))<10"
380,"SELECT ""book_id"",""name"" FROM ""Books"" WHERE ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Orders"" WHERE ""dispatch_date"" BETWEEN '2018-06-23' AND '2019-06-23' GROUP BY ""book_id"" HAVING SUM(""quantity"")>=10) AND ""book_id"" NOT IN (SELECT ""book_id"" FROM ""Books"" WHERE CAST('2019-06-23' AS DATE) - ""available_from""<=30)"
