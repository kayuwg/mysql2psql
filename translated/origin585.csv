id,original query
1,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
2,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" AS ""i"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(""PID"")=1)"
3,"SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND ROW(""lon"",""lat"") IN (SELECT ""lon"",""lat"" AS ""lat"" FROM ""insurance"" GROUP BY ""lon"",""lat"" HAVING COUNT(""lat"")=1)"
4,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
5,"WITH ""unique_locations"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""pid"")=1), ""tivs"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""pid"")>1) SELECT SUM(""i"".""tiv_2016"") AS ""tiv_2016"" FROM (""insurance"" AS ""i"" JOIN ""unique_locations"" AS ""u"" ON ""u"".""lat""=""i"".""lat"" AND ""u"".""lon""=""i"".""lon"") JOIN ""tivs"" AS ""t"" ON ""t"".""tiv_2015""=""i"".""tiv_2015"""
6,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""i1"".""TIV_2015"" IN (SELECT ""i2"".""TIV_2015"" FROM ""insurance"" AS ""i2"" GROUP BY ""i2"".""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""i1"".""LAT"", ""i1"".""LON"") IN (SELECT CONCAT(""i3"".""LAT"", ""i3"".""LON"") FROM ""insurance"" AS ""i3"" GROUP BY ""i3"".""LAT"",""i3"".""LON"" HAVING COUNT(1)=1)"
7,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""CNT1"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""CNT2"" FROM ""INSURANCE"") AS ""TBL"" WHERE ""TBL"".""CNT1"">=2 AND ""TBL"".""CNT2""=1"
8,"SELECT SUM(DISTINCT ""a"".""TIV_2016"") AS ""TIV_2016"" FROM (SELECT * FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AS ""a"" CROSS, ""insurance"" AS ""b"" WHERE ""a"".""PID""!=""b"".""PID"" AND ""a"".""TIV_2015""=""b"".""TIV_2015"""
9,"SELECT SUM(""i"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""TIV_2015"" IN (SELECT ""Tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1) AND CONCAT(""i"".""lat"", ',', ""i"".""lon"") IN (SELECT CONCAT(""LAT"", ',', ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
10,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") AS ""ct"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
11,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
12,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT DISTINCT ""i1"".""pid"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""PID""!=""i2"".""PID"" AND ""i1"".""TIV_2015""=""i2"".""TIV_2015"" WHERE ""i1"".""pid"" NOT IN (SELECT ""i1"".""pid"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""pid""!=""i2"".""pid"" AND (""i1"".""lat""=""i2"".""lat"" AND ""i1"".""lon""=""i2"".""lon"")))"
13,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
14,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
15,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM (SELECT ""i1"".*,""i2"".""c1"",""i3"".""c2"" FROM (""insurance"" AS ""i1"" JOIN (SELECT ""tiv_2015"",COUNT(1) AS ""c1"" FROM ""insurance"" AS ""i2"" GROUP BY ""tiv_2015"") AS ""i2"" ON ""i2"".""tiv_2015""=""i1"".""tiv_2015"") JOIN (SELECT ""lat"",""lon"",COUNT(1) AS ""c2"" FROM ""insurance"" AS ""i2"" GROUP BY ""lat"",""lon"") AS ""i3"" ON ""i3"".""lat""=""i1"".""lat"" AND ""i3"".""lon""=""i1"".""lon"") AS ""x"" WHERE ""x"".""c1"">1 AND ""x"".""c2""=1"
16,"WITH ""cte"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1), ""cte2"" AS (SELECT CONCAT(""LAT"", ""LON"") AS ""city"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1) SELECT SUM(COALESCE(""TIV_2016"", 0)) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""cte"") AND CONCAT(""LAT"", ""LON"") IN (SELECT ""city"" FROM ""cte2"")"
17,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY 1 HAVING COUNT(DISTINCT ""PID"")>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1))"
18,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
19,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""tbl_1"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" AS ""tbl_2"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""tbl_1"".""LAT"",""tbl_1"".""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" AS ""tbl_3"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
20,"SELECT ROUND(SUM(""I"".""TIV_2016""), 2) AS ""TIV_2016"" FROM (""insurance"" AS ""I"" LEFT JOIN (SELECT ""TIV_2015"",COUNT(""PID"") AS ""PID_cnt"" FROM ""insurance"" GROUP BY 1) AS ""TBL"" ON ""I"".""TIV_2015""=""TBL"".""TIV_2015"") LEFT JOIN (SELECT ""LAT"",""LON"",COUNT(""PID"") AS ""PID_cnt2"" FROM ""insurance"" GROUP BY 1,2) AS ""TBL2"" ON ""I"".""LAT""=""TBL2"".""LAT"" AND ""I"".""LON""=""TBL2"".""LON"" WHERE ""TBL"".""PID_cnt"">=2 AND ""PID_cnt2""=1"
21,"WITH ""t2015"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1), ""location"" AS (SELECT ""pid"",COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""c"" FROM ""insurance"") SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN ""t2015"" AS ""t"" ON ""i"".""tiv_2015""=""t"".""tiv_2015"") JOIN ""location"" AS ""l"" ON ""l"".""pid""=""i"".""pid"" WHERE ""l"".""c""=1"
22,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt1"",COUNT(1) OVER (PARTITION BY ""tiv_2015"") AS ""cnt2"" FROM ""insurance"") AS ""a"" WHERE ""cnt1""=1 AND ""cnt2"">=2"
23,"WITH ""same_tiv_2015"" AS (SELECT ""tiv_2015"",COUNT(1) FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1), ""diff_loc"" AS (SELECT ""lat"",""lon"",COUNT(1) FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""same_tiv_2015"") AND CONCAT(""lat"", ',', ""lon"") IN (SELECT CONCAT(""lat"", ',', ""lon"") FROM ""diff_loc"")"
24,"WITH ""insur_plus"" AS (SELECT *,CONCAT(""lat"", '-', ""lon"") AS ""lat_lon"" FROM ""insurance"") SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insur_plus"" AS ""i1"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insur_plus"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND ""lat_lon"" NOT IN (SELECT ""lat_lon"" FROM ""insur_plus"" GROUP BY ""lat_lon"" HAVING COUNT(1)>1)"
25,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE EXISTS (SELECT 1 FROM ""insurance"" AS ""i2"" WHERE ""i"".""pid""!=""i2"".""pid"" AND ""i"".""tiv_2015""=""i2"".""tiv_2015"") AND NOT EXISTS (SELECT 1 FROM ""insurance"" AS ""i2"" WHERE ""i"".""pid""!=""i2"".""pid"" AND ""i"".""lon""=""i2"".""lon"" AND ""i"".""lat""=""i2"".""lat"")"
26,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" JOIN (SELECT ""PID"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""lat"", ""lon"") NOT IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(CONCAT(""lat"", ""lon""))>1)) AS ""sq"" ON ""i"".""PID""=""sq"".""PID"""
27,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY 1 HAVING COUNT(DISTINCT ""PID"")>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1))"
28,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""pid"")=1) AND ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""pid"")>1)"
29,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
30,"WITH ""insurance_cte"" AS (SELECT *,COUNT(""pid"") OVER (PARTITION BY ""tiv_2015"") AS ""tiv_2015_cnt"",COUNT(""pid"") OVER (PARTITION BY ""lat"", ""lon"") AS ""pk_cnt"" FROM ""insurance"") SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance_cte"" WHERE ""tiv_2015_cnt"">=2 AND ""pk_cnt""=1"
31,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
32,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""PID"",""TIV_2015"",""TIV_2016"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""cnt"",COUNT(1) OVER (PARTITION BY CONCAT(""LAT"", ',', ""LON"")) AS ""loc_cnt"" FROM ""insurance"") AS ""t"" WHERE ""cnt"">1 AND ""loc_cnt""=1"
33,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
34,"SELECT ""sum_TIV_2016"" AS ""TIV_2016"" FROM (SELECT SUM(""TIV_2016"") AS ""sum_TIV_2016"" FROM (""insurance"" AS ""ins"" JOIN (SELECT ""TIV_2015"",COUNT(1) AS ""count_tiv"" FROM ""insurance"" GROUP BY 1 HAVING ""count_tiv"">1) AS ""tiv"" ON ""ins"".""TIV_2015""=""tiv"".""TIV_2015"") JOIN (SELECT ""lat"",""lon"",COUNT(1) AS ""count_loc"" FROM ""insurance"" GROUP BY 1,2 HAVING ""count_loc""=1) AS ""loc"" ON ""ins"".""lat""=""loc"".""lat"" AND ""ins"".""lon""=""loc"".""lon"") AS ""a"""
35,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""comval"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""place"" FROM ""insurance"") AS ""t"" WHERE ""comval"">1 AND ""place""=1"
36,"WITH ""tiv_counts"" AS (SELECT ""TIV_2015"",COUNT(""TIV_2015"") AS ""2015_counts"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING ""2015_counts"">1), ""map_freqs"" AS (SELECT ""TIV_2015"",""TIV_2016"",COUNT(""LAT"") AS ""lat_freqs"",COUNT(""LON"") AS ""lon_freqs"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING ""lat_freqs""<=1 AND ""lon_freqs""<=1) SELECT SUM(""map_freqs"".""TIV_2016"") AS ""TIV_2016"" FROM ""tiv_counts"" JOIN ""map_freqs"" ON ""tiv_counts"".""TIV_2015""=""map_freqs"".""TIV_2015"""
37,"WITH ""tiv"" AS (SELECT ""tiv_2015"",COUNT(1) AS ""cnt"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING ""cnt"">1), ""located"" AS (SELECT ""LAT"",""LON"",COUNT(1) AS ""cnt"" FROM ""insurance"" GROUP BY ""LAT"",""LON""), ""holders"" AS (SELECT ""pid"",""tiv_2016"",""tiv_2015"" FROM ""insurance"" AS ""i"" JOIN ""located"" AS ""l"" ON ""i"".""LAT""=""l"".""LAT"" AND ""i"".""LON""=""l"".""LON"" WHERE ""cnt""=1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""tiv"" AS ""t"" JOIN ""holders"" AS ""h"" ON ""t"".""tiv_2015""=""h"".""tiv_2015"""
38,"SELECT SUM(DISTINCT ""i"".""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" AS ""i"" CROSS JOIN ""insurance"" AS ""i1"" WHERE ""i"".""pid""!=""i1"".""pid"" AND ""i"".""tiv_2015""=""i1"".""tiv_2015"" AND ""i"".""pid"" NOT IN (SELECT ""i"".""pid"" FROM ""insurance"" AS ""i"" CROSS JOIN ""insurance"" AS ""i1"" WHERE ""i"".""pid""!=""i1"".""pid"" AND ""i"".""lat""=""i1"".""lat"" AND ""i"".""lon""=""i1"".""lon"")"
39,"WITH ""tiv_2015_value"" AS (SELECT DISTINCT (""TIV_2015"") FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>=2), ""lat_lon"" AS (SELECT DISTINCT (CONCAT(""LAT"", ', ', ""LON"")) AS ""latlon"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT * FROM ""tiv_2015_value"") AND CONCAT(""LAT"", ', ', ""LON"") IN (SELECT * FROM ""lat_lon"")"
40,"WITH ""CTE1"" AS (SELECT DISTINCT ""TIV_2015"" AS ""inv_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1), ""CTE2"" AS (SELECT DISTINCT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""inv_2015"" FROM ""CTE1"") AND CONCAT(""LAT"", CONCAT(',', ""LON"")) IN (SELECT CONCAT(""LAT"", CONCAT(',', ""LON"")) FROM ""CTE2"")"
41,"WITH ""a"" AS (SELECT ""tiv_2015"",COUNT(""tiv_2015"") FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1), ""b"" AS (SELECT ""pid"",""lat"",""lon"" FROM ""insurance"" WHERE CONCAT(""lat"", ""lon"") NOT IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1)) SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT ""pid"" FROM ""b"") AND ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""a"")"
42,"WITH ""tiv"" AS (SELECT ""PID"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1)), ""loc"" AS (SELECT ""PID"" FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(CONCAT(""LAT"", ""LON""))=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""tiv"") AND ""PID"" IN (SELECT ""PID"" FROM ""loc"")"
43,"WITH ""same_value"" AS (SELECT ""pid"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""a"".""TIV_2015"" FROM (SELECT ""TIV_2015"",COUNT(""PID"") FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AS ""a"")), ""notsame_value"" AS (SELECT ""pid"" FROM ""insurance"" WHERE CONCAT(""lat"", ""lon"") NOT IN (SELECT ""a"".""lt"" FROM (SELECT CONCAT(""lat"", ""lon"") AS ""lt"",COUNT(""PID"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(""PID"")>1) AS ""a"")) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT ""same_value"".""pid"" FROM (""same_value"") CROSS JOIN ""notsame_value"" WHERE ""notsame_value"".""pid""=""same_value"".""pid"")"
44,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>=2) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
45,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) AND ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1)"
46,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
47,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (WITH ""TEMP"" AS (SELECT *,CONCAT(""LAT"", ""LON"") AS ""LOC"" FROM ""Insurance"") SELECT ""PID"",""TIV_2016"" FROM ""TEMP"" WHERE ""LOC"" IN (SELECT ""LOC"" FROM ""TEMP"" GROUP BY ""LOC"" HAVING COUNT(""LOC"")=1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1)) AS ""t"""
48,"WITH ""valid_TIV15"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)!=1), ""valid_LATLON"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" JOIN ""valid_LATLON"" AS ""v"" ON ""i"".""LAT""=""v"".""LAT"" AND ""i"".""LON""=""v"".""LON"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)!=1)"
49,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" AS ""a"" WHERE EXISTS (SELECT ""TIV_2016"" FROM ""Insurance"" WHERE ""PID""!=""a"".""PID"" AND ""TIV_2015""=""a"".""TIV_2015"") AND NOT EXISTS (SELECT ""TIV_2016"" FROM ""Insurance"" WHERE ""PID""!=""a"".""PID"" AND ROW(""LAT"",""LON"")=ROW(""a"".""LAT"",""a"".""LON""))"
50,"WITH ""tmp1"" AS (SELECT DISTINCT ""t1"".""PID"" FROM (""insurance"" AS ""t1"") CROSS JOIN ""insurance"" AS ""t2"" WHERE ""t1"".""PID""!=""t2"".""PID"" AND ""t1"".""TIV_2015""=""t2"".""TIV_2015""), ""tmp2"" AS (SELECT ""t1"".""PID"" FROM (""insurance"" AS ""t1"") CROSS JOIN ""insurance"" AS ""t2"" WHERE ""t1"".""PID""!=""t2"".""PID"" AND CONCAT(""t1"".""LAT"", ""t1"".""LON"")=CONCAT(""t2"".""LAT"", ""t2"".""LON"") GROUP BY 1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""tmp1"") AND ""PID"" NOT IN (SELECT ""PID"" FROM ""tmp2"")"
51,"WITH ""cte"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1), ""cte2"" AS (SELECT CONCAT(""lat"", ""lon"") AS ""loc1"" FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(""PID"")=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT DISTINCT ""TIV_2015"" FROM ""cte"") AND CONCAT(""lat"", ""lon"") IN (SELECT ""loc1"" FROM ""cte2"")"
52,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LON"",""LAT"" HAVING COUNT(1)=1)"
53,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""PID"",""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(DISTINCT ""PID"")>=2) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""PID"")=1)) AS ""aa"""
54,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt"",COUNT(1) OVER (PARTITION BY ""tiv_2015"") AS ""tiv"" FROM ""insurance"") AS ""z"" WHERE ""cnt""=1 AND ""tiv"">1"
55,"WITH ""t1"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1), ""t2"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""t1"") AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""t2"")"
56,"SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND CONCAT(""i"".""LAT"", '-', ""i"".""LON"") IN (SELECT CONCAT(""LAT"", '-', ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
57,"WITH ""tiv15"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1), ""unique_city"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1) SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT * FROM ""tiv15"") AND ROW(""lat"",""lon"") IN (SELECT * FROM ""unique_city"")"
58,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
59,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""TIV_2016"",COUNT(""TIV_2015"") OVER (PARTITION BY ""TIV_2015"") AS ""dr1"",COUNT(""TIV_2015"") OVER (PARTITION BY ""lat"", ""lon"") AS ""dr2"" FROM ""insurance"") AS ""t"" WHERE ""dr1"">=2 AND ""dr2""=1"
60,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", CONCAT(',', ""LON"")) IN (SELECT CONCAT(""LAT"", CONCAT(',', ""LON"")) FROM ""insurance"" GROUP BY CONCAT(""LAT"", CONCAT(',', ""LON"")) HAVING COUNT(1)=1)"
61,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
62,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""INSURANCE"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
63,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE EXISTS (SELECT * FROM ""insurance"" AS ""i2"" WHERE ""i1"".""PID""!=""i2"".""PID"" AND ""i1"".""TIV_2015""=""i2"".""TIV_2015"") AND NOT EXISTS (SELECT * FROM ""insurance"" AS ""i3"" WHERE ""i1"".""PID""!=""i3"".""PID"" AND ""i1"".""LAT""=""i3"".""LAT"" AND ""i1"".""LON""=""i3"".""LON"")"
64,"WITH ""CTE_LAT_LON_COMBINED"" AS (SELECT ""PID"",""TIV_2015"",""TIV_2016"",CONCAT(CAST(""LAT"" AS CHAR), CAST(""LON"" AS CHAR)) AS ""CITY"" FROM ""INSURANCE""), ""CTE_REMOVE_SAME_CITIES"" AS (SELECT ""A"".""PID"" FROM ""CTE_LAT_LON_COMBINED"" AS ""A"" JOIN ""CTE_LAT_LON_COMBINED"" AS ""B"" ON ""A"".""CITY""=""B"".""CITY"" AND ""A"".""PID""!=""B"".""PID"" GROUP BY 1), ""CTE_FINAL_LIST"" AS (SELECT ""A"".""PID"" FROM ""CTE_LAT_LON_COMBINED"" AS ""A"" JOIN ""CTE_LAT_LON_COMBINED"" AS ""B"" ON ""A"".""TIV_2015""=""B"".""TIV_2015"" AND ""A"".""PID""!=""B"".""PID"" WHERE ""A"".""PID"" NOT IN (SELECT ""PID"" FROM ""CTE_REMOVE_SAME_CITIES"") GROUP BY 1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""INSURANCE"" AS ""A"" JOIN ""CTE_FINAL_LIST"" AS ""B"" ON ""A"".""PID""=""B"".""PID"""
65,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""insurance"".""LAT"", ""insurance"".""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
66,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
67,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""Lat"", ""Lon"") IN (SELECT CONCAT(""Lat"", ""Lon"") FROM ""insurance"" GROUP BY CONCAT(""Lat"", ""Lon"") HAVING COUNT(1)=1)"
68,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
69,"SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND ROW(""lon"",""lat"") IN (SELECT ""lon"",""lat"" FROM ""insurance"" GROUP BY ""lon"",""lat"" HAVING COUNT(""lat"")=1)"
70,"WITH ""cte"" AS (SELECT ""TIV_2015"",COUNT(1) AS ""num"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>=2), ""cte2"" AS (SELECT COUNT(""PID"") AS ""cnt"",CONCAT_WS(',', ""LAT"", ""LON"") AS ""loc"" FROM ""insurance"" GROUP BY 2 HAVING COUNT(""PID"")=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""cte"") AND CONCAT_WS(',', ""LAT"", ""LON"") IN (SELECT ""loc"" FROM ""cte2"")"
71,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT DISTINCT ""pid"" FROM (SELECT ""pid"",COUNT(1) OVER (PARTITION BY ""tiv_2015"") AS ""num15"",COUNT(1) OVER (PARTITION BY CONCAT(""lat"", ""lon"")) AS ""num_loc"" FROM ""insurance"") AS ""x"" WHERE ""num15"">1 AND ""num_loc""=1)"
72,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""TIV_2016"",COUNT(""TIV_2015"") OVER (PARTITION BY ""TIV_2015"") AS ""cnt2015"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""cntloc"" FROM ""insurance"") AS ""t"" WHERE ""cnt2015"">1 AND ""cntloc""=1"
73,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
74,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
75,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
76,"SELECT SUM(""c"".""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""a"".""PID"",""a"".""TIV_2015"",""a"".""TIV_2016"",""a"".""LAT"",""a"".""LON"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ""a"".""PID""!=""b"".""PID"" GROUP BY ""a"".""PID"",""a"".""TIV_2015"",""a"".""TIV_2016"",""a"".""LAT"",""a"".""LON"") AS ""c"" LEFT JOIN ""insurance"" AS ""d"" ON (""c"".""LAT""=""d"".""LAT"") AND (""c"".""LON""=""d"".""LON"") AND ""c"".""PID""!=""d"".""PID"" WHERE ""d"".""PID"" IS NULL"
77,"SELECT SUM(""t"".""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" AS ""t"" WHERE ""T"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""Insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
78,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
79,"WITH ""t1"" AS (SELECT ""pid"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)=1), ""t2"" AS (SELECT ""pid"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" NOT IN (SELECT * FROM ""t1"") AND ""pid"" IN (SELECT * FROM ""t2"")"
80,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT DISTINCT ""i1"".""PID"",""i1"".""TIV_2016"" FROM ""insurance"" AS ""i1"" CROSS JOIN ""insurance"" AS ""i2"" WHERE ""i1"".""PID""!=""i2"".""PID"" AND ""i1"".""TIV_2015""=""i2"".""TIV_2015"") AS ""t1"" JOIN (SELECT ""PID"",""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AS ""t2"" ON ""t1"".""PID""=""t2"".""PID"""
81,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
82,"WITH ""get_uniques_ll"" AS (SELECT ""lat"",""lon"",MIN(""PID"") AS ""uid"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)<=1), ""get_same_tiv"" AS (SELECT DISTINCT ""i1"".""pid"",""i1"".""TIV_2016"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""PID""!=""i2"".""PID"" AND ""i1"".""TIV_2015""=""i2"".""TIV_2015"") SELECT ROUND(SUM(""t1"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""get_same_tiv"" AS ""t1"" JOIN ""get_uniques_ll"" AS ""t2"" ON ""t1"".""pid""=""t2"".""uid"""
83,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" AS ""i"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" WHERE ""pid""!=""i"".""pid"") AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""lat"")=1)"
84,"WITH ""2015Val"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(""TIV_2015"")>1), ""DiffCity"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT * FROM ""2015Val"") AND ROW(""LAT"",""LON"") NOT IN (SELECT * FROM ""DiffCity"")"
85,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
86,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
87,"WITH ""cte"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1), ""cte2"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(""lat"")=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""cte"") AND ROW(""lat"",""lon"") IN (SELECT ""LAT"",""LON"" FROM ""cte2"")"
88,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
89,"SELECT SUM(""i"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""tiv_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""i"".""lat"", ""i"".""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(1)=1)"
90,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
91,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(DISTINCT ""pid"")>1) AND CONCAT(""lat"", ""lon"") NOT IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(DISTINCT ""pid"")>1)"
92,"WITH ""t1"" AS (SELECT ""TIV_2015"",1 AS ""IsSatTIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>=2), ""t2"" AS (SELECT ""LAT"",""LON"",1 AS ""IsUniqueLoc"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (""insurance"" AS ""t3"" LEFT JOIN ""t1"" ON ""t3"".""TIV_2015""=""t1"".""TIV_2015"") LEFT JOIN ""t2"" ON ""t3"".""LAT""=""t2"".""LAT"" AND ""t3"".""LON""=""t2"".""LON"" WHERE ""t1"".""IsSatTIV_2015""=1 AND ""t2"".""IsUniqueLoc""=1"
93,"WITH ""TEMP"" AS (SELECT ""PID"",COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""ct"",""TIV_2016"",""LAT"",""LON"" FROM ""insurance""), ""t2"" AS (SELECT ""PID"",COUNT(""PID"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""LOCATION"",""TIV_2016"" FROM ""insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""PID"",""TIV_2016"" FROM ""t2"" WHERE ""LOCATION""=1) AS ""t4"" WHERE ""pid"" IN (SELECT ""PID"" FROM (SELECT ""PID"" FROM ""temp"" WHERE ""ct"">1) AS ""t3"")"
94,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM (SELECT DISTINCT ""tiv_2016"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""cnt1"",COUNT(1) OVER (PARTITION BY CONCAT(""lat"", ""lon"")) AS ""cnt2"" FROM ""insurance"") AS ""t"" WHERE ""cnt1"">1 AND ""cnt2""=1"
95,"WITH ""same_TIV_2015"" AS (SELECT ""TIV_2015"" FROM ""insurance"" AS ""i"" GROUP BY 1 HAVING COUNT(DISTINCT ""PID"")>=2), ""lat_lon_unique"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" AS ""i"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""pid"")=1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN ""same_TIV_2015"" AS ""tiv"" ON ""tiv"".""TIV_2015""=""i"".""TIV_2015"") JOIN ""lat_lon_unique"" AS ""llu"" ON ""llu"".""lat""=""i"".""lat"" AND ""llu"".""lon""=""i"".""lon"""
96,"WITH ""not_same_loc"" AS (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1), ""investment"" AS (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""not_same_loc"") AND ""PID"" NOT IN (SELECT ""PID"" FROM ""investment"")"
97,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ""a"".""TIV_2015""=""b"".""TIV_2015"") AND ""PID"" NOT IN (SELECT ""c"".""PID"" FROM ""insurance"" AS ""c"" JOIN ""insurance"" AS ""d"" ON ""c"".""PID""!=""d"".""PID"" AND ""c"".""LAT""=""d"".""LAT"" AND ""c"".""LON""=""d"".""LON"")"
98,"WITH ""cte"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1), ""cte1"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1), ""cte2"" AS (SELECT ""tiv_2016"" FROM (""insurance"" AS ""i"" JOIN ""cte"" ON ""i"".""tiv_2015""=""cte"".""tiv_2015"") JOIN ""cte1"" ON ""i"".""lat""=""cte1"".""lat"" AND ""i"".""lon""=""cte1"".""lon"") SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""cte2"""
99,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") AS ""UNIQUE_CITY"" FROM ""INSURANCE"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
100,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT MAX(""TIV_2015"") AS ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ""PID"" IN (SELECT MAX(""PID"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
101,"WITH ""t1"" AS (SELECT ""PID"",""TIV_2016"" FROM (SELECT ""PID"",""TIV_2016"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""count_2015"" FROM ""insurance"") AS ""t3"" WHERE ""count_2015"">1), ""t2"" AS (SELECT ""PID"",""TIV_2016"" FROM (SELECT ""PID"",""TIV_2016"",COUNT(1) OVER (PARTITION BY CONCAT(""LAT"", ""LON"")) AS ""count_loc"" FROM ""insurance"") AS ""t4"" WHERE ""count_loc""=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""t1"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""t2"")"
102,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" WHERE ""PID"" NOT IN (SELECT DISTINCT ""a"".""PID"" FROM ""Insurance"" AS ""a"" JOIN ""Insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND ""PID"" IN (SELECT DISTINCT ""a"".""PID"" FROM ""Insurance"" AS ""a"" JOIN ""Insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ""a"".""TIV_2015""=""b"".""TIV_2015"")"
103,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT * FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(""PID"")=1) AS ""b"" WHERE ""PID"" NOT IN (SELECT DISTINCT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")=1)"
104,"WITH ""location_counts_1"" AS (SELECT ""LAT"",""LON"",COUNT(DISTINCT ""PID"") AS ""latlon_count"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1), ""pids_with_unique_location"" AS (SELECT DISTINCT ""i"".""PID"",""l"".""latlon_count"" FROM ""insurance"" AS ""i"" JOIN ""location_counts_1"" AS ""l"" ON ""i"".""LAT""=""l"".""LAT"" AND ""i"".""LON""=""l"".""LON""), ""pids_with_nonunique_tiv2015s"" AS (SELECT DISTINCT ""i"".""PID"" FROM ""insurance"" AS ""i"" JOIN ""insurance"" AS ""i2"" ON ""i"".""pid""!=""i2"".""pid"" AND ""i"".""TIV_2015""=""i2"".""TIV_2015"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN ""pids_with_unique_location"" AS ""u"" ON ""u"".""PID""=""i"".""PID"") JOIN ""pids_with_nonunique_tiv2015s"" AS ""n"" ON ""n"".""PID""=""i"".""PID"""
105,"WITH ""valid_LATLON"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" JOIN ""valid_LATLON"" AS ""v"" ON ""i"".""LAT""=""v"".""LAT"" AND ""i"".""LON""=""v"".""LON"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)!=1)"
106,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""num_2015"",COUNT(1) OVER (PARTITION BY CONCAT(""lat"", ""lon"")) AS ""num_loc"" FROM ""insurance"") AS ""x"" WHERE ""num_2015"">1 AND ""num_loc""=1"
107,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" LEFT JOIN (SELECT ""PID"",COUNT(1) OVER (PARTITION BY CONCAT(""LAT"", ' ', ""LON"")) AS ""count_lat_lon"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""count_2015"" FROM ""insurance"") AS ""i2"" ON ""i1"".""PID""=""i2"".""PID"" WHERE ""i2"".""count_lat_lon""=1 AND ""i2"".""count_2015"">1"
108,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (ORDER BY ""TIV_2015"") AS ""same_TIV"",DENSE_RANK() OVER (ORDER BY ""lat"",""lon"") AS ""same_lat"" FROM ""insurance""), ""cte2"" AS (SELECT ""pid"",COUNT(""pid"") OVER (PARTITION BY ""same_TIV"") AS ""tivcount"",COUNT(""pid"") OVER (PARTITION BY ""same_lat"") AS ""latcount"",""TIV_2016"" FROM ""cte"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""cte2"" WHERE ""latcount""=1 AND ""tivcount"">1"
109,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
110,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
111,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")=1) AND ""LAT"" NOT IN (SELECT ""LAT"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)"
112,"WITH ""criteria"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""val"" FROM ""insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""criteria"" WHERE ""cnt""=1 AND ""val"">1"
113,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>=2) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(1)=1)"
114,"WITH ""tiv_count"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(""PID"")>1), ""lat_lon_count"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(""PID"")=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""tiv_count"") AND ""lat"" IN (SELECT ""lat"" FROM ""lat_lon_count"") AND ""lon"" IN (SELECT ""lon"" FROM ""lat_lon_count"")"
115,"SELECT SUM(""i"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(1)=1)"
116,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
117,"WITH ""cte"" AS (SELECT *,RANK() OVER (ORDER BY ""TIV_2015"") AS ""rnk"",RANK() OVER (ORDER BY ""LAT"",""LON"") AS ""rnk_lat"" FROM ""insurance""), ""cteb"" AS (SELECT ""PID"",COUNT(""PID"") OVER (PARTITION BY ""rnk"") AS ""repeated_tiv"",COUNT(""PID"") OVER (PARTITION BY ""rnk_lat"") AS ""repeated_loc"",""TIV_2016"" FROM ""cte"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""cteb"" WHERE ""repeated_tiv"">1 AND ""repeated_loc""=1"
118,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AND ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1)"
119,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1) AND ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1)"
120,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
121,"WITH ""sub"" AS (SELECT DISTINCT ""i1"".""pid"",""i1"".""tiv_2015"",""i1"".""tiv_2016"",""i1"".""lat"",""i1"".""lon"" FROM (""insurance"" AS ""i1"") CROSS JOIN ""insurance"" AS ""i2"" WHERE ""i1"".""tiv_2015""=""i2"".""tiv_2015"" AND ""i1"".""pid""!=""i2"".""pid""), ""coordinates"" AS (SELECT ""lat"",""lon"",COUNT(""pid"") AS ""count"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""pid"")=1) SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""sub"" JOIN ""coordinates"" ON (""sub"".""lat""=""coordinates"".""lat"" AND ""sub"".""lon""=""coordinates"".""lon"")"
122,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
123,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
124,"WITH ""tiv15"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1), ""not_unique_city"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)>1) SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT * FROM ""tiv15"") AND ROW(""lat"",""lon"") NOT IN (SELECT * FROM ""not_unique_city"")"
125,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""cnt1"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""cnt2"" FROM ""insurance"") AS ""t"" WHERE ""cnt1"">1 AND ""cnt2""=1"
126,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT (""TIV_2015"") FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
127,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""i1"".""TIV_2015"" IN (SELECT ""i2"".""TIV_2015"" FROM ""insurance"" AS ""i2"" WHERE ""i1"".""PID""!=""i2"".""PID"") AND ROW(""i1"".""LAT"",""i1"".""LON"") NOT IN (SELECT ""i3"".""LAT"",""i3"".""LON"" FROM ""insurance"" AS ""i3"" WHERE ""i1"".""PID""!=""i3"".""PID"")"
128,"WITH ""eligible"" AS (SELECT DISTINCT ""i1"".""pid"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON (""i1"".""pid""!=""i2"".""pid"" AND ""i1"".""TIV_2015""=""i2"".""TIV_2015"") ORDER BY 1), ""not_eligible"" AS (SELECT DISTINCT ""e1"".""pid"" FROM ""insurance"" AS ""e1"" JOIN ""insurance"" AS ""e2"" ON (""e1"".""pid""!=""e2"".""pid"" AND ROW(""e1"".""lat"",""e1"".""lon"")=ROW(""e2"".""lat"",""e2"".""lon"")) ORDER BY 1) SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT * FROM ""eligible"") AND ""pid"" NOT IN (SELECT * FROM ""not_eligible"")"
129,"WITH ""insur_plus"" AS (SELECT *,CONCAT(""lat"", '-', ""lon"") AS ""lat_lon"" FROM ""insurance"") SELECT SUM(""i1"".""tiv_2016"") AS ""TIV_2016"" FROM ""insur_plus"" AS ""i1"" WHERE ""i1"".""tiv_2015"" IN (SELECT ""i2"".""tiv_2015"" FROM ""insur_plus"" AS ""i2"" WHERE ""i1"".""pid""!=""i2"".""pid"") AND ""i1"".""lat_lon"" NOT IN (SELECT ""i3"".""lat_lon"" FROM ""insur_plus"" AS ""i3"" WHERE ""i1"".""pid""!=""i3"".""pid"")"
130,"SELECT ROUND(SUM(""insurance"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
131,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>=2) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(CONCAT(""lat"", ""lon""))=1)"
132,"WITH ""complete"" AS (SELECT *,COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""Criteria1"",COUNT(""PID"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""Criteria2"" FROM ""insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""complete"" WHERE ""Criteria1"">1 AND ""Criteria2""=1"
133,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") NOT IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1)"
134,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
135,"WITH ""a"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1), ""b"" AS (SELECT ""TIV_2016"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""PID"")=1), ""c"" AS (SELECT ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""a"")) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""c"" WHERE ""TIV_2016"" IN (SELECT ""TIV_2016"" FROM ""B"")"
136,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT ""TIV_2016"",COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""2015_count"",COUNT(""PID"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""location_count"" FROM ""insurance"") AS ""table1"" WHERE ""2015_count"">1 AND ""location_count""=1"
137,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND ""pid"" IN (SELECT ""pid"" FROM ""insurance"" WHERE CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") AS ""lo"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1))"
138,"WITH ""t"" AS (SELECT DISTINCT ""b"".""pid"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND CONCAT(""a"".""lat"", ',', ""a"".""lon"")=CONCAT(""b"".""lat"", ',', ""b"".""lon"")), ""t2"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ""pid"" NOT IN (SELECT DISTINCT ""b"".""pid"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND CONCAT(""a"".""lat"", ',', ""a"".""lon"")=CONCAT(""b"".""lat"", ',', ""b"".""lon""))"
139,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE CONCAT(""LON"", ""LAT"") IN (SELECT CONCAT(""LON"", ""LAT"") FROM ""insurance"" GROUP BY ""LON"",""LAT"" HAVING COUNT(1)=1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
140,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
141,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", '-', ""LON"") IN (SELECT CONCAT(""LAT"", '-', ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
142,"WITH ""cte1"" AS (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1), ""cte2"" AS (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT * FROM ""cte1"") AND ROW(""LAT"",""LON"") IN (SELECT * FROM ""cte2"")"
143,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE CONCAT(""LAT"", ' ', ""LON"") IN (SELECT CONCAT(""LAT"", ' ', ""LON"") FROM ""insurance"" GROUP BY CONCAT(""LAT"", ' ', ""LON"") HAVING COUNT(1)=1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
144,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
145,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
146,"WITH ""unique_location"" AS (SELECT ""PID"",""LAT"",""LON"" FROM ""insurance"" GROUP BY 2,3 HAVING COUNT(""PID"")=1), ""SAME_2015"" AS (SELECT ""PID"",""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")=1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""SAME_2015"") AND ""PID"" IN (SELECT ""PID"" FROM ""unique_location"")"
147,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""TIV_2016"",COUNT(""TIV_2015"") OVER (PARTITION BY ""TIV_2015"") AS ""dr1"",COUNT(""TIV_2015"") OVER (PARTITION BY ""lat"", ""lon"") AS ""dr2"" FROM ""insurance"") AS ""t"" WHERE ""dr1"">=2 AND ""dr2""=1"
148,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""i1"" WHERE ""i"".""TIV_2015""=""i1"".""TIV_2015"")>1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""i2"" WHERE ROW(""i"".""LAT"",""i"".""LON"")=ROW(""i2"".""LAT"",""i2"".""LON""))=1"
149,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
150,"SELECT ROUND(SUM(DISTINCT ""a"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" WHERE ""a"".""PID""!=""b"".""PID"" AND ""a"".""PID"" IN (SELECT DISTINCT ""i"".""PID"" FROM ""insurance"" AS ""i"" JOIN ""insurance"" AS ""j"" ON ""i"".""LAT""=""j"".""LAT"" AND ""i"".""LON""=""j"".""LON"" GROUP BY ""i"".""PID"" HAVING COUNT(DISTINCT ""j"".""PID"")=1)"
151,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""TIV_2015""=""b"".""TIV_2015"")>1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ROW(""a"".""LAT"",""a"".""LON"")=ROW(""c"".""LAT"",""c"".""LON""))=1"
152,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
153,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AS ""c"" ON ""i"".""TIV_2015""=""c"".""TIV_2015"") JOIN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) AS ""p"" ON ""i"".""lat""=""p"".""lat"" AND ""i"".""lon""=""p"".""lon"""
154,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM (SELECT ""tiv_2015"",""tiv_2016"",""lat"",""lon"",COUNT(""tiv_2015"") OVER (PARTITION BY ""tiv_2015"") AS ""cnt_tiv_2015"",COUNT(""lat"") OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt_lat"",COUNT(""lon"") OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt_lon"" FROM ""insurance"") AS ""sub"" WHERE ""cnt_tiv_2015"">1 AND ""cnt_lat""=1 AND ""cnt_lon""=1"
155,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN (SELECT DISTINCT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AS ""a"" ON ""i"".""TIV_2015""=""a"".""TIV_2015"") JOIN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AS ""b"" ON ""i"".""LAT""=""b"".""LAT"" AND ""i"".""LON""=""b"".""LON"""
156,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,CONCAT(""LAT"", '', ""LON"") AS ""location"" FROM ""insurance"" GROUP BY ""location"" HAVING COUNT(1)=1) AS ""temp"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
157,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
158,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(CONCAT(""lat"", ""lon""))=1)"
159,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT DISTINCT ""i1"".""PID"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""TIV_2015""=""i2"".""TIV_2015"" AND ""i1"".""PID""!=""i2"".""PID"" WHERE ""i1"".""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(1)=1))"
160,"WITH ""TIV2015"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1), ""Location"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN ""TIV2015"" AS ""T"" ON ""i"".""TIV_2015""=""T"".""TIV_2015"") JOIN ""Location"" AS ""L"" ON ""i"".""LAT""=""L"".""LAT"" AND ""i"".""LON""=""L"".""LON"""
161,"WITH ""cte"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1), ""cte2"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""LAT"",""LON"") IN (SELECT * FROM ""cte"") AND (""TIV_2015"" IN (SELECT * FROM ""cte2""))"
162,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AND ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1)"
163,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
164,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" AS ""i"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" AS ""i"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)<2)"
165,"WITH ""I1"" AS (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1), ""T2"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""I1"") AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""T2"")"
166,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" AS ""i2"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") NOT IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" AS ""i3"" WHERE ""i1"".""PID""!=""i3"".""PID"")"
167,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
168,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM (SELECT DISTINCT ""a"".""PID"" AS ""PID"",""a"".""TIV_2016"" AS ""tiv_2016"" FROM ""insurance"" AS ""a"" CROSS JOIN ""insurance"" AS ""b"" WHERE ""a"".""PID""!=""b"".""PID"" AND ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ""a"".""PID"" NOT IN (SELECT ""c"".""PID"" FROM ""insurance"" AS ""c"" CROSS JOIN ""insurance"" AS ""d"" WHERE ""c"".""PID""!=""d"".""PID"" AND ""c"".""lat""=""d"".""lat"" AND ""c"".""lon""=""d"".""lon"")) AS ""r1"""
169,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM (SELECT ""TIV_2015"",COUNT(1) AS ""cnt"" FROM ""insurance"" GROUP BY ""TIV_2015"") AS ""tbl1"" WHERE ""cnt"">1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM (SELECT ""LAT"",""LON"",COUNT(1) AS ""cnt"" FROM ""insurance"" GROUP BY ""LAT"",""LON"") AS ""tbl2"" WHERE ""cnt""=1)"
170,"WITH ""unique_locations"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1), ""previous_year_non_unique"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""previous_year_non_unique"") AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""unique_locations"")"
171,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt"",COUNT(1) OVER (PARTITION BY ""tiv_2015"") AS ""tiv"" FROM ""insurance"") AS ""z"" WHERE ""cnt""=1 AND ""tiv"">1"
172,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(1)=1)"
173,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""TIV_2015"",""TIV_2016"",CONCAT(""LAT"", ',', ""LON"") AS ""location"" FROM ""insurance"" GROUP BY ""location"" HAVING COUNT(1)=1) AS ""q"" JOIN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AS ""w"" USING (""TIV_2015"")"
174,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
175,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (""insurance"" AS ""i"" JOIN (SELECT ""pid"" FROM ""insurance"" WHERE CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(1)=1)) AS ""p"" ON ""i"".""pid""=""p"".""pid"") JOIN (SELECT ""pid"" FROM ""insurance"" WHERE ""TIV_2015"" IN ((SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1))) AS ""q"" ON ""i"".""pid""=""q"".""pid"""
176,"WITH ""cte"" AS (SELECT ""a"".""pid"" FROM (SELECT ""pid"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1)) AS ""a"" JOIN (SELECT ""pid"" FROM ""insurance"" WHERE CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(1)=1)) AS ""b"" ON ""a"".""pid""=""b"".""pid"") SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT ""pid"" FROM ""cte"")"
177,"WITH ""tp1"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1), ""tp2"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""tp1"") AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""tp2"")"
178,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ' ', ""lon"") IN (SELECT CONCAT(""lat"", ' ', ""lon"") FROM ""Insurance"" GROUP BY CONCAT(""lat"", ' ', ""lon"") HAVING COUNT(1)=1)"
179,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
180,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1)) AND ""PID"" NOT IN (WITH ""Locations"" AS (SELECT *,CONCAT_WS(' ', ""LAT"", ""LON"") AS ""Location"" FROM ""insurance"") SELECT ""PID"" FROM ""Locations"" WHERE ""Location"" IN (SELECT ""Location"" FROM ""Locations"" GROUP BY ""Location"" HAVING COUNT(""PID"")>1))"
181,"SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") NOT IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY CONCAT(""lat"", ""lon"") HAVING COUNT(1)>1)"
182,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""TIV_2015""=""b"".""TIV_2015"")>1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ROW(""a"".""LAT"",""a"".""LON"")=ROW(""c"".""LAT"",""c"".""LON""))=1"
183,"WITH ""table1"" AS (SELECT *,COUNT(""TIV_2015"") OVER (PARTITION BY ""TIV_2015"") AS ""cnt_value"",COUNT(""LAT"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""cnt_location"" FROM ""Insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""table1"" WHERE ""cnt_value"">1 AND ""cnt_location""=1"
184,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
185,"WITH ""same_tiv_2015"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1), ""diff_lat_long"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" AS ""i1"" WHERE (""tiv_2015"" IN (SELECT * FROM ""same_tiv_2015"")) AND (ROW(""lat"",""lon"") IN (SELECT * FROM ""diff_lat_long""))"
186,"WITH ""CTE_1"" AS (SELECT * FROM ""INSURANCE"" AS ""I"" WHERE EXISTS (SELECT 'X' FROM ""INSURANCE"" AS ""II"" WHERE ""I"".""TIV_2015""=""II"".""TIV_2015"" AND ""I"".""PID""!=""II"".""PID"")), ""CTE_2"" AS (SELECT ""PID"",""LAT"",""LON"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""LAT_LON_COUNT"" FROM ""INSURANCE"" AS ""I""), ""CTE_3"" AS (SELECT * FROM ""CTE_2"" WHERE ""LAT_LON_COUNT""=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""INSURANCE"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""CTE_3"") AND ""PID"" IN (SELECT ""PID"" FROM ""CTE_1"")"
187,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
188,"SELECT SUM(""c"".""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""a"".""PID"",""a"".""TIV_2015"",""a"".""TIV_2016"",""a"".""LAT"",""a"".""LON"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ""a"".""PID""!=""b"".""PID"" GROUP BY ""a"".""PID"",""a"".""TIV_2015"",""a"".""TIV_2016"",""a"".""LAT"",""a"".""LON"") AS ""c"" LEFT JOIN ""insurance"" AS ""d"" ON (""c"".""LAT""=""d"".""LAT"") AND (""c"".""LON""=""d"".""LON"") AND ""c"".""PID""!=""d"".""PID"" WHERE ""d"".""PID"" IS NULL"
189,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" AS ""a"" WHERE EXISTS (SELECT * FROM ""Insurance"" WHERE ""PID""!=""a"".""PID"" AND ""TIV_2015""=""a"".""TIV_2015"") AND NOT EXISTS (SELECT * FROM ""Insurance"" WHERE ""PID""!=""a"".""PID"" AND ROW(""LAT"",""LON"")=ROW(""a"".""LAT"",""a"".""LON""))"
190,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""INSURANCE"" AS ""I"" WHERE 1=(SELECT COUNT(1) FROM ""INSURANCE"" AS ""I1"" WHERE ""I"".""LAT""=""I1"".""LAT"" AND ""I"".""LON""=""I1"".""LON"") AND 1<(SELECT COUNT(1) FROM ""INSURANCE"" AS ""I2"" WHERE ""I"".""TIV_2015""=""I2"".""TIV_2015"")"
191,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
192,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1)"
193,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
194,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""i1"" WHERE ""i"".""TIV_2015""=""i1"".""TIV_2015"")>1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""i2"" WHERE ROW(""i"".""LAT"",""i"".""LON"")=ROW(""i2"".""LAT"",""i2"".""LON""))=1"
195,"SELECT ROUND(SUM(""insurance1"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""insurance1"" LEFT JOIN ""insurance"" AS ""insurance2"" ON (""insurance1"".""LAT""=""insurance2"".""LAT"") AND (""insurance1"".""LON""=""insurance2"".""LON"") AND ""insurance1"".""PID""!=""insurance2"".""PID"" WHERE ""insurance2"".""PID"" IS NULL AND ""insurance1"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" WHERE ""PID""!=""insurance1"".""PID"")"
196,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
197,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(""pid"")>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(""pid"")=1)"
198,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""lat""=""b"".""lat"" AND ""a"".""lon""=""b"".""lon"")=1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""b"".""TIV_2015""=""a"".""TIV_2015"")>1"
199,"WITH ""tiv2015_counts"" AS (SELECT ""TIV_2015"",COUNT(1) AS ""counts"" FROM ""insurance"" AS ""i"" GROUP BY ""TIV_2015""), ""unique_city"" AS (SELECT ""LAT"",""LON"",COUNT(1) AS ""counts"" FROM ""insurance"" AS ""i"" GROUP BY ""LAT"",""LON"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""tiv2015_counts"" WHERE ""counts"">=2) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""unique_city"" WHERE ""counts""=1)"
200,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""TIV_2015""=""b"".""TIV_2015"")>1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""LAT""=""c"".""LAT"" AND ""a"".""LON""=""c"".""LON"")=1"
201,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") NOT IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1)"
202,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(1)=1)"
203,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
204,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" LEFT JOIN (SELECT ""PID"",COUNT(1) OVER (PARTITION BY CONCAT(""LAT"", ' ', ""LON"")) AS ""count_lat_lon"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""count_2015"" FROM ""insurance"") AS ""i2"" ON ""i1"".""PID""=""i2"".""PID"" WHERE ""i2"".""count_lat_lon""=1 AND ""i2"".""count_2015"">1"
205,"WITH ""valid_LATLON"" AS (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" JOIN ""valid_LATLON"" AS ""v"" ON ""i"".""LAT""=""v"".""LAT"" AND ""i"".""LON""=""v"".""LON"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)!=1)"
206,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
207,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""i1"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
208,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT ""PID"",""TIV_2016"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""tiv2015_count"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""loc_count"" FROM ""insurance"") AS ""temp"" WHERE ""tiv2015_count"">1 AND ""loc_count""=1"
209,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""pid"" NOT IN (SELECT ""pid"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)=1) AND ""pid"" IN (SELECT ""pid"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
210,"WITH ""dupTIV15"" AS (SELECT ""TIV_2015"",COUNT(1) AS ""n_pid"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>=2), ""uniqCITY"" AS (SELECT CONCAT(CAST(""LAT"" AS CHAR), ',', CAST(""LON"" AS CHAR)) AS ""loc"",COUNT(1) AS ""nStr"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""dupTIV15"") AND CONCAT(CAST(""LAT"" AS CHAR), ',', CAST(""LON"" AS CHAR)) IN (SELECT ""loc"" FROM ""uniqCITY"")"
211,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
212,"WITH ""tmp1cte"" AS (SELECT *,RANK() OVER (ORDER BY ""TIV_2015"") AS ""same_tiv"",RANK() OVER (ORDER BY ""LAT"",""LON"") AS ""same_loc"" FROM ""insurance""), ""tmp2cte"" AS (SELECT ""PID"",COUNT(""PID"") OVER (PARTITION BY ""same_tiv"") AS ""repeated_tiv"",COUNT(""PID"") OVER (PARTITION BY ""same_loc"") AS ""repeated_loc"",""TIV_2016"" FROM ""tmp1cte"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""tmp2cte"" WHERE ""repeated_tiv"">1 AND ""repeated_loc""=1"
213,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
214,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""i1"".""tiv_2015"" IN (SELECT ""i2"".""tiv_2015"" FROM ""insurance"" AS ""i2"" WHERE ""i1"".""pid""!=""i2"".""pid"") AND ROW(""i1"".""lat"",""i1"".""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" AS ""i3"" WHERE ""i1"".""pid""!=""i3"".""pid"")"
215,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
216,"WITH ""cte1"" AS (SELECT ""TIV_2015"",COUNT(""PID"") AS ""count15"" FROM ""insurance"" AS ""i"" GROUP BY ""TIV_2015""), ""cte2"" AS (SELECT CONCAT(""LAT"", ""LON"") AS ""loc"",COUNT(""PID"") AS ""countloc"" FROM ""insurance"" AS ""i"" GROUP BY CONCAT(""LAT"", ""LON"")) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""cte1"" WHERE ""count15"">1) AND CONCAT(""LAT"", ""LON"") IN (SELECT ""loc"" FROM ""cte2"" WHERE ""countloc""=1)"
217,"SELECT ROUND(SUM(""a"".""tiv_2016""), 2) AS ""tiv_2016"" FROM (""insurance"" AS ""a"" JOIN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AS ""b"" ON ""a"".""tiv_2015""=""b"".""tiv_2015"") JOIN (SELECT ""lon"",""lat"" FROM ""insurance"" GROUP BY ""lon"",""lat"" HAVING COUNT(1)=1) AS ""c"" ON ""a"".""lat""=""c"".""lat"" AND ""a"".""lon""=""c"".""lon"""
218,"WITH ""t1"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1), ""t2"" AS (SELECT CONCAT(""lat"", ""lon"") AS ""a"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""t1"") AND CONCAT(""lat"", ""lon"") IN (SELECT ""a"" FROM ""t2"")"
219,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT DISTINCT ""I1"".* FROM ""insurance"" AS ""I1"" JOIN ""insurance"" AS ""I2"" ON ""I1"".""TIV_2015""=""I2"".""TIV_2015"" AND ""I1"".""PID""!=""I2"".""PID"" AND (""I1"".""LAT""!=""I2"".""LAT"" OR ""I1"".""LON""!=""I2"".""LON"") AND ROW(""I1"".""LAT"",""I1"".""LON"") IN (SELECT DISTINCT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)) AS ""A"""
220,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
221,"WITH ""t"" AS (SELECT *,COUNT(""tiv_2015"") OVER (PARTITION BY ""tiv_2015"") AS ""num_same_tiv_2015"",COUNT(""lat"") OVER (PARTITION BY ""lat"", ""lon"") AS ""num_same_lat_lon"" FROM ""insurance"") SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""t"" WHERE ""num_same_tiv_2015"">1 AND ""num_same_lat_lon""=1"
222,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(CONCAT(""LAT"", ""LON""))=1)"
223,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1)"
224,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,CONCAT(""LAT"", ',', ""LON"") AS ""loc"" FROM ""insurance"" GROUP BY ""loc"" HAVING COUNT(1)=1) AS ""t"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
225,"WITH ""cte"" AS (SELECT * FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""lat""+'-'+""lon"")=1), ""cte2"" AS (SELECT * FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1)) SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT ""pid"" FROM ""cte"") AND ""pid"" IN (SELECT ""pid"" FROM ""cte2"")"
226,"SELECT ROUND(SUM(""i"".""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""pid"" NOT IN (SELECT ""pid"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")<2) AND ROW(""i"".""lat"",""i"".""lon"") NOT IN (SELECT ""i2"".""lat"",""i2"".""lon"" FROM ""insurance"" AS ""i2"" WHERE ""i"".""pid""!=""i2"".""pid"")"
227,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""TIV_2016"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""cnt_2015"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""cnt_loc"" FROM ""insurance"") AS ""t"" WHERE ""cnt_2015"">1 AND ""cnt_loc""=1"
228,"SELECT ROUND(SUM(""ins1"".""TIV_2016""), 2) AS ""TIV_2016"" FROM (""insurance"" AS ""ins1"" CROSS JOIN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1) AS ""uniqueloc"") JOIN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AS ""2015val"" ON ""ins1"".""LAT""=""uniqueloc"".""LAT"" AND ""ins1"".""LON""=""uniqueloc"".""LON"" AND ""ins1"".""TIV_2015""=""2015val"".""TIV_2015"""
229,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
230,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1)"
231,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
232,"SELECT SUM(""TIV_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""pid"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
233,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""INSURANCE"" WHERE ""TIV_2015"" NOT IN (SELECT ""TIV_2015"" FROM ""INSURANCE"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""INSURANCE"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)"
234,"SELECT ROUND(SUM(""a"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1>(SELECT COUNT(""b"".""PID"") FROM ""insurance"" AS ""b"" WHERE (""a"".""PID""!=""b"".""PID"" AND ROW(""b"".""LAT"",""b"".""LON"")=ROW(""a"".""LAT"",""a"".""LON""))) AND 1<=(SELECT COUNT(""c"".""PID"") FROM ""insurance"" AS ""c"" WHERE (""a"".""PID""!=""c"".""PID"" AND ""a"".""TIV_2015""=""c"".""TIV_2015""))"
235,"WITH ""same_tiv_2015"" AS (SELECT ""i"".""tiv_2015"" FROM ""insurance"" AS ""i"" GROUP BY ""i"".""tiv_2015"" HAVING COUNT(""i"".""tiv_2015"")>1), ""diff_lat"" AS (SELECT ""i2"".""lat"",""i2"".""lon"" FROM ""insurance"" AS ""i2"" GROUP BY ""i2"".""lat"",""i2"".""lon"" HAVING (COUNT(""i2"".""lat"")=1)) SELECT SUM(""i3"".""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" AS ""i3"" WHERE ""i3"".""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""same_tiv_2015"") AND ROW(""i3"".""lat"",""i3"".""lon"") IN (SELECT ""lat"",""lon"" FROM ""diff_lat"")"
236,"WITH ""short_by_tiv"" AS (SELECT ""tiv_2015"",COUNT(DISTINCT ""pid"") AS ""c"" FROM ""insurance"" GROUP BY ""tiv_2015""), ""part1"" AS (SELECT ""i"".* FROM ""insurance"" AS ""i"" JOIN ""short_by_tiv"" AS ""t"" ON ""t"".""tiv_2015""=""i"".""tiv_2015"" AND ""c"">1), ""short_by_latlon"" AS (SELECT ""ke"",COUNT(DISTINCT ""pid"") AS ""pp"" FROM (SELECT CONCAT(""lat"", ""lon"") AS ""ke"",""pid"" FROM ""insurance"") AS ""sample"" GROUP BY ""ke""), ""part2"" AS (SELECT ""ins"".* FROM (SELECT ""i"".""pid"" FROM (SELECT ""pid"",CONCAT(""lat"", ""lon"") AS ""ke"" FROM ""insurance"") AS ""i"" JOIN ""short_by_latlon"" AS ""t"" ON ""t"".""ke""=""i"".""ke"" AND ""pp""=1) AS ""abc"" JOIN ""insurance"" AS ""ins"" ON ""ins"".""pid""=""abc"".""pid""), ""ans"" AS (SELECT ""p1"".""PID"",""p1"".""TIV_2015"",""p1"".""TIV_2016"",""p1"".""LAT"",""p1"".""LON"" FROM ""part1"" AS ""p1"" JOIN ""part2"" AS ""p2"" ON ""p1"".""pid""=""p2"".""pid"") SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""ans"""
237,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
238,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
239,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ""i1"".""tiv_2015"" IN (SELECT ""i2"".""tiv_2015"" FROM ""insurance"" AS ""i2"" WHERE ""i1"".""pid""!=""i2"".""pid"") AND ROW(""i1"".""lat"",""i1"".""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" AS ""i3"" WHERE ""i1"".""pid""!=""i3"".""pid"")"
240,"SELECT SUM(""BASE"".""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""A"".""PID"",""A"".""TIV_2016"" FROM (SELECT * FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM (SELECT ""TIV_2015"",COUNT(1) AS ""N"" FROM ""Insurance"" GROUP BY ""TIV_2015"") AS ""base15"" WHERE ""N"">1)) AS ""A"" LEFT JOIN ""Insurance"" AS ""B"" ON ""A"".""PID""!=""B"".""PId"" AND ""A"".""Lat""=""B"".""LAT"" AND ""A"".""LON""=""B"".""LON"" WHERE ""B"".""PID"" IS NULL) AS ""BASE"""
241,"WITH ""cte"" AS (SELECT ""i1"".""PID"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""TIV_2015""=""i2"".""TIV_2015"" AND ""i1"".""PID""!=""i2"".""PID""), ""cte2"" AS (SELECT ""i1"".""PID"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""LAT""=""i2"".""LAT"" AND ""i1"".""LON""=""i2"".""LON"" AND ""i1"".""PID""!=""i2"".""PID""), ""demo"" AS (SELECT DISTINCT ""PID"" FROM ""cte"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""cte2"")) SELECT SUM(""i"".""TIV_2016"") AS ""TIV_2016"" FROM ""demo"" AS ""d"" JOIN ""insurance"" AS ""i"" ON ""d"".""PID""=""i"".""PID"""
242,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""INSURANCE"" WHERE CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""INSURANCE"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""INSURANCE"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
243,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
244,"WITH ""temp"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""cnt"",COUNT(1) OVER (PARTITION BY ""tiv_2015"") AS ""tiv"" FROM ""insurance"") SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""temp"" WHERE ""tiv"">1 AND ""cnt""=1"
245,"SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM (SELECT DISTINCT ""a"".""pid"",""a"".""tiv_2016"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ""a"".""PID""!=""b"".""PID"" WHERE ""a"".""PID"" NOT IN (SELECT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""lat""=""b"".""lat"" AND ""a"".""lon""=""b"".""lon"" AND ""a"".""pid""!=""b"".""pid"")) AS ""a"""
246,"SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM (SELECT DISTINCT ""I1"".""pid"",""I1"".""tiv_2016"" FROM (""insurance"" AS ""I1"" JOIN ""insurance"" AS ""I2"" ON ""I1"".""TIV_2015""=""I2"".""TIV_2015"" AND ""I1"".""pid""!=""I2"".""pid"") JOIN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1) AS ""loc"" ON ""I1"".""lat""=""loc"".""lat"" AND ""I1"".""lon""=""loc"".""lon"") AS ""A"""
247,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
248,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT ""t"".""PID"",""t"".""TIV_2015"",""t"".""TIV_2016"",""t"".""LAT"",""t"".""LON"",""t1"".""TIV_2015_COUNT"",""t2"".""city_count"" FROM (""insurance"" AS ""t"" LEFT JOIN (SELECT ""TIV_2015"",COUNT(1) AS ""TIV_2015_COUNT"" FROM ""insurance"" GROUP BY ""TIV_2015"") AS ""t1"" ON ""t"".""TIV_2015""=""t1"".""TIV_2015"") LEFT JOIN (SELECT ""LAT"",""LON"",COUNT(1) AS ""city_count"" FROM ""insurance"" GROUP BY ""LAT"",""LON"") AS ""t2"" ON ""t"".""LAT""=""t2"".""LAT"" AND ""t"".""LON""=""t2"".""LON"" WHERE ""t1"".""TIV_2015_COUNT"">1 AND ""t2"".""city_count""=1) AS ""ft"""
249,"WITH ""CTE"" AS (SELECT *,CONCAT_WS(', ', ""LAT"", ""LON"") AS ""LOCATION"" FROM ""insurance""), ""CTE2"" AS (SELECT * FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""LOCATION"") AS ""cnt_location"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""cnt_tiv"" FROM ""CTE"" AS ""c"") AS ""sub"" WHERE ""sub"".""cnt_location""=1 AND ""sub"".""cnt_tiv"">=2) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""CTE2"""
250,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" NOT IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1)"
251,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)>1)"
252,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
253,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
254,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>=2) AND ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1)"
255,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
256,"SELECT SUM(""TIV_2016"") AS ""tiv_2016"" FROM ""insurance"" AS ""i"" WHERE (SELECT COUNT(DISTINCT ""PID"") FROM ""insurance"" WHERE ""TIV_2015""=""i"".""TIV_2015"")>=2 AND (SELECT COUNT(DISTINCT ""PID"") FROM ""insurance"" WHERE ""lat""=""i"".""lat"" AND ""lon""=""i"".""lon"")=1"
257,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""i"".""LAT"",""i"".""LON"") NOT IN (SELECT ""i1"".""LAT"",""i1"".""LON"" FROM ""insurance"" AS ""i1"" GROUP BY 1,2 HAVING COUNT(1)>1)"
258,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT DISTINCT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)"
259,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT *,COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""IV_occurence"",COUNT(""PID"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""location_occurence"" FROM ""insurance"") AS ""T"" WHERE ""IV_occurence"">1 AND ""location_occurence""=1"
260,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") AS ""ct"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
261,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AND ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1)"
262,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT DISTINCT (""a"".""PID"") FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" WHERE (""a"".""TIV_2015"")=(""b"".""TIV_2015"") AND ""a"".""PID"" NOT IN (SELECT DISTINCT (""a"".""PID"") FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" WHERE ROW(""a"".""LAT"",""a"".""LON"")=ROW(""b"".""LAT"",""b"".""LON"")))"
263,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1))"
264,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>=2) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>=2)"
265,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
266,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""pid"")=1)"
267,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""cnt1"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""cnt2"" FROM ""insurance"") AS ""tbl"" WHERE ""cnt1"">1 AND ""cnt2""=1"
268,"SELECT SUM(""A"".""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""A"".""TIV_2016"",""A"".""LAT"",""A"".""LON"",COUNT(1) OVER (PARTITION BY ""A"".""TIV_2015"") AS ""row_number"" FROM ""insurance"" AS ""A"") AS ""A"" JOIN (SELECT ""LAT"",""LON"",COUNT(1) FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AS ""B"" ON ""A"".""LAT""=""B"".""LAT"" AND ""A"".""LON""=""B"".""LON"" WHERE ""A"".""row_number"">1"
269,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
270,"WITH ""join_loc"" AS (SELECT DISTINCT ""l"".""PID"",""l"".""TIV_2015"",""l"".""TIV_2016"" FROM ""insurance"" AS ""l"" LEFT JOIN ""insurance"" AS ""r"" ON ""l"".""pid""!=""r"".""pid"" AND ""l"".""LAT""=""r"".""LAT"" AND ""l"".""LON""=""r"".""LON"" WHERE ""r"".""pid"" IS NULL), ""join_2015"" AS (SELECT DISTINCT ""l"".""PID"",""L"".""TIV_2016"" FROM ""join_loc"" AS ""l"" JOIN ""insurance"" AS ""r"" ON ""l"".""PID""!=""r"".""PID"" AND ""l"".""TIV_2015""=""r"".""TIV_2015"" WHERE ""r"".""TIV_2015"" IS NOT NULL) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""join_2015"""
271,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE EXISTS (SELECT * FROM ""insurance"" WHERE ""PID""!=""a"".""PID"" AND ""TIV_2015""=""a"".""TIV_2015"") AND NOT EXISTS (SELECT * FROM ""insurance"" WHERE ""PID""!=""a"".""PID"" AND ROW(""LAT"",""LON"")=ROW(""a"".""LAT"",""a"".""LON""))"
272,"SELECT ROUND(SUM(""i"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""i1"" WHERE ""i"".""TIV_2015""=""i1"".""TIV_2015"")>1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""i2"" WHERE ROW(""i"".""LAT"",""i"".""LON"")=ROW(""i2"".""LAT"",""i2"".""LON""))=1"
273,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
274,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
275,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ROW(""i1"".""lat"",""i1"".""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1) AND ""i1"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
276,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1)"
277,"WITH ""t1"" AS (SELECT DISTINCT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ROW(""a"".""LAT"",""a"".""LON"")!=ROW(""b"".""LAT"",""b"".""LON"")), ""t2"" AS (SELECT DISTINCT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ROW(""a"".""LAT"",""a"".""LON"")=ROW(""b"".""LAT"",""b"".""LON"")) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""t1"") AND ""PID"" NOT IN (SELECT ""PID"" FROM ""t2"")"
278,"SELECT SUM(""i"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1 AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1))"
279,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""count_latlon"",COUNT(""TIV_2015"") OVER (PARTITION BY ""TIV_2015"") AS ""count_TIV2015"" FROM ""insurance"") AS ""T"" WHERE ""count_latlon""=1 AND ""count_TIV2015"">1"
280,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT DISTINCT ""i3"".""pid"",""i3"".""TIV_2016"" FROM ""insurance"" AS ""i3"" JOIN ""insurance"" AS ""i4"" ON ""i3"".""TIV_2015""=""i4"".""TIV_2015"" WHERE ""i3"".""pid""!=""i4"".""pid"" AND ""i3"".""pid"" NOT IN (SELECT ""i1"".""PID"" FROM (""insurance"" AS ""i1"") CROSS JOIN ""insurance"" AS ""i2"" WHERE ""i1"".""lat""=""i2"".""lat"" AND ""i1"".""lon""=""i2"".""lon"" AND ""i1"".""pid""!=""i2"".""pid"")) AS ""t"""
281,"SELECT ROUND(SUM(""sub"".""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT DISTINCT ""a"".""PID"",""a"".""TIV_2016"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ""a"".""PID""!=""b"".""PID"" WHERE ""a"".""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1)) AS ""sub"""
282,"WITH ""cte"" AS (SELECT ""PID"",""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(""TIV_2015"")>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1)) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""CTE"""
283,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
284,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1 AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1))"
285,"SELECT SUM(""insurance"".""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1) AND CONCAT(""lat"", ',', ""lon"") IN (SELECT CONCAT(""lat"", ',', ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(CONCAT(""lat"", ',', ""lon""))<2)"
286,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
287,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
288,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"")=1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")>1"
289,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1<=(SELECT COUNT(1) FROM ""insurance"" WHERE ""a"".""PID""!=""PID"" AND ""TIV_2015""=""a"".""TIV_2015"") AND ROW(""a"".""LAT"",""a"".""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""insurance"" WHERE ""a"".""PID""!=""PID"")"
290,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
291,"WITH ""tiv15"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1), ""unique_city"" AS (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1) SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT * FROM ""tiv15"") AND ROW(""lat"",""lon"") IN (SELECT * FROM ""unique_city"")"
292,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM (SELECT DISTINCT ""I1"".* FROM ""insurance"" AS ""I1"" JOIN ""insurance"" AS ""I2"" ON ""I1"".""TIV_2015""=""I2"".""TIV_2015"" AND ""I1"".""PID""!=""I2"".""PID"" AND (""I1"".""LAT""!=""I2"".""LAT"" OR ""I1"".""LON""!=""I2"".""LON"") AND ROW(""I1"".""LAT"",""I1"".""LON"") NOT IN (SELECT DISTINCT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)) AS ""A"""
293,"WITH ""condition_1"" AS (SELECT DISTINCT ""s1"".""pid"" FROM (""insurance"" AS ""s1"") CROSS JOIN ""insurance"" AS ""s2"" WHERE ""s1"".""LON""=""s2"".""LON"" AND ""s1"".""LAT""=""s2"".""LAT"" AND ""s1"".""pid""!=""s2"".""pid""), ""condition_2"" AS (SELECT DISTINCT ""s1"".""pid"" FROM (""insurance"" AS ""s1"") CROSS JOIN ""insurance"" AS ""s2"" WHERE ""s1"".""TIV_2015""=""s2"".""TIV_2015"" AND ""s1"".""pid""!=""s2"".""pid"" AND ""s1"".""pid""), ""final"" AS (SELECT * FROM ""condition_2"" AS ""c1"" WHERE ""c1"".""pid"" NOT IN (SELECT * FROM ""condition_1"")) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""s"" RIGHT JOIN ""final"" AS ""f"" ON ""s"".""pid""=""f"".""pid"""
294,"WITH ""xyz"" AS (SELECT ""tiv_2015"",COUNT(""tiv_2015"") AS ""cnt"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")!=1), ""abc"" AS (SELECT CONCAT(""LAT"", ""LON"") AS ""location"",COUNT(1) FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(1)=1) SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""i"".""TIV_2015"" IN (SELECT DISTINCT ""tiv_2015"" FROM ""xyz"") AND CONCAT(""i"".""LAT"", ""i"".""LON"") IN (SELECT DISTINCT ""location"" FROM ""abc"")"
295,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>=2) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
296,"WITH ""f1"" AS (SELECT DISTINCT ""a"".""pid"" FROM ""insurance"" AS ""a"" CROSS JOIN ""insurance"" AS ""b"" WHERE ""a"".""tiv_2015""=""b"".""tiv_2015"" AND ""a"".""pid""!=""b"".""pid""), ""f2"" AS (SELECT ""pid"" FROM ""insurance"" WHERE ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1)) SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""pid"" IN (SELECT ""f1"".""pid"" FROM ""f1"" JOIN ""f2"" USING (""pid""))"
297,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1)"
298,"WITH ""cte"" AS (SELECT *,COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""cnt1"",COUNT(""PID"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""cnt2"" FROM ""insurance"") SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""cte"" WHERE ""cnt1"">1 AND ""cnt2""=1"
299,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""loc"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""tiv"" FROM ""insurance"") AS ""temp"" WHERE ""loc""=1 AND ""tiv"">1"
300,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
301,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
302,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
303,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") AS ""city"" FROM ""insurance"" GROUP BY ""city"" HAVING COUNT(1)=1) AND ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
304,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(CONCAT(""LAT"", ""LON""))=1)"
305,"WITH ""t1"" AS (SELECT DISTINCT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ROW(""a"".""LAT"",""a"".""LON"")!=ROW(""b"".""LAT"",""b"".""LON"")), ""t2"" AS (SELECT DISTINCT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ROW(""a"".""LAT"",""a"".""LON"")=ROW(""b"".""LAT"",""b"".""LON"")) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""t1"") AND ""PID"" NOT IN (SELECT ""PID"" FROM ""t2"")"
306,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"")=1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")>1"
307,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")=1) AND ""TIV_2015"" NOT IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")=1)"
308,"SELECT SUM(""i_4"".""tiv_2016"") AS ""TIV_2016"" FROM (SELECT ""tiv_2016"" FROM ((""insurance"" AS ""i_1"") CROSS JOIN (SELECT ""tiv_2015"",COUNT(1) FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1) AS ""i_2"") CROSS JOIN (SELECT ""lat"",""lon"",COUNT(1) FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) AS ""i_3"" WHERE ""i_1"".""tiv_2015""=""i_2"".""tiv_2015"" AND ""i_1"".""lat""=""i_3"".""lat"" AND ""i_1"".""lon""=""i_3"".""lon"") AS ""i_4"""
309,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")>1)"
310,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" NOT IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")<=1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(CONCAT(""LAT"", ""LON""))=1)"
311,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)"
312,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT ""PID"",""TIV_2015"",COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""ct_2015"",""TIV_2016"",COUNT(""PID"") OVER (PARTITION BY CONCAT(""LAT"", ""LON"")) AS ""ct_location"" FROM ""insurance"") AS ""sub"" WHERE ""ct_2015"">1 AND ""ct_location""=1"
313,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""pid"" NOT IN (SELECT ""pid"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""pid"")=1) AND ""pid"" IN (SELECT ""pid"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""pid"")=1)"
314,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" WHERE CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(CONCAT(""LAT"", ""LON""))=1)))"
315,"WITH ""temp"" AS (SELECT ""PID"",""TIV_2015"",""TIV_2016"",CONCAT(""LAT"", ""LON"") AS ""Location"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""temp"" WHERE ""Location"" IN (SELECT CONCAT(""LAT"", ""LON"") AS ""Location"" FROM ""insurance"" GROUP BY ""Location"" HAVING COUNT(1)=1)"
316,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")<=1 UNION SELECT ""i1"".""PID"" FROM ""insurance"" AS ""i1"" JOIN ""insurance"" AS ""i2"" ON ""i1"".""LAT""=""i2"".""LAT"" AND ""i1"".""LON""=""i2"".""LON"" AND ""i1"".""PID""!=""i2"".""PID"")"
317,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1) AND ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1)"
318,"SELECT ROUND(SUM(""p1"".""tiv_2016""), 2) AS ""tiv_2016"" FROM (SELECT ""t1"".* FROM ""insurance"" AS ""t1"" LEFT JOIN (SELECT ""tiv_2015"",COUNT(""tiv_2015"") AS ""count_t15"" FROM ""insurance"" GROUP BY ""tiv_2015"") AS ""t2"" ON ""t1"".""tiv_2015""=""t2"".""tiv_2015"" WHERE ""t2"".""count_t15"">1) AS ""p1"" JOIN (SELECT ""k1"".* FROM ""insurance"" AS ""k1"" LEFT JOIN (SELECT ""lat"",""lon"",COUNT(""lat"") AS ""count_city"" FROM ""insurance"" GROUP BY ""lat"",""lon"") AS ""k2"" ON ""k1"".""lat""=""k2"".""lat"" AND ""k1"".""lon""=""k2"".""lon"" WHERE ""k2"".""count_city""=1) AS ""p2"" ON ""p1"".""pid""=""p2"".""pid"""
319,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""i"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>=2) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY CONCAT(""LAT"", ""LON"") HAVING COUNT(CONCAT(""LAT"", ""LON""))>=2)"
320,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND ROW(""lat"",""lon"") IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1)"
321,"WITH ""same_tiv_2015"" AS (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)>1), ""diff_lat_long"" AS (SELECT ""lat"",""lon"",COUNT(1) FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1) SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM (""insurance"" AS ""i1"" JOIN ""same_tiv_2015"" AS ""r1"" ON ""i1"".""tiv_2015""=""r1"".""tiv_2015"") JOIN ""diff_lat_long"" AS ""r2"" ON ""i1"".""lat""=""r2"".""lat"" AND ""i1"".""lon""=""r2"".""lon"""
322,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
323,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)"
324,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""LAT"",""LON"" FROM ""Insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)"
325,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE 1=(SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""LAT""=""b"".""LAT"" AND ""a"".""LON""=""b"".""LON"") AND 1<(SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""TIV_2015""=""c"".""TIV_2015"")"
326,"SELECT SUM(""i1"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""i1"" WHERE ROW(""i1"".""lat"",""i1"".""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1) AND ""i1"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)"
327,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY 1,2 HAVING COUNT(1)=1)"
328,"WITH ""T1"" AS (SELECT ""PID"",""TIV_2016"",COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""c"" FROM ""insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""T1"" WHERE ""c"">1 AND ""PID"" NOT IN (SELECT ""I2"".""PID"" FROM ""insurance"" AS ""I1"" CROSS JOIN ""insurance"" AS ""I2"" WHERE (""I1"".""LAT""=""I2"".""LAT"") AND (""I1"".""LON""=""I2"".""LON"") AND (""I1"".""PID""!=""I2"".""PID""))"
329,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""PID"")>1) AND CONCAT(""LAT"", ""LON"") NOT IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""PID"")>1)"
330,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
331,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
332,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
333,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ROW(""LAT"",""LON"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1))"
334,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(""tiv_2015"")>1) AND ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(""pid"")>1)"
335,"WITH ""lat_lon"" AS (SELECT ""Lat"",""Lon"",COUNT(1) AS ""cnt"" FROM ""insurance"" GROUP BY 1,2) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM (SELECT DISTINCT (""a"".""PID""),""a"".""TIV_2016"" FROM (""insurance"" AS ""a"" LEFT JOIN ""insurance"" AS ""b"" ON ""a"".""TIV_2015""=""b"".""TIV_2015"" AND ""a"".""PID""!=""b"".""PID"") LEFT JOIN ""lat_lon"" AS ""c"" ON ""a"".""lat""=""c"".""lat"" AND ""a"".""lon""=""c"".""lon"" WHERE ""b"".""PID"" IS NOT NULL AND ""cnt""=1) AS ""a"""
336,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
337,"WITH ""conditions"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""lat"", ""lon"") AS ""city_count"",COUNT(1) OVER (PARTITION BY ""tiv_2015"") AS ""tiv_15_count"" FROM ""insurance"") SELECT SUM(""tiv_2016"") AS ""TIV_2016"" FROM ""conditions"" WHERE ""city_count""=1 AND ""tiv_15_count"">1"
338,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(""TIV_2015"")>1) AND ROW(""LAT"",""LON"") IN (SELECT ""LAT"",""LON"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(""LAT"")=1 AND COUNT(""LON"")=1)"
339,"SELECT ROUND(SUM(""a"".""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE (SELECT COUNT(1) FROM ""insurance"" AS ""b"" WHERE ""a"".""lat""=""b"".""lat"" AND ""a"".""lon""=""b"".""lon"")=1 AND (SELECT COUNT(1) FROM ""insurance"" AS ""c"" WHERE ""a"".""tiv_2015""=""c"".""tiv_2015"")>1"
340,"WITH ""cte"" AS (SELECT ""TIV_2016"",COUNT(""PID"") OVER (PARTITION BY ""TIV_2015"") AS ""condition1"",COUNT(""PID"") OVER (PARTITION BY ""LAT"", ""LON"") AS ""condition2"" FROM ""insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""cte"" WHERE ""condition1"">=2 AND ""condition2""=1"
341,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
342,"WITH ""temp"" AS (SELECT ""TIV_2016"",CONCAT(""LAT"", ""LON"") AS ""coord"" FROM ""Insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""Insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1)) SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""temp"" WHERE ""coord"" NOT IN (SELECT CONCAT(""LAT"", ""LON"") AS ""coord"" FROM ""Insurance"" GROUP BY ""coord"" HAVING COUNT(1)>1)"
343,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" NOT IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)=1) AND ""PID"" IN (SELECT ""PID"" FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
344,"SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
345,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""Insurance"" AS ""a"" WHERE EXISTS (SELECT * FROM ""Insurance"" WHERE ""PID""!=""a"".""PID"" AND ""TIV_2015""=""a"".""TIV_2015"") AND NOT EXISTS (SELECT * FROM ""Insurance"" WHERE ""PID""!=""a"".""PID"" AND ROW(""LAT"",""LON"")=ROW(""a"".""LAT"",""a"".""LON""))"
346,"WITH ""join_loc"" AS (SELECT DISTINCT ""l"".""PID"",""l"".""TIV_2015"",""l"".""TIV_2016"" FROM ""insurance"" AS ""l"" LEFT JOIN ""insurance"" AS ""r"" ON ""l"".""pid""!=""r"".""pid"" AND ""l"".""LAT""=""r"".""LAT"" AND ""l"".""LON""=""r"".""LON"" WHERE ""r"".""pid"" IS NULL), ""join_2015"" AS (SELECT DISTINCT ""l"".""PID"",""L"".""TIV_2016"" FROM ""join_loc"" AS ""l"" JOIN ""insurance"" AS ""r"" ON ""l"".""PID""!=""r"".""PID"" AND ""l"".""TIV_2015""=""r"".""TIV_2015"" WHERE ""r"".""TIV_2015"" IS NOT NULL) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""join_2015"""
347,"SELECT SUM(""a"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" AS ""a"" WHERE ""a"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)=1)"
348,"WITH ""w"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""TIV_2015"") AS ""same_TIV_2015"",COUNT(1) OVER (PARTITION BY ""LAT"", ""LON"") AS ""unique_geo"" FROM ""Insurance"") SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""w"" WHERE ""same_TIV_2015"">1 AND ""unique_geo""=1"
349,"SELECT ROUND(SUM(""TIV_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT DISTINCT ""a"".""PID"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ""a"".""TIV_2015""=""b"".""TIV_2015"" WHERE ""a"".""PID"" NOT IN (SELECT ""c"".""PID"" FROM ""insurance"" AS ""c"" JOIN ""insurance"" AS ""d"" ON ""c"".""PID""!=""d"".""PID"" AND ""c"".""LAT""=""d"".""LAT"" AND ""c"".""LON""=""d"".""LON""))"
350,"WITH ""cte"" AS (SELECT DISTINCT ""a"".""PID"",""a"".""LAT"",""a"".""LON"" FROM ""insurance"" AS ""a"" JOIN ""insurance"" AS ""b"" ON ""a"".""PID""!=""b"".""PID"" AND ""a"".""TIV_2015""=""b"".""TIV_2015""), ""tmp"" AS (SELECT ""PID"" FROM ""cte"" WHERE CONCAT(""LAT"", ""LON"") NOT IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)>1)) SELECT SUM(""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""PID"" IN (SELECT ""PID"" FROM ""tmp"")"
351,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM ""insurance"" WHERE ""tiv_2015"" NOT IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY ""tiv_2015"" HAVING COUNT(1)=1) AND ROW(""lat"",""lon"") NOT IN (SELECT ""lat"",""lon"" FROM ""insurance"" GROUP BY ""lat"",""lon"" HAVING COUNT(1)>1)"
352,"ERROR: mysql parse error: line 1 column 149 near ""TIV_2015 in (select TIV_2015 from insurance group by TIV_2015 having count(*)>1)"" "
353,"SELECT SUM(""tiv_2016"") AS ""tiv_2016"" FROM (SELECT *,COUNT(""pid"") OVER (PARTITION BY ""tiv_2015"") AS ""num_2015"" FROM ""insurance"") AS ""temp"" WHERE ""num_2015"">=2 AND ""pid"" NOT IN (SELECT ""i1"".""pid"" FROM ""insurance"" AS ""i1"" JOIN (SELECT ""pid"",""lat"",""lon"" FROM ""insurance"") AS ""i2"" ON ""i1"".""pid""!=""i2"".""pid"" WHERE ""i1"".""lat""=""i2"".""lat"" AND ""i1"".""lon""=""i2"".""lon"")"
354,"SELECT SUM(""insurance"".""TIV_2016"") AS ""TIV_2016"" FROM ""insurance"" WHERE ""insurance"".""TIV_2015"" IN (SELECT ""TIV_2015"" FROM ""insurance"" GROUP BY ""TIV_2015"" HAVING COUNT(1)>1) AND CONCAT(""LAT"", ""LON"") IN (SELECT CONCAT(""LAT"", ""LON"") FROM ""insurance"" GROUP BY ""LAT"",""LON"" HAVING COUNT(1)=1)"
355,"SELECT ROUND(SUM(""tiv_2016""), 2) AS ""TIV_2016"" FROM ""insurance"" WHERE ""tiv_2015"" IN (SELECT ""tiv_2015"" FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(""lat"", ""lon"") IN (SELECT CONCAT(""lat"", ""lon"") FROM ""insurance"" GROUP BY 1 HAVING COUNT(1)=1)"
