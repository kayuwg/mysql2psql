id,original query
1,"WITH ""cte"" AS (SELECT ""c"".""caller_id"" AS ""id"",""c"".""duration"",LEFT(""p"".""phone_number"", 3) AS ""countrycode"" FROM ""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT ""c"".""callee_id"" AS ""id"",""c"".""duration"",LEFT(""p"".""phone_number"", 3) AS ""countrycode"" FROM ""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id""), ""countryavg"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""duration"") AS ""avgduration"" FROM ""Country"" AS ""c"" LEFT JOIN ""cte"" AS ""cte"" ON ""c"".""country_code""=""cte"".""countrycode"" GROUP BY ""c"".""country_code"") SELECT ""country"" FROM ""countryavg"" WHERE ""avgduration"">(SELECT AVG(""duration"") FROM ""calls"")"
2,"WITH ""person_w_country_code"" AS (SELECT ""id"",""name"",LEFT(""phone_number"", POSITION('-' IN ""phone_number"")-1) AS ""country_code"" FROM ""Person""), ""all_calls"" AS (SELECT ""caller_id"" AS ""call_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""call_id"",""duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""all_calls"" AS ""calls"" JOIN ""person_w_country_code"" AS ""p"" ON ""calls"".""call_id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=""p"".""country_code"" GROUP BY ""p"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
3,"WITH ""country_code"" AS (SELECT ""id"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING_INDEX(""p"".""phone_number"", '-', 1)), ""call_duration"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""name"" AS ""country"" FROM ""country_code"" JOIN ""call_duration"" ON ""country_code"".""id""=""call_duration"".""id"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
4,"SELECT ""name"" AS ""country"" FROM (SELECT ""a"".""id"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""duration"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""a"" JOIN ""Person"" AS ""p"" ON ""p"".""id""=""a"".""id"") AS ""b"" JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=""b"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
5,"WITH ""person_country"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country_name"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""all_calls"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT ""pc"".""country_name"" AS ""country"" FROM ""person_country"" AS ""pc"" LEFT JOIN ""all_calls"" AS ""ac"" ON ""pc"".""id""=""ac"".""id"" GROUP BY ""pc"".""country_name"" HAVING AVG(""ac"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
6,"WITH ""base"" AS (SELECT DISTINCT ""caller_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3) UNION ALL SELECT DISTINCT ""callee_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""callee_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3)), ""base1"" AS (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg_country"",(SELECT AVG(""duration"") FROM ""Calls"") AS ""avg_global"" FROM ""base"") SELECT ""name"" AS ""country"" FROM ""base1"" WHERE ""avg_country"">""avg_global"""
7,"WITH ""temp"" AS (SELECT *,LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") SELECT ""c1"".""name"" AS ""country"" FROM (""Country"" AS ""c1"" LEFT JOIN ""temp"" AS ""t"" ON ""c1"".""country_code""=""t"".""country_code"") LEFT JOIN ""calls"" AS ""c2"" ON ""t"".""id""=""c2"".""caller_id"" OR ""t"".""id""=""c2"".""callee_id"" GROUP BY ""c1"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
8,"WITH ""union_table"" AS (SELECT ""caller_id"" AS ""calling"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""calling"",""duration"" FROM ""Calls""), ""person_country"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country_name"" FROM (SELECT *,LEFT(""phone_number"", 3) AS ""country_c"" FROM ""Person"") AS ""p"" JOIN ""Country"" AS ""c"" ON ""p"".""country_c""=""c"".""country_code""), ""final"" AS (SELECT ""country_name"",AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"") AS ""durat"" FROM ""union_table"" AS ""t"" JOIN ""person_country"" AS ""p"" ON ""t"".""calling""=""p"".""id"" GROUP BY ""country_name"") SELECT ""country_name"" AS ""country"" FROM ""final"" WHERE ""durat""=1"
9,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""callee_id"" AS ""caller_id"",""caller_id"" AS ""callee_id"",""duration"" FROM ""Calls"" UNION SELECT * FROM ""Calls"") AS ""sub"" LEFT JOIN ""Person"" AS ""p"" ON ""sub"".""caller_id""=""p"".""id"") LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" GROUP BY ""c"".""name"" HAVING SUM(""sub"".""duration"")/COUNT(1)>(SELECT SUM(""sub2"".""duration"")/COUNT(1) FROM (SELECT ""callee_id"" AS ""caller_id"",""caller_id"" AS ""callee_id"",""duration"" FROM ""Calls"" UNION SELECT * FROM ""Calls"") AS ""sub2"")"
10,"WITH ""all_calls"" AS (SELECT ""caller_id"" AS ""call_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""call_id"",""duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""all_calls"" AS ""a"" ON ""p"".""id""=""a"".""call_id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""all_calls"")"
11,"WITH ""cte"" AS (SELECT ""Country"".""name"" AS ""country"",AVG(""duration"") AS ""duration"" FROM ((SELECT ""caller_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""caller_id"",""duration"" FROM ""Calls"") AS ""Calls"" JOIN ""Country"") JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" AND ""Country"".""country_code""=SUBSTR(""phone_number"", 1, 3) GROUP BY ""Country"".""name"") SELECT ""country"" FROM ""cte"" WHERE ""duration"">(SELECT AVG(""duration"") FROM ""calls"")"
12,"WITH ""tmp"" AS (SELECT ""id"",""c"".""name"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING_INDEX(""p"".""phone_number"", '-', 1)=""c"".""country_code""), ""tmp1"" AS (SELECT ""name"",AVG(""duration"") AS ""avg_duration"" FROM (SELECT ""name"",""caller_id"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""tmp"" AS ""t"" ON ""c"".""caller_id""=""t"".""id"" UNION ALL SELECT ""name"",""callee_id"" AS ""caller_id"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""tmp"" AS ""t"" ON ""c"".""callee_id""=""t"".""id"") AS ""t1"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""tmp1"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")"
13,"WITH ""m"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""m"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""m"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
14,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""x"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""x"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" GROUP BY LEFT(""p"".""phone_number"", 3) HAVING AVG(""x"".""duration"")>(SELECT AVG(""duration"") AS ""average"" FROM ""Calls"")"
15,"SELECT ""C"".""name"" AS ""country"" FROM (""Person"" AS ""P"" LEFT JOIN ""Country"" AS ""C"" ON LEFT(""P"".""phone_number"", 3)=""C"".""country_code"") JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""phn"" ON ""P"".""id""=""phn"".""id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
16,"WITH ""CTE"" AS (SELECT ""a"".""id"",""a"".""country_code"",""b"".""name"" AS ""country"",""c"".""duration"" FROM ((SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""a"" LEFT JOIN ""Country"" AS ""b"" ON ""a"".""country_code""=""b"".""country_code"") LEFT JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""c"" ON ""a"".""id""=""c"".""id"") SELECT ""country"" FROM ""CTE"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""CTE"")"
17,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" AS ""a"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"" AS ""b"") AS ""a"" JOIN ""person"" AS ""p"" ON ""a"".""id""=""p"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
18,"WITH ""t"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTR(""phone_number"", 1, 3)=""country_code""), ""c"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""country"" FROM ""c"" LEFT JOIN ""t"" ON ""t"".""id""=""c"".""id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""c"")"
19,"WITH ""cte"" AS (SELECT ""t2"".""caller_id"" AS ""caller_id"",""t2"".""calls"" AS ""calls"",""t2"".""duration"" AS ""duration"",SUBSTRING(""p"".""phone_number"", 1, 3) AS ""country_code"" FROM (SELECT ""t1"".""caller_id"" AS ""caller_id"",SUM(""t1"".""calls"") AS ""calls"",SUM(""t1"".""duration"") AS ""duration"" FROM (SELECT ""caller_id"",COUNT(""duration"") AS ""calls"",SUM(""duration"") AS ""duration"" FROM ""Calls"" GROUP BY 1 UNION ALL SELECT ""callee_id"",COUNT(""duration"") AS ""calls"",SUM(""duration"") AS ""duration"" FROM ""Calls"" GROUP BY 1) AS ""t1"" GROUP BY 1) AS ""t2"" LEFT JOIN ""Person"" AS ""p"" ON ""t2"".""caller_id""=""p"".""id"") SELECT ""c"".""name"" AS ""country"" FROM ""cte"" LEFT JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=""cte"".""country_code"" GROUP BY 1 HAVING SUM(""cte"".""duration"")/SUM(""cte"".""calls"")>(SELECT SUM(""duration"")/SUM(""calls"") FROM ""cte"")"
20,"WITH ""calls_long"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls""), ""country_person"" AS (SELECT ""p"".""id"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTRING_INDEX(""p"".""phone_number"", '-', 1)=""c"".""country_code"") SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""cp"".""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""country_avg"",AVG(""duration"") OVER () AS ""global_avg"" FROM ""calls_long"" AS ""cl"" JOIN ""country_person"" AS ""cp"" USING (""id"")) AS ""a"" WHERE ""country_avg"">""global_avg"""
21,"SELECT ""country"".""name"" AS ""country"" FROM ((SELECT * FROM ""calls"" UNION ALL SELECT ""callee_id"",""caller_id"",""duration"" FROM ""calls"") AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") JOIN ""country"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""country"".""country_code"" GROUP BY ""country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
22,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
23,"SELECT ""B"".""name"" AS ""country"" FROM ((SELECT * FROM ""Person"") AS ""A"" JOIN ""Country"" AS ""B"" ON SUBSTRING(""A"".""phone_number"", 1, 3)=""B"".""country_code"") JOIN (SELECT ""caller_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls"") AS ""C"" ON ""C"".""caller_id""=""A"".""id"" GROUP BY ""B"".""name"" HAVING AVG(""C"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
24,"WITH ""t"" AS (SELECT ""co"".""name"" AS ""country"",""duration"" FROM (""Calls"" AS ""ca"" JOIN ""Person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"") JOIN ""Country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" UNION ALL SELECT ""co"".""name"" AS ""country"",""duration"" FROM (""Calls"" AS ""ca"" JOIN ""Person"" AS ""p"" ON ""ca"".""callee_id""=""p"".""id"") JOIN ""Country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"") SELECT ""country"" FROM ""t"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""t"")"
25,"WITH ""temp"" AS (SELECT ""id"",""name"" AS ""country"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""person"") AS ""t1"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=""t1"".""country_code""), ""cte"" AS (SELECT ""country"",""duration"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") AS ""t1"" JOIN ""temp"" AS ""t"" ON ""t1"".""id""=""t"".""id"") SELECT ""country"" FROM ""cte"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
26,"WITH ""calltable"" AS (SELECT ""c"".""caller_id"" AS ""id"",""c"".""duration"" AS ""duration"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""ct"".""name"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""ct"" ON LEFT(""p"".""phone_number"", 3)=""ct"".""country_code"" UNION ALL SELECT ""c"".""callee_id"" AS ""id"",""c"".""duration"" AS ""duration"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""ct"".""name"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""ct"" ON LEFT(""p"".""phone_number"", 3)=""ct"".""country_code"") SELECT ""name"" AS ""country"" FROM ""calltable"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
27,"WITH ""country_personId"" AS (SELECT ""c"".""name"" AS ""country"",""c"".""country_code"",""p"".""id"" AS ""id"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) SELECT ""country"" FROM ""country_personId"" LEFT JOIN (SELECT ""caller_id"" AS ""caller"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""caller"",""duration"" FROM ""calls"") AS ""caller_duration"" ON ""country_personId"".""id""=""caller_duration"".""caller"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
28,"WITH ""temp"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls""), ""phone"" AS (SELECT ""b"".""id"",""a"".""name"" AS ""country"" FROM ""country"" AS ""a"" JOIN (SELECT ""id"",""name"",LEFT(""phone_number"", 3) AS ""cod"" FROM ""person"") AS ""b"" ON ""a"".""country_code""=""b"".""cod"") SELECT ""country"" FROM ""temp"" AS ""a"" JOIN ""phone"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
29,"WITH ""global_avg"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""calls"") SELECT ""name"" AS ""country"" FROM (SELECT ""ca"".""caller_id"",""co"".""name"",""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""caller_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" UNION SELECT ""ca"".""callee_id"",""co"".""name"",""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""callee_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"") AS ""result_table"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT * FROM ""global_avg"")"
30,"WITH ""country_info"" AS (SELECT DISTINCT ""p"".""id"",""country"".""name"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""number"" FROM ""person"") AS ""p"" LEFT JOIN ""country"" ON ""country"".""country_code""=""p"".""number""), ""total_call"" AS (SELECT ""caller_id"" AS ""person"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""person"",""duration"" FROM ""calls""), ""country_avg"" AS (SELECT ""country_info"".""name"",AVG(""total_call"".""duration"") AS ""country_avg"" FROM ""country_info"" JOIN ""total_call"" ON ""country_info"".""id""=""total_call"".""person"" GROUP BY ""country_info"".""name"") SELECT ""country_avg"".""name"" AS ""country"" FROM ""country_avg"" WHERE ""country_avg"">(SELECT AVG(""duration"") FROM ""calls"")"
31,"SELECT ""co"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"") JOIN ""CALLS"" AS ""ca"" ON ""p"".""id"" IN (""ca"".""caller_id"",""ca"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
32,"WITH ""cte_code"" AS (SELECT SUBSTR(""phone_number"", 1, 3) AS ""country_code"",""id"" FROM ""person""), ""cte_country"" AS (SELECT ""name"",""id"" FROM ""country"" JOIN ""cte_code"" ON ""country"".""country_code""=""cte_code"".""country_code""), ""cte_caller"" AS (SELECT ""name"",SUM(""duration"") AS ""tot_duration"",COUNT(""duration"") AS ""tot_ct"" FROM ""cte_country"" JOIN ""calls"" ON ""cte_country"".""id""=""calls"".""caller_id"" GROUP BY ""name""), ""cte_callee"" AS (SELECT ""name"",SUM(""duration"") AS ""tot_duration"",COUNT(""duration"") AS ""tot_ct"" FROM ""cte_country"" JOIN ""calls"" ON ""cte_country"".""id""=""calls"".""callee_id"" GROUP BY ""name""), ""cte_all"" AS (SELECT ""name"",SUM(""tot_duration"") AS ""tot_duration"",SUM(""tot_ct"") AS ""tot_ct"" FROM (SELECT * FROM ""cte_caller"" UNION ALL SELECT * FROM ""cte_callee"") AS ""t"" GROUP BY ""name"") SELECT ""name"" AS ""country"" FROM ""cte_all"" WHERE ""tot_duration""/""tot_ct"">(SELECT SUM(""tot_duration"")/SUM(""tot_ct"") FROM ""cte_all"")"
33,"WITH ""s"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""x"" AS (SELECT ""s"".""country"",""duration"" FROM ""calls"" AS ""c"" JOIN ""s"" ON ""c"".""caller_id""=""s"".""id"" UNION ALL SELECT ""s"".""country"",""duration"" FROM ""calls"" AS ""c"" JOIN ""s"" ON ""c"".""callee_id""=""s"".""id"") SELECT ""country"" FROM ""x"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""x"")"
34,"SELECT ""name"" AS ""country"" FROM (SELECT ""P"".""id"",""T"".""name"",""C1"".""duration"" FROM (""Person"" AS ""P"" LEFT JOIN ""Country"" AS ""T"" ON LEFT(""P"".""phone_number"", 3)=""T"".""country_code"") LEFT JOIN ""Calls"" AS ""C1"" ON ""P"".""id""=""C1"".""caller_id"" UNION SELECT ""P"".""id"",""T"".""name"",""C2"".""duration"" FROM (""Person"" AS ""P"" LEFT JOIN ""Country"" AS ""T"" ON LEFT(""P"".""phone_number"", 3)=""T"".""country_code"") LEFT JOIN ""Calls"" AS ""C2"" ON ""P"".""id""=""C2"".""callee_id"") AS ""tb"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
35,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Country"" ON LEFT(""phone_number"", 3)=""Country"".""country_code"") JOIN ""Calls"" ON ""Person"".""id"" IN (""Calls"".""caller_id"",""Calls"".""callee_id"") GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
36,"SELECT ""ct"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls"") AS ""c"" LEFT JOIN (SELECT ""id"",SUBSTRING(""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"") AS ""p"" ON ""c"".""id""=""p"".""id"") LEFT JOIN ""Country"" AS ""ct"" ON ""p"".""country_code""=""ct"".""country_code"" GROUP BY 1 HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") AS ""global_avg"" FROM ""Calls"")"
37,"SELECT ""b"".""name"" AS ""country"" FROM (""Person"" AS ""a"" JOIN ""Country"" AS ""b"" ON SUBSTRING(""a"".""phone_number"", 1, 3)=""b"".""country_code"") JOIN ""Calls"" AS ""c"" ON (""a"".""id""=""c"".""caller_id"") OR (""a"".""id""=""c"".""callee_id"") GROUP BY ""b"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
38,"WITH ""cte"" AS (SELECT ""a"".""id"",""b"".""name"" FROM ""Person"" AS ""a"" LEFT JOIN ""Country"" AS ""b"" ON (LEFT(""a"".""phone_number"", 3))=""b"".""country_code""), ""cte2"" AS (SELECT ""b"".""name"" AS ""country"",""duration"" FROM ""Calls"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"" UNION ALL SELECT ""b"".""name"" AS ""country"",""duration"" FROM ""Calls"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""callee_id""=""b"".""id"") SELECT ""country"" FROM ""cte2"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
39,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"",""duration"" FROM ""calls"") SELECT ""co"".""name"" AS ""country"" FROM (""cte"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""id""=""p"".""id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
40,"WITH ""calltable"" AS (SELECT ""caller_id"" AS ""id"",""duration"",LEFT(""p"".""phone_number"", 3) AS ""country_code"" FROM ""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"",LEFT(""p"".""phone_number"", 3) AS ""country_code"" FROM ""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") SELECT ""c"".""name"" AS ""country"" FROM ""country"" AS ""c"" JOIN ""calltable"" AS ""t"" USING (""country_code"") GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
41,"WITH ""base"" AS ((SELECT ""country_code"",""country"".""name"",COUNT(1) AS ""calls"",SUM(""c"".""duration"") AS ""duration"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") JOIN ""country"" ON LEFT(""p"".""phone_number"", 3)=""country"".""country_code"" GROUP BY 1,2) UNION ALL (SELECT ""country_code"",""country"".""name"",COUNT(1) AS ""calls"",SUM(""c"".""duration"") AS ""duration"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") JOIN ""country"" ON LEFT(""p"".""phone_number"", 3)=""country"".""country_code"" GROUP BY 1,2)) SELECT ""name"" AS ""country"" FROM ""base"" GROUP BY ""country_code"",""name"" HAVING SUM(""duration"")/SUM(""calls"")>(SELECT SUM(""duration"")/SUM(""calls"") FROM ""base"")"
42,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""c"".""name"",AVG(""duration"") OVER (PARTITION BY ""c"".""country_code"") AS ""country_avg"",AVG(""duration"") OVER () AS ""global_avg"" FROM (""cte"" JOIN ""person"" AS ""p"" USING (""id"")) JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""temp"" WHERE ""country_avg"">""global_avg"""
43,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""a"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""a"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
44,"SELECT ""name"" AS ""country"" FROM (SELECT ""ca"".""caller_id"",""co"".""name"",""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""caller_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" UNION SELECT ""ca"".""callee_id"",""co"".""name"",""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""callee_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"") AS ""result_table"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
45,"WITH ""cte"" AS (SELECT *,SUBSTR(""phone_number"", 1, 3) AS ""country_code"" FROM ""person""), ""cte2"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte"" JOIN ""country"" AS ""c"" ON ""cte"".""country_code""=""c"".""country_code"") JOIN ""cte2"" ON ""cte"".""id""=""cte2"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte2"")"
46,"SELECT ""c"".""Name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""a"" JOIN ""Person"" AS ""p"" ON ""a"".""id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY ""c"".""Name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
47,"WITH ""cte"" AS (SELECT ""country_code"",""name"",""id"" FROM ""country"" AS ""c"" JOIN (SELECT LEFT(""phone_number"", 3) AS ""phone"",""id"" FROM ""person"") AS ""p"" ON ""c"".""country_code""=""p"".""phone""), ""cte1"" AS (SELECT ""a"".""caller_id"" AS ""id1"",""name"",""country_code"",""duration"" FROM ""cte"" AS ""b"" JOIN ""calls"" AS ""a"" ON ""a"".""caller_id""=""b"".""id"" UNION SELECT ""a"".""callee_id"" AS ""id1"",""name"",""country_code"",""duration"" FROM ""cte"" AS ""b"" JOIN ""calls"" AS ""a"" ON ""a"".""callee_id""=""b"".""id"") SELECT ""name"" AS ""country"" FROM ""cte1"" GROUP BY ""name"" HAVING SUM(""duration"")/COUNT(""id1"")>(SELECT AVG(""duration"") FROM ""calls"")"
48,"SELECT ""Country"".""name"" AS ""country"" FROM ""Country"" JOIN (SELECT * FROM (SELECT AVG(""duration"") AS ""global_avg_duration"" FROM ""Calls"") AS ""t1"", (SELECT SUBSTRING(""phone_number"", 1, 3) AS ""prefix"",AVG(""duration"") AS ""avg_duration"" FROM ""Person"" JOIN (SELECT ""caller_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""caller_id"",""duration"" FROM ""Calls"") AS ""calls_union"" ON (""calls_union"".""caller_id""=""Person"".""id"") GROUP BY ""prefix"") AS ""t2"" WHERE ""avg_duration"">""global_avg_duration"") AS ""t3"" ON (""Country"".""country_code""=""t3"".""prefix"")"
49,"WITH ""tmp"" AS (SELECT * FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""caller_id"",""caller_id"" AS ""callee_id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""tmp"" AS ""a"" JOIN ""person"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""b"".""phone_number"", 3)=""c"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""tmp"")"
50,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""id"",""duration"",LEFT(""b"".""phone_number"", 3) AS ""country_code"" FROM ""calls"" AS ""a"" JOIN ""person"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"" UNION ALL SELECT ""caller_id"" AS ""id"",""duration"",LEFT(""b"".""phone_number"", 3) AS ""country_code"" FROM ""calls"" AS ""a"" JOIN ""person"" AS ""b"" ON ""a"".""callee_id""=""b"".""id"") SELECT ""b"".""name"" AS ""country"" FROM ""cte"" AS ""a"" JOIN ""country"" AS ""b"" ON ""a"".""country_code""=""b"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
51,"WITH ""ALL_CALLS"" AS (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""Calls""), ""Persons"" AS (SELECT ""p"".*,""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT ""country"" FROM ""ALL_CALLS"" AS ""c"" LEFT JOIN ""Persons"" AS ""p"" ON ""p"".""id""=""c"".""user_id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
52,"WITH ""cte"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte"" AS ""c1"" JOIN ""person"" AS ""p"" ON ""c1"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" GROUP BY 1 HAVING AVG(""c1"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
53,"WITH ""a"" AS (SELECT *,SUBSTRING(""phone_number"", 1, 3) AS ""pcode"" FROM ""person"" AS ""p""), ""b"" AS ((SELECT ""ca"".""caller_id"",""ca"".""duration"",""co"".""name"",""co"".""country_code"" FROM (""calls"" AS ""ca"" LEFT JOIN ""a"" ON ""ca"".""caller_id""=""a"".""id"") LEFT JOIN ""country"" AS ""co"" ON ""a"".""pcode""=""co"".""country_code"") UNION ALL (SELECT ""ca"".""caller_id"",""ca"".""duration"",""co"".""name"",""co"".""country_code"" FROM (""calls"" AS ""ca"" LEFT JOIN ""a"" ON ""ca"".""callee_id""=""a"".""id"") LEFT JOIN ""country"" AS ""co"" ON ""a"".""pcode""=""co"".""country_code"")), ""c"" AS (SELECT AVG(""duration"") AS ""wa"" FROM ""calls"") SELECT ""name"" AS ""country"" FROM ""b"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT * FROM ""c"")"
54,"SELECT ""Country"".""name"" AS ""country"" FROM (""Country"" JOIN ""Person"" ON LEFT(""Person"".""phone_number"", 3)=""Country"".""country_code"") JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"" GROUP BY ""Country"".""name"" HAVING AVG(""Calls"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
55,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
56,"WITH ""t1"" AS (SELECT ""id"",""duration"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""tmp1""), ""t2"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_code""), ""t3"" AS (SELECT ""t1"".""id"",AVG(""t1"".""duration"") AS ""peravg"",""t2"".""country"" FROM ""t1"" JOIN ""t2"" USING (""id"") GROUP BY ""t2"".""country"" HAVING AVG(""t1"".""duration"")>(SELECT AVG(""duration"") FROM ""t1"")) SELECT ""country"" FROM ""t3"""
57,"WITH ""country_calls"" AS (SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id""), ""country_avg"" AS (SELECT ""c"".""name"",AVG(""cc"".""duration"") AS ""avg_duration"" FROM ""country_calls"" AS ""cc"" LEFT JOIN ""Country"" AS ""c"" ON ""cc"".""country_code""=""c"".""country_code"" GROUP BY ""cc"".""country_code"") SELECT ""name"" AS ""country"" FROM ""country_avg"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")"
58,"WITH ""T1"" AS (SELECT ""caller_id"" AS ""id"",""duration"",SUBSTRING(""phone_number"", 1, 3) AS ""c_code"" FROM ""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""caller_id"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"",SUBSTRING(""phone_number"", 1, 3) AS ""c_code"" FROM ""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""callee_id"") SELECT ""c"".""name"" AS ""country"" FROM ""T1"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=""T1"".""c_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""T1"")"
59,"WITH ""calltable"" AS (SELECT ""c"".""caller_id"" AS ""id"",""c"".""duration"" AS ""duration"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""ct"".""name"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""ct"" ON LEFT(""p"".""phone_number"", 3)=""ct"".""country_code"" UNION ALL SELECT ""c"".""callee_id"" AS ""id"",""c"".""duration"" AS ""duration"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""ct"".""name"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""ct"" ON LEFT(""p"".""phone_number"", 3)=""ct"".""country_code"") SELECT ""c"".""name"" AS ""country"" FROM (SELECT ""country_code"",""name"",AVG(""duration"") AS ""duration"" FROM ""calltable"" GROUP BY ""country_code"",""name"") AS ""c"" WHERE ""c"".""duration"">(SELECT AVG(""duration"") FROM ""calls"")"
60,"WITH ""ALL_CALLS"" AS (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""Calls""), ""Persons"" AS (SELECT ""p"".*,""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT ""country"" FROM ""ALL_CALLS"" AS ""c"" LEFT JOIN ""Persons"" AS ""p"" ON ""p"".""id""=""c"".""user_id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
61,"ERROR: mysql parse error: line 1 column 30 near ""SELECT P.id,P.name,C.name AS country FROM Person AS P JOIN Country AS C ON LEFT(P.phone_number,3)=C.country_code) AS new JOIN Calls AS c ON new.id=c.caller_id OR new.id=c.callee_id GROUP BY new.country HAVING avg(duration) > (SELECT AVG(duration) FROM Calls)"" "
62,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Country"" ON LEFT(""phone_number"", 3)=""Country"".""country_code"") JOIN ""Calls"" ON ""Person"".""id""=""Calls"".""caller_id"" OR ""Person"".""id""=""Calls"".""callee_id"" GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
63,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""c1"" LEFT JOIN ""person"" AS ""p"" ON ""p"".""id""=""c1"".""id"") LEFT JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""country"" HAVING AVG(""c1"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
64,"SELECT DISTINCT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") JOIN (SELECT ""id"",""duration"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""a"") AS ""b"" ON ""p"".""id""=""b"".""id"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
65,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) JOIN ""cte"" ON ""cte"".""user_id""=""p"".""id"" GROUP BY ""c"".""country_code"" HAVING AVG(""cte"".""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
66,"WITH ""cte"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM (""country"" AS ""c"") JOIN ""person"" AS ""p"" WHERE ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)), ""cte2"" AS (SELECT AVG(""duration"") AS ""avg_dur"",""country"" FROM ""calls"" AS ""c"" LEFT JOIN ""cte"" AS ""p1"" ON ""c"".""caller_id""=""p1"".""id"" OR ""c"".""callee_id""=""p1"".""id"" GROUP BY ""country"") SELECT DISTINCT ""country"" FROM ""cte2"" WHERE ""avg_dur"">(SELECT AVG(""duration"") FROM ""calls"")"
67,"WITH ""temp"" AS (SELECT *,LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") SELECT ""c1"".""name"" AS ""country"" FROM (""Country"" AS ""c1"" LEFT JOIN ""temp"" AS ""t"" ON ""c1"".""country_code""=""t"".""country_code"") LEFT JOIN ""calls"" AS ""c2"" ON ""t"".""id""=""c2"".""caller_id"" OR ""t"".""id""=""c2"".""callee_id"" GROUP BY ""c1"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
68,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""co"".""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
69,"SELECT ""C"".""name"" AS ""country"" FROM (""Country"" AS ""C"" JOIN ""Person"" AS ""P"" ON ""C"".""country_code""=LEFT(""phone_number"", 3)) JOIN ""Calls"" AS ""L"" ON ""L"".""caller_id""=""P"".""id"" OR ""L"".""callee_id""=""P"".""id"" GROUP BY 1 HAVING AVG(""L"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
70,"WITH ""cte"" AS (SELECT ""a"".""id"",""b"".""name"" FROM ""Person"" AS ""a"" JOIN ""Country"" AS ""b"" ON LEFT(""a"".""phone_number"", 3)=""b"".""country_code""), ""cte2"" AS ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"") UNION ALL (SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"")) SELECT ""a"".""name"" AS ""country"" FROM ""cte"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""id""=""b"".""id"" GROUP BY ""a"".""name"" HAVING SUM(""duration"")/COUNT(""duration"")>(SELECT SUM(""duration"")/COUNT(""duration"") FROM ""cte2"")"
71,"WITH ""users"" AS (SELECT ""r"".""id"",""r"".""duration"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"" AS ""p"" RIGHT JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""r"" ON ""r"".""id""=""p"".""id"") SELECT ""c"".""name"" AS ""country"" FROM ""Country"" AS ""c"" JOIN ""users"" AS ""u"" ON ""u"".""country_code""=""c"".""country_code"" GROUP BY ""c"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""glob_duration"" FROM ""users"")"
72,"SELECT ""name"" AS ""country"" FROM (SELECT ""ca"".""caller_id"",""co"".""name"",""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""caller_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" UNION SELECT ""ca"".""callee_id"",""co"".""name"",""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""callee_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"") AS ""result_table"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
73,"WITH ""cte"" AS (SELECT AVG(""duration"") AS ""global_avg"" FROM ""Calls"") (SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY ""c"".""name"" HAVING AVG(""ca"".""duration"")>(SELECT ""global_avg"" FROM ""cte""))"
74,"WITH ""CTE"" AS (SELECT ""A"".""id"",""B"".""name"" FROM ""Person"" AS ""A"" JOIN ""Country"" AS ""B"" ON SUBSTRING(""A"".""phone_number"", 1, 3)=""B"".""country_code"") SELECT ""t"".""name"" AS ""country"" FROM (SELECT ""B"".""name"",""A"".""duration"" FROM ""Calls"" AS ""A"" JOIN ""CTE"" AS ""B"" ON ""A"".""caller_id""=""B"".""id"" UNION ALL SELECT ""D"".""name"",""C"".""duration"" FROM ""Calls"" AS ""C"" JOIN ""CTE"" AS ""D"" ON ""C"".""callee_id""=""D"".""id"") AS ""t"" GROUP BY ""t"".""name"" HAVING AVG(""t"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
75,"SELECT ""co"".""name"" AS ""country"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"" OR ""c"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""co"" ON LEFT(""phone_number"", 3)=""co"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
76,"SELECT ""co"".""name"" AS ""country"" FROM ((""Person"" AS ""p"") JOIN ""Country"" AS ""co"") JOIN ""Calls"" AS ""c"" WHERE ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") AND ""co"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
77,"WITH ""tmp"" AS (SELECT ""id"",""c"".""name"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING_INDEX(""p"".""phone_number"", '-', 1)=""c"".""country_code""), ""tmp1"" AS (SELECT ""name"",AVG(""duration"") AS ""avg_duration"" FROM (SELECT ""name"",""caller_id"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""tmp"" AS ""t"" ON ""c"".""caller_id""=""t"".""id"" UNION ALL SELECT ""name"",""callee_id"" AS ""caller_id"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""tmp"" AS ""t"" ON ""c"".""callee_id""=""t"".""id"") AS ""t1"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""tmp1"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")"
78,"SELECT ""d"".""name"" AS ""country"" FROM (SELECT DISTINCT ""c"".""name"",SUM(""a"".""duration"") OVER (PARTITION BY ""c"".""name"")/COUNT(""a"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",SUM(""a"".""duration"") OVER ()/COUNT(""a"".""duration"") OVER () AS ""sum_duration"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""a"" LEFT JOIN ""person"" AS ""b"" ON ""a"".""id""=""b"".""id"") LEFT JOIN ""country"" AS ""c"" ON SUBSTR(""b"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""d"" WHERE ""d"".""avg_duration"">""d"".""sum_duration"""
79,"WITH ""t"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code"") SELECT ""country"" FROM ""Calls"" AS ""c"" JOIN ""t"" ON ""c"".""caller_id""=""t"".""id"" OR ""c"".""callee_id""=""t"".""id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"" AS ""c"")"
80,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON ""country"".""country_code""=LEFT(""person"".""phone_number"", 3)) JOIN ""calls"" ON ""person"".""id""=""calls"".""caller_id"" OR ""person"".""id""=""calls"".""callee_id"" GROUP BY ""country"".""country_code"" HAVING AVG(""calls"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
81,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" LEFT JOIN ""calls"" AS ""c"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
82,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
83,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""calls""), ""cte2"" AS (SELECT ""id"",""name"",SUBSTRING(""phone_number"", 1, 3) AS ""code"" FROM ""person""), ""cte3"" AS (SELECT ""id"",""t1"".""name"",""t2"".""name"" AS ""country_name"" FROM ""cte2"" AS ""t1"" LEFT JOIN ""country"" AS ""t2"" ON ""t2"".""country_code""=""t1"".""code"") SELECT ""country_name"" AS ""country"" FROM (SELECT DISTINCT ""country_name"",AVG(""duration"") OVER (PARTITION BY ""country_name"") AS ""a1"",AVG(""duration"") OVER () AS ""a2"" FROM (SELECT ""t1"".""user_id"",""t1"".""duration"",""t2"".""country_name"" FROM ""cte"" AS ""t1"" LEFT JOIN ""cte3"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""id"") AS ""x"") AS ""y"" WHERE ""a1"">""a2"""
84,"WITH ""cte"" AS (SELECT ""c"".""name"",""p"".""id"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTR(""p"".""phone_number"", 1, 3)) SELECT ""ct"".""name"" AS ""country"" FROM ""calls"" AS ""c"" JOIN ""cte"" AS ""ct"" ON ""c"".""caller_id""=""ct"".""id"" OR ""c"".""callee_id""=""ct"".""id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
85,"SELECT ""ct"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") JOIN ""Country"" AS ""ct"" ON LEFT(""p"".""phone_number"", 3)=""ct"".""country_code"" GROUP BY ""ct"".""name"" HAVING AVG(""ca"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
86,"WITH ""cte_ppl_ctry"" AS (SELECT ""id"",""p"".""name"" AS ""person"",""phone_number"",""c"".""name"" AS ""country"",""country_code"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""cte_final"" AS (SELECT ""country"" FROM ""Calls"" AS ""c"" JOIN ""cte_ppl_ctry"" AS ""pc"" ON ""c"".""caller_id""=""pc"".""id"" OR ""c"".""callee_id""=""pc"".""id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")) SELECT * FROM ""cte_final"""
87,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""Calls"" AS ""c1"" ON ""c1"".""caller_id""=""p"".""id"" OR ""c1"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
88,"SELECT ""ct"".""name"" AS ""country"" FROM (""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""Country"" AS ""ct"" ON ""ct"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY 1 HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
89,"WITH ""all_call_durations"" AS (SELECT ""co1"".""name"",""duration"" FROM (""calls"" AS ""c1"" LEFT JOIN ""person"" AS ""p1"" ON ""c1"".""caller_id""=""p1"".""id"") LEFT JOIN ""country"" AS ""co1"" ON LEFT(""p1"".""phone_number"", 3)=""co1"".""country_code"" UNION ALL SELECT ""co2"".""name"",""duration"" FROM (""calls"" AS ""c2"" LEFT JOIN ""person"" AS ""p2"" ON ""c2"".""callee_id""=""p2"".""id"") LEFT JOIN ""country"" AS ""co2"" ON LEFT(""p2"".""phone_number"", 3)=""co2"".""country_code"") SELECT ""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") AS ""avg_duration"" FROM ""all_call_durations"" GROUP BY ""NAME"") AS ""z"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
90,"WITH ""base"" AS (SELECT DISTINCT ""caller_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3) UNION ALL SELECT DISTINCT ""callee_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""callee_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3)), ""base1"" AS (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg_country"",(SELECT AVG(""duration"") FROM ""Calls"") AS ""avg_global"" FROM ""base"") SELECT ""name"" AS ""country"" FROM ""base1"" WHERE ""avg_country"">""avg_global"""
91,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
92,"WITH ""c1"" AS (SELECT ""a"".*,""b"".""country"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""a"" LEFT JOIN (SELECT ""p"".*,""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""b"" ON ""a"".""id""=""b"".""id"") SELECT ""country"" FROM ""c1"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""c1"")"
93,"WITH ""CTE"" AS (SELECT ""C2"".""name"",AVG(""duration"") AS ""avg_call"" FROM (""Calls"" AS ""C1"" JOIN ""Person"" AS ""P1"" ON ""C1"".""caller_id""=""P1"".""id"" OR ""C1"".""callee_id""=""P1"".""id"") LEFT JOIN ""Country"" AS ""C2"" ON LEFT(""P1"".""phone_number"", 3)=""C2"".""country_code"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""CTE"" WHERE ""avg_call"">(SELECT AVG(""duration"") FROM ""Calls"")"
94,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""Calls"" AS ""ca"" ON (""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") GROUP BY 1 HAVING AVG(""ca"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
95,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""cid"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""cte2"" AS (SELECT SUBSTRING(""phone_number"", 1, 3) AS ""code"",SUM(""duration"")/COUNT(""id"") AS ""num"" FROM ""cte"" LEFT JOIN ""Person"" AS ""p"" ON ""cte"".""cid""=""p"".""id"" GROUP BY SUBSTRING(""phone_number"", 1, 3)) SELECT ""name"" AS ""country"" FROM ""cte2"" LEFT JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=""cte2"".""code"" WHERE ""num"">(SELECT SUM(""duration"")/COUNT(1) FROM ""Calls"")"
96,"WITH ""cte"" AS (SELECT ""p"".""id"",LEFT(""phone_number"", 3) AS ""country_code"",""c"".""name"",""callee_id"",""duration"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") LEFT JOIN ""calls"" ON ""caller_id""=""p"".""id"" OR ""p"".""id""=""callee_id"" ORDER BY ""p"".""id""), ""cte2"" AS (SELECT ""name"" AS ""country"",AVG(""duration"") AS ""avg_duration"",ROW_NUMBER() OVER (ORDER BY AVG(""duration"") DESC) AS ""rn"" FROM ""cte"" GROUP BY ""name"") SELECT ""country"" FROM ""cte2"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
97,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
98,"WITH ""c1"" AS (SELECT ""id"",SUBSTRING_INDEX(""phone_number"", '-', 1) AS ""country_code"" FROM ""Person"") SELECT ""name"" AS ""country"" FROM (""Country"" AS ""c2"" LEFT JOIN ""c1"" ON ""c2"".""country_code""=""c1"".""country_code"") LEFT JOIN ""Calls"" AS ""c3"" ON ""c1"".""id""=""c3"".""caller_id"" OR ""c1"".""id""=""c3"".""callee_id"" GROUP BY ""c2"".""name"" HAVING AVG(""c3"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
99,"WITH ""table1"" AS (SELECT ""id"",LEFT(""phone_number"", 3) AS ""code"" FROM ""Person""), ""table2"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""table1"" LEFT JOIN ""Country"" AS ""c"" ON ""table1"".""code""=""c"".""country_code""), ""table3"" AS ((SELECT ""country"",""caller_id"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""table2"" ON ""c"".""caller_id""=""table2"".""id"") UNION ALL (SELECT ""country"",""callee_id"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""table2"" ON ""c"".""callee_id""=""table2"".""id"")), ""table4"" AS (SELECT ""country"",AVG(""duration"") OVER (PARTITION BY ""country"") AS ""country_avg"",AVG(""duration"") OVER () AS ""global_avg"" FROM ""table3"") SELECT DISTINCT ""country"" FROM ""table4"" WHERE ""country_avg"">""global_avg"""
100,"SELECT ""c1"".""name"" AS ""country"" FROM (""person"" AS ""p"" LEFT JOIN ""country"" AS ""c1"" ON LEFT(""p"".""phone_number"", 3)=""c1"".""country_code"") LEFT JOIN ""calls"" AS ""c2"" ON ""p"".""id"" IN (""c2"".""caller_id"",""c2"".""callee_id"") GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
101,"SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""tmp"" ON ""tmp"".""id""=""p"".""id"" GROUP BY 1 HAVING ROUND(SUM(""tmp"".""duration"")/COUNT(""tmp"".""id""), 1)>(SELECT ROUND((SUM(""duration"")*2)/(COUNT(1)*2), 1) FROM ""Calls"")"
102,"WITH ""TT1"" (""Average"") AS (SELECT SUM(""duration"")/COUNT(1) FROM (SELECT ""Caller_id"",""id"",""Callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""number"" FROM ""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") AS ""t1"" JOIN ""Country"" ON ""t1"".""number""=""Country"".""country_code""), ""TT2"" (""name"", ""A2"") AS (SELECT ""Country"".""name"",SUM(""duration"")/COUNT(1) FROM (SELECT ""Caller_id"",""id"",""Callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""number"" FROM ""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") AS ""t1"" JOIN ""Country"" ON ""t1"".""number""=""Country"".""country_code"" GROUP BY ""Country"".""name"") SELECT ""TT2"".""name"" AS ""country"" FROM (""TT1"") JOIN ""TT2"" WHERE ""TT2"".""A2"">""TT1"".""Average"""
103,"WITH ""cte"" AS (SELECT SUM(""duration"")/COUNT(1) AS ""global_call_duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""calls"" ON ""p"".""id"" IN (""callee_id"",""caller_id"") GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
104,"WITH ""arranged_calls"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""caller_id"",""duration"" FROM ""calls"") SELECT DISTINCT ""c"".""name"" AS ""country"" FROM (""country"" AS ""c"" JOIN ""person"" ON ""country_code""=LEFT(""phone_number"", 3)) JOIN ""arranged_calls"" ON ""id""=""caller_id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""average"" FROM ""calls"")"
105,"SELECT ""b"".""name"" AS ""country"" FROM (""Person"" AS ""a"" JOIN ""Country"" AS ""b"" ON SUBSTRING(""a"".""phone_number"", 1, 3)=""b"".""country_code"") JOIN ""Calls"" AS ""c"" ON (""a"".""id""=""c"".""caller_id"") OR (""a"".""id""=""c"".""callee_id"") GROUP BY ""b"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
106,"WITH ""name"" AS (SELECT ""p"".""id"",""p"".""name"" AS ""person_name"",""c"".""name"" AS ""country_name"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""n1"".""country_name"",""duration"" FROM (""Calls"" AS ""c"" LEFT JOIN ""name"" AS ""n1"" ON ""c"".""caller_id""=""n1"".""id"") LEFT JOIN ""name"" AS ""n2"" ON ""c"".""callee_id""=""n2"".""id"" UNION ALL SELECT ""n2"".""country_name"",""duration"" FROM (""Calls"" AS ""c"" LEFT JOIN ""name"" AS ""n1"" ON ""c"".""caller_id""=""n1"".""id"") LEFT JOIN ""name"" AS ""n2"" ON ""c"".""callee_id""=""n2"".""id"") AS ""tmp"" GROUP BY ""country_name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
107,"WITH ""global_avg"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""Calls""), ""country_calls"" AS (SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id""), ""country_avg"" AS (SELECT ""country_code"",AVG(""duration"") AS ""avg_duration"" FROM ""country_calls"" GROUP BY ""country_code"") SELECT ""c"".""name"" AS ""country"" FROM ""country_avg"" AS ""ca"" LEFT JOIN ""Country"" AS ""c"" ON ""ca"".""country_code""=""c"".""country_code"" WHERE ""ca"".""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")"
108,"WITH ""call_duration"" AS (SELECT ""caller_id"" AS ""id"",""duration"" AS ""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" AS ""duration"" FROM ""calls""), ""call_info"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""cd"".""duration"") AS ""avg_dur"" FROM (""country"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""call_duration"" AS ""cd"" ON ""cd"".""id""=""p"".""id"" GROUP BY ""c"".""name"") SELECT ""country"" FROM ""call_info"" WHERE ""avg_dur"">(SELECT AVG(""duration"") FROM ""calls"")"
109,"WITH ""t"" AS (SELECT ""caller_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""t"" JOIN ""Person"" AS ""p"" ON ""p"".""id""=""t"".""caller_id"") JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY LEFT(""p"".""phone_number"", 3) HAVING AVG(""t"".""duration"")>(SELECT AVG(""duration"") FROM ""t"")"
110,"WITH ""t"" AS (SELECT ""id"",""name"" FROM (SELECT ""id"",""c"".""name"",LEFT(""phone_number"", 3) AS ""cty"" FROM ""Person"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""c"".""country_code"") AS ""t2"") SELECT ""name"" AS ""country"" FROM (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg"",AVG(""duration"") OVER () AS ""avg2"" FROM (SELECT ""t1"".""name"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""t"" AS ""t1"" ON ""c"".""caller_id""=""t1"".""id"" UNION ALL SELECT ""t2"".""name"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""t"" AS ""t2"" ON ""c"".""callee_id""=""t2"".""id"") AS ""d"") AS ""d2"" WHERE ""avg"">""avg2"""
111,"SELECT ""country"" FROM (SELECT DISTINCT ""c"".""name"" AS ""country"",AVG(""a"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_c"",AVG(""a"".""duration"") OVER () AS ""avg_global"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTRING(""phone_number"", 1, 3)=""c"".""country_code"") JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""a"" ON ""a"".""id""=""p"".""id"") AS ""b"" WHERE ""avg_c"">""avg_global"""
112,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Country"" ON LEFT(""phone_number"", 3)=""Country"".""country_code"") JOIN ""Calls"" ON ""Person"".""id""=""Calls"".""caller_id"" OR ""Person"".""id""=""Calls"".""callee_id"" GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
113,"WITH ""global_avg"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""Calls""), ""country_calls"" AS (SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id""), ""country_avg"" AS (SELECT ""country_code"",AVG(""duration"") AS ""avg_duration"" FROM ""country_calls"" GROUP BY ""country_code"") SELECT ""c"".""name"" AS ""country"" FROM ""country_avg"" AS ""ca"" LEFT JOIN ""Country"" AS ""c"" ON ""ca"".""country_code""=""c"".""country_code"" WHERE ""ca"".""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")"
114,"SELECT ""c"".""name"" AS ""Country"" FROM (""country"" AS ""c"" JOIN ""person"" AS ""p"" ON SUBSTRING(""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""calls"" AS ""a"" ON ""p"".""id"" IN (""a"".""caller_id"",""a"".""callee_id"") GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
115,"SELECT ""b"".""name"" AS ""country"" FROM (""Person"" AS ""a"" JOIN ""Country"" AS ""b"" ON SUBSTRING(""a"".""phone_number"", 1, 3)=""b"".""country_code"") JOIN ""Calls"" AS ""c"" ON (""a"".""id""=""c"".""caller_id"") OR (""a"".""id""=""c"".""callee_id"") GROUP BY ""b"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
116,"WITH ""t"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT DISTINCT ""name"" AS ""Country"" FROM (SELECT ""c"".""name"",AVG(""duration"") OVER (PARTITION BY ""c"".""name"") AS ""c_avg"",AVG(""duration"") OVER () AS ""g_avg"" FROM (""t"" JOIN ""Person"" AS ""p"" ON ""t"".""id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""a"" WHERE ""c_avg"">""g_avg"""
117,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
118,"WITH ""dur"" AS (SELECT ""id"",SUM(""tot"") AS ""total"",SUM(""num"") AS ""num"" FROM (SELECT ""caller_id"" AS ""id"",SUM(""duration"") AS ""tot"",COUNT(""duration"") AS ""num"" FROM ""calls"" GROUP BY ""caller_id"" UNION ALL SELECT ""callee_id"" AS ""id"",SUM(""duration"") AS ""tot"",COUNT(""duration"") AS ""num"" FROM ""calls"" GROUP BY ""callee_id"") AS ""sub"" GROUP BY ""id""), ""main"" AS (SELECT ""Person"".*,""Country"".""name"" AS ""country"",""total"",""num"",SUM(""total"") OVER (PARTITION BY ""Country"".""name"") AS ""id_tot"",SUM(""num"") OVER (PARTITION BY ""Country"".""name"") AS ""id_num"",SUM(""total"") OVER () AS ""global_tot"",SUM(""num"") OVER () AS ""global_num"" FROM (""Person"" JOIN ""Country"" ON LEFT(""phone_number"", 3)=""country_code"") LEFT JOIN ""dur"" ON ""Person"".""id""=""dur"".""id"") SELECT DISTINCT ""country"" FROM ""main"" WHERE ""id_tot""/""id_num"">""global_tot""/""global_num"""
119,"SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") OVER () AS ""avg_global"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""country_avg"" FROM (SELECT ""caller_id"",""callee_id"",""duration"",""country"".""name"" FROM ((SELECT ""caller_id"",""callee_id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"",""caller_id"",""duration"" FROM ""calls"") AS ""ca"" LEFT JOIN ""person"" ON ""person"".""id""=""ca"".""caller_id"") LEFT JOIN ""country"" ON LEFT(""person"".""phone_number"", 3)=""country"".""country_Code"") AS ""t"") AS ""sr"" WHERE ""country_avg"">""avg_global"""
120,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
121,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" LEFT JOIN ""Person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""temp"" WHERE ""avg_duration"">""global_avg_duration"""
122,"WITH ""tmp_table1"" AS (SELECT ""e"".*,""f"".""name"" AS ""caller_country_name"",""g"".""name"" AS ""callee_country_name"" FROM ((SELECT ""c"".*,""d"".""phone_number"" AS ""callee_phone_number"" FROM (SELECT ""a"".""phone_number"" AS ""caller_phone_number"",""b"".""caller_id"",""b"".""callee_id"",""b"".""duration"" FROM ""Person"" AS ""a"" RIGHT JOIN ""Calls"" AS ""b"" ON ""a"".""id""=""b"".""caller_id"") AS ""c"" LEFT JOIN ""Person"" AS ""d"" ON ""c"".""callee_id""=""d"".""id"") AS ""e"" LEFT JOIN ""Country"" AS ""f"" ON LEFT(""e"".""caller_phone_number"", 3)=""f"".""country_code"") LEFT JOIN ""Country"" AS ""g"" ON LEFT(""e"".""callee_phone_number"", 3)=""g"".""country_code"") SELECT ""name"" AS ""country"" FROM (SELECT ""a"".""name"",(COALESCE((COALESCE(""b"".""caller_duration"", 0)+COALESCE(""c"".""callee_duration"", 0))/COALESCE((COALESCE(""b"".""caller_count"", 0)+COALESCE(""c"".""callee_count"", 0)), 1), 0)) AS ""country_avg"" FROM (""Country"" AS ""a"" LEFT JOIN (SELECT SUM(""duration"") AS ""caller_duration"",COUNT(""caller_country_name"") AS ""caller_count"",""caller_country_name"" FROM ""tmp_table1"" GROUP BY ""caller_country_name"") AS ""b"" ON ""a"".""name""=""b"".""caller_country_name"") LEFT JOIN (SELECT SUM(""duration"") AS ""callee_duration"",COUNT(""callee_country_name"") AS ""callee_count"",""callee_country_name"" FROM ""tmp_table1"" GROUP BY ""callee_country_name"") AS ""c"" ON ""a"".""name""=""c"".""callee_country_name"") AS ""h"" WHERE ""country_avg"">(SELECT * FROM (SELECT AVG(""duration"") AS ""world_avg"" FROM ""tmp_table1"") AS ""i"")"
123,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
124,"SELECT ""c"".""name"" AS ""country"" FROM ""Country"" AS ""c"" JOIN (SELECT SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",AVG(""c"".""duration"") AS ""avg_duration"" FROM ""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id"" GROUP BY ""country_code"" HAVING ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")) AS ""t"" ON ""c"".""country_code""=""t"".""country_code"""
125,"WITH ""a"" AS (SELECT ""caller_id"",""callee_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""caller_id"",""caller_id"" AS ""callee_id"",""duration"" FROM ""Calls""), ""b"" AS (SELECT DISTINCT SUBSTRING(""p"".""phone_number"", 1, 3) AS ""code"",AVG(""a"".""duration"") AS ""perc"" FROM ""a"" LEFT JOIN ""Person"" AS ""p"" ON ""a"".""caller_id""=""p"".""id"" GROUP BY SUBSTRING(""p"".""phone_number"", 1, 3)) SELECT ""c"".""name"" AS ""country"" FROM ""b"" LEFT JOIN ""Country"" AS ""c"" ON ""b"".""code""=""c"".""country_code"" WHERE ""perc"">(SELECT AVG(""duration"") FROM ""Calls"")"
126,"WITH ""cte"" AS (SELECT AVG(""duration"") AS ""g_duration"" FROM ""Calls""), ""cte2"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT ""country"" FROM (SELECT ""cte2"".*,""y"".""name"" AS ""country"" FROM (""cte2"" JOIN ""Person"" AS ""x"" ON ""cte2"".""id""=""x"".""id"") LEFT JOIN ""Country"" AS ""y"" ON SUBSTR(""x"".""phone_number"", 1, 3)=""y"".""country_code"") AS ""a"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT ""g_duration"" FROM ""cte"")"
127,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""sub"" JOIN ""Person"" AS ""p"" ON ""p"".""id""=""sub"".""id"") JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
128,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_Code"") JOIN ""Calls"" AS ""cl"" ON ""cl"".""caller_id""=""p"".""id"" OR ""cl"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
129,"SELECT ""B"".""name"" AS ""country"" FROM (SELECT ""A"".""name"",AVG(""C"".""duration"") AS ""IndiAvg"",(SELECT AVG(""duration"") FROM ""Calls"") AS ""GlbAvg"" FROM ""Calls"" AS ""C"" JOIN (SELECT ""P"".""id"",""C"".""name"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""CountryCode"" FROM ""Person"") AS ""P"" JOIN ""Country"" AS ""C"" ON ""P"".""CountryCode""=""C"".""country_code"") AS ""A"" ON ""A"".""id"" IN (""C"".""caller_id"",""C"".""callee_id"") GROUP BY ""A"".""name"") AS ""B"" WHERE ""B"".""IndiAvg"">""B"".""GlbAvg"""
130,"WITH ""cte1"" AS (SELECT ""a"".""id"",""b"".""name"" FROM ""Person"" AS ""a"" LEFT JOIN ""Country"" AS ""b"" ON LEFT(""a"".""phone_number"", 3)=""b"".""country_code""), ""cte2"" AS (SELECT ""c"".""name"",""d"".""duration"" FROM ""cte1"" AS ""c"" RIGHT JOIN ""Calls"" AS ""d"" ON ""c"".""id""=""d"".""caller_id""), ""cte3"" AS (SELECT ""e"".""name"",""f"".""duration"" FROM ""cte1"" AS ""e"" RIGHT JOIN ""Calls"" AS ""f"" ON ""e"".""id""=""f"".""callee_id""), ""cte4"" AS (SELECT * FROM ""cte2"" UNION ALL SELECT * FROM ""cte3""), ""cte5"" AS (SELECT ""name"" AS ""country"",AVG(""duration"") AS ""avg_duration"" FROM ""cte4"" GROUP BY ""name"") SELECT ""country"" FROM ""cte5"" WHERE ""avg_duration"">(SELECT AVG(""duration"") OVER () FROM ""Calls"" LIMIT 1)"
131,"SELECT ""c"".""name"" AS ""country"" FROM ""Country"" AS ""c"" JOIN (SELECT SUBSTRING(""p"".""phone_number"", 1, 3) AS ""country_code"",SUM(""ca"".""duration"")/COUNT(""ca"".""duration"") AS ""average"" FROM ""Person"" AS ""p"" LEFT JOIN ""Calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"" GROUP BY ""country_code"") AS ""t"" ON ""t"".""country_code""=""c"".""country_code"" WHERE ""t"".""average"">(SELECT SUM(""duration"")/COUNT(""duration"") FROM ""Calls"")"
132,"WITH ""temp"" AS (SELECT *,LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") SELECT ""c1"".""name"" AS ""country"" FROM (""Country"" AS ""c1"" LEFT JOIN ""temp"" AS ""t"" ON ""c1"".""country_code""=""t"".""country_code"") LEFT JOIN ""calls"" AS ""c2"" ON ""t"".""id""=""c2"".""caller_id"" OR ""t"".""id""=""c2"".""callee_id"" GROUP BY ""c1"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
133,"SELECT DISTINCT ""country"" FROM (SELECT ""p"".""id"",""c"".""name"" AS ""country"",AVG(""duration"") OVER (PARTITION BY ""c"".""name"") AS ""country_ave_time"",AVG(""duration"") OVER () AS ""total_time"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) AS ""t1"" WHERE ""country_ave_time"">""total_time"""
134,"WITH ""ect"" AS (SELECT ""name"",AVG(""ca"".""duration"") AS ""ad"" FROM (""Country"" AS ""c"" JOIN (SELECT ""id"",LEFT(""phone_number"", 3) AS ""code"" FROM ""Person"") AS ""p"" ON ""c"".""country_code""=""p"".""code"") JOIN ""Calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"" GROUP BY ""name"") SELECT ""name"" AS ""country"" FROM (SELECT ""name"",""ad"" FROM ""ect"" GROUP BY ""name"" HAVING AVG(""ad"")>(SELECT AVG(""duration"") FROM ""Calls"")) AS ""t"""
135,"SELECT ""C"".""name"" AS ""country"" FROM (""Person"" AS ""P"" JOIN ""Calls"" ON ""caller_id""=""P"".""id"" OR ""callee_id""=""P"".""id"") JOIN ""Country"" AS ""C"" ON ""C"".""country_code""=LEFT(""P"".""phone_number"", 3) GROUP BY ""C"".""name"" HAVING AVG(""DURATION"")>(SELECT AVG(""DURATION"") FROM ""CALLS"")"
136,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
137,"WITH ""CTE"" AS (SELECT ""c"".""name"",AVG(""ca"".""duration"") AS ""country_avg"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) JOIN ""Calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"") SELECT ""name"" AS ""country"" FROM ""CTE"" WHERE ""country_avg"">(SELECT AVG(""duration"") FROM ""calls"")"
138,"WITH ""cte"" AS (SELECT ""c2"".""name"" AS ""country"",""c1"".""duration"" FROM (""Calls"" AS ""c1"" JOIN ""Person"" AS ""p"" ON ""c1"".""caller_id""=""p"".""id"") JOIN ""Country"" AS ""c2"" ON LEFT(""p"".""phone_number"", 3)=""c2"".""country_code"" UNION ALL SELECT ""c2"".""name"" AS ""country"",""c1"".""duration"" FROM (""Calls"" AS ""c1"" JOIN ""Person"" AS ""p"" ON ""c1"".""callee_id""=""p"".""id"") JOIN ""Country"" AS ""c2"" ON LEFT(""p"".""phone_number"", 3)=""c2"".""country_code"") SELECT ""cte"".""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
139,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""caller"",""duration"" AS ""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""caller"",""duration"" AS ""duration"" FROM ""Calls""), ""country_calls"" AS (SELECT ""c"".""duration"",""c2"".""name"" FROM (""cte"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""caller""=""p"".""id"") JOIN ""Country"" AS ""c2"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c2"".""country_code"") SELECT ""name"" AS ""country"" FROM ""country_calls"" GROUP BY ""name"" HAVING SUM(""duration"")/COUNT(1)>(SELECT SUM(""duration"")/COUNT(1) FROM ""Calls"")"
140,"SELECT ""name"" AS ""country"" FROM (SELECT ""name"",SUM(""duration"") AS ""sum_duration"",SUM(""cnt"") AS ""sum_cnt"" FROM (SELECT ""caller_id"" AS ""id"",""c"".""name"",SUM(""duration"") AS ""duration"",COUNT(""caller_id"") AS ""cnt"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTR(""p"".""phone_number"", 1, 3)) JOIN ""calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" GROUP BY ""caller_id"",""c"".""name"" UNION ALL SELECT ""callee_id"" AS ""id"",""c"".""name"",SUM(""duration"") AS ""duration"",COUNT(""callee_id"") AS ""cnt"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTR(""p"".""phone_number"", 1, 3)) JOIN ""calls"" AS ""ca"" ON ""ca"".""callee_id""=""p"".""id"" GROUP BY ""callee_id"",""c"".""name"") AS ""A"" GROUP BY ""name"") AS ""B"" WHERE ""sum_duration""/""sum_cnt"">(SELECT AVG(""duration"") AS ""global_average"" FROM ""calls"")"
141,"WITH ""temp"" AS (SELECT ""country"".""name"" AS ""country"",""c1"".""duration"" AS ""duration"" FROM (""country"" LEFT JOIN ""person"" ON ""country"".""country_code""=SUBSTR(""person"".""phone_number"", 1, 3)) JOIN ""calls"" AS ""c1"" ON ""person"".""id""=""c1"".""caller_id"" UNION ALL SELECT ""country"".""name"" AS ""country"",""c2"".""duration"" AS ""duration"" FROM (""country"" LEFT JOIN ""person"" ON ""country"".""country_code""=SUBSTR(""person"".""phone_number"", 1, 3)) JOIN ""calls"" AS ""c2"" ON ""person"".""id""=""c2"".""callee_id"") SELECT ""country"" FROM ""temp"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
142,"WITH ""base"" AS (SELECT ""name"",AVG(""duration"") AS ""avg_duration"",COUNT(1) AS ""count_calls"" FROM (SELECT ""country"".""name"",""duration"" FROM ((""country"") JOIN ""person"") JOIN ""calls"" WHERE ""person"".""id""=""caller_id"" AND SUBSTRING(""phone_number"", 1, 3)=""country_code"" UNION ALL SELECT ""country"".""name"",""duration"" FROM ((""country"") JOIN ""person"") JOIN ""calls"" WHERE ""person"".""id""=""callee_id"" AND SUBSTRING(""phone_number"", 1, 3)=""country_code"") AS ""A"" GROUP BY ""name"") SELECT ""name"" AS ""country"" FROM ""base"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
143,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""Calls"" JOIN ""Person"" ON ""id""=""caller_id"") JOIN ""Country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3) UNION ALL SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""Calls"" JOIN ""Person"" ON ""id""=""callee_id"") JOIN ""Country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3)) SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
144,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_Code"") JOIN ""Calls"" AS ""cl"" ON ""cl"".""caller_id""=""p"".""id"" OR ""cl"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
145,"SELECT ""Co"".""name"" AS ""country"" FROM (""Person"" AS ""P"" JOIN ""Country"" AS ""Co"" ON SUBSTR(""P"".""phone_number"", 1, 3)=""Co"".""country_code"") JOIN ""Calls"" AS ""Ca"" ON ""P"".""id""=""Ca"".""caller_id"" OR ""P"".""id""=""Ca"".""callee_id"" GROUP BY ""Co"".""name"" HAVING AVG(""Ca"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
146,"WITH ""t"" AS (SELECT ""caller_id"",""duration"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT ""callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id""), ""t1"" AS (SELECT ""t"".""country_code"",""name"",AVG(""duration"") AS ""country_duration"" FROM ""t"" JOIN ""Country"" AS ""c"" ON ""t"".""country_code""=""c"".""country_code"" GROUP BY ""t"".""country_code""), ""average"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""t"") SELECT ""name"" AS ""country"" FROM ""t1"" WHERE ""country_duration"">(SELECT ""avg_duration"" FROM ""average"")"
147,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
148,"WITH ""global_calls"" AS (SELECT 'Global' AS ""Country"",AVG(""c"".""duration"") AS ""avg_duration"" FROM ""calls"" AS ""c""), ""country_calls"" AS (SELECT ""ct"".""name"" AS ""Country"",AVG(""c"".""duration"") AS ""avg_duration"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""country"" AS ""ct"" ON TRIM(LEADING '0' FROM ""ct"".""country_code"")=TRIM(LEADING '0' FROM LEFT(""p"".""phone_number"", 3)) GROUP BY 1) SELECT ""cc"".""country"" FROM ""country_calls"" AS ""cc"" WHERE ""cc"".""avg_duration"">(SELECT ""avg_duration"" FROM ""global_calls"")"
149,"WITH ""cte"" AS (WITH ""cte"" AS (WITH ""cte"" AS (WITH ""consolidated"" AS (SELECT ""p"".""id"",""p"".""name"",LEFT(""phone_number"", 3) AS ""phn"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""c"".""country_code"") SELECT ""consolidated"".*,""c"".""duration"" FROM ""consolidated"" JOIN ""Calls"" AS ""c"" ON ""id""=""c"".""caller_id"" OR ""id""=""c"".""callee_id"") SELECT ""name"",""country"",""duration"",AVG(""duration"") OVER () AS ""national"" FROM ""cte"") SELECT ""country"",AVG(""duration"") AS ""average_personal"",""national"" FROM ""cte"" GROUP BY ""country"") SELECT ""country"" FROM ""cte"" WHERE ""average_personal"">""national"""
150,"SELECT DISTINCT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""l"" ON ""caller_id""=""id"" OR ""id""=""callee_id"") JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
151,"WITH ""cte"" AS (SELECT ""c"".""name"",""a"".""duration"" FROM (""Calls"" AS ""a"" JOIN ""Person"" AS ""b"" ON ""a"".""callee_id""=""b"".""id"") JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=LEFT(""b"".""phone_number"", 3) UNION ALL SELECT ""c"".""name"",""a"".""duration"" FROM (""Calls"" AS ""a"" JOIN ""Person"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"") JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=LEFT(""b"".""phone_number"", 3)) SELECT ""name"" AS ""country"" FROM ""cte"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
152,"SELECT ""co"".""name"" AS ""country"" FROM ((""Person"" AS ""p"") JOIN ""Country"" AS ""co"") JOIN ""Calls"" AS ""c"" WHERE ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") AND ""co"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
153,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
154,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
155,"WITH ""cte"" AS (SELECT ""d"".""name"" AS ""country"",""a"".""duration"" FROM (((""Calls"" AS ""a"" LEFT JOIN ""Person"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"") LEFT JOIN ""Person"" AS ""c"" ON ""a"".""callee_id""=""c"".""id"") LEFT JOIN ""Country"" AS ""d"" ON LEFT(""b"".""phone_number"", 3)=""d"".""country_code"") LEFT JOIN ""Country"" AS ""e"" ON LEFT(""c"".""phone_number"", 3)=""e"".""country_code"" UNION ALL SELECT ""e"".""name"" AS ""country"",""a"".""duration"" FROM (((""Calls"" AS ""a"" LEFT JOIN ""Person"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"") LEFT JOIN ""Person"" AS ""c"" ON ""a"".""callee_id""=""c"".""id"") LEFT JOIN ""Country"" AS ""d"" ON LEFT(""b"".""phone_number"", 3)=""d"".""country_code"") LEFT JOIN ""Country"" AS ""e"" ON LEFT(""c"".""phone_number"", 3)=""e"".""country_code"") SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
156,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"",""c"".""name"" AS ""country_name"",""c"".""country_code"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""cte1"" AS (SELECT ""caller_id"" AS ""id"",SUM(""duration"") AS ""duration"",COUNT(""caller_id"") AS ""c"" FROM ""Calls"" GROUP BY ""caller_id""), ""cte2"" AS (SELECT ""callee_id"" AS ""id"",SUM(""duration"") AS ""duration"",COUNT(""callee_id"") AS ""c"" FROM ""Calls"" GROUP BY ""callee_id""), ""cte3"" AS (SELECT * FROM ""cte1"" UNION ALL SELECT * FROM ""cte2""), ""cte4"" AS (SELECT ""id"",SUM(""duration"") AS ""total"",SUM(""c"") AS ""c"" FROM ""cte3"" GROUP BY ""id""), ""cte5"" AS (SELECT ""cte4"".""id"",""cte4"".""total"",""cte4"".""c"",""cte"".""country_name"" FROM ""cte4"" JOIN ""cte"" ON ""cte"".""id""=""cte4"".""id""), ""cte6"" AS (SELECT ""country_name"",SUM(""total"")/SUM(""c"") AS ""avg_dur"" FROM ""cte5"" GROUP BY ""country_name"") SELECT ""country_name"" AS ""country"" FROM ""cte6"" WHERE ""avg_dur"">(SELECT AVG(""duration"") FROM ""Calls"")"
157,"WITH ""TEMP"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""temp"" AS ""t"" JOIN ""person"" AS ""p"" ON (""t"".""id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON (SUBSTR(""phone_number"", 1, 3)=""c"".""country_code"") GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""globAvg"" FROM ""calls"")"
158,"WITH ""temp1"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""temp2"" AS (SELECT ""a"".""id"",""a"".""duration"",""b"".""phone_number"",""c"".""name"" AS ""country"" FROM (""temp1"" AS ""a"" LEFT JOIN ""Person"" AS ""b"" ON ""a"".""id""=""b"".""id"") LEFT JOIN ""Country"" AS ""c"" ON SUBSTRING(""b"".""phone_number"", 1, 3)=""c"".""country_code""), ""temp3"" AS (SELECT ""country"",AVG(""duration"") OVER () AS ""avg_dur"",AVG(""duration"") OVER (PARTITION BY ""country"") AS ""country_dur"" FROM ""temp2"") SELECT DISTINCT ""country"" FROM ""temp3"" WHERE ""avg_dur""<""country_dur"""
159,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"",""c"".""country_code"",""c"".""name"" AS ""country_name"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""caller_id"" AS ""id"",""c"".""duration"",""cte"".""country_name"" FROM ""Calls"" AS ""c"" JOIN ""cte"" ON ""c"".""caller_id""=""cte"".""id"" UNION ALL SELECT ""callee_id"" AS ""id"",""c"".""duration"",""cte"".""country_name"" FROM ""Calls"" AS ""c"" JOIN ""cte"" ON ""c"".""callee_id""=""cte"".""id"") AS ""temp"" GROUP BY ""country_name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"") ORDER BY ""country_name"""
160,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""calls"" ON ""person"".""id""=""calls"".""callee_id"" OR ""person"".""id""=""calls"".""caller_id"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
161,"WITH ""cte"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls""), ""cte2"" AS (SELECT ""id"",""duration"",""name"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""cte"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") SELECT DISTINCT ""b"".""name"" AS ""country"" FROM ""cte2"" AS ""a"" JOIN ""country"" AS ""b"" ON ""a"".""country_code""=""b"".""country_code"" GROUP BY ""a"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
162,"WITH ""PersonCounter"" AS (SELECT ""P"".""id"",""C"".""name"" FROM ""Person"" AS ""P"" JOIN ""Country"" AS ""C"" ON LEFT(""P"".""phone_number"", 3)=""C"".""country_code""), ""CountryCalls"" AS (SELECT ""PC"".""name"",""C"".""duration"" FROM ""Calls"" AS ""C"" JOIN ""PersonCounter"" AS ""PC"" ON ""PC"".""id""=""C"".""caller_id"" UNION ALL SELECT ""PC"".""name"",""C"".""duration"" FROM ""Calls"" AS ""C"" JOIN ""PersonCounter"" AS ""PC"" ON ""PC"".""id""=""C"".""callee_id""), ""CountryAverage"" AS (SELECT ""name"",AVG(""duration"") AS ""Avgduration"" FROM ""CountryCalls"" GROUP BY ""name"") SELECT ""name"" AS ""country"" FROM ""CountryAverage"" WHERE ""Avgduration"">(SELECT AVG(""duration"") FROM ""CountryCalls"")"
163,"WITH ""zte"" AS (SELECT ""Country"".""name"",""duration"" FROM ((SELECT ""caller_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls"") AS ""temp1"" LEFT JOIN ""Person"" ON ""temp1"".""caller_id""=""Person"".""id"") LEFT JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3)) SELECT ""name"" AS ""country"" FROM ""zte"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""tot_duration"" FROM ""zte"")"
164,"SELECT ""ct"".""name"" AS ""country"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"")) JOIN ""country"" AS ""ct"" ON ""ct"".""country_code""=SUBSTRING(""phone_number"", 1, 3) GROUP BY ""ct"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
165,"WITH ""cte1"" AS (SELECT ""caller_id"" AS ""caller"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""caller"",""duration"" FROM ""calls""), ""cte2"" AS (SELECT ""co"".""name"",AVG(""c"".""duration"") AS ""avg_duration"" FROM (""cte1"" AS ""c"" LEFT JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""caller"") LEFT JOIN ""country"" AS ""co"" ON ""co"".""country_code""=SUBSTR(""p"".""phone_number"", 1, 3) GROUP BY 1), ""cte3"" AS (SELECT AVG(""duration"") AS ""global_avg"" FROM ""cte1""), ""cte4"" AS (SELECT ""cte2"".""name"",""cte2"".""avg_duration"",""cte3"".""global_avg"" FROM ""cte2"" JOIN ""cte3"") SELECT ""name"" AS ""country"" FROM ""cte4"" WHERE ""avg_duration"">""global_avg"""
166,"SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
167,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""phn"" ON ""p"".""id""=""phn"".""id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
168,"WITH ""all_calls"" AS (SELECT ""caller_id"" AS ""call_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""call_id"",""duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""all_calls"" AS ""a"" ON ""p"".""id""=""a"".""call_id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""all_calls"")"
169,"WITH ""temp"" AS (SELECT *,LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") SELECT ""c1"".""name"" AS ""country"" FROM (""Country"" AS ""c1"" LEFT JOIN ""temp"" AS ""t"" ON ""c1"".""country_code""=""t"".""country_code"") LEFT JOIN ""calls"" AS ""c2"" ON ""t"".""id""=""c2"".""caller_id"" OR ""t"".""id""=""c2"".""callee_id"" GROUP BY ""c1"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
170,"WITH ""t"" AS (SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""calls"" JOIN ""person"" ON ""caller_id""=""id"") JOIN ""country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3) UNION ALL SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""calls"" JOIN ""person"" ON ""callee_id""=""id"") JOIN ""country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3)) SELECT ""country"" FROM ""t"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
171,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
172,"WITH ""a"" AS (SELECT ""caller_id"",""callee_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""caller_id"",""caller_id"" AS ""callee_id"",""duration"" FROM ""Calls""), ""b"" AS (SELECT DISTINCT SUBSTRING(""p"".""phone_number"", 1, 3) AS ""code"",SUM(""a"".""duration"")/COUNT(""a"".""caller_id"") AS ""perc"" FROM ""a"" LEFT JOIN ""Person"" AS ""p"" ON ""a"".""caller_id""=""p"".""id"" GROUP BY SUBSTRING(""p"".""phone_number"", 1, 3)) SELECT ""c"".""name"" AS ""country"" FROM ""b"" LEFT JOIN ""Country"" AS ""c"" ON ""b"".""code""=""c"".""country_code"" WHERE ""perc"">(SELECT SUM(""duration"")/COUNT(1) FROM ""Calls"")"
173,"WITH ""cte"" AS (SELECT ""p"".""id"",""c"".""name"",""x"".* FROM (""person"" AS ""p"" LEFT JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") RIGHT JOIN ""calls"" AS ""x"" ON ""x"".""caller_id""=""p"".""id"" OR ""x"".""callee_id""=""p"".""id""), ""t2"" AS (SELECT *,AVG(""duration"") OVER () AS ""g_avg"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""c_avg"" FROM ""cte"") SELECT DISTINCT ""name"" AS ""country"" FROM ""t2"" WHERE ""g_avg""<""c_avg"""
174,"SELECT ""name"" AS ""country"" FROM (SELECT DISTINCT ""N"".""name"",(2*SUM(""C"".""duration"") OVER (PARTITION BY ""N"".""name""))/(2*COUNT(""C"".""caller_id"") OVER (PARTITION BY ""N"".""name"")) AS ""average"",(2*SUM(""C"".""duration"") OVER ())/(2*COUNT(""C"".""caller_id"") OVER ()) AS ""global_average"" FROM (""Person"" AS ""P"" JOIN ""Country"" AS ""N"" ON LEFT(""P"".""phone_number"", 3)=""N"".""country_code"") JOIN ""Calls"" AS ""C"" ON ""C"".""caller_id""=""P"".""id"" OR ""C"".""callee_id""=""P"".""id"") AS ""TMP"" WHERE ""average"">""global_average"""
175,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT DISTINCT ""country"" FROM ""cte"" WHERE ""avg_duration"">""global_avg_duration"""
176,"SELECT ""a"".""name"" AS ""country"" FROM (""Country"" AS ""a"" JOIN ""Person"" AS ""b"" ON ""a"".""country_code""=SUBSTRING(""b"".""phone_number"", 1, 3)) JOIN ""Calls"" AS ""c"" ON ""b"".""id""=""c"".""caller_id"" OR ""b"".""id""=""c"".""callee_id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
177,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""calls"" ON ""person"".""id""=""calls"".""callee_id"" OR ""person"".""id""=""calls"".""caller_id"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
178,"WITH ""c"" AS (SELECT ""caller_id"" AS ""callid"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""callid"",""duration"" FROM ""calls"") SELECT ""ct"".""name"" AS ""country"" FROM (""person"" AS ""p"" RIGHT JOIN ""c"" ON ""p"".""id""=""c"".""callid"") LEFT JOIN ""country"" AS ""ct"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""ct"".""country_code"" GROUP BY ""ct"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""c"")"
179,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""calls""), ""cte2"" AS (SELECT ""id"",""name"",SUBSTRING(""phone_number"", 1, 3) AS ""code"" FROM ""person""), ""cte3"" AS (SELECT ""id"",""t1"".""name"",""t2"".""name"" AS ""country_name"" FROM ""cte2"" AS ""t1"" LEFT JOIN ""country"" AS ""t2"" ON ""t2"".""country_code""=""t1"".""code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""country_name"",AVG(""duration"") AS ""a1"" FROM (SELECT ""t1"".""user_id"",""t1"".""duration"",""t2"".""country_name"" FROM ""cte"" AS ""t1"" LEFT JOIN ""cte3"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""id"") AS ""x"" GROUP BY ""country_name"") AS ""x"" WHERE ""a1"">(SELECT AVG(""duration"") FROM ""cte"")"
180,"SELECT ""country"" FROM (SELECT ""country"",SUM(""dura"")/SUM(""cnt"") AS ""avg_duration"" FROM (SELECT ""c"".""name"" AS ""country"",SUM(""duration"") AS ""dura"",COUNT(""caller_id"") AS ""cnt"" FROM (""Calls"" AS ""ca"" JOIN ""Person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"")) JOIN ""Country"" AS ""c"" ON (""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) GROUP BY 1 UNION ALL SELECT ""c"".""name"" AS ""country"",SUM(""duration"") AS ""dura"",COUNT(""callee_id"") AS ""cnt"" FROM (""Calls"" AS ""ca"" JOIN ""Person"" AS ""p"" ON (""ca"".""callee_id""=""p"".""id"")) JOIN ""Country"" AS ""c"" ON (""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) GROUP BY 1) AS ""t1"" GROUP BY 1) AS ""t2"" WHERE ""avg_duration"">(SELECT (SUM(""duration"")*2)/(COUNT(1)*2) AS ""global_avg"" FROM ""Calls"")"
181,"WITH ""cte1"" AS (SELECT ""id"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""name"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""c"".""country_code""), ""cte2"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT ""name"" AS ""country"" FROM ""cte2"" LEFT JOIN ""cte1"" USING (""id"") GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
182,"WITH ""call_info"" AS (SELECT ""cl"".""caller_id"" AS ""person_id"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""cl"".""duration"" FROM ""calls"" AS ""cl"" JOIN ""person"" AS ""p"" ON ""cl"".""caller_id""=""p"".""id"" UNION ALL SELECT ""cl"".""callee_id"" AS ""person_id"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""cl"".""duration"" FROM ""calls"" AS ""cl"" JOIN ""person"" AS ""p"" ON ""cl"".""callee_id""=""p"".""id""), ""glob_avg"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""call_info""), ""country_avg"" AS (SELECT ""country_code"",AVG(""duration"") AS ""avg_duration"" FROM ""call_info"" AS ""ci"" GROUP BY ""country_code""), ""get_gt"" AS (SELECT ""ca"".""country_code"",CASE WHEN ""ca"".""avg_duration"">""ga"".""avg_duration"" THEN 1 ELSE 0 END AS ""is_gt_glob"" FROM ""country_avg"" AS ""ca"" JOIN ""glob_avg"" AS ""ga"") SELECT ""cc"".""name"" AS ""country"" FROM ""get_gt"" AS ""t"" JOIN ""country"" AS ""cc"" ON ""t"".""country_code""=""cc"".""country_code"" WHERE ""t"".""is_gt_glob""=1"
183,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
184,"WITH ""CTE"" AS (SELECT ""cou"".""country_code"",""cou"".""name"",""sub"".""duration"" FROM (SELECT ""c"".""caller_id"",""p"".""name"",""p"".""phone_number"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT ""c"".""callee_id"",""p"".""name"",""p"".""phone_number"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") AS ""sub"" LEFT JOIN ""Country"" AS ""cou"" ON ""sub"".""country_code""=""cou"".""country_code"") SELECT ""sub2"".""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") AS ""avg_duration"" FROM ""CTE"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""CTE"")) AS ""sub2"""
185,"WITH ""cte"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""code"" FROM ""person"" AS ""p"") AS ""t"" LEFT JOIN ""country"" AS ""c"" ON ""t"".""code""=""c"".""country_code"") SELECT ""country"" FROM (SELECT ""t2"".""id"",""duration"",""cte"".""country"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""t2"" LEFT JOIN ""cte"" ON ""t2"".""id""=""cte"".""id"") AS ""t3"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
186,"WITH ""cte"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING(""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""Calls"" AS ""l"" ON (""p"".""id""=""l"".""caller_id"" OR ""p"".""id""=""l"".""callee_id"") GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT ""avg_duration"" FROM ""cte"")"
187,"WITH ""cte"" AS (SELECT ""a"".*,""b"".""country_code"" AS ""caller_code"",""c"".""country_code"" AS ""callee_code"" FROM (""Calls"" AS ""a"" LEFT JOIN (SELECT *,SUBSTRING(""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"") AS ""b"" ON ""a"".""caller_id""=""b"".""id"") LEFT JOIN (SELECT *,SUBSTRING(""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"") AS ""c"" ON ""a"".""callee_id""=""c"".""id"") SELECT ""g"".""name"" AS ""country"" FROM (SELECT ""country_code"" FROM (SELECT ""country_code"",AVG(""duration"") AS ""avg_duration"" FROM (SELECT ""caller_code"" AS ""country_code"",""duration"" FROM ""cte"" UNION ALL SELECT ""callee_code"" AS ""country_code"",""duration"" FROM ""cte"") AS ""d"" GROUP BY ""country_code"") AS ""e"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls"")) AS ""f"" LEFT JOIN ""Country"" AS ""g"" ON ""f"".""country_code""=""g"".""country_code"""
188,"WITH ""CTE1"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls""), ""CTE2"" AS (SELECT ""CTE1"".""id"",""duration"",SUBSTR(""phone_number"", 1, 3) AS ""country_code"" FROM ""CTE1"" JOIN ""Person"" ON ""CTE1"".""id""=""Person"".""id""), ""CTE3"" AS (SELECT DISTINCT ""country_code"",AVG(""duration"") OVER (PARTITION BY ""country_code"") AS ""in_duration"",AVG(""duration"") OVER () AS ""t_duration"" FROM ""CTE2"") SELECT ""COUNTRY"".""name"" AS ""country"" FROM ""Country"" WHERE ""country_code"" IN (SELECT ""country_code"" FROM ""CTE3"" WHERE ""in_duration"">""t_duration"")"
189,"WITH ""x"" AS (SELECT ""c"".""name"",AVG(""duration"") AS ""avg_dur"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""calls"" AS ""ca"" ON (""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") GROUP BY 1 HAVING ""avg_dur"">(SELECT AVG(""duration"") FROM ""calls"")) SELECT ""name"" AS ""country"" FROM ""x"""
190,"SELECT ""co"".""name"" AS ""country"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""co"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""co"".""country_code"" GROUP BY ""co"".""name"" HAVING AVG(""ca"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
191,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""a"" JOIN ""Person"" AS ""b"" ON ""a"".""id""=""b"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""b"".""phone_number"", 3)=""c"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""global_average"" FROM ""Calls"")"
192,"SELECT ""co"".""name"" AS ""country"" FROM (""country"" AS ""co"" JOIN ""person"" AS ""p"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY 1 HAVING AVG(""ca"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
193,"WITH ""t1"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""person"" JOIN ""country"" AS ""c"" ON LEFT(""phone_number"", 3)=""c"".""country_code""), ""t2"" AS (SELECT ""country"",""duration"" FROM ""t1"" JOIN ""calls"" WHERE ""t1"".""id""=""caller_id"" OR ""t1"".""id""=""callee_id""), ""t3"" AS (SELECT ""country"",AVG(""duration"") AS ""avg_country"" FROM ""t2"" GROUP BY ""country"") SELECT ""country"" FROM ""t3"" WHERE ""avg_country"">(SELECT AVG(""duration"") AS ""avg"" FROM ""t2"")"
194,"WITH ""calls"" AS (SELECT LEFT(""person"".""phone_number"", 3) AS ""country_code"",""cls"".""user_id"" AS ""user_id"",""cls"".""duration"" AS ""duration"" FROM (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""Calls"") AS ""cls"" JOIN ""Person"" AS ""person"" ON ""cls"".""user_id""=""person"".""id"") SELECT ""country"".""name"" AS ""country"" FROM ""calls"" AS ""cal1"" JOIN ""Country"" AS ""country"" ON ""country"".""country_code""=""cal1"".""country_code"" GROUP BY ""country"".""country_code"" HAVING AVG(""cal1"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")=1"
195,"WITH ""t"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""t"" JOIN ""Person"" AS ""p"" USING (""id"")) JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
196,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
197,"WITH ""t1"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""t2"" AS (SELECT ""t3"".""caller_id"",""t3"".""duration"" FROM ""Calls"" AS ""t3"" UNION ALL SELECT ""t3"".""callee_id"",""t3"".""duration"" FROM ""Calls"" AS ""t3""), ""t4"" AS (SELECT AVG(""t2"".""duration"") AS ""country_avg"",""t1"".""country"" FROM ""t2"" LEFT JOIN ""t1"" ON ""t2"".""caller_id""=""t1"".""id"" GROUP BY ""t1"".""country"") SELECT ""country"" FROM ""t4"" WHERE ""country_avg"">(SELECT AVG(""t2"".""duration"") FROM ""t2"")"
198,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" RIGHT JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
199,"WITH ""t"" AS (SELECT ""p"".""id"" AS ""id"",LEFT(""p"".""phone_number"", 3) AS ""ctry_code"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""t2"" AS (SELECT ""t"".""name"" AS ""name"",""ctry_code"",SUM(CASE WHEN ""c"".""caller_id""=""id"" OR ""c"".""callee_id""=""id"" THEN ""duration"" END)/COUNT(1) AS ""ctry"" FROM ""t"" JOIN ""calls"" AS ""c"" ON ""c"".""caller_id""=""id"" OR ""c"".""callee_id""=""id"" GROUP BY ""t"".""ctry_code"") SELECT ""name"" AS ""country"" FROM ""t2"" WHERE (SELECT AVG(""duration"") FROM ""calls"")<""ctry"""
200,"WITH ""cte"" AS (SELECT LEFT(""phone_number"", 3) AS ""country_code"",AVG(""duration"") OVER (PARTITION BY LEFT(""phone_number"", 3)) AS ""country_avg"",AVG(""duration"") OVER () AS ""overall_avg"" FROM ""person"" AS ""p"" JOIN (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") AS ""c"" ON ""p"".""id""=""c"".""caller_id"") SELECT DISTINCT ""name"" AS ""country"" FROM ""cte"" JOIN ""country"" ON ""cte"".""country_code""=""country"".""country_code"" WHERE ""country_avg"">""overall_avg"""
201,"WITH ""countrycode"" AS (SELECT ""id"",""cc"",""c"".""name"" AS ""country"" FROM (SELECT *,SUBSTR(""phone_number"", 1, 3) AS ""cc"" FROM ""person"") AS ""p"" JOIN ""country"" AS ""c"" ON ""p"".""cc""=""c"".""country_code""), ""global_avg"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""calls""), ""base"" AS (SELECT ""country"",AVG(""duration"") AS ""duration"" FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""c1"" JOIN ""countrycode"" AS ""c2"" ON ""c1"".""id""=""c2"".""id"" GROUP BY ""country"") SELECT ""country"" FROM (""base"") JOIN ""global_avg"" WHERE ""duration"">""avg_duration"""
202,"SELECT ""c"".""name"" AS ""country"" FROM (""person"" AS ""a"" JOIN ""calls"" AS ""b"" ON ""a"".""id""=""b"".""caller_id"" OR ""a"".""id""=""b"".""callee_id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""a"".""phone_number"", 3) GROUP BY ""c"".""name"" HAVING AVG(""b"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
203,"WITH ""t1"" AS (SELECT ""p"".""id"",""c"".""country_code"",""c"".""name"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""t2"" AS (SELECT ""t1"".""name"",""duration"" FROM ((SELECT ""caller_id"",""duration"" FROM ""Calls"") UNION ALL (SELECT ""callee_id"" AS ""caller_id"",""duration"" FROM ""Calls"")) AS ""tmp1"" LEFT JOIN ""t1"" ON ""tmp1"".""caller_id""=""t1"".""id"") SELECT ""name"" AS ""country"" FROM (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""country_avg"",AVG(""duration"") OVER () AS ""global_avg"" FROM ""t2"") AS ""tmp2"" WHERE ""country_avg"">""global_avg"""
204,"SELECT ""b"".""name"" AS ""country"" FROM (SELECT DISTINCT ""country_code"" FROM (SELECT AVG(""duration"") OVER (PARTITION BY ""country_code"") AS ""avg_country"",""country_code"",AVG(""duration"") OVER () AS ""average_global"" FROM (SELECT ""a"".""duration"",""a"".""caller_id"",""b"".""country_code"" FROM (SELECT ""duration"",""caller_id"" FROM ""Calls"" UNION ALL SELECT ""duration"",""callee_id"" AS ""caller_id"" FROM ""Calls"") AS ""a"" LEFT JOIN (SELECT *,LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""b"" ON ""a"".""caller_id""=""b"".""id"") AS ""c"") AS ""d"" WHERE ""avg_country"">""average_global"") AS ""e"" LEFT JOIN ""Country"" AS ""b"" ON ""e"".""country_code""=""b"".""country_code"""
205,"SELECT ""cc"".""name"" AS ""country"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""caller_id"" OR ""id""=""c"".""callee_id"") JOIN ""country"" AS ""cc"" ON ""cc"".""country_code""=LEFT(""phone_number"", 3) GROUP BY ""cc"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
206,"SELECT ""c"".""name"" AS ""country"" FROM (""country"" AS ""c"" JOIN ""person"" AS ""p"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""calls"" ON (""p"".""id""=""calls"".""caller_id"" OR ""p"".""id""=""calls"".""callee_id"") GROUP BY ""c"".""name"" HAVING AVG(""calls"".""duration"")>(SELECT (2*(SUM(""duration""))/(2*COUNT(1))) AS ""total_avg"" FROM ""calls"")"
207,"WITH ""PC"" AS (SELECT ""id"" AS ""Person_id"",""C"".""name"" AS ""country"" FROM ""Person"" AS ""P"" JOIN ""Country"" AS ""C"" ON ""c"".""country_code""=LEFT(""P"".""phone_number"", 3)), ""CALLS"" AS (SELECT ""caller_id"" AS ""person_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""person_id"",""duration"" FROM ""calls"") SELECT ""PC"".""Country"" FROM ""PC"" JOIN ""CALLS"" ON ""PC"".""person_id""=""CALLS"".""person_id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
208,"WITH ""CTE"" AS (SELECT ""cou"".""country_code"",""cou"".""name"",""sub"".""duration"" FROM (SELECT ""c"".""caller_id"",""p"".""name"",""p"".""phone_number"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT ""c"".""callee_id"",""p"".""name"",""p"".""phone_number"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") AS ""sub"" LEFT JOIN ""Country"" AS ""cou"" ON ""sub"".""country_code""=""cou"".""country_code"") SELECT ""sub2"".""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") AS ""avg_duration"" FROM ""CTE"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""CTE"")) AS ""sub2"""
209,"SELECT ""name"" AS ""Country"" FROM ((SELECT ""country_code"",AVG(""duration"") AS ""mean_duration"" FROM ((SELECT ""c"".""caller_id"" AS ""id"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") UNION ALL (SELECT ""c"".""callee_id"" AS ""id"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"")) AS ""t"" GROUP BY ""country_code"") AS ""t1"" LEFT JOIN ""Country"" AS ""c"" ON ""t1"".""country_code""=""c"".""country_code"") JOIN (SELECT AVG(""duration"") AS ""global_mean_duration"" FROM ((SELECT ""c"".""caller_id"" AS ""id"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") UNION ALL (SELECT ""c"".""callee_id"" AS ""id"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"")) AS ""t2"") AS ""t3"" WHERE ""t1"".""mean_duration"">""t3"".""global_mean_duration"""
210,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""Calls"" ON ""id""=""caller_id"" OR ""id""=""callee_id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
211,"WITH ""derived"" AS (SELECT ""country"",AVG(""duration"") AS ""avg_duration"" FROM ""calls"" JOIN (SELECT ""id"",""country"".""name"" AS ""country"" FROM ""person"" JOIN ""country"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") AS ""t"" ON ""caller_id""=""t"".""id"" OR ""callee_id""=""t"".""id"" GROUP BY 1) SELECT ""country"" FROM ""derived"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
212,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"" AS ""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
213,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""Calls"" AS ""c1"" ON ""c1"".""caller_id""=""p"".""id"" OR ""c1"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
214,"WITH ""a"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""b"" AS (SELECT ""a"".""duration"",SUBSTRING(""Person"".""phone_number"", 1, 2+1) AS ""country_code"" FROM ""a"" JOIN ""Person"" ON ""a"".""id""=""Person"".""id""), ""c"" AS (SELECT AVG(""duration"") AS ""average"" FROM ""b""), ""d"" AS (SELECT ""country_code"",AVG(""duration"") AS ""duration"" FROM ""b"" GROUP BY ""country_code"" HAVING ""duration"">(SELECT * FROM ""c"")) SELECT ""Country"".""name"" AS ""country"" FROM ""Country"" JOIN ""d"" ON ""Country"".""country_code""=""d"".""country_code"""
215,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""p"" JOIN ""Country"" AS ""c"" USING (""country_code"")) LEFT JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""comb"" ON ""p"".""id""=""comb"".""id"" GROUP BY ""c"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
216,"WITH ""cte"" AS (SELECT ""co"".""name"",SUM(""ca"".""duration"") AS ""total_time"",COUNT(1) AS ""total_calls"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""co"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""Calls"" AS ""ca"" ON (""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") GROUP BY ""co"".""name"") SELECT ""name"" AS ""country"" FROM ""cte"" WHERE (""total_time""/""total_calls"")>(SELECT AVG(""duration"") FROM ""Calls"")"
217,"WITH ""temp1"" AS (SELECT ""id"",LEFT(""phone_number"", 3) AS ""code"" FROM ""person""), ""temp2"" AS (SELECT ""temp1"".""id"",""country"".""name"" FROM ""temp1"" LEFT JOIN ""country"" ON ""temp1"".""code""=""country"".""country_code""), ""temp3"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"",""duration"" FROM ""calls""), ""temp4"" AS (SELECT ""temp2"".""name"",""temp3"".""duration"" FROM ""temp3"" LEFT JOIN ""temp2"" ON ""temp2"".""id""=""temp3"".""caller_id""), ""temp5"" AS (SELECT ""name"",AVG(""duration"") AS ""duration"" FROM ""temp4"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""temp5"" WHERE ""duration"">(SELECT AVG(""duration"") FROM ""calls"")"
218,"WITH ""call_logs"" AS (SELECT ""caller_id"" AS ""pid"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""pid"",""duration"" FROM ""calls""), ""cntry_info"" AS (SELECT ""p"".""id"",""c"".""country_code"",""c"".""name"" AS ""country_name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT ""t"".""country_name"" AS ""country"" FROM (SELECT ""cntry"".""country_name"",SUM(""cl"".""duration"")/COUNT(""cntry"".""id"") AS ""avg_duration"" FROM ""call_logs"" AS ""cl"" JOIN ""cntry_info"" AS ""cntry"" ON ""cl"".""pid""=""cntry"".""id"" GROUP BY ""cntry"".""country_name"") AS ""t"" WHERE ""t"".""avg_duration"">(SELECT SUM(""duration"")/COUNT(""pid"") AS ""global_avg_duration"" FROM ""call_logs"")"
219,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""calls"" JOIN ""person"" ON ""id""=""caller_id"") JOIN ""country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3) UNION ALL SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""calls"" JOIN ""person"" ON ""id""=""callee_id"") JOIN ""country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3)) SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
220,"WITH ""temp"" AS (SELECT ""c"".""name"",AVG(""duration"") OVER (PARTITION BY ""c"".""name"") AS ""average"",AVG(""duration"") OVER () AS ""total"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") RIGHT JOIN ""calls"" ON ""p"".""id""=""caller_id"" OR ""p"".""id""=""callee_id"") SELECT DISTINCT ""name"" AS ""country"" FROM ""temp"" WHERE ""average"">""total"""
221,"WITH ""ref"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""duration"") AS ""avg_call"" FROM (""Calls"" AS ""ca"" LEFT JOIN ""Person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""c"".""country_code"" GROUP BY ""c"".""name"") SELECT ""country"" FROM ""ref"" WHERE ""avg_call"">(SELECT AVG(""duration"") FROM ""Calls"")"
222,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
223,"WITH ""Durations"" AS (SELECT ""A"".""duration"",""C"".""name"" AS ""country"" FROM (""Calls"" AS ""A"" LEFT JOIN ""Person"" AS ""B"" ON ""A"".""caller_id""=""B"".""id"") LEFT JOIN ""Country"" AS ""C"" ON SUBSTR(""B"".""phone_number"", 1, 3)=""C"".""country_code"" UNION ALL SELECT ""A"".""duration"",""C"".""name"" FROM (""Calls"" AS ""A"" LEFT JOIN ""Person"" AS ""B"" ON ""A"".""callee_id""=""B"".""id"") LEFT JOIN ""Country"" AS ""C"" ON SUBSTR(""B"".""phone_number"", 1, 3)=""C"".""country_code"") SELECT ""country"" FROM ""Durations"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
224,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
225,"SELECT ""name"" AS ""country"" FROM (SELECT ""P"".""id"",""T"".""name"",""C1"".""duration"" FROM (""Person"" AS ""P"" LEFT JOIN ""Country"" AS ""T"" ON LEFT(""P"".""phone_number"", 3)=""T"".""country_code"") LEFT JOIN ""Calls"" AS ""C1"" ON ""P"".""id""=""C1"".""caller_id"" UNION SELECT ""P"".""id"",""T"".""name"",""C2"".""duration"" FROM (""Person"" AS ""P"" LEFT JOIN ""Country"" AS ""T"" ON LEFT(""P"".""phone_number"", 3)=""T"".""country_code"") LEFT JOIN ""Calls"" AS ""C2"" ON ""P"".""id""=""C2"".""callee_id"") AS ""tb"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
226,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
227,"WITH ""cte"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code""), ""all_calls"" AS (SELECT ""country"",""id"" AS ""caller"",""duration"" FROM ""cte"" AS ""c"" JOIN ""Calls"" AS ""pc"" ON ""c"".""id""=""caller_id"" UNION ALL SELECT ""country"",""id"" AS ""caller"",""duration"" FROM ""cte"" AS ""c"" JOIN ""Calls"" AS ""pc"" ON ""c"".""id""=""callee_id""), ""averages"" AS (SELECT DISTINCT ""country"",AVG(""duration"") OVER (PARTITION BY ""country"") AS ""cnt_avg"",AVG(""duration"") OVER () AS ""global_avg"" FROM ""all_calls"" ORDER BY ""country"" DESC) SELECT ""country"" FROM ""averages"" WHERE ""cnt_avg"">""global_avg"" ORDER BY 1"
228,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
229,"WITH ""t1"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") SELECT ""b"".""name"" AS ""country"" FROM (""t1"" JOIN ""person"" AS ""a"" ON ""t1"".""caller_id""=""a"".""id"") JOIN ""country"" AS ""b"" ON LEFT(""a"".""phone_number"", 3)=""b"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
230,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
231,"WITH ""cte"" AS (SELECT ""caller_id"",""phone_number"",""duration"",SUBSTR(""phone_number"", 1, 3) AS ""country_code"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id""), ""country_avg"" AS (SELECT ""co"".""name"",AVG(""duration"") AS ""avg_duration"" FROM ""cte"" LEFT JOIN ""Country"" AS ""co"" ON ""cte"".""country_code""=""co"".""country_code"" GROUP BY 1) SELECT ""country_avg"".""name"" AS ""country"" FROM ""country_avg"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
232,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte"" AS ""c1"" JOIN ""person"" AS ""p"" ON ""c1"".""id""=""p"".""id"") JOIN ""country"" AS ""c"" ON (LEFT(""phone_number"", 3))=""c"".""country_code"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""glob"" FROM ""calls"")"
233,"SELECT ""c1"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""c"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""Country"" AS ""c1"" ON LEFT(""p"".""phone_number"", 3)=""c1"".""country_code"" GROUP BY ""c1"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
234,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
235,"WITH ""t"" AS (SELECT ""p"".""id"",""p"".""name"",""p"".""phone_number"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)), ""t2"" AS (SELECT ""c"".""caller_id"",""c"".""duration"" FROM ""Calls"" AS ""c"" UNION SELECT ""c1"".""callee_id"",""c1"".""duration"" FROM ""Calls"" AS ""c1""), ""t3"" AS (SELECT ""t2"".""caller_id"",""t2"".""duration"",""t"".""country"" FROM ""t2"" LEFT JOIN ""t"" ON ""t"".""id""=""t2"".""caller_id""), ""t5"" AS (SELECT SUM(""duration"")/COUNT(""duration"") AS ""avg_global"" FROM ""Calls""), ""t4"" AS (SELECT SUM(""duration"")/COUNT(""duration"") AS ""time_call"",""country"" FROM ""t3"" GROUP BY ""country"") SELECT ""country"" FROM ""t4"" WHERE ""time_call"">(SELECT ""avg_global"" FROM ""t5"")"
236,"WITH ""a"" AS (SELECT ""id"",""Country"".""name"" AS ""countryname"" FROM ""Person"" LEFT JOIN ""Country"" ON SUBSTR(""Person"".""phone_number"", 1, 3)=""Country"".""country_code""), ""b"" AS (SELECT ""a"".""countryname"" AS ""cn"",AVG(""duration"") AS ""c_duration"" FROM ""Calls"" LEFT JOIN ""a"" ON ""Calls"".""caller_id""=""a"".""id"" OR ""Calls"".""callee_id""=""a"".""id"" GROUP BY ""a"".""countryname"") SELECT ""b"".""cn"" AS ""country"" FROM ""b"" WHERE ""c_duration"">(SELECT AVG(""duration"") AS ""global_ave"" FROM ""Calls"")"
237,"SELECT ""B"".""name"" AS ""country"" FROM (SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""user_id"",""duration"" FROM ""Calls"") AS ""A"" LEFT JOIN (SELECT ""P"".""id"" AS ""user_id"",""C"".""name"" FROM ""Person"" AS ""P"" JOIN ""Country"" AS ""C"" ON LEFT(""P"".""phone_number"", 3)=""C"".""country_code"") AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" GROUP BY ""B"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""world_time"" FROM ""Calls"")"
238,"WITH ""t1"" AS (SELECT ""c2"".""name"",""c1"".""duration"" FROM (""person"" AS ""p"" JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""c1"" ON ""c1"".""id""=""p"".""id"") JOIN ""country"" AS ""c2"" ON ""c2"".""country_code""=LEFT(""p"".""phone_number"", 3)) SELECT ""name"" AS ""country"" FROM ""t1"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""t1"")"
239,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
240,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""c"".""country_Code"") JOIN ""Calls"" AS ""cl"" ON ""cl"".""caller_id""=""p"".""id"" OR ""cl"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
241,"WITH ""cte"" AS (SELECT ""co"".""name"" AS ""country"",""c"".""duration"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"" UNION ALL SELECT ""co"".""name"" AS ""country"",""c"".""duration"" FROM (""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""co"".""country_code"") SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
242,"SELECT ""name"" AS ""country"" FROM (SELECT ""country"".""name"",AVG(""allcalls"".""duration"") AS ""avg_country_duration"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""allcalls"" LEFT JOIN ""person"" ON ""person"".""id""=""allcalls"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""person"".""phone_number"", 3) GROUP BY ""country"".""name"") AS ""t"" WHERE ""avg_country_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
243,"SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""temp"" ON ""p"".""id""=""temp"".""id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
244,"WITH ""t1"" AS (SELECT ""id"",""b"".""name"" AS ""country_name"" FROM ""person"" AS ""a"" JOIN ""country"" AS ""b"" ON LEFT(""phone_number"", 3)=""country_code""), ""t2"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""country_name"" AS ""country"" FROM ""t1"" JOIN ""t2"" ON ""t1"".""id""=""t2"".""id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""t2"")"
245,"SELECT ""C2"".""name"" AS ""country"" FROM (""Calls"" AS ""C1"" JOIN ""Person"" AS ""P1"" ON ""C1"".""caller_id""=""P1"".""id"" OR ""C1"".""callee_id""=""P1"".""id"") LEFT JOIN ""Country"" AS ""C2"" ON LEFT(""P1"".""phone_number"", 3)=""C2"".""country_code"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
246,"WITH ""DURATION"" AS (SELECT AVG(""duration"") AS ""AVG_DURATION"" FROM ""Calls""), ""PERSON_COUNTRY"" AS (SELECT ""A"".""id"",""A"".""name"",""A"".""phone_number"",""B"".""name"" AS ""COUNTRY"" FROM ""Person"" AS ""A"" LEFT JOIN ""Country"" AS ""B"" ON SUBSTRING(""A"".""phone_number"", 1, 3)=""b"".""country_code""), ""COUNTRY_CALL"" AS (SELECT ""B"".""COUNTRY"" AS ""CALLER_COUNTRY"",""C"".""COUNTRY"" AS ""CALLEE_COUNTRY"",""A"".""duration"",1 AS ""COUNT"" FROM (""Calls"" AS ""A"" LEFT JOIN ""PERSON_COUNTRY"" AS ""B"" ON ""A"".""caller_id""=""B"".""id"") LEFT JOIN ""PERSON_COUNTRY"" AS ""C"" ON ""A"".""callee_id""=""C"".""id""), ""FINAL_TABLE"" AS (SELECT ""CALLER_COUNTRY"" AS ""COUNTRY"",SUM(""DURATION"") AS ""DURATION"",SUM(""COUNT"") AS ""COUNT"" FROM ""COUNTRY_CALL"" GROUP BY ""CALLER_COUNTRY"" UNION ALL SELECT ""CALLEE_COUNTRY"" AS ""COUNTRY"",SUM(""DURATION"") AS ""DURATION"",SUM(""COUNT"") AS ""COUNT"" FROM ""COUNTRY_CALL"" GROUP BY ""CALLEE_COUNTRY""), ""FINAL_TABLE_FOR_REAL"" AS (SELECT ""COUNTRY"",AVG(""DURATION""/""COUNT"") AS ""AVERAGE_DURATION"" FROM (SELECT ""COUNTRY"",SUM(""DURATION"") AS ""DURATION"",SUM(""COUNT"") AS ""COUNT"" FROM ""FINAL_TABLE"" GROUP BY ""COUNTRY"") AS ""A"" GROUP BY ""COUNTRY"") SELECT ""COUNTRY"" FROM ""FINAL_TABLE_FOR_REAL"" AS ""A"" WHERE ""AVERAGE_DURATION"">(SELECT ""AVG_DURATION"" FROM ""DURATION"")"
247,"WITH ""cte"" AS (SELECT ""c"".""name"",AVG(""ca"".""duration"") AS ""country_avg"" FROM (""country"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) JOIN ""calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY ""c"".""name"") SELECT ""name"" AS ""country"" FROM ""cte"" WHERE ""country_avg"">(SELECT AVG(""duration"") FROM ""calls"")"
248,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
249,"WITH ""person_country"" AS (SELECT ""p"".*,""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code""), ""duration"" AS (SELECT ""country"",AVG(""duration"") AS ""avg_duration"" FROM (SELECT ""p"".""id"",""p"".""country"",""ca"".""duration"" FROM ""calls"" AS ""ca"" JOIN ""person_country"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" UNION ALL SELECT ""p"".""id"",""p"".""country"",""ca"".""duration"" FROM ""calls"" AS ""ca"" JOIN ""person_country"" AS ""p"" ON ""ca"".""callee_id""=""p"".""id"") AS ""t"" GROUP BY ""country"") SELECT ""country"" FROM ""duration"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
250,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"" AS ""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
251,"WITH ""TT1"" (""Average"") AS (SELECT SUM(""duration"")/COUNT(1) FROM (SELECT ""Caller_id"",""id"",""Callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""number"" FROM ""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") AS ""t1"" JOIN ""Country"" ON ""t1"".""number""=""Country"".""country_code""), ""TT2"" (""name"", ""A2"") AS (SELECT ""Country"".""name"",SUM(""duration"")/COUNT(1) FROM (SELECT ""Caller_id"",""id"",""Callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""number"" FROM ""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") AS ""t1"" JOIN ""Country"" ON ""t1"".""number""=""Country"".""country_code"" GROUP BY ""Country"".""name"") SELECT ""TT2"".""name"" AS ""country"" FROM (""TT1"") JOIN ""TT2"" WHERE ""TT2"".""A2"">""TT1"".""Average"""
252,"WITH ""t1"" AS (SELECT ""p"".""id"",""c"".""name"" FROM ""person"" AS ""p"" LEFT JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code""), ""t2"" AS (SELECT ""caller_id"" AS ""cid"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""cid"",""duration"" FROM ""calls"") SELECT ""name"" AS ""country"" FROM ""t2"" JOIN ""t1"" ON ""t2"".""cid""=""t1"".""id"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
253,"SELECT ""name"" AS ""country"" FROM (SELECT ""country_code"",""c2"".""name"",AVG(""duration"") AS ""avgs"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""c"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""Country"" AS ""c2"" ON LEFT(""p"".""phone_number"", 3)=""c2"".""country_code"" GROUP BY ""country_code"") AS ""t"" WHERE ""avgs"">(SELECT AVG(""duration"") FROM ""calls"")"
254,"WITH ""cte"" AS (SELECT ""id"",""name"",LEFT(""phone_number"", 3) AS ""country_code"",""duration"" FROM ""person"" LEFT JOIN ""calls"" ON ""person"".""id""=""calls"".""caller_id"" OR ""person"".""id""=""calls"".""callee_id"") SELECT ""b"".""name"" AS ""Country"" FROM ""cte"" AS ""a"" LEFT JOIN ""country"" AS ""b"" ON ""a"".""country_code""=""b"".""country_code"" GROUP BY ""b"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
255,"WITH ""t"" AS (SELECT ""id"",""name"" FROM (SELECT ""id"",""c"".""name"",LEFT(""phone_number"", 3) AS ""cty"" FROM ""Person"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""c"".""country_code"") AS ""t2"") SELECT ""name"" AS ""country"" FROM (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg"",AVG(""duration"") OVER () AS ""avg2"" FROM (SELECT ""t1"".""name"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""t"" AS ""t1"" ON ""c"".""caller_id""=""t1"".""id"" UNION ALL SELECT ""t2"".""name"",""duration"" FROM ""Calls"" AS ""c"" JOIN ""t"" AS ""t2"" ON ""c"".""callee_id""=""t2"".""id"") AS ""d"") AS ""d2"" WHERE ""avg"">""avg2"""
256,"SELECT ""name"" AS ""country"" FROM ((SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""t1"" JOIN ""Calls"" AS ""ca"" ON (""t1"".""id""=""ca"".""caller_id"" OR ""t1"".""id""=""ca"".""callee_id"")) JOIN ""Country"" AS ""co"" ON ""co"".""country_code""=""t1"".""country_code"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
257,"SELECT ""co"".""name"" AS ""country"" FROM ((""Person"" AS ""p"") JOIN ""Country"" AS ""co"") JOIN ""Calls"" AS ""c"" WHERE ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") AND ""co"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
258,"WITH ""s"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""x"" AS (SELECT ""s"".""country"",""duration"" FROM ""calls"" AS ""c"" JOIN ""s"" ON ""c"".""caller_id""=""s"".""id"" UNION ALL SELECT ""s"".""country"",""duration"" FROM ""calls"" AS ""c"" JOIN ""s"" ON ""c"".""callee_id""=""s"".""id"") SELECT ""country"" FROM ""x"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""x"")"
259,"WITH ""cte"" AS (SELECT ""co"".""name"",AVG(""duration"") OVER (PARTITION BY ""co"".""name"") AS ""cavg"",AVG(""duration"") OVER () AS ""gavg"" FROM (""calls"" AS ""c"" LEFT JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""callee_id"" OR ""p"".""id""=""c"".""caller_id"") LEFT JOIN ""country"" AS ""co"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""co"".""country_code"") SELECT DISTINCT ""name"" AS ""country"" FROM ""cte"" WHERE ""cavg"">""gavg"""
260,"WITH ""df_country"" AS (SELECT LEFT(""p"".""phone_number"", 3) AS ""country_code"",AVG(""duration"") AS ""avg_duration_per_country"" FROM ""calls"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id"" GROUP BY 1) SELECT ""c"".""name"" AS ""country"" FROM ""df_country"" JOIN ""country"" AS ""c"" USING (""country_code"") WHERE ""avg_duration_per_country"">(SELECT AVG(""duration"") AS ""avg_global"" FROM ""calls"")"
261,"WITH ""temp1"" AS (SELECT ""caller_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls""), ""temp2"" AS (SELECT *,SUBSTRING(""phone_number"", 1, 3) AS ""code"" FROM ""Person""), ""temp3"" AS (SELECT ""temp1"".""duration"",""c"".""name"" FROM (""Country"" AS ""c"" RIGHT JOIN ""temp2"" ON ""temp2"".""code""=""c"".""country_code"") RIGHT JOIN ""temp1"" ON ""temp2"".""id""=""temp1"".""caller_id"") SELECT ""name"" AS ""country"" FROM ""temp3"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""temp1"")"
262,"WITH ""cte"" AS (SELECT ""id"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code""), ""cte1"" AS (SELECT ""name"",""duration"" FROM ""calls"" AS ""c"" JOIN ""cte"" AS ""c1"" ON ""c"".""caller_id""=""c1"".""id"" UNION ALL SELECT ""name"",""duration"" FROM ""calls"" AS ""c"" JOIN ""cte"" AS ""c1"" ON ""c"".""callee_id""=""c1"".""id""), ""cte2"" AS (SELECT ""name"",AVG(""duration"") AS ""avg_duration"",SUM(""duration"") AS ""sum_duration"",COUNT(1) AS ""cnt"" FROM ""cte1"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""cte2"" WHERE ""avg_duration"">(SELECT SUM(""sum_duration"")/SUM(""cnt"") FROM ""cte2"")"
263,"WITH ""cte"" AS (SELECT ""duration"",""country"".""name"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""a"" LEFT JOIN ""Person"" USING (""Id"")) LEFT JOIN ""Country"" ON LEFT(""Person"".""phone_number"", 3)=""country"".""country_code"") SELECT ""name"" AS ""country"" FROM ""CTE"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
264,"SELECT ""country"".""name"" AS ""country"" FROM ((""calls"") JOIN ""person"") JOIN ""country"" WHERE (""calls"".""caller_id""=""person"".""id"" OR ""calls"".""callee_id""=""person"".""id"") AND LEFT(""phone_number"", 3)=""country_code"" GROUP BY ""country"".""name"" HAVING SUM(""duration"")/COUNT(1)>(SELECT SUM(""duration"")/COUNT(1) FROM ""calls"")"
265,"WITH ""cte"" AS (SELECT ""c"".""name"",COALESCE(AVG(""calls"".""duration""), 0) AS ""avg_duration"" FROM (""country"" AS ""c"" LEFT JOIN ""person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) LEFT JOIN ""calls"" ON ""calls"".""caller_id""=""p"".""id"" OR ""calls"".""callee_id""=""p"".""id"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""cte"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
266,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
267,"WITH ""tmp"" AS (SELECT DISTINCT ""a"".""name"" AS ""country"",""id"" FROM ""country"" AS ""a"" JOIN ""person"" AS ""b"" ON ""a"".""country_code""=LEFT(""phone_number"", 3)) SELECT ""country"" FROM (SELECT ""b"".""country"",SUM(""duration"") AS ""duration"",COUNT(1) AS ""cnt"" FROM ""calls"" AS ""a"" JOIN ""tmp"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"" GROUP BY 1 UNION SELECT ""c"".""country"",SUM(""duration"") AS ""duration"",COUNT(1) AS ""cnt"" FROM ""calls"" AS ""a"" JOIN ""tmp"" AS ""c"" ON ""a"".""callee_id""=""c"".""id"" GROUP BY 1) AS ""t"" GROUP BY 1 HAVING SUM(""duration"")/SUM(""cnt"")>(SELECT AVG(""duration"") FROM ""calls"")"
268,"SELECT DISTINCT ""country"" FROM (SELECT ""country"".""name"" AS ""country"",""calls"".""duration"",AVG(""calls"".""duration"") OVER (PARTITION BY ""country"".""name"") AS ""avg_duration"",AVG(""calls"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" JOIN ""person"" ON ""calls"".""caller_id""=""person"".""id"" OR ""calls"".""callee_id""=""person"".""id"") JOIN ""country"" ON LEFT(""person"".""phone_number"", 3)=""country"".""country_code"") AS ""t"" WHERE ""avg_duration"">""avg_total"""
269,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""user"",""duration"" FROM ""Calls"" UNION SELECT ""callee_id"" AS ""user"",""duration"" FROM ""Calls"") AS ""temp"" JOIN ""Person"" AS ""b"" ON ""temp"".""user""=""b"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""b"".""phone_number"", 3)=""c"".""country_code"" GROUP BY ""c"".""name"",""c"".""country_code"" HAVING AVG(""temp"".""duration"")>(SELECT SUM(""duration"")/COUNT(1) FROM ""Calls"")"
270,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" RIGHT JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") RIGHT JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
271,"WITH ""s"" AS (SELECT ""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""x"" AS (SELECT ""s"".""country"",""duration"" FROM ""calls"" AS ""c"" JOIN ""s"" ON ""c"".""caller_id""=""s"".""id"" UNION ALL SELECT ""s"".""country"",""duration"" FROM ""calls"" AS ""c"" JOIN ""s"" ON ""c"".""callee_id""=""s"".""id"") SELECT ""country"" FROM ""x"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""x"")"
272,"WITH ""base"" AS (SELECT DISTINCT ""caller_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3) UNION ALL SELECT DISTINCT ""callee_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""callee_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3)), ""base1"" AS (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg_country"",(SELECT AVG(""duration"") FROM ""Calls"") AS ""avg_global"" FROM ""base"") SELECT ""name"" AS ""country"" FROM ""base1"" WHERE ""avg_country"">""avg_global"""
273,"SELECT ""name"" AS ""country"" FROM ""Country"" WHERE ""country_code"" IN (SELECT SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"" FROM ""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id"" GROUP BY ""country_code"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls""))"
274,"WITH ""all_calls"" AS (SELECT ""co"".""name"",""ca"".""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""co"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""co"".""country_code"" UNION ALL SELECT ""co"".""name"",""ca"".""duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""ca"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""co"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""co"".""country_code""), ""Country_Avg"" AS (SELECT ""name"" AS ""country"",SUM(""duration"")/COUNT(1) AS ""avg_duration"" FROM ""all_calls"" GROUP BY ""name"") SELECT ""country"" FROM ""country_avg"" WHERE ""avg_duration"">(SELECT (SUM(""duration"")*2)/(COUNT(1)*2) AS ""total_avg"" FROM ""calls"")"
275,"WITH ""person_mod"" AS (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""person""), ""country_mod"" AS (SELECT ""person_mod"".""id"",""country"".""name"" FROM ""country"" JOIN ""person_mod"" ON ""country"".""country_code""=""person_mod"".""country_code""), ""calls_mod"" AS (SELECT ""caller_id"" AS ""person_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""person_id"",""duration"" FROM ""calls""), ""country_duration"" AS (SELECT ""ca"".""duration"",""co"".""name"" FROM ""calls_mod"" AS ""ca"" JOIN ""country_mod"" AS ""co"" ON ""ca"".""person_id""=""co"".""id""), ""country_avg"" AS (SELECT ""name"" AS ""country"",AVG(""duration"") AS ""co_avg"" FROM ""country_duration"" GROUP BY ""name""), ""global_avg"" AS (SELECT AVG(""duration"") AS ""glo_avg"" FROM ""country_duration"") SELECT ""ca"".""country"" FROM ""country_avg"" AS ""ca"" JOIN ""global_avg"" AS ""ga"" WHERE ""ca"".""co_avg"">""ga"".""glo_avg"""
276,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Country"" ON LEFT(""phone_number"", 3)=""Country"".""country_code"") JOIN ""Calls"" ON ""Person"".""id""=""Calls"".""caller_id"" OR ""Person"".""id""=""Calls"".""callee_id"" GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
277,"WITH ""T1"" AS (SELECT ""Caller_id"" AS ""id"",""duration"",LEFT(""phone_number"", 3) AS ""num"" FROM ""Calls"" AS ""C1"" JOIN ""Person"" AS ""P1"" ON ""C1"".""caller_id""=""P1"".""id"" UNION ALL SELECT ""Callee_id"" AS ""id"",""duration"",LEFT(""phone_number"", 3) AS ""num"" FROM ""Calls"" AS ""C2"" JOIN ""Person"" AS ""P2"" ON ""C2"".""callee_id""=""P2"".""id"") SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""name"",CASE WHEN AVG(""duration"") OVER (PARTITION BY ""name"")<=AVG(""duration"") OVER () THEN 0 ELSE 1 END AS ""test"" FROM ""T1"" JOIN ""Country"" AS ""C"" ON ""T1"".""num""=""C"".""country_code"") AS ""sub"" WHERE ""test""=1"
278,"SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) LEFT JOIN ""Calls"" AS ""cl"" ON ""p"".""id""=""cl"".""caller_id"" OR ""p"".""id""=""cl"".""callee_id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"") IS NOT NULL AND AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
279,"WITH ""base"" AS (SELECT DISTINCT ""caller_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3) UNION ALL SELECT DISTINCT ""callee_id"" AS ""id"",""Country"".""name"",""duration"" FROM (""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""callee_id""=""Person"".""id"") LEFT JOIN ""country"" ON ""country"".""country_code""=LEFT(""Person"".""phone_number"", 3)), ""base1"" AS (SELECT DISTINCT ""name"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg_country"",(SELECT AVG(""duration"") FROM ""Calls"") AS ""avg_global"" FROM ""base"") SELECT ""name"" AS ""country"" FROM ""base1"" WHERE ""avg_country"">""avg_global"""
280,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
281,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""phn"" ON ""p"".""id""=""phn"".""id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
282,"WITH ""PersonCountry"" AS (SELECT * FROM ""Country"" AS ""C"" JOIN (SELECT ""id"",SUBSTRING(""phone_number"", 1, 3) AS ""phone_code"" FROM ""Person"") AS ""P"" ON ""C"".""country_code""=""P"".""phone_code"") SELECT ""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") AS ""average_duration"" FROM ""PersonCountry"" JOIN ""Calls"" ON ""id""=""caller_id"" OR ""id""=""callee_id"" GROUP BY ""name"") AS ""PC"" WHERE ""average_duration"">(SELECT AVG(""duration"") FROM ""Calls"")"
283,"WITH ""cte"" AS (SELECT ""c"".""name"",COALESCE(AVG(""calls"".""duration""), 0) AS ""avg_duration"" FROM (""country"" AS ""c"" LEFT JOIN ""person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) LEFT JOIN ""calls"" ON ""calls"".""caller_id""=""p"".""id"" OR ""calls"".""callee_id""=""p"".""id"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""cte"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
284,"SELECT ""c"".""name"" AS ""country"" FROM (""country"" AS ""c"" JOIN ""person"" AS ""p"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""calls"" AS ""a"" ON ""a"".""caller_id""=""p"".""id"" OR ""a"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
285,"SELECT ""co"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""c"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""Country"" AS ""co"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""co"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
286,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""Calls"" ON ""id""=""caller_id"" OR ""id""=""callee_id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT SUM(""duration"")*2/(SELECT COUNT(1)*2 FROM ""Calls"") FROM ""Calls"")"
287,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"" AS ""caller_name"",""p"".""phone_number"",""c"".""name"" AS ""country_name"",""c"".""country_code"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""country_name"",AVG(CASE WHEN ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" THEN ""duration"" ELSE 0 END) AS ""D"" FROM ""cte"" JOIN ""Calls"" ON ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" GROUP BY ""country_name"" HAVING ""D"">(SELECT AVG(""duration"") FROM ""Calls"")) AS ""tmp"""
288,"SELECT ""ct"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""c"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""c"".""id"") JOIN ""country"" AS ""ct"" ON ""ct"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY ""ct"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
289,"SELECT ""name"" AS ""country"" FROM (SELECT DISTINCT ""c"".""name"",AVG(""t"".""duration"") OVER (PARTITION BY ""c"".""country_code"") AS ""avg_country"",AVG(""t"".""duration"") OVER () AS ""avg_global"" FROM ((SELECT ""caller_id"" AS ""user_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls"") AS ""t"" JOIN ""Person"" AS ""p"" ON ""t"".""user_id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""j"" WHERE ""avg_country"">""avg_global"""
290,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
291,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
292,"WITH ""cte"" AS (SELECT ""caller_id"",""phone_number"",""duration"",SUBSTR(""phone_number"", 1, 3) AS ""country_code"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id""), ""country_avg"" AS (SELECT ""co"".""name"",AVG(""duration"") AS ""avg_duration"" FROM ""cte"" LEFT JOIN ""Country"" AS ""co"" ON ""cte"".""country_code""=""co"".""country_code"" GROUP BY 1) SELECT ""country_avg"".""name"" AS ""country"" FROM ""country_avg"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""calls"")"
293,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT DISTINCT ""country"" FROM ""cte"" WHERE ""avg_duration"">""avg_total"""
294,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON LEFT(""person"".""phone_number"", 3)=""country"".""country_code"") JOIN ""calls"" ON ""person"".""id""=""calls"".""caller_id"" OR ""person"".""id""=""calls"".""callee_id"" GROUP BY ""country"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
295,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""call_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""call_id"",""duration"" FROM ""calls"") AS ""a"" JOIN ""person"" AS ""b"" ON ""a"".""call_id""=""b"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""b"".""phone_number"", 3)=""c"".""country_code"" GROUP BY ""c"".""country_code"" HAVING AVG(""a"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
296,"WITH ""abc"" AS (SELECT ""id"",""name"",LEFT(""phone_number"", 3) AS ""c"" FROM ""person""), ""xyz"" AS (SELECT ""a"".""id"",""a"".""name"",""a"".""c"",""b"".""name"" AS ""cou"" FROM ""abc"" AS ""a"" JOIN ""country"" AS ""b"" ON ""a"".""c""=""b"".""country_code""), ""final"" AS (SELECT ""a"".""duration"",""b"".""cou"" FROM ""calls"" AS ""a"" JOIN ""xyz"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"" UNION ALL SELECT ""a"".""duration"",""b"".""cou"" FROM ""calls"" AS ""a"" JOIN ""xyz"" AS ""b"" ON ""a"".""callee_id""=""b"".""id""), ""ans"" AS (SELECT ""cou"",AVG(""duration"") OVER () AS ""globald"",AVG(""duration"") OVER (PARTITION BY ""cou"") AS ""regionald"" FROM ""final"") SELECT ""cou"" AS ""country"" FROM ""ans"" WHERE ""regionald"">""globald"" GROUP BY 1"
297,"SELECT ""t1"".""name"" AS ""country"" FROM (SELECT ""a"".""name"",""b"".""id"",AVG(""c"".""duration"") AS ""avg_call"" FROM (""Country"" AS ""a"" LEFT JOIN ""Person"" AS ""b"" ON ""a"".""country_code""=LEFT(""b"".""phone_number"", 3)) LEFT JOIN (SELECT DISTINCT * FROM ""Calls"") AS ""c"" ON ""b"".""id""=""c"".""caller_id"" OR ""b"".""id""=""c"".""callee_id"" GROUP BY ""a"".""name"") AS ""t1"" WHERE ""t1"".""avg_call"">(SELECT SUM(""duration"")/COUNT(""duration"") FROM (SELECT DISTINCT * FROM ""Calls"") AS ""d"")"
298,"WITH ""CTE"" AS (SELECT ""b"".""name"",AVG(""c"".""duration"") AS ""average"" FROM (""Person"" AS ""a"" JOIN ""Country"" AS ""b"" ON SUBSTR(""a"".""phone_number"", 1, 3)=""b"".""country_code"") JOIN ""Calls"" AS ""c"" ON ""c"".""caller_id""=""a"".""id"" OR ""c"".""callee_id""=""a"".""id"" GROUP BY ""b"".""name"") SELECT ""name"" AS ""country"" FROM ""CTE"" WHERE ""average"">(SELECT AVG(""duration"") FROM ""Calls"")"
299,"WITH ""cte_duration"" AS (SELECT ""co"".""name"",""c"".""duration"" FROM (""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id"") JOIN ""Country"" AS ""co"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3)) SELECT ""country"" FROM (SELECT ""name"" AS ""country"",AVG(""duration"") AS ""country_avg_duration"" FROM ""cte_duration"" GROUP BY ""name"") AS ""d"" WHERE ""country_avg_duration"">(SELECT AVG(""duration"") FROM ""cte_duration"")"
300,"WITH ""CTE"" AS (SELECT ""c"".""name"",AVG(""ca"".""duration"") AS ""country_avg"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) JOIN ""Calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"") SELECT ""name"" AS ""country"" FROM ""CTE"" WHERE ""country_avg"">(SELECT AVG(""duration"") FROM ""calls"")"
301,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"" AS ""caller_name"",""p"".""phone_number"",""c"".""name"" AS ""country_name"",""c"".""country_code"" FROM ""Person"" AS ""p"" RIGHT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""country_name"",AVG(CASE WHEN ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" THEN ""duration"" ELSE 0 END) AS ""D"" FROM ""cte"" JOIN ""Calls"" ON ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" GROUP BY ""country_name"" HAVING ""D"">(SELECT AVG(""duration"") FROM ""Calls"")) AS ""tmp"""
302,"WITH ""person_country_code"" AS (SELECT ""id"",SUBSTRING_INDEX(""phone_number"", '-', 1) AS ""country_code_person"" FROM ""Person""), ""avg_global_average"" AS (SELECT ""country_code_person"",AVG(""duration"") AS ""average"" FROM ""Calls"" AS ""c"" JOIN ""person_country_code"" AS ""p"" ON (""c"".""caller_id""=""p"".""id"") OR (""c"".""callee_id""=""p"".""id"") GROUP BY 1) SELECT ""c"".""name"" AS ""country"" FROM ""avg_global_average"" AS ""a"" JOIN ""Country"" AS ""c"" ON ""a"".""country_code_person""=""c"".""country_code"" WHERE ""average"">(SELECT AVG(""duration"") FROM ""calls"")"
303,"WITH ""global_avg"" AS (SELECT AVG(""duration"") FROM ""calls"") SELECT ""ct"".""name"" AS ""country"" FROM (""calls"" AS ""cl"" LEFT JOIN ""person"" AS ""p"" ON ""cl"".""caller_id""=""p"".""id"" OR ""cl"".""callee_id""=""p"".""id"") LEFT JOIN ""country"" AS ""ct"" ON ""ct"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""ct"".""country_code"" HAVING AVG(""duration"")>(SELECT * FROM ""global_avg"") ORDER BY 1"
304,"WITH ""cte1"" AS (SELECT ""id"",""C"".""name"" AS ""country"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""it"" JOIN ""Country"" AS ""C"" ON ""C"".""country_code""=""it"".""country_code""), ""cte2"" AS (SELECT AVG(""duration"") AS ""global_avg"" FROM ""Calls"") SELECT ""country"" FROM (SELECT ""country"",AVG(CASE WHEN ""id""=""caller_id"" OR ""id""=""callee_id"" THEN ""duration"" ELSE NULL END) AS ""country_avg"" FROM ""cte1"" JOIN ""Calls"" GROUP BY ""country"") AS ""itm"" WHERE ""country_avg"">(SELECT ""global_avg"" FROM ""cte2"")"
305,"WITH ""a"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls""), ""b"" AS (SELECT ""c"".""name"",AVG(""a"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_c"",AVG(""a"".""duration"") OVER () AS ""avg_t"" FROM (""Person"" AS ""p"" LEFT JOIN ""a"" USING (""id"")) LEFT JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) SELECT DISTINCT ""name"" AS ""country"" FROM ""b"" WHERE ""avg_c"">""avg_t"""
306,"WITH ""temp"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") AS ""duration"" FROM ((""country"" AS ""c"") JOIN ""person"" AS ""p"") JOIN ""calls"" AS ""ca"" WHERE ""c"".""country_code""=SUBSTR(""p"".""phone_number"", 1, 3) AND (""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") GROUP BY ""c"".""name"") SELECT ""t"".""country"" FROM (""temp"" AS ""t"") JOIN (SELECT AVG(""duration"") AS ""duration"" FROM ""calls"") AS ""t2"" WHERE ""t"".""duration"">""t2"".""duration"""
307,"WITH ""t"" AS (SELECT ""p"".""id"" AS ""id"",LEFT(""p"".""phone_number"", 3) AS ""ctry_code"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""t2"" AS (SELECT ""t"".""name"" AS ""name"",""ctry_code"",SUM(CASE WHEN ""c"".""caller_id""=""id"" OR ""c"".""callee_id""=""id"" THEN ""duration"" END)/COUNT(1) AS ""ctry"" FROM ""t"" JOIN ""calls"" AS ""c"" ON ""c"".""caller_id""=""id"" OR ""c"".""callee_id""=""id"" GROUP BY ""t"".""ctry_code"") SELECT ""name"" AS ""country"" FROM ""t2"" WHERE (SELECT (SUM(""duration"")*2)/(COUNT(""duration"")*2) AS ""global_avg"" FROM ""calls"")<""ctry"""
308,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
309,"WITH ""uni"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls""), ""map"" AS (SELECT ""p"".""id"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT DISTINCT ""m"".""name"" AS ""country"" FROM ""uni"" AS ""u"" JOIN ""map"" AS ""m"" ON ""u"".""id""=""m"".""id"" GROUP BY 1 HAVING AVG(""u"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
310,"WITH ""cte_ppl_ctry"" AS (SELECT ""id"",""p"".""name"" AS ""person"",""phone_number"",""c"".""name"" AS ""country"",""country_code"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""cte_final"" AS (SELECT ""country"" FROM ""Calls"" AS ""c"" JOIN ""cte_ppl_ctry"" AS ""pc"" ON ""c"".""caller_id""=""pc"".""id"" OR ""c"".""callee_id""=""pc"".""id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")) SELECT * FROM ""cte_final"""
311,"WITH ""cte"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte"" AS ""c1"" JOIN ""person"" AS ""p"" ON ""c1"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" GROUP BY 1 HAVING AVG(""c1"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
312,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
313,"SELECT ""country"" FROM (SELECT ""C1"".""name"" AS ""country"",AVG(COALESCE(""duration"", 0)) AS ""AVERAGE"",(SELECT AVG(""duration"") FROM ""Calls"") AS ""global_average"" FROM (""Country"" AS ""C1"" JOIN ""Person"" AS ""P1"" ON ""C1"".""country_code""=LEFT(""P1"".""phone_number"", 3)) JOIN ""Calls"" AS ""C2"" ON ""P1"".""id""=""C2"".""caller_id"" OR ""P1"".""id""=""C2"".""callee_id"" GROUP BY 1) AS ""Temp"" WHERE ""AVERAGE"">""global_average"""
314,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
315,"SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") OVER () AS ""avg_g"",AVG(""duration"") OVER (PARTITION BY ""name"") AS ""avg_c"" FROM ""calls"" JOIN (SELECT ""id"",""country"".""name"" FROM ""person"" JOIN ""country"" ON LEFT(""person"".""phone_number"", 3)=""country"".""country_code"") AS ""t"" ON ""calls"".""caller_id""=""t"".""id"" OR ""calls"".""callee_id""=""t"".""id"") AS ""src"" WHERE ""avg_c"">""avg_g"""
316,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""country_code"",COALESCE(""c"".""duration"", 0) AS ""duration"",""ca"".""name"" FROM ((SELECT ""id"",SUBSTR(""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"") AS ""p"" JOIN ""Calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"")) JOIN ""Country"" AS ""ca"" ON ""p"".""country_code""=""ca"".""country_code"") SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT *,AVG(""duration"") OVER (PARTITION BY ""country_code"") AS ""adur"" FROM ""cte"") AS ""ct"" WHERE ""adur"">(SELECT AVG(""duration"") FROM ""Calls"")"
317,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
318,"SELECT ""C"".""name"" AS ""country"" FROM (""Person"" AS ""P"" LEFT JOIN ""Country"" AS ""C"" ON LEFT(""P"".""phone_number"", 3)=""C"".""country_code"") LEFT JOIN (SELECT ""caller_id"" AS ""id"",""duration"" AS ""duration_1"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" AS ""duration_1"" FROM ""Calls"") AS ""Calls_1"" ON ""P"".""id""=""Calls_1"".""id"" GROUP BY 1 HAVING AVG(""duration_1"")>(SELECT AVG(""duration"") FROM ""calls"")"
319,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
320,"WITH ""abc"" AS (SELECT ""id"",""name"",LEFT(""phone_number"", 3) AS ""c"" FROM ""person""), ""xyz"" AS (SELECT ""a"".""id"",""a"".""name"",""a"".""c"",""b"".""name"" AS ""cou"" FROM ""abc"" AS ""a"" JOIN ""country"" AS ""b"" ON ""a"".""c""=""b"".""country_code""), ""final"" AS (SELECT ""a"".""duration"",""b"".""cou"" FROM ""calls"" AS ""a"" JOIN ""xyz"" AS ""b"" ON ""a"".""caller_id""=""b"".""id"" UNION ALL SELECT ""a"".""duration"",""b"".""cou"" FROM ""calls"" AS ""a"" JOIN ""xyz"" AS ""b"" ON ""a"".""callee_id""=""b"".""id""), ""ans"" AS (SELECT ""cou"",AVG(""duration"") OVER () AS ""globald"",AVG(""duration"") OVER (PARTITION BY ""cou"") AS ""regionald"" FROM ""final"") SELECT ""cou"" AS ""country"" FROM ""ans"" WHERE ""regionald"">""globald"" GROUP BY 1"
321,"WITH ""callss"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls""), ""cte"" AS (SELECT ""c"".""name"",""p"".""id"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" WHERE ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) SELECT ""name"" AS ""country"" FROM ""callss"" AS ""c"" JOIN ""cte"" AS ""t"" ON ""t"".""id""=""c"".""caller_id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""callss"")"
322,"WITH ""cte"" AS (SELECT ""country"".""name"" AS ""name"",AVG(""duration"") AS ""country_average"",(SELECT AVG(""duration"") FROM ""calls"") AS ""global_average"" FROM (""calls"" JOIN ""person"" ON ""calls"".""caller_id""=""id"" OR ""callee_id""=""id"") JOIN ""country"" ON ""country_code""=LEFT(""person"".""phone_number"", 3) GROUP BY ""name"") SELECT ""name"" AS ""country"" FROM ""cte"" WHERE ""country_average"">""global_average"""
323,"SELECT ""C2"".""name"" AS ""country"" FROM (""Calls"" AS ""C1"" JOIN ""Person"" AS ""P1"" ON ""C1"".""caller_id""=""P1"".""id"" OR ""C1"".""callee_id""=""P1"".""id"") JOIN ""Country"" AS ""C2"" ON LEFT(""P1"".""phone_number"", 3)=""C2"".""country_code"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
324,"SELECT ""ct"".""name"" AS ""country"" FROM (""Country"" AS ""ct"" JOIN ""Person"" AS ""p"" ON ""ct"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""Calls"" AS ""c"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"" GROUP BY 1 HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
325,"SELECT ""co"".""name"" AS ""country"" FROM (""Country"" AS ""co"" JOIN ""Person"" AS ""p"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
326,"SELECT ""c"".""name"" AS ""country"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
327,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""t"" LEFT JOIN ""person"" AS ""p"" ON ""t"".""id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""phone_number"", 1, 3) GROUP BY 1 HAVING SUM(""t"".""duration"")/COUNT(""t"".""id"")>(SELECT SUM(""duration"")/COUNT(""duration"") FROM ""calls"")"
328,"WITH ""cte1"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte1"" AS ""c1"" JOIN ""person"" AS ""p"" ON (""c1"".""id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON (SUBSTR(""phone_number"", 1, 3)=""c"".""country_code"") GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""globAvg"" FROM ""calls"")"
329,"SELECT ""t4"".""name"" AS ""country"" FROM (SELECT ""t3"".""name"",AVG(""t1"".""duration"") AS ""country_avg"",'1' AS ""temp"" FROM (""calls"" AS ""t1"" JOIN ""person"" AS ""t2"" ON ""t1"".""caller_id""=""t2"".""id"" OR ""t1"".""callee_id""=""t2"".""id"") JOIN ""country"" AS ""t3"" ON LEFT(""t2"".""phone_number"", 3)=""t3"".""country_code"" GROUP BY 1) AS ""t4"" JOIN (SELECT AVG(""duration"") AS ""global_avg"",'1' AS ""temp"" FROM ""calls"" GROUP BY 2) AS ""t5"" ON ""t4"".""temp""=""t5"".""temp"" WHERE ""t4"".""country_avg"">""t5"".""global_avg"""
330,"WITH ""cus_country"" AS (SELECT ""cus"".""id"" AS ""cust_id"",""Country"".""name"" AS ""country_name"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""cus"" LEFT JOIN ""Country"" ON ""cus"".""country_code""=""Country"".""country_code""), ""call_min"" AS (SELECT ""caller_id"" AS ""cust_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""cust_id"",""duration"" FROM ""calls""), ""g_avg"" AS (SELECT AVG(""duration"") AS ""global_avg"" FROM ""Calls"") SELECT ""country_name"" AS ""Country"" FROM ""call_min"" LEFT JOIN ""cus_country"" ON ""call_min"".""cust_id""=""cus_country"".""cust_id"" GROUP BY ""country_name"" HAVING AVG(""duration"")>(SELECT ""global_avg"" FROM ""g_avg"")"
331,"WITH ""cte"" AS (SELECT ""P"".""id"",""P"".""name"" AS ""person_name"",""C2"".""country_code"",""C2"".""name"" AS ""country_name"",""C"".""duration"" FROM (""Person"" AS ""P"" JOIN ""Calls"" AS ""C"" ON ""P"".""id""=""C"".""caller_id"" OR ""P"".""id""=""C"".""callee_id"") JOIN ""Country"" AS ""C2"" ON LEFT(""P"".""phone_number"", 3)=""C2"".""country_code"") SELECT ""country_name"" AS ""country"" FROM ""cte"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
332,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
333,"WITH ""A"" AS (SELECT ""caller_id"" AS ""user"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls"") SELECT ""C"".""name"" AS ""country"" FROM (""A"" JOIN ""Person"" AS ""P"" ON ""A"".""user""=""P"".""id"") JOIN ""Country"" AS ""C"" ON LEFT(""P"".""phone_number"", 3)=""C"".""country_code"" GROUP BY ""C"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""A"")"
334,"ERROR: mysql parse error: line 1 column 131 near ""p LEFT JOIN Country c ON p.country_code = c.country_code ) ), Caller AS ( SELECT c.caller_id AS id, c.duration, pc.country_code, pc.country FROM Calls c LEFT JOIN pc ON c.caller_id = pc.id ), Callee AS ( SELECT c.callee_id AS id, c.duration, pc.country_code, pc.country FROM Calls c LEFT JOIN pc ON c.callee_id = pc.id ), c AS ( SELECT * FROM Caller UNION ALL SELECT * FROM Callee ), cavg AS ( SELECT country, AVG(duration) OVER(PARTITION BY country_code) AS cd, AVG(duration) OVER() AS gd FROM c ) SELECT DISTINCT country as country FROM cavg WHERE cd > gd "" "
335,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTR(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
336,"SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""Calls"" AS ""a"" ON ""p"".""id""=""a"".""caller_id"" OR ""p"".""id""=""a"".""callee_id"" GROUP BY ""country_code"" HAVING AVG(""duration"")-(SELECT AVG(""duration"") FROM ""Calls"")>0"
337,"WITH ""all_calls"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""cte"" AS (SELECT ""a"".""id"",""c"".""name"" AS ""country"",""a"".""duration"" FROM (""all_calls"" AS ""a"" LEFT JOIN (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""p"" ON ""a"".""id""=""p"".""id"") LEFT JOIN ""Country"" AS ""c"" ON ""c"".""country_code""=""p"".""country_code"") SELECT ""country"" FROM (SELECT ""country"",AVG(""duration"") AS ""avg_duration"" FROM ""cte"" GROUP BY ""country"") AS ""t"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""cte"")"
338,"SELECT ""country"" FROM (SELECT ""a"".""name"" AS ""country"",AVG(""duration"") AS ""average"" FROM ((""Country"" AS ""a"") JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION SELECT ""callee_id"",""duration"" FROM ""Calls"") AS ""b"") JOIN ""Person"" AS ""c"" WHERE ""c"".""id""=""b"".""id"" AND SUBSTR(""c"".""phone_number"", 1, 3)=""a"".""country_code"" GROUP BY 1) AS ""e"", (SELECT AVG(""duration"") AS ""mean"" FROM ""Calls"") AS ""d"" WHERE ""e"".""average"">""d"".""mean"""
339,"SELECT ""name"" AS ""country"" FROM ""Country"" AS ""c"" JOIN (SELECT SUBSTRING(""phone_number"", 1, 3) AS ""country_code"",SUM(""duration"")*1.0/COUNT(1) AS ""duration"" FROM ""Person"" AS ""P"" JOIN (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""B"" ON ""P"".""id""=""B"".""id"" GROUP BY SUBSTRING(""phone_number"", 1, 3)) AS ""A"" ON ""a"".""country_code""=""c"".""country_code"" WHERE ""duration"">(SELECT SUM(""duration"")*1.0/COUNT(""duration"") FROM ""Calls"")"
340,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
341,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_country"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""Calls"" AS ""ca"" JOIN ""Person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""temp"" WHERE ""avg_country"">""avg_total"""
342,"SELECT DISTINCT ""c2"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""x"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""x"".""id"") JOIN ""country"" AS ""c2"" ON LEFT(""p"".""phone_number"", 3)=""c2"".""country_code"" GROUP BY 1 HAVING AVG(""x"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
343,"SELECT ""name"" AS ""country"" FROM (SELECT ""c"".""name"",""m"".""duration"" FROM ((""Person"" AS ""p"") JOIN ""Country"" AS ""c"") JOIN ""Calls"" AS ""m"" WHERE LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" AND ""p"".""id""=""m"".""caller_id"" UNION ALL SELECT ""c1"".""name"",""m1"".""duration"" FROM ((""Person"" AS ""p1"") JOIN ""Country"" AS ""c1"") JOIN ""Calls"" AS ""m1"" WHERE LEFT(""p1"".""phone_number"", 3)=""c1"".""country_code"" AND ""p1"".""id""=""m1"".""callee_id"") AS ""t"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
344,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
345,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code""), ""cte1"" AS ((SELECT ""caller_id"",""cte"".""country"" AS ""country"",""duration"" FROM ""Calls"" LEFT JOIN ""cte"" ON ""Calls"".""caller_id""=""cte"".""id"") UNION ALL (SELECT ""caller_id"",""cte"".""country"" AS ""country"",""duration"" FROM ""Calls"" LEFT JOIN ""cte"" ON ""Calls"".""callee_id""=""cte"".""id"")) SELECT ""country"" FROM ""cte1"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte1"")"
346,"SELECT ""c"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
347,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON ""country_code""=LEFT(""phone_number"", 3)) JOIN ""calls"" ON ""person"".""id""=""calls"".""caller_id"" OR ""person"".""id""=""calls"".""callee_id"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
348,"SELECT ""co"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""ID"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""ID"",""duration"" FROM ""Calls"") AS ""C"" JOIN (SELECT ""id"",SUBSTRING(""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"") AS ""P"" ON ""C"".""id""=""P"".""id"") JOIN ""Country"" AS ""CO"" ON ""P"".""country_code""=""co"".""country_code"" GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT SUM(""duration"")/COUNT(1) FROM ""Calls"")"
349,"WITH ""world"" AS (SELECT AVG(""duration"") AS ""world_average_duration"" FROM (""country"" AS ""cou"" LEFT JOIN ""person"" AS ""p"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""calls"" AS ""ca"" ON ""id""=""caller_id"" OR ""id""=""callee_id""), ""country"" AS (SELECT ""country_code"",""cou"".""name"",AVG(""duration"") AS ""country_average_duration"" FROM (""country"" AS ""cou"" LEFT JOIN ""person"" AS ""p"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""calls"" AS ""ca"" ON ""id""=""caller_id"" OR ""id""=""callee_id"" GROUP BY ""country_code"",""cou"".""name"") SELECT ""name"" AS ""country"" FROM ""country"" WHERE ""country_average_duration"">(SELECT ""world_average_duration"" FROM ""world"")"
350,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
351,"WITH ""caller"" AS (SELECT ""c"".""name"" AS ""country"",SUM(""a"".""duration"") AS ""duration"",COUNT(1) AS ""call_cnt"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""Calls"" AS ""a"" ON ""a"".""caller_id""=""p"".""id"" GROUP BY ""c"".""name""), ""callee"" AS (SELECT ""c"".""name"" AS ""country"",SUM(""a"".""duration"") AS ""duration"",COUNT(1) AS ""call_cnt"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""Calls"" AS ""a"" ON ""a"".""callee_id""=""p"".""id"" GROUP BY ""c"".""name"") SELECT ""country"" FROM (SELECT * FROM ""caller"" UNION ALL SELECT * FROM ""callee"") AS ""t"" GROUP BY ""country"" HAVING SUM(""duration"")/SUM(""call_cnt"")>(SELECT AVG(""duration"") FROM ""Calls"")"
352,"WITH ""cte"" AS (SELECT LEFT(""phone_number"", 3) AS ""country_code"",AVG(""duration"") AS ""country_avg"" FROM ""person"" AS ""p"" JOIN (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") AS ""c"" ON ""p"".""id""=""c"".""caller_id"" GROUP BY LEFT(""phone_number"", 3)) SELECT ""name"" AS ""country"" FROM ""cte"" JOIN ""country"" ON ""cte"".""country_code""=""country"".""country_code"" WHERE ""country_avg"">(SELECT AVG(""duration"") FROM ""calls"")"
353,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""avg_total"" FROM (""calls"" AS ""ca"" RIGHT JOIN ""person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""a"" WHERE ""avg_duration"">""avg_total"""
354,"WITH ""TT1"" (""Average"") AS (SELECT SUM(""duration"")/COUNT(1) FROM (SELECT ""Caller_id"",""id"",""Callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""number"" FROM ""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") AS ""t1"" JOIN ""Country"" ON ""t1"".""number""=""Country"".""country_code""), ""TT2"" (""name"", ""A2"") AS (SELECT ""Country"".""name"",SUM(""duration"")/COUNT(1) FROM (SELECT ""Caller_id"",""id"",""Callee_id"",""duration"",LEFT(""phone_number"", 3) AS ""number"" FROM ""Calls"" LEFT JOIN ""Person"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") AS ""t1"" JOIN ""Country"" ON ""t1"".""number""=""Country"".""country_code"" GROUP BY ""Country"".""name"") SELECT ""TT2"".""name"" AS ""country"" FROM (""TT1"") JOIN ""TT2"" WHERE ""TT2"".""A2"">""TT1"".""Average"""
355,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"",""c"".""name"" AS ""country"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code""), ""cte1"" AS ((SELECT ""caller_id"",""cte"".""country"" AS ""country"",""duration"" FROM ""Calls"" LEFT JOIN ""cte"" ON ""Calls"".""caller_id""=""cte"".""id"") UNION ALL (SELECT ""caller_id"",""cte"".""country"" AS ""country"",""duration"" FROM ""Calls"" LEFT JOIN ""cte"" ON ""Calls"".""callee_id""=""cte"".""id"")) SELECT ""country"" FROM ""cte1"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte1"")"
356,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"" AS ""caller_name"",""p"".""phone_number"",""c"".""name"" AS ""country_name"",""c"".""country_code"" FROM ""Person"" AS ""p"" LEFT JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""country_name"",AVG(CASE WHEN ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" THEN ""duration"" ELSE 0 END) AS ""D"" FROM ""cte"" RIGHT JOIN ""Calls"" ON ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" GROUP BY ""country_name"" HAVING ""D"">(SELECT AVG(""duration"") FROM ""Calls"")) AS ""tmp"""
357,"SELECT ""c"".""name"" AS ""country"" FROM (""country"" AS ""c"" JOIN ""person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
358,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
359,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT DISTINCT ""country"" FROM ""cte"" WHERE ""avg_duration"">""global_avg_duration"""
360,"WITH ""person_country"" AS (SELECT ""p"".""id"",""p"".""phone_number"",""c"".""name"" AS ""country"",""c"".""country_code"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)), ""final_query"" AS (SELECT ""country"" FROM ""Calls"" AS ""cls"" JOIN ""person_country"" AS ""pc"" ON ""pc"".""id""=""cls"".""caller_id"" OR ""pc"".""id""=""cls"".""callee_id"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")) SELECT * FROM ""final_query"""
361,"WITH ""Person_tmp"" AS (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person""), ""Calls_tmp"" AS (SELECT ""caller_id"" AS ""calls_id"",""duration"" FROM ""Calls"" UNION SELECT ""callee_id"" AS ""calls_id"",""duration"" FROM ""Calls"") SELECT ""name"" AS ""country"" FROM ""Country"" WHERE ""country_code"" IN (SELECT DISTINCT ""country_code"" FROM (SELECT ""c"".*,""country_code"",AVG(""duration"") OVER (PARTITION BY ""country_code"") AS ""avg_duration"" FROM ""Calls_tmp"" AS ""c"" LEFT JOIN ""Person_tmp"" AS ""p"" ON ""c"".""calls_id""=""p"".""id"") AS ""t"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls""))"
362,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
363,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
364,"SELECT ""ct"".""name"" AS ""country"" FROM (""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""c"".""callee_id"") JOIN ""Country"" AS ""ct"" ON ""ct"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY 1 HAVING AVG(""c"".""duration"")>(SELECT AVG(""c"".""duration"") FROM ""Calls"" AS ""c"")"
365,"SELECT ""co"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") JOIN ""Country"" AS ""co"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""co"".""name"" HAVING AVG(""ca"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
366,"SELECT ""co"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""Country"" AS ""co"" ON SUBSTR(""p"".""phone_number"", 1, 3)=""co"".""country_code"" GROUP BY ""co"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
367,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""calls"" ON ""person"".""id""=""calls"".""caller_id"" OR ""person"".""id""=""calls"".""callee_id"" GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
368,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
369,"WITH ""call_person_tab"" AS (SELECT ""c"".""duration"",""p1"".""phone_number"" AS ""caller_num"",""p2"".""phone_number"" AS ""callee_num"" FROM (""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p1"" ON ""p1"".""id""=""c"".""caller_id"") LEFT JOIN ""Person"" AS ""p2"" ON ""p2"".""id""=""c"".""callee_id""), ""country_tab"" AS (SELECT ""cp"".""duration"",""ctry1"".""name"" AS ""caller_ctry"",""ctry2"".""name"" AS ""callee_ctry"" FROM (""call_person_tab"" AS ""cp"" LEFT JOIN ""Country"" AS ""ctry1"" ON LEFT(""cp"".""caller_num"", 3)=""ctry1"".""country_code"") LEFT JOIN ""Country"" AS ""ctry2"" ON LEFT(""cp"".""callee_num"", 3)=""ctry2"".""country_code""), ""avg_caller"" AS (SELECT ""caller_ctry"",SUM(""duration"") AS ""sum_duration"",COUNT(""duration"") AS ""count_duration"" FROM ""country_tab"" GROUP BY ""caller_ctry""), ""avg_callee"" AS (SELECT ""callee_ctry"",SUM(""duration"") AS ""sum_duration"",COUNT(""duration"") AS ""count_duration"" FROM ""country_tab"" GROUP BY ""callee_ctry""), ""union_tab"" AS (SELECT * FROM ""avg_caller"" UNION SELECT * FROM ""avg_callee"") SELECT ""ut"".""caller_ctry"" AS ""country"" FROM (""union_tab"" AS ""ut"") JOIN ""Calls"" AS ""c"" GROUP BY ""caller_ctry"" HAVING SUM(""ut"".""sum_duration"")/SUM(""ut"".""count_duration"")>AVG(""c"".""duration"")"
370,"WITH ""u"" AS (SELECT DISTINCT * FROM ""calls""), ""t"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""u"" ON ""u"".""caller_id""=""p"".""id"" OR ""u"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""c"".""country_code"",""c"".""name"" HAVING AVG(""duration"")>(SELECT * FROM ""t"")"
371,"SELECT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""aa"" WHERE ""avg_duration"">""global_avg_duration"" GROUP BY 1"
372,"WITH ""call_duration"" AS (SELECT * FROM (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") AS ""sub""), ""person_country"" AS (SELECT ""p"".""id"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"" FROM ""Person"" AS ""p"") SELECT ""name"" AS ""country"" FROM (SELECT DISTINCT ""co"".""name"",AVG(""c"".""duration"") OVER (PARTITION BY ""co"".""name"") AS ""country_avg"",AVG(""c"".""duration"") OVER () AS ""global_avg"" FROM (""call_duration"" AS ""c"" LEFT JOIN ""person_country"" AS ""p"" ON ""c"".""id""=""p"".""id"") LEFT JOIN ""Country"" AS ""co"" ON ""co"".""country_code""=""p"".""country_code"") AS ""sub2"" WHERE ""country_avg"">""global_avg"""
373,"WITH ""all_calls"" AS (SELECT * FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""caller_id"",""caller_id"" AS ""callee_id"",""duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""all_calls"" LEFT JOIN ""Person"" AS ""p"" ON ""all_calls"".""caller_id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"" GROUP BY ""c"".""name"" HAVING AVG(""all_calls"".""duration"")>(SELECT AVG(""all_calls"".""duration"") FROM ""all_calls"")"
374,"SELECT ""co"".""name"" AS ""country"" FROM (""Country"" AS ""co"" JOIN ""Person"" AS ""p"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN (SELECT ""p"".""id"",""duration"" FROM ""Person"" AS ""p"" JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" UNION ALL SELECT ""p"".""id"",""duration"" FROM ""Person"" AS ""p"" JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""callee_id"") AS ""a"" ON ""p"".""id""=""a"".""id"" GROUP BY ""co"".""name"" HAVING AVG(""a"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
375,"WITH ""cte1"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte1"" AS ""c1"" JOIN ""person"" AS ""p"" ON (""c1"".""id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON (SUBSTR(""phone_number"", 1, 3)=""c"".""country_code"") GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""globAvg"" FROM ""calls"")"
376,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
377,"WITH ""global_avg"" AS (SELECT AVG(""duration"") AS ""drt"" FROM ""country"" JOIN (SELECT LEFT(""p"".""phone_number"", 3) AS ""ccode"",""duration"" FROM ""calls"" LEFT JOIN ""person"" AS ""p"" ON ""calls"".""caller_id""=""p"".""id"" UNION ALL SELECT LEFT(""p"".""phone_number"", 3) AS ""ccode"",""duration"" FROM ""calls"" LEFT JOIN ""person"" AS ""p"" ON ""calls"".""callee_id""=""p"".""id"") AS ""t"" ON ""country"".""country_code""=""t"".""ccode"") SELECT ""country"".""name"" AS ""country"" FROM ""country"" JOIN (SELECT LEFT(""p"".""phone_number"", 3) AS ""ccode"",""duration"" FROM ""calls"" LEFT JOIN ""person"" AS ""p"" ON ""calls"".""caller_id""=""p"".""id"" UNION ALL SELECT LEFT(""p"".""phone_number"", 3) AS ""ccode"",""duration"" FROM ""calls"" LEFT JOIN ""person"" AS ""p"" ON ""calls"".""callee_id""=""p"".""id"") AS ""t"" ON ""country"".""country_code""=""t"".""ccode"" GROUP BY ""t"".""ccode"" HAVING AVG(""duration"")>(SELECT ""drt"" FROM ""global_avg"")"
378,"SELECT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") AS ""aa"" WHERE ""avg_duration"">""global_avg_duration"" GROUP BY 1"
379,"WITH ""cte"" AS (SELECT ""id"",SUBSTRING(""phone_number"", 1, 3) AS ""c_code"" FROM ""Person""), ""cte1"" AS (SELECT ""caller_id"" AS ""call_id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""Calls""), ""cte2"" AS (SELECT ""co"".""name"",AVG(""c1"".""duration"") AS ""total"" FROM (""cte1"" AS ""c1"" JOIN ""cte"" AS ""c"" ON ""c1"".""call_id""=""c"".""id"") JOIN ""Country"" AS ""co"" ON ""c"".""c_code""=""co"".""country_code"" GROUP BY ""co"".""name"") SELECT ""name"" AS ""country"" FROM ""cte2"" WHERE ""total"">(SELECT AVG(""duration"") FROM ""cte1"")"
380,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"" GROUP BY ""c"".""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
381,"WITH ""t"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT DISTINCT ""name"" AS ""Country"" FROM (SELECT ""c"".""name"",AVG(""duration"") OVER (PARTITION BY ""country_code"") AS ""c_avg"",AVG(""duration"") OVER () AS ""g_avg"" FROM (""t"" JOIN ""Person"" AS ""p"" ON ""t"".""id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""a"" WHERE ""c_avg"">""g_avg"""
382,"SELECT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",AVG(""duration"") AS ""avg_duration"" FROM (""Calls"" AS ""ca"" JOIN ""Person"" AS ""p"" ON (""ca"".""caller_id""=""p"".""id"") OR (""ca"".""callee_id""=""p"".""id"")) JOIN ""Country"" AS ""c"" ON (""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) GROUP BY 1) AS ""t1"" WHERE ""avg_duration"">(SELECT AVG(""duration"") AS ""global_avg"" FROM ""Calls"")"
383,"WITH ""cte1"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte1"" AS ""c1"" JOIN ""person"" AS ""p"" ON (""c1"".""id""=""p"".""id"")) JOIN ""country"" AS ""c"" ON (SUBSTR(""phone_number"", 1, 3)=""c"".""country_code"") GROUP BY ""country_code"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""globAvg"" FROM ""calls"")"
384,"WITH ""p"" AS (SELECT ""c"".""name"" AS ""country"",""id"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""phone_number"", 1, 3)), ""c"" AS (SELECT DISTINCT ""p1"".""country"",""duration"",""callee_id"",""caller_id"" FROM ""calls"" AS ""c"" JOIN ""p"" AS ""p1"" ON ""p1"".""id""=""caller_id"" UNION ALL SELECT DISTINCT ""p2"".""country"",""duration"",""callee_id"",""caller_id"" FROM ""calls"" AS ""c"" JOIN ""p"" AS ""p2"" ON ""p2"".""id""=""callee_id""), ""c1"" AS (SELECT ""country"",AVG(""duration"") AS ""ad"" FROM ""c"" GROUP BY 1) SELECT ""country"" FROM ""c1"" WHERE ""ad"">(SELECT AVG(""duration"") FROM ""calls"")"
385,"WITH ""ga"" AS (SELECT AVG(""duration"") AS ""g"" FROM ""calls""), ""cte1"" AS (SELECT ""id"",""C"".""name"" AS ""country"" FROM (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") AS ""it"" JOIN ""Country"" AS ""C"" ON ""C"".""country_code""=""it"".""country_code"") SELECT ""country"" FROM (SELECT ""country"",AVG(CASE WHEN ""id""=""caller_id"" OR ""id""=""callee_id"" THEN ""duration"" ELSE NULL END) AS ""country_avg"" FROM ""cte1"" JOIN ""Calls"" GROUP BY ""country"") AS ""itm"" WHERE ""country_avg"">(SELECT ""g"" FROM ""ga"")"
386,"WITH ""vt"" AS (SELECT ""name"",SUM(""duration"") AS ""duration"",COUNT(""name"") AS ""nums"" FROM ""calls"" AS ""c"" LEFT JOIN (SELECT ""id"",""c"".""name"" FROM ""person"" AS ""p"" LEFT JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) AS ""x"" ON ""c"".""caller_id""=""x"".""id"" GROUP BY ""name"" UNION ALL SELECT ""name"",SUM(""duration"") AS ""duration"",COUNT(""name"") AS ""nums"" FROM ""calls"" AS ""c"" LEFT JOIN (SELECT ""id"",""c"".""name"" FROM ""person"" AS ""p"" LEFT JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) AS ""x"" ON ""c"".""callee_id""=""x"".""id"" GROUP BY ""name"") SELECT ""name"" AS ""country"" FROM (SELECT ""name"",SUM(""duration"")/SUM(""nums""),CASE WHEN SUM(""duration"")/SUM(""nums"")>(SELECT AVG(""duration"") FROM ""calls"") THEN 'yes' ELSE 'no' END AS ""ans"" FROM ""vt"" GROUP BY ""name"") AS ""m"" WHERE ""ans""='yes'"
387,"SELECT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON SUBSTRING_INDEX(""phone_number"", '-', 1)=""c"".""country_code"") AS ""aa"" WHERE ""avg_duration"">""global_avg_duration"" GROUP BY 1"
388,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
389,"SELECT ""c"".""name"" AS ""country"" FROM ((SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") AS ""f"" JOIN ""person"" AS ""p"" ON ""p"".""id""=""f"".""id"") JOIN ""country"" AS ""c"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3) GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
390,"SELECT ""co"".""name"" AS ""country"" FROM (""Country"" AS ""co"" JOIN ""Person"" AS ""p"" ON ""co"".""country_code""=SUBSTR(""p"".""phone_number"", 1, 3)) JOIN ""Calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
391,"SELECT DISTINCT ""country"" FROM (SELECT ""d"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""d"".""name"") AS ""ind_sum"",AVG(""ca"".""duration"") OVER () AS ""total_sum"" FROM (""Calls"" AS ""ca"" LEFT JOIN ""Person"" AS ""p"" ON (""p"".""id""=""ca"".""caller_id"") OR (""p"".""id""=""ca"".""callee_id"")) JOIN ""Country"" AS ""d"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""d"".""country_code"") AS ""a"" WHERE ""ind_sum"">""total_sum"""
392,"SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""phone_number"", 3)=""country_code"") JOIN ""Calls"" ON (""p"".""id""=""Calls"".""caller_id"" OR ""p"".""id""=""Calls"".""callee_id"") GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
393,"WITH ""t"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""c"".""name"",AVG(""duration"") OVER (PARTITION BY ""c"".""name"") AS ""c_avg"",AVG(""duration"") OVER () AS ""g_avg"" FROM (""t"" JOIN ""Person"" AS ""p"" ON ""t"".""id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""a"" WHERE ""c_avg"">""g_avg"""
394,"WITH ""t1"" AS (SELECT ""c"".""name"" AS ""country"",""p"".""id"" FROM ""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)), ""t2"" AS (SELECT ""t"".""country"",""t"".""id"",""c"".""duration"" FROM ""t1"" AS ""t"" JOIN ""Calls"" AS ""c"" ON ""t"".""id""=""c"".""caller_id"" OR ""t"".""id""=""c"".""callee_id""), ""t3"" AS (SELECT ""a"".""country"",AVG(""a"".""duration"") AS ""avg1"" FROM ""t2"" AS ""a"" GROUP BY 1) SELECT ""country"" FROM ""t3"" WHERE ""avg1"">(SELECT AVG(""d"".""duration"") FROM ""Calls"" AS ""d"")"
395,"SELECT ""co"".""name"" AS ""country"" FROM (""Country"" AS ""co"" JOIN ""Person"" AS ""p"" ON ""co"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN (SELECT ""p"".""id"",""duration"" FROM ""Person"" AS ""p"" JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") AS ""a"" ON ""p"".""id""=""a"".""id"" GROUP BY ""co"".""name"" HAVING AVG(""a"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
396,"WITH ""t1"" AS (SELECT SUM(""duration"")*2/(COUNT(1)*2) AS ""global_average"" FROM ""calls""), ""t2"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""t3"" AS (SELECT ""t2"".""country"",AVG(CASE WHEN ""c"".""caller_id""=""t2"".""id"" OR ""c"".""callee_id""=""t2"".""id"" THEN ""duration"" END) AS ""average"" FROM (""t2"") JOIN ""calls"" AS ""c"" GROUP BY 1) SELECT ""country"" FROM (""t3"") JOIN ""t1"" WHERE ""average"">""global_average"""
397,"SELECT ""country"".""name"" AS ""country"" FROM (""country"" JOIN ""person"" ON ""country"".""country_code""=LEFT(""person"".""phone_number"", 3)) JOIN ""calls"" ON ""person"".""id""=""calls"".""caller_id"" OR ""person"".""id""=""calls"".""callee_id"" GROUP BY ""country"".""country_code"" HAVING AVG(""calls"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
398,"SELECT DISTINCT ""country"" FROM (SELECT ""p"".""id"",""c"".""name"" AS ""country"",AVG(""duration"") OVER (PARTITION BY ""c"".""name"") AS ""country_ave_time"",AVG(""duration"") OVER () AS ""total_time"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) AS ""t1"" WHERE ""country_ave_time"">""total_time"""
399,"WITH ""t"" AS (SELECT ""id"",""c"".""name"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTR(""phone_number"", 1, 3)=""country_code""), ""t2"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""t3"" AS (SELECT SUM(""duration"")/COUNT(1) AS ""global_dur"" FROM ""t2"") SELECT ""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") FROM ""t2"" JOIN ""t"" USING (""id"") GROUP BY 1 HAVING AVG(""duration"")>(SELECT SUM(""duration"")/COUNT(1) AS ""global_dur"" FROM ""t2"")) AS ""t4"""
400,"WITH ""t"" AS (SELECT ""p"".""id"" AS ""id"",LEFT(""p"".""phone_number"", 3) AS ""ctry_code"",""c"".""name"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""t2"" AS (SELECT ""t"".""name"" AS ""name"",""ctry_code"",SUM(CASE WHEN ""c"".""caller_id""=""id"" OR ""c"".""callee_id""=""id"" THEN ""duration"" END)/COUNT(1) AS ""ctry"" FROM ""t"" JOIN ""calls"" AS ""c"" ON ""c"".""caller_id""=""id"" OR ""c"".""callee_id""=""id"" GROUP BY ""t"".""ctry_code"") SELECT ""name"" AS ""country"" FROM ""t2"" WHERE (SELECT AVG(""duration"") FROM ""calls"")<""ctry"""
401,"WITH ""c1"" AS (SELECT SUM(""duration"")/COUNT(1) AS ""global_avg"" FROM ""Calls""), ""c2"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country_name"",SUM(""ca"".""duration"") AS ""call_duration"",COUNT(1) AS ""cnt"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" GROUP BY ""p"".""id"",""c"".""name"" UNION ALL SELECT ""p"".""id"",""c"".""name"" AS ""country_name"",SUM(""ca"".""duration"") AS ""call_duration"",COUNT(1) AS ""cnt"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") JOIN ""calls"" AS ""ca"" ON ""p"".""id""=""ca"".""callee_id"" GROUP BY ""p"".""id"",""c"".""name"") SELECT ""country_name"" AS ""country"" FROM ""c2"" GROUP BY ""country_name"" HAVING SUM(""call_duration"")/SUM(""cnt"")>(SELECT ""global_avg"" FROM ""c1"")"
402,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON LEFT(""p"".""phone_number"", 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
403,"WITH ""tmp"" AS (SELECT ""b"".""name"",SUM(""c"".""duration"") AS ""p_sum"",COUNT(""c"".""caller_id"") AS ""counts"" FROM (""Person"" AS ""a"" JOIN ""Country"" AS ""b"" ON SUBSTR(""a"".""phone_number"", 1, 3)=""b"".""country_code"") JOIN ""Calls"" AS ""c"" ON ""c"".""caller_id""=""a"".""id"" OR ""c"".""callee_id""=""a"".""id"" GROUP BY ""b"".""name"") SELECT ""name"" AS ""country"" FROM ""tmp"" GROUP BY ""name"" HAVING SUM(""p_sum"")/SUM(""counts"")>(SELECT AVG(""duration"") FROM ""Calls"")"
404,"SELECT DISTINCT ""country"" FROM (SELECT ""c"".""name"" AS ""country"",""ca"".""duration"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""con_avg"",AVG(""ca"".""duration"") OVER () AS ""total_avg"" FROM (""person"" AS ""p"" LEFT JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""calls"" AS ""ca"" ON ""p"".""id""=""ca"".""caller_id"" OR ""p"".""id""=""ca"".""callee_id"") AS ""a"" WHERE ""con_avg"">""total_avg"""
405,"SELECT ""drv"".""country_name"" AS ""country"" FROM (SELECT ""p"".""name"",""p"".""id"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c1"".""name"" AS ""country_name"",""c"".""caller_id"",""c"".""callee_id"",""c"".""duration"" FROM (""person"" AS ""p"" JOIN ""calls"" AS ""c"" ON ""c"".""caller_id""=""p"".""id"" OR ""c"".""callee_id""=""p"".""id"") JOIN ""country"" AS ""c1"" ON ""c1"".""country_code""=LEFT(""p"".""phone_number"", 3)) AS ""drv"" GROUP BY ""country_name"" HAVING ROUND(SUM(""duration"")/COUNT(""id""), 5)>(SELECT (SUM(""duration"")*2)/(COUNT(""caller_id"")*2) AS ""avg_call"" FROM ""calls"")"
406,"WITH ""total_call"" AS (SELECT ""caller_id"" AS ""call_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""call_id"",""duration"" FROM ""calls""), ""person_country"" AS (SELECT ""p"".""id"",LEFT(""p"".""phone_number"", 3) AS ""country_code"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" LEFT JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""d"" AS (SELECT ""call_id"",""duration"",""country"",AVG(""duration"") AS ""avg_d"" FROM ""total_call"" AS ""c"" LEFT JOIN ""person_country"" AS ""p"" ON ""c"".""call_id""=""p"".""id"" GROUP BY ""country"") SELECT ""country"" FROM ""d"" WHERE ""avg_d"">(SELECT SUM(""duration"")/(SELECT COUNT(""caller_id"") FROM ""calls"") FROM ""calls"")"
407,"SELECT DISTINCT ""name"" AS ""country"" FROM (SELECT ""Country"".""name"",AVG(""duration"") OVER (PARTITION BY ""Country"".""name"") AS ""avg_duration"",AVG(""duration"") OVER () AS ""global_avg"" FROM (""Person"" JOIN ""Calls"" ON ""Person"".""id""=""Calls"".""caller_id"" OR ""Person"".""id""=""Calls"".""callee_id"") JOIN ""Country"" ON LEFT(""phone_number"", 3)=""country_code"") AS ""sub"" WHERE ""avg_duration"">""global_avg"""
408,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
409,"WITH ""x"" AS (SELECT ""p"".""id"",""c"".""name"" AS ""country"" FROM ""person"" AS ""p"" JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""y"" AS (SELECT ""c"".""duration"",""x1"".""country"" AS ""caller_country"",""x2"".""country"" AS ""callee_country"" FROM (""calls"" AS ""c"" JOIN ""x"" AS ""x1"" ON ""c"".""caller_id""=""x1"".""id"") JOIN ""x"" AS ""x2"" ON ""c"".""callee_id""=""x2"".""id""), ""z"" AS (SELECT ""caller_country"" AS ""country"",""duration"" FROM ""y"" UNION ALL SELECT ""callee_country"" AS ""country"",""duration"" FROM ""y"") SELECT ""country"" FROM ""z"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""z"")"
410,"WITH ""cte"" AS (SELECT AVG(""duration"") AS ""avg_duration"" FROM ""Calls"") SELECT ""c"".""name"" AS ""country"" FROM (""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON SUBSTRING(""phone_number"", 1, 3)=""c"".""country_code"") JOIN ""Calls"" AS ""l"" ON (""p"".""id""=""l"".""caller_id"" OR ""p"".""id""=""l"".""callee_id"") GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT ""avg_duration"" FROM ""cte"")"
411,"SELECT ""o"".""name"" AS ""country"" FROM (""Calls"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""p"".""id""=""c"".""caller_id"" OR ""p"".""id""=""callee_id"") JOIN ""Country"" AS ""o"" ON ""o"".""country_code""=LEFT(""p"".""phone_number"", 3) GROUP BY ""o"".""name"" HAVING AVG(""c"".""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
412,"SELECT ""c"".""name"" AS ""country"" FROM (""Country"" AS ""c"" JOIN ""Person"" AS ""p"" ON ""c"".""country_code""=LEFT(""p"".""phone_number"", 3)) JOIN ""Calls"" AS ""ca"" ON ""p"".""id""=""caller_id"" OR ""p"".""id""=""callee_id"" GROUP BY ""c"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") AS ""global"" FROM ""Calls"")"
413,"WITH ""cte"" AS (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") SELECT ""c"".""name"" AS ""country"" FROM (""cte"" AS ""c1"" JOIN ""person"" AS ""p"" ON ""c1"".""caller_id""=""p"".""id"") JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"" GROUP BY 1 HAVING AVG(""c1"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
414,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",AVG(""ca"".""duration"") OVER (PARTITION BY ""c"".""name"") AS ""avg_duration"",AVG(""ca"".""duration"") OVER () AS ""global_avg_duration"" FROM (""calls"" AS ""ca"" LEFT JOIN ""person"" AS ""p"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"") SELECT DISTINCT ""country"" FROM ""cte"" WHERE ""avg_duration"">""global_avg_duration"""
415,"WITH ""cte_ppl_ctry"" AS (SELECT ""id"",""p"".""name"" AS ""person"",""phone_number"",""c"".""name"" AS ""country"",""country_code"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code""), ""cte_final"" AS (SELECT ""country"" FROM ""Calls"" AS ""c"" JOIN ""cte_ppl_ctry"" AS ""pc"" ON ""c"".""caller_id""=""pc"".""id"" OR ""c"".""callee_id""=""pc"".""id"" GROUP BY 1 HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")) SELECT * FROM ""cte_final"""
416,"SELECT ""co"".""name"" AS ""country"" FROM (""person"" AS ""p"" JOIN ""country"" AS ""co"" ON SUBSTRING(""phone_number"", 1, 3)=""country_code"") JOIN ""calls"" AS ""c"" ON ""p"".""id"" IN (""c"".""caller_id"",""c"".""callee_id"") GROUP BY ""co"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
417,"WITH ""cte"" AS (SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""Calls"" JOIN ""Person"" ON ""id""=""caller_id"") JOIN ""Country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3) UNION ALL SELECT ""c"".""name"" AS ""country"",""duration"" FROM (""Calls"" JOIN ""Person"" ON ""id""=""callee_id"") JOIN ""Country"" AS ""c"" ON ""country_code""=LEFT(""phone_number"", 3)) SELECT ""country"" FROM ""cte"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""cte"")"
418,"WITH ""a"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""calls"") SELECT ""name"" AS ""country"" FROM (SELECT ""a"".""id"",""c"".""name"",""duration"" FROM (""a"" LEFT JOIN ""person"" AS ""p"" ON ""a"".""id""=""p"".""id"") LEFT JOIN ""country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") AS ""tmp"" GROUP BY ""name"" HAVING SUM(""duration"")/COUNT(""duration"")>(SELECT SUM(""duration"")/COUNT(""duration"") FROM ""a"")"
419,"WITH ""cte"" AS (SELECT LEFT(""phone_number"", 3) AS ""country_code"",AVG(""duration"") OVER (PARTITION BY LEFT(""phone_number"", 3)) AS ""country_avg"",AVG(""duration"") OVER () AS ""overall_avg"" FROM ""person"" AS ""p"" JOIN (SELECT ""caller_id"",""duration"" FROM ""calls"" UNION ALL SELECT ""callee_id"",""duration"" FROM ""calls"") AS ""c"" ON ""p"".""id""=""c"".""caller_id"") SELECT DISTINCT ""name"" AS ""country"" FROM ""cte"" JOIN ""country"" ON ""cte"".""country_code""=""country"".""country_code"" WHERE ""country_avg"">""overall_avg"""
420,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Calls"".""caller_id""=""Person"".""id"" OR ""Calls"".""callee_id""=""Person"".""id"") JOIN ""Country"" ON ""Country"".""country_code""=LEFT(""Person"".""phone_number"", 3) GROUP BY ""Country"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
421,"WITH ""Person_tmp"" AS (SELECT ""id"",LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person""), ""Calls_tmp"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls"") SELECT ""name"" AS ""country"" FROM ""Country"" WHERE ""country_code"" IN (SELECT ""country_code"" FROM (SELECT ""c"".*,""country_code"",AVG(""duration"") AS ""avg_duration"" FROM ""Calls_tmp"" AS ""c"" LEFT JOIN ""Person_tmp"" AS ""p"" ON ""c"".""id""=""p"".""id"" GROUP BY ""country_code"") AS ""t"" WHERE ""avg_duration"">(SELECT AVG(""duration"") FROM ""Calls""))"
422,"WITH ""t1"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""t2"" AS (SELECT AVG(""duration"") AS ""globalAvg"" FROM ""Calls""), ""t3"" AS (SELECT ""c"".""name"",""t2"".""globalAvg"",AVG(""t1"".""duration"") AS ""countryAVg"" FROM (((""t1"") JOIN ""t2"") JOIN ""Person"" AS ""p"" ON ""t1"".""id""=""p"".""id"") JOIN ""Country"" AS ""c"" ON SUBSTRING(""p"".""phone_number"", 1, 3)=""c"".""country_code"" GROUP BY ""c"".""name"",""t2"".""globalAvg"") SELECT ""name"" AS ""country"" FROM ""t3"" WHERE ""countryAVg"">""globalAvg"""
423,"WITH ""cte"" AS (SELECT ""caller_id"" AS ""id"",""duration"" FROM ""Calls"" UNION ALL SELECT ""callee_id"" AS ""id"",""duration"" FROM ""Calls""), ""cte1"" AS (SELECT ""a"".""name"",AVG(""c"".""duration"") AS ""country_avg"" FROM (""Country"" AS ""a"" JOIN ""Person"" AS ""b"" ON ""a"".""country_code""=SUBSTRING(""b"".""phone_number"", 1, 3)) JOIN ""cte"" AS ""c"" ON ""b"".""id""=""c"".""id"" GROUP BY 1) SELECT ""name"" AS ""country"" FROM ""cte1"" WHERE ""country_avg"">(SELECT AVG(""duration"") FROM ""cte"")"
424,"SELECT ""Country"".""name"" AS ""country"" FROM (""Person"" JOIN ""Calls"" ON ""Person"".""id""=""Calls"".""caller_id"" OR ""Person"".""id""=""Calls"".""callee_id"") JOIN ""Country"" ON ""Country"".""country_code""=SUBSTRING(""Person"".""phone_number"", 1, 3) GROUP BY ""Country"".""country_code"" HAVING COALESCE(AVG(""Calls"".""duration""), 0)>(SELECT COALESCE(AVG(""duration""), 0) FROM ""Calls"")"
425,"WITH ""CTE"" AS (SELECT ""cou"".""country_code"",""cou"".""name"",""sub"".""duration"" FROM (SELECT ""c"".""caller_id"",""p"".""name"",""p"".""phone_number"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""caller_id""=""p"".""id"" UNION ALL SELECT ""c"".""callee_id"",""p"".""name"",""p"".""phone_number"",SUBSTR(""p"".""phone_number"", 1, 3) AS ""country_code"",""c"".""duration"" FROM ""Calls"" AS ""c"" LEFT JOIN ""Person"" AS ""p"" ON ""c"".""callee_id""=""p"".""id"") AS ""sub"" LEFT JOIN ""Country"" AS ""cou"" ON ""sub"".""country_code""=""cou"".""country_code"") SELECT ""sub2"".""name"" AS ""country"" FROM (SELECT ""name"",AVG(""duration"") AS ""avg_duration"" FROM ""CTE"" GROUP BY ""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""CTE"")) AS ""sub2"""
426,"WITH ""cte"" AS (SELECT ""p"".""id"",""p"".""name"" AS ""caller_name"",""p"".""phone_number"",""c"".""name"" AS ""country_name"",""c"".""country_code"" FROM ""Person"" AS ""p"" JOIN ""Country"" AS ""c"" ON LEFT(""p"".""phone_number"", 3)=""c"".""country_code"") SELECT ""country_name"" AS ""country"" FROM (SELECT ""country_name"",AVG(CASE WHEN ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" THEN ""duration"" ELSE 0 END) AS ""D"" FROM ""cte"" JOIN ""Calls"" ON ""cte"".""id""=""Calls"".""caller_id"" OR ""cte"".""id""=""Calls"".""callee_id"" GROUP BY ""country_name"" HAVING ""D"">(SELECT AVG(""duration"") FROM ""Calls"")) AS ""tmp"""
427,"WITH ""id_country"" AS (SELECT ""id"",""country"".""name"" FROM ""person"" JOIN ""country"" ON SUBSTR(""person"".""phone_number"", 1, 3)=""country"".""country_code""), ""country_duration"" AS (SELECT ""calls"".*,""t1"".""name"" AS ""caller_country"",""t2"".""name"" AS ""callee_country"" FROM (""calls"" JOIN ""id_country"" AS ""t1"" ON ""calls"".""caller_id""=""t1"".""id"") JOIN ""id_country"" AS ""t2"" ON ""calls"".""callee_id""=""t2"".""id""), ""melt_table"" AS (SELECT ""duration"",""caller_country"" AS ""country"" FROM ""country_duration"" UNION ALL SELECT ""duration"",""callee_country"" AS ""country"" FROM ""country_duration"") SELECT ""country"" FROM ""melt_table"" GROUP BY ""country"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""melt_table"")"
428,"WITH ""temp1"" AS (SELECT *,LEFT(""phone_number"", 3) AS ""country_code"" FROM ""Person"") SELECT ""c1"".""name"" AS ""country"" FROM (""Country"" AS ""c1"" LEFT JOIN ""temp1"" AS ""t1"" ON ""c1"".""country_code""=""t1"".""country_code"") LEFT JOIN ""calls"" AS ""c2"" ON ""t1"".""id""=""c2"".""caller_id"" OR ""t1"".""id""=""c2"".""callee_id"" GROUP BY ""c1"".""name"" HAVING AVG(""duration"")>(SELECT AVG(""duration"") FROM ""Calls"")"
429,"SELECT ""c"".""name"" AS ""country"" FROM (""country"" AS ""c"" LEFT JOIN ""person"" AS ""p"" ON ""c"".""country_code""=SUBSTRING(""p"".""phone_number"", 1, 3)) LEFT JOIN ""calls"" AS ""ca"" ON ""ca"".""caller_id""=""p"".""id"" OR ""ca"".""callee_id""=""id"" GROUP BY ""c"".""name"" HAVING AVG(""ca"".""duration"")>(SELECT AVG(""duration"") FROM ""calls"")"
