id,original query
1,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""ms"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""ms""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""ms"">=1000 AND ""ms""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""ms"">10000 THEN ROUND(""s"".""salary""*0.51, 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
2,"SELECT ""s1"".""company_id"",""employee_id"",""employee_name"",CAST(CASE WHEN ""max_salary"">10000 THEN ""salary""*(1-0.49) WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ""salary""*(1-0.24) ELSE ""salary"" END AS INTEGER) AS ""salary"" FROM ""Salaries"" AS ""s1"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""ms"" ON ""ms"".""company_id""=""s1"".""company_id"""
3,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""maxsalary"">10000 THEN ""salary""*0.51 WHEN ""maxsalary"">=1000 AND ""maxsalary""<=10000 THEN ""salary""*0.76 ELSE ""salary"" END, 0) AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxsalary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
4,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""t"".""tax_rate""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") AS ""t"" USING (""company_id"")"
5,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""max""<1000 THEN ""salary"" WHEN ""max"">=1000 AND ""max""<=10000 THEN 0.76*""salary"" ELSE 0.51*""salary"" END, 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
6,"WITH ""a"" AS (SELECT ""company_id"",MAX(""salary"") AS ""maxs"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""maxs""<1000 THEN ROUND(""s"".""salary"", 0) WHEN 1000<=""maxs"" AND ""maxs""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""maxs"">10000 THEN ROUND(""s"".""salary""*0.51, 0) END AS ""salary"" FROM (""salaries"" AS ""s"") JOIN ""a"" WHERE ""s"".""company_id""=""a"".""company_id"""
7,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
8,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN ""mxsa""<1000 THEN ROUND(""salary"", 0) WHEN ""mxsa"">=1000 AND ""mxsa""<=10000 THEN ROUND((""salary""*76)/100, 0) WHEN ""mxsa"">10000 THEN ROUND((""salary""*51)/100, 0) END) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""mxsa"" FROM ""salaries"") AS ""dudu"""
9,"SELECT ""Salaries"".""company_id"",""Salaries"".""employee_id"",""Salaries"".""employee_name"",ROUND(CASE WHEN ""salary_max""<1000 THEN ""Salaries"".""salary"" WHEN ""salary_max"">=1000 AND ""salary_max""<=10000 THEN ""Salaries"".""salary""*0.76 ELSE ""Salaries"".""salary""*0.51 END, 0) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""salary_max"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""Salaries"".""company_id""=""t"".""company_id"""
10,"SELECT ""e"".""company_id"",""e"".""employee_id"",""e"".""employee_name"",ROUND(""e"".""salary""-""c"".""tax_rate""*""e"".""salary"") AS ""salary"" FROM ""Salaries"" AS ""e"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY 1) AS ""c"" USING (""company_id"")"
11,"WITH ""NS"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")>10000 THEN 0.51 ELSE 0.76 END AS ""net_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""*""NS"".""net_rate"", 0) AS ""salary"" FROM ""Salaries"" AS ""S"" LEFT JOIN ""NS"" ON ""S"".""company_id""=""NS"".""company_id"""
12,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END AS ""tax"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax"")) AS ""salary"" FROM ""salaries"" JOIN ""cte"" USING (""company_id"")"
13,"WITH ""cte1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id""), ""cte2"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN 0.76 WHEN ""max_salary"">10000 THEN 0.51 END AS ""tax_rate"" FROM ""cte1"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(""a"".""salary""*""b"".""tax_rate"", 0) AS ""salary"" FROM ""Salaries"" AS ""a"" LEFT JOIN ""cte2"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
14,"WITH ""tmp"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id""), ""tmp2"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 0 WHEN 1000<=""max_salary"" AND ""max_salary""<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""tmp"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""tmp2"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
15,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""maxsalary""<1000 THEN ""salary"" WHEN ""maxsalary"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""maxsalary"">10000 THEN ""salary""*0.51 END, 0) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maxsalary"" FROM ""Salaries"") AS ""t1"""
16,"WITH ""main"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN 0.51*""salary"" ELSE 0.76*""salary"" END), 0) AS ""salary"" FROM ""main"""
17,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49)) ELSE ROUND(""salary""*(1-0.24)) END AS ""salary"" FROM (SELECT ""s"".*,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"" AS ""s"") AS ""sub"""
18,"WITH ""temp"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 24 WHEN MAX(""salary"")>10000 THEN 49 END AS ""tax"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""salaries"".""company_id"",""employee_id"",""employee_name"",ROUND((""salary""-((""salary""*""tax"")/100))) AS ""salary"" FROM ""salaries"" JOIN ""temp"" ON ""temp"".""company_id""=""salaries"".""company_id"""
19,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""s1"".""maxSalary""<1000 THEN ROUND(""s1"".""salary"") WHEN ""s1"".""maxSalary"" BETWEEN 1000 AND 10000 THEN ROUND(""s1"".""salary""-0.24*""s1"".""salary"") WHEN ""s1"".""maxSalary"">10000 THEN ROUND(""s1"".""salary""-0.49*""s1"".""salary"") END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maxSalary"" FROM ""salaries"") AS ""s1"""
20,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""effective_salary_rate"", 0) AS ""salary"" FROM ""Salaries"" LEFT JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1.0 WHEN MAX(""salary"")<10000 THEN 0.76 ELSE 0.51 END AS ""effective_salary_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""salary_rates"" ON ""Salaries"".""company_id""=""salary_rates"".""company_id"""
21,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-""salary""*(CASE WHEN ""max"" BETWEEN 1000 AND 10000 THEN 0.24 WHEN ""max"">10000 THEN 0.49 ELSE 0 END)) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max"" FROM ""salaries"" GROUP BY ""company_id"") AS ""max"" ON ""s"".""company_id""=""max"".""company_id"""
22,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""salary""-""salary""*0.24, 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""-0.49*""salary"", 0) END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""tbl"""
23,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49)) ELSE ROUND(""salary""*(1-0.24)) END AS ""salary"" FROM (SELECT ""s"".*,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"" AS ""s"") AS ""sub"""
24,"WITH ""t"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"" AS ""company_id"",""a"".""employee_id"" AS ""employee_id"",""a"".""employee_name"" AS ""employee_name"",FLOOR(ROUND(""a"".""salary""*""t"".""tax_rate"", 0)) AS ""salary"" FROM ""Salaries"" AS ""a"" LEFT JOIN ""t"" ON ""a"".""company_id""=""t"".""company_id"""
25,"WITH ""max_salary"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN 0.76 ELSE 0.51 END AS ""tax_rate"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""A"") SELECT ""A"".""company_id"",""A"".""employee_id"",""A"".""employee_name"",ROUND(""A"".""salary""*""B"".""tax_rate"") AS ""salary"" FROM ""Salaries"" AS ""A"" JOIN ""max_salary"" AS ""B"" ON ""A"".""company_id""=""B"".""company_id"""
26,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""num"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""num""<1000 THEN ""salary"" WHEN ""num"">1000 AND ""num""<10000 THEN ""salary""*(1-0.24) WHEN ""num"">10000 THEN ""salary""*(1-0.49) END, 0) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
27,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*""t1"".""net_tax"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.76 WHEN MAX(""salary"")>10000 THEN 0.51 END AS ""net_tax"" FROM ""Salaries"" GROUP BY 1) AS ""t1"" ON ""s"".""company_id""=""t1"".""company_id"""
28,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""tax_level""='I' THEN ""salary"" WHEN ""tax_level""='II' THEN ""salary""-0.24*(""salary"") ELSE ""salary""-(""salary"")*0.49 END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 'I' WHEN MAX(""salary"")<=10000 THEN 'II' ELSE 'III' END AS ""tax_level"" FROM ""salaries"" GROUP BY ""company_id"") AS ""c"" ON ""s"".""company_id""=""c"".""company_id"""
29,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(""salary""-""salary""*""rating""/100, 0) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN 49 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN 24 ELSE 0 END AS ""rating"" FROM ""Salaries"") AS ""a"""
30,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""*(CASE WHEN ""t"".""max_salary""<1000 THEN 1 WHEN ""t"".""max_salary"">=1000 AND ""t"".""max_salary""<=10000 THEN 0.76 ELSE 0.51 END)), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
31,"WITH ""temp"" AS (SELECT MAX(""salary"") AS ""max_salary"",""company_id"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""sal"".""company_id"",""sal"".""employee_id"",""sal"".""employee_name"",(CASE WHEN ""t"".""max_salary""<1000 THEN ""sal"".""salary"" WHEN ""t"".""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((""sal"".""salary""-(""sal"".""salary""*0.24)), 0) WHEN ""t"".""max_salary"">10000 THEN ROUND((""sal"".""salary""-(""sal"".""salary""*0.49)), 0) END) AS ""salary"" FROM ""Salaries"" AS ""sal"" JOIN ""temp"" AS ""t"" ON ""sal"".""company_id""=""t"".""company_id"""
32,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
33,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""t"".""msalary""<1000 THEN ""s"".""salary"" WHEN ""t"".""msalary"">=1000 AND ""t"".""msalary""<=10000 THEN ROUND(""s"".""salary""*(1-0.24), 0) WHEN ""t"".""msalary"">10000 THEN ROUND(""s"".""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""msalary"" FROM ""salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
34,"WITH ""temp"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND(""salary"", 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""*0.51, 0) ELSE ROUND(""salary""*0.76, 0) END AS ""salary"" FROM ""temp"""
35,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"")<1000 THEN 0 WHEN 1000<=MAX(""salary"")<=10000 THEN 0.24 END AS ""rate"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""c"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""rate""), 0) AS ""salary"" FROM ""cte"" AS ""c"" JOIN ""salaries"" AS ""s"" ON ""c"".""company_id""=""s"".""company_id"""
36,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"")>1000 THEN 0.24 ELSE 0 END AS ""tax"" FROM ""salaries"" GROUP BY 1) SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""cte"" AS ""c"" USING (""company_id"")"
37,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""maximum"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",""salary"" FROM ""salaries"" WHERE ""company_id"" IN (SELECT ""company_id"" FROM ""cte"" WHERE ""maximum""<1000) UNION SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*0.76, 0) FROM ""salaries"" WHERE ""company_id"" IN (SELECT ""company_id"" FROM ""cte"" WHERE ""maximum"">=1000 AND ""maximum""<=10000) UNION SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*0.51, 0) FROM ""salaries"" WHERE ""company_id"" IN (SELECT ""company_id"" FROM ""cte"" WHERE ""maximum"">=10000)"
38,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""ms"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""ms""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""ms"">=1000 AND ""ms""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""ms"">10000 THEN ROUND(""s"".""salary""*0.51, 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
39,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
40,"WITH ""CTE1"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",CASE WHEN ""b"".""max_salary"">10000 THEN ROUND(""salary""-""salary""*49/100, 0) WHEN ""b"".""max_salary"">=1000 THEN ROUND(""salary""-""salary""*24/100, 0) ELSE ""salary"" END AS ""salary"" FROM ""salaries"" AS ""a"" LEFT JOIN ""CTE1"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
41,"WITH ""t1"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN (0.76*""salary"") ELSE (0.51*""salary"") END) AS ""salary"" FROM ""t1"""
42,"SELECT ""salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 ELSE CASE WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") AS ""taxes"" ON ""salaries"".""company_id""=""taxes"".""company_id"""
43,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""*(1-0.24) ELSE ""salary""*(1-0.49) END) AS ""salary"" FROM ""salaries"""
44,"WITH ""T1"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""highest_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""tax_rate"", 0) AS ""salary"" FROM (SELECT *,CASE WHEN ""highest_salary""<1000 THEN 1 WHEN ""highest_salary"">=1000 AND ""highest_salary""<10000 THEN 0.76 WHEN ""highest_salary"">=10000 THEN 0.51 END AS ""tax_rate"" FROM ""T1"") AS ""sub"""
45,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",CASE WHEN ""a"".""max_sal""<1000 THEN ""a"".""salary"" WHEN ""a"".""max_sal"">=1000 AND ""a"".""max_sal""<10000 THEN ROUND(""a"".""salary""-""salary""*24/100) ELSE ROUND(""a"".""salary""-""salary""*49/100) END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_sal"" FROM ""salaries"") AS ""a"""
46,"WITH ""cte1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""cte1"".""salary""<1000 THEN ROUND(""s"".""salary""*1, 0) WHEN ""cte1"".""salary"">=1000 AND ""cte1"".""salary""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""cte1"".""salary"">10000 THEN ROUND(""s"".""salary""*0.51) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte1"" ON ""cte1"".""company_id""=""s"".""company_id"""
47,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",CASE WHEN ""b"".""maxSal"">=1000 AND ""b"".""maxSal""<=10000 THEN ROUND(""a"".""salary""-""a"".""salary""*0.24) WHEN ""b"".""maxSal"">10000 THEN ROUND(""a"".""salary""-""a"".""salary""*0.49) ELSE ROUND(""a"".""salary"") END AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxSal"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
48,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*0.51, 0) END AS ""salary"" FROM ""salaries"""
49,"WITH ""max_salary"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_sal""<1000 THEN ""salary"" WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""-((""salary""*24)/100) WHEN ""max_sal"">10000 THEN ""salary""-((""salary""*49)/100) END, 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""max_salary"" AS ""m"" ON ""s"".""company_id""=""m"".""company_id"""
50,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""company_id"" ORDER BY ""salary"" DESC) AS ""rnk"" FROM ""Salaries""), ""top_salary"" AS (SELECT * FROM ""cte"" WHERE ""rnk""=1), ""tax"" AS (SELECT DISTINCT ""company_id"",CASE WHEN ""salary""<1000 THEN 0 WHEN ""salary"" BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""top_salary"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""tax"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
51,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""s"".""salary""*(1-0.24), 0) WHEN ""max_salary"">10000 THEN ROUND(""s"".""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
52,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""ms"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""ms""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""ms"">=1000 AND ""ms""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""ms"">10000 THEN ROUND(""s"".""salary""*0.51, 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
53,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""a"".""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""a"".""salary""*0.51 ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" USING (""company_id"")"
54,"WITH ""tax_rate_by_salary"" AS (SELECT *,CASE WHEN ""salary""<1000 THEN 0.0 WHEN ""salary""<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" AS ""s""), ""tax_by_company"" AS (SELECT ""company_id"",MAX(""tax_rate"") AS ""tax"" FROM ""tax_rate_by_salary"" AS ""t"" GROUP BY 1) SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""t"".""tax""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""tax_by_company"" AS ""t"" ON ""t"".""company_id""=""s"".""company_id"""
55,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(0.51*""salary"") WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" ELSE ROUND(0.76*""salary"") END AS ""salary"" FROM ""Salaries"""
56,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-24/100)) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
57,"WITH ""temp1"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 0.0 WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN 0.24 WHEN ""max_salary"">10000 THEN 0.49 END AS ""tax"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""t"") SELECT ""Salaries"".""company_id"" AS ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-""salary""*""tax"") AS ""salary"" FROM ""Salaries"" JOIN ""temp1"" ON ""Salaries"".""company_id""=""temp1"".""company_id"""
58,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""-0.49*""salary"", 0) ELSE ROUND(""salary""-0.24*""salary"", 0) END) AS ""salary"" FROM ""Salaries"""
59,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
60,"WITH ""sub"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""Salaries"".""company_id"",""Salaries"".""employee_id"",""Salaries"".""employee_name"",(CASE WHEN ""sub"".""max_salary""<1000 THEN ROUND(""Salaries"".""salary"") WHEN ""sub"".""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""Salaries"".""salary""-""Salaries"".""salary""*0.24) ELSE ROUND(""Salaries"".""salary""-""Salaries"".""salary""*0.49) END) AS ""salary"" FROM ""Salaries"" JOIN ""sub"" ON ""Salaries"".""company_id""=""sub"".""company_id"""
61,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""tmp"".""tax_rt""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rt"" FROM ""salaries"" GROUP BY ""company_id"") AS ""tmp"" ON ""s"".""company_id""=""tmp"".""company_id"""
62,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""comp_sal"" FROM ""Salaries"" GROUP BY ""company_id""), ""cte2"" AS (SELECT ""s"".""company_id"",""employee_id"",""employee_name"",""salary"",""cte"".""comp_sal"" FROM ""Salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""comp_sal""<1000 THEN ""salary"" WHEN ""comp_sal"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""-""salary""*(24/100)) WHEN ""comp_sal"">10000 THEN ROUND(""salary""-""salary""*(49/100)) END AS ""salary"" FROM ""cte2"""
63,"WITH ""cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_sal"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CAST(CASE WHEN ""max_sal""<1000 THEN ""salary"" WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""-(0.24*""salary"") WHEN ""max_sal"">10000 THEN ""salary""-(0.49*""salary"") END AS DECIMAL(10)) AS ""salary"" FROM ""cte"""
64,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""comp_sal"" FROM ""Salaries"" GROUP BY ""company_id""), ""cte2"" AS (SELECT ""s"".""company_id"",""employee_id"",""employee_name"",""salary"",""cte"".""comp_sal"" FROM ""Salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""comp_sal""<1000 THEN ""salary"" WHEN ""comp_sal"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""-""salary""*(24/100)) WHEN ""comp_sal"">10000 THEN ROUND(""salary""-""salary""*(49/100)) END AS ""salary"" FROM ""cte2"""
65,"WITH ""CTE"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") AS ""MS"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""MS""<1000 THEN ""s"".""salary"" WHEN ""MS"" BETWEEN 1000 AND 10000 THEN ""s"".""salary""*(1-0.24) WHEN ""MS"">10000 THEN ""s"".""salary""*(1-0.49) END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""cte"" ON ""s"".""company_id""=""CTE"".""company_id"""
66,"SELECT ""a"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""a"".""highest""<1000 THEN ROUND(""s"".""salary"") WHEN ""a"".""highest"" BETWEEN 1000 AND 10000 THEN ROUND(""s"".""salary""-(24/100)*""s"".""salary"") WHEN ""a"".""highest"">10000 THEN ROUND(""s"".""salary""-(49/100)*""s"".""salary"") END AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""highest"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""a"" ON ""s"".""company_id""=""a"".""company_id"""
67,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""salary""*(1-0.24)) ELSE ROUND(""salary""*(1-0.49)) END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""TBL"""
68,"SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",CASE WHEN ""tab"".""maxSalary""<1000 THEN ROUND(""s1"".""salary"") WHEN ""tab"".""maxSalary"">=1000 AND ""tab"".""maxSalary""<10000 THEN ROUND(0.76*""s1"".""salary"") ELSE ROUND(0.51*""s1"".""salary"") END AS ""salary"" FROM ""Salaries"" AS ""s1"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxSalary"" FROM ""salaries"" GROUP BY ""company_id"") AS ""tab"" ON ""tab"".""company_id""=""s1"".""company_id"""
69,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"""
70,"WITH ""CompanyMaxSalaries"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id""), ""CompanyTax"" AS (SELECT ""company_id"",(CASE WHEN ""max_salary"">10000 THEN 0.49 WHEN ""max_salary"">1000 THEN 0.24 ELSE 0 END) AS ""tax_percent"" FROM ""CompanyMaxSalaries""), ""EmployeePaycheckAfterTax"" AS (SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""*(1-""C"".""tax_percent""), 0) AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN ""CompanyTax"" AS ""C"" ON ""S"".""company_id""=""C"".""company_id"") SELECT * FROM ""EmployeePaycheckAfterTax"""
71,"WITH ""subtable"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries""), ""subtable2"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",CASE WHEN ""max_salary"">10000 THEN 0.49 WHEN ""max_salary"">=1000 THEN 0.24 ELSE 0 END AS ""tax_rate"" FROM ""subtable"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate""), 0) AS ""salary"" FROM ""subtable2"""
72,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((1-0.49)*""salary"", 0) ELSE ROUND((1-0.24)*""salary"", 0) END AS ""salary"" FROM ""Salaries"""
73,"WITH ""t1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_comp"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""t1"".""max_comp""<1000 THEN ""s"".""salary"" WHEN (""t1"".""max_comp"">=1000 AND ""t1"".""max_comp""<=10000) THEN ""s"".""salary""-0.24*""s"".""salary"" WHEN ""t1"".""max_comp"">10000 THEN ""s"".""salary""-0.49*""s"".""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""t1"" ON ""s"".""company_id""=""t1"".""company_id"""
74,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""sal"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""cte"".""sal"">10000 THEN ""salary""-(0.49*""salary"") WHEN ""cte"".""sal""<1000 THEN ""salary"" ELSE ""salary""-(0.24*""salary"") END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
75,"WITH ""t"" AS (SELECT CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<10000 THEN 0.24 ELSE 0.49 END AS ""rate"",""company_id"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""t"" ON ""s"".""company_id""=""t"".""company_id"""
76,"SELECT ""x"".""company_id"",""x"".""employee_id"",""x"".""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((1-0.24)*""salary"") ELSE ROUND((1-0.49)*""salary"") END AS ""salary"" FROM ""Salaries"" AS ""x"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""y"" ON ""x"".""company_id""=""y"".""company_id"""
77,"WITH ""t1"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""t2"".""company_id"",""t2"".""employee_id"",""t2"".""employee_name"",ROUND(""t2"".""salary""-""t1"".""rate""*""t2"".""salary"", 0) AS ""salary"" FROM ""Salaries"" AS ""t2"" LEFT JOIN ""t1"" ON ""t2"".""company_id""=""t1"".""company_id"""
78,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 ELSE CASE WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""taxes"" ON ""Salaries"".""company_id""=""taxes"".""company_id"""
79,"WITH ""tmp"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ""salary""-""salary""*(0.49) ELSE ""salary""-""salary""*(0.24) END, 0) AS ""salary"" FROM ""tmp"""
80,"WITH ""tax_data"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""t"".""tax_rate""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""tax_data"" AS ""t"" USING (""company_id"")"
81,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0.00 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""cte"" ON ""s"".""company_id""=""cte"".""company_id"""
82,"WITH ""max_salaries"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""c"".""company_id"",""c"".""employee_id"",""c"".""employee_name"",ROUND((CASE WHEN ""ms"".""max_salary""<1000 THEN 1 WHEN ""ms"".""max_salary""<10000 THEN 0.76 ELSE 0.51 END)*""c"".""salary"") AS ""salary"" FROM ""salaries"" AS ""c"" JOIN ""max_salaries"" AS ""ms"" USING (""company_id"")"
83,"WITH ""T1"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY 1) SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""salaries"" JOIN ""T1"" USING (""company_id"")"
84,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
85,"SELECT ""B"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-(""salary""*(""tax""/100))) AS ""salary"" FROM (SELECT ""company_id"",CASE WHEN ""max_sal""<1000 THEN 0 WHEN ""max_sal"">=1000 AND 10000>=""max_sal"" THEN 24 ELSE 49 END AS ""tax"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""A"") AS ""B"" JOIN ""Salaries"" AS ""S"" ON ""B"".""company_id""=""S"".""company_id"""
86,"WITH ""t"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END) AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""-""s"".""salary""*""t"".""tax""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""t"" ON ""s"".""company_id""=""t"".""company_id"""
87,"WITH ""TaxRates"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0.0 WHEN MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""TaxRates"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
88,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-""salary""*""tax_rate"", 0) AS ""salary"" FROM (SELECT *,CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 0 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"") AS ""a"""
89,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""msal""<1000 THEN ""salary"" WHEN ""msal"" BETWEEN 1000 AND 10001 THEN ""salary""*(1-0.24) WHEN ""msal"">10000 THEN ""salary""*(1-0.49) END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""msal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""a"" ON ""s"".""company_id""=""a"".""company_id"""
90,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 ELSE CASE WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""taxes"" ON ""Salaries"".""company_id""=""taxes"".""company_id"""
91,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"" GROUP BY 1,2,3"
92,"WITH ""tax_rate"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END AS ""rate"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""rate"") AS ""salary"" FROM ""salaries"" JOIN ""tax_rate"" USING (""company_id"")"
93,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""sal"" FROM ""salaries"" GROUP BY 1) SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""sal""<1000 THEN ""salary"" WHEN ""sal"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) ELSE ROUND(""salary""*0.51) END AS ""salary"" FROM ""salaries"" LEFT JOIN ""cte"" AS ""c"" USING (""company_id"")"
94,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""t"".""msalary""<1000 THEN ""s"".""salary"" WHEN ""t"".""msalary"">=1000 AND ""t"".""msalary""<=10000 THEN ""s"".""salary""*0.76 ELSE ""s"".""salary""*0.51 END, 0) AS ""salary"" FROM (""Salaries"" AS ""s"") JOIN (SELECT ""company_id"",MAX(""salary"") AS ""msalary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" WHERE ""s"".""company_id""=""t"".""company_id"""
95,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
96,"WITH ""cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND((""salary""), 0) WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((""salary""-""salary""*0.24), 0) WHEN ""max_salary"">10000 THEN ROUND((""salary""-""salary""*0.49), 0) END AS ""salary"" FROM ""cte"""
97,"SELECT ""t1"".""company_id"",""t1"".""employee_id"",""t1"".""employee_name"",CASE WHEN ""t1"".""maximum"" BETWEEN 1000 AND 10000 THEN ROUND(0.76*""t1"".""salary"") WHEN ""t1"".""maximum"">10000 THEN ROUND(0.51*""t1"".""salary"") ELSE ""t1"".""salary"" END AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maximum"" FROM ""salaries"") AS ""t1"""
98,"SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""*(1-""T"".""tax_rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""S"" LEFT JOIN (SELECT ""company_id"",""employee_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=10000 THEN 0.49 ELSE 0.24 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""T"" ON ""S"".""company_id""=""T"".""company_id"""
99,"SELECT ""S1"".""company_id"",""S1"".""employee_id"",""S1"".""employee_name"",CASE WHEN ""S2"".""max_salary""<1000 THEN ROUND(""S1"".""salary"") WHEN ""S2"".""max_salary"">10000 THEN ROUND(""S1"".""salary""*0.51) ELSE ROUND(""S1"".""salary""*0.76) END AS ""salary"" FROM ""Salaries"" AS ""S1"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""S2"" ON ""S1"".""company_id""=""S2"".""company_id"""
100,"WITH ""company"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""Salaries"".""company_id"",""Salaries"".""employee_id"",""Salaries"".""employee_name"",ROUND(""Salaries"".""salary""*(1-""company"".""tax""), 0) AS ""salary"" FROM ""Salaries"" LEFT JOIN ""company"" ON ""Salaries"".""company_id""=""company"".""company_id"""
101,"SELECT ""S1"".""company_id"",""S1"".""employee_id"",""S1"".""employee_name"",ROUND((""S1"".""salary""-""S1"".""salary""*""rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""S1"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<=10000 AND MAX(""salary"")>=1000 THEN 0.24 ELSE 0.49 END AS ""rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""S2"" ON ""S1"".""company_id""=""S2"".""company_id"" ORDER BY 1,2"
102,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-0.49), 0) ELSE ROUND(""salary""*(1-0.24), 0) END) AS ""salary"" FROM ""salaries"""
103,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""m_sal""<1000 THEN ""s"".""salary"" WHEN ""m_sal"" BETWEEN 1000 AND 10000 THEN ""s"".""salary""-((24/100)*""s"".""salary"") WHEN ""m_sal"">=10000 THEN ""s"".""salary""-((49/100)*""s"".""salary"") END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""m_sal"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""a"" ON ""a"".""company_id""=""s"".""company_id"""
104,"WITH ""temp"" AS (SELECT ""company_id"",CASE WHEN MAX(""Salary"")<1000 THEN 1 WHEN MAX(""Salary"") BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS ""rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*""t"".""rate"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""temp"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
105,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"""
106,"WITH ""Max_salaries"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ""salary""*0.51 ELSE ""salary""*0.76 END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""Max_salaries"" AS ""m"" ON ""s"".""company_id""=""m"".""company_id"""
107,"WITH ""maxes"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""salaries"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary"">10000 THEN CAST(""salary""-(""salary""*0.49) AS INTEGER) WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN CAST(""salary""-(""salary""*0.24) AS INTEGER) ELSE ""salary"" END AS ""salary"" FROM ""salaries"" JOIN ""maxes"" ON ""salaries"".""company_id""=""maxes"".""company_id"""
108,"WITH ""tmp"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""tax"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax"")) AS ""salary"" FROM ""salaries"" NATURAL JOIN ""tmp"""
109,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 100 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<10000 THEN 76 ELSE 51 END)/100) AS ""salary"" FROM ""Salaries"""
110,"WITH ""t1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_s"" FROM ""salaries"" GROUP BY 1), ""t2"" AS (SELECT ""company_id"",CASE WHEN ""max_s""<1000 THEN 1 WHEN ""max_s""<=10000 THEN 0.76 ELSE 0.51 END AS ""tax"" FROM ""t1"") SELECT ""a"".""company_id"",""employee_id"",""employee_name"",ROUND(""a"".""salary""*""tax"") AS ""salary"" FROM ""salaries"" AS ""a"" JOIN ""t2"" ON ""a"".""company_id""=""t2"".""company_id"""
111,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary""<=10000 THEN 0.76 ELSE 0.51 END)*""salary"", 0) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"") AS ""t"""
112,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""s"".""salary""*(1-0.24), 0) WHEN ""max_salary"">10000 THEN ROUND(""s"".""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
113,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
114,"WITH ""max_salaries"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND(""salary""*(1-0), 0) WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""max_salaries"""
115,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND((CASE WHEN ""x"".""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_salary"">10000 THEN ""salary""*0.51 ELSE ""a"".""salary"" END)) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""a"".""company_id""=""x"".""company_id"""
116,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""a"".""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""a"".""salary""*0.51 ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""a"".""company_id""=""x"".""company_id"""
117,"WITH ""max_salary_calc"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",CASE WHEN ""M"".""max_salary""<1000 THEN ""salary"" WHEN ""M"".""max_salary"">=1000 AND ""M"".""max_salary""<=10000 THEN ROUND((""salary""-((""salary""*24)/100)), 0) ELSE ROUND((""salary""-((""salary""*49)/100)), 0) END AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN ""max_salary_calc"" AS ""M"" ON ""S"".""company_id""=""M"".""company_id"""
118,"WITH ""cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maxs"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""rate"")) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",CASE WHEN ""maxs""<1000 THEN 0 WHEN ""maxs"">10000 THEN 0.49 ELSE 0.24 END AS ""rate"" FROM ""cte"") AS ""a"""
119,"WITH ""base"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ""salary""*(1-0.49) ELSE ""salary""*(1-0.24) END, 0) AS ""salary"" FROM ""base"""
120,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
121,"WITH ""taxtable"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""taxrate"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""t"".""taxrate""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""taxtable"" AS ""t"" USING (""company_id"")"
122,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary""*1 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ""salary""*0.51 END, 0) AS ""salary"" FROM ""salaries"""
123,"SELECT DISTINCT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""Salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""Salary"" WHEN MAX(""Salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((""salary""-""salary""*0.49), 0) ELSE ROUND((""salary""-""salary""*0.24), 0) END AS ""salary"" FROM ""Salaries"" ORDER BY 1"
124,"SELECT ""salaries"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""maxsal""<1000 THEN ROUND(""salary"") WHEN ""maxsal"">=1000 AND ""maxsal""<=10000 THEN ROUND(""salary""-(""salary""*0.24)) ELSE ROUND(""salary""-""salary""*0.49) END AS ""salary"" FROM ""salaries"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxsal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""X"" ON ""X"".""company_id""=""salaries"".""company_id"""
125,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""*(1-0.24) ELSE ""salary""*(1-0.49) END, 0) AS ""salary"" FROM ""Salaries"""
126,"WITH ""cte_companysalary"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""-(""c"".""tax_rate""*""s"".""salary"")), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte_companysalary"" AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
127,"WITH ""mx"" AS (SELECT DISTINCT ""company_id"",MAX(""salary"") AS ""mx"" FROM ""salaries"" GROUP BY ""company_id""), ""tax"" AS (SELECT ""company_id"",(CASE WHEN ""mx""<1000 THEN 1 WHEN ""mx"">=1000 AND ""mx""<=10000 THEN 0.76 WHEN ""mx"">10000 THEN 0.51 END) AS ""tax"" FROM ""mx"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""tax""*""s"".""salary"", 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""tax"" AS ""t"" ON ""s"".""company_Id""=""t"".""company_Id"""
128,"SELECT ""a"".""company_id"",""employee_id"",""employee_name"",ROUND(""a"".""salary""*(1-""b"".""tax_rate""), 0) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
129,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""s"".""salary""*(1-""factor""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END) AS ""factor"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""temp"" ON ""s"".""company_id""=""temp"".""company_id"""
130,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*""t"".""tax"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END) AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
131,"SELECT ""salaries"".""company_id"",""salaries"".""employee_id"",""salaries"".""employee_name"",ROUND(CASE WHEN ""maxsalaries"".""max_salary""<1000 THEN ""salary"" WHEN ""maxsalaries"".""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*(1-0.24) ELSE ""salary""*(1-0.49) END, 0) AS ""salary"" FROM ""Salaries"" AS ""salaries"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""maxsalaries"" ON ""salaries"".""company_id""=""maxsalaries"".""company_id"""
132,"WITH ""maxtab"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""max_sal""<1000 THEN ""Salary"" WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN 0.76*""Salary"" ELSE 0.51*""Salary"" END, 0) AS ""salary"" FROM ""maxtab"" AS ""m"" JOIN ""Salaries"" AS ""s"" ON ""m"".""company_id""=""s"".""company_id"""
133,"WITH ""temp"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""company_highest"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""company_highest""<1000 THEN ""salary"" WHEN ""company_highest"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76) WHEN ""company_highest"">10000 THEN ROUND(""salary""*0.51) END AS ""salary"" FROM ""temp"""
134,"SELECT ""a"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""num""<1000 THEN ""salary"" WHEN ""num"">=1000 AND ""num""<=10000 THEN ""salary""*(1-0.24) WHEN ""num"">10000 THEN ""salary""*(1-0.49) END, 0) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""num"" FROM ""salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
135,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
136,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
137,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49), 0) ELSE ROUND(""salary""*(1-0.24), 0) END AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
138,"WITH ""cte_max_salary"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries""), ""cte_post_tax"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-(CASE WHEN ""max_salary""<1000 THEN 0.00 WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END)), 0) AS ""salary"" FROM ""cte_max_salary"") SELECT * FROM ""cte_post_tax"""
139,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""top_salary"" FROM ""Salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""top_salary""<1000 THEN ""salary"" WHEN ""top_salary"">=1000 AND ""top_salary""<=10000 THEN ROUND(""salary""-(""salary""*0.24)) WHEN ""top_salary"">10000 THEN ROUND(""salary""-(""salary""*0.49)) END AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""cte"" USING (""company_id"")"
140,"WITH ""MAX_SAL"" AS (SELECT ""company_id"",MAX(""salary"") AS ""sal"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""m"".""sal""<1000 THEN ""s"".""salary"" WHEN ""m"".""sal"" BETWEEN 1000 AND 10000 THEN (0.76)*""s"".""salary"" ELSE (0.51)*""s"".""salary"" END), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""MAX_SAL"" AS ""m"" ON ""s"".""company_id""=""m"".""company_id"" GROUP BY ""s"".""company_id"",""s"".""employee_id"""
141,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*0.51) END) AS ""salary"" FROM ""Salaries"""
142,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
143,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND((CASE WHEN ""a"".""max""<1000 THEN ""a"".""salary"" WHEN ""a"".""max"" BETWEEN 1000 AND 10000 THEN 0.76*""a"".""salary"" WHEN ""a"".""max"">10000 THEN 0.51*""a"".""salary"" END), 0) AS ""salary"" FROM (SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",""s"".""salary"",MAX(""s"".""salary"") OVER (PARTITION BY ""s"".""company_id"") AS ""max"" FROM ""Salaries"" AS ""s"") AS ""a"""
144,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""maxsalary"">10000 THEN ROUND((""salary""/100)*51, 0) WHEN ""maxsalary"" BETWEEN 1000 AND 100000 THEN ROUND((""salary""/100)*76, 0) WHEN ""maxsalary""<1000 THEN ""salary"" END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""SALARY"") OVER (PARTITION BY ""company_id"") AS ""maxsalary"" FROM ""Salaries"" GROUP BY ""company_id"",""employee_id"") AS ""m"""
145,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
146,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""max""<1000 THEN ""salary"" WHEN ""max"" BETWEEN 1000 AND 10000 THEN 0.76*""salary"" ELSE 0.51*""salary"" END, 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
147,"WITH ""base"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",CASE WHEN ""max_sal""<1000 THEN 0 WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_sal"" FROM ""salaries"") AS ""sub"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax"")) AS ""salary"" FROM ""base"""
148,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
149,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""max_sal""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""max_sal"">=1000 AND ""max_sal""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""max_sal"">10000 THEN ROUND(""s"".""salary""*0.51, 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
150,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=10000 THEN ""salary""*0.51 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 THEN ""salary""*0.76 ELSE ""salary"" END, 0) AS ""salary"" FROM ""Salaries"""
151,"WITH ""Max_salaries"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN 0.51*""salary"" ELSE 0.76*""salary"" END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""Max_salaries"" AS ""m"" ON ""s"".""company_id""=""m"".""company_id"""
152,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-""salary""*(24/100) ELSE ""salary""-""salary""*(49/100) END, 0) AS ""salary"" FROM ""Salaries"" ORDER BY ""employee_id"""
153,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",CASE WHEN ""b"".""sl""<1000 THEN ""salary"" WHEN ""b"".""sl"" BETWEEN 1000 AND 10000 THEN ROUND(0.76*""salary"") WHEN ""b"".""sl"">10000 THEN ROUND(0.51*""salary"") END AS ""salary"" FROM ""salaries"" AS ""a"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""sl"" FROM ""salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
154,"WITH ""t"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-""s"".""salary""*""t"".""tax_rate"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""t"" ON ""s"".""company_id""=""t"".""company_id"""
155,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""a"".""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN 0.51*""a"".""salary"" ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" USING (""company_id"")"
156,"WITH ""max_sal"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id""), ""tax_rate"" AS (SELECT ""company_id"",CASE WHEN ""max_salary"">10000 THEN 0.49 WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS ""tax_rate"" FROM ""max_sal"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""-(""s"".""salary""*""tax_rate"".""tax_rate"")), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""tax_rate"" ON ""s"".""company_id""=""tax_rate"".""company_id"""
157,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",(ROUND(CASE WHEN ""cte"".""max_salary""<1000 THEN ""S"".""salary"" WHEN ""cte"".""max_salary""<=10000 THEN ""S"".""salary""*0.76 ELSE ""S"".""salary""*0.51 END, 0)) AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN ""cte"" ON ""S"".""company_id""=""cte"".""company_id"""
158,"WITH ""cte1"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_emp_comp"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_emp_comp""<1000 THEN ""salary"" WHEN ""max_emp_comp"" BETWEEN 1000 AND 10000 THEN ""salary""-0.24*(""salary"") WHEN ""max_emp_comp"">10000 THEN ""salary""-0.49*""salary"" END, 0) AS ""salary"" FROM ""cte1"""
159,"WITH ""CTE"" AS (SELECT ""company_id"" AS ""ci"",MAX(""salary"") AS ""sal"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN ""c"".""sal""<1000 THEN ""salary"" WHEN ""c"".""sal"">=1000 AND ""c"".""sal""<=10000 THEN ROUND((""salary""-(""salary""*0.24)), 0) ELSE ROUND((""salary""-(""salary""*0.49)), 0) END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""CTE"" AS ""c"" ON ""s"".""company_id""=""c"".""ci"""
160,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
161,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
162,"WITH ""x"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maxi"" FROM ""salaries""), ""y"" AS (SELECT *,CASE WHEN ""maxi""<1000 THEN 0 WHEN ""maxi"">1000 AND ""maxi""<10000 THEN 24 WHEN ""maxi"">10000 THEN 49 END AS ""tax"" FROM ""x"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-(""salary""*""tax""/100), 0) AS ""salary"" FROM ""y"""
163,"WITH ""maxsal"" (""company_id"", ""msalary"") AS (SELECT ""company_id"",MAX(""salary"") FROM ""salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""msalary"">1000 AND ""msalary""<10000 THEN ROUND((""salary""*76)/100) WHEN ""msalary"">10000 THEN ROUND((""salary""*51)/100) ELSE ""salary"" END AS ""salary"" FROM (SELECT ""salaries"".""company_id"",""salaries"".""employee_id"",""salaries"".""employee_name"",""salaries"".""salary"",""maxsal"".""msalary"" FROM (""salaries"") JOIN ""maxsal"" WHERE ""maxsal"".""company_id""=""salaries"".""company_id"") AS ""t"""
164,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
165,"SELECT ""A"".""company_id"",""A"".""employee_id"",""A"".""employee_name"",ROUND(""A"".""SALARY""-(""A"".""SALARY""*CASE WHEN ""B"".""MAX_SALARY"">10000 THEN 0.49 WHEN ""B"".""MAX_SALARY"">1000 THEN 0.24 ELSE 0 END), 0) AS ""SALARY"" FROM ""SALARIES"" AS ""A"" JOIN (SELECT ""COMPANY_ID"",MAX(""SALARY"") AS ""MAX_SALARY"" FROM ""SALARIES"" GROUP BY ""COMPANY_ID"") AS ""B"" ON ""A"".""COMPANY_ID""=""B"".""COMPANY_ID"""
166,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"")>1000 THEN 0.24 ELSE 0 END AS ""tax"" FROM ""salaries"" GROUP BY 1) SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" AS ""c"" USING (""company_id"")"
167,"WITH ""salary_cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",MAX(""salary"") OVER (PARTITION BY ""company_id"" ORDER BY ""salary"" DESC) AS ""max_salary"" FROM ""Salaries"") SELECT DISTINCT * FROM (SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",(CASE WHEN ""a"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""a"".""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((""s"".""salary""-(""s"".""salary""*0.24)), 0) WHEN ""a"".""max_salary"">10000 THEN ROUND((""s"".""salary""-(""s"".""salary""*0.49)), 0) END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""salary_cte"" AS ""a"" ON ""s"".""company_id""=""a"".""company_id"") AS ""sub"""
168,"WITH ""t"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END AS ""trate"" FROM ""Salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-""s"".""salary""*""t"".""trate"", 0) AS ""salary"" FROM ""t"" JOIN ""Salaries"" AS ""s"" ON ""t"".""company_id""=""s"".""company_id"""
169,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((0.51*""salary""), 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>1000 THEN ROUND((0.76*""salary""), 0) ELSE ROUND(""salary"", 0) END AS ""salary"" FROM ""salaries"""
170,"WITH ""high"" AS (SELECT ""company_id"",MAX(""salary"") AS ""highest"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""highest""<1000 THEN (""salary""-""salary""*0) WHEN ""highest"">=1000 AND ""highest""<=10000 THEN (""salary""-""salary""*0.24) WHEN ""highest"">10000 THEN (""salary""-""salary""*0.49) ELSE NULL END, 0) AS ""salary"" FROM ""high"" AS ""h"" JOIN ""salaries"" AS ""s"" ON ""h"".""company_id""=""s"".""company_id"" GROUP BY 1,2"
171,"WITH ""t"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<=10000 AND MAX(""salary"")>=1000 THEN 0.24 ELSE 0.49 END AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-""salary""*""tax"", 0) AS ""salary"" FROM ""t"" JOIN ""salaries"" USING (""company_id"")"
172,"WITH ""cte"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END) AS ""tax_percent"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_percent"")) AS ""salary"" FROM ""Salaries"" JOIN ""cte"" USING (""company_id"")"
173,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""t"".""max_salary""<1000 THEN ROUND(""salary"", 0) WHEN ""t"".""max_salary"">=1000 AND ""t"".""max_salary""<=10000 THEN ROUND(""salary""-""salary""*0.24, 0) WHEN ""t"".""max_salary"">10000 THEN ROUND(""salary""-""salary""*0.49, 0) END AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
174,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""tax""<1000 THEN ""salary"" WHEN ""tax"">10000 THEN 0.51*""salary"" ELSE 0.76*""salary"" END)) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""tax"" FROM ""Salaries"") AS ""tmp"""
175,"WITH ""CALC"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>999 AND MAX(""salary"")<10001 THEN 24 WHEN MAX(""salary"")>10000 THEN 49 END AS ""tax_bracket"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND((""a"".""salary""-((""a"".""salary""*""b"".""tax_bracket"")/100)), 0) AS ""salary"" FROM ""Salaries"" AS ""A"" JOIN ""CALC"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
176,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND((""a"".""salary"")-(""a"".""salary""*""b"".""tax_bracket"")/100) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary""),CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 49 ELSE 24 END AS ""tax_bracket"" FROM ""salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
177,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
178,"SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",ROUND(CASE WHEN ""s2"".""max_salary""<1000 THEN ""salary"" WHEN ""s2"".""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 ELSE ""salary""*0.51 END, 0) AS ""salary"" FROM ""salaries"" AS ""s1"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY 1) AS ""s2"" ON ""s1"".""company_id""=""s2"".""company_id"""
179,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""c"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""c"".""max_salary"">=100 AND ""c"".""max_salary""<=10000 THEN ROUND(""s"".""salary""-(0.24*""s"".""salary""), 0) WHEN ""c"".""max_salary"">10000 THEN ROUND(""s"".""salary""-(0.49*""s"".""salary""), 0) END AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""cte"" AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
180,"WITH ""m_sal"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_sal"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_sal""<1000 THEN ""salary"" WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""-(""salary""*(24/100))) ELSE ROUND(""salary""-(""salary""*(49/100))) END AS ""salary"" FROM ""m_sal"""
181,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""-(0.24*""salary""), 0) ELSE ROUND(""salary""-(0.49*""salary""), 0) END AS ""salary"" FROM ""Salaries"""
182,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""sub"".""tax_rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""sub"" ON ""s"".""company_id""=""sub"".""company_id"""
183,"WITH ""temp1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max"" FROM ""Salaries"" GROUP BY ""company_id""), ""temp2"" AS (SELECT ""company_id"",(CASE WHEN ""max""<1000 THEN 0 WHEN ""max"">10000 THEN 0.49 ELSE 0.24 END) AS ""tax_rate"" FROM ""temp1"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""*(1-""t"".""tax_rate"")), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""temp2"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
184,"SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""s1"".""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""s1"".""salary""*(1-0.24), 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""s1"".""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"" AS ""s1"""
185,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""tax_rate""*""Salaries"".""salary"", 0) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<10000 THEN 0.76 ELSE 0.51 END) AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""temp"" ON ""Salaries"".""company_id""=""temp"".""company_id"""
186,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""Salaries"""
187,"SELECT ""a"".""company_id"",""employee_id"",""employee_name"",(CASE WHEN ""maxsalary""<1000 THEN ""salary"" WHEN ""maxsalary"">=1000 AND ""maxsalary""<=10000 THEN ROUND((""salary""-0.24*""salary""), 0) ELSE ROUND((""salary""-0.49*""salary""), 0) END) AS ""Salary"" FROM ""Salaries"" AS ""a"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxsalary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
188,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""temp"".""tax_rate""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN (SELECT DISTINCT ""company_id"",MAX(""salary""),CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""Salary"")>=1000 AND MAX(""salary"")<10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") AS ""temp"" ON ""temp"".""company_id""=""s"".""company_id"""
189,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""max""<1000 THEN ""salary"" WHEN ""max"">=1000 AND ""max""<=10000 THEN 0.76*""salary"" ELSE 0.51*""salary"" END, 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
190,"WITH ""final1"" AS (WITH ""final"" AS (WITH ""cte"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_of_company"" FROM ""Salaries"") SELECT *,CASE WHEN ""max_of_company""<1000 THEN 0 WHEN ""max_of_company"">=1000 AND ""max_of_company""<=10000 THEN 24 WHEN ""max_of_company"">10000 THEN 49 END AS ""tax_percent"" FROM ""cte"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((""salary""-(""tax_percent""/100)*""salary""), 2) AS ""amount"" FROM ""final"" ORDER BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN RIGHT(""amount"", 2)>=50 THEN CEIL(""amount"") WHEN RIGHT(""amount"", 2)<50 THEN FLOOR(""amount"") END AS ""salary"" FROM ""final1"""
191,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN 0.76*""a"".""salary"" WHEN ""x"".""max_sal"">10000 THEN 0.51*""a"".""salary"" ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""a"".""company_id""=""x"".""company_id"""
192,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY 1) AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
193,"WITH ""max_salaries"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY 1), ""tax_brackets"" AS (SELECT ""company_id"" AS ""cid"",CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary""<10000 THEN 0.76 ELSE 0.51 END AS ""tax_bracket"" FROM ""max_salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""tb"".""tax_bracket"", 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""tax_brackets"" AS ""tb"" ON ""s"".""company_id""=""tb"".""cid"""
194,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*""t"".""tax"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END) AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
195,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""ms"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""ms""<1000 THEN ROUND(""salary"", 0) WHEN 1000<=""ms"" AND ""ms""<=10000 THEN ROUND((0.76*""salary""), 0) WHEN ""ms"">10000 THEN ROUND((0.51*""salary""), 0) END AS ""salary"" FROM ""cte"" AS ""a"" JOIN ""Salaries"" AS ""s"" ON ""a"".""company_id""=""s"".""company_id"""
196,"WITH ""tmp"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ""salary""*(0.51) ELSE ""salary""*(0.76) END, 0) AS ""salary"" FROM ""tmp"""
197,"SELECT ""s"".""company_id"",""s"".""employee_id"",""employee_name"",ROUND(""salary""*""t"".""taxes"") AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END AS ""taxes"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t"" ON ""t"".""company_id""=""s"".""company_id"""
198,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"",""employee_id"" FROM ""Salaries""), ""c2"" AS (SELECT ""company_id"",""max_salary"",""employee_id"",CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN 1-0.24 ELSE 1-0.49 END AS ""rate"" FROM ""cte"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*""c"".""rate"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""c2"" AS ""c"" ON ""s"".""company_id""=""c"".""company_id"" AND ""s"".""employee_id""=""c"".""employee_id"""
199,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((1-0.24)*""salary"") WHEN ""max_salary"">10000 THEN ROUND((1-0.49)*""salary"") ELSE NULL END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""TMP"""
200,"SELECT ""a"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary"">10000 THEN ROUND(""salary""*0.51) ELSE CASE WHEN ""max_salary"">1000 THEN ROUND(""salary""*0.76) ELSE ""salary"" END END AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
201,"WITH ""TaxRate"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<10000 THEN 0.24 ELSE 0.49 END AS ""Rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""*(1-""TR"".""Rate"")) AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN ""TaxRate"" AS ""TR"" ON ""TR"".""company_id""=""S"".""company_id"""
202,"WITH ""tax"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(""salary"")>10000 THEN 0.51 END) AS ""tax_factor"" FROM ""Salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND((""tax_factor""*""salary""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""tax"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
203,"WITH ""company"" AS (SELECT *,MAX(""salary"") AS ""cmax_salary"" FROM ""Salaries"" GROUP BY ""company_id""), ""bracket"" AS (SELECT *,CASE WHEN ""cmax_salary""<1000 THEN 0 WHEN ""cmax_salary""<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_bracket"" FROM ""company"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-""tax_bracket""*""s"".""salary"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""bracket"" AS ""b"" ON ""s"".""company_id""=""b"".""company_id"""
204,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49)) ELSE ROUND(""salary""*(1-0.24)) END AS ""salary"" FROM (SELECT ""s"".*,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"" AS ""s"") AS ""sub"""
205,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ""salary""*(1-0.49) ELSE ""salary""*(1-0.24) END, 0) AS ""salary"" FROM ""salaries"""
206,"WITH ""t"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maxs"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""maxs""<1000 THEN ""salary"" WHEN ""maxs"">=1000 AND ""maxs""<=10000 THEN ""salary""*(1-0.24) ELSE ""salary""*(1-0.49) END, 0) AS ""salary"" FROM ""t"""
207,"WITH ""CTE"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"")<1000 THEN 0 WHEN 1000<MAX(""salary"") AND MAX(""salary"")<10000 THEN 0.24 ELSE NULL END) AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",ROUND(""s1"".""salary""*(1-""tax""), 0) AS ""salary"" FROM ""Salaries"" AS ""s1"" JOIN ""CTE"" ON ""s1"".""company_id""=""CTE"".""company_id"" ORDER BY ""company_id"",""employee_id"""
208,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 1*""salary"" WHEN 10000<MAX(""salary"") OVER (PARTITION BY ""company_id"") THEN ROUND(0.51*""salary"", 0) ELSE ROUND(0.76*""salary"", 0) END AS ""salary"" FROM ""salaries"""
209,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ""salary""*(1-0.49) ELSE ""salary""*(1-0.24) END)) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",MAX(""Salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""subquery"" ON ""Salaries"".""company_id""=""subquery"".""company_id"""
210,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""a"".""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""a"".""salary""*0.51 ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" USING (""company_id"")"
211,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""ratio"", 0) AS ""salary"" FROM (SELECT *,CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary"">10000 THEN 0.51 ELSE 0.76 END AS ""ratio"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""sub"" USING (""company_id"")) AS ""sub2"""
212,"SELECT ""salaries"".""company_id"",""salaries"".""employee_id"",""salaries"".""employee_name"",ROUND(""salary""*(1-""tax_rate""), 0) AS ""salary"" FROM ""salaries"" LEFT JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY 1) AS ""tax"" ON ""tax"".""company_id""=""salaries"".""company_id"""
213,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
214,"SELECT ""s"".""company_id"" AS ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""rate"") AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")>10000 THEN 1-0.49 ELSE 1-0.24 END AS ""rate"" FROM ""salaries"" GROUP BY 1) AS ""a"" ON ""s"".""company_id""=""a"".""company_id"""
215,"SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",ROUND(""s1"".""salary""*CASE WHEN ""s2"".""max_salary""<1000 THEN 1 WHEN ""s2"".""max_salary"">=1000 AND ""s2"".""max_salary""<=10000 THEN 0.76 ELSE 0.51 END, 0) AS ""salary"" FROM ""Salaries"" AS ""s1"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""s2"" ON ""s1"".""company_id""=""s2"".""company_id"""
216,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*(1-0.24) WHEN ""max_salary"">10000 THEN ""salary""*(0.51) END) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""t"""
217,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-(CASE WHEN ""MAX_Salary"">10000 THEN 0.49 WHEN ""MAX_Salary""<1000 THEN 0 ELSE 0.24 END))) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""MAX_Salary"" FROM ""Salaries"") AS ""s"""
218,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-0.49), 0) END) AS ""salary"" FROM ""Salaries"""
219,"WITH ""CTE1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""c"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""c"".""max_salary"">10000 THEN ROUND(""s"".""salary""*0.51, 0) ELSE ROUND(""s"".""salary""*0.76, 0) END AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""CTE1"" AS ""c"" ON ""s"".""company_id""=""c"".""company_id"""
220,"WITH ""tab"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN ""t"".""max_salary""<1000 THEN ROUND(""s"".""salary"", 0) WHEN ""t"".""max_salary"">=1000 AND ""t"".""max_salary""<=10000 THEN ROUND(""s"".""salary""*(1-0.24), 0) ELSE ROUND(""s"".""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""tab"" AS ""t"" ON ""t"".""company_id""=""s"".""company_id"""
221,"WITH ""a2"" AS (SELECT ""company_id"",MAX(""salary"") AS ""a"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""a""<1000 THEN ""salary"" WHEN ""a"" BETWEEN 1000 AND 10000 THEN ROUND(0.76*""salary"", 0) ELSE ROUND(0.51*""salary"", 0) END AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""a2"" ON ""a2"".""company_id""=""s"".""company_id"""
222,"WITH ""cte"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"",""employee_id"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND(""salary""-""salary""*0, 0) WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""salary""-""salary""*0.24, 0) WHEN ""max_salary"">=10000 THEN ROUND(""salary""-""salary""*0.49, 0) END AS ""salary"" FROM ""cte"""
223,"WITH ""cte"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""mxsalary"" FROM ""salaries"" ORDER BY ""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""mxsalary""<1000 THEN ""salary"" WHEN ""mxsalary""<10000 THEN 0.76*""salary"" ELSE 0.51*""salary"" END) AS ""salary"" FROM ""cte"""
224,"SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND((""S"".""salary""*(1-""T"".""rate"")), 0) AS ""salary"" FROM ""Salaries"" AS ""S"" LEFT JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END) AS ""rate"" FROM ""Salaries"" GROUP BY 1) AS ""T"" ON ""S"".""company_id""=""T"".""company_id"""
225,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 0 WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN 24 ELSE 49 END AS ""tax"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY 1) AS ""s1"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax""/100), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" AS ""c"" ON ""s"".""company_id""=""c"".""company_id"""
226,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""maxi""<1000 THEN ""salary"" WHEN ""maxi"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""maxi"">10000 THEN ""salary""*0.51 END), 0) AS ""salary"" FROM (SELECT ""s"".*,""b"".""maxi"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxi"" FROM ""salaries"" GROUP BY ""company_id"") AS ""b"" ON ""s"".""company_id""=""b"".""company_id"") AS ""c"" GROUP BY ""company_id"",""employee_id"",""employee_name"""
227,"WITH ""ma"" AS (SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",""s"".""salary"",MAX(""s"".""salary"") OVER (PARTITION BY ""s"".""company_id"") AS ""m1"" FROM ""Salaries"" AS ""s"") SELECT ""m"".""company_id"",""m"".""employee_id"",""m"".""employee_name"",CASE WHEN ""m"".""m1""<1000 THEN ROUND(""m"".""salary""-(0.00*""m"".""salary"")) WHEN ""m"".""m1"">=1000 AND ""m"".""m1""<=10000 THEN ROUND(""m"".""salary""-(0.24*""m"".""salary"")) WHEN ""m"".""m1"">=10000 THEN ROUND(""m"".""salary""-(0.49*""m"".""salary"")) END AS ""salary"" FROM ""ma"" AS ""m"""
228,"WITH ""tax_rate_per_company"" AS (SELECT ""temp"".""company_id"" AS ""company_id"",CASE WHEN ""temp"".""max_salary"">=1000 AND ""temp"".""max_salary""<=10000 THEN 24 WHEN ""temp"".""max_salary"">10000 THEN 49 ELSE 0 END AS ""tax_rate"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""temp"") SELECT ""temp"".""company_id"" AS ""company_id"",""temp"".""employee_id"" AS ""employee_id"",""temp"".""employee_name"" AS ""employee_name"",ROUND(""temp"".""salary""*(100-""temp"".""tax_rate"")/100) AS ""salary"" FROM (SELECT ""s"".""company_id"" AS ""company_id"",""s"".""employee_id"" AS ""employee_id"",""s"".""employee_name"" AS ""employee_name"",""s"".""salary"" AS ""salary"",""t"".""tax_rate"" AS ""tax_rate"" FROM ""Salaries"" AS ""s"" JOIN ""tax_rate_per_company"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"") AS ""temp"""
229,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN 0.76*""a"".""salary"" WHEN ""x"".""max_sal"">10000 THEN 0.51*""a"".""salary"" ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""a"".""company_id""=""x"".""company_id"""
230,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""max_salary"">10000 THEN ""salary""*0.51 ELSE ""salary"" END), 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""cte"".""company_id""=""s"".""company_id"""
231,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 24 ELSE 49 END AS ""tax_perc"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND((""s"".""salary""-(""c"".""tax_perc""/100)*(""s"".""salary"")), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""cte"" AS ""c"" ON ""s"".""company_id""=""c"".""company_id"""
232,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""-(""salary""*0.24)) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""-(""salary""*0.49)) END AS ""salary"" FROM ""Salaries"" AS ""s"""
233,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
234,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""company_max"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 0 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""Salaries"") AS ""t"""
235,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ""salary""*(1-0.24) WHEN ""max_salary"">10000 THEN ""salary""*(1-0.49) ELSE NULL END) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) AS ""t"" ON (""s"".""company_id""=""t"".""company_id"")"
236,"SELECT ""S"".""company_id"",""employee_id"",""employee_name"",ROUND(""S"".""salary""*""after_tax"") AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN (SELECT ""company_id"",CASE WHEN ""max_s""<1000 THEN 1 WHEN ""max_s"" BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS ""after_tax"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_s"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""T"") AS ""TS"" ON ""S"".""company_id""=""TS"".""company_id"""
237,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ""salary""-0.49*""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-0.24*""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" END, 0) AS ""salary"" FROM ""Salaries"" GROUP BY 1,2,3"
238,"SELECT ""c"".""company_id"",""c"".""employee_id"",""c"".""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""c"".""salary"" WHEN ""max_salary""<10001 THEN ROUND(""c"".""salary""*0.76, 0) ELSE ROUND(""c"".""salary""*0.51, 0) END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"") AS ""c"""
239,"WITH ""t"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax"" FROM ""salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""tax""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""t"" ON ""t"".""company_id""=""s"".""company_id"""
240,"WITH ""tax"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END) AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""s"".""salary""*(1-""t"".""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""tax"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
241,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""maxs""<1000 THEN ""salary"" WHEN ""maxs"">=1000 AND ""maxs""<=10000 THEN ""salary""*(1-0.24) ELSE ""salary""*(1-0.49) END) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxs"" FROM ""salaries"" GROUP BY 1) AS ""b"" ON ""s"".""company_id""=""b"".""company_id"""
242,"WITH ""max_salaries"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""ms"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""ms"".""max_salary"">10000 THEN ""s"".""salary""*0.51 ELSE ""s"".""salary""*0.76 END) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""max_salaries"" AS ""ms"" ON ""s"".""company_id""=""ms"".""company_id"""
243,"SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",CASE WHEN MAX(""S"".""salary"") OVER (PARTITION BY ""S"".""company_id"")<1000 THEN ""S"".""salary"" WHEN MAX(""S"".""salary"") OVER (PARTITION BY ""S"".""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""S"".""salary""-0.24*""S"".""salary"") WHEN MAX(""S"".""salary"") OVER (PARTITION BY ""S"".""company_id"")>10000 THEN ROUND(""S"".""salary""-0.49*""S"".""salary"") END AS ""salary"" FROM ""salaries"" AS ""S"""
244,"WITH ""ct_tax"" AS (SELECT CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")<10000 THEN 24 ELSE 49 END AS ""tax_rate"",""company_id"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""-(""s"".""salary""*""c"".""tax_rate""/100))) AS ""salary"" FROM (""Salaries"" AS ""s"") JOIN ""ct_tax"" AS ""c"" WHERE ""s"".""company_id""=""c"".""company_id"""
245,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""mx"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""mx""<1000 THEN 1*""salary"" WHEN ""mx""<=10000 AND ""mx"">=1000 THEN ROUND(0.76*""salary"", 0) WHEN ""mx"">10000 THEN ROUND(0.51*""salary"", 0) END AS ""salary"" FROM ""salaries"" AS ""a"" LEFT JOIN ""cte"" ON ""a"".""company_id""=""cte"".""company_id"""
246,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"", 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND((""salary""-""salary""*0.24), 0) ELSE ROUND((""salary""-""salary""*0.49), 0) END AS ""salary"" FROM ""salaries"""
247,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((1-0.49)*""salary"", 0) ELSE ROUND((1-0.24)*""salary"", 0) END AS ""salary"" FROM ""Salaries"""
248,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
249,"WITH ""CTE"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 END) AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""S1"".""company_id"",""S1"".""employee_id"",""S1"".""employee_name"",ROUND(""salary""*(1-""tax""), 0) AS ""salary"" FROM ""Salaries"" AS ""S1"" LEFT JOIN ""CTE"" ON ""S1"".""company_id""=""CTE"".""company_id"""
250,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 1*""salary"" WHEN 10000<MAX(""salary"") OVER (PARTITION BY ""company_id"") THEN ROUND(0.51*""salary"", 0) ELSE ROUND(0.76*""salary"", 0) END AS ""salary"" FROM ""salaries"""
251,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND((CASE WHEN ""a"".""maxx""<1000 THEN ""a"".""salary"" WHEN ""a"".""maxx""<=10000 AND ""a"".""maxx"">=1000 THEN ""a"".""salary""-""a"".""salary""*(24/100) ELSE ""a"".""salary""-""a"".""salary""*(49/100) END), 0) AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""maxx"" FROM ""Salaries"") AS ""a"""
252,"WITH ""cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"",""salary"" FROM ""salaries""), ""cte1"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",CASE WHEN ""max_salary""<1000 THEN 0 WHEN ""max_salary"">10000 THEN 0.49 ELSE 0.24 END AS ""tax_rate"" FROM ""cte"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""cte1"""
253,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""*(1-0.24) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ""salary""*(1-0.49) END), 0) AS ""salary"" FROM ""Salaries"""
254,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"", 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""-""salary""*0.24, 0) ELSE ROUND(""salary""-""salary""*0.49, 0) END AS ""salary"" FROM ""salaries"" AS ""s"""
255,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
256,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-""s"".""salary""*(CASE WHEN ""mx""<1000 THEN 0 WHEN ""mx"">1000 AND ""mx""<10000 THEN 0.24 WHEN ""mx"">10000 THEN 0.49 END), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""mx"" FROM ""Salaries"" GROUP BY 1) AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
257,"WITH ""tax_multiplier"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1.0 WHEN MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END AS ""mult"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*""t"".""mult"") AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""tax_multiplier"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
258,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
259,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""MS"" FROM ""Salaries"" GROUP BY ""company_id""), ""cte2"" AS (SELECT *,(CASE WHEN ""MS""<1000 THEN 0 WHEN ""MS"">=1000 AND ""MS""<=10000 THEN 0.24 ELSE 0.49 END) AS ""tax"" FROM ""cte""), ""cte3"" AS (SELECT * FROM ""Salaries"" LEFT JOIN ""cte2"" USING (""company_id"")) SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax""), 0) AS ""salary"" FROM ""cte3"""
260,"WITH ""src"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""salary""-""salary""*0.24, 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""-""salary""*0.49, 0) END AS ""salary"" FROM ""src"" ORDER BY ""company_id"""
261,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 ELSE CASE WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""taxes"" USING (""company_id"")"
262,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""ma""<1000 THEN ""salary"" WHEN ""ma"">10000 THEN ""salary""*(1-0.49) ELSE ""salary""*(1-0.24) END, 0) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""ma"" FROM ""salaries"") AS ""s"""
263,"WITH ""tax"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 0 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""Salaries"") SELECT DISTINCT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND((1-""tax_rate"")*""salary"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""tax"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
264,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")>=10000 THEN 0.49 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
265,"WITH ""tax"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<=1000 THEN 0 WHEN ""max_salary""<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""temp"") SELECT ""Salaries"".""company_id"",""Salaries"".""employee_id"",""Salaries"".""employee_name"",ROUND(""salary""*(1-""tax_rate""), 0) AS ""salary"" FROM ""Salaries"" LEFT JOIN ""tax"" ON ""Salaries"".""company_id""=""tax"".""company_id"""
266,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""-""salary""*0.24, 0) ELSE ROUND(""salary""-""salary""*0.49, 0) END) AS ""salary"" FROM ""salaries"""
267,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"""
268,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS ""tax_rates"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((""s"".""salary""-""s"".""salary""*""c"".""tax_rates""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""cte"" AS ""c"" ON ""s"".""company_id""=""c"".""company_id"""
269,"WITH ""a"" AS (SELECT *,CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"", 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND((""salary""-""salary""*0.24), 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((""salary""-""salary""*0.49), 0) END AS ""salary1"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",""salary1"" AS ""salary"" FROM ""a"""
270,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
271,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"") WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""-""salary""*0.24) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""-""salary""*0.49) END AS ""salary"" FROM ""Salaries"""
272,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate""), 0) AS ""salary"" FROM ""salaries"" AS ""t1"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") AS ""t2"" USING (""company_id"")"
273,"SELECT ""a"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""a"".""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ROUND(""a"".""salary""*(1-0.24), 0) WHEN ""max_salary"">10000 THEN ROUND(""a"".""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"" AS ""a"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
274,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-0.49), 0) ELSE ROUND(""salary""*(1-0.24), 0) END AS ""salary"" FROM ""Salaries"""
275,"WITH ""tax_rates"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0.0 WHEN MAX(""salary"")<10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""tax_rates"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
276,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN 0.51*""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 THEN 0.76*""salary"" ELSE ""salary"" END), 0) AS ""salary"" FROM ""Salaries"""
277,"WITH ""c"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 1-0.24 ELSE 1-0.49 END AS ""mul"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""salary""*""mul"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""c"" USING (""company_id"")"
278,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""-(""salary""*0.49)) ELSE ROUND(""salary""-(""salary""*0.24)) END AS ""salary"" FROM ""Salaries"""
279,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""-""salary""*0.24, 0) ELSE ROUND(""salary""-""salary""*0.49, 0) END) AS ""salary"" FROM ""salaries"""
280,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-(24/100))) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-(49/100))) END) AS ""salary"" FROM ""Salaries"""
281,"WITH ""CTE"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_sal""<1000 THEN ""salary"" WHEN ""max_sal"">=1000 AND ""max_sal""<=10000 THEN ""salary""-""salary""*0.24 ELSE ""salary""-""salary""*0.49 END) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""CTE"" AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
282,"WITH ""CTE"" AS (SELECT ""company_id"",CASE WHEN ""max_sal""<1000 THEN 0 WHEN ""max_sal"">=1000 AND ""max_sal""<=10000 THEN 24 ELSE 49 END AS ""tax_rate"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""xx"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-""salary""*""tax_rate""/100, 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""CTE"" AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
283,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"", 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND((1-24/100)*""salary"", 0) ELSE ROUND(((1-49/100)*""salary""), 0) END) AS ""salary"" FROM ""Salaries"""
284,"WITH ""t"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries""), ""new_t"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",(CASE WHEN ""max_salary""<1000 THEN 0 WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN 0.24 WHEN ""max_salary"">10000 THEN 0.49 END) AS ""tax_percent"" FROM ""t"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_percent""), 0) AS ""salary"" FROM ""new_t"""
285,"WITH ""temp"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND((CASE WHEN ""temp"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""temp"".""max_salary"" BETWEEN 1000 AND 10000 THEN ""s"".""salary""*(1-0.24) WHEN ""temp"".""max_salary"">10000 THEN ""s"".""salary""*(1-0.49) END), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""temp"" ON ""s"".""company_id""=""temp"".""company_id"""
286,"WITH ""cte"" AS (SELECT ""salaries"".""company_id"",""employee_id"",""employee_name"",""salary"",""max_salary"" FROM ""salaries"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") AS ""b"" ON ""salaries"".""company_id""=""b"".""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""max_salary"">10000 THEN ""salary""*0.51 END), 0) AS ""salary"" FROM ""cte"""
287,"WITH ""CTE1"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_s"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""max_s""<1000 THEN 1 WHEN ""max_s"">=1000 AND ""max_s""<=10000 THEN 1-0.24 ELSE 1-0.49 END)*""salary"", 0) AS ""salary"" FROM ""CTE1"""
288,"WITH ""comp_tax_rate"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0.0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE NULL END AS ""tax_percnt"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""ctr"".""tax_percnt"")) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""comp_tax_rate"" AS ""ctr"" ON ""ctr"".""company_id""=""s"".""company_id"""
289,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_sal""<1000 THEN ""salary"" WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN ROUND(0.76*""salary"") ELSE ROUND(0.51*""salary"") END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_sal"" FROM ""Salaries"") AS ""s"""
290,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""m""<1000 THEN ""salary"" WHEN ""m"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""-(""salary""*0.24), 0) WHEN ""m"">10000 THEN ROUND(""salary""-(""salary""*0.49), 0) END AS ""Salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""m"" FROM ""Salaries"") AS ""t1"""
291,"WITH ""t"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-(""s"".""salary""*""t"".""tax_rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""t"" ON ""s"".""company_id""=""t"".""company_id"""
292,"WITH ""tax_multiplier"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 1 WHEN MAX(""salary"")<=10000 THEN 0.76 ELSE 0.51 END AS ""mult"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(""a"".""salary""*""t"".""mult"") AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN ""tax_multiplier"" AS ""t"" ON ""a"".""company_id""=""t"".""company_id"""
293,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id""), ""demo"" AS (SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",""s"".""salary"",""cte"".""max_salary"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ""salary""-(0.24)*""salary"" ELSE ""salary""-(0.49)*""salary"" END AS ""new_salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""s"".""company_id""=""cte"".""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""new_salary"", 0) AS ""salary"" FROM ""demo"""
294,"WITH ""t1"" AS (SELECT ""s1"".*,""s2"".""max_salary"" FROM ""salaries"" AS ""s1"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""salaries"" GROUP BY ""company_id"") AS ""s2"" ON ""s1"".""company_id""=""s2"".""company_id"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ROUND(""salary"", 0) WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""*0.51, 0) END AS ""salary"" FROM ""t1"""
295,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"""
296,"SELECT ""s"".""company_id"" AS ""company_id"",""s"".""employee_id"" AS ""employee_id"",""s"".""employee_name"" AS ""employee_name"",CASE WHEN ""s"".""max_salary""<1000 THEN ""s"".""salary"" WHEN 1000<=""s"".""max_salary"" AND ""s"".""max_salary""<=10000 THEN ROUND(""s"".""salary""*0.76, 0) WHEN ""s"".""max_salary"">10000 THEN ROUND(""s"".""salary""*0.51, 0) END AS ""salary"" FROM (SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",""s1"".""salary"",""s2"".""max_salary"" FROM ""Salaries"" AS ""s1"" JOIN (SELECT ""company_id"",MAX(""Salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""s2"" ON ""s1"".""company_id""=""s2"".""company_id"") AS ""s"""
297,"WITH ""salary_cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",MAX(""salary"") OVER (PARTITION BY ""company_id"" ORDER BY ""salary"" DESC) AS ""max_salary"" FROM ""Salaries"") SELECT DISTINCT * FROM (SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",(CASE WHEN ""a"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""a"".""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((""s"".""salary""-(""s"".""salary""*0.24)), 0) WHEN ""a"".""max_salary"">10000 THEN ROUND((""s"".""salary""-(""s"".""salary""*0.49)), 0) END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""salary_cte"" AS ""a"" ON ""s"".""company_id""=""a"".""company_id"") AS ""sub"""
298,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*0.51) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76) END) AS ""salary"" FROM ""Salaries"""
299,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(0.51*""salary"", 0) ELSE ROUND(0.76*""salary"", 0) END AS ""salary"" FROM ""Salaries"""
300,"SELECT ""S"".""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49)) ELSE ROUND(""salary""*(1-0.24)) END AS ""salary"" FROM ""Salaries"" AS ""S"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""T"" ON ""S"".""company_id""=""T"".""company_id"""
301,"WITH ""max_sal"" AS (SELECT ""company_id"",MAX(""salary"") AS ""mx"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""m"".""mx""<1000 THEN ""s"".""salary"" WHEN ""m"".""mx"">=1000 AND ""m"".""mx""<=10000 THEN ""s"".""salary""-""s"".""salary""*0.24 WHEN ""m"".""mx"">10000 THEN ""s"".""salary""-""s"".""salary""*0.49 END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""max_sal"" AS ""m"" ON ""s"".""company_id""=""m"".""company_id"""
302,"WITH ""cte"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 0 WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN 0.24 WHEN ""max_salary"">10000 THEN 0.49 ELSE NULL END AS ""tax_rate"" FROM (SELECT DISTINCT ""company_id"",MAX(""salary"") OVER (PARTITION BY ""company_id"" ORDER BY ""salary"" DESC) AS ""max_salary"" FROM ""Salaries"") AS ""x"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-(""s"".""salary""*""tax_rate""), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""cte"" AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
303,"WITH ""tax_r"" AS (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN ((MAX(""salary"")>1000) AND (MAX(""salary"")<10000)) THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""-(""S"".""salary""*""tr"".""tax_rate"")) AS ""salary"" FROM ""salaries"" AS ""S"" LEFT JOIN ""tax_r"" AS ""tr"" ON ""S"".""company_id""=""tr"".""company_id"""
304,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN (""salary"") WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ""salary""-((""salary""*24)/100) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ""salary""-((""salary""*49)/100) END, 0) AS ""salary"" FROM ""salaries"" GROUP BY 1,2"
305,"SELECT ""A"".""company_id"",""B"".""employee_id"",""B"".""employee_name"",CASE WHEN ""A"".""max_salary""<1000 THEN ROUND(""B"".""salary"") WHEN ""A"".""max_salary"">=1000 AND ""A"".""max_salary""<=10000 THEN ROUND(""B"".""salary""-""B"".""salary""*0.24) ELSE ROUND(""B"".""salary""-""B"".""salary""*0.49) END AS ""salary"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""A"" JOIN ""Salaries"" AS ""B"" ON ""A"".""company_id""=""B"".""company_id"""
306,"SELECT ""S2"".""company_id"",""S2"".""employee_id"",""S2"".""employee_name"",ROUND((CASE WHEN ""S1"".""ms""<1000 THEN ""S2"".""salary"" WHEN ""S1"".""ms"">=1000 AND ""S1"".""ms""<=10000 THEN ""S2"".""salary""*(1-0.24) WHEN ""S1"".""ms"">10000 THEN ""S2"".""salary""*(1-0.49) END), 0) AS ""salary"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""ms"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""S1"" JOIN ""Salaries"" AS ""S2"" USING (""company_id"")"
307,"SELECT ""COMPANY_ID"",""EMPLOYEE_ID"",""EMPLOYEE_NAME"",CASE WHEN MAX(""SALARY"") OVER (PARTITION BY ""COMPANY_ID"")<1000 THEN ROUND(""SALARY"") WHEN MAX(""SALARY"") OVER (PARTITION BY ""COMPANY_ID"") BETWEEN 1000 AND 10000 THEN ROUND(0.76*""SALARY"") ELSE ROUND(0.51*""SALARY"") END AS ""SALARY"" FROM ""SALARIES"""
308,"WITH ""temp"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CASE WHEN (""t"".""max""<1000) THEN ROUND(""s"".""salary"", 0) WHEN (""t"".""max"">1000 AND ""t"".""max""<10000) THEN ROUND((""s"".""salary""-(0.24)*""s"".""salary""), 0) WHEN (""t"".""max"">10000) THEN ROUND((""s"".""salary""-(0.49)*""s"".""salary""), 0) END AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""temp"" AS ""t"" ON ""t"".""company_id""=""s"".""company_id"""
309,"SELECT ""Salaries"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""max_salary"">1000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""tmp"" ON ""Salaries"".""company_id""=""tmp"".""company_id"""
310,"WITH ""cte1"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id""), ""cte2"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 1 WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN 0.76 WHEN ""max_salary"">10000 THEN 0.51 END AS ""tax_rate"" FROM ""cte1"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(""a"".""salary""*""b"".""tax_rate"", 0) AS ""salary"" FROM ""Salaries"" AS ""a"" LEFT JOIN ""cte2"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
311,"SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""*(1-""tax_percent""), 0) AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END) AS ""tax_percent"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""T"" ON ""S"".""company_id""=""T"".""company_id"""
312,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24), 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""s"""
313,"WITH ""cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary_company"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary_company""<1000 THEN ROUND(""salary"", 0) WHEN ""max_salary_company"">=1000 AND ""max_salary_company""<10000 THEN ROUND(""salary""*(0.76), 0) WHEN ""max_salary_company"">=10000 THEN ROUND(""salary""*(0.51), 0) ELSE ""salary"" END AS ""salary"" FROM ""cte"""
314,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"", 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*0.51, 0) ELSE NULL END AS ""salary"" FROM ""Salaries"""
315,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",CAST(""s"".""salary""-(CASE WHEN ""cm"".""comp_max""<1000 THEN 0 WHEN ""cm"".""comp_max""<=10000 AND ""cm"".""comp_max"">=1000 THEN 0.24 ELSE 0.49 END)*""s"".""salary"" AS INTEGER) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""comp_max"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""cm"" ON ""s"".""company_id""=""cm"".""company_id"""
316,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">=1000 AND ""max_salary""<=10000 THEN ""salary""*0.76 WHEN ""max_salary"">10000 THEN ""salary""*0.51 END) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""t"""
317,"SELECT ""s1"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_percent""), 0) AS ""salary"" FROM ""Salaries"" AS ""s1"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END) AS ""tax_percent"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t1"" ON ""s1"".""company_id""=""t1"".""company_id"""
318,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""*0.51, 0) END AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"") AS ""a"""
319,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-""s"".""salary""*(CASE WHEN ""mx""<1000 THEN 0 WHEN ""mx"">1000 AND ""mx""<10000 THEN 0.24 WHEN ""mx"">10000 THEN 0.49 END), 0) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",MAX(""salary"") AS ""mx"" FROM ""Salaries"" GROUP BY 1) AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
320,"WITH ""salary_cte"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",MAX(""salary"") OVER (PARTITION BY ""company_id"" ORDER BY ""salary"" DESC) AS ""max_salary"" FROM ""Salaries"") SELECT DISTINCT * FROM (SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",(CASE WHEN ""a"".""max_salary""<1000 THEN ""s"".""salary"" WHEN ""a"".""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND((""s"".""salary""-(""s"".""salary""*0.24)), 0) WHEN ""a"".""max_salary"">10000 THEN ROUND((""s"".""salary""-(""s"".""salary""*0.49)), 0) END) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""salary_cte"" AS ""a"" ON ""s"".""company_id""=""a"".""company_id"") AS ""sub"""
321,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""-(""salary""*""tax_rate""), 0) AS ""salary"" FROM (SELECT *,CASE WHEN ""max_salary""<1000 THEN 0 WHEN ""max_salary"">1000 AND ""max_salary""<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""a"") AS ""b"""
322,"WITH ""tax"" AS (SELECT DISTINCT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(""a"".""salary""*(1-""b"".""tax"")) AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN ""tax"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
323,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"""
324,"WITH ""cte"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"" ORDER BY ""salary"" DESC) AS ""maxs"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND((CASE WHEN ""maxs""<1000 THEN ""salary"" WHEN (""maxs"">=1000 AND ""maxs""<=10000) THEN (""salary""-(""salary""*0.24)) WHEN (""maxs"">10000) THEN (""salary""-(0.49*""salary"")) END), 0) AS ""salary"" FROM ""cte"""
325,"SELECT ""Salaries"".""company_id"",""Salaries"".""employee_id"",""Salaries"".""employee_name"",ROUND((1-""tax_rate"")*""salary"") AS ""salary"" FROM ""Salaries"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0.0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END) AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""Tax"" ON ""Salaries"".""company_id""=""Tax"".""company_id"""
326,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49)) ELSE ROUND(""salary""*(1-0.24)) END AS ""salary"" FROM (SELECT ""s"".*,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"" AS ""s"") AS ""sub"""
327,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary""<10000 THEN ""salary""*0.76 ELSE ""salary""*0.51 END) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""s"""
328,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ""salary""-(""salary""*0.24) ELSE ""salary""-(""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"""
329,"WITH ""cte"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1) SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",CASE WHEN ""b"".""max_salary""<1000 THEN ROUND(""salary"", 0) WHEN ""b"".""max_salary"">=1000 AND ""b"".""max_salary""<=10000 THEN ROUND(""salary""-(0.24*""salary""), 0) WHEN ""b"".""max_salary"">10000 THEN ROUND(""salary""-(0.49*""salary""), 0) END AS ""Salary"" FROM ""Salaries"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
330,"WITH ""temp"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""company_highest"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""company_highest""<1000 THEN ""salary"" WHEN ""company_highest"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76) WHEN ""company_highest"">10000 THEN ROUND(""salary""*0.51) END AS ""salary"" FROM ""temp"""
331,"SELECT ""a"".""company_id"" AS ""company_id"",""a"".""employee_id"" AS ""employee_id"",""a"".""employee_name"" AS ""employee_name"",ROUND((CASE WHEN MAX(""b"".""salary"")>=10000 THEN ""a"".""salary""*0.51 WHEN MAX(""b"".""salary"")>=1000 THEN ""a"".""salary""*0.76 ELSE ""a"".""salary"" END), 0) AS ""salary"" FROM (""Salaries"" AS ""a"") JOIN ""Salaries"" AS ""b"" WHERE ""a"".""company_id""=""b"".""company_id"" AND ""a"".""salary""<=""b"".""salary"" GROUP BY ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"""
332,"WITH ""tmp"" AS (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_sal"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_sal""<1000 THEN ROUND(""salary"") WHEN ""max_sal"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24)) ELSE ROUND(""salary""*(1-0.49)) END AS ""salary"" FROM ""tmp"""
333,"WITH ""tax"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY 1), ""tax1"" AS (SELECT ""company_id"",CASE WHEN ""max_salary""<1000 THEN 0 WHEN ""max_salary""<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""tax"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN ""tax1"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
334,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ""salary""*(1-0.24) WHEN ""max_salary"">10000 THEN ""salary""*(1-0.49) END) AS ""salary"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""max_salary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""a"" JOIN ""Salaries"" AS ""s"" ON ""a"".""company_id""=""s"".""company_id"""
335,"SELECT ""s1"".""company_id"",""s1"".""employee_id"",""s1"".""employee_name"",ROUND(""s1"".""salary""*(1-""s2"".""tax_rate""), 0) AS ""salary"" FROM ""salaries"" AS ""s1"" LEFT JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY ""company_id"") AS ""s2"" ON ""s1"".""company_id""=""s2"".""company_id"""
336,"WITH ""cte"" AS (SELECT * FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""com_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""a"" USING (""company_id"")) SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""com_sal""<1000 THEN ""salary"" WHEN ""com_sal"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""cte"""
337,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""salaries"""
338,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 AND MAX(""salary"") OVER (PARTITION BY ""company_id"")>=1000 THEN ROUND(""salary""*(1-0.24), 0) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""Salaries"""
339,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_company_salary""<1000 THEN ""salary"" WHEN ""max_company_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) WHEN ""max_company_salary"">10000 THEN ROUND(""salary""*0.51, 0) END AS ""salary"" FROM (SELECT ""company_id"",""employee_id"",""employee_name"",""salary"",MAX(""salary"") OVER (PARTITION BY ""company_id"" ORDER BY ""company_id"") AS ""max_company_salary"" FROM ""Salaries"") AS ""a"""
340,"SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END, 0) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
341,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((1-0.49)*""salary"", 0) ELSE ROUND((1-0.24)*""salary"", 0) END AS ""Salary"" FROM ""Salaries"""
342,"WITH ""cte"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0.00 WHEN MAX(""salary"")>1000 AND MAX(""salary"")<10000 THEN 0.24 WHEN MAX(""salary"")>10000 THEN 0.49 END) AS ""tax"" FROM ""salaries"" GROUP BY 1) SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""*(1-""cte"".""tax"")) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN ""cte"" ON ""s"".""company_id""=""cte"".""company_id"""
343,"WITH ""company_max_salary"" AS (SELECT ""company_id"",MAX(""salary"") AS ""salary_max"" FROM ""Salaries"" GROUP BY ""company_id""), ""company_tax"" AS (SELECT ""company_id"",CASE WHEN ""salary_max""<1000 THEN 0 WHEN (""salary_max"">=1000) AND (""salary_max""<=10000) THEN 0.24 WHEN ""salary_max"">10000 THEN 0.49 END AS ""salary_tax"" FROM ""company_max_salary"") SELECT ""S"".""company_id"",""S"".""employee_id"",""S"".""employee_name"",ROUND(""S"".""salary""*(1-""C"".""salary_tax""), 0) AS ""salary"" FROM ""Salaries"" AS ""S"" JOIN ""company_tax"" AS ""C"" ON ""S"".""company_id""=""C"".""company_id"""
344,"WITH ""temp"" AS (SELECT *,CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 0 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<=10000 THEN 0.24 ELSE 0.49 END AS ""tax"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax""), 0) AS ""salary"" FROM ""temp"""
345,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""maxsalary"">10000 THEN ""salary""*0.51 WHEN ""maxsalary"">=1000 AND ""maxsalary""<=10000 THEN ""salary""*0.76 ELSE ""salary"" END, 0) AS ""salary"" FROM ""Salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""maxsalary"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""b"" USING (""company_id"")"
346,"WITH ""t"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")>10000 THEN 0.49 WHEN MAX(""salary"")<=10000 AND MAX(""salary"")>=1000 THEN 0.24 WHEN MAX(""salary"")<1000 THEN 0 END) AS ""tax"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""s"".""employee_id"",""s"".""employee_name"",ROUND(""s"".""salary""-""s"".""salary""*""t"".""tax"", 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN ""t"" ON ""s"".""company_id""=""t"".""company_id"""
347,"WITH ""CTE"" AS (SELECT ""company_id"",CASE WHEN MAX(""Salary"")<1000 THEN 0 WHEN MAX(""Salary"") BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(""Salary"")>10000 THEN 0.49 END AS ""Tax_Rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(""a"".""salary""-(""b"".""Tax_Rate""*""a"".""salary""), 0) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN ""CTE"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
348,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""b"".""salary""<1000 THEN ""a"".""salary"" WHEN ""b"".""salary""<=10000 THEN ""a"".""salary""*0.76 ELSE ""a"".""salary""*0.51 END, 0) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""salary"" FROM ""salaries"" GROUP BY 1) AS ""b"" ON ""a"".""company_id""=""b"".""company_id"""
349,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""*0.76, 0) ELSE ROUND(""salary""*0.51, 0) END AS ""salary"" FROM ""salaries"""
350,"SELECT ""s1"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_percent""), 0) AS ""salary"" FROM ""Salaries"" AS ""s1"" JOIN (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>10000 THEN 0.49 ELSE 0.24 END) AS ""tax_percent"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""t1"" ON ""s1"".""company_id""=""t1"".""company_id"""
351,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN 0.51 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN 1 END), 0) AS ""salary"" FROM ""Salaries"""
352,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""a"".""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN 0.51*""a"".""salary"" ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" USING (""company_id"")"
353,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_rate"")) AS ""salary"" FROM ""salaries"" AS ""s"" JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"") BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS ""tax_rate"" FROM ""salaries"" GROUP BY 1) AS ""c"" ON ""c"".""company_id""=""s"".""company_id"""
354,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((1-0.49)*""salary"", 0) ELSE ROUND((1-0.24)*""salary"", 0) END AS ""salary"" FROM ""Salaries"""
355,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN ""Max_Salary""<1000 THEN ""salary"" WHEN ""Max_Salary"">=1000 AND ""Max_Salary""<=10000 THEN ROUND(""salary""*(1-0.24), 0) ELSE ROUND(""salary""*(1-0.49), 0) END) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""Max_Salary"" FROM ""Salaries"") AS ""a"""
356,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""a"".""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""a"".""salary""*0.51 ELSE ""a"".""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""a"".""company_id""=""x"".""company_id"""
357,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ROUND(""salary"") WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN ROUND(""salary""-""salary""*0.24) WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND(""salary""-""salary""*0.49) END AS ""salary"" FROM ""Salaries"""
358,"WITH ""tmp"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"">10000 THEN ""salary""*(1-0.49) ELSE ""salary""*(1-0.24) END, 0) AS ""salary"" FROM ""tmp"""
359,"SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""x"".""max_sal"" BETWEEN 1000 AND 10000 THEN ""salary""*0.76 WHEN ""x"".""max_sal"">10000 THEN ""salary""*0.51 ELSE ""salary"" END) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") AS ""x"" ON ""a"".""company_id""=""x"".""company_id"""
360,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*""multiply"", 0) AS ""salary"" FROM ""Salaries"" AS ""s"" JOIN (SELECT ""company_id"",(CASE WHEN ""m""<1000 THEN 1 WHEN ""m"" BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END) AS ""multiply"" FROM (SELECT ""company_id"",MAX(""salary"") AS ""m"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""a"") AS ""b"" ON ""b"".""company_id""=""s"".""company_id"""
361,"WITH ""table1"" AS (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN ""max_salary""<1000 THEN ""salary"" WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24), 0) WHEN ""max_salary"">10000 THEN ROUND(""salary""*(1-0.49), 0) END AS ""salary"" FROM ""table1"""
362,"SELECT ""company_id"",""employee_id"",""employee_name"",(CASE WHEN ""max_salary""<1000 THEN ROUND(""salary"") WHEN ""max_salary"" BETWEEN 1000 AND 10000 THEN ROUND(""salary""*(1-0.24)) ELSE ROUND(""salary""*(1-0.49)) END) AS ""salary"" FROM (SELECT *,MAX(""salary"") OVER (PARTITION BY ""company_id"") AS ""max_salary"" FROM ""Salaries"") AS ""t"""
363,"SELECT ""company_id"",""employee_id"",""employee_name"",CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")>10000 THEN ROUND((1-0.49)*""salary"", 0) ELSE ROUND((1-0.24)*""salary"", 0) END AS ""salary"" FROM ""Salaries"""
364,"WITH ""tax"" AS (SELECT ""company_id"",(CASE WHEN MAX(""salary"")<1000 THEN 0 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END) AS ""tax_rate"" FROM ""Salaries"" GROUP BY ""company_id"") SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""s"".""salary""*(1-""t"".""tax_rate"")) AS ""salary"" FROM ""Salaries"" AS ""s"" LEFT JOIN ""tax"" AS ""t"" ON ""s"".""company_id""=""t"".""company_id"""
365,"WITH ""sal_max"" AS (SELECT ""company_id"",MAX(""salary"") AS ""max_sal"" FROM ""salaries"" GROUP BY ""company_id"") SELECT ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"",ROUND(CASE WHEN ""max_sal""<1000 THEN ""salary"" WHEN ""max_sal"">=1000 AND ""max_sal""<=10000 THEN (""salary""-""salary""*0.24) ELSE (""salary""-""salary""*0.49) END, 0) AS ""salary"" FROM ""salaries"" AS ""a"" JOIN ""sal_max"" AS ""b"" ON ""a"".""company_id""=""b"".""company_id"" GROUP BY ""a"".""company_id"",""a"".""employee_id"",""a"".""employee_name"""
366,"SELECT ""s"".""company_id"",""employee_id"",""employee_name"",ROUND(""salary""*(1-""tax_Rate""), 0) AS ""salary"" FROM ""salaries"" AS ""s"" LEFT JOIN (SELECT ""company_id"",CASE WHEN MAX(""salary"")<1000 THEN 0.00 WHEN MAX(""salary"")>=1000 AND MAX(""salary"")<=10000 THEN 0.24 ELSE 0.49 END AS ""tax_Rate"" FROM ""Salaries"" GROUP BY ""company_id"") AS ""x"" ON ""s"".""company_id""=""x"".""company_id"""
367,"SELECT ""company_id"",""employee_id"",""employee_name"",ROUND(CASE WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"")<1000 THEN ""salary"" WHEN MAX(""salary"") OVER (PARTITION BY ""company_id"") BETWEEN 1000 AND 10000 THEN (1-0.24)*""salary"" ELSE (1-0.49)*""salary"" END, 0) AS ""salary"" FROM ""Salaries"""
