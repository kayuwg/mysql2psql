id,original query
1,"WITH ""CTE"" AS (SELECT ""product_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"",""order_id"" FROM ""Orders""), ""cte2"" AS (SELECT * FROM ""CTE"" WHERE ""rk""=1) SELECT ""Products"".""product_name"",""cte2"".""product_id"",""cte2"".""order_id"",""cte2"".""order_date"" FROM ""cte2"" JOIN ""Products"" ON ""cte2"".""product_id""=""Products"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
2,"SELECT ""product_name"",""o"".""product_id"",""order_id"",""o"".""order_date"" FROM (""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""recent_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""t"" ON ""t"".""product_id""=""o"".""product_id"" AND ""order_date""=""recent_date"" ORDER BY ""p"".""product_name"",""o"".""product_id"",""order_id"""
3,"SELECT ""c1"".""product_name"",""c1"".""product_id"",""c1"".""order_id"",""c1"".""order_date"" FROM (SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""d_rank"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""c1"" WHERE ""c1"".""d_rank""=1 ORDER BY ""c1"".""product_name"",""c1"".""product_id"",""c1"".""order_id"""
4,"SELECT ""P"".""product_name"",""O"".""product_id"",""order_id"",""order_date"" FROM ""Products"" AS ""P"" JOIN ""Orders"" AS ""O"" ON ""P"".""product_id""=""O"".""product_id"" WHERE ROW(""O"".""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
5,"SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
6,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"",RANK() OVER (PARTITION BY ""a"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""t"" WHERE ""rnk""=1 ORDER BY 1,2,3"
7,"WITH ""most_recent"" AS (SELECT ""order_id"",""order_date"",""product_id"" FROM (SELECT ""order_id"",""order_date"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"") AS ""orders_ranked"" WHERE ""rn""=1) SELECT ""products"".""product_name"",""most_recent"".""product_id"",""most_recent"".""order_id"",""most_recent"".""order_date"" FROM ""most_recent"" LEFT JOIN ""products"" ON ""most_recent"".""product_id""=""products"".""product_id"" ORDER BY 1,2,3"
8,"WITH ""recent_orders"" AS (SELECT MAX(""order_date"") AS ""order_date"",""product_id"" FROM ""Orders"" AS ""o"" GROUP BY ""product_id"") SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""recent_orders"" AS ""ro"" JOIN ""Orders"" AS ""o"" ON ""ro"".""product_id""=""o"".""product_id"" AND ""ro"".""order_date""=""o"".""order_date"") JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""ro"".""product_id"" ORDER BY ""p"".""product_name"",""o"".""order_id"""
9,"SELECT ""inb"".""product_name"",""inb"".""product_id"",""ina"".""order_id"",""ina"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""r_number"" FROM ""Orders"") AS ""ina"", ""Products"" AS ""inb"" WHERE ""ina"".""r_number""=1 AND ""ina"".""product_id""=""inb"".""product_id"" ORDER BY ""inb"".""product_name"",""inb"".""product_id"",""ina"".""order_id"""
10,"WITH ""recent_orders"" AS (SELECT ""product_id"",""order_id"",""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rank_date"" FROM ""Orders"") AS ""rank_by_product"" WHERE ""rank_date""=1) SELECT ""p"".""product_name"",""r"".""product_id"",""r"".""order_id"",""r"".""order_date"" FROM ""recent_orders"" AS ""r"" JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" ORDER BY ""p"".""product_name"",""r"".""product_id"",""r"".""order_id"""
11,"WITH ""t1"" AS (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""my_rank"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""t1"" WHERE ""my_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
12,"SELECT ""p"".""product_name"" AS ""product_name"",""t1"".""product_id"" AS ""product_id"",""t1"".""order_id"" AS ""order_id"",""t1"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rank_order"" FROM ""Orders"" ORDER BY ""product_id"") AS ""t1"" LEFT JOIN ""Products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""t1"".""rank_order""=1 ORDER BY 1,2,3"
13,"WITH ""t"" AS (SELECT ""order_id"",""order_date"",""orders"".""product_id"",""product_name"",RANK() OVER (PARTITION BY ""orders"".""product_id"" ORDER BY ""order_date"" DESC) AS ""latest_order_date"" FROM ""orders"" LEFT JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""t"" WHERE ""latest_order_date""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
14,"SELECT ""p"".""product_name"",""r"".""product_id"",""r"".""order_id"",""r"".""order_date"" FROM (SELECT ""order_id"",""customer_id"",""product_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"") AS ""r"" JOIN ""products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""ranking""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
15,"SELECT ""product_name"",""t"".""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"") AS ""t"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""t"".""product_id"" WHERE ""r""=1 ORDER BY 1,2,3"
16,"WITH ""O"" AS (SELECT ""order_id"",""product_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""P"".""product_name"",""OD"".* FROM (SELECT ""product_id"",""order_id"",""order_date"" FROM ""O"" WHERE ""rnk""=1) AS ""OD"" JOIN ""products"" AS ""P"" ON ""P"".""product_id""=""Od"".""product_id"" ORDER BY ""P"".""product_name"",""OD"".""product_id"",""OD"".""order_id"""
17,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rk"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""t"" WHERE ""t"".""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
18,"SELECT ""p"".""product_name"",""O"".""product_id"",""O"".""order_id"",""O"".""order_date"" FROM ""Products"" AS ""p"" JOIN (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""recent_order"" FROM ""Orders"") AS ""O"" ON ""O"".""product_id""=""p"".""product_id"" WHERE ""O"".""recent_order""=1 ORDER BY ""p"".""product_name"",""O"".""product_id"",""O"".""order_id"""
19,"SELECT ""product_name"",""t"".""product_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_Date"" DESC) AS ""ranking"" FROM ""orders"") AS ""t"" JOIN ""products"" ON ""products"".""product_id""=""t"".""product_id"" WHERE ""ranking""=1 ORDER BY 1,2,3"
20,"WITH ""cte"" AS (SELECT ""product_id"",""order_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"",""order_date"" FROM ""Orders"") SELECT ""product_name"",""cte"".""product_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""products"" USING (""product_id"") WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
21,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""p"".""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) JOIN ""products"" AS ""p"" USING (""product_id"")) AS ""tmp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
22,"WITH ""cte"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""recentorder"" FROM ""orders"" GROUP BY ""product_id"") SELECT ""product_name"",""p"".""product_id"",""order_id"",""order_date"" FROM (""orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"")) JOIN ""cte"" USING (""product_id"") WHERE ""order_date""=""recentorder"" ORDER BY ""product_name"",""order_id"""
23,"SELECT ""Products"".""product_name"",""Products"".""product_id"",""Orders"".""order_id"",""Orders"".""order_date"" FROM ((SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""a"" LEFT JOIN ""Orders"" ON ""Orders"".""order_date""=""a"".""order_date"" AND ""Orders"".""product_id""=""a"".""product_id"") LEFT JOIN ""Products"" ON ""Products"".""product_id""=""Orders"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
24,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""P"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_name"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
25,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""max_date"" FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"""
26,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Products"" AS ""p"" RIGHT JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ROW(""p"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_Date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY 1,2,3"
27,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""products"" AS ""p"" JOIN ""orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""tmp"" WHERE ""tmp"".""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
28,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""products"" AS ""p"" JOIN (SELECT ""order_id"",""product_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rank_num"" FROM ""orders"") AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""rank_num""=1 ORDER BY ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"""
29,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Products"" AS ""p"" LEFT JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ROW(""p"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY 1,2,3"
30,"SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM ""Orders"" AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ROW(""a"".""product_id"",""a"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"""
31,"SELECT ""a"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""d1"".""order_id"",""d2"".""product_id"",""d1"".""order_date"",""d2"".""product_name"",RANK() OVER (PARTITION BY ""d1"".""product_id"" ORDER BY ""d1"".""order_date"" DESC) AS ""rank_order"" FROM ""Orders"" AS ""d1"" JOIN ""products"" AS ""d2"" ON ""d1"".""product_id""=""d2"".""product_id"") AS ""a"" WHERE ""a"".""rank_order""=1 ORDER BY ""a"".""product_name"",""a"".""product_id"",""a"".""order_id"""
32,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""P"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_name"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
33,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""o"".""product_id"",""p"".""product_name"",RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""a"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
34,"SELECT ""product_name"",""a"".""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",FIRST_VALUE(""order_date"") OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""most_recent"" FROM ""Orders"") AS ""a"" LEFT JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""order_date""=""most_recent"" ORDER BY 1,2,3"
35,"WITH ""most_recent_date"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""recent"" FROM ""Orders"" GROUP BY ""product_id"") SELECT ""p"".""product_name"",""m"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Products"" AS ""p"" JOIN ""most_recent_date"" AS ""m"" ON ""m"".""product_id""=""p"".""product_id"") JOIN ""Orders"" AS ""o"" ON ""o"".""order_date""=""m"".""recent"" AND ""o"".""product_id""=""m"".""product_id"" ORDER BY ""p"".""product_name"",""m"".""product_id"",""o"".""order_id"""
36,"SELECT ""a"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""latest_order_Date"" AS ""order_date"" FROM (SELECT ""p"".""product_id"",""p"".""product_name"",""o"".""order_id"",""o"".""order_date"",MAX(""o"".""order_date"") OVER (PARTITION BY ""p"".""product_id"") AS ""latest_order_Date"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""a"" WHERE ""a"".""order_date""=""a"".""latest_order_Date"" ORDER BY ""a"".""product_name"",""a"".""product_id"",""a"".""order_id"""
37,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""a"".""order_id"",""a"".""order_date"",""b"".""product_id"",""b"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""b"".""product_id"" ORDER BY ""a"".""order_date"" DESC) AS ""rnk"" FROM (""orders"" AS ""a"") JOIN ""products"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"") AS ""x"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
38,"SELECT ""T2"".""product_name"",""T2"".""product_id"",""T2"".""order_id"",""T2"".""order_date"" FROM (SELECT ""T1"".""product_name"",""T1"".""product_id"",""T1"".""order_id"",""T1"".""order_date"",RANK() OVER (PARTITION BY ""T1"".""product_id"" ORDER BY ""T1"".""order_date"" DESC) AS ""PRODUCT_ORDER_DATE_RANK"" FROM (SELECT ""P"".""product_name"",""P"".""product_id"",""O"".""order_id"",""O"".""order_date"" FROM ""Products"" AS ""P"" JOIN ""Orders"" AS ""O"" ON ""P"".""product_id""=""O"".""product_id"" GROUP BY 1,2,3,4) AS ""T1"") AS ""T2"" WHERE ""T2"".""PRODUCT_ORDER_DATE_RANK""=1 ORDER BY 1,2,3"
39,"SELECT ""pr"".""product_name"",""pr"".""product_id"",""abc"".""order_id"",""abc"".""order_date"" FROM ""products"" AS ""pr"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" ORDER BY ""product_id"") AS ""abc"" ON ""abc"".""product_id""=""pr"".""product_id"" WHERE ""abc"".""rnk""=1 ORDER BY 1,2,3"
40,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_id"",""p"".""product_name"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""t"" WHERE ""ranks""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
41,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""orders"".""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rank1"" FROM ""orders"" JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"") AS ""a"" WHERE ""rank1""=1 ORDER BY 1,2,3"
42,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Products"" AS ""p"" LEFT JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ROW(""p"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY 1,2,3"
43,"SELECT ""product_name"",""o"".""product_id"",""order_id"",""order_date"" FROM ((SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""num"" FROM ""Orders"") AS ""o"", ""Customers"" AS ""c"") JOIN ""Products"" AS ""p"" WHERE ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" AND ""num""<2 ORDER BY ""product_name"",""product_id"",""order_id"""
44,"WITH ""temp"" AS (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""p"".""product_name"",""t"".""product_id"",""t"".""order_id"",""t"".""order_date"" FROM ""temp"" AS ""t"" LEFT JOIN ""Products"" AS ""p"" ON ""t"".""product_id""=""p"".""product_id"" WHERE ""t"".""rk""=1 ORDER BY ""p"".""product_name"",""t"".""product_id"",""t"".""order_id"""
45,"WITH ""cte"" AS (SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rank"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""cte"".""rank""=1 ORDER BY ""product_name"",""order_id"""
46,"SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"" FROM ""Orders"" WHERE ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""Orders"" GROUP BY ""product_id"")) AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
47,"WITH ""orders_table"" AS (SELECT ""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",MAX(""order_date"") OVER (PARTITION BY ""product_id"") AS ""max_order_date"" FROM ""Orders"") AS ""t1"" WHERE ""order_date""=""max_order_date"") SELECT ""Products"".""product_name"",""orders_table"".* FROM ""orders_table"" JOIN ""Products"" ON ""Products"".""product_id""=""orders_table"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
48,"WITH ""most_recent_orders"" AS (SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rn"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""most_recent_orders"" WHERE ""rn""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
49,"SELECT ""p"".""product_name"",""o"".""product_id"",""order_id"",""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" USING (""product_id"") WHERE ROW(""order_date"",""o"".""product_id"") IN (SELECT MAX(""order_date""),""product_id"" FROM ""orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""o"".""product_id"",""order_id"""
50,"SELECT ""prod"".""product_name"",""ord1"".""product_id"",""ord1"".""order_id"",""ord1"".""order_date"" FROM (""orders"" AS ""ord1"" JOIN (SELECT DISTINCT ""product_id"",MAX(""order_date"") OVER (PARTITION BY ""product_id"") AS ""order_date"" FROM ""orders"" ORDER BY ""product_id"") AS ""ord2"" ON ""ord1"".""product_id""=""ord2"".""product_id"" AND ""ord1"".""order_date""=""ord2"".""order_date"") JOIN ""products"" AS ""prod"" ON ""ord2"".""product_id""=""prod"".""product_id"" ORDER BY ""prod"".""product_name"",""ord1"".""order_id"""
51,"SELECT ""a"".""product_name"" AS ""product_name"",""b"".""product_id"",""b"".""order_id"",""b"".""order_date"" FROM ""products"" AS ""a"" JOIN (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"") AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""ranking""=1 ORDER BY ""a"".""product_name"",""a"".""product_id"",""b"".""order_id"""
52,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""o"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""p"".""product_name"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""tmp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
53,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""first_order_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""t"" ON ""t"".""product_id""=""p"".""product_id"" AND ""t"".""first_order_date""=""o"".""order_date"" ORDER BY ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"""
54,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""seq"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""x"" WHERE ""seq""=1 ORDER BY 1,2,3"
55,"SELECT ""P"".""product_name"",""CTE"".""product_id"",""CTE"".""order_id"",""CTE"".""order_date"" FROM (SELECT ""order_id"",""product_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"") AS ""CTE"" JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""CTE"".""product_id"" WHERE ""CTE"".""ranking""=1 ORDER BY 1,2,3"
56,"SELECT ""product_name"",""Products"".""product_id"",""order_id"",""order_date"" FROM ""Products"" JOIN (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""date_rank"" FROM ""Orders"") AS ""temp"" ON ""Products"".""product_id""=""temp"".""product_id"" AND ""temp"".""date_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
57,"SELECT ""a"".""product_name"",""t1"".""product_id"",""t1"".""order_id"",""t1"".""order_date"" FROM (SELECT RANK() OVER (PARTITION BY ""t"".""product_id"" ORDER BY ""t"".""order_date"" DESC) AS ""rk"",""t"".""product_id"",""t"".""order_id"",""t"".""order_date"" FROM ""orders"" AS ""t"") AS ""t1"" JOIN ""products"" AS ""a"" ON ""t1"".""product_id""=""a"".""product_id"" WHERE ""t1"".""rk""=1 ORDER BY ""a"".""product_name"",""t1"".""product_id"",""t1"".""order_id"""
58,"WITH ""cte"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""maxorder"" FROM ""orders"" GROUP BY ""product_id"") SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""cte"" AS ""c"" ON ""o"".""product_id""=""c"".""product_id"" AND ""o"".""order_date""=""c"".""maxorder"" ORDER BY 1,2,3"
59,"SELECT ""t2"".""product_name"",""t1"".""product_id"",""t1"".""order_id"",""t1"".""order_date"" FROM ""orders"" AS ""t1"" JOIN (SELECT ""t1"".""product_id"",""t1"".""product_name"",MAX(""t2"".""order_date"") AS ""most_recent_order_date"" FROM ""products"" AS ""t1"" JOIN ""orders"" AS ""t2"" ON ""t2"".""product_id""=""t1"".""product_id"" GROUP BY ""t1"".""product_id"") AS ""t2"" ON ""t2"".""product_id""=""t1"".""product_id"" WHERE ""t1"".""order_date""=""t2"".""most_recent_order_date"" ORDER BY ""t2"".""product_name"",""t1"".""product_id"",""t1"".""order_id"""
60,"WITH ""temp1"" AS (SELECT ""product_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""product_name"",""temp1"".""product_id"",""temp1"".""order_id"",""temp1"".""order_date"" FROM ""temp1"" JOIN ""Products"" AS ""p"" ON ""temp1"".""product_id""=""p"".""product_id"" WHERE ""temp1"".""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
61,"WITH ""CTE"" AS (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM ""CTE"" AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"") WHERE ""a"".""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
62,"SELECT ""products"".""product_name"",""products"".""product_id"",""orders"".""order_id"",""orders"".""order_date"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" WHERE ROW(""Orders"".""product_id"",""Orders"".""order_date"") IN (SELECT ""Orders"".""product_id"",MAX(""Orders"".""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""order_id"""
63,"SELECT ""c"".""product_name"",""b"".""product_id"",""b"".""order_id"",""b"".""order_date"" FROM ((SELECT ""product_id"",MAX(""order_date"") AS ""recent_dt"" FROM ""orders"" GROUP BY ""product_id"") AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""a"".""recent_dt""=""b"".""order_date"") JOIN ""products"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"" ORDER BY ""c"".""product_name"",""b"".""product_id"",""b"".""order_id"""
64,"SELECT ""P"".""product_name"",""O"".""product_id"",""O"".""order_id"",""O"".""order_date"" FROM (""Customers"" AS ""C"" LEFT JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") LEFT JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ROW(""P"".""product_name"",""O"".""order_date"") IN (SELECT ""P"".""product_name"",MAX(""O"".""order_date"") FROM (""Customers"" AS ""C"" LEFT JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") LEFT JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""P"".""product_name"" HAVING MAX(""O"".""order_date"") IS NOT NULL) ORDER BY ""P"".""product_name"",""O"".""order_id"""
65,"SELECT ""product_name"",""a"".""product_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""product_id"",""order_date"" FROM ""orders"" WHERE ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""orders"" GROUP BY ""product_id"")) AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" ORDER BY 1,2,3"
66,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" USING (""product_id"") WHERE ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""Orders"" GROUP BY ""product_id"") ORDER BY 1,2,3"
67,"SELECT ""product_name"",""o1"".""product_id"" AS ""product_id"",""o1"".""order_id"" AS ""order_id"",""o1"".""order_date"" AS ""order_date"" FROM (""Orders"" AS ""o1"" JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""o2"" ON ""o1"".""product_id""=""o2"".""product_id"" AND ""o1"".""order_date""=""o2"".""order_date"") JOIN ""Products"" ON ""o1"".""product_id""=""Products"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
68,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""rnk""=1 ORDER BY 1,2,3"
69,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""P"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_name"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
70,"SELECT ""p"".""product_name"",""p"".""product_id"",""tmp"".""order_id"",""tmp"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""tmp"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""tmp"".""product_id"" WHERE ""tmp"".""rnk""=1 ORDER BY 1,2,3"
71,"SELECT ""p"".""product_name"",""P"".""product_id"",""order_id"",""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""p"".""Product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""dates"" FROM ""orders"" GROUP BY 1) ORDER BY 1,2,3"
72,"SELECT ""product_name"",""tmp"".""product_id"",""tmp"".""order_id"",""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY MAX(""order_date"") DESC) AS ""rnk"" FROM ""orders"" GROUP BY ""product_id"",""order_id"") AS ""tmp"" JOIN ""products"" AS ""p"" ON ""tmp"".""product_id""=""p"".""product_id"" WHERE ""tmp"".""rnk""=1 GROUP BY ""order_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
73,"WITH ""temp"" AS (SELECT ""product_id"",""order_id"",""order_date"" FROM ""Orders"" WHERE ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""recent_date"" FROM ""Orders"" GROUP BY 1) ORDER BY 1) SELECT ""P"".""product_name"",""T"".""product_id"",""T"".""order_id"",""T"".""order_date"" FROM ""TEMP"" AS ""T"" LEFT JOIN ""Products"" AS ""P"" ON ""T"".""product_id""=""P"".""product_id"" ORDER BY 1,2,3"
74,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""P"".""product_name"",""O"".""product_id"",""O"".""order_id"",""O"".""order_date"",RANK() OVER (PARTITION BY ""O"".""product_id"" ORDER BY ""O"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""tbl"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
75,"SELECT ""p"".""product_name"",""p"".""product_id"",""temp"".""order_id"",""temp"".""order_date"" FROM (SELECT * FROM (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""t"" WHERE ""rnk""=1) AS ""temp"" JOIN ""Products"" AS ""p"" ON ""temp"".""product_id""=""p"".""product_id"" ORDER BY ""p"".""product_name"",""p"".""product_id"",""temp"".""order_id"""
76,"WITH ""CTE"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""product_name"",""c"".""product_id"",""order_id"",""order_date"" FROM ""CTE"" AS ""c"" LEFT JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1 ORDER BY ""product_name"",""c"".""product_id"",""order_id"""
77,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"") WHERE ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
78,"SELECT ""pr"".""product_name"",""pr"".""product_id"",""abc"".""order_id"",""abc"".""order_date"" FROM ""products"" AS ""pr"" JOIN (SELECT ""order_id"",""order_date"",""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" ORDER BY ""product_id"") AS ""abc"" ON ""abc"".""product_id""=""pr"".""product_id"" WHERE ""abc"".""rnk""=1 ORDER BY 1,2,3"
79,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""product_id"",""order_id"",""order_date"",MAX(""order_date"") OVER (PARTITION BY ""product_id"") AS ""max_date"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"")) AS ""t"" WHERE ""order_date""=""max_date"" ORDER BY 1,2,3"
80,"WITH ""dt"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""dt"" FROM ""orders"" GROUP BY 1) SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""orders"" AS ""o"" JOIN ""dt"" AS ""d"" ON ""o"".""product_id""=""d"".""product_id"" AND ""o"".""order_date""=""d"".""dt"") JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" ORDER BY 1,2,3"
81,"WITH ""last_date_product"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""last_date"" FROM ""orders"" GROUP BY ""product_id"" ORDER BY ""order_date""), ""product_join"" AS (SELECT ""products"".""product_name"",""orders"".""product_id"",""orders"".""order_id"",""orders"".""order_date"" FROM ""orders"" JOIN ""products"" ON ""orders"".""product_id""=""products"".""product_id"") SELECT ""product_join"".""product_name"",""product_join"".""product_id"",""product_join"".""order_id"",""product_join"".""order_date"" FROM ""product_join"" JOIN ""last_date_product"" ON ""product_join"".""product_id""=""last_date_product"".""product_id"" AND ""product_join"".""order_date""=""last_date_product"".""last_date"" ORDER BY ""product_join"".""product_name"",""product_join"".""product_id"",""product_join"".""order_id"""
82,"WITH ""cte"" AS (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") SELECT ""p"".""product_name"",""c"".""product_id"",""order_id"",""order_date"" FROM ""cte"" AS ""c"" JOIN ""products"" AS ""p"" ON ""c"".""product_id""=""p"".""product_id"" WHERE ""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
83,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""P"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_name"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
84,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"""
85,"WITH ""last_date"" AS (SELECT ""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") SELECT ""p"".""product_name"",""p"".""product_id"",""l"".""order_id"",""l"".""order_date"" FROM ""products"" AS ""p"" LEFT JOIN ""last_date"" AS ""l"" ON ""p"".""product_id""=""l"".""product_id"" WHERE ""l"".""rnk""=1 ORDER BY ""p"".""product_name"",""p"".""product_id"",""l"".""order_id"""
86,"SELECT ""inb"".""product_name"",""inb"".""product_id"",""ina"".""order_id"",""ina"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""r_number"" FROM ""Orders"") AS ""ina"", ""Products"" AS ""inb"" WHERE ""ina"".""r_number""=1 AND ""ina"".""product_id""=""inb"".""product_id"" ORDER BY ""inb"".""product_name"",""inb"".""product_id"",""ina"".""order_id"""
87,"WITH ""t1"" AS (SELECT ""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"",""product_id"" FROM ""Orders"") SELECT ""p"".""product_name"",""t"".""product_id"",""t"".""order_id"",""t"".""order_date"" FROM ""Products"" AS ""p"" JOIN ""t1"" AS ""t"" ON (""p"".""product_id""=""t"".""product_id"") WHERE ""rnk""=1 ORDER BY 1,2,3"
88,"WITH ""MostRecentOrder"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""MostRecent"" FROM ""Orders"" GROUP BY ""product_id"") SELECT ""P"".""product_name"",""P"".""product_id"",""O"".""order_id"",""O"".""order_date"" FROM (""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"") JOIN ""MostRecentOrder"" AS ""MR"" ON ""O"".""product_id""=""MR"".""product_id"" AND ""O"".""order_date""=""MR"".""MostRecent"" ORDER BY 1,2,3"
89,"WITH ""tmp"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""orders"" GROUP BY ""product_id"") SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""t"".""order_date"" FROM ((""products"" AS ""p"") JOIN ""orders"" AS ""o"") JOIN ""tmp"" AS ""t"" WHERE ""p"".""product_id""=""t"".""product_id"" AND ""p"".""product_id""=""o"".""product_id"" AND ""o"".""order_date""=""t"".""order_date"" ORDER BY 1,2,3"
90,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""product_id"",""product_name"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""t"" WHERE ""rnk""=1 ORDER BY 1,2,3"
91,"WITH ""temp"" AS (SELECT ""p"".""product_name"" AS ""product_name"",""o"".""product_id"" AS ""product_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""my_rank"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"")) SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""temp"" WHERE ""my_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
92,"SELECT ""p"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""orders"") AS ""a"" LEFT JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""rn""<=1 ORDER BY ""p"".""product_name"",""a"".""product_id"",""a"".""order_id"""
93,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_id"",""p"".""product_name"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""comb"" WHERE ""rnk""=1 ORDER BY 1,2,3"
94,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""recent_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""m"" ON ""o"".""product_id""=""m"".""product_id"" AND ""o"".""order_date""=""m"".""recent_date"" ORDER BY ""product_name"",""product_id"",""order_id"""
95,"SELECT ""t"".""product_name"",""t"".""product_id"",""t"".""order_id"",""t"".""order_date"" FROM (SELECT ""o"".""order_id"",""o"".""order_date"",""o"".""product_id"",""p"".""product_name"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""r"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""t"" WHERE ""t"".""r""=1 ORDER BY ""t"".""product_name"",""t"".""product_id"",""t"".""order_id"""
96,"SELECT ""product_name"",""order_ranking"".""product_id"",""order_id"",""order_date"" FROM ""Products"" JOIN (SELECT ""order_id"",""order_date"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") AS ""order_ranking"" ON ""Products"".""product_id""=""order_ranking"".""product_id"" WHERE ""order_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
97,"WITH ""CTE"" AS (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"") SELECT ""p"".""product_name"",""p"".""product_id"",""CTE"".""order_id"",""CTE"".""order_date"" FROM ""CTE"" JOIN ""Products"" AS ""p"" ON ""CTE"".""product_id""=""p"".""product_id"" WHERE ""CTE"".""rk""=1 ORDER BY ""p"".""product_name"",""p"".""product_id"",""CTE"".""order_id"""
98,"SELECT ""product_name"",""product_id"" AS ""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""orders"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rank_date"" FROM ""Orders"" JOIN ""Products"" USING (""product_id"")) AS ""rank_dated"" WHERE ""rank_date""=1 ORDER BY 1,2,3"
99,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY 1) ORDER BY 1,2,3"
100,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""products"" AS ""p"" JOIN ""orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""t"" WHERE ""rnk""=1 ORDER BY 1,2,3"
101,"WITH ""cte"" AS (SELECT ""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rank1"" FROM ""orders"") SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM ""cte"" AS ""a"" JOIN ""products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""rank1""=1 ORDER BY ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"""
102,"SELECT ""Products"".""product_name"",""Products"".""product_id"",""Orders_1"".""order_id"",""Orders_1"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""order_date_rank"" FROM ""Orders"") AS ""Orders_1"", ""Products"" WHERE ""Orders_1"".""order_date_rank""=1 AND ""Orders_1"".""product_id""=""Products"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
103,"SELECT ""prod"".""product_name"" AS ""product_name"",""prod"".""product_id"" AS ""product_id"",""orderrank"".""order_id"" AS ""order_id"",""orderrank"".""order_date"" AS ""order_date"" FROM (SELECT ""order_id"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"",""order_date"" FROM ""Orders"") AS ""orderrank"" JOIN ""Products"" AS ""prod"" ON ""orderrank"".""product_id""=""prod"".""product_id"" WHERE ""orderrank"".""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
104,"WITH ""RECENT_ORDERS"" AS (SELECT ""order_id"",""order_date"",""product_id"" FROM (SELECT *,MAX(""order_date"") OVER (PARTITION BY ""product_id"") AS ""Recent_Order"" FROM ""Orders"") AS ""Orders_recent"" WHERE ""order_date""=""Recent_Order"" GROUP BY ""order_id"",""order_date"",""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""Products"" AS ""P"" JOIN ""RECENT_ORDERS"" USING (""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
105,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""p"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_name"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""a"" WHERE ""ranking""=1 ORDER BY 1,2,3"
106,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""products"" AS ""p"" JOIN ""orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""temp"" WHERE ""rnk""=1 ORDER BY ""product_name"",""order_id"""
107,"SELECT ""agg"".""product_name"",""agg"".""product_id"",""agg"".""order_id"",""agg"".""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""req_rank"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""AGG"" WHERE ""agg"".""req_rank""=1 ORDER BY 1,2,3"
108,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""recentday"" FROM ""Orders"" GROUP BY 1) ORDER BY ""product_name"",""product_id"",""order_id"""
109,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""product_id"",""product_name"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""A"" WHERE ""order_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
110,"WITH ""OrderRanking"" AS (SELECT ""order_id"",""order_date"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""Rk"" FROM ""Orders"") SELECT ""P"".""product_name"",""P"".""product_id"",""OdR"".""order_id"",""OdR"".""order_date"" FROM ""Products"" AS ""P"" JOIN ""OrderRanking"" AS ""OdR"" ON ""OdR"".""product_id""=""P"".""product_id"" AND ""OdR"".""Rk""=1 ORDER BY 1,2,3"
111,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""recent_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""m"" ON ""m"".""product_id""=""o"".""product_id"" AND ""m"".""recent_date""=""o"".""order_date"" ORDER BY ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"""
112,"WITH ""product_rank"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""recent_rank"" FROM ""Orders"" AS ""o"") SELECT ""p"".""product_name"",""pr"".""product_id"",""pr"".""order_id"",""pr"".""order_date"" FROM ""product_rank"" AS ""pr"" JOIN ""Products"" AS ""p"" ON ""pr"".""product_id""=""p"".""product_id"" WHERE ""pr"".""recent_rank""=1 ORDER BY ""p"".""product_name"",""pr"".""product_id"",""pr"".""order_id"""
113,"SELECT ""a"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT ""Products"".""product_name"",""Products"".""product_id"",""Orders"".""order_id"",""Orders"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""Orders"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"") AS ""a"" WHERE ""a"".""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
114,"SELECT ""product_name"",""product_id"",""order_id"",""A"".""order_date"" AS ""order_date"" FROM ""orders"" AS ""A"" JOIN ""products"" AS ""B"" USING (""product_id"") WHERE ROW(""A"".""product_id"",""A"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
115,"WITH ""r"" AS (SELECT ""product_id"",""order_id"",""order_date"",MAX(""order_date"") OVER (PARTITION BY ""product_id"") AS ""order_date_max"" FROM ""Orders"") SELECT ""product_name"",""r"".""product_id"",""order_id"",""order_date"" FROM ""r"" JOIN ""Products"" ON ""r"".""product_id""=""Products"".""product_id"" AND ""r"".""order_date_max""=""r"".""order_date"" ORDER BY 1,2,3"
116,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""O"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""O"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" AS ""O"" JOIN ""Products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") AS ""t"" WHERE ""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
117,"SELECT ""p"".""product_name"" AS ""product_name"",""o"".""product_id"" AS ""product_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
118,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ((SELECT ""product_id"",MAX(""order_date"") AS ""max_date"" FROM ""orders"" GROUP BY ""product_id"") AS ""t1"" JOIN ""orders"" AS ""o"" ON ""o"".""product_id""=""t1"".""product_id"" AND ""o"".""order_date""=""t1"".""max_date"") JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" ORDER BY ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"""
119,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""Products"".""product_name"",""Products"".""product_id"",""Orders"".""order_id"",""Orders"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""Products"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"") AS ""a"" WHERE ""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
120,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""p"".""product_id"" ORDER BY ""order_date"" DESC) AS ""rank"" FROM (""orders"" AS ""o"") JOIN ""products"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"") AS ""a"" WHERE ""a"".""rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
121,"SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM ""Orders"" AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ROW(""a"".""product_id"",""a"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"""
122,"SELECT ""t1"".""product_name"",""t1"".""product_id"",""t1"".""order_id"",""t1"".""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"",""o"".""order_id"",""o"".""order_date"" FROM ""products"" AS ""p"" JOIN ""orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""t1"" WHERE ""t1"".""rnk""=1 ORDER BY ""product_name"",""order_id"""
123,"SELECT ""p1"".""product_name"",""a1"".""product_id"",""a1"".""order_id"",""a1"".""order_date"" FROM (SELECT ""o1"".""product_id"",""o1"".""order_id"",""o1"".""order_date"" FROM (""orders"" AS ""o1"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""od"" FROM ""orders"" GROUP BY 1) AS ""o2"" WHERE ROW(""o1"".""product_id"",""o1"".""order_date"")=ROW(""o2"".""product_id"",""o2"".""od"")) AS ""a1"" JOIN ""products"" AS ""p1"" ON ""a1"".""product_id""=""p1"".""product_id"" ORDER BY 1,2,3"
124,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""a"".""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_name"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""a"" JOIN ""products"" AS ""b"" USING (""product_id"")) AS ""t"" WHERE ""rnk""=1 ORDER BY 1,2,3"
125,"SELECT ""product_name"",""a"".""product_id"",""order_id"",""order_date"" FROM (SELECT ""o"".""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""order_date"" DESC) AS ""num"",""product_name"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""a"" WHERE ""num""=1 ORDER BY 1,2,3"
126,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""o"".""product_id"",""product_name"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""prod_rec_ord_rank"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""a"" WHERE ""prod_rec_ord_rank""=1 ORDER BY ""product_name"",""order_id"""
127,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""p"".""product_name"" ORDER BY ""o"".""order_date"" DESC) AS ""flag"" FROM (""Products"" AS ""p"") JOIN ""Orders"" AS ""o"" WHERE ""p"".""product_id""=""o"".""product_id"") AS ""tmp"" WHERE ""flag""=1 ORDER BY ""product_name"",""order_id"""
128,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_id"",""p"".""product_name"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""tmpt"" WHERE ""ranking""=1 ORDER BY 1,2,3"
129,"WITH ""r"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders""), ""recent"" AS (SELECT ""product_id"",""order_id"",""order_date"" FROM ""r"" WHERE ""rnk""=1) SELECT ""p"".""product_name"",""r"".""product_id"",""r"".""order_id"",""r"".""order_date"" FROM ""Products"" AS ""p"" JOIN ""recent"" AS ""r"" ON ""p"".""product_id""=""r"".""product_id"" ORDER BY ""p"".""product_name"",""r"".""product_id"",""r"".""order_id"""
130,"WITH ""cte"" AS (SELECT ""order_id"",""product_name"",""p"".""product_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rn"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""rn""=1 ORDER BY 1,2,3"
131,"SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""orders"" GROUP BY ""product_id"") ORDER BY ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"""
132,"SELECT ""p"".""product_name"" AS ""product_name"",""o"".""product_id"" AS ""product_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""o"".""product_id"",""o"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
133,"WITH ""cte1"" AS (SELECT ""Products"".""Product_name"",""Products"".""product_id"",""Orders"".""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Products"" USING (""product_id"")) SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""cte1"" WHERE ""rk""=1 ORDER BY 1,2,3"
134,"SELECT ""product_name"",""p"".""product_id"",""order_id"",""od"" AS ""order_date"" FROM ((""Products"" AS ""p"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""od"" FROM ""Orders"" GROUP BY ""product_id"") AS ""t"") JOIN ""Orders"" AS ""o"" WHERE ""t"".""product_id""=""p"".""product_id"" AND ""o"".""order_date""=""od"" AND ""o"".""product_id""=""t"".""product_id"" ORDER BY ""product_name"",""p"".""product_id"",""order_id"",""od"""
135,"SELECT ""product_name"",""o"".""product_id"",""o"".""order_id"",""order_date"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ROW(""o"".""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") AS ""mostRecent"" FROM ""Orders"" GROUP BY ""product_id"") ORDER BY 1,2,3"
136,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") GROUP BY 1,2,3 HAVING ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""Orders"" GROUP BY 1) ORDER BY 1,2"
137,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""b"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"",RANK() OVER (PARTITION BY ""a"".""product_id"" ORDER BY ""a"".""order_date"" DESC) AS ""rnk"" FROM ""Orders"" AS ""a"" JOIN ""Products"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""a"" WHERE ""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
138,"SELECT ""t4"".""product_name"",""t4"".""product_id"",""t5"".""order_id"",""t4"".""order_date"" FROM (SELECT * FROM (SELECT ""t2"".""product_id"",""t2"".""product_name"",""t1"".""order_date"",RANK() OVER (PARTITION BY ""t2"".""product_id"" ORDER BY ""t1"".""order_date"" DESC) AS ""ranks"" FROM ""Orders"" AS ""t1"" LEFT JOIN ""Products"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"") AS ""t3"" WHERE ""ranks""=1) AS ""t4"" LEFT JOIN ""Orders"" AS ""t5"" ON ""t4"".""order_date""=""t5"".""order_date"" AND ""t4"".""product_id""=""t5"".""product_id"" GROUP BY 1,2,3,4 ORDER BY 1,2,3,4"
139,"SELECT ""product_name"",""p"".""product_id"",""Order_id"",""order_Date"" FROM ""products"" AS ""p"" JOIN (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") AS ""o"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""rk""=1 ORDER BY 1,2,3"
140,"WITH ""cte"" AS (SELECT ""order_id"",""product_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""cte"" JOIN ""Products"" USING (""product_id"") WHERE ""cte"".""rnk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
141,"SELECT ""tbl2"".""product_name"",""tbl2"".""product_id"",""tbl1"".""order_id"",""tbl1"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") AS ""tbl1"" JOIN ""Products"" AS ""tbl2"" ON ""tbl1"".""product_id""=""tbl2"".""product_id"" WHERE ""tbl1"".""order_rank""=1 ORDER BY ""tbl2"".""product_name"",""tbl2"".""product_id"",""tbl1"".""order_id"""
142,"WITH ""a"" AS (SELECT ""product_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""product_id"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"") AS ""t"" WHERE ""rnk""=1) SELECT ""p"".""product_name"",""a"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM ""a"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"" ORDER BY 1,2,3"
143,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""p"".""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") AS ""x"" WHERE ""rk""=1 ORDER BY 1,2,3"
144,"WITH ""cte"" AS (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""order_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
145,"SELECT ""p"".""product_name"",""p"".""product_id"",""a"".""order_id"",""a"".""order_date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""Ranks"" FROM ""orders"" ORDER BY ""product_id"") AS ""a"" JOIN ""products"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE ""ranks""=1 ORDER BY ""p"".""product_name"",""a"".""order_id"""
146,"WITH ""cte"" AS (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""cte"" WHERE ""order_rank""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
147,"WITH ""temp"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""recent_date"" FROM ""Orders"" GROUP BY ""product_id"") SELECT ""product_name"",""o"".""product_id"",""order_id"",""order_date"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"") WHERE ROW(""o"".""product_id"",""order_date"") IN (SELECT ""product_id"",""recent_date"" FROM ""temp"") ORDER BY ""product_name"",""o"".""product_id"",""order_id"""
148,"SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN (SELECT ""product_id"",MAX(""order_date"") AS ""recent_date"" FROM ""Orders"" GROUP BY ""product_id"") AS ""m"" ON ""m"".""product_id""=""o"".""product_id"" AND ""m"".""recent_date""=""o"".""order_date"" ORDER BY ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"""
149,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""product_id"",""order_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranking"",""order_date"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""c"" USING (""product_id"")) AS ""v"" WHERE ""ranking""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
150,"SELECT ""product_name"",""O"".""product_id"",""order_id"",""order_date"" FROM ""orders"" AS ""O"" JOIN ""products"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ROW(""O"".""product_id"",""O"".""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") FROM ""orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""product_id"",""order_id"""
151,"SELECT ""product_name"",""p"".""product_id"",""Order_id"",""order_Date"" FROM ""products"" AS ""p"" JOIN (SELECT ""product_id"",""order_id"",""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rk"" FROM ""orders"") AS ""o"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""rk""=1 ORDER BY 1,2,3"
152,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"" AS ""product_name"",""p"".""product_id"" AS ""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""result"" WHERE ""rnk""=1 ORDER BY 1,2,3"
153,"WITH ""t"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""order_date"" FROM ""orders"" GROUP BY ""product_id"") SELECT ""p"".""product_name"" AS ""product_name"",""o"".""product_id"" AS ""product_id"",""o"".""order_id"" AS ""order_id"",""o"".""order_date"" AS ""order_date"" FROM (""orders"" AS ""o"" JOIN ""t"" ON ""o"".""product_id""=""t"".""product_id"" AND ""o"".""order_date""=""t"".""order_date"") JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
154,"SELECT ""product_name"",""p"".""product_id"",""order_id"",""order_date"" FROM ""Products"" AS ""p"" JOIN ""Orders"" AS ""o"" USING (""product_id"") WHERE ROW(""product_id"",""order_date"") IN (SELECT ""product_id"",MAX(""order_date"") OVER (PARTITION BY ""product_id"") AS ""recent"" FROM ""Orders"") ORDER BY 1,2,3"
155,"WITH ""ranked_orders"" AS (SELECT ""order_id"",""order_date"",""customer_id"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""order_rank"" FROM ""Orders"") SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Products"" AS ""p"" JOIN ""ranked_orders"" AS ""o"" ON (""o"".""product_id""=""p"".""product_id"") WHERE ""o"".""order_rank""=1 ORDER BY ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"""
156,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""product_name"",""o"".""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""order_date"" DESC) AS ""ranked"" FROM ""orders"" AS ""o"" JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") AS ""f"" WHERE ""ranked""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
157,"SELECT ""products"".""product_name"",""products"".""product_id"",""orders"".""order_id"",""orders"".""order_date"" FROM ""Orders"" JOIN ""Products"" ON ""Orders"".""product_id""=""Products"".""product_id"" WHERE ROW(""Orders"".""product_id"",""Orders"".""order_date"") IN (SELECT ""Orders"".""product_id"",MAX(""Orders"".""order_date"") FROM ""Orders"" GROUP BY ""product_id"") ORDER BY ""product_name"",""order_id"""
158,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""src"" WHERE ""rnk""=1 ORDER BY 1,2,3"
159,"SELECT ""P"".""product_name"",""T"".""product_id"",""T"".""order_id"",""T"".""order_date"" FROM (SELECT ""product_id"",""order_date"",""order_id"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""RNK"" FROM ""Orders"") AS ""T"" JOIN ""Products"" AS ""P"" ON ""T"".""product_id""=""P"".""product_id"" WHERE ""T"".""RNK""=1 ORDER BY ""product_name"",""T"".""product_id"",""T"".""order_id"""
160,"SELECT ""product_name"",""sub"".""product_id"",""sub"".""order_id"",""sub"".""order_date"" FROM (SELECT ""product_id"",""order_date"",""order_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rnk"" FROM ""Orders"") AS ""sub"" LEFT JOIN ""Products"" AS ""p"" ON ""sub"".""product_id""=""p"".""product_id"" WHERE ""rnk""=1 ORDER BY 1,2,3"
161,"SELECT ""product_name"",""y"".""product_id"",""order_id"",""order_date"" FROM (SELECT ""order_id"",""order_date"",""product_id"" FROM (SELECT ""order_id"",""order_date"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""r"" FROM ""orders"") AS ""x"" WHERE ""r""=1) AS ""y"" LEFT JOIN ""products"" AS ""p"" ON ""p"".""product_id""=""y"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"""
162,"WITH ""t1"" AS (SELECT ""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""recent"" FROM ""orders"") SELECT ""p"".""product_name"",""t1"".""product_id"",""t1"".""order_id"",""t1"".""order_date"" FROM ""t1"" JOIN ""products"" AS ""p"" ON ""t1"".""product_id""=""p"".""product_id"" WHERE ""recent""=1 ORDER BY ""p"".""product_name"",""t1"".""product_id"",""t1"".""order_id"""
163,"WITH ""table1"" AS (SELECT ""o"".*,MAX(""o"".""order_date"") OVER (PARTITION BY ""o"".""product_id"") AS ""max_date"",""p"".""product_name"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" USING (""product_id"")) SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM ""table1"" WHERE ""order_date""=""max_date"" ORDER BY ""product_name"",""product_id"",""order_id"""
164,"WITH ""rec"" AS (SELECT ""product_id"",""order_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""r1"" FROM ""Orders"") SELECT ""p"".""product_name"",""r"".""product_id"",""r"".""order_id"",""r"".""order_date"" FROM ""rec"" AS ""r"" JOIN ""Products"" AS ""p"" ON ""r"".""product_id""=""p"".""product_id"" WHERE ""r"".""r1""=1 ORDER BY 1,2,3"
165,"SELECT ""c"".""product_name"",""c"".""product_id"",""c"".""order_id"",""c"".""order_date"" FROM (SELECT ""a"".""product_name"",""a"".""product_id"",""b"".""order_id"",""b"".""order_date"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""rwn"" FROM ""products"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" WHERE ""rwn""=1 AND ""order_date"" IS NOT NULL AND ""order_id"" IS NOT NULL ORDER BY ""product_name"",""product_id"",""order_id"""
166,"SELECT ""T1"".""product_name"",""T1"".""product_id"",""T1"".""order_id"",""T1"".""order_date"" FROM (SELECT ""P"".""product_name"",""P"".""product_id"",""O"".""order_id"",""O"".""order_date"",""O"".""ranks"" FROM ""Products"" AS ""P"" RIGHT JOIN (SELECT *,RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranks"" FROM ""Orders"") AS ""O"" ON ""P"".""product_id""=""O"".""product_id"") AS ""T1"" WHERE ""T1"".""ranks""=1 ORDER BY ""T1"".""product_name"",""T1"".""product_name"",""T1"".""order_id"""
167,"SELECT ""product_name"",""A"".""product_id"",""A"".""order_id"",""A"".""order_date"" FROM (SELECT ""order_id"",""order_date"",""product_id"",RANK() OVER (PARTITION BY ""product_id"" ORDER BY ""order_date"" DESC) AS ""ranking"" FROM ""Orders"") AS ""A"" JOIN ""Products"" AS ""P"" ON ""A"".""product_id""=""P"".""product_id"" WHERE ""ranking""=1 ORDER BY ""product_name"",""A"".""product_id"",""A"".""order_id"""
168,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT RANK() OVER (PARTITION BY ""t"".""product_id"" ORDER BY ""t"".""order_date"" DESC) AS ""rk"",""t"".""product_id"",""a"".""product_name"",""t"".""order_id"",""t"".""order_date"" FROM ""orders"" AS ""t"" JOIN ""products"" AS ""a"" ON ""t"".""product_id""=""a"".""product_id"") AS ""t1"" WHERE ""t1"".""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
169,"WITH ""CTE"" AS (SELECT ""product_id"",MAX(""order_date"") AS ""max_date"" FROM ""Orders"" GROUP BY ""product_id"") SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ROW(""p"".""product_id"",""o"".""order_date"") IN (SELECT * FROM ""CTE"") ORDER BY ""product_name"",""product_id"",""order_id"""
170,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""o"".""product_id"",""o"".""order_id"",""o"".""order_date"",RANK() OVER (PARTITION BY ""o"".""product_id"" ORDER BY ""o"".""order_date"" DESC) AS ""rk"" FROM ""orders"" AS ""o"" LEFT JOIN ""products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""temp"" WHERE ""rk""=1 ORDER BY ""product_name"",""product_id"",""order_id"""
171,"SELECT ""product_name"",""product_id"",""order_id"",""order_date"" FROM (SELECT ""p"".""product_name"",""p"".""product_id"",""o"".""order_id"",""o"".""order_date"",MAX(""o"".""order_date"") OVER (PARTITION BY ""product_id"") AS ""ppp"" FROM ""Orders"" AS ""o"" JOIN ""Products"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" ORDER BY ""product_name"",""product_id"",""order_id"") AS ""aaa"" WHERE ""order_date""=""ppp"""
