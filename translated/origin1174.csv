id,original query
1,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
2,"SELECT ROUND(SUM(CASE WHEN ""first_order""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""order_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""A"" ON ""Delivery"".""order_date""=""A"".""first_order"" AND ""A"".""customer_id""=""Delivery"".""customer_id"""
3,"WITH ""FirstOrderDetails"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""OrderRk"" FROM ""Delivery""), ""FirstOrderCat"" AS (SELECT SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""immediate"",COUNT(1) AS ""AllDelivery"" FROM ""FirstOrderDetails"" WHERE ""OrderRk""=1) SELECT ROUND(COALESCE(""immediate""*100/""AllDelivery"", 0), 2) AS ""immediate_percentage"" FROM ""FirstOrderCat"""
4,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""r""=1"
5,"ERROR: mysql parse error: line 1 column 27 near "";&amp; order_date = customer_pref_delivery_date) * 100/SUM(RN=1),2) as immediate_percentage from (SELECT order_date, customer_pref_delivery_date , ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date ASC ) RN FROM Delivery) x"" "
6,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
7,"SELECT ROUND(AVG(""immediate_type"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate_type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""a"" WHERE ""rnk""=1"
8,"WITH ""temp"" AS (SELECT ""delivery_id"",""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND((SELECT COUNT(""delivery_id"") FROM ""temp"" WHERE ""order_type""='immediate' AND ""rnk""=1)*100/(SELECT COUNT(""delivery_id"") FROM ""temp"" WHERE ""rnk""=1), 2) AS ""immediate_percentage"""
9,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery"") AS ""a"" WHERE ""rk""=1"
10,"SELECT ROUND(SUM(CASE WHEN ""order_type""='immediate' THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_type"" FROM ""delivery"") AS ""a"" WHERE ""rnk""=1"
11,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_order"" FROM ""delivery"") AS ""A"" WHERE ""rank_order""=1"
12,"WITH ""table1"" AS (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""first_date"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""immediate_flag"" FROM ""Delivery""), ""table2"" AS (SELECT *,(CASE WHEN ""first_date""=""order_date"" THEN 1 ELSE 0 END) AS ""first_date_flag"" FROM ""table1"") SELECT ROUND((SUM(""first_date_flag""*""immediate_flag"")/SUM(""first_date_flag""))*100, 2) AS ""immediate_percentage"" FROM ""table2"""
13,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""temp"" WHERE ""rk""=1"
14,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""my_rank"" FROM ""Delivery""), ""cte2"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM ""cte"" WHERE ""my_rank""=1) SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte2"""
15,"WITH ""cte"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""imm"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND(SUM(""imm"")/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
16,"SELECT ROUND((SUM(CASE WHEN ""f"".""pref""=""f"".""first_order_date"" THEN 1 ELSE 0 END)/COUNT(""f"".""pref""))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""f"""
17,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""delivery"" GROUP BY ""customer_id"")"
18,"WITH ""cte"" AS (SELECT * FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""D"" WHERE ""D"".""rn""=1) SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"""
19,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"")"
20,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""Delivery"") AS ""a"" WHERE ""a"".""r""=1"
21,"WITH ""temp"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_type"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""rnk""=1) SELECT ROUND(100*(SUM(CASE WHEN ""order_type""='immediate' THEN 1 ELSE 0 END)/COUNT(1)), 2) AS ""immediate_percentage"" FROM ""temp"""
22,"SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" AND ""rw_num""=1 THEN 1 ELSE 0 END)/SUM(CASE WHEN ""rw_num""=1 THEN 1 ELSE 0 END))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""A"".*,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rw_num"" FROM ""Delivery"" AS ""A"") AS ""X"""
23,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery""), ""cte2"" AS (SELECT CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""re"" FROM ""cte"" WHERE ""rk""=1) SELECT ROUND(SUM(""re"")*100/COUNT(""re""), 2) AS ""immediate_percentage"" FROM ""cte2"""
24,"WITH ""cte"" AS (SELECT * FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"") AND ""order_date""=""customer_pref_delivery_date"") SELECT ROUND((SELECT COUNT(1) FROM ""cte"")*100/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""delivery"""
25,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""Customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
26,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
27,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
28,"WITH ""cte"" AS (SELECT ""delivery_id"",""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""status"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND((SUM(CASE WHEN ""status""='immediate' THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
29,"SELECT ROUND(SUM(CASE WHEN ""b"".""firstday""=""a"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""a"" LEFT JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""firstday"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date""=""b"".""firstday"""
30,"WITH ""cte"" AS (SELECT ""d"".""customer_id"",""min_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"" JOIN ""Delivery"" AS ""d"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""min_date"") SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""cte"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""min_date""=""customer_pref_delivery_date"""
31,"WITH ""firsro"" AS (SELECT * FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"")) SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""firsro"""
32,"WITH ""first_order"" AS (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""first_order"" WHERE ""rnk""=1"
33,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""rnk""=1"
34,"SELECT ROUND(SUM(CASE WHEN ""order_type""='immediate' THEN 1 ELSE 0 END)*100/COUNT(0), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'schedule' END AS ""order_type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""t"" WHERE ""rk""=1"
35,"SELECT ROUND(SUM(CASE WHEN ""seq_order""=1 AND ""immediate""=1 THEN 1 ELSE 0 END)/SUM(CASE WHEN ""seq_order""=1 THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""seq_order"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""immediate"" FROM ""Delivery"") AS ""sub"""
36,"WITH ""cte"" AS (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",""order_date"",""delivery_id"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""temp"" WHERE ""rnk""=1) SELECT ROUND(COALESCE((SELECT COUNT(""delivery_id"") FROM ""cte"" WHERE ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(""delivery_id"") FROM ""cte""), 0)*100, 2) AS ""immediate_percentage"""
37,"WITH ""a"" AS (SELECT DISTINCT (""customer_id""),""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""rnk"")*100, 2) AS ""immediate_percentage"" FROM ""a"" WHERE ""rnk""=1"
38,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
39,"SELECT ROUND(AVG(""a"".""NUM"")*100, 2) AS ""immediate_percentage"" FROM (SELECT (MIN(""order_date"")=MIN(""customer_pref_delivery_date"")) AS ""NUM"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""a"""
40,"WITH ""main"" AS (SELECT *,(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""immediate"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""Delivery"") SELECT ROUND(SUM(""immediate"")*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""main"" WHERE ""ranking""=1"
41,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranks"" FROM ""Delivery""), ""cte2"" AS (SELECT ""customer_id"",""order_date"" FROM ""cte"" WHERE ""ranks""=1) SELECT ROUND(100*COUNT(1)/(SELECT COUNT(1) FROM ""cte2""), 2) AS ""immediate_percentage"" FROM ""cte2"" JOIN ""Delivery"" ON ""cte2"".""customer_id""=""Delivery"".""customer_id"" AND ""cte2"".""order_date""=""Delivery"".""customer_pref_delivery_date"""
42,"SELECT 100*ROUND(COUNT(DISTINCT ""t"".""customer_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery""), 4) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""t"".""order_date""=""t"".""customer_pref_delivery_date"" AND ""rnk""=1"
43,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""x"" WHERE ""rnk""=1"
44,"ERROR: mysql parse error: line 1 column 27 near "";&amp; order_date = customer_pref_delivery_date) * 100/SUM(RN=1),2) as immediate_percentage from (SELECT order_date, customer_pref_delivery_date , ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date ASC ) RN FROM Delivery) x "" "
45,"WITH ""cte"" AS (SELECT COUNT(""i"") AS ""cnt"",""o"",""p"" FROM (SELECT ""customer_id"" AS ""i"",""order_date"" AS ""o"",""customer_pref_delivery_date"" AS ""p"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""d"" WHERE ""d"".""rnk""=1 AND ""d"".""o""=""d"".""p""), ""cte2"" AS (SELECT COUNT(DISTINCT ""customer_id"") AS ""cnt2"" FROM ""delivery"") SELECT ROUND(((""cte"".""cnt""/""cte2"".""cnt2"")*100), 2) AS ""immediate_percentage"" FROM (""cte"") JOIN ""cte2"""
46,"WITH ""TEMP"" AS (SELECT CASE WHEN ""order_Date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediates"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""a"" WHERE ""rnk""=1) SELECT ROUND(SUM(""immediates"")/COUNT(""immediates"")*100, 2) AS ""immediate_percentage"" FROM ""TEMP"""
47,"SELECT ROUND((SUM(CASE WHEN ""t1"".""order_preference""='immediate' THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_order"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_preference"" FROM ""Delivery"" ORDER BY ""customer_id"") AS ""t1"" WHERE ""t1"".""rank_order""=1"
48,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
49,"WITH ""test"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"",MIN(""customer_pref_delivery_date"") AS ""pref_delivery_date"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""DELIVERY"")*100, 2) AS ""immediate_percentage"" FROM ""test"" WHERE ""first_order""=""pref_delivery_date"""
50,"WITH ""t0"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""recent_orders"" FROM ""delivery"" ORDER BY ""customer_id""), ""t"" AS (SELECT COUNT(""delivery_id"") AS ""fast"" FROM ""t0"" WHERE ""order_date""=""customer_pref_delivery_date"" AND ""recent_orders""=1), ""t2"" AS (SELECT COUNT(""delivery_id"") AS ""deno"" FROM ""t0"" WHERE ""recent_orders""=1) SELECT ROUND(""fast""/""deno""*100, 2) AS ""immediate_percentage"" FROM (""t"") JOIN ""t2"""
51,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN '1' ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
52,"WITH ""order_values"" AS (SELECT RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rank"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate"",1 AS ""n"" FROM ""Delivery"") SELECT ROUND(((SUM(""immediate"")/SUM(""n""))*100), 2) AS ""immediate_percentage"" FROM ""order_values"" WHERE ""order_rank""=1"
53,"SELECT ROUND(SUM(""immediate"")/SUM(""orders"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",CASE WHEN ""order_date"" IS NOT NULL THEN 1 ELSE 0 END AS ""orders"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""t"" WHERE ""rnk""=1) AS ""o"""
54,"WITH ""first_order"" AS (SELECT * FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY 1)), ""first_immidiate_order"" AS (SELECT ""customer_id"" FROM ""first_order"" WHERE ""order_date""=""customer_pref_delivery_date"") SELECT ROUND(""num""/""total""*100, 2) AS ""immediate_percentage"" FROM (SELECT COUNT(""customer_id"") AS ""total"" FROM ""first_order"") AS ""t1"" JOIN (SELECT COUNT(""customer_id"") AS ""num"" FROM ""first_immidiate_order"") AS ""t2"""
55,"WITH ""base_table"" AS (SELECT ""customer_id"",""delivery_id"",""customer_pref_delivery_date"",CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN TRUE ELSE FALSE END AS ""is_immediate_order"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_number"" FROM ""Delivery"" GROUP BY 1,2,3,3) SELECT ROUND(SUM(""is_immediate_order"")/COUNT(DISTINCT ""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM ""base_table"" WHERE ""rank_number""=1"
56,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
57,"SELECT ROUND(SUM(CASE WHEN ""first_order""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""tmp"" JOIN ""Delivery"" AS ""d"" ON ""tmp"".""customer_id""=""d"".""customer_id"" WHERE ""first_order""=""order_date"""
58,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
59,"SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END))/COUNT(DISTINCT (""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
60,"SELECT ROUND(AVG(""a"".""NUM"")*100, 2) AS ""immediate_percentage"" FROM (SELECT (MIN(""order_date"")=MIN(""customer_pref_delivery_date"")) AS ""NUM"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""a"""
61,"WITH ""Earliest"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND(((SELECT COUNT(1) FROM ""Earliest"" WHERE ""rnk""=1 AND ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(1) FROM ""Earliest"" WHERE ""rnk""=1))*100, 2) AS ""immediate_percentage"""
62,"SELECT ROUND(COUNT(""customer_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_Date"" AS ""d"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""Delivery"") AS ""p"" WHERE ""r""=1 AND ""order_date"" - ""d""=0"
63,"SELECT ROUND(SUM(""immediate"")/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rank"" FROM ""delivery"") AS ""tmp"" WHERE ""order_rank""=1"
64,"SELECT ROUND(100*AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
65,"SELECT ROUND(COALESCE(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(1)*100, 0), 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""d"" WHERE ""rnk""=1"
66,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""delivery"" GROUP BY 1)"
67,"WITH ""cte"" AS (SELECT ""customer_id"",(""order_date""=""customer_pref_delivery_date"") AS ""imme"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnum"" FROM ""Delivery"") SELECT ROUND(SUM(""imme"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnum""=1"
68,"WITH ""temp"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"",MIN(""customer_pref_delivery_date"") AS ""first_pref"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(100*COUNT(""customer_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""delivery""), 2) AS ""immediate_percentage"" FROM ""temp"" WHERE ""first_order""=""first_pref"""
69,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY 1)"
70,"SELECT ROUND(100*AVG(""order_date""=""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
71,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
72,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_data"" FROM ""delivery"" GROUP BY ""customer_id"")"
73,"WITH ""t1"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""delivery"" GROUP BY 1,2), ""t2"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM ""t1"" WHERE ""rn""=1) SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""t2"""
74,"SELECT ROUND(100*SUM(""first_order""=""customer_pref_delivery_date"")/SUM(""first_order""=""order_date""), 2) AS ""immediate_percentage"" FROM ""delivery"" AS ""d"" JOIN (SELECT DISTINCT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""t"" ON ""d"".""customer_id""=""t"".""customer_id"""
75,"WITH ""table1"" AS (SELECT ""delivery_id"",""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND((SELECT COUNT(""delivery_id"") FROM ""table1"" WHERE ""order_type""='immediate' AND ""rnk""=1)/(SELECT COUNT(""delivery_id"") FROM ""table1"" WHERE ""rnk""=1)*100, 2) AS ""immediate_percentage"""
76,"WITH ""tmp"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM ""tmp"" WHERE ""rnk""=1"
77,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""f_order"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND((SUM(CASE WHEN ""d"".""customer_pref_delivery_date"" IS NULL THEN 0 ELSE 1 END)/COUNT(""f"".""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""first_order"" AS ""f"" LEFT JOIN ""Delivery"" AS ""d"" ON ""f"".""customer_id""=""d"".""customer_id"" AND ""f"".""f_order""=""d"".""customer_pref_delivery_date"""
78,"WITH ""firstorder"" AS (SELECT ""delivery_id"",""customer_id"",MIN(""order_date"") AS ""fir"",MIN(""customer_pref_delivery_date"") AS ""c"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(SUM(""fir""=""c"")/COUNT(""c"")*100, 2) AS ""immediate_percentage"" FROM ""firstorder"""
79,"WITH ""TMP"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""Delivery"" AS ""d"") SELECT ROUND(100*SUM(""t"".""order_date""=""t"".""customer_pref_delivery_date"")/COUNT(1), 2) AS ""immediate_percentage"" FROM ""TMP"" AS ""t"" WHERE ""r""=1"
80,"WITH ""cte"" AS (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",""order_date"",""delivery_id"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""temp"" WHERE ""rnk""=1) SELECT ROUND(COALESCE((SELECT COUNT(""delivery_id"") FROM ""cte"" WHERE ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(""delivery_id"") FROM ""cte""), 0)*100, 2) AS ""immediate_percentage"""
81,"SELECT ROUND(COUNT(CASE WHEN ""a"".""order_date""=""a"".""customer_pref_delivery_date"" THEN 1 ELSE NULL END)/COUNT(""a"".""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""delivery_rank"" FROM ""delivery"") AS ""a"" WHERE ""a"".""delivery_rank""=1"
82,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
83,"WITH ""t1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"",MIN(""customer_pref_delivery_date"") AS ""customer_pref_delivery_date"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(COUNT((CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE NULL END)*1.0)/COUNT(1)*100.0, 2) AS ""immediate_percentage"" FROM ""t1"""
84,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
85,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
86,"WITH ""final1"" AS (WITH ""final"" AS (WITH ""cte"" AS (SELECT ""a"".""delivery_id"",""a"".""customer_id"",""a"".""order_date"",""a"".""customer_pref_delivery_date"" FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""first_order_date"" FROM ""Delivery"") AS ""a"" WHERE ""order_date""=""first_order_date"") SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'Immediate' ELSE 'Scheduled' END AS ""status"" FROM ""cte"") SELECT ""status"",COUNT(""status"") OVER (PARTITION BY ""status"") AS ""status_count"",COUNT(1) OVER () AS ""total"" FROM ""final"") SELECT DISTINCT ROUND((""status_count""/""total"")*100, 2) AS ""immediate_percentage"" FROM ""final1"" WHERE ""status""='Immediate'"
87,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
88,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(COUNT(CASE WHEN ""customer_pref_delivery_date""=""first_order_date"" THEN 1 ELSE NULL END)/COUNT(""f"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""delivery"" AS ""d"" RIGHT JOIN ""first_order"" AS ""f"" ON ""f"".""first_order_date""=""d"".""order_date"" AND ""f"".""customer_id""=""d"".""customer_id"""
89,"WITH ""s1"" AS (SELECT ""customer_id"" AS ""id"",MIN(""order_date"") AS ""d1"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(100*AVG(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d"" JOIN ""s1"" ON ""s1"".""id""=""d"".""customer_id"" AND ""s1"".""d1""=""d"".""order_date"""
90,"WITH ""base"" AS (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""a"" WHERE ""rk""=1), ""base2"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""flag"" FROM ""base"") SELECT ROUND((SUM(""flag"")/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM ""base2"""
91,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""abc"" FROM ""delivery"") AS ""a"" WHERE ""abc""=1"
92,"SELECT ROUND(SUM(""immediate"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END AS ""immediate"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order"" FROM ""delivery"") AS ""d"" WHERE ""d"".""first_order""=1"
93,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"" GROUP BY ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"") AS ""a"" WHERE ""rnk""=1"
94,"SELECT ROUND(SUM(CASE WHEN ""delivery1"".""order_date""=""delivery1"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(""delivery1"".""delivery_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""delivery1"" LEFT JOIN ""Delivery"" AS ""delivery2"" ON ""delivery1"".""customer_id""=""delivery2"".""customer_id"" AND ""delivery1"".""order_date"">""delivery2"".""order_date"" WHERE ""delivery2"".""order_date"" IS NULL"
95,"WITH ""CTE_1"" AS (SELECT ""CUSTOMER_ID"",MIN(""ORDER_DATE"") AS ""EARLIEST_DATE"" FROM ""DELIVERY"" GROUP BY ""CUSTOMER_ID""), ""CTE_2"" AS (SELECT ""D"".""CUSTOMER_ID"",COUNT(1) AS ""IMM_COUNT"" FROM (""DELIVERY"" AS ""D"") JOIN ""CTE_1"" AS ""C"" WHERE ""D"".""CUSTOMER_ID""=""C"".""CUSTOMER_ID"" AND ""D"".""CUSTOMER_PREF_DELIVERY_DATE""=""C"".""EARLIEST_DATE"" GROUP BY ""D"".""CUSTOMER_ID""), ""CTE_3"" AS (SELECT COUNT(DISTINCT ""D"".""CUSTOMER_ID"") AS ""SCHED_COUNT"" FROM (""DELIVERY"" AS ""D"") JOIN ""CTE_1"" AS ""C"" WHERE ""D"".""CUSTOMER_ID""=""C"".""CUSTOMER_ID"" AND ""D"".""CUSTOMER_PREF_DELIVERY_DATE""!=""C"".""EARLIEST_DATE"" AND ""D"".""CUSTOMER_ID"" NOT IN (SELECT ""CUSTOMER_ID"" FROM ""CTE_2"")) SELECT ROUND((SUM(""IMM_COUNT"")/(SUM(""IMM_COUNT"")+""SCHED_COUNT""))*100, 2) AS ""IMMEDIATE_PERCENTAGE"" FROM (""CTE_2"") JOIN ""CTE_3"""
96,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")) SELECT ROUND(100*(SELECT COUNT(""order_date"") FROM ""cte"" WHERE ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(""order_date"") FROM ""cte""), 2) AS ""immediate_percentage"""
97,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
98,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
99,"WITH ""first_orders"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""delivery"" GROUP BY 1) SELECT CAST((COUNT(DISTINCT CASE WHEN ""d"".""order_date""=""customer_pref_delivery_date"" THEN ""delivery_id"" ELSE NULL END)/COUNT(DISTINCT ""delivery_id""))*100 AS DECIMAL(5, 2)) AS ""immediate_percentage"" FROM ""first_orders"" AS ""f"" JOIN ""delivery"" AS ""d"" ON ""f"".""customer_id""=""d"".""customer_id"" AND ""f"".""order_date""=""d"".""order_date"""
100,"WITH ""cte"" AS (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rorder"" FROM ""delivery""), ""cte2"" AS (SELECT ""customer_id"",""delivery_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""timeframe"" FROM ""cte"" WHERE ""rorder""=1) SELECT ROUND(((SELECT COUNT(""delivery_id"") FROM ""cte2"" WHERE ""timeframe""='immediate')/((SELECT COUNT(""delivery_id"") FROM ""cte2"" WHERE ""timeframe""='scheduled')+(SELECT COUNT(""delivery_id"") FROM ""cte2"" WHERE ""timeframe""='immediate')))*100, 2) AS ""immediate_percentage"""
101,"WITH ""t"" AS (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t0"" WHERE ""rnk""=1) SELECT ROUND(100*SUM(""immediate"")/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT *,CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END AS ""immediate"" FROM ""t"") AS ""t1"""
102,"WITH ""fobase"" AS (SELECT ""delivery_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery""), ""firstorders"" AS (SELECT COUNT(""a"".""delivery_id"") AS ""den"" FROM (""Delivery"" AS ""a"") JOIN ""fobase"" AS ""b"" WHERE ""a"".""delivery_id""=""b"".""delivery_id"" AND ""b"".""rnk""=1), ""immediatefirstorders"" AS (SELECT COUNT(""a"".""delivery_id"") AS ""num"" FROM (""Delivery"" AS ""a"") JOIN ""fobase"" AS ""b"" WHERE ""a"".""delivery_id""=""b"".""delivery_id"" AND ""b"".""rnk""=1 AND ""a"".""order_date""=""a"".""customer_pref_delivery_date"") SELECT ROUND((""num""/""den"")*100, 2) AS ""immediate_percentage"" FROM (""immediatefirstorders"") JOIN ""firstorders"""
103,"SELECT ROUND((SUM(CASE WHEN ""pref""=""first_order_date"" THEN 1 ELSE 0 END)/COUNT(""pref""))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""f"""
104,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
105,"SELECT ROUND(COALESCE(SUM(CASE WHEN ""a"".""first_order""=""b"".""customer_pref_delivery_Date"" THEN 1 ELSE 0 END)/COUNT(""a"".""first_order"")*100, 0), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1) AS ""a"" JOIN ""delivery"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""first_order""=""b"".""order_date"""
106,"WITH ""t1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""firstOrderDate"" FROM ""Delivery"" GROUP BY ""customer_id""), ""t2"" AS (SELECT ""d"".""customer_id"",""t1"".""firstOrderDate"",""d"".""customer_pref_delivery_date"" FROM ""Delivery"" AS ""d"" RIGHT JOIN ""t1"" ON ""d"".""customer_id""=""t1"".""customer_id"" AND ""d"".""order_date""=""t1"".""firstOrderDate"") SELECT ROUND((SUM(CASE WHEN ""firstOrderDate""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM ""t2"""
107,"WITH ""delivery"" AS (SELECT ""first_order"".""customer_id"",""first_order"".""min_order_date"",""d"".""customer_pref_delivery_date"" FROM ""Delivery"" AS ""d"" RIGHT JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_order_date"" FROM ""Delivery"" GROUP BY 1) AS ""first_order"" ON ""first_order"".""customer_id""=""d"".""customer_id"" AND ""first_order"".""min_order_date""=""d"".""order_date"") SELECT ROUND(SUM(CASE WHEN ""min_order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""delivery"""
108,"SELECT ROUND(100*SUM(""immediate_flag"")/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate_flag"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""Delivery"") AS ""_"" WHERE ""ranking""=1"
109,"SELECT ROUND(100*SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
110,"SELECT 100*ROUND(COUNT(DISTINCT ""t"".""customer_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery""), 4) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""t"".""order_date""=""t"".""customer_pref_delivery_date"" AND ""rnk""=1"
111,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM (SELECT * FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t1"" WHERE ""rnk""=1) AS ""t2"""
112,"SELECT COALESCE(ROUND(COUNT(DISTINCT ""temp"".""delivery_id"")*100/COUNT(DISTINCT ""d"".""customer_id""), 2), 0) AS ""immediate_percentage"" FROM (SELECT DISTINCT * FROM ""Delivery"" AS ""d"" RIGHT JOIN (SELECT ""customer_id"" AS ""customer_id_new"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"" ON ""t"".""customer_id_new""=""d"".""customer_id"" AND ""d"".""order_date""=""t"".""first_order_date"") AS ""temp"", ""Delivery"" AS ""d"" WHERE ""temp"".""order_date"" - ""temp"".""customer_pref_delivery_date""=0"
113,"SELECT ROUND(100*AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
114,"SELECT ROUND(100*(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END))/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""order_date"",""customer_id"") IN (SELECT MIN(""order_date"") AS ""a"",""customer_id"" FROM ""delivery"" GROUP BY ""customer_id"")"
115,"WITH ""cte"" AS (SELECT ""delivery_id"",COUNT(""delivery_id"") OVER (ORDER BY ""order_date"") AS ""cnt"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""sub"" WHERE ""rnk""=1) AS ""sub1""), ""cte1"" AS (SELECT ""delivery_id"",COUNT(""delivery_id"") OVER (ORDER BY ""order_date"") AS ""cnt"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""sub"" WHERE ""rnk""=1) AS ""sub1"" WHERE ""order_date""=""customer_pref_delivery_date"") SELECT ROUND(MAX(""cte1"".""cnt"")/MAX(""cte"".""cnt"")*100, 2) AS ""immediate_percentage"" FROM ""cte1"" RIGHT JOIN ""cte"" ON ""cte1"".""delivery_id""=""cte"".""delivery_id"""
116,"SELECT ROUND(100*AVG(""a"".""order_date""=""a"".""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_rank"" FROM ""Delivery"") AS ""a"" WHERE ""a"".""date_rank""=1"
117,"SELECT ROUND(100*COALESCE(SUM(CASE WHEN ""a"".""order_date""=""a"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 0), 2) AS ""immediate_percentage"" FROM ""delivery"" AS ""a"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1) AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date""=""b"".""first_order"""
118,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
119,"WITH ""cte"" AS (SELECT * FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery"") AS ""r1"" WHERE ""rk""=1) SELECT ROUND(SUM(""imm"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""imm"" FROM ""cte"") AS ""r1"""
120,"WITH ""temp1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""delivery"" ORDER BY ""customer_id"",""order_date""), ""temp2"" AS (SELECT * FROM ""temp1"" WHERE ""order_date""=""customer_pref_delivery_date"" AND ""r""=1) SELECT ROUND(100*COUNT(DISTINCT ""temp2"".""customer_id"")/COUNT(DISTINCT ""temp1"".""customer_id""), 2) AS ""immediate_percentage"" FROM (""temp1"") JOIN ""temp2"""
121,"SELECT ROUND(AVG(""pref"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN '1' ELSE '0' END AS ""pref"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""R"" FROM ""Delivery"") AS ""temp"" WHERE ""R""=1"
122,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
123,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rk""=1"
124,"WITH ""FIRST_ORDER"" AS (SELECT ""DELIVERY_ID"",""CUSTOMER_ID"",CASE WHEN ""ORDER_DATE""=""CUSTOMER_PREF_DELIVERY_DATE"" THEN 1 ELSE 0 END AS ""IMMEDIATE_DELIVERY"",RANK() OVER (PARTITION BY ""CUSTOMER_ID"" ORDER BY ""ORDER_DATE"") AS ""RN"" FROM ""DELIVERY"") SELECT ROUND(SUM(""IMMEDIATE_DELIVERY"")/COUNT(1)*100, 2) AS ""IMMEDIATE_PERCENTAGE"" FROM ""FIRST_ORDER"" WHERE ""RN""=1"
125,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"" GROUP BY 1,2) AS ""ST"" WHERE ""rnk""=1"
126,"SELECT ROUND((SUM(""pref""=""first_order"")/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order"" FROM ""Delivery"" GROUP BY 1) AS ""f"""
127,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""mindate"" FROM ""delivery"" GROUP BY ""customer_id"")"
128,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY 1)) AS ""tmp"""
129,"SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""rnk""=1"
130,"WITH ""order_rank"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""RNK"" FROM ""Delivery""), ""first_order"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM ""order_rank"" WHERE ""RNK""=1) SELECT ROUND((COUNT(""customer_id"")/(SELECT COUNT(""customer_id"") FROM ""first_order""))*100, 2) AS ""immediate_percentage"" FROM ""first_order"" WHERE ""order_date""=""customer_pref_delivery_date"""
131,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT (""customer_id"")), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""CUSTOMER_ID"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
132,"WITH ""a"" AS (SELECT * FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""Delivery"" GROUP BY ""customer_id"")) SELECT ROUND(""imm""/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (""a"") JOIN (SELECT COUNT(""delivery_id"") AS ""imm"" FROM ""a"" WHERE ""order_date""=""customer_pref_delivery_date"") AS ""b"""
133,"SELECT ROUND(SUM(""delivery_type"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""delivery_type"" FROM ""Delivery"") AS ""a"" WHERE ""rnk""=1"
134,"WITH ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank1"" FROM ""delivery"" ORDER BY ""customer_id"",""order_date""), ""t2"" AS (SELECT * FROM ""t1"" WHERE ""rank1""=1 AND ""order_date""=""customer_pref_delivery_date"") SELECT ROUND((100*COUNT(DISTINCT ""t2"".""customer_id""))/COUNT(DISTINCT ""delivery"".""customer_id""), 2) AS ""immediate_percentage"" FROM (""delivery"") JOIN ""t2"""
135,"SELECT ROUND(100*SUM(CASE WHEN ""C"".""customer_pref_delivery_date""=""C"".""order_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""A"".""order_date"",""A"".""customer_pref_delivery_date"" FROM ""Delivery"" AS ""A"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""dat"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""B"" ON ""A"".""order_date""=""B"".""dat"" AND ""A"".""customer_id""=""B"".""customer_id"") AS ""C"""
136,"SELECT ROUND(COUNT(DISTINCT ""fo"".""customer_id"")/COUNT(DISTINCT ""d"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1) AS ""fo"" RIGHT JOIN ""delivery"" AS ""d"" ON ""d"".""customer_id""=""fo"".""customer_id"" AND ""d"".""customer_pref_delivery_date""=""fo"".""first_order"""
137,"WITH ""cte"" AS (SELECT ""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""early"" FROM ""Delivery"" ORDER BY ""customer_id"") SELECT ROUND(COUNT(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE NULL END)/(SELECT COUNT(CASE WHEN ""early""=1 THEN 1 ELSE NULL END))*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""early""=1"
138,"SELECT ROUND(100*(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id"")), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
139,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""f_order"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND((SUM(CASE WHEN ""d"".""customer_pref_delivery_date"" IS NULL THEN 0 ELSE 1 END)/COUNT(""f"".""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""first_order"" AS ""f"" LEFT JOIN ""Delivery"" AS ""d"" ON ""f"".""customer_id""=""d"".""customer_id"" AND ""f"".""f_order""=""d"".""customer_pref_delivery_date"""
140,"WITH ""t"" AS (SELECT ""delivery_id"",""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(100*AVG(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d"" JOIN ""t"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""order_date"""
141,"WITH ""cte"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(COUNT(CASE WHEN ""a"".""order_date""=""a"".""customer_pref_delivery_date"" THEN 1 END)*100/COUNT(""a"".""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date""=""b"".""first_order"""
142,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"")"
143,"SELECT ROUND(AVG(""first_order""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""first_order"" FROM ""delivery"") AS ""t"" WHERE ""first_order""=""order_date"""
144,"WITH ""cte"" AS (SELECT ""delivery_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1,2) SELECT ROUND(100*SUM(CASE WHEN ""c"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""d"".""customer_id""), 2) AS ""immediate_percentage"" FROM ""cte"" AS ""c"" JOIN ""delivery"" AS ""d"" ON ""c"".""delivery_id""=""d"".""delivery_id"" WHERE ""c"".""first_order""=1"
145,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""a"" WHERE ""rn""=1"
146,"WITH ""cte1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id""), ""cte2"" AS (SELECT ""delivery"".""customer_id"",""order_date"",""customer_pref_delivery_date"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END) AS ""delivery_type"" FROM ""delivery"" JOIN ""cte1"" WHERE ""order_date""=""first_order_date"" AND ""delivery"".""customer_id""=""cte1"".""customer_id"") SELECT ROUND(SUM(CASE WHEN ""delivery_type""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte2"""
147,"SELECT ROUND(100*SUM(CASE WHEN ""order_Date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
148,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
149,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
150,"SELECT ROUND(100*AVG(""order_date""=""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
151,"WITH ""tb"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""delivery_status"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery""), ""tb2"" AS (SELECT COUNT(DISTINCT ""customer_id"") AS ""imm_ct"" FROM ""tb"" WHERE ""delivery_status""='immediate' AND ""rk""=1), ""tb3"" AS (SELECT COUNT(DISTINCT ""customer_id"") AS ""first_ct"" FROM ""tb"" WHERE ""rk""=1) SELECT ROUND((""tb2"".""imm_ct""/""tb3"".""first_ct"")*100, 2) AS ""immediate_percentage"" FROM (""tb2"") JOIN ""tb3"""
152,"WITH ""cte"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") SELECT ROUND(100*SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rn""=1"
153,"WITH ""cte"" AS (SELECT ""delivery_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rank"" FROM ""Delivery"") AS ""temp"" WHERE ""order_rank""=1) SELECT ROUND(COUNT(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE NULL END)*100/COUNT(""delivery_id""), 2) AS ""immediate_percentage"" FROM ""cte"""
154,"WITH ""min_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""min_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND((SUM(CASE WHEN ""customer_pref_delivery_date""=""Delivery"".""order_date"" THEN 1 ELSE 0 END)/COUNT(""Delivery"".""customer_id""))*100, 2) AS ""immediate_percentage"" FROM (""Delivery"") JOIN ""min_order"" WHERE ""Delivery"".""customer_id""=""min_order"".""customer_id"" AND ""Delivery"".""order_date""=""min_order"".""min_order_date"""
155,"WITH ""temp1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""delivery"" ORDER BY ""customer_id"",""order_date""), ""temp2"" AS (SELECT * FROM ""temp1"" WHERE ""order_date""=""customer_pref_delivery_date"" AND ""r""=1) SELECT ROUND(100*COUNT(DISTINCT ""temp2"".""customer_id"")/COUNT(DISTINCT ""temp1"".""customer_id""), 2) AS ""immediate_percentage"" FROM (""temp1"") JOIN ""temp2"""
156,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rk""=1"
157,"WITH ""cte"" AS (SELECT * FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery"") AS ""r1"" WHERE ""rk""=1) SELECT ROUND(SUM(""imm"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""imm"" FROM ""cte"") AS ""r1"""
158,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery""), ""etc"" AS (SELECT ""order_date"",""customer_id"" FROM ""Delivery"" WHERE ""order_date""=""customer_pref_delivery_date""), ""cte2"" AS (SELECT COUNT(""etc"".""customer_id"") AS ""cnt"" FROM ""cte"" JOIN ""etc"" ON ""cte"".""order_date""=""etc"".""order_date"" AND ""cte"".""customer_id""=""etc"".""customer_id"" WHERE ""cte"".""rk""=1) SELECT ROUND((""cnt""/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery""))*100, 2) AS ""immediate_percentage"" FROM ""cte2"""
159,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
160,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"" AS ""d"") AS ""tmp"" WHERE ""rnk""=1"
161,"WITH ""agg"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""fst_dt"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN ""delivery_id"" ELSE NULL END)/COUNT(DISTINCT ""d"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""agg"" JOIN ""delivery"" AS ""d"" ON ""agg"".""customer_id""=""d"".""customer_id"" AND ""agg"".""fst_dt""=""d"".""order_date"""
162,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
163,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY 1), ""order_status"" AS (SELECT ""d"".""delivery_id"",CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""status"" FROM ""Delivery"" AS ""d"" JOIN ""first_order"" AS ""fo"" ON (""d"".""order_date""=""fo"".""first_date"" AND ""d"".""customer_id""=""fo"".""customer_id"")), ""ranking"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND((SELECT COUNT(DISTINCT ""delivery_id"") FROM ""order_status"" WHERE ""status""=1)/(SELECT COUNT(DISTINCT ""delivery_id"") FROM ""order_status"")*100, 2) AS ""immediate_percentage"""
164,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""temp"" WHERE ""temp"".""rk""=1"
165,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
166,"WITH ""cte"" AS (SELECT ""d"".""customer_id"",""min_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"" JOIN ""Delivery"" AS ""d"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""min_date"") SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""cte"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""min_date""=""customer_pref_delivery_date"""
167,"WITH ""cte"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"",MIN(""customer_pref_delivery_date"") AS ""customer_pref_delivery_date"" FROM ""Delivery"" GROUP BY ""customer_id"" ORDER BY ""customer_id"") SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""cte"""
168,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
169,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT (""customer_id"")) FROM ""Delivery"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ""order_date""=""customer_pref_delivery_date"" AND ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
170,"SELECT ROUND((SUM(""pref""=""first_order_date"")/COUNT(""pref""))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""f"""
171,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""d"".""order_date"") AS ""first_order"" FROM ""delivery"" AS ""d"" GROUP BY 1) SELECT ROUND(AVG(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END), 4)*100 AS ""immediate_percentage"" FROM ""delivery"" AS ""d"" WHERE ""d"".""order_date""=(SELECT ""first_order"" FROM ""first_order"" AS ""fo"" WHERE ""fo"".""customer_id""=""d"".""customer_id"")"
172,"SELECT ROUND(100*SUM(""c"".""immediate"")/COUNT(""c"".""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT ""a"".""customer_id"",CASE WHEN TIMESTAMPDIFF(DAY, ""a"".""order_date"", ""a"".""customer_pref_delivery_date"")=0 THEN 1 ELSE 0 END AS ""immediate"" FROM ""Delivery"" AS ""a"" JOIN ""Delivery"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date"">=""b"".""order_date"" GROUP BY ""a"".""customer_id"",""a"".""order_date"" HAVING COUNT(""b"".""order_date"")=1) AS ""c"""
173,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
174,"SELECT ROUND(""c3"".""cnt2""/""c1"".""cnt1""*100, 2) AS ""immediate_percentage"" FROM (SELECT COUNT(DISTINCT ""d"".""customer_id"") AS ""cnt1"" FROM ""delivery"" AS ""d"") AS ""c1"", (SELECT COUNT(""c2"".""customer_id"") AS ""cnt2"" FROM (SELECT ""d2"".""customer_id"" FROM ""delivery"" AS ""d2"" GROUP BY ""d2"".""customer_id"" HAVING MIN(""d2"".""order_date"")=MIN(""customer_pref_delivery_date"")) AS ""c2"") AS ""c3"""
175,"SELECT ROUND(100*SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"" AS ""d"") AS ""tmp"" WHERE ""rnk""=1"
176,"SELECT ROUND(SUM(""TYPE""='immediate')/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""TEMP"".""customer_id"",""TEMP"".""delivery_id"",(CASE WHEN ""TEMP"".""order_date""=""TEMP"".""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END) AS ""TYPE"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""RNK"" FROM ""Delivery"") AS ""TEMP"" WHERE ""RNK""=1) AS ""TEMP2"""
177,"SELECT ROUND(SUM(CASE WHEN ""Delivery"".""order_date""=""Delivery"".""customer_pref_delivery_date"" THEN '1' ELSE 0 END)/COUNT(""Delivery"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" LEFT JOIN ""Delivery"" AS ""Ref"" ON ""Ref"".""customer_id""=""Delivery"".""customer_id"" AND ""Ref"".""order_date""<""Delivery"".""order_date"" WHERE ""Ref"".""customer_id"" IS NULL"
178,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100.0/COUNT(""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rk"" FROM ""Delivery"") AS ""x"" WHERE ""order_rk""=1"
179,"WITH ""tmp"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""type"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranks"" FROM ""Delivery"") AS ""t"" WHERE ""t"".""ranks""=1) SELECT ROUND(COUNT(DISTINCT ""delivery_id"")/(SELECT COUNT(DISTINCT ""delivery_id"") FROM ""tmp"")*100, 2) AS ""immediate_percentage"" FROM ""tmp"" WHERE ""type""='immediate'"
180,"SELECT ROUND(SUM(CASE WHEN ""d1"".""order_date""=""d1"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/(COUNT(""d1"".""order_date"")), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d1"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""d2"" ON ""d1"".""order_date""=""d2"".""order_date"" AND ""d1"".""customer_id""=""d2"".""customer_id"""
181,"WITH ""cte"" AS (SELECT ""delivery_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_number"" FROM ""Delivery"") SELECT ROUND((SELECT COUNT(1) FROM ""cte"" WHERE ""order_date""=""customer_pref_delivery_date"" AND ""order_number""=1)*100/(SELECT COUNT(1) FROM ""cte"" WHERE ""order_number""=1), 2) AS ""immediate_percentage"""
182,"SELECT CAST(""i"".""immediate""/""b"".""allFirst""*100 AS DECIMAL(10, 2)) AS ""immediate_percentage"" FROM (SELECT 1 AS ""k"",COUNT(1) AS ""immediate"" FROM ""Delivery"" AS ""d"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""f"" ON ""d"".""customer_id""=""f"".""customer_id"" WHERE ""d"".""order_date""=""f"".""first_date"" AND ""d"".""customer_pref_delivery_date""=""f"".""first_date"") AS ""i"" JOIN (SELECT 1 AS ""k"",COUNT(1) AS ""allFirst"" FROM ""Delivery"" AS ""d"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""f"" ON ""d"".""customer_id""=""f"".""customer_id"" WHERE ""d"".""order_date""=""f"".""first_date"") AS ""b"" ON ""i"".""k""=""b"".""k"""
183,"WITH ""orders_rnked"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rnk"" FROM ""Delivery"") SELECT ROUND(100*COUNT(DISTINCT CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN ""delivery_id"" ELSE NULL END)/COUNT(DISTINCT ""delivery_id""), 2) AS ""immediate_percentage"" FROM ""orders_rnked"" WHERE ""order_rnk""=1"
184,"WITH ""nn"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""sch"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND(SUM(""sch"")/COUNT(DISTINCT ""customer_id""), 4)*100 AS ""immediate_percentage"" FROM ""nn"" WHERE ""rnk""=1"
185,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY 1) AS ""t"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""first_date"""
186,"SELECT ROUND(COUNT(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN ""delivery_id"" ELSE NULL END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""delivery"") AS ""t"" WHERE ""rn""=1) AS ""s"""
187,"WITH ""cte"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""status_delivery"" FROM ""Delivery"") SELECT ROUND((SUM(CASE WHEN ""status_delivery""='immediate' THEN 1 ELSE 0 END)/COUNT(""status_delivery""))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""t"" JOIN ""cte"" ON ""t"".""delivery_id""=""cte"".""delivery_id"" WHERE ""rk""=1"
188,"WITH ""cte1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id""), ""cte2"" AS (SELECT ""delivery"".""customer_id"",""order_date"",""customer_pref_delivery_date"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END) AS ""delivery_type"" FROM ""delivery"" JOIN ""cte1"" WHERE ""order_date""=""first_order_date"" AND ""delivery"".""customer_id""=""cte1"".""customer_id"") SELECT ROUND(SUM(CASE WHEN ""delivery_type""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte2"""
189,"SELECT ROUND(100*AVG(""order_date""=""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
190,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
191,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
192,"WITH ""cte_delivery"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND(SUM(""order_date"" - ""customer_pref_delivery_date""=0)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""cte_delivery"" WHERE ""rnk""=1"
193,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN '1' ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rank"" FROM ""Delivery"") AS ""RankedOrders"" WHERE ""order_rank""=1"
194,"SELECT ROUND(100*AVG(""order_date""=""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
195,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""timing"" FROM ""delivery"") SELECT ROUND((COUNT(1)/(SELECT COUNT(1) FROM ""cte"" WHERE ""ranking""=1))*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""ranking""=1 AND ""timing""='immediate'"
196,"SELECT ROUND(100*SUM(""a"".""order_date""=""a"".""customer_pref_delivery_date"")/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_rank"" FROM ""Delivery"") AS ""a"" WHERE ""a"".""date_rank""=1"
197,"WITH ""temp"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""note"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")) SELECT ROUND(SUM(""note""='immediate')/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM ""temp"""
198,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""orderrank"" FROM ""delivery"") SELECT ROUND(((SELECT COUNT(""customer_id"") AS ""imm_order_cnt"" FROM ""cte"" WHERE ""orderrank""=1 AND ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(""customer_id"") FROM ""cte"" WHERE ""orderrank""=1))*100, 2) AS ""immediate_percentage"""
199,"WITH ""cte"" AS (SELECT ""d"".""customer_id"",RANK() OVER (PARTITION BY ""d"".""customer_id"" ORDER BY ""d"".""order_date"") AS ""ordernum"",CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""orderstatus"" FROM ""Delivery"" AS ""d"") SELECT ROUND(100*(SUM(""orderstatus""='immediate')/COUNT(1)), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""ordernum""=1"
200,"SELECT ROUND((SELECT COUNT(1) FROM ""delivery"" AS ""a"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1) AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date""=""b"".""first_order"" WHERE ""a"".""order_date""=""a"".""customer_pref_delivery_date"")/(SELECT COUNT(1) FROM ""delivery"" AS ""a"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1) AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date""=""b"".""first_order"")*100, 2) AS ""immediate_percentage"""
201,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_rank"" FROM ""Delivery"" ORDER BY ""customer_id"") SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""date_rank""=1"
202,"SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
203,"SELECT ROUND((SUM(""pref""=""first_order_date"")/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY 1) AS ""f"""
204,"WITH ""cte"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""delivery"" GROUP BY 1) SELECT ROUND(SUM(""delivery"".""order_date""=""customer_pref_delivery_date"")/COUNT(""cte"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" LEFT JOIN ""delivery"" ON ""cte"".""customer_id""=""delivery"".""customer_id"" AND ""cte"".""first_date""=""delivery"".""order_date"""
205,"SELECT CASE WHEN ""immediate""+""sched""=0 THEN 0 ELSE ROUND(""immediate""/(""immediate""+""sched"")*100, 2) END AS ""immediate_percentage"" FROM (SELECT SUM(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""immediate"",SUM(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 0 ELSE 1 END) AS ""sched"" FROM (""Delivery"" AS ""d"") JOIN (SELECT MIN(""order_date"") AS ""order_date"",""customer_id"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""x"" WHERE ""d"".""customer_id""=""x"".""customer_id"" AND ""d"".""order_date""=""x"".""order_date"") AS ""y"""
206,"SELECT ROUND(SUM(""customer_pref_delivery_date""=""first_date"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""first_date"" FROM ""delivery"") AS ""t"" WHERE ""order_date""=""first_Date"""
207,"SELECT ROUND((SUM(CASE WHEN ""a"".""order_date""=""a"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""row_num"" FROM ""Delivery"") AS ""a"" WHERE ""row_num""=1"
208,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""n"" FROM ""Delivery"") SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""n""=1"
209,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""delivery"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"" FROM ""delivery"" GROUP BY ""customer_id"" HAVING MIN(""order_date"")=MIN(""customer_pref_delivery_date"")) AS ""a"""
210,"SELECT ROUND((SUM(CASE WHEN ""a"".""order_date""=""a"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_num"" FROM ""Delivery"") AS ""a"" WHERE ""rank_num""=1"
211,"WITH ""t"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"",MIN(""customer_pref_delivery_date"") AS ""deliv_date"" FROM ""delivery"" GROUP BY 1) SELECT ROUND(SUM(CASE WHEN ""first_date""=""deliv_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""t"""
212,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
213,"WITH ""t1"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""delivery"" GROUP BY 1,2), ""t2"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM ""t1"" WHERE ""rn""=1) SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""t2"""
214,"WITH ""cte"" AS (SELECT ""t1"".""customer_id"",""t1"".""order_date"",""t2"".""first_order_date"",""t1"".""customer_pref_delivery_date"",CASE WHEN ""t1"".""order_date""=""t1"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate_order"",CASE WHEN ""t1"".""order_date""=""t2"".""first_order_date"" THEN 1 ELSE 0 END AS ""first_order"" FROM ""Delivery"" AS ""t1"" LEFT JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"") SELECT ROUND(100*SUM(""immediate_order"")/SUM(""first_order""), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""first_order""=1"
215,"SELECT ROUND(SUM(CASE WHEN ""order_type""='immediate' THEN 1 ELSE 0 END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""drv"".*,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_type"" FROM ""delivery"" AS ""drv"") AS ""a"" WHERE ""a"".""rn""=1"
216,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND(((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
217,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
218,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""min_order"" FROM ""delivery"" AS ""d"" GROUP BY 1), ""list_of_first_orders"" AS (SELECT ""d"".* FROM ""delivery"" AS ""d"" JOIN ""first_order"" AS ""fo"" ON ""fo"".""customer_id""=""d"".""customer_id"" AND ""min_order""=""d"".""order_date""), ""same_day"" AS (SELECT COUNT(DISTINCT ""delivery_id"") AS ""same_day_orders"" FROM ""list_of_first_orders"" AS ""l"" WHERE ""order_date""=""customer_pref_delivery_date""), ""all_orders"" AS (SELECT COUNT(DISTINCT ""delivery_id"") AS ""total_orders"" FROM ""list_of_first_orders"" AS ""l"") SELECT ROUND(""same_day_orders""/""total_orders""*100, 2) AS ""immediate_percentage"" FROM (""same_day"" AS ""sd"") JOIN ""all_orders"" AS ""ao"""
219,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
220,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
221,"SELECT ROUND(((SELECT COUNT(1) FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""a"" LEFT JOIN ""Delivery"" AS ""d"" ON ""a"".""customer_id""=""d"".""customer_id"" WHERE ""delivery_id""=""delivery_id"" AND ""a"".""first_order_date""=""d"".""customer_pref_delivery_date"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery"")*100), 2) AS ""immediate_percentage"""
222,"WITH ""cte1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id""), ""cte2"" AS (SELECT ""delivery"".""customer_id"",""delivery"".""order_date"",""delivery"".""customer_pref_delivery_date"",(CASE WHEN ""delivery"".""order_date""=""delivery"".""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END) AS ""delivery_type"" FROM ""delivery"" JOIN ""cte1"" WHERE ""delivery"".""order_date""=""cte1"".""first_order_date"" AND ""delivery"".""customer_id""=""cte1"".""customer_id"") SELECT ROUND(SUM(CASE WHEN ""delivery_type""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte2"""
223,"SELECT ROUND(100*COALESCE(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(""customer_id""), 0), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d2"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" AS ""d1"" GROUP BY ""customer_id"")"
224,"WITH ""cte_orders"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_seq"" FROM ""Delivery""), ""cte_order_agg"" AS (SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte_orders"" WHERE ""order_seq""=1) SELECT * FROM ""cte_order_agg"""
225,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'Immediate' ELSE 'Scheduled' END AS ""status"" FROM ""delivery"") AS ""a"") SELECT ROUND(((SUM(CASE WHEN ""status""='Immediate' THEN 1 ELSE 0 END)/COUNT(1))*100), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
226,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""T1"" WHERE ""rnk""=1"
227,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order"" FROM ""delivery"") AS ""a"" WHERE ""first_order""=1"
228,"WITH ""cte"" AS (SELECT ""d"".""customer_id"",""min_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"" JOIN ""Delivery"" AS ""d"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""min_date"") SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""cte"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""min_date""=""customer_pref_delivery_date"""
229,"WITH ""cte"" AS (SELECT ""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_order"" FROM ""Delivery"") SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""date_order""=1"
230,"WITH ""first_order"" AS (SELECT * FROM (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order"" FROM ""Delivery"" ORDER BY ""customer_id"",""order_date"") AS ""a"" WHERE ""first_order""=1), ""immediate"" AS (SELECT *,(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' WHEN ""order_date""!=""customer_pref_delivery_date"" THEN 'schedule' END) AS ""i_s"" FROM ""first_order"") SELECT ROUND(100*((SELECT COUNT(1) FROM ""immediate"" WHERE ""i_s"" IN ('immediate'))/(SELECT COUNT(1) FROM ""immediate"")), 2) AS ""immediate_percentage"""
231,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
232,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""minorder"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT (ROUND((SUM(CASE WHEN ""minorder""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/(SELECT COUNT(1) FROM ""first_order""))*100, 2)) AS ""immediate_percentage"" FROM ""delivery"" AS ""d"" JOIN ""first_order"" AS ""fo"" ON ""fo"".""customer_id""=""d"".""customer_id"""
233,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
234,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery""), ""cte2"" AS (SELECT SUM(CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END)*100 AS ""num"",COUNT(""delivery_id"") AS ""den"" FROM ""cte"" WHERE ""rnk""=1) SELECT ROUND(""num""/""den""*1.0, 2) AS ""immediate_percentage"" FROM ""cte2"""
235,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""RNK"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""RNK""=1"
236,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""temp"" WHERE ""temp"".""rk""=1"
237,"SELECT ROUND((100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)), 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY ""customer_id"")"
238,"WITH ""cte"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""imm_order"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_no"" FROM ""delivery"") SELECT ROUND(100*SUM(""imm_order"")/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""order_no""=1"
239,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""delivery"") AS ""a"" WHERE ""ranking""=1"
240,"WITH ""firsts"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""Delivery"" ORDER BY 2) SELECT ROUND(""first_cnt""/COUNT(DISTINCT ""t1"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""firsts"" AS ""t1"" JOIN (SELECT COUNT(1) AS ""first_cnt"" FROM ""delivery"" AS ""a"" JOIN ""firsts"" AS ""b"" ON ""a"".""delivery_id""=""b"".""delivery_id"" WHERE ""b"".""ranking""=1 AND ""a"".""order_date""=""a"".""customer_pref_delivery_date"") AS ""t2"""
241,"SELECT ROUND(COALESCE(100*COUNT(DISTINCT CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN ""delivery_id"" ELSE NULL END)/COUNT(DISTINCT ""delivery_id""), 0), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY 1)"
242,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""order_date"",""customer_id"") IN (SELECT MIN(""order_date""),""customer_id"" FROM ""Delivery"" GROUP BY ""customer_id"")"
243,"WITH ""cte"" AS (SELECT ""d"".""customer_id"",""min_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"" JOIN ""Delivery"" AS ""d"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""min_date"") SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""cte"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""min_date""=""customer_pref_delivery_date"""
244,"WITH ""cte"" AS (SELECT ""delivery_id"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1,2) SELECT ROUND(100*SUM(CASE WHEN ""c"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte"" AS ""c"" JOIN ""delivery"" AS ""d"" ON ""c"".""delivery_id""=""d"".""delivery_id"" WHERE ""c"".""first_order""=1"
245,"SELECT ROUND(SUM(CASE WHEN ""flag""='immediate' THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""R"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""flag"" FROM ""delivery"") AS ""T1"" WHERE ""t1"".""R""=1"
246,"WITH ""sql1"" AS (SELECT ""customer_id"",""customer_pref_delivery_date"",""order_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank1"" FROM ""Delivery"") SELECT ROUND((COUNT(DISTINCT CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN ""customer_id"" ELSE NULL END)/COUNT(DISTINCT ""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""sql1"" WHERE ""rank1""=1"
247,"SELECT ROUND(COALESCE(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 0), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT DISTINCT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
248,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
249,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(0), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
250,"WITH ""t"" AS (SELECT *,CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END AS ""doption"" FROM ""Delivery""), ""t1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""Delivery"") SELECT ROUND(SUM(""doption"")/COUNT(""doption"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""doption"" FROM ""t"" RIGHT JOIN ""t1"" ON ""t1"".""order_date""=""t"".""order_date"" AND ""t1"".""customer_id""=""t"".""customer_id"" WHERE ""t1"".""r""=1) AS ""a"""
251,"SELECT ROUND(COUNT(""delivery_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery"")*100, 2) AS ""Immediate_percentage"" FROM (SELECT * FROM (SELECT * FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""dt"",""customer_pref_delivery_date"" FROM ""Delivery"") AS ""t1"" WHERE ""dt""=1) AS ""t2"" WHERE ""order_date""=""customer_pref_delivery_date"") AS ""t3"""
252,"WITH ""first_orders"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""first_orders"" AS ""f"" JOIN ""Delivery"" AS ""d"" ON ""f"".""customer_id""=""d"".""customer_id"" AND ""f"".""first_order_date""=""d"".""order_date"""
253,"SELECT ROUND((SUM(""pref""=""first_order_date"")/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY 1) AS ""f"""
254,"WITH ""cte"" AS (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery""), ""a"" AS (SELECT COUNT(""cte"".""delivery_id"") AS ""first_orders"" FROM ""cte"" WHERE ""cte"".""rnk""=1), ""b"" AS (SELECT SUM(CASE WHEN ""cte"".""order_date""=""cte"".""customer_pref_delivery_date"" AND ""cte"".""rnk""=1 THEN 1 ELSE 0 END) AS ""immediate_orders"" FROM ""cte"") SELECT ROUND(""b"".""immediate_orders""/""a"".""first_orders""*100, 2) AS ""immediate_percentage"" FROM (""a"") JOIN ""b"""
255,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
256,"SELECT ROUND((SUM(CASE WHEN ""f"".""pref""=""f"".""first_order_date"" THEN 1 ELSE 0 END)/COUNT(""f"".""pref"")*100), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""f"""
257,"SELECT ROUND(100.0*COUNT(CASE WHEN ""lag_delivery_id"" IS NULL AND ""customer_pref_delivery_date""=""order_date"" THEN ""delivery_id"" END)/COUNT(CASE WHEN ""lag_delivery_id"" IS NULL THEN ""delivery_id"" END), 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",LAG(""delivery_id"") OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""lag_delivery_id"" FROM ""Delivery"") AS ""d"""
258,"SELECT ROUND(COUNT(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN ""customer_id"" END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
259,"WITH ""early"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""min_order"",MIN(""customer_pref_delivery_date"") AS ""min_pref"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(100*SUM(CASE WHEN ""min_order""=""min_pref"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM ""early"""
260,"WITH ""win"" AS (SELECT CASE WHEN ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"")=1 AND ""order_date""=""customer_pref_delivery_date"" THEN '1' ELSE 0 END AS ""nume"",CASE WHEN ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"")=1 THEN '1' ELSE 0 END AS ""deno"" FROM ""delivery"") SELECT ROUND(SUM(""nume"")*100/SUM(""deno""), 2) AS ""immediate_percentage"" FROM ""win"""
261,"SELECT ROUND(COUNT(""delivery_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery"")*100, 2) AS ""Immediate_percentage"" FROM (SELECT * FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""dt"",""customer_pref_delivery_date"" FROM ""Delivery"") AS ""t1"" WHERE ""dt""=1 AND ""order_date""=""customer_pref_delivery_date"") AS ""t2"""
262,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""order_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""delivery_id"",""customer_id"") IN (SELECT ""delivery_id"",""customer_id"" FROM (SELECT RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_rank"",""delivery_id"",""customer_id"" FROM ""Delivery"") AS ""d"" WHERE ""date_rank""=1)"
263,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
264,"SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
265,"SELECT ROUND(AVG(TIMESTAMPDIFF(DAY, ""customer_pref_delivery_date"", ""order_date"")=0)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY 1)"
266,"SELECT ROUND((COUNT(DISTINCT CASE WHEN ""order_type""='immediate' THEN ""customer_id"" ELSE NULL END)/COUNT(DISTINCT ""customer_id""))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"",""customer_pref_delivery_date"",CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 'immediate' ELSE 'scheduled' END AS ""order_type"" FROM ""delivery"") AS ""a"" WHERE ""rn""=1"
267,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""abc"" FROM ""delivery"") AS ""a"" WHERE ""abc""=1"
268,"SELECT ROUND(SUM(CASE WHEN ""rk""=1 THEN ""i_s"" ELSE 0 END)*100.0/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT *,(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""i_s"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""temp"""
269,"SELECT ROUND(((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""order_date""))*100), 2) AS ""immediate_percentage"" FROM (SELECT *,(RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"")) AS ""rankk"" FROM ""Delivery"") AS ""t"" WHERE ""rankk""=1"
270,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
271,"WITH ""tmp"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery"") SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM ""tmp"" WHERE ""rk""=1"
272,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
273,"SELECT ROUND((SUM(CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END))/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""a"" WHERE ""rk""=1"
274,"WITH ""cte"" AS (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rnk""=1"
275,"WITH ""first_order"" AS (SELECT ""delivery_id"",""customer_id"",MIN(""order_date"") AS ""order_date"",""customer_pref_delivery_date"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/(SELECT COUNT(1) FROM ""first_order""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",""order_date"" FROM ""first_order"")"
276,"SELECT ROUND(100*COUNT(DISTINCT ""a"".""customer_id"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""delivery""), 2) AS ""immediate_percentage"" FROM (SELECT DISTINCT (""customer_id""),""order_date"" FROM ""delivery"" WHERE ""order_date""=""customer_pref_delivery_date"") AS ""a"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""order_date""=""b"".""first_date"""
277,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""firstOrder"" FROM ""Delivery"" GROUP BY ""customer_id"")"
278,"SELECT ROUND(SUM(CASE WHEN ""first_order""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""first_order"" FROM ""delivery"") AS ""a"""
279,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"",MIN(""customer_pref_delivery_date"") AS ""customer_pref_delivery_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"""
280,"WITH ""cte1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id""), ""cte2"" AS (SELECT ""delivery"".""customer_id"",""order_date"",""customer_pref_delivery_date"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END) AS ""delivery_type"" FROM ""delivery"" JOIN ""cte1"" WHERE ""order_date""=""first_order_date"" AND ""delivery"".""customer_id""=""cte1"".""customer_id"") SELECT ROUND(SUM(CASE WHEN ""delivery_type""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte2"""
281,"WITH ""A"" AS (SELECT ""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_rank"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""delivery"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""delivery""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""A"" WHERE ""date_rank""=1"
282,"WITH ""st"" AS (SELECT ""delivery_id"",""customer_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""statues"" FROM ""delivery"") SELECT ROUND(""a"".""num""/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (""st"") JOIN (SELECT COUNT(1) AS ""num"" FROM ""st"" WHERE ""statues""='immediate' AND ""ranking""=1) AS ""a"" WHERE ""ranking""=1"
283,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
284,"WITH ""tb"" AS (SELECT * FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY 1) AND ""order_date""=""customer_pref_delivery_date"") SELECT ROUND(((SELECT COUNT(1) FROM ""tb"")/COUNT(DISTINCT ""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""Delivery"""
285,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
286,"SELECT ROUND((SELECT COUNT(1) FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AND ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""Delivery"")*100, 2) AS ""immediate_percentage"""
287,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery""), ""cte1"" AS (SELECT ""delivery_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""delivery_status"" FROM ""cte"" WHERE ""rnk""=1) SELECT ROUND(COUNT(""delivery_id"")/(SELECT COUNT(1) FROM ""cte1"")*100, 2) AS ""immediate_percentage"" FROM ""cte1"" WHERE ""delivery_status""='immediate'"
288,"WITH ""CET1"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""Delivery"") SELECT ROUND((SELECT COUNT(""customer_id"") FROM ""CET1"" WHERE ""ranking""=1 AND ""order_date""=""customer_pref_delivery_date"")/(SELECT COUNT(""customer_id"") FROM ""CET1"" WHERE ""ranking""=1)*100, 2) AS ""immediate_percentage"""
289,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY ""customer_id"")"
290,"SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""t"".""rnk""=1"
291,"SELECT ROUND(COUNT(DISTINCT ""d1"".""customer_id"")/COUNT(DISTINCT ""d2"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (""Delivery"" AS ""d1"") JOIN ""Delivery"" AS ""d2"" WHERE ROW(""d1"".""customer_id"",""d1"".""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AND ""d1"".""order_date""=""d1"".""customer_pref_delivery_date"""
292,"WITH ""cte"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM (SELECT ""d"".*,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""delivery"" AS ""d"" ORDER BY ""customer_id"") AS ""temp"" WHERE ""ranking""=1) SELECT ROUND((SELECT COUNT(""customer_id"") FROM ""cte"" WHERE ""order_date""=""customer_pref_delivery_date"")*100/(SELECT COUNT(""customer_id"") FROM ""cte""), 2) AS ""immediate_percentage"""
293,"WITH ""etc"" AS (SELECT ""customer_id"",MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""first_order"",""order_date"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate"" FROM ""Delivery""), ""t2"" AS (SELECT ""customer_id"",CASE WHEN ""order_date""=""first_order"" THEN 1 ELSE 0 END AS ""first"",""immediate"" FROM ""etc"" HAVING ""first""=1) SELECT ROUND(SUM(""immediate"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""t2"""
294,"WITH ""step1"" AS (SELECT ""customer_id"",CASE WHEN MIN(""order_date"")=MIN(""customer_pref_delivery_date"") THEN 1 ELSE 0 END AS ""immediate"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(SUM(""immediate"")/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""step1"""
295,"WITH ""t"" AS (SELECT ""delivery_id"",CASE WHEN RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"")=1 THEN 1 ELSE 0 END AS ""is_first_order"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""is_immediate"" FROM ""Delivery"") SELECT ROUND((SELECT SUM(""is_immediate"") FROM ""t"" WHERE ""is_first_order""=1)/(SELECT SUM(""is_first_order"") FROM ""t"")*100, 2) AS ""immediate_percentage"""
296,"WITH ""nextt"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" - ""order_date"" AS ""diff"" FROM ""Delivery""), ""First_o"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""firstorder"" FROM ""Delivery"" GROUP BY 1), ""immid"" AS (SELECT ""a"".""customer_id"",""a"".""firstorder"",CASE WHEN ""b"".""diff""=0 THEN 1 ELSE 0 END AS ""imm"" FROM ""First_o"" AS ""a"" LEFT JOIN ""nextt"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""firstorder""=""b"".""order_Date"") SELECT ROUND(100*(SUM(""imm"")/COUNT(""imm"")), 2) AS ""immediate_percentage"" FROM ""immid"""
297,"WITH ""cte"" AS (SELECT ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""early"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""immediate"" FROM ""Delivery"" ORDER BY ""customer_id"") SELECT ROUND(COUNT(CASE WHEN ""immediate""=1 THEN 1 ELSE NULL END)/(SELECT COUNT(CASE WHEN ""early""=1 THEN 1 ELSE NULL END))*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""early""=1"
298,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
299,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""num"" FROM ""delivery"") AS ""a"" WHERE ""num""=1"
300,"SELECT ROUND(100*(SELECT SUM(""c"") FROM (SELECT COUNT(DISTINCT (""customer_id"")) AS ""c"" FROM ""delivery"" GROUP BY ""customer_id"" HAVING MIN(""order_date"")=MIN(""customer_pref_delivery_date"")) AS ""t"")/COUNT(DISTINCT (""customer_id"")), 2) AS ""immediate_percentage"" FROM ""delivery"""
301,"SELECT ROUND(AVG(TIMESTAMPDIFF(DAY, ""customer_pref_delivery_date"", ""order_date"")=0)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
302,"WITH ""Temp"" AS (SELECT ""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'schedule' END AS ""order_type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""order_rank"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_type""='immediate' THEN 1 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""Temp"" WHERE ""order_rank""=1"
303,"SELECT ROUND(SUM(""pref""=""first"")/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first"" FROM ""delivery"" GROUP BY 1) AS ""a"""
304,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
305,"SELECT ROUND(((SELECT COUNT(""customer_id"") AS ""c"" FROM (SELECT ""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""delivery"") AS ""q"" WHERE ""r""=1) AS ""w"" WHERE ""date""='immediate')/(SELECT COUNT(""customer_id"") AS ""c"" FROM (SELECT ""customer_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""date"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""delivery"") AS ""q"" WHERE ""r""=1) AS ""w"")*100), 2) AS ""immediate_percentage"""
306,"SELECT ROUND(SUM(CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""delivery"" AS ""d"" WHERE ""order_date""<=ALL (SELECT ""order_date"" FROM ""delivery"" WHERE ""customer_id""=""d"".""customer_id"")"
307,"WITH ""CNT"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND(SUM(CASE WHEN ""D"".""order_date""=""D"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (""Delivery"" AS ""D"") JOIN ""CNT"" AS ""C"" WHERE ""D"".""customer_id""=""C"".""customer_id"" AND ""D"".""order_date""=""C"".""order_date"""
308,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
309,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""temp"" WHERE ""temp"".""rk""=1"
310,"SELECT ROUND(100*SUM(CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""firstOrder"" FROM ""Delivery"" GROUP BY ""customer_id"")"
311,"SELECT ROUND(100*SUM(CASE WHEN (""temp"".""order_date""=""temp"".""customer_pref_delivery_date"") THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT ""d"".""customer_id"",""d"".""order_date"",RANK() OVER (PARTITION BY ""d"".""customer_id"" ORDER BY ""d"".""order_date"") AS ""rnk"",""customer_pref_delivery_date"" FROM ""Delivery"" AS ""d"") AS ""temp"" WHERE ""temp"".""rnk""=1"
312,"SELECT ROUND(100*AVG(""order_date""=""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
313,"WITH ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank1"" FROM ""delivery"" ORDER BY ""customer_id"",""order_date""), ""t2"" AS (SELECT * FROM ""t1"" WHERE ""rank1""=1 AND ""order_date""=""customer_pref_delivery_date"") SELECT ROUND((100*COUNT(DISTINCT ""t2"".""customer_id""))/COUNT(DISTINCT ""delivery"".""customer_id""), 2) AS ""immediate_percentage"" FROM (""delivery"") JOIN ""t2"""
314,"WITH ""cte"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""Immediate"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order_rank"" FROM ""Delivery"") SELECT ROUND(SUM(""Immediate"")/COUNT(DISTINCT ""customer_id""), 4)*100 AS ""immediate_percentage"" FROM ""cte"" WHERE ""first_order_rank""=1"
315,"SELECT ROUND(AVG(""order_date""=""customer_pref_delivery_date"")*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"")"
316,"SELECT ROUND(100*(SELECT SUM(""c"") FROM (SELECT COUNT(DISTINCT (""customer_id"")) AS ""c"" FROM ""delivery"" GROUP BY ""customer_id"" HAVING MIN(""order_date"")=MIN(""customer_pref_delivery_date"")) AS ""t"")/COUNT(DISTINCT (""customer_id"")), 2) AS ""immediate_percentage"" FROM ""delivery"""
317,"SELECT ROUND(100*AVG(""immediate""), 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END AS ""immediate"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""t"" WHERE ""rnk""=1"
318,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"")"
319,"WITH ""x"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") SELECT ROUND((COUNT(1)/(SELECT COUNT(DISTINCT ""customer_id"") FROM ""delivery""))*100, 2) AS ""immediate_percentage"" FROM ""x"" WHERE ""rnk""=1 AND ""order_date""=""customer_pref_delivery_date"""
320,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""t"" WHERE ""rk""=1"
321,"WITH ""a"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""row_num"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""a"" WHERE ""row_num""=1"
322,"WITH ""cte"" AS (SELECT (""order_date""=""customer_pref_delivery_date"") AS ""isimmediateorder"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rwnum"" FROM ""Delivery"") SELECT ROUND(SUM(""isimmediateorder"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""rwnum""=1"
323,"WITH ""t"" AS (WITH ""t"" AS (SELECT ""customer_id"",MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""fod"" FROM ""delivery"") SELECT ""customer_id"",""fod"" FROM ""t"" GROUP BY ""customer_id"") SELECT ROUND(100*SUM(CASE WHEN ""d"".""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM ""t"" JOIN ""delivery"" AS ""d"" ON ""t"".""fod""=""d"".""order_date"" AND ""t"".""customer_id""=""d"".""customer_id"""
324,"SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")*100/COUNT(1), 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""od"" FROM ""delivery"" GROUP BY ""customer_id"")"
325,"SELECT ROUND(AVG(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
326,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""order_date"")*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""delivery"" GROUP BY ""customer_id"")"
327,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""f_order"" FROM ""Delivery"" GROUP BY ""customer_id"") SELECT ROUND((SUM(CASE WHEN ""d"".""customer_pref_delivery_date"" IS NULL THEN 0 ELSE 1 END)/COUNT(""f"".""customer_id""))*100, 2) AS ""immediate_percentage"" FROM ""first_order"" AS ""f"" LEFT JOIN ""Delivery"" AS ""d"" ON ""f"".""customer_id""=""d"".""customer_id"" AND ""f"".""f_order""=""d"".""customer_pref_delivery_date"""
328,"WITH ""t1"" AS (SELECT ""customer_id"",MIN(""order_date""),MIN(""customer_pref_delivery_date""),CASE WHEN MIN(""order_date"")=MIN(""customer_pref_delivery_date"") THEN 1 ELSE 0 END AS ""pref"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(SUM(""pref"")/COUNT(""pref"")*100, 2) AS ""immediate_percentage"" FROM ""t1"""
329,"WITH ""cte"" AS (SELECT ""d"".""customer_id"",""min_date"",""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""t"" JOIN ""Delivery"" AS ""d"" ON ""d"".""customer_id""=""t"".""customer_id"" AND ""d"".""order_date""=""t"".""min_date"") SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""cte"")*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""min_date""=""customer_pref_delivery_date"""
330,"WITH ""cte1"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY ""customer_id""), ""cte2"" AS (SELECT ""delivery"".""customer_id"",""order_date"",""customer_pref_delivery_date"",(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END) AS ""delivery_type"" FROM ""delivery"" JOIN ""cte1"" WHERE ""order_date""=""first_order_date"" AND ""delivery"".""customer_id""=""cte1"".""customer_id"") SELECT ROUND(SUM(CASE WHEN ""delivery_type""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte2"""
331,"SELECT ROUND(100*SUM(CASE WHEN ""order_Date""=""customer_pref_delivery_Date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_Date"") IN (SELECT ""customer_id"",MIN(""order_Date"") FROM ""delivery"" GROUP BY ""customer_id"")"
332,"SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id""))*100, 2) AS ""immediate_percentage"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranking"" FROM ""Delivery"") AS ""a"" WHERE ""ranking""=1"
333,"SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""delivery_id"")*100), 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""num"" FROM ""delivery"") AS ""d"" WHERE ""d"".""num""=1"
334,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 END)/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""delivery"") AS ""T1"" WHERE ""rnk""=1"
335,"SELECT ROUND(SUM(""order_date""=""customer_pref_delivery_date"")/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM ""delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""delivery"" GROUP BY ""customer_id"")"
336,"SELECT ROUND(AVG(TIMESTAMPDIFF(DAY, ""customer_pref_delivery_date"", ""order_date"")=0)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY 1)"
337,"WITH ""cte"" AS (SELECT ""customer_id"",(""order_date""=""customer_pref_delivery_date"") AS ""is_imme"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""cnt"" FROM ""Delivery"") SELECT ROUND(SUM(""is_imme"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""cte"" WHERE ""cnt""=1"
338,"WITH ""nextt"" AS (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"" - ""order_date"" AS ""diff"" FROM ""Delivery""), ""First_o"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""firstorder"" FROM ""Delivery"" GROUP BY 1), ""immid"" AS (SELECT ""a"".""customer_id"",""a"".""firstorder"",CASE WHEN ""b"".""diff""=0 THEN 1 ELSE 0 END AS ""imm"" FROM ""First_o"" AS ""a"" LEFT JOIN ""nextt"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""firstorder""=""b"".""order_Date"") SELECT ROUND(100*(SUM(""imm"")/COUNT(""imm"")), 2) AS ""immediate_percentage"" FROM ""immid"""
339,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",""order_date"",""customer_pref_delivery_date"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""row_num"" FROM ""delivery"") AS ""tmp"" WHERE ""row_num""=1"
340,"SELECT ROUND(SUM(CASE WHEN ""first_order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(""first_order_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d"" RIGHT JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""c"" ON ""d"".""customer_id""=""c"".""customer_id"" AND ""d"".""order_date""=""c"".""first_order_date"""
341,"WITH ""firstD"" AS (SELECT ""d1"".""customer_id"",MIN(""d1"".""order_date"") AS ""order_date"" FROM ""Delivery"" AS ""d1"" GROUP BY ""d1"".""customer_id"") SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""firstD"")*100, 2) AS ""immediate_percentage"" FROM ""firstD"" AS ""fd"" JOIN ""Delivery"" AS ""d2"" ON ""fd"".""customer_id""=""d2"".""customer_id"" AND ""fd"".""order_date""=""d2"".""order_date"" AND ""d2"".""order_date""=""d2"".""customer_pref_delivery_date"""
342,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY 1) SELECT ROUND((100*SUM(CASE WHEN ""a"".""first_order_date""=""b"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)), 2) AS ""immediate_percentage"" FROM ""first_order"" AS ""a"" LEFT JOIN ""Delivery"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""first_order_date""=""b"".""order_date"""
343,"SELECT ROUND((SELECT COUNT(""delivery_id"") FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""firstorder"" FROM ""Delivery"") AS ""b"" WHERE ""order_date""=""firstorder"" AND ""order_date""=""customer_pref_delivery_date"")*100/(SELECT COUNT(""delivery_id"") FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""firstorder"" FROM ""Delivery"") AS ""a"" WHERE ""order_date""=""firstorder""), 2) AS ""immediate_percentage"""
344,"SELECT ROUND(SUM(""perf""=""first"")/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""perf"",MIN(""customer_pref_delivery_date"") AS ""first"" FROM ""delivery"" GROUP BY ""customer_id"") AS ""a"""
345,"SELECT ROUND(AVG(TIMESTAMPDIFF(DAY, ""order_date"", ""customer_pref_delivery_date"")=0)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
346,"WITH ""first_order"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""delivery"" GROUP BY ""customer_id"") SELECT ROUND(SUM(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100.0/COUNT(1), 2) AS ""immediate_percentage"" FROM ""delivery"" AS ""d"" JOIN ""first_order"" AS ""fo"" ON ""d"".""customer_id""=""fo"".""customer_id"" AND ""d"".""order_date""=""fo"".""first_date"""
347,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
348,"SELECT ROUND(AVG(CASE WHEN ""fd""=""customer_pref_delivery_date"" AND ""order_date""=""fd"" THEN 1 ELSE 0 END)*100, 2) AS ""immediate_percentage"" FROM (SELECT *,MIN(""order_date"") OVER (PARTITION BY ""customer_id"") AS ""fd"" FROM ""delivery"") AS ""t"" WHERE ""order_date""=""fd"""
349,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
350,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
351,"SELECT ROUND(AVG(TIMESTAMPDIFF(DAY, ""customer_pref_delivery_date"", ""order_date"")=0)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY 1)"
352,"WITH ""temp"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""imm"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_"" FROM ""Delivery"") SELECT ROUND(SUM(""imm"")/COUNT(DISTINCT ""customer_id""), 4)*100 AS ""immediate_percentage"" FROM ""temp"" WHERE ""rank_""=1"
353,"SELECT ROUND(""z"".""counter""/""z"".""base""*100, 2) AS ""immediate_percentage"" FROM (SELECT SUM(CASE WHEN ""y"".""order_Date""=""y"".""customer_pref_Delivery_date"" THEN 1 ELSE 0 END) AS ""counter"",COUNT(DISTINCT ""y"".""delivery_id"") AS ""base"" FROM (SELECT ""x"".""delivery_id"",""x"".""order_date"",""x"".""customer_pref_delivery_date"" FROM (SELECT ""customer_id"",""delivery_id"",""order_date"",""customer_pref_delivery_date"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""ranker"" FROM ""delivery"") AS ""x"" WHERE ""x"".""ranker""=1) AS ""y"") AS ""z"""
354,"SELECT ROUND(100*AVG(""order_date""=""customer_pref_delivery_date""), 2) AS ""immediate_percentage"" FROM ""Delivery"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""a"" USING (""customer_id"",""order_date"")"
355,"WITH ""first_order_per_customer"" AS (SELECT ""customer_id"",MIN(""order_date"") AS ""order_date"" FROM ""Delivery"" GROUP BY 1) SELECT ROUND(SUM(CASE WHEN ""temp"".""status""='immediate' THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT ""f"".""customer_id"" AS ""customer_id"",""f"".""order_date"" AS ""order_date"",""d"".""customer_pref_delivery_date"" AS ""customer_pref_delivery_date"",CASE WHEN ""f"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 'immediate' ELSE 'scheduled' END AS ""status"" FROM ""first_order_per_customer"" AS ""f"" JOIN ""Delivery"" AS ""d"" ON ""f"".""customer_id""=""d"".""customer_id"" AND ""f"".""order_date""=""d"".""order_date"") AS ""temp"""
356,"SELECT ROUND(SUM(CASE WHEN ""customer_pref_delivery_date""=""order_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id"")*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""Delivery"" GROUP BY ""customer_id"")"
357,"WITH ""t"" AS (SELECT *,(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""i_s"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery"") SELECT ROUND(100*SUM(CASE WHEN ""rk""=1 THEN ""i_s"" ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""t"""
358,"WITH ""immediate"" AS (SELECT ""d"".""customer_id"" FROM ""Delivery"" AS ""d"" RIGHT JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""f"" ON ""d"".""customer_id""=""f"".""customer_id"" AND ""d"".""order_date""=""f"".""first_date"" WHERE ""f"".""first_date""=""d"".""customer_pref_delivery_date"") SELECT ROUND(COUNT(DISTINCT ""i"".""customer_id"")/COUNT(DISTINCT ""d"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (""Delivery"" AS ""d"") JOIN ""immediate"" AS ""i"""
359,"SELECT ROUND((SUM(""same_day_count"")/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""d"".""customer_id"",""d"".""order_date"",""d"".""customer_pref_delivery_date"",(CASE WHEN ""d"".""order_date""=""d"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""same_day_count"" FROM ""Delivery"" AS ""d"" JOIN (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order_date"" FROM ""Delivery"" GROUP BY ""customer_id"") AS ""first_order"" ON ""d"".""customer_id""=""first_order"".""customer_id"" AND ""d"".""order_date""=""first_order"".""first_order_date"") AS ""temp"""
360,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""immediate_percentage"" FROM ""Delivery"" AS ""d"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" AS ""d"" GROUP BY ""customer_id"")"
361,"WITH ""CTE"" AS (SELECT * FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") AS ""t"" WHERE ""rnk""=1) SELECT ROUND((SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM ""CTE"""
362,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM (SELECT RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"",""delivery_id"",""customer_id"",""order_date"",""customer_pref_delivery_date"" FROM ""Delivery"") AS ""tmp"" WHERE ""rnk""=1"
363,"WITH ""temp1"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""r"" FROM ""delivery"" ORDER BY ""customer_id"",""order_date""), ""temp2"" AS (SELECT * FROM ""temp1"" WHERE ""order_date""=""customer_pref_delivery_date"" AND ""r""=1) SELECT ROUND(100*COUNT(DISTINCT ""temp2"".""customer_id"")/COUNT(DISTINCT ""temp1"".""customer_id""), 2) AS ""immediate_percentage"" FROM (""temp1"") JOIN ""temp2"""
364,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""temp"" WHERE ""rk""=1"
365,"SELECT ROUND(AVG(TIMESTAMPDIFF(DAY, ""customer_pref_delivery_date"", ""order_date"")=0)*100, 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY 1)"
366,"SELECT ROUND((SUM(""order_status"")/COUNT(""customer_id""))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""order_status"" FROM ""Delivery"") AS ""t"" WHERE ""rn""=1"
367,"SELECT ROUND(COUNT(DISTINCT ""fo"".""customer_id"")/COUNT(DISTINCT ""d"".""customer_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""order_date"") AS ""first_order"" FROM ""delivery"" GROUP BY 1) AS ""fo"" RIGHT JOIN ""delivery"" AS ""d"" ON ""d"".""customer_id""=""fo"".""customer_id"" AND ""d"".""customer_pref_delivery_date""=""fo"".""first_order"""
368,"SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100/COUNT(""delivery_id""), 2) AS ""immediate_percentage"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""delivery"") AS ""A"" WHERE ""rk""=1"
369,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_o"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""t"".""order_date""=""t"".""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(""d"".""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM ""t"" JOIN ""delivery"" AS ""d"" ON ""d"".""delivery_id""=""t"".""delivery_id"" WHERE ""rank_o""=1"
370,"WITH ""first_order"" AS (SELECT *,RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rnk"" FROM ""Delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)*100.00/COUNT(1), 2) AS ""immediate_percentage"" FROM ""first_order"" WHERE ""rnk""=1"
371,"WITH ""A"" AS (SELECT ""customer_id"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""date_rank"",""order_date"",""customer_pref_delivery_date"" FROM ""delivery"") SELECT ROUND(SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""immediate_percentage"" FROM ""A"" WHERE ""date_rank""=1"
372,"SELECT ROUND(COALESCE(SUM(""type""), 0)*1.00/COUNT(""delivery_id"")*100, 2) AS ""immediate_percentage"" FROM (SELECT ""delivery_id"",CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rk"" FROM ""Delivery"") AS ""s"" WHERE ""rk""=1"
373,"WITH ""a"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""order_type"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rank_order"" FROM ""delivery"") SELECT ROUND(AVG(""order_type"")*100, 2) AS ""immediate_percentage"" FROM ""a"" WHERE ""rank_order""=1"
374,"SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") AS ""min_date"" FROM ""Delivery"" GROUP BY ""customer_id"")"
375,"WITH ""numbered_delivery"" AS (SELECT *,(CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END) AS ""immediate"",ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""rn"" FROM ""Delivery"") SELECT ROUND(SUM(""immediate"")/COUNT(""immediate"")*100, 2) AS ""immediate_percentage"" FROM ""numbered_delivery"" WHERE ""rn""=1"
376,"WITH ""CTE"" AS (SELECT ""delivery_id"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""RNK"" FROM ""Delivery"") SELECT ROUND(100*SUM(CASE WHEN ""order_date""=""customer_pref_delivery_date"" AND ""RNK""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""customer_id""), 2) AS ""immediate_percentage"" FROM ""Delivery"" JOIN ""CTE"" USING (""delivery_id"")"
377,"SELECT ROUND(100*AVG((CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END)), 2) AS ""immediate_percentage"" FROM ""Delivery"" WHERE ROW(""customer_id"",""order_date"") IN (SELECT ""customer_id"",MIN(""order_date"") FROM ""Delivery"" GROUP BY ""customer_id"")"
378,"WITH ""cte"" AS (SELECT *,CASE WHEN ""order_date""=""customer_pref_delivery_date"" THEN 1 ELSE 0 END AS ""Immediate"",RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""order_date"") AS ""first_order_rank"" FROM ""Delivery"") SELECT ROUND(SUM(""Immediate"")/COUNT(DISTINCT ""customer_id""), 4)*100 AS ""immediate_percentage"" FROM ""cte"" WHERE ""first_order_rank""=1"
379,"SELECT ROUND((SUM(""pref""=""first_order_date"")/COUNT(1))*100, 2) AS ""immediate_percentage"" FROM (SELECT ""customer_id"",MIN(""customer_pref_delivery_date"") AS ""pref"",MIN(""order_date"") AS ""first_order_date"" FROM ""delivery"" GROUP BY 1) AS ""f"""
