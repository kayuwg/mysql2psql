id,original query
1,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 WHEN ""product_name""='C' THEN 3 ELSE 0 END) AS ""product_sum"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""tmp"" WHERE ""product_sum""=2)"
2,"SELECT DISTINCT (""o"".""customer_id""),""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
3,"SELECT ""c"".""customer_id"",""cu"".""customer_name"" FROM (SELECT ""o1"".""customer_id"",""o3"".""product_name"" FROM (""orders"" AS ""o1"" LEFT JOIN ""orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"") LEFT JOIN (SELECT ""customer_id"",""product_name"" FROM ""orders"" WHERE ""product_name""='C') AS ""o3"" ON ""o3"".""customer_id""=""o1"".""customer_id"" WHERE ""o1"".""product_name""='A' AND ""o2"".""product_name""='B') AS ""c"" LEFT JOIN ""customers"" AS ""cu"" ON ""cu"".""customer_id""=""c"".""customer_id"" WHERE ""c"".""product_name"" IS NULL"
4,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
5,"SELECT ""t2"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",STRING_AGG(""product_name"", ',') AS ""products"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""t2"" ON ""c"".""customer_id""=""t2"".""customer_id"" WHERE ""t2"".""products"" NOT LIKE '%C%' AND ""t2"".""products"" LIKE '%A%' AND ""t2"".""products"" LIKE '%B%'"
6,"SELECT ""C"".""customer_id"",""C"".""customer_name"" FROM (""Customers"" AS ""C"") CROSS JOIN ""Orders"" AS ""O"" WHERE ""C"".""customer_id""=""O"".""customer_id"" GROUP BY 1 HAVING SUM(""O"".""product_name""='A')>0 AND SUM(""O"".""product_name""='B')>0 AND SUM(""O"".""product_name""='C')=0"
7,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
8,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='C')"
9,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",STRING_AGG(""product_name"", ',') AS ""all_products"" FROM ""orders"" GROUP BY ""customer_id"") AS ""a"" WHERE FIND_IN_SET('A', ""a"".""all_products"")>0 AND FIND_IN_SET('B', ""a"".""all_products"")>0 AND FIND_IN_SET('C', ""a"".""all_products"")=0) ORDER BY ""customer_id"""
10,"WITH ""refined"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""a"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""b"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""c"" FROM ""Orders"" GROUP BY 1) SELECT ""r"".""customer_id"",""c"".""customer_name"" FROM ""refined"" AS ""r"" LEFT JOIN ""Customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" WHERE ""r"".""a"">0 AND ""r"".""b"">0 AND ""r"".""c""=0"
11,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
12,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
13,"WITH ""Candidates"" AS (SELECT ""customer_id"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0) SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Candidates"") ORDER BY ""customer_id"""
14,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN ""o"".""product_name""='A' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""o"".""product_name""='B' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""o"".""product_name""='C' THEN 1 ELSE 0 END)=0"
15,"WITH ""A"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""buyA"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""buyB"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""buyC"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING ""buyA"">0 AND ""buyB"">0 AND ""buyC""=0) SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""A"") ORDER BY ""customer_id"""
16,"SELECT ""customer_id"" AS ""CUSTOMER_ID"",""customer_name"" AS ""CUSTOMER_NAME"" FROM ""customers"" WHERE EXISTS (SELECT * FROM ""orders"" WHERE ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_name""='A') AND EXISTS (SELECT * FROM ""orders"" WHERE ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_name""='B') AND NOT EXISTS (SELECT * FROM ""orders"" WHERE ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_name""='C')"
17,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""A"".""customer_id"" FROM (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AS ""A"" JOIN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" WHERE ""A"".""customer_id"" NOT IN ((SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')))"
18,"WITH ""AB"" AS (SELECT ""C"".""customer_id"" AS ""ID"",""C"".""customer_name"" AS ""NAME"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""O"".""customer_id""=""C"".""customer_id"") JOIN ""Orders"" AS ""O2"" ON ""O2"".""customer_id""=""C"".""customer_id"" WHERE ""O"".""product_name""='A' AND ""O2"".""product_name""='B'), ""haveC"" AS (SELECT ""C2"".""customer_id"" AS ""ID2"",""C2"".""customer_name"" AS ""NAME2"" FROM ""Customers"" AS ""C2"" JOIN ""Orders"" AS ""O4"" ON ""O4"".""customer_id""=""C2"".""customer_id"" WHERE ""O4"".""product_name""='C'), ""JOINER"" AS (SELECT * FROM ""AB"" LEFT JOIN ""haveC"" ON ""AB"".""ID""=""haveC"".""ID2"") SELECT ""ID"" AS ""CUSTOMER_ID"",""NAME"" AS ""CUSTOMER_NAME"" FROM ""JOINER"" WHERE ""ID2"" IS NULL"
19,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
20,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM (SELECT ""c"".""customer_id"",""c"".""customer_name"",""o"".""product_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""itm"" WHERE (""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')) GROUP BY ""customer_id"",""customer_name"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 ORDER BY ""customer_id"""
21,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
22,"WITH ""t1"" AS (SELECT DISTINCT (""c"".""customer_id"") AS ""id"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"") WHERE ""product_name""='C') SELECT ""o1"".""customer_id"",""c"".""customer_name"" FROM (""Orders"" AS ""o1"" JOIN ""Orders"" AS ""o2"" USING (""customer_id"")) JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""o1"".""product_name""='A' AND ""o2"".""product_name""='B' AND ""customer_id"" NOT IN (SELECT ""id"" FROM ""t1"")"
23,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name"" IN ('A','B') GROUP BY ""customer_id"" HAVING COUNT(""product_name"")=2 AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
24,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ((""Customers"" AS ""c"" JOIN ""Orders"" AS ""a"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""a"".""product_name""='A') JOIN ""Orders"" AS ""b"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""product_name""='B') LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""product_name""='C' WHERE ""o"".""order_id"" IS NULL"
25,"SELECT DISTINCT ""temp"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""o"".""product_name""='A' AND ""o"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""o"".""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""o"".""product_name""='C')) AS ""temp"" JOIN ""customers"" AS ""c"" ON ""temp"".""customer_id""=""c"".""customer_id"""
26,"WITH ""order_ab"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='C' THEN -1 WHEN ""product_name""='A' THEN 0.5 WHEN ""product_name""='B' THEN 0.5 ELSE 0 END) AS ""product_count"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING ""product_count""=1) SELECT ""a"".""customer_id"",""b"".""customer_name"" FROM ""order_ab"" AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
27,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
28,"WITH ""a"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A'), ""b"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM (""a"" JOIN ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
29,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
30,"SELECT ""A"".""customer_id"",""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""prodA"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""prodB"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""prodC"" FROM ""orders"" GROUP BY ""customer_id"") AS ""A"" JOIN ""Customers"" AS ""C"" ON ""A"".""customer_id""=""C"".""customer_id"" WHERE ""prodA"">=1 AND ""prodB"">=1 AND ""prodC""=0"
31,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
32,"WITH ""a"" AS (SELECT ""customers"".""customer_id"",""customer_name"",""order_id"" FROM ""customers"" JOIN ""orders"" ON ""customers"".""customer_id""=""orders"".""customer_id"" WHERE ""product_name""='A'), ""b"" AS (SELECT ""a"".""customer_id"",""customer_name"",""a"".""order_id"" FROM ""a"" JOIN ""orders"" ON ""a"".""customer_id""=""orders"".""customer_id"" WHERE ""product_name""='B') SELECT ""b"".""customer_id"",""customer_name"" FROM ""b"" WHERE ""b"".""customer_id"" NOT IN (SELECT ""customers"".""customer_id"" FROM ""customers"" JOIN ""orders"" ON ""customers"".""customer_id""=""orders"".""customer_id"" WHERE ""product_name""='C')"
33,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
34,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
35,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
36,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM (""customers"" AS ""c"") CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
37,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
38,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""product_name"" IN ('A','B') GROUP BY ""o"".""customer_id"" HAVING COUNT(""o"".""product_name"")=2 AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
39,"WITH ""temp"" AS (SELECT DISTINCT ""customer_id"",""product_name"" FROM ""Orders"") SELECT ""t"".""customer_id"",""c"".""customer_name"" FROM ""temp"" AS ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
40,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
41,"WITH ""cte"" AS (SELECT ""a"".""cid"" AS ""customerid"" FROM (SELECT ""customer_id"" AS ""cid"" FROM ""orders"" WHERE ""product_name""='A') AS ""a"" JOIN (SELECT ""customer_id"" AS ""cid"" FROM ""orders"" WHERE ""product_name""='B') AS ""b"" ON ""a"".""cid""=""b"".""cid"" WHERE ""a"".""cid"" NOT IN (SELECT DISTINCT ""customer_id"" AS ""cid"" FROM ""orders"" WHERE ""product_name""='C')) SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""cte"" ON ""c"".""customer_id""=""cte"".""customerid"" ORDER BY ""c"".""customer_id"""
42,"WITH ""boughts"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_name"") AS ""cnt"" FROM ""orders"" WHERE ""product_name"" IN ('A','B') GROUP BY ""customer_id""), ""nots"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C' GROUP BY ""customer_id"") SELECT ""b"".""customer_id"",""c"".""customer_name"" FROM (""boughts"" AS ""b"" JOIN ""customers"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""nots"" AS ""n"" ON ""b"".""customer_id""=""n"".""customer_id"" WHERE ""n"".""customer_id"" IS NULL AND ""b"".""cnt""=2"
43,"WITH ""a"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A'), ""b"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='B'), ""c"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='C') SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""a"" JOIN ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""c"".""customer_id"" IS NULL"
44,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""product_name""='C')"
45,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0"
46,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
47,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM (""Customers"" AS ""c"") CROSS JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
48,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
49,"SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM ((SELECT ""e"".""customer_id"" FROM ""Orders"" AS ""e"" JOIN ""Orders"" AS ""f"" ON ""e"".""customer_id""=""f"".""customer_id"" WHERE ""e"".""product_name"" IN ('A') AND ""f"".""product_name""='B') AS ""a"" LEFT JOIN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" IN ('C')) AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""b"".""customer_id"" IS NULL GROUP BY ""a"".""customer_id"" ORDER BY ""a"".""customer_id"""
50,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
51,"WITH ""prodA"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A'), ""prodB"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B'), ""prodC"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') SELECT ""u"".* FROM ((""Customers"" AS ""u"" JOIN ""prodA"" ON ""u"".""customer_id""=""prodA"".""customer_id"") JOIN ""prodB"" ON ""u"".""customer_id""=""prodB"".""customer_id"") LEFT JOIN ""prodC"" ON ""u"".""customer_id""=""prodC"".""customer_id"" WHERE ""prodC"".""customer_id"" IS NULL"
52,"SELECT ""b"".""customer_id"",""b"".""customer_name"" FROM (SELECT ""a"".""customer_id"",""a"".""customer_name"",SUM(CASE WHEN ""a"".""product_name""='A' THEN 1 ELSE 0 END) AS ""productA"",SUM(CASE WHEN ""a"".""product_name""='B' THEN 1 ELSE 0 END) AS ""productB"",SUM(CASE WHEN ""a"".""product_name""='C' THEN 1 ELSE 0 END) AS ""productC"" FROM (SELECT ""Orders"".""customer_id"",""Orders"".""product_name"",""Customers"".""customer_name"" FROM ""orders"" LEFT JOIN ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"") AS ""a"" GROUP BY ""a"".""customer_id"",""a"".""customer_name"") AS ""b"" WHERE ""b"".""productA"">0 AND ""b"".""productB"">0 AND ""b"".""productC""=0"
53,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
54,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
55,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0 ORDER BY ""o"".""customer_id"""
56,"WITH ""t"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' OR ""product_name""='B' THEN 1 ELSE 0 END) AS ""ab"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""c"" FROM ""orders"" GROUP BY ""customer_id"") SELECT ""t"".""customer_id"",""c"".""customer_name"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""ab""=2 AND ""t"".""c""=0"
57,"SELECT ""a"".""customer_id"",""b"".""customer_name"" FROM (SELECT ""customer_id"" FROM ""orders"" GROUP BY ""customer_id"" HAVING ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT (""customer_id"") FROM ""orders"" WHERE ""product_name""='C')) AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
58,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" LEFT JOIN (SELECT ""customer_id"",STRING_AGG(""product_name"", ',') AS ""products"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""cc"" ON ""cc"".""customer_id""=""c"".""customer_id"" WHERE ""products"" LIKE '%A%' AND ""products"" LIKE '%B%' AND ""products"" NOT LIKE '%C%'"
59,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
60,"WITH ""cte"" AS (SELECT ""customer_name"",""O"".""customer_id"",SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 WHEN ""product_name""='C' THEN -1 END) AS ""sums"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"" GROUP BY ""customer_name"",""O"".""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ""cte"" WHERE ""sums""=2"
61,"SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""a_pur"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""b_pur"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C_pur"" FROM ""orders"" GROUP BY 1) AS ""a"" JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a_pur"">0 AND ""b_pur"">0 AND ""c_pur""=0"
62,"WITH ""AB"" AS (SELECT ""C"".""customer_id"" AS ""ID"",""C"".""customer_name"" AS ""NAME"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""O"".""customer_id""=""C"".""customer_id"") JOIN ""Orders"" AS ""O2"" ON ""O2"".""customer_id""=""C"".""customer_id"" WHERE ""O"".""product_name""='A' AND ""O2"".""product_name""='B'), ""haveC"" AS (SELECT ""C2"".""customer_id"" AS ""ID2"",""C2"".""customer_name"" AS ""NAME2"" FROM ""Customers"" AS ""C2"" JOIN ""Orders"" AS ""O4"" ON ""O4"".""customer_id""=""C2"".""customer_id"" WHERE ""O4"".""product_name""='C'), ""JOINER"" AS (SELECT * FROM ""AB"" LEFT JOIN ""haveC"" ON ""AB"".""ID""=""haveC"".""ID2"") SELECT ""ID"" AS ""CUSTOMER_ID"",""NAME"" AS ""CUSTOMER_NAME"" FROM ""JOINER"" WHERE ""ID2"" IS NULL"
63,"SELECT DISTINCT ""b"".""customer_id"",""b"".""customer_name"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""a"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""a"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')"
64,"SELECT DISTINCT ""orders"".""customer_id"",""customers"".""customer_name"" FROM ""orders"" JOIN ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"" WHERE ""orders"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""orders"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""orders"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
65,"SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""a_pur"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""b_pur"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C_pur"" FROM ""orders"" GROUP BY 1) AS ""a"" JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a_pur"">0 AND ""b_pur"">0 AND ""c_pur""=0"
66,"WITH ""order_cnt"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 WHEN ""product_name""='C' THEN -1 ELSE 0 END) AS ""cnt"" FROM ""Orders"" GROUP BY ""customer_id"") SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""order_cnt"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""order_cnt"".""customer_id"" WHERE ""order_cnt"".""cnt""=2"
67,"SELECT ""a"".""customer_id"",""Customers"".""customer_name"" FROM ((SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AS ""a"" JOIN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""Customers"" ON ""a"".""customer_id""=""Customers"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
68,"WITH ""cte"" AS (SELECT ""a"".""cid"" AS ""customerid"" FROM (SELECT ""customer_id"" AS ""cid"" FROM ""orders"" WHERE ""product_name""='A') AS ""a"" JOIN (SELECT ""customer_id"" AS ""cid"" FROM ""orders"" WHERE ""product_name""='B') AS ""b"" ON ""a"".""cid""=""b"".""cid"" WHERE ""a"".""cid"" NOT IN (SELECT DISTINCT ""customer_id"" AS ""cid"" FROM ""orders"" WHERE ""product_name""='C')) SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""cte"" ON ""c"".""customer_id""=""cte"".""customerid"""
69,"SELECT * FROM ""customers"" AS ""c"" WHERE EXISTS (SELECT DISTINCT 1 FROM ""orders"" WHERE ""product_name""='A' AND ""customer_id""=""c"".""customer_id"") AND EXISTS (SELECT DISTINCT 1 FROM ""orders"" WHERE ""product_name""='B' AND ""customer_id""=""c"".""customer_id"") AND NOT EXISTS (SELECT DISTINCT 1 FROM ""orders"" WHERE ""product_name""='C' AND ""customer_id""=""c"".""customer_id"") ORDER BY ""c"".""customer_id"""
70,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 WHEN ""product_name""='C' THEN -1 ELSE 0 END) AS ""product_count"" FROM (SELECT DISTINCT ""customer_id"",""product_name"" FROM ""Orders"") AS ""t1"" GROUP BY ""customer_id"") AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_count""=2"
71,"SELECT DISTINCT ""C"".""customer_id"",""C"".""customer_name"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" GROUP BY ""C"".""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
72,"WITH ""AB"" AS (SELECT ""o1"".""customer_id"" FROM ""Orders"" AS ""o1"" JOIN ""Orders"" AS ""o2"" ON ""o1"".""customer_id""=""o2"".""customer_id"" WHERE ""o1"".""product_name""='A' AND ""o2"".""product_name""='B') SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT * FROM ""AB"") AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
73,"WITH ""cte"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""prod_A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""prod_B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""prod_C"" FROM ""orders"" GROUP BY ""customer_id"") SELECT ""cte"".""customer_id"",""customer_name"" FROM (""cte"") CROSS JOIN ""customers"" AS ""c"" WHERE ""c"".""customer_id""=""cte"".""customer_id"" AND ""prod_A"">0 AND ""prod_B"">0 AND ""prod_C""=0"
74,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
75,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
76,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
77,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
78,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ROW(""o"".""customer_id"",'A') IN (SELECT ""customer_id"",""product_name"" FROM ""orders"") AND ROW(""o"".""customer_id"",'B') IN (SELECT ""customer_id"",""product_name"" FROM ""orders"") AND ROW(""o"".""customer_id"",'C') NOT IN (SELECT ""customer_id"",""product_name"" FROM ""orders"")"
79,"WITH ""both_ab_id"" AS (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B')), ""target_id"" AS (SELECT DISTINCT ""customer_id"" FROM ""both_ab_id"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')) SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""target_id"") ORDER BY ""customer_id"""
80,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY 1"
81,"SELECT ""tmp"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",CASE WHEN SUM(""bought_a"")>=1 AND SUM(""bought_b"")>=1 AND SUM(""bought_c"")=0 THEN 1 ELSE 0 END AS ""bought_ab_not_c"" FROM (SELECT ""customer_id"",CASE WHEN ""product_name"" IN ('A') THEN 1 ELSE 0 END AS ""bought_a"",CASE WHEN ""product_name"" IN ('B') THEN 1 ELSE 0 END AS ""bought_b"",CASE WHEN ""product_name"" IN ('C') THEN 1 ELSE 0 END AS ""bought_c"" FROM ""orders"") AS ""a"" GROUP BY 1) AS ""tmp"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""tmp"".""customer_id"" WHERE ""bought_ab_not_c""=1"
82,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
83,"SELECT ""c"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" AS ""customer_name"" FROM ""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""a"" ON ""c"".""customer_id""=""a"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""a"".""product_name""='A')>0 AND SUM(""a"".""product_name""='B')>0 AND SUM(""a"".""product_name""='C')=0"
84,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
85,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
86,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0"
87,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='B') ORDER BY ""customer_id"""
88,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name""='A' OR ""product_name""='B' GROUP BY ""customer_id"" HAVING COUNT(""product_name"")=2 AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
89,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND NOT ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
90,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
91,"WITH ""A_buyer"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' GROUP BY ""customer_id""), ""B_buyer"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B' GROUP BY ""customer_id""), ""C_buyer"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C' GROUP BY ""customer_id""), ""AB_buyer"" AS (SELECT ""a"".""customer_id"" FROM ""A_buyer"" AS ""a"" JOIN ""B_buyer"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id""), ""Res"" AS (SELECT ""ab"".""customer_id"" FROM ""AB_buyer"" AS ""ab"" LEFT JOIN ""C_buyer"" AS ""c"" ON ""ab"".""customer_id""=""c"".""customer_id"" WHERE ""c"".""customer_id"" IS NULL) SELECT ""r"".""customer_id"",""c2"".""customer_name"" FROM ""Res"" AS ""r"" JOIN ""Customers"" AS ""c2"" ON ""r"".""customer_id""=""c2"".""customer_id"""
92,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE (SELECT COUNT(""product_name"") FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name"" IN ('A','B'))=2 AND (SELECT COUNT(""product_name"") FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name""='C')=0"
93,"WITH ""temp"" AS (SELECT DISTINCT ""customer_id"",""product_name"" FROM ""Orders"") SELECT ""t"".""customer_id"",""c"".""customer_name"" FROM ""temp"" AS ""t"" LEFT JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(CASE ""product_name"" WHEN 'A' THEN 1 WHEN 'B' THEN 2 WHEN 'C' THEN 4 ELSE 0 END)=3"
94,"SELECT DISTINCT ""c"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B')"
95,"WITH ""CTE"" AS (SELECT ""order_id"",""customer_id"",""product_name"",CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 2 WHEN ""product_name""='C' THEN 3 ELSE 4 END AS ""custom_rnk"" FROM ""orders"") SELECT DISTINCT ""b"".""customer_id"",""customer_name"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""CTE"" WHERE ""custom_rnk""=3) AND ""a"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""CTE"" WHERE ""custom_rnk""=1) AND ""a"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""CTE"" WHERE ""custom_rnk""=2)"
96,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
97,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"") WHERE ""o"".""product_name"" IN ('A','B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') GROUP BY ""o"".""customer_id"" HAVING COUNT(""o"".""product_name"")=2 ORDER BY ""c"".""customer_id"""
98,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
99,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Orders"" LEFT JOIN ""Customers"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
100,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
101,"SELECT ""cust"".""customer_id"",""cust"".""customer_name"" FROM ""Customers"" AS ""cust"" JOIN ""Orders"" AS ""ord"" ON ""cust"".""customer_id""=""ord"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0"
102,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
103,"WITH ""final1"" AS (WITH ""final"" AS (WITH ""consolidated"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"",""o"".""product_name"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT *,CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END AS ""product_A_check"",CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""product_B_check"",CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END AS ""product_C_check"" FROM ""consolidated"") SELECT ""customer_id"",""customer_name"",SUM(""product_A_check"") AS ""sum_A"",SUM(""product_B_check"") AS ""sum_B"",SUM(""product_C_check"") AS ""sum_C"" FROM ""final"" GROUP BY ""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ""final1"" WHERE ""sum_A""!=0 AND ""sum_B""!=0 AND ""sum_C""=0"
104,"SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM (SELECT DISTINCT ""customer_id"",""product_name"" FROM ""orders"" WHERE ""product_name"" IN ('A','B','C')) AS ""a"" LEFT JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING (SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END))=1 AND (SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END))=1 AND (SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END))=0"
105,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
106,"SELECT ""C"".""customer_id"",""C"".""customer_name"" FROM ""Customers"" AS ""C"" LEFT JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" GROUP BY ""C"".""customer_id"" HAVING SUM(""O"".""product_name""='A')>0 AND SUM(""O"".""product_name""='B')>0 AND SUM(""O"".""product_name""='C')=0 ORDER BY ""C"".""customer_id"""
107,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" AS ""a"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C'))"
108,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A' OR ""o"".""product_name""='B' GROUP BY ""o"".""customer_id"" HAVING COUNT(""o"".""product_name"")=2 AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
109,"SELECT ""A"".""customer_id"" AS ""customer_id"",""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' OR ""product_name""='B' THEN 1 ELSE 0 END) AS ""ABcnt"",COALESCE(SUM(CASE WHEN ""product_name""='C' THEN 1 END), 0) AS ""CCnt"" FROM ""Orders"" AS ""orders"" GROUP BY ""customer_id"") AS ""A"" JOIN ""Customers"" AS ""customers"" ON ""A"".""customer_id""=""customers"".""customer_id"" WHERE ""ABcnt"">=2 AND ""CCnt""=0"
110,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
111,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0)"
112,"WITH ""lefty"" AS (SELECT DISTINCT ""c"".""customer_id"",""customer_name"",""o"".""product_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A' OR ""o"".""product_name""='B') SELECT ""customer_id"",""customer_name"" FROM ""lefty"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" AS ""o"" WHERE ""product_name""='C') GROUP BY ""customer_id"" HAVING COUNT(1)=2"
113,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
114,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"") GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 WHEN ""product_name""='C' THEN -1 ELSE '0' END)=2"
115,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"") GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0 ORDER BY ""o"".""customer_id"""
116,"SELECT DISTINCT ""Customers"".""customer_id"",""Customers"".""customer_name"" FROM ""Orders"" LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE ""Customers"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""Customers"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""Customers"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
117,"WITH ""cte"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""product_name""='A') SELECT ""customer_id"",""customer_name"" FROM ""Orders"" JOIN ""Customers"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT * FROM ""cte"") AND ""product_name""='B'"
118,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
119,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
120,"SELECT ""a"".""customer_id"",""b"".""customer_name"" FROM ""orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(CASE WHEN ""a"".""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""a"".""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""a"".""product_name""='C' THEN 1 ELSE 0 END)=0"
121,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
122,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
123,"WITH ""cte1"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')), ""cte2"" AS (SELECT ""customer_id"" FROM ""cte1"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A')), ""cte3"" AS (SELECT ""customer_id"" FROM ""cte2"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) SELECT DISTINCT ""cte3"".""customer_id"",""customer_name"" FROM ""cte3"" JOIN ""Customers"" ON ""cte3"".""customer_id""=""Customers"".""customer_id"" ORDER BY 1"
124,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
125,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY ""o"".""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
126,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM (""Customers"" AS ""c"") CROSS JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
127,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_name"",""o"".""customer_id"" HAVING SUM(CASE WHEN ""o"".""product_name"" IN ('A','B') THEN 1 WHEN ""o"".""product_name"" IN ('C') THEN 0.5 ELSE 0 END)=2"
128,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
129,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
130,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name""='A' OR ""product_name""='B' GROUP BY ""customer_id"" HAVING COUNT(""product_name"")=2 AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
131,"SELECT ""t"".""customer_id"",""t"".""customer_name"" FROM (SELECT ""o"".""customer_id"",""c"".""customer_name"",SUM(CASE WHEN ""o"".""product_name""='A' THEN 1 ELSE 0 END) AS ""prod_A"",SUM(CASE WHEN ""o"".""product_name""='B' THEN 1 ELSE 0 END) AS ""prod_B"",SUM(CASE WHEN ""o"".""product_name""='C' THEN 1 ELSE 0 END) AS ""prod_C"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"") AS ""t"" WHERE ""t"".""prod_A"">0 AND ""t"".""prod_B"">0 AND ""prod_C""=0 ORDER BY ""t"".""customer_id"""
132,"WITH ""cte"" AS (SELECT ""order_id"",""orders"".""customer_id"",""customer_name"",CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END AS ""A"",CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""B"",CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END AS ""C"" FROM ""Orders"" LEFT JOIN ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"") SELECT ""customer_id"",""customer_name"" FROM (SELECT ""customer_id"",""customer_name"",SUM(""A"") AS ""A"",SUM(""B"") AS ""B"",SUM(""C"") AS ""C"" FROM ""cte"" GROUP BY ""customer_id"") AS ""t"" WHERE ""a"">=1 AND ""b"">=1 AND ""c""=0"
133,"SELECT ""a"".""customer_id"",""customer_name"" FROM (SELECT ""customer_id"",STRING_AGG(DISTINCT ""product_name"", ',') AS ""p"" FROM ""orders"" GROUP BY ""customer_id"") AS ""a"" JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""p"" LIKE '%A%B%' AND ""p"" NOT LIKE '%C%'"
134,"WITH ""TEMP"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) SELECT DISTINCT ""temp"".""customer_id"",""c"".""customer_name"" FROM ""TEMP"" JOIN ""Customers"" AS ""c"" ON ""temp"".""customer_id""=""c"".""customer_id"" WHERE ""temp"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
135,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ((""Customers"" AS ""c"" LEFT JOIN (SELECT ""customer_id"",""product_name"" FROM ""Orders"" WHERE ""product_name""='A') AS ""t1"" ON ""c"".""customer_id""=""t1"".""customer_id"") LEFT JOIN (SELECT ""customer_id"",""product_name"" FROM ""Orders"" WHERE ""product_name""='B') AS ""t2"" ON ""c"".""customer_id""=""t2"".""customer_id"") LEFT JOIN (SELECT ""customer_id"",""product_name"" FROM ""Orders"" WHERE ""product_name""='C') AS ""t3"" ON ""c"".""customer_id""=""t3"".""customer_id"" WHERE ""t1"".""customer_id"" AND ""t2"".""customer_id"" AND ""t3"".""customer_id"" IS NULL"
136,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
137,"SELECT DISTINCT ""o"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""customer_name"" AS ""CUSTOMER_NAME"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""o"".""customer_id"""
138,"SELECT DISTINCT ""C"".""customer_id"",""C"".""customer_name"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"" WHERE ""O"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""C"" WHERE ""product_name""='A') AND ""O"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""C"" WHERE ""product_name""='B') AND ""O"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" AS ""C"" WHERE ""product_name""='C')"
139,"WITH ""cte"" AS (SELECT ""customer_id"" FROM (SELECT ""customer_id"",CASE WHEN ""product_name"" IN ('A') THEN 1 ELSE 0 END AS ""A"" FROM ""Orders"") AS ""x"" WHERE ""A""!=0), ""cte1"" AS (SELECT ""customer_id"" FROM (SELECT ""customer_id"",CASE WHEN ""product_name"" IN ('B') THEN 1 ELSE 0 END AS ""B"" FROM ""Orders"") AS ""x"" WHERE ""B""!=0), ""cte2"" AS (SELECT ""customer_id"" FROM (SELECT ""customer_id"",CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END AS ""C"" FROM ""Orders"") AS ""y"" WHERE ""C""=1) SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT * FROM ""cte"") AND ""customer_id"" IN (SELECT * FROM ""cte1"") AND ""customer_id"" NOT IN (SELECT * FROM ""cte2"") ORDER BY 1"
140,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""count_A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""count_B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""count_C"",SUM(CASE WHEN ""product_name""='D' THEN 1 ELSE 0 END) AS ""count_D"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING ""count_A"">0 AND ""count_B"">0 AND ""count_C""=0) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" ORDER BY 1"
141,"SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
142,"WITH ""customers_who_ordered_a"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A'), ""customers_who_ordered_b"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B'), ""customers_who_ordered_c"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C'), ""customers_ordered_ab_not_c"" AS (SELECT ""a"".""customer_id"" FROM (""customers_who_ordered_a"" AS ""a"") CROSS JOIN ""customers_who_ordered_b"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""customers_who_ordered_c"")) SELECT ""cu"".""customer_id"",""customer_name"" FROM ""customers_ordered_ab_not_c"" AS ""c"" JOIN ""Customers"" AS ""cu"" ON ""cu"".""customer_id""=""c"".""customer_id"""
143,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
144,"WITH ""CTE"" AS (SELECT DISTINCT ""O1"".""CUSTOMER_ID"" FROM ""ORDERS"" AS ""O1"" LEFT JOIN ""ORDERS"" AS ""O2"" ON ""O1"".""CUSTOMER_ID""=""O2"".""CUSTOMER_ID"" WHERE ""O1"".""PRODUCT_NAME""='A' AND ""O2"".""PRODUCT_NAME""='B') SELECT ""C2"".""CUSTOMER_ID"",""C2"".""CUSTOMER_NAME"" FROM ""CTE"" AS ""C1"" JOIN ""CUSTOMERS"" AS ""C2"" ON ""C1"".""CUSTOMER_ID""=""C2"".""CUSTOMER_ID"" AND ""C1"".""CUSTOMER_ID"" NOT IN (SELECT ""CUSTOMER_ID"" FROM ""ORDERS"" WHERE ""PRODUCT_NAME""='C')"
145,"SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""product_name""='A' AND ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""product_name""='C')"
146,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""orders"" LEFT JOIN ""customers"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
147,"SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND NOT ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
148,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""o"".""customer_id"",""c"".""customer_name"",SUM(CASE WHEN ""product_name""='A' THEN 100 WHEN ""product_name""='B' THEN 10 WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""product_index"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",""c"".""customer_name"") AS ""tmp"" WHERE ""product_index""=110"
149,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
150,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""o"".""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""o"".""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""o"".""product_name""='C' THEN 1 ELSE 0 END)=0)"
151,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
152,"SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
153,"SELECT ""a"".""customer_id"",""b"".""customer_name"" FROM ""orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY 1 HAVING (SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0)"
154,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END AS ""A"",CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""B"",CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END AS ""C"",CASE WHEN ""product_name""='D' THEN 1 ELSE 0 END AS ""D"" FROM ""orders"") AS ""a"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""a"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING MAX(""A"")=1 AND MAX(""B"")=1 AND MAX(""C"")=0"
155,"ERROR: mysql parse error: line 1 column 57 near "") , bought_a AS ( select customer_id from orders where product_name = 'A' ) , bought_b AS ( select customer_id from orders where product_name = 'B' ) select distinct customer_id, customer_name FROM bought_a join bought_b using (customer_id) left join bought_c c using(customer_id) join customers using (customer_id) where c.customer_id is null"" "
156,"WITH ""bought_ab"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" USING (""customer_id"") WHERE ""product_name""='A' OR ""product_name""='B' GROUP BY 1,2 HAVING COUNT(""product_name"")>=2) SELECT ""customer_id"",""customer_name"" FROM ""bought_ab"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
157,"SELECT DISTINCT ""b"".""customer_id"",""b"".""customer_name"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""a"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""a"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')"
158,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE (SELECT COUNT(""product_name"") FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name"" IN ('A','B'))=2 AND (SELECT COUNT(""product_name"") FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name""='C')=0"
159,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
160,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""O"".""product_name""='A')>0 AND SUM(""O"".""product_name""='B')>0 AND SUM(""O"".""product_name""='C')=0 ORDER BY ""o"".""customer_id"""
161,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY ""o"".""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
162,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
163,"SELECT ""a"".""customer_id"",""cust"".""customer_name"" FROM ((SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AS ""a"" JOIN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Customers"" AS ""cust"" ON ""a"".""customer_id""=""cust"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
164,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""c"".""customer_name"",""o"".""product_name"",SUM(CASE WHEN ""product_name""='A' THEN '1' ELSE '0' END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN '1' ELSE '0' END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN '1' ELSE '0' END) AS ""C"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1) SELECT ""cte"".""customer_id"",""cte"".""customer_name"" FROM ""cte"" WHERE ""A""=1 AND ""B""=1 AND ""C""=0"
165,"WITH ""temp1"" AS (SELECT DISTINCT ""o1"".""customer_id"" FROM (""orders"" AS ""o1"") CROSS JOIN ""orders"" AS ""o2"" WHERE ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""product_name""='A' AND ""o2"".""product_name""='B'), ""temp2"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') SELECT ""t1"".""customer_id"",""customer_name"" FROM (""temp1"" AS ""t1"" LEFT JOIN ""temp2"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""t1"".""customer_id""=""c"".""customer_id"" WHERE ""t2"".""customer_id"" IS NULL"
166,"SELECT DISTINCT (""customer_id""),""customer_name"" FROM ""Orders"" JOIN ""Customers"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
167,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
168,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
169,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
170,"WITH ""A"" AS (SELECT DISTINCT (""a1"".""customer_id"") FROM ((""Orders"" AS ""a1"") CROSS JOIN ""Orders"" AS ""a2"") CROSS JOIN ""Orders"" AS ""a3"" WHERE ""a1"".""product_name""='A' AND ""a2"".""product_name""='B' AND ""a3"".""product_name""!='C' AND ""a1"".""customer_id""=""a2"".""customer_id"" AND ""a2"".""customer_id""=""a3"".""customer_id"") SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM ""A"" AS ""a"" LEFT JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
171,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""o"".""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""o"".""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""o"".""product_name""='C' THEN 1 ELSE 0 END)=0 ORDER BY 1"
172,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT (""customer_id"") FROM ""Orders"" WHERE ""product_name""='C')"
173,"SELECT DISTINCT ""a"".""customer_id"",""c"".""customer_name"" FROM ((SELECT ""o1"".""customer_id"" FROM ""orders"" AS ""o1"" WHERE ""o1"".""product_name""='A') AS ""a"" JOIN (SELECT ""o2"".""customer_id"" FROM ""orders"" AS ""o2"" WHERE ""o2"".""product_name""='B') AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""o3"".""customer_id"" FROM ""orders"" AS ""o3"" WHERE ""o3"".""product_name""='C')"
174,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE (SELECT COUNT(""product_name"") FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name"" IN ('A','B'))=2 AND (SELECT COUNT(""product_name"") FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name""='C')=0"
175,"SELECT ""a"".""customer_id"",""customer_name"" FROM (""orders"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a"".""product_name""='A' AND ""b"".""product_name""='B' AND ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
176,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name""='A' OR ""product_name""='B' GROUP BY ""customer_id"" HAVING COUNT(""product_name"")=2 AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
177,"WITH ""t1"" AS (SELECT ""customer_id"",""product_name"",COUNT(1) AS ""cn"" FROM ""Orders"" GROUP BY ""customer_id"",""product_name""), ""get_trans"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN ""cn"" END) AS ""a"",SUM(CASE WHEN ""product_name""='B' THEN ""cn"" END) AS ""b"",SUM(CASE WHEN ""product_name""='C' THEN ""cn"" END) AS ""c"" FROM ""t1"" GROUP BY 1) SELECT ""g"".""customer_id"",""c"".""customer_name"" FROM ""get_trans"" AS ""g"" JOIN ""Customers"" AS ""c"" ON ""g"".""customer_id""=""c"".""customer_id"" WHERE ""a"">0 AND ""b"">0 AND ""c"" IS NULL ORDER BY 1"
178,"WITH ""order_type"" AS (SELECT ""customer_id"",CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END AS ""is_A_purchase"",CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""is_B_purchase"",CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END AS ""is_C_purchase"" FROM ""Orders"") SELECT ""customer_id"",""customer_name"" FROM ""order_type"" JOIN ""Customers"" USING (""customer_id"") GROUP BY ""customer_id"",""customer_name"" HAVING (MAX(""is_A_purchase"")>0 AND MAX(""is_B_purchase"")>0 AND MAX(""is_C_purchase"")=0) ORDER BY ""customer_id"""
179,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
180,"WITH ""CUST_A_B"" AS (SELECT DISTINCT ""A"".""CUSTOMER_ID"" FROM (SELECT ""CUSTOMER_ID"" FROM ""ORDERS"" WHERE ""PRODUCT_NAME""='A') AS ""A"" CROSS JOIN (SELECT ""CUSTOMER_ID"" FROM ""ORDERS"" WHERE ""PRODUCT_NAME""='B') AS ""B"" WHERE ""A"".""CUSTOMER_ID""=""B"".""CUSTOMER_ID"") SELECT ""C1"".""CUSTOMER_ID"",""C2"".""CUSTOMER_NAME"" FROM ""CUST_A_B"" AS ""C1"" JOIN ""CUSTOMERS"" AS ""C2"" ON ""C1"".""CUSTOMER_ID""=""C2"".""CUSTOMER_ID"" WHERE ""C1"".""CUSTOMER_ID"" NOT IN (SELECT ""CUSTOMER_ID"" FROM ""ORDERS"" WHERE ""PRODUCT_NAME""='C')"
181,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0 ORDER BY 1"
182,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM ""customers"" AS ""a"" CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
183,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"") GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
184,"SELECT ""a"".""customer_id"",""b"".""customer_name"" FROM (SELECT ""customer_id"",STRING_AGG(DISTINCT ""product_name"", ',' ORDER BY ""product_name"") AS ""product_list"" FROM ""orders"" GROUP BY ""customer_id"" HAVING FIND_IN_SET('A', ""product_list"")>0 AND FIND_IN_SET('B', ""product_list"")>0 AND FIND_IN_SET('C', ""product_list"")=0) AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
185,"WITH ""CTE"" AS (SELECT ""o"".""customer_id"",""c"".""customer_name"",SUM(""product_name""='A') AS ""countA"",SUM(""product_name""='B') AS ""countB"",SUM(""product_name""='C') AS ""countC"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2) SELECT ""cte"".""customer_id"",""cte"".""customer_name"" FROM ""CTE"" WHERE ""countA"">0 AND ""countB"">0 AND ""countC""=0"
186,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
187,"SELECT DISTINCT ""c"".""customer_id"",""customer_name"" FROM ""customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
188,"SELECT ""T"".""customer_id"",""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 WHEN ""product_name""='C' THEN -1 ELSE 0 END) AS ""Point"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""T"" JOIN ""Customers"" AS ""C"" ON ""T"".""customer_id""=""C"".""customer_id"" WHERE ""Point""=2 ORDER BY ""customer_id"""
189,"SELECT ""customer_id"",""customer_name"" FROM ""Orders"" JOIN ""customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING STRING_AGG(""product_name"", ',') LIKE '%A%' AND STRING_AGG(""product_name"", ',') LIKE '%B%' AND STRING_AGG(""product_name"", ',') NOT LIKE '%C%'"
190,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
191,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
192,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='C') ORDER BY ""c"".""customer_id"""
193,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' OR ""product_name""='B' GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_name"")=2) AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
194,"WITH ""subtable"" AS (SELECT ""customer_id"",""product_name"" FROM ""orders"" GROUP BY ""customer_id"",""product_name""), ""table2"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 WHEN ""product_name""='C' THEN -1 ELSE 0 END) AS ""person_value"" FROM ""subtable"" GROUP BY ""customer_id"") SELECT ""t"".""customer_id"",""c"".""customer_name"" FROM ""table2"" AS ""t"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""person_value""=2"
195,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
196,"SELECT ""A"".""customer_id"" AS ""customer_id"",""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' OR ""product_name""='B' THEN 1 ELSE 0 END) AS ""ABcnt"",COALESCE(SUM(CASE WHEN ""product_name""='C' THEN 1 END), 0) AS ""CCnt"" FROM ""Orders"" AS ""orders"" GROUP BY ""customer_id"") AS ""A"" JOIN ""Customers"" AS ""customers"" ON ""A"".""customer_id""=""customers"".""customer_id"" WHERE ""ABcnt""=2 AND ""CCnt""=0"
197,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
198,"WITH ""cte"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') SELECT DISTINCT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
199,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
200,"SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM (""customers"" AS ""c"") CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
201,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
202,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0"
203,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
204,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""ORDERS"" GROUP BY ""customer_id"") AS ""o"" ON ""c"".""Customer_id""=""o"".""Customer_id"" WHERE ""o"".""A"">=1 AND ""o"".""B"">=1 AND ""o"".""C""=0"
205,"WITH ""tmp"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C'), ""tmp2"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND NOT ""customer_id"" IN (SELECT ""customer_id"" FROM ""tmp"")), ""tmp3"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B' AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""tmp2"") AND NOT ""customer_id"" IN (SELECT ""customer_id"" FROM ""tmp"")) SELECT ""c"".""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" JOIN ""tmp3"" AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" ORDER BY ""customer_id"""
206,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
207,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
208,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""orders"" GROUP BY ""customer_id"") AS ""m"" ON ""c"".""customer_id""=""m"".""customer_id"" WHERE ""m"".""A"">0 AND ""m"".""B"">0 AND ""m"".""C""=0"
209,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
210,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B')"
211,"WITH ""t1"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')) SELECT ""t1"".""customer_id"",""c"".""customer_name"" FROM ""t1"" LEFT JOIN ""Customers"" AS ""c"" ON ""t1"".""customer_id""=""c"".""customer_id"""
212,"SELECT DISTINCT ""t"".""customer_id"",""customer_name"" FROM ""customers"" AS ""t"" JOIN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AS ""a"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
213,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')"
214,"SELECT DISTINCT ""c"".""customer_id"",""customer_name"" FROM (""customers"" AS ""c"") CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""product_name""='A' AND ""customer_name"" IN (SELECT DISTINCT ""customer_name"" FROM (""customers"" AS ""c"") CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""product_name""='B') AND ""customer_name"" NOT IN (SELECT DISTINCT ""customer_name"" FROM (""customers"" AS ""c"") CROSS JOIN ""orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""product_name""='C')"
215,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='C') ORDER BY ""c"".""customer_id"""
216,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A' AND ""c"".""customer_id"" IN (SELECT ""b"".""customer_id"" FROM ""orders"" AS ""b"" WHERE ""b"".""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""c1"".""customer_id"" FROM ""orders"" AS ""c1"" WHERE ""c1"".""product_name""='C')"
217,"SELECT ""t"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' OR ""product_name""='B' GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_name"")=2) AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""t"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""t"".""customer_id"""
218,"WITH ""A"" AS (SELECT DISTINCT (""customer_id"") AS ""custs_A"" FROM ""Orders"" WHERE ""product_name""='A'), ""B"" AS (SELECT DISTINCT (""customer_id"") AS ""custs_B"" FROM ""Orders"" WHERE ""product_name""='B'), ""C"" AS (SELECT DISTINCT (""customer_id"") AS ""custs_c"" FROM ""Orders"" WHERE ""product_name""='C') SELECT ""Customers"".""customer_id"",""Customers"".""customer_name"" FROM (SELECT ""A"".""custs_A"" FROM (""A"" JOIN ""B"" ON ""A"".""custs_A""=""B"".""custs_B"") LEFT JOIN ""C"" ON ""A"".""custs_A""=""C"".""custs_C"" WHERE ""C"".""custs_C"" IS NULL) AS ""t"" JOIN ""Customers"" ON ""Customers"".""customer_id""=""t"".""custs_A"""
219,"SELECT ""C"".""customer_id"",""C"".""customer_name"" FROM ""Customers"" AS ""C"" LEFT JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" GROUP BY ""C"".""customer_id"" HAVING SUM(""O"".""product_name""='A')>0 AND SUM(""O"".""product_name""='B')>0 AND SUM(""O"".""product_name""='C')=0 ORDER BY ""C"".""customer_id"""
220,"WITH ""Staging"" AS (SELECT ""customer_id"",COUNT(DISTINCT (CASE WHEN ""product_name"" IN ('A','B') THEN ""product_name"" ELSE NULL END)) AS ""AAndBCount"",COUNT(DISTINCT (CASE WHEN ""product_name""='C' THEN ""product_name"" ELSE NULL END)) AS ""CCount"" FROM ""Orders"" GROUP BY ""customer_id"") SELECT ""Customers"".""customer_id"",""Customers"".""customer_name"" FROM ""Staging"" JOIN ""Customers"" ON ""Staging"".""customer_id""=""Customers"".""customer_id"" WHERE ""AAndBCount"">=2 AND ""CCount""=0"
221,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
222,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')"
223,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" CROSS JOIN (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 WHEN ""product_name""='C' THEN -1 ELSE 0 END) AS ""tot"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING ""tot"">1) AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"""
224,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" GROUP BY ""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0)"
225,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""c"".""customer_name"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"",SUM(CASE WHEN ""product_name""='D' THEN 1 ELSE 0 END) AS ""D"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY ""o"".""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ""cte"" WHERE ""A""=1 AND ""B""=1 AND ""C""=0"
226,"WITH ""CTE"" AS (SELECT DISTINCT ""customer_id"",SUM(CASE WHEN ""product_name"" IN ('A','B','C') THEN 1 ELSE 0 END) AS ""cnt"",SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 ELSE 0 END) AS ""cnt1"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""product_name"" IN ('A','B','C') THEN 1 ELSE 0 END)!=3 AND SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 ELSE 0 END)=2) SELECT ""C"".""customer_id"",""C"".""customer_name"" FROM ""CTE"" AS ""C1"" JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""C1"".""customer_id"""
227,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' OR ""product_name""='B' THEN 1 ELSE 0 END) AS ""both"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""b"" WHERE ""both"">=2) AND ""o"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
228,"SELECT ""t1"".""customer_id"",""customer_name"" FROM (""Orders"" AS ""t1"" CROSS JOIN ""Orders"" AS ""t2"") JOIN ""Customers"" ON ""t1"".""customer_id""=""t2"".""customer_id"" AND ""t1"".""product_name""='A' AND ""t2"".""product_name""='B' AND ""t1"".""customer_id""=""Customers"".""customer_id"" WHERE ""t1"".""customer_id"" NOT IN (SELECT ""t1"".""customer_id"" FROM (""Orders"" AS ""t1"" CROSS JOIN ""Orders"" AS ""t2"") JOIN ""Orders"" AS ""t3"" ON ""t1"".""customer_id""=""t2"".""customer_id"" AND ""t3"".""customer_id""=""t2"".""customer_id"" AND ""t1"".""product_name""='A' AND ""t2"".""product_name""='B' AND ""t3"".""product_name""='C')"
229,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
230,"SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
231,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
232,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 WHEN ""product_name""='C' THEN 3 ELSE 0 END) AS ""product_sum"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""tmp"" WHERE ""product_sum""=2)"
233,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
234,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""customer_name"",""product_name"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""cte"" WHERE ""product_name"" IN ('A') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""product_name""='B')"
235,"WITH ""order_count"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""product_A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""product_B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""product_C"" FROM ""orders"" GROUP BY ""customer_id"") SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM ""customers"" AS ""a"" JOIN ""order_count"" AS ""oc"" ON ""a"".""customer_id""=""oc"".""customer_id"" AND ""oc"".""product_A"">0 AND ""oc"".""product_B"">0 AND ""oc"".""product_C""=0"
236,"WITH ""a"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A'), ""b"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM (""a"" JOIN ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
237,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
238,"SELECT DISTINCT ""Orders"".""customer_id"",""customer_name"" FROM ""Customers"" JOIN ""Orders"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE ""product_name"" IN ('A','B') AND ""Orders"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" IN ('C')) GROUP BY ""customer_id"" HAVING (COUNT(1)=2)"
239,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",STRING_AGG(""product_name"", ',') AS ""product_names"" FROM ""Orders"" AS ""o"" GROUP BY 1 HAVING ""product_names"" LIKE '%A%' AND ""product_names"" LIKE '%B%' AND ""product_names"" NOT LIKE '%C%') AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"""
240,"SELECT DISTINCT ""C"".""customer_id"",""C"".""customer_name"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" WHERE ""C"".""customer_id"" IN (SELECT ""D"".""customer_id"" FROM ""Customers"" AS ""D"" JOIN ""Orders"" AS ""E"" ON ""D"".""customer_id""=""E"".""customer_id"" WHERE ""E"".""product_name""='A') AND ""C"".""customer_id"" IN (SELECT ""D"".""customer_id"" FROM ""Customers"" AS ""D"" JOIN ""Orders"" AS ""E"" ON ""D"".""customer_id""=""E"".""customer_id"" WHERE ""E"".""product_name""='B') AND ""C"".""customer_id"" NOT IN (SELECT ""D"".""customer_id"" FROM ""Customers"" AS ""D"" JOIN ""Orders"" AS ""E"" ON ""D"".""customer_id""=""E"".""customer_id"" WHERE ""E"".""product_name""='C') ORDER BY ""C"".""customer_id"""
241,"SELECT DISTINCT ""o"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
242,"SELECT ""CUSTOMER_ID"",""CUSTOMER_name"" FROM ""Customers"" WHERE ""CUSTOMER_ID"" IN (SELECT ""CUSTOMER_ID"" FROM (SELECT ""CUSTOMER_ID"",COUNT(CASE WHEN ""product_name""='A' THEN 1 END) AS ""prod_a"",COUNT(CASE WHEN ""product_name""='B' THEN 1 END) AS ""prod_b"",COUNT(CASE WHEN ""product_name""='C' THEN 1 END) AS ""prod_c"" FROM ""orders"" GROUP BY 1) AS ""x"" WHERE ""prod_a""=1 AND ""prod_b""=1 AND ""prod_c""=0)"
243,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
244,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM ((""customers"" AS ""a"" JOIN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name"" IN ('A')) AS ""ab"" ON ""a"".""customer_id""=""ab"".""customer_id"") JOIN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name"" IN ('B')) AS ""ab2"" ON ""a"".""customer_id""=""ab2"".""customer_id"") LEFT JOIN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') AS ""c"" ON ""ab"".""customer_id""=""c"".""customer_id"" WHERE ""c"".""customer_id"" IS NULL"
245,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1 HAVING SUM(""o"".""product_name""='A')=1 AND SUM(""o"".""product_name""='b')=1 AND SUM(""o"".""product_name""='c')=0 ORDER BY 1"
246,"SELECT ""c"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" AS ""customer_name"" FROM ((""customers"" AS ""c"" JOIN ""orders"" AS ""a"" ON ""c"".""customer_id""=""a"".""customer_id"" AND ""a"".""product_name""='A') JOIN ""orders"" AS ""b"" ON ""c"".""customer_id""=""b"".""customer_id"" AND ""b"".""product_name""='B') LEFT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_name""='C' WHERE ""o"".""order_id"" IS NULL"
247,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""A"".""customer_id"" FROM (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AS ""A"" JOIN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" WHERE ""A"".""customer_id"" NOT IN ((SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')))"
248,"WITH ""agg"" AS (SELECT ""t1"".""customer_id"",""t2"".""customer_name"",SUM(CASE WHEN ""t1"".""product_name""='A' THEN 1 ELSE 0 END) AS ""num_A"",SUM(CASE WHEN ""t1"".""product_name""='B' THEN 1 ELSE 0 END) AS ""num_B"",SUM(CASE WHEN ""t1"".""product_name""='C' THEN 1 ELSE 0 END) AS ""num_C"" FROM ""Orders"" AS ""t1"" JOIN ""Customers"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"" GROUP BY ""t1"".""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ""agg"" WHERE ""num_A"">0 AND ""num_B"">0 AND ""num_C""=0"
249,"SELECT ""t"".""customer_id"",""customer_name"" FROM ((""Customers"" AS ""t"" LEFT JOIN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AS ""a"" ON ""t"".""customer_id""=""a"".""customer_id"") LEFT JOIN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AS ""b"" ON ""t"".""customer_id""=""b"".""customer_id"") LEFT JOIN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" WHERE ""a"".""customer_id"" IS NOT NULL AND ""b"".""customer_id"" IS NOT NULL AND ""c"".""customer_id"" IS NULL"
250,"WITH ""CTE"" AS ((SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') UNION ALL (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') UNION ALL (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C'))) SELECT ""c"".""customer_id"",""customer_name"" FROM ""CTE"" LEFT JOIN ""Customers"" AS ""c"" ON ""CTE"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(1)=3"
251,"SELECT DISTINCT ""sub"".""a"" AS ""customer_id"",""sub"".""b"" AS ""customer_name"" FROM (SELECT ""o"".""customer_id"" AS ""a"",""c"".""customer_name"" AS ""b"",""o"".""product_name"" AS ""c"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""c"".""customer_id"" IN (SELECT ""o1"".""customer_id"" FROM (SELECT ""customer_id"" FROM ""orders"" AS ""o"" WHERE ""product_name""='A') AS ""o1"" JOIN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AS ""t1"" ON ""o1"".""customer_id""=""t1"".""customer_id"") AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')) AS ""sub"""
252,"WITH ""TEMP"" AS (SELECT ""A"".""customer_id"",""customer_name"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""Orders"" AS ""A"" LEFT JOIN ""Customers"" AS ""B"" ON ""A"".""customer_id""=""B"".""customer_id"" GROUP BY ""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ""TEMP"" WHERE ""A""=1 AND ""B""=1 AND ""C""=0 ORDER BY ""customer_id"""
253,"WITH ""boughtAB"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" IN ('A','B') GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_name"")=2), ""boughtC"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" IN ('C')) SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT * FROM ""boughtAB"") AND ""customer_id"" NOT IN (SELECT * FROM ""boughtC"")"
254,"SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name"" IN ('A')) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name"" IN ('B')) AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name"" IN ('C'))"
255,"SELECT ""c"".""CUSTOMER_ID"",""c"".""CUSTOMER_NAME"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0 ORDER BY ""c"".""customer_id"""
256,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ((""Customers"" AS ""c"" JOIN ""Orders"" AS ""a"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""a"".""product_name""='A') JOIN ""Orders"" AS ""b"" ON ""b"".""customer_id""=""c"".""customer_id"" AND ""b"".""product_name""='B') LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""product_name""='C' WHERE ""o"".""order_id"" IS NULL"
257,"WITH ""CustomerC"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C' GROUP BY ""customer_id""), ""CustomerA"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' GROUP BY ""customer_id""), ""CustomerB"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B' GROUP BY ""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ((""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""CustomerA"" USING (""customer_id"")) JOIN ""CustomerB"" USING (""customer_id"") WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""CustomerC"") AND ""customer_id"" GROUP BY ""customer_id"",""customer_name"" ORDER BY ""customer_id"""
258,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
259,"SELECT ""b"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",SUM(""flag"") AS ""flags"" FROM (SELECT ""customer_id"",CASE WHEN ""product_name""='C' THEN -1 WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""flag"" FROM (SELECT DISTINCT ""customer_id"",""product_name"" FROM ""Orders"" WHERE ""product_name""='A' OR ""product_name""='B' OR ""product_name""='C') AS ""d"") AS ""a"" GROUP BY ""customer_id"") AS ""b"" LEFT JOIN ""Customers"" AS ""c"" ON ""b"".""customer_id""=""c"".""customer_id"" WHERE ""flags""=2"
260,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" GROUP BY ""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0)"
261,"SELECT ""X"".""customer_id"",""X"".""customer_name"" FROM (SELECT ""Orders"".""customer_id"",""customer_name"" FROM ""Orders"" LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE ""product_name""='A' AND ""Orders"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) AS ""X"" LEFT JOIN (SELECT ""customer_id"",""product_name"" FROM ""Orders"" WHERE ""product_name""='C') AS ""Y"" ON ""X"".""customer_id""=""Y"".""customer_id"" WHERE ""Y"".""product_name"" IS NULL"
262,"SELECT DISTINCT ""a"".""customer_id"",""customer_name"" FROM ""Orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""product_name""='A' AND ""a"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""a"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
263,"WITH ""cte"" AS (SELECT ""customer_id"",STRING_AGG(""product_name"", ',') AS ""concat"" FROM ""orders"" GROUP BY ""customer_id"") SELECT ""c"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" AS ""customer_name"" FROM ""cte"" JOIN ""customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE (""cte"".""concat"" LIKE '%A%B%' AND ""cte"".""concat"" NOT LIKE '%C%' OR ""cte"".""concat"" LIKE '%B%A%' AND ""cte"".""concat"" NOT LIKE '%C%')"
264,"ERROR: mysql parse error: line 1 column 185 near ""A1 join (select customer_id from orders where product_name = 'A' ) A2 on A1.customer_id = A2.customer_id join (select customer_id from orders where product_name = 'B' ) A3 on A1.customer_id = A3.customer_id) join customers c on A1.customer_id = c.customer_id"" "
265,"SELECT DISTINCT ""Orders"".""customer_id"",""customer_name"" FROM ""Orders"" LEFT JOIN ""Customers"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE ""Orders"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""Orders"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""Orders"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
266,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""O"".""customer_id"",""C"".""customer_name"",STRING_AGG(DISTINCT ""O"".""product_name"", ',' ORDER BY ""product_name"") AS ""products"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"" GROUP BY ""O"".""customer_id"",""C"".""customer_name"") AS ""cust_orders"" WHERE ""products"" NOT LIKE '%C%' AND ""products"" LIKE '%A,B%'"
267,"SELECT ""c"".""customer_id"",""customer_name"" FROM (""Customers"" AS ""c"") CROSS JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') GROUP BY 1 ORDER BY 1"
268,"WITH ""a"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A'), ""b"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B'), ""c"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""orders"" JOIN ""customers"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT * FROM ""a"") AND ""customer_id"" IN (SELECT * FROM ""b"") AND ""customer_id"" NOT IN (SELECT * FROM ""c"") ORDER BY ""customer_id"""
269,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"") GROUP BY 1 HAVING SUM(""o"".""product_name""='A')>=1 AND SUM(""o"".""product_name""='B')>=1 AND SUM(""o"".""product_name""='C')=0"
270,"WITH ""cust_a"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A'), ""cust_b"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') SELECT ""cust_a"".""customer_id"",""c"".""customer_name"" FROM (""cust_a"" JOIN ""cust_b"" ON ""cust_a"".""customer_id""=""cust_b"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""cust_a"".""customer_id""=""c"".""customer_id"" WHERE ""cust_a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
271,"WITH ""cte"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""Orders"" GROUP BY 1) SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""A"">0 AND ""B"">0 AND ""C""=0) ORDER BY 1"
272,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A' AND ""o"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""o"".""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" WHERE ""o"".""product_name""='C')"
273,"SELECT ""customers"".""customer_id"",""customer_name"" FROM ""customers"" JOIN ""orders"" ON ""customers"".""customer_id""=""orders"".""customer_id"" WHERE ""product_name""='A' AND ""customers"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customers"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
274,"WITH ""temp"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""Orders"" GROUP BY ""customer_id"") SELECT ""t"".""customer_id"",""c"".""customer_name"" FROM ""temp"" AS ""t"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""t"".""A"">0 AND ""t"".""B"">0 AND ""t"".""C""=0"
275,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE 'A' IN (SELECT ""product_name"" FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"") AND 'B' IN (SELECT ""product_name"" FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"") AND 'C' NOT IN (SELECT ""product_name"" FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"")"
276,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE 'A' IN (SELECT ""product_name"" FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"") AND 'B' IN (SELECT ""product_name"" FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"") AND 'C' NOT IN (SELECT ""product_name"" FROM ""Orders"" WHERE ""customer_id""=""c"".""customer_id"")"
277,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='C') ORDER BY ""c"".""customer_id"""
278,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
279,"SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
280,"SELECT DISTINCT ""A"".""customer_id"",""customer_name"" FROM ((SELECT * FROM ""Orders"" WHERE ""Product_name""='A') AS ""A"" JOIN (SELECT * FROM ""Orders"" WHERE ""Product_name""='B') AS ""B"" USING (""customer_id"")) JOIN ""Customers"" USING (""customer_id"") WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
281,"WITH ""CTE1"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT * FROM ""CTE1"")"
282,"WITH ""t"" AS (SELECT ""customer_id"",CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END AS ""aflag"",CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""bflag"",CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END AS ""cflag"" FROM ""orders"") SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" GROUP BY 1 HAVING SUM(""aflag"")>0 AND SUM(""bflag"")>0 AND SUM(""cflag"")=0"
283,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
284,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY ""o"".""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
285,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"",""c"".""customer_name"" HAVING SUM(CASE WHEN ""o"".""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""o"".""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""o"".""product_name""='C' THEN 1 ELSE 0 END)=0"
286,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
287,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" WHERE EXISTS (SELECT * FROM ""orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name""='A') AND EXISTS (SELECT * FROM ""orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name""='B') AND NOT EXISTS (SELECT * FROM ""orders"" WHERE ""customer_id""=""c"".""customer_id"" AND ""product_name""='C') ORDER BY ""c"".""customer_id"""
288,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""C"".""customer_id"",""C"".""customer_name"",(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 WHEN ""product_name""='C' THEN 5 ELSE 0 END) AS ""value"" FROM ""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""O"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(""value"")=2) AS ""a"""
289,"SELECT DISTINCT ""C"".""customer_id"" AS ""CUSTOMER_ID"",""C"".""customer_name"" AS ""CUSTOMER_NAME"" FROM ""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" WHERE ""C"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""C"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""C"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')"
290,"SELECT ""P"".""customer_id"",""C"".""customer_name"" FROM (SELECT STRING_AGG(DISTINCT ""product_name"", ',') AS ""allproducts"",""customer_id"" FROM ""orders"" GROUP BY ""customer_id"") AS ""P"" JOIN ""Customers"" AS ""C"" ON ""P"".""customer_id""=""C"".""customer_id"" WHERE ""P"".""allproducts"" LIKE '%A%B%' AND ""P"".""allproducts"" NOT LIKE '%C%'"
291,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM ""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
292,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
293,"WITH ""cte"" AS (SELECT DISTINCT ""a"".""customer_id"" FROM ""Orders"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""product_name""='A' AND ""b"".""product_name""='B' AND ""a"".""customer_id"" NOT IN (SELECT DISTINCT ""c"".""customer_id"" FROM ""Orders"" AS ""c"" WHERE ""c"".""product_name""='C')) SELECT ""cte"".""customer_id"",""c"".""customer_name"" FROM ""cte"" JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" ORDER BY 1"
294,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
295,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" WHERE ""o"".""product_name""='C') ORDER BY ""c"".""customer_id"""
296,"WITH ""lefty"" AS (SELECT DISTINCT ""c"".""customer_id"",""customer_name"",""o"".""product_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A' OR ""o"".""product_name""='B'), ""righty"" AS (SELECT DISTINCT ""customer_id"" FROM ""orders"" AS ""o"" WHERE ""product_name""='C') SELECT ""customer_id"",""customer_name"" FROM ""lefty"" WHERE ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""righty"") GROUP BY ""customer_id"" HAVING COUNT(1)=2"
297,"SELECT ""customer_id"",""customer_name"" FROM ""Orders"" JOIN ""Customers"" USING (""customer_id"") GROUP BY 1 HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0 ORDER BY 1"
298,"SELECT ""Orders"".""customer_id"",""customer_name"" FROM ""Orders"" LEFT JOIN ""Customers"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE ""product_name""='A' AND ""Orders"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""Orders"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
299,"SELECT ""a"".""customer_id"",""b"".""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 10 WHEN ""product_name""='C' THEN 100 ELSE 0 END) AS ""product_score"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""product_score""=11"
300,"SELECT DISTINCT ""c"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o1"" ON ""c"".""customer_id""=""o1"".""customer_id"") JOIN ""orders"" AS ""o2"" ON ""c"".""customer_id""=""o2"".""customer_id"" WHERE ""o1"".""product_name""='A' AND ""o2"".""product_name""='B' AND NOT EXISTS (SELECT ""customer_id"" FROM ""orders"" AS ""o3"" WHERE ""c"".""customer_id""=""o3"".""customer_id"" AND ""o3"".""product_name""='C')"
301,"WITH ""CUST_CTE"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')) SELECT ""c1"".""customer_id"",""customer_name"" FROM ""CUST_CTE"" AS ""c1"" JOIN ""Customers"" AS ""c2"" ON ""c1"".""customer_id""=""c2"".""customer_id"""
302,"WITH ""CTE"" AS (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) SELECT ""CTE"".""customer_id"",""Customers"".""customer_name"" FROM ""CTE"" LEFT JOIN ""Customers"" ON ""CTE"".""customer_id""=""Customers"".""customer_id"" WHERE ""CTE"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
303,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
304,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE (""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A')) AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
305,"SELECT DISTINCT ""Customers"".""customer_id"",""Customers"".""customer_name"" FROM ""Orders"" JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE ""Customers"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""Customers"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""Customers"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
306,"SELECT * FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
307,"SELECT * FROM ""customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
308,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
309,"WITH ""cte"" AS (SELECT ""order_id"",""customer_id"",""product_name"" FROM ""orders"" WHERE ""product_name""='A' OR ""product_name""='B'), ""cte2"" AS (SELECT ""customer_id"",COUNT(""product_name"") AS ""n"" FROM ""cte"" GROUP BY 1), ""cte3"" AS (SELECT ""customer_id"" FROM ""cte2"" WHERE ""n""=2), ""cte4"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte3"") AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""cte4"")"
310,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
311,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
312,"WITH ""base"" AS (SELECT ""cc"".""customer_id"",""cc"".""customer_name"",SUM(CASE WHEN ""oo"".""product_name""='A' THEN 1 ELSE 0 END) AS ""a_count"",SUM(CASE WHEN ""oo"".""product_name""='B' THEN 1 ELSE 0 END) AS ""b_count"",SUM(CASE WHEN ""oo"".""product_name""='C' THEN 1 ELSE 0 END) AS ""c_count"" FROM ""customers"" AS ""cc"" JOIN ""orders"" AS ""oo"" ON ""cc"".""customer_id""=""oo"".""customer_id"" GROUP BY 1,2) SELECT ""customer_id"",""customer_name"" FROM ""base"" WHERE ""a_count"">=1 AND ""b_count"">=1 AND ""c_count""=0"
313,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
314,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
315,"SELECT DISTINCT ""a"".""customer_id"",""b"".""customer_name"" FROM (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')) AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
316,"WITH ""bought_a"" AS (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A'), ""bought_b"" AS (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B'), ""bought_c"" AS (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') SELECT ""bought_a"".""customer_id"",""customers"".""customer_name"" FROM (""bought_a"" JOIN ""bought_b"" USING (""customer_id"")) JOIN ""customers"" USING (""customer_id"") WHERE ""bought_a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""bought_c"")"
317,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
318,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""a"".""customer_id"",""customer_name"",SUM(""a"".""type_count"") OVER (PARTITION BY ""a"".""customer_id"") AS ""type_value"" FROM (SELECT ""o"".""customer_id"",""c"".""customer_name"",CASE WHEN ""o"".""product_name""='A' THEN 1 WHEN ""o"".""product_name""='B' THEN 1 WHEN ""o"".""product_name""='c' THEN -1 ELSE 0 END AS ""type_count"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""a"") AS ""bb"" WHERE ""type_value""=2 GROUP BY ""customer_id"""
319,"SELECT ""Customers"".""customer_id"",""Customers"".""customer_name"" FROM ""Customers"" WHERE ""Customers"".""customer_id"" IN (SELECT DISTINCT ""Customers"".""customer_id"" FROM ""Customers"" LEFT JOIN ""Orders"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE ""Orders"".""product_name""='A') AND ""Customers"".""customer_id"" IN (SELECT DISTINCT ""Customers"".""customer_id"" FROM ""Customers"" LEFT JOIN ""Orders"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE ""Orders"".""product_name""='B') AND ""Customers"".""customer_id"" NOT IN (SELECT DISTINCT ""Customers"".""customer_id"" FROM ""Customers"" LEFT JOIN ""Orders"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE ""Orders"".""product_name""='C') ORDER BY ""customer_id"""
320,"SELECT DISTINCT ""a"".""customer_id"",""b"".""customer_name"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY 1,2 HAVING MAX(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)=1 AND MAX(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)=1 AND MAX(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0"
321,"SELECT DISTINCT ""a"".""customer_id"",""c"".""customer_name"" FROM ((SELECT ""o1"".""customer_id"" FROM ""orders"" AS ""o1"" WHERE ""o1"".""product_name""='A') AS ""a"" JOIN (SELECT ""o2"".""customer_id"" FROM ""orders"" AS ""o2"" WHERE ""o2"".""product_name""='B') AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""o3"".""customer_id"" FROM ""orders"" AS ""o3"" WHERE ""o3"".""product_name""='C')"
322,"WITH ""CTE1"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""product_name""='A' AND ""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')) SELECT ""CTE1"".""customer_id"",""customer_name"" FROM ""CTE1"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""CTE1"".""customer_id"" ORDER BY ""CTE1"".""customer_id"""
323,"WITH ""cte"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""orders"" GROUP BY ""customer_id"") SELECT ""cte"".""customer_id"",""c"".""customer_name"" FROM ""cte"" JOIN ""customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" WHERE ""A"">=1 AND ""B"">=1 AND ""C""=0"
324,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""customer_id"",""product_name"",CASE WHEN ""product_name""='A' THEN 1 WHEN ""product_name""='B' THEN 1 ELSE 0 END AS ""tag"" FROM ""orders"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name"" IN ('C'))) AS ""t1"" LEFT JOIN ""customers"" AS ""c"" ON (""t1"".""customer_id""=""c"".""customer_id"") WHERE ""t1"".""tag""=1 GROUP BY ""t1"".""customer_id"" HAVING COUNT(DISTINCT ""product_name"")=2"
325,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""c"".""customer_id"",""c"".""customer_name"",SUM(CASE WHEN ""product_name"" IN ('A','B') THEN 1 WHEN ""product_name"" IN ('C') THEN -1 END) AS ""Score"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2) AS ""a"" WHERE ""Score""=2"
326,"SELECT ""o1"".""customer_id"",""c"".""customer_name"" FROM ((""orders"" AS ""o1"") CROSS JOIN ""orders"" AS ""o2"") CROSS JOIN ""customers"" AS ""c"" WHERE ""o1"".""customer_id""=""c"".""customer_id"" AND ""o1"".""customer_id""=""o2"".""customer_id"" AND ""o1"".""product_name""='A' AND ""o2"".""product_name""='B' AND ""o1"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') ORDER BY ""o1"".""customer_id"""
327,"SELECT DISTINCT ""a"".""customer_id"",""b"".""customer_name"" FROM ""ORDERS"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""product_name""='A' AND ""a"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""a"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
328,"WITH ""table1"" AS (SELECT ""customer_id"",STRING_AGG(""product_name"", ',' ORDER BY ""product_name"") AS ""total_product"" FROM ""Orders"" GROUP BY 1) SELECT ""table1"".""customer_id"" AS ""CUSTOMER_ID"",""customer_name"" AS ""CUSTOMER_NAME"" FROM ""table1"" LEFT JOIN ""Customers"" ON ""Customers"".""customer_id""=""table1"".""customer_id"" WHERE ""total_product"" LIKE '%A%' AND ""total_product"" LIKE '%B%' AND ""total_product"" NOT LIKE '%C%'"
329,"SELECT DISTINCT ""a"".""customer_id"",""b"".""customer_name"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY 1,2 HAVING MAX(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)=1 AND MAX(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)=1 AND MAX(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0"
330,"SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""customer_name"" AS ""CUSTOMER_NAME"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
331,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')"
332,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
333,"WITH ""cte"" AS (SELECT ""c"".""customer_name"",""o"".""customer_id"",""o"".""product_name"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"",SUM(CASE WHEN ""product_name""='D' THEN 1 ELSE 0 END) AS ""D"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"") SELECT ""customer_id"",""customer_name"" FROM ""cte"" WHERE ""A""=1 AND ""B""=1 AND ""C""=0"
334,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
335,"WITH ""cte"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A'), ""cte2"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B'), ""cte3"" AS (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""orders"" JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"") AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte2"") AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""cte3"")"
336,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
337,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
338,"WITH ""bought_a"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"",""o"".""product_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='A'), ""bought_b"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"",""o"".""product_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='B'), ""bought_c"" AS (SELECT ""c"".""customer_id"",""c"".""customer_name"",""o"".""product_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""product_name""='C') SELECT DISTINCT ""a"".""customer_id"",""a"".""customer_name"" FROM ""bought_a"" AS ""a"" JOIN ""bought_b"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""bought_c"" WHERE ""product_name""='C')"
339,"SELECT ""t1"".""customer_id"",""c"".""customer_name"" FROM (SELECT ""t"".""customer_id"",(CASE WHEN ""t"".""product_name""='A' THEN 1 WHEN ""t"".""product_name""='B' THEN 1 WHEN ""t"".""product_name""='C' THEN 0.5 ELSE 0 END) AS ""index_p"" FROM (SELECT ""customer_id"",""product_name"" FROM ""Orders"" WHERE ""product_name"" IN ('A','B','C') GROUP BY ""customer_id"",""product_name"") AS ""t"") AS ""t1"" LEFT JOIN ""Customers"" AS ""c"" ON ""t1"".""customer_id""=""c"".""customer_id"" GROUP BY ""t1"".""customer_id"" HAVING SUM(""t1"".""index_p"")=2"
340,"SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""customer_name"" AS ""CUSTOMER_NAME"" FROM (SELECT ""a"".""customer_id"" FROM ((SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A' GROUP BY ""customer_id"") AS ""a"" JOIN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B' GROUP BY ""customer_id"") AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN (SELECT ""cc"".""customer_id"" FROM (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C' GROUP BY ""customer_id"") AS ""c"" RIGHT JOIN ""Customers"" AS ""cc"" ON ""c"".""customer_id""=""cc"".""customer_id"" WHERE ""c"".""customer_id"" IS NULL) AS ""x"" ON ""b"".""customer_id""=""x"".""customer_id"") AS ""x"" JOIN ""Customers"" AS ""c"" ON ""x"".""customer_id""=""c"".""customer_id"" ORDER BY ""c"".""customer_id"""
341,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name"" IN ('A','B') AND ""c"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') GROUP BY ""c"".""customer_id"",""c"".""customer_name"" HAVING COUNT(""c"".""customer_name"")=2"
342,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"",""c"".""customer_name"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0 ORDER BY ""c"".""customer_id"""
343,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
344,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""product_name""='A')>0 AND SUM(""o"".""product_name""='B')>0 AND SUM(""o"".""product_name""='C')=0"
345,"SELECT ""customer_id"",""customer_name"" FROM ""orders"" JOIN ""customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)=1 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)=1 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0"
346,"SELECT ""b"".""customer_id"",""b"".""customer_name"" FROM ""orders"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""b"".""customer_id"" HAVING SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END)=0 ORDER BY ""b"".""customer_id"""
347,"SELECT ""C"".""customer_id"",""C"".""customer_name"" FROM ""Customers"" AS ""C"" LEFT JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"" GROUP BY ""C"".""customer_id"" HAVING SUM(""O"".""product_name""='A')>0 AND SUM(""O"".""product_name""='B')>0 AND SUM(""O"".""product_name""='C')=0 ORDER BY ""C"".""customer_id"""
348,"SELECT ""x"".""customer_id"",""c"".""customer_name"" FROM ""customers"" AS ""c"" JOIN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') AND ""product_name"" IN ('A','B') GROUP BY 1 HAVING COUNT(1)>1) AS ""x"" ON ""x"".""customer_id""=""c"".""customer_id"""
349,"SELECT ""o"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" AS ""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN ""o"".""product_name""='C' THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""o"".""product_name""='A' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""o"".""product_name""='B' THEN 1 ELSE 0 END)>=1"
350,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
351,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" LEFT JOIN (SELECT ""customer_id"" AS ""c"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""a"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""b"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""cc"" FROM ""orders"" GROUP BY ""customer_id"") AS ""t"" ON ""customers"".""customer_id""=""t"".""c"" WHERE ""a"">0 AND ""b"">0 AND ""cc""=0"
352,"SELECT DISTINCT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""product_name"" IN ('A','B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') GROUP BY ""o"".""customer_id"" HAVING COUNT(""o"".""customer_id"")>1"
353,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""c"".""customer_id"" IN (SELECT ""o2"".""customer_id"" FROM ""Orders"" AS ""o2"" WHERE ""o2"".""product_name""='A') AND ""c"".""customer_id"" IN (SELECT ""o2"".""customer_id"" FROM ""Orders"" AS ""o2"" WHERE ""o2"".""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""o2"".""customer_id"" FROM ""Orders"" AS ""o2"" WHERE ""o2"".""product_name""='C') GROUP BY 1,2 ORDER BY 1"
354,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name""='A' AND ""c"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT DISTINCT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C')"
355,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
356,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""c"".""customer_id"" AS ""customer_id"",""c"".""customer_name"" AS ""customer_name"",(SUM(""product_name""='A')>=1) AND (SUM(""product_name""='B')>=1) AND (SUM(""product_name""='C')=0) AS ""cond"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"") AS ""d"" WHERE ""cond""=TRUE"
357,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE (""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A')) AND (""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B')) AND (""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C'))"
358,"SELECT ""a"".""customer_id"",""customers"".""customer_name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END) AS ""A"",SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END) AS ""B"",SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END) AS ""C"" FROM ""orders"" GROUP BY ""customer_id"" HAVING ""A""=1 AND ""B""=1 AND ""C""=0) AS ""a"" CROSS, ""customers"" WHERE ""a"".""customer_id""=""customers"".""customer_id"""
359,"SELECT ""o"".""customer_id"",""customer_name"" FROM ""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""product_name""='A' OR ""product_name""='B' AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') GROUP BY 1 HAVING COUNT(DISTINCT ""product_name"")=2 ORDER BY 1"
360,"SELECT ""a"".""customer_id"",""a"".""customer_name"" FROM (""customers"" AS ""a"") CROSS JOIN ""orders"" AS ""b"" WHERE ""a"".""customer_id""=""b"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(""b"".""product_name""='A')>0 AND SUM(""b"".""product_name""='B')>0 AND SUM(""b"".""product_name""='C')=0"
361,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') GROUP BY ""o"".""customer_id"""
362,"SELECT ""c"".""customer_id"",""customer_name"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE (""product_name""='A' OR ""product_name""='B') AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') GROUP BY ""c"".""customer_id"",""customer_name"" HAVING COUNT(""customer_name"")=2 ORDER BY ""c"".""customer_id"""
363,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
364,"SELECT ""t2"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",STRING_AGG(""product_name"", ',') AS ""products"" FROM ""Orders"" GROUP BY ""customer_id"") AS ""t2"" ON ""c"".""customer_id""=""t2"".""customer_id"" WHERE ""t2"".""products"" NOT LIKE '%C%' AND ""t2"".""products"" LIKE '%A%' AND ""t2"".""products"" LIKE '%B%'"
365,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A')"
366,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
367,"SELECT DISTINCT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
368,"SELECT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
369,"SELECT ""o"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') GROUP BY ""o"".""customer_id"""
370,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C') ORDER BY ""customer_id"""
371,"SELECT ""a"".""customer_id"",""c"".""customer_name"" FROM (SELECT DISTINCT ""customer_id"",""product_name"" FROM ""orders"" WHERE ""product_name"" IN ('A','B','C')) AS ""a"" LEFT JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY ""a"".""customer_id"" HAVING (SUM(CASE WHEN ""product_name""='A' THEN 1 ELSE 0 END))=1 AND (SUM(CASE WHEN ""product_name""='B' THEN 1 ELSE 0 END))=1 AND (SUM(CASE WHEN ""product_name""='C' THEN 1 ELSE 0 END))=0"
372,"WITH ""base_table"" AS (SELECT ""customer_id"",""customer_name"",STRING_AGG(DISTINCT ""product_name"", ',') AS ""product_lists"" FROM ""Customers"" LEFT JOIN ""Orders"" USING (""customer_id"") GROUP BY 1,2) SELECT ""customer_id"",""customer_name"" FROM ""base_table"" WHERE ""product_lists"" LIKE '%A%B%' AND ""product_lists"" NOT LIKE '%C%' GROUP BY 1"
373,"WITH ""cus_A"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" LIKE 'A'), ""cus_B"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" LIKE 'B'), ""cus_C"" AS (SELECT DISTINCT ""customer_id"" FROM ""Orders"" WHERE ""product_name"" LIKE 'C') SELECT DISTINCT ""c"".""customer_id"",""c"".""customer_name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cus_A"") AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cus_B"") AND ""c"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""cus_C"")"
374,"SELECT ""customer_id"",""customer_name"" FROM ""customers"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" GROUP BY ""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0) ORDER BY ""customer_id"""
375,"SELECT ""customer_id"",""customer_name"" FROM (SELECT ""Orders"".""customer_id"",""Customers"".""customer_name"",""Orders"".""product_name"" FROM ""Orders"" JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") AS ""tb1"" GROUP BY ""customer_id"" HAVING SUM(""product_name""='A')>0 AND SUM(""product_name""='B')>0 AND SUM(""product_name""='C')=0"
376,"SELECT ""customer_id"",""customer_name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
377,"SELECT DISTINCT ""o"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""customer_name"" AS ""CUSTOMER_NAME"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='A') AND ""o"".""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='B') AND ""o"".""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""Orders"" WHERE ""product_name""='C')"
378,"SELECT ""sub1"".""customer_id"",""c"".""customer_name"" FROM (((SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='A') AS ""sub1"" JOIN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='B') AS ""sub2"" ON ""sub1"".""customer_id""=""sub2"".""customer_id"") LEFT JOIN (SELECT ""customer_id"" FROM ""orders"" WHERE ""product_name""='C') AS ""sub3"" ON ""sub1"".""customer_id""=""sub3"".""customer_id"") JOIN ""customers"" AS ""c"" ON ""sub1"".""customer_id""=""c"".""customer_id"" WHERE ""sub3"".""customer_id"" IS NULL"
