id,original query
1,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
2,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
3,"WITH ""apples"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""oranges"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apples"".""sale_date"",""apples"".""sold_num""-""oranges"".""sold_num"" AS ""diff"" FROM ""apples"" JOIN ""oranges"" ON ""apples"".""sale_date""=""oranges"".""sale_date"""
4,"WITH ""apple"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apple"".""sale_date"",(""apple"".""sold_num""-""orange"".""sold_num"") AS ""diff"" FROM ""apple"" JOIN ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"""
5,"SELECT ""t1"".""sale_date"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""t1"" JOIN ""sales"" AS ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"" WHERE ""t1"".""fruit"" LIKE 'apples' AND ""t2"".""fruit"" LIKE 'oranges' GROUP BY ""t1"".""sale_date"""
6,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
7,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
8,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
9,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE ""sold_num""*-1 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
10,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE ""sold_num""*-1 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
11,"SELECT ""SALE_DATE"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""DIFF"" FROM ""Sales"" GROUP BY ""sale_date"""
12,"SELECT ""s"".""sale_date"",SUM(CASE WHEN ""s"".""fruit""='apples' THEN ""s"".""sold_num"" ELSE -""s"".""sold_num"" END) AS ""diff"" FROM ""Sales"" AS ""s"" GROUP BY 1"
13,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""Diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
14,"SELECT ""sale_date"",SUM(""apple_num"")-SUM(""orange_num"") AS ""diff"" FROM (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END AS ""apple_num"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END AS ""orange_num"" FROM ""sales"") AS ""a"" GROUP BY 1 ORDER BY 1"
15,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
16,"SELECT ""t1"".""sale_date"",""t1"".""sold_num""-""t2"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""t1"") JOIN ""Sales"" AS ""t2"" WHERE ""t1"".""fruit""='apples' AND ""t2"".""fruit""='oranges' AND ""t1"".""sale_date""=""t2"".""sale_date"" GROUP BY ""t1"".""sale_date"" ORDER BY ""t1"".""sale_date"""
17,"SELECT ""sale_date"",(SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END)) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY 1"
18,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN -""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
19,"SELECT ""S"".""sale_date"" AS ""SALE_DATE"",SUM(CASE WHEN ""S"".""fruit""='apples' THEN ""S"".""sold_num"" ELSE -""S"".""sold_num"" END) AS ""DIFF"" FROM ""Sales"" AS ""S"" GROUP BY ""S"".""sale_date"" ORDER BY ""S"".""sale_date"""
20,"SELECT ""sale_date"",(""apple_count""-""orange_count"") AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apple_count"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""orange_count"" FROM ""sales"" GROUP BY ""sale_date"") AS ""a"" ORDER BY 1"
21,"SELECT ""t1"".""sale_date"" AS ""SALE_DATE"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""DIFF"" FROM ""SALES"" AS ""t1"" JOIN ""sales"" AS ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"" WHERE ""t1"".""fruit"" LIKE 'apples' AND ""t2"".""fruit"" LIKE 'oranges' GROUP BY ""sale_date"""
22,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
23,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
24,"WITH ""apple"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apple"".""sale_date"",(""apple"".""sold_num""-""orange"".""sold_num"") AS ""diff"" FROM ""apple"" JOIN ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"""
25,"WITH ""CTE_a"" AS (SELECT ""a"".* FROM ""sales"" AS ""a"" WHERE ""fruit""='apples'), ""CTE_o"" AS (SELECT ""o"".* FROM ""sales"" AS ""o"" WHERE ""fruit""='oranges') SELECT ""a"".""sale_date"" AS ""SALE_DATE"",(""a"".""sold_num""-""o"".""sold_num"") AS ""DIFF"" FROM ""CTE_a"" AS ""a"" JOIN ""CTE_o"" AS ""o"" ON ""a"".""sale_date""=""o"".""sale_date"""
26,"SELECT DISTINCT ""s1"".""sale_date"" AS ""SALE_DATE"",(CASE WHEN ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' THEN (""s1"".""sold_num""-""s2"".""sold_num"") ELSE (""s2"".""sold_num""-""s1"".""sold_num"") END) AS ""DIFF"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE ""s1"".""fruit""!=""s2"".""fruit"""
27,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
28,"SELECT ""sale_date"",""apples""-""oranges"" AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges"" FROM ""Sales"" GROUP BY ""sale_date"") AS ""a"""
29,"SELECT ""apple"".""sale_date"",""apple"".""sold_num""-""orange"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""apple"" JOIN ""sales"" AS ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"" WHERE ""apple"".""fruit""='apples' AND ""orange"".""fruit""='oranges'"
30,"SELECT ""a"".""sale_date"",""a"".""sold_num""-""b"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
31,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
32,"WITH ""apple"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apple"".""sale_date"",(""apple"".""sold_num""-""orange"".""sold_num"") AS ""diff"" FROM ""apple"" JOIN ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"""
33,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
34,"SELECT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""s1"" LEFT JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE 1=1 AND ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges'"
35,"WITH ""a"" AS (SELECT ""sale_date"",SUM(""sold_num"") AS ""apple_total"" FROM ""Sales"" WHERE ""fruit""='apples' GROUP BY ""sale_date""), ""o"" AS (SELECT ""sale_date"",SUM(""sold_num"") AS ""orange_total"" FROM ""Sales"" WHERE ""fruit""='oranges' GROUP BY ""sale_date"") SELECT ""a"".""sale_date"",COALESCE(""apple_total"", 0)-COALESCE(""orange_total"", 0) AS ""diff"" FROM ""a"" JOIN ""o"" ON ""a"".""sale_date""=""o"".""sale_date"" ORDER BY ""a"".""sale_date"""
36,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE NULL END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE NULL END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
37,"SELECT ""sale_date"",(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='apples')-(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='oranges') AS ""diff"" FROM ""sales"" AS ""s"" GROUP BY ""s"".""sale_date"""
38,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE ""sold_num""*(-1) END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
39,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
40,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""s1"" JOIN ""Sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges'"
41,"SELECT ""sale_date"",(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='apples')-(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='oranges') AS ""diff"" FROM ""sales"" AS ""s"" GROUP BY ""s"".""sale_date"""
42,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
43,"SELECT ""S1"".""sale_date"",""S1"".""sold_num""-""S2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""S1"" JOIN ""Sales"" AS ""S2"" ON ""S1"".""sale_date""=""S2"".""Sale_date"" WHERE ""S1"".""fruit""='apples' AND ""S2"".""fruit""='oranges' GROUP BY 1 ORDER BY 1"
44,"SELECT ""sale_date"",(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
45,"SELECT ""sale_date"" AS ""SALE_DATE"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""DIFF"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY 1"
46,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""s1"" LEFT JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' GROUP BY 1 ORDER BY 1"
47,"SELECT ""c1"".""sale_date"",""c1"".""app_num""-""c2"".""ora_num"" AS ""diff"" FROM (SELECT ""sale_date"",""fruit"" AS ""apple"",""sold_num"" AS ""app_num"" FROM ""sales"" WHERE ""fruit""='apples') AS ""c1"", (SELECT ""sale_date"",""fruit"" AS ""orange"",""sold_num"" AS ""ora_num"" FROM ""sales"" WHERE ""fruit""='oranges') AS ""c2"" WHERE ""c1"".""sale_date""=""c2"".""sale_date"""
48,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
49,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
50,"SELECT ""t1"".""sale_date"",""t1"".""sold_num""-""t2"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""t1"") JOIN ""Sales"" AS ""t2"" WHERE ""t1"".""fruit""='apples' AND ""t2"".""fruit""='oranges' AND ""t1"".""sale_date""=""t2"".""sale_date"" GROUP BY ""t1"".""sale_date"" ORDER BY ""t1"".""sale_date"""
51,"SELECT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""!=""s2"".""fruit"" AND ""s1"".""fruit""='apples' ORDER BY ""s1"".""sale_date"""
52,"SELECT ""s"".""sale_date"",(SUM(""s"".""apples_sold"")-SUM(""s"".""oranges_sold"")) AS ""diff"" FROM (SELECT ""sale_date"",(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples_sold"",(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges_sold"" FROM ""sales"") AS ""s"" GROUP BY ""s"".""sale_date"" ORDER BY ""s"".""sale_date"""
53,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
54,"WITH ""cte"" AS (SELECT ""sale_date"",""sold_num"" FROM ""sales"" WHERE ""fruit""='apples'), ""cte1"" AS (SELECT ""sale_date"",""sold_num"" FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""cte"".""sale_date"",(""cte"".""sold_num""-""cte1"".""sold_num"") AS ""diff"" FROM ""cte"" JOIN ""cte1"" USING (""sale_date"")"
55,"ERROR: mysql parse error: line 1 column 129 near ""a inner join (select sale_date, fruit, sold_num from Sales where fruit = 'oranges') o on a.sale_date = o.sale_date) order by a.sale_date"" "
56,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
57,"WITH ""cte"" AS (SELECT ""sale_date"",""sold_num"" FROM ""sales"" WHERE ""fruit""='apples'), ""cte1"" AS (SELECT ""sale_date"",""sold_num"" FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""cte"".""sale_date"",(""cte"".""sold_num""-""cte1"".""sold_num"") AS ""diff"" FROM ""cte"" JOIN ""cte1"" ON ""cte"".""sale_date""=""cte1"".""sale_date"""
58,"SELECT TO_CHAR(""s1"".""sale_date"", 'YYYY-%m-%d') AS ""SALE_DATE"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""DIFF"" FROM ""sales"" AS ""s1"" LEFT JOIN ""sales"" AS ""s2"" ON ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' AND ""s1"".""sale_date""=""s2"".""sale_date"" GROUP BY ""s1"".""sale_date"""
59,"WITH ""apple_table"" AS (SELECT ""sale_date"",""sold_num"" FROM ""sales"" WHERE ""fruit""='apples' ORDER BY ""sale_date""), ""orange_table"" AS (SELECT ""sale_date"",""sold_num"" FROM ""sales"" WHERE ""fruit""='oranges' ORDER BY ""sale_date"") SELECT ""apple_table"".""sale_date"",""apple_table"".""sold_num""-""orange_table"".""sold_num"" AS ""diff"" FROM ""apple_table"" JOIN ""orange_table"" USING (""sale_date"") ORDER BY ""sale_date"""
60,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -1*""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
61,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -1*""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
62,"SELECT ""sale_date"",(SUM(""apples"")-SUM(""oranges"")) AS ""diff"" FROM (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" END AS ""apples"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END AS ""oranges"" FROM ""sales"") AS ""a"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
63,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
64,"SELECT ""A"".""SALE_DATE"",""A"".""SOLD_NUM""-""B"".""SOLD_NUM"" AS ""DIFF"" FROM ""SALES"" AS ""A"" JOIN ""SALES"" AS ""B"" ON ""A"".""SALE_DATE""=""B"".""SALE_DATE"" WHERE ""A"".""FRUIT""='apples' AND ""B"".""FRUIT""='oranges' ORDER BY ""A"".""SALE_DATE"""
65,"SELECT ""A"".""sale_date"" AS ""SALE_DATE"",""A"".""sold_num""-""B"".""sold_num"" AS ""DIFF"" FROM (""Sales"" AS ""A"") JOIN ""Sales"" AS ""B"" WHERE ""A"".""sale_date""=""B"".""sale_date"" AND ""A"".""fruit""!=""B"".""fruit"" AND ""A"".""fruit""='apples' ORDER BY ""A"".""sale_date"""
66,"WITH ""cte"" AS (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END AS ""apples_sold"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END AS ""oranges_sold"" FROM ""Sales"") SELECT ""sale_date"",SUM(""apples_sold"")-SUM(""oranges_sold"") AS ""diff"" FROM ""cte"" GROUP BY 1 ORDER BY 1"
67,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -1*""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
68,"SELECT ""p1"".""sale_date"",""p1"".""sold_num""-""p2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""p1"" JOIN ""sales"" AS ""p2"" USING (""sale_date"") WHERE ""p1"".""fruit""='apples' AND ""p2"".""fruit""='oranges'"
69,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
70,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE ""sold_num""*(-1) END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
71,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
72,"SELECT ""sale_date"",SUM(CASE ""fruit"" WHEN 'apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
73,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
74,"SELECT ""sale_date"",(MAX(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-MAX(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END)) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
75,"SELECT ""sale_date"",SUM(""diff"") AS ""diff"" FROM (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END AS ""diff"" FROM ""sales"") AS ""temp"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
76,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
77,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
78,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN 1*""sold_num"" WHEN ""fruit""='oranges' THEN -1*""sold_num"" ELSE NULL END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
79,"SELECT ""sale_date"",""sold_lagged""-""sold_num"" AS ""diff"" FROM (SELECT ""sale_date"",""fruit"",""sold_num"",LAG(""sold_num"") OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""sold_lagged"" FROM ""Sales"") AS ""sub"" WHERE ""fruit""='oranges'"
80,"WITH ""tem_a"" AS (SELECT ""sale_date"",""sold_num"" AS ""num_apples"" FROM ""sales"" WHERE ""fruit""='apples'), ""tem_o"" AS (SELECT ""sale_date"",""sold_num"" AS ""num_oranges"" FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""sale_date"",""diff"" FROM (SELECT ""a"".""sale_date"",""a"".""num_apples"",""b"".""num_oranges"",(""a"".""num_apples""-""b"".""num_oranges"") AS ""diff"" FROM ""tem_a"" AS ""a"" LEFT JOIN ""tem_o"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"") AS ""a"""
81,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
82,"WITH ""apple"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""apple"".""sale_date"",(""apple"".""sold_num""-""orange"".""sold_num"") AS ""diff"" FROM ""apple"" JOIN ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"""
83,"WITH ""t1"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""t2"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""t1"".""sale_date"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""diff"" FROM ""t1"" JOIN ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"" GROUP BY ""t1"".""sale_date"" ORDER BY ""t1"".""sale_date"""
84,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN -1*""sold_num"" ELSE 1*""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
85,"SELECT ""a"".""sale_date"",""a"".""sold_num""-""o"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""a"") JOIN ""Sales"" AS ""o"" WHERE ""a"".""sale_date""=""o"".""sale_date"" AND ""a"".""fruit""='apples' AND ""o"".""fruit""='oranges'"
86,"WITH ""orange_sold"" AS (SELECT ""sale_date"",SUM(""sold_num"") AS ""oranges_sold"" FROM ""Sales"" WHERE ""fruit""='oranges' GROUP BY ""sale_date"") SELECT ""s"".""sale_date"",SUM(""s"".""sold_num"")-""o"".""oranges_sold"" AS ""diff"" FROM ""Sales"" AS ""s"" JOIN ""orange_sold"" AS ""o"" USING (""sale_date"") WHERE ""s"".""fruit""='apples' GROUP BY ""s"".""sale_date"",""o"".""oranges_sold"""
87,"SELECT ""sale_date"",(SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END)) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
88,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
89,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY 1"
90,"SELECT ""sale_date"",SUM(CASE ""fruit"" WHEN 'apples' THEN ""sold_num"" ELSE 0 END-CASE ""fruit"" WHEN 'oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
91,"WITH ""cte"" AS (SELECT ""sale_date"",""fruit"" AS ""apple"",""sold_num"" AS ""apple_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""cte2"" AS (SELECT ""sale_date"",""fruit"" AS ""orange"",""sold_num"" AS ""orange_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT DISTINCT ""Sales"".""sale_date"",""apple_num""-""orange_num"" AS ""diff"" FROM (""Sales"" LEFT JOIN ""cte"" ON ""Sales"".""sale_date""=""cte"".""sale_date"") LEFT JOIN ""cte2"" ON ""Sales"".""sale_date""=""cte2"".""sale_date"" ORDER BY ""Sales"".""sale_date"""
92,"WITH ""cte1"" AS (SELECT ""sale_date"",""fruit"" AS ""app"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""cte2"" AS (SELECT ""sale_date"",""fruit"" AS ""org"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""cte1"".""sale_date"",(""cte1"".""sold_num""-""cte2"".""sold_num"") AS ""diff"" FROM ""cte1"" JOIN ""cte2"" ON ""cte2"".""sale_date""=""cte1"".""sale_date"""
93,"SELECT ""sale_date"",(SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END)) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
94,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
95,"WITH ""sales_breakout"" AS (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges"" FROM ""Sales"" GROUP BY ""sale_date"") SELECT ""sale_date"",""apples""-""oranges"" AS ""diff"" FROM ""sales_breakout"" ORDER BY ""sale_date"""
96,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
97,"WITH ""cte"" AS (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges"" FROM ""Sales"" AS ""s"" GROUP BY ""sale_date"") SELECT ""sale_date"",(""apples""-""oranges"") AS ""diff"" FROM ""cte"" ORDER BY ""sale_date"""
98,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
99,"SELECT ""sale_date"",""sold_num""-""diff"" AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"",LEAD(""sold_num"", 1) OVER (PARTITION BY ""sale_date"") AS ""diff"" FROM ""sales"") AS ""asd"" WHERE ""diff"" IS NOT NULL"
100,"SELECT ""t1"".""sale_date"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""DIFF"" FROM (SELECT * FROM ""Sales"" WHERE ""fruit""='apples') AS ""t1"" JOIN (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') AS ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"" ORDER BY ""t1"".""sale_date"""
101,"SELECT ""SALE_DATE"",SUM(CASE WHEN ""FRUIT""='APPLES' THEN ""sold_num"" WHEN ""FRUIT""='ORANGES' THEN -""sold_num"" END) AS ""DIFF"" FROM ""SALES"" GROUP BY ""SALE_DATE"""
102,"WITH ""refined"" AS (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges"" FROM ""Sales"" GROUP BY 1) SELECT ""sale_date"",""apples""-""oranges"" AS ""diff"" FROM ""refined"" ORDER BY ""sale_date"""
103,"WITH ""dailyapple"" AS (SELECT ""sale_date"" AS ""date"",SUM(""sold_num"") AS ""num1"" FROM ""Sales"" WHERE ""fruit""='apples' GROUP BY ""sale_date""), ""dailyoranges"" AS (SELECT ""sale_date"" AS ""date"",SUM(""sold_num"") AS ""num2"" FROM ""Sales"" WHERE ""fruit""='oranges' GROUP BY ""sale_date"") SELECT ""dailyapple"".""date"" AS ""SALE_DATE"",COALESCE(""dailyapple"".""num1"", 0)-COALESCE(""dailyoranges"".""num2"", 0) AS ""DIFF"" FROM ""dailyapple"" JOIN ""dailyoranges"" ON ""dailyapple"".""date""=""dailyoranges"".""date"""
104,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
105,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
106,"SELECT ""sale_date"",(""t1"".""applect""-""t1"".""orangect"") AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"" AS ""orangect"",LAG(""sold_num"", 1) OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""applect"",RANK() OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""rk"" FROM ""sales"") AS ""t1"" WHERE ""t1"".""rk""=2"
107,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN (-1)*""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
108,"SELECT ""a"".""sale_date"" AS ""sale_date"",(""a"".""sold_num""-""o"".""sold_num"") AS ""diff"" FROM (SELECT * FROM ""Sales"" WHERE ""fruit""='apples') AS ""a"" LEFT JOIN (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') AS ""o"" ON ""a"".""sale_date""=""o"".""sale_date"""
109,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""s1"") JOIN ""Sales"" AS ""s2"" WHERE ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' ORDER BY ""s1"".""sale_date"""
110,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
111,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
112,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
113,"WITH ""apple"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""a"".""sale_date"",""a"".""sold_num""-""o"".""sold_num"" AS ""diff"" FROM ""apple"" AS ""a"" JOIN ""orange"" AS ""o"" USING (""sale_date"") ORDER BY ""a"".""sale_date"""
114,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
115,"SELECT DISTINCT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM (""sales"" AS ""s1"") JOIN ""sales"" AS ""s2"" WHERE ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges'"
116,"WITH ""apples"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""oranges"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apples"".""sale_date"",""apples"".""sold_num""-""oranges"".""sold_num"" AS ""diff"" FROM ""apples"" JOIN ""oranges"" WHERE ""apples"".""sale_date""=""oranges"".""sale_date"""
117,"SELECT ""a"".""sale_date"",""a"".""daily_apple""-COALESCE(""b"".""daily_orange"", 0) AS ""diff"" FROM (SELECT ""sale_date"",SUM(""sold_num"") AS ""daily_apple"" FROM ""Sales"" WHERE ""fruit""='apples' GROUP BY ""sale_date"" ORDER BY ""sale_date"") AS ""a"" LEFT JOIN (SELECT ""sale_date"",SUM(""sold_num"") AS ""daily_orange"" FROM ""Sales"" WHERE ""fruit""='oranges' GROUP BY ""sale_date"" ORDER BY ""sale_date"") AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"""
118,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
119,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -1*""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
120,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
121,"SELECT ""r"".""sale_date"",(MAX(""apples"")-MAX(""oranges"")) AS ""diff"" FROM (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE NULL END AS ""apples"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE NULL END AS ""oranges"" FROM ""Sales"") AS ""r"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
122,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE (-""sold_num"") END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
123,"SELECT ""S"".""sale_date"",SUM(CASE WHEN ""S"".""fruit""='apples' THEN ""S"".""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""S"".""fruit""='oranges' THEN ""S"".""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" AS ""S"" GROUP BY ""S"".""sale_date"""
124,"WITH ""apple"" AS (SELECT ""sale_date"",""fruit"",""sold_num"" FROM ""sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT ""sale_date"",""fruit"",""sold_num"" FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""a"".""sale_date"",""a"".""sold_num""-""o"".""sold_num"" AS ""diff"" FROM ""apple"" AS ""a"" LEFT JOIN ""orange"" AS ""o"" ON ""a"".""sale_date""=""o"".""sale_date"" ORDER BY ""sale_date"""
125,"SELECT ""s1"".""sale_date"" AS ""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges'"
126,"SELECT ""SALE_DATE"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END-CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""DIFF"" FROM ""sales"" GROUP BY ""sale_date"""
127,"SELECT ""sale_date"",""aapl_sold""-""oran_sold"" AS ""diff"" FROM (SELECT ""a"".""sale_date"",""a"".""sold_num"" AS ""aapl_sold"",""b"".""sold_num"" AS ""oran_sold"" FROM ""Sales"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" AND ""a"".""fruit""='apples' AND ""b"".""fruit""!='apples') AS ""x"" ORDER BY 1"
128,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""s1"" JOIN ""Sales"" AS ""s2"" ON ""s2"".""sale_date""=""s1"".""sale_date"" AND ""s2"".""fruit""!=""s1"".""fruit"" WHERE ""s1"".""fruit""='apples'"
129,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
130,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
131,"WITH ""cte"" AS (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apple"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""orange"" FROM ""sales"" GROUP BY 1) SELECT ""c"".""sale_date"",""c"".""apple""-""c"".""orange"" AS ""DIFF"" FROM ""cte"" AS ""c"" GROUP BY 1"
132,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
133,"SELECT ""t1"".""sale_date"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""DIFF"" FROM (SELECT * FROM ""Sales"" WHERE ""fruit""='apples') AS ""t1"" JOIN (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') AS ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"" ORDER BY ""t1"".""sale_date"""
134,"SELECT ""sale_date"",(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='apples')-(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='oranges') AS ""diff"" FROM ""sales"" AS ""s"" GROUP BY ""s"".""sale_date"""
135,"WITH ""x"" AS (SELECT ""sale_date"",""sold_num""-LEAD(""sold_num"", 1) OVER (PARTITION BY ""sale_date"" ORDER BY ""sale_date"") AS ""diff"" FROM ""Sales"") SELECT * FROM ""x"" WHERE ""diff"" IS NOT NULL"
136,"SELECT ""t1"".""sale_date"",""t1"".""sold_num""-""t2"".""sold_num"" AS ""diff"" FROM (""sales"" AS ""t1"") JOIN ""sales"" AS ""t2"" WHERE ""t1"".""sale_date""=""t2"".""sale_date"" AND ""t1"".""fruit""='apples' AND ""t2"".""fruit""='oranges'"
137,"SELECT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges'"
138,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -1*""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
139,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
140,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
141,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
142,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
143,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num""*-1 ELSE ""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
144,"SELECT ""N_1"".""sale_date"",""N_1"".""sold_num""-""N_2"".""sold_num"" AS ""diff"" FROM (SELECT * FROM ""Sales"" GROUP BY ""sale_date"",""fruit"" ORDER BY ""sale_date"",""fruit"") AS ""N_1"" JOIN (SELECT * FROM ""Sales"" GROUP BY ""sale_date"",""fruit"" ORDER BY ""sale_date"",""fruit"" DESC) AS ""N_2"" ON ""N_1"".""sale_date""=""N_2"".""sale_date"" WHERE ""N_1"".""fruit""='apples' AND ""N_2"".""fruit""='oranges'"
145,"SELECT ""sale_date"",""apples""-""oranges"" AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges"" FROM ""Sales"" GROUP BY ""sale_date"") AS ""a"""
146,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""s1"" LEFT JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""!=""s2"".""fruit"" GROUP BY ""sale_date"""
147,"SELECT ""A"".""sale_date"",""A"".""sold_num""-""O"".""sold_num"" AS ""diff"" FROM (SELECT * FROM ""sales"" WHERE ""fruit""='apples') AS ""A"" JOIN (SELECT * FROM ""sales"" WHERE ""fruit""='oranges') AS ""O"" ON ""A"".""sale_date""=""O"".""sale_date"""
148,"WITH ""t"" AS (SELECT *,LEAD(""sold_num"", 1) OVER (PARTITION BY ""sale_date"") AS ""oj_sold"" FROM ""Sales"") SELECT ""t"".""sale_date"",""t"".""sold_num""-""t"".""oj_sold"" AS ""diff"" FROM ""t"" GROUP BY 1"
149,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
150,"SELECT ""t1"".""sale_date"",""t1"".""sold_num""-""t2"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""t1"") JOIN ""Sales"" AS ""t2"" WHERE ""t1"".""fruit""='apples' AND ""t2"".""fruit""='oranges' AND ""t1"".""sale_date""=""t2"".""sale_date"""
151,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE ""sold_num""*(-1) END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
152,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY 1"
153,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_Date"""
154,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
155,"WITH ""differences"" AS (SELECT ""sale_date"",""sold_num""-LEAD(""sold_num"") OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""diff"" FROM ""sales"") SELECT ""sale_date"",""diff"" FROM ""differences"" WHERE ""diff"" IS NOT NULL ORDER BY ""sale_date"""
156,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
157,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
158,"SELECT ""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""s1"" LEFT JOIN ""Sales"" AS ""s2"" USING (""sale_date"") GROUP BY ""sale_date"""
159,"SELECT ""sale_date"",""apple_count""-""orange_count"" AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END) AS ""apple_count"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""orange_count"" FROM ""sales"" GROUP BY ""sale_date"") AS ""sales_table"""
160,"SELECT ""A"".""sale_date"" AS ""sale_date"",(""A"".""sold_num""-""O"".""sold_num"") AS ""diff"" FROM ""Sales"" AS ""A"" JOIN ""Sales"" AS ""O"" ON ""A"".""sale_date""=""O"".""sale_date"" WHERE ""A"".""fruit""='apples' AND ""O"".""fruit""='oranges' ORDER BY ""A"".""sale_date"""
161,"SELECT ""ap"".""sale_date"",(""ap"".""sold_num""-""org"".""sold_num"") AS ""DIFF"" FROM (""Sales"" AS ""ap"") JOIN ""Sales"" AS ""org"" WHERE ""ap"".""fruit""='apples' AND ""org"".""fruit""='oranges' AND ""org"".""sale_date""=""ap"".""sale_date"" ORDER BY ""ap"".""sale_date"""
162,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
163,"WITH ""c1"" AS (SELECT ""sale_date"" AS ""sale_date"",""fruit"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""c2"" AS (SELECT ""sale_date"" AS ""sale_date"",""fruit"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""c1"".""sale_date"",(""c1"".""sold_num""-""c2"".""sold_num"") AS ""diff"" FROM (""c1"") JOIN ""c2"" WHERE ""c1"".""sale_date""=""c2"".""sale_date"" GROUP BY ""c1"".""sale_date"" ORDER BY 1"
164,"SELECT ""b"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges' AND ""a"".""sale_date""=""b"".""sale_date"" ORDER BY ""b"".""sale_date"""
165,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" USING (""sale_date"") WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
166,"SELECT ""s"".""sale_date"",SUM(CASE WHEN ""s"".""fruit""='apples' THEN ""s"".""sold_num"" ELSE -""s"".""sold_num"" END) AS ""diff"" FROM ""sales"" AS ""s"" GROUP BY ""s"".""sale_date"" ORDER BY ""s"".""sale_date"""
167,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
168,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
169,"SELECT ""a"".""sale_date"",""a"".""sold_num""-COALESCE(""b"".""sold_num"", 0) AS ""diff"" FROM ""sales"" AS ""a"" LEFT JOIN ""sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" AND ""a"".""fruit""!=""b"".""fruit"" WHERE ""a"".""fruit""='apples' ORDER BY ""a"".""sale_date"""
170,"SELECT ""A"".""SALE_DATE"",""A"".""SOLD_NUM""-""B"".""SOLD_NUM"" AS ""DIFF"" FROM ""SALES"" AS ""A"" JOIN ""SALES"" AS ""B"" ON ""A"".""SALE_DATE""=""B"".""SALE_DATE"" AND ""A"".""FRUIT""='apples' AND ""B"".""FRUIT""='oranges' ORDER BY ""A"".""SALE_DATE"""
171,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
172,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -1*""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
173,"SELECT TO_CHAR(""sale_date"", 'YYYY-%m-%d') AS ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
174,"WITH ""apple"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apple"".""sale_date"",(""apple"".""sold_num""-""orange"".""sold_num"") AS ""diff"" FROM ""apple"" JOIN ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"""
175,"SELECT ""sale_date"",""apples_num""-""oranges_num"" AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples_num"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges_num"" FROM ""sales"" GROUP BY 1) AS ""agg"" ORDER BY 1"
176,"SELECT ""a"".""sale_date"",""apples_sales""-""orange_sales"" AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"" AS ""apples_sales"" FROM ""Sales"" WHERE ""fruit""='apples') AS ""a"" LEFT JOIN (SELECT ""sale_date"",""sold_num"" AS ""orange_sales"" FROM ""Sales"" WHERE ""fruit""='oranges') AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"""
177,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
178,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
179,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1 ORDER BY 1"
180,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM (SELECT * FROM ""sales"" WHERE ""fruit""='apples') AS ""s1"" JOIN (SELECT * FROM ""sales"" WHERE ""fruit""='oranges') AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"""
181,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
182,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
183,"SELECT ""a"".""sale_date"",""a"".""sold_num""-""b"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""a"") JOIN ""Sales"" AS ""b"" WHERE ""a"".""sale_date""=""b"".""sale_date"" AND ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges' ORDER BY ""a"".""sale_date"""
184,"WITH ""apple"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='oranges') SELECT ""aa"".""sale_date"",""aa"".""sold_num""-""oo"".""sold_num"" AS ""diff"" FROM ""apple"" AS ""aa"" JOIN ""orange"" AS ""oo"" ON ""aa"".""sale_date""=""oo"".""sale_date"""
185,"SELECT ""sale_date"",""sold_num""-""nxt"" AS ""DIFF"" FROM (SELECT ""sale_date"",""fruit"",""sold_num"",LEAD(""sold_num"") OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""nxt"" FROM ""Sales"") AS ""a"" WHERE ""nxt"" IS NOT NULL"
186,"SELECT ""sale_date"",""apples_sold""-""oranges_sold"" AS ""diff"" FROM (SELECT ""a"".""sale_date"",""a"".""fruit"" AS ""apple"",""a"".""sold_num"" AS ""apples_sold"",""b"".""fruit"" AS ""orange"",""b"".""sold_num"" AS ""oranges_sold"" FROM ""Sales"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" AND ""a"".""fruit""<""b"".""fruit"") AS ""a"" ORDER BY ""sale_date"""
187,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
188,"SELECT ""s1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""s1"" LEFT JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""!=""s2"".""fruit"" GROUP BY ""s1"".""sale_date"" ORDER BY ""s1"".""sale_date"""
189,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
190,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
191,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
192,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
193,"SELECT ""a"".""sale_date"",""a"".""sold_num""-""b"".""noranges"" AS ""diff"" FROM ""Sales"" AS ""a"" JOIN (SELECT ""sale_date"",""sold_num"" AS ""noranges"" FROM ""Sales"" WHERE ""fruit""='oranges') AS ""b"" USING (""sale_date"") WHERE ""a"".""fruit""='apples' ORDER BY ""a"".""sale_date"""
194,"SELECT ""a"".""sale_date"",(COALESCE(""a"".""sold_num"", 0)-COALESCE(""o"".""sold_num"", 0)) AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples') AS ""a"" JOIN (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') AS ""o"" ON ""a"".""sale_date""=""o"".""sale_date"" GROUP BY ""a"".""sale_date"" ORDER BY ""a"".""sale_date"""
195,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges' ORDER BY ""a"".""sale_date"""
196,"WITH ""apple"" AS (SELECT ""sale_date"",""fruit"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""oranges"" AS (SELECT ""sale_date"",""fruit"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges'), ""sales_dt"" AS (SELECT DISTINCT ""sale_date"" FROM ""Sales"") SELECT ""s"".""sale_date"",""apple"".""sold_num""-""oranges"".""sold_num"" AS ""diff"" FROM (""sales_dt"" AS ""s"" LEFT JOIN ""apple"" USING (""sale_date"")) LEFT JOIN ""oranges"" USING (""sale_date"")"
197,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE ""sold_num""*-1 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
198,"WITH ""CTE"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""CTE2"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""cte"".""sale_date"",""cte"".""sold_num""-""cte2"".""sold_num"" AS ""diff"" FROM ""CTE"" JOIN ""CTE2"" ON ""CTE"".""sale_date""=""CTE2"".""sale_date"" GROUP BY 1"
199,"SELECT ""sale_date"",SUM(""sold_num"") AS ""diff"" FROM (SELECT ""sale_date"",""fruit"",CASE WHEN ""fruit""='apples' THEN SUM(""sold_num"") ELSE SUM(""sold_num"")*(-1) END AS ""sold_num"" FROM ""Sales"" GROUP BY ""sale_date"",""fruit"") AS ""r"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
200,"SELECT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM (""Sales"" AS ""s1"") JOIN ""Sales"" AS ""s2"" WHERE ""s1"".""Fruit""='apples' AND ""s2"".""Fruit""='oranges' AND ""s1"".""sale_date""=""s2"".""sale_date"" GROUP BY ""s1"".""sale_date"" ORDER BY ""s1"".""sale_date"""
201,"WITH ""A"" AS (SELECT ""SALE_DATE"",""SOLD_NUM"" FROM ""SALES"" WHERE ""FRUIT""='apples'), ""O"" AS (SELECT ""SALE_DATE"",""SOLD_NUM"" FROM ""SALES"" WHERE ""FRUIT""='oranges') SELECT ""A"".""SALE_DATE"",(""A"".""SOLD_NUM""-""O"".""SOLD_NUM"") AS ""DIFF"" FROM ""A"" JOIN ""O"" ON ""A"".""SALE_DATE""=""O"".""SALE_DATE"" ORDER BY ""SALE_DATE"""
202,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
203,"SELECT ""a"".""sale_date"",""a"".""sold_num""-""b"".""sold_num"" AS ""diff"" FROM (""Sales"" AS ""a"") JOIN ""Sales"" AS ""b"" WHERE ""a"".""sale_date""=""b"".""sale_date"" AND ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
204,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN -""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
205,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY 1"
206,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
207,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN -1*""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
208,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -1*""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
209,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN 1 ELSE -1 END*""sold_num"") AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
210,"WITH ""cte"" AS (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN ""sold_num""*-1 END AS ""normed"" FROM ""Sales"") SELECT ""sale_date"" AS ""SALE_DATE"",SUM(""normed"") AS ""DIFF"" FROM ""cte"" GROUP BY 1"
211,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
212,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
213,"SELECT ""S1"".""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""sales"" AS ""s1"" LEFT JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""!=""s2"".""fruit"" WHERE ""s1"".""fruit""='apples'"
214,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
215,"SELECT ""sale_date"",""diff"" FROM (SELECT ""sale_date"",(""sold_num""-LEAD(""sold_num"", 1) OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"")) AS ""diff"" FROM ""sales"") AS ""a"" WHERE ""diff"" IS NOT NULL"
216,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" USING (""sale_date"") WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
217,"SELECT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""DIFF"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' GROUP BY ""s1"".""sale_Date"" ORDER BY ""s1"".""sale_date"""
218,"SELECT ""S1"".""sale_date"",(""S1"".""sold_num""-""S2"".""sold_num"") AS ""diff"" FROM ""Sales"" AS ""S1"" JOIN ""Sales"" AS ""S2"" ON ""S1"".""sale_date""=""S2"".""sale_date"" AND ""S1"".""fruit""='apples' AND ""S2"".""fruit""='oranges' ORDER BY ""S1"".""sale_date"""
219,"SELECT ""s1"".""sale_date"",(""s2"".""sold_num""-""s1"".""sold_num"") AS ""diff"" FROM (""sales"" AS ""s1"") JOIN ""sales"" AS ""s2"" WHERE ""s1"".""sale_date""=""s2"".""sale_date"" GROUP BY ""s1"".""sale_date"""
220,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -1*""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY 1"
221,"SELECT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' AND ""s1"".""sale_date""=""s2"".""sale_date"" ORDER BY ""s1"".""sale_date"""
222,"SELECT ""s"".""sale_date"",""s"".""sold_num""-""t"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Sales"" AS ""t"" ON ""s"".""sale_date""=""t"".""sale_date"" WHERE ""s"".""fruit""='apples' AND ""t"".""fruit""='oranges'"
223,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
224,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN -""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
225,"SELECT ""sale_date"",(SUM(CASE ""fruit"" WHEN 'apples' THEN ""sold_num"" ELSE NULL END)-SUM(CASE ""fruit"" WHEN 'oranges' THEN ""sold_num"" ELSE NULL END)) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
226,"SELECT ""sale_date"",(""Apples""-""Oranges"") AS ""diff"" FROM (SELECT ""a"".""sale_date"",""a"".""sold_num"" AS ""Apples"",""b"".""sold_num"" AS ""Oranges"" FROM (SELECT * FROM ""Sales"" WHERE ""fruit""='apples' GROUP BY ""sale_date"") AS ""a"" JOIN (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges' GROUP BY ""sale_date"") AS ""b"" ON ""A"".""sale_date""=""B"".""sale_date"" ORDER BY ""A"".""sale_date"") AS ""t"" ORDER BY ""sale_date"""
227,"SELECT ""t1"".""sale_date"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples') AS ""t1"" JOIN (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') AS ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"""
228,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN -""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
229,"SELECT ""r"".""sale_date"",(MAX(""apples"")-MAX(""oranges"")) AS ""diff"" FROM (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE NULL END AS ""apples"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE NULL END AS ""oranges"" FROM ""Sales"") AS ""r"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
230,"WITH ""cte"" AS (SELECT ""sale_date"",""sold_num"" AS ""apple_num"",LEAD(""sold_num"") OVER (PARTITION BY ""sale_date"") AS ""orange_num"" FROM ""Sales"") SELECT ""sale_date"",(""apple_num""-""orange_num"") AS ""diff"" FROM ""cte"" WHERE ""apple_num""-""orange_num"" IS NOT NULL ORDER BY ""sale_date"""
231,"ERROR: mysql parse error: line 1 column 167 near ""AS AppleSales JOIN ( SELECT sale_date, sold_num AS oranges_sold FROM Sales WHERE fruit = 'oranges' ) AS OrangeSales) WHERE AppleSales.sale_date = OrangeSales.sale_date GROUP BY AppleSales.sale_date"" "
232,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 1 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 1 END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
233,"SELECT ""sale_date"",(SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END)) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
234,"WITH ""cte"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""cte1"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""cte"".""Sale_date"",""cte"".""sold_num""-""cte1"".""sold_num"" AS ""diff"" FROM ""cte"" JOIN ""cte1"" ON ""cte"".""Sale_date""=""cte1"".""Sale_date"""
235,"SELECT ""a"".""sale_date"" AS ""sale_date"",""a"".""sold_num""-""b"".""sold_num"" AS ""diff"" FROM (SELECT * FROM ""sales"" WHERE ""fruit""!='apples') AS ""b"" JOIN (SELECT * FROM ""sales"" WHERE ""fruit""='apples') AS ""a"" ON ""a"".""sale_date""=""b"".""sale_date"" ORDER BY ""a"".""sale_date"""
236,"SELECT ""a"".""sale_date"",""a"".""sold_num""-""b"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" WHERE ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges' ORDER BY ""a"".""sale_date"""
237,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
238,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
239,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
240,"SELECT DISTINCT ""s1"".""sale_date"" AS ""sale_date"",""s1"".""sold_num""-""s2"".""sold_num"" AS ""diff"" FROM ""Sales"" AS ""s1"" JOIN ""Sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' GROUP BY ""s1"".""sale_date"""
241,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM (""Sales"" AS ""a"") JOIN ""Sales"" AS ""b"" WHERE ""a"".""sale_date""=""b"".""sale_date"" AND ""a"".""fruit""='apples' AND ""b"".""fruit""='oranges'"
242,"SELECT ""sale_date"",SUM(""diff"") AS ""diff"" FROM (SELECT ""sale_date"",(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"") AS ""s"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
243,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
244,"SELECT ""t1"".""sale_date"" AS ""SALE_DATE"",(""t1"".""sold_num""-""t2"".""sold_num"") AS ""DIFF"" FROM (SELECT ""sale_date"",SUM(""sold_num"") AS ""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples' GROUP BY ""sale_date"") AS ""t1"" JOIN (SELECT ""sale_date"",SUM(""sold_num"") AS ""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges' GROUP BY ""sale_date"") AS ""t2"" ON ""t2"".""sale_date""=""t1"".""sale_date"" ORDER BY 1"
245,"SELECT DISTINCT ""sale_date"",SUM((CASE WHEN ""fruit""='apples' THEN 1 ELSE -1 END)*""sold_num"") AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
246,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" WHEN ""fruit""='oranges' THEN -1*""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1 ORDER BY 1"
247,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
248,"SELECT ""n"".""sale_date"",SUM(""fruit_num"") AS ""diff"" FROM (SELECT ""sale_date"",""fruit"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -(""sold_num"") END AS ""fruit_num"" FROM ""Sales"") AS ""n"" GROUP BY 1 ORDER BY 1"
249,"SELECT ""t1"".""sale_date"",""t1"".""sold_num""-""t2"".""sold_num"" AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples') AS ""t1"" JOIN (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') AS ""t2"" ON ""t1"".""sale_date""=""t2"".""sale_date"" ORDER BY ""t1"".""sale_date"""
250,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY 1"
251,"SELECT ""A"".""sale_date"",(""A"".""total_sale""-""B"".""total_sale"") AS ""diff"" FROM (SELECT ""sale_date"",""sold_num"" AS ""total_sale"" FROM ""Sales"" WHERE ""fruit""='apples') AS ""A"", (SELECT ""sale_date"",""sold_num"" AS ""total_sale"" FROM ""Sales"" WHERE ""fruit""='oranges') AS ""B"" WHERE ""A"".""sale_date""=""B"".""sale_date"""
252,"SELECT ""sale_date"",(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='apples')-(SELECT ""sold_num"" FROM ""sales"" AS ""x"" WHERE ""s"".""sale_date""=""x"".""sale_date"" AND ""fruit""='oranges') AS ""diff"" FROM ""sales"" AS ""s"" GROUP BY ""s"".""sale_date"""
253,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
254,"WITH ""temp"" AS (SELECT ""sale_date"",(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END) AS ""apples"",(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""oranges"" FROM ""sales"") SELECT DISTINCT ""sale_date"",(SUM(""apples"")-SUM(""oranges"")) AS ""diff"" FROM ""temp"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
255,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" AND ""b"".""fruit""='oranges' WHERE ""a"".""fruit""='apples'"
256,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM (SELECT * FROM ""Sales"" WHERE ""fruit""='apples') AS ""a"" JOIN (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" ORDER BY ""a"".""sale_date"""
257,"WITH ""A"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='apples'), ""O"" AS (SELECT * FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""A"".""sale_date"",(""A"".""sold_num""-""O"".""sold_num"") AS ""diff"" FROM ""A"" JOIN ""O"" ON ""A"".""sale_date""=""O"".""sale_date"""
258,"WITH ""cte"" AS (SELECT ""sale_date"",""sold_num"",LEAD(""sold_num"") OVER (PARTITION BY ""sale_date"") AS ""org_num"" FROM ""Sales"" ORDER BY ""sale_date"") SELECT ""sale_date"",""sold_num""-""org_num"" AS ""diff"" FROM ""cte"" WHERE ""org_num"" IS NOT NULL"
259,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
260,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"""
261,"SELECT ""sale_date"",""apples""-""oranges"" AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""apples"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""oranges"" FROM ""Sales"" GROUP BY ""sale_date"") AS ""a"""
262,"WITH ""apple"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""apple"".""sale_date"",(""apple"".""sold_num""-""orange"".""sold_num"") AS ""diff"" FROM ""apple"" JOIN ""orange"" ON ""apple"".""sale_date""=""orange"".""sale_date"" ORDER BY ""apple"".""sale_date"""
263,"WITH ""aa"" AS (SELECT ""sale_date"",""fruit"",""sold_num""-LEAD(""sold_num"") OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""diff"" FROM ""Sales"") SELECT ""sale_date"",""diff"" FROM ""aa"" WHERE ""fruit""='apples'"
264,"WITH ""subq"" AS (SELECT ""sale_date"",(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"") SELECT ""sale_date"",SUM(""diff"") AS ""diff"" FROM ""subq"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
265,"WITH ""apple"" AS (SELECT ""sale_date"",""fruit"",""sold_num"" FROM ""sales"" WHERE ""fruit""='apples' GROUP BY 1,2,3), ""orange"" AS (SELECT ""sale_date"",""fruit"",""sold_num"" FROM ""sales"" WHERE ""fruit""='oranges' GROUP BY 1,2,3) SELECT ""a"".""sale_date"",""a"".""sold_num""-""b"".""sold_num"" AS ""diff"" FROM ""apple"" AS ""a"" JOIN ""orange"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" ORDER BY ""a"".""sale_date"""
266,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
267,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
268,"WITH ""cte"" AS (SELECT *,FIRST_VALUE(""sold_num"") OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""apples_count"",LAST_VALUE(""sold_num"") OVER (PARTITION BY ""sale_date"" ORDER BY ""fruit"") AS ""oranges_count"" FROM ""Sales"") SELECT ""sale_date"",""apples_count""-""oranges_count"" AS ""diff"" FROM ""cte"" WHERE ""fruit""='oranges'"
269,"SELECT DISTINCT ""s1"".""sale_date"",(""s1"".""sold_num""-""s2"".""sold_num"") AS ""diff"" FROM (""sales"" AS ""s1"") JOIN ""sales"" AS ""s2"" WHERE ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges'"
270,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='oranges' THEN (-1)*""sold_num"" ELSE ""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
271,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
272,"SELECT DISTINCT ""s1"".""sale_date"" AS ""SALE_DATE"",(CASE WHEN ""s1"".""fruit""='apples' AND ""s2"".""fruit""='oranges' THEN (""s1"".""sold_num""-""s2"".""sold_num"") ELSE (""s2"".""sold_num""-""s1"".""sold_num"") END) AS ""DIFF"" FROM ""sales"" AS ""s1"" JOIN ""sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" WHERE ""s1"".""fruit""!=""s2"".""fruit"""
273,"SELECT ""table2"".""sale_date"",""table2"".""sale_apple""-""table2"".""sale_orange"" AS ""diff"" FROM (SELECT ""table1"".""sale_date"",SUM(""sale_apple"") AS ""sale_apple"",SUM(""sale_orange"") AS ""sale_orange"" FROM (SELECT ""sale_date"",""fruit"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END AS ""sale_apple"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END AS ""sale_orange"" FROM ""Sales"") AS ""table1"" GROUP BY ""table1"".""sale_date"") AS ""table2"" ORDER BY ""table2"".""sale_date"""
274,"SELECT ""sale_date"",(SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END)) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
275,"SELECT ""sale_date"",""sold_num""-""s2"" AS ""diff"" FROM (SELECT ""s1"".""sale_date"",""s1"".""fruit"",""s1"".""sold_num"",""s2"".""sold_num"" AS ""s2"" FROM ""Sales"" AS ""s1"" JOIN ""Sales"" AS ""s2"" ON ""s1"".""sale_date""=""s2"".""sale_date"" AND ""s1"".""fruit""!=""s2"".""fruit"" WHERE ""s1"".""fruit""='apples') AS ""a"""
276,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
277,"SELECT ""sale_date"",""app""-""org"" AS ""diff"" FROM (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""app"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""org"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY 1) AS ""t"""
278,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""sales"" GROUP BY 1"
279,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY 1"
280,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END)-SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""diff"" FROM ""sales"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
281,"SELECT ""a"".""sale_date"",(""a"".""sold_num""-""b"".""sold_num"") AS ""diff"" FROM ""sales"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""sale_date""=""b"".""sale_date"" WHERE ""a"".""fruit"" LIKE 'apples' AND ""b"".""fruit"" LIKE 'oranges' GROUP BY ""a"".""sale_date"""
282,"WITH ""CTE1"" AS (SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE 0 END) AS ""ap"",SUM(CASE WHEN ""fruit""='oranges' THEN ""sold_num"" ELSE 0 END) AS ""org"" FROM ""Sales"" GROUP BY ""sale_date"") SELECT ""sale_date"",""ap""-""org"" AS ""diff"" FROM ""CTE1"" ORDER BY ""sale_date"""
283,"SELECT ""S1"".""sale_date"",(""S1"".""sold_num""-""S2"".""sold_num"") AS ""diff"" FROM (""Sales"" AS ""S1"") JOIN ""Sales"" AS ""S2"" WHERE ""S1"".""sale_date""=""S2"".""sale_date"" AND ""S1"".""fruit""='apples' AND ""S2"".""fruit""='oranges' GROUP BY ""sale_date"""
284,"WITH ""apples"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='apples'), ""orange"" AS (SELECT * FROM ""sales"" WHERE ""fruit""='oranges'), ""apple_orange"" AS (SELECT ""a"".""sale_date"",""a"".""sold_num"" AS ""apple_sold"",COALESCE(""o"".""sold_num"", 0) AS ""orange_sold"" FROM ""apples"" AS ""a"" LEFT JOIN ""orange"" AS ""o"" ON ""a"".""sale_date""=""o"".""sale_date"" UNION SELECT ""o"".""sale_date"",COALESCE(""a"".""sold_num"", 0) AS ""apple_sold"",""o"".""sold_num"" AS ""orange_sold"" FROM ""apples"" AS ""a"" RIGHT JOIN ""orange"" AS ""o"" ON ""a"".""sale_date""=""o"".""sale_date"") SELECT ""sale_date"",""apple_sold""-""orange_sold"" AS ""diff"" FROM ""apple_orange"" ORDER BY 1"
285,"WITH ""A1"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='apples'), ""O1"" AS (SELECT ""sale_date"",""sold_num"" FROM ""Sales"" WHERE ""fruit""='oranges') SELECT ""A1"".""sale_date"",""A1"".""sold_num""-""O1"".""sold_num"" AS ""diff"" FROM (""A1"") JOIN ""O1"" WHERE ""A1"".""sale_date""=""O1"".""sale_date"""
286,"SELECT ""sale_date"",SUM(CASE WHEN ""fruit""='apples' THEN ""sold_num"" ELSE -""sold_num"" END) AS ""diff"" FROM ""Sales"" GROUP BY ""sale_date"""
287,"WITH ""difference"" AS (SELECT ""sale_date"",CASE WHEN ""fruit""='apples' THEN ""sold_num"" END AS ""apple_purchases"",CASE WHEN ""fruit""='oranges' THEN ""sold_num"" END AS ""oranges_purchases"" FROM ""Sales"") SELECT ""sale_date"",(SUM(""apple_purchases"")-SUM(""oranges_purchases"")) AS ""diff"" FROM ""difference"" GROUP BY ""sale_date"" ORDER BY ""sale_date"""
