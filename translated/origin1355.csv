id,original query
1,"SELECT ""activity"" FROM ""Friends"" GROUP BY 1 HAVING COUNT(""id"")!=(SELECT MAX(""ct"") FROM (SELECT COUNT(""activity"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"") AND COUNT(""id"")!=(SELECT MIN(""ct"") FROM (SELECT COUNT(""activity"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"")"
2,"WITH ""a"" AS (SELECT ""activity"",""cnt"",DENSE_RANK() OVER (ORDER BY ""cnt"" DESC) AS ""ranks"" FROM (SELECT ""activity"",COALESCE(COUNT(""f"".""id""), 0) AS ""cnt"" FROM ""friends"" AS ""f"" RIGHT JOIN ""activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""activity"") AS ""sub"") SELECT ""activity"" FROM ""a"" WHERE ""ranks""!=1 AND ""ranks""!=(SELECT COUNT(DISTINCT ""ranks"") FROM ""a"")"
3,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt_activity"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM ""cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1)"
4,"SELECT ""x"".""activity"" FROM (SELECT ""activity"",SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END) AS ""freq"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END)) AS ""asc_rnk"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END) DESC) AS ""desc_rnk"" FROM ""friends"" GROUP BY ""activity"") AS ""x"" WHERE ""x"".""asc_rnk"">1 AND ""x"".""desc_rnk"">1"
5,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""ac"",MAX(COUNT(1)) OVER () AS ""max_num"",MIN(COUNT(1)) OVER () AS ""min_num"" FROM ""friends"" GROUP BY ""activity"") AS ""t"" WHERE ""ac"" NOT IN (""max_num"",""min_num"")"
6,"WITH ""part_num"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""num_participates"" FROM ""Friends"" AS ""f"" GROUP BY ""activity""), ""max_part"" AS (SELECT MAX(""num_participates"") AS ""max_num_participates"" FROM ""part_num""), ""min_part"" AS (SELECT MIN(""num_participates"") AS ""min_num_participates"" FROM ""part_num"") SELECT ""activity"" FROM ""part_num"" WHERE ""num_participates""!=(SELECT ""max_num_participates"" FROM ""max_part"") AND ""num_participates""!=(SELECT ""min_num_participates"" FROM ""min_part"")"
7,"WITH ""t"" AS (SELECT ""activity"",COUNT(1) AS ""size"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""id"") SELECT ""activity"" FROM ""t"" WHERE ""size""!=(SELECT MAX(""size"") FROM ""t"") AND ""size""!=(SELECT MIN(""size"") FROM ""t"")"
8,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""act_count"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""act_count""<(SELECT MAX(""act_count"") FROM ""temp"") AND ""act_count"">(SELECT MIN(""act_count"") FROM ""temp"")"
9,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt_activity"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM ""cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1)"
10,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt_activity"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""rnk_asc""!=1 AND ""rnk_desc""!=1"
11,"WITH ""temp"" AS (SELECT ""F"".""id"",""F"".""name"",""F"".""activity"",""T"".""counts"" FROM ""Friends"" AS ""F"" LEFT JOIN (SELECT ""activity"",COUNT(""activity"") AS ""counts"" FROM ""Friends"" GROUP BY 1) AS ""T"" ON ""F"".""activity""=""T"".""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""counts""<(SELECT MAX(""counts"") FROM ""temp"") AND ""counts"">(SELECT MIN(""counts"") FROM ""temp"") GROUP BY 1"
12,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""count_"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""count_"" NOT IN ((SELECT MAX(""count_"") FROM ""temp""),(SELECT MIN(""count_"") FROM ""temp""))"
13,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
14,"SELECT DISTINCT ""activity"" FROM (SELECT *,RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""maxi"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""mini"" FROM ""friends"" GROUP BY ""activity"") AS ""temp"" WHERE ""maxi""!=1 AND ""mini""!=1"
15,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""totalnum"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""CTE"" WHERE ""totalnum"" NOT IN ((SELECT MAX(""totalnum"") FROM ""CTE""),(SELECT MIN(""totalnum"") FROM ""CTE""))"
16,"SELECT ""activity"" FROM (SELECT ""id"",""activity"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""rk_desc"",RANK() OVER (ORDER BY COUNT(1)) AS ""rk_asc"" FROM ""Friends"" GROUP BY 2) AS ""tmp"" WHERE ""rk_desc""!=1 AND ""rk_asc""!=1"
17,"SELECT DISTINCT (""name"") AS ""activity"" FROM ""Activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) OR COUNT(1)=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1))"
18,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") AS ""m"" FROM ""CTE"" UNION SELECT MIN(""cnt"") AS ""m"" FROM ""CTE"")"
19,"WITH ""basetable"" AS (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""friends"" GROUP BY ""activity""), ""minCount"" AS (SELECT MIN(""counts"") FROM ""basetable""), ""maxCount"" AS (SELECT MAX(""counts"") FROM ""basetable"") SELECT ""activity"" FROM ""basetable"" WHERE ""counts"">(SELECT * FROM ""minCount"") AND ""counts""<(SELECT * FROM ""maxCount"")"
20,"WITH ""t"" AS (SELECT ""activity"",COUNT(""name"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t"" WHERE ""cnt""<(SELECT MAX(""cnt"") FROM ""t"") AND ""cnt"">(SELECT MIN(""cnt"") FROM ""t"")"
21,"WITH ""temp"" AS (SELECT ""a"".""name"",COUNT(""f"".""id"") AS ""num_counts"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""t"".""name"" AS ""activity"" FROM ""temp"" AS ""t"" WHERE ""t"".""num_counts""!=(SELECT MAX(""num_counts"") FROM ""temp"") AND ""t"".""num_counts""!=(SELECT MIN(""num_counts"") FROM ""temp"")"
22,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(""name"") AS ""participants"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""participants""!=(SELECT MAX(""participants"") FROM ""CTE"") AND ""participants""!=(SELECT MIN(""participants"") FROM ""CTE"")"
23,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1) NOT IN ((SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1),(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1))"
24,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"")"
25,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY ""numParts"") AS ""ascRank"",RANK() OVER (ORDER BY ""numParts"" DESC) AS ""descRank"" FROM (SELECT ""activity"",COUNT(1) AS ""numParts"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""activity"") AS ""counts"") AS ""ranked"" WHERE ""ascRank""!=1 AND ""descRank""!=1"
26,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""rk_asc"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rk_desc"" FROM ""Friends"" GROUP BY 1) AS ""t"" WHERE ""rk_asc""!=1 AND ""rk_desc""!=1"
27,"WITH ""sub1"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_rank"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_rank"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""sub1"" WHERE ""min_rank"">1 AND ""max_rank"">1"
28,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""cnt"" NOT IN ((SELECT MIN(""cnt"") FROM ""CTE""),(SELECT MAX(""cnt"") FROM ""CTE""))"
29,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""id"")<(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1) AND COUNT(""id"")>(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1)"
30,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
31,"WITH ""cte_1"" AS (SELECT ""activity"",COUNT(1) OVER (PARTITION BY ""activity"") AS ""cnt"" FROM ""Friends""), ""min_max_cte"" AS (SELECT MAX(""cnt"") AS ""max_cnt"",MIN(""cnt"") AS ""min_cnt"" FROM ""cte_1"") SELECT DISTINCT ""activity"" FROM (""cte_1"" AS ""A"") JOIN ""min_max_cte"" WHERE ""cnt""!=""min_max_cte"".""max_cnt"" AND ""cnt""!=""min_max_cte"".""min_cnt"""
32,"WITH ""count_act"" AS (SELECT ""activity"",COUNT(""activity"") AS ""act_cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""count_act"" WHERE ""act_cnt"" NOT IN (SELECT MIN(""act_cnt"") FROM ""count_act"") AND ""act_cnt"" NOT IN (SELECT MAX(""act_cnt"") FROM ""count_act"")"
33,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""cte"" WHERE ""ct"" NOT IN (SELECT MAX(""ct"") FROM ""cte"") AND ""ct"" NOT IN (SELECT MIN(""ct"") FROM ""cte"")"
34,"WITH ""ct_"" AS (SELECT ""activity"",COUNT(""name"") AS ""ct"" FROM ""friends"" GROUP BY 1), ""max_min"" AS (SELECT MAX(""ct"") AS ""most"",MIN(""ct"") AS ""least"" FROM ""ct_"") SELECT ""activity"" FROM ""ct_"" WHERE ""ct""!=(SELECT ""most"" FROM ""max_min"") AND ""ct""!=(SELECT ""least"" FROM ""max_min"")"
35,"WITH ""total_friends_per_activity"" AS (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""friends"" GROUP BY 1), ""min_max_activities"" AS (SELECT MIN(""total"") AS ""min_friends"",MAX(""total"") AS ""max_friends"" FROM ""total_friends_per_activity"") SELECT ""activity"" FROM ""total_friends_per_activity"" AS ""a"" WHERE ""total""!=(SELECT ""min_friends"" FROM ""min_max_activities"") AND ""total""!=(SELECT ""max_friends"" FROM ""min_max_activities"")"
36,"WITH ""temp"" AS (SELECT ""activity"",COUNT('id') AS ""count"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT (""name"") AS ""activity"" FROM ""Activities"" WHERE ""name"" NOT IN (SELECT DISTINCT (""activity"") AS ""activity"" FROM ""temp"" WHERE ""count""=(SELECT MAX(""count"") FROM ""temp"") UNION SELECT DISTINCT (""activity"") AS ""activity"" FROM ""temp"" WHERE ""count""=(SELECT MIN(""count"") FROM ""temp""))"
37,"WITH ""activity_cnts"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""activity_cnts"" WHERE ""cnt""<(SELECT MAX(""cnt"") FROM ""activity_cnts"") AND ""cnt"">(SELECT MIN(""cnt"") FROM ""activity_cnts"")"
38,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"")"
39,"WITH ""main"" AS (SELECT ""a"".""name"" AS ""activity"",RANK() OVER (ORDER BY COUNT(CASE WHEN ""b"".""name"" THEN 1 ELSE 0 END)) AS ""rank_asc"",RANK() OVER (ORDER BY COUNT(CASE WHEN ""b"".""name"" THEN 1 ELSE 0 END) DESC) AS ""rank_desc"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY ""activity"") SELECT ""activity"" FROM ""main"" WHERE ""rank_asc""=""rank_desc"" OR (""rank_asc""!=1 AND ""rank_desc""!=1)"
40,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(DISTINCT ""id"") DESC) AS ""rk1"",RANK() OVER (ORDER BY COUNT(DISTINCT ""id"")) AS ""rk2"" FROM ""Friends"" GROUP BY 1) AS ""t"" WHERE ""rk1""!=1 AND ""rk2""!=1"
41,"WITH ""CTE1"" AS (SELECT ""activity"",COUNT(""id"") AS ""counts"" FROM ""Friends"" AS ""f"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE1"" WHERE ""counts"" NOT IN (SELECT MIN(""counts"") AS ""counts"" FROM ""CTE1"" UNION SELECT MAX(""counts"") AS ""counts"" FROM ""CTE1"")"
42,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""times"",MAX(COUNT(1)) OVER () AS ""max_times"",MIN(COUNT(1)) OVER () AS ""min_times"" FROM ""Friends"" GROUP BY ""activity"") AS ""temp"" WHERE ""times"" NOT IN (""max_times"",""min_times"")"
43,"WITH ""acttable"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""cntdesc"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""cntasc"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""acttable"" WHERE ""cntdesc""!=1 AND ""cntasc""!=1"
44,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""count_"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""count_"" NOT IN ((SELECT MAX(""count_"") FROM ""temp""),(SELECT MIN(""count_"") FROM ""temp""))"
45,"WITH ""ActivityCount"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""num_participants"" FROM ""Friends"" GROUP BY ""activity""), ""MaxNMin"" AS (SELECT MAX(""num_participants"") AS ""max_participants"",MIN(""num_participants"") AS ""min_participants"" FROM ""ActivityCount"") SELECT DISTINCT ""activity"" FROM ""ActivityCount"" WHERE ""num_participants"">(SELECT ""min_participants"" FROM ""MaxNMin"") AND ""num_participants""<(SELECT ""max_participants"" FROM ""MaxNMin"")"
46,"WITH ""base"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT ""A"".""activity"" FROM (SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""cnt"") AS ""rk"" FROM ""base"") AS ""aa"" WHERE ""rk""!=1) AS ""A"" JOIN (SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""cnt"" DESC) AS ""rk"" FROM ""base"") AS ""aa"" WHERE ""rk""!=1) AS ""B"" ON ""A"".""activity""=""B"".""activity"""
47,"WITH ""t1"" AS (SELECT ""activity"",COUNT(""id"") AS ""cnt_act"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t1"" WHERE ""cnt_act""!=(SELECT MAX(""cnt_act"") FROM ""t1"") AND ""cnt_act""!=(SELECT MIN(""cnt_act"") FROM ""t1"")"
48,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""count_"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""count_"" NOT IN ((SELECT MAX(""count_"") FROM ""temp""),(SELECT MIN(""count_"") FROM ""temp""))"
49,"SELECT ""b"".""activity"" FROM (SELECT ""a"".""activity"",DENSE_RANK() OVER (ORDER BY ""req"") AS ""rank_asc"",DENSE_RANK() OVER (ORDER BY ""req"" DESC) AS ""rank_desc"" FROM (SELECT ""activity"",COUNT(1) AS ""req"" FROM ""friends"" GROUP BY 1) AS ""a"") AS ""b"" WHERE ""b"".""rank_Asc""!=1 AND ""b"".""rank_desc""!=1"
50,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""rk1"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rk2"" FROM ""Friends"" GROUP BY ""activity"") AS ""temp"" WHERE ""rk1""!=1 AND ""rk2""!=1"
51,"WITH ""CTE"" AS (SELECT ""a"".""id"",""a"".""name"",COUNT(""f"".""activity"") AS ""count"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""id"",""a"".""name"") SELECT ""name"" AS ""activity"" FROM ""CTE"" WHERE ""count"">(SELECT MIN(""Count"") FROM ""CTE"") AND ""count""<(SELECT MAX(""count"") FROM ""CTE"")"
52,"WITH ""t1"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""n"" FROM ""friends"" GROUP BY 1) SELECT ""a"".""name"" AS ""activity"" FROM ""activities"" AS ""a"" LEFT JOIN ""t1"" ON ""a"".""name""=""t1"".""activity"" WHERE ""t1"".""n"">(SELECT MIN(""n"") FROM ""t1"") AND ""t1"".""n""<(SELECT MAX(""n"") FROM ""t1"")"
53,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""cntdesc"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""cntasc"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""cntdesc""!=1 AND ""cntasc""!=1"
54,"WITH ""temp"" AS (SELECT ""activity"",COUNT(""name"") AS ""num_people"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""name"" AS ""ACTIVITY"" FROM ""activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""temp"" WHERE ""num_people""=(SELECT MAX(""num_people"") FROM ""temp"") OR ""num_people""=(SELECT MIN(""num_people"") FROM ""temp""))"
55,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""ct"",MAX(COUNT(""id"")) OVER () AS ""max_ct"",MIN(COUNT(""id"")) OVER () AS ""min_ct"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""ct""!=""max_Ct"" AND ""ct""!=""min_ct"""
56,"WITH ""cnt"" AS (SELECT ""activity"",COUNT(""id"") AS ""num"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""cnt"" WHERE ""num"" NOT IN (SELECT MAX(""num"") FROM ""cnt"") AND ""num"" NOT IN (SELECT MIN(""num"") FROM ""cnt"")"
57,"WITH ""cte"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""activity"") AS ""total"" FROM ""Friends"") SELECT DISTINCT (""activity"") FROM ""cte"" WHERE ""total""!=(SELECT MIN(""total"") FROM ""cte"") AND ""total""!=(SELECT MAX(""total"") FROM ""cte"")"
58,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""acount"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""activity"") NOT IN (SELECT MAX(""acount"") FROM ""cte"" UNION SELECT MIN(""acount"") FROM ""cte"")"
59,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
60,"WITH ""cte1"" AS (SELECT ""f"".""activity"" AS ""activity"",COUNT(""f"".""activity"") AS ""activity_count"" FROM ""Friends"" AS ""f"" GROUP BY ""f"".""activity""), ""cte2"" AS (SELECT MIN(""activity_count"") AS ""min_count"",MAX(""activity_count"") AS ""max_count"" FROM ""cte1"") SELECT ""activity"" FROM ""cte1"" WHERE ""activity_count""!=(SELECT ""min_count"" FROM ""cte2"") AND ""activity_count""!=(SELECT ""max_count"" FROM ""cte2"")"
61,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""count"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""count"" NOT IN (SELECT MAX(""count"") FROM ""cte"") AND ""count"" NOT IN (SELECT MIN(""count"") FROM ""cte"")"
62,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""name"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"")"
63,"WITH ""CTE"" AS (SELECT ""A1"".""name"",COUNT(""F1"".""name"") AS ""cnt"" FROM ""Activities"" AS ""A1"" LEFT JOIN ""Friends"" AS ""F1"" ON ""A1"".""name""=""F1"".""activity"" GROUP BY ""A1"".""name"") SELECT ""name"" AS ""activity"" FROM ""CTE"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""CTE"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""CTE"")"
64,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""id"")>(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(""id"")<(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
65,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
66,"WITH ""cnts"" AS (SELECT ""activity"",COUNT(""id"") AS ""cnts"" FROM ""Friends"" GROUP BY 1), ""min_max"" AS (SELECT ""activity"",""cnts"",DENSE_RANK() OVER (ORDER BY ""cnts"") AS ""min_rn"",DENSE_RANK() OVER (ORDER BY ""cnts"" DESC) AS ""max_rn"" FROM ""cnts"") SELECT ""name"" AS ""activity"" FROM ""Activities"" WHERE ""name"" IN (SELECT ""activity"" FROM ""min_max"" WHERE ""min_rn"">1 AND ""max_rn"">1)"
67,"WITH ""t1"" AS (SELECT ""activity"",COUNT(""id"") AS ""number"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t1"" WHERE ""number""<(SELECT MAX(""number"") FROM ""t1"") AND ""number"">(SELECT MIN(""number"") FROM ""t1"")"
68,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""cte"")"
69,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""num"" DESC) AS ""drank"",DENSE_RANK() OVER (ORDER BY ""num"") AS ""arank"" FROM (SELECT ""activity"",COUNT(""id"") AS ""num"" FROM ""friends"" GROUP BY ""activity"") AS ""a"") AS ""b"" WHERE ""b"".""drank""!=1 AND ""b"".""arank""!=1"
70,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
71,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""counts"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"") DESC) AS ""rank_desc"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"")) AS ""rank_asc"" FROM ""Friends"" GROUP BY ""activity"") AS ""tmp"" WHERE ""rank_desc""!=1 AND ""rank_asc""!=1"
72,"SELECT ""activity"" AS ""ACTIVITY"" FROM (SELECT ""Activities"".""name"",""Friends"".""activity"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""Friends"".""id"")) AS ""asc_ranking"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""Friends"".""id"") DESC) AS ""desc_ranking"" FROM ""Friends"" RIGHT JOIN ""Activities"" ON ""Activities"".""name""=""Friends"".""activity"" GROUP BY 1) AS ""t1"" WHERE ""asc_ranking""!=1 AND ""desc_ranking""!=1"
73,"WITH ""y"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""x"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"")) AS ""seq"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""y"" WHERE ""seq"" NOT IN (SELECT MIN(""seq"") FROM ""y"") AND ""seq"" NOT IN (SELECT MAX(""seq"") FROM ""y"") GROUP BY 1"
74,"WITH ""minm"" AS (SELECT ""activity"",COUNT(""id"") AS ""c"" FROM ""Friends"" GROUP BY 1 ORDER BY COUNT(""id"")), ""maxm"" AS (SELECT ""activity"",COUNT(""id"") AS ""c"" FROM ""Friends"" GROUP BY 1 ORDER BY COUNT(""id"") DESC), ""minc"" AS (SELECT ""activity"",RANK() OVER (ORDER BY ""c"") AS ""r"" FROM ""minm""), ""maxc"" AS (SELECT ""activity"",RANK() OVER (ORDER BY ""c"" DESC) AS ""r"" FROM ""maxm"") SELECT DISTINCT ""activity"" FROM ""Friends"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM ""minc"" WHERE ""r""=1) AND ""activity"" NOT IN (SELECT ""activity"" FROM ""maxc"" WHERE ""r""=1)"
75,"SELECT ""x"".""activity"" FROM (SELECT ""activity"",SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END) AS ""freq"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END)) AS ""asc_rnk"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END) DESC) AS ""desc_rnk"" FROM ""friends"" GROUP BY ""activity"") AS ""x"" WHERE ""x"".""asc_rnk"">1 AND ""x"".""desc_rnk"">1"
76,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""num_friends"" FROM ""friends"" GROUP BY ""activity"") AS ""act"" WHERE ""num_friends""<(SELECT MAX(""num_friends"") FROM (SELECT ""activity"",COUNT(""id"") AS ""num_friends"" FROM ""friends"" GROUP BY ""activity"") AS ""maxa"") AND ""num_friends"">(SELECT MIN(""num_friends"") FROM (SELECT ""activity"",COUNT(""id"") AS ""num_friends"" FROM ""friends"" GROUP BY ""activity"") AS ""mina"")"
77,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""rank_asc"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rank_desc"" FROM ""Friends"" GROUP BY ""activity"") AS ""activity_participants"" WHERE ""rank_asc""!=1 AND ""rank_desc""!=1"
78,"WITH ""y"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""x"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""y"" WHERE ""x"" NOT IN (SELECT MIN(""x"") FROM ""y"") AND ""x"" NOT IN (SELECT MAX(""x"") FROM ""y"")"
79,"SELECT DISTINCT ""activity"" FROM ""Friends"" GROUP BY 1 HAVING COUNT(""id"")!=(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1) AND COUNT(""id"")!=(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1)"
80,"SELECT ""t2"".""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"" HAVING ""cnt"" NOT IN (SELECT ""t1"".""cnt"" FROM ((SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"" ORDER BY ""cnt"" DESC LIMIT 1) UNION (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"" ORDER BY ""cnt"" LIMIT 1)) AS ""t1"")) AS ""t2"""
81,"WITH ""tmp"" AS (SELECT ""activity"",COUNT(""id"") AS ""val"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""tmp"" WHERE ""val"" BETWEEN (SELECT MIN(""val"")+1 FROM ""tmp"") AND (SELECT MAX(""val"")-1 FROM ""tmp"")"
82,"WITH ""total_friends_per_activity"" AS (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""friends"" GROUP BY 1), ""min_max_activities"" AS (SELECT MIN(""total"") AS ""min_friends"",MAX(""total"") AS ""max_friends"" FROM ""total_friends_per_activity"") SELECT ""activity"" FROM ""total_friends_per_activity"" AS ""a"" WHERE ""total""!=(SELECT ""min_friends"" FROM ""min_max_activities"") AND ""total""!=(SELECT ""max_friends"" FROM ""min_max_activities"")"
83,"WITH ""t1"" AS (SELECT ""activity"",COUNT(1) AS ""times"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t1"" WHERE ""times""<(SELECT MAX(""times"") FROM ""t1"") AND ""times"">(SELECT MIN(""times"") FROM ""t1"")"
84,"WITH ""tmp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rnk_desc"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""tmp"" WHERE ""rnk_asc""!=1 AND ""rnk_desc""!=1"
85,"WITH ""cnt"" AS (SELECT ""a"".""name"" AS ""activity"",COALESCE(COUNT(""b"".""id""), 0) AS ""cnt"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY 1) SELECT ""a"".""name"" AS ""activity"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY 1 HAVING COALESCE(COUNT(""b"".""id""), 0) NOT IN (SELECT MIN(""cnt"") FROM ""cnt"") AND COALESCE(COUNT(""b"".""id""), 0) NOT IN (SELECT MAX(""cnt"") FROM ""cnt"")"
86,"WITH ""tmp"" AS (SELECT ""activity"",COUNT(1) AS ""n_friends"" FROM ""Friends"" AS ""f1"" LEFT JOIN ""Activities"" AS ""a"" ON ""activity""=""a"".""name"" GROUP BY ""activity"") SELECT ""activity"" FROM ""tmp"" WHERE ""n_friends""!=(SELECT MAX(""t1"".""n_friends"") FROM ""tmp"" AS ""t1"") AND ""n_friends""!=(SELECT MIN(""t2"".""n_friends"") FROM ""tmp"" AS ""t2"")"
87,"WITH ""a"" AS (SELECT ""activity"",COUNT(""id"") OVER (PARTITION BY ""activity"") AS ""cnt"" FROM ""friends"") SELECT DISTINCT ""activity"" FROM ""a"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""a"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""a"")"
88,"WITH ""tmp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(DISTINCT ""id"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(DISTINCT ""id"") DESC) AS ""rnk_desc"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""tmp"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM ""tmp"" WHERE ""rnk_asc""=1) AND ""activity"" NOT IN (SELECT ""activity"" FROM ""tmp"" WHERE ""rnk_desc""=1)"
89,"WITH ""CET"" AS (SELECT ""activity"",COUNT(""name"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CET"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""CET"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""CET"")"
90,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""count_"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""count_"" NOT IN ((SELECT MAX(""count_"") FROM ""temp""),(SELECT MIN(""count_"") FROM ""temp""))"
91,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" AS ""ACTIVITY"" FROM ""cte"" WHERE ""counts"" NOT IN (SELECT MAX(""counts"") FROM ""cte"") AND ""counts"" NOT IN (SELECT MIN(""counts"") FROM ""cte"")"
92,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""activity"") AS ""num"" FROM ""friends"" GROUP BY 1) AS ""a"" WHERE ""num"" NOT IN (SELECT MAX(""num"") FROM (SELECT ""activity"",COUNT(""activity"") AS ""num"" FROM ""friends"" GROUP BY 1) AS ""a"") AND ""num"" NOT IN (SELECT MIN(""num"") FROM (SELECT ""activity"",COUNT(""activity"") AS ""num"" FROM ""friends"" GROUP BY 1) AS ""a"")"
93,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""ranking"",RANK() OVER (ORDER BY COUNT(1)) AS ""ranking2"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""ranking""!=1 AND ""ranking2""!=1"
94,"WITH ""a"" AS (SELECT ""activity"",COUNT(1) AS ""activity_count"" FROM ""friends"" GROUP BY ""activity"" ORDER BY 2 DESC) SELECT ""activity"" FROM ""a"" WHERE ""activity_count"" NOT IN (SELECT MAX(""activity_count"") FROM ""a"") AND ""activity_count"" NOT IN (SELECT MIN(""activity_count"") FROM ""a"")"
95,"WITH ""cte"" AS (SELECT ""a"".""name"",COUNT(""f"".""id"") AS ""num"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""t"".""name"" AS ""activity"" FROM ""cte"" AS ""t"" WHERE ""t"".""num""!=(SELECT MAX(""num"") FROM ""cte"") AND ""t"".""num""!=(SELECT MIN(""num"") FROM ""cte"")"
96,"WITH ""cte"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1)) AS ""rnk"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""rnk""!=(SELECT MAX(""rnk"") FROM ""cte"") AND ""rnk""!=(SELECT MIN(""rnk"") FROM ""cte"")"
97,"SELECT ""activity"" AS ""ACTIVITY"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT MIN(""Count"") FROM (SELECT ""activity"" AS ""Activity"",COUNT(1) AS ""Count"" FROM ""Friends"" GROUP BY ""activity"") AS ""Temp1"") AND COUNT(1)!=(SELECT MAX(""Count"") FROM (SELECT ""activity"" AS ""Activity"",COUNT(1) AS ""Count"" FROM ""Friends"" GROUP BY ""activity"") AS ""Temp2"")"
98,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
99,"WITH ""t"" AS (SELECT ""a"".""name"" AS ""activity"",COUNT(""f"".""id"") AS ""participants"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY 1) SELECT ""activity"" FROM ""t"" WHERE ""participants"" NOT IN (SELECT MAX(""participants"") FROM ""t"" UNION SELECT MIN(""participants"") FROM ""t"")"
100,"WITH ""base"" AS (SELECT ""a"".""id"",""a"".""name"",COUNT(DISTINCT ""f"".""id"") AS ""counts"" FROM ""Friends"" AS ""f"" JOIN ""activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY 1,2) SELECT ""name"" AS ""activity"" FROM ""base"" WHERE ""counts""!=(SELECT MAX(""counts"") FROM ""base"") AND ""counts""!=(SELECT MIN(""counts"") FROM ""base"")"
101,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""n_participants"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""n_participants""!=(SELECT MIN(""n_participants"") FROM ""cte"") AND ""n_participants""!=(SELECT MAX(""n_participants"") FROM ""cte"")"
102,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""friends_count"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""friends_count"" NOT IN ((SELECT MAX(""friends_count"") FROM ""cte""),(SELECT MIN(""friends_count"") FROM ""cte""))"
103,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1) NOT IN (SELECT MIN(""counts"") AS ""cnt"" FROM (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""t1"" UNION ALL SELECT MAX(""counts"") AS ""cnt"" FROM (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""t2"")"
104,"WITH ""cnt"" AS (SELECT ""A"".""name"",COUNT(DISTINCT ""F"".""id"") AS ""num"" FROM ""Activities"" AS ""A"" LEFT JOIN ""Friends"" AS ""F"" ON ""A"".""name""=""F"".""activity"" GROUP BY ""A"".""name"") SELECT ""name"" AS ""ACTIVITY"" FROM ""cnt"" WHERE ""num""!=(SELECT MIN(""num"") FROM ""cnt"") AND ""num""!=(SELECT MAX(""num"") FROM ""cnt"")"
105,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""cnt"" NOT IN ((SELECT MIN(""cnt"") FROM ""CTE""),(SELECT MAX(""cnt"") FROM ""CTE""))"
106,"WITH ""CTE_1"" AS (SELECT ""ACTIVITY"",COUNT(""ACTIVITY"") AS ""ACT_COUNT"" FROM ""FRIENDS"" GROUP BY ""ACTIVITY""), ""CTE_2"" AS (SELECT MAX(""ACT_COUNT"") AS ""MAX_ACT_COUNT"",MIN(""ACT_COUNT"") AS ""MIN_ACT_COUNT"" FROM ""CTE_1"") SELECT ""ACTIVITY"" FROM (SELECT ""F"".""ACTIVITY"",COUNT(""F"".""ACTIVITY"") FROM ""FRIENDS"" AS ""F"" GROUP BY ""F"".""ACTIVITY"" HAVING COUNT(""F"".""ACTIVITY"")<(SELECT ""MAX_ACT_COUNT"" FROM ""CTE_2"") AND COUNT(""F"".""ACTIVITY"")>(SELECT ""MIN_ACT_COUNT"" FROM ""CTE_2"")) AS ""X"""
107,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_rank"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_rank"" FROM ""Friends"" GROUP BY ""activity"") AS ""rank_tmp"" WHERE ""max_rank""!=1 AND ""min_rank""!=1"
108,"WITH ""min_max_activities"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""total"" DESC) AS ""ranked_max"",DENSE_RANK() OVER (ORDER BY ""total"") AS ""ranked_min"" FROM (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""friends"" GROUP BY 1) AS ""f"") SELECT ""name"" AS ""activity"" FROM ""activities"" AS ""a"" LEFT JOIN (SELECT ""activity"" FROM ""min_max_activities"" WHERE ""ranked_max""=1 OR ""ranked_min""=1) AS ""g"" ON ""g"".""activity""=""a"".""name"" WHERE ""g"".""activity"" IS NULL"
109,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
110,"WITH ""activity_cnt"" AS (SELECT ""a"".""name"" AS ""activity"",COUNT(""f"".""id"") AS ""count_users"" FROM ""Friends"" AS ""f"" RIGHT JOIN ""Activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT DISTINCT ""activity"" FROM ""activity_cnt"" WHERE ""count_users"" NOT IN (SELECT MAX(""count_users"") FROM ""activity_cnt"") AND ""count_users"" NOT IN (SELECT MIN(""count_users"") FROM ""activity_cnt"")"
111,"WITH ""act"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY 1 ORDER BY 2) SELECT ""name"" AS ""activity"" FROM ""activities"" WHERE ""name"" IN (SELECT ""activity"" FROM ""act"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""act"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""act""))"
112,"WITH ""t"" AS (SELECT ""activity"",COUNT(0) AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t"" WHERE ""ct""!=(SELECT MAX(""ct"") FROM ""t"") AND ""ct""!=(SELECT MIN(""ct"") FROM ""t"")"
113,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
114,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") AS ""t2"" WHERE ""ct"" NOT IN (SELECT MAX(""ct"") AS ""max_ct"" FROM (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") AS ""t1"") AND ""ct"" NOT IN (SELECT MIN(""ct"") AS ""max_ct"" FROM (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") AS ""t1"")"
115,"WITH ""cte"" AS (SELECT *,COUNT(1) AS ""act_count"",MIN(COUNT(1)) OVER () AS ""min_act_count"",MAX(COUNT(1)) OVER () AS ""max_act_count"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""cte"".""activity"" FROM ""cte"" LEFT JOIN ""Activities"" ON ""cte"".""activity""=""Activities"".""name"" WHERE ""act_count""!=""min_act_count"" AND ""act_count""!=""max_act_count"""
116,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""freq"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""freq""!=(SELECT MAX(""freq"") FROM ""cte"") AND ""freq""!=(SELECT MIN(""freq"") FROM ""cte"")"
117,"WITH ""temp"" AS (SELECT ""activity"",COUNT(""activity"") AS ""students"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""students"">(SELECT MIN(""students"") FROM ""temp"") AND ""students""<(SELECT MAX(""students"") FROM ""temp"")"
118,"WITH ""cte"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""rnk_asc""!=1 AND ""rnk_desc""!=1"
119,"SELECT ""a"".""name"" AS ""activity"" FROM ""Activities"" AS ""a"" JOIN (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""dscrank"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""ascrank"" FROM ""Friends"" GROUP BY ""activity"") AS ""r"" ON ""a"".""name""=""r"".""activity"" WHERE ""r"".""dscrank""!=1 AND ""r"".""ascrank""!=1"
120,"SELECT DISTINCT ""activity"" FROM ""Friends"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM (SELECT ""activity"",""participant_act"",RANK() OVER (ORDER BY ""participant_act"" DESC) AS ""rnk"" FROM (SELECT ""activity"",COUNT(1) AS ""participant_act"" FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC) AS ""A"") AS ""B"" WHERE ""rnk""=1 UNION SELECT ""activity"" FROM (SELECT ""activity"",""participant_act"",RANK() OVER (ORDER BY ""participant_act"") AS ""rnk2"" FROM (SELECT ""activity"",COUNT(1) AS ""participant_act"" FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC) AS ""A"") AS ""B"" WHERE ""rnk2""=1)"
121,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""count_asc"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""count_desc"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""count_asc""!=1 AND ""count_desc""!=1"
122,"WITH ""cte"" AS (SELECT DISTINCT ""A"".""name"",COUNT(1) OVER (PARTITION BY ""F"".""activity"") AS ""cnt"" FROM ""Friends"" AS ""F"" JOIN ""Activities"" AS ""A"" ON ""A"".""name""=""F"".""activity"") SELECT ""name"" AS ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"")"
123,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1)) AS ""rk"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""rk""!=(SELECT MAX(""rk"") FROM ""temp"") AND ""rk""!=(SELECT MIN(""rk"") FROM ""temp"")"
124,"WITH ""cte"" AS (SELECT DISTINCT ""activity"",COUNT(""id"") OVER (PARTITION BY ""activity"") AS ""no_p"" FROM ""friends""), ""cte1"" AS (SELECT MAX(""no_p"") OVER (ORDER BY ""no_p"" DESC) AS ""max_val"",MIN(""no_p"") OVER (ORDER BY ""no_p"") AS ""min_val"" FROM ""cte"") SELECT DISTINCT ""activity"" FROM ""cte"" JOIN ""cte1"" ON ""no_p""!=""max_val"" AND ""no_p""!=""min_val"""
125,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""id"")<(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1) AND COUNT(""id"")>(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1)"
126,"SELECT ""a"".""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" JOIN (SELECT MIN(""cnt"") AS ""min_cnt"",MAX(""cnt"") AS ""max_cnt"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""x"") AS ""m"" ON ""a"".""cnt"" NOT IN (""m"".""min_cnt"",""m"".""max_cnt"")"
127,"SELECT ""activity"" FROM ""friends"" GROUP BY 1 HAVING COUNT(""id"")!=(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1) AND COUNT(""id"")!=(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1)"
128,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
129,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""par_qty"") AS ""top_rk"",DENSE_RANK() OVER (ORDER BY ""par_qty"" DESC) AS ""bottom_rk"" FROM (SELECT ""activity"",COUNT(1) AS ""par_qty"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"") AS ""b"" WHERE ""top_rk""!=1 AND ""bottom_rk""!=1"
130,"WITH ""t"" AS (SELECT ""activity"",COUNT(""activity"") OVER (PARTITION BY ""a"".""name"") AS ""count_act"" FROM ""friends"" AS ""f"" JOIN ""activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"") SELECT DISTINCT ""t"".""activity"" FROM ""t"" WHERE ""t"".""count_act"" NOT IN (SELECT MAX(""t"".""count_act"") FROM ""t"") AND ""t"".""count_act"" NOT IN (SELECT MIN(""t"".""count_act"") FROM ""t"")"
131,"WITH ""tmp"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY 1 ORDER BY 2) SELECT ""activity"" FROM ""tmp"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""tmp"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""tmp"")"
132,"WITH ""cte"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""num_act"" FROM ""Friends"" GROUP BY 1) SELECT ""name"" AS ""activity"" FROM ""Activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""cte"" WHERE ""num_act"" IN (SELECT MAX(""num_act"") FROM ""cte"")) AND ""name"" NOT IN (SELECT ""activity"" FROM ""cte"" WHERE ""num_act"" IN (SELECT MIN(""num_act"") FROM ""cte""))"
133,"WITH ""cte"" AS (SELECT ""activity"",""c"",DENSE_RANK() OVER (ORDER BY ""c"" DESC) AS ""rn"" FROM (SELECT ""activity"",COUNT(1) AS ""c"" FROM ""Friends"" GROUP BY ""activity"") AS ""t1"") SELECT ""activity"" FROM ""cte"" WHERE ""cte"".""rn""!=1 AND ""cte"".""rn""!=(SELECT MAX(""rn"") FROM ""cte"")"
134,"WITH ""Result"" AS (SELECT ""a"".""name"",COUNT(""f"".""activity"") AS ""num_count"" FROM ""Friends"" AS ""f"" RIGHT JOIN ""Activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT ""r"".""name"" AS ""activity"" FROM ""Result"" AS ""r"" WHERE ""r"".""num_count""!=(SELECT MAX(""num_count"") FROM ""Result"") AND ""r"".""num_count""!=(SELECT MIN(""num_count"") FROM ""Result"")"
135,"WITH ""cte"" AS (SELECT *,COUNT(1) AS ""total"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""total""!=(SELECT MIN(""total"") FROM ""cte"") AND ""total""!=(SELECT MAX(""total"") FROM ""cte"")"
136,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""ct""!=(SELECT MAX(""ct"") FROM ""cte"") AND ""ct""!=(SELECT MIN(""ct"") FROM ""cte"")"
137,"WITH ""agg_activity"" AS (SELECT ""activity"",COUNT(1) AS ""num_participants"" FROM ""Friends"" GROUP BY 1) SELECT ""name"" AS ""activity"" FROM ""Activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""agg_activity"" WHERE ""num_participants""=(SELECT MAX(""num_participants"") FROM ""agg_activity"") OR ""num_participants""=(SELECT MIN(""num_participants"") FROM ""agg_activity""))"
138,"WITH ""cte"" AS (SELECT COUNT(1) AS ""num"",""activity"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM (SELECT *,MAX(""num"") OVER () AS ""max_num"",MIN(""num"") OVER () AS ""min_num"" FROM ""cte"") AS ""tmp"" WHERE ""num""<""max_num"" AND ""num"">""min_num"""
139,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(DISTINCT ""id"")!=(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1) AND COUNT(DISTINCT ""id"")!=(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1)"
140,"WITH ""CTE1"" AS (SELECT ""activity"",COUNT(""id"") AS ""counts"" FROM ""Friends"" AS ""f"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE1"" WHERE ""counts"" NOT IN (SELECT MIN(""counts"") AS ""counts"" FROM ""CTE1"" UNION SELECT MAX(""counts"") AS ""counts"" FROM ""CTE1"")"
141,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""id"") NOT IN (SELECT MAX(""cnt"") AS ""cnt"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""tmp1"" UNION SELECT MIN(""cnt"") AS ""cnt"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""tmp2"")"
142,"WITH ""count_c"" AS (SELECT ""activity"",COUNT(1) AS ""total_c"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT MAX(""total_c"") FROM ""count_c"") AND COUNT(1)!=(SELECT MIN(""total_c"") FROM ""count_c"")"
143,"WITH ""sub1"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_rank"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_rank"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""sub1"" WHERE ""min_rank"">1 AND ""max_rank"">1"
144,"SELECT ""activity"" FROM ""Friends"" GROUP BY 1 HAVING COUNT(""id"")>(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(""id"")<(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
145,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""cnt""!=(SELECT MIN(""cnt"") FROM ""temp"") AND ""cnt""!=(SELECT MAX(""cnt"") FROM ""temp"")"
146,"WITH ""cte"" AS (SELECT ""a"".""name"",COUNT(""activity"") AS ""counta"" FROM ""Activities"" AS ""a"" JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""f"".""activity"") SELECT ""cte"".""name"" AS ""Activity"" FROM ""cte"" WHERE ""cte"".""counta"" NOT IN (SELECT MAX(""counta"") AS ""value"" FROM ""cte"" UNION SELECT MIN(""counta"") AS ""value"" FROM ""cte"")"
147,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"")"
148,"WITH ""a"" AS (SELECT ""activity"",COUNT(""activity"") AS ""numact"" FROM ""friends"" GROUP BY ""activity""), ""b"" AS (SELECT MAX(""numact"") AS ""maxnum"",MIN(""numact"") AS ""minnum"" FROM ""a"") SELECT ""activity"" FROM ""a"" AS ""a"" JOIN ""b"" AS ""b"" ON ""numact""!=""maxnum"" AND ""numact""!=""minnum"""
149,"WITH ""cte"" AS (SELECT ""a"".""name"" AS ""activity_name"",COUNT(""b"".""id"") AS ""counts"" FROM ""Activities"" AS ""a"" JOIN ""Friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY 1) SELECT ""activity_name"" AS ""activity"" FROM ""cte"" WHERE ""counts"" NOT IN (SELECT MAX(""counts"") FROM ""cte"") AND ""counts"" NOT IN (SELECT MIN(""counts"") FROM ""cte"") ORDER BY 1"
150,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""activity"") NOT IN ((SELECT MAX(""countactivity"") FROM (SELECT COUNT(""activity"") AS ""countactivity"" FROM ""Friends"" GROUP BY ""activity"") AS ""a""),(SELECT MIN(""countactivity"") FROM (SELECT COUNT(""activity"") AS ""countactivity"" FROM ""Friends"" GROUP BY ""activity"") AS ""a""))"
151,"WITH ""cte"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""rnk""!=1 AND ""rnk""!=(SELECT MAX(""rnk"") FROM ""cte"")"
152,"WITH ""cte"" AS (SELECT ""a"".""name"",COUNT(""f"".""id"") AS ""num"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""t"".""name"" AS ""activity"" FROM ""cte"" AS ""t"" WHERE ""t"".""num""!=(SELECT MAX(""num"") FROM ""cte"") AND ""t"".""num""!=(SELECT MIN(""num"") FROM ""cte"")"
153,"WITH ""act_count"" AS (SELECT ""a"".""name"",COUNT(""f"".""id"") AS ""activity_count"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""name"" AS ""activity"" FROM ""act_count"" WHERE ""activity_count""!=(SELECT MAX(""activity_count"") FROM ""act_count"") AND ""activity_count""!=(SELECT MIN(""activity_count"") FROM ""act_count"")"
154,"WITH ""cte"" AS (SELECT ""activity"",RANK() OVER (ORDER BY ""cnt"") AS ""rnk"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""Friends"" GROUP BY 1) AS ""x""), ""cte1"" AS (SELECT ""activity"",RANK() OVER (ORDER BY ""cnt"" DESC) AS ""rnk"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""Friends"" GROUP BY 1) AS ""x"") SELECT ""name"" AS ""activity"" FROM ""Activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""cte"" WHERE ""rnk""=1) AND ""name"" NOT IN (SELECT ""activity"" FROM ""cte1"" WHERE ""rnk""=1)"
155,"WITH ""tem"" AS (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""tem"" WHERE ""total"" NOT IN (SELECT MAX(""total"") FROM (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"") AND ""total"" NOT IN (SELECT MIN(""total"") FROM (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"")"
156,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""participants"" FROM ""Friends"" GROUP BY ""activity"" HAVING ""participants""!=(SELECT MAX(""p"") FROM (SELECT COUNT(""id"") AS ""p"",""activity"" FROM ""Friends"" GROUP BY 2) AS ""a"") AND ""participants""!=(SELECT MIN(""p"") FROM (SELECT COUNT(""id"") AS ""p"",""activity"" FROM ""Friends"" GROUP BY 2) AS ""a"")) AS ""b"""
157,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""name"") AS ""ac"",MAX(COUNT(""name"")) OVER () AS ""max_n"",MIN(COUNT(""name"")) OVER () AS ""min_n"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""ac"" NOT IN (""max_n"",""min_n"")"
158,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""id"") NOT IN ((SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1),(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1))"
159,"WITH ""nb_act"" AS (SELECT ""activity"",COUNT(0) AS ""nb"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""act"".""name"" AS ""activity"" FROM ""Friends"" AS ""fr"" JOIN ""Activities"" AS ""act"" ON ""fr"".""activity""=""act"".""name"" GROUP BY ""act"".""name"" HAVING COUNT(""fr"".""id"")!=(SELECT MAX(""nb"") FROM ""nb_act"") AND COUNT(""fr"".""id"")!=(SELECT MIN(""nb"") FROM ""nb_act"")"
160,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1)) AS ""rk"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""rk_desc"" FROM ""Friends"" GROUP BY ""activity"") AS ""temp"" WHERE ""rk""!=1 AND ""rk_desc""!=1"
161,"WITH ""tmp"" AS (SELECT COUNT(""f"".""id"") AS ""ct"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""a"".""name"" AS ""activity"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"" HAVING COUNT(""f"".""id"") NOT IN (SELECT MAX(""ct"") FROM ""tmp"" UNION SELECT MIN(""ct"") FROM ""tmp"")"
162,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""cnt"" NOT IN ((SELECT MIN(""cnt"") FROM ""CTE""),(SELECT MAX(""cnt"") FROM ""CTE""))"
163,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) AS ""NUM"" FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) AS ""NUM"" FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
164,"WITH ""c"" AS (SELECT ""a"".""name"",CASE WHEN COUNT(""a"".""id"") IS NULL THEN 0 ELSE COUNT(""a"".""id"") END AS ""count"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name""), ""m"" AS (SELECT MAX(""count"") AS ""m1"",MIN(""count"") AS ""m2"" FROM ""c"") SELECT ""c"".""name"" AS ""ACTIVITY"" FROM ""c"" WHERE ""c"".""count"" NOT IN (SELECT ""m1"" FROM ""m"") AND ""c"".""count"" NOT IN (SELECT ""m2"" FROM ""m"")"
165,"WITH ""cte"" AS (SELECT *,COUNT(1) AS ""act_count"",MIN(COUNT(1)) OVER () AS ""min_act_count"",MAX(COUNT(1)) OVER () AS ""max_act_count"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""act_count""!=""min_act_count"" AND ""act_count""!=""max_act_count"""
166,"WITH ""new"" AS (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""new"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""new"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""new"")"
167,"SELECT ""a"".""activity"" AS ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""counts"",MAX(COUNT(1)) OVER () AS ""max_c"",MIN(COUNT(1)) OVER () AS ""min_c"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""a"".""counts"" NOT IN (""max_c"",""min_c"")"
168,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""name"") AS ""num_participant"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" AS ""ACTIVITY"" FROM (SELECT ""activity"",""num_participant"",MAX(""num_participant"") OVER () AS ""max_participant"",MIN(""num_participant"") OVER () AS ""min_participant"" FROM ""cte"") AS ""sub"" WHERE ""num_participant""<""max_participant"" AND ""num_participant"">""min_participant"""
169,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY 1) SELECT DISTINCT ""activity"" FROM ""cte"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""cte"")"
170,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY ""ppl"") AS ""act_rank"",RANK() OVER (ORDER BY ""ppl"" DESC) AS ""act_rank_reverse"" FROM (SELECT ""activity"",COUNT(""name"") AS ""ppl"" FROM ""Friends"" GROUP BY 1) AS ""t1"") AS ""t2"" WHERE ""act_rank""!=1 AND ""act_rank_reverse""!=1 ORDER BY 1"
171,"WITH ""ActivityRanking"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""HRk"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""LRk"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""Friends"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM ""ActivityRanking"" WHERE ""HRk""=1) AND ""activity"" NOT IN (SELECT ""activity"" FROM ""ActivityRanking"" WHERE ""LRk""=1)"
172,"WITH ""tem"" AS (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""tem"" WHERE ""cnt"" NOT IN (SELECT MIN(""cnt"") AS ""cnt"" FROM ""tem"" UNION (SELECT MAX(""cnt"") AS ""cnt"" FROM ""tem""))"
173,"WITH ""act"" AS (SELECT ""activity"",COUNT(""id"") AS ""total"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""act"" WHERE ""total"" NOT IN (SELECT MAX(""total"") FROM ""act"") AND ""total"" NOT IN (SELECT MIN(""total"") FROM ""act"")"
174,"WITH ""cte"" AS (SELECT COUNT(""id"") AS ""cnt"",""activity"" FROM ""Friends"" GROUP BY 2) SELECT ""activity"" FROM ""cte"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""cte"")"
175,"WITH ""mima"" AS (SELECT ""activity"",COUNT(1) AS ""ct"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""mima"" WHERE ""ct"" NOT IN (SELECT MAX(""ct"") FROM ""mima"") AND ""ct"" NOT IN (SELECT MIN(""ct"") FROM ""mima"")"
176,"WITH ""t"" AS (SELECT ""a"".""name"",COUNT(""f"".""id"") AS ""sum"",RANK() OVER (ORDER BY COUNT(""f"".""id"")) AS ""R1"",RANK() OVER (ORDER BY COUNT(""f"".""id"") DESC) AS ""R2"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""f"".""activity"",""a"".""name"") SELECT ""t"".""name"" AS ""activity"" FROM ""t"" WHERE ""t"".""R1""!=1 AND ""t"".""R2""!=1"
177,"WITH ""temp1"" AS (SELECT ""activity"",COUNT(""activity"") FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""activity"")!=(SELECT DISTINCT MAX(COUNT(""activity"")) OVER () FROM ""friends"" GROUP BY ""activity"") AND COUNT(""activity"")!=(SELECT DISTINCT MIN(COUNT(""activity"")) OVER () FROM ""friends"" GROUP BY ""activity"")) SELECT DISTINCT ""activity"" FROM ""temp1"""
178,"WITH ""TEMP"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""TEMP"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""TEMP"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""TEMP"")"
179,"WITH ""cntact"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cntact"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cntact"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cntact"")"
180,"SELECT ""temp"".""activity"" FROM (SELECT ""f"".""activity"",RANK() OVER (ORDER BY COUNT(""f"".""id"")) AS ""ascrnk"",RANK() OVER (ORDER BY COUNT(""f"".""id"") DESC) AS ""descrnk"" FROM ""friends"" AS ""f"" GROUP BY 1) AS ""temp"" WHERE ""temp"".""ascrnk""!=1 AND ""temp"".""descrnk""!=1"
181,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
182,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
183,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""name"")!=(SELECT COUNT(""name"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""name"") LIMIT 1) AND COUNT(""name"")!=(SELECT COUNT(""name"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""name"") DESC LIMIT 1)"
184,"SELECT ""a"".""activity"" AS ""ACTIVITY"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""activity"")) AS ""r1"",DENSE_RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""r2"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""a"".""r1""!=1 AND ""a"".""r2""!=1"
185,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""activity"") NOT IN ((SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1),(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1))"
186,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1)"
187,"WITH ""t"" AS (SELECT ""f"".""activity"",DENSE_RANK() OVER (ORDER BY COUNT(1) DESC) AS ""high"",DENSE_RANK() OVER (ORDER BY COUNT(1)) AS ""low"" FROM ""friends"" AS ""f"" JOIN ""activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY 1) SELECT ""activity"" FROM ""t"" WHERE ""high""!=1 AND ""low""!=1"
188,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""rank1"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rank2"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""rank1""!=1 AND ""rank2""!=1"
189,"WITH ""act_count"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""name"")) AS ""count_rank"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""act_count"" WHERE ""count_rank""!=1 AND ""count_rank""!=(SELECT MAX(""count_rank"") FROM ""act_count"")"
190,"SELECT ""activity"" FROM (SELECT DISTINCT ""activity"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""top"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""bot"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""top""!=1 AND ""bot""!=1"
191,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
192,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""name"")) AS ""min_rank"",DENSE_RANK() OVER (ORDER BY COUNT(""name"") DESC) AS ""max_rank"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""min_rank""!=1 AND ""max_rank""!=1"
193,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"")"
194,"WITH ""cte"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""person"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""person"" NOT IN (SELECT MAX(""person"") FROM ""cte"") AND ""person"" NOT IN (SELECT MIN(""person"") FROM ""cte"")"
195,"WITH ""cte"" AS (SELECT *,COUNT(""activity"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""ct"" NOT IN ((SELECT MAX(""ct"") FROM ""cte""),(SELECT MIN(""ct"") FROM ""cte""))"
196,"WITH ""A"" AS (SELECT ""id"",COUNT(""activity"") AS ""rnk"",""activity"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""e"".""ACTIVITY"" AS ""activity"" FROM ""A"" AS ""e"" WHERE ""e"".""rnk""!=(SELECT MAX(""rnk"") FROM ""A"") AND ""e"".""rnk""!=(SELECT MIN(""rnk"") FROM ""A"")"
197,"WITH ""TEMP"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""TEMP"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""TEMP"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""TEMP"")"
198,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""id""),RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""drank"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""arank"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"" WHERE ""drank""!=1 AND ""arank""!=1"
199,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY ""activity""), ""cte2"" AS (SELECT MIN(""cnt"") AS ""mincnt"",MAX(""cnt"") AS ""maxcnt"" FROM ""cte"") SELECT ""cte1"".""activity"" FROM (""cte"" AS ""cte1"") JOIN ""cte2"" AS ""cte2"" WHERE ""cte1"".""cnt""!=""cte2"".""mincnt"" AND ""cte1"".""cnt""!=""cte2"".""maxcnt"""
200,"WITH ""t"" AS (SELECT ""a"".""name"" AS ""activity"",COALESCE(COUNT(""f"".""name""), 0) AS ""num"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""t"" WHERE ""num""!=(SELECT MAX(""num"") FROM ""t"") AND ""num""!=(SELECT MIN(""num"") FROM ""t"")"
201,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(""activity"") AS ""num_a"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""activity"")!=(SELECT MAX(""num_a"") FROM ""CTE"") AND COUNT(""activity"")!=(SELECT MIN(""num_a"") FROM ""CTE"")"
202,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY ""cnt"" DESC) AS ""max_rnk"",RANK() OVER (ORDER BY ""cnt"") AS ""min_rnk"" FROM (SELECT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""x"") AS ""y"" WHERE ""max_rnk""!=1 AND ""min_rnk""!=1"
203,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""rnk"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""rnk""!=1 AND ""rnk_desc""!=1"
204,"WITH ""cte"" AS (SELECT ""f"".""activity"",COUNT(""f"".""name"") AS ""cnt"" FROM ""Friends"" AS ""f"" GROUP BY ""f"".""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"")"
205,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT (""activity"") FROM ""cte"" WHERE ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""cte"") AND ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""cte"")"
206,"WITH ""temp1"" AS (SELECT ""activity"",COUNT(""activity"") FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""activity"") NOT IN ((SELECT DISTINCT MAX(COUNT(""activity"")) OVER () FROM ""friends"" GROUP BY ""activity""),(SELECT DISTINCT MIN(COUNT(""activity"")) OVER () FROM ""friends"" GROUP BY ""activity""))) SELECT DISTINCT ""activity"" FROM ""temp1"""
207,"WITH ""temp"" AS (SELECT ""a"".""name"",COUNT(""f"".""id"") AS ""num_counts"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""t"".""name"" AS ""activity"" FROM ""temp"" AS ""t"" WHERE ""t"".""num_counts""!=(SELECT MAX(""num_counts"") FROM ""temp"") AND ""t"".""num_counts""!=(SELECT MIN(""num_counts"") FROM ""temp"")"
208,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""act_num"",MAX(COUNT(1)) OVER () AS ""max_act"",MIN(COUNT(1)) OVER () AS ""min_act"" FROM ""Friends"" GROUP BY ""activity"" ORDER BY ""act_num"" DESC) AS ""TABLE1"" WHERE ""act_num"" NOT IN (""max_act"",""min_act"")"
209,"SELECT ""B"".""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""no_count"" FROM ""Friends"" GROUP BY ""activity"") AS ""B"" WHERE ""B"".""no_count""!=(SELECT MIN(""A"".""no_count"") AS ""min_count"" FROM (SELECT ""activity"",COUNT(""id"") AS ""no_count"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"") AND ""B"".""no_count""!=(SELECT MAX(""A"".""no_count"") AS ""max_count"" FROM (SELECT ""activity"",COUNT(""id"") AS ""no_count"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"")"
210,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
211,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""activity"") AS ""ac"",MAX(COUNT(""activity"")) OVER () AS ""max_num"",MIN(COUNT(""activity"")) OVER () AS ""min_num"" FROM ""Friends"" GROUP BY ""activity"") AS ""tb1"" WHERE ""ac"" NOT IN (""max_num"",""min_num"")"
212,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""count_activity"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" RIGHT JOIN ""Activities"" AS ""A"" ON ""CTE"".""activity""=""A"".""name"" WHERE ""count_activity"" NOT IN ((SELECT MAX(""count_activity"") FROM ""CTE""),(SELECT MIN(""count_activity"") FROM ""CTE"")) GROUP BY ""activity"""
213,"WITH ""ActRanks"" AS (SELECT ""activity"",COUNT(""id""),RANK() OVER (ORDER BY COUNT(""id"")) AS ""r"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""ActRanks"" WHERE ""r"">1 AND ""r""<(SELECT MAX(""r"") FROM ""ActRanks"")"
214,"WITH ""cte"" AS (SELECT ""a"".""name"" AS ""activity"",COUNT(1) AS ""activity_count"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""cte"" WHERE ""activity_count""<(SELECT MAX(""activity_count"") FROM ""cte"") AND ""activity_count"">(SELECT MIN(""activity_count"") FROM ""cte"")"
215,"WITH ""min_max_activities"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""total"" DESC) AS ""ranked_max"",DENSE_RANK() OVER (ORDER BY ""total"") AS ""ranked_min"" FROM (SELECT ""activity"",COUNT(1) AS ""total"" FROM ""friends"" GROUP BY 1) AS ""f"") SELECT ""name"" AS ""activity"" FROM ""activities"" AS ""a"" LEFT JOIN (SELECT * FROM ""min_max_activities"" WHERE ""ranked_max""=1 OR ""ranked_min""=1) AS ""g"" ON ""g"".""activity""=""a"".""name"" WHERE ""g"".""activity"" IS NULL"
216,"SELECT ""activity"" FROM (SELECT ""activity"",""cnt"",DENSE_RANK() OVER (ORDER BY ""cnt"") AS ""rnk1"",DENSE_RANK() OVER (ORDER BY ""cnt"" DESC) AS ""rnk2"" FROM (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"") AS ""b"" WHERE ""rnk1""!=1 AND ""rnk2""!=1"
217,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""minrank"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""maxrank"" FROM ""friends"" GROUP BY ""activity"") SELECT ""name"" AS ""activity"" FROM ""activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""temp"" WHERE ""minrank""=1 OR ""maxrank""=1)"
218,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""F"".""id"")) AS ""RK1"",RANK() OVER (ORDER BY COUNT(""F"".""id"") DESC) AS ""RK2"" FROM ""Activities"" AS ""A"" LEFT JOIN ""Friends"" AS ""F"" ON ""A"".""name""=""F"".""activity"" GROUP BY ""activity"") AS ""T"" WHERE ""RK1""!=1 AND ""RK2""!=1"
219,"WITH ""t"" AS (SELECT ""a"".""name"" AS ""activity"",COALESCE(COUNT(""f"".""name""), 0) AS ""num"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""t"" WHERE ""num""!=(SELECT MAX(""num"") FROM ""t"") AND ""num""!=(SELECT MIN(""num"") FROM ""t"")"
220,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
221,"WITH ""abc"" AS (SELECT ""activity"",COUNT(""activity"") AS ""counts"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""abc"" WHERE ""counts""<(SELECT MAX(""counts"") FROM ""abc"") AND ""counts"">(SELECT MIN(""counts"") FROM ""abc"")"
222,"WITH ""t1"" AS (SELECT ""activity"",COUNT(1) AS ""activity_cnt"" FROM ""Friends"" GROUP BY 1), ""t2"" AS (SELECT ""activity"" FROM ""t1"" WHERE ""activity_cnt""=(SELECT MIN(""activity_cnt"") FROM ""t1"") UNION ALL SELECT ""activity"" FROM ""t1"" WHERE ""activity_cnt""=(SELECT MAX(""activity_cnt"") FROM ""t1"")) SELECT ""activity"" FROM ""t1"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM ""t2"")"
223,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""maxrnk"",DENSE_RANK() OVER (ORDER BY COUNT(""activity"")) AS ""minrnk"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"" WHERE ""minrnk""!=1 AND ""maxrnk""!=1"
224,"WITH ""cte"" AS (SELECT ""a"".""name"",COUNT(""f"".""name"") AS ""cnt"" FROM ""Activities"" AS ""a"" JOIN ""Friends"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY 1) SELECT ""name"" AS ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"")"
225,"WITH ""a"" AS (SELECT ""activity"",COUNT(""name"") AS ""activity_count"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""a"" WHERE ""activity_count"" NOT IN (SELECT MAX(""activity_count"") FROM ""a"") AND ""activity_count"" NOT IN (SELECT MIN(""activity_count"") FROM ""a"")"
226,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1)) AS ""rk"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""rk_desc"" FROM ""Friends"" GROUP BY ""activity"") AS ""temp"" WHERE ""rk""!=1 AND ""rk_desc""!=1"
227,"SELECT ""activity"" FROM (SELECT ""a"".""name"" AS ""activity"",RANK() OVER (ORDER BY COUNT(DISTINCT ""b"".""id"")) AS ""rnk_asc"",RANK() OVER (ORDER BY COUNT(DISTINCT ""b"".""id"") DESC) AS ""rnk_desc"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY 1) AS ""t"" WHERE ""rnk_asc""!=1 AND ""rnk_desc""!=1"
228,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""ct""!=(SELECT MAX(""ct"") FROM ""cte"") AND ""ct""!=(SELECT MIN(""ct"") FROM ""cte"")"
229,"WITH ""activity_cnt"" AS (SELECT ""activity"",COUNT(""f"".""id"") AS ""cnt"" FROM ""friends"" AS ""f"" GROUP BY ""activity"") SELECT ""activity"" FROM ""activity_cnt"" WHERE ""cnt"">(SELECT MIN(""cnt"") FROM ""activity_cnt"") AND ""cnt""<(SELECT MAX(""cnt"") FROM ""activity_cnt"")"
230,"WITH ""act"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" AS ""a"" JOIN ""Activities"" AS ""b"" ON ""a"".""activity""=""b"".""name"" GROUP BY ""a"".""activity"") SELECT ""activity"" FROM ""act"" WHERE ""cnt"" NOT IN (SELECT MAX(""cnt"") FROM ""act"") AND ""cnt"" NOT IN (SELECT MIN(""cnt"") FROM ""act"")"
231,"SELECT ""activity"" FROM ""friends"" GROUP BY 1 HAVING COUNT(""id"") NOT IN (SELECT MAX(""id"") AS ""id"" FROM (SELECT ""activity"",COUNT(""id"") AS ""id"" FROM ""friends"" GROUP BY 1) AS ""a"" UNION ALL SELECT MIN(""id"") FROM (SELECT ""activity"",COUNT(""id"") AS ""id"" FROM ""friends"" GROUP BY 1) AS ""a"")"
232,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""activity"") AS ""act_cnt"" FROM ""friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""friends"" WHERE ""activity"" NOT IN (SELECT ""cte"".""activity"" FROM ""cte"" JOIN (SELECT MIN(""cte"".""act_cnt"") AS ""min_cnt"" FROM ""cte"") AS ""a"" ON ""a"".""min_cnt""=""cte"".""act_cnt"" UNION ALL SELECT ""cte"".""activity"" FROM ""cte"" JOIN (SELECT MAX(""cte"".""act_cnt"") AS ""max_cnt"" FROM ""cte"") AS ""a"" ON ""a"".""max_cnt""=""cte"".""act_cnt"")"
233,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""top_rnk"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""bot_rnk"" FROM ""Friends"" GROUP BY 1) AS ""t"" WHERE ""top_rnk""!=1 AND ""bot_rnk""!=1"
234,"WITH ""FriendActivity"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""High"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""Low"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""FriendActivity"" WHERE ""High""!=1 AND ""Low""!=1"
235,"WITH ""temp"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""num_activity"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""temp"" WHERE ""num_activity"" NOT IN ((SELECT MAX(""num_activity"") FROM ""temp""),(SELECT MIN(""num_activity"") FROM ""temp""))"
236,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""name"") AS ""cnts"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cnts""!=(SELECT MAX(""cnts"") FROM ""cte"") AND ""cnts""!=(SELECT MIN(""cnts"") FROM ""cte"")"
237,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""total"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""total"" NOT IN (SELECT MAX(""total"") FROM ""cte"") AND ""total"" NOT IN (SELECT MIN(""total"") FROM ""cte"")"
238,"WITH ""t1"" AS (SELECT ""activity"",COUNT(""name"") AS ""participant_count"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t1"" WHERE ""participant_count""<(SELECT MAX(""participant_count"") FROM ""t1"") AND ""participant_count"">(SELECT MIN(""participant_count"") FROM ""t1"")"
239,"WITH ""counts"" AS (SELECT COUNT(DISTINCT ""id"") AS ""c"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""Friends"" GROUP BY ""Activity"" HAVING COUNT(DISTINCT ""id"") NOT IN (SELECT MAX(""c"") FROM ""counts"") AND COUNT(DISTINCT ""id"") NOT IN (SELECT MIN(""c"") FROM ""counts"")"
240,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
241,"WITH ""activity_freq"" AS (SELECT COUNT(1) AS ""freq"",""activity"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""activity_freq"" WHERE ""freq""!=(SELECT MIN(""freq"") FROM ""activity_freq"") AND ""freq""!=(SELECT MAX(""freq"") FROM ""activity_freq"")"
242,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""activity_max"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""activity_min"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"" WHERE ""activity_max""!=1 AND ""activity_min""!=1"
243,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""max_count"",RANK() OVER (ORDER BY COUNT(1)) AS ""min_count"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT (""activity"") FROM ""cte"" WHERE ""max_count""!=1 AND ""min_count""!=1"
244,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""count_"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""count_"" NOT IN ((SELECT MAX(""count_"") FROM ""temp""),(SELECT MIN(""count_"") FROM ""temp""))"
245,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""id"")<(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1) AND COUNT(""id"")>(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1)"
246,"WITH ""subq"" AS (SELECT ""activity"",COUNT(""name"") AS ""ptcip"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""subq"" WHERE ""ptcip"" NOT IN ((SELECT MAX(""ptcip"") FROM ""subq""),(SELECT MIN(""ptcip"") FROM ""subq""))"
247,"WITH ""cte"" AS (SELECT ""a"".""name"" AS ""activity"",COUNT(""f"".""id"") AS ""cnt"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cte"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cte"")"
248,"SELECT ""Activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
249,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""activity""),RANK() OVER (ORDER BY COUNT(""activity"")) AS ""r1"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""r2"" FROM ""Friends"" GROUP BY ""activity"") AS ""tbl"" WHERE ""r1""!=1 AND ""r2""!=1"
250,"WITH ""tmp"" AS (SELECT ""activity"",COUNT(""id"") AS ""part"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""tmp"" WHERE ""part""!=(SELECT MAX(""part"") FROM ""tmp"") AND ""part""!=(SELECT MIN(""part"") FROM ""tmp"")"
251,"WITH ""cte"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""activity_rank"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""cte"" WHERE ""activity_rank""!=(SELECT MAX(""activity_rank"") FROM ""cte"") AND ""activity_rank""!=(SELECT MIN(""activity_rank"") FROM ""cte"")"
252,"SELECT ""activity"" FROM ""Friends"" GROUP BY 1 HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1)"
253,"WITH ""a"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""a"" WHERE ""a"".""cnt"" NOT IN ((SELECT MAX(""cnt"") FROM ""a""),(SELECT MIN(""cnt"") FROM ""a""))"
254,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"") DESC) AS ""top_rnk"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"")) AS ""bot_rnk"" FROM ""Friends"" GROUP BY 1) AS ""t"" WHERE ""top_rnk""!=1 AND ""bot_rnk""!=1"
255,"SELECT DISTINCT ""activity"" FROM ""friends"" WHERE ""activity"" NOT IN (SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rnk"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""rnk""=1) AND ""activity"" NOT IN (SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""activity"")) AS ""rnk"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""rnk""=1)"
256,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""act_count"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""act_count""!=(SELECT MAX(""act_count"") FROM ""cte"") AND ""act_count""!=(SELECT MIN(""act_count"") FROM ""cte"")"
257,"WITH ""S0"" AS (SELECT ""activity"",COUNT(""name"") AS ""num_people"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""S0"" WHERE ""num_people""!=(SELECT MAX(""num_people"") FROM ""S0"") AND ""num_people""!=(SELECT MIN(""num_people"") FROM ""S0"")"
258,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""act_num"",MAX(COUNT(1)) OVER () AS ""max_act"",MIN(COUNT(1)) OVER () AS ""min_act"" FROM ""Friends"" GROUP BY ""activity"" ORDER BY ""act_num"" DESC) AS ""TABLE1"" WHERE ""act_num"" NOT IN (""max_act"",""min_act"")"
259,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
260,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""activity"")!=(SELECT COUNT(""activity"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""activity"") LIMIT 1) AND COUNT(""activity"")!=(SELECT COUNT(""activity"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""activity"") DESC LIMIT 1)"
261,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""act"",MAX(COUNT(1)) OVER () AS ""max_num"",MIN(COUNT(1)) OVER () AS ""min_num"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""act"" NOT IN (""max_num"",""min_num"")"
262,"WITH ""Friends_activity"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""Friends"" GROUP BY ""activity""), ""extremes"" AS (SELECT MAX(""cnt"") AS ""cnt_act"" FROM ""Friends_activity"" UNION SELECT MIN(""cnt"") AS ""cnt_act"" FROM ""Friends_activity"") SELECT ""activity"" FROM ""Friends_activity"" WHERE ""cnt"" NOT IN (SELECT ""cnt_act"" FROM ""extremes"")"
263,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""ranking1"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""ranking2"" FROM ""friends"" GROUP BY ""activity"") AS ""tmpt"" WHERE ""ranking1""!=1 AND ""ranking2""!=1"
264,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""c"" FROM ""Friends"" GROUP BY 1 ORDER BY 2) SELECT ""activity"" FROM ""cte"" WHERE ""c"">(SELECT MIN(""c"") FROM ""cte"") AND ""c""<(SELECT MAX(""c"") FROM ""cte"")"
265,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"") DESC) AS ""top_rnk"",DENSE_RANK() OVER (ORDER BY COUNT(DISTINCT ""id"")) AS ""bot_rnk"" FROM ""Friends"" GROUP BY 1) AS ""t"" WHERE ""top_rnk""!=1 AND ""bot_rnk""!=1"
266,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(""name"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""ct"" NOT IN ((SELECT MIN(""ct"") FROM ""CTE""),(SELECT MAX(""ct"") FROM ""CTE""))"
267,"SELECT ""activity"" FROM (SELECT ""a"".""name"" AS ""activity"",RANK() OVER (ORDER BY COUNT(CASE WHEN ""b"".""name"" THEN 1 ELSE 0 END)) AS ""rank_asc"",RANK() OVER (ORDER BY COUNT(CASE WHEN ""b"".""name"" THEN 1 ELSE 0 END) DESC) AS ""rank_desc"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY ""activity"") AS ""A"" WHERE ""rank_asc""=""rank_desc"" OR (""rank_asc""!=1 AND ""rank_desc""!=1)"
268,"WITH ""t1"" AS (SELECT ""activity"",COUNT(""activity"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t1"" WHERE ""ct"" NOT IN (SELECT MAX(""ct"") FROM ""t1"") AND ""ct"" NOT IN (SELECT MIN(""ct"") FROM ""t1"")"
269,"WITH ""count_CTE"" AS (SELECT *,COUNT(""id"") OVER (PARTITION BY ""activity"") AS ""count_act"" FROM ""Friends"") SELECT DISTINCT ""activity"" FROM ""count_CTE"" WHERE ""count_act"" NOT IN (SELECT MIN(""count_act"") FROM ""count_CTE"") AND ""count_act"" NOT IN (SELECT MAX(""count_act"") FROM ""count_CTE"")"
270,"WITH ""cntact"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cntact"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""cntact"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""cntact"")"
271,"WITH ""PARTICIPANTS"" AS (SELECT ""ACTIVITY"",COUNT(""ID"") AS ""COUNT_PART"" FROM ""FRIENDS"" GROUP BY ""ACTIVITY"") SELECT ""ACTIVITY"" FROM ""PARTICIPANTS"" WHERE ""COUNT_PART""!=(SELECT MAX(""COUNT_PART"") FROM ""PARTICIPANTS"") AND ""COUNT_PART""!=(SELECT MIN(""COUNT_PART"") FROM ""PARTICIPANTS"")"
272,"WITH ""cte"" AS (SELECT MIN(""count_names"") AS ""min_count"",MAX(""count_names"") AS ""max_count"" FROM (SELECT ""activity"",COUNT(""name"") AS ""count_names"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"") SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""name"")!=(SELECT ""min_count"" FROM ""cte"") AND COUNT(""name"")!=(SELECT ""max_count"" FROM ""cte"")"
273,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""num"" DESC) AS ""rnk_desc"",DENSE_RANK() OVER (ORDER BY ""num"") AS ""rnk_asc"" FROM (SELECT DISTINCT ""activity"",COUNT(""f"".""name"") OVER (PARTITION BY ""f"".""activity"") AS ""num"" FROM ""Friends"" AS ""f"" LEFT JOIN ""Activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"") AS ""cte1"") AS ""cte2"" WHERE ""rnk_desc""!=1 AND ""rnk_asc""!=1"
274,"WITH ""CTE1"" AS (SELECT ""activity"",COALESCE(COUNT(""f"".""name""), 0) AS ""activity_cnt"" FROM ""friends"" AS ""f"" RIGHT JOIN ""Activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""CTE1"" WHERE ""activity_cnt""!=(SELECT MAX(""activity_cnt"") FROM ""CTE1"") AND ""activity_cnt""!=(SELECT MIN(""activity_cnt"") FROM ""CTE1"")"
275,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
276,"SELECT DISTINCT ""activity"" FROM ""friends"" GROUP BY 1 HAVING COUNT(""id"") NOT IN (SELECT MIN(""ct"") FROM (SELECT COUNT(""id"") AS ""ct"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" UNION SELECT MAX(""ct"") FROM (SELECT COUNT(""id"") AS ""ct"" FROM ""friends"" GROUP BY ""activity"") AS ""a"")"
277,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
278,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY 1), ""max_min_active"" AS (SELECT MAX(""cnt"") AS ""max_cnt"",MIN(""cnt"") AS ""min_cnt"" FROM ""cte"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt"" NOT IN (SELECT ""max_cnt"" FROM ""max_min_active"") AND ""cnt"" NOT IN (SELECT ""min_cnt"" FROM ""max_min_active"")"
279,"WITH ""cte"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1) DESC) AS ""rnk"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""cte"" WHERE ""rnk""!=1 AND ""rnk""!=(SELECT MAX(""rnk"") FROM ""cte"")"
280,"SELECT ""ACTIVITY"" FROM (WITH ""cte"" AS (SELECT COUNT(""ACTIVITY"") AS ""MINMAX"",""ACTIVITY"" FROM ""FRIENDS"" GROUP BY ""ACTIVITY"") SELECT ""ACTIVITY"",COUNT(""ACTIVITY"") FROM ""FRIENDS"" GROUP BY ""ACTIVITY"" HAVING COUNT(""ACTIVITY"")!=(SELECT MAX(""MINMAX"") FROM ""CTE"") AND COUNT(""ACTIVITY"")!=(SELECT MIN(""MINMAX"") FROM ""CTE"")) AS ""B"""
281,"WITH ""Activity_count"" AS (SELECT DISTINCT ""activity"" AS ""activity"",COUNT(""name"") OVER (PARTITION BY ""activity"") AS ""n_participants"" FROM ""Friends"") SELECT DISTINCT ""activity"" FROM ""ACtivity_count"" WHERE ""n_participants""!=(SELECT MAX(""n_participants"") FROM ""activity_count"") AND ""n_participants""!=(SELECT MIN(""n_participants"") FROM ""activity_count"")"
282,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""id"") AS ""holder"" FROM ""Friends"" GROUP BY ""Activity"") SELECT ""activity"" FROM ""cte"" WHERE ""holder"" NOT IN ((SELECT MAX(""holder"") FROM ""cte""),(SELECT MIN(""holder"") FROM ""cte""))"
283,"SELECT ""activity"" FROM (SELECT DISTINCT ""activity"",COUNT(""id"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""t"" WHERE ""cnt""!=(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1) AND ""cnt""!=(SELECT COUNT(""id"") FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1)"
284,"SELECT ""A"".""activity"" FROM (SELECT ""activity"",COUNT(""name"") AS ""count_name"",MAX(COUNT(1)) OVER () AS ""max_count"",MIN(COUNT(1)) OVER () AS ""min_count"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"" WHERE ""A"".""count_name"" NOT IN (""A"".""max_count"",""A"".""min_count"")"
285,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY ""ct"") AS ""ranking_asc"",RANK() OVER (ORDER BY ""ct"" DESC) AS ""ranking_desc"" FROM (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") AS ""sub1"") AS ""sub2"" WHERE ""ranking_asc""!=1 AND ""ranking_desc""!=1"
286,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_activity"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""temp"" WHERE ""max_activity""!=1 AND ""min_activity""!=1"
287,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
288,"WITH ""t"" AS (SELECT ""activity"",COUNT(1) AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t"" WHERE ""ct"" NOT IN (SELECT MAX(""ct"") FROM ""t"") AND ""ct"" NOT IN (SELECT MIN(""ct"") FROM ""t"")"
289,"WITH ""result"" AS (SELECT ""T1"".*,RANK() OVER (ORDER BY ""cnt"") AS ""DR"" FROM (SELECT ""activity"",COUNT(DISTINCT ""ID"") AS ""cnt"" FROM ""friends"" GROUP BY 1) AS ""T1"") SELECT ""activity"" FROM ""result"" WHERE ""DR""!=1 AND ""DR"" NOT IN (SELECT MAX(""DR"") FROM ""result"")"
290,"WITH ""act_rank_tb"" AS (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY ""act_num"") AS ""act_rank"" FROM (SELECT ""activity"",COUNT(""name"") AS ""act_num"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"") SELECT ""activity"" FROM ""act_rank_tb"" WHERE ""act_rank""!=(SELECT MIN(""act_rank"") FROM ""act_rank_tb"") AND ""act_rank""!=(SELECT MAX(""act_rank"") FROM ""act_rank_tb"")"
291,"WITH ""temp1"" AS (SELECT ""activity"",COUNT(""id"") AS ""ct"" FROM ""Friends"" GROUP BY 1) SELECT ""activity"" FROM ""temp1"" WHERE ""ct""!=(SELECT MAX(""ct"") FROM ""temp1"") AND ""ct""!=(SELECT MIN(""ct"") FROM ""temp1"")"
292,"WITH ""temp"" AS (SELECT ""f"".""activity"",COUNT(""f"".""name"") AS ""cnt"" FROM ""Activities"" AS ""a"" LEFT JOIN ""Friends"" AS ""f"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""temp"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""temp"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""temp"")"
293,"SELECT ""activity"" FROM (SELECT ""A1"".""name"" AS ""activity"",COUNT(1) AS ""CNT"",MAX(COUNT(1)) OVER () AS ""MAX_CNT"",MIN(COUNT(1)) OVER () AS ""MIN_CNT"" FROM ""Activities"" AS ""A1"" JOIN ""Friends"" AS ""F1"" ON ""A1"".""name""=""F1"".""activity"" GROUP BY 1) AS ""TEMP"" WHERE ""CNT""!=""MAX_CNT"" AND ""CNT""!=""MIN_CNT"""
294,"WITH ""extreme"" AS (SELECT ""activity"",COUNT(1) AS ""num"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""extreme"" WHERE ""num""!=(SELECT MAX(""num"") FROM ""extreme"") AND ""num""!=(SELECT MIN(""num"") FROM ""extreme"")"
295,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_activity"" FROM ""friends"" GROUP BY 1) SELECT ""name"" AS ""activity"" FROM ""activities"" JOIN ""temp"" ON ""activities"".""name""=""temp"".""activity"" WHERE ""max_activity""!=1 AND ""min_activity""!=1"
296,"WITH ""A"" AS (SELECT ""activity"",COUNT(""id"") OVER (PARTITION BY ""activity"") AS ""noofpart"" FROM ""friends"") SELECT DISTINCT ""activity"" FROM ""A"" WHERE ""noofpart""!=(SELECT MAX(""noofpart"") FROM ""A"") AND ""noofpart""!=(SELECT MIN(""noofpart"") FROM ""A"")"
297,"WITH ""activity_cnt"" AS (SELECT ""activity"",COUNT(""f"".""id"") AS ""cnt"" FROM ""friends"" AS ""f"" GROUP BY ""activity"") SELECT ""activity"" FROM ""activity_cnt"" WHERE ""cnt"">(SELECT MIN(""cnt"") FROM ""activity_cnt"") AND ""cnt""<(SELECT MAX(""cnt"") FROM ""activity_cnt"")"
298,"WITH ""y"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""x"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""y"" WHERE ""x"" NOT IN (SELECT MAX(""x"") FROM ""y"") AND ""x"" NOT IN (SELECT MIN(""x"") FROM ""y"")"
299,"WITH ""cte1"" AS (SELECT ""activity"" FROM (SELECT ""activity"",COUNT(""id"") AS ""x"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""d_rank"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""i_rank"" FROM ""friends"" GROUP BY 1) AS ""agg"" WHERE ""agg"".""d_rank""!=1 AND ""agg"".""i_rank""!=1) SELECT ""name"" AS ""activity"" FROM ""activities"" WHERE ""name"" IN (SELECT * FROM ""cte1"")"
300,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""ct"" FROM ""Friends"" GROUP BY ""activity"") SELECT DISTINCT ""activity"" FROM ""cte"" WHERE ""ct"" NOT IN (SELECT MAX(""ct"") FROM ""cte"") AND ""ct"" NOT IN (SELECT MIN(""ct"") FROM ""cte"")"
301,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(""activity"")!=(SELECT COUNT(""activity"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""activity"") DESC LIMIT 1) AND COUNT(""activity"")!=(SELECT COUNT(""activity"") FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""activity"") LIMIT 1)"
302,"SELECT ""F"".""activity"" FROM ""Friends"" AS ""F"" GROUP BY 1 HAVING COUNT(1)<(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1) AND COUNT(1)>(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1)"
303,"SELECT ""t"".""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""ra"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rd"" FROM ""friends"" GROUP BY 1) AS ""t"" WHERE ""t"".""ra""!=1 AND ""t"".""rd""!=1"
304,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_activity"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""temp"" WHERE ""max_activity""!=1 AND ""min_activity""!=1"
305,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""max_activity"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""min_activity"" FROM ""friends"" GROUP BY 1) SELECT ""activity"" FROM ""temp"" WHERE ""max_activity""!=1 AND ""min_activity""!=1"
306,"WITH ""TA"" AS (SELECT ""activity"",COUNT(""activity"") AS ""counta"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""TA"" WHERE ""counta""!=(SELECT MAX(""counta"") FROM ""TA"") AND ""counta""!=(SELECT MIN(""counta"") FROM ""TA"")"
307,"WITH ""cte"" AS (SELECT DISTINCT ""a"".""name"" AS ""activity"",COUNT(""f"".""id"") AS ""cnts"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""f"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""cte"" WHERE ""cnts""<(SELECT MAX(""cnts"") FROM ""cte"") AND ""cnts"">(SELECT MIN(""cnts"") FROM ""cte"")"
308,"WITH ""cte1"" AS (SELECT ""activity"",RANK() OVER (ORDER BY ""num"") AS ""r"",RANK() OVER (ORDER BY ""num"" DESC) AS ""rd"" FROM (SELECT ""activity"",COUNT(""activity"") AS ""num"" FROM ""friends"" GROUP BY 1) AS ""cte"" ORDER BY 2 DESC) SELECT ""activity"" FROM ""cte1"" WHERE ""r""!=1 AND ""rd""!=1"
309,"WITH ""t1"" AS (SELECT ""a"".""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" AS ""a"" JOIN ""activities"" AS ""b"" ON ""a"".""activity""=""b"".""name"" GROUP BY 1) SELECT DISTINCT ""activity"" FROM ""t1"" WHERE ""cnt""<(SELECT MAX(""cnt"") FROM ""t1"") AND ""cnt"">(SELECT MIN(""cnt"") FROM ""t1"")"
310,"WITH ""cte"" AS (SELECT ""activity"",COUNT(""name"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cnt"" BETWEEN (SELECT MIN(""cnt"") FROM ""cte"")+1 AND (SELECT MAX(""cnt"") FROM ""cte"")-1"
311,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1) NOT IN (SELECT MIN(""counts"") FROM (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""t1"" UNION ALL SELECT MAX(""counts"") FROM (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""t2"")"
312,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1) NOT IN ((SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1),(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1))"
313,"WITH ""CTE"" AS (SELECT ""activity"",COUNT(1) AS ""counts"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""CTE"" WHERE ""counts"" NOT IN (SELECT MAX(""counts"") FROM ""cte"") AND ""counts"" NOT IN (SELECT MIN(""counts"") FROM ""cte"")"
314,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)<(SELECT COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY ""activity"" ORDER BY ""cnt"" DESC LIMIT 1) AND COUNT(1)>(SELECT COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY ""activity"" ORDER BY ""cnt"" LIMIT 1)"
315,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY 1), ""rank_all"" AS (SELECT ""activity"",RANK() OVER (ORDER BY ""cnt"" DESC) AS ""max_rnk"",RANK() OVER (ORDER BY ""cnt"") AS ""min_rnk"" FROM ""cte"") SELECT ""activity"" FROM ""rank_all"" WHERE ""max_rnk""!=1 AND ""min_rnk""!=1"
316,"SELECT DISTINCT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""id"")!=(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") LIMIT 1) AND COUNT(""id"")!=(SELECT COUNT(""id"") FROM ""Friends"" GROUP BY ""activity"" ORDER BY COUNT(""id"") DESC LIMIT 1)"
317,"WITH ""activity_count"" AS (SELECT ""a"".""name"",COUNT(1) AS ""cnt"" FROM ""ACTIVITIES"" AS ""a"" JOIN ""FRIENDS"" AS ""f"" ON ""a"".""name""=""f"".""activity"" GROUP BY ""a"".""name""), ""min_max_cnt"" AS (SELECT MIN(""cnt"") AS ""min_cnt"",MAX(""cnt"") AS ""max_cnt"" FROM ""activity_count"") SELECT ""name"" AS ""ACTIVITY"" FROM ""activity_count"" WHERE ""cnt"" NOT IN (SELECT ""min_cnt"" FROM ""min_max_cnt"" UNION SELECT ""max_cnt"" FROM ""min_max_cnt"")"
318,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""cntdesc"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""cntasc"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""cntdesc""!=1 AND ""cntasc""!=1"
319,"WITH ""activity_count"" AS (SELECT ""activity"",COUNT(""id"") AS ""participants"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""activity_count"" WHERE ""participants""!=(SELECT MAX(""participants"") FROM ""activity_count"") AND ""participants""!=(SELECT MIN(""participants"") FROM ""activity_count"")"
320,"WITH ""temp"" AS (SELECT ""activity"",COUNT(""id"") AS ""num_activity"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""num_activity"" NOT IN (SELECT MAX(""num_activity"") FROM ""temp"") AND ""num_activity"" NOT IN (SELECT MIN(""num_activity"") FROM ""temp"")"
321,"WITH ""tmp"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""tmp"" WHERE ""cnt"">(SELECT MIN(""cnt"") FROM ""tmp"") AND ""cnt""<(SELECT MAX(""cnt"") FROM ""tmp"")"
322,"WITH ""temp"" AS (SELECT ""activity"",COUNT(1) AS ""peoplecount"" FROM ""Friends"" GROUP BY ""activity""), ""temp2"" AS (SELECT ""temp"".""activity"",RANK() OVER (ORDER BY ""peoplecount"") AS ""ranka"",RANK() OVER (ORDER BY ""peoplecount"" DESC) AS ""rankb"" FROM ""temp"") SELECT ""temp2"".""activity"" FROM ""temp2"" WHERE ""ranka""!=1 AND ""rankb""!=1"
323,"WITH ""cte"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""activity"") DESC) AS ""rnk"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""cte"".""rnk""!=1 AND ""cte"".""rnk""!=(SELECT MAX(""rnk"") FROM ""cte"")"
324,"WITH ""max_min_table"" AS (SELECT MAX(""t"".""cnt"") AS ""max_cnt"",MIN(""t"".""cnt"") AS ""min_cnt"" FROM (SELECT ""activity"",COUNT(""name"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"") SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""name"")!=(SELECT ""max_cnt"" FROM ""max_min_table"") AND COUNT(""name"")!=(SELECT ""min_cnt"" FROM ""max_min_table"")"
325,"WITH ""temp"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(1)) AS ""rk"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""temp"" WHERE ""rk""!=(SELECT MAX(""rk"") FROM ""temp"") AND ""rk""!=(SELECT MIN(""rk"") FROM ""temp"")"
326,"SELECT ""activity"" FROM (SELECT ""f"".""activity"",COUNT(1) AS ""count"",MAX(COUNT(1)) OVER () AS ""max_count"",MIN(COUNT(1)) OVER () AS ""min_count"" FROM ""Friends"" AS ""f"" JOIN ""Activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""f"".""activity"") AS ""t"" WHERE ""count""!=""max_count"" AND ""count""!=""min_count"""
327,"WITH ""cte"" AS (SELECT ""fr"".""activity"",COUNT(""fr"".""name"") AS ""participant_cnt"" FROM ""friends"" AS ""fr"" GROUP BY ""fr"".""activity"") SELECT ""c"".""activity"" FROM ""cte"" AS ""c"" JOIN (SELECT MIN(""participant_cnt"") AS ""min_cnt"",MAX(""participant_cnt"") AS ""max_cnt"" FROM ""cte"") AS ""t"" WHERE (""c"".""participant_cnt"">""min_cnt"" AND ""c"".""participant_cnt""<""max_cnt"")"
328,"WITH ""CTE"" AS (SELECT ""f"".""activity"",COUNT(""f"".""name"") AS ""participant_cnt"" FROM ""Friends"" AS ""f"" GROUP BY ""f"".""activity"") SELECT ""c"".""activity"" FROM ""CTE"" AS ""c"" JOIN (SELECT MIN(""participant_cnt"") AS ""min_cnt"",MAX(""participant_cnt"") AS ""max_cnt"" FROM ""CTE"") AS ""t"" WHERE (""c"".""participant_cnt"">""min_cnt"" AND ""c"".""participant_cnt""<""max_cnt"")"
329,"WITH ""TEMP"" AS (SELECT ""ACTIVITY"",COUNT(""NAME"") AS ""NUM_PARTICIPANTS"" FROM ""FRIENDS"" GROUP BY ""ACTIVITY"") SELECT ""ACTIVITY"" FROM ""TEMP"" WHERE ""NUM_PARTICIPANTS"">(SELECT MIN(""NUM_PARTICIPANTS"") FROM ""TEMP"") AND ""NUM_PARTICIPANTS""<(SELECT MAX(""NUM_PARTICIPANTS"") FROM ""TEMP"")"
330,"SELECT DISTINCT ""activity"" FROM ""friends"" GROUP BY 1 HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1)"
331,"SELECT ""name"" AS ""activity"" FROM ""activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM (SELECT ""activity"",""num"",RANK() OVER (ORDER BY ""num"" DESC) AS ""num_rank"" FROM (SELECT ""activity"",COUNT(""activity"") AS ""num"" FROM ""friends"" GROUP BY ""activity"") AS ""t1"") AS ""t2"" WHERE ""num_rank""=1) AND ""name"" NOT IN (SELECT ""activity"" FROM (SELECT ""activity"",""num"",RANK() OVER (ORDER BY ""num"") AS ""num_rank"" FROM (SELECT ""activity"",COUNT(""activity"") AS ""num"" FROM ""friends"" GROUP BY ""activity"") AS ""t1"") AS ""t2"" WHERE ""num_rank""=1)"
332,"SELECT ""activity"" FROM (SELECT ""activity"",""cnt"",RANK() OVER (ORDER BY ""cnt"") AS ""rnk_asc"",RANK() OVER (ORDER BY ""cnt"" DESC) AS ""rnk_desc"" FROM (SELECT ""a"".""name"" AS ""activity"",COUNT(DISTINCT ""b"".""id"") AS ""cnt"" FROM ""activities"" AS ""a"" LEFT JOIN ""friends"" AS ""b"" ON ""a"".""name""=""b"".""activity"" GROUP BY 1) AS ""t"") AS ""t1"" WHERE ""rnk_asc""!=1 AND ""rnk_desc""!=1"
333,"WITH ""cnt"" AS (SELECT ""activity"",COUNT(1) AS ""times"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cnt"" WHERE ""times"" NOT IN (SELECT MAX(""times"") FROM ""cnt"") AND ""times"" NOT IN (SELECT MIN(""times"") FROM ""cnt"")"
334,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1)"
335,"SELECT ""x"".""activity"" FROM (SELECT ""activity"",SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END) AS ""freq"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END)) AS ""asc_rnk"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""activity"" IS NOT NULL THEN 1 ELSE 0 END) DESC) AS ""desc_rnk"" FROM ""friends"" GROUP BY ""activity"") AS ""x"" WHERE ""x"".""asc_rnk"">1 AND ""x"".""desc_rnk"">1"
336,"SELECT ""ACTIVITY"" FROM (SELECT ""A"".""name"" AS ""ACTIVITY"",COUNT(1) AS ""counter"" FROM ""Activities"" AS ""A"" JOIN ""Friends"" AS ""F"" ON ""A"".""name""=""F"".""activity"" GROUP BY ""A"".""id"",""A"".""name"" HAVING ""counter"" NOT IN (SELECT MAX(""counter"") FROM (SELECT COUNT(1) AS ""counter"" FROM ""Activities"" AS ""A"" JOIN ""Friends"" AS ""F"" ON ""A"".""name""=""F"".""activity"" GROUP BY ""A"".""id"",""A"".""name"") AS ""Temp"") AND ""counter"" NOT IN (SELECT MIN(""counter"") FROM (SELECT COUNT(1) AS ""counter"" FROM ""Activities"" AS ""A"" JOIN ""Friends"" AS ""F"" ON ""A"".""name""=""F"".""activity"" GROUP BY ""A"".""id"",""A"".""name"") AS ""Temp"")) AS ""Temp2"""
337,"WITH ""activity_cnt"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(""activity"")), ""max_min_cnt"" AS (SELECT MAX(""cnt"") AS ""max_a_cnt"",MIN(""cnt"") AS ""min_cnt"" FROM ""activity_cnt"") SELECT DISTINCT ""activity"" FROM ""activity_cnt"" WHERE ""cnt""!=(SELECT ""max_a_cnt"" FROM ""max_min_cnt"") AND ""cnt""!=(SELECT ""min_cnt"" FROM ""max_min_cnt"")"
338,"SELECT ""activity"" FROM (SELECT DISTINCT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""rnk_asc"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rnk_desc"" FROM ""friends"" GROUP BY ""activity"") AS ""a"" WHERE ""rnk_asc"">1 AND ""rnk_desc"">1"
339,"WITH ""part_num"" AS (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""num_participates"" FROM ""Friends"" AS ""f"" GROUP BY ""activity"") SELECT ""activity"" FROM ""part_num"" WHERE ""num_participates""!=(SELECT MAX(""num_participates"") FROM ""part_num"") AND ""num_participates""!=(SELECT MIN(""num_participates"") FROM ""part_num"")"
340,"SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""Friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
341,"WITH ""num_participants"" AS (SELECT ""activity"",COUNT(""name"") AS ""num_p"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(""name"")>(SELECT MIN(""num_p"") FROM ""num_participants"") AND COUNT(""name"")<(SELECT MAX(""num_p"") FROM ""num_participants"")"
342,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
343,"WITH ""cte_activity"" AS (SELECT ""activity"",COUNT(1) AS ""part_num"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte_activity"" WHERE ""part_num"">(SELECT MIN(""part_num"") FROM ""cte_activity"") AND ""part_num""<(SELECT MAX(""part_num"") FROM ""cte_activity"")"
344,"WITH ""t"" AS (SELECT ""activity"",RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rnk1"",RANK() OVER (ORDER BY COUNT(""id"")) AS ""rnk2"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""t"" WHERE ""rnk1""!=1 AND ""rnk2""!=1"
345,"WITH ""act_cnt"" AS (SELECT ""f"".""activity"",COUNT(""f"".""id"") AS ""cnt"" FROM ""Friends"" AS ""f"" RIGHT JOIN ""Activities"" AS ""a"" ON ""f"".""activity""=""a"".""name"" GROUP BY ""a"".""name"") SELECT ""activity"" FROM ""act_cnt"" WHERE ""cnt""!=(SELECT MAX(""cnt"") FROM ""act_cnt"") AND ""cnt""!=(SELECT MIN(""cnt"") FROM ""act_cnt"")"
346,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1)"
347,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
348,"SELECT ""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""cnt"",MAX(COUNT(1)) OVER () AS ""max_cnt"",MIN(COUNT(1)) OVER () AS ""min_cnt"" FROM ""friends"" GROUP BY ""activity"") AS ""t"" WHERE ""cnt""!=""max_cnt"" AND ""cnt""!=""min_cnt"""
349,"WITH ""temp"" AS (SELECT ""activity"",COUNT(""id"") AS ""t"" FROM ""friends"" GROUP BY 1) SELECT ""name"" AS ""activity"" FROM ""Activities"" WHERE ""name"" NOT IN (SELECT ""activity"" FROM ""temp"" WHERE ""t""=(SELECT MAX(""t"") FROM ""temp"") OR ""t""=(SELECT MIN(""t"") FROM ""temp""))"
350,"SELECT ""activity"" FROM (SELECT ""activity"",RANK() OVER (ORDER BY ""cnt"" DESC) AS ""rnk1"",RANK() OVER (ORDER BY ""cnt"") AS ""rnk2"" FROM (SELECT ""activity"",COUNT(DISTINCT ""id"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") AS ""a"") AS ""b"" WHERE ""rnk1""!=1 AND ""rnk2""!=1"
351,"WITH ""result"" AS (SELECT ""T1"".*,RANK() OVER (ORDER BY ""cnt"") AS ""DR"" FROM (SELECT ""activity"",COUNT(1) AS ""cnt"" FROM ""friends"" GROUP BY 1) AS ""T1"") SELECT ""activity"" FROM ""result"" WHERE ""DR""!=1 AND ""DR"" NOT IN (SELECT MAX(""DR"") FROM ""result"")"
352,"SELECT ""A"".""activity"" FROM (SELECT ""activity"",COUNT(1) AS ""num_friends"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"" JOIN (SELECT MIN(""num_friends"") AS ""min_count"",MAX(""num_friends"") AS ""max_count"" FROM (SELECT ""activity"",COUNT(1) AS ""num_friends"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"") AS ""B"" ON ""A"".""num_friends""!=""B"".""min_count"" AND ""A"".""num_friends""!=""B"".""max_count"""
353,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) DESC LIMIT 1) AND COUNT(1)!=(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY COUNT(1) LIMIT 1)"
354,"SELECT DISTINCT ""activity"" FROM ""Friends"" GROUP BY ""activity"" HAVING COUNT(DISTINCT ""id"") NOT IN (SELECT MAX(""counts"") FROM (SELECT COUNT(DISTINCT ""id"") AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""G"") AND COUNT(DISTINCT ""id"") NOT IN (SELECT MIN(""counts"") FROM (SELECT COUNT(DISTINCT ""id"") AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""G"")"
355,"SELECT ""u"".""activity"" FROM (SELECT ""t"".""activity"",""t"".""countactivity"",DENSE_RANK() OVER (ORDER BY ""t"".""countactivity"" DESC) AS ""rankdesc"",DENSE_RANK() OVER (ORDER BY ""t"".""countactivity"") AS ""rankasc"" FROM (SELECT ""activity"",COUNT(1) AS ""countactivity"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"") AS ""u"" WHERE ""u"".""rankdesc""!=1 AND ""u"".""rankasc""!=1"
356,"SELECT ""activity"" FROM ""friends"" GROUP BY ""activity"" HAVING COUNT(1)>(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 LIMIT 1) AND COUNT(1)<(SELECT COUNT(1) FROM ""friends"" GROUP BY ""activity"" ORDER BY 1 DESC LIMIT 1)"
357,"WITH ""cntact"" AS (SELECT ""activity"",COUNT(""activity"") AS ""cnt"" FROM ""Friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cntact"" WHERE ""cnt"" NOT IN ((SELECT MAX(""cnt"") FROM ""cntact""),(SELECT MIN(""cnt"") FROM ""cntact""))"
358,"SELECT ""t"".""activity"" FROM (SELECT ""activity"",MAX(COUNT(""id"")) OVER () AS ""maxn"",MIN(COUNT(""id"")) OVER () AS ""minn"",COUNT(""id"") AS ""co"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""t"".""co""!=""t"".""maxn"" AND ""t"".""co""!=""t"".""minn"""
359,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""rnk"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""rnk""!=1 AND ""rnk_desc""!=1"
360,"WITH ""cte"" AS (SELECT ""activity"",COUNT(1) AS ""num"" FROM ""friends"" GROUP BY ""activity"") SELECT ""activity"" FROM ""cte"" WHERE ""num"" NOT IN ((SELECT MAX(""num"") FROM ""cte""),(SELECT MIN(""num"") FROM ""cte""))"
361,"SELECT ""activity"" FROM (SELECT *,RANK() OVER (ORDER BY ""counts"" DESC) AS ""row_num_desc"",RANK() OVER (ORDER BY ""counts"") AS ""row_num"" FROM (SELECT ""activity"",COUNT(""name"") AS ""counts"" FROM ""Friends"" GROUP BY ""activity"") AS ""A"") AS ""B"" WHERE ""row_num""!=1 AND ""row_num_desc""!=1"
362,"SELECT ""activity"" FROM (SELECT ""activity"",DENSE_RANK() OVER (ORDER BY COUNT(""id"")) AS ""rnk"",DENSE_RANK() OVER (ORDER BY COUNT(""id"") DESC) AS ""rnk_desc"" FROM ""Friends"" GROUP BY ""activity"") AS ""t"" WHERE ""rnk""!=1 AND ""rnk_desc""!=1"
