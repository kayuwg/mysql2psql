id,original query
1,"WITH ""table1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" WHERE ""u"".""user_id"" IN (SELECT DISTINCT ""a"".""user_id"" FROM (""table1"" AS ""a"" JOIN ""table1"" AS ""b"" ON ""a"".""contest_id""+1=""b"".""contest_id"" AND ""a"".""user_id""=""b"".""user_id"") JOIN ""table1"" AS ""c"" ON ""a"".""contest_id""+2=""c"".""contest_id"" AND ""a"".""user_id""=""c"".""user_id"") OR ""u"".""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3)"
2,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) AS ""a"" LEFT JOIN ""users"" USING (""user_id"")"
3,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" JOIN (SELECT DISTINCT ""C1"".""user_id"" FROM (""cte"" AS ""C1"" LEFT JOIN ""cte"" AS ""C2"" ON ""C1"".""contest_id""=""C2"".""contest_id""+1) LEFT JOIN ""cte"" AS ""C3"" ON ""C1"".""contest_id""=""C3"".""contest_id""-1 WHERE ""C1"".""user_id""=""C2"".""user_id"" AND ""C1"".""user_id""=""C3"".""user_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""T"" USING (""user_id"")"
4,"WITH ""temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""temp1"" AS (SELECT DISTINCT ""t1"".""medal"" AS ""id"" FROM ((""temp"" AS ""t1"") CROSS JOIN ""temp"" AS ""t2"") CROSS JOIN ""temp"" AS ""t3"" WHERE ""t1"".""contest_id""=""t2"".""contest_id""-1 AND ""t1"".""contest_id""=""t3"".""contest_id""-2 AND ""t1"".""medal""=""t2"".""medal"" AND ""t2"".""medal""=""t3"".""medal""), ""temp3"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN (SELECT ""id"" FROM ""temp1"" UNION SELECT ""id"" FROM ""temp3"") AS ""a"" ON ""u"".""user_id""=""a"".""id"""
5,"WITH ""T"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""T2"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""T"" AS ""a"") CROSS JOIN ""T"" AS ""b"") CROSS JOIN ""T"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""T3"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""T4"" AS (SELECT ""user_id"" FROM ""T2"" UNION SELECT ""user_id"" FROM ""T3"") SELECT ""Users"".""name"",""Users"".""mail"" FROM ""T4"" LEFT JOIN ""Users"" ON ""T4"".""user_id""=""Users"".""user_id"""
6,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
7,"WITH ""medals"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""row_num"" FROM ""medals""), ""candidates"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""row_num"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""candidates"" AS ""c"" ON ""u"".""user_id""=""c"".""user_id"""
8,"SELECT DISTINCT ""mail"",""name"" FROM ((SELECT ""id"" FROM (SELECT ""contest_id"",""id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""previous_2"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests"") AS ""a"") AS ""b"" WHERE ""contest_id""-""previous_2""=2) UNION (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3)) AS ""t"" JOIN ""Users"" AS ""u"" ON ""t"".""id""=""u"".""user_id"""
9,"WITH ""cte"" AS (SELECT ""C1"".""contest_id"",""C1"".""gold_medal"" AS ""all_medal"" FROM ""Contests"" AS ""C1"" UNION ALL SELECT ""C2"".""contest_id"",""C2"".""silver_medal"" FROM ""Contests"" AS ""C2"" UNION ALL SELECT ""C3"".""contest_id"",""C3"".""bronze_medal"" FROM ""Contests"" AS ""C3"") SELECT DISTINCT ""U"".""name"",""U"".""mail"" FROM ""Users"" AS ""U"" JOIN (SELECT DISTINCT ""cte1"".""all_medal"" FROM (""cte"" AS ""cte1"" JOIN ""cte"" AS ""cte2"" ON ""cte1"".""contest_id""+1=""cte2"".""contest_id"") JOIN ""cte"" AS ""cte3"" ON ""cte1"".""contest_id""+2=""cte3"".""contest_id"" WHERE ""cte1"".""all_medal""=""cte2"".""all_medal"" AND ""cte1"".""all_medal""=""cte3"".""all_medal"" UNION ALL SELECT ""C"".""gold_medal"" FROM ""Contests"" AS ""C"" GROUP BY ""C"".""gold_medal"" HAVING COUNT(DISTINCT ""C"".""contest_id"")>=3) AS ""t"" ON ""t"".""all_medal""=""U"".""user_id"""
10,"WITH ""T1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold_medal' AS ""result"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver_medal' AS ""result"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze_medal' AS ""result"" FROM ""Contests""), ""T2"" AS (SELECT DISTINCT ""s1"".""user_id"" FROM ((""T1"" AS ""s1"") CROSS JOIN ""T1"" AS ""s2"") CROSS JOIN ""T1"" AS ""s3"" WHERE ""s1"".""user_id""=""s2"".""user_id"" AND ""s1"".""contest_id""+1=""s2"".""contest_id"" AND ""s2"".""user_id""=""s3"".""user_id"" AND ""s2"".""contest_id""+1=""s3"".""contest_id"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2) OR ""user_id"" IN (SELECT ""user_id"" FROM ""T2"")"
11,"WITH ""three_golds"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""three_consecutive_a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""three_consecutive_b"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""row_num"" FROM ""three_consecutive_a""), ""three_consecutive"" AS (SELECT DISTINCT ""user_id"" FROM ""three_consecutive_b"" GROUP BY ""user_id"",""contest_id""-""row_num"" HAVING COUNT(""user_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""three_golds"" UNION ALL SELECT ""user_id"" FROM ""three_consecutive"")"
12,"WITH ""tmp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"") SELECT ""name"",""mail"" FROM (SELECT DISTINCT ""a"".""medal"" FROM ((""tmp"" AS ""a"") CROSS JOIN ""tmp"" AS ""b"") CROSS JOIN ""tmp"" AS ""c"" WHERE ""b"".""contest_id""=""a"".""contest_id""+1 AND ""c"".""contest_id""=""b"".""contest_id""+1 AND ""a"".""medal""=""b"".""medal"" AND ""b"".""medal""=""c"".""medal"" UNION SELECT DISTINCT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""d"" JOIN ""Users"" ON ""d"".""medal""=""Users"".""user_id"""
13,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
14,"WITH ""uniontbl"" AS (SELECT ""contest_id"",""gold_medal"" AS ""userid"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""userid"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""userid"" FROM ""contests""), ""ordertbl"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""userid"" ORDER BY ""contest_id"") AS ""rn"" FROM ""uniontbl"" ORDER BY ""userid"",""contest_id""), ""anymedal"" AS (SELECT DISTINCT ""userid"" FROM (SELECT *,""contest_id""-""rn"" AS ""diff"" FROM ""ordertbl"") AS ""temp"" GROUP BY ""userid"",""diff"" HAVING COUNT(1)>=3), ""goldmedal"" AS (SELECT ""gold_medal"" AS ""userid_gold"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""anymedal"" AS ""a"" ON ""u"".""user_id""=""a"".""userid"" UNION SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""goldmedal"" AS ""g"" ON ""u"".""user_id""=""g"".""userid_gold"""
15,"WITH ""res_temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""A"".""user_id"" FROM (""res_temp"" AS ""A"" JOIN ""res_temp"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" AND ""A"".""contest_id""+1=""B"".""contest_id"") JOIN ""res_temp"" AS ""C"" ON ""B"".""user_id""=""C"".""user_id"" AND ""B"".""contest_id""+1=""C"".""contest_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) AS ""a"" LEFT JOIN ""Users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"""
16,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3), ""all_record"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""qualified_ids"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""contest_id"",""user_id"",COUNT(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cnt"" FROM ""all_record"" ORDER BY 1) AS ""a"" WHERE ""a"".""cnt""=3 UNION SELECT ""user_id"" FROM ""gold"") SELECT ""name"",""mail"" FROM ""Users"" JOIN ""qualified_ids"" USING (""user_id"")"
17,"SELECT ""name"",""mail"" FROM (SELECT DISTINCT (""c1"".""medal"") FROM ((SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"") AS ""c1"" CROSS, (SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"") AS ""c2"") CROSS JOIN (SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"") AS ""c3"" WHERE ROW(""c1"".""contest_id"",""c1"".""medal"")=ROW(""c2"".""contest_id""-1,""c2"".""medal"") AND ROW(""c1"".""contest_id"",""c1"".""medal"")=ROW(""c3"".""contest_id""-2,""c3"".""medal"") UNION SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>2) AS ""a1"" JOIN ""users"" AS ""u"" ON ""a1"".""medal""=""u"".""user_id"""
18,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) OR ""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM (""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""cte"" AS ""c3"" ON ""c1"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""+2=""c3"".""contest_id"")"
19,"SELECT DISTINCT ""E"".""name"",""E"".""mail"" FROM (SELECT ""V"".""name"",""V"".""mail"" FROM (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""D"" LEFT JOIN ""Users"" AS ""V"" ON ""D"".""gold_medal""=""V"".""user_id"" UNION ALL SELECT ""U"".""name"",""U"".""mail"" FROM (SELECT DISTINCT ""B"".""participant"" FROM (SELECT ""A"".""participant"",""A"".""contest_id"",""A"".""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""A"".""participant"" ORDER BY ""A"".""contest_id"") AS ""ranking"" FROM (SELECT ""gold_medal"" AS ""participant"",""contest_id"",'gold' AS ""award"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""participant"",""contest_id"",'silver' AS ""award"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""participant"",""contest_id"",'bronze' AS ""award"" FROM ""Contests"") AS ""A"") AS ""B"" GROUP BY ""B"".""participant"",""B"".""ranking"" HAVING COUNT(""B"".""contest_id"")>=3) AS ""C"" LEFT JOIN ""Users"" AS ""U"" ON ""C"".""participant""=""U"".""user_id"") AS ""E"""
20,"WITH ""three_plus_gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""all_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""rn"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""all_medal""), ""three_consecutive"" AS (SELECT ""user_id"",""contest_id""-""rn"",COUNT(1) FROM ""rn"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(1)>=3), ""selected"" AS (SELECT ""user_id"" FROM ""three_plus_gold"" UNION SELECT ""user_id"" FROM ""three_consecutive"") SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""selected"" AS ""s"" ON ""s"".""user_id""=""u"".""user_id"""
21,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT DISTINCT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM (SELECT ""medal"" AS ""user_id"" FROM ""case1"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""case2"") AS ""A"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""A"".""user_id"""
22,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
23,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""r"" FROM (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"") AS ""a"") AS ""b"" GROUP BY ""user_id"",(""contest_id""-""r"") HAVING COUNT(""contest_id""-""r"")>=3)"
24,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""contestant"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""contestant"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""contestant"" FROM ""contests""), ""t2"" AS (SELECT DISTINCT ""a"".""contestant"" FROM (""t"" AS ""a"" JOIN ""t"" AS ""b"" ON ""a"".""contest_id""+1=""b"".""contest_id"" AND ""a"".""contestant""=""b"".""contestant"") JOIN ""t"" AS ""c"" ON ""b"".""contest_id""+1=""c"".""contest_id"" AND ""b"".""contestant""=""c"".""contestant""), ""t3"" AS (SELECT DISTINCT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3), ""t4"" AS (SELECT * FROM ""t2"" UNION SELECT * FROM ""t3"") SELECT ""u"".""name"",""u"".""mail"" FROM ""t4"" JOIN ""users"" AS ""u"" ON ""t4"".""contestant""=""u"".""user_id"""
25,"WITH ""winner_id"" AS (SELECT ""contest_id"",""gold_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""win_id"" FROM ""Contests""), ""three_win"" AS (SELECT DISTINCT ""sub"".""win_id"" FROM (SELECT ""w1"".""contest_id"",""w1"".""win_id"",""w2"".""win_id"" AS ""win_id2"",""w3"".""win_id"" AS ""win_id3"" FROM (""winner_id"" AS ""w1"" JOIN ""winner_id"" AS ""w2"" ON ""w1"".""contest_id""+1=""w2"".""contest_id"" AND ""w1"".""win_id""=""w2"".""win_id"") JOIN ""winner_id"" AS ""w3"" ON ""w2"".""contest_id""+1=""w3"".""contest_id"" AND ""w2"".""win_id""=""w3"".""win_id"") AS ""sub"" UNION ALL SELECT DISTINCT ""gold_medal"" AS ""gold_win_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""three_win"" AS ""t"" ON ""u"".""user_id""=""t"".""win_id"""
26,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"" ORDER BY 2,1), ""b"" AS (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"") OVER (PARTITION BY ""user_id"") AS ""second"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"") AS ""third"" FROM ""a""), ""c"" AS (SELECT DISTINCT ""user_id"" FROM ""b"" WHERE ""contest_id""=""second""-1 AND ""second""=""third""-1 UNION SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""c"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""user_id"""
27,"WITH ""cte"" AS ((SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"")) SELECT ""u"".""name"",""u"".""mail"" FROM ((SELECT ""c1"".""medal"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""contest_id""<""c2"".""contest_id""+3 AND ""c1"".""contest_id"">=""c2"".""contest_id"" AND ""c1"".""medal""=""c2"".""medal"" GROUP BY ""c1"".""medal"",""c1"".""contest_id"" HAVING COUNT(DISTINCT ""c2"".""contest_id"")>=3) UNION (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3)) AS ""a"" JOIN ""Users"" AS ""u"" ON ""a"".""medal""=""u"".""user_id"""
28,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""cte1"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(1)>=3), ""cte2"" AS (SELECT ""user_id"" FROM (SELECT ""user_id"",(""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""diff"" FROM ""cte"") AS ""a"" GROUP BY ""user_id"",""diff"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""cte1"" UNION SELECT * FROM ""cte2"")"
29,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests"" ORDER BY ""id"",""contest_id""), ""cte2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING (COUNT(1))>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""t1"".""id"" FROM (""cte1"" AS ""t1"" JOIN ""cte1"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""contest_id""=""t2"".""contest_id""-1) JOIN ""cte1"" AS ""t3"" ON ""t2"".""id""=""t3"".""id"" AND ""t2"".""contest_id""=""t3"".""contest_id""-1 UNION SELECT * FROM ""cte2"") AS ""m"" LEFT JOIN ""Users"" AS ""u"" ON ""m"".""id""=""u"".""user_id"""
30,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"" ORDER BY ""contest_id""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE ROW(""contest_id"",""user_id"") IN (SELECT ""contest_id""-1,""user_id"" FROM ""t2"") AND ROW(""contest_id"",""user_id"") IN (SELECT ""contest_id""+1,""user_id"" FROM ""t2"")) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
31,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests""), ""cte"" AS (SELECT DISTINCT ""t1"".""id"" FROM ((""t"" AS ""t1"") CROSS JOIN ""t"" AS ""t2"") CROSS JOIN ""t"" AS ""t3"" WHERE ""t1"".""contest_id""=""t2"".""contest_id""-1 AND ""t1"".""contest_id""=""t3"".""contest_id""-2 AND ""t1"".""id""=""t2"".""id"" AND ""t1"".""id""=""t3"".""id"" UNION SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""cte"")"
32,"WITH ""c1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""melted"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""c2"" AS (SELECT ""u1"".""user_id"" FROM ((""melted"" AS ""u1"") CROSS JOIN ""melted"" AS ""u2"") CROSS JOIN ""melted"" AS ""u3"" WHERE ""u1"".""contest_id""=""u2"".""contest_id""-1 AND ""u2"".""contest_id""=""u3"".""contest_id""-1 AND ""u1"".""user_id""=""u2"".""user_id"" AND ""u2"".""user_id""=""u3"".""user_id""), ""both_conditions"" AS (SELECT ""user_id"" FROM ""c1"" UNION SELECT ""user_id"" FROM ""c2"") SELECT ""u"".""name"",""u"".""mail"" FROM ""both_conditions"" AS ""b"" JOIN ""Users"" AS ""u"" ON ""b"".""user_id""=""u"".""user_id"""
33,"WITH ""G"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""C"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""R"" AS (SELECT DISTINCT ""C1"".""user_id"" FROM (""C"" AS ""C1"" JOIN ""C"" AS ""C2"" ON ""C1"".""user_id""=""C2"".""user_id"" AND ""C2"".""contest_id""=""C1"".""contest_id""+1) JOIN ""C"" AS ""C3"" ON ""C2"".""user_id""=""C3"".""user_id"" AND ""C3"".""contest_id""=""C2"".""contest_id""+1 UNION SELECT * FROM ""G"") SELECT ""U"".""name"",""U"".""mail"" FROM ""R"" JOIN ""Users"" AS ""U"" USING (""user_id"")"
34,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
35,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
36,"WITH ""winner_id"" AS (SELECT ""contest_id"",""gold_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""win_id"" FROM ""Contests""), ""three_win"" AS (SELECT DISTINCT ""sub"".""win_id"" FROM (SELECT ""w1"".""contest_id"",""w1"".""win_id"",""w2"".""win_id"" AS ""win_id2"",""w3"".""win_id"" AS ""win_id3"" FROM (""winner_id"" AS ""w1"" JOIN ""winner_id"" AS ""w2"" ON ""w1"".""contest_id""+1=""w2"".""contest_id"" AND ""w1"".""win_id""=""w2"".""win_id"") JOIN ""winner_id"" AS ""w3"" ON ""w2"".""contest_id""+1=""w3"".""contest_id"" AND ""w2"".""win_id""=""w3"".""win_id"") AS ""sub"" UNION ALL SELECT DISTINCT ""gold_medal"" AS ""gold_win_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""three_win"" AS ""t"" ON ""u"".""user_id""=""t"".""win_id"""
37,"WITH ""cte"" AS ((SELECT ""contest_id"",""gold_medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""silver_medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"")) SELECT ""u"".""name"",""u"".""mail"" FROM ((SELECT DISTINCT ""c2"".""gold_medal"" AS ""user_id"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c2"".""contest_id""<=""c1"".""contest_id"" AND ""c1"".""contest_id""<""c2"".""contest_id""+3 AND ""c1"".""gold_medal""=""c2"".""gold_medal"" GROUP BY ""c1"".""contest_id"",""c1"".""gold_medal"" HAVING COUNT(DISTINCT ""c2"".""contest_id"")>=3) UNION (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3)) AS ""a"" JOIN ""Users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"""
38,"SELECT ""name"",""mail"" FROM (""Users"") CROSS JOIN ""Contests"" WHERE ""user_id""=""gold_medal"" GROUP BY ""name"",""mail"" HAVING COUNT(""gold_medal"")>=3 UNION (WITH ""cs"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user"" FROM ""Contests"") SELECT ""name"",""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""cs"" AS ""a"") CROSS JOIN ""cs"" AS ""b"") CROSS JOIN ""cs"" AS ""c"" WHERE ""a"".""user""=""b"".""user"" AND ""b"".""user""=""c"".""user"" AND ""a"".""contest_id""=""b"".""contest_id""-1 AND ""b"".""contest_id""=""c"".""contest_id""-1 AND ""u"".""user_id""=""a"".""user"")"
39,"WITH ""CTE"" AS (SELECT ""a"".""contest_id"",""u"".""name"",""u"".""mail"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""a"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""a"".""user_id"") SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""contest_id"") AS ""grp"" FROM ""cte"") AS ""c"" GROUP BY ""name"",""mail"",""grp"" HAVING COUNT(1)>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""name"",""u"".""mail"" HAVING COUNT(1)>=3"
40,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte2"" AS (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte1"" AS ""c1"") CROSS JOIN ""cte1"" AS ""c2"") CROSS JOIN ""cte1"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2) UNION SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""cte2"")"
41,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""winner"",""grp"",COUNT(1) AS ""consecutive_medals"" FROM (SELECT ""contest_id"",""winner"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""grp"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""winner"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests"") AS ""a"" ORDER BY ""winner"",""contest_id"") AS ""b"" GROUP BY ""winner"",""grp"") AS ""c"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""c"".""winner"" WHERE ""c"".""consecutive_medals"">=3 UNION ALL SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""gold_medal"" AS ""winner"",COUNT(1) AS ""gold"" FROM ""contests"" AS ""c"" GROUP BY ""gold_medal"") AS ""c"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""c"".""winner"" WHERE ""gold"">=3) AS ""w"""
42,"WITH ""selected_users"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>2 UNION SELECT ""c1"".""gold_medal"" AS ""user_id"" FROM (""Contests"" AS ""c1"" JOIN ""Contests"" AS ""c2"" ON (""c1"".""contest_id""+1=""c2"".""contest_id"")) JOIN ""Contests"" AS ""c3"" ON (""c2"".""contest_id""+1=""c3"".""contest_id"") WHERE ""c1"".""gold_medal"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""c1"".""gold_medal"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") UNION SELECT ""c1"".""silver_medal"" AS ""user_id"" FROM (""Contests"" AS ""c1"" JOIN ""Contests"" AS ""c2"" ON (""c1"".""contest_id""+1=""c2"".""contest_id"")) JOIN ""Contests"" AS ""c3"" ON (""c2"".""contest_id""+1=""c3"".""contest_id"") WHERE ""c1"".""silver_medal"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""c1"".""silver_medal"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") UNION SELECT ""c1"".""bronze_medal"" AS ""user_id"" FROM (""Contests"" AS ""c1"" JOIN ""Contests"" AS ""c2"" ON (""c1"".""contest_id""+1=""c2"".""contest_id"")) JOIN ""Contests"" AS ""c3"" ON (""c2"".""contest_id""+1=""c3"".""contest_id"") WHERE ""c1"".""bronze_medal"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""c1"".""bronze_medal"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"")) SELECT ""r"".""name"",""r"".""mail"" FROM ""Users"" AS ""r"" JOIN ""selected_users"" ON (""r"".""user_id""=""selected_users"".""user_id"")"
43,"WITH ""cte_unstack"" AS (SELECT ""contest_id"",CASE WHEN ""place""='1' THEN ""gold_medal"" WHEN ""place""='2' THEN ""silver_medal"" WHEN ""place""='3' THEN ""bronze_medal"" END AS ""medalist_id"" FROM ""Contests"" CROSS JOIN (SELECT '1' AS ""place"" UNION ALL SELECT '2' AS ""place"" UNION ALL SELECT '3' AS ""place"") AS ""places""), ""cte_3x_consec_medalists"" AS (SELECT ""medalist_id"",""contest_id"" AS ""idx_0"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""medalist_id"" ORDER BY ""contest_id"") AS ""idx_1"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""medalist_id"" ORDER BY ""contest_id"") AS ""idx_2"" FROM ""cte_unstack""), ""cte_interview_candidates"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3 UNION SELECT ""medalist_id"" AS ""user_id"" FROM ""cte_3x_consec_medalists"" WHERE ""idx_2""-""idx_1""=1 AND ""idx_1""-""idx_0""=1), ""cte_final"" AS (SELECT ""u"".""name"",""u"".""mail"" FROM ""cte_interview_candidates"" AS ""cand"" JOIN ""Users"" AS ""u"" ON ""cand"".""user_id""=""u"".""user_id"") SELECT * FROM ""cte_final"""
44,"WITH ""medal_tab"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""Contests"") SELECT ""u"".""name"" AS ""name"",""u"".""mail"" AS ""mail"" FROM (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3 UNION SELECT DISTINCT (""t2"".""user_id"") AS ""user_id"" FROM (SELECT ""t1"".""user_id"" AS ""user_id"",""t1"".""diff"" AS ""diff"",COUNT(""t1"".""contest_id"") AS ""consec_num"" FROM (SELECT ""user_id"",""medal"",""contest_id"",(""contest_id""-RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""diff"" FROM ""medal_tab"") AS ""t1"" GROUP BY 1,2 HAVING COUNT(""t1"".""contest_id"")>=3) AS ""t2"") AS ""t3"" LEFT JOIN ""Users"" AS ""u"" ON ""t3"".""user_id""=""u"".""user_id"""
45,"WITH ""win_3_medal"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""win_3_consecutive"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests""), ""tmp"" AS (SELECT ""w1"".""id"" FROM (""win_3_consecutive"" AS ""w1"" CROSS JOIN ""win_3_consecutive"" AS ""w2"") JOIN ""win_3_consecutive"" AS ""w3"" ON ""w1"".""contest_id""=""w2"".""contest_id""-1 AND ""w2"".""contest_id""=""w3"".""contest_id""-1 WHERE ""w1"".""id""=""w2"".""id"" AND ""w2"".""id""=""w3"".""id"" AND ""w1"".""id""=""w3"".""id""), ""tmp1"" AS (SELECT ""id"" FROM ""win_3_medal"" UNION SELECT ""id"" FROM ""tmp"") SELECT ""users"".""name"",""users"".""mail"" FROM ""tmp1"" LEFT JOIN ""users"" ON ""tmp1"".""id""=""users"".""user_id"""
46,"WITH ""tb1"" AS (SELECT ""Contest_id"",""gold_medal"" FROM ""Contests"" UNION ALL SELECT ""Contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""Contest_id"",""bronze_medal"" FROM ""Contests"") SELECT ""name"",""mail"" FROM (SELECT DISTINCT ""a"".""gold_medal"" FROM ((""tb1"" AS ""a"") CROSS JOIN ""tb1"" AS ""b"") CROSS JOIN ""tb1"" AS ""c"" WHERE ""a"".""Contest_id""+1=""b"".""Contest_id"" AND ""a"".""Contest_id""+2=""c"".""Contest_id"" AND ""a"".""gold_medal""=""b"".""gold_medal"" AND ""b"".""gold_medal""=""c"".""gold_medal"" UNION SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""tb2"" CROSS, ""users"" WHERE ""users"".""user_id""=""tb2"".""gold_medal"""
47,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner"",'gold' AS ""position"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"",'silver' FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"",'bronze' FROM ""Contests""), ""cte_2"" AS (SELECT ""winner"",SUM(CASE WHEN ""position""='gold' THEN 1 ELSE 0 END) AS ""sum"" FROM ""cte"" GROUP BY ""winner"" HAVING ""sum"">=3 UNION SELECT ""A"".""winner"",'sum' FROM (""cte"" AS ""A"" JOIN ""cte"" AS ""B"" ON ""A"".""winner""=""B"".""winner"" AND ""A"".""contest_id""+1=""B"".""contest_id"") JOIN ""cte"" AS ""C"" ON ""A"".""winner""=""C"".""winner"" AND ""A"".""contest_id""+2=""C"".""contest_id"") SELECT DISTINCT ""name"",""mail"" FROM ""cte_2"" AS ""A"" JOIN ""users"" AS ""B"" ON ""A"".""winner""=""B"".""user_id"""
48,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte2"" AS (SELECT DISTINCT ""t1"".""user_id"" FROM ((""cte"" AS ""t1"") CROSS JOIN ""cte"" AS ""t2"") CROSS JOIN ""cte"" AS ""t3"" WHERE ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""user_id""=""t3"".""user_id"" AND ""t1"".""contest_id""=""t2"".""contest_id""+1 AND ""t2"".""contest_id""=""t3"".""contest_id""+1 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM ""cte2"")"
49,"WITH ""t"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""t0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""t0""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" GROUP BY ""user_id"",""contest_id""-""rnk"" HAVING COUNT(1)>=3 UNION ALL SELECT ""user_id"" FROM ""t"") SELECT DISTINCT ""name"",""mail"" FROM ""t2"" JOIN ""Users"" USING (""user_id"")"
50,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""t3"" AS (SELECT ""user_id"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_count"" FROM ""t2"") SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" WHERE ""u"".""User_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""u"".""User_id"" IN (SELECT ""user_id"" FROM ""t3"" WHERE ""t3"".""contest_id""=2+""lag_count"")"
51,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""c"".""user_id"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""user_id""=""b"".""user_id"") JOIN ""cte"" AS ""c"" ON ""b"".""contest_id""=""c"".""contest_id""-1 AND ""b"".""user_id""=""c"".""user_id"") OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3)"
52,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"",'gold' AS ""type"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"",'silver' AS ""type"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"",'bronze' AS ""type"" FROM ""Contests"") SELECT ""name"",""mail"" FROM (SELECT DISTINCT ""a1"".""medal"" AS ""user_id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""contest_id""=""a2"".""contest_id""-1 AND ""a2"".""contest_id""=""a3"".""contest_id""-1 AND ""a1"".""medal""=""a2"".""medal"" AND ""a2"".""medal""=""a3"".""medal"" UNION SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) AS ""b"" CROSS, ""Users"" AS ""u"" WHERE ""u"".""user_id""=""b"".""user_id"""
53,"WITH ""temp1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""uid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""uid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""uid"" FROM ""Contests""), ""temp2"" AS (SELECT ""uid"",""temp1"".""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""uid"" ORDER BY ""temp1"".""contest_id"") AS ""rn"" FROM ""temp1""), ""temp3"" AS (SELECT ""uid"" AS ""user_id"" FROM ""temp2"" GROUP BY ""uid"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""mail"" FROM ""temp3"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""temp3"".""user_id"""
54,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
55,"WITH ""md"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""temp"" AS (SELECT ""medal"",""contest_id"",RANK() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""mrk"" FROM ""md"" ORDER BY ""medal"",""mrk"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""medal"" FROM ""temp"" GROUP BY ""medal"",""contest_id""-""mrk"" HAVING COUNT(1)>=3)"
56,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
57,"WITH ""CTE"" AS (SELECT ""gold_medal"" AS ""medal"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""medal"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""medal"",""contest_id"" FROM ""Contests""), ""CTE2"" AS (SELECT ""medal"",""contest_id"",COALESCE(LAG(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id""), 0) AS ""lagresult"" FROM ""CTE""), ""CTE3"" AS (SELECT DISTINCT ""A"".""medal"" FROM ((SELECT DISTINCT ""medal"" FROM ""CTE2"" WHERE ""contest_id""-""lagresult""='2') UNION ALL (SELECT ""gold_medal"" AS ""medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""medal"")>=3)) AS ""A"") SELECT ""U"".""name"",""U"".""mail"" FROM ""Users"" AS ""U"" RIGHT JOIN ""Cte3"" AS ""C"" ON ""U"".""user_id""=""C"".""medal"""
58,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
59,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
60,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte2"" AS (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte1"" AS ""c1"") CROSS JOIN ""cte1"" AS ""c2"") CROSS JOIN ""cte1"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2) UNION SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""cte2"")"
61,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""t2"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t3"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t2""), ""t4"" AS (SELECT ""user"" FROM ""t3"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3), ""t5"" AS (SELECT ""t1"".""gold_medal"" AS ""user_id"" FROM ""t1"" UNION SELECT ""t4"".""user"" FROM ""t4"") SELECT ""u"".""name"" AS ""name"",""u"".""mail"" AS ""mail"" FROM ""t5"" JOIN ""users"" AS ""u"" ON ""t5"".""user_id""=""u"".""user_id"""
62,"SELECT ""t2"".""name"",""t2"".""mail"" FROM (SELECT DISTINCT ""userid"" FROM (SELECT ""userid"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""userid"" ORDER BY ""contest_id"") AS ""lead3"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""userid"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""userid"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""userid"" FROM ""contests"") AS ""a"") AS ""b"" WHERE ""lead3"" IS NOT NULL AND ""lead3""-""contest_id""=2 UNION SELECT DISTINCT ""userid"" FROM (SELECT ""gold_medal"" AS ""userid"",COUNT(1) FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""a"") AS ""t1"" CROSS, ""users"" AS ""t2"" WHERE ""t1"".""userid""=""t2"".""user_id"""
63,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
64,"WITH ""cte"" AS (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""t"") SELECT DISTINCT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) OR ""user_id"" IN (SELECT ""user_id"" FROM ""cte"" GROUP BY ""user_id"",(""contest_id""-""rnk"") HAVING COUNT(1)>=3)"
65,"WITH ""T1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""T2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"" ORDER BY ""contest_id""), ""T3"" AS (SELECT ""contest_id"",""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""series_id"" FROM ""T2""), ""T4"" AS (SELECT ""contest_id"",""user_id"" FROM ""T3"" WHERE ROW(""user_id"",""series_id"") IN (SELECT ""user_id"",""series_id"" FROM ""T3"" GROUP BY ""user_id"",""series_id"" HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""T1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""T4"")"
66,"WITH ""cte"" AS ((SELECT ""contest_id"",""gold_medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""silver_medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"")) SELECT ""u"".""name"",""u"".""mail"" FROM ((SELECT DISTINCT ""c2"".""gold_medal"" AS ""user_id"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c2"".""contest_id""<=""c1"".""contest_id"" AND ""c1"".""contest_id""<""c2"".""contest_id""+3 AND ""c1"".""gold_medal""=""c2"".""gold_medal"" GROUP BY ""c1"".""contest_id"",""c1"".""gold_medal"" HAVING COUNT(DISTINCT ""c2"".""contest_id"")>=3) UNION (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3)) AS ""a"" JOIN ""Users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"""
67,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""winner"",""grp"",COUNT(1) AS ""consecutive_medals"" FROM (SELECT ""contest_id"",""winner"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""grp"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""winner"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests"") AS ""a"") AS ""b"" GROUP BY ""winner"",""grp"") AS ""c"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""c"".""winner"" WHERE ""c"".""consecutive_medals"">=3 UNION ALL SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""gold_medal"" AS ""winner"",COUNT(1) AS ""gold"" FROM ""contests"" AS ""c"" GROUP BY ""gold_medal"") AS ""c"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""c"".""winner"" WHERE ""gold"">=3) AS ""w"""
68,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests"" ORDER BY ""user_id"",""contest_id"") SELECT DISTINCT ""mail"",""name"" FROM ""users"" AS ""u"" JOIN ""cte"" USING (""user_id"") WHERE ""u"".""user_id"" IN (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) OR ""u"".""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"")"
69,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
70,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION SELECT ""user_id"" FROM ""con2t"")"
71,"WITH ""medal_tab"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""Contests"") SELECT ""u"".""name"" AS ""name"",""u"".""mail"" AS ""mail"" FROM (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3 UNION SELECT DISTINCT (""t2"".""user_id"") AS ""user_id"" FROM (SELECT ""t1"".""user_id"" AS ""user_id"",""t1"".""diff"" AS ""diff"",COUNT(""t1"".""contest_id"") AS ""consec_num"" FROM (SELECT ""user_id"",""medal"",""contest_id"",(""contest_id""-RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""diff"" FROM ""medal_tab"") AS ""t1"" GROUP BY 1,2 HAVING COUNT(""t1"".""contest_id"")>=3) AS ""t2"") AS ""t3"" LEFT JOIN ""Users"" AS ""u"" ON ""t3"".""user_id""=""u"".""user_id"""
72,"WITH ""r"" AS (SELECT ""contest_id"",""gold_medal"" AS ""u_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""u_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""u_id"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""r3"".""u_id"" FROM (SELECT ""r2"".""u_id"",""r2"".""contest_id""-""r2"".""rnk"" AS ""cd"",COUNT(1) AS ""cnt"" FROM (SELECT ""u_id"",""contest_id"",COUNT(1),ROW_NUMBER() OVER (PARTITION BY ""u_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""r"" GROUP BY 1,2) AS ""r2"" GROUP BY 1,2 HAVING COUNT(1)>=3) AS ""r3"" UNION SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) AS ""r4"" JOIN ""Users"" AS ""u"" ON ""r4"".""u_id""=""u"".""user_id"""
73,"WITH ""Contest_Medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT ""r"".""mail"",""r"".""name"" FROM (SELECT DISTINCT ""cm1"".""medal"" FROM (""Contest_Medal"" AS ""cm1"" JOIN ""Contest_Medal"" AS ""cm2"" ON ""cm1"".""contest_id""+1=""cm2"".""contest_id"" AND ""cm1"".""medal""=""cm2"".""medal"") JOIN ""Contest_Medal"" AS ""cm3"" ON ""cm2"".""contest_id""+1=""cm3"".""contest_id"" AND ""cm2"".""medal""=""cm3"".""medal"" UNION SELECT ""a"".""medal"" FROM (SELECT ""gold_medal"" AS ""medal"",COUNT(1) AS ""cnt"" FROM ""Contests"" GROUP BY ""gold_medal"") AS ""a"" WHERE ""a"".""cnt"">=3) AS ""l"" LEFT JOIN ""Users"" AS ""r"" ON ""l"".""medal""=""r"".""user_id"""
74,"WITH ""cond1"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""u"".""user_id"",""u"".""name"",""c"".""contest_id"",LEAD(""c"".""contest_id"", 2) OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""3nd_medal"",(CAST(""c"".""contest_id"" AS INTEGER)+2) AS ""seq_3"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"" ORDER BY 2,3) AS ""sub"" WHERE ""3nd_medal""=""seq_3""), ""cond2"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT * FROM ""cond1"" UNION SELECT * FROM ""cond2"") AS ""sub1"" JOIN ""Users"" AS ""u"" ON ""sub1"".""user_id""=""u"".""user_id"""
75,"WITH ""allothers"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""group2"" AS (SELECT DISTINCT (""gold_medal"") FROM (SELECT ""contest_id"",""gold_medal"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""gold_medal"" ORDER BY ""contest_id"") AS ""diff"" FROM ""allothers"" ORDER BY ""gold_medal"",""contest_id"") AS ""g"" GROUP BY ""gold_medal"",""diff"" HAVING COUNT(""gold_medal"")>=3 UNION SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""group2"")"
76,"WITH ""medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""a"".""user_id"" FROM (""medals"" AS ""a"" JOIN ""medals"" AS ""b"" ON ""a"".""contest_id""=""b"".""contest_id""+1 AND ""a"".""user_id""=""b"".""user_id"") JOIN ""medals"" AS ""c"" ON ""a"".""contest_id""=""c"".""contest_id""-1 AND ""a"".""user_id""=""c"".""user_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""user_id"" HAVING COUNT(1)>=3) AS ""t"" JOIN ""Users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
77,"WITH ""TEMP"" AS (SELECT ""CONTEST_ID"",""GOLD_MEDAL"" AS ""ID"",'GOLD' AS ""MEDAL"" FROM ""CONTESTS"" UNION ALL SELECT ""CONTEST_ID"",""SILVER_MEDAL"" AS ""ID"",'SILVER' AS ""MEDAL"" FROM ""CONTESTS"" UNION ALL SELECT ""CONTEST_ID"",""BRONZE_MEDAL"" AS ""ID"",'BRONZE' AS ""MEDAL"" FROM ""CONTESTS""), ""COND1"" AS (SELECT ""A"".""ID"" FROM (""TEMP"" AS ""A"" JOIN ""TEMP"" AS ""B"" ON ""A"".""ID""=""B"".""ID"" AND ""A"".""CONTEST_ID""+1=""B"".""CONTEST_ID"") JOIN ""TEMP"" AS ""C"" ON ""A"".""ID""=""C"".""ID"" AND ""A"".""CONTEST_ID""+2=""C"".""CONTEST_ID""), ""COND2"" AS (SELECT ""GOLD_MEDAL"" AS ""ID"" FROM ""CONTESTS"" GROUP BY ""GOLD_MEDAL"" HAVING COUNT(1)>=3), ""COND"" AS (SELECT DISTINCT (""ID"") FROM ""COND1"" UNION SELECT DISTINCT (""ID"") FROM ""COND2"") SELECT ""U"".""NAME"",""U"".""MAIL"" AS ""MAIL"" FROM ""COND"" JOIN ""USERS"" AS ""U"" ON ""U"".""USER_ID""=""COND"".""ID"""
78,"WITH ""t1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""t2"" AS (SELECT ""id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""num"" FROM ""t1""), ""t3"" AS (SELECT ""id"" FROM ""t2"" GROUP BY ""id"",""contest_id""-""num"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT DISTINCT ""name"",""mail"" FROM ""t3"" JOIN ""Users"" ON ""t3"".""id""=""Users"".""user_id"""
79,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
80,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte2"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cnt"" FROM ""cte2"") AS ""F"" WHERE ""F"".""cnt""-""F"".""contest_id""=2 UNION SELECT ""user_id"" FROM ""cte1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" JOIN ""Users"" AS ""u"" USING (""user_id"") ORDER BY ""user_id"""
81,"WITH ""t1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""t2"" AS (SELECT *,""contest_id""-RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""num"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""t"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""t2"" GROUP BY ""user_id"",""num"" HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT ""user_id"" FROM ""t1"")"
82,"WITH ""a"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""b"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""num"" FROM ""a""), ""c"" AS (SELECT ""user"" AS ""user_id"" FROM ""b"" GROUP BY 1,""contest_id""-""num"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""c"" ON ""u"".""user_id""=""c"".""user_id"""
83,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"",'gold' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"",'silver' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"",'bronze' AS ""medal"" FROM ""Contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""cte1""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM ""cte2"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""cte3"")"
84,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) UNION SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT DISTINCT ""A"".""medal"" FROM ((""cte"" AS ""A"") CROSS JOIN ""cte"" AS ""B"") CROSS JOIN ""cte"" AS ""C"" WHERE ""A"".""contest_id""=""B"".""contest_id""-1 AND ""A"".""contest_id""=""C"".""contest_id""-2 AND ""A"".""medal""=""B"".""medal"" AND ""A"".""medal""=""C"".""medal"")"
85,"WITH ""CTE1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""CTE2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""CTE3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""delta"",COUNT(1) AS ""cnt"" FROM (SELECT ""contest_id"",""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""delta"" FROM ""CTE2"") AS ""sub1"" GROUP BY ""user_id"",""delta"") AS ""sub2"" WHERE ""cnt"">=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""CTE1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""CTE3"")"
86,"WITH ""CTE1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""CTE2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""CTE3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""delta"",COUNT(1) AS ""cnt"" FROM (SELECT ""contest_id"",""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""delta"" FROM ""CTE2"") AS ""sub1"" GROUP BY ""user_id"",""delta"") AS ""sub2"" WHERE ""cnt"">=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""CTE1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""CTE3"")"
87,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""t1"" AS (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""t""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" WHERE (""contest_id""=""diff""+2) UNION ALL SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""mail"",""name"" FROM ""t2"" JOIN ""Users"" USING (""user_id"")"
88,"WITH ""T1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""userid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""userid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""userid"" FROM ""Contests""), ""T2"" AS (SELECT DISTINCT ""a"".""userid"" AS ""id"" FROM (""T1"" AS ""a"" LEFT JOIN ""T1"" AS ""b"" ON ""a"".""contest_id""=""b"".""contest_id""-1) JOIN ""T1"" AS ""c"" ON ""b"".""contest_id""=""c"".""contest_id""-1 WHERE ""a"".""userid""=""b"".""userid"" AND ""b"".""userid""=""c"".""userid""), ""T3"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT DISTINCT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""T2"") OR ""user_id"" IN (SELECT ""id"" FROM ""T3"")"
89,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""c"".""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
90,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"",'bronze' AS ""medal"" FROM ""contests""), ""cte2"" AS (SELECT ""winner"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""r"" FROM ""cte"") SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT ""winner"" FROM ""cte2"" GROUP BY ""winner"",""contest_id""-""r"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""winner"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""winner"" HAVING COUNT(""contest_id"")>=3) AS ""sub"" ON ""sub"".""winner""=""u"".""user_id"""
91,"WITH ""c1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""melted"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""c2"" AS (SELECT ""u1"".""user_id"" FROM ((""melted"" AS ""u1"") CROSS JOIN ""melted"" AS ""u2"") CROSS JOIN ""melted"" AS ""u3"" WHERE ""u1"".""contest_id""=""u2"".""contest_id""-1 AND ""u2"".""contest_id""=""u3"".""contest_id""-1 AND ""u1"".""user_id""=""u2"".""user_id"" AND ""u2"".""user_id""=""u3"".""user_id""), ""both_conditions"" AS (SELECT ""user_id"" FROM ""c1"" UNION SELECT ""user_id"" FROM ""c2"") SELECT ""u"".""name"",""u"".""mail"" FROM ""both_conditions"" AS ""b"" JOIN ""Users"" AS ""u"" ON ""b"".""user_id""=""u"".""user_id"""
92,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
93,"WITH ""tmp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY 2,1) SELECT ""a"".""name"",""a"".""mail"" FROM ""users"" AS ""a"" JOIN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")-""contest_id"" AS ""diff"" FROM ""tmp"") AS ""t"" WHERE ""diff""=2) AS ""b"" ON ""a"".""user_id""=""b"".""user_id"""
94,"WITH ""medal_winners"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""gold_medal_winners"" AS (SELECT ""user_id"" FROM ""medal_winners"" GROUP BY ""user_id"" HAVING COUNT(CASE WHEN ""medal""='gold' THEN 1 END)>=3), ""consecutive_winners"" AS (SELECT ""m1"".""user_id"" AS ""user_id"" FROM (""medal_winners"" AS ""m1"" JOIN ""medal_winners"" AS ""m2"" ON ""m1"".""user_id""=""m2"".""user_id"" AND ""m1"".""contest_id""=""m2"".""contest_id""-1) JOIN ""medal_winners"" AS ""m3"" ON ""m2"".""user_id""=""m3"".""user_id"" AND ""m2"".""contest_id""=""m3"".""contest_id""-1) SELECT ""name"",""mail"" FROM (SELECT ""user_id"" FROM ""consecutive_winners"" UNION SELECT ""user_id"" FROM ""gold_medal_winners"") AS ""w"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""w"".""user_id"""
95,"WITH ""CTE"" AS ((SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"")), ""t1"" AS ((SELECT DISTINCT ""c1"".""medal"" FROM ""CTE"" AS ""c1"" LEFT JOIN ""CTE"" AS ""c2"" ON ((""c2"".""contest_id""-""c1"".""contest_id"") BETWEEN 1 AND 2) AND (""c1"".""medal""=""c2"".""medal"") GROUP BY ""c1"".""contest_id"",""c1"".""medal"" HAVING COUNT(""c2"".""contest_id"")>=2) UNION (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3)) SELECT ""name"",""mail"" FROM ""t1"" LEFT JOIN ""Users"" AS ""u"" ON ""t1"".""medal""=""u"".""user_id"""
96,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""c"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""drnk"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""cte""), ""d"" AS (SELECT *,COUNT(""user_id"") AS ""cnt"" FROM ""c"" GROUP BY ""grp"",""user_id"" HAVING COUNT(""user_id"")>2), ""gold"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""contest_id"",""user_id"" FROM ""d"" UNION SELECT ""contest_id"",""gold_medal"" FROM ""gold"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
97,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte2"" AS (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte1"" AS ""c1"") CROSS JOIN ""cte1"" AS ""c2"") CROSS JOIN ""cte1"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2) UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" WHERE ""user_id"" IN (SELECT * FROM ""cte2"")"
98,"WITH ""tmp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""tmp2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""rn"" FROM ""tmp""), ""tmp3"" AS (SELECT ""medal"" FROM ""tmp2"" GROUP BY ""medal"",(""contest_id""-""rn"") HAVING COUNT(1)>=3), ""tmp4"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""medal"" FROM ""tmp4"" UNION SELECT ""medal"" FROM ""tmp3"")"
99,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT DISTINCT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""t2"")"
100,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
101,"WITH ""res"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""temp"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (""res"" AS ""a"" JOIN ""res"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"") JOIN ""res"" AS ""c"" ON ""b"".""user_id""=""c"".""user_id"" WHERE ""a"".""contest_id""+1=""b"".""contest_id"" AND ""b"".""contest_id""+1=""c"".""contest_id"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""temp"" AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
102,"WITH ""conts"" AS (SELECT ""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"",""c2"".""gold_medal"" AS ""c2_gold_medal"",""c2"".""silver_medal"" AS ""c2_silver_medal"",""c2"".""bronze_medal"" AS ""c2_bronze_medal"",""c3"".""gold_medal"" AS ""c3_gold_medal"",""c3"".""silver_medal"" AS ""c3_silver_medal"",""c3"".""bronze_medal"" AS ""c3_bronze_medal"",""c3"".""contest_id"" AS ""2_conts_ago"" FROM (""Contests"" AS ""c1"" LEFT JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""-1) LEFT JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_id""=""c1"".""contest_id""-2), ""cte"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""gold_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""gold_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"") UNION SELECT ""silver_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""silver_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""silver_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"") UNION SELECT ""bronze_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""bronze_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""bronze_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"")) SELECT ""u"".""name"",""u"".""mail"" FROM ""cte"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"""
103,"WITH ""cte_allmedal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""w_plyr"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""w_plyr"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""w_plyr"" FROM ""Contests""), ""cte_conseq"" AS (SELECT ""w_plyr"",""contest_id""-""rk"" AS ""grp"" FROM (SELECT ""w_plyr"",""contest_id"",DENSE_RANK() OVER (PARTITION BY ""w_plyr"" ORDER BY ""contest_id"") AS ""rk"" FROM ""cte_allmedal"") AS ""tbl""), ""cte_group"" AS (SELECT ""w_plyr"" FROM ""cte_conseq"" GROUP BY ""w_plyr"",""grp"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM (SELECT ""w_plyr"" AS ""user_id"" FROM ""cte_group"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""tbl"" JOIN ""Users"" ON ""tbl"".""user_id""=""Users"".""user_id"""
104,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT DISTINCT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""t1"".""medal"" FROM ""t"" AS ""t1"" JOIN ""t"" AS ""t2"" ON ""t1"".""medal""=""t2"".""medal"" AND (""t2"".""contest_id""-""t1"".""contest_id"") BETWEEN 0 AND 2 GROUP BY ""t1"".""medal"",""t1"".""contest_id"" HAVING COUNT(DISTINCT ""t2"".""contest_id"")>=3) OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3)"
105,"WITH ""medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""ids"" AS (SELECT ""contest_id"",""medal"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""id_group"" FROM ""medals""), ""medal_cnt"" AS (SELECT ""contest_id"",""medal"",COUNT(1) OVER (PARTITION BY ""medal"", ""id_group"") AS ""cnt"" FROM ""ids""), ""any_medal"" AS (SELECT DISTINCT ""medal"" AS ""user_id"" FROM ""medal_cnt"" WHERE ""cnt"">=3), ""gold_medal"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"",COUNT(""gold_medal"") AS ""cnt"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""candidates"" AS (SELECT ""user_id"" FROM ""gold_medal"" UNION SELECT ""user_id"" FROM ""any_medal"") SELECT ""name"",""mail"" FROM ""candidates"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""user_id"""
106,"WITH ""t0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""t1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (""t0"" AS ""a"" JOIN ""t0"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""contest_id""=""b"".""contest_id""-1) JOIN ""t0"" AS ""c"" ON ""a"".""user_id""=""c"".""user_id"" AND ""a"".""contest_id""=""c"".""contest_id""-2), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests""), ""t3"" AS (SELECT ""user_id"" FROM ""t2"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3), ""t4"" AS (SELECT ""user_id"" FROM ""t1"" UNION SELECT ""user_id"" FROM ""t3"") SELECT ""u"".""mail"",""u"".""name"" FROM ""t4"" JOIN ""Users"" AS ""u"" ON ""t4"".""user_id""=""u"".""user_id"""
107,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""a"" AS (SELECT ""contest_id"",""user_id"",""medal"",ROW_NUMBER() OVER (ORDER BY ""contest_id"") AS ""rn"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""cte""), ""b"" AS (SELECT * FROM ""a"" GROUP BY ""grp"",""user_id"" HAVING COUNT(6)>2), ""c"" AS (SELECT * FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""contest_id"",""user_id"" FROM ""b"" UNION SELECT ""contest_id"",""gold_medal"" FROM ""c"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
108,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""c"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""drnk"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""cte""), ""d"" AS (SELECT *,COUNT(""user_id"") AS ""cnt"" FROM ""c"" GROUP BY ""grp"",""user_id"" HAVING COUNT(""user_id"")>2), ""gold"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""contest_id"",""user_id"" FROM ""d"" UNION SELECT ""contest_id"",""gold_medal"" FROM ""gold"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
109,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
110,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
111,"WITH ""c1"" AS (SELECT ""gold_medal"" AS ""uid"",""contest_id"" AS ""cid"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""uid"",""contest_id"" AS ""cid"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""uid"",""contest_id"" AS ""cid"" FROM ""Contests""), ""c2"" AS (SELECT ""gold_medal"" AS ""uid"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3), ""c3"" AS (SELECT ""uid"",""cid"",ROW_NUMBER() OVER (PARTITION BY ""uid"" ORDER BY ""cid"") AS ""uid_rn"" FROM ""c1""), ""c4"" AS (SELECT ""uid"",""cid"" FROM ""c3"" GROUP BY ""uid"",""cid""-""uid_rn"" HAVING COUNT(""uid"")>=3), ""c5"" AS (SELECT DISTINCT ""uid"" FROM ""c4"" UNION SELECT ""uid"" FROM ""c2"") SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""c5"" ON ""u"".""user_id""=""c5"".""uid"""
112,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
113,"WITH ""t"" AS (SELECT *,""contest_id""-RANK() OVER (PARTITION BY ""user_id"", ""user_id"" IN (""gold_medal"",""silver_medal"",""bronze_medal"") ORDER BY ""contest_id"") AS ""consecutive_ref"" FROM ""Contests"" JOIN ""Users"" ON ""user_id"" IN (""gold_medal"",""silver_medal"",""bronze_medal"") ORDER BY ""user_id"",""contest_id""), ""u"" AS (SELECT ""user_id"" FROM ""t"" GROUP BY 1 HAVING SUM(""user_id""=""gold_medal"")>=3 UNION SELECT ""user_id"" FROM ""t"" GROUP BY ""user_id"",""consecutive_ref"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""u"" LEFT JOIN ""Users"" USING (""user_id"")"
114,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""a3"".""user_id"" FROM (""a"" AS ""a1"" JOIN ""a"" AS ""a2"" ON ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a1"".""user_id""=""a2"".""user_id"") JOIN ""a"" AS ""a3"" ON ""a2"".""user_id""=""a3"".""user_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"" GROUP BY 1 UNION ALL SELECT ""gold_medal"" AS ""userid"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) AS ""t"" JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
115,"WITH ""order_users"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"",1 AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"",2 AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"",3 AS ""medal"" FROM ""Contests"" ORDER BY ""user_id"",""contest_id"") SELECT DISTINCT ""f"".""name"",""f"".""mail"" FROM (SELECT DISTINCT ""g"".""name"",""g"".""mail"" FROM (SELECT ""u"".""user_id"",""u"".""name"",""u"".""mail"",""ou"".""contest_id"",(""ou"".""contest_id""-LAG(""ou"".""contest_id"", 2) OVER (PARTITION BY ""ou"".""user_id"" ORDER BY ""ou"".""contest_id"")) AS ""lag_emp_id"" FROM ""Users"" AS ""u"" JOIN ""order_users"" AS ""ou"" ON ""u"".""user_id""=""ou"".""user_id"" WHERE ""ou"".""medal"" IN (1,2,3)) AS ""g"" WHERE ""g"".""lag_emp_id""=2 UNION ALL (SELECT ""h"".""name"",""h"".""mail"" FROM (SELECT ""u"".""user_id"",""u"".""name"",""u"".""mail"",""ou"".""contest_id"",SUM(""ou"".""medal"") OVER (PARTITION BY ""ou"".""user_id"" ORDER BY ""ou"".""contest_id"") AS ""gold_medal_count"" FROM ""Users"" AS ""u"" JOIN ""order_users"" AS ""ou"" ON ""u"".""user_id""=""ou"".""user_id"" WHERE ""ou"".""medal""=1) AS ""h"" WHERE ""h"".""gold_medal_count""=3)) AS ""f"" ORDER BY ""f"".""name"""
116,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
117,"WITH ""T1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""T2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"" ORDER BY ""contest_id""), ""T3"" AS (SELECT ""contest_id"",""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""series_id"" FROM ""T2""), ""T4"" AS (SELECT ""contest_id"",""user_id"" FROM ""T3"" WHERE ROW(""user_id"",""series_id"") IN (SELECT ""user_id"",""series_id"" FROM ""T3"" GROUP BY ""user_id"",""series_id"" HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""T1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""T4"")"
118,"SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN (WITH ""u"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"",'gold' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"",'silver' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"",'bronze' AS ""type"" FROM ""Contests"") SELECT ""medal"" FROM ""u"" WHERE ""type""='gold' GROUP BY ""medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""m"".""medal"" FROM (""u"" AS ""f"" CROSS JOIN ""u"" AS ""m"") JOIN ""u"" AS ""l"" ON (""f"".""contest_id""=""m"".""contest_id""-1 AND ""f"".""contest_id""=""l"".""contest_id""-2) AND (""f"".""medal""=""m"".""medal"") AND (""f"".""medal""=""l"".""medal"")) AS ""x"" ON ""x"".""medal""=""u"".""user_id"""
119,"WITH ""medal_list"" AS (SELECT ""medal"",CASE WHEN (""contest_id""-LEAD(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"" DESC))=2 THEN 1 ELSE 0 END AS ""con1"",SUM(CASE WHEN ""type""='gold' THEN 1 ELSE 0 END) OVER (PARTITION BY ""medal"") AS ""con2"" FROM (SELECT ""gold_medal"" AS ""medal"",'gold' AS ""type"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""medal"",'silver' AS ""type"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""medal"",'bronze' AS ""type"",""contest_id"" FROM ""contests"") AS ""sub1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""medal_list"" AS ""m"" ON ""m"".""medal""=""u"".""user_id"" GROUP BY 1,2 HAVING MAX(""m"".""con1"")=1 OR MAX(""m"".""con2"")>=3"
120,"WITH ""cte"" AS (SELECT ""contest_id"",'gold medal' AS ""medal_type"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",'silver medal' AS ""medal_type"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",'bronze medal' AS ""medal_type"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"",""medal_type"") SELECT ""name"",""mail"" FROM ""Users"" JOIN (SELECT ""user_id"" FROM ""cte"" WHERE ""medal_type""='gold medal' GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""a"".""user_id"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""b"".""contest_id""=""a"".""contest_id""+1) JOIN ""cte"" AS ""c"" ON ""c"".""contest_id""=""b"".""contest_id""+1 WHERE ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"" AND ""a"".""user_id""=""c"".""user_id"") AS ""t"" ON ""Users"".""user_id""=""t"".""user_id"""
121,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"",'gold' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"",'silver' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"",'bronze' AS ""medal"" FROM ""Contests"") SELECT ""name"",""mail"" FROM (SELECT ""id"" FROM ""CTE"" WHERE ""medal""='gold' GROUP BY ""id"" HAVING COUNT(""contest_id"")>2 UNION SELECT DISTINCT ""c1"".""id"" FROM (""CTE"" AS ""c1"" JOIN ""CTE"" AS ""c2"" ON ""c1"".""id""=""c2"".""id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""CTE"" AS ""c3"" ON ""c2"".""id""=""c3"".""id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"") AS ""X"" JOIN ""users"" AS ""u"" ON ""X"".""id""=""u"".""user_id"""
122,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""t1"" AS (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""t""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" WHERE (""contest_id""=""diff""+2) UNION ALL SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""mail"",""name"" FROM ""t2"" JOIN ""Users"" USING (""user_id"")"
123,"WITH ""t0"" AS (SELECT ""contest_id"",""silver_medal"" AS ""user"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""gold_medal"" AS ""user"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user"" FROM ""contests""), ""t1"" AS (SELECT ""contest_id"",""user"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT DISTINCT ""user"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT DISTINCT ""gold_medal"" AS ""user"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT DISTINCT ""name"",""mail"" FROM ""users"" JOIN ""t2"" ON ""users"".""user_id""=""t2"".""user"""
124,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",""contest_id""-(LAG(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"")) AS ""diff"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" AS ""a"" GROUP BY 1,2 UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" AS ""a"" GROUP BY 1,2 UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"" AS ""a"" GROUP BY 1,2) AS ""x"" JOIN ""users"" AS ""b"" ON ""x"".""medal""=""b"".""user_id"") AS ""y"" WHERE ""diff""=2 UNION SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" AS ""a"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""x"" JOIN ""Users"" AS ""y"" ON ""x"".""id""=""y"".""user_id"""
125,"WITH ""t0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""t1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (""t0"" AS ""a"" JOIN ""t0"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""contest_id""=""b"".""contest_id""-1) JOIN ""t0"" AS ""c"" ON ""a"".""user_id""=""c"".""user_id"" AND ""a"".""contest_id""=""c"".""contest_id""-2), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests""), ""t3"" AS (SELECT ""user_id"" FROM ""t2"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3), ""t4"" AS (SELECT ""user_id"" FROM ""t1"" UNION SELECT ""user_id"" FROM ""t3"") SELECT ""u"".""name"",""u"".""mail"" FROM ""t4"" JOIN ""Users"" AS ""u"" ON ""t4"".""user_id""=""u"".""user_id"""
126,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""a"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""drnk"" FROM ""cte""), ""b"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"" FROM ""cte""), ""c"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""drnk"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""cte""), ""d"" AS (SELECT *,COUNT(""user_id"") AS ""cnt"" FROM ""c"" GROUP BY ""grp"",""user_id"" HAVING COUNT(""user_id"")>2), ""gold"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""contest_id"",""user_id"" FROM ""d"" UNION SELECT ""contest_id"",""gold_medal"" FROM ""gold"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
127,"WITH ""gold"" AS (SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY 1,2 HAVING COUNT(1)>=3), ""all_med"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""check_all"" AS (SELECT ""name"",""mail"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""contest_id"") AS ""lead_con"" FROM ""Users"" AS ""u"" JOIN ""all_med"" AS ""a"" ON ""u"".""user_id""=""a"".""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""check_all"" WHERE ""contest_id""+2=""lead_con"" UNION SELECT * FROM ""gold"""
128,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" LEFT JOIN ""Contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""user_id"" HAVING COUNT(""c"".""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
129,"WITH ""gold_cte"" AS (SELECT ""gold_medal"" AS ""medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""cte2"" AS (SELECT ""c1"".""contest_id"",""c1"".""medal"" FROM (""cte1"" AS ""c1"" LEFT JOIN ""cte1"" AS ""c2"" ON ""c1"".""medal""=""c2"".""medal"") LEFT JOIN ""cte1"" AS ""c3"" ON ""c2"".""medal""=""c3"".""medal"" WHERE ""c3"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c1"".""contest_id""+1) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""medal"" AS ""id"" FROM ""gold_cte"" UNION ALL SELECT ""medal"" AS ""id"" FROM ""cte2"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""id""=""u"".""user_id"""
130,"WITH ""c1"" AS (SELECT ""gold_medal"" AS ""uid"",""contest_id"" AS ""cid"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""uid"",""contest_id"" AS ""cid"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""uid"",""contest_id"" AS ""cid"" FROM ""Contests""), ""c2"" AS (SELECT ""gold_medal"" AS ""uid"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3), ""c3"" AS (SELECT ""uid"",""cid"",ROW_NUMBER() OVER (PARTITION BY ""uid"" ORDER BY ""cid"") AS ""uid_rn"" FROM ""c1""), ""c4"" AS (SELECT ""uid"",""cid"" FROM ""c3"" GROUP BY ""uid"",""cid""-""uid_rn"" HAVING COUNT(""uid"")>=3), ""c5"" AS (SELECT DISTINCT ""uid"" FROM ""c4"" UNION SELECT ""uid"" FROM ""c2"") SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""c5"" ON ""u"".""user_id""=""c5"".""uid"""
131,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte3"" AS (SELECT ""user_id"",DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""cte2""), ""cte4"" AS (SELECT ""user_id"" FROM ""cte3"" GROUP BY ""user_id"",""diff"" HAVING COUNT(""user_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""cte4"")"
132,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
133,"WITH ""contest_view"" AS (SELECT * FROM (SELECT ""c"".""gold_medal"" AS ""user"",""c"".""contest_id"" FROM ""Contests"" AS ""c"" UNION ALL SELECT ""c"".""silver_medal"" AS ""user"",""c"".""contest_id"" FROM ""Contests"" AS ""c"" UNION ALL SELECT ""c"".""bronze_medal"" AS ""user"",""c"".""contest_id"" FROM ""Contests"" AS ""c"") AS ""t"" ORDER BY ""t"".""user""), ""gold_contest_view"" AS (SELECT DISTINCT ""c"".""gold_medal"",COUNT(""c"".""contest_id"") FROM ""Contests"" AS ""c"" GROUP BY ""c"".""gold_medal"" HAVING COUNT(""c"".""contest_id"")>=3) SELECT DISTINCT ""t"".* FROM (SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""contest_view"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""user""=""u"".""user_id"" WHERE (""c"".""contest_id""+1 IN (SELECT ""c1"".""contest_id"" FROM ""contest_view"" AS ""c1"" WHERE ""c1"".""user""=""c"".""user"") AND ""c"".""contest_id"" IN (SELECT ""c1"".""contest_id"" FROM ""contest_view"" AS ""c1"" WHERE ""c1"".""user""=""c"".""user"") AND ""c"".""contest_id""-1 IN (SELECT ""c1"".""contest_id"" FROM ""contest_view"" AS ""c1"" WHERE ""c1"".""user""=""c"".""user"")) UNION ALL SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""gold_contest_view"" AS ""gc"" LEFT JOIN ""Users"" AS ""u"" ON ""gc"".""gold_medal""=""u"".""user_id"") AS ""t"""
134,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
135,"WITH ""gold_cte"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""union_cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""union_gold_consecutive_cte"" AS (SELECT ""u1"".""user_id"" FROM (""union_cte"" AS ""u1"" JOIN ""union_cte"" AS ""u2"" ON ""u1"".""contest_id""+1=""u2"".""contest_id"" AND ""u1"".""user_id""=""u2"".""user_id"") JOIN ""union_cte"" AS ""u3"" ON ""u1"".""contest_id""+2=""u3"".""contest_id"" AND ""u2"".""contest_id""+1=""u3"".""contest_id"" AND ""u1"".""user_id""=""u3"".""user_id"" AND ""u3"".""user_id""=""u2"".""user_id"" UNION SELECT * FROM ""gold_cte"") SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""union_gold_consecutive_cte"" AS ""gc"" ON ""u"".""user_id""=""gc"".""user_id"""
136,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""Users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
137,"SELECT ""a"".""name"",""a"".""mail"" FROM (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_two"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id"" IN (""c"".""gold_medal"",""c"".""silver_medal"",""c"".""bronze_medal"")) AS ""a"" GROUP BY ""user_id"" HAVING SUM(""user_id""=""gold_medal"")>=3 OR SUM(""contest_id""-""lag_two""=2)>=1"
138,"WITH ""GOLD"" AS (SELECT ""name"",""mail"" FROM ""Contests"" AS ""C1"" JOIN ""Users"" AS ""U1"" ON ""C1"".""gold_medal""=""U1"".""user_id"" GROUP BY 1,2 HAVING COUNT(""gold_medal"")>=3), ""Contests_long"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""CONSERCUTIVE"" AS (SELECT ""user_id"" FROM ""Contests_long"" WHERE ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""Contests_long"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""Contests_long"")) SELECT ""name"",""mail"" FROM ""CONSERCUTIVE"" AS ""CON1"" JOIN ""Users"" AS ""U2"" ON ""CON1"".""user_id""=""U2"".""user_id"" UNION SELECT * FROM ""GOLD"""
139,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""c"".""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ((""Users"" AS ""u"" CROSS JOIN ""contests"" AS ""c1"") CROSS JOIN ""contests"" AS ""c2"") CROSS JOIN ""contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
140,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
141,"WITH ""any_medal"" AS (WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""champ"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""champ"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""champ"" FROM ""Contests"") SELECT DISTINCT ""champ"" FROM ""cte"" WHERE ROW(""contest_id""+1,""champ"") IN (SELECT * FROM ""cte"") AND ROW(""contest_id""+2,""champ"") IN (SELECT * FROM ""cte"")), ""gold_medel"" AS (SELECT ""gold_medal"" AS ""champ"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""Users"" AS ""b"" RIGHT JOIN (SELECT * FROM ""any_medal"" UNION SELECT * FROM ""gold_medel"") AS ""a"" ON ""b"".""user_id""=""a"".""champ"""
142,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"",'gold' AS ""medal_type"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"",'silver' AS ""medal_type"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"",'bronze' AS ""medal_type"" FROM ""contests"") SELECT ""name"",""mail"" FROM (SELECT ""id"" FROM ""CTE"" WHERE ""medal_type""='gold' GROUP BY ""id"",""medal_type"" HAVING COUNT(""contest_id"")>2 UNION SELECT DISTINCT ""c1"".""id"" FROM (""CTE"" AS ""c1"" JOIN ""CTE"" AS ""c2"" ON ""c1"".""id""=""c2"".""id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""CTE"" AS ""c3"" ON ""c2"".""contest_id""+1=""c3"".""contest_id"" AND ""c2"".""id""=""c3"".""id"") AS ""x"" JOIN ""Users"" AS ""s"" ON ""s"".""user_id""=""x"".""id"""
143,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
144,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
145,"WITH ""gold"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"",COUNT(""gold_medal"") FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""u"".""user_id"" HAVING COUNT(""gold_medal"")>=3), ""m"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""any"" AS (SELECT DISTINCT ""m1"".""user_id"" FROM ((""m"" AS ""m1"") CROSS JOIN ""m"" AS ""m2"") CROSS JOIN ""m"" AS ""m3"" WHERE ""m1"".""user_id""=""m2"".""user_id"" AND ""m1"".""user_id""=""m3"".""user_id"" AND ""m2"".""contest_id""-""m1"".""contest_id""=1 AND ""m3"".""contest_id""-""m2"".""contest_id""=1) SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""gold"" AS ""g"" ON ""u"".""user_id""=""g"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""any"" AS ""a"" ON ""u"".""user_id""=""a"".""user_id"""
146,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT ""name"",""mail"" FROM (SELECT DISTINCT ""c1"".""medal"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""medal""=""c3"".""medal"" AND ""c1"".""contest_id""=""c3"".""contest_id""-2 UNION (SELECT DISTINCT ""gold_medal"" AS ""medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3)) AS ""tmp1"" CROSS, ""Users"" WHERE ""tmp1"".""medal""=""users"".""user_id"""
147,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
148,"WITH ""temp1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""user_id"")>=3), ""temp2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""temp3"" AS (SELECT ""contest_id"",""medal"" AS ""user_id"" FROM ""temp2"" WHERE (ROW(""contest_id""+1,""medal"") IN (SELECT ""contest_id"",""medal"" FROM ""temp2"")) AND (ROW(""contest_id""+2,""medal"") IN (SELECT ""contest_id"",""medal"" FROM ""temp2"")) OR (ROW(""contest_id""-1,""medal"") IN (SELECT ""contest_id"",""medal"" FROM ""temp2"")) AND (ROW(""contest_id""-2,""medal"") IN (SELECT ""contest_id"",""medal"" FROM ""temp2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""temp1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""temp3"")"
149,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
150,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""flag"" FROM ""t0""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" GROUP BY ""user_id"",""contest_id""-""flag"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""user_id"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" AS ""t"" JOIN ""Users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
151,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
152,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
153,"WITH ""CTE1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""CTE2"" AS (SELECT DISTINCT ""a"".""medal"" FROM ((""CTE1"" AS ""a"") CROSS JOIN ""CTE1"" AS ""b"") CROSS JOIN ""CTE1"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""+1 AND ""a"".""contest_id""=""c"".""contest_id""+2 AND ""a"".""medal""=""b"".""medal"" AND ""a"".""medal""=""c"".""medal""), ""CTE3"" AS (SELECT ""gold_medal"" AS ""medal"",COUNT(1) AS ""ct"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING ""ct"">=3), ""CTE4"" AS (SELECT DISTINCT ""medal"" FROM ""CTE2"" UNION SELECT DISTINCT ""medal"" FROM ""CTE3"") SELECT ""name"",""mail"" FROM ""Users"" JOIN ""CTE4"" ON ""Users"".""user_id""=""CTE4"".""medal"""
154,"WITH ""x"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests""), ""y"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""x""), ""z"" AS (SELECT ""user_id"",""contest_id""-""rn"",COUNT(""contest_id""-""rn"") FROM ""y"" GROUP BY 1,2 HAVING COUNT(""contest_id""-""rn"")>=3), ""a"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""z"" UNION SELECT ""user_id"" FROM ""a"")"
155,"WITH ""cte"" AS (SELECT ""contest_id"",'gold medal' AS ""medal_type"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",'silver medal' AS ""medal_type"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",'bronze medal' AS ""medal_type"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"",""medal_type"") SELECT ""name"",""mail"" FROM ""Users"" JOIN (SELECT ""user_id"" FROM ""cte"" WHERE ""medal_type""='gold medal' GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""a"".""user_id"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""b"".""contest_id""=""a"".""contest_id""+1) JOIN ""cte"" AS ""c"" ON ""c"".""contest_id""=""b"".""contest_id""+1 WHERE ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"" AND ""a"".""user_id""=""c"".""user_id"") AS ""t"" ON ""Users"".""user_id""=""t"".""user_id"""
156,"WITH ""T1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""T2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"" ORDER BY ""contest_id""), ""T3"" AS (SELECT ""contest_id"",""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""series_id"" FROM ""T2""), ""T4"" AS (SELECT ""contest_id"",""user_id"" FROM ""T3"" WHERE ROW(""user_id"",""series_id"") IN (SELECT ""user_id"",""series_id"" FROM ""T3"" GROUP BY ""user_id"",""series_id"" HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""T1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""T4"")"
157,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""m"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""m"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""m"" FROM ""contests""), ""con"" AS (SELECT DISTINCT ""c"".""m"" AS ""user_id"" FROM (""c"" JOIN ""c"" AS ""c1"" ON ""c"".""contest_id""+1=""c1"".""contest_id"" AND ""c"".""m""=""c1"".""m"") JOIN ""c"" AS ""c2"" ON ""c"".""contest_id""+2=""c2"".""contest_id"" AND ""c"".""m""=""c2"".""m"") SELECT ""u1"".""name"",""u1"".""mail"" FROM (SELECT * FROM ""con"" UNION SELECT * FROM ""gold"") AS ""u"" JOIN ""users"" AS ""u1"" ON ""u"".""user_id""=""u1"".""user_id"""
158,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
159,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"",'gold' AS ""medal"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"",'silver' AS ""medal"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"",'bronze' AS ""medal"" FROM ""Contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""ld"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""ld_ld"" FROM ""cte1""), ""cte3"" AS (SELECT ""user_id"" FROM ""cte2"" WHERE ""contest_id""=""ld""-1 AND ""ld""=""ld_ld""-1 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""cte3"")"
160,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""c"".""gold_medal"" HAVING COUNT(""c"".""gold_medal"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
161,"WITH ""unions"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal_type"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal_type"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal_type"" FROM ""contests""), ""gold_winners"" AS (SELECT ""user_id"" FROM ""unions"" WHERE ""medal_type""='gold' GROUP BY ""user_id"" HAVING COUNT(1)>2), ""winners"" AS (SELECT ""user_id"",(""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""unions""), ""consecutive"" AS (SELECT ""user_id"",""grp"" FROM ""winners"" GROUP BY ""user_id"",""grp"" HAVING COUNT(1)>2) SELECT ""name"",""mail"" FROM ""gold_winners"" JOIN ""users"" ON ""gold_winners"".""user_id""=""users"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""consecutive"" JOIN ""users"" ON ""consecutive"".""user_id""=""users"".""user_id"""
162,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
163,"WITH ""t1"" AS (SELECT ""user_id"",""mail"",""name"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""consec_wins"" FROM ""users"" AS ""u"" LEFT JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") SELECT ""name"",""mail"" FROM ""t1"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""consec_wins""=2)>0"
164,"WITH ""a"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""b"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""c"" AS (SELECT ""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""b"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""c"" GROUP BY ""user_id"",""diff"" HAVING COUNT(""diff"")>=3) OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""a"")"
165,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
166,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
167,"WITH ""all_gold"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>2), ""all_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""m"".""user_id"" FROM ((""all_medal"" AS ""m"") CROSS JOIN ""all_medal"" AS ""n"") CROSS JOIN ""all_medal"" AS ""l"" WHERE ""m"".""user_id""=""n"".""user_id"" AND ""n"".""user_id""=""l"".""user_id"" AND ""m"".""contest_id""+1=""n"".""contest_id"" AND ""n"".""contest_id""+1=""l"".""contest_id"" UNION ALL SELECT DISTINCT ""user_id"" FROM ""all_gold"") AS ""a"" LEFT JOIN ""users"" AS ""u"" ON ""a"".""user_id""=""u"".""user_id"""
168,"WITH ""cte2"" AS (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") SELECT ""c1"".""name"",""c1"".""mail"" FROM (""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""user_id""=""c2"".""user_id"") JOIN ""cte2"" AS ""c3"" ON ""c1"".""contest_id""=""c3"".""contest_id""-2 AND ""c1"".""user_id""=""c3"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""users"" JOIN (SELECT ""user_id"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""gold_medal""=""user_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""gold_medal""=""user_id"" THEN 1 ELSE NULL END)>=3) AS ""temp"" ON ""users"".""user_id""=""temp"".""user_id"""
169,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""c"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""drnk"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""cte""), ""d"" AS (SELECT *,COUNT(""user_id"") AS ""cnt"" FROM ""c"" GROUP BY ""grp"",""user_id"" HAVING COUNT(""user_id"")>2), ""gold"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""contest_id"",""user_id"" FROM ""d"" UNION SELECT ""contest_id"",""gold_medal"" FROM ""gold"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
170,"WITH ""d_ans_1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""gold"" AS (SELECT ""users"".""user_id"",""contest_id"" FROM ""users"" LEFT JOIN ""contests"" ON ""users"".""user_id""=""contests"".""gold_medal"" WHERE ""contest_id"" IS NOT NULL), ""silver"" AS (SELECT ""users"".""user_id"",""contest_id"" FROM ""users"" LEFT JOIN ""contests"" ON ""users"".""user_id""=""contests"".""silver_medal"" WHERE ""contest_id"" IS NOT NULL), ""bronze"" AS (SELECT ""users"".""user_id"",""contest_id"" FROM ""users"" LEFT JOIN ""contests"" ON ""users"".""user_id""=""contests"".""bronze_medal"" WHERE ""contest_id"" IS NOT NULL), ""d1"" AS (SELECT * FROM ""gold"" UNION SELECT * FROM ""silver"" UNION SELECT * FROM ""bronze""), ""d2"" AS (SELECT ""user_id"",""contest_id"",CASE WHEN @""pre_user""!=(@""pre_user"":=""user_id"") THEN @""ct"":=1 ELSE CASE WHEN @""pre_contest""-(@""pre_contest"":=""contest_id"")=-1 THEN @""ct"":=@""ct""+1 ELSE @""ct"":=1 END END AS ""ct"" FROM (""d1"") CROSS JOIN (SELECT @""pre_user"":=NULL,@""pre_contest"":=NULL,@""ct"":=0) AS ""init"" ORDER BY ""user_id"",""contest_id""), ""d_ans_2"" AS (SELECT ""user_id"" FROM ""d2"" WHERE ""ct""=3), ""d_final"" AS (SELECT * FROM ""d_ans_1"" UNION SELECT * FROM ""d_ans_2"") SELECT ""name"",""mail"" FROM ""d_final"" LEFT JOIN ""users"" ON ""d_final"".""user_id""=""users"".""user_id"""
171,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
172,"WITH ""Union_table"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal_winnder"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal_winnder"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal_winnder"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT DISTINCT ""medal_winnder"" FROM (SELECT *,""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""medal_winnder"" ORDER BY ""contest_id"") AS ""group_id"" FROM ""Union_table"") AS ""A"" GROUP BY ""medal_winnder"",""group_id"" HAVING COUNT(""group_id"")>=3) OR ""user_id"" IN (SELECT DISTINCT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
173,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""cte_2"" AS (SELECT ""gold_medal"" AS ""medal"",COUNT(""contest_id"") AS ""cnt_gold"" FROM ""Contests"" GROUP BY 1 HAVING ""cnt_gold"">=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT DISTINCT ""a"".""medal"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""contest_id""+1=""b"".""contest_id"") JOIN ""cte"" AS ""c"" ON ""a"".""contest_id""+2=""c"".""contest_id"" WHERE ""a"".""medal""=""b"".""medal"" AND ""b"".""medal""=""c"".""medal"" UNION SELECT ""medal"" FROM ""cte_2"")"
174,"WITH ""new_data"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT (""user_id"") FROM (SELECT *,LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"" FROM ""new_data"") AS ""a"" WHERE ""contest_id""-""lag_2""=2 AND ""contest_id""-""lag_1""=1 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""a"" ON ""u"".""user_id""=""a"".""user_id"""
175,"WITH ""id1"" AS (SELECT DISTINCT ""user_id"" AS ""id"" FROM (SELECT ""a"".""user_id"",""b"".""contest_id""-(ROW_NUMBER() OVER (PARTITION BY ""a"".""user_id"" ORDER BY ""contest_id"")) AS ""x"" FROM ""Users"" AS ""a"" JOIN ""Contests"" AS ""b"" ON (""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"")) AS ""aa"" GROUP BY ""user_id"",""x"" HAVING COUNT(""x"")>2), ""id2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""id1"") OR ""user_id"" IN (SELECT ""id"" FROM ""id2"")"
176,"WITH ""temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""b"".""name"",""b"".""mail"" FROM (SELECT DISTINCT ""a"".""user_id"" FROM (""temp"" AS ""a"" JOIN ""temp"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""contest_id""+1=""b"".""contest_id"") JOIN ""temp"" AS ""c"" ON ""b"".""user_id""=""c"".""user_id"" AND ""b"".""contest_id""+1=""c"".""contest_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"""
177,"WITH ""golds"" AS (SELECT ""gold_medal"" AS ""uid"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""ptable"" AS (SELECT ""contest_id"",""gold_medal"" AS ""uid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""uid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""uid"" FROM ""Contests""), ""consecutive"" AS (SELECT ""p1"".""contest_id"",""p1"".""uid"" FROM ((""ptable"" AS ""p1"") CROSS JOIN ""ptable"" AS ""p2"") CROSS JOIN ""ptable"" AS ""p3"" WHERE (""p1"".""contest_id""+1=""p2"".""contest_id"" AND ""p1"".""contest_id""+2=""p3"".""contest_id"") AND (""p1"".""uid""=""p2"".""uid"") AND ""p1"".""uid""=""p3"".""uid"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""uid"" FROM ""golds"") OR ""user_id"" IN (SELECT ""uid"" FROM ""consecutive"")"
178,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""allmedal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""candidates"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (SELECT ""contest_id"",""user_id"",COUNT(""user_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cnt"" FROM ""allmedal"") AS ""a"" WHERE ""a"".""cnt"">=3 UNION SELECT ""user_id"" FROM ""gold"") SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""candidates"" ON ""u"".""user_id""=""candidates"".""user_id"""
179,"WITH ""gold_criteria"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2), ""unioned"" AS (SELECT * FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") AS ""xx"" ORDER BY ""medal"",""contest_id""), ""laged"" AS (SELECT ""contest_id"",""medal"",LAG(""contest_id"", 1) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""l1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""l2"" FROM ""unioned""), ""res"" AS (SELECT * FROM (SELECT ""medal"" AS ""md"" FROM ""laged"" WHERE ""contest_id""-""l1""=1 AND ""l1""-""l2""=1 UNION ALL SELECT ""gold_medal"" AS ""md"" FROM ""gold_criteria"") AS ""yy"" GROUP BY ""md"") SELECT ""u"".""name"",""u"".""mail"" FROM ""res"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""md""=""u"".""user_id"""
180,"WITH ""allothers"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""group2"" AS (SELECT DISTINCT (""gold_medal"") FROM (SELECT ""contest_id"",""gold_medal"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""gold_medal"" ORDER BY ""contest_id"") AS ""diff"" FROM ""allothers"" ORDER BY ""gold_medal"",""contest_id"") AS ""g"" GROUP BY ""gold_medal"",""diff"" HAVING COUNT(""gold_medal"")>=3 UNION SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""group2"")"
181,"WITH ""t1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ((SELECT DISTINCT ""a"".""medal"" AS ""user_id"" FROM (""t1"" AS ""a"" LEFT JOIN ""t1"" AS ""b"" ON ""a"".""medal""=""b"".""medal"") LEFT JOIN ""t1"" AS ""c"" ON ""a"".""medal""=""c"".""medal"" WHERE ""a"".""contest_id""+1=""b"".""contest_id"" AND ""a"".""contest_id""+2=""c"".""contest_id"" UNION SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)) AS ""d"" JOIN ""Users"" AS ""u"" ON ""d"".""user_id""=""u"".""user_id"""
182,"SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN (WITH ""u"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"",'gold' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"",'silver' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"",'bronze' AS ""type"" FROM ""Contests"") SELECT ""medal"" FROM ""u"" WHERE ""type""='gold' GROUP BY ""medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""m"".""medal"" FROM (""u"" AS ""f"" CROSS JOIN ""u"" AS ""m"") JOIN ""u"" AS ""l"" ON (""f"".""contest_id""=""m"".""contest_id""-1 AND ""f"".""contest_id""=""l"".""contest_id""-2) AND (""f"".""medal""=""m"".""medal"") AND (""f"".""medal""=""l"".""medal"")) AS ""x"" ON ""x"".""medal""=""u"".""user_id"""
183,"WITH ""tmp"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""contests"" ORDER BY ""user_id"",""contest_id"") SELECT ""name"",""mail"" FROM (SELECT * FROM ""tmp"" WHERE ""medal""='gold') AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1,2 HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""name"",""mail"" FROM (SELECT *,LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lead_contest"" FROM ""tmp"") AS ""a"" JOIN ""users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" WHERE ""lead_contest""-""contest_id""=2"
184,"WITH ""cte0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""cte0""), ""cte2"" AS (SELECT ""user_id"" FROM ""cte1"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(""user_id"")>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"""
185,"WITH ""medalinfo"" AS (SELECT * FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"") AS ""a""), ""threecons"" AS (SELECT DISTINCT ""a"".""medal"" FROM ""medalinfo"" AS ""a"" LEFT JOIN ""medalinfo"" AS ""b"" ON ""a"".""medal""=""b"".""medal"" WHERE ""a"".""contest_id"" BETWEEN ""b"".""contest_id""-2 AND ""b"".""contest_id"" GROUP BY ""a"".""medal"",""a"".""contest_id"" HAVING COUNT(DISTINCT ""b"".""contest_id"")=3 ORDER BY 1), ""goldinfo"" AS (SELECT ""gold_medal"" AS ""medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(DISTINCT ""contest_id"")>=3), ""usersinfo"" AS (SELECT ""medal"" AS ""user_id"" FROM ""goldinfo"" UNION SELECT ""medal"" AS ""user_id"" FROM ""threecons"") SELECT ""name"",""mail"" FROM ""users"" AS ""a"" JOIN ""usersinfo"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"""
186,"WITH ""GOLD_CANDIDATE"" AS (SELECT ""GOLD_MEDAL"" FROM ""CONTESTS"" GROUP BY ""GOLD_MEDAL"" HAVING COUNT(1)>=3), ""WINNER_RECORD"" AS ((SELECT ""contest_id"",""GOLD_MEDAL"" AS ""WINNER"" FROM ""CONTESTS"") UNION (SELECT ""contest_id"",""SILVER_MEDAL"" AS ""WINNER"" FROM ""CONTESTS"") UNION (SELECT ""contest_id"",""BRONZE_MEDAL"" AS ""WINNER"" FROM ""CONTESTS"")), ""SERIES_CANDIDATE"" AS (SELECT ""W1"".""WINNER"" FROM (""WINNER_RECORD"" AS ""W1"" JOIN ""WINNER_RECORD"" AS ""W2"" ON ""W1"".""WINNER""=""W2"".""WINNER"" AND ""W1"".""contest_id""=""W2"".""contest_id""-1) JOIN ""WINNER_RECORD"" AS ""W3"" ON ""W1"".""WINNER""=""W3"".""WINNER"" AND ""W1"".""contest_id""=""W3"".""contest_id""-2) SELECT ""NAME"",""MAIL"" FROM ""USERS"" WHERE ""USER_ID"" IN (SELECT * FROM ""SERIES_CANDIDATE"") OR ""USER_ID"" IN (SELECT * FROM ""GOLD_CANDIDATE"")"
187,"WITH ""t"" AS ((SELECT ""gold_medal"" AS ""uid"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) UNION (WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""uid"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""uid"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""uid"" FROM ""contests"") SELECT DISTINCT ""t"".""uid"" FROM ""t"" JOIN ""t"" AS ""t2"" ON ""t2"".""contest_id"">=""t"".""contest_id""-2 AND ""t2"".""contest_id""<=""t"".""contest_id"" AND ""t"".""uid""=""t2"".""uid"" GROUP BY ""t"".""contest_id"",""t"".""uid"" HAVING COUNT(""t2"".""uid"")>=3)) SELECT ""name"",""mail"" FROM ""t"" JOIN ""users"" ON ""uid""=""user_id"""
188,"WITH ""won_medal"" AS (SELECT ""contest_id"",""Users"".""user_id"" FROM ""Contests"" JOIN ""Users"" ON (""Users"".""user_id""=""Contests"".""gold_medal"") OR (""Users"".""user_id""=""Contests"".""silver_medal"") OR (""Users"".""user_id""=""Contests"".""bronze_medal"")), ""any_medal"" AS (SELECT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lead_"",LAG(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_"" FROM ""won_medal"" AS ""A"") AS ""A"" WHERE ""lead_""-""contest_id""=1 AND ""contest_id""-""lag_""=1), ""gold_candidates"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""all_candidates"" AS (SELECT * FROM ""gold_candidates"" UNION SELECT * FROM ""any_medal"") SELECT ""Users"".""name"",""Users"".""mail"" FROM ""Users"" JOIN ""all_candidates"" ON ""Users"".""user_id""=""all_candidates"".""user_id"""
189,"WITH ""table1"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""table2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""row_num"" FROM ""table1"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN (SELECT ""user_id"" FROM ""table2"" GROUP BY ""user_id"",""contest_id""-""row_num"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""t"" ON ""u"".""user_id""=""t"".""user_id"""
190,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
191,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests""), ""b"" AS (SELECT DISTINCT ""id"" FROM (SELECT ""id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""id"" ORDER BY ""contest_id"")-""contest_id"" AS ""diff"" FROM ""a"") AS ""t1"" WHERE ""diff""=2), ""c"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN (SELECT ""id"" FROM ""b"" UNION SELECT ""id"" FROM ""c"") AS ""t2"" ON ""u"".""user_id""=""t2"".""id"""
192,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" JOIN (SELECT DISTINCT ""C1"".""user_id"" FROM (""cte"" AS ""C1"" LEFT JOIN ""cte"" AS ""C2"" ON ""C1"".""contest_id""=""C2"".""contest_id""+1) LEFT JOIN ""cte"" AS ""C3"" ON ""C1"".""contest_id""=""C3"".""contest_id""-1 WHERE ""C1"".""user_id""=""C2"".""user_id"" AND ""C1"".""user_id""=""C3"".""user_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""T"" USING (""user_id"")"
193,"WITH ""tmp1"" AS (SELECT ""gold_medal"" AS ""user"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""tmp2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user"" FROM ""Contests""), ""tmp3"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""tmp2""), ""tmp4"" AS (SELECT ""user"" FROM ""tmp3"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""user"" FROM ""tmp1"") SELECT ""name"",""mail"" FROM ""Users"" JOIN ""tmp4"" ON ""user_id""=""user"""
194,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"",'bronze' AS ""medal"" FROM ""contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT ""winner"" FROM (SELECT ""winner"",""contest_id"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""nextone"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""nexttwo"" FROM ""cte"") AS ""sub"" WHERE ""sub"".""contest_id""+1=""sub"".""nextone"" AND ""sub"".""nextone""+1=""sub"".""nexttwo"" UNION SELECT ""winner"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY 1 HAVING COUNT(""contest_id"")>=3) AS ""sub2"" ON ""u"".""user_id""=""sub2"".""winner"""
195,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte2"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cnt"" FROM ""cte2"") AS ""F"" WHERE ""F"".""cnt""-""F"".""contest_id""=2 UNION SELECT ""user_id"" FROM ""cte1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" JOIN ""users"" AS ""u"" USING (""user_id"") ORDER BY ""user_id"""
196,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) OR ""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM (""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""cte"" AS ""c3"" ON ""c1"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""+2=""c3"".""contest_id"")"
197,"SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"",DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""rnk"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"",(""tmp"".""contest_id""-""rnk"") HAVING COUNT(""tmp"".""contest_id""-""rnk"")>=3 UNION SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"" HAVING COUNT(""contest_id"")>=3"
198,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3), ""alltbl"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""tmp"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cnt"" FROM ""alltbl""), ""final"" AS (SELECT DISTINCT ""user_id"" FROM ""tmp"" WHERE ""cnt"">=3 UNION SELECT ""user_id"" FROM ""gold"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""final"")"
199,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
200,"WITH ""m"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>2) OR ""user_id"" IN (SELECT ""m3"".""user_id"" FROM (""m"" AS ""m1"" JOIN ""m"" AS ""m2"" ON ""m1"".""contest_id""=""m2"".""contest_id""-1 AND ""m1"".""user_id""=""m2"".""user_id"") JOIN ""m"" AS ""m3"" ON ""m2"".""user_id""=""m3"".""user_id"" AND ""m2"".""contest_id""=""m3"".""contest_id""-1 GROUP BY 1)"
201,"WITH ""TEMP"" AS (SELECT ""user_id"",""contest_id"" FROM ""Contests"" AS ""C"" JOIN ""USERS"" AS ""U"" ON ""C"".""gold_medal""=""U"".""user_id"" OR ""C"".""silver_medal""=""U"".""user_id"" OR ""C"".""bronze_medal""=""U"".""user_id""), ""CON1"" AS (SELECT ""T1"".""user_id"" FROM ((""TEMP"" AS ""T1"") CROSS JOIN ""TEMP"" AS ""T2"") CROSS JOIN ""TEMP"" AS ""T3"" WHERE (""T1"".""user_id""=""T2"".""user_id"" AND ""T2"".""user_id""=""T3"".""user_id"" AND ""T1"".""contest_id""+1=""T2"".""contest_id"" AND ""T2"".""contest_id""+1=""T3"".""contest_id"") GROUP BY 1) SELECT ""name"",""mail"" FROM ""USERS"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""CON1"") OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3)"
202,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""t3"" AS (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_contest"" FROM ""t2"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"" WHERE ""lag_contest""-""contest_id""=2)"
203,"WITH ""c1"" AS (SELECT ""medal"" FROM (SELECT ""contest_id"",""medal"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""nx"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") AS ""sub1"") AS ""sub2"" WHERE ""nx""-""contest_id""=2), ""c2"" AS (SELECT ""gold_medal"" AS ""medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN (SELECT ""c1"".""medal"" FROM ""c1"" UNION SELECT ""c2"".""medal"" FROM ""c2"") AS ""s"" ON ""u"".""user_id""=""s"".""medal"""
204,"WITH ""squeezed"" AS (SELECT ""contest_id"",""gold_medal"" AS ""uid"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""uid"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""uid"" FROM ""Contests""), ""w"" AS (SELECT ""contest_id"",""uid"",LAG(""contest_id"", 2) OVER (PARTITION BY ""uid"" ORDER BY ""contest_id"") AS ""prev"" FROM ""squeezed""), ""t2"" AS (SELECT ""uid"" FROM ""w"" WHERE ""contest_id""-""prev""=2) SELECT ""name"",""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""uid""=""u"".""user_id"" UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3"
205,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (""new_c"" AS ""a"" LEFT JOIN ""new_c"" AS ""b"" ON ""a"".""contest_id""+1=""b"".""contest_id"") LEFT JOIN ""new_c"" AS ""c"" ON ""a"".""contest_id""+2=""c"".""contest_id"" WHERE ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id""), ""case2"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""user_id"" FROM ""case1"" UNION SELECT ""user_id"" FROM ""case2"") AS ""d"" JOIN ""users"" AS ""u"" ON ""d"".""user_id""=""u"".""user_id"""
206,"WITH ""res_temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""B"".""name"",""B"".""mail"" FROM (SELECT DISTINCT ""A"".""user_id"" FROM (""res_temp"" AS ""A"" JOIN ""res_temp"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" AND ""A"".""contest_id""+1=""B"".""contest_id"") JOIN ""res_temp"" AS ""C"" ON ""B"".""user_id""=""C"".""user_id"" AND ""B"".""contest_id""+1=""C"".""contest_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""A"" LEFT JOIN ""Users"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"""
207,"WITH ""m"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""user_id"" FROM ""m"" WHERE ROW(""contest_id""+1,""user_id"") IN (SELECT * FROM ""m"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT * FROM ""m"") UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"""
208,"WITH ""cte"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""cte2"" AS (SELECT DISTINCT ""a"".""medal"" FROM (""cte1"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""medal""=""b"".""medal"" AND ""a"".""contest_id""=""b"".""contest_id""-1) JOIN ""cte1"" AS ""c"" ON ""a"".""medal""=""c"".""medal"" AND ""a"".""contest_id""=""c"".""contest_id""-2) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""cte"" UNION SELECT * FROM ""cte2"")"
209,"WITH ""allMedals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""t1"" AS (SELECT ""a1"".""medal"" FROM (""allMedals"" AS ""a1"" JOIN ""allMedals"" AS ""a2"" ON ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a1"".""medal""=""a2"".""medal"") JOIN ""allMedals"" AS ""a3"" ON ""a1"".""contest_id""+2=""a3"".""contest_id"" AND ""a1"".""medal""=""a3"".""medal""), ""t2"" AS (SELECT DISTINCT ""medal"" FROM ""t1"" UNION SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""Users"" AS ""u"" ON ""t2"".""medal""=""u"".""user_id"""
210,"WITH ""c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT ""name"",""mail"" FROM (((""users"" AS ""u"") CROSS JOIN ""c"" AS ""c1"") CROSS JOIN ""c"" AS ""c2"") CROSS JOIN ""c"" AS ""c3"" WHERE ""u"".""user_id""=""c1"".""user_id"" AND ""u"".""user_id""=""c2"".""user_id"" AND ""u"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1 UNION SELECT ""name"",""mail"" FROM (""users"" AS ""u"") CROSS JOIN ""contests"" AS ""c"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(1)>=3"
211,"WITH ""cte"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""Gold"",CASE WHEN ""u"".""user_id""=""c"".""silver_medal"" THEN 1 ELSE 0 END AS ""Silver"",CASE WHEN ""u"".""user_id""=""c"".""bronze_medal"" THEN 1 ELSE 0 END AS ""Bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") (SELECT ""name"",""mail"" FROM ""CTE"" GROUP BY ""name"",""mail"" HAVING SUM(""gold"")>=3) UNION (SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""e"".""name"",""e"".""mail"",SUM(""Gold""+""Silver""+""Bronze"") OVER (PARTITION BY ""name"", ""mail"", ""grp"" ORDER BY ""c"".""contest_id"") AS ""medalsum"" FROM ""contests"" AS ""c"" LEFT JOIN ""CTE"" AS ""e"" ON ""c"".""contest_id""=""e"".""contest_id"") AS ""a"" WHERE ""medalsum"">=3)"
212,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT ""name"",""mail"" FROM ""Users"" JOIN (SELECT DISTINCT ""C1"".""user_id"" FROM (""cte"" AS ""C1"" LEFT JOIN ""cte"" AS ""C2"" ON ""C1"".""contest_id""=""C2"".""contest_id""+1) LEFT JOIN ""cte"" AS ""C3"" ON ""C1"".""contest_id""=""C3"".""contest_id""-1 WHERE ""C1"".""user_id""=""C2"".""user_id"" AND ""C1"".""user_id""=""C3"".""user_id"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""T"" USING (""user_id"")"
213,"WITH ""contests_union"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""category"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""category"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""category"" FROM ""Contests"" ORDER BY ""contest_id"") SELECT ""user"".""name"" AS ""name"",""user"".""mail"" AS ""mail"" FROM ""Users"" AS ""user"" JOIN (SELECT ""user_id"" FROM (SELECT ""gold_medal"" AS ""user_id"",COUNT(""contest_id"") AS ""gold"" FROM ""Contests"" GROUP BY ""user_id"" HAVING ""gold"">=3) AS ""A"" UNION SELECT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",COALESCE(LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id""), 0) AS ""lead_1"",COALESCE(LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id""), 0) AS ""lead_2"" FROM ""contests_union"") AS ""C"" WHERE (""contest_id""+1)=""lead_1"" AND (""contest_id""+2=""lead_2"")) AS ""D"" ON ""user"".""user_id""=""D"".""user_id"""
214,"WITH ""CTE1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""userid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""userid"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""userid"" FROM ""Contests""), ""CTE2"" AS (SELECT DISTINCT ""C1"".""userid"" FROM ((""CTE1"" AS ""C1"") CROSS JOIN ""CTE1"" AS ""C2"") CROSS JOIN ""CTE1"" AS ""C3"" WHERE ""C1"".""contest_id""=""C2"".""contest_id""+1 AND ""C2"".""contest_id""=""C3"".""contest_id""+1 AND ""C1"".""userid""=""C2"".""userid"" AND ""C2"".""userid""=""C3"".""userid"") SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>2) UNION SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""CTE2"")"
215,"WITH ""medal_list"" AS (SELECT ""medal"",CASE WHEN (""contest_id""-LEAD(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"" DESC))=2 THEN 1 ELSE 0 END AS ""con1"",SUM(CASE WHEN ""type""='gold' THEN 1 ELSE 0 END) OVER (PARTITION BY ""medal"") AS ""con2"" FROM (SELECT ""gold_medal"" AS ""medal"",'gold' AS ""type"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""medal"",'silver' AS ""type"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""medal"",'bronze' AS ""type"",""contest_id"" FROM ""contests"") AS ""sub1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""medal_list"" AS ""m"" ON ""m"".""medal""=""u"".""user_id"" GROUP BY 1,2 HAVING MAX(""m"".""con1"")=1 OR MAX(""m"".""con2"")>=3"
216,"WITH ""gold_cand"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3), ""usermedals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""medals"" AS (SELECT ""user_id"" FROM (SELECT ""user_id"",""contest_id""-(ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""diff"" FROM ""usermedals"") AS ""T"" GROUP BY ""user_id"",""diff"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""gold_cand"" UNION SELECT ""user_id"" FROM ""medals"")"
217,"WITH ""t"" AS (SELECT ""user_id"",""mail"",""name"",""gold_medal"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""users"" JOIN ""contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""user_id"",""diff"" HAVING COUNT(1)>=3 UNION SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
218,"WITH ""cte"" AS (SELECT ""u"".*,""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""users"" AS ""u"" LEFT JOIN ""contests"" AS ""c"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
219,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
220,"WITH ""t"" AS (SELECT ""user_id"",""mail"",""name"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""users"" JOIN ""contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""user_id"",""diff"" HAVING COUNT(1)>=3 UNION SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
221,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
222,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests""), ""t2"" AS (SELECT ""id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""seq"" FROM ""t""), ""t3"" AS (SELECT ""id"" FROM ""t2"" GROUP BY ""seq"",""id"" HAVING COUNT(1)>=3), ""t4"" AS (SELECT * FROM ""t3"" UNION SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""t4"" JOIN ""users"" AS ""u"" ON ""t4"".""id""=""u"".""user_id"""
223,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
224,"WITH ""cont"" AS ((SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"")) SELECT ""name"",""mail"" FROM (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3 UNION (SELECT DISTINCT ""c1"".""user_id"" FROM (""cont"" AS ""c1"" CROSS JOIN ""cont"" AS ""c2"") JOIN ""cont"" AS ""c3"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"" WHERE ""c2"".""contest_id""=""c1"".""contest_id""+1 AND ""c3"".""contest_id""=""c1"".""contest_id""+2)) AS ""int_cand"" JOIN ""Users"" AS ""u"" ON ""int_cand"".""user_id""=""u"".""user_id"""
225,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""t2"".""name"",""t2"".""mail"" FROM (SELECT ""user_id"",""mail"",""name"",CASE WHEN (LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""-1) AND (LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+1) THEN 1 ELSE 0 END AS ""flag"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""mail"",""u"".""name"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") AS ""t1"") AS ""t2"" WHERE ""flag""=1 GROUP BY ""user_id"""
226,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
227,"WITH ""main"" AS (SELECT ""user_id"",""mail"",""name"",(CASE WHEN (""contest_id""+2)=LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") THEN 1 ELSE 0 END) AS ""qualifying"" FROM ""Users"" JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT DISTINCT ""mail"",""name"" FROM ""Users"" JOIN ""Contests"" ON ""user_id""=""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""mail"",""name"" FROM ""main"" WHERE ""qualifying""=1"
228,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests""), ""ctf"" AS (SELECT ""id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""cte""), ""rt"" AS (SELECT DISTINCT ""id"" AS ""user_id"" FROM ""ctf"" GROUP BY ""id"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM (""users"") CROSS JOIN ""rt"" WHERE ""users"".""user_id""=""rt"".""user_id"""
229,"SELECT ""t2"".""name"",""t2"".""mail"" FROM ""Contests"" AS ""t1"" JOIN ""Users"" AS ""t2"" ON ""t1"".""gold_medal""=""t2"".""user_id"" GROUP BY ""t2"".""user_id"" HAVING COUNT(""t1"".""contest_id"")>=3 UNION SELECT ""t3"".""name"",""t3"".""mail"" FROM (((""Users"" AS ""t3"") CROSS JOIN ""Contests"" AS ""t4"") CROSS JOIN ""Contests"" AS ""t5"") CROSS JOIN ""Contests"" AS ""t6"" WHERE ""t3"".""user_id"" IN (""t4"".""gold_medal"",""t4"".""silver_medal"",""t4"".""bronze_medal"") AND ""t3"".""user_id"" IN (""t5"".""gold_medal"",""t5"".""silver_medal"",""t5"".""bronze_medal"") AND ""t3"".""user_id"" IN (""t6"".""gold_medal"",""t6"".""silver_medal"",""t6"".""bronze_medal"") AND ""t4"".""contest_id""-1=""t5"".""contest_id"" AND ""t5"".""contest_id""-1=""t6"".""contest_id"""
230,"WITH ""cte"" AS (SELECT ""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""consecutive"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""t"") SELECT ""us"".""name"",""us"".""mail"" FROM (SELECT ""user_id"" FROM ""cte"" GROUP BY ""user_id"",""consecutive"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3) AS ""u"" JOIN ""Users"" AS ""us"" ON ""u"".""user_id""=""us"".""user_id"""
231,"WITH ""T1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""T2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"" ORDER BY ""contest_id""), ""T3"" AS (SELECT ""contest_id"",""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""series_id"" FROM ""T2""), ""T4"" AS (SELECT ""contest_id"",""user_id"" FROM ""T3"" WHERE ROW(""user_id"",""series_id"") IN (SELECT ""user_id"",""series_id"" FROM ""T3"" GROUP BY ""user_id"",""series_id"" HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""T1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""T4"")"
232,"WITH ""T1"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""T2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"" ORDER BY ""contest_id""), ""T3"" AS (SELECT ""contest_id"",""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""series_id"" FROM ""T2""), ""T4"" AS (SELECT ""contest_id"",""user_id"" FROM ""T3"" WHERE ROW(""user_id"",""series_id"") IN (SELECT ""user_id"",""series_id"" FROM ""T3"" GROUP BY ""user_id"",""series_id"" HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""T1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""T4"")"
233,"SELECT ""name"",""mail"" FROM (""users"") CROSS JOIN ""contests"" WHERE ""user_id""=""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3 UNION SELECT ""name"",""mail"" FROM (((""users"") CROSS JOIN ""contests"" AS ""c1"") CROSS JOIN ""contests"" AS ""c2"") CROSS JOIN ""contests"" AS ""c3"" WHERE ""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
234,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""c1"".""id"" FROM ((""CTE"" AS ""c1"") CROSS JOIN ""CTE"" AS ""c2"") CROSS JOIN ""CTE"" AS ""c3"" WHERE ""c1"".""id""=""c2"".""id"" AND ""c2"".""id""=""c3"".""id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c3"".""contest_id""=""c2"".""contest_id""+1)"
235,"WITH ""flat_contests"" AS (SELECT ""contest_id"",""gold_medal"" AS ""player_id"",'gold_medal' AS ""medal_type"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""player_id"",'silver_medal' AS ""medal_type"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""player_id"",'bronze_medal' AS ""medal_type"" FROM ""contests""), ""ranked_contests"" AS (SELECT ""contest_id"",""player_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""player_id"" ORDER BY ""contest_id"") AS ""third_win"",SUM(CASE WHEN ""medal_type""='gold_medal' THEN 1 ELSE 0 END) OVER (PARTITION BY ""player_id"") AS ""gold_wins"" FROM ""flat_contests"") SELECT DISTINCT ""name"",""mail"" FROM ""ranked_contests"" AS ""r"" JOIN ""Users"" AS ""u"" ON ""r"".""player_id""=""u"".""user_id"" WHERE ""gold_wins"">=3 OR ""third_win""-""contest_id""=2"
236,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
237,"SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""gold_medal""=""user_id"") AS ""goldwon"" FROM (""contests"" AS ""c"") CROSS JOIN ""users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""user_id"" HAVING ""goldwon"">=3) AS ""a"" UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
238,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""c"".""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ((""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c2"".""contest_id""-""c1"".""contest_id""=1 AND ""c1"".""gold_medal""=""c2"".""gold_medal"") JOIN ""cte"" AS ""c3"" ON ""c3"".""contest_id""-""c1"".""contest_id""=2 AND ""c3"".""gold_medal""=""c2"".""gold_medal"") LEFT JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""c1"".""gold_medal"""
239,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
240,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
241,"WITH ""contests_union"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""category"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""category"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""category"" FROM ""Contests"" ORDER BY ""contest_id"") SELECT ""user"".""name"" AS ""name"",""user"".""mail"" AS ""mail"" FROM ""Users"" AS ""user"" JOIN (SELECT ""user_id"" FROM (SELECT ""gold_medal"" AS ""user_id"",COUNT(""contest_id"") AS ""gold"" FROM ""Contests"" GROUP BY ""user_id"" HAVING ""gold"">=3) AS ""A"" UNION SELECT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",COALESCE(LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id""), 0) AS ""lead_1"",COALESCE(LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id""), 0) AS ""lead_2"" FROM ""contests_union"") AS ""C"" WHERE (""contest_id""+1)=""lead_1"" AND (""contest_id""+2=""lead_2"")) AS ""D"" ON ""user"".""user_id""=""D"".""user_id"""
242,"SELECT ""name"",""mail"" FROM (WITH ""tmp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""tmp2"" AS (SELECT * FROM ""tmp"" ORDER BY ""user_id"",""contest_id""), ""tmp3"" AS (SELECT DISTINCT ""t1"".""user_id"" FROM (""tmp2"" AS ""t1"" LEFT JOIN ""tmp2"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""contest_id""=""t2"".""contest_id""+1) LEFT JOIN ""tmp2"" AS ""t3"" ON ""t2"".""user_id""=""t3"".""user_id"" AND ""t2"".""contest_id""=""t3"".""contest_id""+1 WHERE ""t3"".""contest_id"" IS NOT NULL) SELECT ""Users"".""name"",""Users"".""mail"" FROM ""tmp3"" LEFT JOIN ""Users"" ON ""tmp3"".""user_id""=""Users"".""user_id"" GROUP BY 1,2 UNION ALL SELECT ""t2"".""name"",""t2"".""mail"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"") AS ""t1"" LEFT JOIN ""Users"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" GROUP BY 1,2 HAVING COUNT(1)>=3) AS ""t5"" GROUP BY 1,2"
243,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
244,"SELECT ""a"".""name"",""a"".""mail"" FROM (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_two"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id"" IN (""c"".""gold_medal"",""c"".""silver_medal"",""c"".""bronze_medal"")) AS ""a"" GROUP BY ""user_id"" HAVING SUM(""user_id""=""gold_medal"")>=3 OR SUM(""contest_id""-""lag_two""=2)>=1"
245,"WITH ""t"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests""), ""opt1"" AS (SELECT ""user_id"",""contest_id""-""rk"",COUNT(1) FROM (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rk"" FROM ""t"") AS ""t1"" GROUP BY 1,2 HAVING COUNT(1)>=3), ""opt2"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM ""opt1"") OR ""user_id"" IN (SELECT DISTINCT ""gold_medal"" FROM ""opt2"")"
246,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
247,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_contest"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""lag_contest""=2)>=1"
248,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
249,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"" WHERE ""c1"".""contest_id"" IS NOT NULL) SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
250,"WITH ""t1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM (SELECT ""p1"".""contest_id"" AS ""contest_id"",""p1"".""user_id"",""p2"".""contest_id"" AS ""next_contest_id"" FROM ""t2"" AS ""p1"" LEFT JOIN ""t2"" AS ""p2"" ON ""p1"".""user_id""=""p2"".""user_id"" AND (""p2"".""contest_id""-""p1"".""contest_id"") BETWEEN 0 AND 2) AS ""t"" GROUP BY ""contest_id"",""user_id"" HAVING COUNT(""next_contest_id"")=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
251,"WITH ""contest_unpivot"" AS (SELECT ""u"".""name"",""u"".""mail"",""a"".""contest_id"",""a"".""type"",ROW_NUMBER() OVER (PARTITION BY ""a"".""contestant_id"" ORDER BY ""a"".""contest_id"") AS ""row_num"" FROM (SELECT ""contest_id"",'gold' AS ""type"",""gold_medal"" AS ""contestant_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""type"",""silver_medal"" AS ""contestant_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""type"",""bronze_medal"" AS ""contestant_id"" FROM ""Contests"") AS ""a"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""a"".""contestant_id"") SELECT ""u"".""name"",""u"".""mail"" FROM ""contest_unpivot"" AS ""u"" GROUP BY ""name"",""mail"",""contest_id""-""row_num"" HAVING COUNT(1)>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""contest_unpivot"" AS ""u"" WHERE ""type""='gold' GROUP BY ""name"",""mail"" HAVING COUNT(""type"")>=3"
252,"WITH ""cte"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""Gold"",CASE WHEN ""u"".""user_id""=""c"".""silver_medal"" THEN 1 ELSE 0 END AS ""Silver"",CASE WHEN ""u"".""user_id""=""c"".""bronze_medal"" THEN 1 ELSE 0 END AS ""Bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""Gold""+""Silver""+""Bronze"") OVER (PARTITION BY ""name"", ""mail"", ""grp"" ORDER BY ""contest_id"") AS ""medalsum"",SUM(""GOLD"") OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""contest_id"") AS ""goldsum"" FROM ""CTE"") AS ""a"" WHERE ""medalsum"">=3 OR ""goldsum"">=3"
253,"WITH ""g"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3), ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"" ORDER BY ""contest_id""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cnt"" FROM ""t"") AS ""F"" WHERE ""F"".""cnt""-""F"".""contest_id""=2 UNION SELECT ""user_id"" FROM ""g"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" JOIN ""Users"" AS ""u"" USING (""user_id"") ORDER BY ""user_id"""
254,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""r"" FROM ""cte1"" GROUP BY 1,2), ""cte3"" AS (SELECT ""user_id"" FROM ""cte2"" GROUP BY ""user_id"",""contest_id""-""r"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""cte3"" JOIN ""Users"" USING (""user_id"")"
255,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""a"".""medal"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""medal""=""b"".""medal"" AND ""b"".""medal""=""c"".""medal"" AND ""b"".""contest_id""=""a"".""contest_id""+1 AND ""c"".""contest_id""=""b"".""contest_id""+1) UNION SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3)"
256,"SELECT ""u"".""name"",""u"".""mail"" FROM (""users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ((((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"") CROSS JOIN ""Contests"" AS ""c4"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
257,"WITH ""g"" AS (SELECT ""contest_id"",""gold_medal"" AS ""m"" FROM ""contests""), ""s"" AS (SELECT ""contest_id"",""silver_medal"" AS ""m"" FROM ""contests""), ""b"" AS (SELECT ""contest_id"",""bronze_medal"" AS ""m"" FROM ""contests""), ""criteria1"" AS (SELECT ""m"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""m"" ORDER BY ""contest_id"") AS ""3rd_contest_id"" FROM (SELECT * FROM ""g"" UNION SELECT * FROM ""s"" UNION SELECT * FROM ""b"") AS ""t""), ""criteria2"" AS (SELECT ""m"",COUNT(1) AS ""wins"" FROM ""g"" GROUP BY ""m"") SELECT ""u"".""name"" AS ""name"",""u"".""mail"" AS ""mail"" FROM (SELECT ""m"" FROM ""criteria1"" WHERE ""contest_id""+2=""3rd_contest_id"" UNION SELECT ""m"" FROM ""criteria2"" WHERE ""wins"">=3) AS ""c"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""m"""
258,"WITH ""userInfo"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""qualifUsers"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (SELECT ""user_id"",""contest_id""-LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff1"",""contest_id""-LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff2"" FROM ""userInfo"") AS ""a"" WHERE ""diff1""=1 AND ""diff2""=2), ""qualifUsers2"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM (""Users"" LEFT JOIN ""qualifUsers"" USING (""user_id"")) LEFT JOIN ""qualifUsers2"" USING (""user_id"") WHERE ""qualifUsers"".""user_id"" IS NOT NULL OR ""qualifUsers2"".""user_id"" IS NOT NULL"
259,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""condition1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""condition2"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""condition1"" UNION SELECT ""user_id"" FROM ""condition2"")"
260,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
261,"WITH ""CTE1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""CTE2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""CTE3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""delta"",COUNT(1) AS ""cnt"" FROM (SELECT ""contest_id"",""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""delta"" FROM ""CTE2"") AS ""sub1"" GROUP BY ""user_id"",""delta"") AS ""sub2"" WHERE ""cnt"">=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""CTE1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""CTE3"")"
262,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
263,"WITH ""gold_any"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3), ""contest_user"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""conse_medal"" AS (SELECT ""a"".""contest_id"",""a"".""user_id"" FROM ((""contest_user"" AS ""a"") CROSS JOIN ""contest_user"" AS ""b"") CROSS JOIN ""contest_user"" AS ""c"" WHERE ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id"" AND ""a"".""contest_id""-1=""b"".""contest_id"" AND ""b"".""contest_id""-1=""c"".""contest_id"" GROUP BY 1,2), ""all_po"" AS (SELECT * FROM (SELECT ""user_id"" FROM ""gold_any"" UNION ALL SELECT ""user_id"" FROM ""conse_medal"") AS ""temp"" GROUP BY 1) SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""all_po"" AS ""a"" ON ""u"".""user_id""=""a"".""user_id"""
264,"WITH ""T0"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""T1"" AS (SELECT ""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id""))-(DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""C"" FROM ""T0""), ""T2"" AS (SELECT ""user_id"" FROM ""T1"" GROUP BY ""user_id"",""C"" HAVING COUNT(1)>=3), ""T3"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3 UNION ALL SELECT * FROM ""T2"") SELECT DISTINCT ""A"".""name"",""A"".""mail"" FROM ""Users"" AS ""A"" JOIN ""T3"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"""
265,"SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"",DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""rnk"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY 1,2,(""tmp"".""contest_id""-""rnk"") HAVING COUNT(""tmp"".""contest_id""-""rnk"")>=3 UNION SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") AS ""tmp"" GROUP BY 1,2 HAVING COUNT(""contest_id"")>=3"
266,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""cte2"" AS (SELECT ""c1"".""user_id"" AS ""id"" FROM (""cte1"" AS ""c1"" JOIN ""cte1"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""cte1"" AS ""c3"" ON ""c2"".""user_id""=""c3"".""user_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"") SELECT ""u1"".""name"",""mail"" FROM ""cte2"" LEFT JOIN ""Users"" AS ""u1"" ON ""cte2"".""id""=""u1"".""user_id"" UNION SELECT ""U2"".""name"",""mail"" FROM (SELECT ""gold_medal"" AS ""gold_id"",COUNT(1) AS ""count1"" FROM ""Contests"" GROUP BY ""gold_medal"") AS ""a"" LEFT JOIN ""USers"" AS ""U2"" ON ""a"".""gold_id""=""U2"".""user_id"" WHERE ""count1"">=3"
267,"WITH ""t1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests""), ""t2"" AS (SELECT ""id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""num"" FROM ""t1""), ""t3"" AS (SELECT DISTINCT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""t2"" JOIN ""Users"" AS ""u"" ON ""t2"".""id""=""u"".""user_id"" GROUP BY ""id"",""contest_id""-""num"" HAVING COUNT(1)>=3 UNION SELECT ""name"",""mail"" FROM ""t3"" JOIN ""Users"" AS ""u"" ON ""t3"".""id""=""u"".""user_id"""
268,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""data"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests""), ""data1"" AS (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""c_rnk"" FROM ""data""), ""data2"" AS (SELECT ""user_id"" FROM ""data1"" GROUP BY ""user_id"",""contest_id""-""c_rnk"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""d2"".""user_id"" FROM ""data2"" AS ""d2"" UNION SELECT ""g"".""user_id"" FROM ""gold"" AS ""g"") AS ""c"" LEFT JOIN ""users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"""
269,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",CASE WHEN ""user_id"" IN (""gold_medal"",""silver_medal"",""bronze_medal"") THEN ""contest_id"" ELSE NULL END AS ""contest_won"",CASE WHEN ""user_id""=""gold_medal"" THEN 1 ELSE 0 END AS ""gold_med"" FROM ""Users"" AS ""u"" CROSS JOIN ""Contests"" AS ""c"" ORDER BY 1), ""days"" AS (SELECT ""user_id"",""mail"",""name"",""contest_won"",LEAD(""contest_won"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_won"") AS ""cont2"",LEAD(""contest_won"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_won"") AS ""cont3"",""gold_med"" FROM ""cte"" WHERE ""contest_won"" IS NOT NULL), ""consec"" AS (SELECT *,CASE WHEN (ABS(""cont2""-""contest_won"")+ABS(""cont2""-""cont3""))=2 THEN 'yes' ELSE 'no' END AS ""win"" FROM ""days"" WHERE ""cont2"" IS NOT NULL AND ""cont3"" IS NOT NULL) SELECT DISTINCT ""mail"",""name"" FROM ""consec"" WHERE ""win""='yes' UNION SELECT ""mail"",""name"" FROM ""days"" GROUP BY 1,2 HAVING SUM(""gold_med"")>=3"
270,"WITH ""cte"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""Gold"",CASE WHEN ""u"".""user_id""=""c"".""silver_medal"" THEN 1 ELSE 0 END AS ""Silver"",CASE WHEN ""u"".""user_id""=""c"".""bronze_medal"" THEN 1 ELSE 0 END AS ""Bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") (SELECT ""name"",""mail"" FROM ""CTE"" GROUP BY ""name"",""mail"" HAVING SUM(""gold"")>=3) UNION (SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""e"".""name"",""e"".""mail"",SUM(""Gold""+""Silver""+""Bronze"") OVER (PARTITION BY ""name"", ""mail"", ""grp"" ORDER BY ""c"".""contest_id"") AS ""medalsum"" FROM ""contests"" AS ""c"" LEFT JOIN ""CTE"" AS ""e"" ON ""c"".""contest_id""=""e"".""contest_id"") AS ""a"" WHERE ""medalsum"">=3)"
271,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
272,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
273,"WITH ""conts"" AS (SELECT ""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"",""c2"".""gold_medal"" AS ""c2_gold_medal"",""c2"".""silver_medal"" AS ""c2_silver_medal"",""c2"".""bronze_medal"" AS ""c2_bronze_medal"",""c3"".""gold_medal"" AS ""c3_gold_medal"",""c3"".""silver_medal"" AS ""c3_silver_medal"",""c3"".""bronze_medal"" AS ""c3_bronze_medal"",""c3"".""contest_id"" AS ""2_conts_ago"" FROM (""Contests"" AS ""c1"" LEFT JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""-1) LEFT JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_id""=""c1"".""contest_id""-2), ""cte"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""gold_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""gold_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"") UNION SELECT ""silver_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""silver_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""silver_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"") UNION SELECT ""bronze_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""bronze_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""bronze_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"")) SELECT ""u"".""name"",""u"".""mail"" FROM ""cte"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"""
274,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
275,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""users"".*,LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+2 AS ""sign"",SUM(""gold_medal""=""user_id"") OVER (PARTITION BY ""user_id"") AS ""gold"" FROM ""users"" LEFT JOIN ""contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") AS ""cte"" WHERE ""gold"">=3 OR ""sign""=1"
276,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""c"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id""-(ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""r"" FROM ""t"") AS ""tt"" GROUP BY ""user_id"",""r"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""user_id"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""c"" ON ""c"".""user_id""=""u"".""user_id"""
277,"WITH ""joined_contest"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""metal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'sliver' AS ""metal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""metal"" FROM ""Contests""), ""cte"" AS (SELECT ""user_id"",SUM(CASE WHEN ""metal""='gold' THEN 1 ELSE 0 END) OVER (PARTITION BY ""user_id"") AS ""num_gold_metals"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""row_num"",""contest_id"" FROM ""joined_contest""), ""u1"" AS (SELECT ""user_id"" FROM ""cte"" GROUP BY ""user_id"",""contest_id""-""row_num"" HAVING COUNT(1)>=3), ""u2"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""num_gold_metals"">=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""u1"") OR ""user_id"" IN (SELECT * FROM ""u2"")"
278,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""cte2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"" ORDER BY ""medal"",""contest_id""), ""cte3"" AS (SELECT DISTINCT ""a"".""medal"" AS ""user_id"" FROM (""cte2"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""medal""=""b"".""medal"" AND ""a"".""contest_id""=""b"".""contest_id""-1) JOIN ""cte2"" AS ""c"" ON ""b"".""medal""=""c"".""medal"" AND ""b"".""contest_id""=""c"".""contest_id""-1) (SELECT ""a"".""name"",""a"".""mail"" FROM ""users"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"") UNION (SELECT ""a"".""name"",""a"".""mail"" FROM ""users"" AS ""a"" JOIN ""cte3"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"")"
279,"SELECT ""name"",""mail"" FROM ""Users"" JOIN (SELECT ""user_id"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""user_id"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"" AND ""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"")) AS ""t"" ON ""Users"".""user_id""=""t"".""user_id"""
280,"WITH ""c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user"" FROM ""contests""), ""cte"" AS (SELECT DISTINCT ""c1"".""user"" FROM (""c"" AS ""c1"" JOIN ""c"" AS ""c2"" ON ""c1"".""user""=""c2"".""user"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1) JOIN ""c"" AS ""c3"" ON ""c2"".""user""=""c3"".""user"" AND ""c2"".""contest_id""=""c3"".""contest_id""-1 UNION SELECT ""gold_medal"" AS ""user"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" JOIN ""cte"" ON ""users"".""user_id""=""cte"".""user"""
281,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
282,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""cte1""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM ""cte2"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(1)>=3), ""cte4"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""cte3"" UNION SELECT * FROM ""cte4"")"
283,"WITH ""cte1"" AS (SELECT ""gold_medal"",COUNT(1) FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""cte2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""cte3"" AS (SELECT ""c1"".""medal"" FROM ""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""medal""=""c2"".""medal"" AND ""c1"".""contest_id""-""c2"".""contest_id"" BETWEEN 1 AND 2 GROUP BY ""c1"".""medal"",""c1"".""contest_id"" HAVING COUNT(""c1"".""contest_id"")>=2 UNION SELECT ""gold_medal"" FROM ""cte1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""medal""=""u"".""user_id"""
284,"WITH ""ct"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2 UNION SELECT ""u"".""user_id"" FROM (((""users"" AS ""u"") CROSS JOIN ""contests"" AS ""c1"") CROSS JOIN ""contests"" AS ""c2"") CROSS JOIN ""contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1) SELECT ""name"",""mail"" FROM ""users"" JOIN ""ct"" ON ""users"".""user_id""=""ct"".""user_id"""
285,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"") SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
286,"WITH ""cte"" AS (SELECT DISTINCT ""a"".""name"",""a"".""mail"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""a"".""user_id"" ORDER BY ""contest_id"")-""contest_id"" AS ""DIFF2"" FROM ""Users"" AS ""a"" LEFT JOIN ""Contests"" AS ""b"" ON ""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal""), ""cte2"" AS (SELECT ""a"".""name"",""a"".""mail"",COUNT(1) AS ""gold"" FROM ""Users"" AS ""a"" LEFT JOIN ""Contests"" AS ""b"" ON ""a"".""user_id""=""b"".""gold_medal"" GROUP BY ""a"".""user_id"" HAVING ""gold"">=3) SELECT DISTINCT ""name"",""mail"" FROM ""cte"" WHERE ""DIFF2""=2 UNION SELECT DISTINCT ""name"",""mail"" FROM ""cte2"""
287,"WITH ""any_medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""winner_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""winner_id"" FROM ""contests""), ""gold_medals"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ""gold_medals"" AS ""gm"" LEFT JOIN ""Users"" AS ""u"" ON ""gm"".""gold_medal""=""u"".""user_id"" GROUP BY ""gm"".""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3 UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ((""any_medals"" AS ""am1"" JOIN ""any_medals"" AS ""am2"" ON ""am1"".""contest_id""+1=""am2"".""contest_id"" AND ""am1"".""winner_id""=""am2"".""winner_id"") JOIN ""any_medals"" AS ""am3"" ON ""am2"".""contest_id""+1=""am3"".""contest_id"" AND ""am2"".""winner_id""=""am3"".""winner_id"") JOIN ""users"" AS ""u"" ON ""am1"".""winner_id""=""u"".""user_id"""
288,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""cte2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""cte3"" AS (SELECT DISTINCT ""a"".""medal"" AS ""user_id"" FROM (""cte2"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""medal""=""b"".""medal"" AND ""a"".""contest_id""=""b"".""contest_id""-1) JOIN ""cte2"" AS ""c"" ON ""b"".""medal""=""c"".""medal"" AND ""b"".""contest_id""=""c"".""contest_id""-1) (SELECT ""a"".""name"",""a"".""mail"" FROM ""users"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"") UNION (SELECT ""a"".""name"",""a"".""mail"" FROM ""users"" AS ""a"" JOIN ""cte3"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"")"
289,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
290,"WITH ""T1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests""), ""T2"" AS (SELECT *,RANK() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""T1"" ORDER BY ""id"",""contest_id""), ""T3"" AS (SELECT ""id"" FROM ""T2"" GROUP BY (""contest_id""-""rnk""),""id"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""T3"" JOIN ""users"" ON ""T3"".""id""=""users"".""user_id"""
291,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
292,"SELECT ""name"",""mail"" FROM (""users"") CROSS JOIN ""contests"" WHERE ""user_id""=""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3 UNION SELECT ""name"",""mail"" FROM (((""users"") CROSS JOIN ""contests"" AS ""c1"") CROSS JOIN ""contests"" AS ""c2"") CROSS JOIN ""contests"" AS ""c3"" WHERE ""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
293,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"" WHERE ""c1"".""contest_id"" IS NOT NULL ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
294,"WITH ""num_gold"" AS (SELECT ""gold_medal"" AS ""user_id"",COUNT(1) AS ""num_gold"" FROM ""contests"" GROUP BY 1), ""consec_current_bronze"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""bronze_medal"" AS ""user_id"",LAG(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_bronze"",LAG(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_silver"",LAG(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_gold"",LAG(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_bronze"",LAG(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_silver"",LAG(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_gold"" FROM ""contests"") AS ""z1"" WHERE ""user_id"" IN (""prev1_bronze"",""prev1_silver"",""prev1_gold"") AND ""user_id"" IN (""prev2_bronze"",""prev2_silver"",""prev2_gold"")), ""consec_current_silver"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""silver_medal"" AS ""user_id"",LAG(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_bronze"",LAG(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_silver"",LAG(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_gold"",LAG(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_bronze"",LAG(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_silver"",LAG(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_gold"" FROM ""contests"") AS ""z1"" WHERE ""user_id"" IN (""prev1_bronze"",""prev1_silver"",""prev1_gold"") AND ""user_id"" IN (""prev2_bronze"",""prev2_silver"",""prev2_gold"")), ""consec_current_gold"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""gold_medal"" AS ""user_id"",LAG(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_bronze"",LAG(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_silver"",LAG(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""prev1_gold"",LAG(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_bronze"",LAG(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_silver"",LAG(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""prev2_gold"" FROM ""contests"") AS ""z1"" WHERE ""user_id"" IN (""prev1_bronze"",""prev1_silver"",""prev1_gold"") AND ""user_id"" IN (""prev2_bronze"",""prev2_silver"",""prev2_gold"")) SELECT ""name"",""mail"" FROM (SELECT ""user_id"" FROM ""num_gold"" WHERE ""num_gold"">=3 UNION SELECT ""user_id"" FROM ""consec_current_bronze"" UNION SELECT ""user_id"" FROM ""consec_current_silver"" UNION SELECT ""user_id"" FROM ""consec_current_gold"") AS ""zz"" LEFT JOIN ""users"" AS ""u"" ON ""zz"".""user_id""=""u"".""user_id"""
295,"WITH ""gold_tbl"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""cons_tbl"" AS (SELECT ""contest_id"",""user_id"",(""contest_id""-RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""a"") SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""gold_tbl"" AS ""g"" ON ""u"".""user_id""=""g"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""cons_tbl"" AS ""c"" ON ""u"".""user_id""=""c"".""user_id"" GROUP BY ""u"".""user_id"",""grp"" HAVING COUNT(""contest_id"")>=3"
296,"WITH ""tb1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""tb2"" AS (SELECT ""contest_id"",""medal"",""contest_id""-RANK() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""gp"" FROM ""tb1""), ""tb3"" AS (SELECT ""gold_medal"" AS ""medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2), ""tb4"" AS (SELECT DISTINCT ""medal"" FROM ""tb2"" GROUP BY ""medal"",""gp"" HAVING COUNT(1)>2) SELECT DISTINCT ""mail"",""name"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""medal"" FROM ""tb3"" UNION SELECT ""medal"" FROM ""tb4"")"
297,"WITH ""user_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold_medal' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver_medal' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze_medal' AS ""medal"" FROM ""Contests""), ""user_rn"" AS (SELECT ""user_id"",""contest_id"",""medal"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""user_medal""), ""stg"" AS (SELECT ""user_id"" FROM ""user_rn"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""user_id"" FROM ""user_medal"" WHERE ""medal""='gold_medal' GROUP BY ""user_id"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""stg"")"
298,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
299,"SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ((""contests"" AS ""c1"" JOIN ""contests"" AS ""c2"" ON ""c2"".""contest_id""-""c1"".""contest_id""=1) JOIN ""contests"" AS ""c3"" ON ""c3"".""contest_id""-""c2"".""contest_id""=1) JOIN ""users"" AS ""u"" ON ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) AS ""t"" JOIN ""users"" AS ""u"" ON ""t"".""gold_medal""=""u"".""user_id"""
300,"ERROR: mysql parse error: line 1 column 194 near ""select name, mail from users where user_id in (select gold_medal as 'id' from contests group by 1 having count(*) >= 3) or user_id in (select distinct a1.id from a a1, a a2, a a3 where a1.id = a2.id and a2.id = a3.id and a1.contest_id + 1 = a2.contest_id and a2.contest_id + 1 = a3.contest_id)"" "
301,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner"",'gold' AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""winner"",'bronze' AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""winner"",'silver' AS ""medal"" FROM ""contests""), ""t1"" AS (SELECT ""winner"",COUNT(1) AS ""num_gm"" FROM ""t"" WHERE ""medal""='gold' GROUP BY 1), ""t2"" AS (SELECT ""winner"",""contest_id"" AS ""con"",LEAD(""contest_id"") OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""next_con"",LAG(""contest_id"") OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""prev_con"" FROM ""t""), ""w"" AS (SELECT ""winner"",'g',""num_gm"" AS ""x"" FROM ""t1"" WHERE ""num_gm"">=3 UNION SELECT ""winner"",'c',""con"" AS ""x"" FROM ""t2"" WHERE (""next_con""-""con"")=1 AND (""con""-""prev_con"")=1) SELECT DISTINCT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""w"" ON ""u"".""user_id""=""w"".""winner"""
302,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""b"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""a""), ""c"" AS (SELECT ""user_id"" FROM ""b"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""c"" JOIN ""users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"""
303,"WITH ""tmp"" AS (SELECT ""u"",""contest_id"",LAG(""contest_id"", 1) OVER (PARTITION BY ""u"" ORDER BY ""contest_id"") AS ""pre1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""u"" ORDER BY ""contest_id"") AS ""pre2"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""u"" ORDER BY ""contest_id"") AS ""nxt1"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""u"" ORDER BY ""contest_id"") AS ""nxt2"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""u"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""u"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""u"" FROM ""Contests"") AS ""tmp""), ""tmp2"" AS (SELECT DISTINCT ""u"" FROM ""tmp"" WHERE (""pre1""=""contest_id""-1 AND ""pre2""=""contest_id""-2) OR (""pre1""=""contest_id""-1 AND ""nxt1""=""contest_id""+1) OR (""nxt1""=""contest_id""+1 AND ""nxt2""=""contest_id""+2) UNION (SELECT ""gold_medal"" AS ""u"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3)) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""u"" FROM ""tmp2"")"
304,"WITH ""winner_id"" AS (SELECT ""contest_id"",""gold_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""win_id"" FROM ""Contests""), ""three_win"" AS (SELECT DISTINCT ""sub"".""win_id"" FROM (SELECT ""w1"".""contest_id"",""w1"".""win_id"",""w2"".""win_id"" AS ""win_id2"",""w3"".""win_id"" AS ""win_id3"" FROM (""winner_id"" AS ""w1"" JOIN ""winner_id"" AS ""w2"" ON ""w1"".""contest_id""+1=""w2"".""contest_id"" AND ""w1"".""win_id""=""w2"".""win_id"") JOIN ""winner_id"" AS ""w3"" ON ""w2"".""contest_id""+1=""w3"".""contest_id"" AND ""w2"".""win_id""=""w3"".""win_id"") AS ""sub"" UNION ALL SELECT DISTINCT ""gold_medal"" AS ""gold_win_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""three_win"" AS ""t"" ON ""u"".""user_id""=""t"".""win_id"""
305,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
306,"WITH ""criteria_1"" AS (SELECT ""medal"" FROM (SELECT ""agg"".""medal"",""agg"".""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""agg"".""medal"" ORDER BY ""agg"".""contest_id"") AS ""req_rank"" FROM (SELECT ""gold_medal"" AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""medal"",""contest_id"" FROM ""contests"") AS ""agg"") AS ""FINAL"" GROUP BY ""medal"",""contest_id""-""req_rank"" HAVING COUNT(1)>=3), ""criteria_2"" AS (SELECT ""gold_medal"" AS ""medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(DISTINCT ""contest_id"")>2) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""medal"" FROM ""criteria_1"" UNION SELECT ""medal"" FROM ""criteria_2"") AS ""agg"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""agg"".""medal"""
307,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"" WHERE ""c1"".""contest_id"" IS NOT NULL ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
308,"WITH ""medals"" AS (SELECT ""gold_medal"" AS ""user_id"",'gold' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",'silver' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"",""contest_id"" FROM ""contests""), ""lagged_and_counted"" AS (SELECT ""user_id"",""medal"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"",COUNT(1) OVER (PARTITION BY ""user_id"", ""medal"") AS ""medal_count"" FROM ""medals"") SELECT DISTINCT ""name"",""mail"" FROM ""lagged_and_counted"" NATURAL CROSS JOIN ""Users"" WHERE ""contest_id""=""lag_2""+2 OR (""medal""='gold' AND ""medal_count"">=3)"
309,"SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""contest_id"",""user_id"",""medal"",COUNT(CASE WHEN ""medal""='gold' THEN ""contest_id"" END) OVER (PARTITION BY ""user_id"") AS ""goldcnt"",LEAD(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""ld"",LAG(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lg"" FROM (SELECT ""contest_id"",""user_id"",""medal"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests"") AS ""t"") AS ""t"") AS ""t"" WHERE ""goldcnt"">=3 OR (""contest_id""=""lg""+1 AND ""contest_id""=""ld""-1))"
310,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
311,"WITH ""base"" AS (SELECT ""gold_medal"" AS ""medal"",""contest_id"" FROM ""contests"" UNION SELECT ""silver_medal"" AS ""medal"",""contest_id"" FROM ""contests"" UNION SELECT ""bronze_medal"" AS ""medal"",""contest_id"" FROM ""contests"" ORDER BY ""medal"",""contest_id""), ""consec_winners"" AS (SELECT DISTINCT ""b1"".""medal"" AS ""user_id"" FROM ((""base"" AS ""b1"") CROSS JOIN ""base"" AS ""b2"") CROSS JOIN ""base"" AS ""b3"" WHERE ""b1"".""medal""=""b2"".""medal"" AND ""b2"".""medal""=""b3"".""medal"" AND ""b1"".""contest_id""=""b2"".""contest_id""-1 AND ""b2"".""contest_id""=""b3"".""contest_id""-1), ""gold_winners"" AS (SELECT ""user_id"" FROM (SELECT ""gold_medal"" AS ""user_id"",COUNT(DISTINCT ""contest_id"") AS ""count_gold"" FROM ""contests"" GROUP BY ""gold_medal"") AS ""sub"" WHERE ""count_gold"">=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""consec_winners"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""gold_winners"")"
312,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""cte1"" AS (SELECT DISTINCT ""t1"".""medal"" FROM (""cte"" AS ""t1"" CROSS JOIN ""cte"" AS ""t2"") JOIN ""cte"" AS ""t3"" ON ""t1"".""contest_id""+1=""t2"".""contest_id"" AND ""t2"".""contest_id""+1=""t3"".""contest_id"" AND ""t1"".""medal""=""t2"".""medal"" AND ""t2"".""medal""=""t3"".""medal"") SELECT ""name"",""mail"" FROM ""cte1"" JOIN ""Users"" ON ""cte1"".""medal""=""Users"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""Users"".""user_id""=""Contests"".""gold_medal"" GROUP BY ""Contests"".""gold_medal"" HAVING COUNT(""Contests"".""gold_medal"")>=3"
313,"WITH ""total_golds"" AS (SELECT ""gold_medal"" AS ""pl_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""all_medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""pl_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""pl_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""pl_id"" FROM ""Contests""), ""cons_medals"" AS (SELECT DISTINCT ""pl_id"" FROM (SELECT ""contest_id"",""pl_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""pl_id"" ORDER BY ""contest_id"") AS ""pre_pre_contest"" FROM ""all_medals"") AS ""C"" WHERE ""contest_id""-""pre_pre_contest""=2) SELECT ""U"".""name"",""U"".""mail"" FROM (SELECT * FROM ""total_golds"" UNION SELECT * FROM ""cons_medals"") AS ""W"" JOIN ""Users"" AS ""U"" ON ""W"".""pl_id""=""U"".""user_id"""
314,"WITH ""S0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""gold_medal0"",""silver_medal"" AS ""silver_medal0"",""bronze_medal"" AS ""bronze_medal0"" FROM ""Contests""), ""S1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""gold_medal1"",""silver_medal"" AS ""silver_medal1"",""bronze_medal"" AS ""bronze_medal1"" FROM ""Contests""), ""S2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""gold_medal2"",""silver_medal"" AS ""silver_medal2"",""bronze_medal"" AS ""bronze_medal2"" FROM ""Contests""), ""S3"" AS (SELECT DISTINCT (""gold_medal0"") AS ""user_id"" FROM (""S0"" JOIN ""S1"" ON ""S0"".""contest_id""+1=""S1"".""contest_id"") JOIN ""S2"" ON ""S0"".""contest_id""+2=""S2"".""contest_id"" WHERE (""gold_medal0""=""gold_medal1"" AND ""gold_medal1""=""gold_medal2"") OR (""gold_medal0""=""gold_medal1"" AND ""gold_medal1""=""silver_medal2"") OR (""gold_medal0""=""gold_medal1"" AND ""gold_medal1""=""bronze_medal2"") OR (""gold_medal0""=""silver_medal1"" AND ""silver_medal1""=""gold_medal2"") OR (""gold_medal0""=""silver_medal1"" AND ""silver_medal1""=""silver_medal2"") OR (""gold_medal0""=""silver_medal1"" AND ""silver_medal1""=""bronze_medal2"") OR (""gold_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""gold_medal2"") OR (""gold_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""silver_medal2"") OR (""gold_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""bronze_medal2"")), ""S4"" AS (SELECT DISTINCT (""silver_medal0"") AS ""user_id"" FROM (""S0"" JOIN ""S1"" ON ""S0"".""contest_id""+1=""S1"".""contest_id"") JOIN ""S2"" ON ""S0"".""contest_id""+2=""S2"".""contest_id"" WHERE (""silver_medal0""=""gold_medal1"" AND ""gold_medal1""=""gold_medal2"") OR (""silver_medal0""=""gold_medal1"" AND ""gold_medal1""=""silver_medal2"") OR (""silver_medal0""=""gold_medal1"" AND ""gold_medal1""=""bronze_medal2"") OR (""silver_medal0""=""silver_medal1"" AND ""silver_medal1""=""gold_medal2"") OR (""silver_medal0""=""silver_medal1"" AND ""silver_medal1""=""silver_medal2"") OR (""silver_medal0""=""silver_medal1"" AND ""silver_medal1""=""bronze_medal2"") OR (""silver_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""gold_medal2"") OR (""silver_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""silver_medal2"") OR (""silver_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""bronze_medal2"")), ""S5"" AS (SELECT DISTINCT (""bronze_medal0"") AS ""user_id"" FROM (""S0"" JOIN ""S1"" ON ""S0"".""contest_id""+1=""S1"".""contest_id"") JOIN ""S2"" ON ""S0"".""contest_id""+2=""S2"".""contest_id"" WHERE (""bronze_medal0""=""gold_medal1"" AND ""gold_medal1""=""gold_medal2"") OR (""bronze_medal0""=""gold_medal1"" AND ""gold_medal1""=""silver_medal2"") OR (""bronze_medal0""=""gold_medal1"" AND ""gold_medal1""=""bronze_medal2"") OR (""bronze_medal0""=""silver_medal1"" AND ""silver_medal1""=""gold_medal2"") OR (""bronze_medal0""=""silver_medal1"" AND ""silver_medal1""=""silver_medal2"") OR (""bronze_medal0""=""silver_medal1"" AND ""silver_medal1""=""bronze_medal2"") OR (""bronze_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""gold_medal2"") OR (""bronze_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""silver_medal2"") OR (""bronze_medal0""=""bronze_medal1"" AND ""bronze_medal1""=""bronze_medal2"")), ""S6"" AS (SELECT DISTINCT (""gold_medal"") AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""S7"" AS (SELECT ""user_id"" FROM ""S3"" UNION SELECT ""user_id"" FROM ""S4"" UNION SELECT ""user_id"" FROM ""S5"" UNION SELECT ""user_id"" FROM ""S6"") SELECT ""name"",""mail"" FROM ""S7"" JOIN ""Users"" ON ""S7"".""user_id""=""Users"".""user_id"""
315,"SELECT ""tb"".""name"" AS ""name"",""tb"".""mail"" AS ""mail"" FROM (SELECT ""u"".""name"",""u"".""mail"",(""c"".""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"")) AS ""num"" FROM ""users"" AS ""u"" LEFT JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tb"" GROUP BY ""tb"".""name"",""tb"".""mail"",""tb"".""num"" HAVING COUNT(""tb"".""num"")>=3 UNION SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",COUNT(1) AS ""cnt"" FROM ""contests"" LEFT JOIN ""users"" ON ""contests"".""gold_medal""=""users"".""user_id"" GROUP BY ""user_id"" HAVING ""cnt"">=3) AS ""temp"""
316,"WITH ""CTE"" AS (SELECT ""contestent_id"",""contest_id""-RANK() OVER (PARTITION BY ""contestent_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM (SELECT DISTINCT ""contestent_id"",""contest_id"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""contestent_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""contestent_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""contestent_id"" FROM ""Contests"") AS ""a"" ORDER BY ""contestent_id"",""contest_id"") AS ""b"") SELECT DISTINCT ""name"",""mail"" FROM (""CTE"") CROSS JOIN ""Users"" WHERE ""user_id""=""contestent_id"" GROUP BY ""contestent_id"",""rnk"" HAVING COUNT(1)>=3 UNION SELECT ""name"",""mail"" FROM (""Contests"") CROSS JOIN ""Users"" WHERE ""gold_medal""=""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3"
317,"SELECT ""u"".""NAME"",""u"".""mail"" FROM (SELECT ""user_id"",COUNT(1) OVER (PARTITION BY ""user_id"", ""grp"") AS ""cnt"",SUM(""gold_cnt"") OVER (PARTITION BY ""user_id"") AS ""cnt_gold"" FROM (SELECT ""u"".""user_id"",""c"".*,""u"".""user_id""=""c"".""gold_medal"" AS ""gold_cnt"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""users"" AS ""u"" LEFT JOIN ""contests"" AS ""c"" ON (""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") ORDER BY ""c"".""contest_id"") AS ""a"") AS ""b"" LEFT JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id"" HAVING MAX(""cnt"")>=3 OR MAX(""cnt_gold"")>=3"
318,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
319,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
320,"WITH ""winner_id"" AS (SELECT ""contest_id"",""gold_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""win_id"" FROM ""Contests""), ""three_win"" AS (SELECT DISTINCT ""sub"".""win_id"" FROM (SELECT ""w1"".""contest_id"",""w1"".""win_id"",""w2"".""win_id"" AS ""win_id2"",""w3"".""win_id"" AS ""win_id3"" FROM (""winner_id"" AS ""w1"" JOIN ""winner_id"" AS ""w2"" ON ""w1"".""contest_id""+1=""w2"".""contest_id"" AND ""w1"".""win_id""=""w2"".""win_id"") JOIN ""winner_id"" AS ""w3"" ON ""w2"".""contest_id""+1=""w3"".""contest_id"" AND ""w2"".""win_id""=""w3"".""win_id"") AS ""sub"" UNION ALL SELECT DISTINCT ""gold_medal"" AS ""gold_win_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""three_win"" AS ""t"" ON ""u"".""user_id""=""t"".""win_id"""
321,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
322,"WITH ""temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""temp2"" AS (SELECT ""t1"".""user_id"" AS ""uid"" FROM (""temp"" AS ""t1"" JOIN ""temp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""contest_id""=""t2"".""contest_id""+1) JOIN ""temp"" AS ""t3"" ON ""t2"".""user_id""=""t3"".""user_id"" AND ""t2"".""contest_id""=""t3"".""contest_id""+1 UNION (SELECT ""gold_medal"" AS ""uid"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""uid"" FROM ""temp2"")"
323,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
324,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""winner_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""winner_id"" FROM ""Contests""), ""cte2"" AS (SELECT DISTINCT ""c1"".""winner_id"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""winner_id""=""c2"".""winner_id"" AND ""c1"".""winner_id""=""c3"".""winner_id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""contest_id""=""c3"".""contest_id""-2), ""cte3"" AS (SELECT DISTINCT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""cte4"" AS (SELECT ""winner_id"" AS ""id"" FROM ""cte2"" UNION ALL SELECT ""gold_medal"" AS ""id"" FROM ""cte3"") SELECT DISTINCT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""cte4"")"
325,"WITH ""table1"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""table2"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""row_num"" FROM ""table1"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN (SELECT ""user_id"" FROM ""table2"" GROUP BY ""user_id"",""contest_id""-""row_num"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""t"" ON ""u"".""user_id""=""t"".""user_id"""
326,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
327,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
328,"SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"" AND ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3"
329,"SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" LEFT JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""name"",""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
330,"SELECT ""u"".""name"",""u"".""mail"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""u"".""user_id"" HAVING COUNT(""u"".""user_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"") CROSS JOIN ""users"" AS ""u"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"""
331,"SELECT ""u"".""NAME"",""u"".""mail"" FROM (SELECT ""user_id"",COUNT(1) OVER (PARTITION BY ""user_id"", ""grp"") AS ""cnt"",SUM(""gold_cnt"") OVER (PARTITION BY ""user_id"") AS ""cnt_gold"" FROM (SELECT ""u"".""user_id"",""c"".*,""u"".""user_id""=""c"".""gold_medal"" AS ""gold_cnt"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""users"" AS ""u"" LEFT JOIN ""contests"" AS ""c"" ON (""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") ORDER BY ""c"".""contest_id"") AS ""a"") AS ""b"" LEFT JOIN ""users"" AS ""u"" USING (""user_id"") GROUP BY ""user_id"" HAVING MAX(""cnt"")>=3 OR MAX(""cnt_gold"")>=3"
332,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT DISTINCT ""a"".""medal"" FROM ((""CTE"" AS ""a"") CROSS JOIN ""CTE"" AS ""b"") CROSS JOIN ""CTE"" AS ""c"" WHERE ""a"".""medal""=""b"".""medal"" AND ""b"".""medal""=""c"".""medal"" AND ""a"".""contest_id""+1=""b"".""contest_id"" AND ""b"".""contest_id""+1=""c"".""contest_id"") UNION SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3)"
333,"WITH ""t1"" AS (SELECT ""name"",""mail"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""a"".""user_id"" FROM ((""t2"" AS ""a"") CROSS JOIN ""t2"" AS ""b"") CROSS JOIN ""t2"" AS ""c"" WHERE ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"" AND ""a"".""contest_id""+1=""b"".""contest_id"" AND ""b"".""contest_id""+1=""c"".""contest_id"" AND ""a"".""contest_id""+2=""c"".""contest_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t3"" JOIN ""users"" ON ""t3"".""user_id""=""users"".""user_id"" UNION SELECT * FROM ""t1"""
334,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"""
335,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" GROUP BY ""user_id"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""mail"",""name"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""t2"")"
336,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
337,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" WHERE ""u"".""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"") AS ""sub"") AS ""sub2"" GROUP BY ""grp"",""user_id"" HAVING COUNT(1)>=3) OR ""u"".""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
338,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"" WHERE ""c1"".""contest_id"" IS NOT NULL ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
339,"WITH ""t1"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT ""a"".""user_id"" FROM (""t1"" AS ""a"" JOIN ""t1"" AS ""b"" ON ""a"".""contest_id""=""b"".""contest_id""+1) JOIN ""t1"" AS ""c"" ON ""b"".""contest_id""=""c"".""contest_id""+1 WHERE ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" JOIN ""t2"" ON ""users"".""user_id""=""t2"".""user_id"""
340,"WITH ""res_temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""temp"" AS (SELECT DISTINCT ""A"".""user_id"" FROM (""res_temp"" AS ""A"" JOIN ""res_temp"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" AND ""A"".""contest_id""+1=""B"".""contest_id"") JOIN ""res_temp"" AS ""C"" ON ""B"".""user_id""=""C"".""user_id"" AND ""B"".""contest_id""+1=""C"".""contest_id"" UNION ALL SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""user_id"" FROM ""temp"") AS ""newTemp"" LEFT JOIN ""users"" AS ""u"" ON ""newTemp"".""user_id""=""u"".""user_id"""
341,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""user_id"",""name"",""mail"",""A"".""contest_id""-""A"".""medal_order"" AS ""grp"" FROM (SELECT ""u"".""user_id"",""name"",""u"".""mail"",""c"".""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""medal_order"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""A"") AS ""B"" GROUP BY ""user_id"",""name"",""mail"",""grp"" HAVING COUNT(1)>=3 UNION SELECT ""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""name"",""u"".""mail"" HAVING COUNT(""c"".""contest_id"")>=3"
342,"WITH ""cons_id"" AS (SELECT *,""contest_id""-LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""second_lag"",""contest_id""-LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""first_lag"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") AS ""b"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) OR ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM ""cons_id"" WHERE ""first_lag""=1 AND ""second_lag""=2)"
343,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
344,"WITH ""t1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""t3"" AS (SELECT ""user_id"" FROM ""t2"" WHERE ROW(""contest_id""+1,""user_id"") IN (SELECT * FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT * FROM ""t2"")) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""t1"" UNION SELECT * FROM ""t3"")"
345,"WITH ""temp1"" AS (SELECT ""gold_medal"",COUNT(""contest_id"") AS ""gold_times"" FROM ""contests"" GROUP BY 1), ""temp2"" AS (SELECT ""gold_medal"" AS ""medalist_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""medalist_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""medalist_id"",""contest_id"" FROM ""contests""), ""temp3"" AS (SELECT DISTINCT ""medalist_id"" FROM ""temp2"" WHERE ROW(""medalist_id"",""contest_id""-1) IN (SELECT * FROM ""temp2"") AND ROW(""medalist_id"",""contest_id""+1) IN (SELECT * FROM ""temp2"") UNION ALL SELECT ""gold_medal"" AS ""medalsit_id"" FROM ""temp1"" WHERE ""gold_times"">=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""temp3"")"
346,"WITH ""table1"" AS (SELECT ""gold_medal"",COUNT(""gold_medal"") AS ""cnt"" FROM ""Contests"" GROUP BY ""gold_medal""), ""table2"" AS ((SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""silver_medal"" FROM ""Contests"") UNION ALL (SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"")), ""table3"" AS (SELECT ""medal"",""contest_id"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""lead1"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""lead2"" FROM ""table2"" ORDER BY ""medal"",""contest_id""), ""table4"" AS ((SELECT ""name"",""mail"" FROM ""table1"" JOIN ""Users"" AS ""u"" ON ""table1"".""gold_medal""=""u"".""user_id"" WHERE ""cnt"">=3) UNION ALL (SELECT ""name"",""mail"" FROM ""table3"" JOIN ""Users"" AS ""u"" ON ""table3"".""medal""=""u"".""user_id"" WHERE (""lead2""-""lead1""=1) AND (""lead1""-""contest_id""=1))) SELECT DISTINCT ""name"",""mail"" FROM ""table4"""
347,"SELECT ""a"".""name"",""a"".""mail"" FROM (((""users"" AS ""a"") CROSS JOIN ""contests"" AS ""b"") CROSS JOIN ""contests"" AS ""c"") CROSS JOIN ""contests"" AS ""d"" WHERE (""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"") AND (""a"".""user_id""=""c"".""gold_medal"" OR ""a"".""user_id""=""c"".""silver_medal"" OR ""a"".""user_id""=""c"".""bronze_medal"") AND (""a"".""user_id""=""d"".""gold_medal"" OR ""a"".""user_id""=""d"".""silver_medal"" OR ""a"".""user_id""=""d"".""bronze_medal"") AND ""b"".""contest_id""=""c"".""contest_id""-1 AND ""c"".""contest_id""=""d"".""contest_id""-1 UNION SELECT DISTINCT ""b"".""name"",""b"".""mail"" FROM (""contests"" AS ""a"") CROSS JOIN ""users"" AS ""b"" WHERE ""a"".""gold_medal""=""b"".""user_id"" GROUP BY ""a"".""gold_medal"" HAVING COUNT(""a"".""gold_medal"")>2"
348,"WITH ""new_data"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT (""user_id"") FROM (SELECT *,LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"" FROM ""new_data"") AS ""a"" WHERE ""contest_id""-""lag_2""=2 AND ""contest_id""-""lag_1""=1 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""a"" ON ""u"".""user_id""=""a"".""user_id"""
349,"SELECT ""name"",""mail"" FROM (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT CASE WHEN ""gold_medal""=""lag1gold"" AND ""lag1gold""=""lag2Silver"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1gold"" AND ""lag1gold""=""lag2bronze"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1gold"" AND ""lag1gold""=""lag2gold"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1silver"" AND ""lag1silver""=""lag2bronze"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1silver"" AND ""lag1silver""=""lag2silver"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1silver"" AND ""lag1silver""=""lag2gold"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2bronze"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2silver"" THEN ""gold_medal"" WHEN ""gold_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2gold"" THEN ""gold_medal"" END AS ""user_id"" FROM (SELECT ""gold_medal"",""silver_medal"",""bronze_medal"",LAG(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1gold"",LAG(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2gold"",LAG(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1silver"",LAG(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2silver"",LAG(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1bronze"",LAG(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2bronze"" FROM ""Contests"") AS ""a"" UNION SELECT CASE WHEN ""silver_medal""=""lag1gold"" AND ""lag1gold""=""lag2Silver"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1gold"" AND ""lag1gold""=""lag2bronze"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1gold"" AND ""lag1gold""=""lag2gold"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1silver"" AND ""lag1silver""=""lag2bronze"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1silver"" AND ""lag1silver""=""lag2silver"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1silver"" AND ""lag1silver""=""lag2gold"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2bronze"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2silver"" THEN ""silver_medal"" WHEN ""silver_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2gold"" THEN ""silver_medal"" END AS ""user_id"" FROM (SELECT ""gold_medal"",""silver_medal"",""bronze_medal"",LAG(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1gold"",LAG(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2gold"",LAG(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1silver"",LAG(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2silver"",LAG(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1bronze"",LAG(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2bronze"" FROM ""Contests"") AS ""b"" UNION SELECT CASE WHEN ""bronze_medal""=""lag1gold"" AND ""lag1gold""=""lag2Silver"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1gold"" AND ""lag1gold""=""lag2bronze"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1gold"" AND ""lag1gold""=""lag2gold"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1silver"" AND ""lag1silver""=""lag2bronze"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1silver"" AND ""lag1silver""=""lag2silver"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1silver"" AND ""lag1silver""=""lag2gold"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2bronze"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2silver"" THEN ""bronze_medal"" WHEN ""bronze_medal""=""lag1bronze"" AND ""lag1bronze""=""lag2gold"" THEN ""bronze_medal"" END AS ""user_id"" FROM (SELECT ""gold_medal"",""silver_medal"",""bronze_medal"",LAG(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1gold"",LAG(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2gold"",LAG(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1silver"",LAG(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2silver"",LAG(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""lag1bronze"",LAG(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""lag2bronze"" FROM ""Contests"") AS ""a"") AS ""b"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""b"".""user_id"" WHERE ""b"".""user_id"" IS NOT NULL"
350,"WITH ""cte"" AS (SELECT ""name"",""mail"",""c"".""contest_id"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""Gold"",CASE WHEN ""u"".""user_id""=""c"".""silver_medal"" THEN 1 ELSE 0 END AS ""Silver"",CASE WHEN ""u"".""user_id""=""c"".""bronze_medal"" THEN 1 ELSE 0 END AS ""Bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""c"".""contest_id"") AS ""diff"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""Gold""+""Silver""+""Bronze"") OVER (PARTITION BY ""name"", ""mail"", ""diff"") AS ""medalsum"",SUM(""GOLD"") OVER (PARTITION BY ""name"", ""mail"") AS ""goldsum"" FROM ""CTE"") AS ""a"" WHERE ""medalsum"">=3 OR ""goldsum"">=3"
351,"WITH ""cte"" AS (SELECT ""contest_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""rnk"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"") AS ""a""), ""cte2"" AS (SELECT ""a"".""medal"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""contest_id""+1=""b"".""contest_id"" AND ""a"".""medal""=""b"".""medal"") JOIN ""cte"" AS ""c"" ON ""b"".""contest_id""+1=""c"".""contest_id"" AND ""b"".""medal""=""c"".""medal"" UNION SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""cte2"" AS ""c"" ON ""c"".""medal""=""u"".""user_id"""
352,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(1)>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"""
353,"WITH ""gold_medals"" AS (SELECT ""gold_medal"",COUNT(1) AS ""medal_number"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING ""medal_number"">=3), ""all_medal"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_ud"",""contest_id"" FROM ""Contests""), ""lag_all"" AS (SELECT ""user_id"",""contest_id""-LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""all_medal"") SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""gold_medals"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""lag_all"" WHERE ""diff""=2)"
354,"WITH ""c1"" AS (SELECT ""u"".""user_id"",""c"".""contest_id"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" UNION ALL SELECT ""u"".""user_id"",""c"".""contest_id"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""silver_medal"" UNION ALL SELECT ""u"".""user_id"",""c"".""contest_id"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""bronze_medal""), ""c2"" AS (SELECT ""user_id"",""contest_id"",COALESCE(LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id""), 0) AS ""next_2"" FROM ""c1"" ORDER BY ""user_id"",""contest_id""), ""c3"" AS (SELECT DISTINCT ""user_id"" FROM ""c2"" WHERE (""next_2""-""contest_id"")=2), ""c4"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""c3"") OR ""user_id"" IN (SELECT ""id"" FROM ""c4"")"
355,"WITH ""gold_table"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""union_table"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""medal_table"" AS (SELECT DISTINCT ""u1"".""user_id"" FROM (""union_table"" AS ""u1"" JOIN ""union_table"" AS ""u2"" ON ""u1"".""user_id""=""u2"".""user_id"" AND ""u1"".""contest_id""+1=""u2"".""contest_id"") JOIN ""union_table"" AS ""u3"" ON ""u1"".""user_id""=""u3"".""user_id"" AND ""u1"".""contest_id""-1=""u3"".""contest_id"" WHERE ""u1"".""contest_id"" IS NOT NULL AND ""u2"".""contest_id"" IS NOT NULL AND ""u3"".""contest_id"" IS NOT NULL) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""gold_table"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""medal_table"")"
356,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
357,"WITH ""three_golds"" AS (SELECT ""b"".""name"",""mail"" FROM ""Contests"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""gold_medal""=""b"".""user_id"" GROUP BY 1,2 HAVING COUNT(""contest_id"")>=3), ""all_winners"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""three_golds"" UNION SELECT DISTINCT ""b"".""name"",""b"".""mail"" FROM (SELECT ""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""all_winners"") AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1,2,""diff"" HAVING COUNT(""diff"")>=3"
358,"SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cons"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") AS ""f1"" WHERE ""cons""=""contest_id""+2 UNION SELECT ""name"",""mail"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
359,"SELECT ""a"".""name"",""a"".""mail"" FROM (((""users"" AS ""a"") CROSS JOIN ""contests"" AS ""b"") CROSS JOIN ""contests"" AS ""c"") CROSS JOIN ""contests"" AS ""d"" WHERE (""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"") AND (""a"".""user_id""=""c"".""gold_medal"" OR ""a"".""user_id""=""c"".""silver_medal"" OR ""a"".""user_id""=""c"".""bronze_medal"") AND (""a"".""user_id""=""d"".""gold_medal"" OR ""a"".""user_id""=""d"".""silver_medal"" OR ""a"".""user_id""=""d"".""bronze_medal"") AND ""b"".""contest_id""=""c"".""contest_id""-1 AND ""c"".""contest_id""=""d"".""contest_id""-1 UNION SELECT DISTINCT ""b"".""name"",""b"".""mail"" FROM (""contests"" AS ""a"") CROSS JOIN ""users"" AS ""b"" WHERE ""a"".""gold_medal""=""b"".""user_id"" GROUP BY ""a"".""gold_medal"" HAVING COUNT(""a"".""gold_medal"")>2"
360,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
361,"WITH ""main"" AS (SELECT ""user_id"",""mail"",""name"",(CASE WHEN (""contest_id""+2)=LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") THEN 1 ELSE 0 END) AS ""qualifying"" FROM ""Users"" JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT DISTINCT ""mail"",""name"" FROM ""Users"" JOIN ""Contests"" ON ""user_id""=""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""mail"",""name"" FROM ""main"" WHERE ""qualifying""=1"
362,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"",""contest_id"" FROM ""Contests""), ""cte2"" AS (SELECT ""a"".""user"" FROM (""cte1"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""user""=""b"".""user"" AND ""a"".""contest_id""=""b"".""contest_id""+1) JOIN ""cte1"" AS ""c"" ON ""a"".""user""=""c"".""user"" AND ""a"".""contest_id""=""c"".""contest_id""+2), ""cte3"" AS (SELECT ""gold_medal"" AS ""user"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""cte4"" AS (SELECT ""user"" FROM ""cte3"" UNION SELECT ""user"" FROM ""cte2"") SELECT ""mail"",""name"" FROM ""cte4"" JOIN ""Users"" ON ""cte4"".""user""=""Users"".""user_id"""
363,"WITH ""medals"" AS (SELECT ""gold_medal"" AS ""user_id"",'gold' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",'silver' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"",""contest_id"" FROM ""contests""), ""lagged_and_counted"" AS (SELECT ""user_id"",""medal"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"",COUNT(1) OVER (PARTITION BY ""user_id"", ""medal"") AS ""medal_count"" FROM ""medals"") SELECT DISTINCT ""name"",""mail"" FROM ""lagged_and_counted"" NATURAL CROSS JOIN ""Users"" WHERE ""contest_id""=""lag_2""+2 OR (""medal""='gold' AND ""medal_count"">=3)"
364,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""medalists"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY ""id"",""contest_id""), ""any_three"" AS (SELECT DISTINCT ""id"" FROM (SELECT ""id"",""consec"",COUNT(1) AS ""num_consec"" FROM (SELECT ""id"",""contest_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""consec"" FROM ""medalists"") AS ""t1"" GROUP BY ""id"",""consec"") AS ""t2"" WHERE ""num_consec"">=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""any_three"" AS ""a"" LEFT JOIN ""users"" AS ""u"" ON ""a"".""id""=""u"".""user_id"" UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""gold"" AS ""g"" LEFT JOIN ""users"" AS ""u"" ON ""g"".""id""=""u"".""user_id"""
365,"SELECT DISTINCT ""b"".""name"",""b"".""mail"" FROM (SELECT ""a"".""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""groupid"" FROM ""Users"" AS ""a"" JOIN ""Contests"" AS ""b"" ON ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"" OR ""a"".""user_id""=""b"".""gold_medal"") AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY ""a"".""user_id"",""a"".""groupid"" HAVING COUNT(""a"".""groupid"")>=3 UNION SELECT DISTINCT ""b"".""name"",""b"".""mail"" FROM ""Contests"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""gold_medal""=""b"".""user_id"" GROUP BY ""a"".""gold_medal"" HAVING COUNT(""a"".""gold_medal"")>=3"
366,"WITH ""medals"" AS (SELECT ""gold_medal"" AS ""user_id"",'gold' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",'silver' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"",""contest_id"" FROM ""contests""), ""lagged_and_counted"" AS (SELECT ""user_id"",""medal"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"",COUNT(1) OVER (PARTITION BY ""user_id"", ""medal"") AS ""medal_count"" FROM ""medals"") SELECT DISTINCT ""name"",""mail"" FROM ""lagged_and_counted"" NATURAL CROSS JOIN ""Users"" WHERE ""contest_id""=""lag_2""+2 OR (""medal""='gold' AND ""medal_count"">=3)"
367,"SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""cand_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) OR ""user_id"" IN (SELECT DISTINCT ""cand_id"" FROM (SELECT ""t"".""cand_id"",""t"".""contest_id"",""t"".""contest_id""-RANK() OVER (PARTITION BY ""cand_id"" ORDER BY ""contest_id"") AS ""diff"" FROM (SELECT ""contest_id"",""silver_medal"" AS ""cand_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""cand_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""gold_medal"" AS ""cand_id"" FROM ""contests"") AS ""t"") AS ""t2"" GROUP BY ""cand_id"",""diff"" HAVING COUNT(""diff"")>=3)"
368,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) UNION SELECT DISTINCT ""x"".""name"",""x"".""mail"" FROM ((""Users"" AS ""x"" LEFT JOIN ""Contests"" AS ""a"" ON ""x"".""user_id"" IN (""a"".""gold_medal"",""a"".""silver_medal"",""a"".""bronze_medal"")) LEFT JOIN ""Contests"" AS ""b"" ON ""a"".""contest_id""=""b"".""contest_id""-1 AND ""x"".""user_id"" IN (""b"".""gold_medal"",""b"".""silver_medal"",""b"".""bronze_medal"")) LEFT JOIN ""Contests"" AS ""c"" ON ""a"".""contest_id""=""c"".""contest_id""-2 AND ""x"".""user_id"" IN (""c"".""gold_medal"",""c"".""silver_medal"",""c"".""bronze_medal"") WHERE ""b"".""contest_id"" IS NOT NULL AND ""c"".""contest_id"" IS NOT NULL"
369,"SELECT ""a"".""name"",""a"".""mail"" FROM (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_two"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id"" IN (""c"".""gold_medal"",""c"".""silver_medal"",""c"".""bronze_medal"")) AS ""a"" GROUP BY ""user_id"" HAVING SUM(""user_id""=""gold_medal"")>=3 OR SUM(""contest_id""-""lag_two""=2)>=1"
370,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""cte2"" AS (SELECT DISTINCT ""c1"".""user_id"" FROM (""cte1"" AS ""c1"" JOIN ""cte1"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1) JOIN ""cte1"" AS ""c3"" ON ""c1"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""=""c3"".""contest_id""-2), ""cte3"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""COntests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte2"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""cte3"")"
371,"WITH ""all_contests"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""metal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""metal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""metal"" FROM ""Contests""), ""t"" AS (SELECT *,""contest_id""-LAG(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff1"",""contest_id""-LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff2"",COUNT(CASE WHEN ""metal""='gold' THEN 1 END) OVER (PARTITION BY ""user_id"") AS ""gold_cnt"" FROM ""all_contests"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""t"" WHERE (""diff1""=1 AND ""diff2""=2) OR ""gold_cnt"">=3)"
372,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""gold_medal"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""user_id""=""gold_medal"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
373,"WITH ""t"" AS (SELECT ""contest_id"",""u"".""name"",""u"".""mail"",""u"".""user_id"",SUM(CASE WHEN ""c"".""gold_medal""=""u"".""user_id"" THEN 1 ELSE 0 END) AS ""g"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"" GROUP BY ""u"".""user_id"",""u"".""name"",""u"".""mail"",""contest_id""), ""t2"" AS (SELECT ""name"",""mail"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""seq"" FROM ""t"") SELECT ""name"",""mail"" FROM ""t"" GROUP BY ""name"",""mail"",""user_id"" HAVING SUM(""g"")>=3 UNION SELECT ""name"",""mail"" FROM ""t2"" GROUP BY ""name"",""mail"",""seq"" HAVING COUNT(1)>=3"
374,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
375,"WITH ""cte"" AS (SELECT ""contest_id"",'gold medal' AS ""medal_type"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",'silver medal' AS ""medal_type"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",'bronze medal' AS ""medal_type"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"",""medal_type"") SELECT ""name"",""mail"" FROM ""Users"" JOIN (SELECT ""user_id"" FROM ""cte"" WHERE ""medal_type""='gold medal' GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""a"".""user_id"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""b"".""contest_id""=""a"".""contest_id""+1) JOIN ""cte"" AS ""c"" ON ""c"".""contest_id""=""b"".""contest_id""+1 WHERE ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"" AND ""a"".""user_id""=""c"".""user_id"") AS ""t"" ON ""Users"".""user_id""=""t"".""user_id"""
376,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) AS ""a"" LEFT JOIN ""users"" USING (""user_id"")"
377,"WITH ""squeezed"" AS (SELECT ""contest_id"",""gold_medal"" AS ""uid"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""uid"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""uid"" FROM ""Contests""), ""w"" AS (SELECT ""contest_id"",""uid"",LAG(""contest_id"", 2) OVER (PARTITION BY ""uid"" ORDER BY ""contest_id"") AS ""prev"" FROM ""squeezed""), ""t2"" AS (SELECT ""uid"" FROM ""w"" WHERE ""contest_id""-""prev""=2) SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION SELECT ""name"",""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""uid""=""u"".""user_id"""
378,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"") SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
379,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
380,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""win_id"" FROM ""Contests""), ""CTE1"" AS (SELECT DISTINCT ""c1"".""win_id"" FROM (""CTE"" AS ""c1"" JOIN ""CTE"" AS ""c2"" ON ""c1"".""win_id""=""c2"".""win_id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""CTE"" AS ""c3"" ON ""c2"".""win_id""=""c3"".""win_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"" UNION SELECT ""gold_medal"" AS ""win_id"" FROM ""Contests"" AS ""c"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""CTE1"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""win_id""=""u"".""user_id"""
381,"WITH ""medal_list"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""medal_list_num"" AS (SELECT ""contest_id"",""user_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rank_num"" FROM ""medal_list""), ""all_name_list"" AS (SELECT ""user_id"" FROM ""medal_list_num"" GROUP BY ""user_id"",""contest_id""-""rank_num"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""t2"".""name"",""t2"".""mail"" FROM ""all_name_list"" AS ""t1"" JOIN ""Users"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"""
382,"WITH ""t"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""t0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""t0""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" GROUP BY ""user_id"",""contest_id""-""rnk"" HAVING COUNT(1)>=3 UNION ALL SELECT ""user_id"" FROM ""t"") SELECT DISTINCT ""name"",""mail"" FROM ""t2"" JOIN ""Users"" USING (""user_id"")"
383,"WITH ""t1"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prev_2"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""t1"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prev_2""=2)>=1"
384,"WITH ""res_temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""B"".""name"",""B"".""mail"" FROM (SELECT DISTINCT ""A"".""user_id"" FROM (""res_temp"" AS ""A"" JOIN ""res_temp"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" AND ""A"".""contest_id""+1=""B"".""contest_id"") JOIN ""res_temp"" AS ""C"" ON ""B"".""user_id""=""C"".""user_id"" AND ""B"".""contest_id""+1=""C"".""contest_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""A"" LEFT JOIN ""Users"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"""
385,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
386,"WITH ""medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""medal"" AS ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""ranks"" FROM ""medals"") AS ""t"" JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"",(""t"".""contest_id""-""t"".""ranks"") HAVING COUNT(""t"".""contest_id""-""t"".""ranks"")>=3 UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) AS ""t"" JOIN ""users"" AS ""u"" ON ""t"".""gold_medal""=""u"".""user_id"""
387,"WITH ""cte_gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""cte_unpivot"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""cte_consecutive"" AS (SELECT ""u1"".""user_id"" FROM ((""users"" AS ""u1"" JOIN ""cte_unpivot"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""user_id"") JOIN ""cte_unpivot"" AS ""c2"" ON ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""u1"".""user_id""=""c2"".""user_id"") JOIN ""cte_unpivot"" AS ""c3"" ON ""c2"".""contest_id""=""c3"".""contest_id""-1 AND ""u1"".""user_id""=""c3"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT * FROM ""cte_consecutive"" UNION SELECT * FROM ""cte_gold"") AS ""x"" ON ""u"".""user_id""=""x"".""user_id"""
388,"SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"",DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""rnk"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"",(""tmp"".""contest_id""-""rnk"") HAVING COUNT(""tmp"".""contest_id""-""rnk"")>=3 UNION SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"" HAVING COUNT(""contest_id"")>=3"
389,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
390,"WITH ""contests_union"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""category"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""category"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""category"" FROM ""Contests"" ORDER BY ""contest_id"") SELECT ""user"".""name"" AS ""name"",""user"".""mail"" AS ""mail"" FROM ""Users"" AS ""user"" JOIN (SELECT ""user_id"" FROM (SELECT ""gold_medal"" AS ""user_id"",COUNT(""contest_id"") AS ""gold"" FROM ""Contests"" GROUP BY ""user_id"" HAVING ""gold"">=3) AS ""A"" UNION SELECT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",COALESCE(LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id""), 0) AS ""lead_1"",COALESCE(LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id""), 0) AS ""lead_2"" FROM ""contests_union"") AS ""C"" WHERE (""contest_id""+1)=""lead_1"" AND (""contest_id""+2=""lead_2"")) AS ""D"" ON ""user"".""user_id""=""D"".""user_id"""
391,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
392,"WITH ""CTE1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""userid"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""userid"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""userid"" FROM ""Contests""), ""CTE2"" AS (SELECT DISTINCT ""C1"".""userid"" FROM ((""CTE1"" AS ""C1"") CROSS JOIN ""CTE1"" AS ""C2"") CROSS JOIN ""CTE1"" AS ""C3"" WHERE ""C1"".""contest_id""=""C2"".""contest_id""+1 AND ""C2"".""contest_id""=""C3"".""contest_id""+1 AND ""C1"".""userid""=""C2"".""userid"" AND ""C2"".""userid""=""C3"".""userid"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>2) UNION SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""CTE2"")"
393,"SELECT ""a"".""name"",""a"".""mail"" FROM (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_two"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id"" IN (""c"".""gold_medal"",""c"".""silver_medal"",""c"".""bronze_medal"")) AS ""a"" GROUP BY ""user_id"" HAVING SUM(""user_id""=""gold_medal"")>=3 OR SUM(""contest_id""-""lag_two""=2)>=1"
394,"WITH ""condition_one"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT DISTINCT ""contest_id"",""user_id"",LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""pp1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""pp2"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") AS ""a"") AS ""b"" WHERE ""contest_id""=""pp1""+1 AND ""contest_id""=""pp2""+2), ""condition_two"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""condition_one"") OR ""user_id"" IN (SELECT * FROM ""condition_two"")"
395,"SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"",DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""rnk"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"",(""tmp"".""contest_id""-""rnk"") HAVING COUNT(""tmp"".""contest_id""-""rnk"")>=3 UNION SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"" HAVING COUNT(""contest_id"")>=3"
396,"WITH ""medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY ""id"",""contest_id""), ""case1"" AS (SELECT ""id"" FROM (SELECT ""id"",""contest_id"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""contest_id_2"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""contest_id_3"" FROM ""medal"") AS ""t"" WHERE (""contest_id""+1=""contest_id_2"") AND (""contest_id""+2=""contest_id_3"")), ""case2"" AS (SELECT COUNT(""contest_id"") AS ""num"",""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"")"
397,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""users"".*,LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+2 AS ""sign"",SUM(""gold_medal""=""user_id"") OVER (PARTITION BY ""user_id"") AS ""gold"" FROM ""users"" LEFT JOIN ""contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") AS ""cte"" WHERE ""gold"">=3 OR ""sign""=1"
398,"(SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) AS ""c"" ON ""u"".""user_id""=""c"".""user_id"") UNION SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rownum"" FROM ((SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"") UNION (SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"") UNION (SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") ORDER BY ""user_id"",""contest_id"") AS ""a"") AS ""b"" GROUP BY ""b"".""rownum"",""user_id"" HAVING COUNT(""user_id"")>=3) AS ""c"" ON ""u"".""user_id""=""c"".""user_id"""
399,"WITH ""t1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""winner"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""winner"" FROM ""contests""), ""t2"" AS (SELECT ""winner"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""roww"" FROM ""t1""), ""t3"" AS (SELECT DISTINCT ""winner"",(""contest_id""-""roww"") AS ""gap"" FROM ""t2"" GROUP BY ""winner"",""contest_id""-""roww"" HAVING COUNT(1)>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""t3"" JOIN ""users"" AS ""u"" ON ""t3"".""winner""=""u"".""user_id"" UNION SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""gold_medal""=""u"".""user_id"""
400,"WITH ""CONT"" AS (SELECT ""U"".""USER_ID"",""U"".""NAME"",""U"".""MAIL"",""C"".""CONTEST_ID"" FROM ""USERS"" AS ""U"" JOIN ""CONTESTS"" AS ""C"" ON (""U"".""USER_ID""=""C"".""GOLD_MEDAL"" OR ""U"".""USER_ID""=""C"".""SILVER_MEDAL"" OR ""U"".""USER_ID""=""C"".""BRONZE_MEDAL"")), ""FIRST_COND"" AS (SELECT ""C"".""USER_ID"",""C"".""NAME"",""C"".""MAIL"" FROM (""CONT"" AS ""C"" JOIN ""CONT"" AS ""C1"" ON (""C"".""USER_ID""=""C1"".""USER_ID"" AND ""C"".""CONTEST_ID""=""C1"".""CONTEST_ID""+1)) JOIN ""CONT"" AS ""C2"" ON (""C1"".""USER_ID""=""C2"".""USER_ID"" AND ""C1"".""CONTEST_ID""=""C2"".""CONTEST_ID""+1) GROUP BY 1), ""SECOND_COND"" AS (SELECT ""USER_ID"",""NAME"",""MAIL"" FROM (SELECT ""U"".""USER_ID"",""U"".""NAME"",""U"".""MAIL"",COUNT(""C"".""CONTEST_ID"") AS ""cnt"" FROM ""USERS"" AS ""U"" JOIN ""CONTESTS"" AS ""C"" ON (""U"".""USER_ID""=""C"".""GOLD_MEDAL"") GROUP BY 1) AS ""X"" WHERE ""X"".""CNT"">=3) SELECT ""F"".""NAME"",""F"".""MAIL"" FROM ""FIRST_COND"" AS ""F"" UNION SELECT ""S"".""NAME"",""S"".""MAIL"" FROM ""SECOND_COND"" AS ""S"""
401,"WITH ""unpivot"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""winer_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""winer_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""winer_id"" FROM ""contests""), ""ordered"" AS (SELECT ""winer_id"",""contest_id"",""name"",""mail"",""medal"",LAG(""contest_id"", 2) OVER (PARTITION BY ""winer_id"" ORDER BY ""contest_id"") AS ""prepre"" FROM ""unpivot"" AS ""p"" JOIN ""users"" AS ""u"" ON ""p"".""winer_id""=""u"".""user_id"") SELECT ""name"",""mail"" FROM ""ordered"" GROUP BY ""winer_id"" HAVING SUM(""medal""='gold')>=3 OR SUM(""contest_id""-""prepre""=2)>=1"
402,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
403,"WITH ""t"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""t2"" AS (SELECT ""user_id"" FROM ""t"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3), ""t3"" AS (SELECT DISTINCT ""temp1"".""user_id"" FROM (""t"" AS ""temp1"") CROSS JOIN ""t"" AS ""temp2"" WHERE ""temp1"".""user_id""=""temp2"".""user_id"" AND (""temp1"".""contest_id""-""temp2"".""contest_id"") BETWEEN 1 AND 2 GROUP BY ""temp1"".""user_id"",""temp1"".""contest_id"" HAVING COUNT(DISTINCT ""temp2"".""contest_id"")=2) SELECT ""name"",""mail"" FROM ""t2"" JOIN ""users"" ON ""t2"".""user_id""=""users"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""t3"" JOIN ""users"" ON ""t3"".""user_id""=""users"".""user_id"""
404,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"" AS ""first"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""second"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""third"" FROM ""cte1""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM ""cte2"" WHERE ""first""+1=""second"" AND ""second""+1=""third""), ""cte4"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte5"" AS (SELECT ""user_id"" FROM ""cte3"" UNION ALL SELECT ""gold_medal"" FROM ""cte4"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""cte5"" AS ""c"" USING (""user_id"")"
405,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM (""a"" AS ""a1"" CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
406,"WITH ""temp"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" ORDER BY ""user_id"",""contest_id""), ""temp_2"" AS (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""nx_2"" FROM ""temp""), ""temp_3"" AS (SELECT DISTINCT ""user_id"" AS ""user_id"" FROM ""temp_2"" WHERE ""nx_2""-""contest_id""=2 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""temp_3"")"
407,"WITH ""Medalists"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""U"".""name"",""U"".""mail"" FROM (((""Medalists"" AS ""M1"") CROSS JOIN ""Medalists"" AS ""M2"") CROSS JOIN ""Medalists"" AS ""M3"") CROSS JOIN ""Users"" AS ""U"" WHERE ""M1"".""contest_id""=""M2"".""contest_id""+1 AND ""M1"".""user_id""=""M2"".""user_id"" AND ""M1"".""contest_id""=""M3"".""contest_id""+2 AND ""M1"".""user_id""=""M3"".""user_id"" AND ""M2"".""contest_id""=""M3"".""contest_id""+1 AND ""M2"".""user_id""=""M3"".""user_id"" AND ""M1"".""user_id""=""U"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""Users"" AS ""A"" JOIN ""Contests"" AS ""B"" ON ""A"".""user_id""=""B"".""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3"
408,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT ""c1"".""gold_medal"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1 AND ""c1"".""gold_medal""=""c2"".""gold_medal"" AND ""c2"".""gold_medal""=""c3"".""gold_medal"")"
409,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""r"" FROM (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"") AS ""a"") AS ""b"" GROUP BY ""user_id"",(""contest_id""-""r"") HAVING COUNT(""contest_id""-""r"")>=3)"
410,"WITH ""main"" AS (SELECT ""user_id"",""mail"",""name"",(CASE WHEN (""contest_id""+2)=LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") THEN 1 ELSE 0 END) AS ""qualifying"" FROM ""Users"" JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT DISTINCT ""mail"",""name"" FROM ""Users"" JOIN ""Contests"" ON ""user_id""=""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""mail"",""name"" FROM ""main"" WHERE ""qualifying""=1"
411,"WITH ""x"" AS (SELECT ""u"".*,""c"".""contest_id"",CASE WHEN ""c"".""gold_medal""=""u"".""user_id"" THEN 1 ELSE 0 END AS ""gold_medal"",1 AS ""medal_winner"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal""), ""gold"" AS (SELECT ""name"",""mail"" FROM ""x"" GROUP BY 1,2 HAVING SUM(""gold_medal"")>=3), ""three_or_more"" AS (SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",(""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""x"") AS ""a"" GROUP BY ""name"",""mail"",""grp"" HAVING COUNT(1)>=3) SELECT * FROM ""three_or_more"" UNION SELECT * FROM ""gold"""
412,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
413,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
414,"WITH ""flat_table_contests"" AS (SELECT ""contest_id"",""gold_medal"" AS ""player"",'gold_medal' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""player"",'silver_medal' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""player"",'bronze_medal' AS ""medal"" FROM ""contests""), ""ranked_contest"" AS (SELECT ""contest_id"",""player"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""player"" ORDER BY ""contest_id"") AS ""next_winner"",SUM(CASE WHEN ""medal""='gold_medal' THEN 1 ELSE 0 END) OVER (PARTITION BY ""player"") AS ""count_of_gold_medal"" FROM ""flat_table_contests"") SELECT DISTINCT ""name"",""mail"" FROM ""ranked_contest"" AS ""f"" JOIN ""users"" AS ""u"" ON ""f"".""player""=""u"".""user_id"" WHERE ""count_of_gold_medal"">=3 OR ""next_winner""-""contest_id""=2"
415,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
416,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
417,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"" WHERE ""c1"".""contest_id"" IS NOT NULL ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
418,"WITH ""cte"" AS (SELECT ""gold_medal"" AS ""userid"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""userid"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""userid"",""contest_id"" FROM ""contests""), ""cte1"" AS (SELECT ""userid"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""userid"" ORDER BY ""contest_id"") AS ""next_2"" FROM ""cte""), ""cte2"" AS (SELECT DISTINCT ""userid"" FROM ""cte1"" WHERE ""next_2""-""contest_id""=2 UNION ALL SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT DISTINCT ""users"".""name"",""users"".""mail"" FROM ""cte2"" LEFT JOIN ""users"" ON ""cte2"".""userid""=""users"".""user_id"" ORDER BY ""users"".""user_id"""
419,"WITH ""TMP"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") AS ""x"" ORDER BY ""user_id"",""contest_id""), ""TMP2"" AS (SELECT ""contest_id""-""rn"" AS ""tag"",""user_id"",COUNT(1) FROM ""tmp"" GROUP BY 1,2 HAVING COUNT(1)>=3), ""TMP3"" AS (SELECT DISTINCT ""user_id"" FROM ""TMP2"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" AS ""a"" JOIN ""TMP3"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"""
420,"WITH ""temp"" AS (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"") AS ""TBL""), ""temp2"" AS (SELECT ""user_id"" FROM ""temp"" GROUP BY ""user_id"",""contest_id""-""rnk"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT DISTINCT ""U"".""name"",""U"".""mail"" FROM ""temp2"" LEFT JOIN ""Users"" AS ""U"" ON ""temp2"".""user_id""=""U"".""user_id"""
421,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""users"".*,CASE WHEN LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+1 AND LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+2 THEN 1 ELSE 0 END AS ""sign"",SUM(""gold_medal""=""user_id"") OVER (PARTITION BY ""user_id"") AS ""gold"" FROM ""users"" LEFT JOIN ""contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") AS ""cte"" WHERE ""gold"">=3 OR ""sign""=1"
422,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""u"".""name"",""u"".""mail"",COUNT(""t"".""contest_id"") OVER (PARTITION BY ""t"".""user_id"" ORDER BY ""t"".""contest_id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""counts"" FROM ""Users"" AS ""u"" JOIN (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""t"" ON ""u"".""user_id""=""t"".""user_id"") AS ""m"" WHERE ""counts""=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""name"",""u"".""mail"",""c"".""gold_medal"" HAVING COUNT(1)>=3"
423,"WITH ""base_table"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" GROUP BY 1,2 UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" GROUP BY 1,2 UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" GROUP BY 1,2), ""contest_number"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""base_table"" GROUP BY 1,2), ""case_two"" AS (SELECT ""user_id"",""diff"",COUNT(DISTINCT ""contest_id"") AS ""cnt"" FROM ""contest_number"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""contest_id"")>=3), ""case_one"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""case_two"") OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""case_one"") GROUP BY 1,2"
424,"WITH ""cte"" AS (SELECT ""user_id"",""mail"",""name"",""contests"".""contest_id"" FROM ""users"" CROSS JOIN ""contests"" WHERE ""user_id"" IN (""gold_medal"",""silver_medal"",""bronze_medal"")), ""cte2"" AS (SELECT DISTINCT ""user_id"",""mail"",""name"",""contests"".""contest_id"" FROM ""users"" CROSS JOIN ""contests"" WHERE ""user_id"" IN (""gold_medal"") GROUP BY ""user_id"" HAVING COUNT(1)>=3) (SELECT DISTINCT ""a"".""name"",""a"".""mail"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""contest_id""=""b"".""contest_id""+1) JOIN ""cte"" AS ""c"" ON ""a"".""contest_id""=""c"".""contest_id""-1 AND ""a"".""user_id""=""c"".""user_id"") UNION (SELECT DISTINCT ""name"",""mail"" FROM ""cte2"")"
425,"WITH ""cte"" AS (SELECT ""c"".""contest_id"",CASE WHEN ""c"".""gold_medal"" IN (""c1"".""gold_medal_1"",""c1"".""silver_medal_1"",""c1"".""bronze_medal_1"") AND ""c"".""gold_medal"" IN (""c2"".""gold_medal_2"",""c2"".""silver_medal_2"",""c2"".""bronze_medal_2"") THEN ""c"".""gold_medal"" ELSE 0 END AS ""user_id_1"",CASE WHEN ""c"".""silver_medal"" IN (""c1"".""gold_medal_1"",""c1"".""silver_medal_1"",""c1"".""bronze_medal_1"") AND ""c"".""silver_medal"" IN (""c2"".""gold_medal_2"",""c2"".""silver_medal_2"",""c2"".""bronze_medal_2"") THEN ""c"".""silver_medal"" ELSE 0 END AS ""user_id_2"",CASE WHEN ""c"".""bronze_medal"" IN (""c1"".""gold_medal_1"",""c1"".""silver_medal_1"",""c1"".""bronze_medal_1"") AND ""c"".""bronze_medal"" IN (""c2"".""gold_medal_2"",""c2"".""silver_medal_2"",""c2"".""bronze_medal_2"") THEN ""c"".""bronze_medal"" ELSE 0 END AS ""user_id_3"" FROM ((SELECT ""contest_id"",""gold_medal"",""silver_medal"",""bronze_medal"" FROM ""Contests"") AS ""c"" JOIN (SELECT ""contest_id"",LEAD(""contest_id"", 1) OVER () AS ""contest_1"",LEAD(""gold_medal"", 1) OVER () AS ""gold_medal_1"",LEAD(""silver_medal"", 1) OVER () AS ""silver_medal_1"",LEAD(""bronze_medal"", 1) OVER () AS ""bronze_medal_1"" FROM ""Contests"") AS ""c1"" ON ""c"".""contest_id""=""c1"".""contest_id"") JOIN (SELECT ""contest_id"",LEAD(""contest_id"", 2) OVER () AS ""contest_2"",LEAD(""gold_medal"", 2) OVER () AS ""gold_medal_2"",LEAD(""silver_medal"", 2) OVER () AS ""silver_medal_2"",LEAD(""bronze_medal"", 2) OVER () AS ""bronze_medal_2"" FROM ""Contests"") AS ""c2"" ON ""c"".""contest_id""=""c2"".""contest_id"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""user_id_1"" AS ""user_id"" FROM ""cte"" UNION ALL SELECT ""user_id_2"" AS ""user_id"" FROM ""cte"" UNION ALL SELECT ""user_id_3"" AS ""user_id"" FROM ""cte"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")-1>=2) AS ""final"" JOIN ""users"" AS ""u"" ON ""final"".""user_id""=""u"".""user_id"""
426,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
427,"SELECT ""c"".""name"",""c"".""mail"" FROM (SELECT ""user_id"",""name"",""mail"" FROM ""users"" AS ""c"") AS ""C"" WHERE (SELECT CASE WHEN COUNT(""gap"")=0 THEN 0 ELSE 1 END AS ""result"" FROM (SELECT ""contest_id""-""rank_num"" AS ""gap"",COUNT(1) AS ""num_group"" FROM (SELECT ""contest_id"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""rank_num"" FROM ""contests"" WHERE ""gold_medal""=""c"".""user_id"" OR ""silver_medal""=""c"".""user_id"" OR ""bronze_medal""=""c"".""user_id"") AS ""A"" GROUP BY ""contest_id""-""rank_num"" HAVING ""num_group"">=3) AS ""B"")=1 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""contests"" AS ""c"" LEFT JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""u"".""name"",""u"".""mail"" HAVING COUNT(""contest_id"")>=3"
428,"WITH ""unioncontests"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'broze' AS ""type"" FROM ""Contests"" GROUP BY ""contest_id"" ORDER BY ""contest_id"") SELECT ""users"".""name"",""users"".""mail"" FROM ""Users"" AS ""users"" JOIN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION (SELECT ""c1"".""user_id"" FROM (""unioncontests"" AS ""c1"" JOIN ""unioncontests"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""unioncontests"" AS ""c3"" ON ""c2"".""contest_id""+1=""c3"".""contest_id"" WHERE ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"")) AS ""A"" ON ""users"".""user_id""=""A"".""user_id"""
429,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
430,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
431,"WITH ""contest_long"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""Contests""), ""users_3_consec"" AS (SELECT DISTINCT (""MCF1"".""user_id"") FROM (""contest_long"" AS ""MCF1"" JOIN ""contest_long"" AS ""MCF2"" ON ""MCF1"".""user_id""=""MCF2"".""user_id"" AND ""MCF1"".""contest_id""=""MCF2"".""contest_id""+1) JOIN ""contest_long"" AS ""MCF3"" ON ""MCF1"".""user_id""=""MCF3"".""user_id"" AND ""MCF1"".""contest_id""=""MCF3"".""contest_id""+2), ""gold_3"" AS (SELECT ""user_id"" FROM ""contest_long"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT (""contest_id""))>=3), ""all_user"" AS (SELECT ""user_id"" FROM ""gold_3"" UNION SELECT ""user_id"" FROM ""users_3_consec"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""all_user"")"
432,"WITH ""all_medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""consecutive_medas"" AS (SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ((""all_medals"" AS ""a1"" JOIN ""all_medals"" AS ""a2"" ON (""a2"".""contest_id""=""a1"".""contest_id""+1 AND ""a1"".""medal""=""a2"".""medal"")) JOIN ""all_medals"" AS ""a3"" ON (""a3"".""contest_id""=""a1"".""contest_id""+2 AND ""a3"".""medal""=""a1"".""medal"")) JOIN ""Users"" AS ""u"" ON (""u"".""user_id""=""a1"".""medal"")), ""gold_medalists"" AS (SELECT ""u"".""name"",""u"".""mail"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON (""c"".""gold_medal""=""u"".""user_id"") GROUP BY ""c"".""gold_medal"" HAVING COUNT(1)>=3) SELECT * FROM ""gold_medalists"" UNION SELECT * FROM ""consecutive_medas"""
433,"WITH ""CTE1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""CTE2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""CTE3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""delta"",COUNT(1) AS ""cnt"" FROM (SELECT ""contest_id"",""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""delta"" FROM ""CTE2"") AS ""sub1"" GROUP BY ""user_id"",""delta"") AS ""sub2"" WHERE ""cnt"">=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""CTE1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""CTE3"")"
434,"WITH ""gold"" AS (SELECT ""c"".""gold_medal"" AS ""user_id"" FROM ""Contests"" AS ""c"" GROUP BY ""c"".""gold_medal"" HAVING COUNT(1)>=3), ""all_users"" AS (SELECT ""u"".""user_id"",""c"".""contest_id"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal""), ""con"" AS (SELECT ""a1"".""user_id"",""a1"".""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""a1"".""user_id"" ORDER BY ""a1"".""contest_id"") AS ""rows"" FROM ""all_users"" AS ""a1""), ""con2"" AS (SELECT DISTINCT ""c"".""user_id"" FROM ""con"" AS ""c"" GROUP BY ""c"".""user_id"",""c"".""rows"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (""Users"" AS ""u"" LEFT JOIN ""gold"" AS ""g"" ON ""u"".""user_id""=""g"".""user_id"") LEFT JOIN ""con2"" AS ""c"" ON ""u"".""user_id""=""c"".""user_id"" WHERE ""g"".""user_id"" IS NOT NULL OR ""c"".""user_id"" IS NOT NULL"
435,"WITH ""CET"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""Contests""), ""CET2"" AS (SELECT DISTINCT ""c1"".""user_id"" FROM (""CET"" AS ""c1"" JOIN ""CET"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""CET"" AS ""c3"" ON ""c1"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""+2=""c3"".""contest_id""), ""CET3"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT * FROM ""CET2"") OR ""user_id"" IN (SELECT * FROM ""CET3"")"
436,"WITH ""contest_and_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" AS ""c"" GROUP BY ""gold_medal"" HAVING COUNT(0)>=3) OR ""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM ((""contest_and_medal"" AS ""c1"") CROSS JOIN ""contest_and_medal"" AS ""c2"") CROSS JOIN ""contest_and_medal"" AS ""c3"" WHERE ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"" AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"")"
437,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
438,"WITH ""results"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""consW"" AS (SELECT ""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cons"" FROM ""results""), ""Win"" AS (SELECT ""user_id"",""cons"" FROM ""consW"" GROUP BY ""user_id"",""cons"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""Win"" AS ""w"" JOIN ""Users"" AS ""u"" ON ""w"".""user_id""=""u"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""name"",""mail"" HAVING COUNT(""gold_medal"")>=3"
439,"WITH ""new"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case_1"" AS (SELECT DISTINCT ""n1"".""medal"" AS ""id"" FROM (""new"" AS ""n1"" LEFT JOIN ""new"" AS ""n2"" ON ""n1"".""contest_id""+1=""n2"".""contest_id"") LEFT JOIN ""new"" AS ""n3"" ON ""n1"".""contest_id""+2=""n3"".""contest_id"" WHERE ""n1"".""medal""=""n2"".""medal"" AND ""n2"".""medal""=""n3"".""medal""), ""case_2"" AS (SELECT DISTINCT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN (SELECT ""id"" FROM ""case_1"" UNION SELECT ""id"" FROM ""case_2"") AS ""c"" ON ""u"".""user_id""=""c"".""id"""
440,"WITH ""any_medals"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""winner_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""winner_id"" FROM ""contests""), ""gold_medals"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ""gold_medals"" AS ""gm"" LEFT JOIN ""Users"" AS ""u"" ON ""gm"".""gold_medal""=""u"".""user_id"" GROUP BY ""gm"".""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3 UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (((""any_medals"" AS ""am1"") CROSS JOIN ""any_medals"" AS ""am2"") CROSS JOIN ""any_medals"" AS ""am3"") CROSS JOIN ""users"" AS ""u"" WHERE ""am1"".""contest_id""+1=""am2"".""contest_id"" AND ""am2"".""contest_id""+1=""am3"".""contest_id"" AND ""am1"".""winner_id""=""am2"".""winner_id"" AND ""am2"".""winner_id""=""am3"".""winner_id"" AND ""am1"".""winner_id""=""u"".""user_id"""
441,"SELECT ""us"".""name"" AS ""name"",""us"".""mail"" AS ""mail"" FROM (""users"" AS ""us"") CROSS JOIN ""contests"" AS ""cn"" WHERE ""us"".""user_id""=""cn"".""gold_medal"" GROUP BY ""us"".""user_id"" HAVING COUNT(""cn"".""contest_id"")>=3 UNION SELECT ""us"".""name"" AS ""name"",""us"".""mail"" AS ""mail"" FROM (((""users"" AS ""us"") CROSS JOIN ""contests"" AS ""cn1"") CROSS JOIN ""contests"" AS ""cn2"") CROSS JOIN ""contests"" AS ""cn3"" WHERE ""us"".""user_id"" IN (""cn1"".""gold_medal"",""cn1"".""silver_medal"",""cn1"".""bronze_medal"") AND ""us"".""user_id"" IN (""cn2"".""gold_medal"",""cn2"".""silver_medal"",""cn2"".""bronze_medal"") AND ""us"".""user_id"" IN (""cn3"".""gold_medal"",""cn3"".""silver_medal"",""cn3"".""bronze_medal"") AND ""cn1"".""contest_id""-1=""cn2"".""contest_id"" AND ""cn2"".""contest_id""-1=""cn3"".""contest_id"""
442,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user_id"" FROM (SELECT ""user_id"",""contest_id""-""rn"" FROM ""t1"" GROUP BY 1,2 HAVING COUNT(1)>=3) AS ""tmp"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""Users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"" GROUP BY 1,2"
443,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte2"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cnt"" FROM ""cte2"") AS ""F"" WHERE ""F"".""cnt""-""F"".""contest_id""=2 UNION SELECT ""user_id"" FROM ""cte1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" JOIN ""Users"" AS ""u"" USING (""user_id"") ORDER BY ""user_id"""
444,"WITH ""temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""temp2"" AS (SELECT ""t1"".""user_id"" AS ""uid"" FROM (""temp"" AS ""t1"" JOIN ""temp"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" AND ""t1"".""contest_id""=""t2"".""contest_id""+1) JOIN ""temp"" AS ""t3"" ON ""t2"".""user_id""=""t3"".""user_id"" AND ""t2"".""contest_id""=""t3"".""contest_id""+1 UNION (SELECT ""gold_medal"" AS ""uid"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3)) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""uid"" FROM ""temp2"")"
445,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
446,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""c1"".""medal"" AS ""medal"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c2"".""contest_id""-""c1"".""contest_id""=1 AND ""c3"".""contest_id""-""c2"".""contest_id""=1 AND ""c1"".""medal""=""c2"".""medal"" AND ""c3"".""medal""=""c2"".""medal"" UNION SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""t"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""t"".""medal"""
447,"WITH ""cte"" AS (SELECT ""user_id"",""mail"",""name"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""users"" LEFT JOIN ""contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
448,"SELECT ""name"",""mail"" FROM (SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""u"".""name"",""u"".""mail"",COUNT(""t"".""contest_id"") OVER (PARTITION BY ""t"".""user_id"" ORDER BY ""t"".""contest_id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""counts"" FROM ""Users"" AS ""u"" JOIN (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""t"" ON ""u"".""user_id""=""t"".""user_id"") AS ""m"" WHERE ""counts""=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""name"",""u"".""mail"",""c"".""gold_medal"" HAVING COUNT(1)>=3) AS ""a"""
449,"WITH ""new_data"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT (""user_id"") FROM (SELECT *,LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"" FROM ""new_data"") AS ""a"" WHERE ""contest_id""-""lag_2""=2 AND ""contest_id""-""lag_1""=1 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""a"" ON ""u"".""user_id""=""a"".""user_id"""
450,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" WHERE ""u"".""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"") AS ""sub"") AS ""sub2"" GROUP BY ""grp"",""user_id"" HAVING COUNT(1)>=3) OR ""u"".""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
451,"WITH ""cte"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""Gold"",CASE WHEN ""u"".""user_id""=""c"".""silver_medal"" THEN 1 ELSE 0 END AS ""Silver"",CASE WHEN ""u"".""user_id""=""c"".""bronze_medal"" THEN 1 ELSE 0 END AS ""Bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""Gold""+""Silver""+""Bronze"") OVER (PARTITION BY ""name"", ""mail"", ""grp"") AS ""medalsum"",SUM(""GOLD"") OVER (PARTITION BY ""name"", ""mail"") AS ""goldsum"" FROM ""CTE"") AS ""a"" WHERE ""medalsum"">=3 OR ""goldsum"">=3"
452,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
453,"SELECT DISTINCT ""temp"".""name"",""temp"".""mail"" FROM (SELECT ""u"".""name"",""u"".""user_id"",""u"".""mail"",""c"".""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""users"" AS ""u"" LEFT JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""temp"" GROUP BY ""temp"".""user_id"",""temp"".""grp"" HAVING COUNT(1)>=3 UNION SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""c"".""contest_id"")>=3"
454,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""Q1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user"" FROM ""Contests"" ORDER BY ""contest_id""), ""Q2"" AS (SELECT ""user"",""contest_id"",DENSE_RANK() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") FROM ""q1""), ""Q3"" AS (SELECT DISTINCT ""a"".""user"" AS ""user"" FROM ((""q2"" AS ""a"") CROSS JOIN ""q2"" AS ""b"") CROSS JOIN ""q2"" AS ""c"" WHERE ""a"".""user""=""b"".""user"" AND ""a"".""user""=""c"".""user"" AND ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 UNION SELECT ""gold_medal"" AS ""user"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Q3"" AS ""a"" LEFT JOIN ""Users"" AS ""b"" ON ""user""=""user_id"""
455,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
456,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
457,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" WHERE ""u"".""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"") AS ""sub"") AS ""sub2"" GROUP BY ""grp"",""user_id"" HAVING COUNT(1)>=3) OR ""u"".""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
458,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""t1"" AS (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""t""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" WHERE (""contest_id""=""diff""+2) UNION ALL SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""mail"",""name"" FROM ""t2"" JOIN ""Users"" USING (""user_id"")"
459,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""cte2"" AS (SELECT ""c1"".""contest_id"",""c1"".""medal"" FROM (""cte1"" AS ""c1"" JOIN ""cte1"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c1"".""medal""=""c2"".""medal"") JOIN ""cte1"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" AND ""c1"".""medal""=""c3"".""medal""), ""cte3"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT ""medal"" FROM ""cte2"" UNION SELECT ""gold_medal"" FROM ""cte3"") AS ""cte4"" ON ""u"".""user_id""=""cte4"".""medal"""
460,"WITH ""TEMP"" AS (SELECT ""user_id"",""contest_id"" FROM ""Contests"" AS ""C"" JOIN ""USERS"" AS ""U"" ON ""C"".""gold_medal""=""U"".""user_id"" OR ""C"".""silver_medal""=""U"".""user_id"" OR ""C"".""bronze_medal""=""U"".""user_id""), ""CON1"" AS (SELECT ""T1"".""user_id"" FROM ((""TEMP"" AS ""T1"") CROSS JOIN ""TEMP"" AS ""T2"") CROSS JOIN ""TEMP"" AS ""T3"" WHERE (""T1"".""user_id""=""T2"".""user_id"" AND ""T2"".""user_id""=""T3"".""user_id"" AND ""T1"".""contest_id""+1=""T2"".""contest_id"" AND ""T2"".""contest_id""+1=""T3"".""contest_id"") GROUP BY 1) SELECT ""name"",""mail"" FROM ""USERS"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""CON1"") OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(1)>=3)"
461,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
462,"WITH ""sum_cte"" AS (SELECT ""u"".""name"",""u"".""mail"",""contest_id"",(""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""medal_rank"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""gold_medal"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") SELECT ""name"",""mail"" FROM ""sum_cte"" GROUP BY ""name"",""mail"",""medal_rank"" HAVING COUNT(""medal_rank"")>=3 UNION SELECT ""name"",""mail"" FROM ""sum_cte"" GROUP BY ""name"",""mail"" HAVING SUM(""gold_medal"")>=3"
463,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user_id"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""t0""), ""t2"" AS (SELECT ""user_id"" FROM ""t1"" GROUP BY ""user_id"",""contest_id""-""rnk"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""t2"" JOIN ""Users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
464,"WITH ""a"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""contests"") SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT ""a1"".""user_id"" FROM (SELECT ""a"".""user_id"",""a"".""contest_id""-RANK() OVER (PARTITION BY ""a"".""user_id"" ORDER BY ""a"".""contest_id"") AS ""diff"" FROM ""a"") AS ""a1"" GROUP BY ""a1"".""user_id"",""diff"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) AS ""b"" ON ""u"".""user_id""=""b"".""user_id"""
465,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests""), ""c"" AS (SELECT ""contest_id"",""user_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"") AS ""drnk"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""usrdrnk"",(DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")) AS ""grp"" FROM ""cte""), ""d"" AS (SELECT *,COUNT(""user_id"") AS ""cnt"" FROM ""c"" GROUP BY ""grp"",""user_id"" HAVING COUNT(""user_id"")>2), ""gold"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2) SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""contest_id"",""user_id"" FROM ""d"" UNION SELECT ""contest_id"",""gold_medal"" FROM ""gold"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""user_id""=""u"".""user_id"""
466,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
467,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""cte2"" AS (SELECT ""contest_id"",""user_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rk"" FROM ""cte1""), ""cte3"" AS (SELECT ""user_id"" FROM ""cte2"" GROUP BY ""user_id"",""contest_id""-""rk"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""cte3"" JOIN ""Users"" USING (""user_id"")"
468,"WITH ""cte_gold"" AS (SELECT ""gold_medal"" AS ""user_id"",COUNT(1) FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""cte_other"" AS (SELECT ""C1"".""gold_medal"" AS ""user_id"" FROM ((""Contests"" AS ""C1"") CROSS JOIN ""Contests"" AS ""C2"") CROSS JOIN ""Contests"" AS ""C3"" WHERE (""C1"".""contest_id""=""C2"".""contest_id""+1 AND (""C1"".""gold_medal""=""C2"".""gold_medal"" OR ""C1"".""gold_medal""=""C2"".""silver_medal"" OR ""C1"".""gold_medal""=""C2"".""bronze_medal"")) AND (""C1"".""contest_id""=""C3"".""contest_id""+2 AND (""C1"".""gold_medal""=""C3"".""gold_medal"" OR ""C1"".""gold_medal""=""C3"".""silver_medal"" OR ""C1"".""gold_medal""=""C3"".""bronze_medal"")) UNION SELECT ""C1"".""silver_medal"" AS ""user_id"" FROM ((""Contests"" AS ""C1"") CROSS JOIN ""Contests"" AS ""C2"") CROSS JOIN ""Contests"" AS ""C3"" WHERE (""C1"".""contest_id""=""C2"".""contest_id""+1 AND (""C1"".""silver_medal""=""C2"".""gold_medal"" OR ""C1"".""silver_medal""=""C2"".""silver_medal"" OR ""C1"".""silver_medal""=""C2"".""bronze_medal"")) AND (""C1"".""contest_id""=""C3"".""contest_id""+2 AND (""C1"".""silver_medal""=""C3"".""gold_medal"" OR ""C1"".""silver_medal""=""C3"".""silver_medal"" OR ""C1"".""silver_medal""=""C3"".""bronze_medal"")) UNION SELECT ""C1"".""bronze_medal"" AS ""user_id"" FROM ((""Contests"" AS ""C1"") CROSS JOIN ""Contests"" AS ""C2"") CROSS JOIN ""Contests"" AS ""C3"" WHERE (""C1"".""contest_id""=""C2"".""contest_id""+1 AND (""C1"".""bronze_medal""=""C2"".""gold_medal"" OR ""C1"".""bronze_medal""=""C2"".""silver_medal"" OR ""C1"".""bronze_medal""=""C2"".""bronze_medal"")) AND (""C1"".""contest_id""=""C3"".""contest_id""+2 AND (""C1"".""bronze_medal""=""C3"".""gold_medal"" OR ""C1"".""bronze_medal""=""C3"".""silver_medal"" OR ""C1"".""bronze_medal""=""C3"".""bronze_medal""))) SELECT ""name"",""mail"" FROM (SELECT ""user_id"" FROM ""cte_gold"" UNION SELECT ""user_id"" FROM ""cte_other"") AS ""sub"" JOIN ""users"" AS ""U"" ON ""sub"".""user_id""=""U"".""user_id"""
469,"WITH ""long_format"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"" ORDER BY 1), ""rnking"" AS (SELECT ""contest_id"",""user_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""long_format""), ""gold_medal"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""candidate_ids"" AS (SELECT ""user_id"" FROM ""rnking"" GROUP BY ""user_id"",""contest_id""-""rnk"" HAVING COUNT(1)>=3 UNION SELECT ""user_id"" FROM ""gold_medal"") SELECT ""name"",""mail"" FROM ""users"" JOIN ""candidate_ids"" AS ""candi"" ON ""users"".""user_id""=""candi"".""user_id"""
470,"WITH ""tbl1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""tbl2"" AS (SELECT DISTINCT ""c1"".""medal"" FROM (""tbl1"" AS ""c1"" JOIN ""tbl1"" AS ""c2"" ON ""c2"".""contest_id""-""c1"".""contest_id""=1 AND ""c1"".""medal""=""c2"".""medal"") JOIN ""tbl1"" AS ""c3"" ON ""c3"".""contest_id""-""c2"".""contest_id""=1 AND ""c1"".""medal""=""c3"".""medal"" UNION ALL SELECT DISTINCT ""gold_medal"" AS ""medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""tbl2"" JOIN ""Users"" AS ""u"" ON ""tbl2"".""medal""=""u"".""user_id"""
471,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""Contests""), ""t1"" AS (SELECT ""user"",""contest_id"",RANK() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rk"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"",""contest_id"" FROM ""t1"" GROUP BY ""user_id"",""contest_id""-""rk"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" GROUP BY ""user_id"" HAVING COUNT(1)>=3) SELECT DISTINCT ""U"".""name"",""U"".""mail"" FROM ""Users"" AS ""U"" JOIN ""t2"" ON ""U"".""user_id""=""t2"".""user_id"""
472,"WITH ""c1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""melted"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""c2"" AS (SELECT ""u1"".""user_id"" FROM ((""melted"" AS ""u1"") CROSS JOIN ""melted"" AS ""u2"") CROSS JOIN ""melted"" AS ""u3"" WHERE ""u1"".""contest_id""=""u2"".""contest_id""-1 AND ""u2"".""contest_id""=""u3"".""contest_id""-1 AND ""u1"".""user_id""=""u2"".""user_id"" AND ""u2"".""user_id""=""u3"".""user_id""), ""both_conditions"" AS (SELECT ""user_id"" FROM ""c1"" UNION SELECT ""user_id"" FROM ""c2"") SELECT ""u"".""name"",""u"".""mail"" FROM ""both_conditions"" AS ""b"" JOIN ""Users"" AS ""u"" ON ""b"".""user_id""=""u"".""user_id"""
473,"WITH ""cte"" AS (SELECT ""name"",""mail"",""contest_id"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT ""name"",""mail"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""contest_id"")>=3 UNION (SELECT DISTINCT ""t1"".""name"",""t1"".""mail"" FROM ""cte"" AS ""t1"" JOIN ""cte"" AS ""t2"" ON ""t1"".""name""=""t2"".""name"" AND ""t1"".""mail""=""t2"".""mail"" AND ""t2"".""contest_id""-""t1"".""contest_id"" BETWEEN 0 AND 2 GROUP BY ""t1"".""name"",""t1"".""mail"",""t1"".""contest_id"" HAVING COUNT(DISTINCT ""t2"".""contest_id"")>=3)"
474,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""c"".""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
475,"WITH ""new_contests"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_contests"" AS ""c1"" LEFT JOIN ""new_contests"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_contests"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT DISTINCT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""c"" ON ""u"".""user_id""=""c"".""id"""
476,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
477,"SELECT ""d"".""name"",""d"".""mail"" FROM (SELECT DISTINCT ""medal"" AS ""user_id"" FROM (SELECT ""medal"",""contest_id"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""next_contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""next_2_contest_id"" FROM (SELECT DISTINCT ""contest_id"",""medal"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") AS ""a"") AS ""b"") AS ""c"" WHERE ""next_contest_id""=""contest_id""+1 AND ""next_2_contest_id""=""contest_id""+2 UNION SELECT DISTINCT ""medal"" AS ""user_id"" FROM (SELECT ""medal"",COUNT(""medal"") AS ""num"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"") AS ""a"" GROUP BY ""medal"" HAVING ""num"">=3) AS ""b"") AS ""c"" LEFT JOIN ""Users"" AS ""d"" ON ""c"".""user_id""=""d"".""user_id"""
478,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""c1"".""id"" FROM ((""CTE"" AS ""c1"") CROSS JOIN ""CTE"" AS ""c2"") CROSS JOIN ""CTE"" AS ""c3"" WHERE ""c1"".""id""=""c2"".""id"" AND ""c2"".""id""=""c3"".""id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c3"".""contest_id""=""c2"".""contest_id""+1)"
479,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
480,"SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN (WITH ""u"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"",'gold' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"",'silver' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"",'bronze' AS ""type"" FROM ""Contests"") SELECT ""medal"" FROM ""u"" WHERE ""type""='gold' GROUP BY ""medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""m"".""medal"" FROM (""u"" AS ""f"" CROSS JOIN ""u"" AS ""m"") JOIN ""u"" AS ""l"" ON (""f"".""contest_id""=""m"".""contest_id""-1 AND ""f"".""contest_id""=""l"".""contest_id""-2) AND (""f"".""medal""=""m"".""medal"") AND (""f"".""medal""=""l"".""medal"")) AS ""x"" ON ""x"".""medal""=""u"".""user_id"""
481,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
482,"WITH ""CTE"" AS (SELECT ""contest_id"",'Gold' AS ""Medal_Type"",""Gold_Medal"" AS ""Winner_Id"" FROM ""contests"" UNION SELECT ""contest_id"",'Silver' AS ""Medal_Type"",""silver_Medal"" AS ""Winner_Id"" FROM ""contests"" UNION SELECT ""contest_id"",'Bronze' AS ""Medal_Type"",""bronze_Medal"" AS ""Winner_Id"" FROM ""contests""), ""CTE_TMP"" AS (SELECT ""Winner_id"",""Contest_id"",""Contest_id""-ROW_NUMBER() OVER (PARTITION BY ""Winner_id"" ORDER BY ""winner_id"",""contest_id"") AS ""Rn"" FROM ""CTE"" ORDER BY 1,2), ""CTE_Final"" AS (SELECT ""winner_id"",""rn"",COUNT(DISTINCT ""contest_id"") AS ""wins"" FROM ""cte_tmp"" GROUP BY 1,2 UNION ALL SELECT ""winner_id"",""Medal_type"",COUNT(DISTINCT ""contest_id"") AS ""wins"" FROM ""cte"" WHERE ""Medal_type""='Gold' GROUP BY 1,2) SELECT DISTINCT ""r"".""name"",""r"".""mail"" FROM ""cte_final"" AS ""cf"" JOIN ""users"" AS ""r"" ON ""cf"".""winner_id""=""r"".""user_id"" WHERE ""cf"".""wins"">=3"
483,"SELECT ""name"",""mail"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""contest_id"")>=3 UNION (SELECT DISTINCT ""t1"".""name"",""t1"".""mail"" FROM (SELECT ""name"",""mail"",""contest_id"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") AS ""t1"" JOIN (SELECT ""name"",""mail"",""contest_id"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") AS ""t2"" ON ""t1"".""name""=""t2"".""name"" AND ""t1"".""mail""=""t2"".""mail"" AND ""t2"".""contest_id""-""t1"".""contest_id"" BETWEEN 0 AND 2 GROUP BY ""t1"".""name"",""t1"".""mail"",""t1"".""contest_id"" HAVING COUNT(DISTINCT ""t2"".""contest_id"")>=3)"
484,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM ((""t"" AS ""a"") CROSS JOIN ""t"" AS ""b"") CROSS JOIN ""t"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""b"".""contest_id""=""c"".""contest_id""-1 AND ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""t1"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(DISTINCT ""contest_id"")>=3)"
485,"SELECT DISTINCT ""U"".""name"",""U"".""mail"" FROM (((""Users"" AS ""U"") CROSS JOIN ""Contests"" AS ""C1"") CROSS JOIN ""Contests"" AS ""C2"") CROSS JOIN ""Contests"" AS ""C3"" WHERE ""U"".""USER_ID"" IN (""C1"".""GOLD_MEDAL"",""C1"".""SILVER_MEDAL"",""C1"".""BRONZE_MEDAL"") AND ""U"".""USER_ID"" IN (""C2"".""GOLD_MEDAL"",""C2"".""SILVER_MEDAL"",""C2"".""BRONZE_MEDAL"") AND ""U"".""USER_ID"" IN (""C3"".""GOLD_MEDAL"",""C3"".""SILVER_MEDAL"",""C3"".""BRONZE_MEDAL"") AND ""C1"".""CONTEST_ID""=""C2"".""CONTEST_ID""+1 AND ""C2"".""CONTEST_ID""=""C3"".""CONTEST_ID""+1 UNION SELECT ""U"".""NAME"",""U"".""MAIL"" FROM ""Users"" AS ""U"" JOIN ""Contests"" AS ""C"" ON ""U"".""user_id""=""C"".""gold_medal"" GROUP BY ""U"".""user_id"" HAVING COUNT(""CONTEST_ID"")>=3"
486,"WITH ""T"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""row_num"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") AS ""a""), ""T1"" AS (SELECT DISTINCT ""user_id"" FROM ""T"" GROUP BY ""user_id"",""contest_id""-""row_num"" HAVING COUNT(""contest_id"")>=3), ""T2"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""U"" AS (SELECT * FROM ""T1"" UNION SELECT * FROM ""T2"") SELECT ""a"".""name"",""a"".""mail"" FROM ""Users"" AS ""a"" JOIN ""U"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"""
487,"WITH ""cte"" AS (SELECT ""user_id"",""mail"",""name"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prepre"" FROM ""users"" AS ""a"" LEFT JOIN ""contests"" AS ""b"" ON ""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prepre""=2)>=1"
488,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""u"".""mail"",""u"".""name"" HAVING COUNT(""c"".""gold_medal"")>=3 UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ((""Users"" AS ""u"" JOIN ""Contests"" AS ""c1"" ON ""u"".""user_id""=""c1"".""gold_medal"" OR ""u"".""user_id""=""c1"".""silver_medal"" OR ""u"".""user_id""=""c1"".""bronze_medal"") JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""+1 AND (""u"".""user_id""=""c2"".""gold_medal"" OR ""u"".""user_id""=""c2"".""silver_medal"" OR ""u"".""user_id""=""c2"".""bronze_medal"")) JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_Id""=""c2"".""contest_id""+1 AND (""u"".""user_id""=""c3"".""gold_medal"" OR ""u"".""user_id""=""c3"".""silver_medal"" OR ""u"".""user_id""=""c3"".""bronze_medal"")"
489,"WITH ""GoldWinner"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""AllWinner"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""ConsecutiveWinnersTemp"" AS (SELECT ""user_id"",""contest_id"" AS ""CurrentWin"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""3rdWin"" FROM ""AllWinner""), ""ConsecutiveWinnersFinal"" AS (SELECT DISTINCT ""user_id"" FROM ""ConsecutiveWinnersTemp"" WHERE ""3rdWin""-""CurrentWin""=2) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""GoldWinner"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""ConsecutiveWinnersFinal"")"
490,"WITH ""cte"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""u"".""user_id""=""c"".""gold_medal"" THEN 1 ELSE 0 END AS ""Gold"",CASE WHEN ""u"".""user_id""=""c"".""silver_medal"" THEN 1 ELSE 0 END AS ""Silver"",CASE WHEN ""u"".""user_id""=""c"".""bronze_medal"" THEN 1 ELSE 0 END AS ""Bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""Gold""+""Silver""+""Bronze"") OVER (PARTITION BY ""name"", ""mail"", ""grp"" ORDER BY ""contest_id"") AS ""medalsum"",SUM(""GOLD"") OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""contest_id"") AS ""goldsum"" FROM ""CTE"") AS ""a"" WHERE ""medalsum"">=3 OR ""goldsum"">=3"
491,"SELECT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""users"" AS ""u"") CROSS JOIN ""contests"" AS ""c1"") CROSS JOIN ""contests"" AS ""c2"") CROSS JOIN ""contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c2"".""contest_id""=""c3"".""contest_id""+1"
492,"WITH ""cont"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cont"" AS ""c1"") CROSS JOIN ""cont"" AS ""c2"") CROSS JOIN ""cont"" AS ""c3"" WHERE ""c1"".""contest_id""+1=""c2"".""contest_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"" AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3)"
493,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""con1t"" AS (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""con2t"" AS (SELECT ""user_id"" FROM ""cte"" WHERE ""medal""='gold' GROUP BY ""user_id"" HAVING COUNT(DISTINCT ""contest_id"")>=3) SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""con1t"" UNION ALL SELECT ""user_id"" FROM ""con2t"")"
494,"WITH ""t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM ((""t"" AS ""a"") CROSS JOIN ""t"" AS ""b"") CROSS JOIN ""t"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""b"".""contest_id""=""c"".""contest_id""-1 AND ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""t1"" UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3)"
495,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
496,"SELECT ""a"".""name"",""a"".""mail"" FROM (SELECT *,LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_two"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id"" IN (""c"".""gold_medal"",""c"".""silver_medal"",""c"".""bronze_medal"")) AS ""a"" GROUP BY ""user_id"" HAVING SUM(""user_id""=""gold_medal"")>=3 OR SUM(""contest_id""-""lag_two""=2)>=1"
497,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
498,"WITH ""cte"" AS (SELECT DISTINCT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3), ""cte2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""cte3"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""cte"" UNION SELECT DISTINCT ""c1"".""medal"" FROM (""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""contest_id""=""c2"".""contest_id""-1) JOIN ""cte2"" AS ""c3"" ON ""c1"".""contest_id""=""c3"".""contest_id""-2 WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c1"".""medal""=""c3"".""medal"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""id""=""u"".""user_id"""
499,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"" AS ""first"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""second"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""third"" FROM ""cte1""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM ""cte2"" WHERE ""first""+1=""second"" AND ""second""+1=""third""), ""cte4"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte5"" AS (SELECT ""user_id"" FROM ""cte3"" UNION ALL SELECT ""gold_medal"" FROM ""cte4"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""cte5"" AS ""c"" USING (""user_id"")"
500,"WITH ""res_temp"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""B"".""name"",""B"".""mail"" FROM (SELECT DISTINCT ""A"".""user_id"" FROM (""res_temp"" AS ""A"" JOIN ""res_temp"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"" AND ""A"".""contest_id""+1=""B"".""contest_id"") JOIN ""res_temp"" AS ""C"" ON ""B"".""user_id""=""C"".""user_id"" AND ""B"".""contest_id""+1=""C"".""contest_id"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) AS ""A"" LEFT JOIN ""Users"" AS ""B"" ON ""A"".""user_id""=""B"".""user_id"""
501,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
502,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
503,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
504,"WITH ""t1"" AS (SELECT ""contest_id"",""mail"",""name"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") SELECT ""name"",""mail"" FROM ""t1"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3"
505,"WITH ""base"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""player"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""player"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""player"" FROM ""Contests""), ""p2"" AS (SELECT ""player"",SUM(CASE WHEN ""medal""='gold' THEN 1 ELSE 0 END) AS ""n_gold"" FROM ""base"" GROUP BY 1 HAVING SUM(CASE WHEN ""medal""='gold' THEN 1 ELSE 0 END)>=3), ""p3"" AS (SELECT ""b"".""contest_id"",""b"".""player"",""p"".""gold_medal"" AS ""prev_gold"",""p"".""silver_medal"" AS ""prev_silver"",""p"".""bronze_medal"" AS ""prev_bronze"",""n"".""gold_medal"" AS ""next_gold"",""n"".""silver_medal"" AS ""next_silver"",""n"".""bronze_medal"" AS ""next_bronze"",CASE WHEN ""b"".""player""=""p"".""gold_medal"" THEN 1 ELSE 0 END AS ""a"",CASE WHEN ""b"".""player""=""p"".""silver_medal"" THEN 1 ELSE 0 END AS ""b"",CASE WHEN ""b"".""player""=""p"".""bronze_medal"" THEN 1 ELSE 0 END AS ""c"",CASE WHEN ""b"".""player""=""n"".""gold_medal"" THEN 1 ELSE 0 END AS ""d"",CASE WHEN ""b"".""player""=""n"".""silver_medal"" THEN 1 ELSE 0 END AS ""e"",CASE WHEN ""b"".""player""=""n"".""bronze_medal"" THEN 1 ELSE 0 END AS ""f"" FROM (""base"" AS ""b"" LEFT JOIN ""Contests"" AS ""p"" ON ""b"".""contest_id""=""p"".""contest_id""+1) LEFT JOIN ""Contests"" AS ""n"" ON ""b"".""contest_id""+1=""n"".""contest_id""), ""idLs"" AS (SELECT DISTINCT ""player"" FROM ""p3"" WHERE ""a""+""b""+""c""+""d""+""e""+""f"">=2 UNION SELECT DISTINCT ""player"" FROM ""p2"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""player"" FROM ""idLs"")"
506,"SELECT ""name"",""mail"" FROM (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") AS ""a"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
507,"WITH ""gold"" AS (SELECT ""c"".""contest_id"",""c"".""gold_medal"" AS ""win"" FROM ""Contests"" AS ""c""), ""silver"" AS (SELECT ""c"".""contest_id"",""c"".""silver_medal"" AS ""win"" FROM ""Contests"" AS ""c""), ""bronze"" AS (SELECT ""c"".""contest_id"",""c"".""bronze_medal"" AS ""win"" FROM ""Contests"" AS ""c"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT DISTINCT ""win"" FROM (SELECT ""p"".""win"",COUNT(""contest_id"") OVER (PARTITION BY ""win"" ORDER BY ""contest_id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""consec_win"" FROM (SELECT * FROM ""gold"" UNION SELECT * FROM ""silver"" UNION SELECT * FROM ""bronze"") AS ""p"") AS ""consec"" WHERE ""consec_win""=3 UNION (SELECT ""gold_medal"" AS ""win"" FROM ""Contests"" GROUP BY ""win"" HAVING COUNT(""contest_id"")>=3))"
508,"WITH ""gold_medal_users"" AS (SELECT ""gold_medal"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY 1 HAVING COUNT(1)>=3), ""three_consecutive_gold"" AS (SELECT ""c1"".""gold_medal"" FROM (""Contests"" AS ""c1"" JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""+1 AND (""c1"".""gold_medal""=""c2"".""silver_medal"" OR ""c1"".""gold_medal""=""c2"".""gold_medal"" OR ""c1"".""gold_medal""=""c2"".""bronze_medal"")) JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_id""=""c2"".""contest_id""+1 AND (""c1"".""gold_medal""=""c3"".""silver_medal"" OR ""c1"".""gold_medal""=""c3"".""gold_medal"" OR ""c1"".""gold_medal""=""c3"".""bronze_medal"")), ""three_consecutive_silver"" AS (SELECT ""c1"".""silver_medal"" FROM (""Contests"" AS ""c1"" JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""+1 AND (""c1"".""silver_medal""=""c2"".""silver_medal"" OR ""c1"".""silver_medal""=""c2"".""gold_medal"" OR ""c1"".""silver_medal""=""c2"".""bronze_medal"")) JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_id""=""c2"".""contest_id""+1 AND (""c1"".""silver_medal""=""c3"".""silver_medal"" OR ""c1"".""silver_medal""=""c3"".""gold_medal"" OR ""c1"".""silver_medal""=""c3"".""bronze_medal"")), ""three_consecutive_bronze"" AS (SELECT ""c1"".""bronze_medal"" FROM (""Contests"" AS ""c1"" JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""+1 AND (""c1"".""bronze_medal""=""c2"".""silver_medal"" OR ""c1"".""bronze_medal""=""c2"".""gold_medal"" OR ""c1"".""bronze_medal""=""c2"".""bronze_medal"")) JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_id""=""c2"".""contest_id""+1 AND (""c1"".""bronze_medal""=""c3"".""silver_medal"" OR ""c1"".""bronze_medal""=""c3"".""gold_medal"" OR ""c1"".""bronze_medal""=""c3"".""bronze_medal"")) SELECT ""name"",""mail"" FROM (SELECT ""silver_medal"" AS ""id"" FROM ""three_consecutive_silver"" UNION SELECT ""gold_medal"" AS ""id"" FROM ""three_consecutive_gold"" UNION SELECT ""bronze_medal"" AS ""id"" FROM ""three_consecutive_bronze"" UNION SELECT * FROM ""gold_medal_users"") AS ""a"" JOIN ""users"" AS ""u"" ON ""a"".""id""=""u"".""user_id"""
509,"WITH ""new_data"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") SELECT DISTINCT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT (""user_id"") FROM (SELECT *,LAG(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_1"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_2"" FROM ""new_data"") AS ""b"" WHERE ""contest_id""-""lag_2""=2 AND ""contest_id""-""lag_1""=1 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""a"" ON ""u"".""user_id""=""a"".""user_id"""
510,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
511,"WITH ""contest_unpivot"" AS (SELECT ""contest_id"",""type"",""contestant_id"" FROM (SELECT ""contest_id"",'gold' AS ""type"",""gold_medal"" AS ""contestant_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""type"",""silver_medal"" AS ""contestant_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""type"",""bronze_medal"" AS ""contestant_id"" FROM ""Contests"") AS ""a""), ""three_gold_cons"" AS (SELECT ""contestant_id"" FROM ""contest_unpivot"" WHERE ""type""='gold' GROUP BY ""contestant_id"" HAVING COUNT(""type"")>2 UNION ALL SELECT DISTINCT ""contestant_id"" FROM (SELECT ""contestant_id"",""contest_id"" AS ""curr"",LAG(""contest_id"", 2) OVER (PARTITION BY ""contestant_id"" ORDER BY ""contest_id"") AS ""prev_2"" FROM ""contest_unpivot"" ORDER BY ""contestant_id"",""contest_id"") AS ""a"" WHERE ""curr""-""prev_2""=2) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""three_gold_cons"" AS ""w"" ON ""u"".""user_id""=""w"".""contestant_id"""
512,"WITH ""consecutive"" AS (SELECT *,LEAD(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""contest_id_led"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests"") AS ""a"") SELECT ""name"",""mail"" FROM ""Users"" JOIN ""consecutive"" ON ""user_id""=""medal"" WHERE ""contest_id_led""-""contest_id""=2 UNION SELECT ""name"",""mail"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3"
513,"WITH ""golds"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""all_data"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""consecs"" AS (SELECT ""contest_id"",""user_id"" FROM ""all_data"" WHERE ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""all_data"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""all_data"")) SELECT ""name"",""mail"" FROM ""users"" AS ""u"" WHERE EXISTS (SELECT * FROM ""golds"" AS ""g"" WHERE ""u"".""user_id""=""g"".""user_id"") OR EXISTS (SELECT * FROM ""consecs"" AS ""c"" WHERE ""u"".""user_id""=""c"".""user_id"")"
514,"WITH ""temp"" AS (SELECT ""user_id"",""contest_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"") AS ""TBL""), ""temp2"" AS (SELECT DISTINCT ""U"".""name"",""U"".""mail"" FROM (SELECT ""user_id"",""contest_id""-""rnk"" AS ""delta"",COUNT(1) AS ""consecutive_cnt"" FROM ""temp"" GROUP BY 1,2) AS ""TBL"" LEFT JOIN ""Users"" AS ""U"" ON ""TBL"".""user_id""=""U"".""user_id"" WHERE ""consecutive_cnt"">=3) (SELECT DISTINCT ""U"".""name"",""U"".""mail"" FROM (SELECT ""gold_medal"",COUNT(""contest_id"") AS ""gold_cnt"" FROM ""Contests"" GROUP BY 1) AS ""TBL"" LEFT JOIN ""Users"" AS ""U"" ON ""TBL"".""gold_medal""=""U"".""user_id"" WHERE ""gold_cnt"">=3) UNION SELECT * FROM ""temp2"""
515,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
516,"WITH ""gold"" AS (SELECT DISTINCT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""medal"" AS (SELECT DISTINCT ""c1"".""user_id"" FROM (""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1) JOIN ""cte"" AS ""c3"" ON ""c2"".""user_id""=""c3"".""user_id"" AND ""c2"".""contest_id""=""c3"".""contest_id""-1) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""medal"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""gold"")"
517,"WITH ""temp"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""previous"" FROM ""users"" LEFT JOIN ""contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""temp"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""previous""=2)>=1"
518,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" LEFT JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""c"".""gold_medal"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
519,"WITH ""Medalists"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""U"".""name"",""U"".""mail"" FROM (((""Medalists"" AS ""M1"") CROSS JOIN ""Medalists"" AS ""M2"") CROSS JOIN ""Medalists"" AS ""M3"") CROSS JOIN ""Users"" AS ""U"" WHERE ""M1"".""contest_id""=""M2"".""contest_id""+1 AND ""M1"".""user_id""=""M2"".""user_id"" AND ""M1"".""contest_id""=""M3"".""contest_id""+2 AND ""M1"".""user_id""=""M3"".""user_id"" AND ""M1"".""user_id""=""U"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""Users"" AS ""A"" JOIN ""Contests"" AS ""B"" ON ""A"".""user_id""=""B"".""gold_medal"" GROUP BY ""user_id"" HAVING COUNT(""contest_id"")>=3"
520,"SELECT DISTINCT ""a"".""name"",""a"".""mail"" FROM (((""users"" AS ""a"") CROSS JOIN ""contests"" AS ""b"") CROSS JOIN ""contests"" AS ""c"") CROSS JOIN ""contests"" AS ""d"" WHERE (""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"") AND (""a"".""user_id""=""c"".""gold_medal"" OR ""a"".""user_id""=""c"".""silver_medal"" OR ""a"".""user_id""=""c"".""bronze_medal"") AND (""a"".""user_id""=""d"".""gold_medal"" OR ""a"".""user_id""=""d"".""silver_medal"" OR ""a"".""user_id""=""d"".""bronze_medal"") AND ""b"".""contest_id""!=""c"".""contest_id"" AND ""c"".""contest_id""!=""d"".""contest_id"" AND ""b"".""contest_id""!=""d"".""contest_id"" AND ((""b"".""contest_id""=""c"".""contest_id""-1 AND ""c"".""contest_id""=""d"".""contest_id""-1) OR (""a"".""user_id""=""b"".""gold_medal"" AND ""b"".""gold_medal""=""c"".""gold_medal"" AND ""c"".""gold_medal""=""d"".""gold_medal""))"
521,"WITH ""cte2"" AS (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" JOIN (SELECT ""c1"".""user_id"" FROM (""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""user_id""=""c2"".""user_id"") JOIN ""cte2"" AS ""c3"" ON ""c1"".""contest_id""=""c3"".""contest_id""-2 AND ""c1"".""user_id""=""c3"".""user_id"") AS ""t1"" ON ""users"".""user_id""=""t1"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""users"" JOIN (SELECT ""user_id"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""gold_medal""=""user_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""gold_medal""=""user_id"" THEN 1 ELSE NULL END)>=3) AS ""temp"" ON ""users"".""user_id""=""temp"".""user_id"""
522,"WITH ""t0"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
523,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
524,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
525,"WITH ""t1"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""contests""), ""t3"" AS (SELECT ""contest_id"",""user_id"" FROM ""t2"" WHERE (ROW(""contest_id""+1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""+2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"")) OR (ROW(""contest_id""-1,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2"") AND ROW(""contest_id""-2,""user_id"") IN (SELECT ""contest_id"",""user_id"" FROM ""t2""))) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user_id"" FROM ""t3"")"
526,"SELECT ""name"",""mail"" FROM ""Users"" AS ""u"" JOIN ((SELECT DISTINCT ""user_id"" FROM (SELECT (""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""a"".""user_id"" ORDER BY ""contest_id"")) AS ""row_num"",""a"".""user_id"" FROM ""Contests"" JOIN ""Users"" AS ""a"" ON ""gold_medal""=""a"".""user_id"" OR ""silver_medal""=""a"".""user_id"" OR ""bronze_medal""=""a"".""user_id"") AS ""a"" GROUP BY ""user_id"",""row_num"" HAVING COUNT(1)>=3) UNION (SELECT DISTINCT ""user_id"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(1)>=3)) AS ""l"" ON ""u"".""user_id""=""l"".""user_id"""
527,"WITH ""t1"" AS (SELECT ""gold_medal"",COUNT(""gold_medal"") FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""t2"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""t3"" AS (SELECT ""medal"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""l"" FROM ""t2"") SELECT ""name"",""mail"" FROM ""users"" AS ""u"" JOIN (SELECT DISTINCT ""medal"" FROM ""t3"" WHERE ""contest_id""-""l""=2 UNION SELECT ""gold_medal"" AS ""medal"" FROM ""t1"") AS ""t"" ON ""user_id""=""medal"""
528,"SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"",DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""rnk"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"",(""tmp"".""contest_id""-""rnk"") HAVING COUNT(""tmp"".""contest_id""-""rnk"")>=3 UNION SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") AS ""tmp"" GROUP BY ""tmp"".""name"",""tmp"".""mail"" HAVING COUNT(""contest_id"")>=3"
529,"WITH ""cte1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests""), ""cte2"" AS (SELECT ""user_id"",""contest_id"" AS ""first"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""second"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""third"" FROM ""cte1""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM ""cte2"" WHERE ""first""+1=""second"" AND ""second""+1=""third""), ""cte4"" AS (SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte5"" AS (SELECT ""user_id"" FROM ""cte3"" UNION ALL SELECT ""gold_medal"" FROM ""cte4"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""cte5"" AS ""c"" USING (""user_id"")"
530,"SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"",DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""rnk"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY 1,2,(""tmp"".""contest_id""-""rnk"") HAVING COUNT(""tmp"".""contest_id""-""rnk"")>=3 UNION SELECT ""tmp"".""name"",""tmp"".""mail"" FROM (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") AS ""tmp"" GROUP BY 1,2 HAVING COUNT(""contest_id"")>=3"
531,"WITH ""unioncontests"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'broze' AS ""type"" FROM ""Contests"" GROUP BY ""contest_id"" ORDER BY ""contest_id"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (SELECT ""c1"".""user_id"" FROM (""unioncontests"" AS ""c1"" JOIN ""unioncontests"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""unioncontests"" AS ""c3"" ON ""c2"".""contest_id""+1=""c3"".""contest_id"" WHERE ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id""))"
532,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'g' AS ""type"" FROM ""Contests"" AS ""con"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'s' AS ""type"" FROM ""Contests"" AS ""con"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'b' AS ""type"" FROM ""Contests"" AS ""con""), ""cte1"" AS (SELECT ""user_id"",CASE WHEN ""type""='g' THEN 1 ELSE 0 END AS ""gold_cnt"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rn"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""gr"" FROM ""cte"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte1"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"" GROUP BY ""c"".""user_id"" HAVING SUM(""gold_cnt"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM ""cte1"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"" GROUP BY ""c"".""user_id"",""gr"" HAVING COUNT(""gold_cnt"")>=3"
533,"WITH ""gold_t"" AS (SELECT ""contest_id"",""gold_medal"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""any_t"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY ""contest_id"",""id"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" FROM ""gold_t"") OR ""user_id"" IN (SELECT ""a"".""id"" FROM ((""any_t"" AS ""a"") CROSS JOIN ""any_t"" AS ""b"") CROSS JOIN ""any_t"" AS ""c"" WHERE ""a"".""id""=""b"".""id"" AND ""b"".""id""=""c"".""id"" AND ""a"".""contest_id""+1=""b"".""contest_id"" AND ""b"".""contest_id""+1=""c"".""contest_id"")"
534,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (WITH ""contest_medal"" (""contest_id"", ""user_id"") AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" FROM ""Contests"") SELECT DISTINCT ""c1"".""user_id"" FROM (""contest_medal"" AS ""c1"" JOIN ""contest_medal"" AS ""c2"" ON ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1) JOIN ""contest_medal"" AS ""c3"" ON ""c1"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""=""c3"".""contest_id""-2 UNION ALL SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING (COUNT(1))>2)"
535,"WITH ""CTE"" AS (SELECT ""contest_id"",""gold_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""win_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""win_id"" FROM ""Contests""), ""CTE1"" AS (SELECT DISTINCT ""c1"".""win_id"" FROM (""CTE"" AS ""c1"" JOIN ""CTE"" AS ""c2"" ON ""c1"".""win_id""=""c2"".""win_id"" AND ""c1"".""contest_id""+1=""c2"".""contest_id"") JOIN ""CTE"" AS ""c3"" ON ""c2"".""win_id""=""c3"".""win_id"" AND ""c2"".""contest_id""+1=""c3"".""contest_id"" UNION SELECT ""gold_medal"" AS ""win_id"" FROM ""Contests"" AS ""c"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3) SELECT ""name"",""mail"" FROM ""CTE1"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""win_id""=""u"".""user_id"""
536,"WITH ""cte"" AS (SELECT ""name"",""mail"",""contest_id"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT ""name"",""mail"" FROM ""Contests"" JOIN ""Users"" ON ""gold_medal""=""user_id"" GROUP BY 1,2 HAVING COUNT(DISTINCT ""contest_id"")>=3 UNION (SELECT DISTINCT ""t1"".""name"",""t1"".""mail"" FROM ""cte"" AS ""t1"" JOIN ""cte"" AS ""t2"" ON ""t1"".""name""=""t2"".""name"" AND ""t1"".""mail""=""t2"".""mail"" AND ""t2"".""contest_id""-""t1"".""contest_id"" BETWEEN 0 AND 2 GROUP BY ""t1"".""name"",""t1"".""mail"",""t1"".""contest_id"" HAVING COUNT(DISTINCT ""t2"".""contest_id"")>=3)"
537,"WITH ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests"" ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) OR ""user_id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""id""=""a2"".""id"" AND ""a2"".""id""=""a3"".""id"" AND ""a1"".""contest_id""+1=""a2"".""contest_id"" AND ""a2"".""contest_id""+1=""a3"".""contest_id"")"
538,"WITH ""base"" AS (SELECT ""contest_id"",""gold_medal"" AS ""winner"",'g' AS ""flag"" FROM ""contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""winner"",'s' AS ""flag"" FROM ""contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""winner"",'b' AS ""flag"" FROM ""contests"" ORDER BY 1), ""seq"" AS (SELECT ""contest_id"",""winner"",""flag"",DENSE_RANK() OVER (PARTITION BY ""winner"" ORDER BY ""contest_id"") AS ""seq"" FROM ""base""), ""start_position"" AS (SELECT ""contest_id"",""winner"",""flag"",""seq"",""contest_id""-""seq"" AS ""start_position"" FROM ""seq""), ""consecutive_winner"" AS (SELECT DISTINCT ""winner"" FROM (SELECT ""winner"",COUNT(1) AS ""consecutive_cnt"" FROM ""start_position"" GROUP BY ""start_position"",""winner"") AS ""a"" WHERE ""consecutive_cnt"">=3), ""gold_r"" AS (SELECT ""winner"" FROM ""base"" WHERE ""flag""='g' GROUP BY ""winner"" HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""consecutive_winner"") OR ""user_id"" IN (SELECT * FROM ""gold_r"")"
539,"WITH ""cte"" AS (SELECT DISTINCT * FROM ""Contests"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"" OR ""c"".""gold_medal""=""u"".""user_id""), ""cte_2"" AS (SELECT DISTINCT * FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"") SELECT ""c1"".""name"",""c1"".""mail"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON (""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c1"".""user_id""=""c2"".""user_id"") OR (""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""user_id""=""c2"".""user_id"") GROUP BY ""c1"".""user_id"",""c1"".""contest_id"" HAVING COUNT(1)=2 UNION SELECT ""name"",""mail"" FROM ""cte_2"" GROUP BY ""user_id"" HAVING COUNT(1)>=3"
540,"WITH ""gold"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""any_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""Contests""), ""temp"" AS (SELECT ""id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""grp"",""contest_id"" FROM ""any_medal""), ""medal"" AS (SELECT ""id"" FROM ""temp"" GROUP BY ""id"",(""contest_id""-""grp"") HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT * FROM ""gold"") OR ""user_id"" IN (SELECT * FROM ""medal"")"
541,"WITH ""userInfo"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests""), ""qualifUsers"" AS (SELECT DISTINCT ""a"".""user_id"" FROM (""userInfo"" AS ""a"" JOIN ""userInfo"" AS ""b"" ON ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""user_id""=""b"".""user_id"") JOIN ""userInfo"" AS ""c"" ON ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""c"".""user_id""), ""qualifUsers2"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY 1 HAVING COUNT(""contest_id"")>=3) SELECT ""name"",""mail"" FROM (""Users"" LEFT JOIN ""qualifUsers"" USING (""user_id"")) LEFT JOIN ""qualifUsers2"" USING (""user_id"") WHERE ""qualifUsers"".""user_id"" IS NOT NULL OR ""qualifUsers2"".""user_id"" IS NOT NULL"
542,"WITH ""cte"" AS (SELECT ""contest_id"",""user_id"",""contest_id""-LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""ld"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM (""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") LEFT JOIN ""cte"" ON ""Users"".""user_id""=""cte"".""user_id"" AND ""Contests"".""contest_id""=""cte"".""contest_id"" GROUP BY ""Users"".""user_id"" HAVING SUM(""gold_medal""=""Users"".""user_id"")>=3 OR SUM(""cte"".""ld""=2)>=1"
543,"ERROR: mysql parse error: line 1 column 399 near ""union all (select distinct t1.user_id from t t1, t t2, t t3 where t1.contest_id=t2.contest_id-1 and t2.contest_id=t3.contest_id-1 and t1.user_id=t2.user_id and t2.user_id=t3.user_id)) "" "
544,"SELECT ""u"".""name"",""u"".""mail"" FROM (""users"" AS ""u"") CROSS JOIN (SELECT ""t1"".""gold_medal"" AS ""user_id"" FROM ((""contests"" AS ""t1"") CROSS JOIN ""contests"" AS ""t2"") CROSS JOIN ""contests"" AS ""t3"" WHERE ""t2"".""contest_id""=""t1"".""contest_id""+1 AND ""t3"".""contest_id""=""t2"".""contest_id""+1 AND (""t1"".""gold_medal""=""t2"".""gold_medal"" OR ""t1"".""gold_medal""=""t2"".""silver_medal"" OR ""t1"".""gold_medal""=""t2"".""bronze_medal"") AND (""t1"".""gold_medal""=""t3"".""gold_medal"" OR ""t1"".""gold_medal""=""t3"".""silver_medal"" OR ""t1"".""gold_medal""=""t3"".""bronze_medal"") UNION SELECT ""t1"".""silver_medal"" AS ""user_id"" FROM ((""contests"" AS ""t1"") CROSS JOIN ""contests"" AS ""t2"") CROSS JOIN ""contests"" AS ""t3"" WHERE ""t2"".""contest_id""=""t1"".""contest_id""+1 AND ""t3"".""contest_id""=""t2"".""contest_id""+1 AND (""t1"".""silver_medal""=""t2"".""gold_medal"" OR ""t1"".""silver_medal""=""t2"".""silver_medal"" OR ""t1"".""silver_medal""=""t2"".""bronze_medal"") AND (""t1"".""silver_medal""=""t3"".""gold_medal"" OR ""t1"".""silver_medal""=""t3"".""silver_medal"" OR ""t1"".""silver_medal""=""t3"".""bronze_medal"") UNION SELECT ""t1"".""bronze_medal"" AS ""user_id"" FROM ((""contests"" AS ""t1"") CROSS JOIN ""contests"" AS ""t2"") CROSS JOIN ""contests"" AS ""t3"" WHERE ""t2"".""contest_id""=""t1"".""contest_id""+1 AND ""t3"".""contest_id""=""t2"".""contest_id""+1 AND (""t1"".""bronze_medal""=""t2"".""gold_medal"" OR ""t1"".""bronze_medal""=""t2"".""silver_medal"" OR ""t1"".""bronze_medal""=""t2"".""bronze_medal"") AND (""t1"".""bronze_medal""=""t3"".""gold_medal"" OR ""t1"".""bronze_medal""=""t3"".""silver_medal"" OR ""t1"".""bronze_medal""=""t3"".""bronze_medal"") UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>2) AS ""t"" WHERE ""u"".""user_id""=""t"".""user_id"""
545,"WITH ""three_golds"" AS (SELECT ""b"".""name"",""mail"" FROM ""Contests"" AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""gold_medal""=""b"".""user_id"" GROUP BY 1,2 HAVING COUNT(""contest_id"")>=3), ""all_winners"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""three_golds"" UNION SELECT DISTINCT ""b"".""name"",""b"".""mail"" FROM (SELECT ""user_id"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""diff"" FROM ""all_winners"") AS ""a"" JOIN ""Users"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" GROUP BY 1,2,""diff"" HAVING COUNT(""diff"")>=3"
546,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
547,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY ""u"".""mail"",""u"".""name"" HAVING COUNT(""c"".""gold_medal"")>=3 UNION SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ((""Users"" AS ""u"" JOIN ""Contests"" AS ""c1"" ON ""u"".""user_id""=""c1"".""gold_medal"" OR ""u"".""user_id""=""c1"".""silver_medal"" OR ""u"".""user_id""=""c1"".""bronze_medal"") JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""+1 AND (""u"".""user_id""=""c2"".""gold_medal"" OR ""u"".""user_id""=""c2"".""silver_medal"" OR ""u"".""user_id""=""c2"".""bronze_medal"")) JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_Id""=""c2"".""contest_id""+1 AND (""u"".""user_id""=""c3"".""gold_medal"" OR ""u"".""user_id""=""c3"".""silver_medal"" OR ""u"".""user_id""=""c3"".""bronze_medal"")"
548,"WITH ""a"" AS (SELECT ""userid"",""contest_id"" AS ""g"" FROM (SELECT ""gold_medal"" AS ""userid"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""userid"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""userid"",""contest_id"" FROM ""Contests"") AS ""t"" ORDER BY ""userid"",""contest_id"") SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" RIGHT JOIN (SELECT ""gold_medal"" AS ""users"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION SELECT DISTINCT ""a1"".""userid"" AS ""users"" FROM ((""a"" AS ""a1"") CROSS JOIN ""a"" AS ""a2"") CROSS JOIN ""a"" AS ""a3"" WHERE ""a1"".""userid""=""a2"".""userid"" AND ""a2"".""userid""=""a3"".""userid"" AND ""a1"".""g""=""a2"".""g""-1 AND ""a2"".""g""=""a3"".""g""-1 AND ""a1"".""userid"" NOT IN (SELECT ""userid"" FROM ""a"" GROUP BY ""userid"" HAVING COUNT(""userid"")<3)) AS ""s"" ON ""s"".""users""=""u"".""user_id"""
549,"WITH ""cte1"" AS (SELECT ""u"".""user_id"",""u"".""name"",""u"".""mail"",""c"".""contest_id"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"" ORDER BY ""u"".""user_id"",""c"".""contest_id"") SELECT DISTINCT ""a"".""name"" AS ""name"",""a"".""mail"" AS ""mail"" FROM ((""cte1"" AS ""a"") CROSS JOIN ""cte1"" AS ""b"") CROSS JOIN ""cte1"" AS ""c"" WHERE (""a"".""contest_id""=""b"".""contest_id""+1 AND ""a"".""user_id""=""b"".""user_id"") AND (""a"".""contest_id""=""c"".""contest_id""-1 AND ""a"".""user_id""=""c"".""user_id"") UNION SELECT ""u"".""name"" AS ""name"",""u"".""mail"" AS ""mail"" FROM ""Contests"" AS ""c"" JOIN ""Users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" GROUP BY 1,2 HAVING COUNT(1)>=3"
550,"WITH ""medals"" AS (SELECT 'gold' AS ""medal"" UNION ALL SELECT 'silver' AS ""medal"" UNION ALL SELECT 'bronze' AS ""medal""), ""contests_base"" AS (SELECT ""contest_id"",""medal"",CASE WHEN ""medal""='gold' THEN ""gold_medal"" WHEN ""medal""='silver' THEN ""silver_medal"" ELSE ""bronze_medal"" END AS ""winner_id"" FROM ""contests"" CROSS JOIN ""medals"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT ""contest_id"",""medal"",""winner_id"",LEAD(""contest_id"", 1) OVER (PARTITION BY ""winner_id"" ORDER BY ""contest_id"") AS ""next_contest_won"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""winner_id"" ORDER BY ""contest_id"") AS ""3rd_contest_won"" FROM ""contests_base"") AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""winner_id""=""u"".""user_id"" WHERE ""next_contest_won""-""contest_id""=1 AND ""3rd_contest_won""-""next_contest_won""=1 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""winner_id"" FROM ""contests_base"" WHERE ""medal""='gold' GROUP BY ""winner_id"" HAVING COUNT(""contest_id"")>=3) AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""winner_id""=""u"".""user_id"""
551,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (WITH ""contest_and_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT ""c1"".""user_id"" FROM ((""contest_and_medal"" AS ""c1"") CROSS JOIN ""contest_and_medal"" AS ""c2"") CROSS JOIN ""contest_and_medal"" AS ""c3"" WHERE ""c1"".""contest_id""-""c2"".""contest_id""=1 AND ""c2"".""contest_id""-""c3"".""contest_id""=1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id""))"
552,"WITH ""user_medal"" AS (SELECT ""user_id"",""mail"",""name"",""contest_id"",CASE WHEN ""user_id""=""gold_medal"" THEN 'gold' WHEN ""user_id""=""silver_medal"" THEN 'silver' WHEN ""user_id""=""bronze_medal"" THEN 'bronze' END AS ""award"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""u1"".""name"",""u1"".""mail"" FROM ""user_medal"" AS ""u1"" JOIN ""user_medal"" AS ""u2"" ON ""u1"".""contest_id""-""u2"".""contest_id""<=2 AND ""u1"".""contest_id""-""u2"".""contest_id"">=0 AND ""u1"".""user_id""=""u2"".""user_id"" GROUP BY ""u1"".""user_id"",""u1"".""mail"",""u1"".""name"",""u1"".""contest_id"" HAVING COUNT(""u1"".""award"")=3 UNION SELECT ""name"",""mail"" FROM ""user_medal"" GROUP BY ""user_id"" HAVING SUM(CASE WHEN ""award""='gold' THEN 1 END)>=3"
553,"SELECT ""name"",""mail"" FROM ""Contests"" AS ""t1"" JOIN ""Users"" AS ""t2"" ON ""gold_medal""=""user_id"" GROUP BY ""name"",""mail"" HAVING COUNT(1)>2 UNION SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prev_2"" FROM (SELECT ""user_id"",""name"",""mail"",""contest_id"" FROM ""Users"" AS ""t1"" JOIN ""Contests"" AS ""t2"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") AS ""t"") AS ""t"" WHERE ""contest_id""-""prev_2""=2"
554,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (WITH ""contest_and_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT ""c1"".""user_id"" FROM ((""contest_and_medal"" AS ""c1"") CROSS JOIN ""contest_and_medal"" AS ""c2"") CROSS JOIN ""contest_and_medal"" AS ""c3"" WHERE ""c1"".""contest_id""-""c2"".""contest_id""=1 AND ""c2"".""contest_id""-""c3"".""contest_id""=1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id""))"
555,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
556,"WITH ""conts"" AS (SELECT ""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"",""c2"".""gold_medal"" AS ""c2_gold_medal"",""c2"".""silver_medal"" AS ""c2_silver_medal"",""c2"".""bronze_medal"" AS ""c2_bronze_medal"",""c3"".""gold_medal"" AS ""c3_gold_medal"",""c3"".""silver_medal"" AS ""c3_silver_medal"",""c3"".""bronze_medal"" AS ""c3_bronze_medal"",""c3"".""contest_id"" AS ""2_conts_ago"" FROM (""Contests"" AS ""c1"" LEFT JOIN ""Contests"" AS ""c2"" ON ""c2"".""contest_id""=""c1"".""contest_id""-1) LEFT JOIN ""Contests"" AS ""c3"" ON ""c3"".""contest_id""=""c1"".""contest_id""-2), ""cte"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""gold_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""gold_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"") UNION SELECT ""silver_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""silver_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""silver_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"") UNION SELECT ""bronze_medal"" AS ""user_id"" FROM ""conts"" WHERE ""2_conts_ago"" IS NOT NULL AND ""bronze_medal"" IN (""c2_gold_medal"",""c2_silver_medal"",""c2_bronze_medal"") AND ""bronze_medal"" IN (""c3_gold_medal"",""c3_silver_medal"",""c3_bronze_medal"")) SELECT ""u"".""name"",""u"".""mail"" FROM ""cte"" AS ""c"" LEFT JOIN ""Users"" AS ""u"" ON ""c"".""user_id""=""u"".""user_id"""
557,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
558,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (WITH ""contest_and_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT ""c1"".""user_id"" FROM ((""contest_and_medal"" AS ""c1"") CROSS JOIN ""contest_and_medal"" AS ""c2"") CROSS JOIN ""contest_and_medal"" AS ""c3"" WHERE ""c1"".""contest_id""-""c2"".""contest_id""=1 AND ""c2"".""contest_id""-""c3"".""contest_id""=1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id""))"
559,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (WITH ""contest_and_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT ""c1"".""user_id"" FROM ((""contest_and_medal"" AS ""c1"") CROSS JOIN ""contest_and_medal"" AS ""c2"") CROSS JOIN ""contest_and_medal"" AS ""c3"" WHERE ""c1"".""contest_id""-""c2"".""contest_id""=1 AND ""c2"".""contest_id""-""c3"".""contest_id""=1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id""))"
560,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3), ""cte2"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""silver_medal"" AS ""user_id"",""contest_id"" FROM ""Contests"" UNION SELECT ""bronze_medal"" AS ""user_id"",""contest_id"" FROM ""Contests""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""cnt"" FROM ""cte2"") AS ""F"" WHERE ""F"".""cnt""-""F"".""contest_id""=2 UNION SELECT ""user_id"" FROM ""cte1"") SELECT ""u"".""name"",""u"".""mail"" FROM ""cte3"" JOIN ""Users"" AS ""u"" USING (""user_id"") ORDER BY ""user_id"""
561,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",""user_id""=""silver_medal"" AS ""silver"",""user_id""=""bronze_medal"" AS ""bronze"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
562,"SELECT DISTINCT ""name"",""mail"" FROM ((""Users"" AS ""u"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u"".""user_id""=""c1"".""gold_medal"") LEFT JOIN ""Contests"" AS ""c2"" ON ""u"".""user_id""=""c2"".""gold_medal"") LEFT JOIN ""Contests"" AS ""c3"" ON ""u"".""user_id""=""c3"".""gold_medal"" WHERE ""c1"".""contest_id""!=""c2"".""contest_id"" AND ""c2"".""contest_id""!=""c3"".""contest_id"" AND ""c1"".""contest_id""!=""c3"".""contest_id"" UNION SELECT DISTINCT ""name"",""mail"" FROM ((""Users"" AS ""u"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u"".""user_id""=""c1"".""gold_medal"" OR ""u"".""user_id""=""c1"".""silver_medal"" OR ""u"".""user_id""=""c1"".""bronze_medal"") LEFT JOIN ""Contests"" AS ""c2"" ON ""u"".""user_id""=""c2"".""gold_medal"" OR ""u"".""user_id""=""c2"".""silver_medal"" OR ""u"".""user_id""=""c2"".""bronze_medal"") LEFT JOIN ""Contests"" AS ""c3"" ON ""u"".""user_id""=""c3"".""gold_medal"" OR ""u"".""user_id""=""c3"".""silver_medal"" OR ""u"".""user_id""=""c3"".""bronze_medal"" WHERE ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
563,"WITH ""cte"" AS (SELECT ""user_id"",""mail"",""name"",""contests"".""contest_id"" FROM ""users"" CROSS JOIN ""contests"" WHERE ""user_id"" IN (""gold_medal"",""silver_medal"",""bronze_medal"")), ""cte2"" AS (SELECT DISTINCT ""user_id"",""mail"",""name"",""contests"".""contest_id"" FROM ""users"" CROSS JOIN ""contests"" WHERE ""user_id"" IN (""gold_medal"") GROUP BY ""user_id"" HAVING COUNT(1)>=3) (SELECT DISTINCT ""a"".""name"",""a"".""mail"" FROM (""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""contest_id""=""b"".""contest_id""+1) JOIN ""cte"" AS ""c"" ON ""a"".""contest_id""=""c"".""contest_id""-1 AND ""a"".""user_id""=""c"".""user_id"") UNION (SELECT DISTINCT ""name"",""mail"" FROM ""cte2"")"
564,"WITH ""medals"" AS (SELECT ""gold_medal"" AS ""user_id"",'gold' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user_id"",'silver' AS ""medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"",""contest_id"" FROM ""contests""), ""lag_and_count"" AS (SELECT ""user_id"",""medal"",""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"",COUNT(1) OVER (PARTITION BY ""user_id"", ""medal"") AS ""cnt"" FROM ""medals"") SELECT DISTINCT ""t2"".""name"",""t2"".""mail"" FROM ""lag_and_count"" AS ""t1"" LEFT JOIN ""users"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""user_id"" WHERE ""t1"".""medal""='gold' AND ""cnt"">=3 OR ""t1"".""contest_id""-""prevprev""=2"
565,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
566,"WITH ""c1"" AS (SELECT ""contest_id"",""gold_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""id"" FROM ""contests""), ""c2"" AS (SELECT ""contest_id"",""id"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""c1""), ""c3"" AS (SELECT ""id"" FROM ""c2"" GROUP BY ""id"",""contest_id""-""rnk"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""users"" JOIN ""c3"" ON ""c3"".""id""=""users"".""user_id"""
567,"SELECT ""name"",""mail"" FROM (""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c"" GROUP BY ""user_id"" HAVING SUM(""u"".""user_id""=""c"".""gold_medal"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
568,"WITH ""ContestLong"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""Contests""), ""WindowFunction"" AS (SELECT ""contest_id"",""medal"" AS ""user_id"",RANK() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""rank_medal"" FROM ""ContestLong""), ""CrossJoin"" AS (SELECT ""w1"".""user_id"",""w1"".""contest_id"" AS ""id1"",""w2"".""contest_id"" AS ""id2"" FROM (""WindowFunction"" AS ""w1"") CROSS JOIN ""WindowFunction"" AS ""w2"" WHERE ""w1"".""user_id""=""w2"".""user_id"" AND ""w1"".""rank_medal""=""w2"".""rank_medal""+3-1 AND ""w1"".""contest_id""=""w2"".""contest_id""+3-1) SELECT ""name"",""mail"" FROM (SELECT DISTINCT ""user_id"" FROM ""CrossJoin"" UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3) AS ""t0"" LEFT JOIN ""Users"" USING (""user_id"")"
569,"SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3 UNION SELECT DISTINCT ""user_id"" FROM (SELECT ""u"".""user_id"",""c"".""contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""third_win"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"" ORDER BY ""u"".""user_id"",""c"".""contest_id"") AS ""temp"" WHERE ""third_win""-""contest_id""=2) AS ""t1"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t1"".""user_id"""
570,"WITH ""cte1"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""cte2"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""cte1""), ""cte3"" AS (SELECT ""user"" AS ""user_id"" FROM ""cte2"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""cte3"" JOIN ""users"" AS ""u"" ON ""cte3"".""user_id""=""u"".""user_id"""
571,"WITH ""cte"" AS (SELECT DISTINCT ""gold_medal"" AS ""winner"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3), ""cte2"" AS (SELECT *,LEAD(""gold_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""next_gold"",LEAD(""silver_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""next_silver"",LEAD(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"") AS ""next_bronze"",LEAD(""gold_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""next2_gold"",LEAD(""silver_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""next2_silver"",LEAD(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"") AS ""next2_bronze"" FROM ""Contests""), ""cte3"" AS (SELECT DISTINCT ""user_id"" FROM ""cte2"" JOIN ""users"" ON (""user_id"" IN (""next_gold"",""next_silver"",""next_bronze"")) AND (""user_id"" IN (""next2_gold"",""next2_silver"",""next2_bronze"")) AND (""user_id"" IN (""gold_medal"",""silver_medal"",""bronze_medal""))) SELECT ""name"",""mail"" FROM (SELECT ""winner"" FROM ""cte"" UNION SELECT ""user_id"" FROM ""cte3"") AS ""sub"" CROSS, ""Users"" WHERE ""winner""=""user_id"""
572,"WITH ""cte"" AS (SELECT ""c"".""contest_id"",""u"".""name"",""u"".""mail"",CASE WHEN ""gold_medal""=""user_id"" THEN 1 ELSE 0 END AS ""gold"",CASE WHEN ""silver_medal""=""user_id"" THEN 1 ELSE 0 END AS ""silver"",CASE WHEN ""bronze_medal""=""user_id"" THEN 1 ELSE 0 END AS ""bronze"",""c"".""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""c"".""contest_id"") AS ""indgrp"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""gold"") OVER (PARTITION BY ""name"", ""mail"") AS ""goldsum"",SUM(""gold""+""silver""+""bronze"") OVER (PARTITION BY ""name"", ""mail"", ""indgrp"") AS ""medalsum"" FROM ""cte"") AS ""a"" WHERE ""goldsum"">=3 OR ""medalsum"">=3"
573,"WITH ""t"" AS (SELECT ""contest_id"",""name"",""mail"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""rnk"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") SELECT DISTINCT ""name"",""mail"" FROM ""t"" GROUP BY ""mail"",(""contest_id""-""rnk"") HAVING COUNT(""contest_id""-""rnk"")>=3 UNION SELECT ""name"",""mail"" FROM ""Users"" JOIN ""Contests"" ON ""gold_medal""=""user_id"" GROUP BY ""user_id"" HAVING COUNT(""user_id"")>=3"
574,"SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""users"".*,CASE WHEN LEAD(""contest_id"", 1) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+1 AND LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"")=""contest_id""+2 THEN 1 ELSE 0 END AS ""sign"",SUM(""gold_medal""=""user_id"") OVER (PARTITION BY ""user_id"") AS ""gold"" FROM ""users"" LEFT JOIN ""contests"" ON ""gold_medal""=""user_id"" OR ""silver_medal""=""user_id"" OR ""bronze_medal""=""user_id"") AS ""cte"" WHERE ""gold"">=3 OR ""sign""=1"
575,"WITH ""T"" AS (SELECT ""U"".""user_id"",""C"".""contest_id"" FROM ""Users"" AS ""U"" CROSS JOIN ""Contests"" AS ""C"" WHERE ""U"".""user_id""=""C"".""gold_medal"" OR ""U"".""user_id""=""C"".""silver_medal"" OR ""U"".""user_id""=""C"".""bronze_medal"" ORDER BY ""U"".""user_id"",""contest_id"") SELECT DISTINCT ""name"",""mail"" FROM ((""T"" AS ""T1"" JOIN ""T"" AS ""T2"" ON ""T1"".""user_id""=""T2"".""user_id"" AND ""T1"".""contest_id""+1=""T2"".""contest_id"") JOIN ""T"" AS ""T3"" ON ""T1"".""user_id""=""T3"".""user_id"" AND ""T1"".""contest_id""+2=""T3"".""contest_id"") JOIN ""Users"" AS ""U"" ON ""T1"".""user_id""=""U"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""Users"" AS ""U"" JOIN ""Contests"" AS ""C"" ON ""C"".""gold_medal""=""U"".""user_id"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>=3"
576,"WITH ""cte"" AS (SELECT ""gold_medal"" AS ""user_id"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"",""contest_id"" FROM ""contests"") SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"" AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1 UNION SELECT DISTINCT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3)"
577,"SELECT ""name"",""mail"" FROM (""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c"" GROUP BY ""user_id"" HAVING SUM(""u"".""user_id""=""c"".""gold_medal"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
578,"WITH ""new_c"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""case1"" AS (SELECT DISTINCT ""c1"".""medal"" AS ""id"" FROM (""new_c"" AS ""c1"" LEFT JOIN ""new_c"" AS ""c2"" ON ""c1"".""contest_id""+1=""c2"".""contest_id"") LEFT JOIN ""new_c"" AS ""c3"" ON ""c1"".""contest_id""+2=""c3"".""contest_id"" WHERE ""c1"".""medal""=""c2"".""medal"" AND ""c2"".""medal""=""c3"".""medal""), ""case2"" AS (SELECT ""gold_medal"" AS ""id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(""contest_id"")>=3) SELECT ""u"".""name"",""u"".""mail"" FROM (SELECT ""id"" FROM ""case1"" UNION SELECT ""id"" FROM ""case2"") AS ""t"" JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""id"""
579,"WITH ""contesttable"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""c"".""gold_medal""=""u"".""user_id"" THEN 1 ELSE 0 END AS ""gold"",CASE WHEN ""c"".""silver_medal""=""u"".""user_id"" THEN 1 ELSE 0 END AS ""silver"",CASE WHEN ""c"".""bronze_medal""=""u"".""user_id"" THEN 1 ELSE 0 END AS ""bronze"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""u"".""name"", ""u"".""mail"" ORDER BY ""c"".""contest_id"") AS ""grp"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"" ORDER BY ""u"".""name"",""u"".""mail"",""c"".""contest_id"") SELECT DISTINCT ""name"",""mail"" FROM (SELECT ""name"",""mail"",SUM(""gold"") OVER (PARTITION BY ""name"", ""mail"") AS ""goldsum"",SUM(""gold""+""silver""+""bronze"") OVER (PARTITION BY ""name"", ""mail"", ""grp"") AS ""medalsum"" FROM ""contesttable"") AS ""a"" WHERE ""goldsum"">=3 OR ""medalsum"">=3"
580,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
581,"SELECT DISTINCT ""a"".""name"",""a"".""mail"" FROM (((""users"" AS ""a"") CROSS JOIN ""contests"" AS ""b"") CROSS JOIN ""contests"" AS ""c"") CROSS JOIN ""contests"" AS ""d"" WHERE (""a"".""user_id""=""b"".""gold_medal"" OR ""a"".""user_id""=""b"".""silver_medal"" OR ""a"".""user_id""=""b"".""bronze_medal"") AND (""a"".""user_id""=""c"".""gold_medal"" OR ""a"".""user_id""=""c"".""silver_medal"" OR ""a"".""user_id""=""c"".""bronze_medal"") AND (""a"".""user_id""=""d"".""gold_medal"" OR ""a"".""user_id""=""d"".""silver_medal"" OR ""a"".""user_id""=""d"".""bronze_medal"") AND ""b"".""contest_id""!=""c"".""contest_id"" AND ""c"".""contest_id""!=""d"".""contest_id"" AND ""b"".""contest_id""!=""d"".""contest_id"" AND ((""b"".""contest_id""=""c"".""contest_id""-1 AND ""c"".""contest_id""=""d"".""contest_id""-1) OR (""a"".""user_id""=""b"".""gold_medal"" AND ""b"".""gold_medal""=""c"".""gold_medal"" AND ""c"".""gold_medal""=""d"".""gold_medal""))"
582,"SELECT ""name"",""mail"" FROM (""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c"" GROUP BY ""user_id"" HAVING SUM(""u"".""user_id""=""c"".""gold_medal"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
583,"WITH ""cte"" AS (SELECT ""contest_id"",'gold_medal' AS ""medal"",""gold_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'silver_medal' AS ""medal"",""silver_medal"" AS ""id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze_medal' AS ""medal"",""bronze_medal"" AS ""id"" FROM ""Contests""), ""cte1"" AS (SELECT DISTINCT ""id"" FROM (SELECT *,COUNT(""medal"") OVER (PARTITION BY ""id"", ""medal"") AS ""cnt"" FROM ""cte"") AS ""m"" WHERE ""medal""='gold_medal' AND ""cnt"">=3) SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN (SELECT DISTINCT ""id"" FROM (SELECT *,LEAD(""contest_id"", 1) OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""l1"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""id"" ORDER BY ""contest_id"") AS ""l2"" FROM ""cte"") AS ""t"" WHERE ""l1""=""contest_id""+1 AND ""l2""=""l1""+1 UNION SELECT * FROM ""cte1"") AS ""t1"" ON ""t1"".""id""=""u"".""user_id"""
584,"SELECT ""u"".""name"",""u"".""mail"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(1)>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
585,"WITH ""medal_format"" AS (SELECT ""gold_medal"" AS ""medal"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""silver_medal"" AS ""medal"",""contest_id"" FROM ""Contests"" UNION ALL SELECT ""bronze_medal"" AS ""medal"",""contest_id"" FROM ""Contests"" ORDER BY ""medal"",""contest_id"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""medal"" FROM (SELECT ""medal"",""contest_id"",""contest_id_lag"",CASE WHEN ""contest_id_lag"" IS NULL THEN @""counter"":=0 WHEN ""contest_id""-""contest_id_lag""=1 THEN @""counter"":=@""counter""+1 ELSE @""counter"":=0 END AS ""consecutive_flag"" FROM (SELECT ""medal"",""contest_id"",LAG(""contest_id"") OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""contest_id_lag"" FROM ""medal_format"") AS ""lag_data"") AS ""consecutive_data"" WHERE ""consecutive_flag""=2 UNION SELECT ""gold_medal"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>2)"
586,"WITH ""gold_medals"" AS (SELECT ""gold_medal"",COUNT(1) AS ""num_golds"" FROM ""Contests"" GROUP BY 1), ""bronze_silver"" AS (SELECT *,CASE WHEN (LEAD(""silver_medal"", 1) OVER (ORDER BY ""contest_id"")=""gold_medal"" OR LEAD(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"")=""gold_medal"" OR LEAD(""gold_medal"", 1) OVER (ORDER BY ""contest_id"")=""gold_medal"") AND (LEAD(""silver_medal"", 2) OVER (ORDER BY ""contest_id"")=""gold_medal"" OR LEAD(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"")=""gold_medal"" OR LEAD(""gold_medal"", 2) OVER (ORDER BY ""contest_id"")=""gold_medal"") THEN ""gold_medal"" ELSE NULL END AS ""gold_condition"",CASE WHEN (LEAD(""gold_medal"", 1) OVER (ORDER BY ""contest_id"")=""silver_medal"" OR LEAD(""silver_medal"", 1) OVER (ORDER BY ""contest_id"")=""silver_medal"" OR LEAD(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"")=""silver_medal"") AND (LEAD(""gold_medal"", 2) OVER (ORDER BY ""contest_id"")=""silver_medal"" OR LEAD(""silver_medal"", 2) OVER (ORDER BY ""contest_id"")=""silver_medal"" OR LEAD(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"")=""silver_medal"") THEN ""silver_medal"" ELSE NULL END AS ""silver_condition"",CASE WHEN (LEAD(""gold_medal"", 1) OVER (ORDER BY ""contest_id"")=""bronze_medal"" OR LEAD(""silver_medal"", 1) OVER (ORDER BY ""contest_id"")=""bronze_medal"" OR LEAD(""bronze_medal"", 1) OVER (ORDER BY ""contest_id"")=""bronze_medal"") AND (LEAD(""gold_medal"", 2) OVER (ORDER BY ""contest_id"")=""bronze_medal"" OR LEAD(""silver_medal"", 2) OVER (ORDER BY ""contest_id"")=""bronze_medal"" OR LEAD(""bronze_medal"", 2) OVER (ORDER BY ""contest_id"")=""bronze_medal"") THEN ""bronze_medal"" ELSE NULL END AS ""bronze_condition"" FROM ""Contests"") SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""medal"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""medal"",""gold_condition"" AS ""medal_condition"" FROM ""bronze_silver"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"",""silver_condition"" AS ""medal_condition"" FROM ""bronze_silver"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"",""bronze_condition"" AS ""medal_condition"" FROM ""bronze_silver"") AS ""a"" WHERE ""medal_condition"" IS NOT NULL UNION ALL (SELECT DISTINCT ""gold_medal"" AS ""medal"" FROM ""gold_medals"" WHERE ""num_golds"">=3)) AS ""c"" JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""c"".""medal"""
587,"SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM (SELECT ""contest_id"",""user_id"",COUNT(CASE WHEN ""medal""='gold' THEN ""contest_id"" END) OVER (PARTITION BY ""user_id"") AS ""goldcount"",LEAD(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""ldcontest"",LAG(""contest_id"") OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lgcontest"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""contests"") AS ""t"") AS ""t"" WHERE ""goldcount"">=3 OR (""ldcontest""=""contest_id""+1 AND ""lgcontest""=""contest_id""-1))"
588,"WITH ""cte"" AS (SELECT ""user_id"",""name"",""mail"",""contest_id"",""user_id""=""gold_medal"" AS ""gold"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""prevprev"" FROM ""Users"" LEFT JOIN ""Contests"" ON ""user_id""=""gold_medal"" OR ""user_id""=""silver_medal"" OR ""user_id""=""bronze_medal"") SELECT ""name"",""mail"" FROM ""cte"" GROUP BY ""user_id"" HAVING SUM(""gold"")>=3 OR SUM(""contest_id""-""prevprev""=2)>=1"
589,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
590,"WITH ""cte_contest"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""metal_type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""metal_type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""metal_type"" FROM ""Contests"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte_contest"" WHERE ""metal_type""='gold' GROUP BY ""user_id"" HAVING COUNT(1)>=3 UNION SELECT DISTINCT ""user_id"" FROM (SELECT ""user_id"",""contest_id"" AS ""current_contest_id"",LEAD(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lead_contest_id"" FROM ""cte_contest"") AS ""l"" WHERE ""lead_contest_id""-""current_contest_id""=2)"
591,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (WITH ""contest_and_medal"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT ""c1"".""user_id"" FROM ((""contest_and_medal"" AS ""c1"") CROSS JOIN ""contest_and_medal"" AS ""c2"") CROSS JOIN ""contest_and_medal"" AS ""c3"" WHERE ""c1"".""contest_id""-""c2"".""contest_id""=1 AND ""c2"".""contest_id""-""c3"".""contest_id""=1 AND ""c1"".""user_id""=""c2"".""user_id"" AND ""c1"".""user_id""=""c3"".""user_id""))"
592,"WITH ""cte2"" AS (SELECT ""c"".""contest_id"",""u"".""user_id"",""u"".""name"",""u"".""mail"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") SELECT ""name"",""mail"" FROM ""users"" JOIN (SELECT ""c1"".""user_id"" FROM (""cte2"" AS ""c1"" JOIN ""cte2"" AS ""c2"" ON ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""user_id""=""c2"".""user_id"") JOIN ""cte2"" AS ""c3"" ON ""c1"".""contest_id""=""c3"".""contest_id""-2 AND ""c1"".""user_id""=""c3"".""user_id"") AS ""t1"" ON ""users"".""user_id""=""t1"".""user_id"" UNION SELECT ""name"",""mail"" FROM ""users"" JOIN (SELECT ""user_id"" FROM ""contests"" AS ""c"" JOIN ""users"" AS ""u"" ON ""gold_medal""=""user_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""gold_medal""=""user_id"" THEN 1 ELSE NULL END)>=3) AS ""temp"" ON ""users"".""user_id""=""temp"".""user_id"""
593,"WITH ""gold"" AS (SELECT ""gold_medal"",COUNT(DISTINCT ""contest_id"") AS ""gold_user"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(DISTINCT ""contest_id"")>2), ""a"" AS (SELECT ""contest_id"",""gold_medal"" AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""medal"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""medal"" FROM ""contests""), ""b"" AS (SELECT ""contest_id"",""medal"",DENSE_RANK() OVER (ORDER BY ""contest_id"")-DENSE_RANK() OVER (PARTITION BY ""medal"" ORDER BY ""contest_id"") AS ""rk"" FROM ""a""), ""c"" AS (SELECT ""rk"",""medal"" FROM ""b"" GROUP BY ""rk"",""medal"" HAVING COUNT(1)>2) SELECT DISTINCT ""u"".""name"",""u"".""mail"" FROM (SELECT DISTINCT ""medal"" FROM ""c"" UNION SELECT DISTINCT ""gold_medal"" AS ""medal"" FROM ""gold"") AS ""t"" LEFT JOIN ""users"" AS ""u"" ON ""t"".""medal""=""u"".""user_id"""
594,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (WITH ""new_table"" AS (SELECT ""contest_id"",'gold_medal' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'selver_medal' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",'bronze_medal' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""Contests"" ORDER BY ""contest_id"",CASE WHEN ""medal""='gold_medal' THEN 1 WHEN ""medal""='silver_medal' THEN 2 ELSE 3 END) SELECT DISTINCT ""N1"".""user_id"" FROM (""new_table"" AS ""N1"" JOIN ""new_table"" AS ""N2"" ON ""N1"".""user_id""=""N2"".""user_id"") JOIN ""new_table"" AS ""N3"" ON ""N3"".""user_id""=""N1"".""user_id"" WHERE ""N2"".""contest_id""=""N1"".""contest_id""+1 AND ""N3"".""contest_id""=""N2"".""contest_id""+1 UNION SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3)"
595,"WITH ""identified"" AS (SELECT ""u1"".""name"",""u1"".""mail"",""c1"".""contest_id"",CASE WHEN ""u1"".""user_id""=""c1"".""gold_medal"" THEN 1 ELSE 0 END AS ""medal"",CASE WHEN (""c1"".""contest_id""+1=LEAD(""c1"".""contest_id"", 1) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) AND (""c1"".""contest_id""+2=LEAD(""c1"".""contest_id"", 2) OVER (PARTITION BY ""u1"".""name"", ""u1"".""mail"" ORDER BY ""c1"".""contest_id"")) THEN 1 ELSE 0 END AS ""threeTime"" FROM ""Users"" AS ""u1"" LEFT JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" OR ""u1"".""user_id""=""c1"".""silver_medal"" OR ""u1"".""user_id""=""c1"".""bronze_medal"" WHERE ""c1"".""contest_id"" IS NOT NULL ORDER BY 1,2) SELECT ""name"",""mail"" FROM ""identified"" GROUP BY 1,2 HAVING SUM(""medal"")>=3 OR SUM(""threeTime"")>=1"
596,"SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",""contest_id""-DENSE_RANK() OVER (PARTITION BY ""u"".""user_id"" ORDER BY ""contest_id"") AS ""Con_diff"" FROM ""Users"" AS ""u"" JOIN ""Contests"" AS ""c"" ON ""u"".""user_id""=""c"".""gold_medal"" OR ""u"".""user_id""=""c"".""silver_medal"" OR ""u"".""user_id""=""c"".""bronze_medal"") AS ""tmp"" GROUP BY ""name"",""mail"",""Con_diff"" HAVING COUNT(""Con_diff"")>=3 UNION SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"" FROM ""Users"" AS ""u1"" JOIN ""Contests"" AS ""c1"" ON ""u1"".""user_id""=""c1"".""gold_medal"" GROUP BY ""name"",""mail"",""gold_medal"" HAVING COUNT(""gold_medal"")>=3) AS ""tmpg"""
597,"SELECT ""name"",""mail"" FROM (""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c"" GROUP BY ""user_id"" HAVING SUM(""u"".""user_id""=""c"".""gold_medal"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c2"".""contest_id""=""c3"".""contest_id""-1"
598,"WITH ""cte"" AS (SELECT ""contest_id"",'gold' AS ""medal"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'silver' AS ""medal"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",'bronze' AS ""medal"",""bronze_medal"" AS ""user_id"" FROM ""contests""), ""condition1"" AS (SELECT DISTINCT ""a"".""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""), ""condition2"" AS (SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""condition1"" UNION SELECT ""user_id"" FROM ""condition2"")"
599,"WITH ""cte"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""type"" FROM ""Contests"" UNION SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'broze' AS ""type"" FROM ""Contests"" GROUP BY ""contest_id"" ORDER BY ""contest_id"") SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (SELECT DISTINCT ""a"".""user_id"" AS ""user_id"" FROM ((""cte"" AS ""a"") CROSS JOIN ""cte"" AS ""b"") CROSS JOIN ""cte"" AS ""c"" WHERE ""a"".""contest_id""=""b"".""contest_id""-1 AND ""a"".""contest_id""=""c"".""contest_id""-2 AND ""a"".""user_id""=""b"".""user_id"" AND ""a"".""user_id""=""c"".""user_id""))"
600,"SELECT ""u"".""name"",""u"".""mail"" FROM (""Contests"" AS ""c"") CROSS JOIN ""Users"" AS ""u"" WHERE ""u"".""user_id""=""c"".""gold_medal"" GROUP BY ""u"".""user_id"" HAVING COUNT(""contest_id"")>=3 UNION SELECT ""u"".""name"",""u"".""mail"" FROM (((""Users"" AS ""u"") CROSS JOIN ""Contests"" AS ""c1"") CROSS JOIN ""Contests"" AS ""c2"") CROSS JOIN ""Contests"" AS ""c3"" WHERE ""u"".""user_id"" IN (""c1"".""gold_medal"",""c1"".""silver_medal"",""c1"".""bronze_medal"") AND ""u"".""user_id"" IN (""c2"".""gold_medal"",""c2"".""silver_medal"",""c2"".""bronze_medal"") AND ""u"".""user_id"" IN (""c3"".""gold_medal"",""c3"".""silver_medal"",""c3"".""bronze_medal"") AND ""c1"".""contest_id""-1=""c2"".""contest_id"" AND ""c2"".""contest_id""-1=""c3"".""contest_id"""
601,"WITH ""t0"" AS (SELECT ""gold_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""silver_medal"" AS ""user"",""contest_id"" FROM ""contests"" UNION ALL SELECT ""bronze_medal"" AS ""user"",""contest_id"" FROM ""contests""), ""t1"" AS (SELECT ""user"",""contest_id"",ROW_NUMBER() OVER (PARTITION BY ""user"" ORDER BY ""contest_id"") AS ""rn"" FROM ""t0""), ""t2"" AS (SELECT ""user"" AS ""user_id"" FROM ""t1"" GROUP BY ""user"",""contest_id""-""rn"" HAVING COUNT(1)>=3 UNION ALL SELECT ""gold_medal"" AS ""user_id"" FROM ""contests"" GROUP BY ""gold_medal"" HAVING COUNT(1)>=3) SELECT DISTINCT ""name"",""mail"" FROM ""t2"" JOIN ""users"" AS ""u"" ON ""t2"".""user_id""=""u"".""user_id"""
602,"WITH ""contesttable"" AS (SELECT ""u"".""name"",""u"".""mail"",""c"".""contest_id"",CASE WHEN ""c"".""gold_medal""=""u"".""user_id"" THEN 1 ELSE 0 END AS ""gold"",CASE WHEN (""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"") THEN 1 ELSE 0 END AS ""medal"" FROM ""users"" AS ""u"" JOIN ""contests"" AS ""c"" ON ""c"".""gold_medal""=""u"".""user_id"" OR ""c"".""silver_medal""=""u"".""user_id"" OR ""c"".""bronze_medal""=""u"".""user_id"" ORDER BY ""u"".""name"",""u"".""mail"",""c"".""contest_id"") SELECT ""name"",""mail"" FROM ""contesttable"" GROUP BY ""name"",""mail"" HAVING SUM(""gold"")>=3 UNION SELECT ""name"",""mail"" FROM (SELECT ""name"",""mail"",""contest_id""-ROW_NUMBER() OVER (PARTITION BY ""name"", ""mail"" ORDER BY ""contest_id"") AS ""grp"" FROM ""contesttable"") AS ""a"" GROUP BY ""name"",""mail"",""grp"" HAVING COUNT(1)>=3"
603,"SELECT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""gold_medal"" AS ""user_id"" FROM ""Contests"" GROUP BY ""gold_medal"" HAVING COUNT(""gold_medal"")>=3 UNION ALL (WITH ""conseq_wins"" AS (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""Contests"") SELECT DISTINCT (""a"".""user_id"") FROM (""conseq_wins"" AS ""a"" JOIN ""conseq_wins"" AS ""b"" ON ""b"".""contest_id""=""a"".""contest_id""+1) JOIN ""conseq_wins"" AS ""c"" ON ""c"".""contest_id""=""b"".""contest_id""+1 WHERE ""a"".""user_id""=""b"".""user_id"" AND ""b"".""user_id""=""c"".""user_id""))"
604,"WITH ""cte"" AS (SELECT ""user_id"",""contest_id"",""medal"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"",'gold' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"",'silver' AS ""medal"" FROM ""Contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"",'bronze' AS ""medal"" FROM ""Contests"") AS ""m"" ORDER BY 1,2) SELECT DISTINCT ""name"",""mail"" FROM ""Users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"" GROUP BY 1 HAVING SUM(CASE WHEN ""medal""='gold' THEN 1 ELSE 0 END)>=3) OR ""user_id"" IN (SELECT DISTINCT ""c1"".""user_id"" FROM ((""cte"" AS ""c1"") CROSS JOIN ""cte"" AS ""c2"") CROSS JOIN ""cte"" AS ""c3"" WHERE ""c1"".""user_id""=""c2"".""user_id"" AND ""c2"".""user_id""=""c3"".""user_id"" AND ((""c1"".""contest_id""=""c2"".""contest_id""-1 AND ""c1"".""contest_id""=""c3"".""contest_id""-2) OR (""c1"".""contest_id""=""c2"".""contest_id""+1 AND ""c1"".""contest_id""=""c3"".""contest_id""-1) OR (""c1"".""contest_id""=""c2"".""contest_id""+2 AND ""c1"".""contest_id""=""c3"".""contest_id""+1)))"
605,"WITH ""C"" AS (SELECT CASE WHEN (""GOLD_MEDAL""=LAG(""GOLD_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""GOLD_MEDAL""=LAG(""SILVER_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""GOLD_MEDAL""=LAG(""BRONZE_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"")) AND (""GOLD_MEDAL""=LEAD(""GOLD_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""GOLD_MEDAL""=LEAD(""SILVER_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""GOLD_MEDAL""=LEAD(""BRONZE_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"")) THEN ""GOLD_MEDAL"" ELSE NULL END AS ""USER_ID1"",CASE WHEN (""SILVER_MEDAL""=LAG(""GOLD_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""SILVER_MEDAL""=LAG(""SILVER_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""SILVER_MEDAL""=LAG(""BRONZE_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"")) AND (""SILVER_MEDAL""=LEAD(""GOLD_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""SILVER_MEDAL""=LEAD(""SILVER_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""SILVER_MEDAL""=LEAD(""BRONZE_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"")) THEN ""SILVER_MEDAL"" ELSE NULL END AS ""USER_ID2"",CASE WHEN (""BRONZE_MEDAL""=LAG(""GOLD_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""BRONZE_MEDAL""=LAG(""SILVER_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""BRONZE_MEDAL""=LAG(""BRONZE_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"")) AND (""BRONZE_MEDAL""=LEAD(""GOLD_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""BRONZE_MEDAL""=LEAD(""SILVER_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"") OR ""BRONZE_MEDAL""=LEAD(""BRONZE_MEDAL"", 1) OVER (ORDER BY ""CONTEST_ID"")) THEN ""BRONZE_MEDAL"" ELSE NULL END AS ""USER_ID3"" FROM ""CONTESTS""), ""UNI"" AS (SELECT ""USER_ID1"" AS ""USER_ID"" FROM ""C"" WHERE ""USER_ID1"" IS NOT NULL UNION ALL SELECT ""USER_ID2"" AS ""USER_ID"" FROM ""C"" WHERE ""USER_ID2"" IS NOT NULL UNION ALL SELECT ""USER_ID3"" AS ""USER_ID"" FROM ""C"" WHERE ""USER_ID3"" IS NOT NULL), ""CAN"" AS (SELECT DISTINCT (""USER_ID"") AS ""USER_ID"" FROM ""UNI"" UNION SELECT DISTINCT (""gold_medal"") AS ""USER_ID"" FROM ""Contests"" GROUP BY ""GOLD_MEDAL"" HAVING COUNT(1)>=3) SELECT ""U"".""NAME"",""U"".""MAIL"" FROM ""CAN"" AS ""C"" JOIN ""USERS"" AS ""U"" ON ""C"".""USER_ID""=""U"".""USER_ID"""
606,"WITH ""cte"" AS (SELECT DISTINCT ""user_id"" FROM (SELECT ""contest_id"",LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""lag_id"",""contest_id""-LAG(""contest_id"", 2) OVER (PARTITION BY ""user_id"" ORDER BY ""contest_id"") AS ""id_diff"",""user_id"" FROM (SELECT ""contest_id"",""gold_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""silver_medal"" AS ""user_id"" FROM ""contests"" UNION ALL SELECT ""contest_id"",""bronze_medal"" AS ""user_id"" FROM ""contests"") AS ""a"") AS ""b"" WHERE ""id_diff""=2), ""cte2"" AS (SELECT ""gold_medal"" FROM ""contests"" GROUP BY 1 HAVING COUNT(""gold_medal"")>=3) SELECT DISTINCT ""name"",""mail"" FROM ""users"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") OR ""user_id"" IN (SELECT ""gold_medal"" FROM ""cte2"")"
