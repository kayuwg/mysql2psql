id,original query
1,"WITH ""ExamHighLow"" AS (SELECT ""exam_id"",MAX(""score"") AS ""high"",MIN(""score"") AS ""low"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT ""t"".""student_id"" AS ""QuietStudents"" FROM (SELECT ""e1"".""student_id"",NOT (""e1"".""score""<""e2"".""high"" AND ""e1"".""score"">""e2"".""low"") AS ""middle"" FROM ""Exam"" AS ""e1"" JOIN ""ExamHighLow"" AS ""e2"" ON ""e1"".""exam_id""=""e2"".""exam_id"") AS ""t"" GROUP BY ""t"".""student_id"" HAVING SUM(""middle"")=0) AS ""q"" JOIN ""Student"" AS ""s"" ON ""q"".""QuietStudents""=""s"".""student_id"" ORDER BY ""s"".""student_id"""
2,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
3,"SELECT DISTINCT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""highest"",MIN(""score"") AS ""lowest"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t"" ON ""e"".""exam_id""=""t"".""exam_id"" WHERE ""e"".""score""=""t"".""highest"" OR ""e"".""score""=""t"".""lowest"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""Exam"")"
4,"WITH ""CTE"" AS (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""RK1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""RK2"" FROM ""Exam"") SELECT DISTINCT ""Student"".""student_id"",""student_name"" FROM ""CTE"" JOIN ""Student"" ON ""CTE"".""student_id""=""Student"".""student_id"" WHERE ""Student"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""CTE"" WHERE ""RK1""=1 OR ""RK2""=1) ORDER BY 1"
5,"WITH ""ct"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY ""exam_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" LEFT JOIN ""ct"" ON ""exam"".""exam_id""=""ct"".""exam_id"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""exam"" GROUP BY ""student_id"" HAVING COUNT(""exam_id"")>=1)"
6,"WITH RECURSIVE ""my_cte"" AS (SELECT ""exam_id"",""student"".""student_id"",""student_name"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"" FROM ""exam"" RIGHT JOIN ""student"" ON ""student"".""student_id""=""exam"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""my_cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""my_cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1) ORDER BY ""student_id"""
7,"WITH ""cte"" AS (SELECT ""e"".""student_id"" AS ""student_id"",""s"".""student_name"" AS ""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""top"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""bottom"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""top""=1 OR ""bottom""=1) ORDER BY 1"
8,"WITH RECURSIVE ""my_cte"" AS (SELECT ""exam_id"",""student"".""student_id"",""student_name"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"" FROM ""exam"" RIGHT JOIN ""student"" ON ""student"".""student_id""=""exam"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""my_cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""my_cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1) ORDER BY ""student_id"""
9,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"" FROM ""exam"" JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""low""=1 OR ""high""=1) ORDER BY ""student_id"""
10,"WITH ""tem"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id""), ""tem1"" AS (SELECT ""student_id"",COUNT(""exam_id"") AS ""total_exam_cnt"",SUM(CASE WHEN ""score"" NOT IN (""min_score"",""max_score"") THEN 1 ELSE 0 END) AS ""quiet_ind"" FROM (SELECT ""a"".*,""b"".""min_score"",""b"".""max_score"" FROM ""exam"" AS ""a"" LEFT JOIN ""tem"" AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"") AS ""a"" GROUP BY ""student_id"") SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" IN (SELECT ""student_id"" FROM ""tem1"" WHERE ""quiet_ind""=""total_exam_cnt"")"
11,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT ""exam_id"",""student_id"",""score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"" FROM ""Exam"") AS ""t"" JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""t"".""student_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""t"".""score""=""min_score"" THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""t"".""score""=""max_score"" THEN 1 ELSE 0 END)=0 ORDER BY 1"
12,"WITH ""non_quite_students"" AS (SELECT DISTINCT ""exam"".""student_id"" AS ""student_id"" FROM ""exam"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""mm"" ON ""exam"".""exam_id""=""mm"".""exam_id"" AND (""exam"".""score""=""max_score"" OR ""exam"".""score""=""min_score"")) SELECT DISTINCT ""exam"".""student_id"",""student"".""student_name"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"" WHERE ""exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""non_quite_students"") ORDER BY ""exam"".""student_id"""
13,"WITH ""max_min"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_sco"",MIN(""score"") AS ""min_sco"" FROM ""Exam"" GROUP BY ""exam_id""), ""non_quiet"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" LEFT JOIN ""max_min"" ON ""Exam"".""exam_id""=""max_min"".""exam_id"" WHERE ""score""=""max_sco"" OR ""score""=""min_sco"") SELECT * FROM ""Student"" WHERE (""student_id"" NOT IN (SELECT * FROM ""non_quiet"")) AND (""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam""))"
14,"SELECT ""t2"".""student_id"",""s"".""student_name"" FROM (SELECT ""student_id"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""Exam"") AS ""t1"" GROUP BY ""student_id"" HAVING SUM(CASE WHEN ""score""=""max_score"" OR ""score""=""min_score"" THEN 1 ELSE 0 END)=0) AS ""t2"" LEFT JOIN ""student"" AS ""s"" ON ""t2"".""student_id""=""s"".""student_id"" ORDER BY ""t2"".""student_id"""
15,"WITH ""cte"" AS (SELECT MAX(""score"") AS ""best"",MIN(""score"") AS ""worst"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id""), ""cte1"" AS (SELECT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""cte"" ON ""e"".""exam_id""=""cte"".""exam_id"" AND (""cte"".""best""=""e"".""score"" OR ""cte"".""worst""=""e"".""score"")) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") ORDER BY ""student_id"""
16,"WITH ""a"" AS (SELECT ""exam_id"",""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"" FROM ""Exam"") SELECT ""b"".""student_id"",""c"".""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""a"" WHERE ""max_score""=1 OR ""min_score""=1)) AS ""b"" JOIN ""Student"" AS ""c"" ON ""b"".""student_id""=""c"".""student_id"""
17,"WITH ""exam_table"" AS (SELECT ""exam"".""student_id"",""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_high"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_low"" FROM ""exam"" JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""exam_table"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam_table"" WHERE ""low_high""=1 OR ""high_low""=1) ORDER BY ""student_id"""
18,"SELECT ""s"".* FROM ""student"" AS ""s"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""b"".""student_id"" FROM (""exam"" AS ""b"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" AS ""a"" GROUP BY ""a"".""exam_id"") AS ""c"" WHERE ""c"".""exam_id""=""b"".""exam_id"" AND (""b"".""score""=""min_score"" OR ""b"".""score""=""max_score"")) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"")"
19,"SELECT DISTINCT ""s"".""student_id"",""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" AND ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rank_num"" FROM ""Exam"" GROUP BY ""exam_id"",""student_id"" UNION ALL SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank_num"" FROM ""Exam"" GROUP BY ""exam_id"",""student_id"") AS ""a"" WHERE ""rank_num""=1) ORDER BY ""s"".""student_id"""
20,"WITH ""S0"" AS (SELECT ""exam_id"",MAX(""score"") AS ""high_score"",MIN(""score"") AS ""low_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""S1"" AS (SELECT ""Exam"".""exam_id"",""student_id"",""score"",""high_score"",""low_score"" FROM ""S0"" JOIN ""Exam"" ON ""S0"".""exam_id""=""Exam"".""exam_id""), ""S2"" AS (SELECT DISTINCT (""student_id"") AS ""student_id"" FROM ""S1"" WHERE ""score""=""high_score"" OR ""score""=""low_score"" UNION SELECT ""student_id"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT (""student_id"") FROM ""Exam"")) SELECT ""Student"".""student_id"",""student_name"" FROM ""Student"" WHERE ""Student"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""S2"")"
21,"WITH ""T1"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""Exam"".""student_id"" FROM ""Exam"" JOIN ""T1"" ON ""Exam"".""exam_id""=""T1"".""exam_id"" WHERE ""Exam"".""score""=""T1"".""max_score"" OR ""Exam"".""score""=""T1"".""min_score"") AND ""student_id"" IN (SELECT DISTINCT ""Exam"".""student_id"" FROM ""Exam"")"
22,"WITH ""cte"" AS (SELECT ""exam_id"",""Exam"".""student_id"",""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk_min"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk_max"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk_min""=1 OR ""rk_max""=1) ORDER BY ""student_id"""
23,"WITH ""score"" AS (SELECT ""exam_id"",MAX(""score"") AS ""h"",MIN(""score"") AS ""l"" FROM ""exam"" GROUP BY ""exam_id""), ""result"" AS (SELECT ""e"".""student_id"",MAX(CASE WHEN ""e"".""score""=""s"".""h"" OR ""e"".""score""=""s"".""l"" THEN 1 ELSE 0 END) AS ""flag"" FROM ""exam"" AS ""e"" JOIN ""score"" AS ""s"" ON ""e"".""exam_id""=""s"".""exam_id"" GROUP BY ""e"".""student_id"") SELECT ""r"".""student_id"",""s"".""student_name"" FROM ""result"" AS ""r"" JOIN ""student"" AS ""s"" ON ""r"".""student_id""=""s"".""student_id"" WHERE ""r"".""flag""=0 ORDER BY ""r"".""student_id"""
24,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
25,"WITH ""rank_tab"" AS (SELECT DISTINCT ""student_id"",""exam_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""exam"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""rank_tab"" JOIN ""student"" AS ""s"" ON ""rank_tab"".""student_id""=""s"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""rank_tab"" WHERE ""low_rank""=1 OR ""high_rank""=1) ORDER BY ""s"".""student_id"""
26,"SELECT ""student_id"",""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""e"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxs"",MIN(""score"") AS ""mins"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t"" USING (""exam_id"") WHERE ""score""=""maxs"" OR ""score""=""mins"")) AS ""t"" LEFT JOIN ""Student"" USING (""student_id"") ORDER BY ""student_id"""
27,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""TOP_RANK"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""BTM_RANK"" FROM ""exam"") SELECT DISTINCT ""a"".""student_id"",""b"".""student_name"" FROM ""cte"" AS ""a"" LEFT JOIN ""student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""top_rank""=1 OR ""btm_rank""=1) ORDER BY ""a"".""student_id"""
28,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxx"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""minn"" FROM ""exam"") AS ""a"" WHERE ""score""=""maxx"" OR ""score""=""minn"") ORDER BY ""e"".""student_id"""
29,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
30,"WITH ""T"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"" FROM ""Exam"") SELECT ""I"".""student_id"",""S"".""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""T"" WHERE ""high""=1 OR ""low""=1)) AS ""I"" LEFT JOIN ""Student"" AS ""S"" ON ""I"".""student_id""=""S"".""student_id"" ORDER BY ""I"".""student_id"""
31,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""exam"" GROUP BY 1,2,3) SELECT DISTINCT ""s"".* FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""low_rank""=1 OR ""high_rank""=1) ORDER BY ""s"".""student_id"""
32,"WITH ""high_students"" AS (SELECT DISTINCT ""student_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""r"" FROM ""Exam"") AS ""a"" WHERE ""r""=1), ""low_students"" AS (SELECT DISTINCT ""student_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""r"" FROM ""Exam"") AS ""a"" WHERE ""r""=1) SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" WHERE ""s"".""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""high_students"") AND ""student_id"" NOT IN (SELECT * FROM ""low_students"")"
33,"SELECT ""e"".""student_id"",""s"".""student_name"" FROM (""Exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") JOIN (SELECT MAX(""score"") AS ""high"",MIN(""score"") AS ""low"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""r"" ON ""e"".""exam_id""=""r"".""exam_id"" GROUP BY ""e"".""student_id"",""s"".""student_name"" HAVING SUM(""e"".""score""=""r"".""high"")=0 AND SUM(""e"".""score""=""r"".""low"")=0 ORDER BY ""e"".""student_id"""
34,"WITH RECURSIVE ""my_cte"" AS (SELECT ""exam_id"",""student"".""student_id"",""student_name"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"" FROM ""exam"" RIGHT JOIN ""student"" ON ""student"".""student_id""=""exam"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""my_cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""my_cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1) ORDER BY ""student_id"""
35,"WITH ""t"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY ""exam_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" LEFT JOIN ""t"" ON ""exam"".""exam_id""=""t"".""exam_id"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""exam"" GROUP BY ""student_id"" HAVING COUNT(""exam_id"")>=1)"
36,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
37,"SELECT ""student_id"",""student_name"" FROM (""exam"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""exam_min_max"" USING (""exam_id"")) JOIN ""student"" USING (""student_id"") GROUP BY ""student_id"" HAVING SUM(CASE WHEN ""score""<""max_score"" AND ""score"">""min_score"" THEN 0 ELSE 1 END)=0 ORDER BY ""student_id"""
38,"SELECT ""student_id"",""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""Exam"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxs"",MIN(""score"") AS ""mins"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t"" USING (""exam_id"") WHERE ""score""=""maxs"" OR ""score""=""mins"")) AS ""t"" LEFT JOIN ""Student"" USING (""student_id"") ORDER BY ""student_id"""
39,"WITH ""cte"" AS (SELECT ""Exam"".""student_id"",""student_name"",""exam_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
40,"WITH ""cte"" AS (SELECT MAX(""score"") AS ""best"",MIN(""score"") AS ""worst"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id""), ""cte1"" AS (SELECT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""cte"" ON ""e"".""exam_id""=""cte"".""exam_id"" AND (""cte"".""best""=""e"".""score"" OR ""cte"".""worst""=""e"".""score"")) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") ORDER BY ""student_id"""
41,"WITH ""scores_ranks_by_exam"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id""), ""loud_students"" AS (SELECT ""student_id"" FROM ""scores_ranks_by_exam"" WHERE ""max_score""=1 OR ""min_score""=1) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""loud_students"") ORDER BY ""s"".""student_id"""
42,"WITH ""a"" AS (SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id""), ""b"" AS (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""r"" FROM ""Exam"" UNION SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""r"" FROM ""Exam"") SELECT ""student_id"",""student_name"" FROM ""a"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""b"" WHERE ""r""=1) ORDER BY ""student_id"""
43,"SELECT ""st"".""student_id"",""st"".""student_name"" FROM (""exam"" AS ""et"" JOIN ""student"" AS ""st"" ON ""et"".""student_id""=""st"".""student_id"") JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_s"",MIN(""score"") AS ""min_s"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""et2"" ON ""et"".""exam_id""=""et2"".""exam_id"" GROUP BY ""et"".""student_id"" HAVING SUM(""et"".""score""=""et2"".""max_s"" OR ""et"".""score""=""et2"".""min_s"")=0 ORDER BY ""st"".""student_id"""
44,"SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""t1"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t2"" ON ""t1"".""exam_id""=""t2"".""exam_id"" WHERE ""t1"".""score""=""t2"".""score"" UNION SELECT ""student_id"" FROM ""Exam"" AS ""t1"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t2"" ON ""t1"".""exam_id""=""t2"".""exam_id"" WHERE ""t1"".""score""=""t2"".""score"") AND ""student_id"" IN (SELECT DISTINCT (""student_id"") FROM ""Exam"")"
45,"WITH ""ranktable"" AS (SELECT ""exam_id"",""score"",""student"".""student_id"",""student"".""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""last_"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""first_"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""ranktable"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Ranktable"" WHERE ""last_""=1 OR ""first_""=1) ORDER BY ""student_id"""
46,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
47,"WITH ""highest"" AS (SELECT ""exam_id"",MAX(""score"") AS ""high"" FROM ""exam"" GROUP BY ""exam_id""), ""lowest"" AS (SELECT ""exam_id"",MIN(""score"") AS ""low"" FROM ""exam"" GROUP BY ""exam_id"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" USING (""student_id"") WHERE ""student_id"" NOT IN (SELECT ""e"".""student_id"" FROM ""exam"" AS ""e"" JOIN ""highest"" AS ""h"" USING (""exam_id"") WHERE ""e"".""score""=""h"".""high"") AND ""student_id"" NOT IN (SELECT ""e"".""student_id"" FROM ""exam"" AS ""e"" JOIN ""lowest"" AS ""l"" USING (""exam_id"") WHERE ""e"".""score""=""l"".""low"") GROUP BY ""student_id"",""exam_id"""
48,"SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM (""exam"" AS ""e1"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""exam"" GROUP BY ""exam_id"" UNION SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"" AND ""e1"".""score""=""e2"".""score"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"")"
49,"SELECT DISTINCT ""Exam"".""student_id"",""student_name"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""ASC_RANK"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""DESC_RANK"" FROM ""Exam"") AS ""score_ranks"" WHERE ""ASC_RANK""=1 OR ""DESC_RANK""=1) ORDER BY ""Exam"".""student_id"""
50,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
51,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""exam"" GROUP BY 1,2,3) SELECT DISTINCT ""s"".* FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""low_rank""=1 OR ""high_rank""=1) ORDER BY ""s"".""student_id"""
52,"WITH ""extreme_scores"" AS (SELECT ""e"".""exam_id"",MIN(""e"".""score"") AS ""min_score"",MAX(""e"".""score"") AS ""max_score"" FROM ""Exam"" AS ""e"" GROUP BY ""e"".""exam_id""), ""extreme_students"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"" FROM ""Exam"" AS ""e"" JOIN ""extreme_scores"" AS ""es"" ON ""e"".""exam_id""=""es"".""exam_id"" WHERE ""e"".""score""=""es"".""min_score"" OR ""e"".""score""=""es"".""max_score"") SELECT DISTINCT ""e"".""student_id"" AS ""STUDENT_ID"",""s"".""student_name"" AS ""STUDENT_NAME"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""es"".""student_id"" FROM ""extreme_students"" AS ""es"") ORDER BY ""student_id"""
53,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
54,"SELECT * FROM ""student"" WHERE ROW(""student_id"",0) IN (SELECT ""student_id"",SUM(""quietdegree"") FROM (SELECT ""e"".""student_id"",CASE WHEN ""score""=MAX(""score"") OVER (PARTITION BY ""exam_id"") THEN 1 ELSE 0 END+CASE WHEN ""score""=MIN(""score"") OVER (PARTITION BY ""exam_id"") THEN 1 ELSE 0 END AS ""quietdegree"" FROM ""exam"" AS ""e"") AS ""r"" GROUP BY ""student_id"")"
55,"WITH ""CTE"" AS (SELECT ""e"".""student_id"",""s"".""student_name"",""e"".""exam_id"",DENSE_RANK() OVER (PARTITION BY ""EXAM_id"" ORDER BY ""score"") AS ""Minimum"",DENSE_RANK() OVER (PARTITION BY ""EXAM_id"" ORDER BY ""score"" DESC) AS ""Maximum"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""CTE"" WHERE ""student_id"" NOT IN (SELECT ""Student_id"" FROM ""CTE"" WHERE ""minimum""=1 OR ""maximum""=1) ORDER BY ""student_id"""
56,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""score_desc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""score_asc"" FROM ""exam"") SELECT ""student"".""student_id"",""student"".""student_name"" FROM ""student"" LEFT JOIN ""exam"" ON ""student"".""student_id""=""exam"".""student_id"" WHERE ""exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""score_desc""=1 OR ""score_asc""=1) GROUP BY ""student"".""student_id"""
57,"WITH ""cte"" AS (SELECT ""exam_id"",""e"".""student_id"",""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lower"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""higher"" FROM ""Exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""lower""=1 OR ""higher""=1) ORDER BY ""student_id"""
58,"WITH ""x"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",""e"".""score"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""rnk_desc"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" GROUP BY ""student_id"",""exam_id"",""score"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""x"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""x"" WHERE ""rnk_desc""=1 OR ""rnk_asc""=1) ORDER BY ""student_id"""
59,"WITH ""cte"" AS (SELECT ""exam"".""student_id"",""student"".""student_name"" AS ""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rank1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank2"" FROM ""exam"" JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""c"".""student_id"" AS ""student_id"",""student_name"" FROM ""cte"" AS ""c"" WHERE ""c"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rank1""=1 OR ""rank2""=1) ORDER BY ""c"".""student_id"""
60,"SELECT ""a"".""student_id"",""b"".""student_name"" FROM (""exam"" AS ""a"" JOIN ""student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"") LEFT JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""c"" ON ""a"".""score"">""c"".""min_score"" AND ""a"".""score""<""c"".""max_score"" AND ""a"".""exam_id""=""c"".""exam_id"" GROUP BY ""a"".""student_id"",""b"".""student_name"" HAVING COUNT(DISTINCT ""a"".""exam_id"")=COUNT(DISTINCT ""c"".""exam_id"") ORDER BY ""a"".""student_id"""
61,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""score_asc_rank"" FROM ""Exam"") AS ""sar"" WHERE ""score_asc_rank""=1) AND ""e"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""score_desc_rank"" FROM ""Exam"") AS ""sdr"" WHERE ""score_desc_rank""=1) ORDER BY ""e"".""student_id"""
62,"WITH ""attend_exam"" AS (SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id""), ""not_quite_student"" AS (SELECT DISTINCT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""asc_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""desc_rank"" FROM ""EXAM"") AS ""rank_score"" WHERE ""asc_rank""=1 OR ""desc_rank""=1) SELECT ""a"".""student_id"",""a"".""student_name"" FROM ""attend_exam"" AS ""a"" LEFT JOIN ""not_quite_student"" AS ""aqs"" ON ""a"".""student_id""=""aqs"".""student_id"" WHERE ""aqs"".""student_id"" IS NULL ORDER BY 1"
63,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk2"" FROM ""exam"") SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rnk1""=1 OR ""rnk2""=1) AND ""student_id"" IN (SELECT ""student_id"" FROM ""exam"")"
64,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""a"".""student_id"" FROM (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_rank"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_rank"" FROM ""Exam"") AS ""a"" WHERE ""a"".""score""=""min_rank"" OR ""a"".""score""=""max_rank"")) AS ""b"" ON ""s"".""student_id""=""b"".""student_id"" ORDER BY ""s"".""student_id"""
65,"WITH ""extreme_scores"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""best_worst"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""e"" JOIN ""extreme_scores"" AS ""m"" ON ""e"".""exam_id""=""m"".""exam_id"" WHERE ""e"".""score""=""m"".""min_score"" OR ""e"".""score""=""m"".""max_score"") SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT * FROM ""best_worst"") ORDER BY ""e"".""student_id"""
66,"WITH ""m"" AS (SELECT DISTINCT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""Exam"") SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""m"" WHERE ""m"".""score""=""min_score"" OR ""m"".""score""=""max_score"") ORDER BY ""e"".""student_id"""
67,"SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""Student_Id""=""e"".""student_Id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""s"".""student_id"",""s"".""student_name"",""e"".""exam_Id"",""e"".""score"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""High_R"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""Low_R"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""Student_Id""=""e"".""student_Id"") AS ""RES"" WHERE ""High_R""=1 OR ""Low_R""=1) ORDER BY ""s"".""student_id"""
68,"WITH ""score_table"" AS (SELECT ""e1"".""exam_id"",MIN(""score"") AS ""mins"",MAX(""score"") AS ""maxs"" FROM ""Exam"" AS ""e1"" GROUP BY ""exam_id""), ""quiet_table"" AS (SELECT DISTINCT ""s"".""student_id"" FROM ((""Student"" AS ""s"") CROSS JOIN ""Exam"" AS ""e"") CROSS JOIN ""score_table"" WHERE ""s"".""student_id""=""e"".""student_id"" AND ""e"".""exam_id""=""score_table"".""exam_id"" AND (""e"".""score""=""score_table"".""mins"" OR ""e"".""score""=""score_table"".""maxs"")) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ((""Student"" AS ""s"") CROSS JOIN ""quiet_table"" AS ""q"") CROSS JOIN ""Exam"" AS ""e"" WHERE ""s"".""student_id"" NOT IN (SELECT ""q1"".""student_id"" FROM ""quiet_table"" AS ""q1"") AND ""s"".""student_id"" IN (SELECT ""student_id"" FROM ""Exam"")"
69,"WITH ""exam_min_max_scores"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY 1), ""non_quiet_students"" AS (SELECT ""student_id"",SUM(CASE WHEN ""score""=""min_score"" OR ""score""=""max_score"" THEN 1 ELSE 0 END) AS ""not_quiet"" FROM ""Exam"" JOIN ""exam_min_max_scores"" AS ""scores"" ON ""scores"".""exam_id""=""Exam"".""exam_id"" GROUP BY 1) SELECT ""Student"".* FROM ""non_quiet_students"" JOIN ""Student"" ON ""non_quiet_students"".""student_id""=""Student"".""student_id"" WHERE ""not_quiet""=0 ORDER BY ""Student"".""student_id"""
70,"WITH ""MinMax"" AS (SELECT ""exam_id"",""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""LowRank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""HighRank"" FROM ""Exam"") SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""MinMax"" WHERE (""LowRank""=1 OR ""HighRank""=1)) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") ORDER BY ""student_id"""
71,"WITH ""ct"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY ""exam_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" LEFT JOIN ""ct"" ON ""exam"".""exam_id""=""ct"".""exam_id"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""exam"" GROUP BY ""student_id"" HAVING COUNT(""exam_id"")>=1)"
72,"SELECT * FROM ""student"" WHERE ROW(""student_id"",0) IN (SELECT ""student_id"",SUM(""quiet_level"") AS ""check_all"" FROM (SELECT ""exam_id"",""student_id"",""score"",CASE WHEN ""score""=MAX(""score"") OVER (PARTITION BY ""exam_id"") THEN 1 ELSE 0 END+CASE WHEN ""score""=MIN(""score"") OVER (PARTITION BY ""exam_id"") THEN 1 ELSE 0 END AS ""quiet_level"" FROM ""exam"") AS ""c"" GROUP BY ""student_id"" HAVING SUM(""quiet_level"")=0)"
73,"SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ((""student"" AS ""s"") CROSS JOIN ""exam"" AS ""e"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""highest"",MIN(""score"") AS ""lowest"" FROM ""exam"" GROUP BY ""exam_id"") AS ""t"" WHERE ""s"".""student_id""=""e"".""student_id"" AND ""e"".""exam_id""=""t"".""exam_id"" GROUP BY ""s"".""student_id"",""s"".""student_name"" HAVING SUM(CASE WHEN ""e"".""score""=""t"".""highest"" THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""e"".""score""=""t"".""lowest"" THEN 1 ELSE 0 END)=0 ORDER BY ""s"".""student_id"""
74,"WITH ""x"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",""e"".""score"",""s"".""student_name"",MIN(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""rnk_desc"",MAX(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" GROUP BY ""student_id"",""exam_id"",""score"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""x"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""x"" WHERE ""score""=""rnk_desc"" OR ""score""=""rnk_asc"") ORDER BY ""student_id"""
75,"WITH ""exam_min_max_scores"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY 1), ""non_quiet_students"" AS (SELECT ""student_id"",SUM(CASE WHEN ""score""=""min_score"" OR ""score""=""max_score"" THEN 1 ELSE 0 END) AS ""not_quiet"" FROM ""Exam"" JOIN ""exam_min_max_scores"" AS ""scores"" ON ""scores"".""exam_id""=""Exam"".""exam_id"" GROUP BY 1) SELECT ""Student"".* FROM ""non_quiet_students"" JOIN ""Student"" ON ""non_quiet_students"".""student_id""=""Student"".""student_id"" WHERE ""not_quiet""=0 ORDER BY ""Student"".""student_id"""
76,"SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE EXISTS (SELECT ""student_id"" FROM ""Exam"" WHERE ""S"".""student_id""=""student_id"") AND ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ((""Exam"" AS ""e"") CROSS JOIN (SELECT MAX(""score"") AS ""score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""k"") CROSS JOIN (SELECT MIN(""score"") AS ""score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""k2"" WHERE (""e"".""exam_id""=""k"".""exam_id"" AND ""e"".""score""=""k"".""score"") OR (""e"".""exam_id""=""k2"".""exam_id"" AND ""e"".""score""=""k2"".""score""))"
77,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM ((""Exam"" AS ""e"") CROSS JOIN (SELECT MAX(""score"") AS ""score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""k"") CROSS JOIN (SELECT MIN(""score"") AS ""score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""k2"" WHERE (""e"".""exam_id""=""k"".""exam_id"" AND ""e"".""score""=""k"".""score"") OR (""e"".""exam_id""=""k2"".""exam_id"" AND ""e"".""score""=""k2"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
78,"WITH ""cte"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"",""mins"",""maxs"" FROM (""exam"" AS ""e"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""mins"" FROM ""exam"" GROUP BY ""exam_id"") AS ""mini"" ON ""e"".""exam_id""=""mini"".""exam_id"") JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxs"" FROM ""exam"" GROUP BY ""exam_id"") AS ""maxi"" ON ""e"".""exam_id""=""maxi"".""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN (SELECT ""student_id"",COUNT(""exam_id"") AS ""ecount"",SUM(CASE WHEN ""score""=""mins"" THEN 0 WHEN ""score""=""maxs"" THEN 0 ELSE 1 END) AS ""icount"" FROM ""cte"" GROUP BY ""student_id"") AS ""b"" ON ""s"".""student_id""=""b"".""student_id"" WHERE ""ecount""=""icount"" ORDER BY ""s"".""student_id"""
79,"WITH ""data"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""stud_info"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""e"" JOIN ""data"" AS ""d"" ON ""e"".""exam_id""=""d"".""exam_id"" WHERE (""e"".""score""=""d"".""min_score"" OR ""e"".""score""=""d"".""max_score"")) SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""Student"" AS ""s"" LEFT JOIN ""stud_info"" AS ""si"" ON ""s"".""student_id""=""si"".""student_id"") LEFT JOIN (SELECT ""student_id"",COUNT(1) AS ""snct"" FROM ""Exam"" GROUP BY ""student_id"") AS ""d"" ON ""s"".""student_id""=""d"".""student_id"" WHERE ""si"".""student_id"" IS NULL AND ""d"".""snct"">0"
80,"WITH ""not_q"" AS (SELECT ""student_id"" FROM (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""asc_rnk"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""desc_rnk"" FROM ""Exam"") AS ""x"" WHERE ""asc_rnk""=1 OR ""desc_rnk""=1), ""one_test"" AS (SELECT ""student_id"" FROM ""Exam"" GROUP BY 1 HAVING COUNT(DISTINCT ""exam_id"")>=1) SELECT * FROM ""student"" WHERE ""student_id"" NOT IN (SELECT * FROM ""not_q"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""one_test"") ORDER BY 1"
81,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""Student"" AS ""s"" JOIN ""Exam"" AS ""ex"" ON ""s"".""student_id""=""ex"".""student_id"") JOIN (SELECT ""e"".""exam_id"",MIN(""e"".""score"") AS ""minScore"",MAX(""e"".""score"") AS ""maxScore"" FROM ""Exam"" AS ""e"" GROUP BY ""e"".""exam_id"") AS ""examScores"" ON ""examScores"".""exam_id""=""ex"".""exam_id"" GROUP BY ""s"".""student_id"" HAVING BIT_AND(CASE WHEN ""ex"".""score""<""examScores"".""maxScore"" AND ""ex"".""score"">""examScores"".""minScore"" THEN 1 ELSE 0 END)=1 ORDER BY ""s"".""student_id"""
82,"WITH ""mx"" AS (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id""), ""mn"" AS (SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""e"".""student_id"",""s"".""student_name"" FROM ((""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") LEFT JOIN ""mx"" ON ""e"".""exam_id""=""mx"".""exam_id"" AND ""e"".""score""=""mx"".""score"") LEFT JOIN ""mn"" ON ""e"".""exam_id""=""mn"".""exam_id"" AND ""e"".""score""=""mn"".""score"" GROUP BY ""e"".""student_id"",""s"".""student_name"" HAVING COUNT(""mx"".""score"")+COUNT(""mn"".""score"")=0 ORDER BY ""e"".""student_id"""
83,"WITH ""exam_student"" AS (SELECT ""a"".""exam_id"",""b"".""student_name"",""a"".""student_id"",""a"".""score"" FROM ""Exam"" AS ""a"" LEFT JOIN ""Student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id""), ""max_min"" AS (SELECT ""exam_id"",""student_id"",""student_name"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_in_exam"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_in_exam"" FROM ""exam_student""), ""non_quite"" AS (SELECT DISTINCT ""student_id"",""student_name"" FROM ""max_min"" WHERE (""score""=""min_in_exam"") OR (""score""=""max_in_exam"")), ""quite"" AS (SELECT DISTINCT ""student_id"",""student_name"" FROM ""max_min"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""non_quite"") ORDER BY ""student_id"") SELECT * FROM ""quite"""
84,"WITH ""high_rank_cte"" AS (SELECT * FROM (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""Ranks"" FROM ""exam"") AS ""a"" WHERE ""ranks""=1), ""low_rank_cte"" AS (SELECT * FROM (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""Ranks"" FROM ""exam"") AS ""a"" WHERE ""ranks""=1) SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""high_rank_cte"" UNION SELECT ""student_id"" FROM ""low_rank_cte"") ORDER BY 1"
85,"WITH ""scores"" AS (SELECT ""exam_id"",MIN(""score"") AS ""mini"",MAX(""score"") AS ""maxi"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" IN (SELECT ""student_id"" FROM ""exam"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" WHERE ""score"" IN (SELECT ""mini"" FROM ""scores"" WHERE ""exam_id""=""exam"".""exam_id"") OR ""score"" IN (SELECT ""maxi"" FROM ""scores"" WHERE ""exam_id""=""exam"".""exam_id"")))"
86,"WITH ""base"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",""exam_id"",""score"" FROM ""student"" AS ""s"" LEFT JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""exam_id"" IS NOT NULL), ""exam_range"" AS (SELECT ""exam_id"",MIN(""score"") AS ""lowest"",MAX(""score"") AS ""highest"" FROM ""exam"" GROUP BY 1), ""base1"" AS (SELECT ""student_id"",""student_name"",MAX(""lowest_ind"") AS ""max_lowest"",MAX(""highest_ind"") AS ""max_highest"" FROM (SELECT ""b"".""student_id"",""b"".""student_name"",""b"".""exam_id"",CASE WHEN ""score""=""lowest"" THEN 1 ELSE 0 END AS ""lowest_ind"",CASE WHEN ""score""=""highest"" THEN 1 ELSE 0 END AS ""highest_ind"" FROM ""base"" AS ""b"" LEFT JOIN ""exam_range"" AS ""e1"" ON ""b"".""exam_id""=""e1"".""exam_id"") AS ""t"" GROUP BY 1,2) SELECT ""student_id"",""student_name"" FROM ""base1"" WHERE ""max_lowest""=0 AND ""max_highest""=0 ORDER BY 1"
87,"WITH ""cte1"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") AS ""max"" FROM ""exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") AS ""min"" FROM ""exam"" GROUP BY ""exam_id"")) SELECT DISTINCT ""s"".* FROM ""exam"" JOIN ""student"" AS ""s"" USING (""student_id"") WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") ORDER BY ""s"".""student_id"""
88,"SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""Exam"") AS ""temp1"" WHERE ""temp1"".""score""=""min_score"" OR ""temp1"".""score""=""max_score"")) AS ""temp2"" JOIN ""student"" AS ""s"" ON ""temp2"".""student_id""=""s"".""student_id"""
89,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
90,"WITH ""B"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" JOIN (SELECT MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""A"" ON ""Exam"".""exam_id""=""A"".""exam_id"" AND (""Exam"".""score""=""max_score"" OR ""Exam"".""score""=""min_score"")) SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""B"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") ORDER BY ""student_id"""
91,"WITH ""high_low"" AS (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""low"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""high"",COUNT(""exam_id"") OVER (PARTITION BY ""student_id"") AS ""n_exam"" FROM ""exam""), ""quiet"" AS (SELECT ""e"".""student_id"",""s"".""student_name"",CASE WHEN ""e"".""score""<""e"".""high"" AND ""e"".""score"">""e"".""low"" THEN 1 ELSE 0 END AS ""q"",""n_exam"" FROM ""high_low"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT ""student_id"",""student_name"" FROM ""quiet"" GROUP BY ""student_id"",""student_name"" HAVING SUM(""q"")=AVG(""n_exam"")"
92,"WITH ""score_table"" AS (SELECT ""e1"".""exam_id"",MIN(""score"") AS ""mins"",MAX(""score"") AS ""maxs"" FROM ""Exam"" AS ""e1"" GROUP BY ""exam_id""), ""quite_table"" AS (SELECT DISTINCT ""s"".""student_id"" FROM ((""Student"" AS ""s"") CROSS JOIN ""Exam"" AS ""e"") CROSS JOIN ""score_table"" WHERE ""s"".""student_id""=""e"".""student_id"" AND ""e"".""exam_id""=""score_table"".""exam_id"" AND (""e"".""score""=""score_table"".""mins"" OR ""e"".""score""=""score_table"".""maxs"")) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ((""Student"" AS ""s"") CROSS JOIN ""quite_table"" AS ""q"") CROSS JOIN ""Exam"" AS ""e"" WHERE ""s"".""student_id"" NOT IN (SELECT ""q"".""student_id"" FROM (SELECT * FROM ""quite_table"") AS ""q"") AND ""s"".""student_id"" IN (SELECT ""student_id"" FROM ""Exam"")"
93,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
94,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
95,"WITH ""cte"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"",""mins"",""maxs"" FROM (""exam"" AS ""e"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""mins"" FROM ""exam"" GROUP BY ""exam_id"") AS ""mini"" ON ""e"".""exam_id""=""mini"".""exam_id"") JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxs"" FROM ""exam"" GROUP BY ""exam_id"") AS ""maxi"" ON ""e"".""exam_id""=""maxi"".""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""student"" AS ""s"" JOIN (SELECT ""student_id"",COUNT(""exam_id"") AS ""ecount"" FROM ""exam"" GROUP BY ""student_id"") AS ""a"" ON ""s"".""student_id""=""a"".""student_id"") LEFT JOIN (SELECT ""student_id"",SUM(CASE WHEN ""score""=""mins"" THEN 0 WHEN ""score""=""maxs"" THEN 0 ELSE 1 END) AS ""icount"" FROM ""cte"" GROUP BY ""student_id"") AS ""b"" ON ""s"".""student_id""=""b"".""student_id"" WHERE ""ecount""=""icount"" ORDER BY ""s"".""student_id"""
96,"WITH ""high_low"" AS (SELECT ""exam_id"",MAX(""score"") AS ""highest"",MIN(""score"") AS ""lowest"" FROM ""exam"" GROUP BY ""exam_id"") SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""e"".""student_id"" FROM (""exam"" AS ""e"") CROSS JOIN ""high_low"" AS ""hl"" WHERE ""e"".""exam_id""=""hl"".""exam_id"" AND (""e"".""score""=""hl"".""highest"" OR ""e"".""score""=""hl"".""lowest"")) ORDER BY 1"
97,"WITH ""cte"" AS (SELECT DISTINCT ""student_id"" FROM (SELECT ""student_id"",""exam_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk2"" FROM ""Exam"") AS ""h"" WHERE ""rnk1""=1 OR ""rnk2""=1) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"") AND ""s"".""student_id"" IN (SELECT ""student_id"" FROM ""Exam"" GROUP BY ""student_id"" HAVING COUNT(""exam_id"")>=1)"
98,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""a"".""student_id"" FROM (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""Exam"") AS ""a"" WHERE ""a"".""score""=""a"".""min_score"" OR ""a"".""score""=""a"".""max_score"")) AS ""b"" ON ""s"".""student_id""=""b"".""student_id"" ORDER BY ""s"".""student_id"""
99,"WITH ""e1"" AS (SELECT ""exam_id"",MAX(""score"") AS ""hs"",MIN(""score"") AS ""ms"" FROM ""Exam"" GROUP BY ""exam_id""), ""e2"" AS (SELECT ""student_id"",COUNT(""exam_id"") AS ""exam_cnt"" FROM ""Exam"" GROUP BY ""student_id""), ""e3"" AS (SELECT ""student_id"",COUNT(1) AS ""score_cnt"" FROM ""e1"" JOIN ""Exam"" ON ""e1"".""exam_id""=""Exam"".""exam_id"" WHERE ""score""<""hs"" AND ""score"">""ms"" GROUP BY ""student_id"") SELECT ""e3"".""student_id"" AS ""student_id"",""student_name"" FROM (""e3"" JOIN ""e2"" ON ""e2"".""student_id""=""e3"".""student_id"" AND ""e2"".""exam_cnt""=""e3"".""score_cnt"") LEFT JOIN ""Student"" ON ""e3"".""student_id""=""Student"".""student_id"" ORDER BY ""e3"".""student_id"""
100,"SELECT ""e"".""student_id"",""s"".""student_name"" FROM (""Exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") JOIN (SELECT MAX(""score"") AS ""high"",MIN(""score"") AS ""low"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""r"" ON ""e"".""exam_id""=""r"".""exam_id"" GROUP BY ""e"".""student_id"",""s"".""student_name"" HAVING SUM(""e"".""score""=""r"".""high"")=0 AND SUM(""e"".""score""=""r"".""low"")=0 ORDER BY ""e"".""student_id"""
101,"WITH ""highscores"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""studentsWithHighLowScores"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""e"" JOIN ""highscores"" AS ""h"" ON ""e"".""exam_id""=""h"".""exam_id"" AND (""e"".""score""=""h"".""min_score"" OR ""e"".""score""=""h"".""max_score"")) SELECT DISTINCT ""s"".""student_id"" AS ""STUDENT_ID"",""s"".""student_name"" AS ""STUDENT_NAME"" FROM (""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"") LEFT JOIN ""studentsWithHighLowScores"" AS ""hl"" ON ""s"".""student_id""=""hl"".""student_id"" WHERE ""hl"".""student_id"" IS NULL ORDER BY ""student_id"""
102,"WITH ""t"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""asc_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""desc_score"" FROM ""Exam"") SELECT DISTINCT ""t"".""student_id"",""student_name"" FROM ""t"" JOIN ""Student"" AS ""s"" ON ""t"".""student_id""=""s"".""student_id"" WHERE ""t"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""t"" WHERE ""asc_score""=1 OR ""desc_score""=1)"
103,"WITH ""rank_score"" AS (SELECT ""student_id"",""exam_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank_low"" FROM ""exam"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""rank_score"" AS ""r"" ON ""s"".""student_id""=""r"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""rank_score"" WHERE ""high_score""=1 OR ""rank_low""=1) GROUP BY ""s"".""student_id"""
104,"SELECT ""student_id"",""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""Exam"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxs"",MIN(""score"") AS ""mins"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t"" USING (""exam_id"") WHERE ""score""=""maxs"" OR ""score""=""mins"")) AS ""t"" LEFT JOIN ""Student"" USING (""student_id"") ORDER BY ""student_id"""
105,"SELECT DISTINCT ""Exam"".""student_id"",""Student"".""student_name"" FROM ""Exam"" JOIN ""Student"" ON ""Student"".""student_id""=""Exam"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""ma_sc"",MIN(""score"") AS ""mi_sc"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""sub"" ON ""Exam"".""exam_id""=""sub"".""exam_id"" WHERE ""score""=""sub"".""ma_sc"" OR ""score""=""sub"".""mi_sc"") ORDER BY ""Exam"".""student_id"""
106,"WITH ""t1"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY 1), ""t2"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",""max_score"" FROM ""t1"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",""min_score"" FROM ""t1"")) SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"" WHERE ""student_id"" NOT IN (SELECT * FROM ""t2"")) ORDER BY 1"
107,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""exam"" GROUP BY 1,2,3) SELECT DISTINCT ""s"".* FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""low_rank""=1 OR ""high_rank""=1) ORDER BY ""s"".""student_id"""
108,"WITH ""T1"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""Exam"".""student_id"" FROM ""Exam"" JOIN ""T1"" ON ""Exam"".""exam_id""=""T1"".""exam_id"" WHERE ""Exam"".""score""=""T1"".""max_score"" OR ""Exam"".""score""=""T1"".""min_score"") AND ""student_id"" IN (SELECT DISTINCT ""Exam"".""student_id"" FROM ""Exam"")"
109,"WITH ""cte"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM (""Student"" AS ""s"") CROSS JOIN ""Exam"" AS ""e"" WHERE ""s"".""student_id""=""e"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
110,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e0"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""exam_highlow_scores"" ON ""e0"".""exam_id""=""exam_highlow_scores"".""exam_id"" AND (""score""=""min_score"" OR ""score""=""max_score"")) AND ""student_id"" IN (SELECT ""student_id"" FROM ""Exam"")"
111,"SELECT ""t2"".""student_id"",""s"".""student_name"" FROM (SELECT ""student_id"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""Exam"") AS ""t1"" GROUP BY ""student_id"" HAVING SUM(CASE WHEN ""score""=""max_score"" OR ""score""=""min_score"" THEN 1 ELSE 0 END)=0) AS ""t2"" LEFT JOIN ""student"" AS ""s"" ON ""t2"".""student_id""=""s"".""student_id"" ORDER BY ""t2"".""student_id"""
112,"SELECT ""t1"".""student_id"",""t1"".""student_name"" FROM (SELECT ""e"".""exam_id"",""e"".""student_id"",""s"".""student_name"",""e"".""score"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""h_rnk"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""l_rnk"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") AS ""t1"" GROUP BY ""t1"".""student_id"",""t1"".""student_name"" HAVING MIN(""h_rnk"")!=1 AND MIN(""l_rnk"")!=1 ORDER BY ""t1"".""student_id"""
113,"WITH ""exam_min_max"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""student_with_min_max"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""A"" JOIN ""exam_min_max"" AS ""B"" ON ""A"".""exam_id""=""B"".""exam_id"" AND (""A"".""score""=""B"".""max_score"" OR ""A"".""score""=""B"".""min_score"")) SELECT DISTINCT ""A"".""student_id"",""B"".""student_name"" FROM ""Exam"" AS ""A"" JOIN ""Student"" AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""A"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""student_with_min_max"") ORDER BY ""A"".""student_id"""
114,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
115,"WITH ""cte"" AS (SELECT ""e"".""student_id"" AS ""student_id"",""s"".""student_name"" AS ""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""top"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""bottom"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""top""=1 OR ""bottom""=1) ORDER BY 1"
116,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxi"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""mini"" FROM ""Exam"") AS ""maxandmin"" WHERE ""score""=""maxi"" OR ""score""=""mini"") ORDER BY ""e"".""student_id"""
117,"WITH ""top_scores"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT ""e"".""exam_id"",""student_id"",CASE WHEN ""score""=""max_score"" OR ""score""=""min_score"" THEN 0 ELSE 1 END AS ""quiet"" FROM ""Exam"" AS ""e"" JOIN ""top_scores"" AS ""t"" ON ""e"".""exam_id""=""t"".""exam_id"") AS ""t"" JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""t"".""student_id"" GROUP BY ""s"".""student_id"",""s"".""student_name"" HAVING SUM(""quiet"")=COUNT(0) ORDER BY ""s"".""student_id"""
118,"WITH ""lo_hi"" AS (SELECT *,MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""low"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""high"" FROM ""Exam"" AS ""e""), ""louds"" AS (SELECT ""lh"".""student_id"" FROM ""lo_hi"" AS ""lh"" WHERE ""score""=""low"" OR ""score""=""high"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" USING (""student_id"") WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""louds"") ORDER BY 1"
119,"WITH ""base"" AS (SELECT ""e"".""student_id"",""e"".""score"",""e"".""exam_id"",""s"".""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" ORDER BY ""s"".""student_id"") SELECT DISTINCT ""a"".""student_id"",""a"".""student_name"" FROM ""base"" AS ""a"" WHERE ""a"".""student_id"" NOT IN (SELECT ""a"".""student_id"" FROM ""base"" AS ""a"" WHERE ""a"".""rnk_desc""=1 OR ""a"".""rnk_asc""=1)"
120,"WITH ""MinMaxExam"" AS (SELECT ""e1"".""exam_id"",""e1"".""student_id"",""e1"".""score"" FROM ""Exam"" AS ""e1"" WHERE (SELECT COUNT(1) FROM ""Exam"" AS ""e2"" WHERE ""e2"".""exam_id""=""e1"".""exam_id"" AND ""e2"".""score"">""e1"".""score"")=0 OR (SELECT COUNT(1) FROM ""Exam"" AS ""e2"" WHERE ""e2"".""exam_id""=""e1"".""exam_id"" AND ""e2"".""score""<""e1"".""score"")=0) SELECT DISTINCT ""Exam"".""student_id"",""student_name"" FROM ""Exam"" JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""MinMaxExam"") ORDER BY ""Exam"".""student_id"""
121,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""Student"" AS ""s"") CROSS JOIN (SELECT ""e"".""student_id"",COUNT(DISTINCT ""e"".""exam_id"") AS ""quiet_exams"",""y"".""exams"" FROM ((""Exam"" AS ""e"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""x"") CROSS JOIN (SELECT ""student_id"",COUNT(DISTINCT ""exam_id"") AS ""exams"" FROM ""Exam"" GROUP BY ""student_id"") AS ""y"" WHERE ""e"".""exam_id""=""x"".""exam_id"" AND ""e"".""score""<""x"".""max_score"" AND ""e"".""score"">""x"".""min_score"" AND ""e"".""student_id""=""y"".""student_id"" GROUP BY ""e"".""student_id"") AS ""z"" WHERE ""s"".""student_id""=""z"".""student_id"" AND ""z"".""quiet_exams""=""z"".""exams"""
122,"WITH ""temp"" AS (SELECT ""exam_id"",MAX(""score"") AS ""maxscore"",MIN(""score"") AS ""minscore"" FROM ""Exam"" GROUP BY ""exam_id""), ""non_quiet"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"" AS ""quietStudent"" FROM ""Exam"" AS ""e"" JOIN ""temp"" AS ""t"" ON ""e"".""exam_id""=""t"".""exam_id"" WHERE ""e"".""score""=""t"".""maxscore"" OR ""e"".""score""=""t"".""minscore""), ""quiet_student"" AS (SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT (""quietStudent"") FROM ""non_quiet"")) SELECT DISTINCT (""e"".""student_id""),""q"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""quiet_student"" AS ""q"" ON ""e"".""student_id""=""q"".""student_id"" ORDER BY ""e"".""student_id"""
123,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""exam"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""A"" ON ""exam"".""exam_id""=""A"".""exam_id"" WHERE ""exam"".""score"" IN (""A"".""max_score"",""A"".""min_score"")) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"")"
124,"WITH ""x"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",""e"".""score"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""rnk_desc"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" GROUP BY ""student_id"",""exam_id"",""score"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""x"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""x"" WHERE ""rnk_desc""=1 OR ""rnk_asc""=1) ORDER BY ""student_id"""
125,"WITH ""maxmin"" AS (SELECT ""exam_id"",MAX(""score"") AS ""high"",MIN(""score"") AS ""low"" FROM ""Exam"" GROUP BY 1), ""quite"" AS (SELECT ""e"".""student_id"",COUNT(""e"".""exam_id"") AS ""num"" FROM ""Exam"" AS ""e"" JOIN ""maxmin"" AS ""m"" ON ""e"".""exam_id""=""m"".""exam_id"" WHERE ""e"".""score""!=""m"".""high"" AND ""e"".""score""!=""m"".""low"" GROUP BY 1), ""total"" AS (SELECT ""student_id"",COUNT(""exam_id"") AS ""num"" FROM ""Exam"" GROUP BY 1) SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT ""q"".""student_id"" FROM ""quite"" AS ""q"" JOIN ""total"" AS ""t"" ON ""q"".""student_id""=""t"".""student_id"" WHERE ""q"".""num""=""t"".""num"")"
126,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""a"".""student_id"" FROM (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""Exam"") AS ""a"" WHERE ""a"".""score""=""a"".""min_score"" OR ""a"".""score""=""a"".""max_score"")) AS ""b"" ON ""s"".""student_id""=""b"".""student_id"""
127,"WITH ""a"" AS (SELECT ""b"".""student_id"",""a"".""student_name"",""exam_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""b"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""c"" FROM ""Student"" AS ""a"" JOIN ""exam"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""a"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""a"" WHERE ""b""=""score"" OR ""c""=""score"") GROUP BY ""student_id"",""student_name"" ORDER BY ""student_id"""
128,"SELECT * FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_min"" FROM (SELECT ""group_table"".""exam_id"",""min_score"",""max_score"",""e2"".""student_id"" AS ""student_min"" FROM (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""group_table"" JOIN ""exam"" AS ""e2"" ON ""group_table"".""exam_id""=""e2"".""exam_id"" WHERE ""group_table"".""min_score""=""e2"".""score"") AS ""group2"" JOIN ""exam"" AS ""e3"" ON ""group2"".""exam_id""=""e3"".""exam_id"" WHERE ""group2"".""max_score""=""e3"".""score"") AND ""student_id"" NOT IN (SELECT ""e3"".""student_id"" AS ""student_max"" FROM (SELECT ""group_table"".""exam_id"",""min_score"",""max_score"",""e2"".""student_id"" AS ""student_min"" FROM (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""group_table"" JOIN ""exam"" AS ""e2"" ON ""group_table"".""exam_id""=""e2"".""exam_id"" WHERE ""group_table"".""min_score""=""e2"".""score"") AS ""group2"" JOIN ""exam"" AS ""e3"" ON ""group2"".""exam_id""=""e3"".""exam_id"" WHERE ""group2"".""max_score""=""e3"".""score"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""exam"")"
129,"WITH ""max_min_score"" AS (SELECT DISTINCT ""exam_id"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""Exam"") SELECT ""qq"".""student_id"" AS ""student_id"",""student_name"" FROM (SELECT ""e"".""exam_id"" AS ""exam_id"",""student_id"",COUNT(""student_id"") AS ""c"",""score"" FROM ""Exam"" AS ""e"" LEFT JOIN ""max_min_score"" AS ""m"" ON ""e"".""exam_id""=""m"".""exam_id"" WHERE ""score"">""m"".""min_score"" AND ""score""<""m"".""max_score"" AND ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""student_id"",""score"" FROM ""Exam"" AS ""e"" LEFT JOIN ""max_min_score"" AS ""m"" ON ""e"".""exam_id""=""m"".""exam_id"" WHERE ""score""=""m"".""min_score"" OR ""score""=""m"".""max_score"") AS ""max_min_score_id"") GROUP BY ""student_id"" HAVING ""c"">=1) AS ""qq"" LEFT JOIN ""Student"" AS ""s"" ON ""qq"".""student_id""=""s"".""student_id"" ORDER BY ""qq"".""student_id"""
130,"SELECT DISTINCT (""s"".""student_id"") AS ""student_id"",""s"".""student_name"" AS ""student_name"" FROM (""student"" AS ""s"" JOIN ""exam"" ON ""s"".""student_id""=""exam"".""student_id"") JOIN (SELECT MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"",""exam_id"" AS ""eid"" FROM ""exam"" GROUP BY ""exam_id"") AS ""my_tab"" ON ""exam_id""=""eid"" WHERE ""score""<""max_score"" AND ""score"">""min_score"" GROUP BY ""s"".""student_id"" HAVING COUNT(""s"".""student_id"")=(SELECT COUNT(1) FROM ""exam"" AS ""e1"" WHERE ""e1"".""student_id""=""s"".""student_id"") ORDER BY ""student_id"""
131,"WITH ""quiet_students"" AS (SELECT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""ra"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rd"" FROM ""exam"") AS ""e1"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""ra"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rd"" FROM ""exam"") AS ""e2"" WHERE ""ra""=1 OR ""rd""=1)) SELECT DISTINCT ""qs"".""student_id"",""student_name"" FROM ""quiet_students"" AS ""qs"" LEFT JOIN ""student"" ON ""qs"".""student_id""=""student"".""student_id"" ORDER BY ""student_id"""
132,"WITH ""extreme_scores"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""medium_students_"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",CASE WHEN ""e"".""score""<""max_score"" AND ""e"".""score"">""min_score"" THEN 0 ELSE 1 END AS ""flag"" FROM ""Exam"" AS ""e"" JOIN ""extreme_scores"" AS ""s"" ON ""e"".""exam_id""=""s"".""exam_id""), ""medium_students"" AS (SELECT ""student_id"" FROM ""medium_students_"" GROUP BY ""student_id"" HAVING SUM(""flag"")=0) SELECT ""st"".""student_id"",""st"".""student_name"" FROM ""Student"" AS ""st"" JOIN ""medium_students"" AS ""m"" ON ""st"".""student_id""=""m"".""student_id"""
133,"SELECT ""student_id"",""student_name"" FROM (SELECT ""st"".""student_id"" AS ""student_id"",""st"".""student_name"" AS ""student_name"",""tb3"".""student_id"" AS ""exst"",""e3"".""student_id"" AS ""exst2"" FROM (""Student"" AS ""st"" LEFT JOIN (SELECT DISTINCT ""e2"".""student_id"" AS ""student_id"" FROM (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""tb"" LEFT JOIN ""exam"" AS ""e2"" ON (""e2"".""score""=""tb"".""max_score"" AND ""tb"".""exam_id""=""e2"".""exam_id"") OR (""e2"".""score""=""tb"".""min_score"" AND ""tb"".""exam_id""=""e2"".""exam_id"")) AS ""tb3"" ON ""tb3"".""student_id""=""st"".""student_id"") LEFT JOIN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AS ""e3"" ON ""st"".""student_id""=""e3"".""student_id"") AS ""t4"" WHERE ""t4"".""exst"" IS NULL AND ""t4"".""exst2"" IS NOT NULL"
134,"WITH ""examwise_high_low"" AS (SELECT ""exam_id"",MAX(""score"") AS ""highest"",MIN(""score"") AS ""lowest"" FROM ""exam"" GROUP BY ""exam_id"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""ex"".""student_id"" FROM ""exam"" AS ""ex"" JOIN ""examwise_high_low"" AS ""hl"" ON ""ex"".""exam_id""=""hl"".""exam_id"" WHERE (""ex"".""score""=""hl"".""highest"" OR ""ex"".""score""=""hl"".""lowest"")) ORDER BY 1"
135,"WITH ""scores"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"") JOIN ""scores"" AS ""c"" ON ""c"".""exam_id""=""e"".""exam_id"" GROUP BY ""s"".""student_id"",""s"".""student_name"" HAVING SUM(CASE WHEN ""e"".""score""=""c"".""max_score"" OR ""e"".""score""=""c"".""min_score"" THEN 1 ELSE 0 END)=0 ORDER BY ""s"".""student_id"""
136,"SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""s1"".""student_id"" FROM ""Exam"" AS ""s1"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""b"" ON ""s1"".""exam_id""=""b"".""exam_id"" WHERE ""s1"".""score""=""b"".""max_score"" OR ""s1"".""score""=""b"".""min_score"") ORDER BY ""s"".""student_id"""
137,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM (""Exam"" AS ""E"") CROSS JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max"",MIN(""score"") AS ""min"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""M"" WHERE ""E"".""exam_id""=""M"".""exam_id"" AND (""M"".""max""=""E"".""score"" OR ""M"".""min""=""E"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
138,"WITH ""cte"" AS (SELECT ""exam_id"",MIN(""score"") AS ""mins"",MAX(""score"") AS ""maxs"" FROM ""Exam"" GROUP BY ""exam_id""), ""cte1"" AS (SELECT ""cte"".""exam_id"",""student_id"",""score"",""mins"",""maxs"" FROM ""exam"" JOIN ""cte"" ON ""cte"".""exam_id""=""exam"".""exam_id""), ""cte2"" AS (SELECT ""student_id"" FROM ""cte1"" WHERE ""score""!=""mins"" AND ""score""!=""maxs""), ""cte3"" AS (SELECT ""t1"".""student_id"",""cn"",""cn1"" FROM (SELECT ""student_id"",COUNT(1) AS ""cn"" FROM ""cte2"" GROUP BY ""student_id"") AS ""t1"" JOIN (SELECT ""student_id"",COUNT(1) AS ""cn1"" FROM ""Exam"" GROUP BY ""student_id"") AS ""t2"" ON ""t1"".""student_id""=""t2"".""student_id"") SELECT ""cte3"".""student_id"",""student_name"" FROM ""cte3"" JOIN ""Student"" ON ""cte3"".""student_id""=""student"".""student_id"" WHERE ""cn""=""cn1"""
139,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN (SELECT DISTINCT ""student_id"" FROM ""exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max"" FROM ""exam"") AS ""score"" WHERE ""score"".""score""=""score"".""min"" OR ""score"".""score""=""score"".""max"")) AS ""id"" ON ""s"".""student_id""=""id"".""student_id"" ORDER BY ""s"".""student_id"""
140,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM (""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") LEFT JOIN (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t"" ON ""e"".""exam_id""=""t"".""exam_id"" AND (""e"".""score""=""t"".""max_score"" OR ""e"".""score""=""t"".""min_score"")) AS ""m"" ON ""e"".""student_id""=""m"".""student_id"" WHERE ""m"".""student_id"" IS NULL ORDER BY ""e"".""student_id"""
141,"WITH ""M"" AS (SELECT *,MIN(""SCORE"") OVER (PARTITION BY ""EXAM_ID"") AS ""LOWEST"",MAX(""SCORE"") OVER (PARTITION BY ""EXAM_ID"") AS ""HIGHEST"" FROM ""EXAM"") SELECT DISTINCT ""S"".""STUDENT_ID"",""S"".""STUDENT_NAME"" FROM ""STUDENT"" AS ""S"" JOIN ""EXAM"" AS ""E"" ON ""S"".""STUDENT_ID""=""E"".""STUDENT_ID"" WHERE ""S"".""STUDENT_ID"" NOT IN (SELECT ""M"".""STUDENT_ID"" FROM ""M"" WHERE ""M"".""SCORE""=""LOWEST"" OR ""M"".""SCORE""=""HIGHEST"") ORDER BY ""S"".""STUDENT_ID"""
142,"WITH ""exam_scores_denormalized"" AS (SELECT ""exam_id"",""Student"".""student_id"",""student_name"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""Exam"" JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id""), ""is_exam_result_loud"" AS (SELECT ""exam_id"",""student_id"",""student_name"",""max_score""=""score"" OR ""min_score""=""score"" AS ""is_loud"" FROM ""exam_scores_denormalized"") SELECT ""student_id"",""student_name"" FROM ""is_exam_result_loud"" GROUP BY ""student_id"",""student_name"" HAVING MAX(""is_loud"")=0 ORDER BY ""student_id"""
143,"WITH ""tmp"" AS (SELECT ""student_name"",""e"".*,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""exam_rank"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""exam_rank_reverse"" FROM ""Student"" AS ""s"" RIGHT JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"") SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""tmp"" WHERE ""exam_rank""=1 OR ""exam_rank_reverse""=1 UNION SELECT ""student_id"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam""))"
144,"SELECT * FROM ""Student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rnk"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rnk"" FROM ""Exam"") AS ""t"" WHERE ""high_rnk""=1 OR ""low_rnk""=1)"
145,"WITH ""x"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",""e"".""score"",""s"".""student_name"",MIN(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""rnk_min"",MAX(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""rnk_max"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""x"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""x"" WHERE ""score""=""rnk_min"" OR ""score""=""rnk_max"") ORDER BY ""student_id"""
146,"WITH ""main"" AS (SELECT ""Student"".*,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"" FROM ""Student"" JOIN ""Exam"" USING (""student_id"")) SELECT ""student_id"",""student_name"" FROM ""main"" GROUP BY ""student_id"" HAVING MIN(""low"")!=1 AND MIN(""high"")!=1 ORDER BY ""student_id"""
147,"WITH ""hl_student"" AS (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"" FROM ""exam"") SELECT DISTINCT ""exam"".""student_id"",""student_name"" FROM ""student"" JOIN ""exam"" ON ""student"".""student_id""=""exam"".""student_id"" WHERE ""student"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""hl_student"" WHERE ""high_rank""=1 OR ""low_rank""=1) ORDER BY 1"
148,"WITH ""loud"" AS (SELECT ""exam_id"",MAX(""score"") AS ""high"",MIN(""score"") AS ""low"" FROM ""Exam"" GROUP BY ""exam_id""), ""quiet"" AS (SELECT ""a"".* FROM ""Exam"" AS ""a"" JOIN ""loud"" AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" WHERE ""a"".""score""!=""b"".""high"" AND ""a"".""score""!=""b"".""low""), ""loud_list"" AS (SELECT ""a"".""student_id"" FROM ""Exam"" AS ""a"" JOIN ""loud"" AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" WHERE ""a"".""score""=""b"".""high"" OR ""a"".""score""=""b"".""low"") SELECT DISTINCT ""a"".""student_id"",""b"".""student_name"" FROM ""quiet"" AS ""a"" JOIN ""Student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""loud_list"") ORDER BY ""a"".""student_id"""
149,"SELECT ""student_id"",""student_name"" FROM (SELECT ""c"".*,""s"".""student_name"" FROM (SELECT ""student_id"",MIN(""is_student_quite_in_exam"") AS ""is_student_quite"",MAX(""no_of_exams_attended"") AS ""no_of_exams_attended"" FROM (SELECT DISTINCT ""student_id"",CASE WHEN ""score"">""exam_min_score"" AND ""score""<""exam_max_score"" THEN 1 ELSE 0 END AS ""is_student_quite_in_exam"",""no_of_exams_attended"" FROM (SELECT *,COUNT(""exam_id"") OVER (PARTITION BY ""student_id"") AS ""no_of_exams_attended"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""exam_max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""exam_min_score"" FROM ""Exam"") AS ""a"") AS ""b"" GROUP BY ""student_id"") AS ""c"" JOIN ""Student"" AS ""s"" ON ""c"".""student_id""=""s"".""student_id"") AS ""d"" WHERE ""is_student_quite""=1 AND ""no_of_exams_attended"">=1 ORDER BY ""student_id"""
150,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" USING (""student_id"")) SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
151,"SELECT DISTINCT ""b"".""student_id"",""d"".""student_name"" FROM ""exam"" AS ""b"" LEFT JOIN ""student"" AS ""d"" ON ""b"".""student_id""=""d"".""student_id"" WHERE ""b"".""student_id"" NOT IN (SELECT ""a"".""student_id"" FROM (SELECT ""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""mx_scr"" FROM ""exam"") AS ""a"" WHERE ""a"".""score""=""a"".""mx_scr"") AND ""b"".""student_id"" NOT IN (SELECT ""c"".""student_id"" FROM (SELECT ""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""mx_scr"" FROM ""exam"") AS ""c"" WHERE ""c"".""score""=""c"".""mx_scr"") ORDER BY 1"
152,"WITH ""max_score"" AS (SELECT ""s1"".""student_id"" FROM (SELECT ""e1"".""exam_id"",""e1"".""student_id"",""e1"".""score"",DENSE_RANK() OVER (PARTITION BY ""e1"".""exam_id"" ORDER BY ""e1"".""score"" DESC) AS ""max_rank"" FROM ""Exam"" AS ""e1"") AS ""s1"" WHERE ""max_rank""=1), ""min_score"" AS (SELECT ""s2"".""student_id"" FROM (SELECT ""e2"".""exam_id"",""e2"".""student_id"",""e2"".""score"",DENSE_RANK() OVER (PARTITION BY ""e2"".""exam_id"" ORDER BY ""e2"".""score"") AS ""min_rank"" FROM ""Exam"" AS ""e2"") AS ""s2"" WHERE ""min_rank""=1), ""n_score"" AS (SELECT DISTINCT ""max_score"".""student_id"" FROM ""max_score"" UNION ALL SELECT DISTINCT ""min_score"".""student_id"" FROM ""min_score"") SELECT DISTINCT ""st"".""student_id"",""student_name"" FROM ""Student"" AS ""st"" JOIN ""Exam"" AS ""e"" ON ""st"".""student_id""=""e"".""student_id"" WHERE ""st"".""student_id"" NOT IN (SELECT ""n_score"".""student_id"" FROM ""n_score"") ORDER BY ""st"".""student_id"""
153,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""score_desc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""score_asc"" FROM ""exam"") SELECT ""exam"".""student_id"",""student"".""student_name"" FROM ""exam"" LEFT JOIN ""student"" ON ""student"".""student_id""=""exam"".""student_id"" WHERE ""exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""score_desc""=1 OR ""score_asc""=1) GROUP BY ""exam"".""student_id"" ORDER BY ""exam"".""student_id"""
154,"WITH ""eminmax"" AS (SELECT ""exam_id"",MIN(""SCORE"") AS ""minscore"",MAX(""SCORE"") AS ""maxscore"" FROM ""exam"" GROUP BY ""exam_id""), ""ids"" AS (SELECT ""student_id"" FROM ""exam"" JOIN ""eminmax"" ON ""exam"".""exam_id""=""eminmax"".""exam_id"" WHERE ""score""=""maxscore"" OR ""score""=""minscore""), ""final"" AS (SELECT ""exam"".""student_id"" FROM ""exam"" LEFT JOIN ""ids"" ON ""exam"".""student_id""=""ids"".""student_id"" WHERE ""ids"".""student_id"" IS NULL GROUP BY ""exam"".""student_id"") SELECT ""student"".""student_id"",""student"".""student_name"" FROM ""final"" JOIN ""student"" ON ""final"".""student_id""=""student"".""student_id"""
155,"WITH ""t"" AS (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""exam""), ""t1"" AS (SELECT *,(CASE WHEN ""score""=""min_score"" OR ""score""=""max_score"" THEN 1 ELSE 0 END) AS ""flag"" FROM ""t"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""t1"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" GROUP BY 1,2 HAVING SUM(""flag"")=0"
156,"WITH ""cte"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",SUM(CASE WHEN ""e1"".""score""=""min_score"" OR ""e1"".""score""=""max_score"" THEN 1 ELSE 0 END) AS ""loud"" FROM (""Exam"" AS ""e1"" JOIN ""Student"" AS ""s"" ON ""e1"".""student_id""=""s"".""student_id"") JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY 1) AS ""e2"" ON ""e1"".""exam_id""=""e2"".""exam_id"" GROUP BY 1,2) SELECT ""student_id"",""student_name"" FROM ""cte"" WHERE ""loud""=0 ORDER BY 1"
157,"WITH ""t1"" AS (SELECT *,(CASE WHEN ""score""=MAX(""score"") OVER (PARTITION BY ""exam_id"") OR ""score""=MIN(""score"") OVER (PARTITION BY ""exam_id"") THEN 1 ELSE 0 END) AS ""flag"" FROM ""exam"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""t1"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" GROUP BY 1,2 HAVING SUM(""flag"")=0"
158,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk_from_top"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk_from_bottom"" FROM ""exam"") SELECT DISTINCT ""c"".""student_id"",""s"".""student_name"" FROM ""cte"" AS ""c"" LEFT JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""c"".""student_id"" WHERE ""c"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""rk_from_top""=1 OR ""rk_from_bottom""=1) ORDER BY 1"
159,"WITH ""m"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY 1) SELECT DISTINCT ""e"".""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""m"" JOIN ""Exam"" AS ""e"" ON ""e"".""exam_id""=""m"".""exam_id"" AND (""e"".""score""=""m"".""max_score"" OR ""e"".""score""=""m"".""min_score"")) ORDER BY 1"
160,"WITH ""cte"" AS (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxs"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""mins"" FROM ""exam"") SELECT DISTINCT ""c"".""student_id"",""s"".""student_name"" FROM ""cte"" AS ""c"" LEFT JOIN ""student"" AS ""s"" ON ""c"".""student_id""=""s"".""student_id"" WHERE ""score""<""maxs"" AND ""score"">""mins"" AND ""c"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""score""=""mins"" OR ""score""=""maxs"") ORDER BY ""c"".""student_id"""
161,"SELECT DISTINCT ""Exam"".""student_id"",""Student"".""student_name"" FROM ""Exam"" JOIN ""Student"" ON ""Student"".""student_id""=""Exam"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""ma_sc"",MIN(""score"") AS ""mi_sc"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""sub"" ON ""Exam"".""exam_id""=""sub"".""exam_id"" WHERE ""score""=""sub"".""ma_sc"" OR ""score""=""sub"".""mi_sc"") ORDER BY ""Exam"".""student_id"""
162,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""desc_rk"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""asc_rk"" FROM ""Exam"") AS ""t"" ON ""t"".""student_id""=""s"".""student_id"" GROUP BY ""s"".""student_id"",""s"".""student_name"" HAVING MIN(""t"".""desc_rk"")!=1 AND MIN(""asc_rk"")!=1 ORDER BY ""s"".""student_id"""
163,"SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""Exam"") AS ""temp1"" WHERE ""temp1"".""score""=""temp1"".""min_score"" OR ""temp1"".""score""=""temp1"".""max_score"")) AS ""temp2"" JOIN ""student"" AS ""s"" ON ""temp2"".""student_id""=""s"".""student_id"""
164,"WITH ""not_quiet"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""SCORE"" DESC) AS ""high_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""SCORE"") AS ""low_score"" FROM ""Exam"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" USING (""student_id"") WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""not_quiet"" WHERE ""high_score""=1 OR ""low_score""=1) ORDER BY ""s"".""student_id"""
165,"WITH ""cte1"" AS (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_exam_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_exam_score"" FROM ""exam""), ""cte2"" AS (SELECT ""student_id"" FROM ""cte1"" WHERE ""score""=""min_exam_score"" OR ""score""=""max_exam_score"") SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte2"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"")"
166,"WITH ""getRange"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY 1), ""silentStudents"" AS (SELECT ""student_id"",COUNT(1) AS ""total_count"" FROM ""Exam"" AS ""e"" JOIN ""getRange"" AS ""g"" ON ""e"".""exam_id""=""g"".""exam_id"" AND (""e"".""score"">""g"".""min_score"" AND ""e"".""score""<""g"".""max_score"") GROUP BY 1), ""studentCount"" AS (SELECT ""student_id"",COUNT(1) AS ""exam_count"" FROM ""Exam"" GROUP BY 1) SELECT DISTINCT ""Student"".""student_id"",""Student"".""student_name"" FROM (""silentStudents"" JOIN ""studentCount"" ON ""silentStudents"".""student_id""=""studentCount"".""student_id"" AND ""total_count""=""exam_count"") JOIN ""Student"" ON ""Student"".""student_id""=""silentStudents"".""student_id"" ORDER BY 1"
167,"WITH ""extreme"" AS (SELECT ""exam_id"",""student_id"",""score"",""rank"" FROM (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rank"" FROM ""exam"" UNION SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank"" FROM ""exam"") AS ""tmp"" WHERE ""tmp"".""rank""=1) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""extreme"") ORDER BY 1"
168,"SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""t1"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t2"" ON ""t1"".""exam_id""=""t2"".""exam_id"" WHERE ""t1"".""score""=""t2"".""score"" UNION SELECT ""student_id"" FROM ""Exam"" AS ""t1"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t2"" ON ""t1"".""exam_id""=""t2"".""exam_id"" WHERE ""t1"".""score""=""t2"".""score"") AND ""student_id"" IN (SELECT DISTINCT (""student_id"") FROM ""Exam"")"
169,"SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_rank"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_rank"" FROM ""exam"") AS ""cte"" WHERE ""max_rank""=1 OR ""min_rank""=1)"
170,"SELECT DISTINCT ""t1"".""student_id"",""t1"".""student_name"" FROM (""student"" AS ""t1"") CROSS JOIN (SELECT DISTINCT ""a"".""student_id"",MIN(CASE WHEN ""a"".""s_max""!=""b"".""ex_max"" AND ""a"".""s_min""!=""b"".""ex_min"" THEN 1 ELSE 0 END) AS ""q"" FROM (SELECT ""student_id"",MAX(""score"") AS ""s_max"",MIN(""score"") AS ""s_min"",""exam_id"" FROM ""exam"" GROUP BY ""student_id"",""exam_id"" HAVING COUNT(DISTINCT ""exam_id"")>=1) AS ""a"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""ex_max"",MIN(""score"") AS ""ex_min"" FROM ""exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" GROUP BY ""a"".""student_id"" HAVING ""q""=1) AS ""t2"" WHERE ""t1"".""student_id""=""t2"".""student_id"""
171,"WITH ""CTE"" AS (SELECT ""EXAM_ID"",""E"".""STUDENT_ID"",""STUDENT_NAME"",RANK() OVER (PARTITION BY ""EXAM_ID"" ORDER BY ""SCORE"" DESC) AS ""RN"",RANK() OVER (PARTITION BY ""EXAM_ID"" ORDER BY ""SCORE"") AS ""RNR"" FROM ""EXAM"" AS ""E"" LEFT JOIN ""STUDENT"" AS ""S"" ON ""E"".""STUDENT_ID""=""S"".""STUDENT_ID""), ""CTE1"" AS (SELECT ""STUDENT_ID"",""STUDENT_NAME"",(CASE WHEN ""RN""!=1 AND ""RNR""!=1 THEN 1 ELSE 0 END) AS ""QUIET"" FROM ""CTE"") SELECT ""STUDENT_ID"",MIN(""STUDENT_NAME"") AS ""STUDENT_NAME"" FROM ""CTE1"" GROUP BY ""STUDENT_ID"" HAVING AVG(""QUIET"")=1 ORDER BY 1"
172,"SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e1"" WHERE ""score""=(SELECT MAX(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"") OR ""score""=(SELECT MIN(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id""))"
173,"SELECT DISTINCT ""a"".""student_id"",""b"".""student_name"" FROM ""exam"" AS ""a"" JOIN ""student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") AS ""filter"" FROM ""exam"" GROUP BY 1) UNION SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") AS ""filter"" FROM ""exam"" GROUP BY 1)) ORDER BY 1"
174,"SELECT * FROM ""Student"" AS ""s"" WHERE EXISTS (SELECT 1 FROM ""EXAM"" AS ""e"" WHERE ""s"".""student_id""=""e"".""student_id"") AND NOT EXISTS (SELECT 1 FROM (SELECT ""exam_id"",""STUDENT_ID"" FROM (SELECT ""exam_id"",""STUDENT_ID"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""EXAM"") AS ""t2"" WHERE ""low_rank""=1 OR ""high_rank""=1) AS ""t3"" WHERE ""s"".""student_id""=""t3"".""student_id"")"
175,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""exam"") SELECT DISTINCT ""s"".* FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""low_rank""=1 OR ""high_rank""=1) ORDER BY ""s"".""student_id"""
176,"SELECT DISTINCT ""student"".""student_id"",""student_name"" FROM (SELECT ""student_id"",""exam_ct"",COUNT(1) OVER (PARTITION BY ""student_id"") AS ""quiet_ct"" FROM (SELECT ""exam_id"",""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",COUNT(""exam_id"") OVER (PARTITION BY ""student_id"") AS ""exam_ct"" FROM ""exam"") AS ""max_min_scores"" WHERE ""score""<""max_score"" AND ""score"">""min_score"") AS ""quiet"" JOIN ""student"" ON ""student"".""student_id""=""quiet"".""student_id"" WHERE ""exam_ct""=""quiet_ct"""
177,"WITH ""H"" AS (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"")), ""L"" AS (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")), ""HL"" AS (SELECT * FROM ""H"" UNION SELECT * FROM ""L"") SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT * FROM ""HL"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") ORDER BY ""student_id"""
178,"WITH ""maxmin"" AS (SELECT ""exam_id"",""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""exam"") SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""maxmin"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"")"
179,"WITH ""tmp"" AS (SELECT *,CASE WHEN ""score""=""highest"" OR ""score""=""lowest"" THEN 'AO' ELSE 'quiet' END AS ""label"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""highest"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""lowest"" FROM ""exam"" ORDER BY 1,2) AS ""t"") SELECT ""b"".* FROM ""tmp"" AS ""a"" JOIN ""student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""label""='quiet' THEN 1 ELSE 0 END)/COUNT(1)=1 ORDER BY 1"
180,"WITH ""max_min_score"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY ""exam_id"") SELECT ""a"".""student_id"",""a"".""student_name"" FROM (""student"" AS ""a"" JOIN ""exam"" AS ""b"" ON (""a"".""student_id""=""b"".""student_id"")) JOIN ""max_min_score"" AS ""c"" ON (""b"".""exam_id""=""c"".""exam_id"") GROUP BY ""a"".""student_id"",""a"".""student_name"" HAVING SUM(CASE WHEN ""b"".""score""=""c"".""max_score"" OR ""b"".""score""=""c"".""min_score"" THEN 1 ELSE 0 END)=0 ORDER BY ""a"".""student_id"""
181,"WITH ""cte"" AS (SELECT ""exam_id"",""e"".""student_id"",""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1) ORDER BY ""student_id"""
182,"WITH ""t"" AS (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""r1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""r2"" FROM ""exam""), ""e"" AS (SELECT ""student_id"" FROM ""t"" WHERE ""r1""=1 OR ""r2""=1) SELECT DISTINCT ""t"".""student_id"",""s"".""student_name"" FROM ""t"" JOIN ""student"" AS ""s"" ON ""t"".""student_id""=""s"".""student_id"" AND ""t"".""student_id"" NOT IN (SELECT * FROM ""e"")"
183,"SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") AS ""highest"" FROM ""Exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") AS ""lowest"" FROM ""Exam"" GROUP BY ""exam_id"")) ORDER BY ""student_id"""
184,"WITH ""BestAndWorstStudents"" AS (SELECT DISTINCT ""student_id"" FROM ((""Exam"" AS ""e"") CROSS JOIN (SELECT MAX(""score"") AS ""score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""k"") CROSS JOIN (SELECT MIN(""score"") AS ""score"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""k2"" WHERE (""e"".""exam_id""=""k"".""exam_id"" AND ""e"".""score""=""k"".""score"") OR (""e"".""exam_id""=""k2"".""exam_id"" AND ""e"".""score""=""k2"".""score"")) SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""Student"" AS ""S"" WHERE EXISTS (SELECT ""student_id"" FROM ""Exam"" WHERE ""S"".""student_id""=""student_id"") AND ""student_id"" NOT IN (SELECT * FROM ""BestAndWorstStudents"")"
185,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"" FROM ""exam"" GROUP BY 1,2,3) SELECT DISTINCT ""s"".* FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""low_rank""=1 OR ""high_rank""=1) ORDER BY ""s"".""student_id"""
186,"WITH ""temp"" AS (SELECT ""e"".""student_id"",""b"".""student_name"",""score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""highest_score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lowest_score"",SUM(1) OVER (PARTITION BY ""student_id"") AS ""tests_count"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""b"" USING (""student_id"")) SELECT DISTINCT ""student_id"",""student_name"" FROM (""temp"" AS ""t"" LEFT JOIN (SELECT DISTINCT ""student_id"" FROM ""temp"" WHERE ""score""=""highest_score"") AS ""h"" USING (""student_id"")) LEFT JOIN (SELECT DISTINCT ""student_id"" FROM ""temp"" WHERE ""score""=""lowest_score"") AS ""l"" USING (""student_id"") WHERE ""h"".""student_id"" IS NULL AND ""l"".""student_id"" IS NULL AND ""t"".""tests_count"">=1"
187,"WITH ""table1"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""student_name"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" USING (""student_id"")) SELECT DISTINCT ""student_id"",""student_name"" FROM ""table1"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""table1"" WHERE ""rnk_desc""=1 OR ""rnk_asc""=1) ORDER BY ""student_id"""
188,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" USING (""student_id"") WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""exam"" GROUP BY ""exam_id"" UNION ALL SELECT ""exam_id"",MAX(""score"") FROM ""exam"" GROUP BY ""exam_id"")) ORDER BY ""e"".""student_id"""
189,"SELECT ""b"".""student_id"",""student_name"" FROM (""student"") CROSS JOIN (SELECT ""student_id"",SUM(CASE WHEN ""score""<""maxscore"" AND ""score"">""minscore"" THEN 0 ELSE 1 END) AS ""quiet"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxscore"",MIN(""score"") AS ""minscore"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""a"" ON ""e"".""exam_id""=""a"".""exam_id"" GROUP BY ""student_id"" HAVING ""quiet""=0) AS ""b"" WHERE ""student"".""student_id""=""b"".""student_id"""
190,"SELECT ""STUDENT_ID"",""STUDENT_NAME"" FROM ""STUDENT"" WHERE ""STUDENT_ID"" NOT IN (SELECT ""STUDENT_ID"" FROM (SELECT ""STUDENT_ID"",RANK() OVER (PARTITION BY ""EXAM_ID"" ORDER BY ""SCORE"") AS ""SCORE_RANK_1"",RANK() OVER (PARTITION BY ""EXAM_ID"" ORDER BY ""SCORE"" DESC) AS ""SCORE_RANK_2"" FROM ""EXAM"") AS ""A"" WHERE ""SCORE_RANK_1""=1 OR ""SCORE_RANK_2""=1) AND ""STUDENT_ID"" IN (SELECT ""STUDENT_ID"" FROM ""EXAM"")"
191,"WITH ""students_ranking"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" USING (""student_id"")) SELECT ""student_id"",""student_name"" FROM ""students_ranking"" GROUP BY 1,2 HAVING MIN(""low"")>1 AND MIN(""high"")>1 ORDER BY 1"
192,"WITH ""edges"" AS (SELECT ""exam_id"",MAX(""score"") AS ""highest"",MIN(""score"") AS ""lowest"" FROM ""exam"" GROUP BY ""exam_id""), ""quiet"" AS (SELECT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""edges"" AS ""ed"" ON ""ed"".""exam_id""=""e"".""exam_id"" WHERE (""e"".""score""=""lowest"" OR ""e"".""score""=""highest"") GROUP BY ""student_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""e"".""student_id""=""s"".""student_id"") LEFT JOIN ""quiet"" AS ""q"" ON ""q"".""student_id""=""s"".""student_id"" WHERE ""q"".""student_id"" IS NULL GROUP BY ""s"".""student_id"",""s"".""student_name"" ORDER BY ""s"".""student_id"""
193,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
194,"SELECT ""student"".""student_id"",""student_name"" FROM ""student"" LEFT JOIN ""exam"" ON ""student"".""student_id""=""exam"".""student_id"" WHERE ""student"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""exam"" GROUP BY ""exam_id"") UNION SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""exam"" GROUP BY ""exam_id"")) GROUP BY ""student"".""student_id"" HAVING COUNT(""exam_id"")>=1"
195,"WITH ""cte"" AS (SELECT MAX(""score"") AS ""best"",MIN(""score"") AS ""worst"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id""), ""cte1"" AS (SELECT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""cte"" ON ""e"".""exam_id""=""cte"".""exam_id"" AND (""cte"".""best""=""e"".""score"" OR ""cte"".""worst""=""e"".""score"")) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") ORDER BY ""student_id"""
196,"WITH ""high_scorers"" AS (SELECT ""student_id"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""high_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""ehs"" ON ""e"".""exam_id""=""ehs"".""exam_id"" AND ""e"".""score""=""ehs"".""high_score""), ""low_scorers"" AS (SELECT ""student_id"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""high_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""ehs"" ON ""e"".""exam_id""=""ehs"".""exam_id"" AND ""e"".""score""=""ehs"".""high_score"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT * FROM ""high_scorers"") AND ""s"".""student_id"" NOT IN (SELECT * FROM ""low_scorers"") GROUP BY ""s"".""student_id"" ORDER BY ""s"".""student_id"""
197,"WITH ""sub"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""hr"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lr"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" USING (""student_id"")) SELECT ""student_id"",""student_name"" FROM ""sub"" GROUP BY ""student_id"",""student_name"" HAVING MIN(LEAST(""hr"", ""lr""))>1 ORDER BY ""student_id"""
198,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"" UNION ALL SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id""))"
199,"WITH ""m"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""f2"".""student_id"",""Student"".""student_name"" FROM (SELECT ""f"".""student_id"",SUM(CASE WHEN ""f"".""score""=""f"".""max_score"" OR ""f"".""score""=""f"".""min_score"" THEN 1 ELSE 0 END) AS ""mscore"" FROM (SELECT ""e"".""student_id"",""e"".""score"",""m"".""max_score"",""m"".""min_score"" FROM ""Exam"" AS ""e"" JOIN ""m"" ON ""e"".""exam_id""=""m"".""exam_id"") AS ""f"" GROUP BY ""f"".""student_id"") AS ""f2"" LEFT JOIN ""Student"" ON ""f2"".""student_id""=""Student"".""student_id"" WHERE ""f2"".""mscore""=0 ORDER BY ""f2"".""student_id"""
200,"WITH ""cte1"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min1"",MAX(""score"") AS ""max1"" FROM ""exam"" GROUP BY ""exam_id""), ""cte2"" AS (SELECT DISTINCT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""cte1"" AS ""c"" ON ""e"".""exam_id""=""c"".""exam_id"" WHERE ""score""=""max1"" OR ""score""=""min1""), ""cte3"" AS (SELECT ""e"".""exam_id"",""student_id"",""score"" FROM ""exam"" AS ""e"" JOIN ""cte1"" AS ""c"" ON ""e"".""exam_id""=""c"".""exam_id"" WHERE ""score""<""max1"" AND ""score"">""min1"") SELECT DISTINCT ""c"".""student_id"",""student_name"" FROM ""cte3"" AS ""c"" JOIN ""student"" AS ""s"" ON ""c"".""student_id""=""s"".""student_id"" WHERE ""c"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte2"") ORDER BY ""c"".""student_id"""
201,"SELECT DISTINCT ""Exam"".""student_id"",""Student"".""student_name"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maximum"",MIN(""score"") AS ""minimum"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t"" ON ""Exam"".""exam_id""=""t"".""exam_id"" WHERE ""Exam"".""score""=""t"".""maximum"" OR ""Exam"".""score""=""t"".""minimum"") ORDER BY ""Exam"".""student_id"""
202,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"") UNION SELECT ""student_id"" FROM ""Exam"" RIGHT JOIN ""Student"" USING (""student_id"") GROUP BY ""student_id"" HAVING SUM(""score"") IS NULL) ORDER BY ""student_id"""
203,"WITH ""sub"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""hr"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lr"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" USING (""student_id"")) SELECT ""student_id"",""student_name"" FROM ""sub"" GROUP BY ""student_id"",""student_name"" HAVING LEAST(MIN(""hr""), MIN(""lr""))>1 ORDER BY ""student_id"""
204,"WITH ""cte"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnt_max"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnt_min"" FROM ""exam"") SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rnt_max""=1 OR ""rnt_min""=1) ORDER BY 1"
205,"SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""exam"" GROUP BY 1 UNION (SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""exam"" GROUP BY 1))) ORDER BY 1"
206,"WITH ""TEMP"" AS (SELECT ""S"".""STUDENT_ID"" AS ""STUDENT_ID"",""S"".""STUDENT_NAME"" AS ""STUDENT_NAME"",CASE WHEN ""E"".""SCORE"">MIN(""E"".""SCORE"") OVER (PARTITION BY ""E"".""EXAM_ID"") AND ""E"".""SCORE""<MAX(""E"".""SCORE"") OVER (PARTITION BY ""E"".""EXAM_ID"") THEN 0 ELSE 1 END AS ""SCORE"" FROM (""STUDENT"" AS ""S"") CROSS JOIN ""EXAM"" AS ""E"" WHERE ""S"".""STUDENT_ID""=""E"".""STUDENT_ID"") SELECT ""STUDENT_ID"",""STUDENT_NAME"" FROM ""TEMP"" GROUP BY ""STUDENT_ID"",""STUDENT_NAME"" HAVING SUM(""SCORE"")=0 ORDER BY 1"
207,"WITH ""tmp"" AS (SELECT ""a"".*,""b"".""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"" FROM ""exam"" AS ""a"" JOIN ""student"" AS ""b"" USING (""student_id"")) SELECT DISTINCT ""student_id"",""student_name"" FROM ""tmp"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""tmp"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1) ORDER BY 1"
208,"WITH ""rank_table"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rank2"" FROM ""Exam"") SELECT DISTINCT ""S"".""student_id"",""S"".""student_name"" FROM ""Student"" AS ""S"" JOIN ""Exam"" AS ""E"" ON ""S"".""student_id""=""E"".""student_id"" WHERE ""S"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""rank_table"" WHERE ""rank1""=1 OR ""rank2""=1) ORDER BY ""S"".""student_id"""
209,"SELECT DISTINCT ""A"".""student_id"",""student_name"" FROM ""Exam"" AS ""A"" LEFT JOIN ""Student"" AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""A"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")) ORDER BY 1"
210,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""e1"".""student_id"" FROM ""Exam"" AS ""e1"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"")) AND ""student_id"" NOT IN (SELECT DISTINCT ""e1"".""student_id"" FROM ""Exam"" AS ""e1"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"")"
211,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
212,"WITH ""temp"" AS (SELECT ""Exam"".*,""student"".""student_name"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""Max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""Min_score"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT (""student_id""),""student_name"" FROM ""temp"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""temp"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") ORDER BY ""student_id"""
213,"WITH ""temp"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""temp"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""temp"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY 1"
214,"WITH ""tempTable"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""HighestScore"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""LowestScore"" FROM ""Exam"") SELECT DISTINCT ""tempTable"".""student_id"",""Student"".""student_name"" FROM ""tempTable"" LEFT JOIN ""Student"" ON ""tempTable"".""student_id""=""Student"".""student_id"" WHERE ""tempTable"".""student_id"" NOT IN (SELECT ""tempTable"".""student_id"" FROM ""tempTable"" WHERE ""HighestScore""=1 OR ""LowestScore""=1) ORDER BY ""tempTable"".""student_id"""
215,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""e"".""student_id"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""high"",MIN(""score"") AS ""low"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""l"" ON ""e"".""exam_id""=""l"".""exam_id"" AND (""e"".""score""=""l"".""high"" OR ""e"".""score""=""l"".""low""))"
216,"WITH ""cte"" AS (SELECT ""Exam"".""student_id"" AS ""student_id"",""student_name"",""exam_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lowest_score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""highest_score"" FROM ""Exam"" LEFT JOIN ""Student"" USING (""student_id"")) SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""lowest_score""=1 OR ""highest_score""=1) ORDER BY ""student_id"""
217,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_score"" FROM ""exam"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""exam"" LEFT JOIN ""student"" USING (""student_id"") WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""cte"" WHERE ""high_score""=1 OR ""low_score""=1) ORDER BY ""student_id"""
218,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
219,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e1"" WHERE ""score""=(SELECT MAX(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"") OR ""score""=(SELECT MIN(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id""))"
220,"SELECT ""t1"".""student_id"",""t1"".""student_name"" FROM (""student"" AS ""t1"") CROSS JOIN (SELECT DISTINCT ""a"".""student_id"",MIN(CASE WHEN ""a"".""s_max""!=""b"".""ex_max"" AND ""a"".""s_min""!=""b"".""ex_min"" THEN 1 ELSE 0 END) AS ""q"" FROM (SELECT ""student_id"",MAX(""score"") AS ""s_max"",MIN(""score"") AS ""s_min"",""exam_id"" FROM ""exam"" GROUP BY ""student_id"",""exam_id"" HAVING COUNT(DISTINCT ""exam_id"")>=1) AS ""a"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""ex_max"",MIN(""score"") AS ""ex_min"" FROM ""exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" GROUP BY ""a"".""student_id"" HAVING ""q""=1) AS ""t2"" WHERE ""t1"".""student_id""=""t2"".""student_id"""
221,"SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""exam"" AS ""e"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""exam"" GROUP BY ""exam_id"" UNION SELECT ""exam_id"",MIN(""score"") FROM ""exam"" GROUP BY ""exam_id"")) AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""student"" NATURAL LEFT CROSS JOIN ""exam"" WHERE ""score"" IS NULL)"
222,"WITH ""H"" AS (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"")), ""L"" AS (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")), ""HL"" AS (SELECT * FROM ""H"" UNION SELECT * FROM ""L"") SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT * FROM ""HL"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") ORDER BY ""student_id"""
223,"SELECT ""Student"".""student_id"",""Student"".""student_name"" FROM ""Student"" LEFT JOIN (SELECT DISTINCT ""Exam"".""student_id"" AS ""student_id"" FROM ""Exam"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""g_t"" ON ""Exam"".""exam_id""=""g_t"".""exam_id"" AND (""Exam"".""score""=""g_t"".""max_score"" OR ""Exam"".""score""=""g_t"".""min_score"")) AS ""e2"" ON ""Student"".""student_id""=""e2"".""student_id"" WHERE ""e2"".""student_id"" IS NULL AND ""Student"".""student_id"" IN (SELECT DISTINCT (""student_id"") FROM ""Exam"")"
224,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk2"" FROM ""Exam"") SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""e"".""student_id"""
225,"WITH ""cte"" AS (SELECT ""e"".""student_id"" AS ""student_id"",""s"".""student_name"" AS ""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""top"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""bottom"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""top""=1 OR ""bottom""=1) ORDER BY 1"
226,"WITH ""score_record"" AS (SELECT ""exam_id"",MAX(""score"") AS ""highest_score"",MIN(""score"") AS ""lowest_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""not_quiet"" AS (SELECT DISTINCT ""s"".""student_id"" FROM (""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" USING (""student_id"")) JOIN ""score_record"" AS ""sr"" ON ""e"".""exam_id""=""sr"".""exam_id"" AND ""e"".""score"" IN (""sr"".""highest_score"",""sr"".""lowest_score"") WHERE ""sr"".""exam_id"" IS NOT NULL) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" USING (""student_id"") WHERE ""s"".""student_id"" NOT IN (SELECT * FROM ""not_quiet"") ORDER BY ""s"".""student_id"""
227,"WITH ""high_score_student"" (""student_id"", ""high_score"") AS (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"" FROM ""Exam""), ""low_score_student"" (""student_id"", ""low_score"") AS (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_score"" FROM ""Exam"") SELECT DISTINCT ""a"".""student_id"",""student_name"" FROM ""Student"" AS ""a"" LEFT JOIN ""Exam"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""high_score_student"" WHERE ""high_score""=1) AND ""a"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""low_score_student"" WHERE ""low_score""=1) AND ""b"".""exam_id"" IS NOT NULL ORDER BY ""a"".""student_id"""
228,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""ascRank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""descRank"" FROM ""exam"") AS ""temp"" WHERE ""ascRank""=1 OR ""descRank""=1) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"")"
229,"WITH ""ref"" AS (SELECT ""e"".""student_id"",""student_name"",""e"".""exam_id"",""score"",CASE WHEN ""score""=(SELECT MAX(""score"") FROM ""Exam"" AS ""ex"" GROUP BY ""exam_id"" HAVING ""ex"".""exam_id""=""e"".""exam_id"") OR ""score""=(SELECT MIN(""score"") FROM ""Exam"" AS ""ex"" GROUP BY ""exam_id"" HAVING ""ex"".""exam_id""=""e"".""exam_id"") THEN 1 ELSE 0 END AS ""not_quiet"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" USING (""student_id"") ORDER BY ""student_id"") SELECT ""student_id"",""student_name"" FROM ""ref"" GROUP BY ""student_id"",""student_name"" HAVING SUM(""not_quiet"")=0 ORDER BY ""student_id"""
230,"WITH ""CTE"" AS (SELECT ""EXAM_ID"",MAX(""SCORE"") AS ""MAX_SCORE"",MIN(""SCORE"") AS ""MIN_SCORE"" FROM ""EXAM"" GROUP BY ""EXAM_ID""), ""CTE_2"" AS (SELECT ""E"".""EXAM_ID"",""E"".""STUDENT_ID"",CASE WHEN ""E"".""SCORE"">""CTE"".""MIN_SCORE"" AND ""E"".""SCORE""<""CTE"".""MAX_SCORE"" THEN 'YES' ELSE 'NO' END AS ""INDICATOR"" FROM ""EXAM"" AS ""E"" JOIN ""CTE"" ON ""E"".""EXAM_ID""=""CTE"".""EXAM_ID"") SELECT DISTINCT ""CTE_2"".""STUDENT_ID"",""S"".""STUDENT_NAME"" FROM ""CTE_2"" JOIN ""STUDENT"" AS ""S"" ON ""CTE_2"".""STUDENT_ID""=""S"".""STUDENT_ID"" WHERE ""CTE_2"".""STUDENT_ID"" NOT IN (SELECT ""STUDENT_ID"" FROM ""CTE_2"" WHERE ""INDICATOR""='NO') ORDER BY 1"
231,"SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM (""exam"" AS ""e"") CROSS JOIN ""student"" AS ""s"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""a"".""student_id"" FROM (SELECT ""exam"".""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxs"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""mins"" FROM ""exam"") AS ""a"" WHERE ""a"".""score""=""maxs"" OR ""a"".""score""=""mins"") AND ""e"".""student_id""=""s"".""student_id"" ORDER BY ""e"".""student_id"""
232,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank_asc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rank_desc"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rank_asc""=1 OR ""rank_desc""=1) ORDER BY ""student_id"""
233,"WITH ""tmp"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""s"".""student_name"",""e"".""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""highScore"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lowScore"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" USING (""student_id"")) SELECT DISTINCT ""student_id"",""student_name"" FROM ""tmp"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""tmp"" WHERE ""highScore""=1 OR ""lowScore""=1) ORDER BY ""student_id"""
234,"WITH ""exam_lowest_highest"" AS (SELECT ""exam_id"",MIN(""score"") AS ""lowest"",MAX(""score"") AS ""highest"" FROM ""exam"" GROUP BY ""exam_id""), ""low_score_students"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",""lowest"" FROM ""exam_lowest_highest"")), ""high_score_students"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",""highest"" FROM ""exam_lowest_highest"")), ""inactive_students"" AS (SELECT ""student_id"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"")) SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT * FROM ""low_score_students"") AND ""student_id"" NOT IN (SELECT * FROM ""high_score_students"") AND ""student_id"" NOT IN (SELECT * FROM ""inactive_students"")"
235,"WITH ""ranking"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""r1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""r2"" FROM ""Exam"") SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""ranking"" WHERE ""r1""=1 OR ""r2""=1) AND ""student_id"" IN (SELECT ""student_id"" FROM ""Exam"")"
236,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_mark"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_mark"" FROM ""exam"") SELECT DISTINCT ""s"".""student_id"",""student_name"" FROM ""student"" AS ""s"" JOIN ""cte"" ON ""s"".""student_id""=""cte"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""high_mark""=1) AND ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""low_mark""=1) ORDER BY ""student_id"""
237,"WITH ""cte1"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""exam"" GROUP BY 1 UNION SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""exam"" GROUP BY 1)), ""cte2"" AS (SELECT ""student_id"" FROM ""exam"" GROUP BY 1 HAVING COUNT(""exam_id"")>=1) SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") AND ""student_id"" IN (SELECT ""student_id"" FROM ""cte2"")"
238,"SELECT DISTINCT ""a"".""student_id"",""b"".""student_name"" FROM ""exam"" AS ""a"" JOIN ""Student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""exam"" AS ""a"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxscore"",MIN(""score"") AS ""minscore"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" WHERE (""a"".""score""=""maxscore"" OR ""a"".""score""=""minscore"")) ORDER BY 1"
239,"SELECT ""student_id"",""student_name"" FROM ""student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""exam"" GROUP BY ""exam_id"" UNION SELECT ""exam_id"",MIN(""score"") FROM ""exam"" GROUP BY ""exam_id"")))"
240,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e1"" WHERE ""score""=(SELECT MAX(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"") OR ""score""=(SELECT MIN(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id""))"
241,"SELECT DISTINCT ""A"".""student_id"",""student_name"" FROM ""Exam"" AS ""A"" LEFT JOIN ""Student"" AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""A"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")) ORDER BY 1"
242,"WITH ""cte"" AS (SELECT DISTINCT ""student_id"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""highest"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""lowest"" FROM ""Exam"") AS ""a"" WHERE ""score""!=""highest"" AND ""score""!=""lowest"" AND ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""highest"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""lowest"" FROM ""Exam"") AS ""a"" WHERE ""score""=""highest"" OR ""score""=""lowest"")) SELECT ""student_id"",""student_name"" FROM ""cte"" JOIN ""Student"" USING (""student_id"")"
243,"SELECT DISTINCT ""A"".""student_id"",""student_name"" FROM ""Exam"" AS ""A"" LEFT JOIN ""Student"" AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""A"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")) ORDER BY 1"
244,"WITH ""CTE"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"" FROM ""Exam"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""high""=1 OR ""low""=1) ORDER BY ""s"".""student_id"""
245,"WITH ""student_ranking"" AS (SELECT ""s"".""student_id"",""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""SCORE"") AS ""low"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""SCORE"" DESC) AS ""high"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"") SELECT ""student_id"" AS ""STUDENT_ID"",""student_name"" AS ""STUDENT_NAME"" FROM ""student_ranking"" GROUP BY 1,2 HAVING MIN(""low"")>1 AND MIN(""high"")>1 ORDER BY 1"
246,"WITH ""score"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT DISTINCT (""e2"".""student_id""),""st"".""student_name"" FROM ""Exam"" AS ""e2"" JOIN ""Student"" AS ""st"" ON ""e2"".""student_id""=""st"".""student_id"" WHERE ""e2"".""student_id"" NOT IN (SELECT DISTINCT (""e1"".""student_id"") FROM ""Exam"" AS ""e1"" JOIN ""score"" AS ""s"" ON ""e1"".""exam_id""=""s"".""exam_id"" WHERE ""e1"".""score""=""s"".""max_score"" OR ""e1"".""score""=""s"".""min_score"") ORDER BY ""e2"".""student_id"""
247,"WITH ""t"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"" FROM ""Exam"") SELECT DISTINCT ""t"".""student_id"",""student_name"" FROM ""t"" JOIN ""Student"" ON ""t"".""student_id""=""Student"".""student_id"" WHERE ""t"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""t"" WHERE ""rk""=1 OR ""rk1""=1)"
248,"WITH ""cte"" AS (SELECT MAX(""score"") AS ""best"",MIN(""score"") AS ""worst"",""exam_id"" FROM ""Exam"" GROUP BY ""exam_id""), ""cte1"" AS (SELECT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""cte"" ON ""e"".""exam_id""=""cte"".""exam_id"" AND (""cte"".""best""=""e"".""score"" OR ""cte"".""worst""=""e"".""score"")) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") ORDER BY ""student_id"""
249,"WITH ""base"" AS (SELECT ""exam_Id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_Id"" ORDER BY ""score"") AS ""ascending_rank"",RANK() OVER (PARTITION BY ""exam_Id"" ORDER BY ""score"" DESC) AS ""descending_rank"" FROM ""exam"") SELECT DISTINCT ""student"".* FROM ""base"" LEFT JOIN ""student"" ON ""base"".""student_id""=""student"".""student_id"" WHERE ""ascending_rank""!=1 AND ""descending_rank""!=1 AND ""base"".""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""base"" WHERE ""ascending_rank""=1 OR ""descending_rank""=1) ORDER BY ""student"".""student_id"""
250,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""a"".""student_id"" FROM ""Exam"" AS ""a"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" AND ""a"".""score""=""b"".""max_score"" UNION SELECT DISTINCT ""a"".""student_id"" FROM ""Exam"" AS ""a"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" AND ""a"".""score""=""b"".""min_score"") ORDER BY 1"
251,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT ""student_id"",(""score""=MAX(""score"") OVER (PARTITION BY ""exam_id""))+(""score""=MIN(""score"") OVER (PARTITION BY ""exam_id"")) AS ""quiet"" FROM ""Exam"") AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" GROUP BY ""s"".""student_id"",""s"".""student_name"" HAVING SUM(""quiet"")=0"
252,"WITH ""first_last"" AS (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_rank"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_rank"" FROM ""exam"") SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""first_last"" WHERE ""high_rank""=1 OR ""low_rank""=1) ORDER BY 1"
253,"WITH ""A"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""lowest"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""highest"" FROM ""Exam"") SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""A"" WHERE ""lowest""=1 OR ""highest""=1) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"")"
254,"WITH ""quite_scored"" AS (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""quite_score"" FROM ""Exam""), ""max_quite_scored"" AS (SELECT ""exam_id"",MAX(""quite_score"") AS ""max_qs"" FROM ""quite_scored"" GROUP BY ""exam_id""), ""joined"" AS (SELECT DISTINCT ""student_id"" FROM ""quite_scored"" AS ""qs"" LEFT JOIN ""max_quite_scored"" AS ""mqs"" ON ""qs"".""exam_id""=""mqs"".""exam_id"" WHERE ""quite_score""=""max_qs"" OR ""quite_score""=1) SELECT DISTINCT ""S"".""student_id"",""student_name"" FROM ""Exam"" AS ""E"" LEFT JOIN ""Student"" AS ""S"" ON ""E"".""student_id""=""S"".""student_id"" WHERE ""S"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""joined"") ORDER BY ""S"".""student_id"""
255,"WITH ""temp"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""exam"" GROUP BY ""exam_id"" UNION SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""exam"" GROUP BY ""exam_id"")) SELECT ""s"".""student_id"" AS ""STUDENT_ID"",""s"".""student_name"" AS ""STUDENT_NAME"" FROM ""student"" AS ""s"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""temp"") AND EXISTS (SELECT 1 FROM ""exam"" AS ""e"" WHERE ""s"".""student_id""=""e"".""student_id"")"
256,"WITH ""ref"" AS (SELECT ""e"".""student_id"",""student_name"",""e"".""exam_id"",""score"",CASE WHEN ""score""=(SELECT MAX(""score"") FROM ""Exam"" AS ""ex"" GROUP BY ""exam_id"" HAVING ""ex"".""exam_id""=""e"".""exam_id"") OR ""score""=(SELECT MIN(""score"") FROM ""Exam"" AS ""ex"" GROUP BY ""exam_id"" HAVING ""ex"".""exam_id""=""e"".""exam_id"") THEN 1 ELSE 0 END AS ""not_quiet"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" USING (""student_id"") ORDER BY ""student_id"") SELECT ""student_id"",""student_name"" FROM ""ref"" GROUP BY ""student_id"",""student_name"" HAVING SUM(""not_quiet"")=0 ORDER BY ""student_id"""
257,"SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" USING (""student_id"") WHERE ""e"".""student_id"" NOT IN (SELECT DISTINCT ""e"".""student_id"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" USING (""student_id"") WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""exam"" GROUP BY ""exam_id"")) ORDER BY ""e"".""student_id"""
258,"WITH ""min_cte"" AS (SELECT ""score"",""student_id"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""mini"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxi"" FROM ""exam""), ""min_max_cte"" AS ((SELECT ""student_id"",""score"" FROM ""min_cte"" WHERE ""score""=""mini"" OR ""score""=""maxi"")) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" AND ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""min_max_cte"") ORDER BY ""e"".""student_id"""
259,"SELECT ""b"".""student_id"",""student_name"" FROM (""student"") CROSS JOIN (SELECT ""student_id"",SUM(CASE WHEN ""score""<""maxscore"" AND ""score"">""minscore"" THEN 0 ELSE 1 END) AS ""quiet"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxscore"",MIN(""score"") AS ""minscore"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""a"" ON ""e"".""exam_id""=""a"".""exam_id"" GROUP BY ""student_id"" HAVING ""quiet""=0) AS ""b"" WHERE ""student"".""student_id""=""b"".""student_id"""
260,"WITH ""student_with_min_max_score"" AS (SELECT ""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""exam""), ""not_quite_students"" AS (SELECT DISTINCT ""student_id"" FROM ""student_with_min_max_score"" WHERE ""score""=""min_score"" OR ""score""=""max_score"") SELECT ""student_id"",""student_name"" FROM ""student"" WHERE NOT EXISTS (SELECT 1 FROM ""not_quite_students"" WHERE ""student"".""student_id""=""not_quite_students"".""student_id"") AND EXISTS (SELECT 1 FROM ""exam"" WHERE ""student"".""student_id""=""exam"".""student_id"")"
261,"SELECT DISTINCT ""A"".""student_id"",""student_name"" FROM ""Exam"" AS ""A"" LEFT JOIN ""Student"" AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""A"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""Exam"" GROUP BY ""exam_id"") OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""Exam"" GROUP BY ""exam_id"")) ORDER BY 1"
262,"WITH ""Exam_max"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""maxRanks"" FROM ""exam"" GROUP BY ""exam_id"",""student_id""), ""Exam_min"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""minRanks"" FROM ""exam"" GROUP BY ""exam_id"",""student_id""), ""Student_Max_Min"" AS (SELECT DISTINCT (""student_id"") AS ""student_id"" FROM ""Exam_max"" WHERE ""maxRanks""=1 UNION SELECT DISTINCT (""student_id"") AS ""student_id"" FROM ""Exam_min"" WHERE ""minRanks""=1) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Student_Max_Min"") ORDER BY ""e"".""student_id"""
263,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN (SELECT ""a"".""student_id"",COUNT(""a"".""exam_id"") AS ""total_exam"",SUM(CASE WHEN ""a"".""score"">""min_score"" AND ""a"".""score""<""max_score"" THEN 1 ELSE 0 END) AS ""quite_exam"" FROM ""exam"" AS ""a"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" GROUP BY ""a"".""student_id"") AS ""c"" ON ""s"".""student_id""=""c"".""student_id"" WHERE ""c"".""total_exam""=""c"".""quite_exam"" ORDER BY ""s"".""student_id"""
264,"WITH ""ScoreExtremes"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""ExtremeScorers"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" JOIN ""ScoreExtremes"" ON ""Exam"".""exam_id""=""ScoreExtremes"".""exam_id"" AND (""Exam"".""score""=""ScoreExtremes"".""max_score"" OR ""Exam"".""score""=""ScoreExtremes"".""min_score"")) SELECT ""Student"".""student_id"",""Student"".""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""ExtremeScorers"")"
265,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk2"" FROM ""exam"") SELECT DISTINCT ""b"".""student_id"",""b"".""student_name"" FROM ""exam"" AS ""a"" JOIN ""student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rnk""=1 OR ""rnk2""=1) ORDER BY 1"
266,"SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""Exam"".""student_id"",""student_name"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"") AS ""T"" WHERE ""T"".""score""=""T"".""min_score"" OR ""T"".""score""=""T"".""max_score"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""EXAM"")"
267,"SELECT DISTINCT ""Student"".""student_id"",""Student"".""student_name"" FROM ""Student"" RIGHT JOIN ""exam"" ON ""Student"".""student_id""=""exam"".""student_id"" WHERE ""Student"".""Student_id"" NOT IN (SELECT ""e"".""student_id"" AS ""student_id"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxScore"",MIN(""score"") AS ""minScore"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""temp"" ON ""e"".""exam_id""=""temp"".""exam_id"" WHERE ""e"".""score""=""temp"".""maxScore"" OR ""e"".""score""=""temp"".""minScore"") ORDER BY ""Student"".""student_id"""
268,"WITH ""Score_max_min"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY 1), ""min_max_student"" AS (SELECT DISTINCT ""e"".""student_id"" FROM ""Exam"" AS ""e"" JOIN ""Score_max_min"" AS ""smm"" ON ""smm"".""exam_id""=""e"".""exam_id"" WHERE ""e"".""score""=""smm"".""max_score"" OR ""e"".""score""=""smm"".""min_score""), ""no_student"" AS (SELECT ""s"".""student_id"" FROM ""Student"" AS ""s"" LEFT JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""e"".""student_id"" IS NULL) SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""min_max_student"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""no_student"")"
269,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") AND ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e1"" WHERE ""score""=(SELECT MAX(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"") OR ""score""=(SELECT MIN(""score"") FROM ""Exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id""))"
270,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN (SELECT ""A"".""student_id"" FROM (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") NOT IN (SELECT ""exam_id"",MIN(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1 UNION ALL SELECT ""exam_id"",MAX(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1) GROUP BY 1) AS ""A"" LEFT JOIN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1 UNION ALL SELECT ""exam_id"",MAX(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1) GROUP BY 1) AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""B"".""student_id"" IS NULL GROUP BY 1) AS ""final"" ON ""s"".""student_id""=""final"".""student_id"""
271,"WITH ""CTE"" AS (SELECT ""EXAM_ID"",""E"".""STUDENT_ID"",""STUDENT_NAME"",RANK() OVER (PARTITION BY ""EXAM_ID"" ORDER BY ""SCORE"" DESC) AS ""RN"",RANK() OVER (PARTITION BY ""EXAM_ID"" ORDER BY ""SCORE"") AS ""RNR"" FROM ""EXAM"" AS ""E"" LEFT JOIN ""STUDENT"" AS ""S"" ON ""E"".""STUDENT_ID""=""S"".""STUDENT_ID""), ""CTE1"" AS (SELECT ""STUDENT_ID"",""STUDENT_NAME"",(CASE WHEN ""RN""!=1 AND ""RNR""!=1 THEN 1 ELSE 0 END) AS ""QUIET"" FROM ""CTE"") SELECT ""STUDENT_ID"",MIN(""STUDENT_NAME"") AS ""STUDENT_NAME"" FROM ""CTE1"" GROUP BY ""STUDENT_ID"" HAVING AVG(""QUIET"")=1 ORDER BY 1"
272,"WITH ""sr"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"" FROM ""exam"") SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""student"" AS ""s"" RIGHT JOIN ""exam"" AS ""e"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""sr"".""student_id"" FROM ""sr"" WHERE ""sr"".""low""=1 OR ""sr"".""high""=1) ORDER BY ""s"".""student_id"""
273,"WITH ""cte"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"" FROM (""exam"" AS ""e"" JOIN (SELECT ""exam_id"",""student_id"",MAX(""score"") AS ""highest"" FROM ""exam"" GROUP BY ""exam_id"") AS ""high"" ON ""high"".""exam_id""=""e"".""exam_id"") JOIN (SELECT ""exam_id"",""student_id"",MIN(""score"") AS ""lowest"" FROM ""exam"" GROUP BY ""exam_id"") AS ""low"" ON ""low"".""exam_id""=""e"".""exam_id"" WHERE ""e"".""score""=""high"".""highest"" OR ""e"".""score""=""low"".""lowest"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"") AND ""s"".""student_id"" IN (SELECT ""student_id"" FROM ""exam"")"
274,"SELECT * FROM ""Student"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""e"".""student_id"" AS ""non_quiet"" FROM ""Exam"" AS ""e"" LEFT JOIN (SELECT ""exam_id"",MIN(""score"") AS ""low_score"",MAX(""score"") AS ""high_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""low_high"" ON ""e"".""exam_id""=""low_high"".""exam_id"" WHERE ""score""=""low_score"" OR ""score""=""high_score""))"
275,"SELECT ""a"".""student_id"",""a"".""student_name"" FROM ""Student"" AS ""a"" JOIN (SELECT ""exam_id"",""student_id"",""score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"" FROM ""Exam"") AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""b"".""score""=""max_score"" THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""b"".""score""=""min_score"" THEN 1 ELSE 0 END)=0"
276,"WITH ""loud"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""exam"" GROUP BY 1), ""n_exam"" AS (SELECT ""student_id"",COUNT(DISTINCT ""exam_id"") AS ""n_exam"" FROM ""exam"" GROUP BY 1), ""quite"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",""e"".""exam_id"" FROM (""student"" AS ""s"" LEFT JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"") LEFT JOIN ""loud"" AS ""l"" ON ""e"".""exam_id""=""l"".""exam_id"" WHERE ""e"".""score""!=""max_score"" AND ""e"".""score""!=""min_score""), ""n_quite"" AS (SELECT ""student_id"",""student_name"",COUNT(DISTINCT ""exam_id"") AS ""n_quite"" FROM ""quite"" GROUP BY 1,2) SELECT ""nq"".""student_id"",""nq"".""student_name"" FROM ""n_quite"" AS ""nq"" LEFT JOIN ""n_exam"" AS ""ne"" ON ""nq"".""student_id""=""ne"".""student_id"" WHERE ""nq"".""n_quite""=""ne"".""n_exam"""
277,"WITH ""x"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",""e"".""score"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""rnk_desc"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""x"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""x"" WHERE ""rnk_desc""=1 OR ""rnk_asc""=1) ORDER BY ""student_id"""
278,"WITH ""t"" AS (SELECT ""s"".""student_id"",""s"".""student_name"",RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""ma"",RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""mi"" FROM ""student"" AS ""s"" JOIN ""exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN ""t"" ON ""s"".""student_id""=""t"".""student_id"" WHERE ""t"".""student_id"" NOT IN (SELECT ""t"".""student_id"" FROM ""t"" WHERE ""t"".""ma""=1 OR ""t"".""mi""=1)"
279,"WITH ""t1"" AS (SELECT ""student_id"" FROM ""exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") FROM ""exam"" GROUP BY 1) OR ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") FROM ""exam"" GROUP BY 1)) SELECT DISTINCT ""a"".""student_id"",""student_name"" FROM ""exam"" AS ""a"" JOIN ""student"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"" WHERE ""a"".""student_id"" NOT IN (SELECT * FROM ""t1"") ORDER BY 1"
280,"WITH ""HighRankers"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""High"" FROM ""Exam""), ""LowRankers"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""Low"" FROM ""Exam""), ""NonQuiteStuderns"" AS (SELECT ""student_id"" FROM ""HighRankers"" WHERE ""High""=1 UNION SELECT ""student_id"" FROM ""LowRankers"" WHERE ""Low""=1) SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""NonQuiteStuderns"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"") ORDER BY 1"
281,"WITH ""sample"" AS (SELECT ""exam_id"",""a"".""student_id"",""score"",""student_name"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxi"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""mini"" FROM ""student"" AS ""a"" JOIN ""exam"" AS ""b"" ON ""a"".""student_id""=""b"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""sample"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""sample"" WHERE ""score""=""mini"" UNION SELECT ""student_id"" FROM ""sample"" WHERE ""score""=""maxi"") ORDER BY ""student_id"""
282,"WITH ""q1"" AS (SELECT ""exam_id"",MAX(""score"") AS ""maxscore"" FROM ""exam"" GROUP BY ""exam_id""), ""q2"" AS (SELECT ""exam_id"",MIN(""score"") AS ""minscore"" FROM ""exam"" GROUP BY ""exam_id""), ""q3"" AS (SELECT ""e"".""student_id"" FROM (""exam"" AS ""e"") CROSS JOIN ""q1"" WHERE ""e"".""exam_id""=""q1"".""exam_id"" AND ""e"".""score""=""q1"".""maxscore""), ""q4"" AS (SELECT ""e"".""student_id"" FROM (""exam"" AS ""e"") CROSS JOIN ""q2"" WHERE ""e"".""exam_id""=""q2"".""exam_id"" AND ""e"".""score""=""q2"".""minscore""), ""q5"" AS (SELECT * FROM ""q3"" UNION ALL SELECT * FROM ""q4""), ""q6"" AS (SELECT ""e"".""student_id"" FROM ((""exam"" AS ""e"") CROSS JOIN ""q1"") CROSS JOIN ""q2"" WHERE ""e"".""exam_id""=""q1"".""exam_id"" AND ""e"".""score""<""q1"".""maxscore"" AND ""e"".""exam_id""=""q2"".""exam_id"" AND ""e"".""score"">""q2"".""minscore"" GROUP BY ""e"".""student_id"") SELECT ""q6"".""student_id"",""s"".""student_name"" FROM (""student"" AS ""s"") CROSS JOIN ""q6"" WHERE ""q6"".""student_id"" NOT IN (SELECT * FROM ""q5"") AND ""q6"".""student_id""=""s"".""student_id"""
283,"WITH ""CTE"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"",MAX(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""maxscore"",MIN(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""minscore"" FROM ""Exam"" AS ""e"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""Student"" AS ""s"" LEFT JOIN (SELECT ""cte"".""student_id"" FROM ""CTE"" WHERE ""cte"".""score""=""cte"".""minscore"" OR ""cte"".""score""=""cte"".""maxscore"" GROUP BY ""cte"".""student_id"" ORDER BY ""cte"".""student_id"") AS ""t"" ON ""s"".""student_id""=""t"".""student_id"") LEFT JOIN (SELECT ""student_id"",COUNT(1) AS ""countstudent"" FROM ""Exam"" GROUP BY ""student_id"") AS ""c"" ON ""s"".""student_id""=""c"".""student_id"" WHERE ""t"".""student_id"" IS NULL AND ""c"".""countstudent"">=1"
284,"WITH ""maxminscore"" AS (SELECT DISTINCT ""exam_id"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""score"" FROM ""exam"" UNION ALL SELECT DISTINCT ""exam_id"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""score"" FROM ""exam"") SELECT DISTINCT ""s1"".""student_id"",""s1"".""student_name"" FROM ""student"" AS ""s1"" JOIN ""exam"" USING (""student_id"") WHERE ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"" FROM ""exam"" AS ""e"" JOIN ""maxminscore"" AS ""m"" ON ""m"".""exam_id""=""e"".""exam_id"" AND ""m"".""score""=""e"".""score"") AS ""a"") ORDER BY 1"
285,"SELECT * FROM ""student"" WHERE ""student_id"" NOT IN (SELECT DISTINCT ""e1"".""student_id"" FROM ""exam"" AS ""e1"" WHERE ""e1"".""score"" IN (SELECT MAX(""score"") FROM ""exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"")) AND ""student_id"" NOT IN (SELECT DISTINCT ""e1"".""student_id"" FROM ""exam"" AS ""e1"" WHERE ""e1"".""score"" IN (SELECT MIN(""score"") FROM ""exam"" AS ""e2"" WHERE ""e1"".""exam_id""=""e2"".""exam_id"")) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"")"
286,"WITH ""CTE"" AS (SELECT ""student_id"",""exam_id"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_score"" FROM ""Exam"") SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""b"" ON ""s"".""student_id""=""b"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""CTE"" WHERE ""high_score""=1 OR ""low_score""=1) ORDER BY ""s"".""student_id"""
287,"WITH ""students_with_min_max"" AS (SELECT ""e1"".""student_id"" FROM ""exam"" AS ""e1"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""e2"" ON ""e2"".""exam_id""=""e1"".""exam_id"" WHERE ""e1"".""score""=""e2"".""min_score"" OR ""e1"".""score""=""e2"".""max_score""), ""students_who_took_exam"" AS (SELECT DISTINCT ""student_id"" FROM ""exam"") SELECT * FROM ""student"" AS ""s"" WHERE ""s"".""student_id"" NOT IN (SELECT * FROM ""students_with_min_max"") AND ""s"".""student_id"" IN (SELECT * FROM ""students_who_took_exam"")"
288,"SELECT DISTINCT ""Student"".* FROM ""Student"" JOIN ""Exam"" ON ""Student"".""student_id""=""Exam"".""student_id"" WHERE ""student"".""student_id"" NOT IN (SELECT ""e1"".""student_id"" FROM ""Exam"" AS ""e1"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""e2"" ON ""e1"".""exam_id""=""e2"".""exam_id"" WHERE ""e1"".""score""=""e2"".""min_score"" OR ""e1"".""score""=""e2"".""max_score"") ORDER BY ""student_id"""
289,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""a"".""student_id"" FROM ""Exam"" AS ""a"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" AND ""a"".""score""=""b"".""max_score"" UNION SELECT ""a"".""student_id"" FROM ""Exam"" AS ""a"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" AND ""a"".""score""=""b"".""min_score"") ORDER BY 1"
290,"WITH ""cte"" AS (SELECT ""exam_id"",""e"".""student_id"",""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""low_score""=1 OR ""high_score""=1) ORDER BY ""student_id"""
291,"WITH ""cte"" AS (SELECT ""e"".""student_id"",RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""high"",RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""low"" FROM ""Exam"" AS ""e"") SELECT DISTINCT (""s"".""student_id""),""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""cte"".""student_id"" FROM ""cte"" WHERE ""high""=1 OR ""low""=1) ORDER BY ""e"".""student_id"""
292,"WITH ""min_max"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY 1), ""quiet_exams"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",CASE WHEN ""e"".""score"">""mm"".""min_score"" AND ""e"".""score""<""mm"".""max_score"" THEN 1 ELSE 0 END AS ""quiet_exam"" FROM ""exam"" AS ""e"" JOIN ""min_max"" AS ""mm"" ON ""mm"".""exam_id""=""e"".""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""quiet_exams"" AS ""qe"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""qe"".""student_id"" GROUP BY 1 HAVING MIN(""qe"".""quiet_exam"")=1 ORDER BY 1"
293,"SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""examrank"" FROM ""exam"") AS ""a"" WHERE ""examrank""=1 UNION ALL SELECT ""student_id"" FROM (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""examrank"" FROM ""exam"") AS ""a"" WHERE ""examrank""=1) ORDER BY ""e"".""student_id"""
294,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN (SELECT ""A"".""student_id"" FROM (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") NOT IN (SELECT ""exam_id"",MIN(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1 UNION ALL SELECT ""exam_id"",MAX(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1) GROUP BY 1) AS ""A"" LEFT JOIN (SELECT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MIN(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1 UNION ALL SELECT ""exam_id"",MAX(""score"") AS ""mscore"" FROM ""Exam"" GROUP BY 1) GROUP BY 1) AS ""B"" ON ""A"".""student_id""=""B"".""student_id"" WHERE ""B"".""student_id"" IS NULL GROUP BY 1) AS ""final"" ON ""s"".""student_id""=""final"".""student_id"""
295,"SELECT DISTINCT ""a"".""student_id"",""a"".""student_name"" FROM (SELECT ""e"".""student_id"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_student_exam_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_student_exam_rank"" FROM ""Exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") AS ""a"" GROUP BY ""a"".""student_name"" HAVING MIN(""high_student_exam_rank"")>1 AND MIN(""low_student_exam_rank"")>1 ORDER BY ""student_id"""
296,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM ""student"" AS ""s"" JOIN (SELECT ""a"".""student_id"",COUNT(""a"".""exam_id"") AS ""total_exam"",SUM(CASE WHEN ""a"".""score"">""min_score"" AND ""a"".""score""<""max_score"" THEN 1 ELSE 0 END) AS ""quite_exam"" FROM ""exam"" AS ""a"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""b"" ON ""a"".""exam_id""=""b"".""exam_id"" GROUP BY ""a"".""student_id"") AS ""c"" ON ""s"".""student_id""=""c"".""student_id"" WHERE ""c"".""total_exam""=""c"".""quite_exam"" ORDER BY ""s"".""student_id"""
297,"WITH ""Exam_max"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""maxRanks"" FROM ""exam"" GROUP BY ""exam_id"",""student_id""), ""Exam_min"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""minRanks"" FROM ""exam"" GROUP BY ""exam_id"",""student_id""), ""Student_Max_Min"" AS (SELECT DISTINCT (""student_id"") AS ""student_id"" FROM ""Exam_max"" WHERE ""maxRanks""=1 UNION SELECT DISTINCT (""student_id"") AS ""student_id"" FROM ""Exam_min"" WHERE ""minRanks""=1) SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Student_Max_Min"") ORDER BY ""e"".""student_id"""
298,"WITH ""cte"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_score"" FROM ""Exam"") SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""high_score""=1 OR ""low_score""=1) ORDER BY 1"
299,"WITH ""tallied"" AS (WITH ""minmax"" AS (SELECT ""exam_id"",MIN(""score"") AS ""least"",MAX(""score"") AS ""most"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""e"".""student_id"",""s"".""student_name"",SUM(CASE WHEN ""e"".""score""=""m"".""least"" THEN 1 ELSE 0 END) AS ""lows"",SUM(CASE WHEN ""e"".""score""=""m"".""most"" THEN 1 ELSE 0 END) AS ""highs"",SUM(CASE WHEN ""e"".""score""!=""m"".""least"" AND ""e"".""score""!=""m"".""most"" THEN 1 ELSE 0 END) AS ""neither"" FROM (""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") JOIN ""minmax"" AS ""m"" ON ""e"".""exam_id""=""m"".""exam_id"" GROUP BY ""student_id"") SELECT ""student_id"",""student_name"" FROM ""tallied"" WHERE ""lows""=0 AND ""highs""=0 AND ""neither"">0 ORDER BY ""student_id"""
300,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
301,"WITH RECURSIVE ""my_cte"" AS (SELECT ""exam_id"",""student"".""student_id"",""student_name"",""score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk_asc"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk_desc"" FROM ""exam"" RIGHT JOIN ""student"" ON ""student"".""student_id""=""exam"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""my_cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""my_cte"" WHERE ""rnk_asc""=1 OR ""rnk_desc""=1) ORDER BY ""student_id"""
302,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high"" FROM ""Exam"" JOIN ""Student"" USING (""student_id"")) SELECT ""student_id"",""student_name"" FROM ""cte"" GROUP BY 1,2 HAVING MIN(""low"")>1 AND MIN(""high"")>1 ORDER BY 1"
303,"WITH ""CTE"" AS (SELECT ""e"".""exam_id"",""e"".""student_id"",""e"".""score"",MAX(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""maxscore"",MIN(""e"".""score"") OVER (PARTITION BY ""e"".""exam_id"") AS ""minscore"" FROM ""Exam"" AS ""e"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""Student"" AS ""s"" LEFT JOIN (SELECT ""cte"".""student_id"" FROM ""CTE"" WHERE ""cte"".""score""=""cte"".""minscore"" OR ""cte"".""score""=""cte"".""maxscore"" GROUP BY ""cte"".""student_id"" ORDER BY ""cte"".""student_id"") AS ""t"" ON ""s"".""student_id""=""t"".""student_id"") LEFT JOIN (SELECT ""student_id"",COUNT(1) AS ""countstudent"" FROM ""Exam"" GROUP BY ""student_id"") AS ""c"" ON ""s"".""student_id""=""c"".""student_id"" WHERE ""t"".""student_id"" IS NULL AND ""c"".""countstudent"">=1"
304,"WITH ""cte"" AS (SELECT ""e"".""student_id"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""rnk"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""rnk1"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rnk""=1 OR ""rnk1""=1) ORDER BY ""Student_id"""
305,"WITH ""cte1"" AS (SELECT ""exam_id"",""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_exam_score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_exam_score"" FROM ""exam""), ""cte2"" AS (SELECT ""student_id"",SUM(CASE WHEN ""score"" IN (""min_exam_score"",""max_exam_score"") THEN 1 ELSE 0 END) AS ""nums"" FROM ""cte1"" GROUP BY ""student_id"") SELECT ""s"".""student_id"",""student_name"" FROM ""cte2"" JOIN ""student"" AS ""s"" ON ""cte2"".""student_id""=""s"".""student_id"" AND ""nums""=0"
306,"SELECT DISTINCT ""Student"".""student_id"",""student_name"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Student"".""student_id""=""Exam"".""student_id"" WHERE ""student_name"" NOT IN (SELECT ""student_name"" FROM (""Exam"" LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""top_score"",MIN(""score"") AS ""low_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""exam_records"" ON ""Exam"".""exam_id""=""exam_records"".""exam_id"") LEFT JOIN ""Student"" ON ""Student"".""student_id""=""Exam"".""student_id"" WHERE ""score""=""top_score"" OR ""score""=""low_score"") ORDER BY ""Student"".""student_id"""
307,"WITH ""t1"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""not_quiet"" AS (SELECT DISTINCT ""e"".""student_id"" AS ""student_id"" FROM ""Exam"" AS ""e"" JOIN ""t1"" ON ""e"".""exam_id""=""t1"".""exam_id"" WHERE ""e"".""score""=""max_score"" OR ""e"".""score""=""min_score"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" IN (SELECT ""e"".""student_id"" FROM ""Exam"" AS ""e"" LEFT JOIN ""not_quiet"" AS ""nq"" ON ""e"".""student_id""=""nq"".""student_id"" WHERE ""nq"".""student_id"" IS NULL)"
308,"WITH ""cte"" AS (SELECT ""e"".*,""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""RN_ASC"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""RN_DESC"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rn_asc""=1 OR ""rn_desc""=1) ORDER BY ""student_id"""
309,"WITH ""min_max_exam"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""student_min_max_marks"" AS (SELECT ""E"".""student_id"" FROM ""Exam"" AS ""E"" JOIN ""min_max_exam"" AS ""MME"" ON ""E"".""exam_id""=""MME"".""exam_id"" AND (""E"".""score""=""MME"".""min_score"" OR ""E"".""score""=""MME"".""max_score"")) SELECT DISTINCT ""S"".""student_id"",""S"".""student_name"" FROM ""Exam"" AS ""E"" JOIN ""Student"" AS ""S"" ON ""E"".""student_id""=""S"".""student_id"" WHERE ""E"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""student_min_max_marks"") ORDER BY ""S"".""student_id"""
310,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
311,"WITH ""CTE"" AS (SELECT ""e"".""student_id"",""s"".""student_name"",""e"".""exam_id"",DENSE_RANK() OVER (PARTITION BY ""EXAM_id"" ORDER BY ""score"") AS ""Minimum"",DENSE_RANK() OVER (PARTITION BY ""EXAM_id"" ORDER BY ""score"" DESC) AS ""Maximum"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""CTE"" WHERE ""student_id"" NOT IN (SELECT ""Student_id"" FROM ""CTE"" WHERE ""minimum""=1 OR ""maximum""=1) ORDER BY ""student_id"""
312,"SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""a"".""student_id"" FROM (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rankone"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rankn"" FROM ""Exam"") AS ""a"" WHERE ""a"".""rankone""=1 OR ""a"".""rankn""=1) AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"")"
313,"SELECT ""e"".""student_id"",""s"".""student_name"" FROM (""exam"" AS ""e"" JOIN ""student"" AS ""s"" USING (""student_id"")) JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id"") AS ""tmp"" ON ""e"".""exam_id""=""tmp"".""exam_id"" GROUP BY ""e"".""student_id"" HAVING SUM(CASE WHEN ""e"".""score""=""tmp"".""max_score"" THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""e"".""score""=""tmp"".""min_score"" THEN 1 ELSE 0 END)=0 ORDER BY 1"
314,"SELECT ""a"".""student_id"",""b"".""student_name"" FROM (""Exam"" AS ""a"" JOIN ""Student"" AS ""b"" USING (""student_id"")) LEFT JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""c"" ON ""a"".""score"">""c"".""min_score"" AND ""a"".""score""<""c"".""max_score"" AND ""a"".""exam_id""=""c"".""exam_id"" GROUP BY ""a"".""student_id"",""b"".""student_name"" HAVING COUNT(DISTINCT ""a"".""exam_id"")=COUNT(DISTINCT ""c"".""exam_id"") ORDER BY ""a"".""student_id"""
315,"SELECT DISTINCT ""student_id"",""student_name"" FROM (SELECT ""e"".""student_id"",""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""r1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""r2"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") AS ""a"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT ""e"".""student_id"",""student_name"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""r1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""r2"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") AS ""b"" WHERE ""r1""=1 OR ""r2""=1) ORDER BY ""student_id"""
316,"WITH ""ranks"" AS (SELECT ""exam_id"",""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"" FROM ""Exam""), ""ids"" AS (SELECT DISTINCT ""student_id"" FROM ""ranks"" WHERE ""max_score""=1 OR ""min_score""=1) SELECT ""student_id"",""student_name"" FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT * FROM ""ids"") AND ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""Exam"")"
317,"WITH ""max_s"" AS (SELECT ""exam_id"",MAX(""score"") AS ""mx"" FROM ""Exam"" GROUP BY ""exam_id""), ""min_s"" AS (SELECT ""exam_id"",MIN(""score"") AS ""mn"" FROM ""Exam"" GROUP BY ""exam_id""), ""not_quiet"" AS (SELECT DISTINCT ""e"".""student_id"" FROM (""Exam"" AS ""e"" LEFT JOIN ""max_s"" ON ""max_s"".""exam_id""=""e"".""exam_id"" AND ""max_s"".""mx""=""e"".""score"") LEFT JOIN ""min_s"" ON ""min_s"".""exam_id""=""e"".""exam_id"" AND ""min_s"".""mn""=""e"".""score"" WHERE ""max_s"".""mx"" IS NOT NULL OR ""min_s"".""mn"" IS NOT NULL) SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM (""Exam"" AS ""e"" LEFT JOIN ""not_quiet"" AS ""nq"" ON ""nq"".""student_id""=""e"".""student_id"") JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""nq"".""student_id"" IS NULL ORDER BY ""e"".""student_id"""
318,"SELECT ""st"".""student_id"",""st"".""student_name"" FROM (""exam"" AS ""et"" JOIN ""student"" AS ""st"" ON ""et"".""student_id""=""st"".""student_id"") JOIN (SELECT ""exam_id"",MAX(""score"") AS ""max_s"",MIN(""score"") AS ""min_s"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""et2"" ON ""et"".""exam_id""=""et2"".""exam_id"" GROUP BY ""et"".""student_id"" HAVING SUM(""et"".""score""=""et2"".""max_s"" OR ""et"".""score""=""et2"".""min_s"")=0 ORDER BY ""st"".""student_id"""
319,"SELECT DISTINCT (""S"".""student_id""),""S"".""student_name"" FROM ""Student"" AS ""S"" JOIN ""Exam"" AS ""E"" ON ""S"".""student_id""=""E"".""student_id"" WHERE ""S"".""student_id"" NOT IN (SELECT ""E1"".""student_id"" FROM ""Exam"" AS ""E1"" WHERE ""E1"".""score""=(SELECT MAX(""E11"".""score"") FROM ""Exam"" AS ""E11"" WHERE ""E11"".""exam_id""=""E1"".""exam_id"")) AND ""S"".""student_id"" NOT IN (SELECT ""E2"".""student_id"" FROM ""Exam"" AS ""E2"" WHERE ""E2"".""score""=(SELECT MIN(""E21"".""score"") FROM ""Exam"" AS ""E21"" WHERE ""E21"".""exam_id""=""E2"".""exam_id"")) ORDER BY ""S"".""student_id"""
320,"WITH ""result"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""result"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""result"" WHERE ""rnk1""=1 OR ""rnk2""=1) ORDER BY ""student_id"""
321,"WITH ""Exam_scores"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id"") SELECT ""s"".""student_id"",""s"".""student_name"" FROM (""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"") JOIN ""Exam_scores"" AS ""es"" ON ""e"".""exam_id""=""es"".""exam_id"" GROUP BY ""s"".""student_id"",""s"".""student_name"" HAVING SUM(CASE WHEN ""e"".""score""=""es"".""max_score"" OR ""e"".""score""=""es"".""min_score"" THEN 1 ELSE 0 END)=0 ORDER BY ""s"".""student_id"""
322,"SELECT ""b"".""student_id"",""student_name"" FROM (""student"") CROSS JOIN (SELECT ""student_id"",SUM(CASE WHEN ""score""<""maxscore"" AND ""score"">""minscore"" THEN 0 ELSE 1 END) AS ""quiet"" FROM ""Exam"" AS ""e"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""maxscore"",MIN(""score"") AS ""minscore"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""a"" ON ""e"".""exam_id""=""a"".""exam_id"" GROUP BY ""student_id"" HAVING ""quiet""=0) AS ""b"" WHERE ""student"".""student_id""=""b"".""student_id"""
323,"SELECT ""B"".""student_id"",""B"".""student_name"" FROM (SELECT ""A"".""exam_id"",""A"".""student_id"",""A"".""student_name"",(CASE WHEN ""A"".""score"" IN (""min_score"",""max_score"") THEN 1 ELSE 0 END) AS ""cnt"" FROM (SELECT ""exam_id"",""e"".""student_id"",""student_name"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") AS ""A"") AS ""B"" GROUP BY ""student_id"" HAVING SUM(""B"".""cnt"")=0 ORDER BY ""student_id"""
324,"WITH ""score_rank"" AS (SELECT ""exam_id"",""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""min_score"" FROM ""Exam"") SELECT DISTINCT ""r"".""student_id"",""s"".""student_name"" FROM ""score_rank"" AS ""r"" JOIN ""Student"" AS ""s"" ON ""r"".""student_id""=""s"".""student_id"" WHERE ""r"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""score_rank"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") ORDER BY ""r"".""student_id"""
325,"WITH ""exam_score"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min_score"",MAX(""score"") AS ""max_score"" FROM ""exam"" GROUP BY ""exam_id""), ""stud"" AS (SELECT ""student_id"" FROM ""exam"" JOIN ""exam_score"" ON ""exam"".""exam_id""=""exam_score"".""exam_id"" AND ""exam"".""score""=""exam_score"".""max_score"" UNION SELECT ""student_id"" FROM ""exam"" JOIN ""exam_score"" ON ""exam"".""exam_id""=""exam_score"".""exam_id"" AND ""exam"".""score""=""exam_score"".""min_score"") SELECT ""student_id"",""student_name"" FROM ""student"" AS ""s"" WHERE ""student_id"" IN (SELECT DISTINCT ""student_id"" FROM ""exam"") AND ""student_id"" NOT IN (SELECT DISTINCT ""student_id"" FROM ""stud"") ORDER BY ""student_id"""
326,"SELECT ""s"".""student_id"",""s"".""student_name"" FROM (SELECT ""exam_id"",""student_id"",""score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"",FIRST_VALUE(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"" FROM ""Exam"") AS ""t"" JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""t"".""student_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""t"".""score""=""min_score"" THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""t"".""score""=""max_score"" THEN 1 ELSE 0 END)=0 ORDER BY 1"
327,"WITH ""cte"" AS (SELECT ""exam_id"",""e"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
328,"WITH ""main"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rank_asc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rank_desc"" FROM ""exam"") SELECT * FROM ""student"" WHERE ""student_id"" IN (SELECT ""student_id"" FROM ""main"" GROUP BY ""student_id"" HAVING MIN(""rank_asc"")>1 AND MIN(""rank_desc"")>1) ORDER BY ""student_id"""
329,"WITH ""a"" AS (SELECT ""student_id"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""Exam""), ""b"" AS (SELECT ""student_id"",COUNT(1) AS ""attend"",SUM(CASE WHEN ""rk1""=1 OR ""rk2""=1 THEN 0 ELSE 1 END) AS ""quiet_score"" FROM ""a"" GROUP BY ""student_id""), ""c"" AS (SELECT ""Student"".""student_id"",""Student"".""student_name"",""b"".""quiet_score"",""b"".""attend"" FROM ""Student"" JOIN ""b"" ON ""b"".""student_id""=""Student"".""student_id"") SELECT ""student_id"",""student_name"" FROM ""c"" WHERE ""quiet_score""=""attend"" ORDER BY ""student_id"""
330,"WITH ""cte"" AS (SELECT DISTINCT ""student_id"" FROM (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk_asc"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk_desc"" FROM ""Exam"") AS ""s"" WHERE ""rk_asc""=1 OR ""rk_desc""=1) SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" ON ""s"".""student_id""=""e"".""student_id"" WHERE ""s"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"") ORDER BY 1"
331,"WITH ""t1"" AS (SELECT ""student_id"" FROM (SELECT ""student_id"",""score"",MAX(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""max_score"" FROM ""Exam"") AS ""tmp"" WHERE ""score""=""max_score"" UNION SELECT ""student_id"" FROM (SELECT ""student_id"",""score"",MIN(""score"") OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""min_score"" FROM ""Exam"") AS ""tmp"" WHERE ""score""=""min_score"") SELECT DISTINCT ""e"".""student_id"",""s"".""student_name"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT * FROM ""t1"") ORDER BY ""e"".""student_id"""
332,"WITH ""ranked"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""top_rank"",DENSE_RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""bottom_rank"" FROM ""exam""), ""quiet_only"" AS (SELECT ""exam_id"",""student_id"" FROM ""ranked"" WHERE ""top_rank""!=1 AND ""bottom_rank""!=1), ""grouped"" AS (SELECT ""student_id"",COUNT(DISTINCT ""exam_id"") AS ""total_exams"" FROM ""ranked"" GROUP BY ""student_id""), ""quiet_group"" AS (SELECT ""student_id"",COUNT(DISTINCT ""exam_id"") AS ""quiet_exams"" FROM ""quiet_only"" GROUP BY ""student_id"") SELECT ""grouped"".""student_id"",""student_name"" FROM (""grouped"" LEFT JOIN ""student"" ON ""grouped"".""student_id""=""student"".""student_id"") LEFT JOIN ""quiet_group"" ON ""grouped"".""student_id""=""quiet_group"".""student_id"" WHERE ""total_exams""=""quiet_exams"" ORDER BY ""student_id"""
333,"WITH ""t"" AS (SELECT ""exam_id"",""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""asc_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""desc_score"" FROM ""Exam"") SELECT DISTINCT ""t"".""student_id"",""student_name"" FROM ""t"" JOIN ""Student"" AS ""s"" ON ""t"".""student_id""=""s"".""student_id"" WHERE ""t"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""t"" WHERE ""asc_score""=1 OR ""desc_score""=1)"
334,"WITH ""cte"" AS (SELECT ""exam_id"",""exam"".""student_id"",""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rk1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk2"" FROM ""exam"" LEFT JOIN ""student"" ON ""exam"".""student_id""=""student"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""rk1""=1 OR ""rk2""=1) ORDER BY ""student_id"""
335,"WITH ""cte1"" AS (SELECT ""exam_id"",MIN(""score"") AS ""min1"",MAX(""score"") AS ""max1"" FROM ""exam"" GROUP BY ""exam_id""), ""cte2"" AS (SELECT DISTINCT ""student_id"" FROM ""exam"" AS ""e"" JOIN ""cte1"" AS ""c"" ON ""e"".""exam_id""=""c"".""exam_id"" WHERE ""score""=""max1"" OR ""score""=""min1""), ""cte3"" AS (SELECT ""e"".""exam_id"",""student_id"",""score"" FROM ""exam"" AS ""e"" JOIN ""cte1"" AS ""c"" ON ""e"".""exam_id""=""c"".""exam_id"" WHERE ""score""<""max1"" AND ""score"">""min1"") SELECT DISTINCT ""c"".""student_id"",""student_name"" FROM ""cte3"" AS ""c"" LEFT JOIN ""student"" AS ""s"" ON ""c"".""student_id""=""s"".""student_id"" WHERE ""c"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte2"") ORDER BY ""c"".""student_id"""
336,"WITH ""x"" AS (SELECT ""e"".""student_id"",""e"".""exam_id"",""e"".""score"",""s"".""student_name"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"" DESC) AS ""rnk_desc"",DENSE_RANK() OVER (PARTITION BY ""e"".""exam_id"" ORDER BY ""e"".""score"") AS ""rnk_asc"" FROM ""Exam"" AS ""e"" LEFT JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" GROUP BY ""student_id"",""exam_id"",""score"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""x"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""x"" WHERE ""rnk_desc""=1 OR ""rnk_asc""=1) ORDER BY ""student_id"""
337,"WITH ""CTE"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" WHERE ROW(""exam_id"",""score"") IN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"" UNION SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"")) SELECT DISTINCT ""Exam"".""student_id"",""student_name"" FROM ""Exam"" JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""CTE"") ORDER BY ""Exam"".""student_id"""
338,"WITH ""cte"" AS (SELECT ""exam_id"",""e"".""student_id"",""student_name"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""low_score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""high_score"" FROM ""exam"" AS ""e"" LEFT JOIN ""student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""cte"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte"" WHERE ""low_score""=1 OR ""high_score""=1) ORDER BY ""student_id"""
339,"WITH ""temp"" AS (SELECT ""student_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""ranka"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rankb"" FROM ""Exam"") SELECT ""Student"".""student_id"",""Student"".""student_name"" FROM ""Student"" WHERE ""Student"".""student_id"" NOT IN (SELECT ""temp"".""student_id"" FROM ""temp"" WHERE ""ranka""=1 OR ""rankb""=1) AND ""Student"".""student_id"" IN (SELECT ""Student"".""student_id"" FROM ""Student"" JOIN ""Exam"" ON ""Student"".""student_id""=""Exam"".""student_id"")"
340,"WITH ""temp"" AS (SELECT ""student_id"",""exam_id"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rnum_hi"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""rnum_low"" FROM ""exam""), ""hi_lo_stu"" AS (SELECT DISTINCT ""student_id"" FROM ""temp"" WHERE ""rnum_hi""=1 OR ""rnum_low""=1) SELECT DISTINCT ""e"".""student_id"" AS ""STUDENT_ID"",""s"".""student_name"" AS ""STUDENT_NAME"" FROM ""exam"" AS ""e"" JOIN ""student"" AS ""s"" ON ""s"".""student_id""=""e"".""student_id"" WHERE NOT EXISTS (SELECT * FROM ""hi_lo_stu"" WHERE ""hi_lo_stu"".""student_id""=""e"".""student_id"") ORDER BY 1"
341,"WITH ""cte"" AS (SELECT ""exam_id"",MAX(""score"") AS ""max_score"",MIN(""score"") AS ""min_score"" FROM ""Exam"" GROUP BY ""exam_id""), ""cte1"" AS (SELECT DISTINCT ""student_id"" FROM ""Exam"" AS ""e"" CROSS JOIN ""cte"" WHERE ""e"".""exam_id""=""cte"".""exam_id"" AND (""score""=""min_score"" OR ""score""=""max_score"")) SELECT DISTINCT ""e"".""student_id"",""student_name"" FROM ""Exam"" AS ""e"" JOIN ""Student"" AS ""s"" ON ""e"".""student_id""=""s"".""student_id"" WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""cte1"") ORDER BY ""e"".""student_id"""
342,"SELECT DISTINCT ""s"".* FROM ""Student"" AS ""s"" JOIN ""Exam"" AS ""e"" USING (""student_id"") WHERE ""e"".""student_id"" NOT IN (SELECT ""student_id"" FROM (SELECT *,MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""max_score"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""min_score"" FROM ""Exam"") AS ""temp"" WHERE ""score""=""max_score"" OR ""score""=""min_score"") ORDER BY ""student_id"""
343,"WITH ""CTE"" AS (SELECT ""E"".""student_id"",""E"".""exam_id"",""S"".""student_name"",""score"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"") AS ""R1"",RANK() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""R2"" FROM ""Exam"" AS ""E"" LEFT JOIN ""Student"" AS ""S"" ON ""E"".""student_id""=""S"".""student_id"") SELECT DISTINCT ""student_id"",""student_name"" FROM ""CTE"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""CTE"" WHERE ""R1""=1 OR ""R2""=1) ORDER BY ""student_id"""
344,"SELECT ""student_id"",""student_name"" FROM ""student"" AS ""x"" JOIN (SELECT ""student_id"" AS ""id"",SUM(CASE WHEN ""score""=""maxscore"" OR ""score""=""minscore"" THEN 1 ELSE 0 END) AS ""test"" FROM (SELECT ""exam_id"",""student_id"",""score"",ROW_NUMBER() OVER (PARTITION BY ""exam_id"" ORDER BY ""score"" DESC) AS ""rk"",COUNT(""student_id"") OVER (PARTITION BY ""exam_id"") AS ""cnt"",MAX(""score"") OVER (PARTITION BY ""exam_id"") AS ""maxscore"",MIN(""score"") OVER (PARTITION BY ""exam_id"") AS ""minscore"" FROM ""exam"") AS ""a"" GROUP BY ""student_id"") AS ""b"" ON ""x"".""student_id""=""b"".""id"" WHERE ""b"".""test""=0"
345,"WITH ""highest_lowest"" AS (SELECT ""exam_id"",MAX(""score"") AS ""mx_score"",MIN(""score"") AS ""mn_score"" FROM ""Exam"" AS ""e"" GROUP BY ""exam_id""), ""quiet_students"" AS (SELECT ""student_id"",SUM(""score""=""hl"".""mn_score"" OR ""score""=""hl"".""mx_score"") OVER (PARTITION BY ""student_id"") AS ""sm"" FROM ""Exam"" AS ""e"" JOIN ""highest_lowest"" AS ""hl"" ON ""e"".""exam_id""=""hl"".""exam_id""), ""mx"" AS (SELECT DISTINCT ""s"".""student_id"",""s"".""student_name"" FROM ""quiet_students"" AS ""q"" JOIN ""Student"" AS ""s"" ON ""s"".""student_id""=""q"".""student_id"" WHERE ""sm""=0 ORDER BY 1) SELECT * FROM ""mx"""
346,"SELECT DISTINCT ""Exam"".""student_id"",""student_name"" FROM ""Exam"" LEFT JOIN ""Student"" ON ""Exam"".""student_id""=""Student"".""student_id"" WHERE ""Exam"".""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""e"" LEFT JOIN (SELECT ""exam_id"",MIN(""score"") AS ""min_s"",MAX(""score"") AS ""max_s"" FROM ""Exam"" GROUP BY 1) AS ""t"" ON ""e"".""exam_id""=""t"".""exam_id"" WHERE ""e"".""score""=""min_s"" OR ""e"".""score""=""max_s"") ORDER BY 1"
347,"SELECT * FROM ""Student"" WHERE ""student_id"" NOT IN (SELECT ""student_id"" FROM ""Exam"" AS ""t1"" JOIN (SELECT ""exam_id"",MAX(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t2"" ON ""t1"".""exam_id""=""t2"".""exam_id"" WHERE ""t1"".""score""=""t2"".""score"" UNION SELECT ""student_id"" FROM ""Exam"" AS ""t1"" JOIN (SELECT ""exam_id"",MIN(""score"") AS ""score"" FROM ""Exam"" GROUP BY ""exam_id"") AS ""t2"" ON ""t1"".""exam_id""=""t2"".""exam_id"" WHERE ""t1"".""score""=""t2"".""score"") AND ""student_id"" IN (SELECT DISTINCT (""student_id"") FROM ""Exam"")"
348,"SELECT DISTINCT (""S"".""student_id""),""S"".""student_name"" FROM ""Student"" AS ""S"" JOIN ""Exam"" AS ""E"" ON ""S"".""student_id""=""E"".""student_id"" WHERE ""S"".""student_id"" NOT IN (SELECT ""E1"".""student_id"" FROM ""Exam"" AS ""E1"" WHERE ""E1"".""score""=(SELECT MAX(""E11"".""score"") FROM ""Exam"" AS ""E11"" WHERE ""E11"".""exam_id""=""E1"".""exam_id"")) AND ""S"".""student_id"" NOT IN (SELECT ""E2"".""student_id"" FROM ""Exam"" AS ""E2"" WHERE ""E2"".""score""=(SELECT MIN(""E21"".""score"") FROM ""Exam"" AS ""E21"" WHERE ""E21"".""exam_id""=""E2"".""exam_id"")) ORDER BY ""S"".""student_id"""
