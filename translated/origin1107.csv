id,original query
1,"WITH ""tmp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""tmp"" WHERE ""login_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""login_date"" HAVING ""user_count"">0"
2,"WITH ""t1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""t1"" WHERE ""rnk""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"" ORDER BY ""activity_date"""
3,"WITH ""first_login"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""first_login"" WHERE ""activity_date"">CAST('2019-06-30' AS DATE) + INTERVAL '-91 DAY' GROUP BY ""activity_date"""
4,"SELECT ""first_login_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ""first_login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""first_login_date""<='2019-06-30' GROUP BY ""first_login_date"""
5,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM (SELECT * FROM ""traffic"" WHERE ""activity""='login') AS ""cte"" GROUP BY ""user_id"") AS ""cte2"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
6,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""temp"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
7,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"",""activity_date"" FROM ""Traffic"" WHERE ""activity""='login') AS ""T"" WHERE ""rnk""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
8,"SELECT ""firstlogin"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""firstlogin"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING ""firstlogin"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') AS ""a"" GROUP BY ""firstlogin"" ORDER BY 1"
9,"WITH ""cte"" AS (SELECT DISTINCT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""login_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""login_date"" ORDER BY 1"
10,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
11,"SELECT ""mindate"" AS ""login_date"",COUNT(""x"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""mindate"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""x"" WHERE CAST('2019-06-30' AS DATE) - ""mindate""<=90 GROUP BY ""mindate"""
12,"SELECT ""temp"".""first_login"" AS ""login_date"",COUNT(""temp"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"",""activity"") AS ""temp"" WHERE ""temp"".""first_login"" BETWEEN '2019-04-01' AND '2019-09-30' GROUP BY ""temp"".""first_login"""
13,"SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""t"".""first_login"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND CAST('2019-06-30' AS DATE) GROUP BY ""first_login"" ORDER BY ""first_login"""
14,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""temp"" GROUP BY ""login_date"" HAVING ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY'"
15,"WITH ""CTE1"" AS (SELECT DISTINCT ""user_id"",""activity"",""activity_date"" FROM ""Traffic"" WHERE ""activity""='login'), ""CTE2"" AS (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rks"" FROM ""CTE1"") SELECT ""activity_date"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM ""CTE2"" WHERE ""rks""=1 AND ""activity_date""<='2019-06-30' AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
16,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""rk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"" ORDER BY ""login_date"""
17,"SELECT ""new"".""login_date"",COUNT(""User_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""new"" WHERE ""new"".""login_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""new"".""login_date"""
18,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""A"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
19,"WITH ""main"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",SUM(CASE WHEN CAST('2019-06-30' AS DATE) - ""login_date""<=90 THEN 1 ELSE 0 END) AS ""user_count"" FROM ""main"" GROUP BY ""login_date"" HAVING ""user_count"">0"
20,"WITH ""tmp"" AS (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""tmp"" WHERE ""rnk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"""
21,"WITH ""table1"" AS (SELECT ""user_id"",""activity"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""table1"" WHERE ""rn""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""login_date"""
22,"SELECT DISTINCT ""a"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""rnk""=1 AND ""a"".""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""a"".""activity_date"""
23,"SELECT ""t"".""activity_date"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT DISTINCT ""user_id"",""activity"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""Rank"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""t"".""Rank""=1 AND ""t"".""activity_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""t"".""activity_date"""
24,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""temp"" GROUP BY 1 HAVING CAST('2019-06-30' AS DATE) - ""login_date""<=90"
25,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM (SELECT * FROM ""traffic"" WHERE ""activity""='login') AS ""y"") AS ""z"" WHERE ""rn""=1 AND ""activity_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""activity_date"""
26,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
27,"SELECT ""temp"".""first_login"" AS ""login_date"",COUNT(""temp"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"",""activity"") AS ""temp"" WHERE ""temp"".""first_login"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND CAST('2019-06-30' AS DATE) + INTERVAL '90 DAY' GROUP BY ""temp"".""first_login"""
28,"WITH ""HI"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""frist"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""frist"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""HI"" WHERE CAST('2019-06-30' AS DATE) - ""frist""<=90 GROUP BY ""frist"""
29,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') AS ""m"" WHERE ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""rnk""=1 GROUP BY 1"
30,"WITH ""temp"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""r"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" AS ""t"" WHERE ""r""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
31,"WITH ""table1"" AS (SELECT ""user_id"",""activity"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""table1"" WHERE ""rn""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""login_date"""
32,"SELECT ""mind"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""mind"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"")>='2019-04-01') AS ""T"" GROUP BY ""mind"""
33,"WITH ""first_login"" AS (SELECT ""user_id"",""activity_date"" AS ""login_date"" FROM (SELECT ""user_id"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') AS ""z"" WHERE ""rnk""=1) SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""first_login"" WHERE ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""login_date"" ORDER BY ""login_date"""
34,"SELECT ""first_log"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_log"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""first_log""<=90 GROUP BY ""login_date"""
35,"WITH ""cte"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") OVER (PARTITION BY ""user_id"", ""activity"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='Login') SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" GROUP BY ""login_date"" HAVING ""login_date"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY'"
36,"WITH ""First_login"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_time"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_time"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM ""First_login"" WHERE ""first_time"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""first_time"""
37,"SELECT ""mind"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""mind"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"")>='2019-04-01') AS ""T"" GROUP BY ""mind"""
38,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" AS ""t"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""tmp"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
39,"WITH ""t1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""t1"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
40,"SELECT ""t"".""activity_date"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT DISTINCT ""user_id"",""activity"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""Rank"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""t"".""Rank""=1 AND ""t"".""activity_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""t"".""activity_date"" ORDER BY ""t"".""activity_date"""
41,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""x"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
42,"SELECT ""T"".""login_date"",COUNT(DISTINCT ""T"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""T"" WHERE CAST('2019-06-30' AS DATE) - ""T"".""login_date""<=90 GROUP BY ""T"".""login_date"""
43,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ABS(""login_date"" - CAST('2019-06-30' AS DATE)) BETWEEN 0 AND 90 GROUP BY ""login_date"""
44,"SELECT ""f_log"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""f_log"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING ""f_log"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY') AS ""temp"" GROUP BY ""login_date"""
45,"SELECT ""req_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""req_date"" FROM ""traffic"" AS ""t"" WHERE ""activity""='login' GROUP BY 1 HAVING ""req_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30') AS ""agg"" GROUP BY 1"
46,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - ""login_date""<=90) AS ""t"" GROUP BY ""login_date"" ORDER BY ""login_date"""
47,"WITH ""t"" AS (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 2 HAVING ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM ""t"" GROUP BY 1"
48,"WITH ""win"" AS (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""win"" WHERE ""rk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1"
49,"SELECT ""a"".""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM (SELECT DISTINCT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1 HAVING CAST('2019-06-30' AS DATE) - ""login_date""<=90) AS ""a"" GROUP BY 1"
50,"WITH ""first"" AS (SELECT ""user_id"",COALESCE(MIN(""activity_date""), 0) AS ""logi"" FROM ""Traffic"" WHERE ""activity""='login' AND ""activity_date"">CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY 1) SELECT ""logi"" AS ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM ""first"" WHERE CAST('2019-06-30' AS DATE) - ""logi""<=90 GROUP BY 1 ORDER BY 1"
51,"WITH ""first_login"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM ""first_login"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
52,"WITH ""cte1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1), ""cte2"" AS (SELECT * FROM ""cte1"" WHERE CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY'<=""login_date"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte2"" GROUP BY 1"
53,"SELECT ""a"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM ""traffic"" AS ""a"" JOIN (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""b"" ON ""a"".""activity_date""=""b"".""first_login_date"" AND ""a"".""user_id""=""b"".""user_id"" WHERE ""a"".""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1 ORDER BY 1"
54,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') AS ""tmp"" WHERE ""rnk""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
55,"SELECT ""a"".""date"" AS ""login_date"",COUNT(""a"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - MIN(""activity_date"")<=90) AS ""a"" GROUP BY ""a"".""date"""
56,"WITH ""new"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""new"".""first_login_date"" AS ""login_date"",COUNT(""new"".""user_id"") AS ""user_count"" FROM ""new"" GROUP BY ""new"".""first_login_date"" HAVING CAST('2019-06-30' AS DATE) - ""new"".""first_login_date""<=90"
57,"SELECT ""temp"".""first_login_date"" AS ""login_date"",COUNT(DISTINCT ""temp"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1 HAVING MIN(""activity_date"")>=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND MIN(""activity_date"")<='2019-06-30') AS ""temp"" GROUP BY 1"
58,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND CAST('2019-06-30' AS DATE) + INTERVAL '90 DAY' GROUP BY ""activity_date"""
59,"SELECT ""earlest_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT DISTINCT ""user_id"",MIN(""activity_date"") AS ""earlest_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" ORDER BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""earlest_date""<=90 GROUP BY 1 ORDER BY 1"
60,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
61,"SELECT ""activity_Date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""traffic"" WHERE ""activity""='login' ORDER BY ""user_id"") AS ""a"" WHERE ""rn""=1 AND (""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30') GROUP BY ""activity_date"""
62,"WITH ""a"" AS (SELECT MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM ""a"" WHERE ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1 HAVING ""user_count"">0"
63,"WITH ""hi"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""hi"" WHERE CAST('2019-06-30' AS DATE) - ""first_login""<=90 GROUP BY ""first_login"""
64,"WITH ""table1"" AS (SELECT ""user_id"",""activity"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""table1"" WHERE ""rn""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""login_date"""
65,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 2) AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1"
66,"SELECT ""login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login"" FROM (SELECT * FROM ""Traffic"" WHERE ""activity""='login') AS ""temp"" GROUP BY ""user_id"") AS ""temp"" GROUP BY ""login"" HAVING CAST('2019-06-30' AS DATE) - ""login""<=90"
67,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""rnk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"" ORDER BY ""activity_date"""
68,"SELECT ""user_login_details"".""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""user_login_details"" WHERE ""user_login_details"".""login_date"" - CAST('2019-06-30' AS DATE) BETWEEN -90 AND 0 GROUP BY ""user_login_details"".""login_date"""
69,"SELECT ""a"".""first_login"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""a"".""first_login""<=90 GROUP BY 1 ORDER BY 1"
70,"SELECT ""firstday"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""firstday"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""firstday""<=90 GROUP BY ""firstday"""
71,"SELECT ""ACTIVITY_DATE"" AS ""LOGIN_DATE"",COUNT(DISTINCT ""USER_ID"") AS ""USER_COUNT"" FROM (SELECT ""USER_ID"",""ACTIVITY_DATE"",ROW_NUMBER() OVER (PARTITION BY ""USER_ID"" ORDER BY ""ACTIVITY_DATE"") AS ""NM"" FROM ""TRAFFIC"" WHERE ""ACTIVITY""='login') AS ""X"" WHERE ""NM""=1 AND ""ACTIVITY_DATE"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""ACTIVITY_DATE"""
72,"SELECT ""T1"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""first_login"".""user_id"") AS ""user_count"" FROM ""Traffic"" AS ""T1"" LEFT JOIN (SELECT MIN(""activity_date"") AS ""first_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""first_login"" ON ""first_login"".""user_id""=""T1"".""user_id"" AND ""first_login"".""first_date""=""T1"".""activity_date"" GROUP BY ""T1"".""activity_date"" HAVING CAST('2019-06-30' AS DATE) - ""T1"".""activity_date""<=90 AND COUNT(DISTINCT ""first_login"".""user_id"")>0"
73,"WITH ""t1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' AND ""activity_date"" GROUP BY 1 HAVING ""first_login"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') SELECT ""first_login"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""t1"" GROUP BY 1"
74,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",MIN(""activity_date"") OVER (PARTITION BY ""user_id"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login') AS ""sub"" WHERE ""first_login""=""activity_date"" AND ""activity_date"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY ""activity_date"""
75,"SELECT ""a"".""date"" AS ""login_date"",COUNT(""a"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - MIN(""activity_date"")<=90) AS ""a"" GROUP BY ""a"".""date"""
76,"SELECT ""date_min"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""date_min"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""sub"" WHERE CAST('2019-06-30' AS DATE) - ""date_min""<=90 GROUP BY ""sub"".""date_min"""
77,"SELECT ""mindate"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""mindate"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""mindate""<=90 GROUP BY ""mindate"""
78,"WITH ""t"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
79,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""t"".""login_date""<=90 GROUP BY ""t"".""login_date"""
80,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
81,"WITH ""cte"" AS (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""rnk""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""login_date"""
82,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
83,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
84,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 AND ""rk""=1 GROUP BY ""activity_date"" ORDER BY ""activity_date"""
85,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
86,"WITH ""logins_only"" AS (SELECT DISTINCT ""user_id"",""activity"",""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' ORDER BY ""activity_date""), ""f_logins"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""f_login"" FROM ""logins_only"" GROUP BY ""user_id"") SELECT ""f_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""f_logins"" WHERE ""f_login"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY ""f_login"""
87,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""t"".""activity_date"") AS ""login_date"",""t"".""user_id"" FROM ""Traffic"" AS ""t"" WHERE ""activity"" LIKE 'login' GROUP BY ""t"".""user_id"") AS ""t1"" WHERE ""t1"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
88,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""firstlogin"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
89,"WITH ""T1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""T1"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
90,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
91,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" WHERE CAST('2019-06-30' AS DATE) - ""first_date""<=90 GROUP BY 1"
92,"SELECT ""qry"".""mad"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""mad"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""qry"" WHERE ""qry"".""mad""<='2019-06-30' AND ""qry"".""mad"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY ""qry"".""mad"""
93,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""first_date""<=90 GROUP BY ""first_date"""
94,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""Traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""rn""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
95,"SELECT ""mindate"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""mindate"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""mindate""<=90 GROUP BY 1"
96,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT CASE WHEN ""activity""='login' THEN ""user_id"" ELSE NULL END) AS ""user_count"" FROM (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""traffic"" WHERE ""activity""='login') AS ""temp"" WHERE ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' AND ""rn""=1 GROUP BY 1"
97,"WITH ""t1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"")>=(CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY')) SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""t1"" GROUP BY ""login_date"" ORDER BY ""login_date"""
98,"SELECT ""first_login"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,MIN(""activity_date"") OVER (PARTITION BY ""user_id"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login') AS ""tb1"" WHERE CAST('2019-06-30' AS DATE) - ""first_login""<=90 AND ""activity""='login' GROUP BY ""first_login"""
99,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""traffic"" WHERE ""activity""='login') AS ""A"" WHERE ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' AND ""rk""=1 GROUP BY ""activity_date"""
100,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""t"" WHERE ""login_date"" BETWEEN STR_TO_DATE('2019-06-30', '%Y-%m-%d') - INTERVAL '90 DAY' AND STR_TO_DATE('2019-06-30', '%Y-%m-%d') GROUP BY 1 ORDER BY 1"
101,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30') AS ""aaa"" GROUP BY ""login_date"""
102,"WITH ""temp"" AS (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" WHERE ""rk""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
103,"WITH ""r"" AS (SELECT * FROM ""Traffic"" WHERE ""activity""='login') SELECT ""r2"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""r"".""user_id"",""r"".""activity_date"",RANK() OVER (PARTITION BY ""r"".""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""r"") AS ""r2"" WHERE ""r2"".""rk""=1 AND ""r2"".""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1 ORDER BY 1"
104,"WITH ""cte_firstlogin"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""t"".""user_id"") AS ""user_count"" FROM ""traffic"" AS ""t"" LEFT JOIN ""cte_firstlogin"" AS ""fl"" ON ""t"".""user_id""=""fl"".""user_id"" WHERE (""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') AND ""t"".""activity_date""=""fl"".""first_login"" GROUP BY 1"
105,"WITH ""logindate"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""mdate"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""mdate"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""logindate"" WHERE CAST('2019-06-30' AS DATE) - ""mdate""<=90 GROUP BY 1"
106,"SELECT ""dates"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""dates"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""asd"" WHERE ""dates"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""dates"""
107,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""t1"" WHERE ABS(""t1"".""login_date"" - CAST('2019-06-30' AS DATE)) BETWEEN 0 AND 90 GROUP BY 1"
108,"WITH ""firstlogin"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM ""firstlogin"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
109,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""my_rank"" FROM ""Traffic"" WHERE ""activity""='login'), ""cte2"" AS (SELECT ""user_id"",""activity_date"" FROM ""cte"" WHERE ""my_rank""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte2"" GROUP BY ""activity_date"""
110,"WITH ""rank_user"" AS (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""login_time"" FROM ""Traffic"" WHERE ""activity""='login'), ""first_login"" AS (SELECT * FROM ""rank_user"" WHERE ""login_time""=1) SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""first_login"" WHERE ""activity_date"">='2019-04-01' GROUP BY 1 HAVING ""user_count"">0"
111,"SELECT DISTINCT ""a"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""b"".""user_id"") AS ""user_count"" FROM (SELECT DISTINCT ""a"".""activity_date"" FROM ""traffic"" AS ""a"" WHERE ""a"".""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') AS ""a"" JOIN (SELECT DISTINCT ""a"".""user_id"",MIN(""a"".""activity_date"") AS ""min_date"" FROM ""traffic"" AS ""a"" WHERE ""a"".""activity""='login' GROUP BY ""a"".""user_id"") AS ""b"" ON ""a"".""activity_date""=""b"".""min_date"" GROUP BY ""login_date"""
112,"WITH ""min_login"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""min_login"" FROM ""Traffic"" WHERE TRUE AND ""activity""='login' GROUP BY ""user_id"") SELECT ""min_login"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""min_login"" WHERE TRUE AND ""min_login"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
113,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
114,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""ranking"" FROM ""Traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""ranking""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
115,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""cte"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1"
116,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
117,"WITH ""rnktable"" AS (SELECT ""user_id"",""activity"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""rnktable"" WHERE ""rnk""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND CAST('2019-06-30' AS DATE) + INTERVAL '90 DAY' GROUP BY 1"
118,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
119,"SELECT ""mindate"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""mindate"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""mindate""<=90 GROUP BY ""mindate"""
120,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""t"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""t"".""login_date"""
121,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""b"".""first_login"" AS ""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM ""Traffic"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""activity_date""=""b"".""first_login"" WHERE CAST('2019-06-30' AS DATE) - ""a"".""activity_date""<=90 AND ""a"".""activity""='login' GROUP BY ""a"".""activity_date"""
122,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""t"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
123,"WITH ""S0"" AS (SELECT DISTINCT (""user_id"") AS ""user_id"" FROM ""Traffic"" WHERE ""activity_date""<CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""activity""='login'), ""S1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""user_id"" NOT IN (SELECT ""user_id"" FROM ""S0"") GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""S1"" GROUP BY ""activity_date"" ORDER BY ""login_date"""
124,"WITH ""t1"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING ""first_login"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""t1"" GROUP BY ""login_date"" ORDER BY ""login_date"""
125,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" GROUP BY 1 HAVING CAST('2019-06-30' AS DATE) - ""login_date""<=90"
126,"SELECT * FROM (SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" GROUP BY ""activity_date"") AS ""S"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90"
127,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""login_date"" - CAST('2019-06-30' AS DATE) BETWEEN -90 AND 90 GROUP BY ""login_date"""
128,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
129,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1"
130,"WITH ""t1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1 HAVING ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""t1"" GROUP BY 1"
131,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') AS ""x"" WHERE ""rnk""=1 AND ""activity_date""<='2019-06-30' AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1 ORDER BY 1"
132,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
133,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
134,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
135,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""temp"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
136,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnum"" FROM ""Traffic"" WHERE ""activity""='login') AS ""tbl"" WHERE ""activity_date"" BETWEEN '2019-04-01' AND '2019-06-30' AND ""rnum""=1 GROUP BY 1 ORDER BY 1"
137,"WITH ""t"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""1st_d"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""1st_d"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM ""t"" GROUP BY ""1st_d"" HAVING ""1st_d"" BETWEEN (CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') AND '2019-06-30'"
138,"SELECT ""t1"".""login_date"",COUNT(""t1"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""t1"" WHERE ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1"
139,"WITH ""t1"" AS (SELECT ""activity_date"",""user_id"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""login_rank"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM ""t1"" WHERE ""login_rank""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"" ORDER BY ""activity_date"""
140,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""temp"" GROUP BY ""login_date"" HAVING ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY'"
141,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""f"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1"
142,"WITH ""temp"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""login"" FROM (SELECT * FROM ""traffic"" WHERE ""activity""='login') AS ""t"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" WHERE ""login""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
143,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""tab"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
144,"WITH ""first_login"" AS (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""date_rank"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1,2) SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""first_login"" WHERE ""date_rank""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY 1"
145,"WITH ""A"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""A"" WHERE CAST('2019-06-30' AS DATE) - ""first_login""<=90 GROUP BY 1"
146,"WITH ""cte"" AS (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""cte"".""rnk""=1 AND CAST('2019_06_30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"" ORDER BY ""activity_date"""
147,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE TIMESTAMPDIFF(DAY, ""login_date"", '2019-06-30')<=90 GROUP BY ""login_date"""
148,"SELECT ""date"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT *,MIN(""activity_date"") AS ""date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""date"">=(CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') GROUP BY 1 ORDER BY 1"
149,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""A"" WHERE ABS(TIMESTAMPDIFF(DAY, '2019-06-30', ""login_date""))<=90 GROUP BY ""login_date"""
150,"WITH ""FirstLogin"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""1stLogin"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""1stLogin"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""FirstLogin"" WHERE ""1stLogin"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""1stLogin"""
151,"WITH ""c"" AS (SELECT ""user_id"",""activity"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""login_rn"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""c"" WHERE ""login_rn""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"""
152,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" AS ""t"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t1"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"" ORDER BY ""activity_date"""
153,"WITH ""firstlogin"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""firstlogin"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
154,"SELECT ""t"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""t"".""user_id"") AS ""user_count"" FROM (SELECT ""activity_date"",""user_id"",""activity"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""t"".""activity_date""<=90 AND ""rnk""=1 GROUP BY ""login_date"" ORDER BY ""login_date"""
155,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
156,"SELECT ""user_login_details"".""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""user_login_details"" WHERE ""user_login_details"".""login_date"" - CAST('2019-06-30' AS DATE) BETWEEN -90 AND 0 GROUP BY ""user_login_details"".""login_date"""
157,"WITH ""cte"" AS (SELECT ""user_id"",""activity"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""rn""=1 GROUP BY 1"
158,"WITH ""TEMP"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""firstlogin"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""firstlogin"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""firstlogin"" FROM ""TEMP"" WHERE ""firstlogin"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30') AS ""b"" GROUP BY 1 ORDER BY 1"
159,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login') AS ""x"" WHERE ""first_login""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY ""activity_date"""
160,"WITH ""cte"" AS (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""r"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""r""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
161,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") OVER (PARTITION BY ""user_id"", ""activity"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" GROUP BY ""login_date"" HAVING ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY'"
162,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
163,"WITH ""first_login_date"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""login_date"",COUNT(DISTINCT ""f"".""user_id"") AS ""user_count"" FROM ""first_login_date"" AS ""f"" WHERE ""f"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1 ORDER BY 1"
164,"SELECT ""a"".""first_login"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - MIN(""activity_date"")<=90) AS ""a"" GROUP BY 1 ORDER BY 1"
165,"WITH ""cte_date"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte_date"" WHERE ""login_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""login_date"" ORDER BY ""login_date"""
166,"SELECT ""B"".""first_date"" AS ""login_date"",COUNT(""B"".""user_id"") AS ""user_count"" FROM (SELECT ""A"".""user_id"",""A"".""first_date"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""A"" WHERE ""A"".""first_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') AS ""B"" GROUP BY ""B"".""first_date"""
167,"SELECT ""t"".""login_date"",COUNT(""t"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
168,"SELECT ""i"".""activity_date"" AS ""login_date"",COUNT(""i"".""user_id"") AS ""user_count"" FROM (SELECT ""g"".* FROM (SELECT DISTINCT ""p"".""user_id"",MIN(""p"".""activity_date"") AS ""activity_date"" FROM ""Traffic"" AS ""p"" WHERE ""p"".""activity""='login' GROUP BY ""p"".""user_id"") AS ""g"" WHERE CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY'<=""g"".""activity_date"") AS ""i"" GROUP BY ""i"".""activity_date"" ORDER BY ""i"".""activity_date"""
169,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""Traffic"" WHERE ROW(""user_id"",""activity_date"") IN (SELECT ""user_id"",MIN(""activity_date"") FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY 1"
170,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""x"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
171,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
172,"WITH ""first_login"" AS (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - ""login_date""<=90) SELECT COUNT(DISTINCT ""user_id"") AS ""user_count"",""login_date"" FROM ""first_login"" GROUP BY ""login_date"""
173,"WITH ""cte"" AS (SELECT ""t"".""user_id"",MIN(""t"".""activity_date"") AS ""logindt"" FROM ""Traffic"" AS ""t"" WHERE ""t"".""activity""='login' GROUP BY 1) SELECT ""cte"".""logindt"" AS ""login_date"",COUNT(""cte"".""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""cte"".""logindt""<=90 GROUP BY 1 ORDER BY 1"
174,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
175,"SELECT ""first_act"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_act"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""a"" WHERE ""first_act"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1"
176,"WITH ""MIN_DATE_TABLE"" AS (SELECT *,MIN(""activity_date"") OVER (PARTITION BY ""user_id"") AS ""MIN_DATE"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM ""MIN_DATE_TABLE"" WHERE ""activity_date""=""MIN_DATE"" AND ABS(""activity_date"" - CAST('2019-06-30' AS DATE))<=90 GROUP BY ""activity_date"""
177,"WITH ""cte"" AS (SELECT ""user_id"",""activity_date"" FROM (SELECT DISTINCT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""r"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""t"".""r""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" GROUP BY 1"
178,"WITH ""cte_first_time_logins"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1), ""cte_final"" AS (SELECT ""first_login_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte_first_time_logins"" WHERE ""first_login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""first_login_date""<='2019-06-30' GROUP BY 1 ORDER BY 1) SELECT * FROM ""cte_final"""
179,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
180,"WITH ""base"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""earliest_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT DISTINCT ""earliest_login"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""Base"" WHERE CAST('2019-06-30' AS DATE) - ""earliest_login""<=90 GROUP BY 1"
181,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
182,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""a"" WHERE ""login_date"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY 1 ORDER BY 1"
183,"WITH ""firstlog"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""traffic"" WHERE ""activity"" LIKE 'login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""firstlog"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""traffic"" WHERE ""activity"" LIKE 'login' GROUP BY ""user_id"" HAVING MIN(""activity_date"")>=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY') GROUP BY ""activity_date"""
184,"SELECT ""temp"".""first_login_date"" AS ""login_date"",COUNT(DISTINCT ""temp"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"")>=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND MIN(""activity_date"")<='2019-06-30') AS ""temp"" GROUP BY ""login_date"""
185,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" GROUP BY 1 HAVING CAST('2019-06-30' AS DATE) - ""cte"".""login_date""<=90"
186,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""activity_date"" AS ""login_date"",""user_id"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""RowNo"" FROM ""Traffic"" WHERE ""activity""='login') AS ""temp"" WHERE ""RowNo""=1 AND CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
187,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""temp"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
188,"WITH ""base_table"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""first_login_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""base_table"" WHERE ""first_login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY 1"
189,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""num"" FROM ""traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""num""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' AND ""activity""='login' GROUP BY ""login_date"""
190,"WITH ""t"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_login_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""t"" WHERE ""first_login_date"" BETWEEN (CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') AND '2019-06-30' GROUP BY ""first_login_date"""
191,"WITH ""firstlogin"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""firstlogin"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
192,"WITH ""first_login_date"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_login"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""first_login_date"" WHERE CAST('2019-06-30' AS DATE) - ""first_login""<=90 GROUP BY ""first_login"""
193,"WITH ""FST"" AS (SELECT ""T"".""USER_ID"",""T"".""ACTIVITY"",MIN(""T"".""ACTIVITY_DATE"") AS ""ACTIVITY_DATE"" FROM ""TRAFFIC"" AS ""T"" WHERE ""T"".""ACTIVITY""='login' GROUP BY ""T"".""USER_ID"") SELECT ""FST"".""ACTIVITY_DATE"" AS ""LOGIN_DATE"",COUNT(""FST"".""USER_ID"") AS ""USER_COUNT"" FROM ""FST"" WHERE CAST('2019-06-30' AS DATE) - ""FST"".""ACTIVITY_DATE""<=90 GROUP BY ""FST"".""ACTIVITY_DATE"" ORDER BY 1"
194,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,CASE WHEN ""activity_date""=MIN(""activity_date"") OVER (PARTITION BY ""user_id"") THEN 1 ELSE 0 END AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login') AS ""sub1"" WHERE ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' AND ""first_login""=1 GROUP BY 1 ORDER BY 1"
195,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""activity_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""ad"" WHERE ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' AND ""user_id"" NOT IN (SELECT ""user_id"" FROM ""Traffic"" WHERE ""activity_date""<CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND ""activity""='login') GROUP BY ""activity_date"""
196,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
197,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""s"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1"
198,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"",""activity"" HAVING ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" GROUP BY ""login_date"""
199,"WITH ""t1"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""t1"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
200,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rk"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""rk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"" ORDER BY ""login_date"""
201,"WITH ""new_Traffic"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""new_Traffic"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
202,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") OVER (PARTITION BY ""user_id"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login') AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY 1"
203,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""t"".""activity_date"") AS ""login_date"",""t"".""user_id"" FROM ""Traffic"" AS ""t"" WHERE ""activity"" LIKE 'login' GROUP BY ""t"".""user_id"") AS ""t1"" WHERE ""t1"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
204,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""a"" WHERE CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY 1"
205,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""rnk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"" ORDER BY ""activity_date"""
206,"SELECT ""a"".""first_login"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - MIN(""activity_date"")<=90) AS ""a"" GROUP BY 1 ORDER BY 1"
207,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1 HAVING ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') AS ""temp"" GROUP BY 1"
208,"SELECT ""a"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM ""traffic"" AS ""a"" JOIN (SELECT ""user_id"",MIN(""activity_date"") AS ""first_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""activity_date""=""b"".""first_date"" WHERE ""a"".""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""activity_date""<='2019-06-30' GROUP BY 1"
209,"WITH ""cte"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
210,"WITH ""FIRST_LOGIN"" AS (SELECT ""USER_ID"",""ACTIVITY_DATE"" AS ""LOGIN_DATE"",RANK() OVER (PARTITION BY ""USER_ID"" ORDER BY ""ACTIVITY_DATE"") AS ""RN"" FROM ""TRAFFIC"" WHERE ""ACTIVITY""='login') SELECT ""LOGIN_DATE"",COUNT(DISTINCT ""USER_ID"") AS ""USER_COUNT"" FROM ""FIRST_LOGIN"" WHERE CAST('2019-06-30' AS DATE) - ""LOGIN_DATE""<=90 AND ""RN""=1 GROUP BY ""LOGIN_DATE"" HAVING COUNT(DISTINCT ""USER_ID"")>0"
211,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - ""login_date""<=90) AS ""t"" GROUP BY ""login_date"""
212,"WITH ""l"" AS (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM ""l"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
213,"SELECT ""min_date"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""min_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""x"" WHERE ""min_date""<='2019-06-30' AND ""min_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1 ORDER BY 1"
214,"WITH ""CTE"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM ""Traffic"" AS ""a"" JOIN ""CTE"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""activity_date""=""b"".""first_login"" WHERE CAST('2019-06-30' AS DATE) - ""a"".""activity_date"" BETWEEN 0 AND 90 GROUP BY 1 ORDER BY 1"
215,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
216,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') AS ""a"" WHERE ""rnk""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1"
217,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
218,"SELECT DISTINCT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT DISTINCT ""user_id"",""activity_date"",ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""Traffic"" WHERE ""activity""='login') AS ""T"" WHERE ""rn""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
219,"WITH ""cte"" AS (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""holder"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE ""holder""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
220,"SELECT ""a"".""activity_date"" AS ""login_date"",COUNT(DISTINCT ""a"".""user_id"") AS ""user_count"" FROM ""traffic"" AS ""a"" JOIN (SELECT ""user_id"",MIN(""activity_date"") AS ""first_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""activity_date""=""b"".""first_date"" WHERE ""a"".""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND ""activity_date""<='2019-06-30' AND ""a"".""activity""='login' GROUP BY 1"
221,"WITH ""cte"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") OVER (PARTITION BY ""user_id"", ""activity"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" GROUP BY ""login_date"" HAVING ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY'"
222,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
223,"WITH ""qualified_date"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""qualified_date"" WHERE ""login_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""login_date"""
224,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""login_date"" + INTERVAL '90 DAY'>='2019-06-30' GROUP BY ""login_date"""
225,"SELECT ""first_activity_date"" AS ""login_date"",COUNT(""first_activity_date"") AS ""user_count"" FROM (SELECT ""T"".""user_id"",MIN(""T"".""activity_date"") AS ""first_activity_date"" FROM ""Traffic"" AS ""T"" WHERE ""T"".""activity""='login' GROUP BY ""T"".""user_id"") AS ""first_activity_dates"" GROUP BY ""first_activity_date"" HAVING ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND CAST('2019-06-30' AS DATE) + INTERVAL '90 DAY'"
226,"SELECT ""mind"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""mind"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"")>='2019-04-01') AS ""T"" GROUP BY ""mind"""
227,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
228,"SELECT ""subquery"".""activity_date"" AS ""login_date"",COUNT(""subquery"".""user_id"") AS ""user_count"" FROM (SELECT DISTINCT (""r"".""user_id"") AS ""user_id"",""r"".""activity"" AS ""activity"",MIN(""r"".""activity_date"") AS ""activity_date"" FROM ""Traffic"" AS ""r"" WHERE ""r"".""activity""='login' GROUP BY ""user_id"") AS ""subquery"" WHERE ""subquery"".""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
229,"WITH ""cte"" AS (SELECT *,MIN(""activity_date"") OVER (PARTITION BY ""user_id"") AS ""early_date"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT (""user_id"")) AS ""user_count"" FROM ""cte"" WHERE ""activity_date""=""early_date"" AND ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY ""activity_date"""
230,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""login_rank"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""login_rank""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY 1"
231,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
232,"SELECT ""first_login"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY 1 ORDER BY 2) AS ""s"" WHERE ""first_login"">=DATE('2019-06-30') - INTERVAL '90 DAY' GROUP BY 1"
233,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""summary"" WHERE ""login_date"">=(SELECT CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY') GROUP BY ""login_date"""
234,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
235,"ERROR: mysql parse error: line 1 column 222 near ""by login_date"" "
236,"WITH ""temp"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""temp"" GROUP BY ""login_date"" HAVING CAST('2019-06-30' AS DATE) - ""activity_date""<=90"
237,"WITH ""temp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""temp"" WHERE ""rnk""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
238,"SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""temp"" WHERE CAST('2019-06-30' AS DATE) - ""first_login""<=90 GROUP BY ""first_login"" ORDER BY ""first_login"""
239,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
240,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
241,"WITH ""tmp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rn"" FROM ""traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""tmp"" WHERE ""rn""=1 AND ""activity_date"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY ""activity_date"""
242,"WITH ""firstlogin"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""firstlogin"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
243,"SELECT ""c"".""login_date"",COUNT(DISTINCT ""c"".""user_id"") AS ""user_count"" FROM (SELECT DISTINCT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE 1=1 AND ""activity""='login' GROUP BY ""user_id"") AS ""c"" WHERE 1=1 AND ""c"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY 1 ORDER BY 1"
244,"SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING CAST('2019-06-30' AS DATE) - ""first_login""<=90) AS ""tmp"" GROUP BY ""login_date"" ORDER BY ""login_date"""
245,"SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""a"" WHERE (""activity_date"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND ""activity_date""<='2019-06-30') AND ""user_id"" NOT IN (SELECT DISTINCT ""user_id"" FROM ""Traffic"" WHERE ""activity_date""<CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND ""activity""='login') GROUP BY ""activity_date"" ORDER BY 1"
246,"SELECT ""temp"".""first_login"" AS ""login_date"",COUNT(""temp"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"",""activity"") AS ""temp"" WHERE ""temp"".""first_login"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-09-30' GROUP BY ""temp"".""first_login"""
247,"SELECT ""req_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""req_date"" FROM ""traffic"" AS ""t"" WHERE ""activity""='login' GROUP BY 1 HAVING ""req_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30') AS ""agg"" GROUP BY 1"
248,"WITH ""login"" AS (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"",""activity"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""login"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
249,"WITH ""sqll"" AS (SELECT DISTINCT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""sqll"" WHERE ""first_login"">=CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' GROUP BY ""first_login"""
250,"SELECT ""first_login_date"" AS ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) AS ""t2"" WHERE ""first_login_date"" BETWEEN (DATE('2019-06-30') - INTERVAL '90 DAY') AND DATE('2019-06-30') GROUP BY 1"
251,"WITH ""first_log"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""first_log"" WHERE ""first_login"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""first_login"""
252,"SELECT ""First_Login_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""First_Login_date"" FROM ""traffic"" WHERE ""activity""='Login' GROUP BY ""user_id"" HAVING ""First_Login_date"">=DATE('2019-06-30') + INTERVAL '-90 DAY') AS ""T"" GROUP BY ""First_Login_date"""
253,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT MIN(""t"".""activity_date"") AS ""login_date"",""t"".""user_id"" FROM ""Traffic"" AS ""t"" WHERE ""activity"" LIKE 'login' GROUP BY ""t"".""user_id"") AS ""t1"" WHERE ""t1"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
254,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
255,"WITH ""first_login"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""first_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY 1) SELECT ""first_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""first_login"" WHERE ""first_date"" BETWEEN '2019-04-01' AND '2019-06-30' GROUP BY ""first_date"""
256,"SELECT ""first_login"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""fl"" WHERE CAST('2019-06-30' AS DATE) - ""first_login""<=90 GROUP BY ""login_date"""
257,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
258,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""traffic"" WHERE ""activity""='login') AS ""m"" WHERE ""m"".""rnk""=1 AND ""activity_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30' GROUP BY ""activity_date"""
259,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""activity_date"",""user_id"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""r"" FROM ""traffic"" WHERE ""activity""='login') AS ""t"" WHERE ""r""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"""
260,"SELECT ""a"".""first_login"" AS ""login_date"",COUNT(""a"".""user_id"") AS ""user_count"" FROM (SELECT ""t"".""user_id"",MIN(""t"".""activity_date"") AS ""first_login"" FROM ""traffic"" AS ""t"" WHERE ""t"".""activity""='login' AND ""t"".""user_id"" NOT IN (SELECT ""t1"".""user_id"" FROM ""traffic"" AS ""t1"" WHERE ""t1"".""activity""='login' AND CAST('2019-06-30' AS DATE) - ""t1"".""activity_date"">90) GROUP BY ""t"".""user_id"") AS ""a"" GROUP BY ""a"".""first_login"" ORDER BY ""a"".""first_login"""
261,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"""
262,"SELECT ""A"".""min_date"" AS ""login_date"",COUNT(""A"".""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""min_date"",""user_id"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"") BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND '2019-06-30') AS ""A"" GROUP BY ""A"".""min_date"""
263,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""A"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' AND CAST('2019-06-30' AS DATE) + INTERVAL '90 DAY' GROUP BY ""login_date"""
264,"WITH ""t"" AS (SELECT ""user_id"",""activity"",""activity_date"",DENSE_RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""Traffic"" WHERE ""activity""='login') SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""t"" WHERE ""rnk""=1 AND CAST('2019-06-30' AS DATE) - ""activity_date""<=90 GROUP BY ""activity_date"" ORDER BY ""activity_date"""
265,"SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
266,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT MIN(""activity_date"") AS ""login_date"",""user_id"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"" HAVING MIN(""activity_date"") BETWEEN '2019-04-01' AND '2019-06-30') AS ""a"" GROUP BY ""login_date"" ORDER BY ""login_date"""
267,"SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""activity_date"" + INTERVAL '90 DAY'>='2019-06-30' GROUP BY ""activity_date"""
268,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
269,"SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") OVER (PARTITION BY ""user_id"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login') AS ""temp"" WHERE ""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""login_date"""
270,"SELECT ""temp"".""first_login"" AS ""login_date"",COUNT(""temp"".""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",""activity"",MIN(""activity_date"") AS ""first_login"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"",""activity"") AS ""temp"" WHERE ""temp"".""first_login"" BETWEEN '2019-04-01' AND '2019-09-30' GROUP BY ""temp"".""first_login"""
271,"SELECT * FROM (SELECT ""activity_date"" AS ""login_date"",COUNT(""user_id"") AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" GROUP BY ""activity_date"") AS ""S"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90"
272,"WITH ""CTE"" AS (SELECT * FROM ""Traffic"" WHERE ""activity""='login'), ""CTE1"" AS (SELECT *,RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""activity_date"") AS ""rnk"" FROM ""CTE""), ""CTE2"" AS (SELECT * FROM ""CTE1"" WHERE ""rnk""=1) SELECT ""activity_date"" AS ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""CTE2"" WHERE ""activity_date"">=CAST('2019-06-30' AS DATE) - INTERVAL '90 DAY' GROUP BY 1"
273,"WITH ""cte"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""login_date"",COUNT(DISTINCT ""user_id"") AS ""user_count"" FROM ""cte"" WHERE CAST('2019-06-30' AS DATE) - ""login_date""<=90 GROUP BY ""login_date"" ORDER BY ""login_date"""
274,"SELECT ""DAY"" AS ""LOGIN_DATE"",COUNT(""F"".""USER_ID"") AS ""USER_COUNT"" FROM (SELECT ""T"".""USER_ID"",MIN(""T"".""ACTIVITY_DATE"") AS ""DAY"" FROM ""TRAFFIC"" AS ""T"" WHERE ""T"".""ACTIVITY""='login' GROUP BY ""T"".""USER_ID"") AS ""F"" WHERE CAST('2019-06-30' AS DATE) - ""DAY""<=90 GROUP BY ""DAY"""
275,"WITH ""a"" AS (SELECT ""user_id"",MIN(""activity_date"") AS ""activity_date"" FROM ""traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") SELECT ""a"".""activity_date"" AS ""login_date"",COUNT(""a"".""user_id"") AS ""user_count"" FROM ""a"" WHERE CAST('2019-06-30' AS DATE) - ""a"".""activity_date""<=90 GROUP BY ""a"".""activity_date"""
276,"SELECT ""login_date"",COUNT(1) AS ""user_count"" FROM (SELECT ""user_id"",MIN(""activity_date"") AS ""login_date"" FROM ""Traffic"" WHERE ""activity""='login' GROUP BY ""user_id"") AS ""t"" WHERE ""t"".""login_date"" BETWEEN CAST('2019-06-30' AS DATE) + INTERVAL '-90 DAY' AND '2019-06-30' GROUP BY ""t"".""login_date"""
