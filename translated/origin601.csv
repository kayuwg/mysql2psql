id,original query
1,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",ROW_NUMBER() OVER (ORDER BY ""id"") AS ""idx"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE (""id""-""idx"") IN (SELECT (""id""-""idx"") FROM ""cte"" GROUP BY (""id""-""idx"") HAVING COUNT(""id""-""idx"")>=3)"
2,"SELECT DISTINCT (""X"".""id"") AS ""id"",""X"".""visit_date"" AS ""visit_date"",""X"".""people"" AS ""people"" FROM (""Stadium"" AS ""X"") CROSS JOIN (SELECT ""B"".""id"" AS ""id"" FROM ((""Stadium"" AS ""A"") CROSS JOIN ""Stadium"" AS ""B"") CROSS JOIN ""Stadium"" AS ""C"" WHERE ""A"".""people"">=100 AND ""B"".""people"">=100 AND ""C"".""people"">=100 AND ""A"".""id""=(""B"".""id""-1) AND ""C"".""id""=(""B"".""id""+1)) AS ""Y"" WHERE (""X"".""id""=""Y"".""id"" OR ""X"".""id""+1=""Y"".""id"" OR ""X"".""id""-1=""Y"".""id"") ORDER BY ""X"".""id"""
3,"SELECT ""s0"".""id"",""s0"".""visit_date"",""s0"".""people"" FROM (((""stadium"" AS ""s0"" LEFT JOIN ""stadium"" AS ""s_1"" ON ""s0"".""id""-1=""s_1"".""id"") LEFT JOIN ""stadium"" AS ""s_2"" ON ""s0"".""id""-2=""s_2"".""id"") LEFT JOIN ""stadium"" AS ""s1"" ON ""s0"".""id""+1=""s1"".""id"") LEFT JOIN ""stadium"" AS ""s2"" ON ""s0"".""id""+2=""s2"".""id"" WHERE ""s0"".""people"">=100 AND ((""s_1"".""people"">=100 AND ""s_2"".""people"">=100) OR (""s_1"".""people"">=100 AND ""s1"".""people"">=100) OR (""s1"".""people"">=100 AND ""s2"".""people"">=100)) ORDER BY 1"
4,"WITH ""CTE"" AS (SELECT ""id"",""visit_date"",""people"",""rnk"",(""id""-""rnk"") AS ""island"" FROM (SELECT ""id"",""visit_date"",""people"",RANK() OVER (ORDER BY ""id"") AS ""rnk"" FROM ""Stadium"" WHERE ""people"">=100) AS ""a"") SELECT ""id"",""visit_date"",""people"" FROM ""CTE"" WHERE ""island"" IN (SELECT ""island"" FROM ""CTE"" GROUP BY ""island"" HAVING COUNT(1)>=3)"
5,"SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100 AND ((""id""+1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100) AND ""id""+2 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100)) OR (""id""+1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100) AND ""id""-1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100)) OR (""id""-1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100) AND ""id""-2 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100))) ORDER BY ""id"""
6,"WITH ""tmp"" AS (SELECT * FROM ""Stadium"" WHERE ""people"">=100) SELECT DISTINCT ""t1"".* FROM ((""tmp"" AS ""t1"") CROSS JOIN ""tmp"" AS ""t2"") CROSS JOIN ""tmp"" AS ""t3"" WHERE (""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t2"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t1"".""id""-""t3"".""id""=1) OR (""t1"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t3"".""id""=1) ORDER BY ""visit_date"""
7,"WITH ""clean"" AS (SELECT ""id"",""visit_date"",""people"",RANK() OVER (ORDER BY ""visit_date"") AS ""r"" FROM ""stadium"" WHERE ""people"">=100), ""r"" AS (SELECT ""id""-""r"" AS ""r"" FROM ""clean"" GROUP BY 1 HAVING COUNT(1)>2) SELECT ""c"".""id"",""c"".""visit_date"",""c"".""people"" FROM ""clean"" AS ""c"" JOIN ""r"" ON ""r"".""r""=""c"".""id""-""c"".""r"""
8,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
9,"WITH ""cte"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"") AS ""diff"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",COUNT(""diff"") OVER (PARTITION BY ""diff"") AS ""d"" FROM ""cte"") AS ""c"" WHERE ""c"".""d"">2"
10,"WITH ""s"" AS (SELECT ""s1"".""id"" AS ""id1"",""s1"".""visit_date"" AS ""date1"",""s1"".""people"" AS ""ppl1"",""s2"".""id"" AS ""id2"",""s2"".""visit_date"" AS ""date2"",""s2"".""people"" AS ""ppl2"",""s3"".""id"" AS ""id3"",""s3"".""visit_date"" AS ""date3"",""s3"".""people"" AS ""ppl3"" FROM (""Stadium"" AS ""s1"" LEFT JOIN ""Stadium"" AS ""s2"" ON ""s1"".""id""=""s2"".""id""-1) LEFT JOIN ""Stadium"" AS ""s3"" ON ""s2"".""id""=""s3"".""id""-1 WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT ""id1"" AS ""id"",""date1"" AS ""visit_date"",""ppl1"" AS ""people"" FROM ""s"" UNION SELECT ""id2"" AS ""id"",""date2"" AS ""visit_date"",""ppl2"" AS ""people"" FROM ""s"" UNION SELECT ""id3"" AS ""id"",""date3"" AS ""visit_date"",""ppl3"" AS ""people"" FROM ""s"" ORDER BY ""visit_date"""
11,"WITH ""p"" AS (SELECT ""s"".*,""s"".""id""-RANK() OVER (ORDER BY ""id"") AS ""rank_id_diff"" FROM ""Stadium"" AS ""s"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""p"" WHERE (SELECT COUNT(1) FROM ""p"" AS ""p1"" WHERE ""p1"".""rank_id_diff""=""p"".""rank_id_diff"")>=3"
12,"WITH ""check_consecutive"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rownumber"",""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""check_consecutive"" WHERE ""id""-""rownumber"" IN (SELECT (""id""-""rownumber"") FROM ""check_consecutive"" GROUP BY (""id""-""rownumber"") HAVING COUNT(1)>=3)"
13,"WITH ""s1"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""s"".""id"") AS ""rowIndex"",""s"".* FROM ""Stadium"" AS ""s"" WHERE ""s"".""people"">=100 GROUP BY ""s"".""id"",""s"".""visit_date"",""s"".""people""), ""s2"" AS (SELECT COUNT(""s"".""id"") OVER (PARTITION BY ""s"".""id""-""s"".""rowIndex"") AS ""groupSize"",""s"".* FROM ""s1"" AS ""s"") SELECT ""s3"".""id"",""s3"".""visit_date"",""s3"".""people"" FROM ""s2"" AS ""s3"" GROUP BY ""s3"".""groupSize"",""s3"".""id"",""s3"".""visit_date"",""s3"".""people"" HAVING ""s3"".""groupSize"">=3 ORDER BY ""s3"".""visit_date"""
14,"WITH ""StadiumFilter"" AS (SELECT ""id"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""PartitionNums"" FROM ""Stadium"" WHERE ""people"">=100), ""StadiumIds"" AS (SELECT ""id"" FROM ""StadiumFilter"" WHERE ""PartitionNums"" IN (SELECT ""PartitionNums"" FROM ""StadiumFilter"" GROUP BY ""PartitionNums"" HAVING COUNT(1)>=3)) SELECT ""t1"".""id"",""t1"".""visit_date"",""t1"".""people"" FROM ""Stadium"" AS ""t1"" JOIN ""StadiumIds"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"""
15,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"" AS ""visit_date"",""a"".""people"" AS ""people"" FROM (""Stadium"" AS ""a"" CROSS JOIN ""Stadium"" AS ""b"") JOIN ""Stadium"" AS ""c"" ON ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""-""b"".""id""=1 AND ""a"".""id""-""c"".""id""=2) OR (""a"".""id""-""b"".""id""=-1 AND ""a"".""id""-""c"".""id""=-2) OR (""a"".""id""-""b"".""id""=-1 AND ""a"".""id""-""c"".""id""=1)) ORDER BY ""a"".""visit_date"""
16,"WITH ""rkGroup"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""rkGroup"" WHERE ""rk"" IN (SELECT ""rk"" FROM ""rkGroup"" GROUP BY ""rk"" HAVING COUNT(""id"")>=3)"
17,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""people"") OVER (ORDER BY ""visit_date"") AS ""next1"",LEAD(""people"", 2) OVER (ORDER BY ""visit_date"") AS ""next2"",LAG(""people"") OVER (ORDER BY ""visit_date"") AS ""pre1"",LAG(""people"", 2) OVER (ORDER BY ""visit_date"") AS ""pre2"" FROM ""Stadium"") AS ""temp"" WHERE (""people"">=100 AND ""next1"">=100 AND ""next2"">=100) OR (""people"">=100 AND ""pre1"">=100 AND ""pre2"">=100) OR (""people"">=100 AND ""pre1"">=100 AND ""next1"">=100) ORDER BY ""id"""
18,"SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE 3<=(SELECT COUNT(""s"".""people"") FROM ""stadium"" AS ""s"" WHERE ""s"".""people"">=100 AND ""s"".""id"">=""stadium"".""id"" AND ""s"".""id""<=""stadium"".""id""+2) OR 3<=(SELECT COUNT(""s"".""people"") FROM ""stadium"" AS ""s"" WHERE ""s"".""people"">=100 AND ""s"".""id"">=""stadium"".""id""-1 AND ""s"".""id""<=""stadium"".""id""+1) OR 3<=(SELECT COUNT(""s"".""people"") FROM ""stadium"" AS ""s"" WHERE ""s"".""people"">=100 AND ""s"".""id"">=""stadium"".""id""-2 AND ""s"".""id""<=""stadium"".""id"")"
19,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""stadium"" AS ""a"") CROSS JOIN ""stadium"" AS ""b"") CROSS JOIN ""stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""=""b"".""id""-1 AND ""a"".""id""=""c"".""id""-2) OR (""a"".""id""=""b"".""id""+1 AND ""a"".""id""=""c"".""id""-1) OR (""a"".""id""=""b"".""id""+2 AND ""a"".""id""=""c"".""id""+1)) ORDER BY ""a"".""id"""
20,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
21,"SELECT DISTINCT ""c"".""id"",""c"".""visit_date"",""c"".""people"" FROM (SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""ppl_cnt1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""ppl_cnt2"" FROM ""stadium"") AS ""a"" WHERE ""people"">=100 AND ""ppl_cnt1"">=100 AND ""ppl_cnt2"">=100) AS ""b"" JOIN ""stadium"" AS ""c"" ON ""b"".""id""=""c"".""id"" OR ""b"".""id""+1=""c"".""id"" OR ""c"".""id""=""b"".""id""+2"
22,"WITH ""DailyTraffic"" AS (SELECT ""id"",""visit_date"",LAG(""people"", 2, -1) OVER (ORDER BY ""visit_date"") AS ""2Before"",LAG(""people"", 1, -1) OVER (ORDER BY ""visit_date"") AS ""1Before"",""people"" AS ""Today"",LEAD(""people"", 1, -1) OVER (ORDER BY ""visit_date"") AS ""1After"",LEAD(""people"", 2, -1) OVER (ORDER BY ""visit_date"") AS ""2After"" FROM ""Stadium"") SELECT ""id"",""visit_date"",""Today"" AS ""people"" FROM ""DailyTraffic"" WHERE (""2Before"">=100 AND ""1Before"">=100 AND ""Today"">=100) OR (""1Before"">=100 AND ""Today"">=100 AND ""1After"">=100) OR (""Today"">=100 AND ""1After"">=100 AND ""2After"">=100)"
23,"WITH ""people"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rank_id_diff"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""people"" WHERE ""rank_id_diff"" IN (SELECT ""rank_id_diff"" FROM ""people"" GROUP BY ""rank_id_diff"" HAVING COUNT(""rank_id_diff"")>=3)"
24,"SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 GROUP BY ""s1"".""id"" ORDER BY ""visit_date"""
25,"WITH ""cte"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rownumber"",""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE (""id""-""rownumber"") IN (SELECT (""id""-""rownumber"") FROM ""cte"" GROUP BY (""id""-""rownumber"") HAVING COUNT(1)>=3)"
26,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rnk"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""rnk"" IN (SELECT ""rnk"" FROM ""cte"" GROUP BY ""rnk"" HAVING COUNT(1)>=3)"
27,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LAG(""people"") OVER (ORDER BY ""id"") AS ""before1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""before2"",LEAD(""people"") OVER (ORDER BY ""id"") AS ""after1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""after2"" FROM ""Stadium"") AS ""s"" WHERE (""people"">=100 AND ""before1"">=100 AND ""before2"">=100) OR (""people"">=100 AND ""after1"">=100 AND ""after2"">=100) OR (""people"">=100 AND ""before1"">=100 AND ""after1"">=100)"
28,"WITH ""ctetest"" AS (SELECT ""id"",""visit_date"",""people"",LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""id1"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""id2"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""id3"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""id4"" FROM ""stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT ""id"",""visit_date"",""people"" FROM ""ctetest"" WHERE (""id1""=""id""+1 AND ""id2""=""id""+2) OR (""id3""=""id""-1 AND ""id4""=""id""-2) OR (""id1""=""id""+1 AND ""id3""=""id""-1) ORDER BY ""id"""
29,"SELECT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) GROUP BY ""s1"".""id"" ORDER BY ""s1"".""id"""
30,"WITH ""cte"" AS (SELECT *,LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""lag_p_1"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""lead_p_1"" FROM ""Stadium"") SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ""cte"" JOIN ""Stadium"" AS ""s1"" ON ""s1"".""id"" BETWEEN ""cte"".""id""-1 AND ""cte"".""id""+1 WHERE ""cte"".""people"">=100 AND ""cte"".""lag_p_1"">=100 AND ""cte"".""lead_p_1"">=100 ORDER BY ""visit_date"""
31,"WITH ""cte1"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte1"" WHERE ""rk"" IN (SELECT ""rk"" FROM ""cte1"" GROUP BY ""rk"" HAVING COUNT(1)>=3) ORDER BY ""id"""
32,"WITH ""cte"" AS (SELECT *,(""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"")) AS ""rn"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""rn"" IN (SELECT ""rn"" FROM ""cte"" GROUP BY ""rn"" HAVING COUNT(1)>=3)"
33,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
34,"SELECT * FROM (SELECT * FROM ""stadium"" WHERE ""people"">99) AS ""s"" WHERE (""s"".""id""+1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">99) AND ""s"".""id""+2 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">99)) OR (""s"".""id""-1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">99) AND ""s"".""id""-2 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">99)) OR (""s"".""id""-1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">99) AND ""s"".""id""+1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">99))"
35,"WITH ""StadiumFilter"" AS (SELECT ""id"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""PartitionNums"" FROM ""Stadium"" WHERE ""people"">=100), ""StadiumIds"" AS (SELECT ""id"" FROM ""StadiumFilter"" WHERE ""PartitionNums"" IN (SELECT ""PartitionNums"" FROM ""StadiumFilter"" GROUP BY ""PartitionNums"" HAVING COUNT(1)>=3)) SELECT ""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""StadiumIds"")"
36,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
37,"SELECT DISTINCT ""s"".* FROM (""stadium"" AS ""s"" CROSS JOIN ""stadium"" AS ""s2"") JOIN ""stadium"" AS ""s3"" ON (""s"".""id""+1=""s2"".""id"" AND ""s"".""id""+2=""s3"".""id"") OR (""s"".""id""-1=""s2"".""id"" AND ""s"".""id""+1=""s3"".""id"") OR (""s"".""id""-2=""s2"".""id"" AND ""s"".""id""-1=""s3"".""id"") WHERE ""s"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s"".""id"""
38,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM ""Stadium"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
39,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""id1"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""id2"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""idb1"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""idb2"" FROM (SELECT ""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100) AS ""St_flt"") AS ""std_rst"" WHERE 'y'=CASE WHEN (""id1""=""id""+1 AND ""id2""=""id""+2) THEN 'y' WHEN (""idb1""=""id""-1 AND ""id1""=""id""+1) THEN 'y' WHEN (""idb2""=""id""-2 AND ""idb1""=""id""-1) THEN 'y' ELSE 'n' END"
40,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S1"".""id""=""S2"".""id""+1 AND ""S1"".""id""=""S3"".""id""-1) OR (""S1"".""id""=""S2"".""id""+2 AND ""S1"".""id""=""S3"".""id""+1)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
41,"WITH ""a"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""r"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""a"" WHERE ""r"" IN (SELECT ""r"" FROM (SELECT ""r"",COUNT(1) AS ""rnum"" FROM ""a"" GROUP BY ""r"") AS ""b"" WHERE ""rnum"">=3)"
42,"SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id""+1 FROM ""Stadium"" WHERE ""people"">=100 AND (""id""+1 IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100) AND ""id""-1 IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100))) OR ""id"" IN (SELECT ""id""-1 FROM ""Stadium"" WHERE ""people"">=100 AND (""id""+1 IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100) AND ""id""-1 IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100))) OR ""id"" IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100 AND (""id""+1 IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100) AND ""id""-1 IN (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100)))"
43,"WITH ""cte1"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte1"" WHERE ""rk"" IN (SELECT ""rk"" FROM ""cte1"" GROUP BY ""rk"" HAVING COUNT(1)>=3) ORDER BY ""id"""
44,"WITH ""CTE"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""s"".""id"") AS ""diff"" FROM ""Stadium"" AS ""s"" WHERE ""s"".""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""CTE"" WHERE ""diff"" IN (SELECT ""diff"" FROM ""CTE"" GROUP BY ""diff"" HAVING COUNT(""diff"")>=3)"
45,"WITH ""tmp"" AS (SELECT *,""id""-2 AS ""minus_two"",""id""+2 AS ""plus_two"",""id""-1 AS ""minus_one"",""id""+1 AS ""plus_one"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""tmp"" WHERE (""minus_two"" IN (SELECT ""id"" FROM ""tmp"") AND ""minus_one"" IN (SELECT ""id"" FROM ""tmp"")) OR (""plus_two"" IN (SELECT ""id"" FROM ""tmp"") AND ""plus_one"" IN (SELECT ""id"" FROM ""tmp"")) OR (""minus_one"" IN (SELECT ""id"" FROM ""tmp"") AND ""plus_one"" IN (SELECT ""id"" FROM ""tmp""))"
46,"WITH ""temp"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""consecutive"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""temp"" WHERE ""consecutive"" IN (SELECT ""consecutive"" FROM ""temp"" GROUP BY ""consecutive"" HAVING COUNT(""id"")>2) ORDER BY ""visit_date"""
47,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
48,"SELECT DISTINCT ""a"".* FROM ((SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""a"" CROSS, (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""b"") CROSS JOIN (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""c"" WHERE (""a"".""id""-1=""b"".""id"" AND ""b"".""id""-1=""c"".""id"" AND ""a"".""id""-2=""c"".""id"") OR (""b"".""id""-1=""a"".""id"" AND ""a"".""id""-1=""c"".""id"" AND ""b"".""id""-2=""c"".""id"") OR (""c"".""id""-1=""b"".""id"" AND ""b"".""id""-1=""a"".""id"" AND ""c"".""id""-2=""a"".""id"") ORDER BY ""a"".""id"""
49,"SELECT ""ID"",""visit_date"",""people"" FROM (SELECT ""ID"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nxt"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nxt2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""Stadium"") AS ""cte"" WHERE (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""nxt2"">=100) OR (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""pre"">=100) OR (""cte"".""people"">=100 AND ""cte"".""pre"">=100 AND ""cte"".""pre2"">=100)"
50,"SELECT DISTINCT ""s1"".* FROM (""Stadium"" AS ""s1"" CROSS JOIN ""Stadium"" AS ""s2"") JOIN ""Stadium"" AS ""s3"" ON (""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"") WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""visit_date"""
51,"WITH ""a"" AS (SELECT ""id"",""visit_date"",""people"",LAG(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""before_yesterday"",LAG(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""yesterday"",LEAD(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""tmr"",LEAD(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""day_after_tmr"" FROM ""Stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ""a"" WHERE (""a"".""id""+1=""a"".""tmr"" AND ""a"".""id""+2=""a"".""day_after_tmr"") OR (""a"".""id""-1=""a"".""yesterday"" AND ""a"".""id""+1=""a"".""tmr"") OR (""a"".""id""-2=""a"".""before_yesterday"" AND ""a"".""id""-1=""a"".""yesterday"")"
52,"WITH ""rec_100"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""ID"") AS ""cons_id"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ""rec_100"" AS ""a"" WHERE ""cons_id"" IN (SELECT ""cons_id"" FROM ""rec_100"" GROUP BY ""cons_id"" HAVING COUNT(""cons_id"")>=3)"
53,"WITH ""t"" AS (SELECT *,LAG(""people"") OVER (ORDER BY ""id"") AS ""l1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""l2"",LEAD(""people"") OVER (ORDER BY ""id"") AS ""f1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""f2"" FROM ""Stadium"") SELECT DISTINCT ""id"",""visit_date"",""people"" FROM ""t"" WHERE (""people"">=100 AND ""l1"">=100 AND ""l2"">=100) OR (""people"">=100 AND ""l1"">=100 AND ""f1"">=100) OR (""people"">=100 AND ""f1"">=100 AND ""f2"">=100)"
54,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""+1=""t2"".""id"" AND ""t1"".""id""+2=""t3"".""id"" AND ""t2"".""id""+1=""t3"".""id"") OR (""t1"".""id""-1=""t2"".""id"" AND ""t1"".""id""+1=""t3"".""id"" AND ""t2"".""id""+2=""t3"".""id"") OR (""t1"".""id""-2=""t3"".""id"" AND ""t1"".""id""-1=""t2"".""id"" AND ""t2"".""id""-1=""t3"".""id"")) ORDER BY ""t1"".""id"""
55,"WITH ""T"" AS (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",""ID""-ROW_NUMBER() OVER (ORDER BY ""ID"") AS ""R"" FROM ""STADIUM"" WHERE ""PEOPLE"">=100) SELECT ""ID"",""VISIT_DATE"",""PEOPLE"" FROM ""T"" WHERE ""R"" IN (SELECT ""R"" FROM ""T"" GROUP BY ""R"" HAVING COUNT(""R"")>=3)"
56,"WITH ""tmp"" AS (SELECT *,""id""-2 AS ""minus_two"",""id""+2 AS ""plus_two"",""id""-1 AS ""minus_one"",""id""+1 AS ""plus_one"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""tmp"" WHERE (""minus_two"" IN (SELECT ""id"" FROM ""tmp"") AND ""minus_one"" IN (SELECT ""id"" FROM ""tmp"")) OR (""plus_two"" IN (SELECT ""id"" FROM ""tmp"") AND ""plus_one"" IN (SELECT ""id"" FROM ""tmp"")) OR (""minus_one"" IN (SELECT ""id"" FROM ""tmp"") AND ""plus_one"" IN (SELECT ""id"" FROM ""tmp"")) ORDER BY ""id"""
57,"WITH ""large_stads"" AS (SELECT *,CASE WHEN COALESCE(LAG(""id"") OVER (ORDER BY ""id""), 0)!=""id""-1 THEN 1 ELSE 0 END AS ""new_group"" FROM ""Stadium"" WHERE ""people"">=100), ""stad_groups"" AS (SELECT *,SUM(""new_group"") OVER (ORDER BY ""id"") AS ""group_id"" FROM ""large_stads""), ""consec_groups"" AS (SELECT ""group_id"" FROM ""stad_groups"" GROUP BY 1 HAVING COUNT(1)>=3) SELECT ""id"",""visit_date"",""people"" FROM ""stad_groups"" WHERE ""group_id"" IN (SELECT ""group_id"" FROM ""consec_groups"") ORDER BY 1"
58,"SELECT DISTINCT ""x"".""id"",""visit_date"",""people"" FROM (""stadium"" AS ""x"") CROSS JOIN (SELECT ""a"".""id"" AS ""a_id"",""b"".""id"" AS ""b_id"",""c"".""id"" AS ""c_id"" FROM ((""stadium"" AS ""a"") CROSS JOIN ""stadium"" AS ""b"") CROSS JOIN ""stadium"" AS ""c"" WHERE (""a"".""id""+1=""b"".""id"" AND (""b"".""people"">=100 AND ""a"".""people"">=100)) AND (""a"".""id""+2=""c"".""id"" AND (""c"".""people"">=100 AND ""a"".""people"">=100))) AS ""x2"" WHERE ""x"".""id""=""x2"".""a_id"" OR ""x"".""id""=""x2"".""b_id"" OR ""x"".""id""=""x2"".""c_id"""
59,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM (SELECT * FROM ""Stadium"") AS ""a"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
60,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE (""s1"".""people"">=100) AND (""s2"".""people"">=100) AND (""s3"".""people"">=100) AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2 AND ""s2"".""id""-""s1"".""id""=1)) ORDER BY ""s1"".""id"""
61,"SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ""Stadium"" AS ""s1"" WHERE ""s1"".""people"">=100 AND ((100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""+1) AND 100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""+2)) OR (100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""-1) AND 100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""-2)) OR (100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""-1) AND 100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""+1)))"
62,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2)) ORDER BY ""s1"".""id"""
63,"SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM (((""Stadium"" AS ""s1"" LEFT JOIN ""Stadium"" AS ""s2"" ON (""s1"".""id""=""s2"".""id""-1)) LEFT JOIN ""Stadium"" AS ""s3"" ON (""s1"".""id""=""s3"".""id""-2)) LEFT JOIN ""Stadium"" AS ""s4"" ON (""s1"".""id""=""s4"".""id""+1)) LEFT JOIN ""Stadium"" AS ""s5"" ON (""s1"".""id""=""s5"".""id""+2) WHERE (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 OR ""s1"".""people"">=100 AND ""s4"".""people"">=100 AND ""s5"".""people"">=100 OR ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s4"".""people"">=100) ORDER BY ""s1"".""visit_date"""
64,"WITH ""GroupedStadium"" AS (SELECT ""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""stadium_group"",""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100), ""GroupedStadiumWithCount"" AS (SELECT ""stadium_group"",""id"",""visit_date"",""people"",COUNT(""id"") OVER (PARTITION BY ""stadium_group"") AS ""records"" FROM ""GroupedStadium"") SELECT ""id"",""visit_date"",""people"" FROM ""GroupedStadiumWithCount"" WHERE ""records"">=3"
65,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2) OR (""s1"".""id""-""s2"".""id""=-1 AND ""s1"".""id""-""s3"".""id""=1) OR (""s1"".""id""-""s2"".""id""=-2 AND ""s1"".""id""-""s3"".""id""=-1)) AND (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) ORDER BY ""s1"".""id"""
66,"WITH ""t"" AS (SELECT ""t1"".""id"",""t1"".""visit_date"",""t1"".""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""grp"" FROM ""stadium"" AS ""t1"" WHERE ""people"">=100) SELECT ""t"".""id"",""t"".""visit_date"",""t"".""people"" FROM ""t"" WHERE ""grp"" IN (SELECT ""grp"" FROM ""t"" GROUP BY ""grp"" HAVING COUNT(1)>=3)"
67,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"" UNION SELECT ""s2"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"" UNION SELECT ""s3"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"") AS ""t"" ORDER BY ""visit_date"""
68,"WITH ""t"" AS (WITH ""t"" AS (SELECT * FROM ""Stadium"" WHERE ""people"">=100) SELECT ""t1"".""id"" FROM ""t"" AS ""t1"" JOIN ""t"" AS ""t2"" ON ""t2"".""id"">""t1"".""id"" AND ""t2"".""id""<=""t1"".""id""+2 GROUP BY ""t1"".""id"" HAVING COUNT(1)=2) SELECT ""s"".* FROM ""stadium"" AS ""s"" JOIN ""t"" ON ""s"".""id"">=""t"".""id"" AND ""s"".""id""<=""t"".""id""+2 GROUP BY ""s"".""id"",""s"".""visit_date"",""s"".""people"" ORDER BY ""visit_date"""
69,"SELECT ""t3"".""id"",""t3"".""visit_date"",""t3"".""people"" FROM (SELECT ""rdiff"",COUNT(1) AS ""cnt"" FROM (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"") AS ""rdiff"" FROM ""Stadium"" WHERE ""people"">=100 ORDER BY ""visit_date"") AS ""t"" GROUP BY ""rdiff"" HAVING ""cnt"">=3) AS ""t2"" CROSS, (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"") AS ""rdiff"" FROM ""Stadium"" WHERE ""people"">=100 ORDER BY ""visit_date"") AS ""t3"" WHERE ""t3"".""rdiff""=""t2"".""rdiff"""
70,"SELECT DISTINCT ""s"".""id"",""s"".""visit_date"",""s"".""people"" FROM (SELECT ""id"",""visit_date"",""people"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""LAG1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""LAG2"" FROM ""stadium"") AS ""x"" JOIN ""stadium"" AS ""s"" ON ""s"".""id"" BETWEEN ""x"".""id""-2 AND ""x"".""id"" WHERE ""x"".""lag1"">=100 AND ""x"".""lag2"">=100 AND ""x"".""people"">=100 ORDER BY 2"
71,"SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""id""=""b"".""id""-1 AND ""b"".""id""=""c"".""id""-1 AND ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 UNION SELECT ""b"".""id"",""b"".""visit_date"",""b"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""id""=""b"".""id""-1 AND ""b"".""id""=""c"".""id""-1 AND ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 UNION SELECT ""c"".""id"",""c"".""visit_date"",""c"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""id""=""b"".""id""-1 AND ""b"".""id""=""c"".""id""-1 AND ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 ORDER BY 1"
72,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
73,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
74,"WITH ""machin"" AS (SELECT *,LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""peoplem1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""peoplem2"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""peoplep1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""peoplep2"" FROM ""Stadium"") SELECT ""id"",""visit_date"",""people"" FROM ""machin"" WHERE ""people"">=100 AND ((""peoplem1"">=100 AND (""peoplem2"">=100 OR ""peoplep1"">=100)) OR (""peoplep1"">=100 AND ""peoplep2"">=100))"
75,"SELECT ""T4"".""id"",""visit_date"",""people"" FROM ""Stadium"" AS ""T4"" JOIN (SELECT ""T1"".""id"" FROM (""Stadium"" AS ""T1"" JOIN ""Stadium"" AS ""T2"" ON ""T1"".""id""=""T2"".""id""+1) JOIN ""Stadium"" AS ""T3"" ON ""T1"".""id""=""T3"".""id""+2 WHERE ""T1"".""people"">=100 AND ""T2"".""people"">=100 AND ""T3"".""people"">=100 UNION SELECT ""T2"".""id"" FROM (""Stadium"" AS ""T1"" JOIN ""Stadium"" AS ""T2"" ON ""T1"".""id""=""T2"".""id""+1) JOIN ""Stadium"" AS ""T3"" ON ""T1"".""id""=""T3"".""id""+2 WHERE ""T1"".""people"">=100 AND ""T2"".""people"">=100 AND ""T3"".""people"">=100 UNION SELECT ""T3"".""id"" FROM (""Stadium"" AS ""T1"" JOIN ""Stadium"" AS ""T2"" ON ""T1"".""id""=""T2"".""id""+1) JOIN ""Stadium"" AS ""T3"" ON ""T1"".""id""=""T3"".""id""+2 WHERE ""T1"".""people"">=100 AND ""T2"".""people"">=100 AND ""T3"".""people"">=100) AS ""T5"" ON ""T4"".""id""=""T5"".""id"" ORDER BY ""visit_date"""
76,"WITH ""cte_100_people"" AS (SELECT ""s"".*,""s"".""id""-RANK() OVER (ORDER BY ""id"") AS ""rank_id_diff"" FROM ""Stadium"" AS ""s"" WHERE ""people"">=100) SELECT ""p"".""id"",""p"".""visit_date"",""p"".""people"" FROM ""cte_100_people"" AS ""p"" WHERE 3<=(SELECT COUNT(1) FROM ""cte_100_people"" AS ""p2"" WHERE ""p2"".""rank_id_diff""=""p"".""rank_id_diff"")"
77,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM ""Stadium"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
78,"WITH ""temp"" AS (SELECT ""a"".""id"" AS ""first"",""b"".""id"" AS ""second"",""c"".""id"" AS ""third"" FROM (""stadium"" AS ""a"" LEFT JOIN ""stadium"" AS ""b"" ON ""a"".""id""+1=""b"".""id"") LEFT JOIN ""stadium"" AS ""c"" ON ""a"".""id""+2=""c"".""id"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""id"" IN (SELECT ""temp"".""first"" AS ""id"" FROM ""temp"" UNION SELECT ""temp"".""second"" AS ""id"" FROM ""temp"" UNION SELECT ""temp"".""third"" AS ""id"" FROM ""temp"")"
79,"WITH ""T"" AS (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",""ID""-ROW_NUMBER() OVER (ORDER BY ""ID"") AS ""R"" FROM ""STADIUM"" WHERE ""PEOPLE"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""T"" WHERE ""r"" IN (SELECT ""r"" FROM ""T"" GROUP BY ""r"" HAVING COUNT(""r"")>=3)"
80,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
81,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
82,"SELECT ""id"",""visit_Date"",""people"" FROM (SELECT *,NTH_VALUE(""people"", 2) OVER (ROWS BETWEEN CURRENT ROW AND 3 FOLLOWING) AS ""s"",NTH_VALUE(""people"", 3) OVER (ROWS BETWEEN CURRENT ROW AND 3 FOLLOWING) AS ""t"",NTH_VALUE(""people"", 1) OVER (ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""p1"",NTH_VALUE(""people"", 2) OVER (ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""p2"" FROM ""stadium"") AS ""a"" WHERE (""a"".""people"">=100 AND ""a"".""s"">=100 AND ""a"".""t"">=100) OR (""a"".""people"">=100 AND ""a"".""p1"">=100 AND ""a"".""p2"">=100) OR (""a"".""people"">=100 AND ""a"".""p2"">=100 AND ""a"".""s"">=100 AND ""a"".""id"" NOT IN (1,2))"
83,"WITH ""internals"" AS (SELECT ""x"".""id"" AS ""x_id"",""y"".""id"" AS ""y_id"",""z"".""id"" AS ""z_id"" FROM ((SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""x"" JOIN (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""y"" ON ""x"".""id""=""y"".""id""+1) JOIN (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""z"" ON ""x"".""id""=""z"".""id""-1) SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""x_id"" AS ""id"",""visit_date"",""people"" FROM ""internals"" AS ""i"" JOIN ""Stadium"" ON ""i"".""x_id""=""Stadium"".""id"" UNION ALL SELECT ""y_id"" AS ""id"",""visit_date"",""people"" FROM ""internals"" AS ""i"" JOIN ""Stadium"" ON ""i"".""y_id""=""Stadium"".""id"" UNION ALL SELECT ""z_id"" AS ""id"",""visit_date"",""people"" FROM ""internals"" AS ""i"" JOIN ""Stadium"" ON ""i"".""z_id""=""Stadium"".""id"") AS ""alias"" GROUP BY ""id"",""visit_date"",""people"" ORDER BY ""visit_date"""
84,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2 AND ""t2"".""id""-""t1"".""id""=1)) ORDER BY ""t1"".""id"""
85,"WITH ""t1"" AS (SELECT (""s"".""id""-RANK() OVER (ORDER BY ""s"".""id"")) AS ""diff"",""s"".""id"",""s"".""visit_date"",""s"".""people"" FROM ""Stadium"" AS ""s"" WHERE ""people"">=100), ""t2"" AS (SELECT COUNT(1) OVER (PARTITION BY ""t1"".""diff"") AS ""ct"",""t1"".""id"",""t1"".""visit_date"",""t1"".""people"" FROM ""t1"") SELECT ""t2"".""id"",""t2"".""visit_date"",""t2"".""people"" FROM ""t2"" WHERE ""t2"".""ct"">=3"
86,"WITH ""cte"" AS (SELECT *,(""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"")) AS ""grp"" FROM (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""a"") SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""grp"" IN (SELECT ""grp"" FROM ""cte"" GROUP BY ""grp"" HAVING COUNT(""id"")>=3) ORDER BY ""visit_date"""
87,"SELECT DISTINCT ""t1"".* FROM ((""Stadium"" AS ""t1"") CROSS JOIN ""Stadium"" AS ""t2"") CROSS JOIN ""Stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""=""t2"".""id""-1 AND ""t2"".""id""=""t3"".""id""-1) OR (""t1"".""id""=""t2"".""id""+1 AND ""t2"".""id""=""t3"".""id""+1) OR (""t1"".""id""=""t2"".""id""+1 AND ""t1"".""id""=""t3"".""id""-1)) ORDER BY ""id"""
88,"WITH ""check_consecutive"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rownumber"",""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""check_consecutive"" WHERE ""id""-""rownumber"" IN (SELECT (""id""-""rownumber"") FROM ""check_consecutive"" GROUP BY (""id""-""rownumber"") HAVING COUNT(1)>=3)"
89,"WITH ""cte"" AS (SELECT ""s1"".""id"" AS ""s1_id"",""s2"".""id"" AS ""s2_id"",""s3"".""id"" AS ""s3_id"" FROM (""stadium"" AS ""s1"" CROSS JOIN ""stadium"" AS ""s2"") JOIN ""stadium"" AS ""s3"" ON ""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2 WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""id"" IN (SELECT ""s1_id"" FROM ""cte"") OR ""id"" IN (SELECT ""s2_id"" FROM ""cte"") OR ""id"" IN (SELECT ""s3_id"" FROM ""cte"")"
90,"SELECT ""al"".""id"",""al"".""visit_date"",""al"".""people"" FROM (SELECT COUNT(1) OVER () AS ""total"",""a"".* FROM (SELECT ""t"".""id"",""t"".""visit_date"",""t"".""people"" FROM (SELECT *,LEAD(""people"", 1, '') OVER (ORDER BY ""id"") AS ""lead1"",LEAD(""people"", 2, '') OVER (ORDER BY ""id"") AS ""lead2"",LAG(""people"", 1, '') OVER (ORDER BY ""id"") AS ""lag1"",LAG(""people"", 2, '') OVER (ORDER BY ""id"") AS ""lag2"" FROM ""Stadium"" ORDER BY ""id"") AS ""t"" WHERE (""t"".""lead1"">=100 AND ""t"".""lead2"">=100 AND ""t"".""people"">=100) OR (""t"".""lag1"">=100 AND ""t"".""lag2"">=100 AND ""t"".""people"">=100) OR (""t"".""lag1"">=100 AND ""t"".""lead1"">=100 AND ""t"".""people"">=100) ORDER BY ""t"".""visit_date"") AS ""a"") AS ""al"" WHERE ""al"".""total"">=3 ORDER BY ""al"".""visit_date"""
91,"WITH ""cte1"" AS (SELECT ""id"",""visit_date"",""people"",ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk_org"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte1"" WHERE ""rk"" IN (SELECT ""rk"" FROM ""cte1"" GROUP BY ""rk"" HAVING COUNT(1)>=3) ORDER BY ""id"""
92,"SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 UNION SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ""s2"".""id""-""s1"".""id""=1 AND ""s1"".""id""-""s3"".""id""=1 UNION SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ""s2"".""id""-""s1"".""id""=2 AND ""s3"".""id""-""s1"".""id""=1 ORDER BY ""id"""
93,"WITH ""traffic"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""categ"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""traffic"" WHERE ""categ"" IN (SELECT ""categ"" FROM ""traffic"" GROUP BY ""categ"" HAVING COUNT(1)>=3)"
94,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nxt"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nxt2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""Stadium"") AS ""tmp"" WHERE (""tmp"".""people"">=100 AND ""tmp"".""nxt"">=100 AND ""nxt2"">=100) OR (""tmp"".""people"">=100 AND ""tmp"".""pre"">=100 AND ""tmp"".""nxt"">=100) OR (""tmp"".""people"">=100 AND ""tmp"".""pre"">=100 AND ""tmp"".""pre2"">=100)"
95,"WITH ""T"" AS (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",""ID""-ROW_NUMBER() OVER (ORDER BY ""ID"") AS ""R"" FROM ""Stadium"" WHERE ""PEOPLE"">=100) SELECT ""ID"",""VISIT_DATE"",""PEOPLE"" FROM ""T"" WHERE ""R"" IN (SELECT ""R"" FROM ""T"" GROUP BY ""R"" HAVING COUNT(""R"")>=3)"
96,"SELECT DISTINCT ""t1"".* FROM ((""Stadium"" AS ""t1"") CROSS JOIN ""Stadium"" AS ""t2"") CROSS JOIN ""Stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND (""t1"".""id""=""t2"".""id""-1 AND ""t1"".""id""=""t3"".""id""-2 OR ""t1"".""id""=""t2"".""id""-1 AND ""t1"".""id""=""t3"".""id""+1 OR ""t1"".""id""=""t2"".""id""+1 AND ""t1"".""id""=""t3"".""id""+2) ORDER BY ""t1"".""id"""
97,"WITH ""s"" AS (SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100) SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""s"" AS ""s1"") CROSS JOIN ""s"" AS ""s2"") CROSS JOIN ""s"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"") OR (""s2"".""id""+1=""s1"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s2"".""id""+1=""s3"".""id"" AND ""s3"".""id""+1=""s1"".""id"")) ORDER BY ""s1"".""id"""
98,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
99,"WITH ""CTE"" AS (SELECT ""id"",""visit_date"",""people"",LAG(""people"", 1) OVER (ORDER BY ""visit_date"") AS ""lag_people_1"",LAG(""people"", 2) OVER (ORDER BY ""visit_date"") AS ""lag_people_2"",LAG(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""lag_id_1"",LAG(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""lag_id_2"" FROM ""Stadium"") SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""CTE"" WHERE ""people"">=100 AND ""lag_people_1"">=100 AND ""lag_people_2"">=100 UNION SELECT ""lag_id_1"" FROM ""CTE"" WHERE ""people"">=100 AND ""lag_people_1"">=100 AND ""lag_people_2"">=100 UNION SELECT ""lag_id_2"" FROM ""CTE"" WHERE ""people"">=100 AND ""lag_people_1"">=100 AND ""lag_people_2"">=100) ORDER BY 2"
100,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
101,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM (""Stadium"" AS ""s1"" CROSS JOIN ""Stadium"" AS ""s2"") JOIN ""Stadium"" AS ""s3"" ON ((""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""+1) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""+2) OR (""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2)) WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
102,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM ""Stadium"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
103,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""=""b"".""id""-1 AND ""b"".""id""=""c"".""id""-1) OR (""a"".""id""=""b"".""id""+1 AND ""a"".""id""=""c"".""id""-1) OR (""c"".""id""=""b"".""id""+1 AND ""a"".""id""=""c"".""id""+1)) ORDER BY ""a"".""visit_date"""
104,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM ""Stadium"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
105,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""a"") AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
106,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM (""Stadium"" AS ""s1"" CROSS JOIN ""Stadium"" AS ""s2"") JOIN ""Stadium"" AS ""s3"" ON ((""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""+1) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""+2) OR (""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2)) WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
107,"WITH ""T_100"" AS (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100) SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""T_100"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""+2 IN (SELECT ""id"" FROM ""T_100"")) OR (""id""-1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""+1 IN (SELECT ""id"" FROM ""T_100"")) OR (""id""-1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""-2 IN (SELECT ""id"" FROM ""T_100"")))"
108,"WITH ""sql1"" AS (SELECT ""id"",""visit_date"",""people"",LEAD(""people"") OVER (ORDER BY ""visit_date"") AS ""day1_people"",LAG(""people"") OVER (ORDER BY ""visit_date"") AS ""day_1_people"",CASE WHEN LEAD(""people"") OVER (ORDER BY ""visit_date"")>=100 THEN 1 ELSE 0 END AS ""day1_value"",CASE WHEN LAG(""people"") OVER (ORDER BY ""visit_date"")>=100 THEN 1 ELSE 0 END AS ""day_1_value"" FROM ""Stadium""), ""sql2"" AS (SELECT ""a"".*,LEAD(""day1_people"") OVER (ORDER BY ""visit_date"") AS ""day2_people"",LAG(""day_1_people"") OVER (ORDER BY ""visit_date"") AS ""day_2_people"",CASE WHEN LEAD(""day1_people"") OVER (ORDER BY ""visit_date"")>=100 THEN 1 ELSE 0 END AS ""day2_value"",CASE WHEN LAG(""day_1_people"") OVER (ORDER BY ""visit_date"")>=100 THEN 1 ELSE 0 END AS ""day_2_value"" FROM ""sql1"" AS ""a"") SELECT ""m"".* FROM (SELECT ""id"",""visit_date"",""people"" FROM ""sql2"" WHERE ""people"">=100 AND ""day1_value"">0 AND ""day_1_value"">0 UNION SELECT ""id"",""visit_date"",""people"" FROM ""sql2"" WHERE ""people"">=100 AND ""day1_value"">0 AND ""day2_value"">0 UNION SELECT ""id"",""visit_date"",""people"" FROM ""sql2"" WHERE ""people"">=100 AND ""day_1_value"">0 AND ""day_2_value"">0) AS ""m"" ORDER BY ""id"""
109,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
110,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
111,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
112,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",CASE WHEN LAG(""id"", 2) OVER (ORDER BY ""id"")=""id""-2 THEN 1 ELSE 0 END+CASE WHEN LAG(""id"", 1) OVER (ORDER BY ""id"")=""id""-1 THEN 1 ELSE 0 END+CASE WHEN LEAD(""id"", 1) OVER (ORDER BY ""id"")=""id""+1 THEN 1 ELSE 0 END+CASE WHEN LEAD(""id"", 2) OVER (ORDER BY ""id"")=""id""+2 THEN 1 ELSE 0 END AS ""flag"" FROM (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""s"") AS ""sf"" WHERE ""sf"".""flag"">1 ORDER BY ""sf"".""id"""
113,"WITH ""OrderedStadium"" AS (SELECT ""id"",""visit_date"",""people"",RANK() OVER (ORDER BY ""id"")/-1 AS ""rank"" FROM ""Stadium"") SELECT DISTINCT ""A"".""id"",""A"".""visit_date"",""A"".""people"" FROM ((""OrderedStadium"" AS ""A"") CROSS JOIN ""OrderedStadium"" AS ""B"") CROSS JOIN ""OrderedStadium"" AS ""C"" WHERE ""A"".""people"">=100 AND ""B"".""people"">=100 AND ""C"".""people"">=100 AND (""A"".""rank""-""B"".""rank""=1 AND ""B"".""rank""-""C"".""rank""=1 OR ""B"".""rank""-""A"".""rank""=1 AND ""A"".""rank""-""C"".""rank""=1 OR ""C"".""rank""-""B"".""rank""=1 AND ""B"".""rank""-""A"".""rank""=1) ORDER BY ""A"".""id"""
114,"SELECT DISTINCT ""S1"".* FROM ((""Stadium"" AS ""S1"") CROSS JOIN ""Stadium"" AS ""S2"") CROSS JOIN ""Stadium"" AS ""S3"" WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 AND ((""S1"".""id""+1=""S2"".""id"" AND ""S2"".""id""+1=""S3"".""id"") OR (""S2"".""id""+1=""S1"".""id"" AND ""S1"".""id""+1=""S3"".""id"") OR (""S2"".""id""+1=""S3"".""id"" AND ""S3"".""id""+1=""S1"".""id"")) ORDER BY ""visit_date"""
115,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",CASE WHEN LAG(""id"", 2) OVER (ORDER BY ""id"")=""id""-2 THEN 1 ELSE 0 END+CASE WHEN LAG(""id"", 1) OVER (ORDER BY ""id"")=""id""-1 THEN 1 ELSE 0 END+CASE WHEN LEAD(""id"", 1) OVER (ORDER BY ""id"")=""id""+1 THEN 1 ELSE 0 END+CASE WHEN LEAD(""id"", 2) OVER (ORDER BY ""id"")=""id""+2 THEN 1 ELSE 0 END AS ""flag"" FROM (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""s"") AS ""sf"" WHERE ""sf"".""flag"">1 ORDER BY ""sf"".""id"""
116,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""TwoPrevDay"",LAG(""people"") OVER (ORDER BY ""id"") AS ""PrevDay"",LEAD(""people"") OVER (ORDER BY ""id"") AS ""NextDay"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""TwoNextDay"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""TwoPrevId"",LAG(""id"") OVER (ORDER BY ""id"") AS ""PrevId"",LEAD(""id"") OVER (ORDER BY ""id"") AS ""NextId"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""TwoNextId"" FROM ""Stadium"") AS ""X"" WHERE ""people"">=100 AND (((""TwoPrevDay"">=100 AND ""PrevDay"">=100) AND (""TwoPrevId""=""id""-2 AND ""PrevId""=""id""-1)) OR ((""PrevDay"">=100 AND ""NextDay"">=100) AND (""PrevId""=""id""-1 AND ""NextId""=""id""+1)) OR ((""NextDay"">=100 AND ""TwoNextDay"">=100) AND (""NextId""=""id""+1 AND ""TwoNextId""=""id""+2))) ORDER BY ""id"""
117,"WITH ""temp_table"" AS (SELECT ""s1"".""id"" AS ""id1"",""s1"".""visit_date"" AS ""vd1"",""s1"".""people"" AS ""p1"",""s2"".""id"" AS ""id2"",""s2"".""visit_date"" AS ""vd2"",""s2"".""people"" AS ""p2"",""s3"".""id"" AS ""id3"",""s3"".""visit_date"" AS ""vd3"",""s3"".""people"" AS ""p3"" FROM (""Stadium"" AS ""s1"" CROSS JOIN ""Stadium"" AS ""s2"") JOIN ""Stadium"" AS ""s3"" ON ""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT * FROM (SELECT ""id1"" AS ""id"",""vd1"" AS ""visit_date"",""p1"" AS ""people"" FROM ""temp_table"" UNION SELECT ""id2"" AS ""id"",""vd2"" AS ""visit_date"",""p2"" AS ""people"" FROM ""temp_table"" UNION SELECT ""id3"" AS ""id"",""vd3"" AS ""visit_date"",""p3"" AS ""people"" FROM ""temp_table"") AS ""final_output"" ORDER BY ""visit_date"""
118,"SELECT DISTINCT ""s1"".* FROM (""STADIUM"" AS ""s1"" CROSS JOIN ""STADIUM"" AS ""s2"") JOIN ""STADIUM"" AS ""s3"" ON (""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""-1) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""+2) WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""visit_date"""
119,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""row_num"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""row_num"" IN (SELECT ""row_num"" FROM ""cte"" GROUP BY ""row_num"" HAVING COUNT(""row_num"")>=3)"
120,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""row_num"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""row_num"" IN (SELECT ""row_num"" FROM ""cte"" GROUP BY ""row_num"" HAVING COUNT(""row_num"")>=3)"
121,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
122,"SELECT * FROM ""stadium"" AS ""s"" WHERE EXISTS (SELECT ""s1"".""id"",""s2"".""id"",""s3"".""id"" FROM (""Stadium"" AS ""s1"" JOIN ""Stadium"" AS ""s2"" ON ""s1"".""id""+1=""s2"".""id"") JOIN ""Stadium"" AS ""s3"" ON ""s1"".""id""+2=""s3"".""id"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND (""s"".""id""=""s1"".""id"" OR ""s"".""id""=""s2"".""id"" OR ""s"".""id""=""s3"".""id"")) ORDER BY ""s"".""Id"""
123,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
124,"SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id"" FROM (WITH ""temptable"" (""id"", ""group_id"") AS (SELECT ""id"",""id""-(DENSE_RANK() OVER (PARTITION BY (""people"">=100) ORDER BY ""id"")) FROM ""Stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT ""id"",COUNT(1) OVER (PARTITION BY ""group_id"") AS ""group_ct"" FROM ""temptable"") AS ""temptable2"" WHERE ""temptable2"".""group_ct"">=3) ORDER BY ""id"""
125,"WITH ""cte1"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte1"" WHERE ""rk"" IN (SELECT ""rk"" FROM ""cte1"" GROUP BY ""rk"" HAVING COUNT(1)>=3) ORDER BY ""id"""
126,"SELECT DISTINCT * FROM (SELECT * FROM (SELECT * FROM ""Stadium"" AS ""s"" WHERE ""people"">=100 AND (EXISTS (SELECT NULL FROM ""Stadium"" WHERE ""people"">=100 AND ""id""+1=""s"".""id"") AND EXISTS (SELECT NULL FROM ""Stadium"" WHERE ""people"">=100 AND ""id""-1=""s"".""id""))) AS ""strict"" UNION ALL SELECT * FROM ""Stadium"" AS ""s"" WHERE ""people"">=100 AND EXISTS (SELECT NULL FROM (SELECT * FROM ""Stadium"" AS ""s"" WHERE ""people"">=100 AND (EXISTS (SELECT NULL FROM ""Stadium"" WHERE ""people"">=100 AND ""id""+1=""s"".""id"") AND EXISTS (SELECT NULL FROM ""Stadium"" WHERE ""people"">=100 AND ""id""-1=""s"".""id""))) AS ""strict"" WHERE ""strict"".""id""-1=""s"".""id"") UNION ALL SELECT * FROM ""Stadium"" AS ""s"" WHERE ""people"">=100 AND EXISTS (SELECT NULL FROM (SELECT * FROM ""Stadium"" AS ""s"" WHERE ""people"">=100 AND (EXISTS (SELECT NULL FROM ""Stadium"" WHERE ""people"">=100 AND ""id""+1=""s"".""id"") AND EXISTS (SELECT NULL FROM ""Stadium"" WHERE ""people"">=100 AND ""id""-1=""s"".""id""))) AS ""strict"" WHERE ""strict"".""id""+1=""s"".""id"")) AS ""x"" ORDER BY ""x"".""id"""
127,"SELECT ""a"".* FROM (((""stadium"" AS ""a"" LEFT JOIN ""stadium"" AS ""b"" ON ""a"".""id""=(""b"".""id""-2)) LEFT JOIN ""stadium"" AS ""c"" ON ""a"".""id""=(""c"".""id""-1)) LEFT JOIN ""stadium"" AS ""d"" ON (""a"".""id"")=(""d"".""id""+1)) LEFT JOIN ""stadium"" AS ""e"" ON (""a"".""id"")=(""e"".""id""+2) WHERE (""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100) OR (""a"".""people"">=100 AND ""c"".""people"">=100 AND ""d"".""people"">=100) OR (""a"".""people"">=100 AND ""d"".""people"">=100 AND ""e"".""people"">=100)"
128,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
129,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2)) ORDER BY ""s1"".""id"""
130,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""+1=""b"".""id"" AND ""a"".""id""+2=""c"".""id"" AND ""b"".""id""+1=""c"".""id"") OR (""a"".""id""+1=""b"".""id"" AND ""a"".""id""-1=""c"".""id"" AND ""b"".""id""-2=""c"".""id"") OR (""a"".""id""-1=""b"".""id"" AND ""a"".""id""-2=""c"".""id"" AND ""b"".""id""-1=""c"".""id"")) ORDER BY ""a"".""id"""
131,"SELECT DISTINCT (""s1"".""id""),""s1"".""visit_date"",""s1"".""people"" FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2)) ORDER BY ""s1"".""id"""
132,"WITH ""tmp"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""diff"" FROM ""stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""diff"") AS ""cnt"" FROM ""tmp"") AS ""t"" WHERE ""cnt"">=3 ORDER BY 2"
133,"WITH ""cte"" AS (SELECT * FROM ""stadium"" WHERE ""people"">=100) SELECT * FROM ""cte"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""cte"") AND ""id""+2 IN (SELECT ""id"" FROM ""cte"")) OR (""id""-1 IN (SELECT ""id"" FROM ""cte"") AND ""id""+1 IN (SELECT ""id"" FROM ""cte"")) OR (""id""-2 IN (SELECT ""id"" FROM ""cte"") AND ""id""-1 IN (SELECT ""id"" FROM ""cte""))"
134,"WITH ""t"" AS (SELECT ""t1"".""id"",""t1"".""visit_date"",""t1"".""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""grp"" FROM ""stadium"" AS ""t1"" WHERE ""people"">=100) SELECT ""t"".""id"",""t"".""visit_date"",""t"".""people"" FROM ""t"" WHERE ""grp"" IN (SELECT ""grp"" FROM ""t"" GROUP BY ""grp"" HAVING COUNT(1)>=3)"
135,"WITH ""machin"" AS (SELECT *,LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""peoplem1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""peoplem2"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""peoplep1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""peoplep2"" FROM ""Stadium"") SELECT ""id"",""visit_date"",""people"" FROM ""machin"" WHERE ""people"">=100 AND ((""peoplem1"">=100 AND (""peoplem2"">=100 OR ""peoplep1"">=100)) OR (""peoplep1"">=100 AND ""peoplep2"">=100))"
136,"WITH ""CTE"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""diff"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""CTE"" WHERE ""diff"" IN (SELECT ""diff"" FROM ""CTE"" GROUP BY 1 HAVING COUNT(1)>=3) ORDER BY 2"
137,"SELECT DISTINCT ""x"".""id"",""visit_date"",""people"" FROM (""stadium"" AS ""x"") CROSS JOIN (SELECT ""a"".""id"" AS ""a_id"",""b"".""id"" AS ""b_id"",""c"".""id"" AS ""c_id"" FROM ((""stadium"" AS ""a"") CROSS JOIN ""stadium"" AS ""b"") CROSS JOIN ""stadium"" AS ""c"" WHERE (""a"".""id""+1=""b"".""id"" AND (""b"".""people"">=100 AND ""a"".""people"">=100)) AND (""a"".""id""+2=""c"".""id"" AND (""c"".""people"">=100 AND ""a"".""people"">=100))) AS ""x2"" WHERE ""x"".""id""=""x2"".""a_id"" OR ""x"".""id""=""x2"".""b_id"" OR ""x"".""id""=""x2"".""c_id"""
138,"WITH ""consecutiveDayAnalysis"" AS (SELECT ""id"",""visit_date"",LAG(""people"", 2, -1) OVER (ORDER BY ""id"") AS ""2DaysBeforeCrowd"",LAG(""people"", 1, -1) OVER (ORDER BY ""id"") AS ""1DayBeforeCrowd"",""people"" AS ""TodayCrowd"",LEAD(""people"", 1, -1) OVER (ORDER BY ""id"") AS ""1DayAfterCrowd"",LEAD(""people"", 2, -1) OVER (ORDER BY ""id"") AS ""2DaysAfterCrowd"" FROM ""Stadium"") SELECT ""id"",""visit_date"",""TodayCrowd"" AS ""people"" FROM ""consecutiveDayAnalysis"" WHERE (""2DaysBeforeCrowd"">=100 AND ""1DayBeforeCrowd"">=100 AND ""TodayCrowd"">=100) OR (""1DayBeforeCrowd"">=100 AND ""TodayCrowd"">=100 AND ""1DayAfterCrowd"">=100) OR (""TodayCrowd"">=100 AND ""1DayAfterCrowd"">=100 AND ""2DaysAfterCrowd"">=100)"
139,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nex"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nex2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""Stadium"") AS ""temp"" WHERE (""temp"".""people"">=100 AND ""temp"".""nex"">=100 AND ""temp"".""nex2"">=100) OR (""temp"".""people"">=100 AND ""temp"".""pre"">=100 AND ""temp"".""pre2"">=100) OR (""temp"".""people"">=100 AND ""temp"".""pre"">=100 AND ""temp"".""nex"">=100)"
140,"WITH ""stadium_info"" AS (SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100) SELECT DISTINCT ""a"".* FROM (""stadium_info"" AS ""a"" JOIN ""stadium_info"" AS ""b"" ON ""b"".""id""-1=""a"".""id"" OR ""b"".""id""+2=""a"".""id"") JOIN ""stadium_info"" AS ""c"" ON ""c"".""id""-2=""a"".""id"" OR ""c"".""id""+1=""a"".""id"" ORDER BY ""a"".""visit_date"""
141,"SELECT * FROM ""stadium"" AS ""s"" WHERE EXISTS (SELECT ""s1"".""id"",""s2"".""id"",""s3"".""id"" FROM (""Stadium"" AS ""s1"" JOIN ""Stadium"" AS ""s2"" ON ""s1"".""id""+1=""s2"".""id"" AND ""s2"".""people"">=100) JOIN ""Stadium"" AS ""s3"" ON ""s1"".""id""+2=""s3"".""id"" AND ""s3"".""people"">=100 WHERE ""s1"".""people"">=100 AND (""s"".""id""=""s1"".""id"" OR ""s"".""id""=""s2"".""id"" OR ""s"".""id""=""s3"".""id"")) ORDER BY ""s"".""Id"""
142,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
143,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) ORDER BY ""s1"".""visit_date"""
144,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
145,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",LAG(""id"") OVER (ORDER BY ""id"") AS ""p"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""p2"",LEAD(""id"") OVER (ORDER BY ""id"") AS ""n"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""n2"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100) AS ""q1"") AS ""q2"" WHERE (""id""-""p""=1 AND ""id""-""p2""=2) OR (""n""-""id""=1 AND ""n2""-""id""=2) OR (""n""-""id""+""p""=""id"")"
146,"SELECT ""id"",""visit_date"",""p"" AS ""people"" FROM (SELECT ""id"",""visit_date"",""people"" AS ""p"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""p1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""p2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""b1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""b2"" FROM ""stadium"") AS ""s"" WHERE (""s"".""p"">=100 AND ""s"".""p1"">=100 AND ""s"".""p2"">=100) OR (""s"".""p1"">=100 AND ""s"".""p"">=100 AND ""s"".""b1"">=100) OR (""s"".""p"">=100 AND ""s"".""b1"">=100 AND ""s"".""b2"">=100)"
147,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",(""id""-(ROW_NUMBER() OVER (ORDER BY ""id""))) AS ""delta"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""delta"" IN (SELECT ""delta"" FROM ""cte"" GROUP BY ""delta"" HAVING COUNT(""delta"")>=3)"
148,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM ""Stadium"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
149,"WITH ""temp_table"" AS (SELECT DISTINCT ""s1"".* FROM (""Stadium"" AS ""s1"" CROSS JOIN ""Stadium"" AS ""s2"") JOIN ""Stadium"" AS ""s3"" ON (""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"") WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT * FROM ""temp_table"" ORDER BY ""visit_date"""
150,"SELECT ""s"".""id"",""s"".""visit_date"",""s"".""people"" FROM ""stadium"" AS ""s"" CROSS JOIN (SELECT MIN(""visit_date"") AS ""st_date"",MAX(""visit_date"") AS ""ed_date"" FROM (SELECT ""id"",""visit_date"",(""id""-""num"") AS ""diff"" FROM (SELECT ""id"",""visit_date"",""people"",ROW_NUMBER() OVER (ORDER BY ""id"") AS ""num"" FROM ""stadium"" WHERE ""people"">=100) AS ""a"") AS ""b"" GROUP BY ""b"".""diff"" HAVING (MAX(""id"")-MIN(""id""))>=2) AS ""x"" WHERE ""s"".""visit_date"" BETWEEN ""x"".""st_date"" AND ""x"".""ed_date"" ORDER BY ""visit_date"""
151,"WITH ""CTE"" AS (SELECT ""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""DIFF"",""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""CTE"" WHERE ""DIFF"" IN (SELECT ""DIFF"" FROM ""CTE"" GROUP BY ""DIFF"" HAVING COUNT(1)>=3)"
152,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1)) ORDER BY ""t1"".""id"""
153,"WITH ""cte_100_people"" AS (SELECT ""s"".*,""s"".""id""-DENSE_RANK() OVER (ORDER BY ""id"") AS ""rank_id_diff"" FROM ""Stadium"" AS ""s"" WHERE ""people"">=100) SELECT ""p"".""id"",""p"".""visit_date"",""p"".""people"" FROM ""cte_100_people"" AS ""p"" WHERE 3<=(SELECT COUNT(1) FROM ""cte_100_people"" AS ""p2"" WHERE ""p2"".""rank_id_diff""=""p"".""rank_id_diff"")"
154,"WITH ""temp"" AS (SELECT ""id"",""visit_date"",""people"",CASE WHEN @""a""<100 AND ""people"">=100 THEN @""c"":=1 WHEN @""a"">=100 AND ""id""=@""b""+1 AND ""people"">=100 THEN @""c"":=@""c""+1 WHEN @""a""<100 OR ""id""!=@""b""+1 OR ""people""<100 THEN @""c"":=0 ELSE @""c"":=0 END AS ""counter"",@""a"":=""people"",@""b"":=""id"" FROM (""Stadium"") CROSS JOIN (SELECT @""a"":=0,@""b"":=0,@""c"":=0) AS ""x"" ORDER BY ""visit_date""), ""temp_2"" AS (SELECT ""id"",""visit_date"",""people"",""counter"",CASE WHEN ""counter""=0 THEN @""d"":=0 WHEN @""d""=1 OR ""counter"">=3 THEN @""d"":=1 ELSE @""d"":=0 END AS ""flag"" FROM (""temp"") CROSS JOIN (SELECT @""d"":=0) AS ""y"" ORDER BY ""visit_date"" DESC) SELECT ""id"",""visit_date"",""people"" FROM ""temp_2"" WHERE ""flag""=1 ORDER BY ""visit_date"""
155,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""+1=""t2"".""id"" AND ""t2"".""id""+1=""t3"".""id"") OR (""t2"".""id""+1=""t3"".""id"" AND ""t3"".""id""+1=""t1"".""id"") OR (""t3"".""id""+1=""t1"".""id"" AND ""t1"".""id""+1=""t2"".""id"")) ORDER BY ""t1"".""id"""
156,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""stadium"" AS ""a"") CROSS JOIN ""stadium"" AS ""b"") CROSS JOIN ""stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""+1=""b"".""id"" AND ""b"".""id""+1=""c"".""id"") OR (""a"".""id""-1=""b"".""id"" AND ""a"".""id""+1=""c"".""id"") OR (""a"".""id""-1=""b"".""id"" AND ""a"".""id""-2=""c"".""id"")) ORDER BY ""visit_date"""
157,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) AND ((""s2"".""id""=""s1"".""id""+1 AND ""s3"".""id""=""s1"".""id""+2) OR (""s2"".""id""=""s1"".""id""-1 AND ""s3"".""id""=""s1"".""id""+1) OR (""s2"".""id""=""s1"".""id""-1 AND ""s3"".""id""=""s1"".""id""-2)) ORDER BY ""s1"".""visit_date"""
158,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
159,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
160,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
161,"WITH ""cte"" AS (SELECT ""dif"" FROM (SELECT ""id"",""visit_date"",""people"",ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rnk"",(""id""-ROW_NUMBER() OVER (ORDER BY ""id"")) AS ""dif"" FROM ""Stadium"" WHERE ""people"">=100) AS ""a"" GROUP BY ""dif"" HAVING COUNT(1)>=3) SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rnk"",(""id""-ROW_NUMBER() OVER (ORDER BY ""id"")) AS ""dif"" FROM ""Stadium"" WHERE ""people"">=100) AS ""a"" WHERE ""dif"" IN (SELECT ""dif"" FROM ""cte"")"
162,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
163,"SELECT DISTINCT ""s"".""id"",""s"".""visit_date"",""s"".""people"" FROM ""Stadium"" AS ""s"" RIGHT JOIN (SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM (SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"",LAG(""s1"".""id"", 1) OVER (ORDER BY ""id"") AS ""prev"",LEAD(""s1"".""id"") OVER (ORDER BY ""id"") AS ""nxt"",LAG(""s1"".""people"", 1) OVER (ORDER BY ""id"") AS ""prev_ppl"",LEAD(""s1"".""people"") OVER (ORDER BY ""id"") AS ""nxt_ppl"" FROM ""Stadium"" AS ""s1"") AS ""a"" WHERE ""a"".""id""-""a"".""prev""=1 AND ""a"".""nxt""-""a"".""id""=1 AND ""a"".""people"">=100 AND ""a"".""prev_ppl"">=100 AND ""a"".""nxt_ppl"">=100) AS ""b"" ON ""s"".""id""=""b"".""id""+1 OR ""s"".""id""=""b"".""id""-1 OR ""b"".""id""=""s"".""id"" ORDER BY ""s"".""id"""
164,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
165,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE (""s1"".""id""=""s2"".""id""+1 AND ""s2"".""id""=""s3"".""id""+1 AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) OR (""s3"".""id""=""s1"".""id""-1 AND ""s1"".""id""=""s2"".""id""-1 AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) OR (""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1 AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) ORDER BY ""s1"".""visit_date"""
166,"SELECT DISTINCT ""S1"".* FROM ((""stadium"" AS ""S1"") CROSS JOIN ""stadium"" AS ""S2"") CROSS JOIN ""stadium"" AS ""S3"" WHERE ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) AND ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
167,"WITH ""cte"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""gap"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""gap"" IN (SELECT ""gap"" FROM ""cte"" GROUP BY ""gap"" HAVING COUNT(""id"")>=3) ORDER BY ""visit_date"""
168,"WITH ""cte"" AS (SELECT LAG(""id"") OVER (ORDER BY ""id"") AS ""prior_1"",""id"",LEAD(""id"") OVER (ORDER BY ""id"") AS ""next_1"",""visit_date"" FROM ""Stadium"" WHERE ""people"">=100), ""cte_2"" AS (SELECT DISTINCT ""id"" FROM ""cte"" WHERE ""prior_1""+1=""next_1""-1 UNION SELECT DISTINCT ""prior_1"" FROM ""cte"" WHERE ""prior_1""+1=""next_1""-1 UNION SELECT DISTINCT ""next_1"" FROM ""cte"" WHERE ""prior_1""+1=""next_1""-1) SELECT * FROM ""stadium"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM ""cte_2"") ORDER BY 1"
169,"WITH ""t1"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""tk"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""t1"" WHERE ""tk"" IN (SELECT ""tk"" FROM ""t1"" GROUP BY ""tk"" HAVING COUNT(""tk"")>=3)"
170,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""+1 AND ""S1"".""id""=""S3"".""id""+2) OR (""S2"".""id""=""S1"".""id""+1 AND ""S2"".""id""=""S3"".""id""+2) OR (""S3"".""id""=""S2"".""id""+1 AND ""S3"".""id""=""S1"".""id""+2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
171,"WITH ""s"" AS (SELECT ""s1"".""id"" AS ""id1"",""s1"".""visit_date"" AS ""date1"",""s1"".""people"" AS ""ppl1"",""s2"".""id"" AS ""id2"",""s2"".""visit_date"" AS ""date2"",""s2"".""people"" AS ""ppl2"",""s3"".""id"" AS ""id3"",""s3"".""visit_date"" AS ""date3"",""s3"".""people"" AS ""ppl3"" FROM (""Stadium"" AS ""s1"" LEFT JOIN ""Stadium"" AS ""s2"" ON ""s1"".""id""=""s2"".""id""-1) LEFT JOIN ""Stadium"" AS ""s3"" ON ""s2"".""id""=""s3"".""id""-1 WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT ""id1"" AS ""id"",""date1"" AS ""visit_date"",""ppl1"" AS ""people"" FROM ""s"" UNION SELECT ""id2"" AS ""id"",""date2"" AS ""visit_date"",""ppl2"" AS ""people"" FROM ""s"" UNION SELECT ""id3"" AS ""id"",""date3"" AS ""visit_date"",""ppl3"" AS ""people"" FROM ""s"" ORDER BY ""visit_date"""
172,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
173,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""lag1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""lag2"" FROM ""Stadium"") SELECT DISTINCT ""s"".""id"",""s"".""visit_date"",""s"".""people"" FROM ""Stadium"" AS ""s"" JOIN ""cte"" AS ""c"" ON ""s"".""id"" BETWEEN ""c"".""id""-2 AND ""c"".""id"" WHERE ""c"".""lag1"">=100 AND ""c"".""lag2"">=100 AND ""c"".""people"">=100"
174,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2 AND ""s2"".""id""-""s1"".""id""=1)) ORDER BY ""s1"".""id"""
175,"SELECT DISTINCT ""t1"".* FROM (""Stadium"" AS ""t1"" CROSS JOIN ""Stadium"" AS ""t2"") JOIN ""Stadium"" AS ""t3"" ON ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 ORDER BY ""t1"".""id"""
176,"WITH ""x"" AS (SELECT ""s1"".""id"" AS ""s1_id"",""s2"".""id"" AS ""s2_id"",""s3"".""id"" AS ""s3_id"" FROM (""stadium"" AS ""s1"" JOIN ""stadium"" AS ""s2"" ON ""s1"".""id""+1=""s2"".""id"" AND ""s1"".""people"">=100 AND ""s2"".""people"">=100) JOIN ""stadium"" AS ""s3"" ON ""s2"".""id""+1=""s3"".""id"" AND ""s2"".""people"">=100 AND ""s3"".""people"">=100), ""y"" AS (SELECT ""s1_id"" AS ""id"" FROM ""x"" UNION SELECT ""s2_id"" AS ""id"" FROM ""x"" UNION SELECT ""s3_id"" AS ""id"" FROM ""x"") SELECT * FROM ""stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""y"") ORDER BY ""visit_date"""
177,"SELECT ""stadium"".""id"",""stadium"".""visit_date"",""stadium"".""people"" FROM (""stadium"") CROSS JOIN (SELECT MIN(""id"") AS ""min_id"",MAX(""id"") AS ""max_id"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""id"") AS ""r_num"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""diff"" FROM ""Stadium"" WHERE ""people"">=100) AS ""temp"" GROUP BY ""diff"" HAVING COUNT(1)>=3) AS ""temp2"" WHERE ""stadium"".""id"">=""min_id"" AND ""stadium"".""id""<=""max_id"""
178,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
179,"WITH ""partitioned"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""grp"" FROM ""stadium"" WHERE ""people"">=100), ""counted"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""grp"") AS ""cnt"" FROM ""partitioned"") SELECT ""id"",""visit_date"",""people"" FROM ""counted"" WHERE ""cnt"">=3"
180,"SELECT DISTINCT ""a"".* FROM ((""stadium"" AS ""a"") CROSS JOIN ""stadium"" AS ""b"") CROSS JOIN ""stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""=""b"".""id""-1 AND ""a"".""id""=""c"".""id""-2) OR (""c"".""id""=""a"".""id""-1 AND ""c"".""id""=""b"".""id""-2) OR (""c"".""id""=""b"".""id""-1 AND ""c"".""id""=""a"".""id""-2)) ORDER BY ""a"".""id"""
181,"SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100 AND ((""id""+1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100) AND ""id""+2 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100)) OR (""id""+1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100) AND ""id""-1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100)) OR (""id""-1 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100) AND ""id""-2 IN (SELECT ""id"" FROM ""stadium"" WHERE ""people"">=100)))"
182,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""a"") AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
183,"SELECT * FROM ""stadium"" AS ""s"" WHERE ""s"".""people"">=100 AND ((EXISTS (SELECT 1 FROM ""stadium"" AS ""s1"" WHERE (""s"".""id""+1=""s1"".""id"") AND ""s1"".""people"">=100) AND EXISTS (SELECT 1 FROM ""stadium"" AS ""s2"" WHERE (""s"".""id""+2=""s2"".""id"") AND ""s2"".""people"">=100)) OR (EXISTS (SELECT 1 FROM ""stadium"" AS ""s3"" WHERE (""s"".""id""-1=""s3"".""id"") AND ""s3"".""people"">=100) AND EXISTS (SELECT 1 FROM ""stadium"" AS ""s4"" WHERE (""s"".""id""-2=""s4"".""id"") AND ""s4"".""people"">=100)) OR (EXISTS (SELECT 1 FROM ""stadium"" AS ""s5"" WHERE (""s"".""id""-1=""s5"".""id"") AND ""s5"".""people"">=100) AND EXISTS (SELECT 1 FROM ""stadium"" AS ""s6"" WHERE (""s"".""id""+1=""s6"".""id"") AND ""s6"".""people"">=100)))"
184,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LAG(""t1"".""id"", 1) OVER (ORDER BY ""t1"".""id"") AS ""prev_1_id"",LAG(""t1"".""id"", 2) OVER (ORDER BY ""t1"".""id"") AS ""prev_2_id"",LAG(""t1"".""id"", 1) OVER (ORDER BY ""t1"".""id"" DESC) AS ""after_1_id"",LAG(""t1"".""id"", 2) OVER (ORDER BY ""t1"".""id"" DESC) AS ""after_2_id"" FROM ""Stadium"" AS ""t1"" WHERE ""people"">=100) AS ""t1"" WHERE (""after_1_id""-""id""=1 AND ""after_2_id""-""after_1_id""=1) OR (""after_1_id""-""id""=1 AND ""id""-""prev_1_id""=1) OR (""id""-""prev_1_id""=1 AND ""prev_1_id""-""prev_2_id""=1) ORDER BY ""visit_date"""
185,"WITH ""T"" AS (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",""ID""-ROW_NUMBER() OVER (ORDER BY ""ID"") AS ""R"" FROM ""STADIUM"" WHERE ""PEOPLE"">=100) SELECT ""ID"",""VISIT_DATE"",""PEOPLE"" FROM ""T"" WHERE ""R"" IN (SELECT ""R"" FROM ""T"" GROUP BY ""R"" HAVING COUNT(""R"")>=3)"
186,"WITH ""T_100"" AS (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100) SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""T_100"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""+2 IN (SELECT ""id"" FROM ""T_100"")) OR (""id""-1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""+1 IN (SELECT ""id"" FROM ""T_100"")) OR (""id""-1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""-2 IN (SELECT ""id"" FROM ""T_100"")))"
187,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""-2=""s3"".""id"")) AND (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) ORDER BY ""s1"".""visit_date"""
188,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""ID"",""Visit_Date"",""People"",COUNT(1) OVER (ORDER BY ""id"" RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Following_cnt"",COUNT(1) OVER (ORDER BY ""id"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Preceding_cnt"",COUNT(1) OVER (ORDER BY ""id"" RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS ""Current_Count"" FROM (SELECT ""ID"",""Visit_Date"",""People"" FROM ""Stadium"" WHERE ""People"">=100) AS ""z"") AS ""ZZ"" WHERE ""Following_cnt""=3 OR ""Preceding_cnt""=3 OR ""Current_Count""=3"
189,"SELECT ""s3"".""id"",""s3"".""visit_date"",""s3"".""people"" FROM (((""stadium"" AS ""s3"" LEFT JOIN ""stadium"" AS ""s1"" ON ""s1"".""id""=""s3"".""id""-2) LEFT JOIN ""stadium"" AS ""s2"" ON ""s2"".""id""=""s3"".""id""-1) LEFT JOIN ""stadium"" AS ""s4"" ON ""s4"".""id""=""s3"".""id""+1) LEFT JOIN ""stadium"" AS ""s5"" ON ""s5"".""id""=""s3"".""id""+2 WHERE LEAST(""s1"".""people"", ""s2"".""people"", ""s3"".""people"")>=100 OR LEAST(""s2"".""people"", ""s3"".""people"", ""s4"".""people"")>=100 OR LEAST(""s3"".""people"", ""s4"".""people"", ""s5"".""people"")>=100 ORDER BY ""s3"".""id"""
190,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",CASE WHEN LAG(""id"", 2) OVER (ORDER BY ""id"")=""id""-2 THEN 1 ELSE 0 END+CASE WHEN LAG(""id"", 1) OVER (ORDER BY ""id"")=""id""-1 THEN 1 ELSE 0 END+CASE WHEN LEAD(""id"", 1) OVER (ORDER BY ""id"")=""id""+1 THEN 1 ELSE 0 END+CASE WHEN LEAD(""id"", 2) OVER (ORDER BY ""id"")=""id""+2 THEN 1 ELSE 0 END AS ""flag"" FROM (SELECT * FROM ""Stadium"" WHERE ""people"">=100) AS ""s"") AS ""sf"" WHERE ""sf"".""flag"">1 ORDER BY ""sf"".""id"""
191,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
192,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",COUNT(1) OVER (PARTITION BY ""DIFF"") AS ""ct"" FROM (SELECT ""id"",""visit_date"",""people"",(""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"")) AS ""diff"" FROM ""stadium"" WHERE ""people"">=100) AS ""x"") AS ""y"" WHERE ""ct"">=3"
193,"SELECT ""ID"",""visit_date"",""people"" FROM (SELECT ""ID"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nxt"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nxt2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""Stadium"") AS ""cte"" WHERE (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""nxt2"">=100) OR (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""pre"">=100) OR (""cte"".""people"">=100 AND ""cte"".""pre"">=100 AND ""cte"".""pre2"">=100)"
194,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""-""b"".""id""=1 AND ""a"".""id""-""c"".""id""=2 AND ""b"".""id""-""c"".""id""=1) OR (""b"".""id""-""a"".""id""=1 AND ""a"".""id""-""c"".""id""=1 AND ""b"".""id""-""c"".""id""=2) OR (""c"".""id""-""a"".""id""=2 AND ""b"".""id""-""a"".""id""=1)) ORDER BY ""visit_date"""
195,"SELECT DISTINCT ""t1"".* FROM ((""Stadium"" AS ""t1"") CROSS JOIN ""Stadium"" AS ""t2"") CROSS JOIN ""Stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""=""t2"".""id""-1 AND ""t2"".""id""=""t3"".""id""-1 AND ""t1"".""id""=""t3"".""id""-2) OR (""t2"".""id""=""t1"".""id""-1 AND ""t1"".""id""=""t3"".""id""-1 AND ""t2"".""id""=""t3"".""id""-2) OR (""t3"".""id""=""t2"".""id""-1 AND ""t2"".""id""=""t1"".""id""-1 AND ""t3"".""id""=""t1"".""id""-2)) ORDER BY ""t1"".""id"""
196,"WITH ""a"" AS (SELECT ""id"",""visit_date"",""people"",LAG(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""before_yesterday"",LAG(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""yesterday"",LEAD(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""tmr"",LEAD(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""day_after_tmr"" FROM ""Stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ""a"" WHERE (""a"".""id""+1=""a"".""tmr"" AND ""a"".""id""+2=""a"".""day_after_tmr"") OR (""a"".""id""-1=""a"".""yesterday"" AND ""a"".""id""+1=""a"".""tmr"") OR (""a"".""id""-2=""a"".""before_yesterday"" AND ""a"".""id""-1=""a"".""yesterday"")"
197,"SELECT ""ID"",""visit_date"",""people"" FROM (SELECT ""ID"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nxt"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nxt2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""Stadium"") AS ""cte"" WHERE (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""nxt2"">=100) OR (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""pre"">=100) OR (""cte"".""people"">=100 AND ""cte"".""pre"">=100 AND ""cte"".""pre2"">=100)"
198,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ((""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1) OR (""s2"".""id""=""s1"".""id""-1 AND ""s1"".""id""=""s3"".""id""-1) OR (""s2"".""id""=""s3"".""id""-1 AND ""s3"".""id""=""s1"".""id""-1)) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""visit_date"""
199,"SELECT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2 AND ""s2"".""id""-""s1"".""id""=1)) GROUP BY ""s1"".""id"" ORDER BY ""s1"".""id"""
200,"WITH ""cte1"" AS (SELECT * FROM ""Stadium"" WHERE ""people"">=100), ""cte2"" AS (SELECT ""id"",LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""next_id"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""next_id_2"" FROM ""cte1""), ""cte3"" AS (SELECT ""id"",""next_id"",""next_id_2"" FROM ""cte2"" WHERE (""next_id""=""id""+1) AND (""next_id_2""=""id""+2)), ""cte4"" AS (SELECT ""id"" FROM ""cte3"" UNION SELECT ""next_id"" AS ""id"" FROM ""cte3"" UNION SELECT ""next_id_2"" AS ""id"" FROM ""cte3"") SELECT * FROM ""stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""cte4"") ORDER BY ""visit_date"""
201,"WITH ""CTE"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""s"".""id"") AS ""diff"" FROM ""Stadium"" AS ""s"" WHERE ""s"".""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""CTE"" WHERE ""diff"" IN (SELECT ""diff"" FROM ""CTE"" GROUP BY ""diff"" HAVING COUNT(""diff"")>=3)"
202,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""rk"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""rk"" IN (SELECT ""rk"" FROM ""cte"" GROUP BY ""rk"" HAVING COUNT(""rk"")>=3)"
203,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2) OR (""s1"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s2"".""id""=2) OR (""s2"".""id""-""s3"".""id""=1 AND ""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2)) ORDER BY ""s1"".""visit_date"""
204,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
205,"WITH ""Cte1"" AS (SELECT * FROM ""Stadium"" WHERE ""people"">=100), ""Cte2"" AS (SELECT ""C1"".""id"" AS ""A"",""C2"".""id"" AS ""B"",""C3"".""id"" AS ""C"" FROM (""Cte1"" AS ""C1"" JOIN ""Cte1"" AS ""C2"" ON ""C1"".""id""=""C2"".""id""-1) JOIN ""Cte1"" AS ""C3"" ON ""C2"".""id""=""C3"".""id""-1), ""Cte3"" AS (SELECT ""A"" AS ""id"" FROM ""Cte2"" UNION SELECT ""B"" AS ""id"" FROM ""Cte2"" UNION SELECT ""C"" AS ""id"" FROM ""Cte2"") SELECT * FROM ""Stadium"" RIGHT JOIN ""Cte3"" USING (""id"") ORDER BY ""visit_date"""
206,"SELECT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 GROUP BY ""s1"".""id"" ORDER BY ""visit_date"""
207,"SELECT DISTINCT ""s0"".* FROM ((""Stadium"" AS ""s0"") CROSS JOIN ""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"" WHERE ""s0"".""people"">=100 AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ((""s0"".""id""+1=""s1"".""id"" AND ""s0"".""id""+2=""s2"".""id"") OR (""s0"".""id""-1=""s1"".""id"" AND ""s0"".""id""+1=""s2"".""id"") OR (""s0"".""id""-1=""s1"".""id"" AND ""s0"".""id""-2=""s2"".""id"")) ORDER BY ""visit_date"""
208,"WITH ""filtered"" AS (SELECT *,LAG(""people"", 2) OVER (ORDER BY ""ID"") AS ""prev_2"",LAG(""people"") OVER (ORDER BY ""ID"") AS ""prev_1"",LEAD(""people"") OVER (ORDER BY ""ID"") AS ""next_1"",LEAD(""people"", 2) OVER (ORDER BY ""ID"") AS ""next_2"" FROM ""stadium"") SELECT ""id"",""visit_date"",""people"" FROM ""filtered"" WHERE (""people"">=100 AND ""prev_1"">=100 AND ""prev_2"">=100) OR (""people"">=100 AND ""prev_1"">=100 AND ""next_1"">=100) OR (""people"">=100 AND ""next_1"">=100 AND ""next_2"">=100)"
209,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE (((""s1"".""id""+1=""s2"".""id"") AND (""s1"".""id""+2=""s3"".""id"")) OR ((""s1"".""id""-1=""s2"".""id"") AND (""s1"".""id""+1=""s3"".""id"")) OR ((""s1"".""id""-2=""s2"".""id"") AND (""s1"".""id""-1=""s3"".""id""))) AND (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) ORDER BY ""s1"".""id"""
210,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1) OR (""s2"".""id""=""s1"".""id""-1 AND ""s2"".""id""=""s3"".""id""-2) OR (""s3"".""id""=""s2"".""id""-1 AND ""s3"".""id""=""s1"".""id""-2)) ORDER BY ""s1"".""id"""
211,"WITH ""statium_lag_lead"" AS (SELECT ""id"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nxt1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nxt2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""stadium"") SELECT ""id"",""visit_date"",""people"" FROM ""statium_lag_lead"" WHERE ""people"">=100 AND ((""nxt1"">=100 AND ""nxt2"">=100) OR (""pre1"">=100 AND ""pre2"">=100) OR (""pre1"">=100 AND ""nxt1"">=100))"
212,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s2"".""id""+1=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""-2=""s3"".""id"")) AND (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) ORDER BY ""s1"".""visit_date"""
213,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
214,"WITH ""idz"" AS (SELECT ""s1"".""id"" AS ""id1"",""s2"".""id"" AS ""id2"",""s3"".""id"" AS ""id3"" FROM (""Stadium"" AS ""s1"" LEFT JOIN ""Stadium"" AS ""s2"" ON ""s1"".""id""=""s2"".""id""+1) LEFT JOIN ""Stadium"" AS ""s3"" ON ""s2"".""id""=""s3"".""id""+1 WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ""idz"" LEFT JOIN ""Stadium"" AS ""s1"" ON ""idz"".""id1""=""s1"".""id"" OR ""idz"".""id2""=""s1"".""id"" OR ""idz"".""id3""=""s1"".""id"" ORDER BY ""s1"".""visit_date"""
215,"SELECT ""ID"",""VISIT_DATE"",""PEOPLE"" FROM (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",LAG(""PEOPLE"") OVER (ORDER BY ""ID"") AS ""PREV1"",LAG(""PEOPLE"", 2) OVER (ORDER BY ""ID"") AS ""PREV2"",LEAD(""PEOPLE"") OVER (ORDER BY ""ID"") AS ""NEXT1"",LEAD(""PEOPLE"", 2) OVER (ORDER BY ""ID"") AS ""NEXT2"" FROM ""STADIUM"") AS ""SUB"" WHERE ""PEOPLE"">=100 AND (""PREV1"">=100 AND ""PREV2"">=100) OR ""PEOPLE"">=100 AND (""PREV1"">=100 AND ""NEXT1"">=100) OR ""PEOPLE"">=100 AND (""NEXT1"">=100 AND ""NEXT2"">=100)"
216,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""=""b"".""id""-1 AND ""a"".""id""=""c"".""id""-2) OR (""a"".""id""=""b"".""id""+1 AND ""a"".""id""=""c"".""id""-1) OR (""a"".""id""=""b"".""id""+2 AND ""a"".""id""=""c"".""id""+1))) AS ""d"" GROUP BY ""id"",""visit_date"",""people"" ORDER BY ""id"""
217,"SELECT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 GROUP BY ""s1"".""id"" ORDER BY ""s1"".""id"""
218,"WITH ""cte"" AS (SELECT *,LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""lag_p_1"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""lead_p_1"" FROM ""Stadium"") SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ""cte"" JOIN ""Stadium"" AS ""s1"" ON ""s1"".""id"" BETWEEN ""cte"".""id""-1 AND ""cte"".""id""+1 WHERE ""cte"".""people"">=100 AND ""cte"".""lag_p_1"">=100 AND ""cte"".""lead_p_1"">=100 ORDER BY ""visit_date"""
219,"SELECT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 GROUP BY ""s1"".""id"" ORDER BY ""s1"".""visit_date"""
220,"SELECT DISTINCT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ((""Stadium"" AS ""a"") CROSS JOIN ""Stadium"" AS ""b"") CROSS JOIN ""Stadium"" AS ""c"" WHERE ""a"".""people"">=100 AND ""b"".""people"">=100 AND ""c"".""people"">=100 AND ((""a"".""id""-""b"".""id""=1 AND ""a"".""id""-""c"".""id""=2) OR (""a"".""id""-""b"".""id""=1 AND ""a"".""id""-""c"".""id""=-1) OR (""a"".""id""-""b"".""id""=-1 AND ""a"".""id""-""c"".""id""=-2)) ORDER BY ""visit_date"""
221,"WITH ""cte1"" AS (SELECT * FROM ""stadium"" WHERE ""people"">=100) SELECT * FROM ""cte1"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""cte1"") AND ""id""+2 IN (SELECT ""id"" FROM ""cte1"")) OR (""id""-1 IN (SELECT ""id"" FROM ""cte1"") AND ""id""-2 IN (SELECT ""id"" FROM ""cte1"")) OR (""id""+1 IN (SELECT ""id"" FROM ""cte1"") AND ""id""-1 IN (SELECT ""id"" FROM ""cte1""))"
222,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
223,"WITH ""more"" AS (SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT DISTINCT ""id"",""visit_date"",""people"" FROM ""more"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""more"") AND ""id""+2 IN (SELECT ""id"" FROM ""more"")) OR (""id""-1 IN (SELECT ""id"" FROM ""more"") AND ""id""+1 IN (SELECT ""id"" FROM ""more"")) OR (""id""-1 IN (SELECT ""id"" FROM ""more"") AND ""id""-2 IN (SELECT ""id"" FROM ""more""))"
224,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
225,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
226,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
227,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2) OR (""t2"".""id""-""t1"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1 AND ""t3"".""id""-""t1"".""id""=1) OR (""t1"".""id""-""t2"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1 AND ""t3"".""id""=""t1"".""id""=1)) ORDER BY ""t1"".""id"""
228,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s2"".""id""=1) OR (""s1"".""id""-""s2"".""id""=1 AND ""s2"".""id""-""s3"".""id""=1) OR (""s1"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=1)) ORDER BY ""s1"".""id"""
229,"SELECT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ""Stadium"" AS ""s1"" WHERE ""s1"".""people"">=100 AND ((100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""+1) AND 100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""+2)) OR (100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""-1) AND 100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""-2)) OR (100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""-1) AND 100<=(SELECT ""people"" FROM ""Stadium"" WHERE ""id""=""s1"".""id""+1)))"
230,"ERROR: mysql parse error: line 1 column 207 near ""UNION (SELECT t2.id FROM stadium t1 JOIN stadium t2 ON t1.id = t2.id-1 JOIN stadium t3 ON t2.id = t3.id-1 WHERE t1.people >= 100 AND t2.people >= 100 AND t3.people >= 100) UNION (SELECT t3.id FROM stadium t1 JOIN stadium t2 ON t1.id = t2.id-1 JOIN stadium t3 ON t2.id = t3.id-1 WHERE t1.people >= 100 AND t2.people >= 100 AND t3.people >= 100) ) "" "
231,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""-""s2"".""id""=1 AND ""s1"".""id""-""s3"".""id""=2 AND ""s2"".""id""-""s3"".""id""=1) OR (""s2"".""id""-""s1"".""id""=1 AND ""s2"".""id""-""s3"".""id""=2 AND ""s1"".""id""-""s3"".""id""=1) OR (""s3"".""id""-""s2"".""id""=1 AND ""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s1"".""id""=2)) ORDER BY ""s1"".""id"""
232,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S1"".""id""=""S2"".""id""+1 AND ""S1"".""id""=""S3"".""id""+2) OR (""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""+1)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
233,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
234,"WITH ""cte"" AS (SELECT ""s1"".""id"" AS ""s1_id"",""s2"".""id"" AS ""s2_id"",""s3"".""id"" AS ""s3_id"" FROM (""stadium"" AS ""s1"" CROSS JOIN ""stadium"" AS ""s2"") JOIN ""stadium"" AS ""s3"" ON ""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2 WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""id"" IN (SELECT ""s1_id"" FROM ""cte"") OR ""id"" IN (SELECT ""s2_id"" FROM ""cte"") OR ""id"" IN (SELECT ""s3_id"" FROM ""cte"")"
235,"SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT DISTINCT ""a1"".""id"" FROM ((""Stadium"" AS ""a1"") CROSS JOIN ""Stadium"" AS ""a2"") CROSS JOIN ""Stadium"" AS ""a3"" WHERE ((""a1"".""id""+1=""a2"".""id"" AND ""a1"".""id""+2=""a3"".""id"") OR (""a1"".""id""=""a2"".""id""+1 AND ""a1"".""id""=""a3"".""id""+2) OR (""a1"".""id""=""a2"".""id""+1 AND ""a1"".""id""=""a3"".""id""-1)) AND ""a1"".""people"">=100 AND ""a2"".""people"">=100 AND ""a3"".""people"">=100) ORDER BY ""visit_date"""
236,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s2"".""id""-""s1"".""id""=1 AND ""s3"".""id""-""s2"".""id""=1) OR (""s1"".""id""-""s2"".""id""=1 AND ""s2"".""id""-""s3"".""id""=1) OR (""s1"".""id""-""s2"".""id""=1 AND ""s3"".""id""-""s1"".""id""=1)) ORDER BY ""s1"".""id"""
237,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ((""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""-1) OR (""s1"".""id""=""s2"".""id""+2 AND ""s1"".""id""=""s3"".""id""+1)) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""visit_date"""
238,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",(""id""-ROW_NUMBER() OVER (ORDER BY ""id"")) AS ""diffrow"" FROM ""stadium"" WHERE ""people"">=100), ""valuecount"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""diffrow"") AS ""countdiff"" FROM ""cte"") SELECT ""id"",""visit_date"",""people"" FROM ""valuecount"" WHERE ""countdiff"">=3 ORDER BY ""id"""
239,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
240,"SELECT ""s0"".""id"",""s0"".""visit_date"",""s0"".""people"" FROM (((""stadium"" AS ""s0"" LEFT JOIN ""stadium"" AS ""s_1"" ON ""s0"".""id""-1=""s_1"".""id"") LEFT JOIN ""stadium"" AS ""s_2"" ON ""s0"".""id""-2=""s_2"".""id"") LEFT JOIN ""stadium"" AS ""s1"" ON ""s0"".""id""+1=""s1"".""id"") LEFT JOIN ""stadium"" AS ""s2"" ON ""s0"".""id""+2=""s2"".""id"" WHERE ""s0"".""people"">=100 AND ((""s_1"".""people"">=100 AND ""s_2"".""people"">=100) OR (""s_1"".""people"">=100 AND ""s1"".""people"">=100) OR (""s1"".""people"">=100 AND ""s2"".""people"">=100)) ORDER BY 1"
241,"WITH ""cte"" AS (SELECT ""s1"".""id"" AS ""s1_id"",""s2"".""id"" AS ""s2_id"",""s3"".""id"" AS ""s3_id"" FROM (""stadium"" AS ""s1"" LEFT JOIN ""stadium"" AS ""s2"" ON ""s1"".""id""=""s2"".""id""-1) LEFT JOIN ""stadium"" AS ""s3"" ON ""s1"".""id""=""s3"".""id""-2 WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""id"" IN (SELECT ""s1_id"" FROM ""cte"") OR ""id"" IN (SELECT ""s2_id"" FROM ""cte"") OR ""id"" IN (SELECT ""s3_id"" FROM ""cte"")"
242,"SELECT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 GROUP BY ""s1"".""id"" ORDER BY ""s1"".""visit_date"""
243,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1)) ORDER BY ""t1"".""id"""
244,"SELECT DISTINCT ""stadium"".""id"",""stadium"".""visit_date"",""stadium"".""people"" FROM (""stadium"") CROSS JOIN (SELECT MIN(""id"") AS ""min_id"",MAX(""id"") AS ""max_id"" FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY ""id"") AS ""r_num"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""diff"" FROM ""Stadium"" WHERE ""people"">=100) AS ""temp"" GROUP BY ""diff"" HAVING COUNT(1)>=3) AS ""temp2"" WHERE ""stadium"".""id"">=""min_id"" AND ""stadium"".""id""<=""max_id"" ORDER BY ""visit_date"""
245,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",COUNT(""id"") OVER (PARTITION BY ""mygroup"") AS ""num_sequence"" FROM (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER () AS ""mygroup"" FROM ""stadium"" WHERE ""people"">=100) AS ""a"") AS ""b"" WHERE ""num_sequence"">=3"
246,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
247,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ((""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2) OR (""s3"".""id""=""s1"".""id""-1 AND ""s3"".""id""=""s2"".""id""-2) OR (""s2"".""id""=""s3"".""id""-1 AND ""s2"".""id""=""s1"".""id""-2)) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""id"""
248,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LEAD(""people"", 1, NULL) OVER () AS ""lead1"",LEAD(""people"", 2, NULL) OVER () AS ""lead2"",LAG(""people"", 1, NULL) OVER () AS ""lag1"",LAG(""people"", 2, NULL) OVER () AS ""lag2"" FROM ""Stadium"") AS ""T1"" WHERE ((""T1"".""people"">=100) AND (""T1"".""lead1"">=100) AND (""T1"".""lead2"">=100)) OR ((""T1"".""people"">=100) AND (""T1"".""lag1"">=100) AND (""T1"".""lag2"">=100)) OR ((""T1"".""people"">=100) AND (""T1"".""lead1"">=100) AND (""T1"".""lag1"">=100))"
249,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
250,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
251,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",LEAD(""people"") OVER (ORDER BY ""id"") AS ""next1"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""next2"",LAG(""people"") OVER (ORDER BY ""id"") AS ""prev1"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""prev2"" FROM ""stadium"") AS ""cons_sal"" WHERE (""people"">=100 AND ""next1"">=100 AND ""next2"">=100) OR (""people"">=100 AND ""prev1"">=100 AND ""prev2"">=100) OR ((""people"">=100 AND ""next1"">=100 AND ""prev1"">=100))"
252,"SELECT DISTINCT ""s1"".* FROM (""Stadium"" AS ""s1"" CROSS JOIN ""Stadium"" AS ""s2"") JOIN ""Stadium"" AS ""s3"" ON (""s1"".""id""=""s2"".""id""-1 AND ""s1"".""id""=""s3"".""id""-2) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""-1) OR (""s1"".""id""=""s2"".""id""+1 AND ""s1"".""id""=""s3"".""id""+2) WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY ""s1"".""visit_date"""
253,"SELECT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 GROUP BY ""s1"".""id"" ORDER BY ""s1"".""id"""
254,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""s"".""id"",""s"".""visit_date"",""s"".""people"",CASE WHEN LAG(""id"", 2) OVER (ORDER BY ""s"".""id"")=""id""-2 AND LAG(""id"", 1) OVER (ORDER BY ""s"".""id"")=""id""-1 THEN 1 WHEN LEAD(""id"", 1) OVER (ORDER BY ""s"".""id"")=""id""+1 AND LAG(""id"", 1) OVER (ORDER BY ""s"".""id"")=""id""-1 THEN 1 WHEN LEAD(""id"", 1) OVER (ORDER BY ""s"".""id"")=""id""+1 AND LEAD(""id"", 2) OVER (ORDER BY ""s"".""id"")=""id""+2 THEN 1 ELSE 0 END AS ""chk"" FROM ""stadium"" AS ""s"" WHERE ""people"">=100) AS ""t"" WHERE ""chk""=1"
255,"WITH ""TB"" AS (SELECT * FROM ""Stadium"" WHERE ""people"">=100) SELECT * FROM ""TB"" WHERE ""id""+1 IN (SELECT ""id"" FROM ""TB"") AND ""id""+2 IN (SELECT ""id"" FROM ""TB"") OR ""id""+1 IN (SELECT ""id"" FROM ""TB"") AND ""id""-1 IN (SELECT ""id"" FROM ""TB"") OR ""id""-1 IN (SELECT ""id"" FROM ""TB"") AND ""id""-2 IN (SELECT ""id"" FROM ""TB"")"
256,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
257,"WITH ""t"" AS (SELECT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1 AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) SELECT DISTINCT ""s"".* FROM (""Stadium"" AS ""s"") CROSS JOIN ""t"" WHERE ""s"".""id""=""t"".""id"" OR ""s"".""id""=""t"".""id""+1 OR ""s"".""id""=""t"".""id""+2"
258,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
259,"SELECT ""ID"",""visit_date"",""people"" FROM (SELECT ""ID"",""visit_date"",""people"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""nxt"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""nxt2"",LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""pre"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""pre2"" FROM ""Stadium"") AS ""cte"" WHERE (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""nxt2"">=100) OR (""cte"".""people"">=100 AND ""cte"".""nxt"">=100 AND ""cte"".""pre"">=100) OR (""cte"".""people"">=100 AND ""cte"".""pre"">=100 AND ""cte"".""pre2"">=100)"
260,"WITH ""temp"" AS (SELECT ""id"",""visit_date"",LAG(""people"", 2) OVER (ORDER BY ""visit_date"") AS ""pre_2_ppl"",LAG(""people"") OVER (ORDER BY ""visit_date"") AS ""pre_ppl"",""people"",LEAD(""people"") OVER (ORDER BY ""visit_date"") AS ""next_ppl"",LEAD(""people"", 2) OVER (ORDER BY ""visit_date"") AS ""next_2_ppl"" FROM ""Stadium"") SELECT DISTINCT ""id"",""visit_date"",""people"" FROM ""temp"" WHERE (""pre_ppl"">=100 AND ""people"">=100 AND ""next_ppl"">=100) OR (""people"">=100 AND ""next_ppl"">=100 AND ""next_2_ppl"">=100) OR (""pre_2_ppl"">=100 AND ""pre_ppl"">=100 AND ""people"">=100) ORDER BY ""visit_date"""
261,"SELECT DISTINCT ""S1"".* FROM (""stadium"" AS ""S1"" CROSS JOIN ""stadium"" AS ""S2"") JOIN ""stadium"" AS ""S3"" ON ((""S1"".""id""=""S2"".""id""-1 AND ""S1"".""id""=""S3"".""id""-2) OR (""S3"".""id""=""S1"".""id""-1 AND ""S3"".""id""=""S2"".""id""-2) OR (""S3"".""id""=""S2"".""id""-1 AND ""S3"".""id""=""S1"".""id""-2)) WHERE ""S1"".""people"">=100 AND ""S2"".""people"">=100 AND ""S3"".""people"">=100 ORDER BY ""S1"".""id"""
262,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"" FROM ""stadium"" WHERE ""people"">=100), ""cte2"" AS (SELECT ""id"",""visit_date"",LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""l1"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""l2"",""people"" FROM ""cte""), ""cte3"" AS (SELECT ""id"",""visit_date"",LEAD(""id"", 1) OVER (ORDER BY ""id"" DESC) AS ""l3"",LEAD(""id"", 2) OVER (ORDER BY ""id"" DESC) AS ""l4"",""people"" FROM ""cte"") SELECT ""cte2"".""id"",""cte2"".""visit_date"",""cte2"".""people"" FROM ""cte2"" JOIN ""cte3"" ON ""cte2"".""id""=""cte3"".""id"" WHERE (""l1""=""cte2"".""id""+1 AND ""l2""=""cte2"".""id""+2) OR (""l3""=""cte3"".""id""-1 AND ""l4""=""cte3"".""id""-2) OR (""l1""=""cte2"".""id""+1 AND ""l3""=""cte3"".""id""-1)"
263,"ERROR: mysql parse error: line 1 column 308 near ""union (select idlist2 from tmp) union (select idlist3 from tmp) ) order by visit_date"" "
264,"WITH ""cte1"" AS (SELECT * FROM ""stadium"" WHERE ""people"">=100) SELECT * FROM ""cte1"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""cte1"") AND ""id""+2 IN (SELECT ""id"" FROM ""cte1"")) OR (""id""-1 IN (SELECT ""id"" FROM ""cte1"") AND ""id""-2 IN (SELECT ""id"" FROM ""cte1"")) OR (""id""+1 IN (SELECT ""id"" FROM ""cte1"") AND ""id""-1 IN (SELECT ""id"" FROM ""cte1""))"
265,"SELECT * FROM ""stadium"" AS ""s"" WHERE EXISTS (SELECT ""s1"".""id"",""s2"".""id"",""s3"".""id"" FROM (""Stadium"" AS ""s1"" JOIN ""Stadium"" AS ""s2"" ON ""s1"".""id""+1=""s2"".""id"") JOIN ""Stadium"" AS ""s3"" ON ""s1"".""id""+2=""s3"".""id"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND (""s"".""id""=""s1"".""id"" OR ""s"".""id""=""s2"".""id"" OR ""s"".""id""=""s3"".""id"")) ORDER BY ""s"".""Id"""
266,"WITH ""result_stg"" AS (SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LEAD(""id"", 1) OVER (ORDER BY ""id"") AS ""lead_one"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead_two"",LAG(""id"", 1) OVER (ORDER BY ""id"") AS ""lag_one"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag_two"" FROM ""Stadium"" WHERE ""people"">=100) AS ""b"" WHERE ((""lead_one""=""id""+1 OR ""lag_one""=""id""-1) AND (""lead_two""=""id""+2 OR ""lag_two""=""id""-2)) OR (""lag_one""=""id""-1 AND ""lead_one""=""id""+1)) SELECT * FROM ""result_stg"" WHERE (SELECT COUNT(1) FROM ""result_stg"")>2"
267,"SELECT DISTINCT ""ID"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""people"">=100 AND ((""ID""+1 IN (SELECT ""ID"" FROM ""Stadium"" WHERE ""people"">=100) AND ""ID""-1 IN (SELECT ""ID"" FROM ""Stadium"" WHERE ""people"">=100)) OR (""ID""-1 IN (SELECT ""ID"" FROM ""Stadium"" WHERE ""people"">=100) AND ""ID""-2 IN (SELECT ""ID"" FROM ""Stadium"" WHERE ""people"">=100)) OR (""ID""+1 IN (SELECT ""ID"" FROM ""Stadium"" WHERE ""people"">=100) AND ""ID""+2 IN (SELECT ""ID"" FROM ""Stadium"" WHERE ""people"">=100))) ORDER BY 2"
268,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
269,"SELECT DISTINCT ""S1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1) OR (""s2"".""id""=""s3"".""id""-1 AND ""s3"".""id""=""s1"".""id""-1) OR (""s3"".""id""=""s1"".""id""-1 AND ""s1"".""id""=""s2"".""id""-1)) ORDER BY ""S1"".""ID"""
270,"WITH ""center"" AS (SELECT ""visit_date"" FROM (SELECT ""visit_date"",CASE WHEN ""people"">=100 AND ""bef"">=100 AND ""aft"">=100 THEN 1 ELSE 0 END AS ""check_"" FROM (SELECT *,LAG(""people"", 1) OVER () AS ""bef"",LEAD(""people"", 1) OVER () AS ""aft"" FROM ""stadium"") AS ""t1"") AS ""t2"" WHERE ""check_""=1) SELECT DISTINCT ""id"",""visit_date"",""people"" FROM (SELECT *,LAG(""visit_date"", 1) OVER () AS ""bef"",LEAD(""visit_date"", 1) OVER () AS ""aft"" FROM ""stadium"") AS ""t1"" WHERE ""visit_date"" IN (SELECT * FROM ""center"") OR ""bef"" IN (SELECT * FROM ""center"") OR ""aft"" IN (SELECT * FROM ""center"") ORDER BY ""id"""
271,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",""people"",COUNT(1) OVER (PARTITION BY ""DIFF"") AS ""ct"" FROM (SELECT ""id"",""visit_date"",""people"",(""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"",""Id"")) AS ""diff"" FROM ""stadium"" WHERE ""people"">=100) AS ""x"") AS ""y"" WHERE ""ct"">=3"
272,"SELECT DISTINCT ""s"".* FROM (SELECT *,LEAD(""people"", 1) OVER (ORDER BY ""visit_date"") AS ""next_people1"",LEAD(""people"", 2) OVER (ORDER BY ""visit_date"") AS ""next_people2"" FROM ""Stadium"") AS ""c"" JOIN ""Stadium"" AS ""s"" ON ""s"".""id"" BETWEEN ""c"".""id"" AND ""c"".""id""+2 WHERE ""c"".""people"">=100 AND ""c"".""next_people1"">=100 AND ""c"".""next_people2"">=100 ORDER BY ""s"".""visit_date"""
273,"SELECT DISTINCT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ((""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1) OR (""s2"".""id""=""s1"".""id""-1 AND ""s1"".""id""=""s3"".""id""-1) OR (""s3"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s1"".""id""-1)) AND ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 ORDER BY 1"
274,"SELECT * FROM ""stadium"" WHERE ""id"" IN (SELECT DISTINCT (""stadium"".""id"") FROM (""stadium"") CROSS JOIN (SELECT * FROM (SELECT *,CASE WHEN ""people"">=100 THEN @""count"":=@""count""+1 ELSE @""count"":=0 END AS ""gr"" FROM (""stadium"") CROSS JOIN (SELECT @""count"":=0) AS ""temp"") AS ""abc"" WHERE ""abc"".""gr"">=3) AS ""pqr"" WHERE ""stadium"".""id""=""pqr"".""id"" OR ""stadium"".""id""=""pqr"".""id""-1 OR ""stadium"".""id""=""pqr"".""id""-2)"
275,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,LAG(""people"", 1) OVER (ORDER BY ""id"") AS ""last_row"",LAG(""people"", 2) OVER (ORDER BY ""id"") AS ""last_2_row"",LEAD(""people"", 1) OVER (ORDER BY ""id"") AS ""next_row"",LEAD(""people"", 2) OVER (ORDER BY ""id"") AS ""next_2_row"" FROM ""Stadium"") AS ""n"" WHERE (""people"">=100 AND ""next_row"">=100 AND ""next_2_row"">=100) OR (""people"">=100 AND ""last_row"">=100 AND ""last_2_row"">=100) OR (""people"">=100 AND ""last_row"">=100 AND ""next_row"">=100)"
276,"SELECT ""s1"".* FROM ((""stadium"" AS ""s1"") CROSS JOIN ""stadium"" AS ""s2"") CROSS JOIN ""stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""id""+1=""s2"".""id"" AND ""s1"".""id""+2=""s3"".""id"") OR (""s1"".""id""-1=""s2"".""id"" AND ""s1"".""id""+1=""s3"".""id"") OR (""s1"".""id""-2=""s2"".""id"" AND ""s1"".""id""-1=""s3"".""id"")) GROUP BY ""s1"".""id"" ORDER BY ""s1"".""visit_date"""
277,"WITH ""cte"" AS (SELECT ""id"",""visit_date"",""people"",(""id""-ROW_NUMBER() OVER (ORDER BY ""id"")) AS ""diffrow"" FROM ""stadium"" WHERE ""people"">=100), ""valuecount"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""diffrow"") AS ""countdiff"" FROM ""cte"") SELECT ""id"",""visit_date"",""people"" FROM ""valuecount"" WHERE ""countdiff"">=3"
278,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
279,"SELECT ""s3"".""id"",""s3"".""visit_date"",""s3"".""people"" FROM (((""stadium"" AS ""s3"" LEFT JOIN ""stadium"" AS ""s1"" ON ""s1"".""id""=""s3"".""id""-2) LEFT JOIN ""stadium"" AS ""s2"" ON ""s2"".""id""=""s3"".""id""-1) LEFT JOIN ""stadium"" AS ""s4"" ON ""s4"".""id""=""s3"".""id""+1) LEFT JOIN ""stadium"" AS ""s5"" ON ""s5"".""id""=""s3"".""id""+2 WHERE LEAST(""s1"".""people"", ""s2"".""people"", ""s3"".""people"")>=100 OR LEAST(""s2"".""people"", ""s3"".""people"", ""s4"".""people"")>=100 OR LEAST(""s3"".""people"", ""s4"".""people"", ""s5"".""people"")>=100 ORDER BY ""s3"".""id"""
280,"SELECT * FROM ""stadium"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM (""stadium"") CROSS JOIN (SELECT ""id1"",""id2"",""id3"" FROM (SELECT ""n1"".""id"" AS ""id1"",""n2"".""id"" AS ""id2"",""n3"".""id"" AS ""id3"",""n1"".""people"" AS ""people1"",""n2"".""people"" AS ""people2"",""n3"".""people"" AS ""people3"" FROM ((SELECT * FROM ""stadium"" WHERE ""people"">=100) AS ""n1"" LEFT JOIN (SELECT * FROM ""stadium"" WHERE ""people"">=100) AS ""n2"" ON ""n1"".""id""=""n2"".""id""-1) LEFT JOIN (SELECT * FROM ""stadium"" WHERE ""people"">=100) AS ""n3"" ON ""n2"".""id""=""n3"".""id""-1) AS ""n4"" WHERE ""people1""+""people2""+""people3"" IS NOT NULL) AS ""n5"" WHERE (""id""=""n5"".""id1"") OR (""id""=""n5"".""id2"") OR (""id""=""n5"".""id3""))"
281,"WITH ""temp"" AS (SELECT ""id"",""visit_date"",""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""consecutive"" FROM ""stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""temp"" WHERE ""consecutive"" IN (SELECT ""consecutive"" FROM ""temp"" GROUP BY ""consecutive"" HAVING COUNT(""id"")>2) ORDER BY ""visit_date"""
282,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""id"",""visit_date"",LAG(""people"", 2, 0) OVER (ORDER BY ""visit_date"") AS ""lag2"",LAG(""people"", 1, 0) OVER (ORDER BY ""visit_date"") AS ""lag1"",""people"",LEAD(""people"", 1, 0) OVER (ORDER BY ""visit_date"") AS ""lead1"",LEAD(""people"", 2, 0) OVER (ORDER BY ""visit_date"") AS ""lead2"" FROM ""stadium"") AS ""tb"" WHERE ""people"">=100 AND ((""lag1"">=100 AND (""lag2"">=100 OR ""lead1"">=100)) OR (""lead1"">=100 AND ""lead2"">=100))"
283,"SELECT ""t1"".""id"",""t1"".""visit_date"",""t1"".""people"" FROM (""stadium"" AS ""t1"" LEFT JOIN ""stadium"" AS ""t2"" ON ""t2"".""id""=""t1"".""id""+1) LEFT JOIN ""stadium"" AS ""t3"" ON ""t3"".""id""=""t1"".""id""+2 WHERE ""t1"".""people"">99 AND ""t2"".""people"">99 AND ""t3"".""people"">99 UNION SELECT ""t1"".""id"",""t1"".""visit_date"",""t1"".""people"" FROM (""stadium"" AS ""t1"" LEFT JOIN ""stadium"" AS ""t2"" ON ""t2"".""id""=""t1"".""id""-1) LEFT JOIN ""stadium"" AS ""t3"" ON ""t3"".""id""=""t1"".""id""+1 WHERE ""t1"".""people"">99 AND ""t2"".""people"">99 AND ""t3"".""people"">99 UNION SELECT ""t1"".""id"",""t1"".""visit_date"",""t1"".""people"" FROM (""stadium"" AS ""t1"" LEFT JOIN ""stadium"" AS ""t2"" ON ""t2"".""id""=""t1"".""id""-1) LEFT JOIN ""stadium"" AS ""t3"" ON ""t3"".""id""=""t1"".""id""-2 WHERE ""t1"".""people"">99 AND ""t2"".""people"">99 AND ""t3"".""people"">99 ORDER BY ""id"""
284,"WITH ""cte"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""visit_date"") AS ""diff_row"" FROM ""Stadium"" WHERE ""people"">=100), ""cte1"" AS (SELECT ""id"",""visit_date"",""people"",COUNT(""diff_row"") OVER (PARTITION BY ""diff_row"" ORDER BY ""id"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""ct"" FROM ""cte"") SELECT ""id"",""visit_date"",""people"" FROM ""cte1"" WHERE ""ct"">2"
285,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
286,"WITH ""CTE"" AS (SELECT *,CASE WHEN ""people"">99 THEN 1 ELSE NULL END AS ""Attended"" FROM ""Stadium"") SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,SUM(""Attended"") OVER (ORDER BY ""id"" ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Cons_f"",SUM(""Attended"") OVER (ORDER BY ""id"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Cons_p"",SUM(""Attended"") OVER (ORDER BY ""id"" ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS ""Cons_m"" FROM ""CTE"") AS ""ABC"" WHERE ""Cons_f""=3 OR ""Cons_p""=3 OR ""Cons_m""=3 ORDER BY ""visit_date"""
287,"WITH ""CTE"" AS (SELECT *,CASE WHEN ""people"">99 THEN 1 ELSE NULL END AS ""Attended"" FROM ""Stadium"") SELECT ""id"",""visit_date"",""people"" FROM (SELECT *,SUM(""Attended"") OVER (ORDER BY ""id"" ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Cons_f"",SUM(""Attended"") OVER (ORDER BY ""id"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Cons_p"",SUM(""Attended"") OVER (ORDER BY ""id"" ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS ""Cons_m"" FROM ""CTE"") AS ""ABC"" WHERE ""Cons_f""=3 OR ""Cons_p""=3 OR ""Cons_m""=3 ORDER BY ""visit_date"""
288,"WITH ""cte"" AS (SELECT *,""id""-(ROW_NUMBER() OVER (ORDER BY ""id"")) AS ""diff"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""diff"" IN (SELECT ""diff"" FROM ""cte"" GROUP BY ""diff"" HAVING COUNT(""diff"")>=3) ORDER BY ""id"""
289,"SELECT DISTINCT ""s1"".""id"",""s1"".""visit_date"",""s1"".""people"" FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE (""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100) AND ((""s1"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s3"".""id""-1) OR (""s2"".""id""=""s1"".""id""-1 AND ""s1"".""id""=""s3"".""id""-1) OR (""s3"".""id""=""s2"".""id""-1 AND ""s2"".""id""=""s1"".""id""-1)) ORDER BY ""s1"".""visit_date"""
290,"SELECT ""id"",""visit_date"",""people"" FROM ""Stadium"" WHERE ""id"" IN (SELECT ""T1"".""id"" FROM (""Stadium"" AS ""T1"" JOIN ""Stadium"" AS ""T2"" ON ""T1"".""id""=""T2"".""id""+1) JOIN ""Stadium"" AS ""T3"" ON ""T1"".""id""=""T3"".""id""+2 WHERE ""T1"".""people"">=100 AND ""T2"".""people"">=100 AND ""T3"".""people"">=100 UNION SELECT ""T2"".""id"" FROM (""Stadium"" AS ""T1"" JOIN ""Stadium"" AS ""T2"" ON ""T1"".""id""=""T2"".""id""+1) JOIN ""Stadium"" AS ""T3"" ON ""T1"".""id""=""T3"".""id""+2 WHERE ""T1"".""people"">=100 AND ""T2"".""people"">=100 AND ""T3"".""people"">=100 UNION SELECT ""T3"".""id"" FROM (""Stadium"" AS ""T1"" JOIN ""Stadium"" AS ""T2"" ON ""T1"".""id""=""T2"".""id""+1) JOIN ""Stadium"" AS ""T3"" ON ""T1"".""id""=""T3"".""id""+2 WHERE ""T1"".""people"">=100 AND ""T2"".""people"">=100 AND ""T3"".""people"">=100) ORDER BY ""visit_date"""
291,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
292,"WITH ""T_100"" AS (SELECT ""id"" FROM ""Stadium"" WHERE ""people"">=100) SELECT * FROM ""Stadium"" WHERE ""id"" IN (SELECT ""id"" FROM ""T_100"" WHERE (""id""+1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""+2 IN (SELECT ""id"" FROM ""T_100"")) OR (""id""-1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""+1 IN (SELECT ""id"" FROM ""T_100"")) OR (""id""-1 IN (SELECT ""id"" FROM ""T_100"") AND ""id""-2 IN (SELECT ""id"" FROM ""T_100"")))"
293,"WITH ""TEMP"" AS (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",""ID""-ROW_NUMBER() OVER (ORDER BY ""ID"") AS ""GRP"" FROM ""STADIUM"" WHERE ""PEOPLE"">=100), ""TEMP2"" AS (SELECT ""ID"",""VISIT_DATE"",""PEOPLE"",COUNT(""ID"") OVER (PARTITION BY ""GRP"") AS ""CNT"" FROM ""TEMP"") SELECT ""ID"",""VISIT_DATE"",""PEOPLE"" FROM ""TEMP2"" WHERE ""CNT"">=3 ORDER BY 2"
294,"WITH ""a"" AS (SELECT ""id"",""visit_date"",""people"",LAG(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""before_yesterday"",LAG(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""yesterday"",LEAD(""id"", 1) OVER (ORDER BY ""visit_date"") AS ""tmr"",LEAD(""id"", 2) OVER (ORDER BY ""visit_date"") AS ""day_after_tmr"" FROM ""Stadium"" WHERE ""people"">=100 ORDER BY ""id"") SELECT ""a"".""id"",""a"".""visit_date"",""a"".""people"" FROM ""a"" WHERE (""a"".""id""+1=""a"".""tmr"" AND ""a"".""id""+2=""a"".""day_after_tmr"") OR (""a"".""id""-1=""a"".""yesterday"" AND ""a"".""id""+1=""a"".""tmr"") OR (""a"".""id""-2=""a"".""before_yesterday"" AND ""a"".""id""-1=""a"".""yesterday"")"
295,"WITH ""greater"" AS (SELECT * FROM ""Stadium"" WHERE ""people"">=100), ""joined"" AS (SELECT ""greater"".""id"",""greater"".""visit_date"",""greater"".""people"",""g2"".""id"" AS ""next_id"" FROM ""greater"" LEFT JOIN ""greater"" AS ""g2"" ON ""greater"".""id""=""g2"".""id""-1), ""labeled"" AS (SELECT ""id"",""visit_date"",""people"",@""label"" AS ""label"",CASE WHEN ""next_id"" IS NULL THEN @""label"":=@""label""+1 ELSE @""label"" END AS ""temp"" FROM (""joined"") CROSS JOIN (SELECT @""label"":=0) AS ""labels""), ""counted"" AS (SELECT ""id"",""visit_date"",""people"",COUNT(1) OVER (PARTITION BY ""label"") AS ""counts"" FROM ""labeled"") SELECT ""id"",""visit_date"",""people"" FROM ""counted"" WHERE ""counts"">=3 ORDER BY ""visit_date"""
296,"WITH ""t1"" AS (SELECT ""s"".""id"",""s"".""visit_date"",""s"".""people"",""id""-ROW_NUMBER() OVER (ORDER BY ""s"".""visit_date"") AS ""rs"" FROM ""Stadium"" AS ""s"" WHERE ""s"".""people"">=100) SELECT ""t"".""id"",""t"".""visit_date"",""t"".""people"" FROM ""t1"" AS ""t"" LEFT JOIN (SELECT ""rs"",COUNT(""rs"") AS ""cnt"" FROM ""t1"" GROUP BY ""rs"") AS ""s"" ON ""s"".""rs""=""t"".""rs"" WHERE ""s"".""cnt"">2"
297,"SELECT DISTINCT ""t1"".* FROM ((""stadium"" AS ""t1"") CROSS JOIN ""stadium"" AS ""t2"") CROSS JOIN ""stadium"" AS ""t3"" WHERE ""t1"".""people"">=100 AND ""t2"".""people"">=100 AND ""t3"".""people"">=100 AND ((""t1"".""id""-""t2"".""id""=1 AND ""t1"".""id""-""t3"".""id""=2 AND ""t2"".""id""-""t3"".""id""=1) OR (""t2"".""id""-""t1"".""id""=1 AND ""t2"".""id""-""t3"".""id""=2 AND ""t1"".""id""-""t3"".""id""=1) OR (""t3"".""id""-""t2"".""id""=1 AND ""t2"".""id""-""t1"".""id""=1 AND ""t3"".""id""-""t1"".""id""=2)) ORDER BY ""t1"".""id"""
298,"WITH ""cte"" AS (SELECT *,""id""-ROW_NUMBER() OVER (ORDER BY ""id"") AS ""gap"" FROM ""Stadium"" WHERE ""people"">=100) SELECT ""id"",""visit_date"",""people"" FROM ""cte"" WHERE ""gap"" IN (SELECT ""gap"" FROM ""cte"" GROUP BY ""gap"" HAVING COUNT(1)>=3)"
299,"SELECT DISTINCT ""s1"".* FROM ((""Stadium"" AS ""s1"") CROSS JOIN ""Stadium"" AS ""s2"") CROSS JOIN ""Stadium"" AS ""s3"" WHERE ""s1"".""people"">=100 AND ""s2"".""people"">=100 AND ""s3"".""people"">=100 AND ((""s1"".""Id""+1=""s2"".""Id"" AND ""s2"".""Id""+1=""s3"".""Id"" AND ""s1"".""Id""+2=""s3"".""Id"") OR (""s1"".""Id""=""s2"".""Id""+1 AND ""s1"".""Id""+1=""s3"".""Id"" AND ""s2"".""Id""+2=""s3"".""Id"") OR (""s1"".""Id""=""s2"".""Id""+1 AND ""s2"".""id""=""s3"".""id""+1 AND ""s3"".""id""+2=""s1"".""id"")) ORDER BY ""s1"".""visit_date"""
300,"WITH ""CTE"" AS (SELECT ""A"".""id"" AS ""AID"",""A"".""visit_date"" AS ""AVD"",""A"".""people"" AS ""AP"",""B"".""id"" AS ""BID"",""B"".""visit_date"" AS ""BVD"",""B"".""people"" AS ""BP"",""C"".""id"" AS ""CID"",""C"".""visit_date"" AS ""CVD"",""C"".""people"" AS ""CP"" FROM (""Stadium"" AS ""A"" JOIN ""Stadium"" AS ""B"" ON ""A"".""id""+1=""B"".""id"") JOIN ""Stadium"" AS ""C"" ON ""B"".""id""+1=""C"".""id"" WHERE ""A"".""people"">=100 AND ""B"".""people"">=100 AND ""C"".""people"">=100) SELECT ""AID"" AS ""id"",""AVD"" AS ""visit_date"",""AP"" AS ""people"" FROM ""CTE"" UNION SELECT ""BID"" AS ""id"",""BVD"" AS ""visit_date"",""BP"" AS ""people"" FROM ""CTE"" UNION SELECT ""CID"" AS ""id"",""CVD"" AS ""visit_date"",""CP"" AS ""people"" FROM ""CTE"" ORDER BY ""visit_date"""
301,"SELECT ""id"",""visit_date"",""people"" FROM (SELECT ""t"".""id"",""t"".""visit_date"",""t"".""people"",LAG(""id"") OVER (ORDER BY ""id"") AS ""lag1"",LAG(""id"", 2) OVER (ORDER BY ""id"") AS ""lag2"",LEAD(""id"") OVER (ORDER BY ""id"") AS ""lead1"",LEAD(""id"", 2) OVER (ORDER BY ""id"") AS ""lead2"" FROM ""stadium"" AS ""t"" WHERE ""people"">=100) AS ""t"" WHERE ((""lag1""+1=""id"" AND ""id""=""lag2""+2) OR (""id""=""lead1""-1 AND ""id""=""lead2""-2) OR (""id""=""lead1""-1 AND ""id""=""lag1""+1))"
