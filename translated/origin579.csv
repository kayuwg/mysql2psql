id,original query
1,"WITH ""cte1"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""cte1"" WHERE ""ranking""!=1 ORDER BY ""id"",""month"" DESC"
2,"WITH ""id_cumu"" AS (SELECT ""a"".""id"",""a"".""month"",""a"".""salary"",MAX(""a"".""month"") OVER (PARTITION BY ""a"".""id"") AS ""mx_mon"" FROM ""Employee"" AS ""a"" GROUP BY 1,2,3) SELECT ""a"".""id"",""a"".""month"",SUM(""b"".""salary"") AS ""Salary"" FROM ""id_cumu"" AS ""a"" LEFT JOIN ""id_cumu"" AS ""b"" ON (""a"".""month""-""b"".""month"") BETWEEN 0 AND 2 AND ""a"".""id""=""b"".""id"" WHERE ""a"".""mx_mon""!=""a"".""month"" GROUP BY 1,2 ORDER BY 1,2 DESC"
3,"WITH ""c"" AS (SELECT ""id"",""month"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""mrnk"" FROM ""Employee"") SELECT ""id"",""month"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""mrnk"" ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Salary"" FROM ""c"" WHERE ""mrnk"">1 ORDER BY ""id"",""month"" DESC"
4,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rank_num"" FROM ""employee"") AS ""cte"" WHERE ""rank_num""!=1 ORDER BY 1,2 DESC"
5,"WITH ""temp"" AS (SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""ranking"" FROM ""Employee"") AS ""t"" WHERE ""ranking""!=1) SELECT ""t"".""Id"",""t"".""Month"",SUM(""u"".""Salary"") AS ""Salary"" FROM ""temp"" AS ""t"" JOIN ""temp"" AS ""u"" ON ""t"".""Id""=""u"".""Id"" WHERE ""t"".""Month"">=""u"".""Month"" AND ""t"".""Month""-""u"".""Month""<=2 GROUP BY ""t"".""Id"",""t"".""Month"" ORDER BY ""t"".""Id"",""t"".""Month"" DESC"
6,"WITH ""t"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""e"" LEFT JOIN (SELECT ""Id"" AS ""Id2"",MAX(""Month"") AS ""recentMonth"" FROM ""Employee"" GROUP BY ""Id"") AS ""gt"" ON ""e"".""Id""=""gt"".""Id2"" WHERE ""Month""!=""recentMonth"") SELECT * FROM ""t"" ORDER BY ""Id"",""Month"" DESC"
7,"WITH ""cte1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""r1"" FROM ""employee"") SELECT ""Id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""cte1"" WHERE ""r1""!=1 ORDER BY ""id"",""month"" DESC"
8,"SELECT ""Id"",""Month"",""Salary""+LAG(""salary"", 1, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"")+LAG(""salary"", 2, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary"" FROM ""Employee"" AS ""E"" WHERE ""month""<(SELECT MAX(""E1"".""month"") FROM ""Employee"" AS ""E1"" WHERE ""E"".""Id""=""E1"".""Id"") ORDER BY ""Id"",""Month"" DESC"
9,"WITH ""cte"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cum_salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rk"" FROM ""Employee"") SELECT ""Id"",""Month"",""cum_salary"" AS ""Salary"" FROM ""cte"" WHERE ""rk""!=1 ORDER BY ""Id"",""Month"" DESC"
10,"WITH ""cte"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""id"",""month"",""salary"" FROM ""cte"" WHERE ""rnk""!=1"
11,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
12,"SELECT ""ID"",""MONTH"",SUM(""SALARY"") OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM (SELECT ""ID"",""MONTH"",""SALARY"",DENSE_RANK() OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" DESC) AS ""RN_MONTH"" FROM ""Employee"") AS ""T"" WHERE ""RN_MONTH"">1 ORDER BY 1,2 DESC"
13,"SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""descending_rank"",SUM(""salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""employee"") AS ""_"" WHERE ""descending_rank""!=1 ORDER BY ""Id"",""Month"" DESC"
14,"WITH ""c"" AS (SELECT ""id"",""month"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""mrnk"" FROM ""Employee"") SELECT ""id"",""month"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""mrnk"" ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Salary"" FROM ""c"" WHERE ""mrnk"">1 ORDER BY ""id"",""month"" DESC"
15,"WITH ""Ranking"" AS (SELECT ""id"",""month"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""Month"" DESC) AS ""ranks"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""runSalary"" FROM ""Employee"") SELECT ""Id"",""Month"",""runSalary"" AS ""Salary"" FROM ""Ranking"" WHERE ""ranks""!=1 ORDER BY ""Id"",""Month"" DESC"
16,"WITH ""CTE"" AS (SELECT ""ID"",""MONTH"",""SALARY"" AS ""CUR_SAL"",ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" DESC) AS ""MONTH_ORD"",LAG(""SALARY"") OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"") AS ""PREV1"",LAG(""SALARY"", 2) OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"") AS ""PREV2"" FROM ""EMPLOYEE"") SELECT ""Id"",""Month"",(""CUR_SAL""+COALESCE(""PREV1"", 0)+COALESCE(""PREV2"", 0)) AS ""Salary"" FROM ""CTE"" WHERE ""MONTH_ORD"">1 ORDER BY 1,2 DESC"
17,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",LAG(""month"", 1) OVER (PARTITION BY ""id"" ORDER BY ""Month"") AS ""month"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Salary"" FROM ""Employee"") AS ""a"" WHERE ""salary"" IS NOT NULL ORDER BY 1,2 DESC"
18,"SELECT ""Id"",""Month"",""Salary_sum"" AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary_sum"",MAX(""Month"") OVER (PARTITION BY ""Id"") AS ""max_month"" FROM ""Employee"") AS ""t"" WHERE ""Month""!=""max_month"" ORDER BY ""Id"",""Month"" DESC"
19,"SELECT ""u"".""id"",""u"".""month"",""u"".""salary""+COALESCE(LAG(""u"".""salary"", 1) OVER (PARTITION BY ""id"" ORDER BY ""month""), 0)+COALESCE(LAG(""u"".""salary"", 2) OVER (PARTITION BY ""id"" ORDER BY ""month""), 0) AS ""salary"" FROM (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rn"" FROM ""employee"") AS ""t"" WHERE ""t"".""rn""!=1) AS ""u"" ORDER BY ""id"",""month"" DESC"
20,"SELECT ""id"",""month"",""tot"" AS ""salary"" FROM (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rk"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""tot"" FROM ""Employee"") AS ""T"" WHERE ""rk""!=1 ORDER BY ""id"",""month"" DESC"
21,"WITH ""mrm"" AS (SELECT ""id"",MAX(""month"") AS ""most_recent"" FROM ""Employee"" GROUP BY 1), ""pastThreeMonth"" AS (SELECT ""id"",""month"",""salary"",LAG(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"") AS ""salary_1"",LAG(""salary"", 2) OVER (PARTITION BY ""id"" ORDER BY ""month"") AS ""salary_2"" FROM ""Employee"") SELECT ""p"".""id"",""p"".""month"",""p"".""salary""+COALESCE(""salary_1"", 0)+COALESCE(""salary_2"", 0) AS ""salary"" FROM ""pastThreeMonth"" AS ""p"" LEFT JOIN ""mrm"" AS ""m"" ON ""p"".""id""=""m"".""id"" AND ""p"".""month""=""m"".""most_recent"" WHERE ""m"".""most_recent"" IS NULL ORDER BY 1,2 DESC"
22,"WITH ""cte"" AS (SELECT ""ID"",""month"",""salary"",RANK() OVER (PARTITION BY ""ID"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""ID"",""month"",(SELECT SUM(""salary"") AS ""salary"" FROM ""cte"" AS ""C2"" WHERE ""C2"".""id""=""C1"".""ID"" AND ""C2"".""month"" BETWEEN ""C1"".""month""-2 AND ""C1"".""month"") AS ""salary"" FROM ""cte"" AS ""C1"" WHERE ""rnk"">1 ORDER BY ""id"",""month"" DESC"
23,"SELECT ""t"".""id"",""t"".""month"",SUM(""t1"".""salary"") AS ""salary"" FROM (SELECT ""e"".""id"",""e"".""month"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN (SELECT ""id"",MAX(""month"") AS ""mx_mn"" FROM ""employee"" GROUP BY ""id"") AS ""t"" ON ""t"".""id""=""e"".""id"" AND ""e"".""month""!=""t"".""mx_mn"") AS ""t"" JOIN (SELECT ""e"".""id"",""e"".""month"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN (SELECT ""id"",MAX(""month"") AS ""mx_mn"" FROM ""employee"" GROUP BY ""id"") AS ""t"" ON ""t"".""id""=""e"".""id"" AND ""e"".""month""!=""t"".""mx_mn"") AS ""t1"" ON ""t"".""id""=""t1"".""id"" AND ""t"".""month"">=""t1"".""month"" AND ""t"".""month""-""t1"".""month"" BETWEEN 0 AND 2 GROUP BY ""t"".""id"",""t"".""month"" HAVING COUNT(""t1"".""month"")<=3 ORDER BY ""t"".""id"",""t"".""month"" DESC"
24,"WITH ""employee_not_recent_month"" AS (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY ""id"") SELECT ""t1"".""id"",""t1"".""month"",SUM(""t2"".""salary"") AS ""salary"" FROM (SELECT * FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",""month"" FROM ""employee_not_recent_month"")) AS ""t1"" JOIN (SELECT * FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",""month"" FROM ""employee_not_recent_month"")) AS ""t2"" ON ""t2"".""id""=""t1"".""id"" AND ""t1"".""month""-""t2"".""month"" BETWEEN 0 AND 2 GROUP BY ""t1"".""id"",""t1"".""month"" ORDER BY ""t1"".""id"",""t1"".""month"" DESC"
25,"SELECT ""id"",""month"",""salary"" FROM (SELECT DISTINCT ""id"",LAG(""month"", 1) OVER (PARTITION BY ""id"" ORDER BY ""Month"") AS ""month"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Salary"" FROM ""Employee"") AS ""a"" WHERE ""salary"" IS NOT NULL ORDER BY 1,2 DESC"
26,"SELECT ""a"".""Id"",""a"".""Month"",(""a"".""Salary""+""b"".""Salary_l1""+""c"".""Salary_l2"") AS ""Salary"" FROM ((""Employee"" AS ""a"" LEFT JOIN (SELECT ""Id"",""Month"",LAG(""Salary"", 1, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary_l1"" FROM ""Employee"") AS ""b"" ON ""a"".""Id""=""b"".""Id"" AND ""a"".""Month""=""b"".""Month"") LEFT JOIN (SELECT ""Id"",""Month"",LAG(""Salary"", 2, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary_l2"" FROM ""Employee"") AS ""c"" ON ""a"".""Id""=""c"".""Id"" AND ""a"".""Month""=""c"".""Month"") LEFT JOIN (SELECT ""Id"",""Month"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""ranking"" FROM ""Employee"") AS ""d"" ON ""a"".""Id""=""d"".""Id"" AND ""a"".""Month""=""d"".""Month"" WHERE ""d"".""ranking"">1 ORDER BY ""a"".""Id"",""a"".""Month"" DESC"
27,"WITH ""rank_month"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_rank"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cumulative_salary"" FROM ""employee"" GROUP BY 1,2) SELECT ""id"",""month"",""cumulative_salary"" AS ""salary"" FROM ""rank_month"" WHERE ""month_rank""!=1 ORDER BY ""id"",""month"" DESC"
28,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
29,"WITH ""Cleaned"" AS (SELECT ""Id"",MAX(""Month"") AS ""LastMonth"" FROM ""Employee"" GROUP BY ""Id"") SELECT ""E"".""Id"" AS ""Id"",""E"".""Month"" AS ""Month"",SUM(""E"".""Salary"") OVER (PARTITION BY ""E"".""Id"" ORDER BY ""E"".""Month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""E"" LEFT JOIN ""Cleaned"" AS ""C"" ON ""E"".""Id""=""C"".""Id"" AND ""E"".""Month""=""C"".""LastMonth"" WHERE ""C"".""Id"" IS NULL ORDER BY ""E"".""Id"",""E"".""Month"" DESC"
30,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",MAX(""Month"") OVER (PARTITION BY ""Id"") AS ""max_month"" FROM ""Employee"") AS ""sub"" WHERE ""Month""!=""max_month"" ORDER BY ""Id"",""Month"" DESC"
31,"WITH ""t1"" AS (SELECT *,SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cum_salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""Month"") AS ""row_num"" FROM ""Employee"") SELECT ""a"".""id"",""a"".""month"",""a"".""cum_salary"" AS ""salary"" FROM ""t1"" AS ""a"" WHERE ""a"".""row_num"" NOT IN (SELECT MAX(""row_num"") FROM ""t1"" AS ""b"" WHERE ""b"".""id""=""a"".""id"") ORDER BY ""id"",""month"" DESC"
32,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
33,"WITH ""rank_month"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_rank"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cumulative_salary"" FROM ""employee"" GROUP BY 1,2,3 ORDER BY 1,2) SELECT ""id"",""month"",""cumulative_salary"" AS ""salary"" FROM ""rank_month"" WHERE ""month_rank""!=1 ORDER BY ""id"",""month"" DESC"
34,"SELECT ""ID"",""MONTH"",""SALARY"" FROM (SELECT ""ID"",""MONTH"",SUM(""SALARY"") OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" DESC) AS ""rnum"" FROM ""EMPLOYEE"") AS ""t1"" WHERE ""rnum"">1 ORDER BY ""ID"",""MONTH"" DESC"
35,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
36,"SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""salary"") AS ""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month"">=""e2"".""month"" AND (""e1"".""Month""-""e2"".""Month"") BETWEEN 0 AND 2 WHERE ""e1"".""month""<(SELECT MAX(""month"") FROM ""employee"" AS ""e3"" WHERE ""e1"".""id""=""e3"".""id"") GROUP BY 1,2 ORDER BY 1,2 DESC"
37,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
38,"SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"") AS ""t"" WHERE ""Month""!=(SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""t"".""Id"") ORDER BY ""Id"",""Month"" DESC"
39,"WITH ""base"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""most_recent_rank"" FROM ""employee"") SELECT ""id"",""month"",""salary"" FROM ""base"" WHERE ""most_recent_rank""!=1 ORDER BY ""id"",""month"" DESC"
40,"WITH ""recent_months"" AS (SELECT ""id"",MAX(""month"") AS ""max_month"" FROM ""employee"" GROUP BY ""id"" HAVING COUNT(1)>1) SELECT ""e1"".""id"",""e1"".""month"",(COALESCE(""e1"".""salary"", 0)+COALESCE(""e2"".""salary"", 0)+COALESCE(""e3"".""salary"", 0)) AS ""salary"" FROM ((""employee"" AS ""e1"" LEFT JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e2"".""month""=""e1"".""month""-1) LEFT JOIN ""employee"" AS ""e3"" ON ""e1"".""id""=""e3"".""id"" AND ""e3"".""month""=""e1"".""month""-2) LEFT JOIN ""recent_months"" AS ""rm"" ON ""e1"".""id""=""rm"".""id"" WHERE ""rm"".""max_month""!=""e1"".""month"" ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
41,"WITH ""cte"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""cte"" WHERE ""rnk""!=1 ORDER BY 1,2 DESC"
42,"SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""salary"") AS ""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month"">=""e2"".""month"" AND (""e1"".""Month""-""e2"".""Month"") BETWEEN 0 AND 2 WHERE ""e1"".""month""<(SELECT MAX(""month"") FROM ""employee"" AS ""e3"" WHERE ""e1"".""id""=""e3"".""id"") GROUP BY 1,2 ORDER BY 1,2 DESC"
43,"WITH ""max_month"" AS (SELECT ""Id"",MAX(""Month"") AS ""max_month"" FROM ""Employee"" GROUP BY ""Id"") SELECT ""e"".""Id"" AS ""id"",""e"".""Month"" AS ""month"",SUM(""e"".""Salary"") OVER (PARTITION BY ""e"".""Id"" ORDER BY ""e"".""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""max_month"" AS ""m"" ON ""e"".""Id""=""m"".""Id"" AND ""e"".""Month""!=""m"".""max_month"" ORDER BY ""e"".""Id"",""e"".""Month"" DESC"
44,"WITH ""EmployeeRanked"" AS (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""MonthRank"" FROM ""Employee"") SELECT ""id"",""month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""MonthRank"" DESC ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""EmployeeRanked"" WHERE ""MonthRank"">1 ORDER BY 1,2 DESC"
45,"WITH ""cte"" AS (SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""t"" WHERE ""rnk"">1) SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""cte"" ORDER BY 1,2 DESC"
46,"SELECT ""id"",""month"",""salary""+COALESCE(LAG(""salary"", 1) OVER (PARTITION BY ""id"" ORDER BY ""month""), 0)+COALESCE(LAG(""salary"", 2) OVER (PARTITION BY ""id"" ORDER BY ""month""), 0) AS ""Salary"" FROM (SELECT * FROM (SELECT ""id"",""month"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rn"" FROM ""employee"") AS ""x_inner"" WHERE ""rn"">1) AS ""x"" ORDER BY ""id"",""month"" DESC"
47,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
48,"WITH ""a"" AS (SELECT ""Id"",""Month"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""c"" FROM ""Employee"") SELECT ""Id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""a"" WHERE ""c"">1 ORDER BY ""id"",""month"" DESC"
49,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
50,"WITH ""cte"" AS (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""cte"" WHERE ""rnk""!=1 ORDER BY 1,2 DESC"
51,"SELECT ""e1"".""id"",""e1"".""month"",(COALESCE(""e1"".""salary"", 0)+COALESCE(""e2"".""salary"", 0)+COALESCE(""e3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""mostrecent"" LEFT JOIN ""employee"" AS ""e1"" ON (""mostrecent"".""id""=""e1"".""id"" AND ""mostrecent"".""month"">""e1"".""month"")) LEFT JOIN ""employee"" AS ""e2"" ON (""e2"".""id""=""e1"".""id"" AND ""e2"".""month""=""e1"".""month""-1)) LEFT JOIN ""employee"" AS ""e3"" ON (""e3"".""id""=""e1"".""id"" AND ""e3"".""month""=""e1"".""month""-2) ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
52,"WITH ""max_month"" AS (SELECT ""ID"",MAX(""month"") AS ""max_month"" FROM ""Employee"" GROUP BY ""ID""), ""exclude_max"" AS (SELECT ""a"".* FROM ""Employee"" AS ""a"" LEFT JOIN ""max_month"" AS ""b"" ON ""a"".""ID""=""b"".""ID"" AND ""a"".""Month""=""b"".""max_month"" WHERE ""b"".""ID"" IS NULL), ""three_month"" AS (SELECT ""ID"",""Month"",""Salary"",COALESCE(LAG(""Salary"", 1) OVER (PARTITION BY ""ID"" ORDER BY ""Month""), 0) AS ""prev_salary"",COALESCE(LAG(""Salary"", 2) OVER (PARTITION BY ""ID"" ORDER BY ""Month""), 0) AS ""prev2_salary"" FROM ""exclude_max"") SELECT ""ID"",""Month"",""Salary""+""prev_salary""+""prev2_salary"" AS ""Salary"" FROM ""three_month"" ORDER BY ""Id"",""Month"" DESC"
53,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY 1) ORDER BY 1,2 DESC"
54,"WITH ""table1"" AS (SELECT DISTINCT ""e"".""Id"",""e"".""Month"",""e"".""Salary"" FROM ""Employee"" AS ""e"" LEFT JOIN (SELECT ""Id"",MAX(""Month"") AS ""mnth"" FROM ""Employee"" AS ""f"" GROUP BY ""Id"") AS ""gh"" ON ""e"".""Id""=""gh"".""Id"" AND ""e"".""Month""=""gh"".""mnth"" WHERE ""gh"".""Id"" IS NULL AND ""gh"".""mnth"" IS NULL) SELECT ""a"".""Id"",""a"".""Month"",SUM(""a"".""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""a"".""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""table1"" AS ""a"" ORDER BY ""ID"",""Month"" DESC"
55,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""Month_Rank"" FROM ""Employee"") SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""t"" WHERE ""Month_Rank""!=1 ORDER BY ""Id"",""Month"" DESC"
56,"WITH ""Cleaned"" AS (SELECT ""Id"",MAX(""Month"") AS ""LastMonth"" FROM ""Employee"" GROUP BY ""Id"") SELECT ""E"".""Id"" AS ""Id"",""E"".""Month"" AS ""Month"",SUM(""E"".""Salary"") OVER (PARTITION BY ""E"".""Id"" ORDER BY ""E"".""Month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""E"" LEFT JOIN ""Cleaned"" AS ""C"" ON ""E"".""Id""=""C"".""Id"" AND ""E"".""Month""=""C"".""LastMonth"" WHERE ""C"".""Id"" IS NULL ORDER BY ""E"".""Id"",""E"".""Month"" DESC"
57,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""ranking"" FROM ""Employee"") SELECT ""t1"".""Id"",""t1"".""Month"",SUM(""t2"".""Salary"") AS ""Salary"" FROM ""t1"" JOIN ""t1"" AS ""t2"" ON ""t1"".""Id""=""t2"".""Id"" WHERE ""t1"".""ranking""<=""t2"".""ranking"" AND ""t1"".""ranking""+3>""t2"".""ranking"" AND ""t1"".""ranking"">1 AND ""t2"".""ranking"">1 GROUP BY ""t1"".""Id"",""t1"".""Month"""
58,"SELECT ""e"".""id"",""e"".""month"",(SELECT SUM(""s"".""salary"") FROM ""employee"" AS ""s"" WHERE ""s"".""id""=""e"".""id"" AND ""s"".""month"" IN (""e"".""month"",""e"".""month""-1,""e"".""month""-2)) AS ""Salary"" FROM ""employee"" AS ""e"" WHERE ""month""!=(SELECT MAX(""month"") FROM ""employee"" AS ""m"" WHERE ""m"".""id""=""e"".""id"") ORDER BY ""id"",""month"" DESC"
59,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
60,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rank_"" FROM ""employee"" ORDER BY 1,2 DESC) AS ""a"" WHERE ""rank_""!=1 ORDER BY 1,2 DESC"
61,"SELECT ""Id"",""Month"",""Salary_sum"" AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary_sum"",MAX(""Month"") OVER (PARTITION BY ""Id"") AS ""max_month"" FROM ""Employee"") AS ""t"" WHERE ""Month""!=""max_month"" ORDER BY ""Id"",""Month"" DESC"
62,"WITH ""temp"" AS (SELECT DISTINCT ""id"",""month"",""salary"" FROM (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee"") AS ""t"" WHERE ""ranking""!=1) SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""temp"" ORDER BY ""id"",""month"" DESC"
63,"SELECT ""Id"",""Month"",COALESCE(LAG(""Salary"", 1) OVER (PARTITION BY ""Id"" ORDER BY ""Month""), 0)+COALESCE(LAG(""Salary"", 2) OVER (PARTITION BY ""Id"" ORDER BY ""Month""), 0)+""Salary"" AS ""Salary"" FROM ""Employee"" WHERE ROW(""id"",""Month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""max_mon"" FROM ""Employee"" GROUP BY ""id"") ORDER BY ""Id"",""Month"" DESC"
64,"SELECT ""B"".""Id"",""B"".""Month"",""B"".""Salary"" FROM (SELECT ""A"".""Id"",""A"".""Month"",""A"".""three_months_sal"" AS ""Salary"",ROW_NUMBER() OVER (PARTITION BY ""A"".""Id"" ORDER BY ""A"".""Month"" DESC) FROM (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""three_months_sal"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"")) AS ""A"") AS ""B"""
65,"SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""salary"") AS ""Salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month"">=""e2"".""month"" AND (""e1"".""month""-""e2"".""month"") BETWEEN 0 AND 2 AND ""e1"".""month""<(SELECT MAX(""month"") FROM ""employee"" AS ""e3"" WHERE ""e1"".""id""=""e3"".""id"") GROUP BY 1,2 ORDER BY 1,2 DESC"
66,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rk"" FROM ""Employee"") AS ""b"" WHERE ""rk""!=1 ORDER BY ""Id"",""Month"" DESC"
67,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""E"" WHERE ""Month""!=(SELECT MAX(""Month"") FROM ""Employee"" AS ""EE"" WHERE ""E"".""Id""=""EE"".""Id"" GROUP BY ""EE"".""Id"") ORDER BY ""Id"",""Month"" DESC"
68,"SELECT ""a"".""id"",""a"".""month"",""a"".""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rank"" FROM ""Employee"") AS ""a"" WHERE ""a"".""rank""!=1 ORDER BY ""a"".""id"",""a"".""month"" DESC"
69,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
70,"SELECT ""tb1"".""id"",""tb1"".""month"",""tb1"".""Salary"" FROM (SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON (""e1"".""id""=""e2"".""id"" AND ""e1"".""month"">=""e2"".""month"" AND (""e1"".""month""-""e2"".""month"")<=2) GROUP BY ""e1"".""id"",""e1"".""month"") AS ""tb1"" JOIN (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"") AS ""tb2"" ON ""tb1"".""id""=""tb2"".""id"" AND ""tb1"".""month""!=""tb2"".""month"" ORDER BY ""tb1"".""id"",""tb1"".""month"" DESC"
71,"SELECT ""B"".""Id"",""B"".""Month"",""B"".""Salary"" FROM (SELECT ""A"".""Id"",""A"".""Month"",""A"".""three_months_sal"" AS ""Salary"",ROW_NUMBER() OVER (PARTITION BY ""A"".""Id"" ORDER BY ""A"".""Month"" DESC) FROM (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""three_months_sal"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"")) AS ""A"") AS ""B"""
72,"SELECT ""a"".""Id"",""a"".""Month"",(""a"".""Salary""+""b"".""Salary_l1""+""c"".""Salary_l2"") AS ""Salary"" FROM ((""Employee"" AS ""a"" LEFT JOIN (SELECT ""Id"",""Month"",LAG(""Salary"", 1, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary_l1"" FROM ""Employee"") AS ""b"" ON ""a"".""Id""=""b"".""Id"" AND ""a"".""Month""=""b"".""Month"") LEFT JOIN (SELECT ""Id"",""Month"",LAG(""Salary"", 2, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary_l2"" FROM ""Employee"") AS ""c"" ON ""a"".""Id""=""c"".""Id"" AND ""a"".""Month""=""c"".""Month"") LEFT JOIN (SELECT ""Id"",""Month"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""ranking"" FROM ""Employee"") AS ""e"" ON ""a"".""Id""=""e"".""Id"" AND ""a"".""Month""=""e"".""Month"" WHERE ""e"".""ranking"">1 ORDER BY ""a"".""Id"",""a"".""Month"" DESC"
73,"SELECT ""id"",""month"",(SELECT SUM(""salary"") FROM ""employee"" AS ""e2"" WHERE ""e1"".""Id""=""e2"".""Id"" AND ""e2"".""Month""<=""e1"".""Month"" AND ""e2"".""Month"">(""e1"".""Month""-3)) AS ""Salary"" FROM ""employee"" AS ""e1"" WHERE ""e1"".""Month""<(SELECT MAX(""month"") FROM ""employee"" WHERE ""id""=""e1"".""id"" GROUP BY ""id"") ORDER BY ""Id"",""Month"" DESC"
74,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""e1"" WHERE ""month""!=(SELECT MAX(""month"") FROM ""Employee"" AS ""e2"" WHERE ""e1"".""id""=""e2"".""id"") ORDER BY ""id"",""month"" DESC"
75,"SELECT ""E1"".""id"",""E1"".""Month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
76,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
77,"SELECT ""t1"".""id"",""t1"".""month"",SUM(""t2"".""salary"") AS ""salary"" FROM ""employee"" AS ""t1"" JOIN ""employee"" AS ""t2"" ON ""t2"".""id""=""t1"".""id"" AND (""t2"".""month""=""t1"".""month"" OR ""t2"".""month""=""t1"".""month""-1 OR ""t2"".""month""=""t1"".""month""-2) WHERE ROW(""t1"".""id"",""t1"".""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"") GROUP BY ""t1"".""id"",""t1"".""month"" ORDER BY ""t1"".""id"",""t1"".""month"" DESC"
78,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""employee"" GROUP BY 1) ORDER BY ""Id"",""month"" DESC"
79,"WITH ""recent_months"" AS (SELECT ""id"",MAX(""month"") AS ""max_month"" FROM ""employee"" GROUP BY ""id"" HAVING COUNT(1)>1) SELECT ""e1"".""id"",""e1"".""month"",(""e1"".""salary""+COALESCE(""e2"".""salary"", 0)+COALESCE(""e3"".""salary"", 0)) AS ""salary"" FROM ((""employee"" AS ""e1"" LEFT JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e2"".""month""=""e1"".""month""-1) LEFT JOIN ""employee"" AS ""e3"" ON ""e1"".""id""=""e3"".""id"" AND ""e3"".""month""=""e1"".""month""-2) LEFT JOIN ""recent_months"" AS ""rm"" ON ""e1"".""id""=""rm"".""id"" WHERE ""rm"".""max_month""!=""e1"".""month"" ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
80,"SELECT ""a"".""Id"",""a"".""Month"",SUM(""b"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""a"" JOIN ""Employee"" AS ""b"" ON ""a"".""Id""=""b"".""Id"" AND ""b"".""Month"" BETWEEN (""a"".""Month""-2) AND ""a"".""Month"" WHERE ROW(""a"".""Id"",""a"".""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"") GROUP BY ""a"".""Id"",""a"".""Month"" ORDER BY ""Id"",""Month"" DESC"
81,"WITH ""last_month"" AS (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY ""id"") SELECT ""a"".""id"",""a"".""month"",SUM(""b"".""salary"") AS ""salary"" FROM (""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""month"">=""b"".""month"" AND ""a"".""month""<""b"".""month""+3) JOIN ""last_month"" AS ""l"" ON ""l"".""id""=""a"".""id"" AND ""a"".""month""<""l"".""month"" GROUP BY ""a"".""id"",""a"".""month"",""a"".""salary"" ORDER BY ""a"".""id"",""a"".""month"" DESC"
82,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM (SELECT *,MAX(""Month"") OVER (PARTITION BY ""Id"") AS ""recent_mon"" FROM ""Employee"") AS ""recent"" WHERE ""Month""!=""recent_mon"" ORDER BY ""Id"",""Month"" DESC"
83,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1)) AS ""t"" ORDER BY 1,2 DESC"
84,"WITH ""cte1"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee""), ""cte2"" AS (SELECT ""id"",""month"",""salary"" FROM ""cte1"" WHERE ""ranking""!=1) SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte2"" ORDER BY ""id"",""month"" DESC"
85,"SELECT ""E1"".""Id"",""E1"".""Month"",(COALESCE(""E1"".""Salary"", 0)+COALESCE(""E2"".""Salary"", 0)+COALESCE(""E3"".""Salary"", 0)) AS ""Salary"" FROM (((SELECT ""Id"",MAX(""Month"") AS ""Month"" FROM ""Employee"" GROUP BY ""Id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON ""maxmonth"".""Id""=""E1"".""Id"" AND ""maxmonth"".""Month"">""E1"".""Month"") LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""Id""=""E2"".""Id"" AND ""E2"".""Month""=""E1"".""Month""-1) LEFT JOIN ""Employee"" AS ""E3"" ON ""E3"".""Id""=""E1"".""Id"" AND ""E3"".""Month""=""E1"".""Month""-2 ORDER BY ""Id"",""Month"" DESC"
86,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
87,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1 ORDER BY 1 DESC) ORDER BY 1,2 DESC"
88,"SELECT ""e1"".""id"",""e1"".""month"",(SELECT SUM(""e2"".""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""id""=""e1"".""id"" AND ""e2"".""month"">=""e1"".""month""-2 AND ""e2"".""month""<=""e1"".""month"" GROUP BY ""e2"".""id"") AS ""Salary"" FROM ""employee"" AS ""e1"" WHERE ""e1"".""month"" NOT IN (SELECT MAX(""e3"".""month"") FROM ""employee"" AS ""e3"" WHERE ""e3"".""id""=""e1"".""id"") GROUP BY ""e1"".""id"",""e1"".""month"" ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
89,"WITH ""cte"" AS (SELECT * FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"")), ""cte_1"" AS (SELECT *,RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""cte"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte"" ORDER BY 1,2 DESC"
90,"SELECT ""tmp"".""id"",""tmp"".""month"",""tmp"".""sal""+""tmp"".""lag1""+""tmp"".""lag2"" AS ""Salary"" FROM (SELECT ""A"".""ID"" AS ""id"",""A"".""MONTH"" AS ""month"",""A"".""SALARY"" AS ""sal"",LAG(""A"".""SALARY"", 1, 0) OVER (PARTITION BY ""A"".""ID"" ORDER BY ""A"".""MONTH"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""lag1"",LAG(""A"".""SALARY"", 2, 0) OVER (PARTITION BY ""A"".""ID"" ORDER BY ""A"".""MONTH"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""lag2"" FROM ""Employee"" AS ""A"" WHERE ROW(""A"".""ID"",""A"".""MONTH"") NOT IN (SELECT ""ID"",MAX(""MONTH"") AS ""cnt"" FROM ""Employee"" GROUP BY ""ID"") ORDER BY ""A"".""ID"",""A"".""MONTH"" DESC) AS ""tmp"""
91,"WITH ""tbMaxM"" AS (SELECT ""id"",MAX(""MONTH"") AS ""max_month"" FROM ""employee"" GROUP BY ""id""), ""tbAll"" AS (SELECT ""e1"".""Id"",""e1"".""Month"",SUM(""e2"".""salary"") AS ""cum_salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month""-""e2"".""month""<3 AND ""e1"".""month""-""e2"".""month"">=0 GROUP BY ""e1"".""Id"",""e1"".""Month"") SELECT ""tbAll"".""Id"",""tbAll"".""Month"",""tbAll"".""cum_Salary"" AS ""Salary"" FROM ""tbAll"" JOIN ""tbMaxM"" ON ""tbAll"".""id""=""tbMaxM"".""id"" AND ""tbAll"".""month""!=""tbMaxM"".""max_month"" ORDER BY ""tbAll"".""Id"",""tbAll"".""Month"" DESC"
92,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" AS ""e"" WHERE ""Month"" NOT IN (SELECT MAX(""Month"") FROM ""Employee"" AS ""e1"" WHERE ""e"".""id""=""e1"".""id"") ORDER BY ""Id"",""Month"" DESC"
93,"WITH ""Employee_sort"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""Month"" DESC) AS ""rk"" FROM ""Employee""), ""Employee_exclude_recent"" AS (SELECT * FROM ""Employee_sort"" WHERE ""rk""!=1) SELECT ""a"".""Id"",""a"".""Month"",SUM(""b"".""Salary"") AS ""Salary"" FROM (""Employee_exclude_recent"" AS ""a"") CROSS JOIN ""Employee_exclude_recent"" AS ""b"" WHERE ""a"".""Id""=""b"".""Id"" AND ""b"".""Month"" BETWEEN ""a"".""Month""-2 AND ""a"".""Month"" GROUP BY 1,2 ORDER BY ""a"".""Id"",""a"".""Month"" DESC"
94,"WITH ""EmployeeLastMonth"" AS (SELECT ""Id"",MAX(""Month"") AS ""LastMonth"" FROM ""Employee"" GROUP BY ""Id""), ""CumulativeSalary"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" WHERE CONCAT(""Id"", '-', ""Month"") NOT IN (SELECT CONCAT(""Id"", '-', ""LastMonth"") FROM ""EmployeeLastMonth"")) SELECT * FROM ""CumulativeSalary"" ORDER BY ""Id"",""Month"" DESC"
95,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""req"" FROM ""Employee"") AS ""a"" WHERE ""a"".""req"">1 ORDER BY ""a"".""id"",""a"".""month"" DESC"
96,"SELECT ""id"",""month"",""Salary"" FROM (SELECT ""Id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""dr"" FROM ""Employee"" GROUP BY 1,2) AS ""a"" WHERE ""dr"">1 ORDER BY 1,2 DESC"
97,"SELECT ""id"",""month"",""cum"" AS ""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cum"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rk"" FROM ""employee"") AS ""r1"" WHERE ""rk""!=1 ORDER BY 1,2 DESC"
98,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""a"" WHERE ""rnk""!=1"
99,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
100,"WITH ""3m_employee"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" DESC RANGE BETWEEN 0 PRECEDING AND 2 FOLLOWING) AS ""salary_3m"",ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""month"" DESC) AS ""RowNumber"" FROM ""Employee"") SELECT ""Id"",""Month"",""salary_3m"" AS ""Salary"" FROM ""3m_employee"" WHERE ""RowNumber"">1 ORDER BY ""Id"",""Month"" DESC"
101,"SELECT ""e"".""Id"",""e"".""Month"",SUM(""e"".""Salary"") OVER (PARTITION BY ""e"".""Id"" ORDER BY ""e"".""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""e"" WHERE ""e"".""Month""!=(SELECT MAX(""e1"".""Month"") FROM ""Employee"" AS ""e1"" WHERE ""e"".""Id""=""e1"".""Id"") ORDER BY 1,2 DESC"
102,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
103,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"") ORDER BY ""id"",""month"" DESC"
104,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1 ORDER BY 1 DESC) ORDER BY 1,2 DESC"
105,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1 ORDER BY 1 DESC) ORDER BY 1,2 DESC"
106,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") AS ""T"" WHERE ""RNK""!=1 ORDER BY ""ID"",""MONTH"" DESC"
107,"SELECT ""e1"".""id"",""e1"".""month"",(COALESCE(""e1"".""salary"", 0)+COALESCE(""e2"".""salary"", 0)+COALESCE(""e3"".""salary"", 0)) AS ""salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""employee"" AS ""e1"" ON (""maxmonth"".""id""=""e1"".""id"" AND ""maxmonth"".""month"">""e1"".""month"")) LEFT JOIN ""employee"" AS ""e2"" ON ""e2"".""id""=""e1"".""id"" AND ""e2"".""month""=""e1"".""month""-1) LEFT JOIN ""employee"" AS ""e3"" ON ""e3"".""id""=""e1"".""id"" AND ""e3"".""month""=""e1"".""month""-2 ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
108,"SELECT ""e1"".""id"" AS ""Id"",""e1"".""month"" AS ""Month"",SUM(COALESCE(""e1"".""Salary"", 0)+COALESCE(""e2"".""Salary"", 0)+COALESCE(""e3"".""Salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""e1"" ON ""maxmonth"".""month"">""e1"".""month"" AND ""maxmonth"".""id""=""e1"".""id"") LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""Id""=""e2"".""Id"" AND ""e1"".""Month""-""e2"".""Month""=1) LEFT JOIN ""Employee"" AS ""e3"" ON ""e1"".""Id""=""e3"".""Id"" AND ""e1"".""Month""-""e3"".""Month""=2 GROUP BY ""e1"".""id"",""e1"".""Month"" ORDER BY 1,2 DESC"
109,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT * FROM (SELECT *,MAX(""month"") OVER (PARTITION BY ""id"") AS ""mm"" FROM ""employee"") AS ""e"" WHERE ""month""!=""mm"") AS ""ee"" ORDER BY ""id"",""month"" DESC"
110,"SELECT ""e1"".""Id"",""e1"".""Month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""e1"") CROSS JOIN ""Employee"" AS ""e2"" WHERE ""e1"".""Id""=""e2"".""Id"" AND ""e1"".""Month""-""e2"".""Month"" IN (0,1,2) AND ROW(""e1"".""Id"",""e1"".""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"") GROUP BY ""e1"".""Id"",""e1"".""Month"" ORDER BY ""e1"".""Id"",""e1"".""Month"" DESC"
111,"WITH ""cte"" AS (SELECT ""e1"".* FROM ""employee"" AS ""e1"" WHERE ""e1"".""month""!=(SELECT MAX(""e2"".""month"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""id""=""e1"".""id"")) SELECT ""id"" AS ""id"",""month"" AS ""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""cte"" ORDER BY ""id"",""month"" DESC"
112,"SELECT ""a"".""id"",""a"".""month"" AS ""month"",SUM(""b"".""salary"") AS ""Salary"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND (""a"".""month""-""b"".""month"") BETWEEN 0 AND 2 WHERE ROW(""a"".""id"",""a"".""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"") GROUP BY 1,2 ORDER BY 1,2 DESC"
113,"SELECT ""E1"".""Id"" AS ""id"",""E1"".""Month"" AS ""month"",SUM(""E2"".""Salary"") AS ""salary"" FROM ""Employee"" AS ""E1"" CROSS JOIN ""Employee"" AS ""E2"" WHERE ""E1"".""Id""=""E2"".""Id"" AND ""E1"".""Month""-""E2"".""Month"" BETWEEN 0 AND 2 AND ""E1"".""Month""<(SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""E1"".""Id"") GROUP BY ""E1"".""Id"",""E1"".""Month"" ORDER BY ""E1"".""Id"",""E1"".""Month"" DESC"
114,"SELECT ""n"".""Id"",""n"".""Month"",COALESCE(""third_salary"", 0)+COALESCE(""second_salary"", 0)+COALESCE(""first_salary"", 0) AS ""Salary"" FROM (SELECT ""t"".* FROM (SELECT ""e1"".""Id"",""e1"".""Month"",""e1"".""Salary"" AS ""third_salary"",LAG(""e1"".""Salary"") OVER (PARTITION BY ""e1"".""Id"" ORDER BY ""e1"".""Month"") AS ""second_salary"",LAG(""e1"".""Salary"", 2) OVER (PARTITION BY ""e1"".""Id"" ORDER BY ""e1"".""Month"") AS ""first_salary"" FROM ""Employee"" AS ""e1"") AS ""t"" WHERE ROW(""t"".""Id"",""t"".""Month"") NOT IN (SELECT ""e0"".""Id"",MAX(""e0"".""Month"") AS ""m"" FROM ""Employee"" AS ""e0"" GROUP BY ""e0"".""Id"")) AS ""n"" ORDER BY ""n"".""Id"",""n"".""Month"" DESC"
115,"WITH ""cte"" AS (SELECT ""Id"",""Month"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Id"",""Month"" DESC) AS ""flag"" FROM ""Employee"") SELECT ""Id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""cte"" WHERE ""flag""!=1 ORDER BY ""Id"",""Month"" DESC"
116,"WITH ""t"" AS (SELECT * FROM ""Employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""max_month"" FROM ""Employee"" GROUP BY ""id"")) SELECT ""id"",""month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""t"" ORDER BY ""id"",""month"" DESC"
117,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
118,"WITH ""CTE"" AS (SELECT ""ID"",""MONTH"",""SALARY"" AS ""CUR_SAL"",ROW_NUMBER() OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" DESC) AS ""MONTH_ORD"",SUM(""SALARY"") OVER (PARTITION BY ""ID"" ORDER BY ""MONTH"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""CUM_SAL"" FROM ""EMPLOYEE"") SELECT ""Id"",""Month"",""CUM_SAL"" AS ""Salary"" FROM ""CTE"" WHERE ""MONTH_ORD"">1 ORDER BY 1,2 DESC"
119,"WITH ""cte"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cum"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rn"" FROM ""employee"") SELECT ""id"",""month"",""cum"" AS ""Salary"" FROM ""cte"" WHERE ""rn""!=1"
120,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") AS ""salary"" FROM ""employee"" GROUP BY ""id"",""month"") AS ""e"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"") ORDER BY ""id"",""month"" DESC"
121,"SELECT ""e1"".""Id"",MAX(""e2"".""Month"") AS ""Month"",SUM(COALESCE(""e2"".""Salary"", 0)) AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON ""e1"".""Id""=""e2"".""Id"" AND ""e1"".""Month""-""e2"".""Month"" BETWEEN 1 AND 3 GROUP BY 1,""e1"".""Month"" ORDER BY 1,2 DESC"
122,"SELECT ""a"".""Id"",""a"".""Month"",(""a"".""Salary""+""b"".""Salary_l1""+""c"".""Salary_l2"") AS ""Salary"" FROM ((""Employee"" AS ""a"" LEFT JOIN (SELECT ""Id"",""Month"",LAG(""Salary"", 1, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary_l1"" FROM ""Employee"") AS ""b"" ON ""a"".""Id""=""b"".""Id"" AND ""a"".""Month""=""b"".""Month"") LEFT JOIN (SELECT ""Id"",""Month"",LAG(""Salary"", 2, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary_l2"" FROM ""Employee"") AS ""c"" ON ""a"".""Id""=""c"".""Id"" AND ""a"".""Month""=""c"".""Month"") LEFT JOIN (SELECT ""Id"",""Month"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""ranking"" FROM ""Employee"") AS ""d"" ON ""a"".""Id""=""d"".""Id"" AND ""a"".""Month""=""d"".""Month"" WHERE ""d"".""ranking"">1 ORDER BY ""a"".""Id"",""a"".""Month"" DESC"
123,"WITH ""non_max_month"" AS (SELECT ""Id"",""Month"",""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""month"") FROM ""Employee"" GROUP BY ""Id"")) SELECT ""a"".""Id"",""a"".""Month"",(""a"".""Salary""+COALESCE(""b"".""Salary"", 0)+COALESCE(""c"".""Salary"", 0)) AS ""Salary"" FROM (""non_max_month"" AS ""a"" LEFT JOIN ""non_max_month"" AS ""b"" ON ""a"".""Month""=""b"".""Month""+1 AND ""a"".""Id""=""b"".""Id"") LEFT JOIN ""non_max_month"" AS ""c"" ON ""a"".""Month""=""c"".""Month""+2 AND ""a"".""Id""=""c"".""Id"" ORDER BY ""Id"",""Month"" DESC"
124,"WITH ""cte"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""id"",""month"",""salary"" FROM ""cte"" WHERE ""rnk""!=1"
125,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
126,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
127,"SELECT ""E1"".""id"",""E1"".""month"",COALESCE(""E1"".""Salary"", 0)+COALESCE(""E2"".""Salary"", 0)+COALESCE(""E3"".""Salary"", 0) AS ""Salary"" FROM (((SELECT ""Id"",MAX(""Month"") AS ""month"" FROM ""Employee"" GROUP BY ""Id"" HAVING COUNT(1)>1) AS ""max_month"" LEFT JOIN ""Employee"" AS ""E1"" ON ""E1"".""id""=""max_month"".""id"" AND ""max_month"".""month"">""E1"".""month"") LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"") AND ""E3"".""month""=""E1"".""month""-2 ORDER BY ""E1"".""id"",""E1"".""month"" DESC"
128,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
129,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rank1"" FROM ""Employee"") AS ""c"" WHERE ""rank1""!=1 GROUP BY ""Id"",""Month"" ORDER BY ""Id"",""Month"" DESC"
130,"SELECT ""Id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""id"",""month"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rn"" FROM ""employee"") AS ""tmp"" WHERE ""rn""!=1 ORDER BY ""Id"",""Month"" DESC"
131,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""e1"".""id"",""e1"".""month"",COALESCE(""e1"".""salary"", 0)+COALESCE(""e2"".""salary"", 0)+COALESCE(""e3"".""salary"", 0) AS ""salary"",RANK() OVER (PARTITION BY ""e1"".""id"" ORDER BY ""e1"".""month"" DESC) AS ""rank0"" FROM (""employee"" AS ""e1"" LEFT JOIN ""employee"" AS ""e2"" ON (""e1"".""id""=""e2"".""id"" AND ""e2"".""month""=""e1"".""month""-1)) LEFT JOIN ""employee"" AS ""e3"" ON (""e2"".""id""=""e3"".""id"" AND ""e3"".""month""=""e2"".""month""-1) ORDER BY ""e1"".""id"",""e1"".""month"" DESC) AS ""sub"" WHERE ""rank0"">1 ORDER BY ""id"",""month"" DESC"
132,"WITH ""id"" AS (SELECT ""id"",MAX(""month"") AS ""recent_month"" FROM ""employee"" GROUP BY ""id"") SELECT ""e1"".""id"",""e1"".""month"",COALESCE(""e1"".""salary"", 0)+COALESCE(""e2"".""salary"", 0)+COALESCE(""e3"".""salary"", 0) AS ""salary"" FROM ((""employee"" AS ""e1"" LEFT JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month""=""e2"".""month""+1) LEFT JOIN ""employee"" AS ""e3"" ON ""e1"".""id""=""e3"".""id"" AND ""e1"".""month""=""e3"".""month""+2) LEFT JOIN ""id"" ON ""e1"".""id""=""id"".""id"" WHERE ""e1"".""month""!=""id"".""recent_month"" ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
133,"WITH ""CTE1"" AS (SELECT *,RANK() OVER (PARTITION BY ""id"" ORDER BY ""Month"" DESC) AS ""rks"" FROM ""Employee""), ""CTE2"" AS (SELECT ""id"",""month"",""salary"",LAG(""salary"", 1) OVER (PARTITION BY ""id"" ORDER BY ""month"") AS ""lag1s"",LAG(""salary"", 2) OVER (PARTITION BY ""id"" ORDER BY ""month"") AS ""lag2s"" FROM ""CTE1"" WHERE ""rks""!=1) SELECT ""id"",""month"",""salary""+COALESCE(""lag1s"", 0)+COALESCE(""lag2s"", 0) AS ""salary"" FROM ""CTE2"" ORDER BY ""id"",""month"" DESC"
134,"WITH ""T1"" AS (SELECT CONCAT(""id"", '-', ""month"") AS ""idm"" FROM (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY 1 ORDER BY 1) AS ""X""), ""T2"" AS (SELECT ""Id"",""month"",""salary"",CONCAT(""id"", '-', ""month"") AS ""idm"" FROM ""employee"") SELECT ""ID"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""T2"" WHERE ""idm"" NOT IN (SELECT ""idm"" FROM ""T1"") ORDER BY ""id"",""month"" DESC"
135,"WITH ""cte1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rn"" FROM ""Employee""), ""cte2"" AS (SELECT * FROM ""cte1"" WHERE ""rn""!=1 ORDER BY ""Id"") SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Salary"" FROM ""cte2"" ORDER BY ""Id"",""Month"" DESC"
136,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rn"" FROM ""employee"") AS ""temp"" WHERE ""rn""!=1 ORDER BY ""id"",""month"" DESC"
137,"WITH ""cte1"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee""), ""cte2"" AS (SELECT ""id"",""month"",""salary"" FROM ""cte1"" WHERE ""ranking""!=1) SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte2"" ORDER BY ""id"",""month"" DESC"
138,"SELECT ""id"",""month"",""Salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_no"" FROM ""Employee"") AS ""src"" WHERE ""month_no"">1 ORDER BY ""id"",""month"" DESC"
139,"SELECT ""a"".""id"",""a"".""month"",SUM(""a"".""salary"") OVER (PARTITION BY ""a"".""id"" ORDER BY ""a"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""Employee"" AS ""a"" WHERE ""month""!=(SELECT MAX(""month"") FROM ""employee"" AS ""b"" WHERE ""b"".""id""=""a"".""id"") GROUP BY ""Id"",""month"" ORDER BY ""id"",""month"" DESC"
140,"SELECT ""A"".""ID"",""A"".""MONTH"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""A"".""MONTH"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""EMPLOYEE"" AS ""A"" WHERE ROW(""A"".""ID"",""A"".""MONTH"") NOT IN (SELECT ""EMPLOYEE"".""ID"",MAX(""MONTH"") FROM ""EMPLOYEE"" GROUP BY ""ID"") ORDER BY ""A"".""ID"",""A"".""MONTH"" DESC"
141,"SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_no"" FROM ""Employee"") AS ""src"" WHERE ""month_no"">1 ORDER BY ""id"",""month"" DESC"
142,"SELECT ""e1"".""Id"",""e1"".""Month"",COALESCE(""e1"".""Salary"", 0)+COALESCE(""e2"".""Salary"", 0)+COALESCE(""e3"".""Salary"", 0) AS ""Salary"" FROM (""Employee"" AS ""e1"" LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""Id""=""e2"".""Id"" AND ""e1"".""Month""=""e2"".""Month""+1) LEFT JOIN ""Employee"" AS ""e3"" ON ""e2"".""Id""=""e3"".""Id"" AND ""e2"".""Month""=""e3"".""Month""+1 WHERE ROW(""e1"".""Id"",""e1"".""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"") ORDER BY ""e1"".""id"",""e1"".""month"" DESC"
143,"WITH ""cte1"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee""), ""cte2"" AS (SELECT ""id"",""month"",""salary"" FROM ""cte1"" WHERE ""ranking""!=1) SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte2"" ORDER BY ""id"",""month"" DESC"
144,"SELECT ""a"".""id"",""a"".""month"",SUM(""b"".""salary"") AS ""salary"" FROM (""employee"" AS ""a"") CROSS JOIN ""employee"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""a"".""month"">=""b"".""month"" AND ""a"".""month""-2<=""b"".""month"" AND ""a"".""month""!=(SELECT MAX(""month"") FROM ""employee"" AS ""c"" WHERE ""a"".""id""=""c"".""id"") GROUP BY ""a"".""id"",""a"".""month"" ORDER BY ""a"".""id"",""a"".""month"" DESC"
145,"SELECT ""E1"".""Id"",""E1"".""Month"",SUM(""E2"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""E1"" JOIN ""Employee"" AS ""E2"" ON ""E1"".""id""=""E2"".""id"" AND ""E1"".""Month"">=""E2"".""Month"" AND ""E1"".""Month""<""E2"".""Month""+3 WHERE ROW(""E1"".""Id"",""E1"".""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") AS ""Month"" FROM ""Employee"" GROUP BY ""Id"") GROUP BY ""E1"".""Id"",""E1"".""Month"" ORDER BY ""E1"".""Id"",""E1"".""Month"" DESC"
146,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""ID"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""employee"" WHERE ROW(""Id"",""month"") NOT IN (SELECT ""Id"",MAX(""month"") FROM ""employee"" GROUP BY 1) ORDER BY ""Id"",""month"" DESC"
147,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"") ORDER BY ""id"",""month"" DESC"
148,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
149,"SELECT ""e"".""id"",""e"".""month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Employee"" AS ""e2"" ON (""e"".""Id""=""e2"".""Id"" AND ""e"".""Month"">=""e2"".""Month"" AND (""e"".""Month""-""e2"".""Month""<=2)) WHERE ""e"".""Month""<(SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""e"".""Id"") GROUP BY ""e"".""Id"",""e"".""Month"" ORDER BY ""e"".""Id"",""e"".""Month"" DESC"
150,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E1"".""id""=""E2"".""id"" AND ""E1"".""month""=""E2"".""month""+1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E1"".""id""=""E3"".""id"" AND ""E1"".""month""=""E3"".""month""+2) ORDER BY ""id"",""month"" DESC"
151,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT ""id"",""month"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rn"" FROM ""employee"") AS ""a"" WHERE ""rn"">1 ORDER BY 1,2 DESC"
152,"WITH ""T1"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rank"" FROM ""Employee"") SELECT ""Id"",""Month"",""Salary"" FROM ""T1"" WHERE ""rank""!=1"
153,"WITH ""tmp1"" AS (SELECT ""Id"",MAX(""month"") AS ""m"" FROM ""Employee"" GROUP BY ""Id""), ""tmp2"" AS (SELECT ""Employee"".""Id"",""Month"",""Salary"" FROM ""Employee"" JOIN ""tmp1"" ON ""tmp1"".""Id""=""Employee"".""Id"" WHERE ""Month""<""m"") SELECT ""t1"".""Id"",""t1"".""Month"",(COALESCE(""t1"".""Salary"", 0)+COALESCE(""t2"".""Salary"", 0)+COALESCE(""t3"".""Salary"", 0)) AS ""Salary"" FROM (""tmp2"" AS ""t1"" LEFT JOIN ""tmp2"" AS ""t2"" ON ""t1"".""Id""=""t2"".""Id"" AND (""t1"".""Month""-""t2"".""Month""=1)) LEFT JOIN ""tmp2"" AS ""t3"" ON ""t2"".""Id""=""t3"".""Id"" AND (""t2"".""Month""-""t3"".""Month""=1) ORDER BY ""t1"".""Id"",""t1"".""Month"" DESC"
154,"WITH ""t1"" AS (SELECT ""employee"".*,RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""t1"" WHERE ""rnk""!=1 ORDER BY 1,2 DESC"
155,"SELECT ""e"".""id"",""e"".""month"",SUM(""e1"".""salary"") AS ""salary"" FROM ""employee"" AS ""e"" JOIN ""employee"" AS ""e1"" ON ""e1"".""id""=""e"".""id"" AND (""e"".""month""-""e1"".""month"") BETWEEN 0 AND 2 WHERE ""e"".""month""!=(SELECT MAX(""ex"".""month"") FROM ""employee"" AS ""ex"" WHERE ""ex"".""id""=""e"".""id"") GROUP BY 1,2 ORDER BY 1,2 DESC"
156,"SELECT * FROM (SELECT DISTINCT ""Id"",LAG(""Month"", 1) OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Salary"" FROM ""Employee"") AS ""e"" WHERE ""e"".""salary"" IS NOT NULL ORDER BY ""id"",""month"" DESC"
157,"SELECT * FROM (SELECT DISTINCT ""Id"",LAG(""Month"", 1) OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Salary"" FROM ""Employee"") AS ""e"" WHERE ""e"".""salary"" IS NOT NULL ORDER BY ""id"",""month"" DESC"
158,"WITH ""cte1"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee""), ""cte2"" AS (SELECT ""id"",""month"",""salary"" FROM ""cte1"" WHERE ""ranking""!=1) SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte2"" ORDER BY ""id"",""month"" DESC"
159,"SELECT ""id"",""month"",""Salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_no"" FROM ""Employee"") AS ""src"" WHERE ""month_no"">1 ORDER BY ""id"",""month"" DESC"
160,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
161,"SELECT ""e1"".""Id"",""e1"".""month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON ""e1"".""Id""=""e2"".""Id"" AND (""e2"".""month""=""e1"".""month"" OR ""e2"".""month""+1=""e1"".""month"" OR ""e2"".""month""+2=""e1"".""month"") WHERE ROW(""e1"".""Id"",""e1"".""month"") NOT IN (SELECT ""Id"",MAX(""month"") FROM ""Employee"" GROUP BY ""Id"") GROUP BY ""e1"".""Id"",""e1"".""Month"" ORDER BY ""e1"".""Id"",""e1"".""Month"" DESC"
162,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_rank"" FROM ""employee"") AS ""a"" WHERE ""month_rank"">1 ORDER BY ""id"",""month"" DESC"
163,"SELECT ""e"".""Id"",""e"".""Month"",SUM(""e"".""Salary"") OVER (PARTITION BY ""e"".""Id"" ORDER BY ""e"".""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""Employee"" AS ""e"" WHERE ""Month""<(SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""e"".""Id"") ORDER BY 1,2 DESC"
164,"SELECT ""Id"",""Month"",""Salary""+LAG(""salary"", 1, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"")+LAG(""salary"", 2, 0) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary"" FROM ""Employee"" AS ""E"" WHERE ""month""<(SELECT MAX(""E1"".""month"") FROM ""Employee"" AS ""E1"" WHERE ""E"".""Id""=""E1"".""Id"") ORDER BY ""Id"",""Month"" DESC"
165,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",""Month"" FROM (SELECT ""Id"",""Month"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""t"" WHERE ""rnk""=1) ORDER BY ""Id"",""Month"" DESC"
166,"SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""salary"") AS ""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month"">=""e2"".""month"" WHERE ROW(""e1"".""id"",""e1"".""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY ""id"") AND ""e1"".""month""-""e2"".""month""<3 GROUP BY ""e1"".""id"",""e1"".""month"" ORDER BY 1,2 DESC"
167,"WITH ""cte"" AS (SELECT ""e"".""id"",""month"",""salary"" FROM ""employee"" AS ""e"" JOIN (SELECT ""id"",MAX(""Month"") AS ""mx_mth"" FROM ""employee"" GROUP BY 1) AS ""t"" ON ""t"".""id""=""e"".""id"" WHERE ""month""!=""mx_mth"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte"" ORDER BY 1,2 DESC"
168,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT ""id"",""month"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""ranking"" FROM ""employee"") AS ""a"" WHERE ""ranking""!=1 ORDER BY ""id"",""month"" DESC"
169,"WITH ""cte"" AS (SELECT ""e"".*,SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""cum_salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""month"") AS ""rnk"" FROM ""employee"" AS ""e"") SELECT ""cte"".""Id"",""cte"".""month"",""cte"".""cum_salary"" AS ""salary"" FROM ""cte"" WHERE ROW(""Id"",""rnk"") NOT IN (SELECT ""cte"".""Id"",MAX(""cte"".""rnk"") FROM ""cte"" GROUP BY ""Id"") ORDER BY ""Id"",""month"" DESC"
170,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""MONTH"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""MONTH"" BETWEEN (""A"".""MONTH""-3) AND (""A"".""MONTH""-1) GROUP BY ""A"".""Id"",""A"".""MONTH"" ORDER BY ""Id"",""MONTH"" DESC"
171,"WITH ""segment_id"" AS (SELECT ""Id"",""Month"",""Salary"",LAG(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""lag_Salary"",LAG(""Salary"", 2) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""lag_lag_Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""month_rank_desc"" FROM ""Employee"") SELECT ""Id"",""Month"",(""Salary""+COALESCE(""lag_Salary"", 0)+COALESCE(""lag_lag_Salary"", 0)) AS ""Salary"" FROM ""segment_id"" WHERE ""month_rank_desc""!=1 ORDER BY ""Id"",""Month"" DESC"
172,"WITH ""no_recent"" AS (SELECT * FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") AS ""Month"" FROM ""Employee"" GROUP BY ""Id"") ORDER BY ""Id"",""Month"" DESC) SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Salary"" FROM ""no_recent"""
173,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
174,"SELECT ""l"".""Id"",""l"".""Month"",SUM(""r"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""l"") CROSS JOIN ""Employee"" AS ""r"" WHERE ""r"".""Id""=""l"".""Id"" AND (""l"".""Month""-""r"".""Month"") BETWEEN 0 AND 2 AND ""l"".""Month"" NOT IN (SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""l"".""Id"") AND ""r"".""Month"" NOT IN (SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""r"".""Id"") GROUP BY ""l"".""Id"",""l"".""Month"" ORDER BY ""l"".""Id"",""l"".""Month"" DESC"
175,"WITH ""cte"" AS (SELECT ""id"",""month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""cte"" WHERE ""rnk""!=1 ORDER BY 1,2 DESC"
176,"WITH ""Cumulative_salary"" AS (SELECT ""Id"",""Month"",""salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""Month"" DESC) AS ""Month_Rank"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Cumulative_Salary"" FROM ""Employee"" GROUP BY 1,2,3) SELECT ""id"",""month"",""Cumulative_Salary"" AS ""Salary"" FROM ""Cumulative_salary"" WHERE ""Month_Rank""!=1 ORDER BY ""ID"",""Month"" DESC"
177,"WITH ""salary"" AS (SELECT ""Id"",""month"",""salary"" FROM (SELECT *,RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""monthrank"" FROM ""employee"") AS ""tmp"" WHERE ""monthrank"">1) SELECT ""s1"".""Id"",""s1"".""Month"",""s1"".""Salary""+COALESCE(""s2"".""salary"", 0)+COALESCE(""s3"".""salary"", 0) AS ""Salary"" FROM (""salary"" AS ""s1"" LEFT JOIN ""salary"" AS ""s2"" ON ""s1"".""Id""=""s2"".""Id"" AND ""s1"".""month""=""s2"".""month""+1) LEFT JOIN ""salary"" AS ""s3"" ON ""s1"".""Id""=""s3"".""Id"" AND ""s1"".""month""=""s3"".""month""+2 ORDER BY ""s1"".""Id"",""s1"".""Month"" DESC"
178,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
179,"WITH ""cte"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""id"",""month"",""salary"" FROM ""cte"" WHERE ""rnk""!=1 ORDER BY ""id"",""month"" DESC"
180,"WITH ""rolling_sum"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"") SELECT ""id"",""month"",""rolling_sum"".""salary"" FROM ""rolling_sum"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY ""id"") ORDER BY ""id"",""month"" DESC"
181,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"") ORDER BY ""id"",""Month"" DESC"
182,"SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON (""e1"".""Id""=""e2"".""Id"" AND ""e1"".""Month"">=""e2"".""Month"" AND ""e1"".""Month""-""e2"".""Month""<=2) WHERE ""e1"".""Month""<(SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""e1"".""Id"") AND ""e2"".""Month"" GROUP BY ""e1"".""Id"",""e1"".""Month"" ORDER BY ""e1"".""Id"",""e1"".""Month"" DESC"
183,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""<(SELECT MAX(""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY ""id"",""month"" DESC"
184,"WITH ""t1"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rk"" FROM ""Employee"") SELECT ""t1"".""Id"",""t1"".""Month"",SUM(""t1"".""Salary"") OVER (PARTITION BY ""t1"".""Id"" ORDER BY ""t1"".""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""t1"" WHERE ""t1"".""rk""!=1 ORDER BY 1,2 DESC"
185,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1 ORDER BY 1 DESC) ORDER BY 1,2 DESC"
186,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT ""id"",""month"",""salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""p"" WHERE ""p"".""rnk""!=1 ORDER BY 1,2 DESC"
187,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rnk"" FROM ""Employee"") SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""cte"" WHERE ""rnk"">1 ORDER BY ""Id"",""Month"" DESC"
188,"WITH ""cte"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""id"",""month"",""salary"" FROM ""cte"" WHERE ""rnk""!=1 ORDER BY ""id"",""month"" DESC"
189,"WITH ""main"" AS (SELECT ""Id"",""Month"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rn"" FROM ""Employee"") SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""salary"" FROM ""main"" WHERE ""rn""!=1 ORDER BY ""Id"",""Month"" DESC"
190,"WITH ""tmp"" AS (SELECT * FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY 1)) SELECT ""t1"".""id"",""t1"".""month"",SUM(""t2"".""salary"") AS ""salary"" FROM ""tmp"" AS ""t1"" JOIN ""tmp"" AS ""t2"" ON ""t1"".""id""=""t2"".""id"" AND ""t1"".""month"">=""t2"".""month"" AND ""t1"".""month""<=""t2"".""month""+2 GROUP BY 1,2 ORDER BY 1,2 DESC"
191,"WITH ""last_3"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rown"" FROM ""Employee""), ""cum_salary"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Salary"" FROM ""last_3"" WHERE ""rown""!=1) SELECT * FROM ""cum_salary"" ORDER BY 1,2 DESC"
192,"SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""mth_rk"" FROM ""Employee"") AS ""t"" WHERE ""t"".""mth_rk""!=1"
193,"SELECT ""a"".""id"",""a"".""month"",""a"".""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"",RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""a"" WHERE ""a"".""rnk""!=1 ORDER BY ""a"".""id"",""a"".""month"" DESC"
194,"WITH ""cte"" AS (SELECT ""id"",MAX(""month"") AS ""recent_month"" FROM ""employee"" GROUP BY 1) SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""salary"") AS ""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND (""e1"".""month""-""e2"".""month"") BETWEEN 0 AND 2 WHERE NOT EXISTS (SELECT 1 FROM ""cte"" AS ""e3"" WHERE ""e3"".""id""=""e1"".""id"" AND ""e3"".""recent_month""=""e1"".""month"") GROUP BY 1,2 ORDER BY 1,2 DESC"
195,"SELECT ""e1"".""Id"",""e1"".""Month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON ""e1"".""Id""=""e2"".""Id"" AND ""e1"".""Month""-""e2"".""Month"" BETWEEN 0 AND 2 WHERE ROW(""e1"".""Id"",""e1"".""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1) GROUP BY 1,2 ORDER BY 1,2 DESC"
196,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
197,"SELECT ""id"",""month"",(SELECT SUM(""salary"") FROM ""employee"" AS ""e2"" WHERE ""e1"".""Id""=""e2"".""Id"" AND ""e2"".""Month""<=""e1"".""Month"" AND ""e2"".""Month"">(""e1"".""Month""-3)) AS ""Salary"" FROM ""employee"" AS ""e1"" WHERE ""e1"".""Month""<(SELECT MAX(""month"") FROM ""employee"" WHERE ""id""=""e1"".""id"" GROUP BY ""id"") ORDER BY ""Id"",""Month"" DESC"
198,"WITH ""cum_salary"" AS (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",MAX(""month"") OVER (PARTITION BY ""id"") AS ""recent_month"" FROM ""Employee"") SELECT ""id"",""month"",""salary"" FROM ""cum_salary"" WHERE ""month""!=""recent_month"" ORDER BY ""id"",""month"" DESC"
199,"SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rank_desc"" FROM ""Employee"") AS ""tmp"" WHERE ""rank_desc"">1 ORDER BY ""Id"",""Month"" DESC"
200,"WITH ""cte"" AS (SELECT * FROM ""Employee"" WHERE CONCAT(""Id"", ""Month"") NOT IN (SELECT CONCAT(""Id"", MAX(""Month"")) FROM ""Employee"" GROUP BY ""Id"")) SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte"" ORDER BY ""Id"",""month"" DESC"
201,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
202,"WITH ""t1"" AS (SELECT ""id"",""month"",""salary"",ROUND(SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING), 0) AS ""salary_avg"",LAG(""month"", 1) OVER (PARTITION BY ""id"" ORDER BY ""month"") AS ""prev_month"" FROM ""employee"") SELECT ""id"",""prev_month"" AS ""month"",""salary_avg"" AS ""salary"" FROM ""t1"" WHERE ""salary_avg"" IS NOT NULL ORDER BY ""id"",""month"" DESC"
203,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
204,"SELECT ""e1"".""id"",""e1"".""month"",SUM(""e2"".""salary"") AS ""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND (""e2"".""month""=""e1"".""month"" OR ""e2"".""month""+1=""e1"".""month"" OR ""e2"".""month""+2=""e1"".""month"") WHERE ROW(""e1"".""id"",""e1"".""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""recent_month"" FROM ""employee"" GROUP BY 1) GROUP BY 1,2 ORDER BY 1,2 DESC"
205,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
206,"WITH ""cte1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk1"" FROM ""employee"") SELECT ""Id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""cte1"" WHERE ""rnk1""!=1 ORDER BY ""id"",""month"" DESC"
207,"SELECT ""a"".""Id"",""a"".""Month"",SUM(""b"".""Salary"") AS ""Salary"" FROM ""Employee"" AS ""a"" LEFT JOIN ""Employee"" AS ""b"" ON ""a"".""Id""=""b"".""Id"" AND ""a"".""Month"">=""b"".""Month"" AND ""a"".""Month""-2<=""b"".""Month"" WHERE ROW(""a"".""id"",""a"".""Month"") NOT IN (SELECT ""id"",MAX(""month"") FROM ""employee"" GROUP BY 1) GROUP BY 1,2 ORDER BY 1,2 DESC"
208,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
209,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1 ORDER BY 1 DESC) ORDER BY 1,2 DESC"
210,"SELECT ""id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""id"" ORDER BY ""Month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""month_order"" FROM ""Employee"") AS ""a"" WHERE ""month_order"">1 ORDER BY ""id"",""Month"" DESC"
211,"SELECT ""e1"".""Id"",""e1"".""month"",COALESCE(""e1"".""Salary"", 0)+COALESCE(""e2"".""Salary"", 0)+COALESCE(""e3"".""Salary"", 0) AS ""Salary"" FROM (((SELECT ""Id"",MAX(""Month"") AS ""month"" FROM ""Employee"" GROUP BY ""Id"" HAVING COUNT(1)>1) AS ""mm"" LEFT JOIN ""Employee"" AS ""e1"" ON (""e1"".""Id""=""mm"".""Id"" AND ""e1"".""Month""<""mm"".""Month"")) LEFT JOIN ""Employee"" AS ""e2"" ON (""e2"".""Id""=""e1"".""Id"" AND ""e2"".""Month""=""e1"".""Month""-1)) LEFT JOIN ""Employee"" AS ""e3"" ON (""e3"".""Id""=""e2"".""Id"" AND ""e3"".""Month""=""e1"".""Month""-2) ORDER BY ""e1"".""Id"",""e1"".""Month"" DESC"
212,"WITH ""CTE"" AS (SELECT ""Id"",""Month"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""dr"" FROM ""Employee""), ""CTE1"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""Salary"" FROM ""CTE"" WHERE ""dr""!=1) SELECT * FROM ""CTE1"""
213,"SELECT ""A"".""Id"",MAX(""B"".""Month"") AS ""Month"",SUM(""B"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""A"") CROSS JOIN ""Employee"" AS ""B"" WHERE ""A"".""Id""=""B"".""Id"" AND ""B"".""Month"" BETWEEN (""A"".""Month""-3) AND (""A"".""Month""-1) GROUP BY ""A"".""Id"",""A"".""Month"" ORDER BY ""Id"",""Month"" DESC"
214,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") AS ""Month"" FROM ""Employee"" GROUP BY ""Id"") ORDER BY ""Id"",""Month"" DESC"
215,"SELECT ""a"".""id"",""a"".""month"",SUM(""b"".""salary"") AS ""salary"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""id""=""b"".""id"" AND ""a"".""month""-""b"".""month"" BETWEEN 0 AND 2 WHERE ROW(""a"".""id"",""a"".""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""recent_month"" FROM ""employee"" GROUP BY ""id"") GROUP BY 1,2 ORDER BY 1,2 DESC"
216,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY 1 ORDER BY 1 DESC) ORDER BY ""Id"",""Month"" DESC"
217,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Salary"",""Month"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""t"" WHERE ""rnk"">1 ORDER BY ""Id"",""Month"" DESC"
218,"WITH ""cte"" AS (SELECT ""id"",""month"",""salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte"" WHERE ""rnk""!=1 ORDER BY ""id"",""month"" DESC"
219,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""MONTH"") AS ""MONTH"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""MONTH"">""E1"".""MONTH"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""MONTH""=""E1"".""MONTH""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""MONTH""=""E1"".""MONTH""-2) ORDER BY ""id"",""MONTH"" DESC"
220,"SELECT ""t"".""id"",""t"".""month"",SUM(""t1"".""salary"") AS ""salary"" FROM (SELECT ""e"".""id"",""e"".""month"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN (SELECT ""id"",MAX(""month"") AS ""mx_mn"" FROM ""employee"" GROUP BY ""id"") AS ""t"" ON ""t"".""id""=""e"".""id"" AND ""e"".""month""!=""t"".""mx_mn"") AS ""t"" JOIN (SELECT ""e"".""id"",""e"".""month"",""e"".""salary"" FROM ""employee"" AS ""e"" JOIN (SELECT ""id"",MAX(""month"") AS ""mx_mn"" FROM ""employee"" GROUP BY ""id"") AS ""t"" ON ""t"".""id""=""e"".""id"" AND ""e"".""month""!=""t"".""mx_mn"") AS ""t1"" ON ""t"".""id""=""t1"".""id"" AND ""t"".""month"">=""t1"".""month"" AND ""t"".""month""-""t1"".""month"" BETWEEN 0 AND 2 GROUP BY ""t"".""id"",""t"".""month"" ORDER BY ""t"".""id"",""t"".""month"" DESC"
221,"SELECT ""a"".""id"",MAX(""b"".""month"") AS ""month"",SUM(""b"".""salary"") AS ""Salary"" FROM (""Employee"" AS ""a"") CROSS JOIN ""Employee"" AS ""b"" WHERE ""a"".""id""=""b"".""id"" AND ""b"".""month"" BETWEEN (""a"".""month""-3) AND (""a"".""month""-1) GROUP BY ""a"".""id"",""a"".""month"" ORDER BY ""a"".""id"",""a"".""month"" DESC"
222,"WITH ""cte"" AS (SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"") ORDER BY ""Id"",""Month"" DESC), ""cte2"" AS (SELECT ""Id"",""Month"",""Salary"",LAG(""Salary"", 3) OVER (PARTITION BY ""Id"" ORDER BY ""Month"") AS ""prev_prev_salary"" FROM ""cte"" ORDER BY ""Id"",""Month"" DESC) SELECT ""Id"",""Month"",(""Salary""-COALESCE(""prev_prev_Salary"", 0)) AS ""Salary"" FROM ""cte2"""
223,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rank_mon"" FROM ""Employee"") AS ""a"" WHERE ""rank_mon""!=1 GROUP BY 1,2 ORDER BY 1,2 DESC"
224,"SELECT ""e"".""Id"",""e"".""Month"",SUM(""e"".""Salary"") OVER (PARTITION BY ""e"".""Id"" ORDER BY ""e"".""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" AS ""e"" WHERE ""Month""<(SELECT MAX(""Month"") FROM ""Employee"" WHERE ""Id""=""e"".""Id"") ORDER BY ""ID"",""Month"" DESC"
225,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"",DENSE_RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""month_no"" FROM ""employee"") AS ""a"" WHERE ""month_no"">1 ORDER BY ""id"",""month"" DESC"
226,"SELECT ""e2"".""Id"",MAX(""e2"".""Month"") AS ""Month"",SUM(""e2"".""Salary"") AS ""Salary"" FROM (""Employee"" AS ""e1"") CROSS JOIN ""Employee"" AS ""e2"" WHERE ""e1"".""Id""=""e2"".""Id"" AND ""e2"".""month"" BETWEEN ""e1"".""Month""-3 AND ""e1"".""Month""-1 GROUP BY ""e1"".""Id"",""e1"".""Month"" ORDER BY ""e1"".""Id"",""e1"".""Month"" DESC"
227,"WITH ""cte"" AS (SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",MAX(""Month"") OVER (PARTITION BY ""Id"") AS ""maxMonth"" FROM ""Employee"") AS ""temp"" WHERE ""Month""!=""maxMonth"") SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS ""salary"" FROM ""cte"" ORDER BY ""Id"",""Month"" DESC"
228,"SELECT ""Id"",""Month"",""total_salary"" AS ""salary"" FROM (SELECT *,SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""total_salary"",ROW_NUMBER() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""RN"" FROM ""Employee"") AS ""t1"" WHERE ""RN"">1 ORDER BY ""Id"",""Month"" DESC"
229,"WITH ""table1"" AS (SELECT ""Id"",""Month"",""Salary"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""sum_salary"" FROM ""Employee"" ORDER BY ""Month"" DESC) SELECT ""Id"",""Month"",""sum_salary"" AS ""Salary"" FROM ""table1"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") AS ""max_month"" FROM ""Employee"" GROUP BY ""id"") ORDER BY ""Id"",""Month"" DESC"
230,"WITH ""exclude_month"" AS (SELECT ""Id"",""Month"",""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rnk"" FROM ""Employee"") AS ""temp"" WHERE ""temp"".""rnk""=1), ""cte1"" AS (SELECT ""e"".""Id"",""e"".""Month"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""exclude_month"" AS ""em"" ON ""e"".""id""=""em"".""id"" AND ""e"".""Month""!=""em"".""Month"") SELECT ""id"",""Month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND 0 FOLLOWING) AS ""Salary"" FROM ""cte1"" ORDER BY ""id"",""Month"" DESC"
231,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM ""Employee"" WHERE ROW(""Id"",""Month"") NOT IN (SELECT ""Id"",MAX(""Month"") FROM ""Employee"" GROUP BY ""Id"") GROUP BY ""Id"",""Month"" ORDER BY ""Id"",""Month"" DESC"
232,"SELECT ""e"".""id"",""e"".""month"",SUM(""e"".""salary"") OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ""e"".""month""!=(SELECT MAX(""e1"".""month"") FROM ""employee"" AS ""e1"" WHERE ""e1"".""id""=""e"".""id"") ORDER BY 1,2 DESC"
233,"SELECT ""E1"".""id"",""E1"".""month"",(COALESCE(""E1"".""salary"", 0)+COALESCE(""E2"".""salary"", 0)+COALESCE(""E3"".""salary"", 0)) AS ""Salary"" FROM (((SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"" HAVING COUNT(1)>1) AS ""maxmonth"" LEFT JOIN ""Employee"" AS ""E1"" ON (""maxmonth"".""id""=""E1"".""id"" AND ""maxmonth"".""month"">""E1"".""month"")) LEFT JOIN ""Employee"" AS ""E2"" ON (""E2"".""id""=""E1"".""id"" AND ""E2"".""month""=""E1"".""month""-1)) LEFT JOIN ""Employee"" AS ""E3"" ON (""E3"".""id""=""E1"".""id"" AND ""E3"".""month""=""E1"".""month""-2) ORDER BY ""id"",""month"" DESC"
234,"WITH ""cte"" AS (SELECT ""id"",""month"",""salary"" FROM ""employee"" WHERE ROW(""id"",""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""employee"" GROUP BY 1)) SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" RANGE BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM ""cte"" ORDER BY ""id"",""month"" DESC"
235,"SELECT * FROM (SELECT DISTINCT ""Id"",LAG(""Month"", 1) OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""Month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""Salary"" FROM ""Employee"") AS ""e"" WHERE ""e"".""salary"" IS NOT NULL ORDER BY ""id"",""month"" DESC"
236,"WITH ""minmonth"" AS (SELECT ""t"".""Id"",""t"".""minmonth"",0 AS ""endmonth"" FROM (SELECT ""Id"",MAX(""Month"") OVER (PARTITION BY ""Id"") AS ""minmonth"" FROM ""Employee"" ORDER BY ""Id"",""Month"") AS ""t"" GROUP BY ""t"".""Id"",""t"".""minmonth"") SELECT ""u"".""Id"",""u"".""Month"",""u"".""Salary""+COALESCE(LAG(""u"".""Salary2"", 1) OVER (PARTITION BY ""u"".""Id"" ORDER BY ""u"".""Month""), 0) AS ""Salary"" FROM (SELECT ""e"".""Id"",""e"".""Month"",""e"".""Salary"",(""e"".""salary""+COALESCE(LAG(""e"".""Salary"", 1) OVER (PARTITION BY ""e"".""Id"" ORDER BY ""e"".""Month""), 0)) AS ""Salary2"" FROM ""Employee"" AS ""e"" LEFT JOIN ""minmonth"" ON ""e"".""Id""=""minmonth"".""Id"" WHERE ""e"".""Month""<""minmonth"".""minmonth"" AND ""e"".""Month"">=""minmonth"".""endmonth"" ORDER BY ""e"".""Id"",""e"".""Month"") AS ""u"" ORDER BY ""u"".""Id"",""u"".""Month"" DESC"
237,"SELECT ""e1"".""id"",MAX(""e2"".""month"") AS ""month"",SUM(""e2"".""salary"") AS ""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""id""=""e2"".""id"" AND ""e1"".""month""-1>=""e2"".""month"" AND ""e1"".""month""-3<=""e2"".""month"" GROUP BY ""e1"".""id"",""e1"".""month"" ORDER BY 1,2 DESC"
238,"WITH ""max_month"" AS (SELECT ""id"",MAX(""month"") AS ""max_month"" FROM ""Employee"" GROUP BY 1) SELECT ""e"".""id"",""e"".""month"",(""e"".""salary""+COALESCE(LAG(""e"".""salary"", 1) OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month""), 0)+COALESCE(LAG(""e"".""salary"", 2) OVER (PARTITION BY ""e"".""id"" ORDER BY ""e"".""month""), 0)) AS ""salary"" FROM ""Employee"" AS ""e"" LEFT JOIN ""max_month"" AS ""m"" ON CONCAT(""e"".""id"", ""e"".""month"")=CONCAT(""m"".""id"", ""m"".""max_month"") WHERE ""m"".""id"" IS NULL ORDER BY 1,2 DESC"
239,"SELECT ""id"",""month"",""salary"" FROM (SELECT ""id"",LAG(""month"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING) AS ""salary"" FROM ""employee"") AS ""a"" WHERE ""month"" IS NOT NULL AND ""salary"" IS NOT NULL ORDER BY ""id"",""month"" DESC"
240,"SELECT ""id"",""month"",SUM(""salary"") OVER (PARTITION BY ""id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""salary"" FROM (SELECT *,RANK() OVER (PARTITION BY ""id"" ORDER BY ""month"" DESC) AS ""rnk"" FROM ""employee"") AS ""t"" WHERE ""rnk""!=1 ORDER BY ""id"",2 DESC"
241,"SELECT ""e"".""id"",""e"".""month"",(SELECT SUM(""salary"") FROM ""employee"" AS ""e2"" WHERE ""e2"".""id""=""e"".""id"" AND ""e2"".""month""<=""e"".""month"" AND ""e"".""month""-""e2"".""month""<=2) AS ""salary"" FROM ""employee"" AS ""e"" WHERE ROW(""e"".""id"",""e"".""month"") NOT IN (SELECT ""id"",MAX(""month"") AS ""month"" FROM ""Employee"" GROUP BY ""id"") ORDER BY 1,2 DESC"
242,"SELECT ""Id"",""Month"",SUM(""Salary"") OVER (PARTITION BY ""Id"" ORDER BY ""month"" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ""Salary"" FROM (SELECT ""Id"",""Month"",""Salary"",RANK() OVER (PARTITION BY ""Id"" ORDER BY ""Month"" DESC) AS ""rank_mon"" FROM ""Employee"") AS ""a"" WHERE ""rank_mon""!=1 GROUP BY 1,2 ORDER BY 1,2 DESC"
