id,original query
1,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
2,"WITH ""bounds"" AS (SELECT SUM(""frequency"")/2 AS ""bound"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cum_sum"" FROM ""numbers"" JOIN ""bounds"") AS ""t2"" WHERE ""bound"" BETWEEN (""cum_sum""-""frequency"") AND ""cum_sum"""
3,"WITH ""tst"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""tst"" WHERE ""cumsum_left"">=((SELECT MAX(""cumsum_left"") FROM ""tst"")/2) LIMIT 1)+(SELECT ""Number"" FROM ""tst"" WHERE ""cumsum_left"">=(((SELECT MAX(""cumsum_left"") FROM ""tst"")+1)/2) LIMIT 1))/2 AS ""Median"""
4,"WITH ""t"" AS (SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN 2 ELSE 1 END AS ""num"",CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END AS ""ind"" FROM ""Numbers"") SELECT DISTINCT CASE WHEN ""cnt"">1 OR ""num""=1 THEN FIRST_VALUE(""NUMBER"") OVER (ORDER BY ""Number"") ELSE AVG(""Number"") END AS ""median"" FROM (SELECT ""Number"",""cm""-""ind""+1 AS ""cnt"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cm"" FROM ""Numbers"") AS ""tmp"" JOIN ""t"" WHERE ""t"".""ind""<=""cm"" LIMIT 2) AS ""tmp"" JOIN ""t"""
5,"WITH ""cte"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""running_sum"",(SUM(""frequency"") OVER ())/2 AS ""median"" FROM ""Numbers"") SELECT AVG(""number"") AS ""median"" FROM ""cte"" WHERE ""median"" BETWEEN ""running_sum""-""frequency"" AND ""running_Sum"""
6,"SELECT (""X"".""Number""+""Y"".""number"")/2 AS ""median"" FROM (SELECT ""X"".*,RANK() OVER (ORDER BY CASE WHEN ""cum_freq""-""md""<0 THEN ""cum_freq""-""md""+(""md""*3) ELSE ""cum_freq""-""md"" END) AS ""nr"" FROM (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cum_freq"" FROM ""Numbers"") AS ""X"", (SELECT (SUM(""frequency"")-1)/2 AS ""md"" FROM ""Numbers"") AS ""md"") AS ""X"", (SELECT ""X"".*,RANK() OVER (ORDER BY CASE WHEN ""cum_freq""-""md""<0 THEN ""cum_freq""-""md""+(""md""*3) ELSE ""cum_freq""-""md"" END) AS ""nr"" FROM (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cum_freq"" FROM ""Numbers"") AS ""X"", (SELECT ((SUM(""frequency""))/2+1) AS ""md"" FROM ""Numbers"") AS ""md"") AS ""Y"" WHERE ""X"".""nr""=1 AND ""Y"".""nr""=1"
7,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rk2"" FROM ""Numbers"") SELECT AVG(""Number""*1.0) AS ""median"" FROM ""tmp"" WHERE ABS(""rk1""-""rk2"")<=""Frequency"""
8,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rk2"" FROM ""Numbers"") SELECT AVG(""Number""*1.0) AS ""median"" FROM ""tmp"" WHERE ABS(""rk1""-""rk2"")<=""Frequency"""
9,"SELECT ROUND(SUM(""Number"")/COUNT(""Number""), 2) AS ""median"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumulative_num"",SUM(""Frequency"") OVER () AS ""total_num"" FROM ""Numbers"") AS ""sub"" WHERE ""total_num""/2.0 BETWEEN ""cumulative_num""-""Frequency"" AND ""cumulative_num"""
10,"WITH ""cte"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
11,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""sum1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""sum2"" FROM ""Numbers"") AS ""sub"" WHERE ""Frequency"">=ABS(""sum1""-""sum2"")"
12,"WITH RECURSIVE ""cte"" (""cnt"", ""Number"", ""Frequency"") AS (SELECT 1 AS ""cnt"",""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""cnt""+1 AS ""cnt"",""Number"",""Frequency""-1 FROM ""cte"" WHERE ""Frequency"">1), ""cte1"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""rk"" FROM ""cte"") SELECT AVG(""number"") AS ""median"" FROM ""cte1"" WHERE ""rk"" BETWEEN (SELECT COUNT(1) FROM ""cte1"")/2 AND (SELECT COUNT(1) FROM ""cte1"")/2+1"
13,"WITH ""t1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""rnk"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num1"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2+1 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num2"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num1"")>=0 AND (""rnk""-""num1"")=(SELECT MIN(""rnk""-""num1"") FROM ""t1"" WHERE (""rnk""-""num1"")>=0))+(SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num2"")>=0 AND (""rnk""-""num2"")=(SELECT MIN(""rnk""-""num2"") FROM ""t1"" WHERE (""rnk""-""num2"")>=0)))/2 AS ""median"""
14,"WITH ""aa"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"" FROM ""Numbers"") SELECT (MIN(""num_1"")+MIN(""num_2""))/2 AS ""median"" FROM (SELECT ""aa"".*,CASE WHEN ""cum_freq"">=FLOOR(((SELECT MAX(""cum_freq"") FROM ""aa"")+1)/2) THEN ""number"" END AS ""num_1"",CASE WHEN ""cum_freq"">=CEIL(((SELECT MAX(""cum_freq"") FROM ""aa"")+1)/2) THEN ""number"" END AS ""num_2"" FROM ""aa"") AS ""tt"""
15,"WITH ""CUMU"" AS (SELECT ""NUMBER"",""FREQUENCY"",SUM(""FREQUENCY"") OVER (ORDER BY ""NUMBER"") AS ""CUM_FREQ"" FROM ""NUMBERS"" GROUP BY 1,2), ""MID_POINT"" AS (SELECT SUM(""FREQUENCY"") AS ""SUM_FREQ"",FLOOR(SUM(""FREQUENCY"")/2) AS ""FLR_MID"",CEIL(SUM(""FREQUENCY"")/2) AS ""CEIL_MID"" FROM ""NUMBERS""), ""FLR_NUM"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""FLR_DIFF"") AS ""FLR_DIFF_RNK"" FROM (SELECT ""C"".""NUMBER"",(""C"".""CUM_FREQ""-""MP"".""FLR_MID"") AS ""FLR_DIFF"" FROM ""CUMU"" AS ""C"" JOIN ""MID_POINT"" AS ""MP"" ON 1=1 WHERE ""C"".""CUM_FREQ"">=""MP"".""FLR_MID"" AND ""MP"".""FLR_MID""=""MP"".""CEIL_MID"") AS ""T""), ""CEIL_NUM"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""CEIL_DIFF"") AS ""CEIL_DIFF_RNK"" FROM (SELECT ""C"".""NUMBER"",""C"".""CUM_FREQ""-(CASE WHEN ""MP"".""CEIL_MID""=""MP"".""FLR_MID"" THEN ""MP"".""FLR_MID""+1 ELSE ""MP"".""CEIL_MID"" END) AS ""CEIL_DIFF"" FROM ""CUMU"" AS ""C"" JOIN ""MID_POINT"" AS ""MP"" ON 1=1 WHERE ""C"".""CUM_FREQ"">=(CASE WHEN ""MP"".""CEIL_MID""=""MP"".""FLR_MID"" THEN ""MP"".""FLR_MID""+1 ELSE ""MP"".""CEIL_MID"" END)) AS ""T"") SELECT CASE WHEN ""FN"".""NUMBER"" IS NOT NULL THEN ROUND((""CN"".""NUMBER""+""FN"".""NUMBER"")/2, 4) ELSE ""CN"".""NUMBER"" END AS ""median"" FROM ""CEIL_NUM"" AS ""CN"" LEFT JOIN ""FLR_NUM"" AS ""FN"" ON 1=1 AND ""FN"".""FLR_DIFF_RNK""=1 WHERE ""CN"".""CEIL_DIFF_RNK""=1"
16,"WITH ""cte"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""m1"",FLOOR((SUM(""frequency"")+2)/2) AS ""m2"" FROM ""numbers""), ""cte2"" AS (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""presum"" FROM ""numbers""), ""n1"" AS (SELECT ""number"" FROM ""cte2"" WHERE ""presum"">=(SELECT ""m1"" FROM ""cte"") LIMIT 1), ""n2"" AS (SELECT ""number"" FROM ""cte2"" WHERE ""presum"">=(SELECT ""m2"" FROM ""cte"") LIMIT 1) SELECT AVG(""number"") AS ""median"" FROM (SELECT * FROM ""n1"" UNION SELECT * FROM ""n2"") AS ""t"""
17,"WITH RECURSIVE ""r1"" AS (SELECT ""Number"",1 AS ""freq"",""frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""freq""+1,""frequency"" FROM ""r1"" WHERE ""freq""<""frequency""), ""r2"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""rnk"" FROM ""r1"") SELECT AVG(""number"") AS ""median"" FROM ""r2"" WHERE ""rnk"" BETWEEN (SELECT MAX(""rnk"")/2 FROM ""r2"") AND (SELECT (MAX(""rnk"")/2)+1 FROM ""r2"")"
18,"WITH ""cte"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""low"",SUM(""frequency"") OVER (ORDER BY ""number"" DESC) AS ""high"" FROM ""Numbers"") SELECT ""number""/COUNT(DISTINCT ""number"") AS ""median"" FROM ""cte"" WHERE ABS(""high""-""low"")<=""frequency"""
19,"WITH ""temp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""number"") AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""temp"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
20,"WITH ""rk"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cs"" FROM ""numbers"") SELECT AVG(""number""*1.00) AS ""median"" FROM ""rk"" WHERE (SELECT SUM(""frequency"")/2.0 FROM ""rk"") BETWEEN ""cs""-""frequency"" AND ""cs"""
21,"WITH ""base"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""sum_freq"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""base"" WHERE ""sum_freq""/2 BETWEEN ""cum_freq""-""Frequency"" AND ""cum_freq"""
22,"WITH ""cte"" AS (SELECT CASE WHEN SUM(""frequency"")%2!=0 THEN CEILING(SUM(""frequency"")/2) ELSE SUM(""frequency"")/2 END AS ""position"",CASE WHEN SUM(""frequency"")%2!=0 THEN 'odd' ELSE 'even' END AS ""quant"" FROM ""numbers""), ""cte1"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""total"" FROM ""numbers""), ""cte2"" AS (SELECT ""number"",""frequency"",""total"",COALESCE(LAG(""total"") OVER (ORDER BY ""number""), 0) AS ""pre"" FROM ""cte1""), ""even_median"" AS (SELECT ""cte2"".""number"" FROM ""cte2"" JOIN ""cte"" ON ""cte"".""position"">""cte2"".""pre"" AND ""cte"".""position""<=""cte2"".""total"" WHERE ""cte"".""quant""='even' UNION ALL SELECT ""cte2"".""number"" FROM ""cte2"" JOIN ""cte"" ON ""cte"".""position""+1>""cte2"".""pre"" AND ""cte"".""position""+1<=""cte2"".""total"" WHERE ""cte"".""quant""='even'), ""cte3"" AS (SELECT AVG(""number"") AS ""median"" FROM ""even_median"" UNION ALL SELECT ""cte2"".""number"" FROM ""cte2"" JOIN ""cte"" ON ""cte"".""position"">""cte2"".""pre"" AND ""cte"".""position""<=""cte2"".""total"" WHERE ""cte"".""quant""='odd') SELECT * FROM ""cte3"" WHERE ""median"" IS NOT NULL"
23,"WITH ""cte"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cumsum"",SUM(""frequency"") OVER () AS ""total_sum"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ((SELECT ""number"" FROM ""cte"" AS ""a"" WHERE ""a"".""cumsum"">=0.5*""a"".""total_sum"" LIMIT 1) UNION ALL (SELECT CASE WHEN ""a"".""total_sum""%2=0 THEN ""number"" ELSE NULL END AS ""number"" FROM ""cte"" AS ""a"" WHERE ""a"".""cumsum"">=0.5*""a"".""total_sum""+(SELECT CASE WHEN ""c"".""total_sum""%2=0 THEN 1 ELSE 0 END AS ""t"" FROM ""cte"" AS ""c"" LIMIT 1) LIMIT 1)) AS ""b"""
24,"WITH RECURSIVE ""all_nums"" AS (SELECT ""number"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency""-1 FROM ""all_nums"" WHERE ""frequency"">1), ""ranked"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"",""frequency"") AS ""ra"",ROW_NUMBER() OVER (ORDER BY ""number"" DESC,""frequency"" DESC) AS ""rd"" FROM ""all_nums"") SELECT ROUND(AVG(""number""), 4) AS ""median"" FROM ""ranked"" WHERE ""ra"" BETWEEN ""rd""-1 AND ""rd""+1"
25,"WITH ""CTE"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""total"" FROM ""Numbers"") SELECT CASE WHEN MAX(""total"")%2=0 THEN ((SELECT ""Number"" FROM ""CTE"" WHERE ""total"">=(SELECT MAX(""total"")/2 FROM ""CTE"") ORDER BY ""total"" LIMIT 1)+(SELECT ""Number"" FROM ""CTE"" WHERE ""total"">=(SELECT MAX(""total"")/2+1 FROM ""CTE"") ORDER BY ""total"" LIMIT 1))/2 ELSE (SELECT ""Number"" FROM ""CTE"" WHERE ""total"">=(SELECT (MAX(""total"")+1)/2 FROM ""CTE"") ORDER BY ""total"" LIMIT 1) END AS ""median"" FROM ""CTE"""
26,"WITH ""upper"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""upper_bound"" FROM ""numbers""), ""lower"" AS (SELECT ""number"",""frequency"",LAG(""upper_bound"", 1) OVER (ORDER BY ""number"") AS ""lower_bound"" FROM ""upper""), ""ind"" AS (SELECT CASE WHEN SUM(""frequency"")%2=0 THEN SUM(""frequency"")/2-0.5 ELSE SUM(""frequency"")/2 END AS ""number1"",CASE WHEN SUM(""frequency"")%2=0 THEN SUM(""frequency"")/2+0.5 ELSE SUM(""frequency"")/2 END AS ""number2"" FROM ""numbers""), ""ind1"" AS (SELECT DISTINCT ""ind"" FROM (SELECT ""number1"" AS ""ind"" FROM ""ind"" UNION ALL SELECT ""number2"" AS ""ind"" FROM ""ind"") AS ""temp"") SELECT AVG(""l"".""number"") AS ""median"" FROM (""lower"" AS ""l"" JOIN ""upper"" AS ""u"" ON ""l"".""number""=""u"".""number"") LEFT JOIN ""ind1"" AS ""i"" ON ""i"".""ind"">COALESCE(""lower_bound"", 0) AND ""i"".""ind""<=""upper_bound"" WHERE ""i"".""ind"" IS NOT NULL"
27,"WITH RECURSIVE ""tmp"" AS (SELECT ""Number"",""Frequency"",1 AS ""dummy"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 AS ""Frequency"",1 AS ""dummy"" FROM ""tmp"" WHERE ""Frequency"">1), ""tmp2"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""row_num"",COUNT(""Number"") OVER (PARTITION BY ""dummy"") AS ""total_length"" FROM ""tmp""), ""odd"" AS (SELECT ROUND(""Number"", 2) AS ""median"" FROM ""tmp2"" WHERE ""total_length""%2=1 AND ""row_num""=CEIL(""total_length""/2)), ""even"" AS (SELECT ROUND(AVG(""Number""), 2) AS ""median"" FROM ""tmp2"" WHERE ""total_length""%2=0 AND ""row_num"" IN (""total_length""/2,""total_length""/2+1)), ""tmp3"" AS (SELECT ""median"" FROM ""odd"" UNION SELECT ""median"" FROM ""even"") SELECT ""median"" FROM ""tmp3"" WHERE ""median"" IS NOT NULL"
28,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",""frequency"",COALESCE(SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), 0) AS ""left_total"",COALESCE(SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING), 0) AS ""right_total"" FROM ""numbers"") AS ""a"" WHERE ""frequency"">=ABS(""left_total""-""right_total"")"
29,"WITH ""cte"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_sum"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM (""cte"") JOIN (SELECT SUM(""Frequency"") AS ""total"" FROM ""Numbers"") AS ""t"" WHERE ""cum_sum"">=0.5*""t"".""total"" AND ""cum_sum""-""Frequency""<=0.5*""t"".""total"""
30,"SELECT AVG(""Number""*1.00) AS ""Median"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"")-""Frequency""+1 AS ""StartIndex"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""EndIndex"",SUM(""Frequency"") OVER () AS ""TotalCount"" FROM ""Numbers"") AS ""A"" WHERE (""TotalCount""+1)/2 BETWEEN ""StartIndex"" AND ""EndIndex"" OR (""TotalCount""%2=0 AND (((""TotalCount""/2.00)+1 BETWEEN ""StartIndex"" AND ""EndIndex"") OR ((""TotalCount""/2.00)-1 BETWEEN ""StartIndex"" AND ""EndIndex"")))"
31,"SELECT AVG(""b"".""number"") AS ""median"" FROM (SELECT CASE (""sum_freq""%2) WHEN 0 THEN FLOOR((""sum_freq""+1)/2) ELSE ((""sum_freq""+1)/2) END AS ""lower"",CASE (""sum_freq""%2) WHEN 0 THEN FLOOR((""sum_freq""+1)/2)+1 ELSE ((""sum_freq""+1)/2) END AS ""upper"" FROM (SELECT SUM(""Frequency"") AS ""sum_freq"" FROM ""Numbers"") AS ""f"") AS ""a"" JOIN (SELECT ""Number"",""rolling_freq"",COALESCE(LAG(""rolling_freq"", 1) OVER (ORDER BY ""Number""), 0) AS ""lag1"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rolling_freq"" FROM ""Numbers"") AS ""t"") AS ""b"" WHERE (""b"".""lag1""<""a"".""lower"" AND ""a"".""lower""<=""b"".""rolling_freq"") OR (""b"".""lag1""<""a"".""upper"" AND ""a"".""upper""<=""b"".""rolling_freq"")"
32,"WITH ""rt"" AS (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""running_total"" FROM ""numbers""), ""mid"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""med"" FROM ""numbers"" UNION SELECT CEILING((SUM(""frequency"")+1)/2) AS ""med"" FROM ""numbers""), ""min_med"" AS (SELECT MIN(""rt"".""number"") AS ""median"" FROM ""rt"" JOIN ""mid"" ON ""rt"".""running_total"">=""mid"".""med"" GROUP BY ""mid"".""med"") SELECT AVG(""median"") AS ""median"" FROM ""min_med"""
33,"WITH ""cte"" AS (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""max_limit"",LEAD(""number"") OVER (ORDER BY ""number"") AS ""next_num"",""total_num"" FROM (""numbers"") JOIN (SELECT SUM(""frequency"")/2 AS ""total_num"" FROM ""numbers"") AS ""t1"") SELECT SUM(""median"") AS ""median"" FROM (SELECT COALESCE(LAG(""max_limit"") OVER (ORDER BY ""number""), 0),CASE WHEN ""total_num"">COALESCE(LAG(""max_limit"") OVER (ORDER BY ""number""), 0) AND ""total_num""<""max_limit"" THEN ""number"" WHEN ""total_num""=""max_limit"" THEN (""number""+""next_num"")/2 ELSE 0 END AS ""median"" FROM ""cte"") AS ""t1"""
34,"WITH ""idx"" AS (SELECT CEIL(SUM(""Frequency"")/2) AS ""n1"",CEIL((SUM(""Frequency"")+1)/2) AS ""n2"" FROM ""Numbers""), ""csum"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""frequency"" FROM ""numbers"") SELECT (""fst"".""Number""+""snd"".""Number"")/2 AS ""median"" FROM (SELECT ""c1"".""Number"",MIN(""c1"".""frequency"") FROM ""idx"" AS ""i"" JOIN ""csum"" AS ""c1"" ON ""i"".""n1""<=""c1"".""frequency"") AS ""fst"", (SELECT ""c2"".""Number"",MIN(""c2"".""frequency"") FROM ""idx"" AS ""i"" JOIN ""csum"" AS ""c2"" ON ""i"".""n2""<=""c2"".""frequency"") AS ""snd"""
35,"WITH ""r"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""running_total"" FROM ""Numbers""), ""r2"" AS (SELECT FLOOR((SUM(""Frequency"")+1)/2) AS ""pos"" FROM ""Numbers"" UNION SELECT CEILING((SUM(""Frequency"")+1)/2) AS ""pos"" FROM ""Numbers"") SELECT AVG(""r3"".""number"") AS ""median"" FROM (SELECT ""r2"".""pos"",MIN(""r"".""running_total""),""r"".""number"" FROM ""r"" JOIN ""r2"" ON ""r"".""running_total"">=""r2"".""pos"" GROUP BY ""r2"".""pos"") AS ""r3"""
36,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency""-1 FROM ""cte"" WHERE ""frequency""-1>=1), ""rk"" AS (SELECT ""number"",RANK() OVER (ORDER BY ""number"",""frequency"") AS ""jb"" FROM ""cte""), ""med"" AS (SELECT CASE WHEN MAX(""jb"")%2=0 THEN MAX(""jb"")/2+1 ELSE (MAX(""jb"")+1)/2 END AS ""t1"",CASE WHEN MAX(""jb"")%2=0 THEN MAX(""jb"")/2 ELSE (MAX(""jb"")+1)/2 END AS ""t2"" FROM ""rk"") SELECT AVG(""number"") AS ""median"" FROM ""rk"" WHERE ""jb"" IN (SELECT ""t1"" FROM ""med"") OR ""jb"" IN (SELECT ""t2"" FROM ""med"")"
37,"WITH ""cte1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rank_asc"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rank_desc"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""cte1"" WHERE ABS(""rank_asc""-""rank_desc"")<=""Frequency"""
38,"WITH RECURSIVE ""numbers_tb"" AS (SELECT ""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 FROM ""numbers_tb"" WHERE ""Frequency"">1), ""numers_all"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""rank_number"" FROM ""numbers_tb"") SELECT AVG(""number"") AS ""median"" FROM (""numers_all"") JOIN (SELECT MAX(""rank_number"") AS ""max_rank"" FROM ""numers_all"") AS ""k"" WHERE ""rank_number"" BETWEEN ""max_rank""/2 AND ""max_rank""/2+1"
39,"WITH ""c"" AS (SELECT ""number"",""frequency"",COALESCE(SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), 0)+1 AS ""sf"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""ef"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""tf"" FROM ""numbers"") SELECT 1.0*SUM(CASE WHEN FLOOR(""tf""/2)+1 BETWEEN ""sf"" AND ""ef"" THEN ""number"" ELSE 0 END+CASE WHEN ""tf""%2=0 AND (""tf""/2) BETWEEN ""sf"" AND ""ef"" THEN ""number"" ELSE 0 END)/(CASE WHEN ""tf""%2=0 THEN 2 ELSE 1 END) AS ""median"" FROM ""c"""
40,"WITH ""median_pos"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""med1"",CEILING((SUM(""frequency"")+1)/2) AS ""med2"" FROM ""Numbers""), ""rnge"" AS (SELECT ""Number"",SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""upper"",SUM(""frequency"") OVER (ORDER BY ""Number"")-""Frequency""+1 AS ""lower"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""median_pos"" AS ""p"" JOIN ""rnge"" AS ""r"" ON ""p"".""med1"" BETWEEN ""r"".""lower"" AND ""r"".""upper"" OR ""p"".""med2"" BETWEEN ""r"".""lower"" AND ""r"".""upper"""
41,"WITH ""temp_cte2"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""prev_sum"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""next_sum"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""temp_cte2"" WHERE ABS(""prev_sum""-""next_sum"")<=""frequency"""
42,"WITH ""median_number"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""NUmber"") AS ""cum_Freq"",SUM(""Frequency"") OVER () AS ""total_count"" FROM ""Numbers"" AS ""n"") SELECT AVG(""NUmber"") AS ""median"" FROM ""median_number"" WHERE ""total_count""/2 BETWEEN ""cum_Freq""-""Frequency"" AND ""cum_Freq"""
43,"SELECT AVG(""b"".""number"") AS ""median"" FROM (SELECT CASE (""sum_freq""%2) WHEN 0 THEN FLOOR((""sum_freq""+1)/2) ELSE ((""sum_freq""+1)/2) END AS ""lower"",CASE (""sum_freq""%2) WHEN 0 THEN FLOOR((""sum_freq""+1)/2)+1 ELSE ((""sum_freq""+1)/2) END AS ""upper"" FROM (SELECT SUM(""Frequency"") AS ""sum_freq"" FROM ""Numbers"") AS ""f"") AS ""a"" JOIN (SELECT ""Number"",""rolling_freq"",COALESCE(LAG(""rolling_freq"", 1) OVER (ORDER BY ""Number""), 0) AS ""lag1"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rolling_freq"" FROM ""Numbers"") AS ""t"") AS ""b"" WHERE (""b"".""lag1""<""a"".""lower"" AND ""a"".""lower""<=""b"".""rolling_freq"") OR (""b"".""lag1""<""a"".""upper"" AND ""a"".""upper""<=""b"".""rolling_freq"")"
44,"WITH ""cte"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cumsum"",SUM(""frequency"") OVER () AS ""total_sum"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ((SELECT ""number"" FROM ""cte"" AS ""a"" WHERE ""a"".""cumsum"">=0.5*""a"".""total_sum"" LIMIT 1) UNION ALL (SELECT CASE WHEN ""a"".""total_sum""%2=0 THEN ""number"" ELSE NULL END AS ""number"" FROM ""cte"" AS ""a"" WHERE ""a"".""cumsum"">=0.5*""a"".""total_sum""+1 LIMIT 1)) AS ""b"""
45,"WITH ""t"" AS (SELECT ""Number"",COALESCE(SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), 0)+1 AS ""RangeStart"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""RangeEnd"",SUM(""Frequency"") OVER () AS ""Total"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""t"" WHERE (CEIL(""Total""/2) BETWEEN ""RangeStart"" AND ""RangeEnd"") OR (""Total""/2+1 BETWEEN ""RangeStart"" AND ""RangeEnd"")"
46,"WITH ""PartialSums"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER () AS ""Total"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""Preceding"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""PartialSums"" WHERE ""Preceding""-""Frequency""<=""Total""/2 AND ""Total""/2<=""Preceding"""
47,"WITH RECURSIVE ""expand"" AS (SELECT ""Number"",1 AS ""ct"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""ct""+1,""Frequency"" FROM ""expand"" WHERE ""ct""<""Frequency""), ""ranks"" AS (SELECT ""number"",RANK() OVER (ORDER BY ""number"",""ct"") AS ""r"",COUNT(1) OVER () AS ""max_v"" FROM ""expand"") SELECT AVG(""number"") AS ""median"" FROM ""ranks"" WHERE ""r"">=FLOOR((""max_v""+1)/2) AND ""r""<=CEILING((""max_v""+1)/2)"
48,"WITH ""median_pos"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""med1"",CEILING((SUM(""frequency"")+1)/2) AS ""med2"" FROM ""Numbers""), ""rnge"" AS (SELECT ""Number"",SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""upper"",SUM(""frequency"") OVER (ORDER BY ""Number"")-""Frequency""+1 AS ""lower"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""median_pos"" AS ""p"" JOIN ""rnge"" AS ""r"" ON ""p"".""med1"" BETWEEN ""r"".""lower"" AND ""r"".""upper"" OR ""p"".""med2"" BETWEEN ""r"".""lower"" AND ""r"".""upper"""
49,"WITH RECURSIVE ""expand"" AS (SELECT ""Number"",1 AS ""ct"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""ct""+1,""Frequency"" FROM ""expand"" WHERE ""ct""<""Frequency""), ""cte"" AS (SELECT ""number"",RANK() OVER ""w"" AS ""r"" FROM ""expand"" WINDOW ""w"" AS (ORDER BY ""number"",""ct"")), ""x"" AS (SELECT * FROM ""cte"" GROUP BY ""r"" HAVING ""r"">=FLOOR((MAX(""r"")+1)/2) AND ""r""<=CEILING((MAX(""r"")+1)/2)), ""y"" AS (SELECT ""number"",""r"",MAX(""r"") OVER () AS ""max_v"" FROM ""cte"") SELECT AVG(""number"") AS ""median"" FROM ""y"" WHERE ""r"">=FLOOR((""max_v""+1)/2) AND ""r""<=CEILING((""max_v""+1)/2)"
50,"WITH ""cte"" AS (SELECT *,COALESCE(LAG(""cum_freq"", 1) OVER (ORDER BY ""Number""), 0) AS ""lag_cum_freq"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"" FROM ""Numbers"") AS ""t"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE (""lag_cum_freq""<(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"") AND ""cum_freq"">=(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"")) OR (""lag_cum_freq""<(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers"") AND ""cum_freq"">=(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers""))"
51,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
52,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rankup"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rankdown"" FROM ""Numbers"") SELECT AVG(CAST(""Number"" AS FLOAT)) AS ""median"" FROM ""tmp"" WHERE ""Frequency"">=ABS(""rankup""-""rankdown"")"
53,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""Number"",""Frequency"",(SUM(""Frequency"") OVER (ORDER BY ""Number""))/(SUM(""Frequency"") OVER ()) AS ""p1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC)/(SUM(""Frequency"") OVER ()) AS ""p2"" FROM ""Numbers"" ORDER BY ""Number"") AS ""temp"" WHERE ""p1""=0.5 OR ""p2""=0.5 OR ""p1"">0.5 AND ""p1""<=""p2"""
54,"SELECT AVG(1.0*""Number"") AS ""median"" FROM (SELECT *,SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""cum_sum"",(SUM(""Frequency"") OVER ())/2.0 AS ""mid"" FROM ""Numbers"") AS ""temp"" WHERE ""mid"" BETWEEN ""cum_sum""-""frequency"" AND ""cum_sum"""
55,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rk2"" FROM ""Numbers"") SELECT AVG(""Number""*1.0) AS ""median"" FROM ""tmp"" WHERE ABS(""rk1""-""rk2"")<=""Frequency"""
56,"WITH ""cte"" AS (SELECT FLOOR((SUM(""Frequency"")+1)/2) AS ""m1"",FLOOR((SUM(""Frequency"")+2)/2) AS ""m2"" FROM ""Numbers""), ""cte2"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""presum"" FROM ""Numbers""), ""low"" AS (SELECT ""Number"" FROM ""cte2"" WHERE ""presum"">=(SELECT ""m1"" FROM ""cte"") LIMIT 1), ""high"" AS (SELECT ""Number"" FROM ""cte2"" WHERE ""presum"">=(SELECT ""m2"" FROM ""cte"") LIMIT 1) SELECT AVG(""number"") AS ""median"" FROM (SELECT * FROM ""low"" UNION SELECT * FROM ""high"") AS ""t"""
57,"ERROR: mysql parse error: line 1 column 206 near ""&amp; cnt/2>=(cum_sum-frequency) "" "
58,"WITH ""pct"" AS (SELECT ""Number"",(SUM(""Frequency"") OVER (ORDER BY ""Number""))/(SUM(""Frequency"") OVER ()) AS ""pct1"",(SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC))/(SUM(""Frequency"") OVER ()) AS ""pct2"" FROM ""Numbers"" ORDER BY ""Number"") SELECT AVG(""Number"") AS ""median"" FROM ""pct"" WHERE ""pct1""=0.5 OR ""pct2""=0.5 OR ""pct1"">0.5 AND ""pct1""<=""pct2"""
59,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",""frequency"" AS ""n"" FROM ""numbers"" UNION ALL SELECT ""number"",""n""-1 FROM ""cte"" WHERE ""n""-1>=1) SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"",""n"" DESC) AS ""rn"",(SELECT SUM(""frequency"") FROM ""numbers"") AS ""total"" FROM ""cte"") AS ""temp"" WHERE ""rn"" BETWEEN (""total""/2) AND (""total""/2+1)"
60,"WITH ""cte"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"",SUM(""Frequency"") OVER ()/2 AS ""median_pos"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE ""median_pos"" BETWEEN ""cum_freq""-""Frequency"" AND ""cum_freq"""
61,"WITH ""cte1"" AS (SELECT DISTINCT CASE WHEN (SELECT SUM(""Frequency"") FROM ""Numbers"")%2!=0 THEN ((SELECT SUM(""Frequency"") FROM ""Numbers"")+1)/2 ELSE ((SELECT SUM(""Frequency"") FROM ""Numbers""))/2 END AS ""t1"",CASE WHEN (SELECT SUM(""Frequency"") FROM ""Numbers"")%2!=0 THEN NULL ELSE ((SELECT SUM(""Frequency"") FROM ""Numbers"")+2)/2 END AS ""t2"" FROM ""Numbers""), ""cte2"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"")-(SELECT ""t1"" FROM ""cte1"") AS ""k1"",SUM(""Frequency"") OVER (ORDER BY ""Number"")-(SELECT ""t2"" FROM ""cte1"") AS ""k2"" FROM ""Numbers""), ""cte3"" AS (SELECT ""number"" FROM ""cte2"" WHERE ""k1"" IN (SELECT MIN(""k1"") FROM ""cte2"" WHERE ""k1"">=0)), ""cte4"" AS (SELECT ""number"" FROM ""cte2"" WHERE ""k2"" IN (SELECT MIN(""k2"") FROM ""cte2"" WHERE ""k2"">=0)), ""cte5"" AS (SELECT ""number"" AS ""median"" FROM ""cte3"" UNION SELECT ""number"" AS ""median"" FROM ""cte4"") SELECT AVG(""median"") AS ""median"" FROM ""cte5"""
62,"WITH RECURSIVE ""all_nums1"" AS (SELECT ""number"",""frequency"",1 AS ""cnt"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency"",1+""cnt"" AS ""cnt"" FROM ""all_nums1"" WHERE ""cnt""<""frequency""), ""all_nums2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_num"" FROM ""all_nums1"") SELECT AVG(""number"") AS ""median"" FROM ""all_nums2"" WHERE ""row_num"" BETWEEN (SELECT COUNT(1) FROM ""all_nums2"")/2 AND (SELECT COUNT(1) FROM ""all_nums2"")/2+1"
63,"WITH ""cte1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""freq_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""freq_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""cte1"" WHERE ABS(""freq_left""-""freq_right"")<=""Frequency"""
64,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cumsum"",SUM(""frequency"") OVER ()/2.0 AS ""medpos"" FROM ""numbers"") AS ""a"" WHERE ""medpos"" BETWEEN ""cumsum""-""frequency"" AND ""cumsum"""
65,"WITH ""tt"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""NUMBER"") AS ""csum"" FROM ""Numbers""), ""t1"" AS (SELECT ""total"",""odd_index"",CASE WHEN ""total""%2=0 THEN ""odd_index""-1 ELSE NULL END AS ""even_index"" FROM (SELECT SUM(""FREQUENCY"") AS ""total"",FLOOR(SUM(""FREQUENCY"")/2)+1 AS ""odd_index"" FROM ""Numbers"") AS ""t2""), ""t3"" AS (SELECT ""Number"",""Frequency"",LAG(""csum"", 1, 0) OVER (ORDER BY ""NUmber"") AS ""lag_csum"",""csum"",""even_index"",""odd_index"" FROM ""tt"" JOIN ""t1"") SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""Number"" FROM ""T3"" WHERE ""even_index"">""lag_csum"" AND ""even_index""<=""csum"" UNION ALL SELECT ""Number"" FROM ""T3"" WHERE ""odd_index"">""lag_csum"" AND ""odd_index""<=""csum"") AS ""t4"""
66,"WITH ""median_pos"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""med1"",CEILING((SUM(""frequency"")+1)/2) AS ""med2"" FROM ""Numbers""), ""rnge"" AS (SELECT ""Number"",SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""upper"",SUM(""frequency"") OVER (ORDER BY ""Number"")-""Frequency""+1 AS ""lower"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM (""median_pos"" AS ""p"") JOIN ""rnge"" AS ""r"" WHERE ""p"".""med1"" BETWEEN ""r"".""lower"" AND ""r"".""upper"" OR ""p"".""med2"" BETWEEN ""r"".""lower"" AND ""r"".""upper"""
67,"WITH ""CUMU"" AS (SELECT ""NUMBER"",""FREQUENCY"",SUM(""FREQUENCY"") OVER (ORDER BY ""NUMBER"") AS ""CUM_FREQ"" FROM ""NUMBERS"" GROUP BY 1,2), ""MID_POINT"" AS (SELECT SUM(""FREQUENCY"") AS ""SUM_FREQ"",FLOOR(SUM(""FREQUENCY"")/2) AS ""FLR_MID"",CEIL(SUM(""FREQUENCY"")/2) AS ""CEIL_MID"" FROM ""NUMBERS""), ""FLR_NUM"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""FLR_DIFF"") AS ""FLR_DIFF_RNK"" FROM (SELECT ""C"".""NUMBER"",(""C"".""CUM_FREQ""-""MP"".""FLR_MID"") AS ""FLR_DIFF"" FROM ""CUMU"" AS ""C"" JOIN ""MID_POINT"" AS ""MP"" ON 1=1 WHERE ""C"".""CUM_FREQ"">=""MP"".""FLR_MID"" AND ""MP"".""FLR_MID""=""MP"".""CEIL_MID"") AS ""T""), ""CEIL_NUM"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""CEIL_DIFF"") AS ""CEIL_DIFF_RNK"" FROM (SELECT ""C"".""NUMBER"",""C"".""CUM_FREQ""-(CASE WHEN ""MP"".""CEIL_MID""=""MP"".""FLR_MID"" THEN ""MP"".""FLR_MID""+1 ELSE ""MP"".""CEIL_MID"" END) AS ""CEIL_DIFF"" FROM ""CUMU"" AS ""C"" JOIN ""MID_POINT"" AS ""MP"" ON 1=1 WHERE ""C"".""CUM_FREQ"">=(CASE WHEN ""MP"".""CEIL_MID""=""MP"".""FLR_MID"" THEN ""MP"".""FLR_MID""+1 ELSE ""MP"".""CEIL_MID"" END)) AS ""T"") SELECT CASE WHEN ""FN"".""NUMBER"" IS NOT NULL THEN ROUND((""CN"".""NUMBER""+""FN"".""NUMBER"")/2, 4) ELSE ""CN"".""NUMBER"" END AS ""median"" FROM ""CEIL_NUM"" AS ""CN"" LEFT JOIN ""FLR_NUM"" AS ""FN"" ON 1=1 AND ""FN"".""FLR_DIFF_RNK""=1 WHERE ""CN"".""CEIL_DIFF_RNK""=1"
68,"WITH ""tmp1"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""rnk"",(SELECT (CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END) FROM ""Numbers"") AS ""num1"",(SELECT (CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2+1 ELSE (SUM(""Frequency"")+1)/2 END) FROM ""Numbers"") AS ""num2"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""tmp1"" WHERE (""rnk"">=""num1"") AND (""rnk""-""num1"")=(SELECT MIN(""rnk""-""num1"") FROM ""tmp1"" WHERE (""rnk"">=""num1"")))+(SELECT ""Number"" FROM ""tmp1"" WHERE (""rnk"">=""num2"") AND (""rnk""-""num2"")=(SELECT MIN(""rnk""-""num2"") FROM ""tmp1"" WHERE (""rnk"">=""num2""))))/2 AS ""median"""
69,"WITH RECURSIVE ""expand"" AS (SELECT ""Number"",1 AS ""ct"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""ct""+1,""Frequency"" FROM ""expand"" WHERE ""ct""<""Frequency""), ""ranks"" AS (SELECT ""number"",RANK() OVER (ORDER BY ""number"",""ct"") AS ""r"",COUNT(1) OVER () AS ""max_v"" FROM ""expand""), ""cte"" AS (SELECT ""number"",""r"",MAX(""r"") OVER () AS ""max_v"" FROM ""ranks"") SELECT AVG(""number"") AS ""median"" FROM ""ranks"" WHERE ""r"">=FLOOR((""max_v""+1)/2) AND ""r""<=CEILING((""max_v""+1)/2)"
70,"WITH RECURSIVE ""tmp"" AS (SELECT *,1 AS ""seq"" FROM ""numbers"" UNION ALL SELECT ""number"",""Frequency"",""seq""+1 AS ""seq"" FROM ""tmp"" WHERE ""seq""<""Frequency"") SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_nbr"",COUNT(1) OVER () AS ""ttl_cnt"" FROM ""tmp"") AS ""t"" WHERE ""row_nbr"" BETWEEN ""ttl_cnt""/2 AND ""ttl_cnt""/2+1"
71,"WITH ""cte"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""f"",SUM(""Frequency"") OVER ()/2 AS ""m"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE ""m"" BETWEEN (""f""-""Frequency"") AND ""f"""
72,"WITH ""median_loc"" AS (SELECT SUM(""Frequency"")+1 AS ""t_frequency"",CASE WHEN (SUM(""Frequency"")+1)%2=0 THEN (SUM(""Frequency"")+1)/2 ELSE (SUM(""Frequency"")+1)/2-0.5 END AS ""median_loc_left"",CASE WHEN (SUM(""Frequency"")+1)%2=0 THEN (SUM(""Frequency"")+1)/2 ELSE (SUM(""Frequency"")+1)/2+0.5 END AS ""median_loc_right"" FROM ""Numbers""), ""frequency_loc"" AS (SELECT ""Number"",COALESCE(""frequency_loc_left"", 1) AS ""frequency_loc_left"",COALESCE(""frequency_loc_left"", 1)+""Frequency""-1 AS ""frequency_loc_right"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING)+1 AS ""frequency_loc_left"" FROM ""Numbers"") AS ""a"") SELECT (""b"".""Number""+""c"".""Number"")/2 AS ""median"" FROM (""median_loc"" AS ""a"" JOIN ""frequency_loc"" AS ""b"" ON ""a"".""median_loc_left"" BETWEEN ""b"".""frequency_loc_left"" AND ""b"".""frequency_loc_right"") JOIN ""frequency_loc"" AS ""c"" ON ""a"".""median_loc_right"" BETWEEN ""c"".""frequency_loc_left"" AND ""c"".""frequency_loc_right"""
73,"WITH RECURSIVE ""tmp"" AS (SELECT *,1 AS ""seq"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency"",""seq""+1 AS ""seq"" FROM ""tmp"" WHERE ""seq""<""Frequency""), ""tmp2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_nbr"",COUNT(1) OVER () AS ""ttl_cnt"" FROM ""tmp"") SELECT AVG(""number"") AS ""median"" FROM ""tmp2"" WHERE ""row_nbr"" BETWEEN ""ttl_cnt""/2 AND ""ttl_cnt""/2+1"
74,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency""-1 FROM ""cte"" WHERE ""frequency"">1), ""cte1"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""rnk"" FROM ""cte"") SELECT AVG(""number"") AS ""median"" FROM ""cte1"" WHERE ""rnk""=(SELECT MAX(""rnk"")/2 FROM ""cte1"") OR ""rnk""=(SELECT (1+MAX(""rnk""))/2 FROM ""cte1"") OR ""rnk""=(SELECT 1+MAX(""rnk"")/2 FROM ""cte1"")"
75,"WITH RECURSIVE ""AllNums"" AS (SELECT ""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 AS ""Frequency"" FROM ""AllNums"" WHERE ""Frequency"">1), ""OrderedList"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""Rn"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""Counter"" FROM ""AllNums"") SELECT AVG(""Number"") AS ""median"" FROM ""OrderedList"" WHERE ""Rn"" IN ((""counter""+1)/2,""counter""/2,(""counter""/2)+1)"
76,"WITH ""temp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""number"") AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""cumsum_right"" FROM ""Numbers"") SELECT ROUND(AVG(""Number""), 4) AS ""median"" FROM ""temp"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
77,"SELECT AVG(""NUMBER"") AS ""median"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumsum"",(SUM(""frequency"") OVER ())/2 AS ""median_num"" FROM ""Numbers"") AS ""temp"" WHERE ""cumsum""-""Frequency""<=""median_num"" AND ""cumsum"">=""median_num"""
78,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""total"" FROM ""numbers"") AS ""a"", (SELECT SUM(""frequency"") AS ""t"" FROM ""numbers"") AS ""b"" WHERE ""total""*2>=""t"" AND (""total""-""frequency"")*2<=""t"""
79,"WITH RECURSIVE ""all_nums1"" AS (SELECT ""number"",""frequency"",1 AS ""cnt"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency"",1+""cnt"" AS ""cnt"" FROM ""all_nums1"" WHERE ""cnt""<""frequency""), ""all_nums2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_num"" FROM ""all_nums1"") SELECT AVG(""number"") AS ""median"" FROM ""all_nums2"" WHERE ""row_num"" BETWEEN (SELECT COUNT(1) FROM ""all_nums2"")/2 AND (SELECT COUNT(1) FROM ""all_nums2"")/2+1"
80,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rk2"" FROM ""Numbers"") SELECT AVG(""Number"")*1.0 AS ""median"" FROM ""tmp"" WHERE ""Frequency"">=ABS(""rk1""-""rk2"")"
81,"WITH RECURSIVE ""rec1"" AS (SELECT ""number"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency""-1 FROM ""rec1"" WHERE ""frequency"">1), ""rec2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"",""frequency"") AS ""rnum_asc"",ROW_NUMBER() OVER (ORDER BY ""number"" DESC,""frequency"" DESC) AS ""rnum_desc"" FROM ""rec1"") SELECT AVG(""number"") AS ""median"" FROM ""rec2"" WHERE ""rnum_asc""=""rnum_desc"" OR ""rnum_asc""=""rnum_desc""-1 OR ""rnum_asc""=""rnum_desc""+1"
82,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rk2"" FROM ""Numbers"") SELECT AVG(""Number""*1.0) AS ""median"" FROM ""tmp"" WHERE ABS(""rk1""-""rk2"")<=""Frequency"""
83,"WITH ""temp1"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""rolsum"" FROM ""Numbers"" ORDER BY ""rolsum"") SELECT ((SELECT ""number"" FROM ""temp1"" WHERE ""rolsum"">=CEILING(((SELECT MAX(""rolsum"") FROM ""temp1"")+1)/2) LIMIT 1)+(SELECT ""number"" FROM ""temp1"" WHERE ""rolsum"">=CEILING(((SELECT MAX(""rolsum"") FROM ""temp1""))/2) LIMIT 1))/2 AS ""median"""
84,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rt"",SUM(""Frequency"") OVER () AS ""m"" FROM ""Numbers"") AS ""a"" WHERE ""m""/2 BETWEEN ""rt""-""Frequency"" AND ""rt"""
85,"WITH ""summary"" AS (SELECT ""number"",""frequency"",(SUM(""frequency"") OVER (ORDER BY ""number"")/SUM(""frequency"") OVER ()) AS ""per1"",(SUM(""frequency"") OVER (ORDER BY ""number"" DESC)/SUM(""frequency"") OVER ()) AS ""per2"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""summary"" WHERE ""per1""=0.5 OR ""per2""=0.5 OR ""per1"">0.5 AND ""per1""<=""per2"""
86,"WITH ""total_size"" AS (SELECT SUM(""Frequency"") AS ""ttl"" FROM ""Numbers""), ""median_pos"" AS (SELECT CASE WHEN ""ttl""%2=0 THEN ""ttl""/2 ELSE ROUND(""ttl""/2, 0) END AS ""pos1"",CASE WHEN ""ttl""%2=0 THEN (""ttl""/2)+1 ELSE NULL END AS ""pos2"" FROM ""total_size""), ""cumul_num"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""ttl"" FROM ""Numbers""), ""num1q"" AS (SELECT 'a' AS ""lbl"",MIN(""c"".""Number"") AS ""num1"" FROM ""cumul_num"" AS ""c"" JOIN ""median_pos"" AS ""m"" ON ""m"".""pos1""<=""c"".""ttl"" GROUP BY ""lbl""), ""num2q"" AS (SELECT 'a' AS ""lbl"",CASE WHEN ""pos2"" IS NOT NULL THEN MIN(""c"".""Number"") ELSE NULL END AS ""num2"" FROM ""cumul_num"" AS ""c"" JOIN ""median_pos"" AS ""m"" ON ""m"".""pos1""+1<=""c"".""ttl"" GROUP BY ""lbl"") SELECT CASE WHEN ""num2"" IS NOT NULL THEN (""num1""+""num2"")/2 ELSE ""num1"" END AS ""median"" FROM ""num1q"" JOIN ""num2q"" ON ""num1q"".""lbl""=""num2q"".""lbl"""
87,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""running_total"",SUM(""frequency"") OVER (ORDER BY ""number"" DESC) AS ""reverse_running_total"" FROM ""numbers"" ORDER BY 1) AS ""t"" WHERE ""running_total"">=(SELECT SUM(""frequency"")/2 FROM ""numbers"") AND ""reverse_running_total"">=(SELECT SUM(""frequency"")/2 FROM ""numbers"")"
88,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumulative"" FROM ""Numbers"") AS ""t1"", (SELECT SUM(""Frequency"") AS ""total"" FROM ""Numbers"") AS ""t2"" WHERE ""total""/2.0 BETWEEN ""cumulative""-""Frequency"" AND ""cumulative"""
89,"WITH ""a"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""c"" FROM ""Numbers"") SELECT ((SELECT MIN(""NUMBER"") FROM ""a"" WHERE ""c"">=CEILING((SELECT SUM(""Frequency"")/2 AS ""m"" FROM ""Numbers"")))+(SELECT MIN(""NUMBER"") FROM ""a"" WHERE ""c"">=CEILING((SELECT (SUM(""Frequency"")+1)/2 AS ""m"" FROM ""Numbers""))))/2 AS ""median"""
90,"WITH ""a"" AS (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""s1"",SUM(""frequency"") OVER (ORDER BY ""number"" DESC) AS ""s2"" FROM ""numbers""), ""b"" AS (SELECT SUM(""frequency"")/2 AS ""cnt"" FROM ""numbers"") SELECT AVG(""a"".""number"") AS ""median"" FROM ""a"" WHERE ""a"".""s1"">=(SELECT ""cnt"" FROM ""b"") AND ""a"".""s2"">=(SELECT ""cnt"" FROM ""b"")"
91,"WITH ""t"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""freq"",(SUM(""Frequency"") OVER ())/2 AS ""median_freq"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""t"" WHERE ""median_freq"" BETWEEN (""freq""-""Frequency"") AND ""freq"""
92,"SELECT AVG(""median"") AS ""median"" FROM (SELECT MIN(""n"".""number"") AS ""median"" FROM (SELECT ""number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""running_total"" FROM ""Numbers"") AS ""n"" JOIN (SELECT FLOOR((SUM(""Frequency"")+1)/2) AS ""median_pos"" FROM ""Numbers"" UNION SELECT CEILING((SUM(""Frequency"")+1)/2) AS ""median_pos"" FROM ""Numbers"") AS ""m"" ON ""n"".""running_total"">=""m"".""median_pos"" GROUP BY ""m"".""median_pos"") AS ""a"""
93,"WITH ""t"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""position"" FROM (SELECT * FROM ""numbers"" ORDER BY ""number"") AS ""sub""), ""t1"" AS (SELECT *,COALESCE(LAG(""position"") OVER (ORDER BY ""number""), -1) AS ""pl"" FROM ""t""), ""t2"" AS (SELECT CASE WHEN SUM(""frequency"")%2=1 THEN (SUM(""frequency"")+1)/2 END AS ""odd"",CASE WHEN SUM(""frequency"")%2=0 THEN SUM(""frequency"")/2 END AS ""even1"",CASE WHEN SUM(""frequency"")%2=0 THEN SUM(""frequency"")/2+1 END AS ""even2"" FROM ""t1""), ""t3"" AS (SELECT ""number"" FROM ""t1"" WHERE ((SELECT ""even2"" FROM ""t2"")>""pl"" AND (SELECT ""even2"" FROM ""t2"")<=""position"") UNION ALL SELECT ""number"" FROM ""t1"" WHERE ((SELECT ""even1"" FROM ""t2"")>""pl"" AND (SELECT ""even1"" FROM ""t2"")<=""position"") UNION ALL SELECT ""number"" FROM ""t1"" WHERE ((SELECT ""odd"" FROM ""t2"")>""pl"" AND (SELECT ""odd"" FROM ""t2"")<=""position"")) SELECT AVG(""number"") AS ""median"" FROM ""t3"""
94,"WITH RECURSIVE ""expand"" AS (SELECT ""Number"",1 AS ""ct"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""ct""+1,""Frequency"" FROM ""expand"" WHERE ""ct""<""Frequency""), ""ranks"" AS (SELECT ""number"",RANK() OVER (ORDER BY ""number"",""ct"") AS ""r"",COUNT(1) OVER () AS ""max_v"" FROM ""expand"") SELECT AVG(""number"") AS ""median"" FROM ""ranks"" WHERE ""r"">=FLOOR((""max_v""+1)/2) AND ""r""<=CEILING((""max_v""+1)/2)"
95,"WITH ""cte"" AS (SELECT SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""cumsum_right"",""Number"",""Frequency"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""frequency"""
96,"WITH ""t1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rnk"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num1"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2+1 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num2"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num1"")>=0 AND (""rnk""-""num1"")=(SELECT MIN(""rnk""-""num1"") FROM ""t1"" WHERE (""rnk""-""num1"")>=0))+(SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num2"")>=0 AND (""rnk""-""num2"")=(SELECT MIN(""rnk""-""num2"") FROM ""t1"" WHERE (""rnk""-""num2"")>=0)))/2 AS ""median"""
97,"WITH ""idx"" AS (SELECT CASE WHEN SUM(""frequency"")%2=0 THEN SUM(""frequency"")/2 ELSE (SUM(""frequency"")+1)/2 END AS ""left_val"",CASE WHEN SUM(""frequency"")%2=0 THEN SUM(""frequency"")/2+1 ELSE (SUM(""frequency"")+1)/2 END AS ""right_val"" FROM ""numbers""), ""temp"" AS (SELECT ""number"",COALESCE(LAG(""cnt"", 1) OVER (ORDER BY ""number"")+1, 0) AS ""left_idx"",""cnt"" FROM (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cnt"" FROM ""numbers"") AS ""cte"") SELECT (""t1"".""number""+""t2"".""number"")/2 AS ""median"" FROM ((""temp"" AS ""t1"") JOIN ""temp"" AS ""t2"") JOIN ""idx"" WHERE ""t1"".""left_idx""<=""left_val"" AND ""t1"".""cnt"">=""left_val"" AND ""t2"".""left_idx""<=""right_val"" AND ""t2"".""cnt"">=""right_val"""
98,"WITH RECURSIVE ""cte_spine"" AS (SELECT 1 AS ""i"" UNION ALL SELECT ""i""+1 AS ""i"" FROM ""cte_spine"" WHERE ""i""<(SELECT MAX(""Frequency"") FROM ""Numbers"")), ""cte_explode"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""Sequence"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""Total_Count"" FROM ""cte_spine"" AS ""s"" JOIN ""Numbers"" AS ""n"" ON ""s"".""i""<=""n"".""Frequency"" ORDER BY 2), ""cte_median"" AS (SELECT AVG(""number"") AS ""Median"" FROM ""cte_explode"" WHERE ""Sequence"" IN (""Total_Count""/2,((""Total_Count""/2)+0.5),((""Total_Count""/2)+1))) SELECT * FROM ""cte_median"""
99,"WITH RECURSIVE ""NUM_LIST"" AS (SELECT ""NUMBER"",1 AS ""DUMMY"" FROM ""NUMBERS"" UNION ALL SELECT ""N1"".""NUMBER"",""DUMMY""+1 FROM (""NUM_LIST"" AS ""N1"") JOIN ""NUMBERS"" AS ""N2"" WHERE ""N1"".""DUMMY""<""N2"".""FREQUENCY"" AND ""N1"".""NUMBER""=""N2"".""NUMBER""), ""ORDERED_LIST"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""NUMBER"") AS ""RN"",COUNT(1) OVER () AS ""TOT"" FROM ""NUM_LIST"") SELECT AVG(""NUMBER"") AS ""Median"" FROM ""ORDERED_LIST"" WHERE (""TOT""%2=0 AND (""TOT""/2=""RN"" OR FLOOR(""TOT""/2)+1=""RN"")) OR (""TOT""%2=1 AND FLOOR(""TOT""/2)+1=""RN"")"
100,"WITH RECURSIVE ""total_rows"" AS (SELECT ""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 FROM ""total_rows"" WHERE ""Frequency"">1), ""max_count"" AS (SELECT SUM(""Frequency"") AS ""max_count"" FROM ""Numbers""), ""row_count"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""row_num"" FROM ""total_rows"" ORDER BY ""Number""), ""first_half"" AS (SELECT ""Number"" FROM ""row_count"" JOIN ""max_count"" WHERE ""row_num""=(""max_count""/2)), ""second_half"" AS (SELECT ""Number"" FROM ""row_count"" JOIN ""max_count"" WHERE ""row_num""=(""max_count""/2+1)) SELECT CASE WHEN ""max_count""%2=0 THEN (""first_half"".""Number""+""second_half"".""Number"")/2.0 ELSE ""first_half"".""Number"" END AS ""median"" FROM (""first_half"" JOIN ""second_half"") JOIN ""max_count"""
101,"WITH RECURSIVE ""table1"" AS (SELECT ""Number"",COUNT(""Number"") AS ""cnt"",""Frequency"" FROM ""Numbers"" GROUP BY ""Number""), ""cte"" AS (SELECT ""Number"",""cnt"",""Frequency"" FROM ""table1"" UNION ALL SELECT ""Number"",""cnt""+1,""Frequency"" FROM ""cte"" WHERE ""cnt""<""Frequency""), ""table2"" AS (SELECT ""Number"",""Frequency"",ROW_NUMBER() OVER (ORDER BY ""NUMBER"") AS ""rn"" FROM ""cte"" ORDER BY ""Number"") SELECT (CASE WHEN SUM(""Frequency"")/2%2=0 THEN SUM(""Number"")/2 ELSE ""Number"" END) AS ""median"" FROM ""table2"" WHERE ""rn"" BETWEEN (SELECT SUM(""FREQUENCY"")/2 FROM ""Numbers"") AND (SELECT SUM(""FREQUENCY"")/2+1 FROM ""Numbers"")"
102,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
103,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",""frequency"" AS ""n"" FROM ""numbers"" UNION ALL SELECT ""number"",""n""-1 FROM ""cte"" WHERE ""n""-1>=1) SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_num"",(SELECT SUM(""frequency"") FROM ""numbers"") AS ""total"" FROM ""cte"") AS ""a"" WHERE ""row_num"" BETWEEN (""total""/2) AND (""total""/2+1)"
104,"SELECT (""SQ4"".""num""+""SQ5"".""num"")/2 AS ""median"" FROM (SELECT MIN(""SQ3"".""Number"") AS ""num"" FROM (SELECT ""SQ2"".""Number"",""SQ2"".""RN"",""SQ2"".""running_total"",""SQ2"".""pos1"",""SQ2"".""pos2"",(CASE WHEN ""running_total"">=""pos1"" THEN 1 ELSE 0 END) AS ""flag1"",(CASE WHEN ""running_total"">=""pos2"" THEN 1 ELSE 0 END) AS ""flag2"" FROM (SELECT ""N1"".""Number"",ROW_NUMBER() OVER (ORDER BY ""N1"".""Number"") AS ""RN"",SUM(""N1"".""frequency"") OVER (ORDER BY ""N1"".""Number"") AS ""running_total"",""N2"".""total"",""N2"".""pos1"",""N2"".""pos2"" FROM (""Numbers"" AS ""N1"") JOIN (SELECT SUM(""frequency"") AS ""total"",(CASE WHEN SUM(""frequency"")%2=1 THEN (SUM(""frequency"")+1)/2 WHEN SUM(""frequency"")%2=0 THEN (SUM(""frequency""))/2 END) AS ""pos1"",(CASE WHEN SUM(""frequency"")%2=1 THEN (SUM(""frequency"")+1)/2 WHEN SUM(""frequency"")%2=0 THEN (SUM(""frequency"")+2)/2 END) AS ""pos2"" FROM ""Numbers"") AS ""N2"") AS ""SQ2"") AS ""SQ3"" WHERE ""flag1""=1) AS ""SQ4"", (SELECT MIN(""SQ3"".""Number"") AS ""num"" FROM (SELECT ""SQ2"".""Number"",""SQ2"".""RN"",""SQ2"".""running_total"",""SQ2"".""pos1"",""SQ2"".""pos2"",(CASE WHEN ""running_total"">=""pos1"" THEN 1 ELSE 0 END) AS ""flag1"",(CASE WHEN ""running_total"">=""pos2"" THEN 1 ELSE 0 END) AS ""flag2"" FROM (SELECT ""N1"".""Number"",ROW_NUMBER() OVER (ORDER BY ""N1"".""Number"") AS ""RN"",SUM(""N1"".""frequency"") OVER (ORDER BY ""N1"".""Number"") AS ""running_total"",""N2"".""total"",""N2"".""pos1"",""N2"".""pos2"" FROM (""Numbers"" AS ""N1"") JOIN (SELECT SUM(""frequency"") AS ""total"",(CASE WHEN SUM(""frequency"")%2=1 THEN (SUM(""frequency"")+1)/2 WHEN SUM(""frequency"")%2=0 THEN (SUM(""frequency""))/2 END) AS ""pos1"",(CASE WHEN SUM(""frequency"")%2=1 THEN (SUM(""frequency"")+1)/2 WHEN SUM(""frequency"")%2=0 THEN (SUM(""frequency"")+2)/2 END) AS ""pos2"" FROM ""Numbers"") AS ""N2"") AS ""SQ2"") AS ""SQ3"" WHERE ""flag2""=1) AS ""SQ5"""
105,"WITH RECURSIVE ""t1"" AS (SELECT ""number"",1 AS ""occurance"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""occurance""+1,""frequency"" FROM ""t1"" WHERE ""occurance""<""frequency""), ""t2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""num_index"" FROM ""t1"") SELECT AVG(""number"") AS ""median"" FROM ""t2"" WHERE ""num_index"" BETWEEN (SELECT MAX(""num_index"")/2 FROM ""t2"") AND (SELECT (MAX(""num_index"")/2)+1 FROM ""t2"")"
106,"WITH ""cte"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rolling_total"",SUM(""Frequency"") OVER () AS ""total"" FROM ""Numbers""), ""cte2"" AS (SELECT ""Number"",(CASE WHEN ""total""%2=1 AND (""total""+1)/2 BETWEEN (""rolling_total""-""frequency""+1) AND ""rolling_total"" THEN 'T' WHEN ""total""%2=0 AND (""total"")/2 BETWEEN (""rolling_total""-""frequency""+1) AND ""rolling_Total"" THEN 'T' WHEN ""total""%2=0 AND (""total""/2)+1 BETWEEN (""rolling_total""-""frequency""+1) AND ""rolling_total"" THEN 'T' ELSE 'F' END) AS ""if_median_or_not"" FROM ""cte"") SELECT AVG(""number"") AS ""median"" FROM ""cte2"" WHERE ""if_median_or_not""='T'"
107,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_sum"",(SUM(""Frequency"") OVER ())/2.0 AS ""mid"" FROM ""Numbers"") AS ""a"" WHERE ""mid"" BETWEEN ""cum_sum""-""Frequency"" AND ""cum_sum"""
108,"WITH ""rk"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cs"" FROM ""numbers"") SELECT AVG(""number""*1.00) AS ""median"" FROM ""rk"" WHERE (SELECT SUM(""frequency"")/2.0 FROM ""rk"") BETWEEN ""cs""-""frequency"" AND ""cs"""
109,"WITH ""CUMU"" AS (SELECT ""NUMBER"",""FREQUENCY"",SUM(""FREQUENCY"") OVER (ORDER BY ""NUMBER"") AS ""CUM_FREQ"" FROM ""NUMBERS"" GROUP BY 1,2), ""MID_POINT"" AS (SELECT SUM(""FREQUENCY"") AS ""SUM_FREQ"",FLOOR(SUM(""FREQUENCY"")/2) AS ""FLR_MID"",CEIL(SUM(""FREQUENCY"")/2) AS ""CEIL_MID"" FROM ""NUMBERS""), ""FLR_NUM"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""FLR_DIFF"") AS ""FLR_DIFF_RNK"" FROM (SELECT ""C"".""NUMBER"",(""C"".""CUM_FREQ""-""MP"".""FLR_MID"") AS ""FLR_DIFF"" FROM ""CUMU"" AS ""C"" JOIN ""MID_POINT"" AS ""MP"" ON 1=1 WHERE ""C"".""CUM_FREQ"">=""MP"".""FLR_MID"" AND ""MP"".""FLR_MID""=""MP"".""CEIL_MID"") AS ""T""), ""CEIL_NUM"" AS (SELECT ""NUMBER"",ROW_NUMBER() OVER (ORDER BY ""CEIL_DIFF"") AS ""CEIL_DIFF_RNK"" FROM (SELECT ""C"".""NUMBER"",""C"".""CUM_FREQ""-(CASE WHEN ""MP"".""CEIL_MID""=""MP"".""FLR_MID"" THEN ""MP"".""FLR_MID""+1 ELSE ""MP"".""CEIL_MID"" END) AS ""CEIL_DIFF"" FROM ""CUMU"" AS ""C"" JOIN ""MID_POINT"" AS ""MP"" ON 1=1 WHERE ""C"".""CUM_FREQ"">=(CASE WHEN ""MP"".""CEIL_MID""=""MP"".""FLR_MID"" THEN ""MP"".""FLR_MID""+1 ELSE ""MP"".""CEIL_MID"" END)) AS ""T"") SELECT CASE WHEN ""FN"".""NUMBER"" IS NOT NULL THEN ROUND((""CN"".""NUMBER""+""FN"".""NUMBER"")/2, 4) ELSE ""CN"".""NUMBER"" END AS ""median"" FROM ""CEIL_NUM"" AS ""CN"" LEFT JOIN ""FLR_NUM"" AS ""FN"" ON 1=1 AND ""FN"".""FLR_DIFF_RNK""=1 WHERE ""CN"".""CEIL_DIFF_RNK""=1"
110,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumulative_num"",SUM(""Frequency"") OVER () AS ""total_num"" FROM ""Numbers"") AS ""sub"" WHERE ""total_num""/2.0 BETWEEN ""cumulative_num""-""Frequency"" AND ""cumulative_num"""
111,"WITH ""temp"" AS (SELECT ""total"",CASE WHEN ""total""%2=1 THEN (""total""+1)/2 ELSE ""total""/2 END AS ""med"" FROM (SELECT SUM(""frequency"") AS ""total"" FROM ""numbers"") AS ""t"") SELECT COALESCE(ROUND(AVG(""number""), 2), 0) AS ""median"" FROM (SELECT ""number"",""endpt"",""frequency"",(""endpt""-""frequency"")+1 AS ""startpt"" FROM (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""endpt"" FROM ""numbers"") AS ""t"") AS ""t"" WHERE CASE WHEN (SELECT ""total"" FROM ""temp"")%2=1 THEN (SELECT ""med"" FROM ""temp"") BETWEEN ""startpt"" AND ""endpt"" ELSE (SELECT ""med"" FROM ""temp"") BETWEEN ""startpt"" AND ""endpt"" OR (SELECT ""med"" FROM ""temp"")+1 BETWEEN ""startpt"" AND ""endpt"" END"
112,"WITH ""summary"" AS (SELECT ""number"",""frequency"",(SUM(""frequency"") OVER (ORDER BY ""number"")/SUM(""frequency"") OVER ()) AS ""per1"",(SUM(""frequency"") OVER (ORDER BY ""number"" DESC)/SUM(""frequency"") OVER ()) AS ""per2"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""summary"" WHERE ""per1""=0.5 OR ""per2""=0.5 OR ""per1"">0.5 AND ""per1""<=""per2"""
113,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",COALESCE(SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), 0) AS ""cumulative_frequency_lower"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumulative_frequency_higher"",SUM(""Frequency"") OVER () AS ""total_size"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tmp"" WHERE ""cumulative_frequency_lower""<=(""total_size""+1)/2.0 AND ""total_size""-""cumulative_frequency_higher""<=(""total_size""+1)/2.0"
114,"WITH RECURSIVE ""AllNumbers"" AS (SELECT ""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 AS ""Frequency"" FROM ""AllNumbers"" WHERE ""Frequency"">1), ""Temp"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""Rnk"",""Number"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""Total"" FROM ""AllNumbers"") SELECT AVG(""Number"") AS ""median"" FROM ""Temp"" WHERE ""Rnk"" IN (((""Total""/2)+0.5),""Total""/2,""Total""/2+1)"
115,"WITH ""t"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""freq"",(SUM(""frequency"") OVER ())/2 AS ""median_num"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE ""median_num"" BETWEEN (""freq""-""frequency"") AND ""freq"""
116,"WITH ""m_pos"" AS (SELECT CEILING((SUM(""Frequency"")+1)/2) AS ""m1"",FLOOR((SUM(""Frequency"")+1)/2) AS ""m2"" FROM ""Numbers""), ""cum_count"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_ct"" FROM ""Numbers""), ""rnge"" AS (SELECT ""Number"",COALESCE(LAG(""cum_ct"", 1) OVER (), 0) AS ""lower"",""cum_ct"" AS ""upper"" FROM ""cum_count"") SELECT AVG(""rnge"".""Number"") AS ""median"" FROM (""rnge"") JOIN ""m_pos"" WHERE (""m_pos"".""m1"">""rnge"".""lower"" AND ""m_pos"".""m1""<=""rnge"".""upper"") OR (""m_pos"".""m2"">""rnge"".""lower"" AND ""m_pos"".""m2""<=""rnge"".""upper"")"
117,"WITH ""sum_freq"" AS (SELECT *,LAG(""sum_freq"") OVER () AS ""sum_freq_lag"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""sum_freq"" FROM ""Numbers"") AS ""n"") SELECT CASE WHEN (SELECT SUM(""Frequency"") FROM ""Numbers"")%2=0 THEN ((SELECT ""Number"" FROM ""sum_freq"" WHERE (SELECT SUM(""Frequency"")/2 FROM ""Numbers"") BETWEEN COALESCE(""sum_freq_lag"", 0) AND ""sum_freq"" LIMIT 1)+(SELECT ""Number"" FROM ""sum_freq"" WHERE (SELECT (SUM(""Frequency"")/2)+1 FROM ""Numbers"") BETWEEN COALESCE(""sum_freq_lag"", 0) AND ""sum_freq"" LIMIT 1))/2 ELSE (SELECT ""Number"" FROM ""sum_freq"" WHERE (SELECT SUM(""Frequency"")/2 FROM ""Numbers"") BETWEEN COALESCE(""sum_freq_lag"", 0) AND ""sum_freq"") END AS ""median"" FROM ""Numbers"" LIMIT 1"
118,"WITH ""t1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""rnk"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num1"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2+1 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num2"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num1"")>=0 AND (""rnk""-""num1"")=(SELECT MIN(""rnk""-""num1"") FROM ""t1"" WHERE (""rnk""-""num1"")>=0))+(SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num2"")>=0 AND (""rnk""-""num2"")=(SELECT MIN(""rnk""-""num2"") FROM ""t1"" WHERE (""rnk""-""num2"")>=0)))/2 AS ""median"""
119,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",""frequency"" FROM ""Numbers"" UNION ALL SELECT ""number"",""frequency""-1 AS ""frequency"" FROM ""cte"" WHERE ""frequency"">1), ""sorted"" AS (SELECT * FROM ""cte"" ORDER BY ""number""), ""tbl1"" AS (SELECT ""t2"".* FROM (SELECT @""am"":=0) AS ""t"", (SELECT @""am"":=@""am""+1 AS ""row_id"",""sorted"".* FROM ""sorted"") AS ""t2"") SELECT AVG(""tbl1"".""number"") AS ""median"" FROM ""tbl1"" JOIN (SELECT FLOOR((COUNT(1)+1)/2) AS ""id"" FROM ""cte"" UNION SELECT CEILING((COUNT(1)+1)/2) FROM ""cte"") AS ""t3"" ON ""tbl1"".""row_id""=""t3"".""id"""
120,"WITH ""CTE"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""total"" FROM ""Numbers"") SELECT CASE WHEN MAX(""total"")%2=0 THEN ((SELECT ""Number"" FROM ""CTE"" WHERE ""total"">=(SELECT MAX(""total"")/2 FROM ""CTE"") ORDER BY ""total"" LIMIT 1)+(SELECT ""Number"" FROM ""CTE"" WHERE ""total"">=(SELECT MAX(""total"")/2+1 FROM ""CTE"") ORDER BY ""total"" LIMIT 1))/2 ELSE (SELECT ""Number"" FROM ""CTE"" WHERE ""total"">=(SELECT (MAX(""total"")+1)/2 FROM ""CTE"") ORDER BY ""total"" LIMIT 1) END AS ""median"" FROM ""CTE"""
121,"WITH ""tmp"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""number"") AS ""cum_freq"",CEIL(SUM(""Frequency"") OVER ()/2) AS ""m1"",FLOOR(SUM(""Frequency"") OVER ()/2)+1 AS ""m2"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ((SELECT * FROM ""tmp"" WHERE ""cum_freq"">=""m1"" LIMIT 1) UNION (SELECT * FROM ""tmp"" WHERE ""cum_freq"">=""m2"" LIMIT 1)) AS ""t"""
122,"WITH ""X"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""run_total"",(SUM(""Frequency"") OVER ())/2 AS ""med"",LEAD(""Number"") OVER (ORDER BY ""Number"") AS ""next_num"" FROM ""Numbers"") SELECT ROUND((CASE WHEN ""med"">(""run_total""-""Frequency"") AND ""med""<""run_total"" THEN ""Number"" WHEN ""med""=""run_total"" THEN (""Number""+""next_num"")/2 END), 4) AS ""median"" FROM ""X"" WHERE (""med"">(""run_total""-""Frequency"") AND ""med""<""run_total"") OR (""med""=""run_total"")"
123,"WITH ""temp"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""incresum"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""temp"" WHERE (""incresum""-""frequency""<(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"") AND ""incresum"">=(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"")) OR (""incresum""-""frequency""<(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers"") AND ""incresum"">=(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers""))"
124,"WITH ""sum_freq"" AS (SELECT *,LAG(""sum_freq"") OVER () AS ""sum_freq_lag"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""sum_freq"" FROM ""Numbers"") AS ""n"") SELECT CASE WHEN (SELECT SUM(""Frequency"") FROM ""Numbers"")%2=0 THEN ((SELECT ""Number"" FROM ""sum_freq"" WHERE (SELECT SUM(""Frequency"")/2 FROM ""Numbers"") BETWEEN COALESCE(""sum_freq_lag"", 0) AND ""sum_freq"" LIMIT 1)+(SELECT ""Number"" FROM ""sum_freq"" WHERE (SELECT (SUM(""Frequency"")/2)+1 FROM ""Numbers"") BETWEEN COALESCE(""sum_freq_lag"", 0) AND ""sum_freq"" LIMIT 1))/2 ELSE (SELECT ""Number"" FROM ""sum_freq"" WHERE (SELECT SUM(""Frequency"")/2 FROM ""Numbers"") BETWEEN COALESCE(""sum_freq_lag"", 0) AND ""sum_freq"") END AS ""median"""
125,"WITH ""temp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rd"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""ra"" FROM ""Numbers"") SELECT AVG(1.0*""Number"") AS ""median"" FROM ""temp"" WHERE ""Frequency"">=ABS(""ra""-""rd"")"
126,"WITH RECURSIVE ""cte1"" (""number"", ""counter"", ""frequency"") AS (SELECT ""number"",1 AS ""counter"",""frequency"" FROM ""numbers"" UNION SELECT ""number"",""counter""+1,""frequency"" FROM ""cte1"" WHERE ""counter""+1<=""frequency""), ""cte2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"",""counter"") AS ""rn"" FROM ""cte1"") SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"" FROM ""cte2"" WHERE ""rn"" BETWEEN ((SELECT MAX(""rn"") FROM ""cte2"")/2) AND ((SELECT MAX(""rn"") FROM ""cte2"")/2+1)) AS ""temp"""
127,"WITH ""t"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""freq"",(SUM(""frequency"") OVER ())/2 AS ""median_num"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE ""median_num"" BETWEEN (""freq""-""frequency"") AND ""freq"""
128,"WITH ""cte"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rk2"" FROM ""Numbers"") SELECT AVG(""Number""*1.0) AS ""median"" FROM ""cte"" WHERE ABS(""rk1""-""rk2"")<=""Frequency"""
129,"WITH RECURSIVE ""t1"" AS (SELECT ""number"",1 AS ""occurance"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""occurance""+1,""frequency"" FROM ""t1"" WHERE ""occurance""<""frequency""), ""t2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""num_index"" FROM ""t1"") SELECT AVG(""number"") AS ""median"" FROM ""t2"" WHERE ""num_index"" BETWEEN (SELECT MAX(""num_index"")/2 FROM ""t2"") AND (SELECT (MAX(""num_index"")/2)+1 FROM ""t2"")"
130,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",MAX(""frequency"") AS ""mf"" FROM ""numbers"" GROUP BY ""number"" UNION ALL SELECT ""number"",""mf""-1 AS ""mf"" FROM ""cte"" WHERE ""mf"">1), ""od"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""number"" DESC,""row_asc"" DESC) AS ""row_desc"" FROM (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_asc"" FROM ""cte"") AS ""od"" ORDER BY ""number"") SELECT AVG(""number"") AS ""median"" FROM ""od"" WHERE ""row_asc""=""row_desc"" OR ""row_asc""=""row_desc""+1 OR ""row_asc""=""row_desc""-1"
131,"WITH RECURSIVE ""cte_spine"" AS (SELECT 1 AS ""i"" UNION ALL SELECT ""i""+1 AS ""i"" FROM ""cte_spine"" WHERE ""i""<(SELECT MAX(""Frequency"") FROM ""Numbers"")), ""cte_explode"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""Sequence"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""Total_Count"" FROM ""cte_spine"" AS ""s"" JOIN ""Numbers"" AS ""n"" ON ""s"".""i""<=""n"".""Frequency"" ORDER BY 2), ""cte_median"" AS (SELECT AVG(""number"") AS ""Median"" FROM ""cte_explode"" WHERE ""Sequence"" IN (""Total_Count""/2,((""Total_Count""/2)+0.5),((""Total_Count""/2)+1))) SELECT * FROM ""cte_median"""
132,"WITH ""cum_numbers"" AS (SELECT ""number"",""frequency"",CASE WHEN ""start"" IS NULL THEN 1 ELSE ""start""+1 END AS ""start"",""end""+1 AS ""end"" FROM (SELECT ""number"",""frequency"",LAG(""cum_frequency"", 1) OVER (ORDER BY ""number"") AS ""start"",""cum_frequency"" AS ""end"" FROM (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cum_frequency"" FROM ""numbers"") AS ""t"") AS ""t""), ""indexes"" AS (SELECT CASE WHEN (SELECT MAX(""end"")-1 FROM ""cum_numbers"")%2=1 THEN ROUND((SELECT (MAX(""end"")-1)/2 FROM ""cum_numbers""), 0) ELSE (SELECT (MAX(""end"")-1)/2 FROM ""cum_numbers"") END AS ""index_1"",CASE WHEN (SELECT (MAX(""end"")-1) FROM ""cum_numbers"")%2=1 THEN NULL ELSE (SELECT ((MAX(""end"")-1)/2)+1 FROM ""cum_numbers"") END AS ""index_2"") SELECT AVG(""t1"".""number"") AS ""median"" FROM ""cum_numbers"" AS ""t1"" JOIN ""indexes"" AS ""t2"" ON (""t2"".""index_1"">=""t1"".""start"" AND ""t2"".""index_1""<""t1"".""end"") OR (""t2"".""index_2"">=""t1"".""start"" AND ""t2"".""index_2""<""t1"".""end"")"
133,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""asc_sum"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""desc_sum"" FROM ""Numbers"") AS ""t"" WHERE ""asc_sum"">=(SELECT SUM(""Frequency"") FROM ""Numbers"")/2 AND ""desc_sum"">=(SELECT SUM(""Frequency"") FROM ""Numbers"")/2"
134,"WITH ""table1"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""running_total"",SUM(""Frequency"") OVER ()/2 AS ""num"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""table1"" WHERE ""num"" BETWEEN (""running_total""-""Frequency"") AND ""running_total"""
135,"WITH ""temp"" AS (SELECT ""Number"",""Frequency"",SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""cumulative_sum"",SUM(""Frequency"") OVER () AS ""total_num"" FROM ""Numbers"") SELECT ROUND(SUM(""Number"")/COUNT(""Number""), 2) AS ""median"" FROM ""temp"" WHERE ""total_num""/2.0 BETWEEN ""cumulative_sum""-""Frequency"" AND ""cumulative_sum"""
136,"WITH ""num"" AS (SELECT DISTINCT CEIL((SELECT SUM(""Frequency"") FROM ""Numbers"")/2) AS ""min"",FLOOR((SELECT SUM(""Frequency"") FROM ""Numbers"")/2+1) AS ""max"" FROM ""Numbers""), ""cum"" AS (SELECT ""number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""acc"" FROM ""Numbers"") SELECT (""a"".""first""+""b"".""first"")/2 AS ""median"" FROM (SELECT MIN(""cum"".""number"") AS ""first"" FROM (""cum"") JOIN ""num"" WHERE ""cum"".""acc"">=""num"".""min"") AS ""a"", (SELECT MIN(""cum"".""Number"") AS ""first"" FROM (""cum"") JOIN ""num"" WHERE ""cum"".""acc"">=""num"".""max"") AS ""b"""
137,"WITH ""temp_cte2"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""prev_sum"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""next_sum"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""temp_cte2"" WHERE ABS(""prev_sum""-""next_sum"")<=""frequency"""
138,"WITH RECURSIVE ""t1"" AS (SELECT ""number"",1 AS ""occurance"",""frequency"" FROM ""Numbers"" UNION ALL SELECT ""number"",""occurance""+1,""frequency"" FROM ""t1"" WHERE ""occurance""+1<=""frequency""), ""t2"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""num_index"" FROM ""t1"") SELECT AVG(""number"") AS ""median"" FROM ""t2"" WHERE ""num_index"" BETWEEN (SELECT MAX(""num_index"")/2 FROM ""t2"") AND (SELECT MAX(""num_index"")/2+1 FROM ""t2"")"
139,"WITH ""n1"" AS (SELECT MIN(""Number"") AS ""median"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""r"" FROM ""Numbers"") AS ""t"" WHERE (SELECT FLOOR(SUM(""Frequency"")/2) FROM ""Numbers"")<=""r""), ""n2"" AS (SELECT MIN(""Number"") AS ""median"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""r"" FROM ""Numbers"") AS ""t"" WHERE (SELECT FLOOR(SUM(""Frequency"")/2)+1 FROM ""Numbers"")<=""r""), ""c"" AS (SELECT SUM(""Frequency"")%2 AS ""cnt"" FROM ""Numbers"") SELECT CASE WHEN (SELECT * FROM ""c"")=1 THEN ROUND((SELECT * FROM ""n2""), 4) ELSE ROUND(((SELECT * FROM ""n1"")+(SELECT * FROM ""n2""))/2, 4) END AS ""median"""
140,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",MAX(""frequency"") AS ""C"" FROM ""Numbers"" GROUP BY ""number"" UNION ALL SELECT ""number"",""C""-1 AS ""C"" FROM ""cte"" WHERE ""C"">1), ""dte"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""number"") AS ""Rnk"",""number"",(SELECT SUM(""frequency"") FROM ""Numbers"") AS ""Total"" FROM ""cte"") SELECT AVG(""number"") AS ""Median"" FROM ""dte"" WHERE ""Rnk"" IN (""Total""/2,((""total""/2)+0.5),((""total""/2)+1))"
141,"WITH RECURSIVE ""details"" AS (SELECT ""number"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency""-1 FROM ""details"" WHERE ""frequency"">1), ""prep"" AS (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"",""frequency"") AS ""rn_asc"",ROW_NUMBER() OVER (ORDER BY ""number"" DESC,""frequency"" DESC) AS ""rn_desc"" FROM ""details"") SELECT AVG(""number"") AS ""median"" FROM ""prep"" WHERE ""rn_asc""=""rn_desc"" OR ""rn_asc""=""rn_desc""-1 OR ""rn_asc""=""rn_desc""+1"
142,"WITH ""sorting"" AS (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""running_total"",(SUM(""Frequency"") OVER ())/2 AS ""median"" FROM ""Numbers""), ""discover"" AS (SELECT CASE WHEN ""running_total"">""median"" AND (""running_total""-""Frequency"")<""median"" THEN ""Number"" WHEN ""running_total""=""median"" THEN (""Number""+""Number""+1)/2 ELSE NULL END AS ""median"" FROM ""sorting"") SELECT ""median"" FROM ""discover"" WHERE ""median"" IS NOT NULL"
143,"WITH ""t"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""running_total"",CASE WHEN (SUM(""frequency"") OVER ())%2=1 THEN ((SUM(""frequency"") OVER ())+1)/2 ELSE (SUM(""frequency"") OVER ())/2 END AS ""med_row1"",CASE WHEN (SUM(""frequency"") OVER ())%2=1 THEN NULL ELSE (SUM(""frequency"") OVER ())/2+1 END AS ""med_row2"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE CASE WHEN ""med_row2"" IS NULL THEN ""med_row1"" BETWEEN ""running_total""-""frequency""+1 AND ""running_total"" ELSE ""med_row1"" BETWEEN ""running_total""-""frequency""+1 AND ""running_total"" OR ""med_row2"" BETWEEN ""running_total""-""frequency""+1 AND ""running_total"" END"
144,"WITH ""PartialSums"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER () AS ""Total"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""Preceding"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""PartialSums"" WHERE ""Total""/2 BETWEEN ""Preceding""-""Frequency"" AND ""Preceding"""
145,"WITH ""med"" AS (SELECT CEIL(SUM(""frequency"")/2) AS ""m1"",CEIL((SUM(""frequency"")+1)/2) AS ""m2"" FROM ""Numbers""), ""CSUM"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cum_sum"" FROM ""Numbers""), ""N1"" AS (SELECT ""number"" FROM ""CSUM"" WHERE ""cum_sum"">=(SELECT ""m1"" FROM ""med"") LIMIT 1), ""N2"" AS (SELECT ""number"" FROM ""CSUM"" WHERE ""cum_sum"">=(SELECT ""m2"" FROM ""med"") LIMIT 1) SELECT AVG(""median"") AS ""median"" FROM (SELECT ""Number"" AS ""median"" FROM ""N1"" UNION SELECT ""Number"" AS ""median"" FROM ""N2"") AS ""sub1"""
146,"WITH ""c1"" AS (SELECT ""Number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cum_sum"" FROM ""numbers""), ""c2"" AS (SELECT ROUND(SUM(""Frequency"")/2, 0) AS ""rk"" FROM ""numbers"" UNION ALL SELECT ROUND((SUM(""Frequency"")+1)/2, 0) FROM ""numbers""), ""c3"" AS (SELECT MIN(""c1"".""Number"") AS ""num"" FROM ""c2"" JOIN ""c1"" ON ""c2"".""rk""<=""c1"".""cum_sum"" GROUP BY ""c2"".""rk"") SELECT AVG(""num"") AS ""median"" FROM ""c3"""
147,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
148,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
149,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",MAX(""frequency"") AS ""C"" FROM ""Numbers"" GROUP BY ""number"" UNION ALL SELECT ""number"",""C""-1 AS ""C"" FROM ""cte"" WHERE ""C"">1), ""dte"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""number"") AS ""Rnk"",""number"",(SELECT SUM(""frequency"") FROM ""Numbers"") AS ""Total"" FROM ""cte"") SELECT AVG(""number"") AS ""Median"" FROM ""dte"" WHERE ""Rnk"" IN (""Total""/2,((""total""/2)+0.5),((""total""/2)+1))"
150,"WITH ""T1"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""freq_total"" FROM ""numbers""), ""T2"" AS (SELECT SUM(""frequency"") AS ""total"" FROM ""numbers""), ""T3"" AS (SELECT ""num1"",""num2"",""num3"" FROM ((SELECT MIN(""a"".""number"") AS ""num1"" FROM (""T1"" AS ""a"") JOIN ""T2"" AS ""b"" WHERE ""a"".""freq_total"">=""b"".""total""/2) AS ""t1"", (SELECT MIN(""a"".""number"") AS ""num2"" FROM (""T1"" AS ""a"") JOIN ""T2"" AS ""b"" WHERE ""a"".""freq_total"">=(""b"".""total""+1)/2) AS ""t2"") JOIN (SELECT MIN(""a"".""number"") AS ""num3"" FROM (""T1"" AS ""a"") JOIN ""T2"" AS ""b"" WHERE ""a"".""freq_total"">=(""b"".""total""/2+1)) AS ""t3"") SELECT CASE WHEN (SELECT ""total"" FROM ""T2"")%2=1 THEN ""num2"" ELSE 1/2*(""num1""+""num2"") END AS ""median"" FROM ""T3"""
151,"WITH ""t"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""freq"",(SUM(""frequency"") OVER ())/2 AS ""median_num"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE ""median_num"" BETWEEN (""freq""-""frequency"") AND ""freq"""
152,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""c1"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""c2"",SUM(""Frequency"") OVER () AS ""cnt"" FROM ""Numbers"") AS ""temp"" WHERE ""c1"">=""cnt""/2 AND ""c2"">=""cnt""/2"
153,"WITH ""a"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""c"" FROM ""Numbers"") SELECT ((SELECT MIN(""NUMBER"") FROM ""a"" WHERE ""c"">=CEILING((SELECT SUM(""Frequency"")/2 AS ""m"" FROM ""Numbers"")))+(SELECT MIN(""NUMBER"") FROM ""a"" WHERE ""c"">=CEILING((SELECT (SUM(""Frequency"")+1)/2 AS ""m"" FROM ""Numbers""))))/2 AS ""median"""
154,"WITH ""c1"" AS (SELECT ""Number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""cum_sum"" FROM ""numbers""), ""c2"" AS (SELECT ROUND(SUM(""Frequency"")/2, 0) AS ""rk"" FROM ""numbers"" UNION ALL SELECT ROUND((SUM(""Frequency"")+1)/2, 0) FROM ""numbers""), ""c3"" AS (SELECT MIN(""c1"".""Number"") AS ""num"" FROM ""c2"" JOIN ""c1"" ON ""c2"".""rk""<=""c1"".""cum_sum"" GROUP BY ""c2"".""rk"") SELECT AVG(""num"") AS ""median"" FROM ""c3"""
155,"WITH ""n1"" AS (SELECT MIN(""Number"") AS ""median"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""r"" FROM ""Numbers"") AS ""t"" WHERE (SELECT FLOOR(SUM(""Frequency"")/2) FROM ""Numbers"")<=""r""), ""n2"" AS (SELECT MIN(""Number"") AS ""median"" FROM (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""r"" FROM ""Numbers"") AS ""t"" WHERE (SELECT FLOOR(SUM(""Frequency"")/2)+1 FROM ""Numbers"")<=""r""), ""c"" AS (SELECT SUM(""Frequency"")%2 AS ""cnt"" FROM ""Numbers"") SELECT CASE WHEN (SELECT * FROM ""c"")=1 THEN ROUND((SELECT * FROM ""n2""), 4) ELSE ROUND(((SELECT * FROM ""n1"")+(SELECT * FROM ""n2""))/2, 4) END AS ""median"""
156,"WITH RECURSIVE ""cte"" AS (SELECT ""Number"",1 AS ""lvl"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""lvl""+1,""Frequency"" FROM ""cte"" WHERE ""lvl""<""Frequency""), ""temp"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""row_count"",COUNT(1) OVER () AS ""tot"" FROM ""cte"") SELECT ROUND(AVG(""Number""), 4) AS ""median"" FROM ""temp"" WHERE ""row_count"" BETWEEN ""tot""/2 AND ""tot""/2+1"
157,"WITH ""cte"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumulative_count"",SUM(""Frequency"") OVER () AS ""all_count"" FROM ""Numbers"") SELECT ((SELECT MIN(""number"") FROM ""cte"" WHERE ""cumulative_count"">=FLOOR((""all_count""+1)/2))+(SELECT MIN(""number"") FROM ""cte"" WHERE ""cumulative_count"">=FLOOR((""all_count""+2)/2)))/2 AS ""median"""
158,"WITH ""temp1"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""Number"") AS ""rolsum"" FROM ""Numbers"") SELECT ((SELECT ""number"" FROM ""temp1"" WHERE ""rolsum"">=CEILING(((SELECT MAX(""rolsum"") FROM ""temp1"")+1)/2) LIMIT 1)+(SELECT ""number"" FROM ""temp1"" WHERE ""rolsum"">=CEILING(((SELECT MAX(""rolsum"") FROM ""temp1""))/2) LIMIT 1))/2 AS ""median"""
159,"WITH RECURSIVE ""cte"" AS (SELECT ""number"",""frequency"" AS ""n"" FROM ""numbers"" UNION ALL SELECT ""number"",""n""-1 FROM ""cte"" WHERE ""n""-1>=1) SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",ROW_NUMBER() OVER (ORDER BY ""number"") AS ""row_num"",(SELECT SUM(""frequency"") FROM ""numbers"") AS ""total"" FROM ""cte"") AS ""a"" WHERE ""row_num"" BETWEEN (""total""/2) AND (""total""/2+1)"
160,"WITH ""temp"" AS (SELECT ""Number"",""Frequency"",(SUM(""Frequency"") OVER (ORDER BY ""Number""))/(SUM(""Frequency"") OVER ()) AS ""p1"",(SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC))/(SUM(""Frequency"") OVER ()) AS ""p2"" FROM ""Numbers"" ORDER BY ""Number"") SELECT AVG(""Number"") AS ""median"" FROM ""temp"" WHERE ""p1"">=0.5 AND ""p2"">=0.5"
161,"WITH RECURSIVE ""total_rows"" AS (SELECT ""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 FROM ""total_rows"" WHERE ""Frequency"">1), ""max_count"" AS (SELECT SUM(""Frequency"") AS ""max_count"" FROM ""Numbers""), ""row_count"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""row_num"" FROM ""total_rows"" ORDER BY ""Number""), ""first_half"" AS (SELECT ""Number"" FROM ""row_count"" JOIN ""max_count"" WHERE ""row_num""=(""max_count""/2)), ""second_half"" AS (SELECT ""Number"" FROM ""row_count"" JOIN ""max_count"" WHERE ""row_num""=(""max_count""/2+1)) SELECT CASE WHEN ""max_count""%2=0 THEN (""first_half"".""Number""+""second_half"".""Number"")/2.0 ELSE ""first_half"".""Number"" END AS ""median"" FROM (""first_half"" JOIN ""second_half"") JOIN ""max_count"""
162,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT *,SUM(""Frequency"") OVER () AS ""ct"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""freq"" FROM ""Numbers"") AS ""a"" WHERE ""ct""/2 BETWEEN ""freq""-""Frequency"" AND ""freq"""
163,"WITH RECURSIVE ""dbse"" AS (SELECT ""number"",""frequency"" FROM ""numbers"" UNION ALL SELECT ""number"",""frequency""-1 FROM ""dbse"" WHERE ""frequency"">1) SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"",RANK() OVER (ORDER BY ""number"",""frequency"") AS ""ranka"",RANK() OVER (ORDER BY ""number"" DESC,""frequency"" DESC) AS ""rankd"" FROM ""dbse"" ORDER BY ""number"") AS ""a"" WHERE ""ranka""=""rankd""+1 OR ""ranka""=""rankd""-1 OR ""ranka""=""rankd"""
164,"WITH RECURSIVE ""AllNumbers"" AS (SELECT ""Number"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency""-1 AS ""Frequency"" FROM ""AllNumbers"" WHERE ""Frequency"">1), ""Temp"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""Rnk"",""Number"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""Total"" FROM ""AllNumbers"") SELECT AVG(""Number"") AS ""median"" FROM ""Temp"" WHERE ""Rnk"" IN (((""Total""+1)/2),""Total""/2,""Total""/2+1)"
165,"WITH ""t1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""rnk"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num1"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2+1 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num2"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num1"")>=0 AND (""rnk""-""num1"")=(SELECT MIN(""rnk""-""num1"") FROM ""t1"" WHERE (""rnk""-""num1"")>=0))+(SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num2"")>=0 AND (""rnk""-""num2"")=(SELECT MIN(""rnk""-""num2"") FROM ""t1"" WHERE (""rnk""-""num2"")>=0)))/2 AS ""median"""
166,"WITH ""tbCum"" AS (SELECT ""n1"".""number"",SUM(""n2"".""frequency"") AS ""cum_frequency"" FROM ""numbers"" AS ""n1"" JOIN ""numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""tbM"" AS (SELECT CASE WHEN MAX(""cum_frequency"")%2=0 THEN MAX(""cum_frequency"")/2 ELSE (MAX(""cum_frequency"")+1)/2 END AS ""median"" FROM ""tbCum"" UNION ALL SELECT CASE WHEN MAX(""cum_frequency"")%2=0 THEN MAX(""cum_frequency"")/2+1 ELSE (MAX(""cum_frequency"")+1)/2 END FROM ""tbCum"") SELECT AVG(""min_median"") AS ""median"" FROM (SELECT ""tbM"".""median"",MIN(""tbCum"".""Number"") AS ""min_median"" FROM ""tbM"" JOIN ""tbCum"" ON ""tbCum"".""cum_frequency"">=""tbM"".""median"" GROUP BY ""tbM"".""median"") AS ""tMedian"""
167,"SELECT ROUND(SUM(""Number"")/COUNT(""Number""), 2) AS ""median"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cumulative_num"",SUM(""Frequency"") OVER () AS ""total_num"" FROM ""Numbers"") AS ""sub"" WHERE ""total_num""/2.0 BETWEEN ""cumulative_num""-""Frequency"" AND ""cumulative_num"""
168,"WITH ""tbCum"" AS (SELECT ""n1"".""number"",SUM(""n2"".""frequency"") AS ""cum_frequency"" FROM ""numbers"" AS ""n1"" JOIN ""numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""tbM"" AS (SELECT CASE WHEN MAX(""cum_frequency"")%2=0 THEN MAX(""cum_frequency"")/2 END AS ""even_median"",CASE WHEN MAX(""cum_frequency"")%2!=0 THEN (MAX(""cum_frequency"")+1)/2 END AS ""odd_median"" FROM ""tbCum""), ""tbMedian1"" AS (SELECT MIN(""cum_frequency"") AS ""cum_frequency"" FROM ""tbCum"" WHERE ""cum_frequency"">=(SELECT CASE WHEN ""even_median"" IS NULL THEN ""odd_median"" WHEN ""odd_median"" IS NULL THEN ""even_median"" END FROM ""tbM"")), ""tbMedian2"" AS (SELECT MIN(""cum_frequency"") AS ""cum_frequency"" FROM ""tbCum"" WHERE ""cum_frequency"">=(SELECT CASE WHEN ""even_median"" IS NULL THEN ""odd_median"" WHEN ""odd_median"" IS NULL THEN ""even_median""+1 END FROM ""tbM"")) SELECT SUM(""tb"".""number"")/2 AS ""median"" FROM (SELECT ""tbCum"".""number"" FROM ""tbMedian1"" JOIN ""tbCum"" ON ""tbCum"".""cum_frequency""=""tbMedian1"".""cum_frequency"" UNION ALL SELECT ""tbCum"".""number"" FROM ""tbMedian2"" JOIN ""tbCum"" ON ""tbCum"".""cum_frequency""=""tbMedian2"".""cum_frequency"") AS ""tb"""
169,"WITH ""a"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""asce"" FROM ""Numbers""), ""b"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""des"" FROM ""Numbers""), ""c"" AS (SELECT SUM(""Frequency"") AS ""accu"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM (SELECT ""a"".""Number"" FROM ((""a"") JOIN ""b"") JOIN ""c"" WHERE ""a"".""Number""=""b"".""Number"" AND ((""a"".""asce"">""c"".""accu""/2 AND ""b"".""des"">""c"".""accu""/2) OR ""a"".""asce""=""c"".""accu""/2 OR ""b"".""des""=""c"".""accu""/2)) AS ""cte"""
170,"WITH ""t"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""freq"",(SUM(""frequency"") OVER ())/2 AS ""median_num"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE ""median_num"" BETWEEN (""freq""-""frequency"") AND ""freq"""
171,"WITH ""median_point"" AS (SELECT (CASE WHEN SUM(""Frequency"")%2=1 THEN (SUM(""Frequency"")+1)/2 ELSE SUM(""Frequency"")/2 END) AS ""start_point"",(CASE WHEN SUM(""Frequency"")%2=1 THEN (SUM(""Frequency"")+1)/2 ELSE SUM(""Frequency"")/2+1 END) AS ""end_point"" FROM ""Numbers""), ""cumu"" AS (SELECT ""a"".""Number"",SUM(""b"".""Frequency"") AS ""Frequency"" FROM (""Numbers"" AS ""a"") JOIN ""Numbers"" AS ""b"" WHERE ""a"".""Number"">=""b"".""Number"" GROUP BY ""a"".""Number"") SELECT ((SELECT MIN(""Number"") FROM ""cumu"" WHERE ""Frequency"">=(SELECT ""start_point"" FROM ""median_point""))+(SELECT MIN(""Number"") FROM ""cumu"" WHERE ""Frequency"">=(SELECT ""end_point"" FROM ""median_point"")))/2 AS ""median"""
172,"WITH ""median"" AS (SELECT CEILING(SUM(""frequency"")/2) AS ""median_1"",CASE WHEN SUM(""frequency"")%2=1 THEN 0 ELSE CEILING(SUM(""frequency"")/2)+1 END AS ""median_2"" FROM ""Numbers""), ""totals"" AS (SELECT ""n1"".""number"",SUM(""n2"".""Frequency"") AS ""frequency"" FROM ""Numbers"" AS ""n1"" JOIN ""Numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""freq_range"" AS (SELECT ""number"",""frequency"" AS ""curr_freq"",COALESCE(LAG(""frequency"", 1) OVER (ORDER BY ""number""), 0) AS ""prev_freq"" FROM ""totals"") SELECT SUM(""number"")/COUNT(1) AS ""median"" FROM ""freq_range"" JOIN ""median"" WHERE ""median_1"" BETWEEN ""prev_freq""+1 AND ""curr_freq"" OR CASE WHEN ""median_2""=0 THEN ""median_1"" ELSE ""median_2"" END BETWEEN ""prev_freq""+1 AND ""curr_freq"""
173,"WITH ""table1"" AS (SELECT ""nu"".""number"",""nu"".""frequency"",SUM(""nu1"".""frequency"") AS ""end"" FROM ""numbers"" AS ""nu"" JOIN ""numbers"" AS ""nu1"" ON ""nu"".""number"">=""nu1"".""number"" GROUP BY ""nu"".""number"" ORDER BY ""nu"".""number"") SELECT AVG(""number"") AS ""median"" FROM (SELECT *,(""end""-""frequency""+1) AS ""start"",(SELECT MAX(""end"") FROM ""table1"") AS ""new2"" FROM ""table1"") AS ""tmp"" WHERE (""new2""/2>=""start"" AND ""new2""/2<=""end"") OR (""new2""/2>=""start""-1 AND ""new2""/2<=""start"")"
174,"SELECT SUM(""num"")/COUNT(""num"") AS ""median"" FROM (SELECT ""d"".""tot"",MIN(""number"") AS ""num"",MIN(""frequency"") AS ""freq"" FROM (SELECT ""a"".""number"",SUM(""b"".""frequency"") AS ""frequency"" FROM (""numbers"" AS ""a"") JOIN ""numbers"" AS ""b"" WHERE ""a"".""number"">=""b"".""number"" GROUP BY 1) AS ""c"", (SELECT CEILING(SUM(""frequency"")/2.0+0.1) AS ""tot"" FROM ""numbers"" UNION SELECT CASE WHEN SUM(""frequency"")%2=0 THEN FLOOR(SUM(""frequency"")/2.0+0.1) END AS ""tot"" FROM ""numbers"") AS ""d"" WHERE ""c"".""frequency"">=""d"".""tot"" GROUP BY ""d"".""tot"") AS ""e"""
175,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
176,"WITH ""cte"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""left_cumsum"",SUM(""frequency"") OVER (ORDER BY ""number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""right_cumsum"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""cte"" WHERE ABS(""left_cumsum""-""right_cumsum"")<=""frequency"""
177,"WITH ""table1"" AS (SELECT ""nu"".""number"",""nu"".""frequency"",SUM(""nu1"".""frequency"") AS ""end"" FROM ""numbers"" AS ""nu"" JOIN ""numbers"" AS ""nu1"" ON ""nu"".""number"">=""nu1"".""number"" GROUP BY ""nu"".""number"" ORDER BY ""nu"".""number"") SELECT AVG(""number"") AS ""median"" FROM (SELECT *,(""end""-""frequency""+1) AS ""start"",(SELECT MAX(""end"") FROM ""table1"") AS ""new2"" FROM ""table1"") AS ""tmp"" WHERE (""new2""/2>=""start"" AND ""new2""/2<=""end"") OR (""new2""/2>=""start""-1 AND ""new2""/2<=""start"")"
178,"WITH ""num"" AS (SELECT DISTINCT CEIL((SELECT SUM(""Frequency"") FROM ""Numbers"")/2) AS ""min"",FLOOR((SELECT SUM(""Frequency"") FROM ""Numbers"")/2+1) AS ""max"" FROM ""Numbers""), ""cum"" AS (SELECT ""number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""acc"" FROM ""Numbers"") SELECT (""a"".""first""+""b"".""first"")/2 AS ""median"" FROM (SELECT MIN(""cum"".""number"") AS ""first"" FROM (""cum"") JOIN ""num"" WHERE ""cum"".""acc"">=""num"".""min"") AS ""a"", (SELECT MIN(""cum"".""Number"") AS ""first"" FROM (""cum"") JOIN ""num"" WHERE ""cum"".""acc"">=""num"".""max"") AS ""b"""
179,"WITH ""table1"" AS (SELECT ""nu"".""number"",""nu"".""frequency"",SUM(""nu1"".""frequency"") AS ""end"" FROM ""numbers"" AS ""nu"" JOIN ""numbers"" AS ""nu1"" ON ""nu"".""number"">=""nu1"".""number"" GROUP BY ""nu"".""number"" ORDER BY ""nu"".""number"") SELECT AVG(""number"") AS ""median"" FROM (SELECT *,(""end""-""frequency""+1) AS ""start"",(SELECT MAX(""end"") FROM ""table1"") AS ""new2"" FROM ""table1"") AS ""tmp"" WHERE (""new2""/2>=""start"" AND ""new2""/2<=""end"") OR (""new2""/2>=""start""-1 AND ""new2""/2<=""start"")"
180,"WITH ""TMP"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""FREQ"",(SUM(""Frequency"") OVER ())/2 AS ""MED"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""TMP"" WHERE ""MED"" BETWEEN (""FREQ""-""Frequency"") AND ""FREQ"""
181,"WITH ""median"" AS (SELECT CEILING(SUM(""frequency"")/2) AS ""median_1"",CASE WHEN SUM(""frequency"")%2=1 THEN 0 ELSE CEILING(SUM(""frequency"")/2)+1 END AS ""median_2"" FROM ""Numbers""), ""totals"" AS (SELECT ""n1"".""number"",SUM(""n2"".""Frequency"") AS ""frequency"" FROM ""Numbers"" AS ""n1"" JOIN ""Numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""freq_range"" AS (SELECT ""number"",""frequency"" AS ""curr_freq"",COALESCE(LAG(""frequency"", 1) OVER (ORDER BY ""number""), 0) AS ""prev_freq"" FROM ""totals"") SELECT SUM(""number"")/COUNT(1) AS ""median"" FROM ""freq_range"" JOIN ""median"" WHERE ""median_1"" BETWEEN ""prev_freq""+1 AND ""curr_freq"" OR CASE WHEN ""median_2""=0 THEN ""median_1"" ELSE ""median_2"" END BETWEEN ""prev_freq""+1 AND ""curr_freq"""
182,"WITH RECURSIVE ""cte"" AS (SELECT ""Number"",MAX(""frequency"") AS ""C"" FROM ""Numbers"" GROUP BY ""Number"" UNION ALL SELECT ""Number"",""C""-1 AS ""C"" FROM ""cte"" WHERE ""C"">1), ""dte"" AS (SELECT ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""Rnk"",""Number"",""C"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""Total"" FROM ""cte"") SELECT AVG(""Number"") AS ""median"" FROM ""dte"" WHERE ""Rnk"" IN ((""Total""/2),((""Total""/2)+0.5),((""total""/2)+1))"
183,"WITH ""cte"" AS (SELECT *,COALESCE(LAG(""cum_freq"", 1) OVER (ORDER BY ""Number""), 0) AS ""lag_cum_freq"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"" FROM ""Numbers"") AS ""t"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE (""lag_cum_freq""<(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"") AND ""cum_freq"">=(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"")) OR (""lag_cum_freq""<(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers"") AND ""cum_freq"">=(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers""))"
184,"WITH ""cte"" AS (SELECT *,COALESCE(LAG(""cum_freq"", 1) OVER (ORDER BY ""Number""), 0) AS ""lag_cum_freq"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"" FROM ""Numbers"") AS ""t"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE (""lag_cum_freq""<(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"") AND ""cum_freq"">=(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"")) OR (""lag_cum_freq""<(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers"") AND ""cum_freq"">=(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers""))"
185,"WITH ""t1"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""rnk"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num1"",(SELECT CASE WHEN SUM(""Frequency"")%2=0 THEN SUM(""Frequency"")/2+1 ELSE (SUM(""Frequency"")+1)/2 END AS ""num"" FROM ""Numbers"") AS ""num2"" FROM ""Numbers"") SELECT ((SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num1"")>=0 AND (""rnk""-""num1"")=(SELECT MIN(""rnk""-""num1"") FROM ""t1"" WHERE (""rnk""-""num1"")>=0))+(SELECT ""Number"" FROM ""t1"" WHERE (""rnk""-""num2"")>=0 AND (""rnk""-""num2"")=(SELECT MIN(""rnk""-""num2"") FROM ""t1"" WHERE (""rnk""-""num2"")>=0)))/2 AS ""median"""
186,"SELECT ""med"" AS ""median"" FROM (SELECT ""number"",""frequency"",""tot"",""ldnum"",""lgnum"",""presum"",COALESCE(LAG(""presum"") OVER (ORDER BY ""number""), 0) AS ""lgsum"",CASE WHEN ""tot""%2!=0 AND COALESCE(LAG(""presum"") OVER (ORDER BY ""number""), 0)<=""tot""/2 AND ""presum"">=""tot""/2 THEN ""number"" WHEN ""tot""%2=0 AND COALESCE(LAG(""presum"") OVER (ORDER BY ""number""), 0)<=""tot""/2 AND ""presum"">=""tot""/2+1 THEN (""number""+COALESCE(""lgnum"", ""number""))/2 END AS ""med"" FROM (SELECT ""number"",""frequency"",LEAD(""number"") OVER (ORDER BY ""number"") AS ""ldnum"",LAG(""number"") OVER (ORDER BY ""number"") AS ""lgnum"",SUM(""frequency"") OVER (ORDER BY ""number"" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""presum"" FROM ""numbers"") AS ""a"", (SELECT SUM(""frequency"") AS ""tot"" FROM ""numbers"") AS ""b"") AS ""q"" WHERE ""med"" IS NOT NULL LIMIT 1"
187,"SELECT CASE WHEN SUM(""q"".""frequency"")%2=0 THEN (""q"".""number""+""q"".""number_old"")/2 ELSE AVG(""q"".""number"") END AS ""median"" FROM (SELECT ""a"".""number"",COALESCE(LAG(""a"".""number"", 1) OVER (ORDER BY ""a"".""number""), ""a"".""number"") AS ""number_old"",""a"".""frequency"",SUM(""b"".""frequency"") AS ""cum_frq"",COALESCE(LAG(SUM(""b"".""frequency""), 1) OVER (ORDER BY ""a"".""number""), 0) AS ""cum_frq_old"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" ON ""a"".""number"">=""b"".""number"" GROUP BY ""a"".""number"" ORDER BY ""a"".""number"") AS ""q"" WHERE ""q"".""cum_frq"">=(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"") AND ""q"".""cum_frq_old""<(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"")"
188,"SELECT CASE WHEN SUM(""q"".""frequency"")%2=0 THEN (""q"".""number""+""q"".""number_old"")/2 ELSE AVG(""q"".""number"") END AS ""median"" FROM (SELECT ""a"".""number"",COALESCE(LAG(""a"".""number"", 1) OVER (ORDER BY ""a"".""number""), ""a"".""number"") AS ""number_old"",""a"".""frequency"",SUM(""b"".""frequency"") AS ""cum_frq"",COALESCE(LAG(SUM(""b"".""frequency""), 1) OVER (ORDER BY ""a"".""number""), 0) AS ""cum_frq_old"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" ON ""a"".""number"">=""b"".""number"" GROUP BY ""a"".""number"" ORDER BY ""a"".""number"") AS ""q"" WHERE ""q"".""cum_frq"">=(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"") AND ""q"".""cum_frq_old""<(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"")"
189,"WITH ""median"" AS (SELECT CEILING(SUM(""frequency"")/2) AS ""median_1"",CASE WHEN SUM(""frequency"")%2=1 THEN 0 ELSE CEILING(SUM(""frequency"")/2)+1 END AS ""median_2"" FROM ""Numbers""), ""totals"" AS (SELECT ""n1"".""number"",SUM(""n2"".""Frequency"") AS ""frequency"" FROM ""Numbers"" AS ""n1"" JOIN ""Numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""freq_range"" AS (SELECT ""number"",""frequency"" AS ""curr_freq"",COALESCE(LAG(""frequency"", 1) OVER (ORDER BY ""number""), 0) AS ""prev_freq"" FROM ""totals"") SELECT SUM(""number"")/COUNT(1) AS ""median"" FROM ""freq_range"" JOIN ""median"" WHERE ""median_1"" BETWEEN ""prev_freq""+1 AND ""curr_freq"" OR CASE WHEN ""median_2""=0 THEN ""median_1"" ELSE ""median_2"" END BETWEEN ""prev_freq""+1 AND ""curr_freq"""
190,"WITH ""s1"" AS (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""acc_fre"" FROM ""numbers""), ""s2"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""fl"",CEIL((SUM(""frequency"")+1)/2) AS ""ce"" FROM ""numbers""), ""n1"" AS (SELECT ""number"" FROM ""s1"" WHERE ""acc_fre"">=(SELECT ""fl"" FROM ""s2"") LIMIT 1), ""n2"" AS (SELECT ""number"" FROM ""s1"" WHERE ""acc_fre"">=(SELECT ""ce"" FROM ""s2"") LIMIT 1) SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"" FROM ""n1"" UNION ALL SELECT ""number"" FROM ""n2"") AS ""t"""
191,"SELECT MIN(CASE WHEN ""fraction""=0.5 THEN (""number""+""post_number"")/2 WHEN ""fraction""<0.5 THEN CASE WHEN ""post_fraction""<=0.5 THEN NULL ELSE ""Post_Number"" END WHEN ""fraction"">0.5 THEN ""Number"" END) AS ""median"" FROM (SELECT ""Number"",""increase""/""count"" AS ""fraction"",LEAD(""Number"") OVER () AS ""post_number"",LEAD(""increase""/""count"") OVER () AS ""post_fraction"" FROM (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""increase"",SUM(""Frequency"") OVER () AS ""count"" FROM ""Numbers"") AS ""A"") AS ""B"""
192,"WITH ""table1"" AS (SELECT ""nu"".""number"",""nu"".""frequency"",SUM(""nu1"".""frequency"") AS ""end"" FROM ""numbers"" AS ""nu"" JOIN ""numbers"" AS ""nu1"" ON ""nu"".""number"">=""nu1"".""number"" GROUP BY ""nu"".""number"" ORDER BY ""nu"".""number"") SELECT AVG(""number"") AS ""median"" FROM (SELECT *,(""end""-""frequency""+1) AS ""start"",(SELECT MAX(""end"") FROM ""table1"") AS ""new2"" FROM ""table1"") AS ""tmp"" WHERE (""new2""/2>=""start"" AND ""new2""/2<=""end"") OR (""new2""/2>=""start""-1 AND ""new2""/2<=""start"")"
193,"WITH ""tempset2"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cumsum_left"",SUM(""Frequency"") OVER (ORDER BY ""Number"" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS ""cumsum_right"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""median"" FROM ""tempset2"" WHERE ABS(""cumsum_left""-""cumsum_right"")<=""Frequency"""
194,"WITH ""t1"" AS (SELECT FLOOR((SUM(""Frequency"")+1)/2) AS ""value1"",FLOOR((SUM(""Frequency"")+2)/2) AS ""value2"" FROM ""Numbers""), ""t2"" AS (SELECT ""Number"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""roll_sum"" FROM ""Numbers""), ""t3"" AS (SELECT MIN(""Number"") AS ""v1"" FROM (""t1"") JOIN ""t2"" WHERE ""value1""<=""roll_sum""), ""t4"" AS (SELECT MIN(""Number"") AS ""v2"" FROM (""t1"") JOIN ""t2"" WHERE ""value2""<=""roll_sum"") SELECT (""v1""+""v2"")/2 AS ""median"" FROM (""t3"") JOIN ""t4"""
195,"SELECT CASE WHEN SUM(""q"".""frequency"")%2=0 THEN (""q"".""number""+""q"".""number_old"")/2 ELSE AVG(""q"".""number"") END AS ""median"" FROM (SELECT ""a"".""number"",COALESCE(LAG(""a"".""number"", 1) OVER (ORDER BY ""a"".""number""), ""a"".""number"") AS ""number_old"",""a"".""frequency"",SUM(""b"".""frequency"") AS ""cum_frq"",COALESCE(LAG(SUM(""b"".""frequency""), 1) OVER (ORDER BY ""a"".""number""), 0) AS ""cum_frq_old"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" ON ""a"".""number"">=""b"".""number"" GROUP BY ""a"".""number"" ORDER BY ""a"".""number"") AS ""q"" WHERE ""q"".""cum_frq"">=(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"") AND ""q"".""cum_frq_old""<(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"")"
196,"SELECT AVG(""num"") AS ""median"" FROM (SELECT ""n1"".""number"" AS ""num"",SUM(""n2"".""frequency"")-""n1"".""frequency""+1 AS ""low"",SUM(""n2"".""frequency"") AS ""high"" FROM ""numbers"" AS ""n1"" JOIN ""numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number"",""n1"".""frequency"") AS ""temp"" WHERE (""low""<=(SELECT FLOOR((SUM(""frequency"")+1)/2) FROM ""Numbers"") AND ""high"">=(SELECT FLOOR((SUM(""frequency"")+1)/2) FROM ""Numbers"")) OR (""low""<=(SELECT CEIL((SUM(""frequency"")+1)/2) FROM ""Numbers"") AND ""high"">=(SELECT CEIL((SUM(""frequency"")+1)/2) FROM ""Numbers""))"
197,"SELECT AVG(""num"") AS ""median"" FROM (SELECT ""n1"".""number"" AS ""num"",SUM(""n2"".""frequency"")-""n1"".""frequency""+1 AS ""low"",SUM(""n2"".""frequency"") AS ""high"" FROM ""numbers"" AS ""n1"" JOIN ""numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number"",""n1"".""frequency"") AS ""temp"" WHERE (""low""<=(SELECT FLOOR((SUM(""frequency"")+1)/2) FROM ""Numbers"") AND ""high"">=(SELECT FLOOR((SUM(""frequency"")+1)/2) FROM ""Numbers"")) OR (""low""<=(SELECT CEIL((SUM(""frequency"")+1)/2) FROM ""Numbers"") AND ""high"">=(SELECT CEIL((SUM(""frequency"")+1)/2) FROM ""Numbers""))"
198,"SELECT AVG(""Number"") AS ""median"" FROM (SELECT *,(""Lastnumber""-(""Frequency""-1)) AS ""Firstnumber"" FROM (SELECT ""a"".""Number"",""a"".""Frequency"",SUM(""b"".""Frequency"") AS ""Lastnumber"" FROM (""Numbers"" AS ""a"") JOIN ""Numbers"" AS ""b"" WHERE ""a"".""Number"">=""b"".""Number"" GROUP BY ""a"".""Number"",""a"".""Frequency"" ORDER BY ""a"".""Number"") AS ""t1"", (SELECT SUM(""Frequency"") AS ""totalcount"" FROM ""Numbers"") AS ""t2"") AS ""t3"" WHERE (""Firstnumber""<=FLOOR((""totalcount""+1)/2) AND ""Lastnumber"">=CEILING((""totalcount""+1)/2)) OR ""Lastnumber""=FLOOR((""totalcount""+1)/2) OR ""Firstnumber""=CEILING((""totalcount""+1)/2)"
199,"WITH ""tbCum"" AS (SELECT ""n1"".""number"",SUM(""n2"".""frequency"") AS ""cum_frequency"" FROM ""numbers"" AS ""n1"" JOIN ""numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""tbM"" AS (SELECT CASE WHEN MAX(""cum_frequency"")%2=0 THEN MAX(""cum_frequency"")/2 END AS ""even_median"",CASE WHEN MAX(""cum_frequency"")%2!=0 THEN (MAX(""cum_frequency"")+1)/2 END AS ""odd_median"" FROM ""tbCum""), ""tbMedian1"" AS (SELECT MIN(""cum_frequency"") AS ""cum_frequency"" FROM ""tbCum"" WHERE ""cum_frequency"">=(SELECT CASE WHEN ""even_median"" IS NULL THEN ""odd_median"" WHEN ""odd_median"" IS NULL THEN ""even_median"" END FROM ""tbM"")), ""tbMedian2"" AS (SELECT MIN(""cum_frequency"") AS ""cum_frequency"" FROM ""tbCum"" WHERE ""cum_frequency"">=(SELECT CASE WHEN ""even_median"" IS NULL THEN ""odd_median"" WHEN ""odd_median"" IS NULL THEN ""even_median""+1 END FROM ""tbM"")) SELECT SUM(""tb"".""number"")/2 AS ""median"" FROM (SELECT ""tbCum"".""number"" FROM ""tbMedian1"" JOIN ""tbCum"" ON ""tbCum"".""cum_frequency""=""tbMedian1"".""cum_frequency"" UNION ALL SELECT ""tbCum"".""number"" FROM ""tbMedian2"" JOIN ""tbCum"" ON ""tbCum"".""cum_frequency""=""tbMedian2"".""cum_frequency"") AS ""tb"""
200,"WITH ""t"" AS (SELECT ""b"".""Number"",""b"".""Frequency"",(SELECT SUM(""a"".""Frequency"") FROM ""Numbers"" AS ""a"" WHERE ""a"".""Number""<=""b"".""Number"") AS ""agg_freq"" FROM ""Numbers"" AS ""b"" GROUP BY ""b"".""Number""), ""t1"" AS (SELECT MAX(""agg_freq"") AS ""max_freq"",MIN(""agg_freq"") AS ""min_freq"" FROM ""t""), ""t2"" AS (SELECT *,(CASE WHEN ""t"".""agg_freq""=(SELECT ""min_freq"" FROM ""t1"") THEN 0 ELSE LAG(""t"".""agg_freq"", 1) OVER (ORDER BY ""t"".""agg_freq"") END) AS ""lag_freq"" FROM ""t"") SELECT (CASE WHEN ""t1"".""max_freq""%2=1 THEN (SELECT ""t2"".""Number"" FROM ""t2"" WHERE ((DIV(""t1"".""max_freq"", 2))+1)>""t2"".""lag_freq"" AND ((DIV(""t1"".""max_freq"", 2))+1)<=""t2"".""agg_freq"") ELSE (((SELECT ""t2"".""Number"" FROM ""t2"" WHERE ""t2"".""lag_freq""<(DIV(""t1"".""max_freq"", 2)) AND ""t2"".""agg_freq"">=(DIV(""t1"".""max_freq"", 2)))+(SELECT ""t2"".""Number"" FROM ""t2"" WHERE ""t2"".""lag_freq""<(DIV(""t1"".""max_freq"", 2))+1 AND ""t2"".""agg_freq"">=(DIV(""t1"".""max_freq"", 2))+1))/2) END) AS ""median"" FROM ""t1"""
201,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""a"".""number"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" GROUP BY ""a"".""number"" HAVING ABS(SUM(SIGN(""a"".""number""-""b"".""number"")*""b"".""frequency""))<=MAX(""a"".""frequency"")) AS ""t"""
202,"WITH ""TBL1"" AS (SELECT ""N1"".""Number"",SUM(""N2"".""Frequency"") AS ""cum_Frequency_ub"" FROM ""Numbers"" AS ""N1"" LEFT JOIN ""Numbers"" AS ""N2"" ON ""N1"".""Number"">=""N2"".""Number"" GROUP BY 1), ""TBL2"" AS (SELECT ""N1"".""Number"",COALESCE(SUM(""N2"".""Frequency""), 0) AS ""cum_Frequency_lb"" FROM ""Numbers"" AS ""N1"" LEFT JOIN ""Numbers"" AS ""N2"" ON ""N1"".""Number"">""N2"".""Number"" GROUP BY 1) SELECT AVG(""TBL1"".""Number"") AS ""median"" FROM ""TBL1"" LEFT JOIN ""TBL2"" ON ""TBL1"".""Number""=""TBL2"".""Number"" WHERE ""TBL2"".""cum_Frequency_lb""<=(SELECT MAX(""cum_Frequency_ub"")/2 FROM ""TBL1"") AND ""TBL1"".""cum_Frequency_ub"">=(SELECT MAX(""cum_Frequency_ub"")/2 FROM ""TBL1"")"
203,"WITH ""tmp"" AS (SELECT ""Number"",""Frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"" DESC) AS ""rnk1"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""rnk2"" FROM ""Numbers"") SELECT AVG(""Number"") AS ""Median"" FROM ""tmp"" WHERE ABS(""rnk1""-""rnk2"")<=""Frequency"""
204,"WITH ""runfre"" AS (SELECT ""n1"".""number"",SUM(""n2"".""frequency"") AS ""run_freq1"",SUM(""n2"".""frequency"")-""n1"".""frequency"" AS ""run_freq2"" FROM (""numbers"" AS ""n1"") JOIN ""numbers"" AS ""n2"" WHERE ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number"" ORDER BY ""n1"".""number""), ""ceil_m"" AS (SELECT CEIL((SUM(""frequency"")+1)/2) AS ""ceiln"" FROM ""numbers""), ""floor_m"" AS (SELECT FLOOR((SUM(""frequency"")+1)/2) AS ""floorn"" FROM ""numbers"") SELECT (""rf1"".""number""+""rf2"".""number"")/2 AS ""median"" FROM (((""runfre"" AS ""rf1"") JOIN ""ceil_m"" AS ""c"") JOIN ""runfre"" AS ""rf2"") JOIN ""floor_m"" AS ""f"" WHERE ""rf1"".""run_freq1"">=""c"".""ceiln"" AND ""rf1"".""run_freq2""<""c"".""ceiln"" AND ""rf2"".""run_freq1"">=""f"".""floorn"" AND ""rf2"".""run_freq2""<""f"".""floorn"""
205,"WITH ""cte"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""roll_sum"" FROM ""Numbers"" ORDER BY ""roll_sum"") SELECT ((SELECT ""Number"" FROM ""cte"" WHERE ""roll_sum"">=CEILING((SELECT MAX(""roll_sum"") FROM ""cte"")/2) LIMIT 1)+(SELECT ""Number"" FROM ""cte"" WHERE ""roll_sum"">=CEILING(((SELECT MAX(""roll_sum"") FROM ""cte"")+1)/2) LIMIT 1))/2 AS ""median"""
206,"WITH ""t"" AS (SELECT *,SUM(""frequency"") OVER (ORDER BY ""number"") AS ""freq"",(SUM(""frequency"") OVER ())/2 AS ""median_num"" FROM ""numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE ""median_num"" BETWEEN (""freq""-""frequency"") AND ""freq"""
207,"SELECT AVG(""D"".""Number"") AS ""median"" FROM (SELECT ""c"".""Number"",""c"".""cum1"",""c"".""cum"",CASE WHEN (""c"".""tot""%2)!=0 THEN (""c"".""tot""+1)/2 ELSE (""c"".""tot"")/2 END AS ""fif1"",CASE WHEN (""c"".""tot""%2)=0 THEN ((""c"".""tot"")/2+1) ELSE (""c"".""tot""+1)/2 END AS ""fif2"" FROM (SELECT ""b"".""Number"",""b"".""Frequency"",LAG(""b"".""cum"", 1, 0) OVER (ORDER BY ""b"".""cum"") AS ""cum1"",""b"".""cum"",(SELECT SUM(""Frequency"") FROM ""Numbers"") AS ""tot"" FROM (SELECT ""A"".""Number"",""A"".""Frequency"",SUM(""B"".""Frequency"") AS ""cum"" FROM (""Numbers"" AS ""A"") JOIN ""Numbers"" AS ""B"" WHERE ""A"".""Number"">=""B"".""Number"" GROUP BY ""A"".""Number"" ORDER BY ""A"".""Number"") AS ""b"") AS ""c"") AS ""D"" WHERE ((""D"".""fif1"">""D"".""cum1"" AND ""D"".""fif1""<=""D"".""cum"") OR (""D"".""fif2"">""D"".""cum1"" AND ""D"".""fif2""<=""D"".""cum""))"
208,"SELECT CASE WHEN SUM(""q"".""frequency"")%2=0 THEN (""q"".""number""+""q"".""number_old"")/2 ELSE AVG(""q"".""number"") END AS ""median"" FROM (SELECT ""a"".""number"",COALESCE(LAG(""a"".""number"", 1) OVER (ORDER BY ""a"".""number""), ""a"".""number"") AS ""number_old"",""a"".""frequency"",SUM(""b"".""frequency"") AS ""cum_frq"",COALESCE(LAG(SUM(""b"".""frequency""), 1) OVER (ORDER BY ""a"".""number""), 0) AS ""cum_frq_old"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" ON ""a"".""number"">=""b"".""number"" GROUP BY ""a"".""number"" ORDER BY ""a"".""number"") AS ""q"" WHERE ""q"".""cum_frq"">=(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"") AND ""q"".""cum_frq_old""<(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"")"
209,"WITH ""t"" AS (SELECT ""number"",""frequency"",SUM(""frequency"") OVER (ORDER BY ""number"") AS ""running_sum"",(SUM(""frequency"") OVER ())/2 AS ""m"" FROM ""Numbers"") SELECT AVG(""number"") AS ""median"" FROM ""t"" WHERE ""m"" BETWEEN ""running_sum""-""frequency"" AND ""running_sum"""
210,"WITH ""t"" AS (SELECT ""b"".""Number"",""b"".""Frequency"",(SELECT SUM(""a"".""Frequency"") FROM ""Numbers"" AS ""a"" WHERE ""a"".""Number""<=""b"".""Number"") AS ""agg_freq"" FROM ""Numbers"" AS ""b"" GROUP BY ""b"".""Number""), ""t1"" AS (SELECT MAX(""agg_freq"") AS ""max_freq"",MIN(""agg_freq"") AS ""min_freq"" FROM ""t""), ""t2"" AS (SELECT *,(CASE WHEN ""t"".""agg_freq""=(SELECT ""min_freq"" FROM ""t1"") THEN 0 ELSE LAG(""t"".""agg_freq"", 1) OVER (ORDER BY ""t"".""agg_freq"") END) AS ""lag_freq"" FROM ""t"") SELECT (CASE WHEN ""t1"".""max_freq""%2=1 THEN (SELECT ""t2"".""Number"" FROM ""t2"" WHERE ((DIV(""t1"".""max_freq"", 2))+1)>""t2"".""lag_freq"" AND ((DIV(""t1"".""max_freq"", 2))+1)<=""t2"".""agg_freq"") ELSE (SELECT AVG(""t2"".""Number"") FROM ""t2"" WHERE (""t2"".""lag_freq""<(DIV(""t1"".""max_freq"", 2)) AND ""t2"".""agg_freq"">=(DIV(""t1"".""max_freq"", 2))) OR (""t2"".""lag_freq""<(DIV(""t1"".""max_freq"", 2))+1 AND ""t2"".""agg_freq"">=(DIV(""t1"".""max_freq"", 2))+1)) END) AS ""median"" FROM ""t1"""
211,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""l"".""number"" FROM ""numbers"" AS ""l"" JOIN ""numbers"" AS ""r"" GROUP BY 1 HAVING ABS(SUM(SIGN(""l"".""number""-""r"".""number"")*""r"".""frequency""))<=MAX(""l"".""frequency"")) AS ""t"""
212,"WITH ""t"" AS (SELECT ""number"",SUM(""frequency"") OVER (ORDER BY ""number"" RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ""cum_freq"",SUM(""frequency"") OVER () AS ""ct"" FROM ""numbers""), ""t1"" AS (SELECT ""number"" FROM (SELECT ""number"",RANK() OVER (ORDER BY ""cum_freq"") AS ""rk"" FROM ""t"" WHERE ""cum_freq"">=(CASE WHEN ""ct""%2=0 THEN FLOOR(""ct""/2) ELSE FLOOR(""ct""/2)+1 END)) AS ""x"" WHERE ""rk""=1), ""t2"" AS (SELECT ""number"" FROM (SELECT ""number"",RANK() OVER (ORDER BY ""cum_freq"") AS ""rk"" FROM ""t"" WHERE ""cum_freq"">=FLOOR(""ct""/2)+1) AS ""x"" WHERE ""rk""=1) SELECT AVG(""number"") AS ""median"" FROM (SELECT ""number"" FROM ""t1"" UNION ALL SELECT ""number"" FROM ""t2"") AS ""z"""
213,"WITH ""num_cfreqs"" AS (SELECT ""number"",""frequency"",(SUM(""frequency"") OVER (ORDER BY ""number""))/(SUM(""frequency"") OVER ()) AS ""fr"",(SUM(""frequency"") OVER (ORDER BY ""number"" DESC))/(SUM(""frequency"") OVER ()) AS ""rfr"" FROM ""Numbers"" ORDER BY ""number"") SELECT AVG(""number"") AS ""median"" FROM ""num_cfreqs"" WHERE ""fr"">0.5 AND ""fr""<=""rfr"" OR ""fr""=0.5 OR ""rfr""=0.5"
214,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""Numbers"" AS ""t1"") JOIN ""Numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
215,"SELECT CASE WHEN ""running_total"">""total""/2 AND ""running_total""-""frequency""<""total""/2 THEN ""Number"" WHEN ""running_total""=""total""/2 THEN (""Number""+""Number""+1)/2 ELSE NULL END AS ""median"" FROM (SELECT ""number"",""frequency"",SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""running_total"",SUM(""Frequency"") OVER () AS ""total"" FROM ""Numbers"") AS ""base"" HAVING ""median"" IS NOT NULL"
216,"WITH ""median"" AS (SELECT CEILING(SUM(""frequency"")/2) AS ""median_1"",CASE WHEN SUM(""frequency"")%2=1 THEN 0 ELSE CEILING(SUM(""frequency"")/2)+1 END AS ""median_2"" FROM ""Numbers""), ""totals"" AS (SELECT ""n1"".""number"",SUM(""n2"".""Frequency"") AS ""frequency"" FROM ""Numbers"" AS ""n1"" JOIN ""Numbers"" AS ""n2"" ON ""n1"".""number"">=""n2"".""number"" GROUP BY ""n1"".""number""), ""freq_range"" AS (SELECT ""number"",""frequency"" AS ""curr_freq"",COALESCE(LAG(""frequency"", 1) OVER (ORDER BY ""number""), 0) AS ""prev_freq"" FROM ""totals"") SELECT SUM(""number"")/COUNT(1) AS ""median"" FROM ""freq_range"" JOIN ""median"" WHERE ""median_1"" BETWEEN ""prev_freq""+1 AND ""curr_freq"" OR CASE WHEN ""median_2""=0 THEN ""median_1"" ELSE ""median_2"" END BETWEEN ""prev_freq""+1 AND ""curr_freq"""
217,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
218,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
219,"WITH ""frq"" AS (SELECT ""number"",""frequency"" AS ""f"",COALESCE((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<""n"".""number""), 0) AS ""p"",(SELECT SUM(""frequency"") FROM ""numbers"") AS ""count"" FROM ""numbers"" AS ""n"" ORDER BY ""number"") SELECT SUM(""number"")/SUM(""q"") AS ""median"" FROM (SELECT ""number"",1 AS ""q"" FROM ""frq"" WHERE (""p""<(FLOOR(""count""/2)+1) AND (FLOOR(""count""/2)+1)<=(""p""+""f"")) UNION ALL SELECT ""number"",1 AS ""q"" FROM ""frq"" WHERE CASE WHEN ""count""%2=0 THEN (""p""<FLOOR(""count""/2) AND FLOOR(""count""/2)<=(""p""+""f"")) ELSE ""p"">""count"" END) AS ""t"""
220,"WITH ""TotalNumbers"" AS (SELECT SUM(""Frequency"") AS ""total_count"" FROM ""Numbers""), ""MedianIndex"" AS (SELECT CEIL(""total_count""/2) AS ""first_index"",CASE WHEN ""total_count""%2=0 THEN CEIL(""total_count""/2)+1 ELSE CEIL(""total_count""/2) END AS ""second_index"" FROM ""TotalNumbers""), ""NumbersWithStartIndex"" AS (SELECT ""N1"".""Number"",""N1"".""Frequency"",COALESCE(SUM(""N2"".""Frequency""), 0)+1 AS ""Start_Position"",COALESCE(SUM(""N2"".""Frequency""), 0)+""N1"".""Frequency"" AS ""End_Position"" FROM ""Numbers"" AS ""N1"" LEFT JOIN ""Numbers"" AS ""N2"" ON ""N1"".""Number"">""N2"".""Number"" GROUP BY 1,2 ORDER BY 1), ""NumbersWithFirstIndex"" AS (SELECT ""N"".""Number"" AS ""number"" FROM ""NumbersWithStartIndex"" AS ""N"" JOIN ""MedianIndex"" AS ""I"" ON ""I"".""first_index"" BETWEEN ""N"".""Start_Position"" AND ""N"".""End_Position""), ""NumbersWithSecondIndex"" AS (SELECT ""N"".""Number"" AS ""number"" FROM ""NumbersWithStartIndex"" AS ""N"" JOIN ""MedianIndex"" AS ""I"" ON ""I"".""second_index"" BETWEEN ""N"".""Start_Position"" AND ""N"".""End_Position""), ""NumbersWithIndex"" AS (SELECT ROUND((""NumbersWithFirstIndex"".""Number""+""NumbersWithSecondIndex"".""Number"")/2, 2) AS ""median"" FROM ""NumbersWithFirstIndex"" JOIN ""NumbersWithSecondIndex"") SELECT * FROM ""NumbersWithIndex"""
221,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
222,"SELECT CASE WHEN SUM(""q"".""frequency"")%2=0 THEN (""q"".""number""+""q"".""number_old"")/2 ELSE AVG(""q"".""number"") END AS ""median"" FROM (SELECT ""a"".""number"",COALESCE(LAG(""a"".""number"", 1) OVER (ORDER BY ""a"".""number""), ""a"".""number"") AS ""number_old"",""a"".""frequency"",SUM(""b"".""frequency"") AS ""cum_frq"",COALESCE(LAG(SUM(""b"".""frequency""), 1) OVER (ORDER BY ""a"".""number""), 0) AS ""cum_frq_old"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" ON ""a"".""number"">=""b"".""number"" GROUP BY ""a"".""number"" ORDER BY ""a"".""number"") AS ""q"" WHERE ""q"".""cum_frq"">=(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"") AND ""q"".""cum_frq_old""<(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"")"
223,"SELECT CASE WHEN SUM(""q"".""frequency"")%2=0 THEN (""q"".""number""+""q"".""number_old"")/2 ELSE AVG(""q"".""number"") END AS ""median"" FROM (SELECT ""a"".""number"",COALESCE(LAG(""a"".""number"", 1) OVER (ORDER BY ""a"".""number""), ""a"".""number"") AS ""number_old"",""a"".""frequency"",SUM(""b"".""frequency"") AS ""cum_frq"",COALESCE(LAG(SUM(""b"".""frequency""), 1) OVER (ORDER BY ""a"".""number""), 0) AS ""cum_frq_old"" FROM ""numbers"" AS ""a"" JOIN ""numbers"" AS ""b"" ON ""a"".""number"">=""b"".""number"" GROUP BY ""a"".""number"" ORDER BY ""a"".""number"") AS ""q"" WHERE ""q"".""cum_frq"">=(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"") AND ""q"".""cum_frq_old""<(SELECT FLOOR(SUM(""frequency"")/2+1) FROM ""numbers"")"
224,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
225,"WITH ""temp_asc"" AS (SELECT ""f"".""Number"",""f"".""Frequency"",SUM(""f1"".""Frequency"") AS ""rk1"" FROM ""Numbers"" AS ""f"" JOIN ""Numbers"" AS ""f1"" ON ""f1"".""Number""<=""f"".""Number"" GROUP BY 1,2), ""temp_desc"" AS (SELECT ""f"".""Number"",""f"".""Frequency"",SUM(""f2"".""Frequency"") AS ""rk2"" FROM ""Numbers"" AS ""f"" JOIN ""Numbers"" AS ""f2"" ON ""f2"".""Number"">=""f"".""Number"" GROUP BY 1,2) SELECT AVG(""a"".""Number"") AS ""median"" FROM ""temp_asc"" AS ""a"" JOIN ""temp_desc"" AS ""d"" USING (""Number"",""Frequency"") WHERE ABS(""a"".""rk1""-""d"".""rk2"")<=""a"".""Frequency"""
226,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
227,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""n1"".""number"",""n1"".""frequency"",ABS(COALESCE(SUM(CASE WHEN ""n2"".""number"">""n1"".""number"" THEN ""n2"".""frequency"" END), 0)-COALESCE(SUM(CASE WHEN ""n2"".""number""<""n1"".""number"" THEN ""n2"".""frequency"" END), 0)) AS ""abs"" FROM ""numbers"" AS ""n1"" JOIN ""numbers"" AS ""n2"" GROUP BY 1,2) AS ""tem"" WHERE ""frequency"">=""abs"""
228,"SELECT AVG(""t1"".""Number"") AS ""median"" FROM (SELECT ""n1"".""Number"",""n1"".""Frequency"",SUM(""n2"".""Frequency"") AS ""left_total"" FROM (""Numbers"" AS ""n1"") JOIN ""Numbers"" AS ""n2"" WHERE ""n1"".""Number"">=""n2"".""Number"" GROUP BY ""n1"".""Number"",""n1"".""Frequency"") AS ""t1"" JOIN (SELECT ""n1"".""Number"",""n1"".""Frequency"",SUM(""n2"".""Frequency"") AS ""right_total"" FROM (""Numbers"" AS ""n1"") JOIN ""Numbers"" AS ""n2"" WHERE ""n1"".""Number""<=""n2"".""Number"" GROUP BY ""n1"".""Number"",""n1"".""Frequency"") AS ""t2"" ON ""t1"".""Number""=""t2"".""Number"" WHERE ""t1"".""Frequency"">=ABS(""t1"".""left_total""-""t2"".""right_total"")"
229,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
230,"WITH RECURSIVE ""expand"" AS (SELECT ""Number"",1 AS ""ct"",""Frequency"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""ct""+1,""Frequency"" FROM ""expand"" WHERE ""ct""<""Frequency""), ""ranks"" AS (SELECT ""number"",RANK() OVER (ORDER BY ""number"",""ct"") AS ""r"",COUNT(1) OVER () AS ""max_v"" FROM ""expand"") SELECT AVG(""number"") AS ""median"" FROM ""ranks"" WHERE ""r"">=FLOOR((""max_v""+1)/2) AND ""r""<=CEILING((""max_v""+1)/2)"
231,"SELECT AVG(""number"") AS ""median"" FROM (SELECT ""l"".""number"" FROM ""numbers"" AS ""l"" JOIN ""numbers"" AS ""r"" GROUP BY 1 HAVING ABS(SUM(SIGN(""l"".""number""-""r"".""number"")*""r"".""frequency""))<=MAX(""l"".""frequency"")) AS ""t"""
232,"SELECT AVG(""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number""))"
233,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
234,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
235,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
236,"SELECT AVG(""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number""))"
237,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
238,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
239,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""frequency"") FROM ""Numbers"" WHERE ""n"".""Number"">=""Number"")-(SELECT SUM(""frequency"") FROM ""Numbers"" WHERE ""n"".""Number""<=""Number""))"
240,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
241,"SELECT ROUND(AVG(""n1"".""number""), 4) AS ""median"" FROM ""numbers"" AS ""n1"" WHERE ""n1"".""frequency"">=ABS((SELECT SUM(""n2"".""frequency"") FROM ""numbers"" AS ""n2"" WHERE ""n2"".""number""<=""n1"".""number"")-(SELECT SUM(""n3"".""frequency"") FROM ""numbers"" AS ""n3"" WHERE ""n3"".""number"">=""n1"".""number""))"
242,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""frequency"") FROM ""Numbers"" WHERE ""n"".""Number"">=""Number"")-(SELECT SUM(""frequency"") FROM ""Numbers"" WHERE ""n"".""Number""<=""Number""))"
243,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
244,"SELECT AVG(""number"") AS ""median"" FROM ""Numbers"" AS ""A"" WHERE ""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""A"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""A"".""Number""))"
245,"SELECT AVG(""a"".""Number"") AS ""median"" FROM ""Numbers"" AS ""a"" WHERE ""a"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""a"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""a"".""Number""))"
246,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
247,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""numbers"" WHERE ""Number"">=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""numbers"" WHERE ""Number""<=""n"".""Number""))"
248,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
249,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number""))"
250,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
251,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
252,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
253,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" AS ""n1"" WHERE ""n1"".""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" AS ""n2"" WHERE ""n2"".""Number"">=""n"".""Number""))"
254,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""n"".""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number""))"
255,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
256,"SELECT ROUND(AVG(""n1"".""number""), 4) AS ""median"" FROM ""numbers"" AS ""n1"" WHERE ""n1"".""frequency"">=ABS((SELECT SUM(""n2"".""frequency"") FROM ""numbers"" AS ""n2"" WHERE ""n2"".""number""<=""n1"".""number"")-(SELECT SUM(""n3"".""frequency"") FROM ""numbers"" AS ""n3"" WHERE ""n3"".""number"">=""n1"".""number""))"
257,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
258,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
259,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ((SELECT COALESCE(SUM(""Frequency""), 0) FROM ""Numbers"" WHERE ""Number""<""n"".""Number"")<=(SELECT SUM(""Frequency"")/2 FROM ""Numbers"")) AND ((SELECT COALESCE(SUM(""Frequency""), 0) FROM ""Numbers"" WHERE ""Number"">""n"".""Number"")<=(SELECT SUM(""Frequency"")/2 FROM ""Numbers""))"
260,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
261,"SELECT AVG(""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
262,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number""))"
263,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
264,"SELECT AVG(""t3"".""Number"") AS ""median"" FROM ""Numbers"" AS ""t3"" JOIN (SELECT ""t1"".""Number"",ABS(SUM(CASE WHEN ""t1"".""Number"">""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""t1"".""Number""<""t2"".""Number"" THEN ""t2"".""Frequency"" ELSE 0 END)) AS ""count_diff"" FROM (""numbers"" AS ""t1"") JOIN ""numbers"" AS ""t2"" GROUP BY ""t1"".""Number"") AS ""t4"" ON ""t3"".""Number""=""t4"".""Number"" WHERE ""t3"".""Frequency"">=""t4"".""count_diff"""
265,"WITH ""n0"" AS (SELECT ROUND(SUM(""Frequency"")/2) AS ""med"" FROM ""Numbers"" UNION SELECT ROUND(SUM(""Frequency"")/2+0.5) AS ""med"" FROM ""Numbers"") SELECT AVG(""n4"".""Number"") AS ""median"" FROM (SELECT ""n1"".""Number"" AS ""Number"",(SELECT SUM(""n2"".""Frequency"") FROM ""Numbers"" AS ""n2"" WHERE ""n2"".""Number""<=""n1"".""Number"")-""n1"".""Frequency""+1 AS ""F_start"",(SELECT SUM(""n3"".""Frequency"") FROM ""Numbers"" AS ""n3"" WHERE ""n3"".""Number""<=""n1"".""Number"") AS ""F_end"" FROM ""Numbers"" AS ""n1"") AS ""n4"" JOIN ""n0"" ON ""n4"".""F_start""<=""n0"".""med"" AND ""n4"".""F_end"">=""n0"".""med"""
266,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
267,"SELECT AVG(""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""n"".""frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""number""))"
268,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
269,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
270,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
271,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""b"".""Frequency"") FROM ""Numbers"" AS ""b"" WHERE ""n"".""Number""<=""b"".""Number"")-(SELECT SUM(""b"".""Frequency"") FROM ""Numbers"" AS ""b"" WHERE ""n"".""Number"">=""b"".""Number""))"
272,"SELECT AVG(""n1"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n1"" WHERE ""n1"".""Frequency"">=ABS((SELECT SUM(""n2"".""Frequency"") FROM ""Numbers"" AS ""n2"" WHERE ""n2"".""Number""<=""n1"".""Number"")-(SELECT SUM(""n3"".""Frequency"") FROM ""Numbers"" AS ""n3"" WHERE ""n3"".""Number"">=""n1"".""Number""))"
273,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
274,"WITH ""cte"" AS (SELECT *,COALESCE(LAG(""cum_freq"", 1) OVER (ORDER BY ""Number""), 0) AS ""lag_cum_freq"" FROM (SELECT *,SUM(""Frequency"") OVER (ORDER BY ""Number"") AS ""cum_freq"" FROM ""Numbers"") AS ""t"") SELECT AVG(""Number"") AS ""median"" FROM ""cte"" WHERE (""lag_cum_freq""<(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"") AND ""cum_freq"">=(SELECT CEIL(SUM(""Frequency"")/2) FROM ""Numbers"")) OR (""lag_cum_freq""<(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers"") AND ""cum_freq"">=(SELECT FLOOR(SUM(""Frequency"")/2+1) FROM ""Numbers""))"
275,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
276,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""n"".""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number""))"
277,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
278,"SELECT AVG(""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number""))"
279,"WITH ""candidates"" AS (SELECT ""n1"".""Number"" FROM (""Numbers"" AS ""n1"") JOIN ""Numbers"" AS ""n2"" WHERE ""n1"".""Number""!=""n2"".""Number"" GROUP BY ""n1"".""Number"",""n1"".""Frequency"" HAVING ""n1"".""Frequency"">=ABS(SUM(CASE WHEN ""n1"".""Number"">""n2"".""Number"" THEN ""n2"".""Frequency"" ELSE 0 END)-SUM(CASE WHEN ""n1"".""Number""<""n2"".""Number"" THEN ""n2"".""Frequency"" ELSE 0 END))) SELECT AVG(""Number"") AS ""median"" FROM ""candidates"""
280,"SELECT AVG(CAST(""n"".""Number"" AS FLOAT)) AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
281,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
282,"WITH RECURSIVE ""t1"" AS (SELECT ""Number"",""Frequency"",1 AS ""occurance"" FROM ""Numbers"" UNION ALL SELECT ""Number"",""Frequency"",""occurance""+1 FROM ""t1"" WHERE ""occurance""<""Frequency""), ""tmp2"" AS (SELECT ""Number"",ROW_NUMBER() OVER (ORDER BY ""Number"") AS ""row_index"",COUNT(1) OVER () AS ""num_cnt"" FROM ""t1""), ""tmp3"" AS (SELECT ""num_cnt"",AVG(""Number"") AS ""median"" FROM ""tmp2"" WHERE ""row_index"" BETWEEN ""num_cnt""/2 AND ""num_cnt""/2+1) SELECT ""median"" FROM ""tmp3"""
283,"SELECT AVG(""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""NUMBERS"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""FREQUENCY"") FROM ""NUMBERS"" WHERE ""Number"">=""n"".""Number""))"
284,"SELECT AVG(""number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
285,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
286,"SELECT AVG(""a"".""number"") AS ""median"" FROM ""numbers"" AS ""a"" WHERE ""a"".""frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""a"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""a"".""Number""))"
287,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
288,"WITH ""a"" AS (SELECT ""n"".""number"" AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""n"".""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number""))) SELECT (CASE WHEN COUNT(""median"")>1 THEN SUM(""median"")/2 ELSE ""median"" END) AS ""median"" FROM ""a"""
289,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
290,"SELECT AVG(""number"") AS ""median"" FROM ""numbers"" AS ""n"" WHERE ""n"".""frequency"">=ABS((SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""n"".""number""<=""numbers"".""number"")-(SELECT SUM(""frequency"") FROM ""numbers"" WHERE ""n"".""number"">=""numbers"".""number""))"
291,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
292,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
293,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
294,"SELECT AVG(""n1"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n1"" WHERE ""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" AS ""n2"" WHERE ""n2"".""Number""<=""n1"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" AS ""n3"" WHERE ""n3"".""Number"">=""n1"".""Number""))"
295,"SELECT AVG(""t1"".""number"") AS ""median"" FROM ""Numbers"" AS ""t1"" WHERE ""Frequency"">=ABS((SELECT SUM(""frequency"") FROM ""Numbers"" AS ""t2"" WHERE ""t1"".""Number"">=""t2"".""Number"")-(SELECT SUM(""frequency"") FROM ""Numbers"" AS ""t3"" WHERE ""t1"".""Number""<=""t3"".""Number""))"
296,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
297,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT COALESCE(SUM(""Frequency""), 0) FROM ""Numbers"" WHERE ""n"".""Number"">""Number"")-(SELECT COALESCE(SUM(""Frequency""), 0) FROM ""Numbers"" WHERE ""n"".""Number""<""Number""))"
298,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
299,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
300,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
301,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
302,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
303,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
304,"SELECT AVG(""n"".""number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""numbers"" WHERE ""number""<=""n"".""number"")-(SELECT SUM(""Frequency"") FROM ""numbers"" WHERE ""number"">=""n"".""number""))"
305,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
306,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
307,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number""))"
308,"SELECT AVG(""n"".""Number"") AS ""median"" FROM ""Numbers"" AS ""n"" WHERE ""n"".""Frequency"">=ABS((SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number""<=""n"".""Number"")-(SELECT SUM(""Frequency"") FROM ""Numbers"" WHERE ""Number"">=""n"".""Number""))"
