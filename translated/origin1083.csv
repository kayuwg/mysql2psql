id,original query
1,"SELECT ""s"".""buyer_id"" AS ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
2,"SELECT DISTINCT (""S"".""buyer_id"") FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT ""S"".""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
3,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" AND ""product"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" AND ""product"".""product_name""='iPhone')"
4,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_Id"" FROM ""product"" WHERE ""product_name""='iphone'))"
5,"WITH ""cte"" AS (SELECT ""buyer_id"",""product_name"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" USING (""product_id"") WHERE ""product_name""='S8' OR ""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone') AND ""product_name""='S8'"
6,"SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
7,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND (""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone'))"
8,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
9,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
10,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") GROUP BY 1 HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
11,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
12,"WITH ""c1"" AS (SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')), ""c2"" AS (SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone')) SELECT ""buyer_id"" FROM ""c1"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""c2"")"
13,"WITH ""tcte"" AS (SELECT ""p"".""product_name"",""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name"" IN ('S8','iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""tcte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""tcte"" WHERE ""product_name""='iPhone')"
14,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
15,"WITH ""cte"" AS (SELECT ""s"".*,""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
16,"SELECT ""s"".""buyer_id"" FROM (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')) AS ""s"" LEFT JOIN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone')) AS ""i"" ON ""s"".""buyer_id""=""i"".""buyer_id"" WHERE ""i"".""buyer_id"" IS NULL"
17,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
18,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",STRING_AGG(""product_name"", ',') AS ""product_names"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING ""product_names"" LIKE '%S8%' AND ""product_names"" NOT LIKE '%iPhone%') AS ""a"""
19,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='s8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iphone' THEN 1 ELSE 0 END)=0"
20,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
21,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
22,"SELECT ""buyer_id"" FROM (SELECT ""s"".""buyer_id"",MAX(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END) AS ""b_s8"",MAX(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""b_ip"" FROM ""product"" AS ""p"" RIGHT JOIN ""sales"" AS ""s"" USING (""product_id"") GROUP BY ""s"".""buyer_id"") AS ""temp"" WHERE ""b_s8""=1 AND ""b_ip""=0"
23,"SELECT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name"" IN ('S8','iPhone') GROUP BY ""buyer_id"" HAVING COUNT(DISTINCT ""product_name"")=1 AND MIN(""product_name"")='S8'"
24,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
25,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s1"" JOIN ""Product"" AS ""p1"" ON ""s1"".""product_id""=""p1"".""product_id"" WHERE ""p1"".""product_name""='iPhone')"
26,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
27,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
28,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(""Product"".""product_name""='S8')>0 AND SUM(""Product"".""product_name""='iPhone')=0"
29,"SELECT DISTINCT ""BUYER_ID"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
30,"WITH ""t1"" AS (SELECT ""s"".""buyer_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""t1"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""t1"" WHERE ""product_name""='iPhone')"
31,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
32,"WITH ""iphone_buyers"" AS (SELECT DISTINCT ""buyer_id"" AS ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone'), ""s_buyers"" AS (SELECT DISTINCT ""buyer_id"" AS ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8') SELECT ""buyer_id"" FROM ""s_buyers"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iphone_buyers"")"
33,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone') AND ""product_name""='S8'"
34,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
35,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')) AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
36,"SELECT DISTINCT ""t3"".""buyer_id"" FROM ""Sales"" AS ""t3"" JOIN ""Product"" AS ""t4"" ON ""t3"".""product_id""=""t4"".""product_id"" WHERE ""t4"".""product_name""='S8' AND ""t3"".""buyer_id"" NOT IN (SELECT ""t1"".""buyer_id"" FROM ""Sales"" AS ""t1"" LEFT JOIN ""Product"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""t2"".""product_name""='iPhone')"
37,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
38,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
39,"SELECT ""s"".""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
40,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8')) AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iphone'))"
41,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name"" IN ('S8','iPhone') GROUP BY ""buyer_id"" HAVING COUNT(DISTINCT ""product_name"")=1 AND MAX(""product_name"")='S8'"
42,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
43,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
44,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
45,"WITH ""cte"" AS (SELECT ""s"".""product_id"",""p"".""product_name"",""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name"" IN ('S8','iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
46,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING STRING_AGG(""product_name"", ',') LIKE '%S8%' AND STRING_AGG(""product_name"", ',') NOT LIKE '%iPhone%'"
47,"SELECT DISTINCT ""Sales"".""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='S8' AND ""Sales"".""buyer_id"" NOT IN (SELECT DISTINCT ""Sales"".""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='iPhone')"
48,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
49,"SELECT DISTINCT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone')"
50,"WITH ""temp"" AS (SELECT DISTINCT ""buyer_id"",""product_name"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name"" LIKE 'S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name"" LIKE 'iPhone')"
51,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
52,"WITH ""S8Buyers"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8'), ""iPhoneBuyers"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone') SELECT * FROM ""S8Buyers"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iPhoneBuyers"")"
53,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8' AND ""a"".""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iphone')"
54,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8')>0 AND MAX(""product_name""='iPhone')=0"
55,"SELECT DISTINCT (""b"".""buyer_id"") FROM ""sales"" AS ""b"" WHERE ""b"".""buyer_id"" IN (SELECT ""b"".""buyer_id"" FROM ""sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='S8') AND ""b"".""buyer_id"" NOT IN (SELECT ""b"".""buyer_id"" FROM ""sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='iPhone')"
56,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
57,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone' GROUP BY ""buyer_id"") GROUP BY ""buyer_id"""
58,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
59,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iPhone')"
60,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
61,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT (""s"".""buyer_id"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
62,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s1"".""buyer_id"" FROM ""Sales"" AS ""s1"" JOIN ""Product"" AS ""p1"" ON ""p1"".""product_id""=""s1"".""product_id"" AND ""p1"".""product_name""='iPhone')"
63,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" USING (""product_id"") GROUP BY ""S"".""buyer_id"" HAVING SUM('S8'=""P"".""product_name"")>0 AND SUM('iPhone'=""P"".""product_name"")=0"
64,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
65,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='iPhone')"
66,ERROR: An error occurred while restore SelectStmt.Having: An error occurred while restore HavingClause.Expr: An error occurred when restore BinaryOperationExpr.L: An error occurred while restore PatternLikeExpr.Expr: Psql translation: string_agg does not support DISTINCT
67,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='iPhone')"
68,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
69,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
70,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
71,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",CASE WHEN ""Product"".""product_name""='S8' THEN 1 WHEN ""Product"".""product_name""='iPhone' THEN -1 END AS ""coeff"" FROM ""Product"" JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" AND (""Product"".""product_name""='S8' OR ""Product"".""product_name""='iPhone') GROUP BY ""buyer_id"",""Product"".""product_name"") AS ""sales_info"" GROUP BY ""buyer_id"" HAVING SUM(""coeff"")=1"
72,"WITH ""A"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT * FROM ""A"")"
73,"SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
74,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
75,"SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"" HAVING (SUM(""product_name""='S8')>0) AND (SUM(""product_name""='iPhone')=0)"
76,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
77,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8') AND SUM(""product_name""='iPhone')=0"
78,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iphone')"
79,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='Iphone') ORDER BY ""buyer_id"""
80,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
81,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>=1 AND SUM(""p"".""product_name""='iPhone')=0"
82,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
83,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
84,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
85,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
86,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
87,"SELECT DISTINCT ""BUYER_ID"" FROM ""Product"" AS ""P"" RIGHT JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='S8' AND ""BUYER_ID"" NOT IN (SELECT ""BUYER_ID"" FROM ""Product"" AS ""P"" RIGHT JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='iphone')"
88,"WITH ""temp"" AS (SELECT * FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
89,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
90,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
91,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
92,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN (""p"".""product_name""='iPhone') THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN (""p"".""product_name""='S8') THEN 1 ELSE 0 END)>0"
93,"SELECT DISTINCT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT DISTINCT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
94,"WITH ""cte"" AS (SELECT ""s"".""buyer_id"",""product_name"" FROM ""Sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
95,"SELECT DISTINCT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""buyer_id"" IN (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='S8') AND ""a"".""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone')"
96,"SELECT DISTINCT ""BUYER_ID"" FROM ""SALES"" AS ""S"" JOIN ""PRODUCT"" AS ""P"" ON ""S"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" WHERE ""PRODUCT_NAME""='S8' AND ""BUYER_ID"" NOT IN (SELECT ""BUYER_ID"" FROM ""PRODUCT"" AS ""P"" JOIN ""SALES"" AS ""S"" ON ""P"".""PRODUCT_ID""=""S"".""PRODUCT_ID"" WHERE ""P"".""PRODUCT_NAME""='iPhone')"
97,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone')) GROUP BY 1"
98,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8')"
99,"WITH ""S8"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='S8') SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='iphone')"
100,"SELECT DISTINCT ""s"".""buyer_id"" FROM (""Product"" AS ""p"") JOIN ""Sales"" AS ""s"" WHERE ""p"".""product_name""='S8' AND ""p"".""product_id""=""s"".""product_id"" AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s1"".""buyer_id"" FROM (""Product"" AS ""p1"") JOIN ""Sales"" AS ""s1"" WHERE ""p1"".""product_id""=""s1"".""product_id"" AND ""p1"".""product_name""='iPhone')"
101,"SELECT DISTINCT (""b"".""buyer_id"") FROM ""sales"" AS ""b"" WHERE ""b"".""buyer_id"" IN (SELECT ""b"".""buyer_id"" FROM ""sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='S8') AND ""b"".""buyer_id"" NOT IN (SELECT ""b"".""buyer_id"" FROM ""sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='iPhone')"
102,"WITH ""sa"" AS (SELECT DISTINCT ""s"".""buyer_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name"" IN ('S8','iPhone')) SELECT ""buyer_id"" FROM ""sa"" WHERE ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sa"" WHERE ""product_name""='iPhone')"
103,"SELECT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
104,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
105,"SELECT DISTINCT ""c"".""buyer_id"" FROM (""Sales"" AS ""c"" LEFT JOIN ""Product"" AS ""g"" ON ""c"".""product_id""=""g"".""product_id"") LEFT JOIN (SELECT ""buyer_id"",""product_name"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""product_name""='iPhone') AS ""d"" ON ""c"".""buyer_id""=""d"".""buyer_id"" WHERE ""d"".""product_name"" IS NULL AND ""g"".""product_name""='S8'"
106,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
107,"WITH ""cte"" AS (SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')), ""demo"" AS (SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone')) SELECT ""cte"".""buyer_id"" FROM ""cte"" LEFT JOIN ""demo"" ON ""cte"".""buyer_id""=""demo"".""buyer_id"" WHERE ""demo"".""buyer_id"" IS NULL"
108,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""b"".""product_id""=""a"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
109,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iphone')=0"
110,"WITH ""S8_buyers"" AS (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" AS ""p"" WHERE ""product_name""='S8')), ""iPhone_buyers"" AS (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" AS ""p"" WHERE ""product_name""='iPhone')) SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" WHERE ""s"".""buyer_id"" IN (SELECT ""A"".""buyer_id"" FROM ""S8_buyers"" AS ""A"") AND ""s"".""buyer_id"" NOT IN (SELECT ""B"".""buyer_id"" FROM ""iPhone_buyers"" AS ""B"")"
111,"WITH ""iphone"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='s8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iphone"")"
112,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1"
113,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
114,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
115,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone ')"
116,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
117,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='Iphone')"
118,"SELECT DISTINCT ""s"".""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
119,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
120,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iphone')=0"
121,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
122,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='Iphone')"
123,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
124,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""t"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
125,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" AND ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" WHERE ""Sales"".""product_id""=""Product"".""product_id"" AND ""product_name""='iPhone')"
126,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING (SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iphone' THEN 1 ELSE 0 END)=0)"
127,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
128,"SELECT DISTINCT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""buyer_id"" IN (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='S8') AND ""a"".""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone')"
129,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
130,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON (""s"".""product_id""=""p"".""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""product_name""='iPhone')"
131,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
132,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
133,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""product"" AS ""p"" LEFT JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""product"" AS ""p"" LEFT JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
134,"WITH ""xtable"" AS (SELECT ""buyer_id"",""sales"".""product_id"",""product_name"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id""), ""ytable"" AS (SELECT DISTINCT ""buyer_id"",""product_name"" FROM ""xtable"") SELECT DISTINCT ""buyer_id"" FROM ""xtable"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""ytable"" WHERE ""product_name"" IN ('iphone'))"
135,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
136,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
137,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
138,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='iPhone')"
139,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
140,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
141,"WITH ""sales_with_product"" AS (SELECT ""a"".""buyer_id"",""a"".""product_id"",""b"".""product_name"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") SELECT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales_with_product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales_with_product"" WHERE ""product_name""='iPhone') GROUP BY ""buyer_id"""
142,"WITH ""t"" (""buyer_Id"") AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""Product_id""=""p"".""Product_id"" WHERE ""p"".""product_Name""='iPhone') SELECT DISTINCT ""s"".""buyer_id"" FROM (""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") LEFT JOIN ""t"" ON ""t"".""buyer_id""=""s"".""buyer_id"" WHERE ""p"".""product_name""='S8' AND ""t"".""buyer_id"" IS NULL"
143,"SELECT DISTINCT ""c"".""buyer_id"" FROM (""Sales"" AS ""c"" LEFT JOIN ""Product"" AS ""g"" ON ""c"".""product_id""=""g"".""product_id"") LEFT JOIN (SELECT ""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""product_name""='iPhone') AS ""d"" ON ""c"".""buyer_id""=""d"".""buyer_id"" WHERE ""d"".""buyer_id"" IS NULL AND ""g"".""product_name""='S8'"
144,"WITH ""A"" AS (SELECT ""Sales"".""buyer_id"" FROM ""Product"" LEFT JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""Product"".""product_name""='S8'), ""B"" AS (SELECT ""Sales"".""buyer_id"" FROM ""Product"" LEFT JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""Product"".""product_name""='iPhone') SELECT DISTINCT ""A"".""buyer_id"" FROM ""A"" WHERE ""buyer_id"" NOT IN (SELECT ""Sales"".""buyer_id"" FROM ""Product"" LEFT JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""Product"".""product_name""='iPhone')"
145,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
146,"WITH ""bought_s8"" AS (SELECT DISTINCT ""buyer_id"",""product_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')) SELECT ""buyer_id"" FROM ""bought_s8"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
147,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
148,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE (""buyer_id"") IN (SELECT ""buyer_id"" FROM ""product"" RIGHT JOIN ""sales"" USING (""product_id"") WHERE ""product_name""='S8') AND (""buyer_id"") NOT IN (SELECT ""buyer_id"" FROM ""product"" RIGHT JOIN ""sales"" USING (""product_id"") WHERE ""product_name""='iPhone')"
149,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE ""product_name"" WHEN 'S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE ""product_name"" WHEN 'iPhone' THEN 1 ELSE 0 END)=0"
150,"SELECT ""t1"".""buyer_id"" FROM ""Sales"" AS ""t1"" JOIN ""Product"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" GROUP BY ""t1"".""buyer_id"" HAVING SUM(CASE WHEN ""t2"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""t2"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
151,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name"" IN ('S8')) AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name"" IN ('iPhone','G4')))"
152,"WITH ""iphonebuyer"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iphonebuyer"") ORDER BY 1"
153,"SELECT ""t1"".""buyer_id"" FROM ""Sales"" AS ""t1"" JOIN ""Product"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" GROUP BY ""t1"".""buyer_id"" HAVING (SUM(CASE WHEN ""t2"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""t2"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0)"
154,"SELECT DISTINCT ""s2"".""buyer_id"" FROM ""sales"" AS ""s2"" JOIN ""product"" AS ""p2"" ON ""s2"".""product_id""=""p2"".""product_id"" WHERE ""p2"".""product_name""='S8' AND ""s2"".""buyer_id"" NOT IN (SELECT DISTINCT ""sa"".""buyer_id"" FROM ""sales"" AS ""sa"" JOIN ""product"" AS ""pa"" ON ""sa"".""product_id""=""pa"".""product_id"" WHERE ""pa"".""product_name""='iPhone')"
155,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""S"".""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8') AND ""S"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
156,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='s8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='iPhone')"
157,"WITH ""cte1"" AS (SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='s8'), ""cte2"" AS (SELECT DISTINCT ""s1"".""buyer_id"" FROM ""sales"" AS ""s1"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s1"".""product_id"" WHERE ""p"".""product_name""='iphone') SELECT DISTINCT ""c1"".""buyer_id"" FROM ""cte1"" AS ""c1"" WHERE ""c1"".""buyer_id"" NOT IN (SELECT ""c2"".* FROM ""cte2"" AS ""c2"")"
158,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
159,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
160,"SELECT DISTINCT ""Sales"".""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""buyer_id"" IN (SELECT DISTINCT ""Sales"".""buyer_id"" FROM ""Sales"" LEFT JOIN (SELECT ""Sales"".""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""Product"".""product_name""='iPhone') AS ""iPhoneUsers"" ON ""Sales"".""buyer_id""=""iPhoneUsers"".""buyer_id"" WHERE ""iPhoneUsers"".""buyer_id"" IS NULL) AND ""product_name""='S8'"
161,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
162,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
163,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
164,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT (""s"".""buyer_id"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
165,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='iPhone')"
166,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
167,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
168,"SELECT ""Sales"".""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""Sales"".""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
169,"WITH ""t"" AS (SELECT ""s"".*,""p"".""product_name"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""t"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""t"" WHERE ""product_name""='Iphone')"
170,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='iPhone')"
171,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" AS ""s"" WHERE EXISTS (SELECT * FROM (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8') AS ""s1"" WHERE ""s1"".""buyer_id""=""s"".""buyer_id"") AND NOT EXISTS (SELECT * FROM (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone') AS ""s2"" WHERE ""s2"".""buyer_id""=""s"".""buyer_id"")"
172,"SELECT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
173,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iphone')"
174,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" LEFT JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" LEFT JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
175,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
176,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
177,"WITH ""tb"" AS (SELECT ""S"".*,""P"".""product_name"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""tb"" WHERE ""tb"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""tb"" WHERE ""tb"".""product_name""='iPhone')"
178,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
179,"WITH ""temp"" AS (SELECT * FROM ""sales"" LEFT JOIN ""product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iphone')"
180,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
181,"WITH ""s"" AS (SELECT ""buyer_id"",SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""s8_cnt"",SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iphone_cnt"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY 1) SELECT ""buyer_id"" FROM ""s"" WHERE ""s8_cnt"">0 AND ""iphone_cnt""=0"
182,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
183,"WITH ""temp"" AS (SELECT ""s"".""product_id"",""s"".""buyer_id"",""p"".""product_name"" FROM (""Sales"" AS ""s"") JOIN ""Product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone') ORDER BY ""buyer_id"""
184,"WITH ""cte"" AS (SELECT ""buyer_id"",SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""S8"",SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iPhone"" FROM ""Product"" JOIN ""sales"" ON ""sales"".""product_id""=""product"".""product_id"" GROUP BY ""buyer_id"") SELECT ""buyer_id"" FROM ""cte"" WHERE ""S8"">0 AND ""iPhone""=0"
185,"SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE ""product_name"" WHEN 'S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE ""product_name"" WHEN 'iPhone' THEN 1 ELSE 0 END)=0"
186,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8' WHERE ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
187,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING MAX(""product_name""='S8')=1 AND MAX(""product_name""='iPhone')=0"
188,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
189,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8' WHERE ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
190,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='iPhone')"
191,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
192,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
193,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
194,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product"".""product_name""='iPhone') AND ""product"".""product_name""='S8'"
195,"SELECT ""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" GROUP BY ""buyer_id"" HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
196,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='s8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='iPhone')"
197,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
198,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
199,"WITH ""t1"" AS (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8'), ""t2"" AS (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""t1"" WHERE ""buyer_id"" NOT IN (SELECT * FROM ""t2"") ORDER BY ""buyer_id"""
200,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" AS ""ss"" JOIN ""product"" AS ""pp"" ON ""ss"".""product_id""=""pp"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iphone')"
201,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
202,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
203,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='iPhone')"
204,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iphone')"
205,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
206,"WITH ""k"" AS (SELECT ""buyer_id"",""product_name"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id""), ""a"" AS (SELECT DISTINCT ""buyer_id"" FROM ""k"" WHERE ""product_name""='iPhone'), ""b"" AS (SELECT DISTINCT ""buyer_id"" FROM ""k"" WHERE ""product_name""='S8') SELECT * FROM ""b"" WHERE ""buyer_id"" NOT IN (SELECT * FROM ""a"")"
207,"WITH ""BoughtS8"" AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8'), ""BoughtiPhone"" AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""BoughtS8"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""BoughtiPhone"")"
208,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
209,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
210,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
211,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
212,"SELECT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""buyer_id"" HAVING SUM(""b"".""product_name""='S8')>0 AND SUM(""b"".""product_name""='iPhone')=0"
213,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
214,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""s8_flag"",SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iphone_flag"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"") AS ""a"" WHERE ""s8_flag"">=1 AND ""iphone_flag""=0"
215,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
216,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
217,"SELECT ""b"".""buyer_id"" FROM ""product"" AS ""a"" RIGHT JOIN ""sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(CASE WHEN ""a"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""a"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
218,"WITH ""draft"" AS (SELECT ""s"".""buyer_id"",""s"".""product_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""draft"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""draft"" WHERE ""product_name""='iPhone')"
219,"WITH ""sales_with_product_name"" AS (SELECT ""s"".""buyer_id"",""s"".""product_id"",""p"".""product_name"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT (""buyer_id"") FROM ""sales_with_product_name"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales_with_product_name"" WHERE ""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales_with_product_name"" WHERE ""product_name""='S8')"
220,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
221,"WITH ""BUYER"" AS (SELECT ""BUYER_ID"",""PRODUCT_NAME"" FROM ""SALES"" LEFT JOIN ""PRODUCT"" ON ""SALES"".""PRODUCT_ID""=""PRODUCT"".""PRODUCT_ID"" WHERE ""PRODUCT_NAME"" IN ('IPHONE','S8') GROUP BY 1,2) SELECT DISTINCT ""T1"".""BUYER_ID"" FROM (SELECT ""BUYER_ID"" FROM ""BUYER"" WHERE ""PRODUCT_NAME""='S8') AS ""T1"" JOIN (SELECT ""BUYER_ID"" FROM ""BUYER"" GROUP BY 1 HAVING COUNT(1)=1) AS ""T2"" ON ""T1"".""BUYER_ID""=""T2"".""BUYER_ID"""
222,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
223,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
224,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
225,"SELECT DISTINCT ""t1"".""buyer_id"" FROM (SELECT ""x"".""buyer_id"" FROM ""Sales"" AS ""x"" WHERE ""x"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" WHERE ""s"".""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))) AS ""t1"" WHERE ""t1"".""buyer_id"" IN (SELECT ""y"".""buyer_id"" FROM ""Sales"" AS ""y"" WHERE ""y"".""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8'))"
226,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8')"
227,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
228,"SELECT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='s8')>0 AND SUM(""product_name""='iphone')=0"
229,"SELECT DISTINCT ""A"".""buyer_id"" FROM (SELECT ""S"".""buyer_id"",""P"".""product_name"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8') AS ""A"" LEFT JOIN (SELECT ""S"".""buyer_id"",""P"".""product_name"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone') AS ""B"" ON ""A"".""buyer_id""=""B"".""buyer_id"" WHERE ""B"".""product_name"" IS NULL"
230,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
231,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
232,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
233,"SELECT DISTINCT ""s1"".""buyer_id"" FROM ""product"" AS ""p1"" LEFT JOIN ""sales"" AS ""s1"" ON ""p1"".""product_id""=""s1"".""product_id"" WHERE ""p1"".""product_name""='S8' AND ""s1"".""buyer_id"" NOT IN (SELECT DISTINCT ""s1"".""buyer_id"" FROM ""product"" AS ""p1"" LEFT JOIN ""sales"" AS ""s1"" ON ""p1"".""product_id""=""s1"".""product_id"" WHERE ""p1"".""product_name""='iPhone')"
234,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""Product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""Product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iphone')"
235,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iphone' THEN 1 ELSE 0 END)=0"
236,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iPhone')"
237,"SELECT DISTINCT ""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""product_name""='iPhone')"
238,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8')>0 AND MAX(""product_name""='iPhone')=0"
239,"SELECT DISTINCT ""s"".""buyer_id"" AS ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
240,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" LEFT JOIN ""Sales"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
241,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
242,"SELECT ""t"".""buyer_id"" FROM (SELECT ""buyer_id"",CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END AS ""S8_label"",CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END AS ""iPhone_label"" FROM ""sales"" AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""S8_label"")>0 AND SUM(""iPhone_label"")=0) AS ""t"""
243,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8' WHERE ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
244,"WITH ""A"" AS (SELECT DISTINCT ""buyer_id"",""product_name"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id""), ""B"" AS (SELECT ""buyer_id"",SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""buy_s8"",SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""buy_ip"" FROM ""A"" GROUP BY ""buyer_id"") SELECT ""buyer_id"" FROM ""B"" WHERE ""buy_s8"">0 AND ""buy_ip""=0"
245,"SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
246,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""ss"" JOIN ""product"" AS ""pp"" USING (""product_id"") WHERE ""product_name""='iphone') AND ""product_name""='s8'"
247,"WITH ""cte"" AS (SELECT ""s"".""buyer_id"",""s"".""product_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
248,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone' GROUP BY ""s"".""buyer_id"")"
249,"WITH ""t"" AS (SELECT ""p"".""product_name"",""s"".""buyer_id"" FROM ""Product"" AS ""p"" RIGHT JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"") SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",STRING_AGG(""product_name"", ',') AS ""pro"" FROM ""t"" GROUP BY 1) AS ""t1"" WHERE ""pro"" LIKE '%S8%' AND ""pro"" NOT LIKE '%iPhone%'"
250,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='Iphone') ORDER BY ""buyer_id"""
251,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
252,"WITH ""cte"" AS (SELECT * FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""cte"" JOIN ""product"" ON ""cte"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8'"
253,"WITH ""cte"" AS (SELECT ""a"".""product_id"",""b"".""product_name"",""a"".""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
254,"WITH ""cte"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
255,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name"" LIKE 's8' AND ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name"" LIKE 'iPhone'))"
256,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(""p"".""product_name""='iPhone')=0"
257,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""p"".""product_name"" LIKE 'S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name"" LIKE 'iPhone' THEN 1 ELSE 0 END)=0"
258,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone ')"
259,"SELECT ""A"".""buyer_id"" FROM ""Sales"" AS ""A"" JOIN ""Product"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" GROUP BY ""A"".""buyer_id"" HAVING SUM(CASE WHEN ""B"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""B"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
260,"SELECT ""buyer_id"" FROM ""sales"" AS ""t1"" JOIN ""product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='s8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
261,"SELECT ""buyer_id"" FROM (SELECT DISTINCT ""s"".""buyer_id"" AS ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8') AS ""s1"" WHERE ""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" AS ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
262,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
263,"SELECT ""buyer_id"" FROM (SELECT DISTINCT (""buyer_id"") FROM ""Sales"") AS ""s"" WHERE EXISTS (SELECT * FROM (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8') AS ""s1"" WHERE ""s1"".""buyer_id""=""s"".""buyer_id"") AND NOT EXISTS (SELECT * FROM (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone') AS ""s2"" WHERE ""s2"".""buyer_id""=""s"".""buyer_id"")"
264,"WITH ""temp"" AS (SELECT ""buyer_id"" AS ""buyer_id"",""product_name"" FROM ""Sales"" AS ""a"" JOIN (SELECT ""product_id"",""product_name"" FROM ""Product"") AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""buyer_id"",""product_name"") SELECT DISTINCT (""buyer_id"") FROM ""temp"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
265,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
266,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8') AND SUM(""product_name""='iPhone')=0"
267,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
268,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""s8"",SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iphone"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"") AS ""x"" WHERE ""s8"">0 AND ""iPhone""=0"
269,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')) AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
270,"SELECT ""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
271,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
272,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
273,"WITH ""t"" AS (SELECT ""s"".""buyer_id"",""p"".""product_name"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT ""buyer_id"" FROM ""t"" GROUP BY ""buyer_id"" HAVING ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""t"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""t"" WHERE ""product_name""='iPhone')"
274,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product"".""product_name""='iphone')"
275,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""sx"" JOIN ""product"" AS ""px"" ON ""px"".""product_id""=""sx"".""product_id"" WHERE ""product_name""='iPhone')"
276,"WITH ""S8Buyers"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""S"".""product_id"" AND ""P"".""product_name""='S8'), ""iPhoneBuyers"" AS (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""S"".""product_id"" AND ""P"".""product_name""='iPhone') SELECT ""buyer_id"" FROM ""S8Buyers"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iPhoneBuyers"")"
277,"SELECT ""buyer_id"" FROM (SELECT ""a"".""buyer_id"",SUM(CASE WHEN ""b"".""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iphone_sales"",SUM(CASE WHEN ""b"".""product_name""='S8' THEN 1 ELSE 0 END) AS ""S8_sales"" FROM ""sales"" AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""buyer_id"") AS ""c"" WHERE ""iphone_sales""=0 AND ""S8_sales"">=1"
278,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
279,"WITH ""s8"" AS (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='S8'), ""iphone"" AS (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='iPhone') SELECT DISTINCT ""s8"".""buyer_id"" FROM ""s8"" LEFT JOIN ""iphone"" ON ""s8"".""buyer_id""=""iphone"".""buyer_id"" WHERE ""iphone"".""buyer_id"" IS NULL"
280,"WITH ""base"" AS (SELECT ""s"".""buyer_id"",CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END AS ""S8"",CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END AS ""iPhone"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"") SELECT ""buyer_id"" FROM ""base"" GROUP BY ""buyer_id"" HAVING SUM(""S8"")>0 AND SUM(""iPhone"")=0"
281,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
282,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
283,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
284,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT (""s"".""buyer_id"") AS ""iphonebuyer"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
285,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='iPhone')"
286,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
287,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='Iphone')"
288,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
289,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" RIGHT JOIN ""Sales"" AS ""s"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" RIGHT JOIN ""Sales"" AS ""s"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='IPhone')"
290,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
291,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
292,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""Sales"".""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='iPhone')"
293,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""product_name""='iPhone') AND ""product_name""='S8'"
294,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
295,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
296,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
297,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8') AND SUM(""product_name""='iPhone')=0"
298,"SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
299,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
300,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
301,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
302,"SELECT ""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
303,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""p"".""product_name""='S8'"
304,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE (""buyer_id"" IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8')) AND (""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s2"" JOIN ""Product"" AS ""p2"" ON ""s2"".""product_id""=""p2"".""product_id"" WHERE ""p2"".""product_name""='iPhone'))"
305,"SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""p"" ON ""a"".""product_id""=""p"".""product_id"" WHERE 1=1 AND ""p"".""product_name""='S8' AND ""a"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""b"" ON ""b"".""product_id""=""s"".""product_id"" WHERE ""b"".""product_name""='iPhone') GROUP BY 1"
306,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0"
307,"SELECT DISTINCT ""buyer_id"" FROM ""SALES"" WHERE ""buyer_id"" IN (SELECT ""BUYER_ID"" FROM ""SALES"" WHERE ""PRODUCT_ID""=(SELECT ""PRODUCT_ID"" FROM ""PRODUCT"" WHERE ""PRODUCT_NAME""='S8')) AND ""BUYER_ID"" NOT IN (SELECT ""BUYER_ID"" FROM ""SALES"" WHERE ""PRODUCT_ID""=(SELECT ""PRODUCT_ID"" FROM ""PRODUCT"" WHERE ""PRODUCT_NAME""='IPHONE'))"
308,"WITH ""cte"" AS (SELECT ""a"".""seller_id"",""a"".""product_id"",""b"".""product_name"",""b"".""unit_price"",""a"".""buyer_id"",""a"".""sale_date"",""a"".""quantity"",""a"".""price"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
309,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
310,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
311,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
312,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""Product"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""Product"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
313,"WITH ""cte"" AS (SELECT ""s"".*,CASE WHEN ""p"".""product_name""='s8' THEN 0 WHEN ""p"".""product_name""='iphone' THEN 1 ELSE NULL END AS ""n_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""n_id"" IS NOT NULL GROUP BY ""buyer_id"" HAVING SUM(""n_id"")=0"
314,"WITH ""cte"" AS (SELECT DISTINCT (""buyer_id""),""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='IPhone')"
315,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""ss"" JOIN ""product"" AS ""pp"" USING (""product_id"") WHERE ""product_name""='iphone') AND ""product_name""='s8'"
316,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Sales"".""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8' OR ""product_name""='iPhone') GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
317,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" WHERE ""s"".""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=((SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone')))"
318,"SELECT DISTINCT ""s1"".""buyer_id"" FROM ""product"" AS ""p1"" LEFT JOIN ""sales"" AS ""s1"" ON ""p1"".""product_id""=""s1"".""product_id"" WHERE ""p1"".""product_name""='S8' AND ""s1"".""buyer_id"" NOT IN (SELECT DISTINCT ""s1"".""buyer_id"" FROM ""product"" AS ""p1"" LEFT JOIN ""sales"" AS ""s1"" ON ""p1"".""product_id""=""s1"".""product_id"" WHERE ""p1"".""product_name""='iPhone')"
319,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
320,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
321,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='iphone')"
322,"SELECT DISTINCT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""buyer_id"" IN (SELECT ""c"".""buyer_id"" FROM ""Sales"" AS ""c"" JOIN ""Product"" AS ""d"" ON ""c"".""product_id""=""d"".""product_id"" WHERE ""d"".""product_name""='S8') AND ""a"".""buyer_id"" NOT IN (SELECT ""c"".""buyer_id"" FROM ""Sales"" AS ""c"" JOIN ""Product"" AS ""d"" ON ""c"".""product_id""=""d"".""product_id"" WHERE ""d"".""product_name""='iPhone')"
323,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
324,"WITH ""iphone_buyers"" AS (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone'), ""S8_buyers"" AS (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8') SELECT * FROM ""S8_buyers"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iphone_buyers"")"
325,"SELECT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
326,"WITH ""t"" (""buyer_Id"") AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""Product_id""=""p"".""Product_id"" WHERE ""p"".""product_Name""='iPhone') SELECT DISTINCT ""s"".""buyer_id"" FROM (""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") LEFT JOIN ""t"" ON ""t"".""buyer_id""=""s"".""buyer_id"" WHERE ""p"".""product_name""='S8' AND ""t"".""buyer_id"" IS NULL"
327,"WITH ""cte1"" AS (SELECT ""s"".""buyer_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8'), ""cte2"" AS (SELECT ""s"".""buyer_id"" AS ""other"",""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='Iphone') SELECT ""buyer_id"" FROM ""cte1"" AS ""c1"" LEFT JOIN ""cte2"" AS ""c2"" ON ""c1"".""buyer_id""=""c2"".""other"" WHERE ""other"" IS NULL GROUP BY ""buyer_id"""
328,"SELECT DISTINCT ""a"".""buyer_id"" FROM (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name"" LIKE 'S8')) AS ""a"" JOIN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name"" LIKE 'iPhone'))) AS ""b"" ON ""a"".""buyer_id""=""b"".""buyer_id"""
329,"SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iphone') GROUP BY ""s"".""buyer_id"""
330,"SELECT ""final"".""buyer_id"" FROM (SELECT ""bothh"".""buyer_id"" AS ""buyer_id"",""bothh"".""product_name"" AS ""product_name"" FROM (SELECT ""S"".""product_id"",""P"".""product_name"" AS ""product_name"",""S"".""buyer_id"" AS ""buyer_id"" FROM (""Sales"" AS ""S"") JOIN ""Product"" AS ""P"" WHERE ""S"".""product_id""=""P"".""product_id"" AND (""P"".""product_name""='S8' OR ""P"".""product_name""='iPhone')) AS ""bothh"" GROUP BY ""bothh"".""buyer_id"" HAVING COUNT(DISTINCT ""bothh"".""product_name"")=1) AS ""final"" WHERE ""final"".""product_name""='S8'"
331,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone') GROUP BY ""buyer_id"""
332,"WITH ""T1"" AS (SELECT * FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8'), ""T2"" AS (SELECT * FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone') SELECT DISTINCT ""T1"".""buyer_id"" FROM ""T1"" LEFT JOIN ""T2"" USING (""buyer_id"") WHERE ""T2"".""seller_id"" IS NULL"
333,"WITH ""S"" AS (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8')), ""I"" AS (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""S"") AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""I"")"
334,"WITH ""sales_list"" AS (SELECT ""s"".""product_id"",""s"".""buyer_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""sales_list"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales_list"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales_list"" WHERE ""product_name""='iPhone')"
335,"SELECT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING COUNT(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE NULL END)>0 AND COUNT(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE NULL END)=0"
336,"SELECT ""buyer_id"" FROM (SELECT ""s"".""buyer_id"",SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END) AS ""s8_flag"",SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iphone_flag"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1) AS ""a"" WHERE ""s8_flag"">0 AND ""iphone_flag""=0"
337,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
338,"SELECT ""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
339,"WITH ""prod_sale"" (""buyer_id"", ""product_name"") AS (SELECT ""buyer_id"",""product_name"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") SELECT ""buyer_id"" FROM ""prod_sale"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
340,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='iphone')"
341,"SELECT DISTINCT ""s1"".""buyer_id"" FROM ""product"" AS ""p1"" LEFT JOIN ""sales"" AS ""s1"" ON ""p1"".""product_id""=""s1"".""product_id"" WHERE ""p1"".""product_name""='S8' AND ""s1"".""buyer_id"" NOT IN (SELECT DISTINCT ""s1"".""buyer_id"" FROM ""product"" AS ""p1"" LEFT JOIN ""sales"" AS ""s1"" ON ""p1"".""product_id""=""s1"".""product_id"" WHERE ""p1"".""product_name""='iPhone')"
342,"WITH ""s8"" AS (SELECT DISTINCT (""sales"".""buyer_id"") AS ""buyer"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8'), ""iphone"" AS (SELECT DISTINCT (""sales"".""buyer_id"") AS ""buyer"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iPhone') SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""buyer_id"" IN (SELECT * FROM ""s8"") AND ""buyer_id"" NOT IN (SELECT * FROM ""iphone"")"
343,"SELECT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" LEFT JOIN ""Sales"" AS ""s"" USING (""product_id"") GROUP BY 1 HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iphone' THEN 1 ELSE 0 END)=0"
344,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""p"".""product_id""=""s"".""product_id"" AND ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""p"".""product_id""=""s"".""product_id"" AND ""product_name""='iPhone')"
345,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
346,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='iPhone')"
347,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
348,"WITH ""temp"" AS (SELECT DISTINCT ""buyer_id"",""product_name"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name"" LIKE 'S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name"" LIKE 'iPhone')"
349,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' OR ""product_name""='iPhone' GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)!=0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
350,"SELECT ""buyer_id"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
351,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
352,"WITH ""cte1"" AS (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8'), ""cte2"" AS (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""cte1"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte2"") ORDER BY ""buyer_id"""
353,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
354,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",MAX(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""bought_iphone"",MAX(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""bought_S8"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"") AS ""a"" WHERE ""bought_iphone""=0 AND ""bought_S8""=1"
355,"WITH ""cte"" AS (SELECT ""s"".""seller_id"",""s"".""buyer_id"",""p"".""product_name"",""p"".""product_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name"" IN ('S8','iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone ')"
356,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
357,"SELECT ""buyer_id"" FROM ""product"" JOIN ""sales"" ON ""product"".""product_id""=""sales"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
358,"WITH ""s8_id"" AS (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='s8'), ""iphone_id"" AS (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iphone') SELECT ""buyer_id"" FROM ((""sales"" AS ""s"") JOIN ""s8_id"" AS ""s8"") JOIN ""iphone_id"" AS ""ip"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""s"".""product_id""=""s8"".""product_id"" THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""s"".""product_id""=""ip"".""product_id"" THEN 1 ELSE 0 END)=0"
359,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8')"
360,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='s8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='iPhone')"
361,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone' GROUP BY ""buyer_id"")"
362,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE (""buyer_id"") NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""p"".""product_name""='S8'"
363,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
364,"SELECT DISTINCT ""buyer_id"" FROM ""product"" JOIN ""sales"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""product"" JOIN ""sales"" USING (""product_id"") WHERE ""product_name""='iphone')"
365,"WITH ""temp"" AS (SELECT ""p"".""product_id"",""p"".""product_name"",""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
366,"WITH ""S8_ID"" AS (SELECT ""PRODUCT_ID"" FROM ""PRODUCT"" WHERE ""PRODUCT_NAME""='S8'), ""I_ID"" AS (SELECT ""PRODUCT_ID"" FROM ""PRODUCT"" WHERE ""PRODUCT_NAME""='iPhone'), ""S8_BUYER"" AS (SELECT ""SALES"".""BUYER_ID"" FROM (""S8_ID"") JOIN ""SALES"" WHERE ""SALES"".""PRODUCT_ID""=""S8_ID"".""PRODUCT_ID""), ""I_BUYER"" AS (SELECT ""SALES"".""BUYER_ID"" FROM (""I_ID"") JOIN ""SALES"" WHERE ""SALES"".""PRODUCT_ID""=""I_ID"".""PRODUCT_ID"") SELECT DISTINCT (""S8_BUYER"".""BUYER_ID"") FROM ""S8_BUYER"" WHERE ""S8_BUYER"".""BUYER_ID"" NOT IN (SELECT ""BUYER_ID"" FROM ""I_BUYER"")"
367,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
368,"WITH ""CTE"" AS (SELECT ""BUYER_ID"",""PRODUCT_NAME"" FROM ""SALES"" LEFT JOIN ""PRODUCT"" ON ""SALES"".""PRODUCT_ID""=""PRODUCT"".""PRODUCT_ID"") SELECT DISTINCT ""BUYER_ID"" FROM ""CTE"" WHERE ""BUYER_ID"" IN (SELECT ""BUYER_ID"" FROM ""CTE"" WHERE ""PRODUCT_NAME""='S8') AND ""BUYER_ID"" NOT IN (SELECT ""BUYER_ID"" FROM ""CTE"" WHERE ""PRODUCT_NAME""='iPhone')"
369,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
370,"SELECT DISTINCT ""S1"".""buyer_id"" FROM (""Sales"" AS ""S1"") JOIN ""Product"" AS ""P"" WHERE ""S1"".""product_id""=""P"".""product_id"" AND ""P"".""product_name""='S8' AND ""S1"".""buyer_id"" NOT IN (SELECT ""S1"".""buyer_id"" AS ""iPhone"" FROM (""Sales"" AS ""S1"") JOIN ""Product"" AS ""P"" WHERE ""S1"".""product_id""=""P"".""product_id"" AND ""P"".""product_name""='iPhone')"
371,"SELECT DISTINCT ""buyer_id"" FROM (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8')) AS ""t"" WHERE ""t"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
372,"WITH ""temp"" AS (SELECT * FROM ""sales"" LEFT JOIN ""product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
373,"WITH ""temp"" AS (SELECT ""S"".*,""product_name"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
374,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
375,"WITH ""t1"" AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='S8'), ""t2"" AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""t1"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""t2"")"
376,"WITH ""cte1"" AS (SELECT ""s"".""buyer_id"" AS ""boughts8"" FROM ""Sales"" AS ""s"" WHERE ""s"".""product_id""=(SELECT ""p"".""product_id"" FROM ""Product"" AS ""p"" WHERE ""p"".""product_name""='S8')), ""cte2"" AS (SELECT ""s"".""buyer_id"" AS ""boughtiphone"" FROM ""Sales"" AS ""s"" WHERE ""s"".""product_id""=(SELECT ""p"".""product_id"" FROM ""Product"" AS ""p"" WHERE ""p"".""product_name""='iPhone')) SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" WHERE ""s"".""buyer_id"" IN (SELECT ""boughts8"" FROM ""cte1"") AND ""s"".""buyer_id"" NOT IN (SELECT ""boughtiphone"" FROM ""cte2"")"
377,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" GROUP BY ""S"".""buyer_id"" HAVING SUM(""P"".""product_name""='S8')>0 AND SUM(""P"".""product_name""='iPhone')=0"
378,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
379,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
380,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='iPhone')"
381,"WITH ""iphonebuyers"" AS (SELECT ""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""b"".""product_name""='iPhone'), ""s8buyers"" AS (SELECT ""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""b"".""product_name""='S8') SELECT DISTINCT ""a"".""buyer_id"" FROM (""sales"" AS ""a"") JOIN ""s8buyers"" AS ""i"" WHERE ""a"".""buyer_id""=""i"".""buyer_id"" AND ""a"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iphonebuyers"")"
382,"SELECT ""S"".""BUYER_ID"" FROM ""SALES"" AS ""S"" LEFT JOIN ""PRODUCT"" AS ""P"" ON ""S"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" GROUP BY ""S"".""BUYER_ID"" HAVING SUM(""P"".""PRODUCT_NAME""='S8')>0 AND SUM(""P"".""PRODUCT_NAME""='iPHONE')=0"
383,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
384,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iphone' THEN 1 ELSE 0 END)=0"
385,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s2"".""buyer_id"" FROM ""Sales"" AS ""s2"" JOIN ""Product"" AS ""p2"" ON ""s2"".""product_id""=""p2"".""product_id"" WHERE ""p2"".""product_name""='iPhone')"
386,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iPhone')"
387,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
388,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' HAVING ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iphone')"
389,"WITH ""CTE"" AS (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""product_name""='S8'), ""CTE1"" AS (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" AND ""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""CTE"" AS ""a"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""CTE1"")"
390,"SELECT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
391,"SELECT DISTINCT ""buyer_id"" FROM (SELECT ""s"".""buyer_id"",CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END AS ""s8"",CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END AS ""iphone"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") AS ""temp1"" GROUP BY ""buyer_id"" HAVING SUM(""s8"")>0 AND SUM(""iphone"")=0"
392,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
393,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
394,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
395,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
396,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING COUNT(CASE ""product_name"" WHEN 'S8' THEN 1 ELSE NULL END)>=1 AND COUNT(CASE ""product_name"" WHEN 'iPhone' THEN 1 ELSE NULL END)=0"
397,"SELECT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
398,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='iPhone')"
399,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
400,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
401,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='iPhone')"
402,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" LEFT JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iphone')"
403,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iphone'))"
404,"SELECT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
405,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""product_name""='iPhone')"
406,"SELECT DISTINCT (""BUYER_ID"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""BUYER_ID"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='Iphone')"
407,"SELECT DISTINCT ""buyer_id"" FROM (SELECT ""buyer_id"",CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END AS ""S8"",CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END AS ""iPhone"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"") AS ""sub"" GROUP BY ""buyer_id"" HAVING SUM(""S8"")>0 AND SUM(""iPhone"")=0"
408,"WITH ""iPhone_buyer"" AS (SELECT DISTINCT ""A"".""buyer_id"" FROM ""Sales"" AS ""A"" LEFT JOIN ""Product"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" WHERE ""product_name""='iPhone'), ""s8_buyer"" AS (SELECT DISTINCT ""A"".""buyer_id"" FROM ""Sales"" AS ""A"" LEFT JOIN ""Product"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" WHERE ""product_name""='S8') SELECT ""buyer_id"" FROM ""s8_buyer"" WHERE ""buyer_id"" NOT IN (SELECT * FROM ""iPhone_buyer"")"
409,"WITH ""a"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""a"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""a"" WHERE ""product_name""='iPhone')"
410,"SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
411,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""temp"" AS ""a"" JOIN ""temp"" AS ""b"" ON ""a"".""buyer_id""=""b"".""buyer_id"" WHERE ""a"".""product_name""='S8' AND ""b"".""product_name""='iPhone') AND ""product_name""='S8'"
412,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
413,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
414,"SELECT DISTINCT ""S"".""BUYER_ID"" FROM ""SALES"" AS ""S"" JOIN ""PRODUCT"" AS ""P"" ON ""S"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" WHERE ""P"".""PRODUCT_NAME""='S8' AND ""S"".""BUYER_ID"" NOT IN (SELECT ""BUYER_ID"" FROM ""SALES"" AS ""S1"" JOIN ""PRODUCT"" AS ""P1"" ON ""S1"".""PRODUCT_ID""=""P1"".""PRODUCT_ID"" WHERE ""P1"".""PRODUCT_NAME""='iPhone')"
415,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iphone')"
416,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") GROUP BY 1 HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
417,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='Iphone')) ORDER BY 1"
418,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>=1 AND SUM(""p"".""product_name""='iPhone')=0"
419,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='iphone')"
420,"WITH ""c"" AS (SELECT ""a"".""buyer_id"",""product_name"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""c"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""c"" WHERE ""product_name""='iPhone')"
421,"SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" USING (""product_id"") WHERE ""product_name""='iPhone')"
422,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
423,ERROR: An error occurred while restore SelectStmt.Having: An error occurred while restore HavingClause.Expr: An error occurred when restore BinaryOperationExpr.L: An error occurred while restore PatternLikeExpr.Expr: Psql translation: string_agg does not support DISTINCT
424,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
425,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8')"
426,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone')"
427,"WITH ""cte"" AS (SELECT ""buyer_id"",""product_name"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"" WHERE ""product_name""='iPhone')"
428,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
429,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
430,"WITH ""CTE"" AS (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone'), ""TEMP"" AS (SELECT DISTINCT (""buyer_id"") FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8') SELECT ""t"".""buyer_id"" FROM ""TEMP"" AS ""t"" LEFT JOIN ""CTE"" AS ""c"" ON ""t"".""buyer_id""=""c"".""buyer_id"" WHERE ""c"".""buyer_id"" IS NULL"
431,"SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""a"" JOIN ""sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""product_name""='iphone')"
432,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
433,"SELECT DISTINCT ""s"".""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
434,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
435,"WITH ""temp"" AS (SELECT DISTINCT ""S"".""buyer_id"",""S"".""product_id"",""P"".""product_name"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
436,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""S"" WHERE ""buyer_id"" IN (SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
437,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8')"
438,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
439,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""s"".""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
440,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
441,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""S"".""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""P"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""S"".""buyer_id"" FROM ""Product"" AS ""P"" JOIN ""Sales"" AS ""S"" ON ""P"".""product_id""=""S"".""product_id"" WHERE ""P"".""product_name""='iPhone')"
442,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE (""p"".""product_name""='S8') AND (""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone'))"
443,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
444,"SELECT DISTINCT ""b"".""buyer_id"" FROM ""Sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""b"".""buyer_id"" FROM ""Sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='iPhone') GROUP BY 1"
445,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone') ORDER BY ""s"".""buyer_id"""
446,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8')"
447,"WITH ""refined_product"" AS (SELECT ""product_id"",""product_name"",CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END AS ""s8_sale"",CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END AS ""iphone_sale"" FROM ""Product"" WHERE ""product_name"" IN ('S8','iPhone')) SELECT ""buyer_id"" FROM ""sales"" JOIN ""refined_product"" USING (""product_id"") GROUP BY 1 HAVING SUM(""iphone_sale"")=0 AND SUM(""s8_sale"")>0"
448,"SELECT ""S"".""buyer_id"" FROM (""Product"" AS ""P"") JOIN ""Sales"" AS ""S"" WHERE ""P"".""product_id""=""S"".""product_id"" GROUP BY ""S"".""buyer_id"" HAVING SUM(""P"".""product_name""='iPhone')=0 AND SUM(""P"".""product_name""='S8')>0"
449,"WITH ""s8_buyers"" AS (SELECT DISTINCT ""a"".""buyer_id"" AS ""buyer_id"" FROM (""Sales"" AS ""a"") JOIN ""Product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""b"".""product_name""='S8'), ""iphone_buyers"" AS (SELECT DISTINCT ""a"".""buyer_id"" AS ""buyer_id"" FROM (""Sales"" AS ""a"") JOIN ""Product"" AS ""b"" WHERE ""a"".""product_id""=""b"".""product_id"" AND ""b"".""product_name""='iPhone') SELECT ""buyer_id"" FROM ""s8_buyers"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""iphone_buyers"")"
450,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
451,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product"".""product_name""='iPhone')"
452,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
453,ERROR: An error occurred while restore SelectStmt.From: An error occurred while restore TableRefsClause.TableRefs: An error occurred while restore Join.Left: An error occurred while restore TableSource.Source: An error occurred while restore SelectStmt.Fields[1]: An error occurred while restore SelectField.Expr: Psql translation: string_agg does not support DISTINCT
454,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
455,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""p"".""product_name""='S8'"
456,"WITH ""buyers"" AS (SELECT ""s"".*,""p"".""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name"" IN ('s8','iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""buyers"" WHERE ""product_name""='s8' GROUP BY ""buyer_id"" HAVING ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""buyers"" GROUP BY ""buyer_id"" HAVING COUNT(DISTINCT ""product_name"")=2)"
457,"SELECT ""Buyer_id"" FROM (SELECT ""s"".""product_id"",""p"".""product_name"",""s"".""buyer_id"" FROM ""Product"" AS ""p"" LEFT JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"") AS ""T1"" GROUP BY ""buyer_id"" HAVING SUM(""T1"".""product_name""='S8')>0 AND SUM(""T1"".""product_name""='iPhone')=0"
458,"WITH ""TEMP"" AS (SELECT ""a"".*,""b"".""product_name"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""TEMP"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""TEMP"" WHERE ""product_name""='iPhone')"
459,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
460,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""Product"".""product_id"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='IPhone') AND ""product_name""='S8'"
461,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
462,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name"" IN ('S8','iPhone') GROUP BY ""buyer_id"" HAVING SUM(CASE ""product_name"" WHEN 'iPhone' THEN 1 ELSE 0 END)=0"
463,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
464,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE (""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""product_name""='iPhone'))"
465,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING (MAX(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)+MIN(CASE WHEN ""p"".""product_name""='iPhone' THEN -1 ELSE 0 END))=1"
466,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
467,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" LEFT JOIN ""Sales"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
468,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""s8"",(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iPhone"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") AS ""z"" GROUP BY 1 HAVING SUM(""s8"")>0 AND SUM(""iPhone"")=0"
469,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
470,"WITH ""prodsales"" AS (SELECT ""prod"".""product_id"",""prod"".""product_name"",""buyer_id"" FROM ""Product"" AS ""prod"" JOIN ""Sales"" AS ""sales"" ON ""prod"".""product_id""=""sales"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""prodsales"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""prodsales"" WHERE ""product_name""='iPhone')"
471,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
472,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
473,"SELECT DISTINCT ""s"".""buyer_id"" AS ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
474,"SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iphone' THEN 1 ELSE 0 END)=0"
475,"SELECT DISTINCT ""s2"".""buyer_id"" FROM ""sales"" AS ""s2"" JOIN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8') AS ""x"" ON ""x"".""buyer_id""=""s2"".""buyer_id"" WHERE ""x"".""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone')"
476,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='iphone')=0 AND SUM(""product_name""='S8')>0"
477,"WITH ""comProSal"" AS (SELECT ""buyer_id"",""s"".""product_id"",""p"".""product_name"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""comProSal"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""comProSal"" WHERE ""product_name""='iPhone') ORDER BY ""buyer_id"""
478,"SELECT DISTINCT ""buyer_id"" FROM (""Sales"" AS ""s"") JOIN ""Product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
479,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
480,"WITH ""s8"" AS (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8'), ""iphone"" AS (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""s8"" WHERE ""buyer_id"" NOT IN (SELECT * FROM ""iphone"")"
481,"SELECT DISTINCT ""Sales"".""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='S8' AND ""Sales"".""buyer_id"" NOT IN (SELECT ""Sales"".""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='iPhone')"
482,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
483,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
484,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iphone')"
485,"WITH ""t"" AS (SELECT ""buyer_id"",CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END AS ""s8_flag"",CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END AS ""iphone_flag"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT ""buyer_id"" FROM ""t"" GROUP BY ""buyer_id"" HAVING SUM(""s8_flag"")>0 AND SUM(""iphone_flag"")=0"
486,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
487,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
488,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')) AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
489,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
490,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" USING (""product_id"") WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" USING (""product_id"") WHERE ""product_name""='iphone')"
491,"WITH ""buyer_s8"" AS (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='S8'), ""buyer_no_iphone"" AS (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Product"".""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""buyer_s8"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""buyer_no_iphone"")"
492,"SELECT ""buyer_id"" FROM (SELECT ""buyer_id"",""product_name"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name"" IN ('iphone','S8') GROUP BY ""buyer_id"" HAVING COUNT(DISTINCT ""product_name"")=1 AND ""product_name""='S8') AS ""tmp"""
493,"SELECT ""A"".""buyer_id"" FROM ""Sales"" AS ""A"" LEFT JOIN ""Product"" AS ""B"" USING (""product_id"") GROUP BY ""A"".""buyer_id"" HAVING SUM(CASE WHEN ""B"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""B"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
494,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
495,"WITH ""buyertable"" AS (SELECT ""s"".""buyer_id"",""p"".""product_name"" FROM ""sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"") SELECT DISTINCT ""buyer_id"" FROM ""buyertable"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""buyertable"" WHERE ""product_name""='iPhone')"
496,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name"" IN ('S8') AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name"" IN ('iPhone'))"
497,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
498,"WITH ""a"" AS (SELECT ""a"".""buyer_id"",MAX(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""bought_s8"",MAX(CASE WHEN ""product_name""='Iphone' THEN 1 ELSE 0 END) AS ""bought_iphone"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""b"".""product_id""=""a"".""product_id"" GROUP BY 1) SELECT ""buyer_id"" FROM ""a"" WHERE ""bought_s8""=1 AND ""bought_iphone""=0"
499,"SELECT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
500,"WITH ""t1"" AS (SELECT ""buyer_id"",""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id""), ""t2"" AS (SELECT DISTINCT (""buyer_id"") AS ""ib"" FROM ""t1"" WHERE ""product_name""='iPhone') SELECT DISTINCT (""buyer_id"") FROM ""t1"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""ib"" FROM ""t2"")"
501,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" NATURAL JOIN ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Product"" NATURAL JOIN ""Sales"" WHERE ""product_name""='iPhone') AND ""product_name""='S8'"
502,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
503,"SELECT DISTINCT (""sales"".""buyer_id"") FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product"".""product_name""='S8' AND ""sales"".""buyer_id"" NOT IN (SELECT DISTINCT (""sales"".""buyer_id"") FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product"".""product_name""='iPhone')"
504,"SELECT DISTINCT (""b"".""buyer_id"") FROM ""sales"" AS ""b"" WHERE ""b"".""buyer_id"" IN (SELECT ""b"".""buyer_id"" FROM ""sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='S8') AND ""b"".""buyer_id"" NOT IN (SELECT ""b"".""buyer_id"" FROM ""sales"" AS ""b"" LEFT JOIN ""product"" AS ""a"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""product_name""='iPhone')"
505,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
506,"WITH ""CTE1"" AS (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='s8')), ""CTE2"" AS (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone')) SELECT DISTINCT ""buyer_id"" FROM ""CTE1"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""CTE2"")"
507,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone')) GROUP BY 1"
508,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
509,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" JOIN ""product"" ON ""sales"".""product_id""=""product"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
510,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"") WHERE ""product_name""='iPhone')"
511,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone'))"
512,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" LEFT JOIN ""product"" ON ""sales"".""product_id""=""Product"".""product_id"" WHERE ""product_name""='IPhone')"
513,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone') GROUP BY ""buyer_id"""
514,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
515,"SELECT ""buyer_id"" FROM ""product"" JOIN ""sales"" USING (""product_id"") WHERE ""product_name""='iPhone' OR ""product_name""='S8' GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
516,"SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""P"".""product_name""='S8' AND ""S"".""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='iPhone')) GROUP BY 1"
517,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='iPhone')"
518,"SELECT DISTINCT ""buyer_id"" FROM (SELECT ""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='S8') AS ""s1"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM (""sales"" AS ""s"") JOIN ""product"" AS ""p"" WHERE ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
519,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
520,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
521,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
522,"SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""b"".""buyer_id"" HAVING SUM(""a"".""product_name""='S8')>0 AND SUM(""a"".""product_name""='iPhone')=0"
523,"WITH ""comb"" AS (SELECT ""P"".""product_id"" AS ""pid"",""P"".""product_name"" AS ""name"",""S"".""buyer_id"" AS ""bid"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"") SELECT DISTINCT (""bid"") AS ""buyer_id"" FROM ""comb"" WHERE ""bid"" IN (SELECT ""bid"" FROM ""comb"" WHERE ""name""='S8') AND ""bid"" NOT IN (SELECT ""bid"" FROM ""comb"" WHERE ""name""='iPhone')"
524,"SELECT ""S"".""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" GROUP BY ""S"".""buyer_id"" HAVING SUM(CASE WHEN ""P"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""P"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
525,"SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" JOIN ""product"" USING (""product_id"") WHERE ""product_name""='iPhone') GROUP BY ""buyer_id"""
526,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
527,"SELECT DISTINCT ""Sales"".""buyer_id"" FROM ""Sales"" WHERE ""Sales"".""buyer_id"" IN (SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" LEFT JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""Product_Name""='S8') AND ""Sales"".""buyer_id"" NOT IN (SELECT ""b"".""buyer_id"" FROM ""Product"" AS ""a"" LEFT JOIN ""Sales"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""Product_Name""='iPhone')"
528,"WITH ""temp"" AS (SELECT * FROM ""product"" JOIN ""sales"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
529,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""p"".""product_name""='iPhone')"
530,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_ID"" WHERE ""p"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_ID"" WHERE ""p"".""product_name""='iphone')"
531,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
532,"SELECT DISTINCT (""S"".""buyer_id"") FROM ""Sales"" AS ""s"" LEFT JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT (""s"".""buyer_id"") AS ""iphonebuyer"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
533,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" AND ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" AND ""product_name""='iPhone')"
534,"SELECT ""buyer_id"" FROM ""Sales"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1 HAVING SUM(CASE WHEN ""b"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""b"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
535,"WITH ""CTE"" AS (SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""buyer_id"" NOT IN (SELECT * FROM ""CTE"") AND ""p"".""product_name""='S8' GROUP BY 1"
536,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
537,"WITH ""cte"" AS (SELECT DISTINCT (""buyer_id"") FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') SELECT DISTINCT (""buyer_id"") AS ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"")"
538,"SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
539,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
540,"WITH ""temp"" AS (SELECT * FROM ""Product"" NATURAL JOIN ""Sales"") SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
541,"SELECT ""buyer_id"" FROM ""Product"" AS ""p"" JOIN ""Sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
542,"WITH ""cte"" AS (SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone') SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""cte"")"
543,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iphone') AND ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8')"
544,"SELECT ""BUYER_ID"" FROM ""SALES"" JOIN ""PRODUCT"" ON ""SALES"".""PRODUCT_ID""=""PRODUCT"".""PRODUCT_ID"" GROUP BY ""BUYER_ID"" HAVING SUM(""PRODUCT_NAME""='S8')>0 AND SUM(""PRODUCT_NAME""='iPhone')=0"
545,"SELECT DISTINCT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='S8' AND ""a"".""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iphone')"
546,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""Product_id""=""p"".""Product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
547,"SELECT DISTINCT ""s"".""buyer_id"" FROM (SELECT ""s"".""product_id"",""product_name"",""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='S8') AS ""s"" LEFT JOIN (SELECT ""s"".""product_id"",""product_name"",""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""product_name""='iPhone') AS ""i"" USING (""buyer_id"") WHERE ""i"".""buyer_id"" IS NULL"
548,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""s"".""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name"" IN ('S8','iPhone')) GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
549,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING SUM(""p"".""product_name""='S8')>0 AND SUM(""p"".""product_name""='iPhone')=0"
550,"SELECT DISTINCT (""s"".""buyer_id"") FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
551,"SELECT DISTINCT (""buyer_id"") FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" LEFT JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" WHERE ""product_name""='iPhone')"
552,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
553,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""t1"" RIGHT JOIN ""Sales"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Product"" AS ""t1"" RIGHT JOIN ""Sales"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""product_name""='iPhone')"
554,"SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY 1 HAVING MAX(""product_name""='S8') AND MAX(""product_name""='iPhone')=0"
555,"WITH ""temp"" AS (SELECT * FROM ""Sales"" JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
556,"SELECT ""buyer_id"" FROM ""Sales"" AS ""S"" JOIN ""Product"" AS ""P"" ON ""S"".""product_id""=""P"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""product_name""='S8')>0 AND SUM(""product_name""='iPhone')=0"
557,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT DISTINCT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" ON ""Product"".""product_id""=""Sales"".""product_id"" WHERE ""product_name""='iPhone')"
558,"SELECT DISTINCT ""Sales"".""buyer_id"" FROM (""Product"") JOIN ""Sales"" WHERE ""Product"".""product_id""=""Sales"".""product_id"" AND ""Product"".""Product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""Sales"".""buyer_id"" FROM (""Product"") JOIN ""Sales"" WHERE ""Product"".""product_id""=""Sales"".""product_id"" AND ""Product"".""Product_name""='iPhone')"
559,"SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
560,"SELECT DISTINCT (""buyer_id"") FROM ""sales"" WHERE ""product_id"" IN (SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" AND ""p"".""product_name""='iPhone')"
561,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8')) AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" WHERE ""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='iPhone'))"
562,"SELECT DISTINCT ""S"".""BUYER_ID"" FROM ""SALES"" AS ""S"" JOIN ""PRODUCT"" AS ""P"" ON ""S"".""PRODUCT_ID""=""P"".""PRODUCT_ID"" GROUP BY ""S"".""BUYER_ID"" HAVING SUM(CASE WHEN ""P"".""PRODUCT_NAME""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""P"".""PRODUCT_NAME""='iPhone' THEN 1 ELSE 0 END)=0"
563,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
564,"SELECT DISTINCT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""product"" AS ""p"" JOIN ""sales"" AS ""s"" ON ""p"".""product_id""=""s"".""product_id"" WHERE ""product_name""='iPhone')"
565,"SELECT ""buyer_id"" FROM ""Sales"" JOIN ""Product"" ON ""Sales"".""product_id""=""Product"".""product_id"" WHERE ""Sales"".""product_id"" IN (SELECT ""product_id"" FROM ""Product"" WHERE ""product_name""='S8' OR ""product_name""='iPhone') GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
566,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
567,"SELECT DISTINCT ""buyer_id"" FROM ""Product"" JOIN ""Sales"" WHERE ""Product"".""product_id""=""Sales"".""product_id"" GROUP BY ""buyer_id"" HAVING SUM(""Product"".""product_name""='S8')>0 AND SUM(""Product"".""product_name""='iPhone')=0"
568,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" WHERE ""s"".""product_id""=(SELECT ""product_id"" FROM ""product"" WHERE ""product_name""='S8') AND ""s"".""buyer_id"" NOT IN (SELECT DISTINCT ""ss"".""buyer_id"" FROM (""sales"" AS ""ss"") JOIN ""product"" AS ""p"" WHERE ""p"".""product_name""='iPhone' AND ""p"".""product_id""=""ss"".""product_id"")"
569,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
570,"SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""a"".""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""b"".""product_name""='iPhone')"
571,"SELECT ""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(""p"".""product_name""='S8')>=1 AND SUM(""p"".""product_name""='iPhone')=0"
572,"SELECT ""buyer_id"" FROM ""Sales"" AS ""a"" JOIN ""Product"" AS ""b"" USING (""product_id"") GROUP BY ""buyer_id"" HAVING SUM(CASE WHEN ""b"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""b"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
573,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='S8' AND ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone')"
574,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8') AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone')"
575,"WITH ""sold_products"" AS (SELECT ""s"".""buyer_id"",SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END) AS ""s8"",SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""iPhone"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" GROUP BY ""s"".""buyer_id"") SELECT DISTINCT ""buyer_id"" FROM ""sold_products"" WHERE ""s8"">0 AND ""iPhone""=0"
576,"SELECT DISTINCT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""s"".""buyer_id"" NOT IN (SELECT ""s"".""buyer_id"" AS ""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""p"".""product_name""='iPhone') AND ""p"".""product_name""='S8'"
577,"SELECT ""s"".""buyer_id"" FROM ""sales"" AS ""s"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""s"".""product_id"" GROUP BY ""s"".""buyer_id"" HAVING SUM(CASE WHEN ""p"".""product_name""='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN ""p"".""product_name""='iPhone' THEN 1 ELSE 0 END)=0"
578,"WITH ""cte"" AS (SELECT ""buyer_id"",""product_name"" FROM ""Sales"" AS ""s"" JOIN ""Product"" AS ""p"" USING (""product_id"")), ""cte2"" AS (SELECT ""buyer_id"",SUM(CASE WHEN ""product_name""='S8' THEN 1 ELSE 0 END) AS ""S8_flag"",SUM(CASE WHEN ""product_name""='iPhone' THEN 1 ELSE 0 END) AS ""ip_flag"" FROM ""cte"" GROUP BY ""buyer_id"" HAVING ""S8_flag"">=1 AND ""ip_flag""=0) SELECT ""buyer_id"" FROM ""cte2"""
579,"WITH ""temp"" AS (SELECT * FROM ""Sales"" LEFT JOIN ""Product"" USING (""product_id"")) SELECT DISTINCT ""buyer_id"" FROM ""Sales"" WHERE ""buyer_id"" NOT IN (SELECT ""temp"".""buyer_id"" FROM ""temp"" WHERE ""product_name""='iPhone') AND ""buyer_id"" IN (SELECT ""temp"".""buyer_id"" FROM ""temp"" WHERE ""product_name""='S8')"
580,"SELECT DISTINCT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='S8' AND ""buyer_id"" NOT IN (SELECT ""buyer_id"" FROM ""sales"" AS ""s"" LEFT JOIN ""product"" AS ""p"" ON ""s"".""product_id""=""p"".""product_id"" WHERE ""product_name""='iPhone')"
