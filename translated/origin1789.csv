id,original query
1,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
2,"WITH ""t"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""num_dep"" FROM ""employee"") SELECT ""employee_id"",""department_id"" FROM ""t"" WHERE ""primary_flag""='Y' OR ""num_dep""=1"
3,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(1)=1)"
4,"SELECT * FROM (SELECT DISTINCT ""ct"".""employee_id"",CASE WHEN ""ct"".""ct_dept""=1 THEN ""department_id"" WHEN ""ct"".""ct_dept"">1 AND ""primary_flag""='Y' THEN ""department_id"" ELSE NULL END AS ""department_id"" FROM ""Employee"" LEFT JOIN (SELECT ""employee_id"",COUNT(""department_id"") AS ""ct_dept"" FROM ""Employee"" GROUP BY ""employee_id"") AS ""ct"" ON ""Employee"".""employee_id""=""ct"".""employee_id"") AS ""a"" WHERE ""department_id"" IS NOT NULL"
5,"WITH ""cte_final"" AS (SELECT ""employee_id"",CASE WHEN COUNT(1)=1 THEN ANY_VALUE(""department_id"") ELSE SUM(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END) END AS ""department_id"" FROM ""Employee"" GROUP BY 1) SELECT * FROM ""cte_final"""
6,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rank_"" FROM ""Employee"") AS ""tmp1"" WHERE ""rank_""=1 ORDER BY ""employee_id"""
7,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
8,"WITH ""emp"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(1) OVER (PARTITION BY ""employee_id"") AS ""cnt"" FROM ""employee"") SELECT ""employee_id"",""department_id"" FROM ""emp"" WHERE (""primary_flag""='Y' AND ""cnt"">1) OR ""cnt""=1"
9,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",COUNT(""department_id"") AS ""ct"" FROM ""employee"" GROUP BY ""employee_id"") AS ""r1"" NATURAL JOIN ""employee"" WHERE ""primary_flag""='Y' OR (""ct""=1 AND ""primary_flag""='N')"
10,"SELECT ""employee_id"",MAX(""department_id"") AS ""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(1)=1 UNION SELECT ""employee_id"",MAX(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" END) AS ""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(1)>1"
11,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""count_dept"" FROM ""Employee"") AS ""t1"" WHERE ""count_dept""=1 OR ""primary_flag""='Y'"
12,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
13,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(""employee_id"") OVER (PARTITION BY ""employee_id"") AS ""C"" FROM ""Employee"") AS ""T"" WHERE ""C""=1 OR ""primary_flag""='Y'"
14,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")<2 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
15,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
16,"WITH ""lookup"" AS (SELECT ""employee_id"",""department_id"",COUNT(""department_id"") AS ""flag"" FROM ""Employee"" GROUP BY ""employee_id"") SELECT ""Employee"".""employee_id"",""Employee"".""department_id"" FROM ""Employee"" LEFT JOIN ""lookup"" ON ""Employee"".""employee_id""=""lookup"".""employee_id"" WHERE ""primary_flag""='Y' OR ""flag""=1"
17,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
18,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
19,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
20,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
21,"WITH ""Temp1"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'), ""Temp2"" AS (SELECT ""employee_id"",""department_id"",COUNT(""department_id"") AS ""c"" FROM ""employee"" GROUP BY 1 HAVING ""c""=1) SELECT ""employee_id"",""department_id"" FROM ""Temp2"" UNION SELECT ""employee_id"",""department_id"" FROM ""Temp1"""
22,"WITH ""cte"" AS (SELECT ""employee_id"",""department_id"",RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rnk"" FROM ""employee"") SELECT ""employee_id"",""department_id"" FROM ""cte"" WHERE ""rnk""=1 GROUP BY ""employee_id"""
23,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
24,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1"
25,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
26,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(""primary_flag"")=1)"
27,"WITH ""cte"" AS (SELECT ""e"".""employee_id"",COUNT(1) AS ""employcount"" FROM ""Employee"" AS ""e"" GROUP BY 1) SELECT ""e"".""employee_id"",""e"".""department_id"" FROM ""Employee"" AS ""e"" LEFT JOIN ""cte"" ON ""e"".""employee_id""=""cte"".""employee_id"" WHERE ""cte"".""employcount""=1 OR (""cte"".""employcount"">1 AND ""e"".""primary_flag""='Y')"
28,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
29,"SELECT ""b"".""employee_id"",""b"".""department_id"" FROM (SELECT ""a"".*,ROW_NUMBER() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""row_num"" FROM ""Employee"" AS ""a"") AS ""b"" WHERE ""row_num""=1"
30,"WITH ""temp"" AS (SELECT ""employee_id"",""department_id"",ROW_NUMBER() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rk"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""temp"" WHERE ""rk""=1"
31,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",CASE WHEN COUNT(""department_id"") OVER (PARTITION BY ""employee_id"")=1 THEN 'Y' ELSE ""primary_flag"" END AS ""primary_flag"" FROM ""Employee"") AS ""t"" WHERE ""primary_flag""='Y'"
32,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" WHERE ""PRIMARY_FLAG""='Y' UNION SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" GROUP BY 1 HAVING COUNT(1)=1"
33,"WITH ""lookup"" AS (SELECT ""employee_id"",""department_id"",COUNT(""department_id"") AS ""flag"" FROM ""Employee"" GROUP BY ""employee_id"") SELECT ""Employee"".""employee_id"",""Employee"".""department_id"" FROM ""Employee"" LEFT JOIN ""lookup"" ON ""Employee"".""employee_id""=""lookup"".""employee_id"" WHERE ""primary_flag""='Y' OR ""flag""=1"
34,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
35,"(SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION ALL (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='N' AND ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(1)=1))"
36,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
37,"WITH ""temp"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT * FROM ""temp"" UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""temp"")"
38,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
39,"SELECT DISTINCT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y'"
40,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
41,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
42,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
43,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
44,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
45,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1)"
46,"SELECT ""e"".""employee_id"",CASE WHEN ""f"".""c"">1 AND ""e"".""primary_flag""='Y' THEN ""e"".""department_id"" WHEN ""f"".""c""=1 THEN ""e"".""department_id"" END AS ""department_id"" FROM ""employee"" AS ""e"" LEFT JOIN (SELECT ""employee_id"",""department_id"",COUNT(""primary_flag"") AS ""c"" FROM ""employee"" GROUP BY ""employee_id"") AS ""f"" ON ""e"".""employee_id""=""f"".""employee_id"" HAVING ""department_id"" IS NOT NULL"
47,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""cn"" FROM ""Employee"") AS ""temp"" WHERE (CASE WHEN ""cn""=1 THEN ""primary_flag""='N' OR ""primary_flag""='Y' WHEN ""cn"">1 THEN ""primary_flag""='Y' END)"
48,"WITH ""EmployeeWithOneDepartment"" AS (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1), ""firstTable"" AS (SELECT ""E"".""employee_id"",""E"".""department_id"" FROM ""Employee"" AS ""E"" JOIN ""EmployeeWithOneDepartment"" AS ""E1"" ON ""E"".""employee_id""=""E1"".""employee_id""), ""secondTable"" AS (SELECT ""E"".""employee_id"",""E"".""department_id"" FROM ""Employee"" AS ""E"" WHERE ""E"".""primary_flag""='Y') SELECT * FROM ""firstTable"" UNION SELECT * FROM ""secondTable"""
49,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
50,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
51,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
52,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING (COUNT(""department_id"")=1)"
53,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
54,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
55,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
56,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"")"
57,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
58,"WITH ""main"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""employee_id"") AS ""dep_count"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""main"" WHERE ""primary_flag""='Y' OR ""dep_count""=1"
59,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
60,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
61,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
62,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
63,"SELECT DISTINCT ""A"".""employee_id"",""A"".""department_id"" FROM (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1) UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') AS ""A"""
64,"WITH ""deps"" AS (SELECT ""employee_id"",COUNT(DISTINCT ""department_id"") AS ""deps_num"" FROM ""Employee"" AS ""e"" GROUP BY ""employee_id"") SELECT ""e"".""employee_id"",SUM(CASE WHEN ""deps_num""=1 THEN ""department_id"" ELSE CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END END) AS ""department_id"" FROM ""Employee"" AS ""e"" LEFT JOIN ""deps"" AS ""d"" ON ""e"".""employee_id""=""d"".""employee_id"" GROUP BY ""e"".""employee_id"""
65,"SELECT DISTINCT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') AS ""b"""
66,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
67,"WITH ""cte"" AS (SELECT ""employee_id"",""department_id"",COUNT(DISTINCT ""department_id"") AS ""count"" FROM ""employee"" GROUP BY ""employee_id"") SELECT ""employee_id"",""department_id"" FROM (SELECT ""e"".""employee_id"",""e"".""department_id"",""primary_flag"",""count"" FROM ""employee"" AS ""e"" JOIN ""cte"" AS ""c"" ON ""e"".""employee_id""=""c"".""employee_id"") AS ""sub"" WHERE (""count"">1 AND ""primary_flag""='Y') OR (""count""=1)"
68,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
69,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"")"
70,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY 1 UNION SELECT ""a"".""employee_id"",""a"".""department_id"" FROM (SELECT ""employee_id"",""department_id"",COUNT(""department_id"") FROM ""Employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1) AS ""a"""
71,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""cnt"" FROM ""Employee"") AS ""tab"" WHERE ""cnt""=1 OR (""cnt"">1 AND ""primary_flag""='Y')"
72,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR (""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1))"
73,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employee"" WHERE ""primary_flag""='Y') GROUP BY 1 HAVING COUNT(1)=1"
74,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
75,"WITH ""cnt"" AS (SELECT DISTINCT ""employee_id"",""department_id"",COUNT(""employee_id"") AS ""cnt"" FROM ""employee"" GROUP BY ""employee_id"") SELECT DISTINCT ""employee_id"",""department_id"" FROM ""cnt"" WHERE ""cnt""=1 UNION SELECT DISTINCT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
76,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""employee_id"") AS ""num_department"" FROM ""employee"") AS ""e1"" WHERE (""num_department"">1 AND ""primary_flag""='Y') OR (""num_department""=1)"
77,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
78,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",MAX(""primary_flag"") OVER (PARTITION BY ""employee_id"") AS ""last_flag"",""primary_flag"" FROM ""Employee"" ORDER BY 1) AS ""temp"" WHERE (""primary_flag""='Y') OR (""last_flag""='N') ORDER BY 1"
79,"WITH ""primaries"" AS (SELECT * FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT ""Employee"".""employee_id"",CASE WHEN ""primaries"".""department_id"" IS NULL THEN ""Employee"".""department_id"" ELSE ""primaries"".""department_id"" END AS ""department_id"" FROM ""Employee"" LEFT JOIN ""primaries"" ON ""Employee"".""employee_id""=""primaries"".""employee_id"" GROUP BY ""Employee"".""employee_id"" ORDER BY ""Employee"".""employee_id"""
80,"WITH ""base"" AS (SELECT ""employee_id"",COUNT(DISTINCT ""department_id"") AS ""nd"" FROM ""employee"" GROUP BY 1) SELECT ""e"".""employee_id"",""e"".""department_id"" FROM ""employee"" AS ""e"" LEFT JOIN ""base"" AS ""b"" ON ""e"".""employee_id""=""b"".""employee_id"" WHERE ""b"".""nd""=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
81,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" AS ""e"" WHERE ""primary_flag""='N' AND NOT EXISTS (SELECT 1 FROM ""employee"" AS ""e1"" WHERE ""e"".""employee_id""=""e1"".""employee_id"" AND ""e1"".""primary_flag""='Y')"
82,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY 1"
83,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(""primary_flag"")=1)"
84,"SELECT DISTINCT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y'"
85,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
86,"SELECT ""t1"".""employee_id"",CASE WHEN ""t1"".""department_id"" IS NULL THEN ""t2"".""department_id"" ELSE ""t1"".""department_id"" END AS ""department_id"" FROM (SELECT ""e"".""employee_id"",CASE WHEN COUNT(1)=1 THEN ""e"".""department_id"" ELSE NULL END AS ""department_id"" FROM ""employee"" AS ""e"" GROUP BY ""employee_id"") AS ""t1"" LEFT JOIN (SELECT ""e"".""employee_id"",""department_id"" FROM ""employee"" AS ""e"" WHERE ""e"".""primary_flag""='Y') AS ""t2"" ON ""t1"".""employee_id""=""t2"".""employee_id"""
87,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
88,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rownum"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""cte"" WHERE ""rownum""=1"
89,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""num"" FROM ""Employee"" ORDER BY ""employee_id"") AS ""a"" WHERE ""num""=1 OR ""primary_flag""='Y'"
90,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
91,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1)"
92,"WITH ""t"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY 1,2), ""t2"" AS (SELECT ""employee_id"",""department_id"",COUNT(""department_id"") AS ""c"" FROM ""Employee"" GROUP BY 1 HAVING ""c""=1) SELECT ""employee_id"",""department_id"" FROM ""t2"" UNION SELECT ""employee_id"",""department_id"" FROM ""t"""
93,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
94,"SELECT DISTINCT ""e"".""employee_id"",COALESCE(""E1"".""department_id"", ""E"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""e"" LEFT JOIN ""Employee"" AS ""e1"" ON ""e"".""employee_id""=""e1"".""employee_id"" AND ""e"".""primary_flag""='N' AND ""e1"".""primary_flag""='Y'"
95,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
96,"WITH ""single"" AS (SELECT ""employee_id"",COUNT(""employee_id"") AS ""count"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING ""count""=1), ""multi"" AS (SELECT ""employee_id"",COUNT(""employee_id"") AS ""count"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING ""count"">1) SELECT ""E"".""employee_id"",""E"".""department_id"" FROM ""single"" JOIN ""Employee"" AS ""E"" ON ""single"".""employee_id""=""E"".""employee_id"" UNION SELECT ""E"".""employee_id"",""E"".""department_id"" FROM ""multi"" JOIN ""Employee"" AS ""E"" ON ""multi"".""employee_id""=""E"".""employee_id"" WHERE ""E"".""primary_flag""='Y'"
97,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
98,"WITH ""temp"" AS (SELECT ""employee_id"",COUNT(""employee_id"") AS ""dep"" FROM ""Employee"" GROUP BY ""employee_id"") SELECT ""A"".""employee_id"",""A"".""department_id"" FROM ""Employee"" AS ""A"" LEFT JOIN ""temp"" AS ""B"" ON ""A"".""employee_id""=""B"".""employee_id"" WHERE ""A"".""primary_flag""='Y' OR ""B"".""dep""=1.00"
99,"SELECT ""e"".""employee_id"",CASE WHEN ""f"".""c"">1 AND ""e"".""primary_flag""='Y' THEN ""e"".""department_id"" WHEN ""f"".""c""=1 THEN ""e"".""department_id"" END AS ""department_id"" FROM ""employee"" AS ""e"" LEFT JOIN (SELECT ""employee_id"",""department_id"",COUNT(""primary_flag"") AS ""c"" FROM ""employee"" GROUP BY ""employee_id"") AS ""f"" ON ""e"".""employee_id""=""f"".""employee_id"" HAVING ""department_id"" IS NOT NULL"
100,"SELECT ""e"".""employee_id"",CASE WHEN ""f"".""c"">1 AND ""e"".""primary_flag""='Y' THEN ""e"".""department_id"" WHEN ""f"".""c""=1 THEN ""e"".""department_id"" END AS ""department_id"" FROM ""employee"" AS ""e"" LEFT JOIN (SELECT ""employee_id"",""department_id"",COUNT(""primary_flag"") AS ""c"" FROM ""employee"" GROUP BY ""employee_id"") AS ""f"" ON ""e"".""employee_id""=""f"".""employee_id"" HAVING ""department_id"" IS NOT NULL"
101,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
102,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
103,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
104,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 ORDER BY ""employee_id"""
105,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'))"
106,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
107,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
108,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
109,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
110,"SELECT DISTINCT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y'"
111,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
112,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
113,"SELECT DISTINCT ""e1"".""employee_id"",COALESCE(""e2"".""department_id"", ""e1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""e1"" LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""employee_id""=""e2"".""employee_id"" AND ""e1"".""primary_flag""='N' AND ""e2"".""primary_flag""='Y'"
114,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
115,"WITH ""cte"" AS (SELECT ""employee_id"",(CASE WHEN COUNT(""department_id"") OVER (PARTITION BY ""employee_id"")=1 THEN ""department_id"" WHEN COUNT(""department_id"") OVER (PARTITION BY ""employee_id"")>1 AND ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END) AS ""department_id"" FROM ""employee"") SELECT ""employee_id"",MAX(""department_id"") AS ""department_id"" FROM ""cte"" GROUP BY 1"
116,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1"
117,"SELECT ""e"".""employee_id"",""e"".""department_id"" FROM ""employee"" AS ""e"" WHERE ""primary_flag""='Y' OR (SELECT COUNT(1) FROM ""employee"" WHERE ""employee_id""=""e"".""employee_id"")=1"
118,"SELECT ""employee_id"",MAX(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" END) AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)>1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
119,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""cn"" FROM ""Employee"") AS ""temp"" WHERE (""cn""=1 AND (""primary_flag""='N' OR ""primary_flag""='Y')) OR (""cn"">1 AND ""primary_flag""='Y')"
120,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",ROW_NUMBER() OVER (PARTITION BY ""employee_id"" ORDER BY CASE WHEN ""primary_flag""='Y' THEN 1 ELSE 2 END) AS ""rn"" FROM ""Employee"") AS ""t"" WHERE ""rn""=1"
121,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
122,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
123,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" AS ""E1"" WHERE ""PRIMARY_FLAG""='Y' UNION ALL SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" AS ""E"" WHERE ""PRIMARY_FLAG""='N' AND NOT EXISTS (SELECT 1 FROM ""EMPLOYEE"" AS ""E2"" WHERE ""E"".""EMPLOYEE_ID""=""E2"".""EMPLOYEE_ID"" AND ""E2"".""PRIMARY_FLAG""='Y')"
124,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""Employee_id"" HAVING COUNT(1)=1"
125,"SELECT DISTINCT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""d_count"" FROM ""Employee"") AS ""p1"" WHERE (""d_count"">1 AND ""primary_flag""='Y') OR (""d_count""=1)"
126,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING SUM(""primary_flag""='Y')=0"
127,"WITH ""cte"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) SELECT ""employee_id"",""department_id"" FROM ""cte"" UNION ALL SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""cte"") AND ""primary_flag""='Y'"
128,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")>1) AND ""primary_flag""='Y' UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
129,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" AS ""e"" WHERE ""primary_flag""='Y' OR (""primary_flag""='N' AND ""employee_id"" IN (SELECT DISTINCT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1))"
130,"SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT DISTINCT ""employee_id"" FROM (SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') AS ""a"")"
131,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
132,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
133,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_Flag""='Y'"
134,"WITH ""no_primary"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1 AND ""primary_flag""='N'), ""yes_primary"" AS (SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT ""employee_id"",""department_id"" FROM ""yes_primary"" UNION ALL SELECT ""employee_id"",""department_id"" FROM ""no_primary"""
135,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
136,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
137,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
138,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"",""primary_flag"" UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
139,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"")"
140,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
141,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(1)=1"
142,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1"
143,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""primary_flag"")=1"
144,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
145,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(1)=1)"
146,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(1)=1)"
147,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(1)=1)"
148,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
149,"WITH ""temp"" AS (SELECT *,COUNT(1) OVER (PARTITION BY ""employee_id"" ORDER BY ""employee_id"") AS ""cnt"" FROM ""Employee"") SELECT ""employee_id"",SUM(CASE WHEN ""cnt""=1 OR ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END) AS ""department_id"" FROM ""temp"" GROUP BY ""employee_id"""
150,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
151,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
152,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
153,"WITH ""cte"" AS (SELECT *,COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""ct"" FROM ""Employee"") SELECT DISTINCT ""employee_id"",CASE WHEN ""ct""=1 THEN ""department_id"" ELSE CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE NULL END END AS ""department_id"" FROM ""cte"" WHERE (""ct""=1) OR (""ct"">1 AND ""primary_flag""='Y')"
154,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
155,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
156,"WITH ""tmp"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) SELECT * FROM ""tmp"" UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
157,"SELECT ""a"".""employee_id"",""a"".""department_id"" FROM (SELECT ""e1"".""employee_id"",""e1"".""department_id"",""e2"".""primary_flag"" FROM ""Employee"" AS ""e1"" LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""employee_id""=""e2"".""employee_id"" AND ""e1"".""department_id""!=""e2"".""department_id"" AND ""e1"".""primary_flag""!='Y') AS ""a"" WHERE ""a"".""primary_flag"" IS NULL"
158,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""cn"" FROM ""Employee"") AS ""temp"" WHERE (CASE WHEN ""cn""=1 THEN ""primary_flag""='Y' OR ""primary_flag""='N' WHEN ""cn"">1 THEN ""primary_flag""='Y' END)"
159,"SELECT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y' GROUP BY ""e1"".""employee_id"""
160,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1) ORDER BY 1"
161,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
162,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
163,"SELECT DISTINCT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y'"
164,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1)"
165,"WITH ""cte"" AS (SELECT ""employee_id"",COUNT(1) AS ""ct"",MAX(""primary_flag"") AS ""pf"" FROM ""Employee"" GROUP BY ""employee_id""), ""cte1"" AS (SELECT * FROM ""employee"" WHERE ""primary_flag""='Y') SELECT DISTINCT ""c"".""employee_id"",CASE WHEN ""ct"">1 AND ""pf""='Y' THEN ""c1"".""department_id"" ELSE ""e"".""department_id"" END AS ""department_id"" FROM (""cte"" AS ""c"" JOIN ""employee"" AS ""e"" ON ""c"".""employee_id""=""e"".""employee_id"") LEFT JOIN ""cte1"" AS ""c1"" ON ""c1"".""employee_id""=""c"".""employee_id"""
166,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" AS ""E1"" WHERE ""PRIMARY_FLAG""='Y' UNION ALL SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" AS ""E"" WHERE ""PRIMARY_FLAG""='N' AND NOT EXISTS (SELECT 1 FROM ""EMPLOYEE"" AS ""E2"" WHERE ""E"".""EMPLOYEE_ID""=""E2"".""EMPLOYEE_ID"" AND ""E2"".""PRIMARY_FLAG""='Y')"
167,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""employee_id"") OVER (PARTITION BY ""employee_id"") AS ""c"" FROM ""employee"") AS ""A"" WHERE ""c""=1 OR ""primary_flag""='Y'"
168,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"") UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
169,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""c"" FROM ""Employee"") AS ""TMP"" WHERE ""primary_flag""='Y' OR ""c""=1"
170,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""is_primary"" FROM ""employee"") AS ""a"" WHERE ""a"".""is_primary""=1"
171,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
172,"WITH ""t"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1), ""tt"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT * FROM ""t"" UNION SELECT * FROM ""tt"""
173,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 ORDER BY ""employee_id"",""department_id"""
174,"SELECT ""employee_id"",CASE WHEN (COUNT(""department_id"")>1) THEN SUM(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE NULL END) WHEN (COUNT(""department_id""))=1 THEN ""department_id"" END AS ""department_id"" FROM ""employee"" GROUP BY ""employee_id"""
175,"SELECT ""employee_id"",COALESCE(MAX(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE NULL END), ""department_id"") AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"""
176,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
177,"WITH ""new_employee"" AS (SELECT ""employee_id"",""department_id"",RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""row_rk"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""new_employee"" WHERE ""row_rk""=1"
178,"WITH ""dep_count"" AS (SELECT ""employee_id"",COUNT(DISTINCT ""department_id"") FROM ""Employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1), ""multiple_department"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'), ""single_department"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""dep_count"")) SELECT ""employee_id"",""department_id"" FROM ""multiple_department"" UNION SELECT ""employee_id"",""department_id"" FROM ""single_department"""
179,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
180,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
181,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
182,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
183,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
184,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
185,"WITH ""CTE"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1 UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT DISTINCT ""employee_id"",""department_id"" FROM ""CTE"""
186,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
187,"SELECT ""e1"".""employee_id"",""e1"".""department_id"" FROM ""Employee"" AS ""e1"" LEFT JOIN (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""employee_id"") AS ""cnt"" FROM ""Employee"" GROUP BY ""employee_id"") AS ""e2"" ON ""e1"".""employee_id""=""e2"".""employee_id"" WHERE ""e1"".""primary_flag""='Y' OR ""e2"".""cnt""=1"
188,"SELECT DISTINCT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) AS ""a"""
189,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
190,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' AND ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)>1) UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
191,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
192,"SELECT DISTINCT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(1) OVER (PARTITION BY ""employee_id"") AS ""total_count"" FROM ""Employee"") AS ""a"" WHERE ""a"".""primary_flag""='Y' OR ""total_count""=1"
193,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"" UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
194,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
195,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
196,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1)"
197,"WITH ""temp"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"",DENSE_RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""my_rank"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""temp"" WHERE ""my_rank""=1"
198,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
199,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
200,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
201,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",DENSE_RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""myrank"" FROM ""employee"") AS ""t"" WHERE ""myrank""=1"
202,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
203,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" JOIN (SELECT ""employee_id"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY ""employee_id"") AS ""t"" USING (""employee_id"") WHERE ""cnt""=1 OR ""primary_flag""='Y'"
204,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1"
205,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(""employee_id"") OVER (PARTITION BY ""employee_id"") AS ""cnt"" FROM ""employee"") AS ""t"" WHERE ""cnt""=1 OR ""primary_flag""='Y'"
206,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employee"" WHERE ""primary_flag""='Y') GROUP BY ""employee_id"",""department_id"" HAVING COUNT(1)=1"
207,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
208,"WITH ""t"" AS (SELECT ""employee_id"",""department_id"",ROW_NUMBER() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rk"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""t"" WHERE ""rk""=1"
209,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"" UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
210,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
211,"SELECT DISTINCT ""a"".""employee_id"",""a"".""department_id"" FROM (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') AS ""a"""
212,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""primary_flag"")=1"
213,"SELECT ""employee_id"",CASE WHEN COUNT(1)=1 THEN ""department_id"" ELSE SUM(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END) END AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"""
214,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
215,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
216,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
217,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
218,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
219,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
220,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""cn"" FROM ""Employee"") AS ""temp"" WHERE (CASE WHEN ""cn""=1 THEN ""primary_flag""='N' OR ""primary_flag""='Y' WHEN ""cn"">1 THEN ""primary_flag""='Y' END)"
221,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING (COUNT(""department_id"")=1) UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"""
222,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
223,"WITH ""t1"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y') SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""t1"") UNION ALL SELECT * FROM ""t1"" ORDER BY ""employee_id"""
224,"SELECT ""b"".""employee_id"",""b"".""department_id"" FROM ""Employee"" AS ""b"" WHERE ""b"".""primary_flag""='Y' OR (""b"".""primary_flag""='N' AND ""b"".""employee_id"" IN (SELECT ""a"".""employee_id"" FROM ""Employee"" AS ""a"" GROUP BY ""a"".""employee_id"" HAVING COUNT(1)=1)) GROUP BY ""b"".""employee_id"""
225,"WITH ""single"" AS (SELECT ""employee_id"" AS ""employee_id"",""department_id"" AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1), ""multi"" AS (SELECT ""employee_id"" AS ""employee_id"",""department_id"" AS ""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT ""employee_id"",""department_id"" FROM ""single"" UNION SELECT ""employee_id"",""department_id"" FROM ""multi"""
226,"SELECT ""a"".""employee_id"",MAX(CASE WHEN ""cnt""=1 THEN ""a"".""department_id"" WHEN ""cnt"">1 AND ""a"".""primary_flag""='Y' THEN ""a"".""department_id"" END) AS ""department_id"" FROM ""employee"" AS ""a"" JOIN (SELECT ""employee_id"",COUNT(1) AS ""cnt"" FROM ""employee"" GROUP BY 1) AS ""b"" ON ""a"".""employee_id""=""b"".""employee_id"" GROUP BY 1"
227,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
228,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" AS ""e1"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
229,"WITH ""single_dept"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT * FROM ""single_dept"""
230,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
231,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) ORDER BY ""employee_id"""
232,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
233,"WITH ""temp"" AS (SELECT ""employee_id"",COUNT(""department_id"") FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""temp"")"
234,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
235,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"""
236,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1) OR ""primary_flag""='Y' ORDER BY ""employee_id"""
237,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"") UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
238,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
239,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
240,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
241,"WITH ""cte"" AS (SELECT ""employee_id"" FROM ""employee"" GROUP BY 1 HAVING (COUNT(DISTINCT ""department_id""))=1) SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""e"".""employee_id"",""e"".""department_id"" FROM ""cte"" JOIN ""employee"" AS ""e"" ON ""cte"".""employee_id""=""e"".""employee_id"""
242,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE (""primary_flag""='Y') UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 ORDER BY ""employee_id"""
243,"WITH ""new"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y') SELECT DISTINCT ""e"".""employee_id"",COALESCE(""n"".""department_id"", ""e"".""department_id"") AS ""department_id"" FROM ""employee"" AS ""e"" LEFT JOIN ""new"" AS ""n"" ON ""e"".""employee_id""=""n"".""employee_id"""
244,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
245,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
246,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""num_dep"" FROM ""Employee"") AS ""a"" WHERE ""primary_flag""='Y' OR ""num_dep""=1"
247,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
248,"SELECT ""employee_id"",CASE WHEN COUNT(""department_id"")=1 THEN ""department_id"" ELSE SUM(CASE WHEN ""primary_flag""='Y' THEN 1 ELSE 0 END*""department_id"") END AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"""
249,"WITH ""t"" AS (SELECT ""employee_id"",SUM(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END) AS ""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)>1) SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT * FROM ""t"""
250,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
251,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
252,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
253,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""num_dept"" FROM ""Employee"") AS ""a"" WHERE ""primary_flag""='Y' OR ""num_dept""=1"
254,"WITH ""ETC"" AS (SELECT *,COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""cnt"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""ETC"" WHERE ""cnt""=1 OR ""primary_flag""='Y'"
255,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
256,"SELECT DISTINCT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y'"
257,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
258,"WITH ""mult"" AS (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)>1) SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION ALL SELECT ""e"".""employee_id"",""e"".""department_id"" FROM ""mult"" AS ""m"" JOIN ""employee"" AS ""e"" ON ""m"".""employee_id""=""e"".""employee_id"" WHERE ""primary_flag""='Y'"
259,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
260,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" AS ""e"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
261,"WITH ""a"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1), ""b"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"") SELECT ""a"".""employee_id"",""a"".""department_id"" FROM ""a"" UNION SELECT ""b"".""employee_id"",""b"".""department_id"" FROM ""b"""
262,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")<2) UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
263,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",DENSE_RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rnk"" FROM ""employee"") AS ""r"" WHERE ""rnk""=1"
264,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",MAX(""primary_flag"") OVER (PARTITION BY ""employee_id"") AS ""last_flag"",""primary_flag"" FROM ""Employee"" ORDER BY 1) AS ""temp"" WHERE (""primary_flag""='Y') OR (""last_flag""='N') ORDER BY 1"
265,"WITH ""cte"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1) SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT * FROM ""cte"""
266,"SELECT ""a"".""employee_id"",""a"".""department_id"" FROM ""employee"" AS ""a"" JOIN (SELECT ""employee_id"",COUNT(DISTINCT ""primary_flag"") AS ""cn"" FROM ""employee"" GROUP BY ""employee_id"") AS ""b"" ON ""a"".""employee_id""=""b"".""employee_id"" WHERE (""b"".""cn""=1) OR (""b"".""cn"">1 AND ""primary_flag""='Y')"
267,"WITH ""cte"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y') SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""cte"") UNION SELECT * FROM ""cte"""
268,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
269,"SELECT ""t2"".""employee_id"",""t2"".""department_id"" FROM (SELECT ""t1"".*,(SELECT COUNT(DISTINCT ""t3"".""department_id"") FROM ""employee"" AS ""t3"" WHERE ""t1"".""employee_id""=""t3"".""employee_id"") AS ""num_dept"" FROM ""employee"" AS ""t1"") AS ""t2"" WHERE ""num_dept""=1 OR (""num_dept"">1 AND ""primary_flag""='Y')"
270,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
271,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""department_id"") OVER (PARTITION BY ""employee_id"") AS ""num_depts"" FROM ""employee"") AS ""a"" WHERE ""primary_flag""='Y' OR ""num_depts""=1"
272,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
273,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
274,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
275,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
276,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
277,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
278,"WITH ""emp"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(1) OVER (PARTITION BY ""employee_id"") AS ""cnt"" FROM ""employee"") SELECT ""employee_id"",""department_id"" FROM ""emp"" WHERE (""primary_flag""='Y' AND ""cnt"">1) OR ""cnt""=1"
279,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
280,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
281,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR (""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employee"" WHERE ""primary_flag""='Y'))"
282,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
283,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
284,"SELECT ""T"".""employee_id"",""T"".""department_id"" FROM (SELECT *,COUNT(""employee_id"") OVER (PARTITION BY ""employee_id"") AS ""c"" FROM ""Employee"") AS ""T"" WHERE ""T"".""c""=1 OR ""T"".""primary_flag""='Y'"
285,"WITH ""lookup"" AS (SELECT ""employee_id"",""department_id"",COUNT(""department_id"") AS ""flag"" FROM ""Employee"" GROUP BY ""employee_id"") SELECT ""Employee"".""employee_id"",""Employee"".""department_id"" FROM ""Employee"" LEFT JOIN ""lookup"" ON ""Employee"".""employee_id""=""lookup"".""employee_id"" WHERE ""primary_flag""='Y' OR ""flag""=1"
286,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
287,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
288,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
289,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
290,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
291,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
292,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 ORDER BY ""employee_id"")"
293,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
294,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
295,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",SUM(1) OVER (PARTITION BY ""employee_id"") AS ""dept_cnt"" FROM ""employee"") AS ""x"" WHERE ""primary_flag""='Y' OR ""dept_cnt""=1 ORDER BY 1"
296,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
297,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='N' AND ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY 1 HAVING COUNT(1)=1)"
298,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rnk"" FROM ""employee"") SELECT ""employee_id"",""department_id"" FROM ""cte"" WHERE ""rnk""=1"
299,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""r"" FROM ""employee"") SELECT ""employee_id"",""department_id"" FROM ""cte"" WHERE ""r""=1"
300,"SELECT ""employee_id"",CASE WHEN COUNT(1)=1 THEN ""department_id"" ELSE SUM(CASE WHEN ""primary_flag""='Y' THEN ""department_id"" ELSE 0 END) END AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"""
301,"WITH ""dept"" AS (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) SELECT ""dept"".""employee_id"",""e1"".""department_id"" FROM ""employee"" AS ""e1"" JOIN ""dept"" ON ""e1"".""employee_id""=""dept"".""employee_id"" UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
302,"SELECT ""employee_id"",MAX(""department_id"") AS ""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
303,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""Department_id"")=1)"
304,"SELECT DISTINCT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION ALL SELECT DISTINCT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT DISTINCT ""employee_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
305,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1) UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
306,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
307,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
308,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1)"
309,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM (SELECT ""employee_id"",COUNT(""department_id"") AS ""dpt_count"" FROM ""Employee"" GROUP BY ""employee_id"") AS ""DptCount"" WHERE ""dpt_count""=1)"
310,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
311,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""_rank"" FROM ""Employee"") AS ""tbl"" WHERE ""tbl"".""_rank""=1"
312,"WITH ""temp"" AS (SELECT *,COUNT(""department_id"") AS ""cnt"" FROM ""employee"" GROUP BY ""employee_id""), ""temp1"" AS (SELECT ""employee_id"",""department_id"" FROM ""temp"" WHERE ""cnt""=1), ""temp2"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') SELECT * FROM ""temp1"" UNION SELECT * FROM ""temp2"""
313,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
314,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
315,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
316,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
317,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
318,"WITH ""cte"" AS (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""employee_id"") OVER (PARTITION BY ""employee_id"") AS ""counter"" FROM ""Employee"") SELECT ""employee_id"",""department_id"" FROM ""cte"" WHERE ""counter""=1 UNION SELECT ""employee_id"",""department_id"" FROM ""cte"" WHERE ""counter"">1 AND ""primary_flag""='Y'"
319,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='N' AND ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
320,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
321,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
322,"(SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT DISTINCT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) ORDER BY ""employee_id"""
323,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1 UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'"
324,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",DENSE_RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""rk"" FROM ""Employee"" AS ""e"") AS ""temp"" WHERE ""rk""=1"
325,"(SELECT ""a"".""employee_id"",""b"".""department_id"" FROM (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) AS ""a"" LEFT JOIN ""Employee"" AS ""b"" ON ""a"".""employee_id""=""b"".""employee_id"") UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y')"
326,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) ORDER BY ""employee_id"""
327,"WITH ""t1"" AS (SELECT *,(SELECT CASE WHEN COUNT(DISTINCT ""department_id"")=1 THEN 1 ELSE 0 END FROM ""Employee"" AS ""e2"" WHERE ""e2"".""employee_id""=""e1"".""employee_id"") AS ""only_in_one_department"" FROM ""Employee"" AS ""e1""), ""t2"" AS (SELECT ""employee_id"",""department_id"" FROM ""t1"" WHERE ""primary_flag""='Y' OR ""only_in_one_department"") SELECT * FROM ""t2"""
328,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",RANK() OVER (PARTITION BY ""employee_id"" ORDER BY ""primary_flag"") AS ""flag_rank"" FROM ""employee"") AS ""t"" WHERE ""flag_rank""=1"
329,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
330,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1) OR ""primary_flag""='Y'"
331,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
332,"WITH ""CTE"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION ALL SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) SELECT DISTINCT ""employee_id"",""department_id"" FROM ""CTE"""
333,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
334,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
335,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
336,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
337,"WITH ""temp1"" AS (SELECT ""employee_id"",""department_id"",COUNT(""employee_id"") AS ""cnt"" FROM ""Employee"" GROUP BY 1), ""temp2"" AS (SELECT * FROM ""employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""temp1"" WHERE ""cnt""=1) AND ""primary_flag""='Y') (SELECT ""employee_id"",""department_id"" FROM ""temp1"" WHERE ""cnt""=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""temp2"")"
338,"SELECT ""e1"".""employee_id"",""e1"".""department_id"" FROM ""Employee"" AS ""e1"" LEFT JOIN (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(""employee_id"") AS ""cnt"" FROM ""Employee"" GROUP BY ""employee_id"") AS ""e2"" ON ""e1"".""employee_id""=""e2"".""employee_id"" WHERE ""e1"".""primary_flag""='Y' OR ""e2"".""cnt""=1"
339,"SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(""department_id"")=1 UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
340,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM (SELECT ""employee_id"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY ""employee_id"") AS ""t1"" WHERE ""cnt""=1)"
341,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM ""EMPLOYEE"" WHERE ""PRIMARY_FLAG""='Y' OR ""EMPLOYEE_ID"" IN (SELECT ""EMPLOYEE_ID"" FROM ""EMPLOYEE"" GROUP BY ""EMPLOYEE_ID"" HAVING COUNT(1)=1)"
342,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
343,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
344,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' GROUP BY ""employee_id"" UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1"
345,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1)"
346,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM (SELECT ""employee_id"",COUNT(""department_id"") AS ""count"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1) AS ""d"")"
347,"SELECT ""employee_id"",""department_id"" FROM (SELECT *,COUNT(""employee_id"") OVER (PARTITION BY ""employee_id"") AS ""c"" FROM ""Employee"") AS ""t"" WHERE ""c""=1 OR ""primary_flag""='Y'"
348,"(SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""department_id"")=1) UNION (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y')"
349,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
350,"WITH ""y"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'), ""n"" AS (SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""y"")) SELECT DISTINCT ""employee_id"",""department_id"" FROM ""y"" UNION SELECT DISTINCT ""employee_id"",""department_id"" FROM ""n"""
351,"SELECT ""a"".""employee_id"",""a"".""department_id"" FROM (SELECT ""e1"".""employee_id"",""e1"".""department_id"",CASE WHEN ""e2"".""primary_flag"" IS NULL THEN 'null' ELSE ""e2"".""primary_flag"" END AS ""primary_flag_v1"" FROM ""Employee"" AS ""e1"" LEFT JOIN ""Employee"" AS ""e2"" ON ""e1"".""employee_id""=""e2"".""employee_id"" AND ""e1"".""department_id""!=""e2"".""department_id"" AND ""e1"".""primary_flag""!='Y') AS ""a"" WHERE ""a"".""primary_flag_v1""='null'"
352,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1"
353,"SELECT ""employee_id"",""department_id"" FROM (SELECT ""employee_id"",""department_id"",""primary_flag"",COUNT(1) OVER (PARTITION BY ""employee_id"") AS ""cnt"" FROM ""Employee"") AS ""t"" WHERE ""cnt""=1 OR (""cnt"">1 AND ""primary_flag""='Y')"
354,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(1)=1) ORDER BY ""employee_id"""
355,"SELECT ""EMPLOYEE_ID"",""DEPARTMENT_ID"" FROM (SELECT *,COUNT(""EMPLOYEE_ID"") OVER (PARTITION BY ""EMPLOYEE_ID"") AS ""C"" FROM ""EMPLOYEE"") AS ""T"" WHERE ""C""=1 OR ""PRIMARY_FLAG""='Y'"
356,"SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""employee_id"" IN (SELECT ""employee_id"" FROM ""employee"" GROUP BY 1 HAVING COUNT(DISTINCT ""department_id"")=1) UNION SELECT ""employee_id"",""department_id"" FROM ""employee"" WHERE ""primary_flag""='Y'"
357,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""a"".""employee_id"",""a"".""department_id"" FROM ""employee"" AS ""a"" JOIN (SELECT ""employee_id"" FROM ""employee"" GROUP BY ""employee_id"" HAVING SUM(1)=1) AS ""b"" ON ""a"".""employee_id""=""b"".""employee_id"""
358,"SELECT DISTINCT ""E1"".""employee_id"",COALESCE(""E2"".""department_id"", ""E1"".""department_id"") AS ""department_id"" FROM ""Employee"" AS ""E1"" LEFT JOIN ""Employee"" AS ""E2"" ON ""E1"".""employee_id""=""E2"".""employee_id"" AND ""E1"".""primary_flag""='N' AND ""E2"".""primary_flag""='Y'"
359,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' UNION SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""employee_id"")=1"
360,"SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y' OR ""employee_id"" IN (SELECT ""employee_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(DISTINCT ""primary_flag"")=1)"
361,"WITH ""E1"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y'), ""E2"" AS (SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""employee_id"" NOT IN (SELECT ""employee_id"" FROM ""E1"")) SELECT ""employee_id"",""department_id"" FROM ""E1"" UNION ALL SELECT ""employee_id"",""department_id"" FROM ""E2"""
362,"(SELECT ""employee_id"",""department_id"" FROM ""Employee"" WHERE ""primary_flag""='Y') UNION (SELECT ""employee_id"",""department_id"" FROM ""Employee"" GROUP BY ""employee_id"" HAVING COUNT(""department_id"")=1)"
