id,original query
1,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""amount"")=7"
2,"SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",RANK() OVER (ORDER BY ""visited_on"") AS ""ranking"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""ranking"">=7"
3,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
4,"SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"" LIMIT 100000 OFFSET 6"
5,"WITH ""t1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""t2"" AS (SELECT MAX(""visited_on"") AS ""visited_on"" FROM ""Customer""), ""t3"" AS (SELECT ""visited_on"" + INTERVAL '6 DAY' AS ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 0 PRECEDING AND 6 FOLLOWING) AS ""amount"" FROM ""t1"") SELECT ""t3"".""visited_on"",""t3"".""amount"",ROUND((""t3"".""amount""/7), 2) AS ""average_amount"" FROM (""t3"") JOIN ""t2"" WHERE ""t3"".""visited_on""<=""t2"".""visited_on"""
6,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
7,"WITH ""DayTotal"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on""), ""WeekMovingTotal"" AS (SELECT ""visited_on"",ROW_NUMBER() OVER () AS ""Seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""WeekSumTotal"" FROM ""DayTotal"") SELECT ""visited_on"",""WeekSumTotal"" AS ""amount"",ROUND(""WeekSumTotal""/7, 2) AS ""average_amount"" FROM ""WeekMovingTotal"" WHERE ""Seq"">6"
8,"WITH ""subt"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1 ORDER BY 2 DESC) SELECT ""visited_on"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL '6' DAY PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""subt"" LIMIT 17899009887789 OFFSET 6"
9,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""last6"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"" FROM ""cte"") AS ""k"" WHERE ""last6"" IS NOT NULL"
10,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""CTE2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rm"" FROM ""CTE"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""CTE2"" WHERE ""rm"">6"
11,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
12,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND((SUM(""b"".""amount"")/7), 2) AS ""average_amount"" FROM (""cte"" AS ""a"") JOIN ""cte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY 1 HAVING COUNT(""b"".""visited_on"")=7 ORDER BY 1"
13,"WITH ""temp0"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""temp"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_seven"",COUNT(""visited_on"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""count_seven"" FROM ""temp0"") SELECT ""visited_on"",SUM(""sum_seven"") AS ""amount"",ROUND(SUM(""sum_seven"")/7, 2) AS ""average_amount"" FROM ""temp"" WHERE ""count_seven""=7 GROUP BY ""visited_on"" ORDER BY ""visited_on"""
14,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",COUNT(""visited_on"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""co"" FROM ""cte"") AS ""c"" WHERE ""co"">=7"
15,"WITH ""amount"" AS (SELECT ""visited_on"",SUM(""total_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""sub"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""amount"" GROUP BY ""visited_on"" LIMIT 100 OFFSET 6"
16,"WITH ""x"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amt"" FROM ""customer"" GROUP BY 1 ORDER BY 1) SELECT ""visited_on"",ROUND(""amount"", 2) AS ""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amt"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amt"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""x"" FROM ""x"" GROUP BY 1) AS ""y"" WHERE ""visited_on""-""x"" IS NOT NULL ORDER BY 1"
17,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""row_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""row_num"">=7"
18,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
19,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(SUM(""amount"")) OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 2000 OFFSET 6"
20,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM (""Customer"" AS ""a"") JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" WHERE ""b"".""visited_on"" - ""a"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""b"".""visited_on"" HAVING COUNT(DISTINCT ""a"".""visited_on"")=7"
21,"WITH ""DailySales"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""MovingTotal"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""Rn"" FROM ""DailySales"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""MovingTotal"" WHERE ""Rn"">6 ORDER BY 1"
22,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"",ROW_NUMBER() OVER () AS ""number"" FROM (SELECT DISTINCT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"" FROM ""Customer"") AS ""s1"") AS ""s2"" WHERE ""number"">=7"
23,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM (""Customer"" AS ""a"") JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" WHERE ""b"".""visited_on"" - ""a"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""b"".""visited_on"" HAVING COUNT(DISTINCT ""a"".""visited_on"")=7"
24,"WITH ""cal"" AS (SELECT DISTINCT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""Customer"") SELECT * FROM ""cal"" WHERE ""visited_on"">=(SELECT ""visited_on"" FROM ""Customer"" ORDER BY 1 LIMIT 1)+6 ORDER BY 1"
25,"WITH ""daily_spend"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""Sales"",MIN(""visited_on"") AS ""f_date"" FROM ""Customer"" GROUP BY ""visited_on""), ""full_set"" AS (SELECT ""visited_on"",SUM(""Sales"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""Sales"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""daily_spend"") SELECT * FROM ""full_set"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""Customer"") + INTERVAL '6 DAY'"
26,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
27,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER () AS ""ranking"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""ranking"">=7"
28,"WITH ""date_order"" AS (SELECT DISTINCT ""c1"".""visited_on"" AS ""start_date"",""c2"".""visited_on"" AS ""end_date"" FROM ""Customer"" AS ""c1"" LEFT JOIN ""Customer"" AS ""c2"" ON ""c2"".""visited_on""=""c1"".""visited_on"" + INTERVAL '6 DAY') SELECT ""end_date"" AS ""visited_on"",SUM(""amount"") AS ""amount"",ROUND(SUM(""amount"")/7, 2) AS ""average_amount"" FROM ""Customer"" AS ""c"" JOIN ""date_order"" AS ""d"" ON ""visited_on"" BETWEEN ""start_date"" AND ""end_date"" GROUP BY ""start_date"",""end_date"" ORDER BY ""visited_on"""
29,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""tot_amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""avg_amount"",ROW_NUMBER() OVER () AS ""seq"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") SELECT ""visited_on"",""tot_amount"" AS ""amount"",ROUND(""avg_amount"", 2) AS ""average_amount"" FROM ""cte"" WHERE ""seq"">6"
30,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
31,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
32,"SELECT ""visited_on"",""window_amount"" AS ""amount"",ROUND(""window_amount""/7.0, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""lag_visited_on"",SUM(""sum_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""window_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""sum_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""tab"") AS ""tab1"" WHERE ""lag_visited_on"" IS NOT NULL"
33,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",(CASE WHEN ROW_NUMBER() OVER (ORDER BY ""visited_on"")>6 THEN SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) ELSE NULL END) AS ""amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""x1"") AS ""x2"" WHERE ""amount"" IS NOT NULL ORDER BY ""visited_on"""
34,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""cte_1"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""date_order"" FROM ""cte"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte_1"" WHERE ""date_order"">=7"
35,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
36,"WITH ""day"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""t1"".""visited_on"" AS ""visited_on"",SUM(""t2"".""day_sum"") AS ""amount"",ROUND(AVG(""t2"".""day_sum""), 2) AS ""average_amount"" FROM ""day"" AS ""t1"" JOIN ""day"" AS ""t2"" ON ""t1"".""visited_on"" - ""t2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""t1"".""visited_on"" HAVING COUNT(""t2"".""visited_on"")=7"
37,"WITH ""c"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (""c"" AS ""c1"") JOIN ""c"" AS ""c2"" WHERE ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7"
38,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount1"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY 1), ""t2"" AS (SELECT *,SUM(""amount1"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount1"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""cte"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""t2"" WHERE ""rn"">6"
39,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6"
40,"WITH ""c1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1), ""c2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""c1"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""c2"" WHERE ""rn"">6 ORDER BY 1"
41,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""lag_log"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"" FROM ""cte"") AS ""abc"" WHERE ""lag_log"" IS NOT NULL"
42,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL '6' DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""date_rank"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""CTE"" WHERE ""date_rank"">6 ORDER BY ""visited_on"""
43,"WITH ""t1"" AS (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""lagged_date"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",""lagged_date"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 0) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""t1"") AS ""t2"" WHERE ""visited_on""-""lagged_date"" IS NOT NULL"
44,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""c7"".""visited_on"",(""c1"".""amount""+""c2"".""amount""+""c3"".""amount""+""c4"".""amount""+""c5"".""amount""+""c6"".""amount""+""c7"".""amount"") AS ""amount"",ROUND((""c1"".""amount""+""c2"".""amount""+""c3"".""amount""+""c4"".""amount""+""c5"".""amount""+""c6"".""amount""+""c7"".""amount"")/7, 2) AS ""average_amount"" FROM ((((((""cte"" AS ""c1"") JOIN ""cte"" AS ""c2"") JOIN ""cte"" AS ""c3"") JOIN ""cte"" AS ""c4"") JOIN ""cte"" AS ""c5"") JOIN ""cte"" AS ""c6"") JOIN ""cte"" AS ""c7"" WHERE ""c1"".""visited_on""=""c2"".""visited_on"" - INTERVAL '1 DAY' AND ""c2"".""visited_on""=""c3"".""visited_on"" - INTERVAL '1 DAY' AND ""c3"".""visited_on""=""c4"".""visited_on"" - INTERVAL '1 DAY' AND ""c4"".""visited_on""=""c5"".""visited_on"" - INTERVAL '1 DAY' AND ""c5"".""visited_on""=""c6"".""visited_on"" - INTERVAL '1 DAY' AND ""c6"".""visited_on""=""c7"".""visited_on"" - INTERVAL '1 DAY' ORDER BY 1"
45,"WITH ""cte2"" AS (SELECT DISTINCT ""visited_on"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW)) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""customer"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""rnk"">6"
46,"WITH ""cte2"" AS (SELECT DISTINCT ""visited_on"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND INTERVAL 0 DAY FOLLOWING)) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND INTERVAL 0 DAY FOLLOWING)/7, 2) AS ""average_amount"" FROM ""customer"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""rnk"">6"
47,"SELECT ""C1"".""visited_on"",SUM(""C2"".""amount"") AS ""amount"",ROUND(SUM(""C2"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""C1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""C2"" ON ""C1"".""visited_on"" - ""C2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""C1"".""visited_on"" HAVING COUNT(DISTINCT ""C2"".""visited_on"")=7 ORDER BY ""C1"".""visited_on"""
48,"SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(SUM(""b"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT DISTINCT ""visited_on"" FROM ""Customer"" WHERE ""visited_on"" IN (SELECT ""visited_on"" + INTERVAL '6 DAY' FROM ""Customer"")) AS ""a"" LEFT JOIN ""Customer"" AS ""b"" ON ""b"".""visited_on"" BETWEEN ""a"".""visited_on"" - INTERVAL '6 DAY' AND ""a"".""visited_on"" GROUP BY 1"
49,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""r"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",""visited_on"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"" WHERE ""r"">6"
50,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
51,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""ranks"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""Customer"" GROUP BY 1 ORDER BY 1) AS ""tem"") AS ""tem1"" WHERE ""ranks"">=7"
52,"WITH ""t1"" AS (SELECT ""visited_on"",SUM(""t"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""t"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""t1"" WHERE ""rnk"">6"
53,"WITH ""first_day"" AS (SELECT MIN(""visited_on"") FROM ""customer"") SELECT ""c1"".""visited_on"",ROUND((SELECT SUM(""c2"".""amount"") FROM ""customer"" AS ""c2"" WHERE ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6), 2) AS ""amount"",ROUND((SELECT SUM(""c3"".""amount"")/COUNT(DISTINCT ""c3"".""visited_on"") FROM ""customer"" AS ""c3"" WHERE ""c1"".""visited_on"" - ""c3"".""visited_on"" BETWEEN 0 AND 6), 2) AS ""average_amount"" FROM ""customer"" AS ""c1"" WHERE ""c1"".""visited_on"">(SELECT * FROM ""first_day"")+5 GROUP BY 1 ORDER BY 1"
54,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""a"".""visited_on"",(SELECT SUM(""b"".""total_amount"") FROM ""cte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6) AS ""amount"",(SELECT ROUND(SUM(""b"".""total_amount"")/7, 2) FROM ""cte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6) AS ""average_amount"" FROM ""cte"" AS ""a"" WHERE ""a"".""visited_on""-(SELECT MIN(""visited_on"") FROM ""cte"")>=6"
55,"SELECT ""cs"".""visited_on"" AS ""visited_on"",(SELECT SUM(""amount"") FROM ""customer"" AS ""cs1"" WHERE ""cs"".""visited_on"" - ""cs1"".""visited_on"" BETWEEN 0 AND 6) AS ""amount"",(SELECT ROUND(SUM(""amount"")/7, 2) FROM ""customer"" AS ""cs2"" WHERE ""cs"".""visited_on"" - ""cs2"".""visited_on"" BETWEEN 0 AND 6) AS ""average_amount"" FROM ""customer"" AS ""cs"" GROUP BY ""cs"".""visited_on"" HAVING ""cs"".""visited_on"">=(SELECT MIN(""cs3"".""visited_on"") FROM ""customer"" AS ""cs3"") + INTERVAL '6 DAY'"
56,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"" WHERE ""rn"">=7"
57,"SELECT ""visited_on"",""window_amount"" AS ""amount"",ROUND(""window_amount""/7.0, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""lag_visited_on"",SUM(""sum_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""window_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""sum_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""tab"") AS ""tab1"" WHERE ""lag_visited_on"" IS NOT NULL"
58,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
59,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
60,"WITH ""tmp"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""ttl"",COUNT(1) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""cnt"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) AS ""t"" ORDER BY 1) SELECT ""visited_on"",""ttl"" AS ""amount"",ROUND(""ttl""/7, 2) AS ""average_amount"" FROM ""tmp"" WHERE ""cnt""=7 ORDER BY 1"
61,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""date_ranking"",SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte"") AS ""sub"" WHERE ""date_ranking"">=7"
62,"WITH ""temp0"" AS (SELECT ""name"",""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""temp"" AS (SELECT ""c"".""visited_on"",""c"".""amount""+""d1"".""amount""+""d2"".""amount""+""d3"".""amount""+""d4"".""amount""+""d5"".""amount""+""d6"".""amount"" AS ""amount"",ROUND((""c"".""amount""+""d1"".""amount""+""d2"".""amount""+""d3"".""amount""+""d4"".""amount""+""d5"".""amount""+""d6"".""amount"")/7, 2) AS ""average_amount"" FROM (((((""temp0"" AS ""c"" LEFT JOIN ""temp0"" AS ""d1"" ON ""c"".""visited_on"" - ""d1"".""visited_on""=1) LEFT JOIN ""temp0"" AS ""d2"" ON ""c"".""visited_on"" - ""d2"".""visited_on""=2) LEFT JOIN ""temp0"" AS ""d3"" ON ""c"".""visited_on"" - ""d3"".""visited_on""=3) LEFT JOIN ""temp0"" AS ""d4"" ON ""c"".""visited_on"" - ""d4"".""visited_on""=4) LEFT JOIN ""temp0"" AS ""d5"" ON ""c"".""visited_on"" - ""d5"".""visited_on""=5) LEFT JOIN ""temp0"" AS ""d6"" ON ""c"".""visited_on"" - ""d6"".""visited_on""=6) SELECT * FROM ""temp"" WHERE ""average_amount"" IS NOT NULL ORDER BY ""visited_on"""
63,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""r1"".""visited_on"",SUM(""r2"".""amount"") AS ""amount"",ROUND(SUM(""r2"".""amount"")/7, 2) AS ""average_amount"" FROM ""CTE"" AS ""r1"" JOIN ""CTE"" AS ""r2"" ON ""r1"".""visited_on"" - ""r2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""r1"".""visited_on"" HAVING COUNT(DISTINCT ""r2"".""visited_on"")>=7 ORDER BY ""r1"".""visited_on"""
64,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND((SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7), 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte"" WHERE ""rnk"">6 ORDER BY ""visited_on"""
65,"WITH ""CTE"" AS (SELECT DISTINCT TO_CHAR(""visited_on"", 'YYYY-%m-%d') AS ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""d_rank"" FROM ""Customer"") SELECT ""visited_on"",""amount"",ROUND(SUM(""amount""/7), 2) AS ""average_amount"" FROM ""CTE"" WHERE ""d_rank"">=7 GROUP BY 1"
66,"WITH ""t1"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""visit_rank"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""visit_rank"" FROM ""Customer"" GROUP BY 1) AS ""t"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""t1"" WHERE ""visit_rank"">6"
67,"WITH ""cte"" AS (SELECT ""visited_on"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",""rnk"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""cte"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""rnk"">6"
68,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 WHERE ""c1"".""visited_on"" - INTERVAL '6 DAY'>=(SELECT MIN(""visited_on"") FROM ""customer"") GROUP BY ""c1"".""visited_on"""
69,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""Customer"" GROUP BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""rn"" FROM ""cte"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""rn"">6"
70,"WITH ""daily_total"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""customer"" GROUP BY ""visited_on""), ""moving_average"" AS (SELECT ""visited_on"",""total"",SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""ascd"" FROM ""daily_total"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM ""moving_average"" WHERE ""ascd"" IS NOT NULL"
71,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
72,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""a_date"" AS ""visited_on"",SUM(""b_amount"") AS ""amount"",ROUND((SUM(""b_amount"")/7), 2) AS ""average_amount"" FROM (SELECT ""a"".""visited_on"" AS ""a_date"",""b"".""visited_on"" AS ""b_date"",""a"".""amount"" AS ""a_amount"",""b"".""amount"" AS ""b_amount"" FROM (""cte"" AS ""a"") JOIN ""cte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6) AS ""t1"" GROUP BY 1 HAVING COUNT(""b_date"")=7 ORDER BY 1"
73,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
74,"SELECT ""A"".""visited_on"" AS ""visited_on"",SUM(""B"".""day_sum"") AS ""amount"",ROUND(AVG(""B"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""B"" WHERE ""A"".""visited_on"" - ""B"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""A"".""visited_on"" HAVING COUNT(""B"".""visited_on"")=7"
75,"WITH ""temp0"" AS (SELECT ""name"",""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""temp"" AS (SELECT ""c"".""visited_on"",""c"".""amount""+""d1"".""amount""+""d2"".""amount""+""d3"".""amount""+""d4"".""amount""+""d5"".""amount""+""d6"".""amount"" AS ""amount"",ROUND((""c"".""amount""+""d1"".""amount""+""d2"".""amount""+""d3"".""amount""+""d4"".""amount""+""d5"".""amount""+""d6"".""amount"")/7, 2) AS ""average_amount"" FROM (((((""temp0"" AS ""c"" LEFT JOIN ""temp0"" AS ""d1"" ON ""c"".""visited_on"" - ""d1"".""visited_on""=1) LEFT JOIN ""temp0"" AS ""d2"" ON ""c"".""visited_on"" - ""d2"".""visited_on""=2) LEFT JOIN ""temp0"" AS ""d3"" ON ""c"".""visited_on"" - ""d3"".""visited_on""=3) LEFT JOIN ""temp0"" AS ""d4"" ON ""c"".""visited_on"" - ""d4"".""visited_on""=4) LEFT JOIN ""temp0"" AS ""d5"" ON ""c"".""visited_on"" - ""d5"".""visited_on""=5) LEFT JOIN ""temp0"" AS ""d6"" ON ""c"".""visited_on"" - ""d6"".""visited_on""=6) SELECT * FROM ""temp"" WHERE ""average_amount"" IS NOT NULL ORDER BY ""visited_on"""
76,"SELECT ""c1"".""visited_on"",ROUND(SUM(""c2"".""day_amount""), 2) AS ""amount"",ROUND(AVG(""c2"".""day_amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_amount"" FROM ""Customer"" GROUP BY 1) AS ""c1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""day_amount"" FROM ""Customer"" GROUP BY 1) AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY 1 HAVING COUNT(""c2"".""visited_on"")=7"
77,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""total_amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""row_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") SELECT ""visited_on"",""total_amount"" AS ""amount"",""average"" AS ""average_amount"" FROM ""cte"" WHERE ""row_num"">=7"
78,"SELECT * FROM (SELECT ""visited_on"",(CASE WHEN ROW_NUMBER() OVER (ORDER BY ""visited_on"")>6 THEN SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) ELSE NULL END) AS ""amount"",ROUND(CASE WHEN ROW_NUMBER() OVER (ORDER BY ""visited_on"")>6 THEN AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) ELSE NULL END, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""tmp2"") AS ""tmp"" WHERE ""average_amount"" IS NOT NULL ORDER BY ""visited_on"""
79,"WITH ""ct"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (""ct"" AS ""c1"") JOIN ""ct"" AS ""c2"" WHERE ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7"
80,"WITH ""t"" AS (SELECT ""visited_on"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""t"" WHERE ""rn"">=7"
81,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
82,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""p_days"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""p_days"" IS NOT NULL"
83,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
84,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND((SUM(""b"".""amount"")/7), 2) AS ""average_amount"" FROM (""cte"" AS ""a"") JOIN ""cte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY 1 HAVING COUNT(""b"".""visited_on"")=7 ORDER BY 1"
85,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER () AS ""ranking"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""ranking"">=7"
86,"SELECT ""a"".""visited_on"",""a"".""amount"",ROUND(""a"".""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""cust_rank"" FROM ""customer"" GROUP BY 1) AS ""a"" WHERE ""cust_rank"">6"
87,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""rn"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""rn"">=7"
88,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"">=0 AND ""c1"".""visited_on"" - ""c2"".""visited_on""<7 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7 ORDER BY ""c1"".""visited_on"""
89,"WITH ""cte1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",LAG(""visited_on"", 6, 0) OVER (ORDER BY ""visited_on"") AS ""temp"" FROM ""cte1"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""temp""!=0"
90,"SELECT ""cs"".""visited_on"" AS ""visited_on"",(SELECT SUM(""amount"") FROM ""customer"" AS ""cs1"" WHERE ""cs"".""visited_on"" - ""cs1"".""visited_on"" BETWEEN 0 AND 6) AS ""amount"",(SELECT ROUND(SUM(""amount"")/7, 2) FROM ""customer"" AS ""cs2"" WHERE ""cs"".""visited_on"" - ""cs2"".""visited_on"" BETWEEN 0 AND 6) AS ""average_amount"" FROM ""customer"" AS ""cs"" GROUP BY ""cs"".""visited_on"" HAVING ""cs"".""visited_on"">=(SELECT MIN(""cs3"".""visited_on"") FROM ""customer"" AS ""cs3"") + INTERVAL '6 DAY'"
91,"WITH ""W"" AS (SELECT ""VISITED_ON"",SUM(""AMOUNT"") AS ""SUM_A"" FROM ""CUSTOMER"" GROUP BY ""VISITED_ON"") SELECT ""W1"".""VISITED_ON"",SUM(""W2"".""SUM_A"") AS ""AMOUNT"",ROUND(SUM(""W2"".""SUM_A"")/7, 2) AS ""AVERAGE_AMOUNT"" FROM ""W"" AS ""W1"" JOIN ""W"" AS ""W2"" ON ""W1"".""VISITED_ON"" - ""W2"".""VISITED_ON""<=6 AND ""W1"".""VISITED_ON"" - ""W2"".""VISITED_ON"">=0 GROUP BY ""W1"".""VISITED_ON"" HAVING COUNT(""W1"".""VISITED_ON"")=7"
92,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
93,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
94,"WITH ""res"" AS (SELECT DISTINCT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""res"" WHERE ""rnk"">=7"
95,"WITH ""dates"" AS (SELECT * FROM (SELECT ""visited_on"",LEAD(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""end_date"" FROM (SELECT DISTINCT ""visited_on"" FROM ""customer"") AS ""a"") AS ""b"" WHERE ""b"".""end_date"" IS NOT NULL) SELECT ""d"".""end_date"" AS ""visited_on"",SUM(""c"".""amount"") AS ""amount"",ROUND(SUM(""c"".""amount"")/7, 2) AS ""average_amount"" FROM (""customer"" AS ""c"") JOIN ""dates"" AS ""d"" WHERE ""c"".""visited_on"">=""d"".""visited_on"" AND ""c"".""visited_on""<=""d"".""end_date"" GROUP BY ""d"".""end_date"""
96,"WITH ""ranking"" AS (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""ranking"" WHERE ""rnk"">6 ORDER BY ""visited_on"""
97,"WITH ""daily_sum"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",COUNT(""visited_on"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""win_len"" FROM ""daily_sum"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""cte"" WHERE ""win_len""=7"
98,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
99,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amt"" FROM ""Customer"" GROUP BY 1 ORDER BY 1) SELECT ""a"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT DISTINCT ""visited_on"" FROM ""Customer"" WHERE ""visited_on"" BETWEEN (SELECT MIN(""visited_on"") + INTERVAL '6 DAY' FROM ""Customer"") AND (SELECT MAX(""visited_on"") FROM ""Customer"")) AS ""a"" LEFT JOIN (SELECT ""visited_on"",(SUM(""amt"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)) AS ""amount"",ROUND(AVG(""amt"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""cte"") AS ""b"" ON ""a"".""visited_on""=""b"".""visited_on"""
100,"WITH ""tem"" AS (SELECT ""customer_id"",""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",MIN(""visited_on"") OVER (ORDER BY ""visited_on"") AS ""min_date"" FROM ""tem"") AS ""a"" WHERE ""visited_on"">=""min_date"" + INTERVAL '6 DAY'"
101,"WITH ""date_table"" AS (SELECT DISTINCT ""visited_on"" FROM ""Customer"" WHERE ""visited_on"" - (SELECT MIN(""visited_on"") FROM ""Customer"")>=6) SELECT ""D"".""visited_on"",SUM(""C"".""amount"") AS ""amount"",ROUND(SUM(""C"".""amount"")/7, 2) AS ""average_amount"" FROM ""date_table"" AS ""D"" LEFT JOIN ""Customer"" AS ""C"" ON ""D"".""visited_on"" - ""C"".""visited_on"">=0 AND ""D"".""visited_on"" - ""C"".""visited_on""<7 GROUP BY ""D"".""visited_on"""
102,"WITH ""uns"" AS (SELECT DISTINCT ""visited_on"",SUM(""amount"") AS ""am"" FROM ""Customer"" GROUP BY 1), ""regr"" AS (SELECT DISTINCT ""visited_on"",SUM(""am"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""am"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""r"" FROM ""uns"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM ""regr"" WHERE ""r"">6"
103,"WITH ""customers1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1), ""average"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""total_by_day"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""avg_by_day"" FROM ""customers1"") SELECT ""a"".""visited_on"",""total_by_day"" AS ""amount"",""avg_by_day"" AS ""average_amount"" FROM ""average"" AS ""a"" JOIN ""customers1"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on""=6"
104,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(SUM(""c2"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""c1"" JOIN ""Customer"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY 1 HAVING COUNT(DISTINCT ""c2"".""visited_on"")=7"
105,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte"") AS ""t"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""Customer"")+6"
106,"SELECT ""t1"".""visited_on"",SUM(""t2"".""amount"") AS ""amount"",ROUND(AVG(""t2"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""t1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""t2"" ON ""t2"".""visited_on"" BETWEEN ""t1"".""visited_on"" - INTERVAL '6 DAY' AND ""t1"".""visited_on"" GROUP BY ""t1"".""visited_on"" HAVING COUNT(1)=7"
107,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""holder"" FROM ""cte"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""temp"" WHERE ""holder"">6"
108,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c1"", (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c2"" WHERE ""c1"".""visited_on""-""c2"".""visited_on"">=0 AND ""c1"".""visited_on""<=""c2"".""visited_on"" + INTERVAL '6 DAY' GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7"
109,"WITH ""cte1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""cte1"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND((""amount""/7), 2) AS ""average_amount"" FROM ""cte2"" WHERE ""rnk"">6"
110,"SELECT ""visited_on"",ROUND(""amount"", 2) AS ""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rowcnt"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"") AS ""t1"" WHERE ""rowcnt"">=7"
111,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""row_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""row_num"">=7"
112,"WITH ""tb1"" AS (SELECT DISTINCT ""visited_on"" FROM ""customer"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""customer"") + INTERVAL '6 DAY') SELECT ""tb1"".""visited_on"",SUM(""t2"".""amount"") AS ""amount"",ROUND(SUM(""t2"".""amount"")/7, 2) AS ""average_amount"" FROM ""tb1"" LEFT JOIN ""Customer"" AS ""t2"" ON ""tb1"".""visited_on""<=""t2"".""visited_on"" + INTERVAL '6 DAY' AND ""tb1"".""visited_on"">=""t2"".""visited_on"" GROUP BY ""tb1"".""visited_on"""
113,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""c"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""c"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) AS ""c"") AS ""t"" WHERE ""t"".""rn"">6"
114,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""cte"" GROUP BY ""visited_on"") AS ""a"" WHERE ""rnk"">=7"
115,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
116,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""amount"")=7"
117,"SELECT ""c1"".""visited_on"",SUM(""c2"".""total_amount"") AS ""amount"",ROUND(AVG(""c2"".""total_amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7 ORDER BY ""c1"".""visited_on"""
118,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000000 OFFSET 6"
119,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
120,"WITH ""datebased"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""daily_amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""temp"" AS (SELECT ""C1"".""visited_on"",SUM(""C2"".""daily_amount"") AS ""amount"",ROUND(AVG(""C2"".""daily_amount""), 2) AS ""average_amount"" FROM ""datebased"" AS ""C1"" JOIN ""datebased"" AS ""C2"" ON ""C1"".""visited_on"" - ""C2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""C1"".""visited_on"" HAVING COUNT(""C2"".""daily_amount"")>=7 ORDER BY ""C1"".""visited_on"") SELECT * FROM ""temp"""
121,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6"
122,"WITH ""CTE"" AS (SELECT ""VISITED_ON"",SUM(""AMOUNT"") AS ""DAILY_AMOUNT"" FROM ""CUSTOMER"" GROUP BY ""VISITED_ON"") SELECT ""VISITED_ON"",""AMOUNT"",""AVERAGE_AMOUNT"" FROM (SELECT ""VISITED_ON"",SUM(""DAILY_AMOUNT"") OVER (ORDER BY ""VISITED_ON"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""AMOUNT"",ROUND(AVG(""DAILY_AMOUNT"") OVER (ORDER BY ""VISITED_ON"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""AVERAGE_AMOUNT"",RANK() OVER (ORDER BY ""VISITED_ON"") AS ""RN"" FROM ""CTE"") AS ""T"" WHERE ""RN"">6"
123,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(SUM(""b"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(DISTINCT ""b"".""visited_on"")=7"
124,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""row_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""row_num"">=7"
125,"SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(AVG(""b"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"">=""b"".""visited_on"" AND ""a"".""visited_on""<=""b"".""visited_on"" + INTERVAL '6 DAY' AND ""a"".""visited_on"">=(SELECT MIN(""visited_on"") + INTERVAL '6 DAY' FROM ""customer"") GROUP BY ""a"".""visited_on"" ORDER BY ""a"".""visited_on"""
126,"WITH ""date_boundaries"" AS (SELECT DISTINCT ""c1"".""visited_on"" AS ""start_dt"",""c2"".""visited_on"" AS ""end_dt"" FROM ""customer"" AS ""c1"" JOIN ""customer"" AS ""c2"" ON ""c1"".""visited_on""<=""c2"".""visited_on"" AND ""c2"".""visited_on"" - ""c1"".""visited_on""=6) SELECT ""db"".""end_dt"" AS ""visited_on"",SUM(""c"".""amount"") AS ""amount"",ROUND(SUM(""c"".""amount"")/7, 2) AS ""average_amount"" FROM ""date_boundaries"" AS ""db"" JOIN ""customer"" AS ""c"" ON ""c"".""visited_on"" BETWEEN ""db"".""start_dt"" AND ""db"".""end_dt"" AND ""db"".""end_dt"" - ""c"".""visited_on""<=6 GROUP BY ""db"".""end_dt"""
127,"WITH ""temp"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY 1) SELECT ""t1"".""visited_on"",SUM(""t2"".""amount"") AS ""amount"",ROUND(SUM(""t2"".""amount"")/7, 2) AS ""average_amount"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""visited_on"">=""t2"".""visited_on"" AND ""t1"".""visited_on"" - INTERVAL '7 DAY'<""t2"".""visited_on"" WHERE ""t1"".""rnk"">=7 GROUP BY 1"
128,"WITH ""daily_revenue"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""daily_total"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""a"".""visited_on"",SUM(""b"".""daily_total"") AS ""amount"",ROUND(SUM(""b"".""daily_total"")/COUNT(1), 2) AS ""average_amount"" FROM (""daily_revenue"" AS ""a"") JOIN ""daily_revenue"" AS ""b"" WHERE ""b"".""visited_on""<=""a"".""visited_on"" AND ""b"".""visited_on"" + INTERVAL '6 DAY'>=""a"".""visited_on"" AND ""a"".""visited_on"" + INTERVAL '-6 DAY'>=(SELECT MIN(""visited_on"") FROM ""Customer"") GROUP BY ""a"".""visited_on"""
129,"WITH ""sum_table"" AS (SELECT DISTINCT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""days"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""sum_table"" WHERE ""days"">=7"
130,"SELECT ""visited_on"",""total"" AS ""amount"",ROUND(""total""/7, 2) AS ""average_amount"" FROM (SELECT *,RANK() OVER (ORDER BY ""visited_on"") AS ""rk"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""total"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""rk"">=7"
131,"SELECT DISTINCT ""visited_on"",(SELECT SUM(""amount"") FROM ""Customer"" WHERE ""visited_on"" BETWEEN ""c"".""visited_on"" - INTERVAL '6 DAY' AND ""c"".""visited_on"") AS ""amount"",ROUND((SELECT SUM(""amount"") FROM ""Customer"" WHERE ""visited_on"" BETWEEN ""c"".""visited_on"" - INTERVAL '6 DAY' AND ""c"".""visited_on"")/7, 2) AS ""average_amount"" FROM ""Customer"" AS ""c"" LIMIT 1000000000 OFFSET 6"
132,"WITH ""TEMP"" AS (SELECT ""VISITED_ON"",SUM(""AMOUNT"") OVER (ORDER BY ""VISITED_ON"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""AMOUNT"",AVG(""AMOUNT"") OVER (ORDER BY ""VISITED_ON"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""AVERAGE_AMOUNT"",RANK() OVER (ORDER BY ""VISITED_ON"") AS ""RNK"" FROM (SELECT ""VISITED_ON"",SUM(""AMOUNT"") AS ""AMOUNT"" FROM ""CUSTOMER"" GROUP BY ""VISITED_ON"") AS ""T"") SELECT ""VISITED_ON"",""AMOUNT"",ROUND(""AVERAGE_AMOUNT"", 2) AS ""AVERAGE_AMOUNT"" FROM ""TEMP"" WHERE ""RNK"">=7 ORDER BY 1"
133,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER () AS ""ranking"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""ranking"">=7"
134,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
135,"SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"" LIMIT 10000 OFFSET 6"
136,"WITH ""TEMP"" AS (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""Rank"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""TEMP"" WHERE ""TEMP"".""rank"">6 ORDER BY ""visited_on"""
137,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rn"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) AS ""sub1"" GROUP BY 1) AS ""sub"" WHERE ""rn"">=7 GROUP BY 1"
138,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
139,"SELECT ""visited_on"",""running_amount"" AS ""amount"",ROUND(""running_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""running_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rk"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) AS ""a"") AS ""b"" WHERE ""rk"">6 ORDER BY 1"
140,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
141,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""rn"">=7"
142,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6"
143,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
144,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""amount"")=7"
145,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",COUNT(1) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""co"" FROM ""cte"") AS ""c"" WHERE ""co"">=7"
146,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""con"" AS (SELECT ""cte"".""visited_on"",SUM(""cte"".""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""cte"".""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte""), ""top_six"" AS (SELECT ""c"".""visited_on"" FROM ""Customer"" AS ""c"" GROUP BY ""c"".""visited_on"" ORDER BY ""c"".""visited_on"" LIMIT 6) SELECT ""con"".""visited_on"",""con"".""amount"",""con"".""average_amount"" FROM ""con"" WHERE ""con"".""visited_on"" NOT IN (SELECT * FROM ""top_six"") ORDER BY ""con"".""visited_on"""
147,"SELECT ""Calendar"".""visited_on"",SUM(""amount"") AS ""amount"",ROUND(SUM(""amount"")/7, 2) AS ""average_amount"" FROM (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""Calendar"" LEFT JOIN ""Customer"" AS ""C2"" ON ""Calendar"".""visited_on"" - ""C2"".""visited_on""<7 AND ""Calendar"".""visited_on"" - ""C2"".""visited_on"">=0 GROUP BY ""Calendar"".""visited_on"" HAVING COUNT(DISTINCT ""C2"".""visited_on"")=7"
148,"WITH ""cte"" AS (SELECT ""customer_id"",""name"",""visited_on"",SUM(""amount"") AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""customer_id"",""rnk"",""name"",""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte"") AS ""a"" WHERE ""rnk"">6"
149,"SELECT ""temp1"".* FROM (SELECT ""temp"".""visited_on"",SUM(""temp"".""amount"") OVER (ORDER BY ""temp"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""temp"".""amount"") OVER (ORDER BY ""temp"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""c"".""visited_on"",SUM(""c"".""amount"") AS ""amount"" FROM ""Customer"" AS ""c"" GROUP BY 1 ORDER BY 1) AS ""temp"") AS ""temp1"" WHERE ""temp1"".""visited_on"" - (SELECT MIN(""visited_on"") FROM ""customer"")>=6"
150,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""a_date"" AS ""visited_on"",SUM(""b_amount"") AS ""amount"",ROUND((SUM(""b_amount"")/7), 2) AS ""average_amount"" FROM (SELECT ""a"".""visited_on"" AS ""a_date"",""b"".""visited_on"" AS ""b_date"",DENSE_RANK() OVER (ORDER BY ""a"".""visited_on"") AS ""ranks"",""a"".""amount"" AS ""a_amount"",""b"".""amount"" AS ""b_amount"" FROM (""cte"" AS ""a"") JOIN ""cte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6) AS ""t1"" WHERE ""ranks"">=7 GROUP BY 1 ORDER BY 1"
151,"SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW))/7 AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t1"") AS ""t2"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") + INTERVAL '6 DAY' FROM ""customer"")"
152,"SELECT ""visited_on"",""amount"",ROUND(""ma"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""ma"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
153,"WITH ""cte"" AS (SELECT ""customer_id"",""name"",""visited_on"",SUM(""amount"") AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""customer_id"",""rnk"",""name"",""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte"") AS ""a"" WHERE ""rnk"">6"
154,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""a"".""visited_on"",SUM(""b"".""total_amount"") AS ""amount"",ROUND(AVG(""b"".""total_amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")>=7"
155,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
156,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""cte1"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""avg_amount"",ROW_NUMBER() OVER () AS ""rk"" FROM ""cte"") SELECT ""visited_on"",""amount"",ROUND(""avg_amount"", 2) AS ""average_amount"" FROM ""cte1"" WHERE ""rk"">6"
157,"WITH ""cte1"" AS (SELECT ""c"".""visited_on"",SUM(""c"".""amount"") AS ""amount"",DENSE_RANK() OVER (ORDER BY ""c"".""visited_on"") AS ""rowid"" FROM ""Customer"" AS ""c"" GROUP BY 1 ORDER BY 1), ""cte2"" AS (SELECT ""c"".""visited_on"",SUM(""c"".""amount"") OVER (ORDER BY ""c"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM ""cte1"" AS ""c"") SELECT ""c"".""visited_on"",""c"".""amount"",ROUND(""c"".""amount""/7, 2) AS ""average_amount"" FROM ""cte2"" AS ""c"" WHERE ""c"".""visited_on"">=(SELECT ""visited_on"" FROM ""cte1"" WHERE ""rowid""=7)"
158,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
159,"SELECT ""a"".""visited_on"",SUM(""b"".""am"") AS ""amount"",ROUND(AVG(""b"".""am""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""am"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""am"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
160,"SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(AVG(""b"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7 ORDER BY ""a"".""visited_on"""
161,"WITH ""tbl1"" AS (SELECT ""c"".""visited_on"" AS ""first_visit"",""t"".""visited_on"" AS ""secondary"",""t"".""amount"" FROM (SELECT ""Customer"".""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""Customer"".""visited_on"") AS ""c"" JOIN ""Customer"" AS ""t"" ON ""c"".""visited_on"">=""t"".""visited_on"" WHERE ""t"".""visited_on"">=""c"".""visited_on"" - INTERVAL '6 DAY' ORDER BY ""c"".""visited_on"",""t"".""visited_on"") SELECT ""tbl1"".""first_visit"" AS ""visited_on"",SUM(""tbl1"".""amount"") AS ""amount"",ROUND(SUM(""tbl1"".""amount"")/7, 2) AS ""average_amount"" FROM ""tbl1"" GROUP BY ""tbl1"".""first_visit"" HAVING MIN(""tbl1"".""secondary"")<=""tbl1"".""first_visit"" - INTERVAL '6 DAY' ORDER BY ""tbl1"".""first_visit"""
162,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6"
163,"SELECT ""c2"".""visited_on"",SUM(""c1"".""amount"") AS ""amount"",ROUND(AVG(""c1"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c1"", (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c2"" WHERE ""c2"".""visited_on"" - ""c1"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c2"".""visited_on"" HAVING COUNT(DISTINCT ""c1"".""visited_on"")=7"
164,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"" FROM ""cte"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM ""cte2"" WHERE ""visited_on""-6>=(SELECT MIN(""visited_on"") FROM ""customer"")"
165,"WITH ""cte1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER () AS ""rk"" FROM ""cte1"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""cte2"" WHERE ""rk"">6"
166,"WITH ""CTE1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""mid_tot"" FROM ""customer"" GROUP BY ""visited_on""), ""CTE2"" AS (SELECT ""visited_on"",ROUND(SUM(""mid_tot"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(AVG(""mid_tot"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""CTE1"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""CTE2"" WHERE ""rnk"">6"
167,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000000 OFFSET 6"
168,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""d1"".""visited_on"",SUM(""d2"".""amount"") AS ""amount"",ROUND(AVG(""d2"".""amount""), 2) AS ""average_amount"" FROM ""CTE"" AS ""d1"" JOIN ""CTE"" AS ""d2"" ON ""d1"".""visited_on"" - ""d2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""d1"".""visited_on"" HAVING COUNT(DISTINCT ""d2"".""visited_on"")=7 ORDER BY 1"
169,"WITH ""cte"" AS (SELECT DISTINCT ""b"".""visited_on"" FROM ""customer"" AS ""a"" JOIN ""customer"" AS ""b"" ON ""a"".""visited_on"" + INTERVAL '6 DAY'=""b"".""visited_on"") SELECT ""cte"".""visited_on"" AS ""visited_on"",SUM(""amount"") AS ""amount"",ROUND(SUM(""amount"")/7, 2) AS ""average_amount"" FROM ""cte"" LEFT JOIN ""customer"" AS ""c"" ON ""cte"".""visited_on"" - ""c"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""visited_on"""
170,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",ROW_NUMBER() OVER () AS ""seq"" FROM ""cte"") AS ""F"" WHERE ""seq"">6"
171,"WITH ""a"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""r"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(SUM(""b"".""amount"")/7, 2) AS ""average_amount"" FROM ""a"" JOIN ""a"" AS ""b"" ON ""b"".""r"">=""a"".""r""-6 AND ""b"".""r""<=""a"".""r"" WHERE ""a"".""r"">=7 GROUP BY ""a"".""visited_on"""
172,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",ROUND(SUM(""total_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(SUM(""total_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""RNK"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""Temp"") AS ""Temp2"" WHERE ""RNK"">=7"
173,"WITH ""t1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""t2"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""t1"" ORDER BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""t2"" WHERE ""rnk"">6 ORDER BY 1"
174,"WITH ""raw_data"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL '6' DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL '6' DAY PRECEDING AND CURRENT ROW) AS ""num_rows"" FROM ""Customer"") SELECT DISTINCT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""raw_data"" WHERE ""num_rows"">=7 ORDER BY ""visited_on"""
175,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM ""customer"" AS ""a"" JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" ON ""b"".""visited_on"" - ""a"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""b"".""visited_on"" HAVING COUNT(DISTINCT ""a"".""visited_on"")=7"
176,"WITH ""temp0"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""temp"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_seven"",COUNT(""visited_on"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""count_seven"" FROM ""temp0"") SELECT ""visited_on"",SUM(""sum_seven"") AS ""amount"",ROUND(SUM(""sum_seven"")/7, 2) AS ""average_amount"" FROM ""temp"" WHERE ""count_seven""=7 GROUP BY ""visited_on"" ORDER BY ""visited_on"""
177,"WITH ""temp2"" AS (SELECT ""visited_on"",SUM(""daily_tot"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""daily_tot"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER () AS ""seq"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""daily_tot"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""temp"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""temp2"" WHERE ""seq"">6"
178,"SELECT DISTINCT ""C1"".""visited_on"",SUM(""C2"".""amount"") AS ""amount"",ROUND(SUM(""C2"".""amount"")/7, 2) AS ""average_amount"" FROM (""Customer"" AS ""C2"") JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""C1"" WHERE ""C1"".""visited_on"" - ""C2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""C1"".""visited_on"" HAVING COUNT(DISTINCT ""C2"".""visited_on"")>=7"
179,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"">=0 AND ""c1"".""visited_on"" - ""c2"".""visited_on""<7 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7 ORDER BY ""c1"".""visited_on"""
180,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
181,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"" WHERE ""rnk"">6 ORDER BY 1"
182,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY 1) AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY 1) AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY 1 HAVING COUNT(1)=7"
183,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""t"") AS ""t1"" WHERE ""rn"">6"
184,"WITH ""grouped_values"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1), ""unfiltered_values"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn_number"" FROM ""grouped_values"") SELECT ""visited_on"",""v"".""amount"",""v"".""average_amount"" FROM ""unfiltered_values"" AS ""v"" WHERE ""rn_number"">=7"
185,"SELECT ""cs"".""visited_on"" AS ""visited_on"",(SELECT SUM(""amount"") FROM ""customer"" AS ""cs1"" WHERE ""cs"".""visited_on"" - ""cs1"".""visited_on"" BETWEEN 0 AND 6) AS ""amount"",(SELECT ROUND(SUM(""amount"")/7, 2) FROM ""customer"" AS ""cs2"" WHERE ""cs"".""visited_on"" - ""cs2"".""visited_on"" BETWEEN 0 AND 6) AS ""average_amount"" FROM ""customer"" AS ""cs"" GROUP BY ""cs"".""visited_on"" HAVING ""cs"".""visited_on"">=(SELECT MIN(""cs3"".""visited_on"") FROM ""customer"" AS ""cs3"") + INTERVAL '6 DAY'"
186,"WITH ""cte"" AS (SELECT DISTINCT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""days"" FROM ""Customer"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""cte"" WHERE ""days"">=7"
187,"SELECT * FROM (SELECT ""visited_on"",SUM(""daily_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""daily_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""daily_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"") AS ""B"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""Customer"") + INTERVAL '6 DAY'"
188,"SELECT ""b"".""visited_on"",ROUND((""b"".""total""+""b"".""nxt_1""+""b"".""nxt_2""+""b"".""nxt_3""+""b"".""nxt_4""+""b"".""nxt_5""+""b"".""nxt_6""), 2) AS ""amount"",ROUND((""b"".""total""+""b"".""nxt_1""+""b"".""nxt_2""+""b"".""nxt_3""+""b"".""nxt_4""+""b"".""nxt_5""+""b"".""nxt_6"")/7, 2) AS ""average_amount"" FROM (SELECT ""a"".""visited_on"",""a"".""total"",LAG(""a"".""total"", 1) OVER (ORDER BY ""a"".""visited_on"") AS ""nxt_1"",LAG(""a"".""total"", 2) OVER (ORDER BY ""a"".""visited_on"") AS ""nxt_2"",LAG(""a"".""total"", 3) OVER (ORDER BY ""a"".""visited_on"") AS ""nxt_3"",LAG(""a"".""total"", 4) OVER (ORDER BY ""a"".""visited_on"") AS ""nxt_4"",LAG(""a"".""total"", 5) OVER (ORDER BY ""a"".""visited_on"") AS ""nxt_5"",LAG(""a"".""total"", 6) OVER (ORDER BY ""a"".""visited_on"") AS ""nxt_6"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""customer"" GROUP BY 1) AS ""a"") AS ""b"" WHERE ""nxt_6"" IS NOT NULL"
189,"SELECT DISTINCT ""a"".""visited_on"",SUM(""b"".""amount"")/""c"".""count"" AS ""amount"",ROUND(SUM(""b"".""amount"")/(7*""c"".""count""), 2) AS ""average_amount"" FROM (""Customer"" AS ""a"" JOIN ""Customer"" AS ""b"" ON ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6) LEFT JOIN (SELECT ""visited_on"",COUNT(""visited_on"") AS ""count"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c"" ON ""a"".""visited_on""=""c"".""visited_on"" GROUP BY ""a"".""visited_on"" HAVING COUNT(DISTINCT ""b"".""visited_on"")>=7 ORDER BY ""a"".""visited_on"""
190,"WITH ""DR"" AS (SELECT ""VISITED_ON"",SUM(""AMOUNT"") AS ""VAL"",ROW_NUMBER() OVER (ORDER BY ""VISITED_ON"") AS ""R"" FROM ""CUSTOMER"" GROUP BY ""VISITED_ON""), ""MOV_AVG"" AS (SELECT ""VISITED_ON"",""R"",""VAL""+LAG(""VAL"", 1) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 2) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 3) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 4) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 5) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 6) OVER (ORDER BY ""VISITED_ON"") AS ""AMOUNT"",ROUND((""VAL""+LAG(""VAL"", 1) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 2) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 3) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 4) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 5) OVER (ORDER BY ""VISITED_ON"")+LAG(""VAL"", 6) OVER (ORDER BY ""VISITED_ON""))/7, 2) AS ""AVERAGE_AMOUNT"" FROM ""DR"") SELECT ""VISITED_ON"",""AMOUNT"",""AVERAGE_AMOUNT"" FROM ""MOV_AVG"" WHERE ""R"">=7"
191,"SELECT ""a"".""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7 ORDER BY ""a"".""visited_on"""
192,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
193,"SELECT DISTINCT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rk"" FROM ""Customer"") AS ""t"" WHERE ""rk"">=7"
194,"SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(SUM(""b"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""a"" JOIN ""Customer"" AS ""b"" ON ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(DISTINCT (""b"".""visited_on""))>6"
195,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount""*1.00) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""T"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""CTE"" WHERE ""visited_on"" + INTERVAL '-6 DAY'>=(SELECT MIN(""visited_on"") FROM ""Customer"") ORDER BY 1"
196,"WITH ""a"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT * FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""a"") AS ""b"" WHERE ""visited_on"" + INTERVAL '-6 DAY' IN (SELECT ""visited_on"" FROM ""a"")"
197,"WITH ""base"" AS (SELECT DISTINCT ""visited_on"" AS ""end_date"",""visited_on"" + INTERVAL '-6 DAY' AS ""start_date"" FROM ""customer"" WHERE ""visited_on"" + INTERVAL '-6 DAY' IN (SELECT DISTINCT ""visited_on"" FROM ""customer"")) SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(SUM(""c2"".""amount"")/7, 2) AS ""average_amount"" FROM ((SELECT ""visited_on"",SUM(""amount"") AS ""n"" FROM ""customer"" GROUP BY 1) AS ""c1"" LEFT JOIN ""base"" AS ""b"" ON ""c1"".""visited_on""=""b"".""end_date"") LEFT JOIN ""customer"" AS ""c2"" ON ""c2"".""visited_on"" BETWEEN ""b"".""start_date"" AND ""b"".""end_date"" WHERE ""b"".""end_date"" IS NOT NULL GROUP BY 1"
198,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""cte1"" AS (SELECT ""visited_on"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""avg_amt"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amt"",COUNT(1) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""cnt"" FROM ""cte"") SELECT ""visited_on"",""sum_amt"" AS ""amount"",ROUND(""avg_amt"", 2) AS ""average_amount"" FROM ""cte1"" WHERE ""cnt"">=7 ORDER BY ""visited_on"""
199,"SELECT ""c1"".""visited_on"",ROUND((SELECT SUM(""c2"".""amount"") FROM ""customer"" AS ""c2"" WHERE ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6), 2) AS ""amount"",ROUND((SELECT SUM(""c3"".""amount"")/COUNT(DISTINCT ""c3"".""visited_on"") FROM ""customer"" AS ""c3"" WHERE ""c1"".""visited_on"" - ""c3"".""visited_on"" BETWEEN 0 AND 6), 2) AS ""average_amount"" FROM ""customer"" AS ""c1"" WHERE ""c1"".""visited_on"">(SELECT MIN(""visited_on"") FROM ""customer"")+5 GROUP BY 1 ORDER BY 1"
200,"WITH ""t"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""rolling_sum"" AS ""amount"",ROUND(""rolling_sum""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""rolling_sum"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rk"" FROM ""t"") AS ""tmp"" WHERE ""rk"">=7 ORDER BY 1"
201,"WITH ""temp"" AS (SELECT ""row_num"",""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""row_num"",""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""temp"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""temp"" WHERE ""row_num"">=7"
202,"WITH ""cte"" AS (SELECT ""visited_on"",LEAD(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""ld"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN CURRENT ROW AND 6 FOLLOWING) AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""ld"" AS ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""cte"" WHERE ""ld"" IS NOT NULL"
203,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""cte"".""visited_on"",SUM(""cte"".""amount"") OVER (ORDER BY ""cte"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""cte"".""amount"") OVER (ORDER BY ""cte"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte"" ORDER BY ""cte"".""visited_on"" LIMIT 9999999 OFFSET 6"
204,"WITH ""total_amt"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) SELECT TO_CHAR(""a"".""visited_on"", 'YYYY-%m-%d') AS ""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(AVG(""b"".""amount""), 2) AS ""average_amount"" FROM ""total_amt"" AS ""a"" LEFT JOIN ""total_amt"" AS ""b"" ON ""a"".""visited_on"">=""b"".""visited_on"" AND ""a"".""visited_on"" + INTERVAL '-6 DAY'<=""b"".""visited_on"" GROUP BY 1 HAVING COUNT(""b"".""visited_on"")=7 ORDER BY ""a"".""visited_on"""
205,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6"
206,"WITH ""row_count"" AS (SELECT ""visited_on"",""daily_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""cnt"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""daily_amount"" FROM ""Customer"" GROUP BY 1 ORDER BY 1) AS ""daily_agg""), ""ma"" AS (SELECT ""visited_on"",SUM(""daily_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",""cnt"" FROM ""row_count"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""ma"" WHERE ""cnt"">=7"
207,"WITH ""Customer2"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM ""Customer2"" AS ""c1"" LEFT JOIN ""Customer2"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY 1 HAVING COUNT(""c2"".""visited_on"")=7 ORDER BY 1"
208,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""a"".""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM ""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
209,"SELECT ""a"".""visited_on"",""a"".""amount"",""a"".""average_amount"" FROM (SELECT ""tmp"".""visited_on"",LAG(""tmp"".""visited_on"", 6) OVER (ORDER BY ""tmp"".""visited_on"") AS ""lag_date"",SUM(""tmp"".""amount"") OVER (ORDER BY ""tmp"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""tmp"".""amount"") OVER (ORDER BY ""tmp"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""tmp"") AS ""a"" WHERE ""a"".""lag_date"" IS NOT NULL"
210,"WITH ""cte_daily_spend"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""daily_amount"" FROM ""Customer"" GROUP BY 1), ""cte_7d_spend"" AS (SELECT ""visited_on"",SUM(""daily_amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL '6' DAY PRECEDING AND CURRENT ROW) AS ""amount"" FROM ""cte_daily_spend""), ""cte_final"" AS (SELECT *,ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""cte_7d_spend"" ORDER BY 1 LIMIT 18446744073709551615 OFFSET 6) SELECT * FROM ""cte_final"""
211,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(CAST(SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS FLOAT)/7.0, 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 100 OFFSET 6"
212,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT * FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""cte"") AS ""t"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""Customer"")+6"
213,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM (""Customer"" AS ""a"") JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" WHERE ""b"".""visited_on"" - ""a"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""b"".""visited_on"" HAVING COUNT(DISTINCT ""a"".""visited_on"")=7"
214,"WITH ""new"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""new"" ORDER BY ""visited_on"" LIMIT 100 OFFSET 6"
215,"SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""num"">6"
216,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"" WHERE ""rnk"">=7 ORDER BY ""visited_on"""
217,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""CTE"" LIMIT 10000 OFFSET 6"
218,"WITH ""CET"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""ranking"" FROM ""CET"") AS ""p1"" WHERE ""ranking"">=7"
219,"WITH ""DailyTotal"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""MovingTotal"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""Rn"" FROM ""DailyTotal"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM ""MovingTotal"" WHERE ""Rn"">=7 ORDER BY 1"
220,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""cte2"" AS (SELECT ""visited_on"",SUM(""total_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""total_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""row_num"" FROM ""cte"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""row_num"">=7 ORDER BY ""visited_on"""
221,"WITH ""groupby_date"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total"" FROM ""Customer"" GROUP BY ""visited_on""), ""seven_days_window"" AS (SELECT ""visited_on"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"",SUM(""total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM ""groupby_date"") SELECT ""visited_on"",""amount"",ROUND(""amount""/7.0, 2) AS ""average_amount"" FROM ""seven_days_window"" WHERE ""rn"">=7"
222,"SELECT ""a"".""visited_on"",SUM(""b"".""sum"") AS ""amount"",ROUND(AVG(""b"".""sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""sum"",AVG(""amount"") FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""sum"",AVG(""amount"") FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(1)=7"
223,"SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""x"" LIMIT 1000000000000 OFFSET 6"
224,"WITH ""c"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""moving_total"" AS ""amount"",ROUND(""moving_total""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""moving_total"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""c"") AS ""t"" WHERE ""rn"">=7 ORDER BY 1"
225,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM (""Customer"" AS ""a"") JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" WHERE ""b"".""visited_on"" - ""a"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""b"".""visited_on"" HAVING COUNT(DISTINCT ""a"".""visited_on"")=7"
226,"WITH ""MOV_AVG"" AS (SELECT ""VISITED_ON"",""R"",CASE WHEN ""R"">=7 THEN SUM(""VAL"") OVER (ORDER BY ""VISITED_ON"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) ELSE NULL END AS ""AMOUNT"" FROM (SELECT ""VISITED_ON"",SUM(""AMOUNT"") AS ""VAL"",ROW_NUMBER() OVER (ORDER BY ""VISITED_ON"") AS ""R"" FROM ""CUSTOMER"" GROUP BY ""VISITED_ON"") AS ""DR"") SELECT ""VISITED_ON"",""AMOUNT"",ROUND(""AMOUNT""/7, 2) AS ""AVERAGE_AMOUNT"" FROM ""MOV_AVG"" WHERE ""R"">=7"
227,"WITH ""t"" AS (SELECT DISTINCT ""visited_on"" FROM ""customer"" WHERE ""visited_on"" - INTERVAL '6 DAY'>=(SELECT MIN(""visited_on"") FROM ""customer"")) SELECT ""t"".""visited_on"",SUM(""amount"") AS ""amount"",ROUND(SUM(""amount"")/7, 2) AS ""average_amount"" FROM ""customer"" AS ""c"" JOIN ""t"" ON ""c"".""visited_on"" BETWEEN ""t"".""visited_on"" - INTERVAL '6 DAY' AND ""t"".""visited_on"" GROUP BY ""t"".""visited_on"""
228,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"">=0 AND ""c1"".""visited_on"" - ""c2"".""visited_on""<7 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""visited_on"")=7 ORDER BY ""c1"".""visited_on"""
229,"WITH ""t1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""t1"") AS ""tmp"" WHERE ""rn"">6 ORDER BY 1"
230,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""c2"".""visited_on"",SUM(""c1"".""amount"") AS ""amount"",ROUND(AVG(""c1"".""amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""c1"" JOIN ""cte"" AS ""c2"" ON ""c2"".""visited_on"" - ""c1"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c2"".""visited_on"" HAVING COUNT(1)=7 ORDER BY ""c2"".""visited_on"""
231,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rw"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""rw"" FROM ""cte"" ORDER BY ""visited_on"") AS ""a"" WHERE ""rw"">6"
232,"SELECT ""a"".""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(DISTINCT ""b"".""visited_on"")=7"
233,"WITH ""cte1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""total_amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""cte2"" AS (SELECT ""c1"".""visited_on"",SUM(""c2"".""total_amount"") AS ""amount"",ROUND(AVG(""c2"".""total_amount""), 2) AS ""average_amount"",COUNT(""c2"".""total_amount"") AS ""cnt"" FROM ""cte1"" AS ""c1"" LEFT JOIN ""cte1"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"">=0 AND ""c1"".""visited_on"" - ""c2"".""visited_on""<=6 GROUP BY ""c1"".""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""cte2"" WHERE ""cnt""=7"
234,"WITH ""daily_trans"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(SUM(""b"".""amount"")/7, 2) AS ""average_amount"" FROM ""daily_trans"" AS ""a"" LEFT JOIN ""daily_trans"" AS ""b"" ON ""a"".""visited_on""<=""b"".""visited_on"" + INTERVAL '6 DAY' AND ""a"".""visited_on"">=""b"".""visited_on"" GROUP BY 1 HAVING COUNT(""b"".""visited_on"")>=7"
235,"WITH ""a"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND((AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)), 2) AS ""average_amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rk"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""temp"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""a"" WHERE ""rk"">=7"
236,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) SELECT ""c"".""visited_on"",SUM(""c1"".""amount"") AS ""amount"",ROUND(AVG(""c1"".""amount""), 2) AS ""average_amount"" FROM ""cte"" AS ""c"" JOIN ""cte"" AS ""c1"" ON ""c1"".""visited_on"" BETWEEN ""c"".""visited_on"" + INTERVAL '-6 DAY' AND ""c"".""visited_on"" GROUP BY 1 HAVING COUNT(DISTINCT ""c1"".""visited_on"")=7 ORDER BY 1"
237,"WITH ""temp"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on""), ""temp1"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""lg"" FROM ""temp"") SELECT ""visited_on"",""amount"",ROUND(""average"", 2) AS ""average_amount"" FROM ""temp1"" WHERE ""lg"" IS NOT NULL"
238,"SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(AVG(""b"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
239,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
240,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
241,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""cte"" ORDER BY ""visited_on"" LIMIT 18446744073709551610 OFFSET 6"
242,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
243,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""row_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""row_num"">=7"
244,"WITH ""t"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""r_num"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""r_num"" FROM ""t"" GROUP BY ""visited_on"") AS ""d"" WHERE ""d"".""r_num"">6 ORDER BY ""visited_on"""
245,"WITH ""t1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT ""t1"".""visited_on"" AS ""visited_on"",SUM(""t2"".""day_sum"") AS ""amount"",ROUND(AVG(""t2"".""day_sum""), 2) AS ""average_amount"" FROM (""t1"") JOIN ""t1"" AS ""t2"" WHERE ""t1"".""visited_on"" - ""t2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""t1"".""visited_on"" HAVING COUNT(""t2"".""visited_on"")=7"
246,"SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6"
247,"WITH ""tot_amt"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) SELECT ""a"".""visited_on"",SUM(""b"".""amount"") AS ""amount"",ROUND(AVG(""b"".""amount""), 2) AS ""average_amount"" FROM ""tot_amt"" AS ""a"" LEFT JOIN ""tot_amt"" AS ""b"" ON ""a"".""visited_on"" - ""b"".""visited_on"">=0 AND ""a"".""visited_on"" - ""b"".""visited_on""<=6 GROUP BY 1 HAVING COUNT(""b"".""visited_on"")=7"
248,"SELECT ""visited_on"",""window_amount"" AS ""amount"",ROUND((CAST(""window_amount"" AS FLOAT)/7.0), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",LAG(""visited_on"", 6) OVER (ORDER BY ""visited_on"") AS ""p_days"",SUM(""s_amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""window_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""s_amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""tem1"") AS ""tem2"" WHERE ""p_days"" IS NOT NULL"
249,"WITH ""XX"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""daily_total"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""daily_total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""daily_total"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"" FROM ""XX"") AS ""sub1"" WHERE ""visited_on"" - INTERVAL '6 DAY'>=(SELECT MIN(""visited_on"") FROM ""customer"")"
250,"SELECT ""a"".""visited_on"" AS ""visited_on"",ROUND(SUM(""b"".""day_sum""), 2) AS ""amount"",ROUND(SUM(""b"".""day_sum"")/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
251,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
252,"WITH ""all_moving_average"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""visit_rank"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""visit_rank"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""all_moving_average"" WHERE ""visit_rank"">6"
253,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(AVG(""c2"".""amount""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(""c2"".""amount"")=7"
254,"WITH ""TEMP"" AS (SELECT ""VISITED_ON"",SUM(""AMOUNT"") OVER (ORDER BY ""VISITED_ON"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""AMOUNT"",AVG(""AMOUNT"") OVER (ORDER BY ""VISITED_ON"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""AVERAGE_AMOUNT"",RANK() OVER (ORDER BY ""VISITED_ON"") AS ""RNK"" FROM (SELECT ""VISITED_ON"",SUM(""AMOUNT"") AS ""AMOUNT"" FROM ""CUSTOMER"" GROUP BY ""VISITED_ON"") AS ""T"") SELECT ""VISITED_ON"",""AMOUNT"",ROUND(""AVERAGE_AMOUNT"", 2) AS ""AVERAGE_AMOUNT"" FROM ""TEMP"" WHERE ""RNK"">=7 ORDER BY 1"
255,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""sum_amt"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""sum_amt"" FROM ""Customer"" GROUP BY 1) AS ""x"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""y"" WHERE ""seq"">6"
256,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
257,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM (""Customer"" AS ""a"") JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" WHERE ""b"".""visited_on"" - ""a"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""b"".""visited_on"" HAVING COUNT(DISTINCT ""a"".""visited_on"")=7"
258,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
259,"WITH ""all_moving_average"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""visit_rank"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""visit_rank"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""all_moving_average"" WHERE ""visit_rank"">6"
260,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""rownum"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""rownum"">=7"
261,"WITH ""custCte"" AS (SELECT DISTINCT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") SELECT ""visited_on"",(SELECT SUM(""b"".""amount"") FROM ""custCte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6) AS ""amount"",ROUND((SELECT AVG(""b"".""amount"") FROM ""custCte"" AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6), 2) AS ""average_amount"" FROM ""custCte"" AS ""a"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""custCte"") + INTERVAL '6 DAY' ORDER BY ""visited_on"""
262,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(SUM(""c2"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT ""customer_id"",""name"",""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c1"" JOIN (SELECT ""customer_id"",""name"",""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""c2"" WHERE ""c1"".""visited_on"" - ""c2"".""visited_on""<7 AND ""c1"".""visited_on"" - ""c2"".""visited_on"">=0 GROUP BY ""c1"".""visited_on"" HAVING COUNT(1)>6 ORDER BY ""c1"".""visited_on"""
263,"SELECT * FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND 0 FOLLOWING) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND 0 FOLLOWING), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""visited_on"" + INTERVAL '-6 DAY' IN (SELECT DISTINCT ""visited_on"" FROM ""customer"")"
264,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM (SELECT SUM(""amount"") AS ""amount"",""visited_on"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""t"") AS ""t2"" WHERE ""seq"">6"
265,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
266,"SELECT ""t1"".""visited_on"",SUM(""t2"".""amount_date"") AS ""amount"",ROUND(SUM(""t2"".""amount_date"")/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount_date"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""t1"" JOIN (SELECT ""visited_on"",SUM(""amount"") AS ""amount_date"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""t2"" ON ""t1"".""visited_on"" - ""t2"".""visited_on"" BETWEEN 0 AND 6 WHERE ""t1"".""visited_on"">=(SELECT ""visited_on"" FROM ""Customer"" LIMIT 1)+6 GROUP BY ""t1"".""visited_on"" ORDER BY ""visited_on"""
267,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1) AS ""a"") AS ""b"" WHERE ""seq"">6"
268,"WITH ""all_moving_average"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",""visit_rank"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""visit_rank"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""all_moving_average"" WHERE ""visit_rank"">6"
269,"WITH ""tmp"" AS (SELECT ""visited_on"",""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""row1"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY 1) AS ""t1""), ""tmp2"" AS (SELECT ""visited_on"",""row1"",SUM(""amount"") OVER (ORDER BY ""row1"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",CAST(SUM(""amount"") OVER (ORDER BY ""row1"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)/7 AS DECIMAL(10, 2)) AS ""average_amount"" FROM ""tmp"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""tmp2"" WHERE ""row1"">=7"
270,"SELECT ""visited_on"",""sum_amount"" AS ""amount"",ROUND(""sum_amount""/7, 2) AS ""average_amount"" FROM (SELECT *,ROW_NUMBER() OVER () AS ""seq"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""sum_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""seq"">6"
271,"SELECT DISTINCT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW) AS ""amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rk"" FROM ""Customer"") AS ""t"" WHERE ""rk"">=7"
272,"SELECT ""b"".""visited_on"",""b"".""amount"",""b"".""average_amount"" FROM (SELECT ""a"".""visited_on"",SUM(""a"".""amount"") OVER (ORDER BY ""a"".""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""a"".""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""a"".""visited_on"") AS ""row_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""b"".""row_num"">=7"
273,"SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rn"" FROM ""customer"" GROUP BY ""visited_on"") AS ""f1"" WHERE ""rn"">6"
274,"SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""t"" LIMIT 1000000 OFFSET 6"
275,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""A"" WHERE ""rnk"">6 ORDER BY 1"
276,"WITH ""temp"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""c"".""visited_on"",SUM(""d"".""amount"") AS ""amount"",ROUND(AVG(""d"".""amount""), 2) AS ""average_amount"" FROM (""temp"" AS ""c"") JOIN ""temp"" AS ""d"" WHERE ""c"".""visited_on"">=""d"".""visited_on"" AND ""c"".""visited_on"" - ""d"".""visited_on""<7 GROUP BY ""c"".""visited_on"" HAVING COUNT(1)>=7 ORDER BY ""c"".""visited_on"""
277,"WITH ""x"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amt"" FROM ""customer"" GROUP BY 1 ORDER BY 1) SELECT ""visited_on"",ROUND((SUM(""amt"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)), 2) AS ""amount"",ROUND((AVG(""amt"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)), 2) AS ""average_amount"" FROM ""x"" GROUP BY 1 ORDER BY 1 LIMIT 9999999 OFFSET 6"
278,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
279,"WITH ""temp"" AS (SELECT ""visited_on"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" RANGE BETWEEN INTERVAL 6 DAY PRECEDING AND CURRENT ROW)/7, 2) AS ""average_amount"" FROM ""Customer"") SELECT DISTINCT * FROM ""temp"" WHERE ""visited_on"" - INTERVAL '6 DAY' IN (SELECT DISTINCT ""visited_on"" FROM ""Customer"")"
280,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
281,"SELECT ""a"".""visited_on"" AS ""visited_on"",SUM(""b"".""day_sum"") AS ""amount"",ROUND(AVG(""b"".""day_sum""), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"", (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""b"" WHERE ""a"".""visited_on"" - ""b"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""a"".""visited_on"" HAVING COUNT(""b"".""visited_on"")=7"
282,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rank_num"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""tt"") AS ""t"" WHERE ""rank_num"">=7"
283,"SELECT * FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT SUM(""amount"") AS ""amount"",""visited_on"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""visited_on"" - INTERVAL '6 DAY' IN (SELECT ""visited_on"" FROM ""Customer"")"
284,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") SELECT ""visited_on"",""amount"",""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""ranking"" FROM ""cte"") AS ""a"" WHERE ""ranking"">=7"
285,"SELECT ""c1"".""visited_on"",SUM(""c2"".""amount"") AS ""amount"",ROUND(SUM(""c2"".""amount"")/7, 2) AS ""average_amount"" FROM (SELECT DISTINCT ""visited_on"" AS ""visited_on"" FROM ""Customer"") AS ""c1"" JOIN ""Customer"" AS ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING ""c1"".""visited_on"">=MIN(""c2"".""visited_on"")+6 ORDER BY ""c1"".""visited_on"""
286,"WITH ""CTE"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount""*1.00) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""T"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""CTE"" WHERE ""visited_on"" + INTERVAL '-6 DAY'>=(SELECT MIN(""visited_on"") FROM ""Customer"") ORDER BY 1"
287,"SELECT ""VISITED_ON"",""AMOUNT"",""AVERAGE_AMOUNT"" FROM (SELECT ""VISITED_ON"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""AMOUNT"",ROUND((SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW))/(COUNT(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)), 2) AS ""AVERAGE_AMOUNT"",COUNT(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""c"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"") AS ""b"" WHERE ""c"">6"
288,"WITH ""daily_spend"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""Sales"",MIN(""visited_on"") AS ""f_date"" FROM ""Customer"" GROUP BY ""visited_on""), ""full_set"" AS (SELECT ""visited_on"",SUM(""Sales"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""Sales"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""daily_spend"") SELECT * FROM ""full_set"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""Customer"") + INTERVAL '6 DAY'"
289,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount"") OVER (ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") AS ""t"") AS ""t1"" WHERE ""rnk"">=7"
290,"WITH ""tmp1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY 1), ""tmp2"" AS (SELECT DISTINCT ""visited_on"" FROM ""customer"" WHERE ""visited_on"">=(SELECT MIN(""visited_on"") FROM ""customer"") + INTERVAL '6 DAY') SELECT ""a"".""visited_on"",SUM(""amount"") AS ""amount"",ROUND(AVG(""amount""), 2) AS ""average_amount"" FROM (""tmp2"" AS ""a"") JOIN ""tmp1"" AS ""b"" WHERE ""b"".""visited_on"" BETWEEN ""a"".""visited_on"" - INTERVAL '6 DAY' AND ""a"".""visited_on"" GROUP BY 1 ORDER BY 1"
291,"SELECT ""visited_on"",""window_amount"" AS ""amount"",ROUND(""window_amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(""amount_per_day"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""window_amount"",DENSE_RANK() OVER (ORDER BY ""visited_on"") AS ""rk"" FROM (SELECT ""visited_on"",SUM(""amount"") AS ""amount_per_day"" FROM ""Customer"" GROUP BY ""visited_on"") AS ""t"") AS ""t2"" WHERE ""rk"">6"
292,"WITH ""tmp"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""tmp2"" AS (SELECT ""visited_on"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rnk"",ROUND(SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""tmp"") SELECT ""visited_on"",""amount"",""average_amount"" FROM ""tmp2"" WHERE ""rnk"">=7"
293,"WITH ""daily_summary"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""customer"" GROUP BY ""visited_on""), ""rolling_window"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""average_amount"",ROW_NUMBER() OVER (ORDER BY ""visited_on"") AS ""rownum"" FROM ""daily_summary"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM ""rolling_window"" WHERE ""rownum"">6"
294,"WITH ""c1"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on""), ""c2"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""day_sum"" FROM ""Customer"" GROUP BY ""visited_on"") SELECT MAX(""c2"".""visited_on"") AS ""visited_on"",SUM(""c2"".""day_sum"") AS ""amount"",ROUND(AVG(""c2"".""day_sum""), 2) AS ""average_amount"" FROM ""c1"" JOIN ""c2"" ON ""c1"".""visited_on"" - ""c2"".""visited_on"" BETWEEN 0 AND 6 GROUP BY ""c1"".""visited_on"" HAVING COUNT(DISTINCT ""c2"".""visited_on"")=7 ORDER BY 1"
295,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"" LIMIT 1000 OFFSET 6) AS ""temp"""
296,"SELECT ""visited_on"",""amount"",ROUND(""amount""/7, 2) AS ""average_amount"" FROM (SELECT ""visited_on"",SUM(SUM(""amount"")) OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",RANK() OVER (ORDER BY ""visited_on"") AS ""rnk"" FROM ""customer"" GROUP BY ""visited_on"") AS ""a"" WHERE ""rnk"">=7 ORDER BY ""visited_on"""
297,"SELECT ""b"".""visited_on"",SUM(""a"".""amount"") AS ""amount"",ROUND(SUM(""a"".""amount"")/7, 2) AS ""average_amount"" FROM ""Customer"" AS ""a"" LEFT JOIN (SELECT DISTINCT ""visited_on"" FROM ""Customer"") AS ""b"" ON ""a"".""visited_on"" BETWEEN ""b"".""visited_on"" + INTERVAL '-6 DAY' AND ""b"".""visited_on"" WHERE ""b"".""visited_on"" + INTERVAL '-6 DAY' IN (SELECT ""visited_on"" FROM ""Customer"") GROUP BY ""b"".""visited_on"" ORDER BY ""b"".""visited_on"""
298,"WITH ""cte"" AS (SELECT ""visited_on"",SUM(""amount"") AS ""amount"" FROM ""Customer"" GROUP BY ""visited_on"" ORDER BY ""visited_on"") SELECT ""visited_on"",""amount"",ROUND(""average_amount"", 2) AS ""average_amount"" FROM (SELECT ""visited_on"",CASE WHEN ROW_NUMBER() OVER (ORDER BY ""visited_on"")>=7 THEN SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) ELSE NULL END AS ""amount"",CASE WHEN ROW_NUMBER() OVER (ORDER BY ""visited_on"")>=7 THEN AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) ELSE NULL END AS ""average_amount"" FROM ""cte"") AS ""a"" WHERE ""a"".""amount"" IS NOT NULL"
299,"WITH RECURSIVE ""cte_date_spine"" AS (SELECT MIN(""visited_on"") AS ""dt"" FROM ""Customer"" UNION ALL SELECT ""dt"" + INTERVAL ''1' DAY' AS ""dt"" FROM ""cte_date_spine"" WHERE ""dt""<(SELECT MAX(""visited_on"") FROM ""Customer"")), ""cte_join_agg"" AS (SELECT ""s"".""dt"" AS ""visited_on"",SUM(""c"".""amount"") AS ""amount"" FROM ""cte_date_spine"" AS ""s"" LEFT JOIN ""Customer"" AS ""c"" ON ""s"".""dt""=""c"".""visited_on"" GROUP BY 1), ""cte_final"" AS (SELECT ""visited_on"",SUM(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ""amount"",ROUND(AVG(""amount"") OVER (ORDER BY ""visited_on"" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS ""average_amount"" FROM ""cte_join_agg"" ORDER BY 1) SELECT * FROM ""cte_final"" LIMIT 18446744073709551615 OFFSET 6"
