id,original query
1,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""cte"" WHERE ""ct"" IN (SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
2,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")>=(SELECT COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""product"")"
3,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
4,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
5,"SELECT DISTINCT ""customer_id"" FROM (SELECT ""customer_id"",""product_key"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_key"") AS ""num_product"" FROM ""Customer"") AS ""temp"" WHERE ""num_product"" IN (SELECT COUNT(1) FROM ""Product"")"
6,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""Customer"" GROUP BY 1) AS ""tmp"" WHERE ""ct""=(SELECT COUNT(1) FROM ""Product"")"
7,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""product_number"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""temp"" WHERE ""temp"".""product_number""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
8,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
9,"SELECT ""c"".""customer_id"" FROM ""Customer"" AS ""c"" JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""c"".""customer_id"" HAVING COUNT(DISTINCT ""p"".""product_key"")=(SELECT COUNT(DISTINCT ""p"".""product_key"") FROM ""Product"" AS ""p"")"
10,"WITH ""cte_filter"" AS (SELECT ""c"".""customer_id"",""c"".""product_key"" FROM ""Customer"" AS ""c"" JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"") SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""counted"" FROM ""cte_filter"" GROUP BY ""customer_id"" HAVING ""counted""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")) AS ""a"""
11,"WITH ""t1"" AS (SELECT COUNT(1) AS ""products"" FROM ""producT"") SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT ""products"" FROM ""t1"")"
12,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
13,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
14,"SELECT ""customer_id"" FROM (SELECT DISTINCT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""np"" FROM ""customer"" GROUP BY ""customer_id"") AS ""a"" JOIN (SELECT COUNT(1) AS ""total"" FROM ""Product"") AS ""b"" ON ""np""=""total"""
15,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
16,"WITH ""T1"" AS (SELECT COUNT(""product_key"") AS ""_total"" FROM ""product"") SELECT ""customer_id"" FROM (""customer"" AS ""c"") JOIN ""t1"" GROUP BY 1,""t1"".""_total"" HAVING COUNT(DISTINCT ""product_key"")=""t1"".""_total"""
17,"SELECT ""c"".""customer_id"" FROM ""Customer"" AS ""c"" JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""c"".""customer_id"" HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
18,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
19,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""customer"" GROUP BY ""customer_id"") AS ""t"" WHERE ""ct""=(SELECT COUNT(1) FROM ""product"")"
20,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""count"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""C"" WHERE ""count""=(SELECT COUNT(""product_key"") AS ""pc"" FROM ""Product"")"
21,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
22,"WITH ""temp"" AS (SELECT ""customer_id"",COUNT(DISTINCT (""product_key"")) AS ""product_num"" FROM ""customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""temp"" WHERE ""product_num""=(SELECT COUNT(""product_key"") FROM ""product"")"
23,"WITH ""cust"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""prod_cnt"" FROM ""customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" AS ""CUSTOMER_ID"" FROM ""cust"" WHERE ""prod_cnt""=(SELECT COUNT(1) FROM ""product"")"
24,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
25,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",CASE WHEN SUM(""cnt"")=""p"".""b"" THEN ""customer_id"" END AS ""l"" FROM (SELECT ""customer_id"",""c"".""product_key"",COUNT(DISTINCT ""c"".""product_key"") AS ""cnt"" FROM ""Customer"" AS ""c"" JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""customer_id"",""c"".""product_key"") AS ""a"", (SELECT COUNT(""product_key"") AS ""b"" FROM ""Product"") AS ""p"" WHERE 1=1 GROUP BY ""customer_id"") AS ""o"" WHERE ""o"".""l"" IS NOT NULL"
26,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
27,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
28,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"") IN (SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
29,"WITH ""unique_products_customers"" AS (SELECT DISTINCT ""customer_id"",""product_key"" FROM ""customer""), ""row_numbered_product_customers"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_key"") AS ""row_num"" FROM ""unique_products_customers"" AS ""upc"") SELECT ""customer_id"" FROM ""row_numbered_product_customers"" WHERE ""row_num""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
30,"WITH ""tmp"" AS (SELECT COUNT(DISTINCT ""product_key"") AS ""diverse1"" FROM ""Product""), ""tmp2"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""diverse"" FROM ""Customer"" WHERE ""product_key"" IN (SELECT DISTINCT ""product_key"" FROM ""Product"") GROUP BY 1) SELECT ""customer_id"" FROM (""tmp2"") JOIN ""tmp"" WHERE ""diverse""=""diverse1"""
31,"SELECT ""customer_id"" FROM ""Customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
32,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
33,"SELECT DISTINCT ""a"".""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING ""cnt"" IN (SELECT COUNT(""product_key"") FROM ""product"")) AS ""a"""
34,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
35,"SELECT DISTINCT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
36,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
37,"SELECT ""customer_id"" FROM ""Customer"" AS ""c"" RIGHT JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
38,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ordered"",""total"" FROM (""Customer"") JOIN (SELECT COUNT(""product_key"") AS ""total"" FROM ""Product"") AS ""a"" GROUP BY 1) SELECT DISTINCT ""customer_id"" FROM ""cte"" WHERE ""ordered""=""total"""
39,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""num_total"" FROM ""Product"")"
40,ERROR: An error occurred while restore SelectStmt.Having: An error occurred while restore HavingClause.Expr: An error occurred when restore BinaryOperationExpr.L: Psql translation: string_agg does not support DISTINCT
41,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") AS ""cnt"" FROM ""Product"")"
42,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
43,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
44,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""cte"" WHERE ""cnt""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
45,"SELECT ""a"".""customer_id"" FROM (SELECT ""customer_id"",SUM(DISTINCT ""product_key"") AS ""total1"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""a"", (SELECT SUM(DISTINCT ""product_key"") AS ""total2"" FROM ""Product"") AS ""b"" WHERE ""a"".""total1""=""b"".""total2"""
46,"WITH ""cte1"" AS (SELECT COUNT(""product_key"") AS ""c1"" FROM ""Product""), ""cte2"" AS (SELECT DISTINCT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""c2"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT DISTINCT ""customer_id"" FROM (""cte1"") JOIN ""cte2"" WHERE ""cte1"".""c1""=""cte2"".""c2"""
47,"SELECT DISTINCT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
48,"WITH ""boughtpdts"" (""customer_id"", ""bought"") AS (SELECT ""customer_id"",""c"".""product_key"" FROM ""customer"" AS ""c"" JOIN ""product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"") SELECT ""customer_id"" FROM ""boughtpdts"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""bought"")=(SELECT COUNT(""product_key"") FROM ""product"")"
49,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(""product_key"") FROM ""Product"")"
50,"SELECT ""customer_id"" FROM (SELECT DISTINCT ""customer_id"",""product_key"" FROM ""customer"") AS ""g"" GROUP BY ""customer_id"" HAVING COUNT(1)=(SELECT COUNT(""product_key"") FROM ""product"")"
51,"SELECT ""customer_id"" FROM ""Customer"" AS ""C"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
52,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT (""product_key"")) FROM ""Product"")"
53,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" JOIN ""product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""p"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
54,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
55,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"") IN (SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
56,ERROR: An error occurred while restore SelectStmt.Having: An error occurred while restore HavingClause.Expr: An error occurred when restore BinaryOperationExpr.L: Psql translation: string_agg does not support DISTINCT
57,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""customer"")"
58,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
59,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
60,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
61,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY 1 HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
62,"SELECT ""A"".""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""customer"" JOIN ""product"" USING (""product_key"") GROUP BY ""customer_id"") AS ""A"" WHERE ""A"".""cnt""=(SELECT COUNT(""product_key"") FROM ""product"")"
63,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""customer"" GROUP BY ""customer_id"") AS ""t"" WHERE ""ct""=(SELECT COUNT(1) FROM ""product"")"
64,"SELECT DISTINCT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
65,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
66,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""num_prods"" FROM ""Product"")"
67,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
68,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnts"" FROM ""Customer"" GROUP BY 1) SELECT ""customer_id"" FROM ""cte"" WHERE ""cnts""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
69,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""proCount"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""t"" WHERE ""t"".""proCount""=(SELECT COUNT(""product_key"") AS ""mx"" FROM ""Product"")"
70,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) AS ""cnt"" FROM ""product"") ORDER BY 1"
71,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""customer"" GROUP BY 1) AS ""temp"" WHERE ""cnt""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
72,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
73,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
74,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
75,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""p"".""product_key"") FROM ""product"" AS ""p"")"
76,"SELECT ""c"".""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""c"".""customer_id"" HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
77,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
78,"SELECT DISTINCT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT DISTINCT COUNT(""product_key"") FROM ""product"")"
79,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
80,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
81,"SELECT DISTINCT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
82,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
83,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
84,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
85,"SELECT ""customer_id"" FROM (SELECT DISTINCT * FROM ""CUSTOMER"") AS ""a"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
86,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
87,"WITH ""cte"" AS (SELECT *,COUNT(1) AS ""total_products"" FROM ""Product"") SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""bought_products"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""tmp"" WHERE ""bought_products""=(SELECT MAX(""total_products"") FROM ""cte"")"
88,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
89,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"") IN (SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
90,"SELECT ""x"".""customer_id"" FROM (SELECT DISTINCT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Customer"" GROUP BY 1) AS ""x"" WHERE ""x"".""cnt""=(SELECT COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Product"")"
91,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
92,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
93,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
94,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
95,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Customer"")"
96,"WITH ""cust_count"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""count_prod"" FROM ""customer"" GROUP BY 1) SELECT DISTINCT ""customer_id"" FROM ""cust_count"" WHERE ""count_prod""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
97,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
98,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
99,"SELECT ""customer_id"" FROM (SELECT DISTINCT * FROM ""Customer"") AS ""t"" GROUP BY ""customer_id"" HAVING COUNT(0)=(SELECT COUNT(0) FROM ""Product"")"
100,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
101,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
102,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"") ORDER BY 1"
103,"SELECT ""cs"".""customer_id"" AS ""customer_id"" FROM ""customer"" AS ""cs"" GROUP BY 1 HAVING COUNT(DISTINCT ""cs"".""product_key"")=(SELECT COUNT(DISTINCT ""pd"".""product_key"") FROM ""product"" AS ""pd"")"
104,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
105,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
106,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""productCt"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""t"" WHERE ""productCt""=(SELECT COUNT(1) FROM ""Product"")"
107,"SELECT ""customer_id"" FROM ""Customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
108,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
109,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""count_product"" FROM ""Product"")"
110,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"") ORDER BY 1"
111,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
112,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
113,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) AS ""num"" FROM ""product"")"
114,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""prdcnt"" FROM ""product"")"
115,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""num_p"" FROM ""product"")"
116,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
117,"SELECT ""a"".""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Customer"" GROUP BY 1) AS ""a"", (SELECT COUNT(1) AS ""cnt"" FROM ""Product"") AS ""b"" WHERE ""a"".""cnt""=""b"".""cnt"""
118,"WITH ""CTE1"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""CTE1"" WHERE ""ct""=(SELECT COUNT(1) FROM ""Product"")"
119,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
120,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" JOIN ""product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY 1 HAVING COUNT(DISTINCT ""p"".""product_key"")=(SELECT COUNT(1) FROM ""product"")"
121,"WITH ""temp"" AS (SELECT ""C"".""customer_id"",""C"".""product_key"" AS ""P1"",""P"".""product_key"" AS ""P2"" FROM ""Customer"" AS ""C"" LEFT JOIN ""Product"" AS ""P"" ON ""C"".""product_key""=""P"".""product_key"") SELECT ""customer_id"" FROM ""temp"" WHERE ""P1""=""P2"" GROUP BY 1 HAVING COUNT(DISTINCT ""P1"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
122,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",CASE WHEN COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"") THEN 1 ELSE 0 END AS ""valid"" FROM ""Customer"" GROUP BY 1) AS ""t"" WHERE ""valid""=1"
123,"SELECT ""c"".""customer_id"" FROM ""Customer"" AS ""c"" GROUP BY ""c"".""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"" AS ""p"")"
124,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
125,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
126,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
127,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"") IN (SELECT COUNT(""product_key"") FROM ""Product"")"
128,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
129,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
130,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
131,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
132,"SELECT DISTINCT ""A"".""customer_id"" AS ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""num_products"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""A"" JOIN (SELECT COUNT(""product_key"") AS ""num_products"" FROM ""Product"") AS ""B"" ON (""A"".""num_products""=""B"".""num_products"") WHERE ""A"".""customer_id"" IS NOT NULL"
133,"WITH ""unique_purchases"" AS (SELECT DISTINCT ""customer_id"",""product_key"" FROM ""customer"") SELECT ""customer_id"" FROM ""unique_purchases"" GROUP BY ""customer_id"" HAVING COUNT(""unique_purchases"".""customer_id"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
134,"WITH ""cust"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Customer"" GROUP BY 1) SELECT ""customer_id"" FROM ""cust"" WHERE ""cnt""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
135,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
136,"SELECT ""customer_id"" FROM (SELECT DISTINCT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""customer_products"" FROM ""Customer"" GROUP BY 1) AS ""c"" WHERE ""customer_products""=(SELECT COUNT(1) FROM ""Product"")"
137,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
138,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING ""ct""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")) AS ""t"""
139,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""cte"" WHERE ""ct""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
140,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
141,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
142,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
143,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
144,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM (SELECT ""c"".""customer_id"",""p"".* FROM ""customer"" AS ""c"" JOIN ""product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"") AS ""t"" GROUP BY ""customer_id"") AS ""j"" WHERE ""ct""=(SELECT COUNT(1) FROM ""product"")"
145,"SELECT ""customer_id"" FROM ""product"" AS ""p"" LEFT JOIN ""customer"" AS ""c"" ON ""p"".""product_key""=""c"".""product_key"" GROUP BY 1 HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
146,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
147,ERROR: An error occurred while restore SubqueryExpr.Query: An error occurred while restore SelectStmt.Fields[1]: An error occurred while restore SelectField.Expr: Psql translation: string_agg does not support DISTINCT
148,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
149,"WITH ""first_pass"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""total_products"" FROM ""Customer"" WHERE LENGTH(""product_key"")>0 GROUP BY 1) SELECT ""customer_id"" FROM ""first_pass"" WHERE ""total_products""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Customer"")"
150,"SELECT DISTINCT ""c"".""customer_id"" FROM ""customer"" AS ""c"" WHERE ""c"".""product_key"" IN (SELECT ""p"".""product_key"" FROM ""product"" AS ""p"") GROUP BY ""c"".""customer_id"" HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(1) FROM ""product"")"
151,"SELECT ""a"".""customer_id"" FROM (SELECT DISTINCT * FROM ""Customer"") AS ""a"" GROUP BY ""a"".""customer_id"" HAVING SUM(CASE WHEN ""a"".""product_key"" IN (SELECT * FROM ""Product"") THEN 1 ELSE 0 END)=(SELECT COUNT(1) FROM ""Product"")"
152,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
153,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT (""product_key"")) AS ""num"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""cte"" WHERE ""num""=(SELECT COUNT(1) FROM ""Product"")"
154,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
155,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
156,"SELECT ""customer_id"" FROM ""Customer"" AS ""c"" RIGHT JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
157,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
158,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
159,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(DISTINCT (""product_key"")) FROM ""product"")"
160,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
161,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
162,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""number_purchase"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""t"" WHERE ""number_purchase""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
163,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
164,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""ct"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""cte"" WHERE ""ct""=(SELECT COUNT(""product_key"") FROM ""Product"")"
165,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
166,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
167,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(""product_key"") FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")) AS ""t"""
168,"SELECT ""c"".""customer_id"" FROM ""Customer"" AS ""c"" GROUP BY ""c"".""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"" AS ""p"")"
169,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
170,"SELECT ""customer_id"" FROM ""Customer"" AS ""c"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
171,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
172,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Product"")"
173,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",""product_key"",COUNT(DISTINCT ""product_key"") AS ""ctr"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""c"" WHERE ""ctr""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
174,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
175,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") AS ""req"" FROM ""product"")"
176,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
177,"SELECT DISTINCT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
178,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
179,"WITH ""temp"" AS (SELECT ""c"".""customer_id"",""p"".""product_key"" FROM ""customer"" AS ""c"" JOIN ""product"" AS ""p"") SELECT DISTINCT ""customer_id"" FROM ""customer"" WHERE ""customer_id"" NOT IN (SELECT ""customer_id"" FROM (SELECT ""t"".""customer_id"",COALESCE(""c"".""product_key"", 0) AS ""pk"" FROM ""temp"" AS ""t"" LEFT JOIN ""customer"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" AND ""t"".""product_key""=""c"".""product_key"") AS ""t1"" WHERE ""pk""=0)"
180,"SELECT ""CUSTOMER_ID"" FROM (SELECT ""CUSTOMER_ID"",SUM(""PRODUCT_KEY"") AS ""TOT"" FROM (SELECT DISTINCT ""CUSTOMER_ID"",""PRODUCT_KEY"" FROM ""CUSTOMER"" ORDER BY ""PRODUCT_KEY"") AS ""A"" GROUP BY ""CUSTOMER_ID"" HAVING SUM(""PRODUCT_KEY"")=(SELECT SUM(""PRODUCT_KEY"") FROM ""PRODUCT"")) AS ""A"""
181,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
182,"WITH ""total_prod"" (""total"") AS (SELECT COUNT(DISTINCT ""product_key"") FROM ""product""), ""con_prod"" (""customer_id"", ""total"") AS (SELECT ""a"".""customer_id"",COUNT(DISTINCT ""a"".""product_key"") FROM ""customer"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_key""=""b"".""product_key"" GROUP BY ""a"".""customer_id"") SELECT DISTINCT ""customer_id"" FROM (""total_prod"") JOIN ""con_prod"" WHERE ""total_prod"".""total""=""con_prod"".""total"""
183,"SELECT DISTINCT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
184,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
185,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""Customer"".""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
186,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
187,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
188,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")>=(SELECT COUNT(1) FROM ""product"")"
189,"WITH ""base"" AS (SELECT DISTINCT ""customer_id"",""product_key"" FROM ""customer""), ""base2"" AS (SELECT ""customer_id"",SUM(""product_key"") AS ""vall"" FROM ""base"" GROUP BY ""customer_id""), ""ans"" AS (SELECT ""customer_id"" FROM ""base2"" WHERE ""vall""=(SELECT SUM(DISTINCT ""product_key"") FROM ""product"")) SELECT ""customer_id"" FROM ""ans"""
190,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
191,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
192,"SELECT DISTINCT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
193,"WITH ""a"" AS (SELECT DISTINCT ""customer_id"",""product"".""product_key"" FROM ""Customer"" JOIN ""product"") SELECT DISTINCT ""a"".""customer_id"" FROM ""a"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""a"".""customer_id"" FROM ""a"" LEFT JOIN ""Customer"" ON ""a"".""customer_id""=""customer"".""customer_id"" AND ""a"".""product_key""=""customer"".""product_key"" WHERE ""customer"".""product_key"" IS NULL)"
194,"WITH ""cte"" AS (SELECT COUNT(1) FROM ""Product"") SELECT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT * FROM ""cte"")"
195,"WITH ""purchased"" AS (SELECT ""customer_id"" AS ""id"",COUNT(DISTINCT ""product_key"") AS ""purchases"" FROM ""customer"" GROUP BY 1) SELECT ""id"" AS ""customer_id"" FROM ""purchased"" WHERE ""purchases""=(SELECT COUNT(1) FROM ""product"")"
196,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
197,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
198,"SELECT ""sub"".""customer_id"" FROM (SELECT ""c"".""customer_id"",SUM(DISTINCT ""c"".""product_key"") AS ""sub_total"",SUM(DISTINCT ""p"".""product_key"") AS ""total"" FROM (""Customer"" AS ""c"") JOIN ""Product"" AS ""p"" GROUP BY ""customer_id"") AS ""sub"" WHERE ""sub"".""sub_total""=""sub"".""total"""
199,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
200,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
201,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
202,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
203,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
204,"SELECT ""customer_id"" FROM (SELECT DISTINCT * FROM ""customer"") AS ""a"" GROUP BY ""customer_id"" HAVING COUNT(1)=(SELECT COUNT(1) FROM ""product"")"
205,"SELECT ""c"".""customer_id"" FROM (SELECT ""a"".""customer_id"",""a"".""product_key"",COUNT(DISTINCT ""a"".""product_key"") AS ""cnt"" FROM ""Customer"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_key""=""b"".""product_key"" GROUP BY ""a"".""customer_id"") AS ""c"" WHERE ""c"".""cnt""=(SELECT COUNT(""d"".""product_key"") AS ""cnt"" FROM ""Product"" AS ""d"")"
206,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
207,"SELECT ""customer_id"" FROM (SELECT ""c"".""customer_id"",""p"".""product_key"" FROM ""customer"" AS ""c"" JOIN ""product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"") AS ""c_p"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
208,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
209,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
210,"WITH ""temp"" AS (SELECT DISTINCT ""P"".""product_key"",""C"".""customer_id"" FROM ""Product"" AS ""P"" JOIN ""Customer"" AS ""C"" USING (""product_key"")) SELECT ""customer_id"" FROM ""temp"" GROUP BY ""customer_id"" HAVING COUNT(""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
211,"WITH ""a"" AS (SELECT DISTINCT ""customer_id"",""product"".""product_key"" FROM ""Customer"" JOIN ""product"") SELECT DISTINCT ""a"".""customer_id"" FROM ""a"" WHERE ""a"".""customer_id"" NOT IN (SELECT ""a"".""customer_id"" FROM ""a"" LEFT JOIN ""Customer"" ON ""a"".""customer_id""=""customer"".""customer_id"" AND ""a"".""product_key""=""customer"".""product_key"" WHERE ""customer"".""product_key"" IS NULL)"
212,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
213,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
214,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
215,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
216,"WITH ""abc"" AS (SELECT ""a"".""customer_id"",COUNT(DISTINCT ""b"".""product_key"") AS ""counts"" FROM ""customer"" AS ""a"" JOIN ""customer"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""b"".""product_key"" IN (SELECT * FROM ""product"") AND (""a"".""product_key""!=""b"".""product_key"") GROUP BY 1) SELECT ""customer_id"" FROM ""abc"" WHERE ""counts""=(SELECT COUNT(1) FROM ""product"")"
217,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
218,"SELECT ""Sub"".""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""num_bought_product"" FROM ""Customer"" GROUP BY ""customer_id"") AS ""Sub"" WHERE ""Sub"".""num_bought_product""=(SELECT COUNT(""product_key"") FROM ""Product"")"
219,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",CASE WHEN COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""Product"") THEN 1 ELSE 0 END AS ""val"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING ""val""=1) AS ""A"""
220,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
221,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
222,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
223,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""c"".""product_key"") AS ""ct"" FROM ""Customer"" AS ""c"" RIGHT JOIN ""Product"" AS ""p"" ON ""c"".""product_key""=""p"".""product_key"" GROUP BY ""customer_id"") AS ""a"" WHERE ""ct""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
224,"SELECT DISTINCT ""customer_id"" FROM (SELECT ""customer_id"",""product_key"",DENSE_RANK() OVER (PARTITION BY ""customer_id"" ORDER BY ""product_key"") AS ""rnk"" FROM ""customer"") AS ""t"" WHERE ""rnk""=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
225,"SELECT DISTINCT ""a"".""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")) AS ""a"""
226,"WITH ""customers"" AS (SELECT DISTINCT ""customer_id"" FROM ""Customer""), ""possibilities"" AS (SELECT ""c"".""customer_id"",""p"".""product_key"" FROM (""Customer"" AS ""c"") JOIN ""Product"" AS ""p"") SELECT ""p"".""customer_id"" FROM ""possibilities"" AS ""p"" LEFT JOIN ""Customer"" AS ""c"" ON ""p"".""customer_id""=""c"".""customer_id"" AND ""p"".""product_key""=""c"".""product_key"" GROUP BY 1 HAVING COUNT(DISTINCT ""c"".""product_key"")=(SELECT COUNT(1) FROM ""Product"")"
227,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(""product_key"") OVER (PARTITION BY ""customer_id"") AS ""cnt"" FROM (SELECT DISTINCT * FROM ""Customer"") AS ""t"") SELECT DISTINCT ""customer_id"" FROM ""cte"" WHERE ""cnt""=(SELECT COUNT(1) FROM ""Product"")"
228,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
229,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
230,"SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""customer"" GROUP BY ""customer_id"") AS ""temp"" WHERE ""cnt""=(SELECT COUNT(1) FROM ""product"")"
231,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""product"")"
232,"SELECT ""customer_id"" FROM ""Customer"" AS ""C"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
233,"SELECT ""customer_id"" FROM ""customer"" AS ""c"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
234,"SELECT DISTINCT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
235,"WITH ""cte"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""Customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""cte"" WHERE ""cnt""=(SELECT COUNT(""product_key"") FROM ""Product"")"
236,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=ALL (SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
237,"WITH ""basic"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""NoProductsBought"" FROM ""Customer"" GROUP BY ""customer_id""), ""noproducts"" AS (SELECT COUNT(1) AS ""nop"" FROM ""Product"") SELECT ""customer_id"" FROM (""basic"") JOIN ""noproducts"" WHERE ""NoProductsBought""=""nop"""
238,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
239,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
240,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""Product"")"
241,"SELECT ""customer_id"" FROM ""customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""product"")"
242,"WITH ""CTE"" AS (SELECT DISTINCT ""customer_id"",""product_key"" FROM ""Customer""), ""CTE1"" AS (SELECT ""customer_id"",COUNT(1) AS ""cnt"" FROM ""CTE"" GROUP BY ""customer_id"" HAVING COUNT(1)=(SELECT COUNT(1) FROM ""Product"")) SELECT ""customer_id"" FROM ""CTE1"""
243,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT (""product_key""))=(SELECT COUNT(1) FROM ""product"")"
244,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
245,ERROR: An error occurred while restore SelectStmt.From: An error occurred while restore TableRefsClause.TableRefs: An error occurred while restore Join.Left: An error occurred while restore TableSource.Source: An error occurred while restore SelectStmt.Fields[1]: An error occurred while restore SelectField.Expr: Psql translation: string_agg does not support DISTINCT
246,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY 1 HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
247,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
248,"WITH ""t1"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""num_items"" FROM ""customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""t1"" WHERE ""num_items""=(SELECT COUNT(1) FROM ""product"")"
249,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")"
250,"SELECT ""customer_id"" FROM (SELECT *,COUNT(DISTINCT ""product_key"") FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(DISTINCT ""product_key"") FROM ""Product"")) AS ""l"""
251,ERROR: An error occurred while restore SelectStmt.From: An error occurred while restore TableRefsClause.TableRefs: An error occurred while restore Join.Left: An error occurred while restore TableSource.Source: An error occurred while restore SelectStmt.Fields[1]: An error occurred while restore SelectField.Expr: Psql translation: string_agg does not support DISTINCT
252,"WITH ""bought"" AS (SELECT ""customer_id"",COUNT(DISTINCT ""product_key"") AS ""cnt"" FROM ""customer"" GROUP BY ""customer_id"") SELECT ""customer_id"" FROM ""bought"" WHERE ""bought"".""cnt""=(SELECT COUNT(1) AS ""cnt"" FROM ""product"")"
253,"SELECT ""customer_id"" FROM ""customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(1) FROM ""product"")"
254,"SELECT ""customer_id"" FROM ""Customer"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""product_key"")=(SELECT COUNT(""product_key"") FROM ""Product"")"
