id,original query
1,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk_asc"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rnk_desc"" FROM ""Employee"") AS ""t1"" WHERE ABS(CAST(""rnk_asc"" AS INTEGER)-CAST(""rnk_desc"" AS INTEGER)) BETWEEN 0 AND 1"
2,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
3,"WITH ""cte_a"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""sal_rank"" FROM ""employee""), ""cte_b"" AS (SELECT CEIL(ROUND(COUNT(""Id"")/2, 1)) AS ""upper_median"",FLOOR(ROUND(COUNT(""Id"")/2, 1)) AS ""lower_median"",""Company"" FROM ""employee"" GROUP BY ""Company"") SELECT ""a"".""id"",""a"".""Company"",""a"".""Salary"" FROM (""cte_a"" AS ""a"") JOIN ""cte_b"" AS ""b"" WHERE ""a"".""Company""=""b"".""Company"" AND ((""b"".""upper_median""=""b"".""lower_median"") AND ""a"".""sal_rank"" IN (""b"".""upper_median"",""b"".""upper_median""+1) OR (""b"".""upper_median""!=""b"".""lower_median"") AND ""a"".""sal_rank""=""b"".""upper_median"")"
4,"WITH ""temp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rownum"",COUNT(1) OVER (PARTITION BY ""company"") AS ""total"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""temp"" WHERE ""rownum"" BETWEEN ""total""/2 AND ""total""/2+1"
5,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
6,"SELECT ""id"",""company"",""salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""RN_DESC"" FROM ""employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""company"",""salary"""
7,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
8,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rown"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""ID"",""Company"",""Salary"" FROM ""t1"" WHERE ""rown"" BETWEEN ""cnt""/2 AND ""cnt""/2+1"
9,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Ranknum"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cn"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""Ranknum"" BETWEEN (""cn""/2) AND (""cn""/2+1)"
10,"WITH ""salary_indeces"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ordered_index"" FROM ""employee""), ""company_info"" AS (SELECT ""company"",COUNT(""id"") AS ""company_total"",CASE WHEN COUNT(""id"")%2=0 THEN 'true' ELSE 'false' END AS ""is_even"" FROM ""employee"" GROUP BY 1), ""median_indices"" AS (SELECT ""company"",CEILING(""company_total""/2) AS ""lower_median_idx"",CASE WHEN ""is_even""='true' THEN CEILING(""company_total""/2)+1 ELSE NULL END AS ""upper_median_idx"" FROM ""company_info"" GROUP BY 1) SELECT ""s"".""id"",""s"".""company"",""s"".""salary"" FROM ""salary_indeces"" AS ""s"" JOIN ""median_indices"" AS ""m"" USING (""company"") WHERE ""ordered_index""=""lower_median_idx"" OR ""ordered_index""=""upper_median_idx"" AND ""upper_median_idx"" IS NOT NULL"
11,"WITH ""ranked_salary"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""Employee"") SELECT ""id"",""company"",""salary"" FROM ""ranked_salary"" WHERE ""row_num"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
12,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_UP"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DOWN"" FROM ""Employee"") AS ""temp"" WHERE ABS(CAST(""RN_UP"" AS INTEGER)-CAST(""RN_DOWN"" AS INTEGER))<=1 ORDER BY ""Company"",""Salary"""
13,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""ranking"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""com_ttl"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""ranking"">=""com_ttl""/2 AND ""ranking""<=""com_ttl""/2+1 ORDER BY 2,1"
14,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rownumber"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Cnt"" FROM ""Employee"") AS ""e"" WHERE ""e"".""rownumber"" BETWEEN (""e"".""Cnt""/2) AND (""e"".""Cnt""/2)+1"
15,"SELECT ""t1"".""Id"",""t1"".""Company"",""t1"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""Sort"",COUNT(1) OVER (PARTITION BY ""Company"")/2.0 AS ""Counts"" FROM ""Employee"") AS ""t1"" WHERE ""Sort"" BETWEEN ""Counts"" AND ""Counts""+1"
16,"WITH ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rk"" FROM ""Employee""), ""t2"" AS (SELECT ""Company"",AVG(""rk"") AS ""avg_rk"" FROM ""t1"" GROUP BY ""Company"") SELECT ""t1"".""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""t1"" JOIN ""t2"" ON ""t1"".""Company""=""t2"".""Company"" WHERE ABS(""t1"".""rk""-""t2"".""avg_rk"")<1"
17,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""row"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
18,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rnk_desc"" FROM ""Employee"") AS ""t"" WHERE ""rnk_asc"" BETWEEN ""rnk_desc""-1 AND ""rnk_desc""+1 ORDER BY 2,3"
19,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rn1"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rn2"" FROM ""Employee"") SELECT ""id"",""company"",""salary"" FROM ""cte"" WHERE ""rn1""+1=""rn2"" OR ""rn1""-1=""rn2"" UNION ALL SELECT ""id"",""company"",""salary"" FROM ""cte"" WHERE ""rn1""=""rn2"""
20,"WITH ""cte"" AS (SELECT ""id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"" FROM ""Employee""), ""cte2"" AS (SELECT ""Company"",COUNT(1) AS ""totr"" FROM ""cte"" GROUP BY ""Company"") SELECT ""cte"".""id"",""cte"".""Company"",""cte"".""Salary"" FROM ""cte"" JOIN ""cte2"" ON ""cte"".""Company""=""cte2"".""Company"" WHERE (FLOOR(""totr""/2)+1=""rn"") OR ((""totr""%2=0) AND (FLOOR(""totr""/2)=""rn""))"
21,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t"" WHERE ""rnk"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
22,"WITH ""CTE"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""t"" FROM ""Employee"") SELECT ""ID"",""Company"",""Salary"" FROM ""CTE"" WHERE ""rk"" IN (""t""/2,""t""/2+0.5,""t""/2+1)"
23,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
24,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranking"",COUNT(""company"") OVER (PARTITION BY ""Company"") AS ""total_num"" FROM ""Employee"" ORDER BY ""company"",""Salary"") AS ""temp"" WHERE (CASE WHEN ""total_num""%2=1 THEN ""ranking""=(1+""total_num"")/2 ELSE ""ranking"" IN (""total_num""/2,""total_num""/2+1) END)"
25,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""sa_rank"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""em_count"" FROM ""Employee"") AS ""new_rank"" WHERE ""sa_rank"" BETWEEN ""em_count""/2 AND ""em_count""/2+1"
26,"WITH ""temp"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rnk"",COUNT(""Id"") OVER (PARTITION BY ""company"") AS ""c1"" FROM ""employee""), ""temp2"" AS (SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""c1""%2!=0 AND ""rnk""=FLOOR(""c1""/2)+1), ""temp3"" AS (SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""c1""%2=0 AND (""rnk""=""c1""/2 OR ""rnk""=(""c1""/2)+1)) SELECT * FROM ""temp3"" UNION SELECT * FROM ""temp2"" ORDER BY ""Company"""
27,"WITH ""tb1"" AS (SELECT ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"",""Id"",""company"",""salary"" FROM ""employee"") SELECT ""tb1"".""id"",""company"",""salary"" FROM ""tb1"" WHERE ((""rowNum""=""cnt""/2 OR ""rowNum""=""cnt""/2+1) OR ""rowNum""=(""cnt""+1)/2)"
28,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Cnt"" FROM ""Employee"") AS ""a"" WHERE ""rnk"" BETWEEN (""Cnt""/2) AND ""Cnt""/2+1"
29,"WITH ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rk"" FROM ""Employee""), ""t2"" AS (SELECT ""Company"",AVG(""rk"") AS ""avg_rk"" FROM ""t1"" GROUP BY ""Company"") SELECT ""t1"".""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""t1"" JOIN ""t2"" ON ""t1"".""Company""=""t2"".""Company"" WHERE ABS(""t1"".""rk""-""t2"".""avg_rk"")<1"
30,"WITH ""Ranked_Employee"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rank_no"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""Employee"") SELECT ""id"",""company"",""salary"" FROM ""Ranked_Employee"" WHERE ""rank_no"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
31,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""row_num_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""row_num_desc"" FROM ""Employee"" ORDER BY ""Company"") AS ""temp1"" WHERE ""row_num_asc"" BETWEEN ""row_num_desc""-1 AND ""row_num_desc""+1 ORDER BY ""Company"",""Salary"""
32,"WITH ""tbl"" AS (SELECT ""Company"",COUNT(1) AS ""Numbers"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Employee"".""Company"" AS ""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Salary_rank"",""Numbers"" FROM ""Employee"" LEFT JOIN ""tbl"" ON ""Employee"".""Company""=""tbl"".""Company"") AS ""BASE"" WHERE ""Salary_rank"" BETWEEN ""Numbers""/2 AND ""Numbers""/2+1"
33,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Employee_Count_per_Company"" FROM ""Employee"") AS ""sq1"" WHERE ""rnum"" BETWEEN ""Employee_Count_per_Company""/2 AND ""Employee_Count_per_Company""/2+1"
34,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
35,"SELECT ""ID"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""ID"") AS ""asce"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""ID"" DESC) AS ""desce"" FROM ""Employee"") AS ""cte"" WHERE ""asce"" BETWEEN ""desce""-1 AND ""desce""+1 ORDER BY 2,3"
36,"WITH ""agg"" AS (SELECT ""id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_"",(COUNT(1) OVER (PARTITION BY ""Company""))/2 AS ""mid"" FROM ""Employee"" ORDER BY ""Salary"") SELECT ""id"" AS ""Id"",""Company"",""Salary"" FROM ""agg"" WHERE ""row_"" BETWEEN ""mid"" AND ""mid""+1 UNION SELECT ""id"" AS ""Id"",""Company"",""Salary"" FROM ""agg"" WHERE ""row_""=""mid"""
37,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""ranked"" FROM ""Employee"" AS ""e""), ""med_rank"" AS (SELECT ""Company"",(MAX(""ranked"")+MIN(""ranked""))/2 AS ""med"" FROM ""cte"" GROUP BY ""Company"") SELECT ""cte"".""Id"",""cte"".""Company"",""cte"".""Salary"" FROM ""cte"" LEFT JOIN ""med_rank"" ON ""cte"".""Company""=""med_rank"".""Company"" WHERE ""cte"".""ranked"" IN (FLOOR(""med_rank"".""med""),CEIL(""med_rank"".""med""))"
38,"WITH ""rankeddata"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""totalcount"" FROM ""Employee"" AS ""E"") SELECT ""Id"",""Company"",""Salary"" FROM ""rankeddata"" WHERE ""totalcount""%2=1 AND ""rnk""=FLOOR(""totalcount""/2)+1 UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""rankeddata"" WHERE ""totalcount""%2=0 AND (""rnk""=FLOOR(""totalcount""/2) OR ""rnk""=FLOOR(""totalcount""/2)+1)"
39,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""RN"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Ct"" FROM ""Employee"") AS ""t"" WHERE ""RN"" BETWEEN (""Ct""/2) AND (""Ct""/2+1)"
40,"WITH ""tmp"" AS (SELECT *,RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk_asc"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rnk_desc"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""tmp"" WHERE ""rnk_asc"" BETWEEN ""rnk_desc""-1 AND ""rnk_desc""+1"
41,"WITH ""t"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rnum"" FROM ""employee"") SELECT ""id"",""t"".""company"",""salary"" FROM (""t"") JOIN (SELECT ""company"",(CASE WHEN MAX(""rnum"")%2=0 THEN ROUND(MAX(""rnum"")/2, 0) ELSE ROUND(MAX(""rnum"")/2, 0) END) AS ""row1"",(CASE WHEN MAX(""rnum"")%2=0 THEN ROUND((MAX(""rnum"")/2)+1, 0) END) AS ""row2"" FROM ""t"" GROUP BY ""company"") AS ""r"" WHERE ""t"".""company""=""r"".""company"" AND (""t"".""rnum""=""r"".""row1"" OR ""t"".""rnum""=""r"".""row2"")"
42,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""number"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t"" WHERE ""number"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
43,"WITH ""T1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""company_count"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""T1"" WHERE ""row_num"" BETWEEN ""company_count""/2 AND ""company_count""/2+1"
44,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""ct"" FROM ""Employee"") AS ""a"" WHERE ""rn"" BETWEEN ""ct""/2 AND ""ct""/2+1"
45,"WITH ""temp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_nbr"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""total_nbr"",CEIL(COUNT(""Salary"") OVER (PARTITION BY ""Company"")/2) AS ""mid"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE (""total_nbr""%2=0 AND ""row_nbr"" IN (""mid"",""mid""+1)) OR (""total_nbr""%2=1 AND ""row_nbr""=""mid"")"
46,"WITH ""salary_ranked"" AS (SELECT *,RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ra"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC) AS ""rd"",COUNT(1) OVER (PARTITION BY ""company"") AS ""ct"" FROM ""employee"") SELECT DISTINCT FIRST_VALUE(""id"") OVER (PARTITION BY ""COMPANY"", ""salary"") AS ""id"",""company"",""salary"" FROM ""salary_ranked"" WHERE ""ra"" BETWEEN (""rd""-1) AND (""rd""+1) ORDER BY ""company"",""id"""
47,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""ranking1"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""ranking2"" FROM ""Employee"") AS ""sub"" WHERE 1.0*""ranking1""-1.0*""ranking2"" IN (0,1,-1)"
48,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""asc_rn"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""desc_rn"" FROM ""employee"") AS ""a"" WHERE ""asc_rn""=""desc_rn"" OR ""asc_rn""=""desc_rn""-1 OR ""asc_rn""=""desc_rn""+1"
49,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
50,"WITH ""t1"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""Employee"") SELECT ""ID"",""Company"",""Salary"" FROM ""t1"" WHERE ""rn""=""cnt""/2 OR ""rn""=CEILING((""cnt""+1)/2)"
51,"WITH ""tmp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""tot"" FROM ""employee"" ORDER BY ""company"",""row_num"") SELECT ""id"",""company"",""salary"" FROM ""tmp"" WHERE ""row_num"" IN (""tot""/2,FLOOR(""tot""/2+1))"
52,"WITH ""Salary_Rank"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""size"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""Salary_Rank"" AS ""s"" WHERE ""rk"" IN (""size""/2,""size""/2+1,(""size""+1)/2)"
53,"SELECT ""a"".""Id"",""a"".""Company"",""a"".""Salary"" FROM ((SELECT ""a"".""Id"",""a"".""Company"",""a"".""Salary"",""a"".""rnk"",""a"".""rown"",(""a"".""con""+1)/2 AS ""fif1"",(""a"".""con""+1)/2 AS ""fif2"" FROM (SELECT ""Id"",""Company"",""Salary"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC) AS ""rnk"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rown"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""con"" FROM ""Employee"") AS ""a"" WHERE (""a"".""con""%2)!=0) UNION ALL (SELECT ""b"".""Id"",""b"".""Company"",""b"".""Salary"",""b"".""rnk"",""b"".""rown"",(""b"".""con"")/2 AS ""fif1"",(""b"".""con""/2+1) AS ""fif2"" FROM (SELECT ""Id"",""Company"",""Salary"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC) AS ""rnk"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rown"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""con"" FROM ""Employee"") AS ""b"" WHERE (""b"".""con""%2)=0)) AS ""a"" WHERE (""a"".""rown""=""a"".""fif1"" OR ""a"".""rown""=""a"".""fif2"") ORDER BY ""Company"",""Salary"""
54,"WITH ""ranking"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rnk"",COUNT(""id"") OVER (PARTITION BY ""company"")/2 AS ""median"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""ranking"" WHERE (""rnk""=""median"" OR ""rnk""=""median""+1) OR (""rnk""=""median""+0.5)"
55,"WITH ""base"" AS (SELECT *,RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""sortloc"" FROM ""employee""), ""max"" AS (SELECT *,MAX(""sortloc"") OVER (PARTITION BY ""company"") AS ""max"" FROM ""base"") SELECT MIN(""id"") AS ""Id"",""Company"",""Salary"" FROM ""max"" WHERE ""sortloc"" IN (""max""-CEIL(""max""/2-1),1+CEIL(""max""/2-1)) GROUP BY ""company"",""salary"""
56,"ERROR: mysql parse error: line 1 column 224 near ""; 1 = 1 THEN num = (total + 1)/2 ELSE num = total/2 OR num = total/2 + 1 END"" "
57,"WITH ""temp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""roww"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""roww"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
58,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""Id"" DESC) AS ""rnk_desc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk_asc"" FROM ""Employee"") AS ""t"" WHERE ""rnk_asc"" BETWEEN ""rnk_desc""-1 AND ""rnk_desc""+1"
59,"SELECT DISTINCT ""id"",""company"",""salary"" FROM (SELECT ""a"".*,(CASE WHEN ""ct""%2!=0 THEN ROUND(""ct""/2) ELSE ROUND(""ct""/2)+1 END) AS ""ctt"",CASE WHEN ""ct""%2=0 THEN ROUND(""ct""/2) END AS ""cttt"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""med"",COUNT(1) OVER (PARTITION BY ""company"") AS ""ct"" FROM ""employee"") AS ""a"") AS ""b"" WHERE ""b"".""med""=""b"".""ctt"" OR ""b"".""med""=""b"".""cttt"""
60,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_id"",CASE WHEN COUNT(1) OVER (PARTITION BY ""Company"")%2!=0 THEN (COUNT(1) OVER (PARTITION BY ""Company"")+1)/2 ELSE COUNT(1) OVER (PARTITION BY ""Company"")/2 END AS ""odd_row"",CASE WHEN COUNT(1) OVER (PARTITION BY ""Company"")%2=0 THEN COUNT(1) OVER (PARTITION BY ""Company"")/2+1 END AS ""even_row"" FROM ""Employee"") AS ""med_wage"" WHERE ""row_id""=""odd_row"" OR ""row_id""=""even_row"""
61,"SELECT ""id"",""company"",""salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rn_asc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rn_desc"" FROM ""employee"") AS ""t"" WHERE ""rn_asc"" BETWEEN (""rn_desc""-1) AND (""rn_desc""+1) ORDER BY ""id"",""company"""
62,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
63,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranking"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""Employee"") AS ""a"" WHERE ""ranking"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
64,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""total_row"" FROM ""Employee"") AS ""t"" WHERE ""row_num"" IN (CEIL(""total_row""/2),FLOOR(""total_row""/2+1))"
65,"WITH ""salary_rank"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"" FROM ""Employee""), ""tot"" AS (SELECT ""Company"",COUNT(""Id"") AS ""total"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""Id"",""s"".""Company"",""Salary"" FROM ""salary_rank"" AS ""s"" JOIN ""tot"" AS ""t"" ON ""s"".""Company""=""t"".""Company"" WHERE ""rowNum"" BETWEEN ""t"".""total""/2.0 AND ""t"".""total""/2.0+1"
66,"SELECT ""a"".""Id"",""a"".""company"",""a"".""Salary"" FROM (SELECT ""Id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""salary"") AS ""rn"",COUNT(""id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") AS ""a"" WHERE (""a"".""rn""=(CASE WHEN ""a"".""cnt""%2=1 THEN CEILING(""a"".""cnt""/2) ELSE CEILING((""a"".""cnt""+1)/2) END)) OR (""a"".""rn""=(CASE WHEN ""a"".""cnt""%2=0 THEN ((""a"".""cnt"")/2) END))"
67,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""total_row"" FROM ""Employee"") AS ""t"" WHERE ""row_num"" IN (CEIL(""total_row""/2),FLOOR(""total_row""/2+1))"
68,"WITH ""main"" AS (SELECT ""Id"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""num"",""Company"",""Salary"" FROM ""Employee""), ""b2"" AS (SELECT COUNT(""Salary"") AS ""counts"",DIV(COUNT(""Salary""), 2) AS ""divNum"",""Company"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""main"".""Id"",""b2"".""Company"",(CASE WHEN ""b2"".""counts""%2=1 AND ""main"".""num""=""b2"".""divNum""+1 THEN ""main"".""Salary"" WHEN (""b2"".""counts""%2=0) AND (""main"".""num""=""b2"".""divNum""+1 OR ""main"".""num""=""b2"".""divNum"") THEN ""main"".""Salary"" END) AS ""Salary"" FROM ""main"" LEFT JOIN ""b2"" ON ""main"".""Company""=""b2"".""Company"" HAVING ""Salary"" IS NOT NULL"
69,"SELECT ""E"".""id"",""E"".""Company"",""E"".""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""emp_cnt"" FROM ""Employee"") AS ""E"" WHERE ""E"".""row_num"">=""emp_cnt""/2 AND ""E"".""row_num""<=(""emp_cnt""/2)+1"
70,"WITH ""rowemployee"" AS (SELECT CASE WHEN @""comp""=""Company"" THEN @""row_num"":=@""row_num""+1 ELSE @""row_num"":=1 END AS ""num"",""Id"",@""comp"":=""Company"" AS ""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") AS ""orderemployee"", (SELECT @""comp"":='',@""row_num"":=0) AS ""temp""), ""cntemployee"" AS (SELECT ""Company"",COUNT(""Id"") AS ""cnt"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""Id"",""rowemployee"".""Company"",""Salary"" FROM ""rowemployee"" JOIN ""cntemployee"" ON ""rowemployee"".""Company""=""cntemployee"".""Company"" WHERE (""rowemployee"".""num""=DIV(""cntemployee"".""cnt"", 2)+1) OR (""cntemployee"".""cnt""%2=0 AND ""rowemployee"".""num""=DIV(""cntemployee"".""cnt"", 2))"
71,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""employee_count"" FROM ""Employee"") AS ""employee_with_row_number"" WHERE ""row_num""=FLOOR((""employee_count""+1)/2) OR ""row_num""=FLOOR((""employee_count""+2)/2)"
72,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
73,"SELECT ""id"",""company"",""salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""r"",COUNT(1) OVER (PARTITION BY ""company"") AS ""n"" FROM ""employee"") AS ""t"" WHERE ""r"" BETWEEN ""n""/2 AND (""n""/2+1)"
74,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""sal_rank"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""company_count"" FROM ""Employee"") AS ""m"" WHERE ""m"".""sal_rank"" BETWEEN ""company_count""/2 AND ""company_count""/2+1"
75,"WITH ""temp"" AS (SELECT ""Id"",""Company"",""Salary"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""rn"" BETWEEN ""cnt""/2 AND ""cnt""/2+1 ORDER BY ""Id"""
76,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""ranking"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""com_ttl"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""ranking"">=""com_ttl""/2 AND ""ranking""<=""com_ttl""/2+1 ORDER BY 2,1"
77,"ERROR: mysql parse error: line 1 column 224 near ""; 1 = 1 THEN num = (total + 1)/2 ELSE num = total/2 OR num = total/2 + 1 END"" "
78,"WITH ""agg"" AS (SELECT ""id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_"",(COUNT(1) OVER (PARTITION BY ""Company""))/2 AS ""mid"" FROM ""Employee"" ORDER BY ""Salary"") SELECT ""id"" AS ""Id"",""Company"",""Salary"" FROM ""agg"" WHERE ""row_"" BETWEEN ""mid"" AND ""mid""+1"
79,"WITH ""base"" AS (SELECT *,RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""sortloc"" FROM ""employee""), ""max"" AS (SELECT *,MAX(""sortloc"") OVER (PARTITION BY ""company"") AS ""max"" FROM ""base"") SELECT MIN(""id"") AS ""Id"",""Company"",""Salary"" FROM ""max"" WHERE ""sortloc"" IN (""max""-CEIL(""max""/2-1),1+CEIL(""max""/2-1)) GROUP BY ""company"",""salary"""
80,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
81,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""Id"") AS ""rn_asc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""Id"" DESC) AS ""rn_desc"" FROM ""Employee"") AS ""temp"" WHERE ""rn_asc"" BETWEEN ""rn_desc""-1 AND ""rn_desc""+1 ORDER BY ""Company"",""Salary"""
82,"WITH ""med"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rk"",COUNT(""salary"") OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee""), ""med_f"" AS (SELECT ""Id"",""Company"",""Salary"",CASE WHEN ""cnt""=(""rk""-1)*2 THEN 1 WHEN ""cnt""=""rk""*2-1 THEN 1 WHEN ""cnt""=(""rk"")*2 THEN 1 ELSE 0 END AS ""med_lb"" FROM ""med"") SELECT ""Id"",""Company"",""Salary"" FROM ""med_f"" WHERE ""med_lb""=1"
83,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
84,"WITH ""Employee_RN"" AS (SELECT ""Id"",""Company"",""Salary"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""R"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""N"" FROM ""Employee"" AS ""e""), ""meds"" AS (SELECT ""Id"",""Company"",""Salary"" FROM ""Employee_RN"" WHERE ""R""<=(1.0*""N""+1)/2+0.5 AND ""R"">=(1.0*""N""+1)/2-0.5) SELECT MIN(""Id"") AS ""Id"",""Company"",""Salary"" FROM ""meds"" GROUP BY ""Company"",""Salary"""
85,"WITH ""salary_ranks"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""salary_rank"" FROM ""employee"" ORDER BY ""company"",""salary""), ""salary_mid_ranks"" AS (SELECT ""company"",MAX(""salary_rank"")/2 AS ""mid_rank"" FROM ""salary_ranks"" GROUP BY ""company"") SELECT ""t1"".""id"",""t1"".""company"",""t1"".""salary"" FROM ""salary_ranks"" AS ""t1"" JOIN ""salary_mid_ranks"" AS ""t2"" ON ""t2"".""company""=""t1"".""company"" WHERE (""t1"".""salary_rank""=""t2"".""mid_rank"" OR ""t1"".""salary_rank""=""t2"".""mid_rank""+1 OR ""t1"".""salary_rank""=""t2"".""mid_rank""+0.5) ORDER BY ""t1"".""company"",""t1"".""salary"""
86,"WITH ""salary_rank"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"" FROM ""Employee""), ""tot"" AS (SELECT ""Company"",COUNT(""Id"") AS ""total"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""Id"",""s"".""Company"",""Salary"" FROM ""salary_rank"" AS ""s"" JOIN ""tot"" AS ""t"" ON ""s"".""Company""=""t"".""Company"" WHERE ""rowNum"" BETWEEN ""t"".""total""/2.0 AND ""t"".""total""/2.0+1"
87,"WITH ""tmp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""row_num_asc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""row_num_desc"" FROM ""employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""tmp"" WHERE ABS(CAST(""row_num_asc"" AS DECIMAL(10))-CAST(""row_num_desc"" AS DECIMAL(10))) IN (0,1)"
88,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""salary_rank_asc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""salary_rank_desc"" FROM ""employee"" ORDER BY ""company"",""salary"") AS ""t"" WHERE ""salary_rank_asc"" BETWEEN ""salary_rank_desc""-1 AND ""salary_rank_desc""+1 ORDER BY ""company"",""salary"""
89,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""row1"" FROM ""employee""), ""cte1"" AS ((SELECT ""company"",CASE WHEN MAX(""row1"")%2=0 THEN MAX(""row1"")/2 ELSE (MAX(""row1"")+1)/2 END AS ""row1"" FROM ""cte"" GROUP BY 1) UNION (SELECT ""company"",CASE WHEN MAX(""row1"")%2=0 THEN MAX(""row1"")/2+1 ELSE (MAX(""row1"")+1)/2 END AS ""row1"" FROM ""cte"" GROUP BY 1)) SELECT ""id"",""cte"".""company"",""salary"" FROM ""cte"" JOIN ""cte1"" USING (""row1"",""company"")"
90,"WITH ""Salary_rank"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""count_comp"" FROM ""Employee"" AS ""e"") SELECT ""ID"",""Company"",""Salary"" FROM ""Salary_rank"" WHERE ""rn"" BETWEEN ""count_comp""/2 AND ""count_comp""/2+1"
91,"WITH ""CET"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""ROW_NUM"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT DISTINCT ""Id"",""Company"",""Salary"" FROM ""CET"" WHERE ROW(""Company"",""ROW_NUM"") IN (SELECT ""Company"",(CASE WHEN ""cnt""%2=1 THEN (""cnt""+1)/2 ELSE ""cnt""/2 END) FROM ""CET"") OR ROW(""Company"",""ROW_NUM"") IN (SELECT ""Company"",(CASE WHEN ""cnt""%2=1 THEN (""cnt""+1)/2 ELSE ""cnt""/2+1 END) FROM ""CET"")"
92,"SELECT ""M"".""ID"",""M"".""COMPANY"",""M"".""SALARY"" FROM (SELECT ""ID"",""COMPANY"",""SALARY"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""SALARY"") AS ""RNK"",COUNT(""SALARY"") OVER (PARTITION BY ""COMPANY"") AS ""CNT"" FROM ""EMPLOYEE"") AS ""M"" WHERE ""RNK"">=""CNT""/2 AND ""RNK""<=""CNT""/2+1"
93,"WITH ""employee_rn"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""count_emp"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""employee_rn"" WHERE ""rn"" BETWEEN ""count_emp""/2 AND ""count_emp""/2+1"
94,"WITH ""ranking"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rnk"",COUNT(""id"") OVER (PARTITION BY ""company"")/2 AS ""median"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""ranking"" WHERE (""rnk""=""median"" OR ""rnk""=""median""+1) OR (""rnk""=""median""+0.5)"
95,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Salary_rk"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""total_rk"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""total_rk""%2=0 AND (""Salary_rk""=""total_rk""/2 OR ""Salary_rk""=""total_rk""/2+1) OR (""total_rk""%2=1 AND ""Salary_rk""=(""total_rk""+1)/2) ORDER BY 2,1"
96,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",""rnk"",MAX(""rnk"") OVER (PARTITION BY ""Company"") AS ""max_rnk"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"" FROM ""Employee"") AS ""TBL"") AS ""TBL2"" WHERE ""rnk""=""max_rnk""/2 OR ""rnk""=""max_rnk""/2+1 OR ""rnk""=FLOOR((""max_rnk""+1)/2)"
97,"SELECT ""id"",""Company"",""Salary"" FROM (SELECT ""id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",COUNT(""Company"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") AS ""a"" WHERE ""rn"" BETWEEN ""cnt""/2 AND ""cnt""/2+1"
98,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rn_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rn_desc"" FROM ""Employee"") AS ""temp"" WHERE ""rn_asc"" BETWEEN ""rn_desc""-1 AND ""rn_desc""+1 ORDER BY ""Company"",""Salary"""
99,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_numbers"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""counts"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") AS ""t"" WHERE ""row_numbers"" BETWEEN ""counts""*1.0/2 AND ""counts""*1.0/2+1"
100,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
101,"WITH ""num_ees"" AS (SELECT ""company"",COUNT(1) AS ""cnt"" FROM ""employee"" GROUP BY 1), ""ordered_ees"" AS (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""sal_rank"" FROM ""employee"" GROUP BY 1,2,3) SELECT DISTINCT ""o"".""id"",""o"".""company"",""o"".""salary"" FROM ""ordered_ees"" AS ""o"" JOIN ""num_ees"" AS ""n"" ON ""n"".""company""=""o"".""company"" WHERE ""o"".""sal_rank"" BETWEEN (""n"".""cnt""/2) AND (""n"".""cnt""/2)+1"
102,"WITH ""company_rnk"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""company_rnk"" WHERE ""rnk"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
103,"SELECT ""u"".""Id"",""u"".""company"",""u"".""salary"" FROM (SELECT *,(CASE WHEN ""t"".""ct""%2=0 AND (""t"".""rk""=""t"".""ct""/2 OR ""t"".""rk""=""t"".""ct""/2+1) THEN 1 WHEN ""t"".""ct""%2=1 AND ""t"".""rk""=(""t"".""ct""+1)/2 THEN 1 ELSE 0 END) AS ""flag"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rk"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""ct"" FROM ""employee"") AS ""t"") AS ""u"" WHERE ""u"".""flag""=1"
104,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""no_rank"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") AS ""t"" WHERE ""no_rank"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
105,"WITH ""t"" AS (SELECT ""Company"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY ""Company"") SELECT MIN(""Id"") AS ""Id"",""Company"",""Salary"" FROM ""Employee"" WHERE ROW(""Company"",""Salary"") IN (SELECT ""Company"",""Salary"" FROM (SELECT ""e"".""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""r"",""cnt"" FROM ""Employee"" AS ""e"" JOIN ""t"" ON ""e"".""Company""=""t"".""Company"") AS ""t"" WHERE (""t"".""cnt""%2=0 AND (""r""=""t"".""cnt""/2 OR ""r""=""t"".""cnt""/2+1)) OR (""t"".""cnt""%2=1 AND (""r""=FLOOR(""t"".""cnt""/2)+1))) GROUP BY ""Company"",""Salary"""
106,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
107,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""Company"") AS ""Cnt"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"" FROM ""Employee"") AS ""t1"" WHERE ""row_num"" BETWEEN ""Cnt""/2 AND ""Cnt""/2+1"
108,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT DISTINCT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_index"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""ct"" FROM ""Employee"") AS ""a"" WHERE ""row_index"" BETWEEN ""ct""/2 AND ""ct""/2+1"
109,"WITH ""base"" AS (SELECT *,RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""sortloc"" FROM ""employee""), ""max"" AS (SELECT *,MAX(""sortloc"") OVER (PARTITION BY ""company"") AS ""max"" FROM ""base"") SELECT MIN(""id"") AS ""Id"",""Company"",""Salary"" FROM ""max"" WHERE ""sortloc"" IN (""max""-CEIL(""max""/2-1),1+CEIL(""max""/2-1)) GROUP BY ""company"",""salary"""
110,"WITH ""comp_count"" AS (SELECT DISTINCT ""company"",COUNT(1) AS ""cnt"" FROM ""employee"" GROUP BY ""company""), ""rank_comp"" AS (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""drank"" FROM ""employee"") SELECT ""r"".""id"",""r"".""company"",""r"".""salary"" FROM ""rank_comp"" AS ""r"" LEFT JOIN ""comp_count"" AS ""c"" ON ""r"".""company""=""c"".""company"" WHERE ""r"".""drank"">=ROUND(""c"".""cnt""/2, 2) AND ""r"".""drank""<=ROUND((""c"".""cnt""/2)+1, 1)"
111,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",(COUNT(1) OVER (PARTITION BY ""Company"")+1)*0.5 AS ""half"" FROM ""Employee"") AS ""temp"" WHERE ""rn"" IN (FLOOR(""half""),CEILING(""half""))"
112,"WITH ""base"" AS (SELECT *,RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""sortloc"" FROM ""employee""), ""max"" AS (SELECT *,MAX(""sortloc"") OVER (PARTITION BY ""company"") AS ""max"" FROM ""base"") SELECT MIN(""id"") AS ""Id"",""Company"",""Salary"" FROM ""max"" WHERE ""sortloc"" IN (""max""-CEIL(""max""/2-1),1+CEIL(""max""/2-1)) GROUP BY ""company"",""salary"""
113,"SELECT ""t1"".""Id"",""t1"".""Company"",""t1"".""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",DENSE_RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""Sort"",COUNT(1) OVER (PARTITION BY ""Company"")/2.0 AS ""Counts"" FROM ""Employee"") AS ""t1"" WHERE ""Sort"" BETWEEN ""Counts"" AND ""Counts""+1"
114,"WITH ""salary_ranks"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""salary_rank"" FROM ""employee"" ORDER BY ""company"",""salary""), ""salary_mid_ranks"" AS (SELECT ""company"",MAX(""salary_rank"")/2 AS ""mid_rank"" FROM ""salary_ranks"" GROUP BY ""company"") SELECT ""t1"".""id"",""t1"".""company"",""t1"".""salary"" FROM ""salary_ranks"" AS ""t1"" JOIN ""salary_mid_ranks"" AS ""t2"" ON ""t2"".""company""=""t1"".""company"" WHERE (""t1"".""salary_rank""=""t2"".""mid_rank"" OR ""t1"".""salary_rank""=""t2"".""mid_rank""+1 OR ""t1"".""salary_rank""=""t2"".""mid_rank""+0.5) ORDER BY ""t1"".""company"",""t1"".""salary"""
115,"WITH ""CTE"" AS (SELECT ""Id"",""Company"",""Salary"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""total"",CEIL(COUNT(""Salary"") OVER (PARTITION BY ""Company"")/2) AS ""mid"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"") AS ""RN"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""CTE"" WHERE (""total""%2=0 AND ""RN"" IN (""mid"",""mid""+1)) OR (""total""%2=1 AND ""RN""=""mid"")"
116,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""total"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""current_row"" FROM ""Employee"") AS ""t"" WHERE (""total""%2=0 AND (""current_row""=FLOOR(""total""/2) OR ""current_row""=FLOOR(""total""/2)+1)) OR (""total""%2=1 AND ""current_row""=FLOOR(""total""/2)+1) ORDER BY ""Id"""
117,"WITH ""cte2"" AS (WITH ""cte1"" AS (SELECT ""e1"".""id"",""e1"".""Company"",""e1"".""Salary"",ROW_NUMBER() OVER (PARTITION BY ""e1"".""company"" ORDER BY ""e1"".""Salary"",""e1"".""id"") AS ""rnk"" FROM ""Employee"" AS ""e1"" GROUP BY ""e1"".""id"",""e1"".""Company"",""e1"".""Salary"") SELECT *,COUNT(""rnk"") OVER (PARTITION BY ""Company"") AS ""Total_emp"" FROM ""cte1"") SELECT ""Id"",""Company"",ROUND(AVG(""Salary""), 0) AS ""Salary"" FROM ""cte2"" WHERE ""rnk"" IN (""Total_emp""/2,(""Total_emp""/2)+0.5,(""Total_emp""/2)+1) GROUP BY ""Id"",""Company"""
118,"WITH ""cte"" AS (SELECT ""id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"" FROM ""Employee""), ""cte2"" AS (SELECT ""Company"",COUNT(1) AS ""totr"" FROM ""cte"" GROUP BY ""Company"") SELECT ""cte"".""id"",""cte"".""Company"",""cte"".""Salary"" FROM ""cte"" JOIN ""cte2"" ON ""cte"".""Company""=""cte2"".""Company"" WHERE (FLOOR(""totr""/2)+1=""rn"") OR ((""totr""%2=0) AND (FLOOR(""totr""/2)=""rn""))"
119,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""ranked"",COUNT(1) OVER (PARTITION BY ""company"") AS ""counted"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""cte"" WHERE CASE WHEN ""counted""%2=0 THEN ""ranked""=FLOOR((""counted""+1)/2) OR ""ranked""=CEIL((""counted""+1)/2) WHEN ""counted""%2=1 THEN ""ranked""=CEIL((""counted""+1)/2) END"
120,"WITH ""rk"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""employee""), ""total"" AS (SELECT ""company"",MAX(""rn"") AS ""total_e"" FROM ""rk"" GROUP BY ""company"") SELECT DISTINCT ""r"".""id"",""r"".""company"",""r"".""salary"" FROM ""rk"" AS ""r"" JOIN ""total"" AS ""t"" ON ""r"".""company""=""t"".""company"" AND (""r"".""rn""=FLOOR((""t"".""total_e""+1)/2) OR ""r"".""rn""=CEIL((""t"".""total_e""+1)/2)) ORDER BY ""r"".""id"""
121,"SELECT ""a"".""id"",""a"".""company"",""a"".""salary"" FROM (SELECT ""Id"",""company"",""salary"",DENSE_RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""sorts"",COUNT(1) OVER (PARTITION BY ""company"") AS ""Counts"" FROM ""Employee"") AS ""a"" WHERE ""sorts"" BETWEEN ""counts""/2 AND (""counts""/2)+1"
122,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""total_row"" FROM ""Employee"") AS ""t"" WHERE ""row_num"" IN (CEIL(""total_row""/2),FLOOR(""total_row""/2+1))"
123,"SELECT ""a"".""id"",""a"".""company"",""a"".""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rownum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""employee"") AS ""a"" WHERE ""a"".""rownum"" BETWEEN ""a"".""compCount""/2 AND ""a"".""compCount""/2+1"
124,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""id"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
125,"WITH ""temp"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rank_no"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""rank_no"" IN (CEIL(""cnt""/2),FLOOR((""cnt""/2)+1))"
126,"WITH ""cte"" AS (SELECT ""company"",COUNT(""id"") AS ""total"" FROM ""employee"" GROUP BY ""company""), ""dte"" AS (SELECT ""id"",""company"",""salary"",""total"" FROM ""employee"" NATURAL JOIN ""cte"") SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rk"",""salary"",""total"" FROM ""dte"") AS ""r1"" WHERE ""rk"" BETWEEN ""total""/2 AND ""total""/2+1"
127,"WITH ""t"" AS (SELECT ""Company"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk"",""Salary"",""Id"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t"" WHERE ""cnt""%2=0 AND ""rnk"" IN (""cnt""/2,""cnt""/2+1) UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""t"" WHERE ""cnt""%2=1 AND ""rnk""=CEIL(""cnt""/2)"
128,"SELECT ""id"" AS ""Id"",""company"" AS ""Company"",""salary"" AS ""Salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rk1"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rk2"" FROM ""employee"") AS ""A"" WHERE ""rk1""=""rk2"" OR ABS(CAST(""rk1"" AS DECIMAL(10))-CAST(""rk2"" AS DECIMAL(10)))=1 ORDER BY ""company"",""salary"""
129,"WITH ""ordered_salary"" AS (SELECT ""Id"",""Company"",""Salary"",COUNT(""id"") OVER (PARTITION BY ""Company"") AS ""ct"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_id"" FROM ""employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""ordered_salary"" WHERE ""row_id"" BETWEEN ""ct""/2 AND ""ct""/2+1"
130,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",CASE WHEN ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"")=ROUND((COUNT(""Id"") OVER (PARTITION BY ""Company""))/2) THEN 1 WHEN (COUNT(""Id"") OVER (PARTITION BY ""Company""))%2=0 AND ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"")=ROUND((COUNT(""Id"") OVER (PARTITION BY ""Company""))/2)+1 THEN 1 ELSE 0 END AS ""flag"" FROM ""Employee"") AS ""a"" WHERE ""flag""=1 ORDER BY ""Company"",""Salary"""
131,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""total_row"" FROM ""Employee"") AS ""t"" WHERE ""row_num"" IN (CEIL(""total_row""/2),FLOOR(""total_row""/2+1))"
132,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rnum"",COUNT(1) OVER (PARTITION BY ""company"") AS ""num"" FROM ""employee"") AS ""tmp"" WHERE ""rnum"" BETWEEN ""num""/2 AND ""num""/2+1"
133,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",CASE WHEN COUNT(""Id"") OVER (PARTITION BY ""company"")%2=0 AND ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0)=ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") THEN 'es' WHEN COUNT(""Id"") OVER (PARTITION BY ""company"")%2=0 AND ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0)+1=ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") THEN 'ets' WHEN COUNT(""Id"") OVER (PARTITION BY ""company"")%2!=0 AND ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0)=ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") THEN 'exs' ELSE 'No' END AS ""rating"" FROM ""Employee"") AS ""A"" WHERE ""rating"" IN ('es','ets','exs')"
134,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""ranking"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""com_ttl"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""ranking"">=""com_ttl""/2 AND ""ranking""<=""com_ttl""/2+1 ORDER BY 2,1"
135,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Rank1"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Subtotal"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""Rank1""=FLOOR((""Subtotal""+1)/2) OR ""Rank1""=FLOOR((""Subtotal""+2)/2) GROUP BY ""Company"",""Salary"""
136,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""r"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""c"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""r"" BETWEEN ""c""/2 AND ""c""/2+1"
137,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rw"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""rw"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
138,"WITH ""tb1"" AS (SELECT ""company"",COUNT(""company"") AS ""ct"" FROM ""employee"" GROUP BY ""company""), ""tb2"" AS (SELECT ""company"",CASE WHEN ""ct""%2=0 THEN ""ct""/2 ELSE CEILING(""ct""/2) END AS ""ct"" FROM ""tb1"" UNION ALL SELECT ""company"",""ct""/2+1 AS ""ct"" FROM ""tb1"" WHERE ""ct""%2=0), ""tb3"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rk"" FROM ""employee"") SELECT ""tb3"".""id"",""tb2"".""company"",""tb3"".""salary"" FROM (""tb2"") JOIN ""tb3"" WHERE ""tb2"".""ct""=""rk"" AND ""tb2"".""company""=""tb3"".""company"""
139,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
140,"WITH ""temp"" AS (SELECT *,COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""cnt""%2=1 AND ""rnk""=(DIV(""cnt"", 2))+1 UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""cnt""%2=0 AND (""rnk""=(DIV(""cnt"", 2)) OR ""rnk""=(DIV(""cnt"", 2))+1)"
141,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") AS ""k"" WHERE ""rk"">=""cnt""/2 AND ""rk""<=(""cnt""/2)+1"
142,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",DENSE_RANK() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ABS(CAST(""RN_ASC"" AS INTEGER)-CAST(""RN_DESC"" AS INTEGER))<=1 ORDER BY ""Company"",""Salary"""
143,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""Employee"") AS ""tab"" WHERE ""rnk"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
144,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",COUNT(""salary"") AS ""freq"" FROM ""employee"" GROUP BY ""company"",""salary"") SELECT ""a"".""id"",""a"".""company"",""a"".""salary"" FROM ""cte"" AS ""a"" WHERE ""a"".""freq"">=ABS((SELECT SUM(""freq"") FROM ""cte"" WHERE ""a"".""salary"">=""cte"".""salary"" AND ""a"".""company""=""cte"".""company"")-(SELECT SUM(""freq"") FROM ""cte"" WHERE ""a"".""salary""<=""cte"".""salary"" AND ""a"".""company""=""cte"".""company""))"
145,"WITH ""cte1"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""employee"" ORDER BY ""company"",""salary""), ""cte2"" AS (SELECT ""id"",""company"",""salary"",""rn"",MIN(""rn"") OVER (PARTITION BY ""company"") AS ""min_rn"",MAX(""rn"") OVER (PARTITION BY ""company"") AS ""max_rn"" FROM ""cte1"") SELECT ""id"",""company"",""salary"" FROM ""cte2"" WHERE ""rn""=FLOOR((""min_rn""+""max_rn"")/2) OR ""rn""=CEIL((""min_rn""+""max_rn"")/2)"
146,"SELECT ""b"".""Id"",""b"".""Company"",""b"".""Salary"" FROM (SELECT ""Company"",ROUND(COUNT(""Salary"")/2) AS ""poi"" FROM ""Employee"" GROUP BY ""Company"") AS ""a"" JOIN (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""salary_row"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""salary_row_desc"" FROM ""Employee"") AS ""b"" ON ""a"".""Company""=""b"".""Company"" WHERE (""a"".""poi""=""b"".""salary_row"") OR (""a"".""poi""=""b"".""salary_row_desc"" AND ""b"".""salary_row_desc""!=""b"".""salary_row"")"
147,"WITH ""cte1"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""employee"" ORDER BY ""company"",""salary""), ""cte2"" AS (SELECT ""id"",""company"",""salary"",""rn"",MIN(""rn"") OVER (PARTITION BY ""company"") AS ""min_rn"",MAX(""rn"") OVER (PARTITION BY ""company"") AS ""max_rn"" FROM ""cte1"") SELECT ""id"",""company"",""salary"" FROM ""cte2"" WHERE ""rn""=FLOOR((""min_rn""+""max_rn"")/2) OR ""rn""=CEIL((""min_rn""+""max_rn"")/2)"
148,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""salary_rank"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""total_number"" FROM ""Employee"") AS ""New"" WHERE (CASE WHEN ""total_number""%2!=0 THEN ""salary_rank""=(""total_number""+1)/2 ELSE ""salary_rank""=""total_number""/2 OR ""salary_rank""=""total_number""/2+1 END)"
149,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rw"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""rw"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
150,"WITH ""temp"" AS (SELECT ""t"".""Id"",""t"".""Company"",""t"".""Salary"",""t"".""ranking"",""u"".""cnt"" FROM (SELECT ""Id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""Salary"",""Id"") AS ""ranking"" FROM ""Employee"") AS ""t"" LEFT JOIN (SELECT ""company"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY ""company"") AS ""u"" ON ""t"".""company""=""u"".""company"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE (""cnt""%2=0 AND ""ranking""=(DIV(""cnt"", 2))) OR (""ranking""=(DIV(""cnt"", 2))+1) ORDER BY ""Company"",""Salary"""
151,"WITH ""rk"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""employee""), ""total"" AS (SELECT ""company"",MAX(""rn"") AS ""total_e"" FROM ""rk"" GROUP BY ""company"") SELECT DISTINCT ""r"".""id"",""r"".""company"",""r"".""salary"" FROM ""rk"" AS ""r"" JOIN ""total"" AS ""t"" ON ""r"".""company""=""t"".""company"" AND (""r"".""rn""=FLOOR((""t"".""total_e""+1)/2) OR ""r"".""rn""=CEIL((""t"".""total_e""+1)/2)) ORDER BY ""r"".""id"""
152,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Rank1"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Subtotal"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""Rank1""=FLOOR((""Subtotal""+1)/2) OR ""Rank1""=FLOOR((""Subtotal""+2)/2) GROUP BY ""Company"",""Salary"""
153,"WITH ""CTE"" AS (SELECT ""ID"",""COMPANY"",""SALARY"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""SALARY"") AS ""RK"" FROM ""EMPLOYEE"") SELECT ""X"".""ID"",""X"".""COMPANY"",""X"".""SALARY"" FROM (SELECT ""ID"",""COMPANY"",""SALARY"",""RK"",MAX(""RK"") OVER (PARTITION BY ""COMPANY"") AS ""MX_RK"" FROM ""CTE"") AS ""X"" WHERE ""RK""=CASE WHEN ""MX_RK""%2=0 THEN ""MX_RK""/2+1 ELSE (""MX_RK""+1)/2 END OR ""RK""=CASE WHEN ""MX_RK""%2=0 THEN ""MX_RK""/2 ELSE (""MX_RK""+1)/2 END"
154,"SELECT ""c1"".""Id"",""c1"".""Company"",""c1"".""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_numbers"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") AS ""c1"" JOIN (SELECT ""Company"",COUNT(""Salary"") AS ""counts"" FROM ""Employee"" GROUP BY ""Company"") AS ""t1"" ON ""c1"".""Company""=""t1"".""Company"" WHERE ""c1"".""row_numbers"" BETWEEN ""counts""*1.0/2 AND ""counts""*1.0/2+1"
155,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
156,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk_asc"",RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rnk_desc"" FROM ""Employee"") AS ""temp"" WHERE ABS(CAST(""rnk_asc"" AS INTEGER)-CAST(""rnk_desc"" AS INTEGER)) BETWEEN 0 AND 1"
157,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rank_no"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") AS ""rank_table"" WHERE ""rank_no"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
158,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""ranking"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""com_ttl"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""ranking"">=""com_ttl""/2 AND ""ranking""<=""com_ttl""/2+1 ORDER BY ""company"",""id"""
159,"WITH ""rank_info"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rnk_desc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk_aesc"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""rank_info"" WHERE ""rnk_desc"" BETWEEN ""rnk_aesc""-1 AND ""rnk_aesc""+1 ORDER BY ""company"",""salary"""
160,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
161,"WITH ""cte"" AS (SELECT ""Id"",""Company"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"",""Salary"" FROM ""Employee""), ""cte1"" AS (SELECT ""Company"",MAX(""rnk"") AS ""max_rnk"" FROM ""cte"" GROUP BY ""Company""), ""cte2"" AS (SELECT ""Company"",CEIL(""max_rnk""/2) AS ""idx"" FROM ""cte1"" UNION SELECT ""Company"",FLOOR(""max_rnk""/2)+1 AS ""idx"" FROM ""cte1"") SELECT ""Id"",""e"".""Company"",""Salary"" FROM ""cte"" AS ""e"" RIGHT JOIN ""cte2"" ON ""e"".""Company""=""cte2"".""Company"" AND ""e"".""rnk""=""cte2"".""idx"" ORDER BY ""Company"",""Salary"""
162,"WITH ""rnum"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""asc_rn"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""desc_rn"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""rnum"" WHERE ""asc_rn""=""desc_rn"" UNION ALL SELECT ""id"",""company"",""salary"" FROM ""rnum"" WHERE ""asc_rn""+1=""desc_rn"" OR ""asc_rn""-1=""desc_rn"" ORDER BY ""company"",""salary"""
163,"WITH ""cte_rnk"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk"" FROM ""Employee""), ""cte_n"" AS (SELECT ""Company"",COUNT(""Id"") AS ""n"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""r"".""Id"",""r"".""Company"",""r"".""Salary"" FROM ""cte_rnk"" AS ""r"" JOIN ""cte_n"" AS ""n"" ON ""r"".""Company""=""n"".""Company"" WHERE 2*""r"".""rnk""=""n"".""n"" OR 2*""r"".""rnk""-1=""n"".""n"" OR 2*""r"".""rnk""-2=""n"".""n"""
164,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
165,"WITH ""cte1"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""employee"" ORDER BY ""company"",""salary""), ""cte2"" AS (SELECT ""id"",""company"",""salary"",""rn"",MIN(""rn"") OVER (PARTITION BY ""company"") AS ""min_rn"",MAX(""rn"") OVER (PARTITION BY ""company"") AS ""max_rn"" FROM ""cte1"") SELECT ""id"",""company"",""salary"" FROM ""cte2"" WHERE ""rn"" IN (FLOOR((""min_rn""+""max_rn"")/2),CEIL((""min_rn""+""max_rn"")/2))"
166,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""num_rank"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""company_count"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE (""company_count""%2=0 AND (""num_rank""=""company_count""/2 OR ""num_rank""=""company_count""/2+1)) OR (""company_count""%2=1 AND ""num_rank""=""company_count""/2+0.5)"
167,"WITH ""t"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""r"" FROM ""employee""), ""u"" AS (SELECT ""id"",""company"",""salary"",""r"",AVG(""r"") OVER (PARTITION BY ""company"") AS ""mr"" FROM ""t"") SELECT ""id"",""company"",""salary"" FROM ""u"" WHERE ABS(""r""-""mr"")<=0.51"
168,"SELECT ""t1"".""Id"",""t1"".""Company"",""t1"".""Salary"" FROM (SELECT ""e"".""Id"",""e"".""Company"",""e"".""Salary"",CASE WHEN @""comp_name""=""e"".""Company"" THEN @""rank"":=@""rank""+1 ELSE @""rank"":=1 END AS ""sal_rank"",@""comp_name"":=""e"".""Company"" AS ""comp_name"" FROM (SELECT @""comp_name"":='A',@""rank"":=0) AS ""var"", ""Employee"" AS ""e"" ORDER BY ""Company"",""Salary"") AS ""t1"" LEFT JOIN (SELECT ""Company"",COUNT(""Id"") AS ""empl_num"" FROM ""Employee"" GROUP BY ""Company"") AS ""t2"" ON ""t1"".""Company""=""t2"".""Company"" WHERE ""t1"".""sal_rank"" IN (""t2"".""empl_num""/2,""t2"".""empl_num""/2+0.5,""t2"".""empl_num""/2+1)"
169,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
170,"WITH ""a"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rank"" FROM ""employee""), ""b"" AS (SELECT ""company"",COUNT(""a"".""rank"") AS ""count"" FROM ""a"" GROUP BY 1), ""c"" AS (SELECT ""company"",ROUND(CASE WHEN ""b"".""count""%2=0 THEN ""b"".""count""/2 ELSE (""b"".""count""+1)/2 END, 0) AS ""count"" FROM ""b"" GROUP BY 1 UNION SELECT ""company"",ROUND(CASE WHEN ""b"".""count""%2=0 THEN ""b"".""count""/2+1 ELSE (""b"".""count""+1)/2 END, 0) AS ""count"" FROM ""b"" GROUP BY 1 ORDER BY 1) SELECT ""a"".""id"",""a"".""company"",""a"".""salary"" FROM ""a"" JOIN ""c"" WHERE ""a"".""company""=""c"".""company"" AND ""a"".""rank""=""c"".""count"" ORDER BY 2,3"
171,"SELECT ""A"".""Id"",""A"".""Company"",""A"".""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""R"" FROM ""Employee"") AS ""A"" WHERE ROW(""A"".""Company"",""A"".""R"") IN (SELECT ""B"".""Company"",""B"".""flr"" FROM (SELECT ""Company"",FLOOR((COUNT(1)+1)/2) AS ""flr"" FROM ""Employee"" GROUP BY ""Company"") AS ""B"") OR ROW(""A"".""Company"",""A"".""R"") IN (SELECT ""B"".""Company"",""B"".""ceil"" FROM (SELECT ""Company"",CEILING((COUNT(1)+1)/2) AS ""ceil"" FROM ""Employee"" GROUP BY ""Company"") AS ""B"")"
172,"WITH ""table1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""num"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""reverse_num"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""table1"" WHERE ""reverse_num""=""num"" UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""table1"" WHERE ""reverse_num""=""num""+1 OR ""reverse_num""=""num""-1 ORDER BY ""Company"",""Id"""
173,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""salary"",""Id"") AS ""rn_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rn_desc"" FROM ""Employee"") AS ""temp"" WHERE ""rn_asc"" BETWEEN ""rn_desc""-1 AND ""rn_desc""+1 ORDER BY ""Company"",""Salary"""
174,"WITH ""CTE"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"" FROM ""Employee""), ""CTE1"" AS (SELECT MAX(""rn"")/2 AS ""m1"",(MAX(""rn"")/2)+1 AS ""m2"",""Company"" FROM ""CTE"" GROUP BY ""Company"") SELECT ""E"".""Id"",""E"".""Company"",""E"".""Salary"" FROM ""CTE"" AS ""E"" JOIN ""CTE1"" AS ""C1"" ON ""E"".""Company""=""C1"".""Company"" AND ""E"".""rn"" BETWEEN ""C1"".""m1"" AND ""C1"".""m2"""
175,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""ss"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""numId"" FROM ""Employee"") AS ""p1"" WHERE ""ss"">=""numId""/2 AND ""ss""<=""numId""/2+1"
176,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rk"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee"") AS ""a"" WHERE ""rk"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
177,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""ranking"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""com_ttl"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""ranking"">=""com_ttl""/2 AND ""ranking""<=""com_ttl""/2+1"
178,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""ranks"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""counts"" FROM ""Employee"") AS ""t1"" WHERE CASE WHEN ""counts""%2=0 THEN ""ranks""=DIV(""counts"", 2) OR ""ranks""=DIV(""counts"", 2)+1 ELSE ""ranks""=DIV(""counts"", 2)+1 END"
179,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rnk_desc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk_asc"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""rnk_asc"" BETWEEN ""rnk_desc""-1 AND ""rnk_desc""+1 GROUP BY ""Id"",""Company"""
180,"WITH ""salary_ranks"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""salary_rank"" FROM ""employee"" ORDER BY ""company"",""salary""), ""salary_mid_ranks"" AS (SELECT ""company"",MAX(""salary_rank"")/2 AS ""mid_rank"" FROM ""salary_ranks"" GROUP BY ""company"") SELECT ""t1"".""id"",""t1"".""company"",""t1"".""salary"" FROM ""salary_ranks"" AS ""t1"" JOIN ""salary_mid_ranks"" AS ""t2"" ON ""t2"".""company""=""t1"".""company"" WHERE (""t1"".""salary_rank""=""t2"".""mid_rank"" OR ""t1"".""salary_rank""=""t2"".""mid_rank""+1 OR ""t1"".""salary_rank""=""t2"".""mid_rank""+0.5) ORDER BY ""t1"".""company"",""t1"".""salary"""
181,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
182,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""row_numbers"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""counts"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") AS ""t"" WHERE ""row_numbers"" BETWEEN ""counts""*1.0/2 AND ""counts""*1.0/2+1"
183,"WITH ""temp_table"" AS (SELECT *,COUNT(""id"") OVER (PARTITION BY ""company"") AS ""cnt"",DENSE_RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk"" FROM ""employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp_table"" WHERE (""cnt""%2=0) AND (""rnk""=(""cnt""/2) OR ""rnk""=(""cnt""/2)+1) UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""temp_table"" WHERE ""cnt""%2=1 AND ""rnk""=(DIV(""cnt"", 2))+1"
184,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
185,"WITH ""t"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""num"" FROM ""Employee""), ""t2"" AS (SELECT ""Id"",""Company"",""Salary"",""num"",MAX(""num"") OVER (PARTITION BY ""Company"") AS ""total"" FROM ""t"") SELECT ""Id"",""Company"",""Salary"" FROM ""t2"" WHERE ""total""%2=0 AND ""num"" IN (""total""/2,""total""/2+1) UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""t2"" WHERE ""total""%2=1 AND ""num""=(""total""+1)/2"
186,"SELECT ""t"".""Id"",""t"".""Company"",""t"".""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"" FROM ""Employee"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY 1) AS ""y"" USING (""company"") WHERE ""cnt""%2!=0 AND ""rnk""=(""cnt""+1)/2 UNION SELECT ""t"".""Id"",""t"".""Company"",""t"".""Salary"" FROM (SELECT *,DENSE_RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC) AS ""rnk"" FROM ""Employee"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY 1) AS ""y"" USING (""company"") WHERE ""cnt""%2=0 AND ""rnk""=""cnt""/2 OR ""rnk""=""cnt""/2+1 ORDER BY 2,3"
187,"WITH ""a"" AS (SELECT ""ID"",""COMPANY"",""SALARY"",(ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""SALARY"")) AS ""r"",(COUNT(""ID"") OVER (PARTITION BY ""COMPANY"")) AS ""total"" FROM ""EMPLOYEE""), ""b"" AS (SELECT ""id"",""COMPANY"",""salary"" FROM ""a"" WHERE (""total""%2=0 AND ""total""/2=""r"") OR (""total""%2=0 AND ""total""/2+1=""r"") OR (""total""%2=1 AND (""total""+1)/2=""r"")) SELECT * FROM ""b"" ORDER BY ""Company"""
188,"WITH ""temp_table"" AS (SELECT *,COUNT(""id"") OVER (PARTITION BY ""company"") AS ""cnt"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk"" FROM ""employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp_table"" WHERE (""cnt""%2=0) AND (""rnk""=(""cnt""/2) OR ""rnk""=(""cnt""/2)+1) UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""temp_table"" WHERE ""cnt""%2=1 AND ""rnk""=(DIV(""cnt"", 2))+1"
189,"WITH ""rank_employee"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""raw_rank"" FROM ""Employee""), ""avg_row_number"" AS (SELECT ""Company"",AVG(""raw_rank"") AS ""avg_row"" FROM ""rank_employee"" GROUP BY 1) SELECT ""E1"".""id"",""E1"".""Company"",""E1"".""Salary"" FROM ""rank_employee"" AS ""E1"" JOIN ""avg_row_number"" AS ""E2"" ON ""E1"".""Company""=""E2"".""Company"" WHERE ABS(""E1"".""raw_rank""-""E2"".""avg_row"")<1"
190,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rn_desc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rn_asc"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1"
191,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""increaserank"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""decreaserank"" FROM ""employee"") AS ""temp"" WHERE ""temp"".""increaserank""=""temp"".""decreaserank"" OR ""temp"".""increaserank""+1=""temp"".""decreaserank"" OR ""temp"".""increaserank""-1=""temp"".""decreaserank"""
192,"SELECT ""computer"".""id"",""computer"".""company"",""computer"".""Salary"" FROM ""employee"" AS ""emp"" JOIN (SELECT ""id"",""company"",""Salary"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""Cnt"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"") AS ""Rnk"" FROM ""Employee"") AS ""computer"" ON ""emp"".""company""=""computer"".""company"" AND ((""Cnt""%2=0 AND (""computer"".""Rnk""=FLOOR(""Cnt""/2))) OR (""Cnt""%2=0 AND (""computer"".""Rnk""=CEIL((""Cnt""+1)/2))) OR (""Cnt""%2=1 AND (""computer"".""Rnk""=CEIL(""Cnt""/2)))) AND ""emp"".""id""=""computer"".""id"""
193,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""cte"" WHERE ""row_num"" BETWEEN ""cnt""/2 AND (""cnt""+2)/2"
194,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""n"",COUNT(1) OVER (PARTITION BY ""company"") AS ""total"" FROM ""Employee"") AS ""tmp"" WHERE ""n"" BETWEEN ""total""/2 AND ""total""/2+1"
195,"SELECT ""id"",""company"",""salary"" FROM ""Employee"" WHERE ""id"" IN (SELECT DISTINCT ""id"" FROM (SELECT ""t1"".""id"",ABS(SUM(CASE WHEN ""t1"".""salary"">""t2"".""salary"" THEN 1 WHEN ""t1"".""salary""<""t2"".""salary"" THEN -1 WHEN ""t1"".""salary""=""t2"".""salary"" AND ""t1"".""id"">""t2"".""id"" THEN 1 WHEN ""t1"".""salary""=""t2"".""salary"" AND ""t1"".""id""<""t2"".""id"" THEN -1 ELSE 0 END)) AS ""score"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""company""=""t2"".""company"" GROUP BY ""t1"".""id"" HAVING ""score""<=1) AS ""t"")"
196,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""count_com"" FROM ""Employee"") AS ""t"" WHERE ""row_num"" BETWEEN ""count_com""/2 AND ""count_com""/2+1"
197,"WITH ""orderemployee"" AS (SELECT ""Id"",""Company"",""Salary"" FROM ""Employee"" ORDER BY ""Company"",""Salary""), ""rowemployee"" AS (SELECT @""row_number"":=CASE WHEN @""customer_no""=""Company"" THEN @""row_number""+1 ELSE 1 END AS ""num"",@""customer_no"":=""Company"" AS ""Company"",""Id"",""Salary"" FROM (""orderemployee"") JOIN (SELECT @""customer_no"":='',@""row_number"":=0) AS ""t""), ""medianemployee"" AS (SELECT ""Company"",CASE WHEN COUNT(""Company"")%2=0 THEN DIV(COUNT(""Company""), 2) ELSE DIV(COUNT(""Company""), 2)+1 END AS ""median_num"" FROM ""Employee"" GROUP BY ""Company"" UNION SELECT ""Company"",CASE WHEN COUNT(""Company"")%2=0 THEN DIV(COUNT(""Company""), 2)+1 END AS ""median_num"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""r"".""Id"",""r"".""Company"",""r"".""Salary"" FROM ""rowemployee"" AS ""r"" JOIN ""medianemployee"" AS ""m"" ON ""r"".""Company""=""m"".""Company"" AND ""r"".""num""=""m"".""median_num"""
198,"SELECT ""t"".""Id"",""t"".""Company"",""t"".""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rnk"" FROM ""Employee"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY 1) AS ""y"" USING (""company"") WHERE (""cnt""%2!=0 AND ""rnk""=(""cnt""+1)/2) OR (""cnt""%2=0 AND (""rnk""=""cnt""/2 OR ""rnk""=""cnt""/2+1))"
199,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""Temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1"
200,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Rank1"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Subtotal"" FROM ""Employee"") AS ""t1"" WHERE ""Rank1""=FLOOR((""Subtotal""+1)/2) OR ""Rank1""=FLOOR((""Subtotal""+2)/2) GROUP BY ""Company"",""Salary"""
201,"WITH ""rowemployee"" AS (SELECT CASE WHEN @""comp""=""Company"" THEN @""row_num"":=@""row_num""+1 ELSE @""row_num"":=1 END AS ""num"",""Id"",@""comp"":=""Company"" AS ""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") AS ""orderemployee"", (SELECT @""comp"":='',@""row_num"":=0) AS ""temp""), ""cntemployee"" AS (SELECT ""Company"",COUNT(""Id"") AS ""cnt"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""Id"",""rowemployee"".""Company"",""Salary"" FROM ""rowemployee"" JOIN ""cntemployee"" ON ""rowemployee"".""Company""=""cntemployee"".""Company"" WHERE (""rowemployee"".""num""=DIV(""cntemployee"".""cnt"", 2)+1) OR (""cntemployee"".""cnt""%2=0 AND ""rowemployee"".""num""=DIV(""cntemployee"".""cnt"", 2))"
202,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(1) OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""ct"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") AS ""t"" WHERE ""rk""<=(1+""ct"")/2+0.5 AND ""rk"">=(1+""ct"")/2-0.5"
203,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ro"",ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0) AS ""ha"",COUNT(""Id"") OVER (PARTITION BY ""company"")%2 AS ""ha1"",CASE WHEN COUNT(""Id"") OVER (PARTITION BY ""company"")%2=0 AND ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0)=ROW_NUMBER() OVER (PARTITION BY ""company"") THEN 'es' WHEN COUNT(""Id"") OVER (PARTITION BY ""company"")%2=0 AND ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0)+1=ROW_NUMBER() OVER (PARTITION BY ""company"") THEN 'ets' WHEN COUNT(""Id"") OVER (PARTITION BY ""company"")%2!=0 AND ROUND(COUNT(""Id"") OVER (PARTITION BY ""company"")/2, 0)=ROW_NUMBER() OVER (PARTITION BY ""company"") THEN 'exs' ELSE 'No' END AS ""rating"" FROM ""Employee"") AS ""A"" WHERE ""rating"" IN ('es','ets','exs')"
204,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"") AS ""ranks"",COUNT(""company"") OVER (PARTITION BY ""company"") AS ""num"" FROM ""employee"") AS ""a"" WHERE ""ranks"" IN (CEIL(""num""/2),""num""/2+1) ORDER BY ""company"",""salary"""
205,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""e"".""Id"",""e"".""Company"",""e"".""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rnk"",""t1"".""cnt"" FROM ""Employee"" AS ""e"" JOIN (SELECT ""Company"",COUNT(1) AS ""cnt"" FROM ""Employee"" GROUP BY ""Company"") AS ""t1"" ON ""e"".""Company""=""t1"".""Company"") AS ""t2"" WHERE ""rnk""=(CASE WHEN ""cnt""/2=FLOOR(""cnt""/2) THEN ""cnt""/2 ELSE FLOOR(""cnt""/2)+1 END) OR ""rnk""=(CASE WHEN ""cnt""/2=FLOOR(""cnt""/2) THEN ""cnt""/2+1 ELSE FLOOR(""cnt""/2)+1 END)"
206,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""salary_rank_asc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""salary_rank_desc"" FROM ""employee"" ORDER BY ""company"",""salary"") AS ""t"" WHERE ""salary_rank_asc"" BETWEEN ""salary_rank_desc""-1 AND ""salary_rank_desc""+1 ORDER BY ""company"",""salary"""
207,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
208,"WITH ""T1"" AS (SELECT ""A"".""Company"",COUNT(1) AS ""even_emp"" FROM ""Employee"" AS ""A"" GROUP BY 1 HAVING COUNT(1)%2=0), ""T2"" AS (SELECT ""A"".""Company"",COUNT(1) AS ""odd_emp"" FROM ""Employee"" AS ""A"" GROUP BY 1 HAVING COUNT(1)%2!=0), ""t3"" AS (SELECT ""A"".""Id"",""T1"".""Company"",""A"".""Salary"",""T1"".""even_emp"",ROW_NUMBER() OVER (PARTITION BY ""A"".""Company"" ORDER BY ""A"".""Salary"") AS ""rownum1"" FROM ""T1"" JOIN ""Employee"" AS ""A"" ON ""A"".""Company""=""T1"".""Company""), ""t4"" AS (SELECT ""B"".""Id"",""T2"".""Company"",""B"".""Salary"",""T2"".""odd_emp"",ROW_NUMBER() OVER (PARTITION BY ""B"".""Company"" ORDER BY ""B"".""Salary"") AS ""rownum2"" FROM ""T2"" JOIN ""Employee"" AS ""B"" ON ""B"".""Company""=""T2"".""Company"") SELECT ""t3"".""Id"",""t3"".""Company"",""t3"".""Salary"" FROM ""t3"" WHERE ""rownum1""=""even_emp""/2 OR ""rownum1""=(""even_emp""/2)+1 UNION ALL SELECT ""t4"".""Id"",""t4"".""Company"",""t4"".""Salary"" FROM ""t4"" WHERE ""rownum2""=((""odd_emp""-1)/2)+1"
209,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rk_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rk_desc"" FROM ""Employee"") AS ""rslt"" WHERE ""rk_asc"" BETWEEN ""rk_desc""-1 AND ""rk_desc""+1"
210,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rk1"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rk2"" FROM ""Employee"") AS ""temp"" WHERE ""rk1"" BETWEEN ""rk2""-1 AND ""rk2""+1 ORDER BY ""Company"",""Salary"""
211,"WITH ""base"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"",""id"") AS ""com_rnk"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""com_rnk_rev"" FROM ""Employee"") SELECT ""id"",""company"",""salary"" FROM ""base"" WHERE ""base"".""com_rnk_rev""=""base"".""com_rnk"" UNION ALL SELECT ""id"",""company"",""salary"" FROM ""base"" WHERE ""base"".""com_rnk_rev""=""base"".""com_rnk""+1 OR ""base"".""com_rnk_rev""=""base"".""com_rnk""-1 ORDER BY ""company"",""id"""
212,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""order_company"",COUNT(""ID"") OVER (PARTITION BY ""Company"") AS ""count_company"" FROM ""Employee"") AS ""a"" WHERE ""order_company"" BETWEEN FLOOR((""count_company""+1)/2.0) AND CEIL((""count_company""+1)/2.0)"
213,"WITH ""temp_table"" AS (SELECT *,COUNT(""id"") OVER (PARTITION BY ""company"") AS ""cnt"",DENSE_RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk"" FROM ""employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp_table"" WHERE (""cnt""%2=0) AND (""rnk""=(""cnt""/2) OR ""rnk""=(""cnt""/2)+1) UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""temp_table"" WHERE ""cnt""%2=1 AND ""rnk""=(DIV(""cnt"", 2))+1"
214,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rn"",COUNT(1) OVER (PARTITION BY ""Company"")/2 AS ""pos"" FROM ""Employee"") AS ""s"" WHERE ""rn""-""pos"" BETWEEN 0 AND 1 ORDER BY 2,3"
215,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""salaryrank"",COUNT(1) OVER (PARTITION BY ""company"") AS ""tte"" FROM ""employee"") AS ""foo"" WHERE ""salaryrank"">=""tte""/2 AND ""salaryrank""<=""tte""/2+1"
216,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""id"") AS ""Rasc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""id"" DESC) AS ""Rdesc"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""Rasc"" BETWEEN ""Rdesc""-1 AND ""Rdesc""+1 ORDER BY ""Company"",""Salary"""
217,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""R"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""T"" FROM ""Employee"") AS ""Employee"" WHERE ""R"" BETWEEN ""T""/2 AND ""T""/2+1"
218,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""ranked"",COUNT(1) OVER (PARTITION BY ""company"") AS ""counted"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""cte"" WHERE CASE WHEN ""counted""%2=0 THEN ""ranked""=FLOOR((""counted""+1)/2) OR ""ranked""=CEIL((""counted""+1)/2) WHEN ""counted""%2=1 THEN ""ranked""=CEIL((""counted""+1)/2) END"
219,"SELECT ""id"",""company"",""Salary"" FROM (SELECT ""id"",""company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""c"" FROM ""Employee"") AS ""temp"" WHERE ""row_num"" IN (FLOOR(""c""/2)+1,CEIL(""c""/2))"
220,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""id"") AS ""rk"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") AS ""cnt"" WHERE ""rk"" BETWEEN ""cnt""/2 AND ""cnt""/2+1"
221,"WITH ""CTE"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""SALARY"") AS ""ROW_NUM"",COUNT(""ID"") OVER (PARTITION BY ""COMPANY"") AS ""TOTAL"" FROM ""EMPLOYEE"") SELECT ""ID"",""COMPANY"",""SALARY"" FROM ""CTE"" WHERE ""ROW_NUM"" IN (FLOOR((""TOTAL""+1)/2),CEIL((""TOTAL""+1)/2))"
222,"WITH ""CTE"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""id"" DESC) AS ""r"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""ct"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""CTE"" WHERE ""r"" BETWEEN ""ct""/2 AND ""ct""/2+1"
223,"SELECT ""Id"",""Company"",AVG(""Salary"") AS ""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""salary_rank"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""total"" FROM ""Employee"") AS ""t1"" WHERE (""t1"".""salary_rank""*2-1=""t1"".""total"" AND ""t1"".""total""%2=1) OR (""t1"".""salary_rank""*2=""t1"".""total"" AND ""t1"".""total""%2=0) OR (""t1"".""salary_rank""*2-2=""t1"".""total"" AND ""t1"".""total""%2=0) GROUP BY ""Id"",""Company"""
224,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rank_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rank_desc"" FROM ""Employee"") AS ""tem"" WHERE ""rank_asc"" BETWEEN ""rank_desc""-1 AND ""rank_desc""+1 ORDER BY ""Company"",""Salary"""
225,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"") AS ""rownum"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""ct"" FROM ""employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""rownum"" BETWEEN ""ct""/2.0 AND ""ct""/2.0+1"
226,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",DENSE_RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""ascrank"",DENSE_RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""dscrank"" FROM ""Employee"") AS ""a"" WHERE ""ascrank"" BETWEEN ""dscrank""-1 AND ""dscrank""+1"
227,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",""ranked"",MAX(""ranked"") OVER (PARTITION BY ""company"" ORDER BY ""company"") AS ""max_rank"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranked"" FROM ""employee"") AS ""f"") AS ""f"" WHERE CASE WHEN ""max_rank""%2=0 THEN ""ranked""=""max_rank""/2 OR ""ranked""=""max_rank""/2+1 ELSE ""ranked""=(""max_rank""+1)/2 END"
228,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""company"",""salary"",COUNT(""ID"") OVER (PARTITION BY ""company"") AS ""ct"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rn"" FROM ""Employee"") AS ""base"" WHERE ""rn"" BETWEEN ""ct""/2 AND ""ct""/2+1 ORDER BY ""Company"",""Salary"""
229,"WITH ""table1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""num"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""reverse_num"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""table1"" WHERE ""reverse_num""=""num"" UNION ALL SELECT ""Id"",""Company"",""Salary"" FROM ""table1"" WHERE ""reverse_num""=""num""+1 OR ""reverse_num""=""num""-1 ORDER BY ""Company"",""Id"""
230,"WITH ""ordered_salary"" AS (SELECT ""id"",""company"",""salary"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""ct"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rowid"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""ordered_salary"" WHERE ""rowid"" BETWEEN ""ct""/2 AND ""ct""/2+1"
231,"WITH ""temp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""roww"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""temp"" WHERE ""roww"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
232,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""RN"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Ct"" FROM ""Employee"") AS ""t"" WHERE ""RN"" BETWEEN (""Ct""/2) AND (""Ct""/2+1)"
233,"SELECT ""a"".""id"",""a"".""company"",""a"".""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranks"",COUNT(""id"") OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee"") AS ""a"" WHERE ""ranks"">=""cnt""/2 AND ""ranks""<=""cnt""/2+1"
234,"WITH ""c"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rno"",COUNT(""Id"") OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee"") SELECT ""Id"",""company"",""salary"" FROM ""c"" WHERE ""rno""=(""cnt""+1)/2 OR ""rno""=""cnt""/2 OR ""rno""=""cnt""/2+1"
235,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""number"",COUNT(""Salary"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t"" WHERE ""number"" BETWEEN ""cnt""/2 AND ""cnt""/2+1"
236,"WITH ""temp"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""rnk_asc"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"" DESC,""id"" DESC) AS ""rnk_desc"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""temp"" WHERE ""rnk_asc""=""rnk_desc"" OR ""rnk_asc""=""rnk_desc""-1 OR ""rnk_asc""=""rnk_desc""+1 ORDER BY ""company"",""salary"""
237,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""row_num"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
238,"WITH ""emp"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""Salary"",""id"") AS ""RN"" FROM ""employee"") SELECT ""emp"".""Id"",""emp"".""Company"",""emp"".""Salary"" FROM ""emp"" JOIN (SELECT ""Company"",DIV(COUNT(1), 2) AS ""middle"",CASE WHEN COUNT(1)%2=0 THEN 'Even' ELSE 'Odd' END AS ""EvenOdd"" FROM ""Employee"" GROUP BY ""Company"") AS ""e"" ON ""emp"".""Company""=""e"".""company"" AND ((""e"".""EvenOdd""='Even' AND ""emp"".""RN"" IN (""e"".""middle"",""e"".""middle""+1)) OR (""e"".""EvenOdd""='Odd' AND ""emp"".""RN""=""e"".""middle""+1)) ORDER BY ""emp"".""Id"",""emp"".""Company"",""emp"".""Salary"""
239,"SELECT ""t1"".""Id"",""t1"".""Company"",""t1"".""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Sort"",COUNT(1) OVER (PARTITION BY ""Company"")/2.0 AS ""Counts"" FROM ""Employee"") AS ""t1"" WHERE ""Sort"" BETWEEN ""Counts"" AND ""Counts""+1"
240,"WITH ""cte_rnk"" AS (SELECT ""e1"".""Id"",MIN(""e1"".""Salary"") AS ""Salary"",MIN(""e1"".""Company"") AS ""Company"",COUNT(""e2"".""Id"") AS ""rnk"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON ""e1"".""Company""=""e2"".""Company"" AND (""e1"".""Salary"">""e2"".""Salary"" OR (""e1"".""Salary""=""e2"".""Salary"" AND ""e1"".""Id"">=""e2"".""Id"")) GROUP BY ""e1"".""Id""), ""cte_n"" AS (SELECT ""Company"",COUNT(""Id"") AS ""n"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""r"".""Id"",""r"".""Company"",""r"".""Salary"" FROM ""cte_rnk"" AS ""r"" JOIN ""cte_n"" AS ""n"" ON ""r"".""Company""=""n"".""Company"" WHERE 2*""r"".""rnk""=""n"".""n"" OR 2*""r"".""rnk""-1=""n"".""n"" OR 2*""r"".""rnk""-2=""n"".""n"""
241,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rw"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""t1"" WHERE ""rw"" BETWEEN ""cnt""/2.0 AND ""cnt""/2.0+1"
242,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rowNum"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""compCount"" FROM ""Employee"") AS ""counted"" WHERE ""rowNum"" BETWEEN ""compCount""/2 AND ""compCount""/2+1"
243,"WITH ""cte"" AS (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""ranked"",COUNT(1) OVER (PARTITION BY ""company"") AS ""counted"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""cte"" WHERE CASE WHEN ""counted""%2=0 THEN ""ranked""=FLOOR((""counted""+1)/2) OR ""ranked""=CEIL((""counted""+1)/2) WHEN ""counted""%2=1 THEN ""ranked""=CEIL((""counted""+1)/2) END"
244,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""Rank1"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""Subtotal"" FROM ""Employee"") AS ""t1"" WHERE ""Rank1""=FLOOR((""Subtotal""+1)/2) OR ""Rank1""=FLOOR((""Subtotal""+2)/2) GROUP BY ""Company"",""Salary"""
245,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""num"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""rk"" BETWEEN ""num""/2 AND ""num""/2+1"
246,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",""ranked"",MAX(""ranked"") OVER (PARTITION BY ""company"" ORDER BY ""company"") AS ""max_rank"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranked"" FROM ""employee"") AS ""f"") AS ""f"" WHERE CASE WHEN ""max_rank""%2=0 THEN ""ranked""=""max_rank""/2 OR ""ranked""-1=""max_rank""/2 ELSE ""ranked""=CEILING(""max_rank""/2) END"
247,"SELECT MIN(""t"".""id"") AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",COUNT(1) AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND ""a"".""salary"">=""b"".""salary"" GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1 GROUP BY ""t"".""company"",""t"".""salary"""
248,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",""ranked"",MAX(""ranked"") OVER (PARTITION BY ""company"" ORDER BY ""company"") AS ""max_rank"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranked"" FROM ""employee"") AS ""f"") AS ""f"" WHERE CASE WHEN ""max_rank""%2=0 THEN ""ranked""=""max_rank""/2 OR ""ranked""-1=""max_rank""/2 ELSE ""ranked""=CEILING(""max_rank""/2) END"
249,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",""ranked"",MAX(""ranked"") OVER (PARTITION BY ""company"" ORDER BY ""company"") AS ""max_rank"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranked"" FROM ""employee"") AS ""f"") AS ""f"" WHERE CASE WHEN ""max_rank""%2=0 THEN ""ranked""=""max_rank""/2 OR ""ranked""-1=""max_rank""/2 ELSE ""ranked""=CEILING(""max_rank""/2) END"
250,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""salary"") AS ""ordered"",COUNT(""id"") OVER (PARTITION BY ""Company"") AS ""ter"" FROM ""employee"") AS ""T"" WHERE ""ordered"" IN (FLOOR((""ter""+1)/2),CEIL((""ter""+1)/2))"
251,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,COUNT(1) OVER (PARTITION BY ""Company"") AS ""counts"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_num"" FROM ""Employee"") AS ""temp"" WHERE ""temp"".""row_num"" IN (CEILING(""temp"".""counts""/2),(""temp"".""counts""/2)+1)"
252,"SELECT MIN(""t"".""id"") AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",COUNT(1) AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND ""a"".""salary"">=""b"".""salary"" GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1 GROUP BY ""t"".""company"",""t"".""salary"""
253,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",""ranked"",MAX(""ranked"") OVER (PARTITION BY ""company"" ORDER BY ""company"") AS ""max_rank"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""ranked"" FROM ""employee"") AS ""f"") AS ""f"" WHERE CASE WHEN ""max_rank""%2=0 THEN ""ranked""=""max_rank""/2 OR ""ranked""-1=""max_rank""/2 ELSE ""ranked""=CEILING(""max_rank""/2) END"
254,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rno"",COUNT(1) OVER (PARTITION BY ""Company"") AS ""cnt"" FROM ""Employee"") SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" WHERE ""rno"" IN (CEIL(""cnt""/2),""cnt""/2+1)"
255,"SELECT MIN(""t"".""id"") AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",COUNT(1) AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND ""a"".""salary"">=""b"".""salary"" GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1 GROUP BY ""t"".""company"",""t"".""salary"""
256,"WITH ""temp"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""tot"" FROM ""Employee"") SELECT ""id"",""company"",""salary"" FROM (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""num"",COUNT(1) OVER (PARTITION BY ""company"") AS ""tot"" FROM ""Employee"") AS ""tmp"" WHERE ""num"" BETWEEN ""tot""/2 AND (""tot"")/2+1"
257,"SELECT ""t"".""id"" AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",SUM(CASE WHEN ""a"".""salary""<""b"".""salary"" OR ""a"".""id""<""b"".""id"" THEN 1 ELSE 0 END)+1 AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND (""a"".""salary""<=""b"".""salary"") GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1"
258,"WITH ""c"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rno"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee"") SELECT ""c"".""id"",""c"".""company"",""c"".""salary"" FROM ""c"" WHERE ""c"".""rno"" IN (CEIL(""c"".""cnt""/2),""c"".""cnt""/2+1)"
259,"SELECT MIN(""t"".""id"") AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",COUNT(1) AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND ""a"".""salary"">=""b"".""salary"" GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1 GROUP BY ""t"".""company"",""t"".""salary"""
260,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"",""Id"") AS ""RN_ASC"",ROW_NUMBER() OVER (PARTITION BY ""COMPANY"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""RN_DESC"" FROM ""Employee"") AS ""temp"" WHERE ""RN_ASC"" BETWEEN ""RN_DESC""-1 AND ""RN_DESC""+1 ORDER BY ""Company"",""Salary"""
261,"WITH ""cnt"" AS (SELECT ""Company"",COUNT(""Id"") AS ""c"" FROM ""Employee"" GROUP BY ""Company""), ""m"" AS (SELECT ""Company"",CASE WHEN ""c""%2=1 THEN 0 ELSE -1 END AS ""n"",FLOOR(""c""/2)+1 AS ""md"" FROM ""cnt"") SELECT ""Id"",""e"".""Company"",""salary"" FROM (SELECT ""Id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""Id"") AS ""rnk"" FROM ""employee"") AS ""e"" JOIN ""m"" ON ""e"".""Company""=""m"".""Company"" WHERE ""rnk"" BETWEEN ""md""+""n"" AND ""md"" ORDER BY ""e"".""company"",""salary"""
262,"WITH ""t1"" AS (SELECT *,RANK() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(""salary"") OVER (PARTITION BY ""Company"") AS ""cn"" FROM ""Employee"") SELECT ""Id"",""Company"",MAX(""Salary"") AS ""Salary"" FROM ""t1"" WHERE (CASE WHEN ""cn""%2=0 THEN ""rk""=(""cn""/2+1) OR ""rk""=""cn""/2 WHEN ""cn""%2=1 THEN ""rk""=(""cn""+1)/2 END) GROUP BY ""Company"",""salary"" ORDER BY ""Company"",""id"""
263,"SELECT DISTINCT MIN(""ID"") OVER (PARTITION BY ""Company"", ""Salary"") AS ""Id"",""Company"",""Salary"" FROM (SELECT ""Id"",""Company"",""Salary"",RANK() OVER (PARTITION BY ""COMPANY"" ORDER BY ""SALARY"") AS ""up"",RANK() OVER (PARTITION BY ""COMPANY"" ORDER BY ""SALARY"" DESC) AS ""dwn"" FROM ""Employee"") AS ""h"" WHERE ABS(CAST(""up"" AS INTEGER)-CAST(""dwn"" AS INTEGER))<=1 ORDER BY ""Company"",""Salary"",""Id"""
264,"WITH ""a"" AS (SELECT ""id"",""company"",""salary"",RANK() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""ranked"",COUNT(1) OVER (PARTITION BY ""company"") AS ""counted"" FROM ""employee"") SELECT ""id"",""company"",""salary"" FROM ""a"" WHERE CASE WHEN ""counted""%2=0 THEN ""ranked""=FLOOR((""counted""+1)/2) OR ""ranked""=CEIL((""counted""+1)/2) WHEN ""counted""%2=1 THEN ""ranked""=CEIL((""counted""+1)/2) END"
265,"WITH ""temp"" AS (SELECT COUNT(1) AS ""total_id"" FROM ""Employee""), ""rank_proxy"" AS (SELECT ""Id"",""Company"",""Salary"",""Salary""*(SELECT ""total_id"" FROM ""temp"")+""Id"" AS ""rank_proxy"" FROM ""Employee""), ""median"" AS (SELECT ""Company"",(CASE WHEN COUNT(1)%2=0 THEN COUNT(1)/2 ELSE (COUNT(1)+1)/2 END) AS ""start_point"",(CASE WHEN COUNT(1)%2=0 THEN COUNT(1)/2+1 ELSE (COUNT(1)+1)/2 END) AS ""end_point"" FROM ""Employee"" GROUP BY ""Company""), ""rownum"" AS (SELECT ""a"".""Id"",""a"".""Company"",""a"".""Salary"",COUNT(""b"".""Id"") AS ""rownum"" FROM (""rank_proxy"" AS ""a"") JOIN ""rank_proxy"" AS ""b"" WHERE ""a"".""Company""=""b"".""Company"" AND ""a"".""rank_proxy"">=""b"".""rank_proxy"" GROUP BY ""a"".""Id"") SELECT ""Id"",""Company"",""Salary"" FROM ""rownum"" WHERE ROW(""Company"",""rownum"") IN (SELECT ""Company"",""start_point"" FROM ""median"") OR ROW(""Company"",""rownum"") IN (SELECT ""Company"",""end_point"" FROM ""median"")"
266,"SELECT ""e"".""Id"",""e"".""Company"",""e"".""Salary"" FROM ""Employee"" AS ""e"" JOIN ""Employee"" AS ""e2"" ON ""e"".""Company""=""e2"".""Company"" GROUP BY ""e"".""Id"" HAVING ABS(SUM(CASE WHEN ""e"".""salary"">""e2"".""salary"" THEN 1 WHEN ""e"".""salary""<""e2"".""salary"" THEN -1 WHEN ""e"".""salary""=""e2"".""salary"" AND ""e"".""Id"">""e2"".""Id"" THEN 1 WHEN ""e"".""salary""=""e2"".""salary"" AND ""e"".""Id""<""e2"".""Id"" THEN -1 ELSE 0 END))<=1"
267,"SELECT ""t1"".""Id"" AS ""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""Company""=""t2"".""Company"" GROUP BY ""t1"".""Id"" HAVING ABS(SUM(CASE WHEN ""t2"".""Salary""<""t1"".""Salary"" THEN 1 WHEN ""t2"".""Salary"">""t1"".""Salary"" THEN -1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id""<""t1"".""Id"" THEN 1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id"">""t1"".""Id"" THEN -1 ELSE 0 END))<=1 ORDER BY ""t1"".""Company"",""t1"".""Salary"",""t1"".""Id"""
268,"SELECT ""id"",""company"",""salary"" FROM ""Employee"" WHERE ""id"" IN (SELECT ""t1"".""id"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""company""=""t2"".""company"" GROUP BY ""t1"".""id"" HAVING ABS(SUM(CASE WHEN ""t1"".""salary"">""t2"".""salary"" THEN 1 WHEN ""t1"".""salary""<""t2"".""salary"" THEN -1 WHEN ""t1"".""salary""=""t2"".""salary"" AND ""t1"".""id""<""t2"".""id"" THEN -1 WHEN ""t1"".""salary""=""t2"".""salary"" AND ""t1"".""id"">""t2"".""id"" THEN 1 ELSE 0 END))<=1)"
269,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"",""Id"") AS ""rn_asc"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"" DESC,""Id"" DESC) AS ""rn_desc"" FROM ""Employee"") AS ""a"" WHERE ""rn_asc"" BETWEEN ""rn_desc""-1 AND ""rn_desc""+1"
270,"SELECT ""t1"".""Id"" AS ""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""Company""=""t2"".""Company"" GROUP BY ""t1"".""Id"" HAVING ABS(SUM(CASE WHEN ""t2"".""Salary""<""t1"".""Salary"" THEN 1 WHEN ""t2"".""Salary"">""t1"".""Salary"" THEN -1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id""<""t1"".""Id"" THEN 1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id"">""t1"".""Id"" THEN -1 ELSE 0 END))<=1 ORDER BY ""t1"".""Company"",""t1"".""Salary"",""t1"".""Id"""
271,"SELECT ""t"".""id"" AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",COUNT(CASE WHEN ""a"".""salary""<""b"".""salary"" OR ""a"".""id""<""b"".""id"" THEN 1 ELSE NULL END)+1 AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND (""a"".""salary""<=""b"".""salary"") GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1"
272,"SELECT * FROM ""employee"" WHERE ""id"" IN (SELECT ""e1"".""id"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""company""=""e2"".""company"" GROUP BY ""e1"".""id"" HAVING SUM(CASE WHEN ""e1"".""salary"">=""e2"".""salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 AND SUM(CASE WHEN ""e1"".""salary""<=""e2"".""salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2) GROUP BY ""company"",""salary"" ORDER BY ""company"""
273,"WITH ""CTE"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""company"",""SALARY"") AS ""ROW_COUNT"" FROM ""EMPLOYEE""), ""CTE_2"" AS (SELECT ""company"",MAX(""ROW_COUNT"") AS ""IS_ODD_OR_EVEN"" FROM ""CTE"" GROUP BY ""company""), ""CTE_first"" AS (SELECT ""T1"".""ID"",""T1"".""COMPANY"",""T1"".""SALARY"" FROM ""CTE"" AS ""T1"" LEFT JOIN ""CTE_2"" AS ""T2"" ON ""T1"".""company""=""T2"".""company"" WHERE ""IS_ODD_OR_EVEN""%2=0 AND ""ROW_COUNT""=""IS_ODD_OR_EVEN""/2 GROUP BY ""ID"",""COMPANY""), ""CTE_SECOND"" AS (SELECT ""T1"".""ID"",""T1"".""COMPANY"",""T1"".""SALARY"" FROM ""CTE"" AS ""T1"" LEFT JOIN ""CTE_2"" AS ""T2"" ON ""T1"".""company""=""T2"".""company"" WHERE ""IS_ODD_OR_EVEN""%2=0 AND ""ROW_COUNT""=1+""IS_ODD_OR_EVEN""/2 GROUP BY ""ID"",""COMPANY""), ""CTE_THIRD"" AS (SELECT ""T1"".""ID"",""T1"".""COMPANY"",""T1"".""SALARY"" FROM ""CTE"" AS ""T1"" LEFT JOIN ""CTE_2"" AS ""T2"" ON ""T1"".""company""=""T2"".""company"" WHERE ""IS_ODD_OR_EVEN""%2!=0 AND ""ROW_COUNT""=(1+""IS_ODD_OR_EVEN"")/2 GROUP BY ""ID"",""COMPANY"") SELECT ""T1"".""ID"" AS ""Id"",""T1"".""COMPANY"" AS ""Company"",""T1"".""SALARY"" AS ""Salary"" FROM ""CTE_FIRST"" AS ""T1"" UNION SELECT ""T2"".""ID"" AS ""Id"",""T2"".""COMPANY"" AS ""Company"",""T2"".""SALARY"" AS ""Salary"" FROM ""CTE_SECOND"" AS ""T2"" UNION SELECT ""T3"".""ID"" AS ""Id"",""T3"".""COMPANY"" AS ""Company"",""T3"".""SALARY"" AS ""Salary"" FROM ""CTE_THIRD"" AS ""T3"""
274,"SELECT ""t1"".""Id"" AS ""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""Company""=""t2"".""Company"" GROUP BY ""t1"".""Id"" HAVING ABS(SUM(CASE WHEN ""t2"".""Salary""<""t1"".""Salary"" THEN 1 WHEN ""t2"".""Salary"">""t1"".""Salary"" THEN -1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id""<""t1"".""Id"" THEN 1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id"">""t1"".""Id"" THEN -1 ELSE 0 END))<=1 ORDER BY ""t1"".""Company"",""t1"".""Salary"",""t1"".""Id"""
275,"SELECT ""t1"".""Id"" AS ""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""Company""=""t2"".""Company"" GROUP BY ""t1"".""Id"" HAVING ABS(SUM(CASE WHEN ""t2"".""Salary""<""t1"".""Salary"" THEN 1 WHEN ""t2"".""Salary"">""t1"".""Salary"" THEN -1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id""<""t1"".""Id"" THEN 1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id"">""t1"".""Id"" THEN -1 ELSE 0 END))<=1 ORDER BY ""t1"".""Company"",""t1"".""Salary"",""t1"".""Id"""
276,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""row_numbers"" FROM ""Employee"" ORDER BY ""Company"",""Salary"") SELECT ""c1"".""Id"",""c1"".""Company"",""c1"".""Salary"" FROM ""cte"" AS ""c1"" JOIN (SELECT ""Company"",COUNT(""Salary"")/2 AS ""first_row_number"",COUNT(""Salary"")/2+1 AS ""second_row_number"" FROM ""Employee"" GROUP BY ""Company"" HAVING COUNT(""Salary"")%2=0) AS ""t1"" ON ""c1"".""Company""=""t1"".""Company"" AND (""c1"".""row_numbers""=""t1"".""first_row_number"" OR ""c1"".""row_numbers""=""t1"".""second_row_number"") UNION ALL SELECT ""c2"".""Id"",""c2"".""Company"",""c2"".""Salary"" FROM ""cte"" AS ""c2"" JOIN (SELECT ""Company"",(COUNT(""Salary"")+1)/2 AS ""median_row_number"" FROM ""Employee"" GROUP BY ""Company"" HAVING COUNT(""Salary"")%2=1) AS ""t2"" ON ""c2"".""Company""=""t2"".""Company"" AND ""c2"".""row_numbers""=""t2"".""median_row_number"" ORDER BY ""Company"",""Salary"""
277,"SELECT ""t"".""id"" AS ""id"",""t"".""company"",""t"".""salary"" FROM (SELECT DISTINCT ""b"".""id"",""b"".""company"",""b"".""salary"",SUM(CASE WHEN ""a"".""salary""<""b"".""salary"" OR ""a"".""id""<""b"".""id"" THEN 1 ELSE 0 END)+1 AS ""ranking"" FROM ""employee"" AS ""a"" JOIN ""employee"" AS ""b"" ON ""a"".""company""=""b"".""company"" AND (""a"".""salary""<=""b"".""salary"") GROUP BY ""b"".""id"",""b"".""company"",""b"".""salary"" ORDER BY ""b"".""company"",""b"".""salary"") AS ""t"" JOIN (SELECT ""company"",COUNT(1) AS ""group_n"" FROM ""employee"" GROUP BY ""company"") AS ""c"" ON ""t"".""company""=""c"".""company"" WHERE ""t"".""ranking"" BETWEEN ""c"".""group_n""/2 AND ""c"".""group_n""/2+1"
278,"SELECT ""t1"".""Id"" AS ""Id"",""t1"".""Company"",""t1"".""Salary"" FROM ""Employee"" AS ""t1"" JOIN ""Employee"" AS ""t2"" ON ""t1"".""Company""=""t2"".""Company"" GROUP BY ""t1"".""Id"" HAVING ABS(SUM(CASE WHEN ""t2"".""Salary""<""t1"".""Salary"" THEN 1 WHEN ""t2"".""Salary"">""t1"".""Salary"" THEN -1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id""<""t1"".""Id"" THEN 1 WHEN ""t2"".""Salary""=""t1"".""Salary"" AND ""t2"".""Id"">""t1"".""Id"" THEN -1 ELSE 0 END))<=1 ORDER BY ""t1"".""Company"",""t1"".""Salary"",""t1"".""Id"""
279,"SELECT ""Id"",""Company"",""Salary"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""Company"" ORDER BY ""Salary"") AS ""rk"",COUNT(""Id"") OVER (PARTITION BY ""Company"") AS ""size"" FROM ""Employee"") AS ""a"" WHERE ""rk""=""size""/2 OR ""rk""=(""size""+2)/2 OR ""rk""=(""size""+1)/2"
280,"SELECT ""id"",""company"",""salary"" FROM (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"") AS ""rnb"",COUNT(1) OVER (PARTITION BY ""company"") AS ""cnt"" FROM ""employee"") AS ""a"" WHERE ""rnb"" BETWEEN ""cnt""/2 AND ""cnt""/2+1"
281,"WITH ""cte_rnk"" AS (SELECT ""e1"".""Id"",MIN(""e1"".""Salary"") AS ""Salary"",MIN(""e1"".""Company"") AS ""Company"",COUNT(""e2"".""Id"") AS ""rnk"" FROM ""Employee"" AS ""e1"" JOIN ""Employee"" AS ""e2"" ON ""e1"".""Company""=""e2"".""Company"" AND (""e1"".""Salary"">""e2"".""Salary"" OR (""e1"".""Salary""=""e2"".""Salary"" AND ""e1"".""Id"">=""e2"".""Id"")) GROUP BY ""e1"".""Id""), ""cte_n"" AS (SELECT ""Company"",COUNT(""Id"") AS ""n"" FROM ""Employee"" GROUP BY ""Company"") SELECT ""r"".""Id"",""r"".""Company"",""r"".""Salary"" FROM ""cte_rnk"" AS ""r"" JOIN ""cte_n"" AS ""n"" ON ""r"".""Company""=""n"".""Company"" WHERE 2*""r"".""rnk""=""n"".""n"" OR 2*""r"".""rnk""-1=""n"".""n"" OR 2*""r"".""rnk""-2=""n"".""n"""
282,"WITH ""salary_ranks"" AS (SELECT ""id"",""company"",""salary"",ROW_NUMBER() OVER (PARTITION BY ""company"" ORDER BY ""salary"",""id"") AS ""salary_rank"" FROM ""employee"" ORDER BY ""company"",""salary""), ""salary_mid_ranks"" AS (SELECT ""company"",MAX(""salary_rank"")/2 AS ""mid_rank"" FROM ""salary_ranks"" GROUP BY ""company"") SELECT ""t1"".""id"",""t1"".""company"",""t1"".""salary"" FROM ""salary_ranks"" AS ""t1"" JOIN ""salary_mid_ranks"" AS ""t2"" ON ""t2"".""company""=""t1"".""company"" WHERE (""t1"".""salary_rank""=""t2"".""mid_rank"" OR ""t1"".""salary_rank""=""t2"".""mid_rank""+1 OR ""t1"".""salary_rank""=""t2"".""mid_rank""+0.5) ORDER BY ""t1"".""company"",""t1"".""salary"""
283,"WITH ""cte"" AS (SELECT ""Id"",""Company"",""Salary"",COUNT(1) AS ""freq"" FROM ""Employee"" GROUP BY 2,3) SELECT ""Id"",""Company"",""Salary"" FROM ""cte"" AS ""a"" WHERE ""freq"">=ABS((SELECT SUM(""freq"") FROM ""cte"" WHERE ""a"".""Salary"">=""cte"".""Salary"" AND ""a"".""Company""=""cte"".""Company"")-(SELECT SUM(""freq"") FROM ""cte"" WHERE ""a"".""Salary""<=""cte"".""Salary"" AND ""a"".""Company""=""cte"".""Company""))"
284,"SELECT MIN(""A"".""Id"") AS ""Id"",""A"".""Company"",""A"".""Salary"" FROM (""Employee"" AS ""A"") JOIN ""Employee"" AS ""B"" WHERE ""A"".""Company""=""B"".""Company"" GROUP BY ""A"".""Company"",""A"".""Salary"" HAVING SUM(CASE WHEN ""B"".""Salary"">=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 AND SUM(CASE WHEN ""B"".""Salary""<=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2"
285,"SELECT MIN(""A"".""Id"") AS ""Id"",""A"".""Company"",""A"".""Salary"" FROM (""Employee"" AS ""A"") JOIN ""Employee"" AS ""B"" WHERE ""A"".""Company""=""B"".""Company"" GROUP BY ""A"".""Company"",""A"".""Salary"" HAVING SUM(CASE WHEN ""B"".""Salary"">=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 AND SUM(CASE WHEN ""B"".""Salary""<=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2"
286,"SELECT MIN(""e1"".""Id"") AS ""Id"",""e1"".""Company"",""e1"".""Salary"" FROM (""Employee"" AS ""e1"") JOIN ""Employee"" AS ""e2"" WHERE ""e1"".""Company""=""e2"".""Company"" GROUP BY ""e1"".""Company"",""e1"".""Salary"" HAVING SUM(CASE WHEN ""e1"".""Salary""=""e2"".""Salary"" THEN 1 ELSE 0 END)>=ABS(SUM(SIGN(""e1"".""Salary""-""e2"".""Salary""))) ORDER BY ""e1"".""Company"",""e1"".""Salary"""
287,"SELECT MIN(""e1"".""id"") AS ""id"",""e1"".""company"",""e1"".""salary"" FROM ""employee"" AS ""e1"" JOIN ""employee"" AS ""e2"" ON ""e1"".""company""=""e2"".""company"" GROUP BY ""e1"".""company"",""e1"".""salary"" HAVING SUM(CASE WHEN ""e1"".""salary""<=""e2"".""salary"" THEN 1 ELSE 0 END)>=COUNT(""e2"".""id"")/2 AND SUM(CASE WHEN ""e1"".""salary"">=""e2"".""salary"" THEN 1 ELSE 0 END)>=COUNT(""e2"".""id"")/2"
288,"SELECT MIN(""Employee"".""Id"") AS ""Id"",""Employee"".""Company"",""Employee"".""Salary"" FROM (""Employee"") JOIN ""Employee"" AS ""alias"" WHERE ""Employee"".""Company""=""alias"".""Company"" GROUP BY ""Employee"".""Company"",""Employee"".""Salary"" HAVING SUM(CASE WHEN ""Employee"".""Salary""=""alias"".""Salary"" THEN 1 ELSE 0 END)>=ABS(SUM(SIGN(""Employee"".""Salary""-""alias"".""Salary""))) ORDER BY ""Employee"".""company"""
289,"SELECT MIN(""e1"".""id"") AS ""id"",""e1"".""company"",""e1"".""Salary"" FROM (""employee"" AS ""e1"") JOIN ""employee"" AS ""e2"" WHERE ""e1"".""company""=""e2"".""company"" GROUP BY ""e1"".""company"",""e1"".""salary"" HAVING SUM(""e2"".""salary"">=""e1"".""salary"")>=COUNT(1)/2 AND SUM(""e2"".""salary""<=""e1"".""salary"")>=COUNT(1)/2"
290,"SELECT MIN(""A"".""Id"") AS ""Id"",""A"".""Company"",""A"".""Salary"" FROM ""Employee"" AS ""A"" JOIN ""Employee"" AS ""B"" ON ""A"".""Company""=""B"".""Company"" GROUP BY ""A"".""Company"",""A"".""Salary"" HAVING SUM(CASE WHEN ""B"".""Salary"">=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 AND SUM(CASE WHEN ""B"".""Salary""<=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2"
291,"SELECT MIN(""A"".""Id"") AS ""Id"",""A"".""Company"",""A"".""Salary"" FROM (""Employee"" AS ""A"") JOIN ""Employee"" AS ""B"" WHERE ""A"".""Company""=""B"".""Company"" GROUP BY ""A"".""Company"",""A"".""Salary"" HAVING SUM(CASE WHEN ""B"".""Salary"">=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 AND SUM(CASE WHEN ""B"".""Salary""<=""A"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2"
292,"SELECT MIN(""E1"".""Id"") AS ""Id"",""E1"".""Company"",""E1"".""Salary"" FROM (""Employee"" AS ""E1"") JOIN ""Employee"" AS ""E2"" WHERE ""E1"".""Company""=""E2"".""Company"" GROUP BY ""E1"".""Company"",""E1"".""Salary"" HAVING SUM(CASE WHEN ""E2"".""Salary"">=""E1"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 AND SUM(CASE WHEN ""E2"".""Salary""<=""E1"".""Salary"" THEN 1 ELSE 0 END)>=COUNT(1)/2 ORDER BY ""E1"".""Company"",""E1"".""Salary"""
293,"SELECT MIN(""employee"".""Id"") AS ""id"",""Employee"".""Company"",""Employee"".""Salary"" FROM (""Employee"") JOIN ""Employee"" AS ""alias"" WHERE ""Employee"".""Company""=""alias"".""Company"" GROUP BY ""Employee"".""Company"",""Employee"".""Salary"" HAVING SUM(CASE WHEN ""Employee"".""Salary""=""alias"".""Salary"" THEN 1 ELSE 0 END)>=ABS(SUM(SIGN(""Employee"".""Salary""-""alias"".""Salary""))) ORDER BY ""Employee"".""Id"""
