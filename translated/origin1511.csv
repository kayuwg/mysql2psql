id,original query
1,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100"
2,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",""order_month"",""cost"" FROM (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""order_month"",SUM(""o"".""quantity""*""p"".""price"") AS ""cost"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""order_month"") AS ""t"" WHERE (""order_month""='2020-06' OR ""order_month""='2020-07') AND ""cost"">=100) AS ""t"" GROUP BY ""customer_id"" HAVING COUNT(1)=2)"
3,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""p"".""price""*""quantity"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""p"".""price""*""quantity"" END)>=100"
4,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
5,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
6,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-06%' THEN ""quantity""*""price"" ELSE 0 END) AS ""june"",SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-07%' THEN ""quantity""*""price"" ELSE 0 END) AS ""july"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2) AS ""temp"" WHERE ""june"">=100 AND ""july"">=100"
7,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""Orders"".""order_date"", 7)='2020-06' THEN ""Orders"".""quantity"" ELSE 0 END*""Product"".""price"")>=100 AND SUM(CASE WHEN LEFT(""Orders"".""order_date"", 7)='2020-07' THEN ""Orders"".""quantity"" ELSE 0 END*""Product"".""price"")>=100"
8,"WITH ""temp"" AS (SELECT ""o"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m'),SUM(""o"".""quantity""*""p"".""price"") AS ""total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') HAVING ""total"">=100) SELECT ""t"".""customer_id"",""c"".""name"" FROM ""temp"" AS ""t"" JOIN ""Customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" GROUP BY ""t"".""customer_id"" HAVING COUNT(1)=2"
9,"SELECT ""customer_id"",""name"" FROM (""Orders"" JOIN ""Product"" USING (""product_id"")) JOIN ""Customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
10,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY ""customer_id"" HAVING SUM(CASE WHEN MONTHNAME(""order_date"")='June' THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN MONTHNAME(""order_date"")='July' THEN ""price""*""quantity"" ELSE 0 END)>=100"
11,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""product"" AS ""p"") JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""o"".""order_date"")=2020 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) SELECT ""customer_id"",""name"" FROM ""cte"" GROUP BY ""customer_id"" HAVING COUNT(1)=2"
12,"SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""name"" HAVING SUM(CASE WHEN ""order_date"" LIKE '2020-06%' THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""order_date"" LIKE '2020-07%' THEN ""price""*""quantity"" ELSE 0 END)>=100"
13,"SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""o"".""quantity""*""p"".""price"") AS ""monthly_purch"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""sub11"" WHERE ""monthly_purch"">=100 AND ""month"" IN (6,7) GROUP BY 1 HAVING COUNT(1)=2)"
14,"SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR_MONTH FROM ""o"".""order_date"") IN ('202006','202007') GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100)"
15,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY EXTRACT(MONTH FROM ""o"".""order_date"")) AS ""row_num"" FROM (""Customers"" AS ""c"" JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-06%' OR ""o"".""order_date"" LIKE '2020-07%' GROUP BY ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""a"" WHERE ""row_num""=2"
16,"WITH ""tbl"" AS (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""order_date"", 'YYYY-%m') FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""c"".""customer_id"",""c"".""name"",TO_CHAR(""order_date"", 'YYYY-%m') HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) SELECT ""customer_id"",""name"" FROM ""tbl"" GROUP BY 1,2 HAVING COUNT(""name"")>1"
17,"SELECT ""a"".""customer_id"",""a"".""name"" FROM (""customers"" AS ""a"" JOIN ""product"" AS ""b"") JOIN ""orders"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""b"".""product_id""=""c"".""product_id"" WHERE ""c"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""a"".""customer_id"",""a"".""name"" HAVING SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""c"".""quantity""*""b"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""c"".""quantity""*""b"".""price"" ELSE 0 END)>=100"
18,"SELECT ""t"".""customer_id"",""b"".""name"" FROM (""orders"" AS ""t"" JOIN ""Product"" AS ""a"" ON ""t"".""product_id""=""a"".""product_id"") JOIN ""customers"" AS ""b"" ON ""t"".""customer_id""=""b"".""customer_id"" WHERE EXTRACT(MONTH FROM ""t"".""order_date"") IN (7,6) GROUP BY ""t"".""customer_id"",""b"".""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""t"".""order_date"")=6 THEN ""t"".""quantity""*""a"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""t"".""order_date"")=7 THEN ""t"".""quantity""*""a"".""price"" ELSE 0 END)>=100"
19,"WITH ""a"" AS (SELECT *,SUM(""Orders"".""quantity""*""Product"".""price"") AS ""TOTALs"" FROM ""Orders"" LEFT JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING (EXTRACT(MONTH FROM ""order_date"")=6) OR (EXTRACT(MONTH FROM ""order_date"")=7)) SELECT ""c"".""customer_id"",""c"".""name"" FROM ""a"" LEFT JOIN ""Customers"" AS ""c"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING MIN(""TOTALs"")>=100 AND COUNT(1)=2"
20,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t1"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t2"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1) AS ""tmp"" WHERE ""t1"">=100 AND ""t2"">=100"
21,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM((CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-06' THEN ""quantity"" ELSE 0 END)*""price"")>=100 AND SUM((CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-07' THEN ""quantity"" ELSE 0 END)*""price"")>=100"
22,"WITH ""cte"" AS (SELECT ""order_id"",""o"".""customer_id"",""name"",""product_id"",""order_date"",""quantity"" FROM ""customers"" AS ""c"" RIGHT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id""), ""cte2"" AS (SELECT ""order_id"",""customer_id"",""name"",""cte"".""product_id"",""order_date"",""quantity"" FROM ""cte"" LEFT JOIN ""product"" AS ""p"" ON ""cte"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07') SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",SUM(""quantity""*""price"") AS ""total_price"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM ""cte2"" LEFT JOIN ""product"" AS ""p"" ON ""cte2"".""product_id""=""p"".""product_id"" GROUP BY 1,4) AS ""sub"" WHERE ""total_price"">=100 GROUP BY 1 HAVING COUNT(1)=2"
23,"SELECT ""e"".""customer_id"",""e"".""name"" FROM (SELECT ""d"".""customer_id"",""d"".""name"",MIN(""d"".""spend"") AS ""min_spend"",MIN(""d"".""month"") AS ""min_month"",MAX(""d"".""month"") AS ""max_month"" FROM (SELECT ""a"".""customer_id"",""b"".""name"",EXTRACT(YEAR FROM ""a"".""order_date"") AS ""year"",EXTRACT(MONTH FROM ""a"".""order_date"") AS ""month"",SUM(""a"".""quantity""*""c"".""price"") AS ""spend"" FROM (""orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""product"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"" WHERE EXTRACT(MONTH FROM ""a"".""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""a"".""order_date"") IN (2020) GROUP BY ""a"".""customer_id"",EXTRACT(YEAR FROM ""a"".""order_date""),EXTRACT(MONTH FROM ""a"".""order_date"")) AS ""d"" GROUP BY ""d"".""customer_id"") AS ""e"" WHERE ""e"".""min_spend"">=100 AND ""min_month""!=""max_month"""
24,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(""tot"") AS ""tot2"" FROM (SELECT ""customer_id"",""ym"",""total"",SUM(CASE WHEN ""total"">=100 THEN 1 ELSE 0 END) AS ""tot"" FROM (SELECT ""customer_id"",TO_CHAR(""order_date"", 'YYYY%m') AS ""ym"",SUM(""price""*""quantity"") AS ""total"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY%m') IN ('202006','202007') GROUP BY ""customer_id"",TO_CHAR(""order_date"", 'YYYY%m')) AS ""r"" GROUP BY ""customer_id"",""ym"") AS ""t"" GROUP BY ""customer_id"" HAVING SUM(""tot"")>1) AS ""sub"" ON ""c"".""customer_id""=""sub"".""customer_id"""
25,"WITH ""CTE"" AS (SELECT SUM(""p"".""price""*""O"".""quantity"") AS ""amount_spent"",""O"".""customer_id"",""C"".""name"",EXTRACT(MONTH FROM ""order_date"") FROM (""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") LEFT JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")='6' AND EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY EXTRACT(MONTH FROM ""order_date""),""O"".""customer_id"",""name"" HAVING ""amount_spent"">=100), ""CTE2"" AS (SELECT SUM(""p"".""price""*""O"".""quantity"") AS ""amount_spent"",""O"".""customer_id"",""C"".""name"",EXTRACT(MONTH FROM ""order_date"") FROM (""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") LEFT JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")='7' AND EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY EXTRACT(MONTH FROM ""order_date""),""O"".""customer_id"",""name"" HAVING ""amount_spent"">=100) SELECT ""a"".""customer_id"",""a"".""name"" FROM ""CTE"" AS ""a"" JOIN ""CTE2"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
26,"SELECT ""cs"".""customer_id"",""cs"".""name"" FROM (""Customers"" AS ""cs"" JOIN ""Orders"" AS ""ord"" USING (""customer_id"")) JOIN ""Product"" AS ""pr"" USING (""product_id"") GROUP BY ""cs"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
27,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
28,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month_"",SUM(""o"".""quantity""*""p"".""price"") AS ""total_spend"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"",""month_"" HAVING ""total_spend"">=100) AS ""t1"" GROUP BY ""customer_id"" HAVING COUNT(1)>=2"
29,"SELECT ""C"".""customer_id"",""C"".""name"" FROM ""Customers"" AS ""C"" LEFT JOIN (SELECT ""O"".""customer_id"",LEFT(""O"".""order_date"", 7) AS ""D"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" WHERE ""O"".""order_date"" LIKE '2020-06%' OR ""O"".""order_date"" LIKE '2020-07%' GROUP BY 1,2 HAVING SUM(""P"".""price""*""O"".""quantity"")>=100) AS ""T"" ON ""C"".""customer_id""=""T"".""customer_id"" GROUP BY 1 HAVING COUNT(""T"".""D"")=2"
30,"WITH ""m6"" AS (SELECT ""customer_id"",SUM(""quantity""*""price"") AS ""spent"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 GROUP BY ""customer_id"",""order_month""), ""m7"" AS (SELECT ""customer_id"",SUM(""quantity""*""price"") AS ""spent"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"",""order_month"") SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""m6"" WHERE ""spent"">=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""m7"" WHERE ""spent"">=100)"
31,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AND ""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100)"
32,"WITH ""tmp"" AS (SELECT ""ina"".""customer_id"",SUM(CASE WHEN LEFT(""ina"".""order_date"", 7)='2020-06' THEN ""ina"".""quantity""*""inb"".""price"" ELSE 0 END) AS ""june"",SUM(CASE WHEN LEFT(""ina"".""order_date"", 7)='2020-07' THEN ""ina"".""quantity""*""inb"".""price"" ELSE 0 END) AS ""july"" FROM (""Orders"" AS ""ina"") JOIN ""Product"" AS ""inb"" WHERE ""ina"".""product_id""=""inb"".""product_id"" GROUP BY ""ina"".""customer_id"") SELECT ""ina"".""customer_id"",""ina"".""name"" FROM (""Customers"" AS ""ina"") JOIN ""tmp"" AS ""inb"" WHERE ""ina"".""customer_id""=""inb"".""customer_id"" AND ""june"">=100 AND ""july"">=100"
33,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
34,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""month"",SUM(""p"".""price""*""o"".""quantity"") FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" AND ""o"".""order_date"">='2020-06-01' AND ""o"".""order_date""<='2020-07-31') JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""tmp"" GROUP BY ""customer_id"",""name"" HAVING COUNT(DISTINCT ""month"")=2"
35,"SELECT ""tmp"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""mon"",SUM(""p"".""price""*""o"".""quantity"") AS ""cost"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"")) AS ""tmp"" ON ""c"".""customer_id""=""tmp"".""customer_id"" GROUP BY ""tmp"".""customer_id"" HAVING SUM(CASE WHEN ""mon""=6 THEN ""cost"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""mon""=7 THEN ""cost"" ELSE 0 END)>=100"
36,"SELECT ""d"".""customer_id"",""d"".""name"" FROM (SELECT ""a"".""customer_id"",""b"".""name"",EXTRACT(YEAR FROM ""a"".""order_date"") AS ""year"",EXTRACT(MONTH FROM ""a"".""order_date"") AS ""month"",SUM(""a"".""quantity""*""c"".""price"") AS ""spend"" FROM (""orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""product"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"" WHERE EXTRACT(MONTH FROM ""a"".""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""a"".""order_date"") IN (2020) GROUP BY ""a"".""customer_id"",""year"",""month"") AS ""d"" GROUP BY ""d"".""customer_id"" HAVING MIN(""d"".""spend"")>=100 AND MIN(""d"".""month"")!=MAX(""d"".""month"")"
37,"WITH ""cust_buy"" AS (SELECT ""orders"".""customer_id"",TO_CHAR(""orders"".""order_date"", 'YYYY-%m') AS ""month"",(""product"".""price""*""orders"".""quantity"") AS ""purchase"" FROM ""orders"" JOIN ""product"" ON ""orders"".""product_id""=""product"".""product_id""), ""june_buy"" AS (SELECT ""customer_id"",""month"",SUM(""purchase"") AS ""tot_price"" FROM ""cust_buy"" WHERE ""month""='2020-06' GROUP BY ""customer_id"",""month"" HAVING ""tot_price"">=100), ""july_buy"" AS (SELECT ""customer_id"",""month"",SUM(""purchase"") AS ""tot_price"" FROM ""cust_buy"" WHERE ""month""='2020-07' GROUP BY ""customer_id"",""month"" HAVING ""tot_price"">=100) SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""june_buy"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""july_buy""))"
38,"SELECT ""c"".""customer_id"",""name"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""quantity""*""price"") AS ""spend"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2 HAVING (""month""=6 AND ""spend"">=100) OR (""month""=7 AND ""spend"">=100)) AS ""a"" JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY 1 HAVING COUNT(""month"")=2"
39,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
40,"SELECT ""o"".""customer_id"",""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
41,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""order_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",""c"".""customer_id"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""month"") AS ""filter_tab"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""month""=6 THEN ""total"" END)>=100 AND SUM(CASE WHEN ""month""=7 THEN ""total"" END)>=100 ORDER BY ""customer_id"""
42,"SELECT ""customers"".""customer_id"" AS ""customer_id"",""customers"".""name"" AS ""name"" FROM (""Orders"" AS ""orders"" JOIN ""Product"" AS ""prod"" ON ""orders"".""product_id""=""prod"".""product_id"") JOIN ""Customers"" AS ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"" GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-06' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100) AND (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-07' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100)"
43,"WITH ""tmp"" AS (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", '%M YYYY') AS ""year_month_dt"",SUM(""p"".""price""*""o"".""quantity"") AS ""order_amount"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">=DATE('2020-06-01') AND ""o"".""order_date""<=DATE('2020-07-31') GROUP BY ""c"".""customer_id"",TO_CHAR(""o"".""order_date"", '%M YYYY') HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""customer_id"",""name"" FROM ""tmp"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>=2"
44,"WITH ""m6"" AS (SELECT ""customer_id"",SUM(""quantity""*""price"") AS ""spent"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 GROUP BY ""customer_id"",""order_month""), ""m7"" AS (SELECT ""customer_id"",SUM(""quantity""*""price"") AS ""spent"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"",""order_month"") SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""m6"" WHERE ""spent"">=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""m7"" WHERE ""spent"">=100)"
45,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t1"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t2"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1) AS ""tmp"" WHERE ""t1"">=100 AND ""t2"">=100"
46,"SELECT ""t"".""customer_id"",""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""quantity""*""price"") AS ""total"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-30' GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"")) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""total"">=100 GROUP BY ""t"".""customer_id"" HAVING COUNT(""t"".""customer_id"")>=2"
47,"SELECT ""t"".""customer_id"",""t"".""name"" FROM (SELECT EXTRACT(MONTH FROM ""o"".""order_date"") AS ""mn"",""c"".""customer_id"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""x"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")='06' OR EXTRACT(MONTH FROM ""o"".""order_date"")='07' AND EXTRACT(YEAR FROM ""o"".""order_date"")='2020' GROUP BY EXTRACT(MONTH FROM ""o"".""order_date""),""c"".""customer_id"",""c"".""name"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""t"" GROUP BY ""t"".""customer_id"",""t"".""name"" HAVING COUNT(""t"".""mn"")=2"
48,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
49,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m'),COALESCE(SUM(CASE WHEN TO_CHAR(""o"".""order_date"", 'YYYY-%m')='2020-06' THEN ""o"".""quantity""*""p"".""price"" END), 0) AS ""June_Amount"",COALESCE(SUM(CASE WHEN TO_CHAR(""o"".""order_date"", 'YYYY-%m')='2020-07' THEN ""o"".""quantity""*""p"".""price"" END), 0) AS ""July_Amount"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m')) AS ""x"" GROUP BY ""customer_id"" HAVING SUM(""June_Amount"")>=100 AND SUM(""July_Amount"")>=100"
50,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"",SUM(""quantity""*""price"") AS ""total_sales"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1,2,3 HAVING ""total_sales"">=100) SELECT ""customer_id"",""name"" FROM ""cte"" GROUP BY 1,2 HAVING COUNT(""customer_id"")>1"
51,"WITH ""june"" AS (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""c"".""customer_id"",""c"".""name"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100), ""july"" AS (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""c"".""customer_id"",""c"".""name"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) SELECT ""m6"".""customer_id"",""m6"".""name"" FROM ""june"" AS ""m6"" JOIN ""july"" AS ""m7"" ON ""m6"".""customer_id""=""m7"".""customer_id"" GROUP BY ""m6"".""customer_id"",""m6"".""name"""
52,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100"
53,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' GROUP BY ""customer_id"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""t1"" ON ""c"".""customer_id""=""t1"".""customer_id"") JOIN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-07' GROUP BY ""customer_id"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""t2"" ON ""c"".""customer_id""=""t2"".""customer_id"""
54,"WITH ""OP1"" AS (SELECT ""O"".""customer_id"",TO_CHAR(""O"".""order_date"", 'YYYY-%m') AS ""YM"",""O"".""quantity""*""P"".""price"" AS ""spending"" FROM (""Orders"" AS ""O"") JOIN ""Product"" AS ""P"" WHERE ""O"".""product_id""=""P"".""product_id"" AND ""O"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31'), ""OP2"" AS (SELECT ""customer_id"",""YM"",SUM(""spending"") AS ""spending"" FROM ""OP1"" GROUP BY ""customer_id"",""YM"" HAVING SUM(""spending"")>=100) SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""OP2"" GROUP BY ""customer_id"" HAVING COUNT(1)=2)"
55,"SELECT ""a"".""customer_id"",""b"".""name"" FROM (SELECT ""e"".""customer_id"" FROM (SELECT DISTINCT ""customer_id"" FROM (SELECT ""customer_id"",SUM(""quantity""*""price"") AS ""total"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""quantity"",""b"".""price"" FROM (SELECT *,EXTRACT(MONTH FROM ""order_date"") AS ""month_1"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=6) AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" GROUP BY ""customer_id"" HAVING ""total"">=100) AS ""d"") AS ""e"" JOIN (SELECT DISTINCT ""customer_id"" FROM (SELECT ""customer_id"",SUM(""quantity""*""price"") AS ""total"" FROM (SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""quantity"",""b"".""price"" FROM (SELECT *,EXTRACT(MONTH FROM ""order_date"") AS ""month_1"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=7) AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" GROUP BY ""customer_id"" HAVING ""total"">=100) AS ""d"") AS ""e1"" ON ""e"".""customer_id""=""e1"".""customer_id"") AS ""a"" LEFT JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
56,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""month"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1,2,3 HAVING SUM(""price""*""quantity"")>=100) AS ""a"" GROUP BY 1,2 HAVING COUNT(""customer_id"")=2"
57,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(YEAR_MONTH FROM ""o"".""order_date"")=202006 THEN ""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(YEAR_MONTH FROM ""o"".""order_date"")=202007 THEN ""quantity""*""p"".""price"" ELSE 0 END)>=100"
58,"SELECT ""customer_id"",""name"" FROM (SELECT ""a"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") AS ""months"" FROM (""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""price""*""quantity"")>=100) AS ""x"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)=2"
59,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" END)>=100"
60,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""o"".""quantity""*""p"".""price"") AS ""price"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""order_date"")) SELECT DISTINCT (""customer_id""),""name"" FROM ""cte"" WHERE ""price"">=100 AND ""order_month""=7 AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""order_month""=6 AND ""price"">=100)"
61,"SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",""order_month"",SUM(""totalspent"") AS ""total"" FROM (SELECT ""o"".*,""c"".""name"",""p"".""price""*""o"".""quantity"" AS ""totalspent"",TO_CHAR(""order_date"", '%M') AS ""order_month"" FROM (""orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""r"" WHERE ""order_month"" IN ('June','July') GROUP BY ""customer_id"",""name"",""order_month"" HAVING SUM(""totalspent"")>=100) AS ""s"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>1"
62,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM((""o"".""quantity""*""p"".""price""))>=100) AS ""a"" GROUP BY ""name"" HAVING COUNT(1)=2"
63,"SELECT ""t"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" END) AS ""June"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" END) AS ""July"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"") AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""June"">=100 AND ""July"">=100"
64,"ERROR: mysql parse error: line 1 column 345 near ""a inner join (select distinct customer_id, name from t1 where mon='07')b on a.customer_id=b.customer_id) ) select distinct customer_id, name from t1 where customer_id in (select customer_id from t2) "" "
65,"SELECT ""customer_id"",""name"" FROM (""customers"" JOIN ""orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
66,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity"" ELSE 0 END*""price"")>=100"
67,"SELECT ""temp"".""customer_id"",""name"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""quantity""*""price"") AS ""total"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"",""month"" HAVING ""total"">=100) AS ""temp"", ""Customers"" AS ""c"" WHERE ""temp"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING COUNT(1)=2"
68,"SELECT ""CUSTOMER_ID"",""NAME"" FROM (SELECT ""C"".""customer_id"" AS ""CUSTOMER_ID"",""C"".""name"" AS ""NAME"",SUM(""O"".""quantity""*""P"".""price"") AS ""TOTAL"" FROM (""Customers"" AS ""C"" LEFT JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") LEFT JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""O"".""order_date"">='2020-06-01' AND ""O"".""order_date""<='2020-07-31' GROUP BY ""C"".""customer_id"",EXTRACT(MONTH FROM ""O"".""order_date"")) AS ""T"" WHERE ""TOTAL"">=100 GROUP BY ""CUSTOMER_ID"" HAVING COUNT(""CUSTOMER_ID"")>1"
69,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity"" ELSE 0 END*""price"")>=100"
70,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
71,"SELECT ""customer_id"",""name"" FROM (""Customers"" AS ""c"" RIGHT JOIN ""Orders"" USING (""customer_id"")) LEFT JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
72,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN (""quantity""*""price"") END) AS ""sum7"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN (""quantity""*""price"") END) AS ""sum6"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING ""sum7"">=100 AND ""sum6"">=100) AS ""cte"" ON ""cte"".""customer_id""=""c"".""customer_id"""
73,"SELECT ""C"".""customer_id"",""C"".""name"" FROM ""Customers"" AS ""C"" LEFT JOIN (SELECT ""O"".""customer_id"",LEFT(""O"".""order_date"", 7) AS ""dates"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""O"".""order_date"" LIKE '2020-06%' OR ""O"".""order_date"" LIKE '2020-07%' GROUP BY 1,2 HAVING SUM(""Price""*""O"".""quantity"")>=100) AS ""T"" ON ""C"".""customer_id""=""T"".""customer_id"" GROUP BY 1 HAVING COUNT(""dates"")=2"
74,"SELECT ""t"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""price""*""quantity"") AS ""total_price"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING ""total_price"">=100 AND ""month"" IN (6,7)) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(""c"".""customer_id"")>1"
75,"SELECT ""customer_id"",""name"" FROM (""Orders"" JOIN ""Product"" USING (""product_id"")) JOIN ""Customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
76,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""price""*""quantity"" ELSE 0 END) AS ""june_sales"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""price""*""quantity"" ELSE 0 END) AS ""july_sales"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"" HAVING ""june_sales"">=100 AND ""july_sales"">=100) AS ""x"", ""customers"" AS ""c"" WHERE ""c"".""customer_id""=""x"".""customer_id"""
77,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AND ""c"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-07%' GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100)"
78,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""month"",SUM(""p"".""price""*""o"".""quantity"") FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" AND ""o"".""order_date"">='2020-06-01' AND ""o"".""order_date""<='2020-07-31') JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""tmp"" GROUP BY ""customer_id"",""name"" HAVING COUNT(DISTINCT ""month"")>1"
79,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
80,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
81,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
82,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""june"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""july"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""june"">=100 AND ""july"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
83,"SELECT ""t"".""customer_id"" AS ""customer_id"",""c"".""name"" AS ""name"" FROM (SELECT ""o"".""customer_id"" AS ""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month_p"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE (EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7) GROUP BY ""o"".""customer_id"",""month_p"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)=2"
84,"WITH ""tb1"" AS (SELECT DISTINCT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"")) SELECT ""tb2"".""customer_id"",""c"".""name"" FROM (SELECT ""tb1"".""customer_id"" FROM ""tb1"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""tb1"" WHERE ""month""=6 AND ""total_price"">=100) AND ""month""=7 AND ""total_price"">=100) AS ""tb2"" LEFT JOIN ""Customers"" AS ""c"" ON ""tb2"".""customer_id""=""c"".""customer_id"""
85,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
86,"SELECT ""t1"".""customer_id"",""t2"".""name"" FROM (SELECT ""t"".""customer_id"",EXTRACT(MONTH FROM ""t"".""order_date"") AS ""mon"" FROM ""orders"" AS ""t"" JOIN ""Product"" AS ""a"" ON ""t"".""product_id""=""a"".""product_id"" WHERE EXTRACT(MONTH FROM ""t"".""order_date"") IN (7,6) GROUP BY ""t"".""customer_id"",EXTRACT(MONTH FROM ""t"".""order_date"") HAVING SUM(""t"".""quantity""*""a"".""price"")>=100) AS ""t1"" JOIN ""Customers"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"" GROUP BY ""t1"".""customer_id"",""t2"".""name"" HAVING COUNT(1)=2"
87,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date""),SUM(""o"".""quantity""*""p"".""price"") AS ""monthpurchase"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND (EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7) GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"")) AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE ""o"".""monthpurchase"">=100 GROUP BY ""customer_id"",""c"".""name"" HAVING COUNT(""monthpurchase"")=2"
88,"WITH ""x"" AS (SELECT DISTINCT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""o"".""quantity""*""p"".""price"") AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""m"" HAVING ""m""=6 OR ""m""=7), ""x1"" AS (SELECT * FROM ""x"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""x"" GROUP BY ""customer_id"" HAVING COUNT(""m"")=2)) SELECT DISTINCT ""customer_id"",""name"" FROM ""x1"" HAVING ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""x1"" WHERE ""tot""<100)"
89,"WITH ""tbA"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""mDate"",EXTRACT(YEAR FROM ""o"".""order_date"") AS ""yDate"",SUM(""p"".""price""*""o"".""quantity"") AS ""moneySpent"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date""),EXTRACT(YEAR FROM ""o"".""order_date"")) SELECT ""t1"".""customer_id"",""t1"".""name"" FROM ""tbA"" AS ""t1"" JOIN ""tbA"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"" AND ""t1"".""mDate""=6 AND ""t2"".""mDate""=7 WHERE ""t1"".""moneySpent"">=100 AND ""t2"".""moneySpent"">=100"
90,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100"
91,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"" AS ""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" END) AS ""sm6"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" END) AS ""sm7"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm6"">=100 AND ""sm7"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
92,"SELECT ""o"".""customer_id"",""name"" FROM ((""Orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""Customers"" AS ""c"" WHERE ""o"".""product_id""=""p"".""product_id"" AND ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
93,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""sales"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m')) SELECT DISTINCT ""CUSTOMER_ID"",""NAME"" FROM ""T"" WHERE ""sales"">=100 GROUP BY ""customer_id"" HAVING COUNT(1)>1"
94,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) JOIN ""product"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
95,"SELECT ""customer_id"",""name"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE SUBSTR(""order_date"", 1, 7)='2020-06' AND ""customer_id"" IN (SELECT ""customer_id"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE SUBSTR(""order_date"", 1, 7)='2020-07' GROUP BY ""customer_id"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) GROUP BY ""customer_id"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100"
96,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" END)>=100"
97,"WITH ""june"" AS (SELECT DISTINCT * FROM ""Orders"" WHERE ""order_date"">='2020-06-01' AND ""order_date""<='2020-06-30'), ""july"" AS (SELECT DISTINCT * FROM ""Orders"" WHERE ""order_date"">='2020-07-01' AND ""order_date""<='2020-07-31'), ""june_price"" AS (SELECT ""customer_id"",SUM(""price""*""quantity"") AS ""price"" FROM ""june"" LEFT JOIN ""Product"" ON ""Product"".""product_id""=""june"".""product_id"" GROUP BY ""customer_id""), ""july_price"" AS (SELECT ""customer_id"",SUM(""price""*""quantity"") AS ""price"" FROM ""july"" LEFT JOIN ""Product"" ON ""Product"".""product_id""=""july"".""product_id"" GROUP BY ""customer_id"") SELECT ""june_price"".""customer_id"",""name"" FROM (""june_price"" JOIN ""july_price"" ON ""june_price"".""customer_id""=""july_price"".""customer_id"") JOIN ""Customers"" ON ""june_price"".""customer_id""=""Customers"".""customer_id"" WHERE ""june_price"".""price"">=100 AND ""july_price"".""price"">=100"
98,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"") AS ""row_num"" FROM (""Customers"" AS ""c"" JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-06%' OR ""o"".""order_date"" LIKE '2020-07%' GROUP BY ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""a"" WHERE ""row_num""=2"
99,"WITH ""x"" AS (SELECT DISTINCT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""o"".""quantity""*""p"".""price"") AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""m"" HAVING ""m""=6 OR ""m""=7), ""x1"" AS (SELECT * FROM ""x"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""x"" GROUP BY ""customer_id"" HAVING COUNT(""m"")=2)) SELECT DISTINCT ""customer_id"",""name"" FROM ""x1"" HAVING ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""x1"" WHERE ""tot""<100)"
100,"WITH ""cte"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""quantity""*""price"" ELSE 0 END) AS ""June"",SUM(CASE WHEN ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""quantity""*""price"" ELSE 0 END) AS ""July"" FROM ""orders"" JOIN ""product"" ON ""product"".""product_id""=""orders"".""product_id"" GROUP BY ""orders"".""customer_id"") SELECT ""customer_id"",""name"" FROM ""customers"" JOIN ""cte"" USING (""customer_id"") WHERE ""June"">=100 AND ""July"">=100"
101,"WITH ""x"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY ""o"".""customer_id"",""month"" HAVING SUM(""p"".""price""*""o"".""quantity"")>99 ORDER BY ""c"".""customer_id""), ""y"" AS (SELECT *,COALESCE(LEAD(""total_price"") OVER (PARTITION BY ""customer_id"" ORDER BY ""month""), 0) AS ""t"" FROM ""x"") SELECT ""customer_id"",""name"" FROM ""y"" WHERE ""total_price"">99 AND ""t"">99"
102,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
103,"SELECT DISTINCT ""o"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE (SELECT SUM(""Orders"".""quantity""*""Product"".""price"") FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE (EXTRACT(MONTH FROM ""Orders"".""order_date"")='06') AND ""c"".""customer_id""=""Orders"".""customer_id"")>=100 AND (SELECT SUM(""Orders"".""quantity""*""Product"".""price"") FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE EXTRACT(MONTH FROM ""Orders"".""order_date"")='07' AND ""c"".""customer_id""=""Orders"".""customer_id"")>=100"
104,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY ""customer_id"" HAVING SUM(CASE WHEN MONTHNAME(""order_date"")='June' THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN MONTHNAME(""order_date"")='July' THEN ""price""*""quantity"" ELSE 0 END)>=100"
105,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price"" ELSE 0 END*""o"".""quantity"")>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price"" ELSE 0 END*""o"".""quantity"")>=100"
106,"SELECT ""customer_id"",""name"" FROM (SELECT ""a"".""customer_id"" AS ""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM (""orders"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY 1,2,3 HAVING SUM(""price""*""quantity"")>=100) AS ""a"" GROUP BY 1,2 HAVING COUNT(""order_month"")>1"
107,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""o"".""quantity""*""p"".""price"" END) AS ""a"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""o"".""quantity""*""p"".""price"" END) AS ""b"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" USING (""product_id"") GROUP BY 1) SELECT ""cte"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN ""cte"" USING (""customer_id"") WHERE ""cte"".""a"">=100 AND ""cte"".""b"">=100"
108,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""month"",SUM(""a"".""quantity""*""b"".""price"") AS ""total"" FROM (SELECT ""customer_id"",""product_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",""quantity"" FROM ""orders"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=6) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=7)) AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"",""a"".""month"") SELECT DISTINCT ""c"".""customer_id"",""d"".""name"" FROM ""cte"" AS ""c"" LEFT JOIN ""customers"" AS ""d"" ON ""c"".""customer_id""=""d"".""customer_id"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""month""=6 AND ""total"">=100) AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""month""=7 AND ""total"">=100)"
109,"SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6) GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""price""*""quantity"")>=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"" HAVING SUM(""price""*""quantity"")>=100)"
110,"WITH ""t1"" AS (SELECT ""p"".""price"",""o"".""customer_id"",""o"".""order_date"",""o"".""quantity"",(""p"".""price""*""o"".""quantity"") AS ""total_price"",EXTRACT(YEAR FROM ""o"".""order_date"") AS ""year"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ((EXTRACT(MONTH FROM ""o"".""order_date"")=6)|(EXTRACT(MONTH FROM ""o"".""order_date"")=7)) AND (EXTRACT(YEAR FROM ""o"".""order_date"")=2020)), ""t2"" AS (SELECT ""customer_id"",""month"",SUM(""total_price"") AS ""customer_monthly_spend"" FROM ""t1"" GROUP BY ""customer_id"",""month"" HAVING (""customer_monthly_spend"">=100)) SELECT ""t2"".""customer_id"" AS ""customer_id"",""c"".""name"" AS ""name"" FROM ""t2"" LEFT JOIN ""customers"" AS ""c"" ON ""t2"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING COUNT(1)>1"
111,"SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" ON (""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"") GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""price""*""quantity"" ELSE 0 END)>=100) AND (SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""price""*""quantity"" ELSE 0 END)>=100)"
112,"SELECT ""CO"".""customer_id"",""CO"".""name"" FROM (SELECT ""cust"".""customer_id"",""O"".""order_date"",""cust"".""name"",""O"".""product_id"",""O"".""quantity"" FROM (""Customers"" AS ""cust"") JOIN ""Orders"" AS ""O"" WHERE ""cust"".""customer_id""=""O"".""customer_id"") AS ""CO"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""CO"".""product_id"" GROUP BY ""CO"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
113,"SELECT ""customers"".""customer_id"" AS ""customer_id"",""customers"".""name"" AS ""name"" FROM (""Orders"" AS ""orders"" JOIN ""Product"" AS ""prod"" ON ""orders"".""product_id""=""prod"".""product_id"") JOIN ""Customers"" AS ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"" WHERE LEFT(""orders"".""order_date"", 7)='2020-06' OR LEFT(""orders"".""order_date"", 7)='2020-07' GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-06' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100) AND (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-07' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100)"
114,"SELECT ""sub"".""customer_id"",""sub"".""name"" FROM (SELECT ""o"".""order_id"",""o"".""customer_id"",""c"".""name"",""o"".""product_id"",EXTRACT(YEAR FROM ""o"".""order_date"") AS ""year"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM (""Customers"" AS ""c"" RIGHT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""year"",""month"" HAVING ""total_price"">=100 AND ""year""='2020' AND ""month"" IN ('6','7')) AS ""sub"" GROUP BY ""sub"".""customer_id"" HAVING COUNT(""sub"".""customer_id"")=2"
115,"SELECT ""a"".""customer_id"",""a"".""name"" FROM (SELECT ""Orders"".""customer_id"",""Customers"".""name"",SUM(""Orders"".""quantity""*""Product"".""price"") AS ""cost"" FROM (""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE MONTHNAME(""Orders"".""order_date"")='June' AND EXTRACT(YEAR FROM ""Orders"".""order_date"")=2020 GROUP BY ""Orders"".""customer_id"",""Customers"".""name"" HAVING (""cost"">=100) UNION SELECT ""Orders"".""customer_id"",""Customers"".""name"",SUM(""Orders"".""quantity""*""Product"".""price"") AS ""cost"" FROM (""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE MONTHNAME(""Orders"".""order_date"")='July' AND EXTRACT(YEAR FROM ""Orders"".""order_date"")=2020 GROUP BY ""Orders"".""customer_id"",""Customers"".""name"" HAVING (""cost"">=100)) AS ""a"" GROUP BY ""a"".""customer_id"",""a"".""name"" HAVING COUNT(""a"".""customer_id"")>1"
116,"SELECT ""customer_id"",""name"" FROM (SELECT ""a"".""customer_id"" AS ""customer_id"",""b"".""name"" AS ""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""a"".""order_date"")=6 THEN ""a"".""quantity""*""c"".""price"" ELSE 0 END) AS ""June_spend"",SUM(CASE WHEN EXTRACT(MONTH FROM ""a"".""order_date"")=7 THEN ""a"".""quantity""*""c"".""price"" ELSE 0 END) AS ""July_spend"" FROM ((""Orders"" AS ""a"") JOIN ""Customers"" AS ""b"") JOIN ""Product"" AS ""c"" WHERE ""a"".""customer_id""=""b"".""customer_id"" AND ""a"".""product_id""=""c"".""product_id"" GROUP BY 1) AS ""temp"" WHERE ""June_spend"">=100 AND ""July_spend"">=100"
117,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
118,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
119,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""o"".""product_id"",""o"".""order_date"",""o"".""quantity"",""p"".""price"",""c"".""name"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") AS ""temp_table"" GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN (EXTRACT(MONTH FROM ""order_date"")=6 AND EXTRACT(YEAR FROM ""order_date"")=2020) THEN ""price""*""quantity"" ELSE NULL END)>=100 AND SUM(CASE WHEN (EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")=2020) THEN ""price""*""quantity"" ELSE NULL END)>=100)"
120,"SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"") JOIN ""Product"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='06' THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='07' THEN ""quantity""*""price"" END)>=100"
121,"WITH ""cte"" AS (SELECT ""o"".*,""quantity""*""price"" AS ""amountspent"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id""), ""next_cte"" AS (SELECT ""customer_id"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""Month"",SUM(""amountspent"") AS ""AM"" FROM ""cte"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"",2 HAVING SUM(""amountspent"")>=100) AS ""a"" GROUP BY 1 HAVING COUNT(1)>1) SELECT ""c"".""customer_id"",""name"" FROM ""customers"" AS ""c"" JOIN ""next_cte"" AS ""nc"" ON ""c"".""customer_id""=""nc"".""customer_id"""
122,"WITH ""name1"" AS (SELECT DISTINCT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""a"".""customer_id"" WHERE LEFT(""order_date"", 7)='2020-06' GROUP BY 1,LEFT(""order_date"", 7) HAVING SUM(""price""*""quantity"")>=100), ""name2"" AS (SELECT DISTINCT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""a"".""customer_id"" WHERE LEFT(""order_date"", 7)='2020-07' GROUP BY 1,LEFT(""order_date"", 7) HAVING SUM(""price""*""quantity"")>=100) SELECT DISTINCT ""a"".""customer_id"",""a"".""name"" FROM ""name1"" AS ""a"" JOIN ""name2"" AS ""b"" ON ""a"".""name""=""b"".""name"""
123,"SELECT ""customer_id"",""name"" FROM (""Customers"" AS ""c"" RIGHT JOIN ""Orders"" USING (""customer_id"")) LEFT JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
124,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
125,"SELECT ""customer_id"" AS ""CUSTOMER_ID"",""name"" AS ""NAME"" FROM (""orders"" LEFT JOIN ""product"" USING (""product_id"")) LEFT JOIN ""customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
126,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""quantity""*""price"" ELSE 0 END)>=100"
127,"WITH ""cte"" AS (SELECT DISTINCT ""customer_id"" AS ""cid"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""dt"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""customer_id"",TO_CHAR(""order_date"", 'YYYY-%m') HAVING SUM(""quantity""*""price"")>=100) SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN ""cte"" ON ""c"".""customer_id""=""cte"".""cid"" GROUP BY ""c"".""customer_id"",""c"".""name"" HAVING COUNT(""cte"".""dt"")=2"
128,"WITH ""frequency"" AS (SELECT ""customer_id"",""name"",SUM(""quantity""*""price"") AS ""total"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""customer_id"",""name"",""month"") SELECT ""customer_id"",""name"" FROM ""frequency"" WHERE (""month""=6 OR ""month""=7) AND ""total"">=100 GROUP BY ""customer_id"",""name"" HAVING COUNT(""name"")=2"
129,"SELECT ""tab"".""customer_id"",""c"".""name"" FROM (SELECT ""t"".""customer_id"" FROM (SELECT ""o"".""customer_id"",""p"".""product_id"",""p"".""price""*""o"".""quantity"" AS ""amount"",LEFT(""o"".""order_date"", 7) AS ""Dates"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE LEFT(""o"".""order_date"", 7)='2020-06' OR LEFT(""o"".""order_date"", 7)='2020-07') AS ""t"" GROUP BY ""t"".""customer_id"",""t"".""Dates"" HAVING SUM(""t"".""amount"")>=100) AS ""tab"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""tab"".""customer_id"" GROUP BY ""tab"".""customer_id"" HAVING COUNT(""tab"".""customer_id"")>1"
130,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE (TO_CHAR(""o"".""order_date"", 'YYYY-%m')='2020-06' OR TO_CHAR(""o"".""order_date"", 'YYYY-%m')='2020-07') GROUP BY 1,2,3 HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""c1"".""customer_id"",""c1"".""name"" FROM (""cte"" AS ""c1"") JOIN ""cte"" AS ""c2"" WHERE ""c1"".""customer_id""=""c2"".""customer_id"" AND ""c1"".""month""='2020-06' AND ""c2"".""month""='2020-07'"
131,"SELECT ""sub"".""customer_id"",""sub"".""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""o"".""order_date"",""p"".""price"",""o"".""quantity"",SUM(""o"".""quantity""*""p"".""price"") AS ""total"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total"">=100) AS ""sub"" WHERE EXTRACT(MONTH FROM ""sub"".""order_date"") IN (6,7) GROUP BY 1 HAVING COUNT(1)=2"
132,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"") JOIN ""product"" AS ""p"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
133,"SELECT ""customer_id"",""name"" FROM (SELECT ""a"".""customer_id"",""a"".""name"",TO_CHAR(""b"".""order_date"", 'YYYY-%m') AS ""trans_mon"" FROM (""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""product"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' OR TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' GROUP BY 1,2,""trans_mon"" HAVING SUM(""b"".""quantity""*""c"".""price"")>=100) AS ""d"" GROUP BY 1,2 HAVING COUNT(""customer_id"")=2"
134,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""O"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""o"".""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""o"".""quantity"" ELSE 0 END*""price"")>=100"
135,"SELECT ""customer_id"",""name"" FROM (""Orders"" LEFT JOIN ""Product"" USING (""product_id"")) LEFT JOIN ""Customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" END)>=100"
136,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""mon"",SUM(""o"".""quantity""*""p"".""price"") AS ""amt"",ROW_NUMBER() OVER (PARTITION BY ""o"".""customer_id"" ORDER BY EXTRACT(MONTH FROM ""o"".""order_date"")) AS ""row_num"" FROM (""Customers"" AS ""c"" JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-06%' OR ""o"".""order_date"" LIKE '2020-07%' GROUP BY ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""a"" WHERE ""row_num""=2"
137,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")='06' THEN ""o"".""quantity"" ELSE 0 END*""p"".""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")='07' THEN ""o"".""quantity"" ELSE 0 END*""p"".""price"")>=100"
138,"ERROR: mysql parse error: line 1 column 302 near ""*/ WITH sumquantity AS( select customers.name, customers.customer_id,sum(orders.quantity*product.price) as fprice, month(orders.order_date) as mnth from customers inner join orders on customers.customer_id = orders.customer_id inner join product on orders.product_id = product.product_id group by customers.customer_id,mnth ) select s.name,s.customer_id from sumquantity as s inner join sumquantity as t on s.customer_id = t.customer_id and s.mnth = 6 and t.mnth = 7 and s.fprice >= 100 and t.fprice >= 100 "" "
139,"SELECT ""customer_id"",""name"" FROM (SELECT ""a"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""quantity""*""price"") AS ""tol"" FROM (""orders"" AS ""a"" JOIN ""Customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Product"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND (EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7) GROUP BY 1,2,3 HAVING ""tol"">=100) AS ""a"" GROUP BY 1,2 HAVING COUNT(""m"")=2"
140,"SELECT ""customer_id"",""name"" FROM (""Orders"" JOIN ""Customers"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"",""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""price""*""quantity"" ELSE 0 END)>=100"
141,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
142,"WITH ""june"" AS (SELECT ""customer_id"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""customer_id"" HAVING SUM(""price""*""quantity"")>=100), ""july"" AS (SELECT ""customer_id"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""customer_id"" HAVING SUM(""price""*""quantity"")>=100) SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""june"" ON ""c"".""customer_id""=""june"".""customer_id"") JOIN ""july"" ON ""c"".""customer_id""=""july"".""customer_id"""
143,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-06%' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END) AS ""c_6"",SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-07%' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END) AS ""c_7"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" USING (""customer_id"")) JOIN ""product"" AS ""p"" USING (""product_id"") GROUP BY 1) AS ""temp"" WHERE ""c_6"">=100 AND ""c_7"">=100"
144,"SELECT DISTINCT ""o"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM ""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE (SELECT SUM(""Orders"".""quantity""*""Product"".""price"") FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE (EXTRACT(MONTH FROM ""Orders"".""order_date"")='06') AND ""c"".""customer_id""=""Orders"".""customer_id"")>=100 AND (SELECT SUM(""Orders"".""quantity""*""Product"".""price"") FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE (EXTRACT(MONTH FROM ""Orders"".""order_date"")='07') AND ""c"".""customer_id""=""Orders"".""customer_id"")>=100"
145,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ((""Customers"" AS ""c"") JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING (SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-06%' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-07%' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100)"
146,"SELECT ""c2"".""customer_id"",""c2"".""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"">='2020-06-01' AND ""o"".""order_date""<='2020-07-31' GROUP BY EXTRACT(MONTH FROM ""o"".""order_date""),""c"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""c2"" GROUP BY ""c2"".""customer_id"",""c2"".""name"" HAVING COUNT(1)=2"
147,"SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",SUM(CASE WHEN ""order_date"" LIKE '2020-06%' THEN (""quantity""*""PRICE"") END) AS ""JUNE"",SUM(CASE WHEN ""order_date"" LIKE '2020-07%' THEN (""quantity""*""PRICE"") END) AS ""JULY"" FROM (""Customers"" AS ""c"" RIGHT JOIN ""Orders"" USING (""customer_id"")) LEFT JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"") AS ""A"" WHERE ""JUNE"">99 AND ""JULY"">99"
148,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""month"",SUM(""a"".""quantity""*""b"".""price"") AS ""total"" FROM (SELECT ""customer_id"",""product_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",""quantity"" FROM ""orders"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=6) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=7)) AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"",""a"".""month"") SELECT DISTINCT ""c"".""customer_id"",""d"".""name"" FROM ""cte"" AS ""c"" LEFT JOIN ""customers"" AS ""d"" ON ""c"".""customer_id""=""d"".""customer_id"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""month""=6 AND ""total"">=100) AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""month""=7 AND ""total"">=100)"
149,"WITH ""june_sales"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""o"".""quantity""*""p"".""price"") AS ""totals"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY 1,2), ""july_sales"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""o"".""quantity""*""p"".""price"") AS ""totals"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY 1,2) SELECT DISTINCT ""june_sales"".""customer_id"",""june_sales"".""name"" FROM ""june_sales"" JOIN ""july_sales"" ON ""june_sales"".""customer_id""=""july_sales"".""customer_id"" AND ""june_sales"".""name""=""july_sales"".""name"" WHERE ""june_sales"".""totals"">=100 AND ""july_sales"".""totals"">=100"
150,"SELECT ""Spent"".""customer_id"",""c"".""name"" FROM (WITH ""July"" AS (SELECT ""o"".""customer_id"",SUM(""o"".""quantity""*""p"".""price"") AS ""July_spent"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""order_date""<'2020-08-01' AND ""order_date"">='2020-07-01' GROUP BY ""customer_id"") SELECT ""j"".""customer_id"",""j"".""July_spent"",""June"".""June_spent"" FROM ""July"" AS ""j"" JOIN (SELECT ""o"".""customer_id"",SUM(""o"".""quantity""*""p"".""price"") AS ""June_spent"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""order_date""<'2020-07-01' AND ""order_date"">='2020-06-01' GROUP BY ""customer_id"") AS ""June"" ON ""j"".""customer_id""=""June"".""customer_id"" GROUP BY ""j"".""customer_id"") AS ""Spent"" JOIN ""Customers"" AS ""c"" ON ""Spent"".""customer_id""=""c"".""customer_id"" WHERE ""Spent"".""July_spent"">=100 AND ""Spent"".""June_spent"">=100"
151,"SELECT ""T"".""customer_id"",""c"".""name"" FROM (SELECT ""customer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""y_date"",EXTRACT(MONTH FROM ""order_date"") AS ""m_date"",SUM(""quantity""*""price"") AS ""spent"" FROM (""orders"" AS ""o"") JOIN ""Product"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" AND EXTRACT(YEAR FROM ""order_date"")='2020' AND (EXTRACT(MONTH FROM ""order_date"")='6' OR EXTRACT(MONTH FROM ""order_date"")='7') GROUP BY 1,2,3 HAVING SUM(""quantity""*""price"")>=100) AS ""T"", ""customers"" AS ""c"" WHERE ""T"".""customer_id""=""c"".""customer_id"" GROUP BY ""T"".""customer_id"" HAVING COUNT(""T"".""customer_id"")=2"
152,"SELECT ""customer_id"" AS ""CUSTOMER_ID"",""name"" AS ""NAME"" FROM (""Orders"" JOIN ""Product"" USING (""product_id"")) JOIN ""Customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity"" ELSE 0 END*""price"")>=100"
153,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
154,"WITH ""qualifying_orders_june"" AS (SELECT ""o"".""customer_id"",SUM(""p"".""price""*""o"".""quantity"") AS ""order_total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""o"".""customer_id"" HAVING ""order_total"">=100), ""qualifying_orders_july"" AS (SELECT ""o"".""customer_id"",SUM(""p"".""price""*""o"".""quantity"") AS ""order_total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"" HAVING ""order_total"">=100) SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""qualifying_orders_june"") AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""qualifying_orders_july"")"
155,"SELECT ""customer_id"",""name"" FROM (SELECT ""t1"".""customer_id"",""t1"".""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""t2"".""order_date"")=6 THEN ""t2"".""quantity""*""t3"".""price"" ELSE 0 END) AS ""june_spend"",SUM(CASE WHEN EXTRACT(MONTH FROM ""t2"".""order_date"")=7 THEN ""t2"".""quantity""*""t3"".""price"" ELSE 0 END) AS ""july_spend"" FROM (""customers"" AS ""t1"" LEFT JOIN ""orders"" AS ""t2"" ON ""t2"".""customer_id""=""t1"".""customer_id"") JOIN ""product"" AS ""t3"" ON ""t3"".""product_id""=""t2"".""product_id"" GROUP BY ""t1"".""customer_id"") AS ""t"" WHERE ""june_spend"">=100 AND ""july_spend"">=100"
156,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
157,"SELECT ""t"".""customer_id"",""t"".""name"" FROM (SELECT ""customer_id"",""name"",SUM(""p1"") AS ""s1"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",SUM(""quantity"")*""p"".""price"" AS ""p1"" FROM ((""orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""customers"" AS ""c"" WHERE LEFT(""order_date"", 7) IN ('2020-06') AND ""p"".""product_id""=""o"".""product_id"" AND ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""product_id"",""o"".""customer_id"" ORDER BY ""o"".""customer_id"") AS ""k"" GROUP BY ""customer_id"") AS ""t"", (SELECT ""customer_id"",""name"",SUM(""p2"") AS ""s2"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",SUM(""quantity"")*""p"".""price"" AS ""p2"" FROM ((""orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""customers"" AS ""c"" WHERE LEFT(""order_date"", 7) IN ('2020-07') AND ""p"".""product_id""=""o"".""product_id"" AND ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""product_id"",""o"".""customer_id"" ORDER BY ""o"".""customer_id"") AS ""k"" GROUP BY ""customer_id"") AS ""k"" WHERE ""k"".""customer_id""=""t"".""customer_id"" AND ""s2"">=100 AND ""s1"">=100"
158,"WITH ""totals"" AS (SELECT ""C"".""customer_id"" AS ""CID"",""C"".""Name"" AS ""name"",SUM(""P"".""price""*""O"".""quantity"") AS ""total"",TO_CHAR(""O"".""order_date"", '%M %2020') AS ""dateFix"" FROM (""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" WHERE ""O"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""CID"",""name"",""dateFix"" HAVING ""total"">=100) SELECT DISTINCT ""twice2"".""customer_id"",""twice2"".""name"" FROM (SELECT ""totals"".""CID"" AS ""customer_id"",""totals"".""name"" AS ""name"",COUNT(1) OVER (PARTITION BY ""totals"".""name"") AS ""twice"" FROM ""totals"") AS ""twice2"" WHERE ""twice2"".""twice"">1"
159,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" LIKE '2020-06%' OR ""order_date"" LIKE '2020-07%' GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) SELECT ""customer_id"",""name"" FROM ""cte"" GROUP BY ""customer_id"" HAVING COUNT(1)>1"
160,"WITH ""temp"" AS (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""month"",SUM(""quantity""*""price"") AS ""spend"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)>='2020-06' AND LEFT(""order_date"", 7)<='2020-07' GROUP BY ""customer_id"",""month"" HAVING ""spend"">=100) SELECT DISTINCT ""t"".""customer_id"",""name"" FROM ""temp"" AS ""t"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""t"".""customer_id"" IN (SELECT ""customer_id"" FROM ""temp"" WHERE ""month""='2020-07') AND ""t"".""customer_id"" IN (SELECT ""customer_id"" FROM ""temp"" WHERE ""month""='2020-06')"
161,"WITH ""table1"" AS (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-06%' GROUP BY 1,2 HAVING SUM(""p"".""price""*""o"".""quantity"")>100), ""table2"" AS (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-07%' GROUP BY 1,2 HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""t1"".""customer_id"",""t1"".""name"" FROM ""table1"" AS ""t1"" JOIN ""table2"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"""
162,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
163,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
164,"SELECT ""c"".""customer_id"" AS ""customer_id"",""c"".""name"" AS ""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"" AS ""customer_id"",LEFT(""order_date"", 7) AS ""month"",SUM(""o"".""quantity""*""p"".""price"") AS ""amount"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"",""month"") AS ""tab"" ON ""c"".""customer_id""=""tab"".""customer_id"" WHERE ""tab"".""amount"">=100 GROUP BY ""c"".""customer_id"" HAVING COUNT(1)=2"
165,"SELECT ""customer_id"",""name"" FROM (SELECT ""a"".""customer_id"" AS ""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"" FROM (""orders"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY 1,2,3 HAVING SUM(""price""*""quantity"")>=100) AS ""a"" GROUP BY 1,2 HAVING COUNT(""order_month"")>1"
166,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY 1,LEFT(""order_date"", 7) HAVING SUM(""quantity""*""price"")>=100) AS ""temp"" GROUP BY 2 HAVING COUNT(1)=2"
167,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""O"") JOIN ""Product"" AS ""P"" ON ""c"".""customer_id""=""O"".""customer_id"" AND ""O"".""product_id""=""P"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
168,"WITH ""tmp"" AS (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", '%M YYYY') AS ""year_month_dt"",SUM(""p"".""price""*""o"".""quantity"") AS ""order_amount"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">=DATE('2020-06-01') AND ""o"".""order_date""<=DATE('2020-07-31') GROUP BY ""c"".""customer_id"",TO_CHAR(""o"".""order_date"", '%M YYYY') HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""customer_id"",""name"" FROM ""tmp"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>=2"
169,"WITH ""x"" AS (SELECT DISTINCT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""o"".""quantity""*""p"".""price"") AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""m"" HAVING ""m""=6 OR ""m""=7), ""x1"" AS (SELECT * FROM ""x"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""x"" GROUP BY ""customer_id"" HAVING COUNT(""m"")=2)) SELECT DISTINCT ""customer_id"",""name"" FROM ""x1"" HAVING ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""x1"" WHERE ""tot""<100)"
170,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
171,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""tot"" ELSE 0 END) AS ""June_spend"",SUM(CASE WHEN ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""tot"" ELSE 0 END) AS ""July_spend"" FROM (SELECT ""o"".""customer_id"",""o"".""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""tot"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1,2) AS ""a"" GROUP BY 1 HAVING ""June_spend"">=100 AND ""July_spend"">=100) AS ""tb"" ON ""c"".""customer_id""=""tb"".""customer_id"""
172,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
173,"WITH ""cte1"" AS (SELECT ""o"".""customer_id"",""c"".""name"",""order_date"",SUM(""price""*""quantity"") AS ""spent"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,EXTRACT(MONTH FROM ""order_date"") ORDER BY 1), ""cte2"" AS ((SELECT ""cte1"".""customer_id"",""cte1"".""name"",""cte1"".""spent"" FROM ""cte1"" WHERE EXTRACT(MONTH FROM ""cte1"".""order_date"")=6 AND ""cte1"".""spent"">=100) UNION ALL (SELECT ""cte1"".""customer_id"",""cte1"".""name"",""cte1"".""spent"" FROM ""cte1"" WHERE EXTRACT(MONTH FROM ""cte1"".""order_date"")=7 AND ""cte1"".""spent"">=100)) SELECT ""cte2"".""customer_id"",""cte2"".""name"" FROM ""cte2"" GROUP BY ""cte2"".""customer_id"" HAVING COUNT(""cte2"".""customer_id"")=2"
174,"WITH ""r"" AS (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") BETWEEN 6 AND 7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total_price"">=100 AND ""month"" IN (6,7)) SELECT ""customer_id"",""name"" FROM ""r"" GROUP BY ""customer_id"" HAVING COUNT(1)=2"
175,"WITH ""totals"" AS (SELECT ""C"".""customer_id"" AS ""CID"",""C"".""Name"" AS ""name"",SUM(""P"".""price""*""O"".""quantity"") AS ""total"",TO_CHAR(""O"".""order_date"", '%M %2020') AS ""dateFix"" FROM (""Orders"" AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" WHERE ""O"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""CID"",""name"",""dateFix"" HAVING ""total"">=100) SELECT DISTINCT ""twice2"".""customer_id"",""twice2"".""name"" FROM (SELECT ""totals"".""CID"" AS ""customer_id"",""totals"".""name"" AS ""name"",COUNT(1) OVER (PARTITION BY ""totals"".""name"") AS ""twice"" FROM ""totals"") AS ""twice2"" WHERE ""twice2"".""twice"">1"
176,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity""*""price"" ELSE 0 END)>=100"
177,"WITH ""tb1"" AS (SELECT ""customer_id"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""sales"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""month"" HAVING ""sales"">=100) SELECT ""tb1"".""customer_id"",""c"".""name"" FROM ""tb1"" LEFT JOIN ""customers"" AS ""c"" ON ""tb1"".""customer_id""=""c"".""customer_id"" WHERE ""month""='2020-06' OR ""month""='2020-07' GROUP BY ""c"".""customer_id"" HAVING COUNT(""c"".""customer_id"")=2"
178,"WITH ""customer_spending"" AS (SELECT ""a"".""customer_id"",""a"".""name"",EXTRACT(MONTH FROM ""orders"".""order_date"") AS ""mth"",SUM(""orders"".""quantity""*""product"".""price"") AS ""spending"" FROM (""customers"" AS ""a"" JOIN ""orders"" ON ""a"".""customer_id""=""orders"".""customer_id"") JOIN ""Product"" ON ""orders"".""product_id""=""Product"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""orders"".""order_date"") IN (6,7) GROUP BY ""a"".""customer_id"",""a"".""name"",EXTRACT(MONTH FROM ""orders"".""order_date"")) SELECT DISTINCT ""a"".""customer_id"",""a"".""name"" FROM ""customer_spending"" AS ""a"" WHERE ""spending"">=100 AND ""mth""=6 AND ""a"".""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM ""customer_spending"" WHERE ""spending"">=100 AND ""mth""=7)"
179,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100"
180,"WITH ""monthly_spend_gr_100"" AS (SELECT ""Customers"".""customer_id"",""Customers"".""name"",TO_CHAR(""Orders"".""order_date"", '%M') AS ""order_month"",SUM(""Orders"".""quantity""*""Product"".""price"") AS ""spend"" FROM (""Orders"" JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""Customers"".""customer_id"",""Customers"".""name"",TO_CHAR(""Orders"".""order_date"", '%M') HAVING SUM(""Orders"".""quantity""*""Product"".""price"")>=100) SELECT ""customer_id"",""name"" FROM ""monthly_spend_gr_100"" GROUP BY ""customer_id"",""name"" HAVING COUNT(DISTINCT ""order_month"")=2"
181,"SELECT ""customer_id"",""name"" FROM (""customers"" JOIN ""orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
182,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
183,"WITH ""temp0"" AS (SELECT ""O"".""customer_id"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""order_month"",""quantity""*""price"" AS ""total_price"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" HAVING ""order_month""='2020-06' OR '2020-07'), ""junecustomer"" AS (SELECT ""customer_id"",SUM(""total_price"") AS ""total_price"" FROM ""temp0"" WHERE ""order_month""='2020-06' GROUP BY ""customer_id"" HAVING ""total_price"">=100), ""julycustomer"" AS (SELECT ""customer_id"",SUM(""total_price"") AS ""total_price"" FROM ""temp0"" WHERE ""order_month""='2020-07' GROUP BY ""customer_id"" HAVING ""total_price"">=100), ""customersraw"" AS (SELECT ""J"".""customer_id"" FROM ""junecustomer"" AS ""J"" JOIN ""julycustomer"" AS ""L"" ON ""J"".""customer_id""=""L"".""customer_id""), ""final"" AS (SELECT ""Customers"".""customer_id"" AS ""CUSTOMER_ID"",""Customers"".""name"" AS ""NAME"" FROM ""Customers"" JOIN ""customersraw"" ON ""Customers"".""customer_id""=""customersraw"".""customer_id"") SELECT * FROM ""final"""
184,"WITH ""CTE"" AS (SELECT ""customer_id"",""product_id"",CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN 'June 2020' WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN 'July 2020' END AS ""order_month"",""quantity"" FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' OR TO_CHAR(""order_date"", 'YYYY-%m')='2020-07') SELECT ""a"".""customer_id"",""a"".""name"" FROM (SELECT ""CTE"".""customer_id"",""c"".""name"",""CTE"".""order_month"" FROM (""Product"" AS ""p"" JOIN ""CTE"" ON ""p"".""product_id""=""CTE"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""CTE"".""customer_id""=""c"".""customer_id"" GROUP BY ""CTE"".""customer_id"",""CTE"".""order_month"" HAVING SUM(""CTE"".""quantity""*""p"".""price"")>=100) AS ""a"" GROUP BY ""a"".""customer_id"" HAVING COUNT(1)=2"
185,"SELECT ""C"".""CUSTOMER_ID"",""C"".""NAME"" FROM ""CUSTOMERS"" AS ""C"" JOIN (SELECT ""CUSTOMER_ID"",SUM(CASE WHEN TO_CHAR(""ORDER_DATE"", '%m')='06' THEN ""P"".""PRICE""*""QUANTITY"" END) AS ""JUNE_SUM"",SUM(CASE WHEN TO_CHAR(""ORDER_DATE"", '%m')='07' THEN ""P"".""PRICE""*""QUANTITY"" END) AS ""JULY_SUM"" FROM ""ORDERS"" AS ""O"" JOIN ""PRODUCT"" AS ""P"" ON ""P"".""PRODUCT_ID""=""O"".""PRODUCT_ID"" GROUP BY ""CUSTOMER_ID"" HAVING ""JUNE_SUM"">=100 AND ""JULY_SUM"">=100) AS ""TOTAL"" ON ""C"".""CUSTOMER_ID""=""TOTAL"".""CUSTOMER_ID"""
186,"WITH ""frequency"" AS (SELECT ""customer_id"",""name"",SUM(""quantity""*""price"") AS ""total"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""customer_id"",""name"",""month"") SELECT ""customer_id"",""name"" FROM ""frequency"" WHERE (""month""=6 OR ""month""=7) AND ""total"">=100 GROUP BY ""customer_id"",""name"" HAVING COUNT(""name"")=2"
187,"SELECT DISTINCT ""fin"".""customer_id"",""fin"".""name"" FROM (SELECT ""a"".""customer_id"",""a"".""name"",COUNT(1) OVER (PARTITION BY ""a"".""customer_id"") AS ""cnt"" FROM (SELECT EXTRACT(YEAR FROM ""o"".""order_date""),EXTRACT(MONTH FROM ""o"".""order_date""),""o"".""customer_id"",""c"".""name"",SUM(""quantity""*""price"") AS ""price"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY EXTRACT(YEAR FROM ""o"".""order_date""),EXTRACT(MONTH FROM ""o"".""order_date""),""customer_id"" HAVING ""price"">=100) AS ""a"") AS ""fin"" WHERE ""fin"".""cnt""=2"
188,"SELECT ""C"".""customer_id"",""C"".""name"" FROM ((""Customers"" AS ""C"") JOIN ""Product"" AS ""P"") JOIN ""Orders"" AS ""O"" WHERE ""O"".""product_id""=""P"".""product_id"" AND ""O"".""customer_id""=""C"".""customer_id"" GROUP BY ""C"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""O"".""order_date"", 7)='2020-06' THEN ""O"".""quantity"" ELSE 0 END*""P"".""price"")>=100 AND SUM(CASE WHEN LEFT(""O"".""order_date"", 7)='2020-07' THEN ""O"".""quantity"" ELSE 0 END*""P"".""price"")>=100"
189,"SELECT ""customers"".""customer_id"" AS ""customer_id"",""customers"".""name"" AS ""name"" FROM (""Orders"" AS ""orders"" JOIN ""Product"" AS ""prod"" ON ""orders"".""product_id""=""prod"".""product_id"") JOIN ""Customers"" AS ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"" GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-06' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100) AND (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-07' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100)"
190,"SELECT ""c"".""customer_id"",""name"" FROM (SELECT DISTINCT ""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 AND EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY 1 HAVING SUM(""price""*""quantity"")>=100 UNION ALL SELECT DISTINCT ""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY 1 HAVING SUM(""price""*""quantity"")>=100) AS ""u"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""u"".""customer_id"" GROUP BY 1 HAVING COUNT(""c"".""customer_id"")>1"
191,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""name"",SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""price""*""quantity"" ELSE 0 END) AS ""total_june"",SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""price""*""quantity"" ELSE 0 END) AS ""total_july"" FROM (""customers"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""product"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY 1,2) SELECT ""customer_id"",""name"" FROM ""cte"" WHERE ""total_june"">=100 AND ""total_july"">=100"
192,"WITH ""cte"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""month""), ""c2"" AS (SELECT ""customer_id"",SUM(CASE WHEN ""total"">=100 THEN 1 ELSE 0 END) AS ""chec"" FROM ""cte"" WHERE ""month""=6 OR ""month""=7 GROUP BY ""customer_id"") SELECT ""c"".""customer_id"",""name"" FROM ""Customers"" AS ""c"" LEFT JOIN ""c2"" ON ""c"".""customer_id""=""c2"".""customer_id"" WHERE ""chec""=2"
193,"SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM ((""Customers"" AS ""c"") JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" AND ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' AND ""c"".""customer_id"" IN (SELECT ""c1"".""customer_id"" FROM ((""Customers"" AS ""c1"") JOIN ""Product"" AS ""p1"") JOIN ""Orders"" AS ""o1"" WHERE ""c1"".""customer_id""=""o1"".""customer_id"" AND ""p1"".""product_id""=""o1"".""product_id"" AND ""o1"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""c1"".""customer_id"" HAVING SUM(""o1"".""quantity""*""p1"".""price"")>=100) GROUP BY ""c"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100"
194,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN SUBSTR(""order_date"", 1, 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN SUBSTR(""order_date"", 1, 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
195,"WITH ""t1"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""tot_sale"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE (EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7) AND EXTRACT(YEAR FROM ""o"".""order_date"")=2020 GROUP BY ""c"".""customer_id"",""c"".""name"",""month"") SELECT DISTINCT ""customer_id"",""name"" FROM ""t1"" WHERE ROW(""customer_id"",""name"") IN (SELECT ""customer_id"",""name"" FROM ""t1"" WHERE ""month""=6 AND ""tot_sale"">=100) AND ROW(""customer_id"",""name"") IN (SELECT ""customer_id"",""name"" FROM ""t1"" WHERE ""month""=7 AND ""tot_sale"">=100)"
196,"WITH ""groupby_and_add_2_month_columns"" AS (SELECT SUM(CASE WHEN TO_CHAR(""Orders"".""order_date"", 'YYYY-%m')='2020-06' THEN ""quantity"" ELSE 0 END*""Product"".""price"") AS ""June_spent"",SUM(CASE WHEN TO_CHAR(""Orders"".""order_date"", 'YYYY-%m')='2020-07' THEN ""quantity"" ELSE 0 END*""Product"".""price"") AS ""July_spent"",""Customers"".""customer_id"",""Customers"".""name"" FROM (""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" GROUP BY ""customer_id"") SELECT ""customer_id"",""name"" FROM ""groupby_and_add_2_month_columns"" WHERE ""June_spent"">=100 AND ""July_spent"">=100"
197,"WITH ""t1"" AS (SELECT ""c"".""customer_id"",""name"",SUM(""price""*""quantity"") AS ""sales"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""c"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") HAVING ""sales"">=100) SELECT ""customer_id"",""name"" FROM ""t1"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>1"
198,"WITH ""cte"" AS (SELECT ""o"".""order_id"",""o"".""customer_id"",""c"".""name"",""o"".""product_id"",""o"".""order_date"",""o"".""quantity"",""p"".""price"",""o"".""quantity""*""p"".""price"" AS ""tot"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31') SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""tot"" ELSE 0 END) AS ""june"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""tot"" ELSE 0 END) AS ""july"" FROM ""cte"" GROUP BY ""customer_id"") AS ""temp"" WHERE ""june"">=100 AND ""july"">=100"
199,"SELECT ""a"".""customer_id"" AS ""customer_id"",""a"".""name"" AS ""name"" FROM (""orders"" AS ""c"" JOIN ""customers"" AS ""a"") LEFT JOIN ""product"" AS ""b"" ON ""c"".""customer_id""=""a"".""customer_id"" AND ""c"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100 AND SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100"
200,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""price""*""quantity"") AS ""cost"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""order_date"">='2020-06-01' AND ""order_date""<='2020-07-31' GROUP BY ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"")) AS ""t"" GROUP BY ""customer_id"",""name"" HAVING SUM(CASE WHEN ""cost"">=100 THEN 1 ELSE 0 END)=2"
201,"WITH ""temp"" AS (SELECT ""customer_id"",""name"",SUM(""price""*""quantity"") AS ""spend"",LEFT(""order_date"", 7) AS ""month"" FROM (""orders"" JOIN ""customers"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") GROUP BY ""orders"".""customer_id"",LEFT(""order_date"", 7)) SELECT DISTINCT ""customer_id"",""name"" FROM ""temp"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""temp"" WHERE ""spend"">=100 AND ""month""='2020-06') AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""temp"" WHERE ""spend"">=100 AND ""month""='2020-07')"
202,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
203,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" USING (""product_id"")) JOIN ""customers"" AS ""c"" USING (""customer_id"") WHERE SUBSTR(""order_date"", 1, 7) IN ('2020-06','2020-07') GROUP BY 1 HAVING SUM(CASE WHEN SUBSTR(""order_date"", 1, 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN SUBSTR(""order_date"", 1, 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
204,"WITH ""res"" AS (SELECT ""customer_id"",SUBSTR(""o"".""order_date"", 1, 7) AS ""order_month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE SUBSTR(""o"".""order_date"", 1, 7) IN ('2020-06','2020-07') GROUP BY 1,2) SELECT ""r"".""customer_id"",""c"".""name"" FROM ""res"" AS ""r"" JOIN ""customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""r"".""order_month""='2020-06' AND ""r"".""total_price"">=100 THEN 1 ELSE 0 END)=1 AND SUM(CASE WHEN ""r"".""order_month""='2020-07' AND ""r"".""total_price"">=100 THEN 1 ELSE 0 END)=1"
205,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
206,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date""),SUM(""price""*""quantity"") AS ""s"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1,2,3) SELECT ""customer_id"",""name"" FROM ""cte"" WHERE ""s"">=100 GROUP BY 1,2 HAVING COUNT(1)=2"
207,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""spent_month"",SUM(""o"".""quantity""*""p"".""price"") AS ""total_spent"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY ""customer_id"",LEFT(""order_date"", 7) HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""t"" ON ""t"".""customer_id""=""c"".""customer_id"" GROUP BY ""t"".""customer_id"" HAVING COUNT(1)=2"
208,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
209,"ERROR: mysql parse error: line 1 column 257 near "";&amp; total >= 100) or (mon = 7 &amp;&amp; total >= 100) ) t left join Customers c on c.customer_id = t.id group by t.id having count(t.total) = 2 "" "
210,"WITH ""cte"" AS (SELECT ""c"".""name"",""a"".""customer_id"" FROM (SELECT ""o"".*,""p"".""price"",(""price""*""quantity"") AS ""total"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") AS ""a"" JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(MONTH FROM ""a"".""order_date"")=6 OR EXTRACT(MONTH FROM ""a"".""order_date"")=7 GROUP BY ""a"".""customer_id"",EXTRACT(MONTH FROM ""a"".""order_date"") HAVING SUM(""a"".""total"")>=100) SELECT ""name"",""customer_id"" FROM ""cte"" GROUP BY ""name"" HAVING COUNT(1)>=2"
211,"SELECT ""Orders"".""customer_id"",""name"" FROM (""Orders"" JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" GROUP BY ""Orders"".""customer_id"" HAVING SUM((CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-06' THEN ""quantity"" ELSE 0 END)*""price"")>=100 AND SUM((CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-07' THEN ""quantity"" ELSE 0 END)*""price"")>=100"
212,"SELECT ""a"".""customer_id"",""a"".""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(YEAR_MONTH FROM ""order_date""),SUM(""quantity""*""price"") FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON (""c"".""customer_id""=""o"".""customer_id"")) JOIN ""Product"" AS ""p"" ON (""p"".""product_id""=""o"".""product_id"") WHERE EXTRACT(YEAR_MONTH FROM ""order_date"") IN (202006,202007) GROUP BY ""c"".""customer_id"",""c"".""name"",EXTRACT(YEAR_MONTH FROM ""order_date"") HAVING SUM(""quantity""*""price"")>=100) AS ""a"" GROUP BY ""a"".""customer_id"",""a"".""name"" HAVING COUNT(1)>1"
213,"SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM (SELECT ""a"".""customer_id"",EXTRACT(MONTH FROM ""a"".""order_date"") AS ""mon"" FROM ""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""a"".""customer_id"",EXTRACT(MONTH FROM ""a"".""order_date"") HAVING SUM(""quantity""*""price"")>=100) AS ""c1"" JOIN ""Customers"" AS ""c"" ON ""c1"".""customer_id""=""c"".""customer_id"" GROUP BY ""c1"".""customer_id"" HAVING COUNT(1)=2"
214,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN TO_CHAR(""order_Date"", 'YYYY%m')=202006 THEN (""p"".""price""*""o"".""quantity"") END)>=100 AND SUM(CASE WHEN TO_CHAR(""order_Date"", 'YYYY%m')=202007 THEN (""p"".""price""*""o"".""quantity"") END)>=100"
215,"SELECT ""customers"".""customer_id"",""name"" FROM ((""customers"") JOIN ""product"") JOIN ""orders"" WHERE ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_id""=""product"".""product_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
216,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")='06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")='07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
217,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(""tot"") AS ""tot2"" FROM (SELECT ""customer_id"",""ym"",""total"",SUM(CASE WHEN ""total"">=100 THEN 1 ELSE 0 END) AS ""tot"" FROM (SELECT ""customer_id"",TO_CHAR(""order_date"", 'YYYY%m') AS ""ym"",SUM(""price""*""quantity"") AS ""total"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY%m') IN ('202006','202007') GROUP BY ""customer_id"",TO_CHAR(""order_date"", 'YYYY%m')) AS ""r"" GROUP BY ""customer_id"",""ym"") AS ""t"" GROUP BY ""customer_id"" HAVING SUM(""tot"")>1) AS ""sub"" ON ""c"".""customer_id""=""sub"".""customer_id"""
218,"WITH ""x"" AS (SELECT DISTINCT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""o"".""quantity""*""p"".""price"") AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""m"" HAVING ""m""=6 OR ""m""=7), ""x1"" AS (SELECT * FROM ""x"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""x"" GROUP BY ""customer_id"" HAVING COUNT(""m"")=2)) SELECT DISTINCT ""customer_id"",""name"" FROM ""x1"" HAVING ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""x1"" WHERE ""tot""<100)"
219,"WITH ""order_month"" (""order_id"", ""customer_id"", ""product_id"", ""month"", ""quantity"") AS (SELECT ""order_id"",""customer_id"",""product_id"",EXTRACT(MONTH FROM ""order_date""),""quantity"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7) SELECT * FROM (SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""name"" AS ""NAME"" FROM (""product"" AS ""p"" JOIN ""order_month"" AS ""o"" USING (""product_id"")) JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"",""month"" HAVING SUM(""price""*""quantity"")>=100) AS ""tem"" GROUP BY ""CUSTOMER_ID"" HAVING COUNT(1)=2"
220,"SELECT ""T"".""customer_id"",""T"".""name"" FROM (SELECT ""Customers"".""name"",""Customers"".""customer_id"",SUM(CASE WHEN ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""quantity""*""price"" ELSE 0 END) AS ""June"",SUM(CASE WHEN ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""quantity""*""price"" ELSE 0 END) AS ""July"" FROM (""Orders"" LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" GROUP BY ""Orders"".""customer_id"") AS ""T"" WHERE ""T"".""June"">=100 AND ""T"".""July"">=100"
221,"SELECT ""a"".""customer_id"" AS ""customer_id"",""a"".""name"" AS ""name"" FROM (""customers"" AS ""a"" JOIN ""product"" AS ""b"") LEFT JOIN ""orders"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""b"".""product_id""=""c"".""product_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100 AND SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100"
222,"SELECT ""customers"".""customer_id"",""customers"".""name"" FROM ""customers"" JOIN (SELECT ""monthlyspends"".""customer_id"",COUNT(""monthlyspends"".""month"") AS ""monthcount"" FROM (SELECT ""custprodorder"".""customer_id"",SUM(""price""*""custprodorder"".""quantity"") AS ""total"",""custprodorder"".""month"" FROM ""product"" JOIN (SELECT ""customer_id"",""product_id"",SUM(""quantity"") AS ""quantity"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"",""product_id"",EXTRACT(MONTH FROM ""order_date"")) AS ""custprodorder"" ON ""product"".""product_id""=""custprodorder"".""product_id"" GROUP BY ""customer_id"",""custprodorder"".""month"" HAVING ""total"">=100) AS ""monthlyspends"" GROUP BY ""monthlyspends"".""customer_id"" HAVING ""monthcount""=2) AS ""result"" ON ""customers"".""customer_id""=""result"".""customer_id"""
223,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity"" ELSE 0 END*""p"".""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity"" ELSE 0 END*""p"".""price"")>=100"
224,"WITH ""cte"" AS (SELECT ""customer_id"",SUM(CASE WHEN MONTHNAME(""order_date"")='June' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""June_Sales"",SUM(CASE WHEN MONTHNAME(""order_date"")='July' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""July_Sales"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY ""customer_id"") SELECT ""cte"".""customer_id"",""name"" FROM ""cte"" JOIN ""customers"" USING (""customer_id"") WHERE ""June_Sales"">=100 AND ""July_Sales"">=100"
225,"SELECT ""x"".""customer_id"",""x"".""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""o"".""date_order"",SUM(""o"".""quantity""*""p"".""price"") AS ""total"" FROM (""customers"" AS ""c"" JOIN (SELECT *,LEFT(""order_date"", 7) AS ""date_order"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31') AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2,3) AS ""x"" GROUP BY 1,2 HAVING SUM(""total"">=100)=2"
226,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""price""*""quantity"" ELSE 0 END)>=100"
227,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""month"") AS ""a"" GROUP BY 1 HAVING SUM(CASE WHEN ""month""='2020-06' AND ""total"">=100 THEN 1 WHEN ""month""='2020-07' AND ""total"">=100 THEN 1 ELSE 0 END)=2"
228,"WITH ""t0"" AS (SELECT ""o"".""customer_id"",""o"".""order_date"",(""o"".""quantity""*""p"".""price"") AS ""total"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id""), ""t1"" AS (SELECT ""customer_id"",COUNT(""customer_id"") AS ""cnt"" FROM (SELECT ""customer_id"",SUM(""total"") AS ""monthly"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM ""t0"" WHERE (EXTRACT(MONTH FROM ""order_date"")='6' OR EXTRACT(MONTH FROM ""order_date"")='7') GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"")) AS ""A"" WHERE ""A"".""monthly"">=100 GROUP BY ""customer_id"") SELECT ""t"".""customer_id"",""c"".""name"" FROM ""t1"" AS ""t"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""t"".""customer_id"" WHERE ""t"".""cnt"">=2"
229,"WITH ""cte"" AS (SELECT EXTRACT(MONTH FROM ""order_date"") AS ""mo"",""customer_id"",SUM(""quantity""*""price"") FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY EXTRACT(MONTH FROM ""order_date""),""customer_id"" HAVING SUM(""quantity""*""price"")>=100) SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""cte"" AS ""cte1"" ON ""cte1"".""customer_id""=""c"".""customer_id"" AND ""cte1"".""mo""=6) JOIN ""cte"" AS ""cte2"" ON ""cte2"".""customer_id""=""c"".""customer_id"" AND ""cte2"".""mo""=7"
230,"WITH ""cte"" AS (SELECT ""b"".""customer_id"",SUM(""a"".""price""*""b"".""quantity"") AS ""price"",EXTRACT(MONTH FROM ""b"".""order_date"") AS ""d"" FROM ""product"" AS ""a"" JOIN ""orders"" AS ""b"" USING (""product_id"") WHERE EXTRACT(MONTH FROM ""b"".""order_date"") IN (6,7) GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""b"".""order_date"") HAVING ""price"">=100) SELECT ""a"".""customer_id"",""a"".""name"" FROM ""customers"" AS ""a"" JOIN ""cte"" AS ""b"" USING (""customer_id"") GROUP BY ""b"".""customer_id"" HAVING COUNT(1)=2"
231,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
232,"SELECT ""cust"".""customer_id"",""name"" FROM ""Customers"" AS ""cust"" JOIN (SELECT ""ordersA"".""customer_id"",SUM(""prod"".""price""*""ordersA"".""quan_6"") AS ""spending_6"",SUM(""prod"".""price""*""ordersA"".""quan_7"") AS ""spending_7"" FROM ""Product"" AS ""prod"" JOIN (SELECT *,CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END AS ""quan_6"",CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END AS ""quan_7"" FROM ""Orders"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07') AS ""ordersA"" ON ""ordersA"".""product_id""=""prod"".""product_id"" GROUP BY ""ordersA"".""customer_id"" HAVING ""spending_6"">=100 AND ""spending_7"">=100) AS ""orderprodB"" ON ""cust"".""customer_id""=""orderprodB"".""customer_id"""
233,"SELECT ""customer_id"",""name"" AS ""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY 1 HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" ELSE 0 END)>=100"
234,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100"
235,"SELECT ""Customers"".""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"") JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' OR TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' GROUP BY ""Customers"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" ELSE 0 END)>=100"
236,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AND ""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100)"
237,"SELECT DISTINCT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" ELSE NULL END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" ELSE NULL END)>=100"
238,"WITH ""a"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""o"".""quantity""*""p"".""price"") AS ""total"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",""c"".""name"",""month"" ORDER BY ""customer_id""), ""x"" AS (SELECT DISTINCT ""customer_id"",""name"",""month"" FROM ""a"" WHERE ""a"".""total"">99 AND ""a"".""month""=6), ""y"" AS (SELECT DISTINCT ""customer_id"",""name"",""month"" FROM ""a"" WHERE ""a"".""total"">99 AND ""a"".""month""=7) SELECT ""x"".""customer_id"",""x"".""name"" FROM ""x"" JOIN ""y"" ON ""x"".""customer_id""=""y"".""customer_id"""
239,"SELECT ""customer_id"",""name"" FROM ""Customers"" NATURAL JOIN (SELECT ""customer_id"",""mon"",SUM(""tot"") AS ""tot_spend"" FROM (SELECT ""order_id"",""customer_id"",""product_id"",EXTRACT(YEAR FROM ""order_date"") AS ""yr"",EXTRACT(MONTH FROM ""order_date"") AS ""mon"",""price""*""quantity"" AS ""tot"" FROM ""Product"" NATURAL JOIN ""Orders"") AS ""t1"" WHERE ""yr""='2020' AND (""mon""=6 OR ""mon""=7) GROUP BY ""customer_id"",""mon"") AS ""t2"" WHERE ""tot_spend"">=100 GROUP BY ""customer_id"",""name"" HAVING COUNT(DISTINCT ""mon"")=2"
240,"SELECT DISTINCT ""o"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE (SELECT SUM(""Orders"".""quantity""*""Product"".""price"") FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE (EXTRACT(MONTH FROM ""Orders"".""order_date"")='06') AND ""c"".""customer_id""=""Orders"".""customer_id"")>=100 AND (SELECT SUM(""Orders"".""quantity""*""Product"".""price"") FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE EXTRACT(MONTH FROM ""Orders"".""order_date"")='07' AND ""c"".""customer_id""=""Orders"".""customer_id"")>=100"
241,"SELECT DISTINCT ""customer_id"",""name"" FROM (SELECT EXTRACT(YEAR FROM ""order_date"") AS ""year"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",""o"".""customer_id"",""c"".""name"",SUM((""o"".""quantity""*""p"".""price"")) AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" USING (""customer_id"")) LEFT JOIN ""product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' AND EXTRACT(MONTH FROM ""order_date"")='6' GROUP BY EXTRACT(YEAR FROM ""order_date""),EXTRACT(MONTH FROM ""order_date""),""o"".""customer_id"",""c"".""name"" HAVING ""tot"">=100) AS ""a"" WHERE ""customer_id"" IN (SELECT DISTINCT ""customer_id"" FROM (SELECT EXTRACT(YEAR FROM ""order_date"") AS ""year"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",""o"".""customer_id"",""c"".""name"",SUM((""o"".""quantity""*""p"".""price"")) AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" USING (""customer_id"")) LEFT JOIN ""product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' AND EXTRACT(MONTH FROM ""order_date"")='7' GROUP BY EXTRACT(YEAR FROM ""order_date""),EXTRACT(MONTH FROM ""order_date""),""o"".""customer_id"",""c"".""name"" HAVING ""tot"">=100) AS ""b"")"
242,"SELECT DISTINCT ""customers"".""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",LEFT(""order_date"", 7) AS ""yearmonth"",SUM(""quantity""*""price"") AS ""order_size"",COUNT(""o"".""customer_id"") OVER (PARTITION BY ""o"".""customer_id"") AS ""cnt"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE LEFT(""order_date"", 7) IN ('2020-06','2020-07') GROUP BY ""customer_id"",LEFT(""order_date"", 7) HAVING SUM(""quantity""*""price"")>=100) AS ""a"" JOIN ""customers"" ON ""customers"".""customer_id""=""a"".""customer_id"" WHERE ""a"".""cnt""=2"
243,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
244,"SELECT ""T"".""customer_id"",""T"".""name"" FROM (SELECT ""O"".""customer_id"",""C"".""name"",SUM(""O"".""quantity""*""P"".""price"") AS ""total"" FROM ((SELECT * FROM ""orders"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31') AS ""O"" JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY ""O"".""customer_id"",TO_CHAR(""O"".""order_date"", 'YYYY-%m') HAVING ""total"">=100) AS ""T"" GROUP BY ""T"".""customer_id"" HAVING COUNT(1)>1"
245,"WITH ""cte1"" AS (SELECT ""customer_id"",""order_date"",""price"",""quantity"" FROM ""Orders"" JOIN ""Product"" USING (""product_id"")), ""jun"" AS (SELECT ""customer_id"" FROM ""cte1"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY 1 HAVING SUM(""price""*""quantity"")>=100), ""jul"" AS (SELECT ""customer_id"" FROM ""cte1"" WHERE ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY 1 HAVING SUM(""price""*""quantity"")>=100) SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT * FROM ""jun"") AND ""customer_id"" IN (SELECT * FROM ""jul"")"
246,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
247,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""month"" HAVING ""month""=6 OR ""month""=7) AS ""temp"", ""Customers"" AS ""c"" WHERE ""c"".""customer_id""=""temp"".""customer_id"" AND ""temp"".""total"">=100 GROUP BY ""c"".""name"" HAVING COUNT(1)=2"
248,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
249,"SELECT ""CUSTOMER_ID"",""NAME"" FROM ""CUSTOMERS"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""ORDERS"" AS ""O"" JOIN ""PRODUCT"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN (""quantity""*""price"") ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN (""quantity""*""price"") ELSE 0 END)>=100)"
250,"SELECT ""customer_id"" AS ""CUSTOMER_ID"",""name"" AS ""NAME"" FROM (SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"",(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END) AS ""June_spend"",(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END) AS ""July_spend"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""June_spend"")>=100 AND SUM(""JULY_spend"")>=100) AS ""p"""
251,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""price""*""quantity"")>=100) AS ""a"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>=2"
252,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""mon"" FROM (""Orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""o"".""order_date"")=2020 GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""X"" GROUP BY ""customer_id"" HAVING MIN(""mon"")!=MAX(""mon"")"
253,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
254,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
255,"WITH ""base"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUBSTRING(""order_date"", 6, 2) AS ""month"",SUM(""o"".""quantity""*""p"".""price"") AS ""spent"" FROM (""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1,2,3) SELECT DISTINCT ""customer_id"",""name"" FROM ""base"" WHERE ""spent"">=100 GROUP BY 1,2 HAVING COUNT(DISTINCT ""month"")=2"
256,"WITH ""temp"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",CASE WHEN (SUM(""o"".""quantity""*""p"".""price"")>=100) THEN 1 ELSE 0 END AS ""monthly_spent_100"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-02' AND '2020-07-31' GROUP BY ""c"".""customer_id"",""c"".""name"",""month"") SELECT ""customer_id"",""name"" FROM ""temp"" GROUP BY ""customer_id"",""name"" HAVING SUM(""monthly_spent_100"")=2"
257,"WITH ""cte"" AS (SELECT ""order_id"",""o"".""customer_id"",""c"".""name"",""o"".""product_id"",""order_date"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""order_month"",""quantity"",""p"".""price"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",CASE WHEN ""order_month"" IN ('2020-06','2020-07') THEN 1 ELSE 0 END AS ""ind"" FROM (SELECT ""customer_id"",""name"",""order_month"" FROM ""cte"" GROUP BY ""customer_id"",""name"",""order_month"" HAVING SUM(""quantity""*""price"")>=100) AS ""t"") AS ""t1"" GROUP BY ""customer_id"",""name"" HAVING SUM(""ind"")=2"
258,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100"
259,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""name"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""price""*""quantity"")>=100) AS ""a"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>=2"
260,"WITH ""cteResult"" AS (SELECT ""c"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date""),SUM(""quantity""*""price"") FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""customers"" AS ""c"" ON ""c"".""customer_Id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""c"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""quantity""*""price"")>=100) SELECT ""customer_id"",""name"" FROM ""cteResult"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>1"
261,"WITH ""x"" AS (SELECT DISTINCT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""o"".""quantity""*""p"".""price"") AS ""tot"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""m"" HAVING ""m""=6 OR ""m""=7), ""x1"" AS (SELECT * FROM ""x"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""x"" GROUP BY ""customer_id"" HAVING COUNT(""m"")=2)) SELECT DISTINCT ""customer_id"",""name"" FROM ""x1"" HAVING ""customer_id"" NOT IN (SELECT ""customer_id"" FROM ""x1"" WHERE ""tot""<100)"
262,"WITH ""t1"" AS (SELECT ""a"".""customer_id"",""c"".""name"",SUM(""b"".""price""*""a"".""quantity"") AS ""cost"",TO_CHAR(""order_date"", '%M') AS ""month"" FROM (""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE TO_CHAR(""order_date"", '%M') IN ('June','July') GROUP BY ""a"".""customer_id"",""month"") SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",SUM(CASE WHEN ""cost"">=100 THEN 1 ELSE 0 END) AS ""s"" FROM ""t1"" GROUP BY ""customer_id"" HAVING ""s""=2) AS ""t2"""
263,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (SELECT ""t"".""customer_id"" FROM (SELECT ""o"".""customer_id"",SUBSTR(""order_date"", 1, 7) AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""Spend"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" AND (SUBSTR(""o"".""order_date"", 1, 7)='2020-06' OR SUBSTR(""o"".""order_date"", 1, 7)='2020-07') GROUP BY ""month"",""customer_id"") AS ""t"" WHERE ""Spend"">=100 GROUP BY ""customer_id"" HAVING COUNT(""t"".""customer_id"")>1) AS ""cc"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""cc"".""customer_id"""
264,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" USING (""customer_id"")) JOIN ""product"" AS ""p"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
265,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" JOIN ""product"" ON ""orders"".""product_id""=""product"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=6 GROUP BY ""customer_id"" HAVING SUM(""price""*""quantity"")>=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" JOIN ""product"" ON ""orders"".""product_id""=""product"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"" HAVING SUM(""price""*""quantity"")>=100)"
266,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""month"") AS ""a"" GROUP BY 1 HAVING SUM(CASE WHEN ""month""='2020-06' AND ""total"">=100 THEN 1 WHEN ""month""='2020-07' AND ""total"">=100 THEN 1 ELSE 0 END)=2"
267,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY 1,2 HAVING SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100"
268,"WITH ""tmp"" AS (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", '%M YYYY') AS ""year_month_dt"",""p"".""price""*""o"".""quantity"" AS ""order_amount"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">=DATE('2020-06-01') AND ""o"".""order_date""<=DATE('2020-07-31')) SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",""year_month_dt"",SUM(""order_amount"") AS ""month_amount"" FROM ""tmp"" GROUP BY ""customer_id"",""year_month_dt"") AS ""tmp2"" WHERE ""month_amount"">=100 GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>=2"
269,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""month"") AS ""a"" GROUP BY 1 HAVING SUM(CASE WHEN ""month""='2020-06' AND ""total"">=100 THEN 1 WHEN ""month""='2020-07' AND ""total"">=100 THEN 1 ELSE 0 END)=2"
270,"SELECT ""o"".""customer_id"",""c"".""name"" FROM ((""Orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""Customers"" AS ""c"" WHERE ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""c"".""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100"
271,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""sales"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m')) SELECT ""customer_id"",""name"" FROM ""t"" GROUP BY ""customer_id"",""name"" HAVING SUM(""sales"">=100)=2"
272,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING (SUM(CASE WHEN ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""o"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100)"
273,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
274,"SELECT ""o"".""customer_id"",""name"" FROM ((""Orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""Customers"" AS ""c"" WHERE ""o"".""product_id""=""p"".""product_id"" AND ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
275,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""c"".""name"",(CASE WHEN SUM(""p"".""price""*""o"".""quantity"")>=100 THEN 1 ELSE 0 END) AS ""b"",EXTRACT(MONTH FROM ""order_date"") FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN ('7','6') GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"")) SELECT ""customer_id"",""name"" FROM ""cte"" GROUP BY ""name"" HAVING SUM(""b"")=2"
276,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE (""customer_id"") IN (SELECT ""customer_id"" FROM ""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' GROUP BY LEFT(""order_date"", 7),""customer_id"" HAVING SUM(""price""*""quantity"")>=100) AND (""customer_id"") IN (SELECT ""customer_id"" FROM ""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-07' GROUP BY LEFT(""order_date"", 7),""customer_id"" HAVING SUM(""price""*""quantity"")>=100)"
277,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""order_date"", '%y-%m') AS ""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""total"" FROM (""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",TO_CHAR(""order_date"", '%y-%m') HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""a"" WHERE (""order_date""='20-06' OR ""order_date""='20-07') GROUP BY ""customer_id"",""name"" HAVING COUNT(""customer_id"")=2"
278,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date""),SUM(""spend""),CASE WHEN EXTRACT(MONTH FROM ""ORDER_DATE"")='6' AND SUM(""SPEND"")>='100' THEN 'Y' WHEN EXTRACT(MONTH FROM ""ORDER_DATE"")='7' AND SUM(""SPEND"")>='100' THEN 'Y' ELSE 'N' END AS ""FLAG"" FROM (SELECT ""a"".*,""b"".""price""*""a"".""quantity"" AS ""spend"" FROM ""orders"" AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE EXTRACT(MONTH FROM ""a"".""order_date"") IN ('6','7')) AS ""c"" GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"")) AS ""d"" WHERE ""FLAG""='Y' GROUP BY ""customer_id"" HAVING COUNT(""FLAG"")='2')"
279,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""name"",SUM(CASE WHEN LEFT(""b"".""order_date"", 7)='2020-06' THEN ""c"".""price""*""b"".""quantity"" ELSE 0 END) AS ""June_spend"",SUM(CASE WHEN LEFT(""b"".""order_date"", 7)='2020-07' THEN ""c"".""price""*""b"".""quantity"" ELSE 0 END) AS ""July_spend"" FROM (""Customers"" AS ""a"" JOIN ""Orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") JOIN ""Product"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY ""a"".""customer_id"") SELECT ""customer_id"",""name"" FROM ""cte"" WHERE ""June_spend"">=100 AND ""July_spend"">=100"
280,"SELECT ""c"".""customer_id"",""name"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""quantity""*""price"") AS ""spend"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2 HAVING (""month""=6 AND ""spend"">=100) OR (""month""=7 AND ""spend"">=100)) AS ""a"" JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY 1 HAVING COUNT(""month"")=2"
281,"SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""quantity""*""price"" ELSE 0 END)>=100"
282,"SELECT ""a"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""b"".""price""*""a"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""b"".""price""*""a"".""quantity"" ELSE 0 END)>=100"
283,"SELECT ""O"".""customer_id"" AS ""CUSTOMER_ID"",""C"".""name"" AS ""NAME"" FROM (""Orders"" AS ""O"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"") LEFT JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""O"".""customer_id"" WHERE EXTRACT(MONTH FROM ""O"".""order_date"")=6 AND EXTRACT(YEAR FROM ""O"".""order_date"")=2020 AND ""O"".""customer_id"" IN (SELECT ""O"".""customer_id"" FROM ""Orders"" AS ""O"" LEFT JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" WHERE EXTRACT(MONTH FROM ""O"".""order_date"")=7 AND EXTRACT(YEAR FROM ""O"".""order_date"")=2020 GROUP BY ""O"".""customer_id"" HAVING SUM(""O"".""quantity""*""P"".""price"")>=100) GROUP BY ""O"".""customer_id"" HAVING SUM(""O"".""quantity""*""P"".""price"")>=100"
284,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""product_id"",""a"".""month"",SUM(""a"".""quantity""*""b"".""price"") AS ""total"" FROM (SELECT ""customer_id"",""product_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",""quantity"" FROM ""orders"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=6) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""orders"" WHERE EXTRACT(MONTH FROM ""order_date"")=7)) AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"",""a"".""month"") SELECT DISTINCT ""c"".""customer_id"",""d"".""name"" FROM ""cte"" AS ""c"" LEFT JOIN ""customers"" AS ""d"" ON ""c"".""customer_id""=""d"".""customer_id"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""month""=6 AND ""total"">=100) AND ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" WHERE ""month""=7 AND ""total"">=100)"
285,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""name"",EXTRACT(MONTH FROM ""b"".""order_date"") AS ""order_month"",SUM(""b"".""quantity""*""c"".""price"") AS ""spent"" FROM (""customers"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""product"" AS ""c"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY ""a"".""customer_id"",""a"".""name"",""order_month""), ""cte2"" AS ((SELECT ""customer_id"",""name"",""order_month"",""spent"" FROM ""cte"" WHERE ""order_month""=6 AND ""spent"">=100) UNION ALL (SELECT ""customer_id"",""name"",""order_month"",""spent"" FROM ""cte"" WHERE ""order_month""=7 AND ""spent"">=100)) SELECT ""customer_id"",""name"" FROM ""cte2"" GROUP BY ""customer_id"",""name"" HAVING COUNT(""name"")>1"
286,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""sales"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m')) SELECT ""CUSTOMER_ID"",""NAME"" FROM ""T"" WHERE ""sales"">=100 GROUP BY ""customer_id"" HAVING COUNT(1)=2"
287,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"") JOIN (SELECT ""o"".""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity"" ELSE 0 END*""p"".""price"") AS ""jun_cost"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity"" ELSE 0 END*""p"".""price"") AS ""jul_cost"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"") AS ""b"" WHERE ""b"".""jun_cost"">=100 AND ""b"".""jul_cost"">=100 AND ""c"".""customer_id""=""b"".""customer_id"""
288,"WITH ""tbl1"" AS (SELECT ""Customers"".""customer_id"" AS ""cust"",""Customers"".""name"",SUM(""Orders"".""quantity""*""Product"".""price"") AS ""amount"",EXTRACT(MONTH FROM ""Orders"".""order_date"") AS ""mnth"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""Customers"".""customer_id"",EXTRACT(MONTH FROM ""Orders"".""order_date"")), ""jun_tab"" AS (SELECT * FROM ""tbl1"" WHERE ""mnth""=6 AND ""amount"">=100), ""jul_tab"" AS (SELECT * FROM ""tbl1"" WHERE ""mnth""=7 AND ""amount"">=100) SELECT ""jun_tab"".""cust"" AS ""customer_id"",""jun_tab"".""name"" FROM ""jun_tab"" JOIN ""jul_tab"" USING (""cust"")"
289,"WITH ""cte"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""O"".""order_date"") AS ""month_num"",SUM(""O"".""quantity""*""P"".""price"") AS ""spent"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""p"".""product_id"" GROUP BY 1,2 HAVING ""month_num"" IN (6,7)) SELECT ""C"".""customer_id"",""C"".""name"" FROM ""Customers"" AS ""C"" JOIN ""cte"" AS ""ct"" USING (""customer_id"") GROUP BY 1,2 HAVING SUM(CASE WHEN ""ct"".""spent"">=100 THEN 1 ELSE 0 END)=2"
290,"WITH ""t1"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",EXTRACT(YEAR FROM ""order_date"") AS ""year"",SUM(""quantity""*""p"".""price"") AS ""total"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY 1,2,3) SELECT ""t2"".""customer_id"",""c"".""name"" FROM (SELECT ""customer_id"" FROM ""t1"" WHERE ""total"">=100 GROUP BY ""customer_id"" HAVING COUNT(1)=2) AS ""t2"" LEFT JOIN ""customers"" AS ""c"" ON ""t2"".""customer_id""=""c"".""customer_id"""
291,"WITH ""totals_per_customer"" AS (SELECT ""C"".""customer_id"",""C"".""name"",TO_CHAR(""order_date"", 'YYYY%m') AS ""month"",SUM(""quantity""*""price"") AS ""total_spent"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE ""order_date"">='2020-06-01' AND ""order_date""<='2020-07-31' GROUP BY 1,2,3 HAVING ""total_spent"">=100) SELECT ""customer_id"",""name"" FROM ""totals_per_customer"" GROUP BY 1,2 HAVING COUNT(1)>=2"
292,"WITH ""res"" AS (SELECT ""customer_id"",SUBSTR(""o"".""order_date"", 1, 7) AS ""order_month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE SUBSTR(""o"".""order_date"", 1, 7) IN ('2020-06','2020-07') GROUP BY 1,2) SELECT ""r"".""customer_id"",""c"".""name"" FROM ""res"" AS ""r"" JOIN ""customers"" AS ""c"" ON ""r"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN ""r"".""order_month""='2020-06' AND ""r"".""total_price"">=100 THEN 1 ELSE 0 END)=1 AND SUM(CASE WHEN ""r"".""order_month""='2020-07' AND ""r"".""total_price"">=100 THEN 1 ELSE 0 END)=1"
293,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (SELECT ""o"".""customer_id"",SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""s1"",SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""s2"" FROM ""Product"" AS ""p"" JOIN ""Orders"" AS ""o"" USING (""product_id"") GROUP BY 1) AS ""temp"" JOIN ""Customers"" AS ""c"" USING (""customer_id"") WHERE ""s1"">=100 AND ""s2"">=100"
294,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
295,"SELECT DISTINCT ""l"".""customer_id"",""l"".""name"" FROM (SELECT ""z"".""customer_id"",""z"".""name"",COUNT(1) OVER (PARTITION BY ""name"") AS ""cnt"" FROM (SELECT ""f"".""customer_id"",""f"".""name"",""month"",SUM(""total_cost"") AS ""m_total_cost"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",""price""*""quantity"" AS ""total_cost"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM (""customers"" AS ""c"" LEFT JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31') AS ""f"" GROUP BY 1,2,3 HAVING ""m_total_cost"">=100) AS ""z"") AS ""l"" WHERE ""cnt""=2"
296,"SELECT ""customer_id"" AS ""CUSTOMER_ID"",""name"" AS ""NAME"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(1) AS ""MNTHCNT"" FROM (SELECT ""A"".""customer_id"",EXTRACT(MONTH FROM ""A"".""order_date"") AS ""MNTH"",SUM(""A"".""quantity""*""B"".""price"") AS ""SPENT"" FROM (SELECT * FROM ""Orders"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7)) AS ""A"" JOIN ""Product"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"" GROUP BY ""A"".""customer_id"",EXTRACT(MONTH FROM ""A"".""order_date"")) AS ""C"" WHERE ""SPENT"">=100 GROUP BY ""customer_id"") AS ""D"" WHERE ""MNTHCNT""=2)"
297,"SELECT ""b"".""customer_id"",""name"" FROM (SELECT ""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""ct"" ELSE NULL END) AS ""june"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""ct"" ELSE NULL END) AS ""july"" FROM (SELECT ""order_id"",""customer_id"",""orders"".""product_id"",""order_date"",""quantity""*""price"" AS ""ct"" FROM ""orders"" LEFT JOIN ""product"" ON ""orders"".""product_id""=""product"".""product_id"") AS ""a"" GROUP BY ""customer_id"") AS ""b"", ""customers"" WHERE ""b"".""customer_id""=""customers"".""customer_id"" AND ""june"">=100 AND ""july"">=100"
298,"SELECT ""customer_id"",""name"" FROM (""customers"" AS ""c"" JOIN ""orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
299,"WITH ""T1"" AS (SELECT ""A"".""CUSTOMER_ID"" AS ""CUSTOMER_ID"",""C"".""NAME"" AS ""NAME"",SUM(""B"".""PRICE""*""A"".""QUANTITY"") AS ""AMT_TOT"",EXTRACT(YEAR FROM ""A"".""ORDER_DATE"")*100+EXTRACT(MONTH FROM ""A"".""ORDER_DATE"") AS ""YM"" FROM ((SELECT * FROM ""ORDERS"" WHERE EXTRACT(MONTH FROM ""ORDER_DATE"") IN (6,7)) AS ""A"" LEFT JOIN ""PRODUCT"" AS ""B"" ON ""A"".""PRODUCT_ID""=""B"".""PRODUCT_ID"") LEFT JOIN ""CUSTOMERS"" AS ""C"" ON ""A"".""CUSTOMER_ID""=""C"".""CUSTOMER_ID"" GROUP BY ""CUSTOMER_ID"",""YM""), ""T2"" AS (SELECT ""CUSTOMER_ID"",""NAME"",SUM(CASE WHEN ""AMT_TOT"">=100 THEN 1 ELSE 0 END) AS ""CNT"" FROM ""T1"" GROUP BY ""CUSTOMER_ID"",""NAME"") SELECT ""CUSTOMER_ID"",""NAME"" FROM ""T2"" WHERE ""CNT""=2"
300,"SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""month"",""o"".""product_id"",""quantity"",""price"",SUM(""quantity""*""price"") AS ""total_price"" FROM ""orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY 1,2 HAVING (""total_price"">=100)) AS ""temp1"" LEFT JOIN ""customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING (COUNT(""month"")=2)"
301,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(YEAR FROM ""o"".""order_date"") AS ""orderyear"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""ordermonth"",SUM(""o"".""quantity""*""p"".""price"") AS ""totalprice"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""o"".""order_date"")=2020 GROUP BY ""c"".""customer_id"",""c"".""name"",EXTRACT(YEAR FROM ""o"".""order_date""),EXTRACT(MONTH FROM ""o"".""order_date"")) SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",SUM(CASE WHEN ""totalprice"">=100 THEN 1 ELSE 0 END) AS ""times"" FROM ""cte"" GROUP BY ""customer_id"",""name"") AS ""a"" WHERE ""times"">1"
302,"SELECT ""customer_id"",""name"" FROM (SELECT ""Customers"".""customer_id"",""Customers"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""price""*""quantity"") AS ""asum"" FROM (""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") LEFT JOIN ""Customers"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING (SUM(""price""*""quantity"")>=100)) AS ""e"" GROUP BY ""customer_id"" HAVING COUNT(1)>=2"
303,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)>1"
304,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""price"" END) AS ""June"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_Date"")=7 THEN ""o"".""quantity""*""price"" END) AS ""July"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" USING (""product_id"") GROUP BY 1 ORDER BY 1) SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN ""cte"" AS ""b"" ON ""c"".""customer_id""=""b"".""customer_id"" AND ""b"".""June"">=100 AND ""b"".""July"">=100 ORDER BY 1"
305,"WITH ""june"" AS (SELECT DISTINCT * FROM ""Orders"" WHERE ""order_date"">='2020-06-01' AND ""order_date""<='2020-06-30'), ""july"" AS (SELECT DISTINCT * FROM ""Orders"" WHERE ""order_date"">='2020-07-01' AND ""order_date""<='2020-07-31'), ""june_price"" AS (SELECT ""customer_id"",SUM(""price""*""quantity"") AS ""price"" FROM ""june"" LEFT JOIN ""Product"" ON ""Product"".""product_id""=""june"".""product_id"" GROUP BY ""customer_id""), ""july_price"" AS (SELECT ""customer_id"",SUM(""price""*""quantity"") AS ""price"" FROM ""july"" LEFT JOIN ""Product"" ON ""Product"".""product_id""=""july"".""product_id"" GROUP BY ""customer_id"") SELECT ""june_price"".""customer_id"",""name"" FROM (""june_price"" JOIN ""july_price"" ON ""june_price"".""customer_id""=""july_price"".""customer_id"") JOIN ""Customers"" ON ""june_price"".""customer_id""=""Customers"".""customer_id"" WHERE ""june_price"".""price"">=100 AND ""july_price"".""price"">=100"
306,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t1"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t2"" FROM (""Product"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"") AS ""a"" WHERE ""t1"">=100 AND ""t2"">=100"
307,"WITH ""cte"" AS (SELECT ""a"".""customer_id"",""a"".""order_date"",""b"".""name"",""quantity""*""price"" AS ""cost"" FROM (""Orders"" AS ""a"" LEFT JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"") LEFT JOIN ""Product"" AS ""c"" ON ""a"".""product_id""=""c"".""product_id"") SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",MAX(""name"") AS ""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 AND EXTRACT(YEAR FROM ""order_date"")=2020 THEN ""cost"" ELSE 0 END) AS ""cost_Jun_2020"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")=2020 THEN ""cost"" ELSE 0 END) AS ""cost_Jul_2020"" FROM ""cte"" GROUP BY ""customer_id"") AS ""d"" WHERE ""cost_Jun_2020"">=100 AND ""cost_Jul_2020"">=100"
308,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",""c"".""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" END)>=100"
309,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""o_month"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""customer_id"",""name"" FROM ""t"" GROUP BY ""customer_id"",""name"" HAVING COUNT(DISTINCT ""o_month"")=2"
310,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""name"",SUM(""quantity""*""price"") AS ""total"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"",""month"" HAVING ""month"" IN ('2020-07','2020-06') AND ""total"">=100) AS ""temp"" GROUP BY ""customer_id"" HAVING COUNT(1)>=2"
311,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""a"".""order_date"") AS ""month"",SUM(""a"".""quantity""*""b"".""price"") AS ""total_sum"" FROM (""orders"" AS ""a"" LEFT JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY ""name"",""month""), ""jun"" AS (SELECT ""customer_id"",""name"",""month"",""total_sum"" FROM ""cte"" WHERE ""month""=6 AND ""total_sum"">=100), ""jul"" AS (SELECT ""customer_id"",""name"",""month"",""total_sum"" FROM ""cte"" WHERE ""month""=7 AND ""total_sum"">=100) SELECT ""a"".""customer_id"",""a"".""name"" FROM ""jun"" AS ""a"" JOIN ""jul"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"""
312,"WITH ""june"" AS (SELECT ""customer_id"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""Order_date"")=6 GROUP BY ""customer_id"" HAVING SUM(""O"".""quantity""*""P"".""price"")>=100), ""july"" AS (SELECT ""customer_id"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""Order_date"")=7 GROUP BY ""customer_id"" HAVING SUM(""O"".""quantity""*""P"".""price"")>=100) SELECT ""C"".""customer_id"",""C"".""name"" FROM (""Customers"" AS ""C"" JOIN ""june"" ON ""C"".""customer_id""=""june"".""customer_id"") JOIN ""july"" ON ""june"".""customer_id""=""july"".""customer_id"" ORDER BY ""customer_id"""
313,"WITH ""groupby_and_add_2_month_columns"" AS (SELECT SUM(CASE WHEN TO_CHAR(""Orders"".""order_date"", 'YYYY-%m')='2020-06' THEN ""quantity"" ELSE 0 END*""Product"".""price"") AS ""June_spent"",SUM(CASE WHEN TO_CHAR(""Orders"".""order_date"", 'YYYY-%m')='2020-07' THEN ""quantity"" ELSE 0 END*""Product"".""price"") AS ""July_spent"",""Customers"".""customer_id"",""Customers"".""name"" FROM (""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" GROUP BY ""customer_id"") SELECT ""customer_id"",""name"" FROM ""groupby_and_add_2_month_columns"" WHERE ""June_spent"">=100 AND ""July_spent"">=100"
314,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-06' THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-07' THEN ""quantity""*""price"" END)>=100"
315,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='06' THEN ""quantity""*""p"".""price"" END) AS ""m6"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='07' THEN ""quantity""*""p"".""price"" END) AS ""m7"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON (""o"".""product_id""=""p"".""product_id"") GROUP BY ""customer_id"" HAVING ""m6"">=100 AND ""m7"">=100) AS ""x"" ON (""c"".""customer_id""=""x"".""customer_id"")"
316,"SELECT ""cs"".""customer_id"",""cs"".""name"" FROM (""Customers"" AS ""cs"" JOIN ""Orders"" AS ""ord"" USING (""customer_id"")) JOIN ""Product"" AS ""pr"" USING (""product_id"") GROUP BY ""cs"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
317,"SELECT ""temp"".""customer_id"",""temp"".""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""customer_id"",""month"" HAVING ""month""=6 OR ""month""=7) AS ""temp"" WHERE ""temp"".""total"">=100 GROUP BY ""temp"".""name"" HAVING COUNT(1)=2"
318,"WITH ""tb1"" AS (SELECT ""order_id"",""customer_id"",""O"".""product_id"",""order_date"",""quantity"",""price"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id""), ""tb2"" AS (SELECT SUM(""price""*""quantity"") AS ""totalPrice"",EXTRACT(MONTH FROM ""order_date"") AS ""month1"",""customer_id"" FROM ""tb1"" WHERE EXTRACT(MONTH FROM ""order_date"")=7 OR EXTRACT(MONTH FROM ""order_date"")=6 GROUP BY ""month1"",""customer_id"" HAVING ""totalPrice"">=100), ""tb3"" AS (SELECT ""customer_id"" FROM ""tb2"" GROUP BY ""customer_id"" HAVING COUNT(DISTINCT ""month1"")>1) SELECT ""tb3"".""customer_id"",""name"" FROM ""tb3"" JOIN ""Customers"" ON ""tb3"".""customer_id""=""Customers"".""customer_id"""
319,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
320,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" WHERE ""c"".""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""o"".""customer_id"",SUBSTRING(""order_date"", 1, 7) AS ""month"" FROM ""product"" AS ""p"" RIGHT JOIN ""orders"" AS ""o"" USING (""product_id"") WHERE SUBSTRING(""order_date"", 1, 7)='2020-06' OR SUBSTRING(""order_date"", 1, 7)='2020-07' GROUP BY ""o"".""customer_id"",SUBSTRING(""order_date"", 1, 7) HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""cm"" GROUP BY ""customer_id"" HAVING COUNT(1)=2)"
321,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
322,"SELECT ""f"".""customer_id"",""c"".""name"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""m"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY 1,2 HAVING SUM(""quantity""*""price"")>=100) AS ""f"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""f"".""customer_id"" GROUP BY 1 HAVING COUNT(1)=2"
323,"WITH ""tmp"" AS (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", '%M YYYY') AS ""year_month_dt"",""p"".""price""*""o"".""quantity"" AS ""order_amount"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">=DATE('2020-06-01') AND ""o"".""order_date""<=DATE('2020-07-31')) SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",""year_month_dt"",SUM(""order_amount"") AS ""month_amount"" FROM ""tmp"" GROUP BY ""customer_id"",""year_month_dt"") AS ""tmp2"" WHERE ""month_amount"">=100 GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>=2"
324,"WITH ""r"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_sum"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total_sum"">=100 AND ""month"" IN (6,7)) SELECT ""customer_id"",""name"" FROM ""r"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>=2"
325,"WITH ""temp"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""cost"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" LIKE '2020-06%' OR ""o"".""order_date"" LIKE '2020-07%' GROUP BY ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"")) SELECT ""customer_id"",""name"" FROM ""temp"" GROUP BY ""customer_id"",""name"" HAVING SUM(CASE WHEN ""cost"">=100 THEN 1 ELSE 0 END)=2"
326,"WITH ""frequency"" AS (SELECT ""customer_id"",""name"",SUM(""quantity""*""price"") AS ""total"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""customer_id"",""name"",""month"") SELECT ""customer_id"",""name"" FROM ""frequency"" WHERE (""month""=6 OR ""month""=7) AND ""total"">=100 GROUP BY ""customer_id"",""name"" HAVING COUNT(""name"")=2"
327,"WITH ""cte1"" AS (SELECT ""c"".""customer_id"",""c"".""name"",""price"",""quantity"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""r"" ON ""c"".""customer_id""=""r"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""r"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31') SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",""name"",""month"",SUM(""price""*""quantity"") AS ""spent_month"" FROM ""cte1"" GROUP BY ""customer_id"",""name"",""month"" HAVING SUM(""price""*""quantity"")>=100) AS ""t"" GROUP BY 1,2 HAVING COUNT(""month"")=2"
328,"SELECT ""T"".""customer_id"",""name"" FROM (SELECT ""O"".""customer_id"",SUM(""O"".""quantity""*""P"".""price"") AS ""Amt_spent"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(MONTH FROM ""O"".""order_date"") IN (6,7) GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""O"".""order_date"") HAVING SUM(""O"".""quantity""*""P"".""price"")>=100) AS ""t"" JOIN ""Customers"" AS ""C"" ON ""T"".""customer_id""=""C"".""customer_id"" GROUP BY ""T"".""customer_id"" HAVING COUNT(1)=2"
329,"WITH ""t"" AS (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""sales"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m')) SELECT ""customer_id"",""name"" FROM ""t"" GROUP BY ""customer_id"",""name"" HAVING SUM(""sales"">=100)=2"
330,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" END)>=100"
331,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
332,"WITH ""r"" AS (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"") BETWEEN 6 AND 7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total_price"">=100 AND ""month"" IN (6,7)) SELECT ""customer_id"",""name"" FROM ""r"" GROUP BY ""customer_id"" HAVING COUNT(1)=2"
333,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""a"".""customer_id"" FROM ""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""a"".""customer_id"" HAVING SUM(""a"".""quantity""*""b"".""price"")>=100) AND ""customer_id"" IN (SELECT ""a"".""customer_id"" FROM ""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE ""a"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""a"".""customer_id"" HAVING SUM(""a"".""quantity""*""b"".""price"")>=100)"
334,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE (EXTRACT(MONTH FROM ""o"".""order_date"") BETWEEN 6 AND 7) AND (EXTRACT(YEAR FROM ""o"".""order_date"")=2020) GROUP BY ""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""t"" GROUP BY ""customer_id"" HAVING COUNT(1)=2"
335,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" END) AS ""June"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" END) AS ""July"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1 ORDER BY 1) SELECT ""cte"".""customer_id"",""c"".""name"" FROM ""cte"" JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" AND ""cte"".""June"">=100 AND ""cte"".""July"">=100 ORDER BY 1"
336,"SELECT ""o"".""customer_id"",""name"" FROM ((""orders"" AS ""o"") JOIN ""product"" AS ""p"") JOIN ""customers"" AS ""c"" WHERE ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
337,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
338,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",""o"".""order_date"",SUM(""o"".""quantity""*""p"".""price"") AS ""total"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total"">=100 AND (EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7)) AS ""newtable"" ON ""c"".""customer_id""=""newtable"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(""c"".""customer_id"")>1"
339,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
340,"SELECT DISTINCT ""e"".""customer_id"",""e"".""name"" FROM ""Customers"" AS ""e"" LEFT JOIN (SELECT ""customer_id"",SUM(""sales"") AS ""total_purchase"",SUM(CASE WHEN ""ind_june""=1 THEN ""sales"" ELSE 0 END) AS ""total_purchase_june"",SUM(CASE WHEN ""ind_july""=1 THEN ""sales"" ELSE 0 END) AS ""total_purchase_july"" FROM (SELECT ""a"".""customer_id"",""a"".""quantity""*""b"".""price"" AS ""sales"",CASE WHEN EXTRACT(MONTH FROM ""a"".""order_date"") IN (6) AND EXTRACT(YEAR FROM ""a"".""order_date"")=2020 THEN 1 ELSE 0 END AS ""ind_june"",CASE WHEN EXTRACT(MONTH FROM ""a"".""order_date"") IN (7) AND EXTRACT(YEAR FROM ""a"".""order_date"")=2020 THEN 1 ELSE 0 END AS ""ind_july"" FROM ""Orders"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") AS ""c"" GROUP BY 1) AS ""d"" ON ""e"".""customer_id""=""d"".""customer_id"" WHERE ""d"".""total_purchase_june"">=100 AND ""d"".""total_purchase_july"">=100"
341,"SELECT ""customer_id"",""name"" FROM (SELECT ""Customers"".""customer_id"",""name"",SUM(""quantity""*""price""),EXTRACT(MONTH FROM ""Orders"".""order_date"") FROM (""Customers"" JOIN ""Product"") JOIN ""Orders"" ON ""Customers"".""customer_id""=""Orders"".""customer_id"" AND ""Product"".""product_id""=""Orders"".""product_id"" WHERE EXTRACT(MONTH FROM ""Orders"".""order_date"")=6 OR EXTRACT(MONTH FROM ""Orders"".""order_date"")=7 GROUP BY (""Customers"".""customer_id""),EXTRACT(MONTH FROM ""Orders"".""order_date"") HAVING (SUM((""quantity""*""price""))>=100)) AS ""t1"" GROUP BY ""name"" HAVING COUNT(1)=2"
342,"WITH ""tmp"" AS (SELECT ""customer_id"",TO_CHAR(""a"".""order_date"", 'YYYY-%m') AS ""order_date"",SUM(""a"".""quantity""*""b"".""price"") AS ""sales"" FROM ""orders"" AS ""a"" JOIN ""product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" GROUP BY 1,2 HAVING SUM(""a"".""quantity""*""b"".""price"")>=100) SELECT DISTINCT ""a"".""customer_id"",""b"".""name"" FROM ""tmp"" AS ""a"" JOIN ""customers"" AS ""b"" ON ""a"".""customer_id""=""b"".""customer_id"" WHERE ""a"".""order_date"" IN ('2020-06','2020-07') GROUP BY ""a"".""customer_id"" HAVING COUNT(DISTINCT ""a"".""order_date"")=2"
343,"SELECT ""B"".""customer_id"",""B"".""name"" FROM (SELECT ""A"".""customer_id"",""A"".""name"",""A"".""mth"",SUM(""A"".""price"") FROM (SELECT ""C"".""customer_id"",""C"".""name"",(CASE WHEN EXTRACT(MONTH FROM ""O"".""order_date"")-10<0 THEN CONCAT(EXTRACT(YEAR FROM ""O"".""order_date""), '-0', EXTRACT(MONTH FROM ""O"".""order_date"")) ELSE CONCAT(EXTRACT(YEAR FROM ""O"".""order_date""), '-', EXTRACT(MONTH FROM ""O"".""order_date"")) END) AS ""mth"",""P"".""price""*""O"".""quantity"" AS ""price"" FROM (""Orders"" AS ""O"" LEFT JOIN ""Customers"" AS ""C"" ON ""O"".""customer_id""=""C"".""customer_id"") LEFT JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE (EXTRACT(MONTH FROM ""O"".""order_date"")=6 OR EXTRACT(MONTH FROM ""O"".""order_date"")=7) AND (EXTRACT(YEAR FROM ""O"".""order_date""))=2020) AS ""A"" GROUP BY ""A"".""customer_id"",""A"".""name"",""A"".""mth"" HAVING SUM(""A"".""price"")>=100) AS ""B"" GROUP BY ""B"".""customer_id"",""B"".""name"" HAVING COUNT(""B"".""name"")=2"
344,"WITH ""temp"" AS (SELECT ""o"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") AS ""mnt"",SUM(""price""*""quantity"") AS ""tot"" FROM (""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""price""*""quantity"")>=100 AND ""mnt"" IN (6,7)) SELECT ""customer_id"",""name"" FROM ""temp"" GROUP BY ""customer_id"",""name"" HAVING ROUND(AVG(""mnt""), 2)>6 AND ROUND(AVG(""mnt""), 2)<7"
345,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""p"".""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""p"".""price"")>=100"
346,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
347,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t1"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t2"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1) AS ""tmp_table"" WHERE ""t1"">=100 AND ""t2"">=100"
348,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
349,"WITH ""cte1"" AS (SELECT ""customer_id"",""order_date"",EXTRACT(MONTH FROM ""order_date"") AS ""mon"",EXTRACT(YEAR FROM ""order_date""),""price""*""quantity"" AS ""rev"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE (EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7) AND EXTRACT(YEAR FROM ""order_date"")=2020), ""cte2"" AS (SELECT ""customer_id"",""mon"",SUM(""rev""),CASE WHEN SUM(""rev"")>=100 THEN 1 ELSE 0 END AS ""yes"" FROM ""cte1"" GROUP BY 1,2), ""cte3"" AS (SELECT ""customer_id"" FROM ""cte2"" GROUP BY ""customer_id"" HAVING SUM(""yes"")=2) SELECT ""customer_id"",""name"" FROM ""cte3"" JOIN ""Customers"" USING (""customer_id"")"
350,"SELECT ""c"".""customer_id"",""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",LEFT(""o"".""order_date"", 7) AS ""date"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE (LEFT(""o"".""order_date"", 7))='2020-06' OR LEFT(""o"".""order_date"", 7)='2020-07' GROUP BY ""o"".""customer_id"",LEFT(""o"".""order_date"", 7) HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""tem"" ON ""c"".""customer_id""=""tem"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(1)=2"
351,"SELECT ""a"".""customer_id"",""a"".""name"" FROM (SELECT ""Orders"".""customer_id"",""Customers"".""name"",SUM(""Orders"".""quantity""*""Product"".""price"") AS ""cost"" FROM (""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE MONTHNAME(""Orders"".""order_date"")='June' AND EXTRACT(YEAR FROM ""Orders"".""order_date"")=2020 GROUP BY ""Orders"".""customer_id"",""Customers"".""name"" HAVING (""cost"">=100) UNION SELECT ""Orders"".""customer_id"",""Customers"".""name"",SUM(""Orders"".""quantity""*""Product"".""price"") AS ""cost"" FROM (""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE MONTHNAME(""Orders"".""order_date"")='July' AND EXTRACT(YEAR FROM ""Orders"".""order_date"")=2020 GROUP BY ""Orders"".""customer_id"",""Customers"".""name"" HAVING (""cost"">=100)) AS ""a"" GROUP BY ""a"".""customer_id"",""a"".""name"" HAVING COUNT(""a"".""customer_id"")>1"
352,"WITH ""r"" AS (SELECT ""c"".""customer_id"",""c"".""name"",""p"".""price"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_sum"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total_sum"">=100 AND ""month"" IN (6,7)) SELECT ""customer_id"",""name"" FROM ""r"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>=2"
353,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",LEFT(""order_date"", 7),SUM(""quantity""*""price"") AS ""total_amount"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7) IN ('2020-06','2020-07') GROUP BY ""c"".""customer_id"",""c"".""name"",LEFT(""order_date"", 7) HAVING SUM(""quantity""*""price"")>=100) AS ""A"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>1"
354,"WITH ""tmp"" AS (SELECT EXTRACT(MONTH FROM ""order_date"") AS ""month"",""customer_id"",SUM(""quantity""*""price"") AS ""spending"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" AND ""o"".""order_date"">='2020-06-01' AND ""o"".""order_date""<'2020-08-01' GROUP BY ""month"",""customer_id"" HAVING ""spending"">=100) SELECT ""tmp"".""customer_id"",""name"" FROM ""tmp"" JOIN ""customers"" AS ""c"" ON ""tmp"".""customer_id""=""c"".""customer_id"" GROUP BY ""tmp"".""customer_id"",""name"" HAVING COUNT(1)=2"
355,"WITH ""temp"" AS (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""month"",SUM(""quantity""*""price"") AS ""spent"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY 1,2 HAVING SUM(""quantity""*""price"")>=100) SELECT ""c"".""customer_id"",""name"" FROM ""customers"" AS ""c"" JOIN ""temp"" AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" GROUP BY 1,2 HAVING COUNT(""c"".""customer_id"")=2"
356,"SELECT ""summary"".""customer_id"",""summary"".""name"" FROM (SELECT ""Orders_month"".""customer_id"",""c"".""name"",""Orders_month"".""month"",SUM(""Orders_month"".""quantity""*""p"".""price"") AS ""total"" FROM ((SELECT ""order_id"",""customer_id"",""product_id"",""order_date"",""quantity"",(CASE WHEN ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN 'June' WHEN ""order_date"" BETWEEN '2020-07-01' AND '2020-07-30' THEN 'July' ELSE 'other_month' END) AS ""month"" FROM ""Orders"") AS ""Orders_month"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""Orders_month"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""Orders_month"".""product_id"" WHERE ""Orders_month"".""month""='June' OR ""Orders_month"".""month""='July' GROUP BY ""Orders_month"".""customer_id"",""c"".""name"",""Orders_month"".""month"" HAVING SUM(""Orders_month"".""quantity""*""p"".""price"")>=100 ORDER BY ""Orders_month"".""customer_id"",""c"".""name"",""Orders_month"".""month"" DESC) AS ""summary"" GROUP BY ""summary"".""customer_id"",""summary"".""name"" HAVING COUNT(DISTINCT ""summary"".""month"")=2"
357,"WITH ""ord_quant"" AS (SELECT ""o"".""customer_id"",SUBSTRING(""o"".""order_date"", 1, 7) AS ""st"",SUM(""p"".""price""*""o"".""quantity"") AS ""tot"" FROM ""Orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">='2020-06-01' AND ""o"".""order_date""<='2020-07-31' GROUP BY 1,2 HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""o"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN ""ord_quant"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1,2 HAVING COUNT(""st"")=2"
358,"WITH ""c"" AS (SELECT ""customer_id"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""mon"",""o"".""quantity""*""p"".""price"" AS ""tot"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7)) AS ""a"" GROUP BY ""customer_id"",""mon"" HAVING SUM(""tot"")>=100) SELECT ""c"".""customer_id"",""c1"".""name"" FROM ""c"" JOIN ""customers"" AS ""c1"" ON ""c"".""customer_id""=""c1"".""customer_id"" GROUP BY ""customer_id"" HAVING COUNT(1)=2"
359,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",LEFT(""order_date"", 7) AS ""order_month"",SUM(""p"".""price""*""o"".""quantity"") AS ""TotalCost"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE ""order_date"" LIKE '%2020-06-%' OR ""order_date"" LIKE '%2020-07-%' GROUP BY ""name"",""order_month"" HAVING ""TotalCost"">=100) AS ""T"" GROUP BY ""name"" HAVING COUNT(""name"")=2"
360,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""month"" HAVING ""month""=6 OR ""month""=7) AS ""temp"", ""Customers"" AS ""c"" WHERE ""c"".""customer_id""=""temp"".""customer_id"" AND ""temp"".""total"">=100 GROUP BY ""c"".""name"" HAVING COUNT(1)=2"
361,"SELECT DISTINCT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""price""*""quantity"" ELSE NULL END) AS ""junespend"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""price""*""quantity"" ELSE NULL END) AS ""julyspend"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1,2) AS ""a"" WHERE ""junespend"">=100 AND ""julyspend"">=100"
362,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END)>=100 AND SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END)>=100"
363,"WITH ""cte_o"" AS (SELECT * FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"") IN (6,7)), ""cte_table"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""quantity""*""price"") AS ""total"" FROM ""cte_o"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING ""total"">=100) SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" LEFT JOIN ""cte_table"" AS ""cte"" ON ""c"".""customer_id""=""cte"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(""c"".""customer_id"")=2"
364,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
365,"SELECT ""customer_id"",""name"" FROM (SELECT TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""month"",""o"".""customer_id"",""c"".""name"" AS ""name"",SUM(""o"".""quantity""*""p"".""price"") AS ""spent"" FROM ((""orders"" AS ""o"") JOIN ""customers"" AS ""c"") JOIN ""product"" AS ""p"" WHERE ""o"".""customer_id""=""c"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" AND TO_CHAR(""o"".""order_date"", 'YYYY')=2020 AND (TO_CHAR(""o"".""order_date"", '%m')=6 OR TO_CHAR(""o"".""order_date"", '%m')=7) GROUP BY TO_CHAR(""o"".""order_date"", 'YYYY-%m'),""o"".""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""a"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>1"
366,"SELECT ""o"".""customer_id"",""c"".""name"" FROM ((""Customers"" AS ""c"") JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING (SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-06%' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""o"".""order_date"" LIKE '2020-07%' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100)"
367,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
368,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
369,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
370,"SELECT ""c"".""customer_id"" AS ""customer_id"",""c"".""name"" AS ""name"" FROM (SELECT ""o"".""customer_id"" AS ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""order_month"",EXTRACT(YEAR FROM ""order_date"") AS ""order_year"",CASE WHEN SUM(""o"".""quantity""*""p"".""price"")>=100 THEN 1 ELSE 0 END AS ""is_spent"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) AND EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""customer_id"",""order_month"",""order_year"") AS ""a"" JOIN ""customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY ""customer_id"",""name"" HAVING SUM(""is_spent"")>1"
371,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""customers"" AS ""c"" JOIN ""product"" AS ""p"") JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""quantity""*""price"" ELSE 0 END)>=100"
372,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
373,"SELECT ""c"".""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""o"".""quantity""*""p"".""price"") AS ""spend"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",""month"" HAVING (""month""=6 AND ""spend"">=100) OR (""month""=7 AND ""spend"">=100)) AS ""inner_table"" JOIN ""customers"" AS ""c"" ON ""inner_table"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(""month"")=2"
374,"SELECT DISTINCT (""customer_id""),""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""price""*""quantity"" ELSE 0 END)>=100"
375,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity""*""price"" ELSE 0 END)>=100"
376,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" END)>=100"
377,"SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
378,"WITH ""june_customers"" AS (SELECT ""customers"".""customer_id"" FROM (""orders"" JOIN ""customers"") JOIN ""product"" ON ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_id""=""product"".""product_id"" WHERE ""orders"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""customers"".""customer_id"" HAVING SUM(""product"".""price""*""orders"".""quantity"")>=100), ""july_customers"" AS (SELECT ""customers"".""customer_id"" FROM (""orders"" JOIN ""customers"") JOIN ""product"" ON ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_id""=""product"".""product_id"" WHERE ""orders"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""customers"".""customer_id"" HAVING SUM(""product"".""price""*""orders"".""quantity"")>=100) SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""june_customers"") AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""july_customers"")"
379,"SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"",""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 AND EXTRACT(YEAR FROM ""order_date"")=2020 THEN ""p"".""price""*""o"".""quantity"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")=2020 THEN ""p"".""price""*""o"".""quantity"" END)>=100"
380,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month_"",SUM(""o"".""quantity""*""p"".""price"") AS ""total_spend"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"",""month_"" HAVING ""total_spend"">=100) AS ""t1"" GROUP BY ""customer_id"" HAVING COUNT(1)>=2"
381,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ((""Customers"" AS ""c"") JOIN ""Product"" AS ""p"") JOIN ""Orders"" AS ""o"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100"
382,"WITH ""june_customers"" AS (SELECT ""customer_id"" FROM ""Product"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")='06' GROUP BY ""customer_id"" HAVING SUM(""quantity""*""price"")>=100), ""july_customers"" AS (SELECT ""customer_id"" FROM ""Product"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")='07' GROUP BY ""customer_id"" HAVING SUM(""quantity""*""price"")>=100) SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""june_customers"") AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""july_customers"")"
383,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (""Orders"" AS ""o"") JOIN ""Product"" AS ""p"" WHERE ""p"".""product_id""=""o"".""product_id"" AND EXTRACT(MONTH FROM ""order_date"") IN ('06') GROUP BY 1 HAVING SUM(""price""*""quantity"")>=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM (""Orders"" AS ""o"") JOIN ""Product"" AS ""p"" WHERE ""p"".""product_id""=""o"".""product_id"" AND EXTRACT(MONTH FROM ""order_date"") IN ('07') GROUP BY 1 HAVING SUM(""price""*""quantity"")>=100)"
384,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price"" ELSE 0 END*""o"".""quantity"")>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price"" ELSE 0 END*""o"".""quantity"")>=100"
385,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
386,"WITH ""temp"" AS (SELECT ""o"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""ym"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_spent"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE TO_CHAR(""o"".""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""customer_id"",""name"",""ym""), ""temp2"" AS (SELECT ""customer_id"",""name"",SUM(CASE WHEN ""total_spent"">=100 THEN 1 ELSE 0 END) AS ""cnt"" FROM ""temp"" GROUP BY ""customer_id"",""name"") SELECT ""customer_id"",""name"" FROM ""temp2"" WHERE ""cnt"">=2"
387,"SELECT ""customer_id"",""name"" FROM (SELECT SUBSTRING_INDEX(""t1"".""order_date"", '-', 2) AS ""month"",""t2"".""customer_id"",""t2"".""name"" FROM (""Orders"" AS ""t1"" JOIN ""Customers"" AS ""t2"" ON ""t1"".""customer_id""=""t2"".""customer_id"") JOIN ""Product"" AS ""t3"" ON ""t1"".""product_id""=""t3"".""product_id"" WHERE SUBSTRING_INDEX(""t1"".""order_date"", '-', 2) IN ('2020-06','2020-07') GROUP BY SUBSTRING_INDEX(""t1"".""order_date"", '-', 2),""t2"".""customer_id"",""t2"".""name"" HAVING SUM(""t3"".""price""*""t1"".""quantity"")>=100) AS ""k"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>1"
388,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""name"",EXTRACT(MONTH FROM ""order_date"") AS ""m"",SUM(""quantity""*""price"") AS ""spend"" FROM (""orders"" AS ""o"" JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING ""spend"">=100 AND (""m""=6 OR ""m""=7)) AS ""lp"" GROUP BY ""name"" HAVING COUNT(""name"")=2"
389,"SELECT ""tmp4"".""customer_id"",""C"".""name"" FROM (SELECT ""customer_id"",SUM(""spend_flag"") AS ""chk"" FROM (SELECT *,CASE WHEN ""tot_spend"">=100 THEN 1 ELSE 0 END AS ""spend_flag"" FROM (SELECT ""customer_id"",SUBSTR(""order_date"", 1, 7) AS ""month"",SUM(""spend"") AS ""tot_spend"" FROM (SELECT ""A"".*,(""A"".""quantity""*""B"".""price"") AS ""spend"" FROM (SELECT * FROM ""Orders"" WHERE SUBSTR(""order_date"", 1, 7) IN ('2020-06','2020-07')) AS ""A"" LEFT JOIN ""Product"" AS ""B"" ON ""A"".""product_id""=""B"".""product_id"") AS ""tmp"" GROUP BY ""customer_id"",SUBSTR(""order_date"", 1, 7)) AS ""tmp2"" GROUP BY ""customer_id"",""month"") AS ""tmp3"" GROUP BY ""customer_id"" HAVING ""chk"">=2) AS ""tmp4"" LEFT JOIN ""Customers"" AS ""C"" ON ""tmp4"".""customer_id""=""C"".""customer_id"""
390,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""c"".""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" ELSE NULL END) AS ""June"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" ELSE NULL END) AS ""July"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" GROUP BY ""o"".""customer_id"" ORDER BY 1) SELECT ""cte"".""customer_id"",""cte"".""name"" FROM ""cte"" WHERE ""cte"".""June"">=100 AND ""cte"".""July"">=100 ORDER BY 1,2"
391,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 AND EXTRACT(YEAR FROM ""o"".""order_date"")=2020 THEN ""o"".""quantity""*""p"".""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 AND EXTRACT(YEAR FROM ""o"".""order_date"")=2020 THEN ""o"".""quantity""*""p"".""price"" END)>=100"
392,"SELECT ""june"".""customer_id"",""june"".""name"" FROM (SELECT ""Customers"".""name"",""Customers"".""customer_id"" FROM (""Orders"" JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE ""order_date"" LIKE '2020-06%' GROUP BY ""Customers"".""name"",""Customers"".""customer_id"" HAVING SUM(""price""*""quantity"")>=100) AS ""june"" JOIN (SELECT ""Customers"".""name"",""Customers"".""customer_id"" FROM (""Orders"" JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"") JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE ""order_date"" LIKE '2020-07%' GROUP BY ""Customers"".""name"",""Customers"".""customer_id"" HAVING SUM(""price""*""quantity"")>=100) AS ""july"" ON ""june"".""name""=""july"".""name"" AND ""july"".""customer_id""=""june"".""customer_id"""
393,"SELECT ""c"".""customer_id"",""name"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN (""quantity""*""price"") END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN (""quantity""*""price"") END)>=100"
394,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END)>=100"
395,"WITH ""cte_june"" AS (SELECT ""customer_id"" FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=6 GROUP BY ""customer_id"" HAVING SUM(""quantity""*""price"")>=100), ""cte_july"" AS (SELECT ""customer_id"" FROM ""Orders"" JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"" HAVING SUM(""quantity""*""price"")>=100) SELECT ""Customers"".""customer_id"",""name"" FROM ""cte_june"" JOIN ""Customers"" ON ""Customers"".""customer_id""=""cte_june"".""customer_id"" WHERE ""cte_june"".""customer_id"" IN (SELECT ""customer_id"" FROM ""cte_july"")"
396,"WITH ""JuneInvoice"" AS (SELECT ""O"".""customer_id"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 AND EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""O"".""customer_id"" HAVING SUM(""P"".""price""*""O"".""quantity"")>=100), ""JulyInvoice"" AS (SELECT ""O"".""customer_id"" FROM ""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")=2020 GROUP BY ""O"".""customer_id"" HAVING SUM(""P"".""price""*""O"".""quantity"")>=100) SELECT ""C"".""customer_id"",""C"".""name"" FROM ""Customers"" AS ""C"" WHERE ""C"".""customer_id"" IN (SELECT ""customer_id"" FROM ""JuneInvoice"") AND ""C"".""customer_id"" IN (SELECT ""customer_id"" FROM ""JulyInvoice"")"
397,"SELECT ""t1"".""customer_id"",""t3"".""name"" FROM (""Orders"" AS ""t1"" LEFT JOIN ""Product"" AS ""t2"" USING (""product_id"")) LEFT JOIN ""Customers"" AS ""t3"" USING (""customer_id"") GROUP BY ""t1"".""customer_id"" HAVING SUM(CASE WHEN ""t1"".""order_date"" LIKE '2020-06-%' THEN ""t2"".""price""*""t1"".""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""t1"".""order_date"" LIKE '2020-07-%' THEN ""t2"".""price""*""t1"".""quantity"" ELSE 0 END)>=100"
398,"WITH ""t1"" AS (SELECT ""o"".""customer_id"",""c"".""name"",CASE WHEN ""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN 'June' WHEN ""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN 'July' ELSE NULL END AS ""month"",SUM(""quantity""*""price"") AS ""total"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""o"".""customer_id"",""month"") SELECT ""customer_id"",""name"" FROM ""t1"" WHERE ""total"">=100 GROUP BY ""customer_id"" HAVING COUNT(1)=2"
399,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity"" ELSE 0 END*""price"")>=100"
400,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY 1,2 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity""*""price"" ELSE 0 END)>=100"
401,"WITH ""T1"" AS (SELECT ""A"".""CUSTOMER_ID"" AS ""CUSTOMER_ID"",""C"".""NAME"" AS ""NAME"",SUM(""B"".""PRICE""*""A"".""QUANTITY"") AS ""AMT_TOT"",EXTRACT(YEAR FROM ""A"".""ORDER_DATE"")*100+EXTRACT(MONTH FROM ""A"".""ORDER_DATE"") AS ""YM"" FROM ((SELECT * FROM ""ORDERS"" WHERE EXTRACT(MONTH FROM ""ORDER_DATE"") IN (6,7)) AS ""A"" LEFT JOIN ""PRODUCT"" AS ""B"" ON ""A"".""PRODUCT_ID""=""B"".""PRODUCT_ID"") LEFT JOIN ""CUSTOMERS"" AS ""C"" ON ""A"".""CUSTOMER_ID""=""C"".""CUSTOMER_ID"" GROUP BY ""CUSTOMER_ID"",""YM""), ""T2"" AS (SELECT ""CUSTOMER_ID"",""NAME"",SUM(CASE WHEN ""AMT_TOT"">=100 THEN 1 ELSE 0 END) AS ""CNT"" FROM ""T1"" GROUP BY ""CUSTOMER_ID"",""NAME"") SELECT ""CUSTOMER_ID"",""NAME"" FROM ""T2"" WHERE ""CNT""=2"
402,"WITH ""ord_prd"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM ""Orders"" AS ""ord"" JOIN ""Product"" AS ""prd"" ON ""ord"".""product_id""=""prd"".""product_id"" GROUP BY ""customer_id"",EXTRACT(YEAR FROM ""order_date""),EXTRACT(MONTH FROM ""order_date"")), ""june"" AS (SELECT ""customer_id"" FROM ""ord_prd"" WHERE ""month""=6 AND ""total"">=100), ""july"" AS (SELECT ""customer_id"" FROM ""ord_prd"" WHERE ""month""=7 AND ""total"">=100) SELECT ""Customers"".""customer_id"" AS ""CUSTOMER_ID"",""name"" AS ""NAME"" FROM (""Customers"" JOIN ""june"" ON ""Customers"".""customer_id""=""june"".""customer_id"") JOIN ""july"" ON ""Customers"".""customer_id""=""july"".""customer_id"""
403,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t1"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t2"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1) AS ""tmp"" WHERE ""t1"">=100 AND ""t2"">=100"
404,"SELECT ""c"".""customer_id"",""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""date"",SUM(""price""*""quantity"") AS ""total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY ""customer_id"",LEFT(""order_date"", 7) HAVING SUM(""price""*""quantity"")>=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(1)=2"
405,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tb"" GROUP BY ""name"" HAVING COUNT(1)=2"
406,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""od"",SUM(""quantity""*""price"") AS ""pr"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""name"",""od"" HAVING ""pr"">=100) SELECT ""customer_id"",""name"" FROM ""cte"" GROUP BY ""customer_id"",""name"" HAVING COUNT(""od"")=2"
407,"SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""A"".""customer_id"" FROM (SELECT ""o"".""customer_id"",SUM(""p"".""price""*""o"".""quantity"") AS ""price"" FROM ""product"" AS ""p"" JOIN ""orders"" AS ""o"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">='2020-06-01' AND ""o"".""order_date""<='2020-06-30' GROUP BY ""o"".""customer_id"" HAVING ""price"">=100) AS ""A"") AND ""customer_id"" IN (SELECT ""B"".""customer_id"" FROM (SELECT ""o"".""customer_id"",SUM(""p"".""price""*""o"".""quantity"") AS ""price"" FROM ""product"" AS ""p"" JOIN ""orders"" AS ""o"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""o"".""order_date"">='2020-07-01' AND ""o"".""order_date""<='2020-07-31' GROUP BY ""o"".""customer_id"" HAVING ""price"">=100) AS ""B"")"
408,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""month"") AS ""a"" GROUP BY 1 HAVING SUM(CASE WHEN ""month""='2020-06' AND ""total"">=100 THEN 1 WHEN ""month""='2020-07' AND ""total"">=100 THEN 1 ELSE 0 END)=2"
409,"WITH ""t"" AS (SELECT ""o"".""customer_id"",LEFT(""order_date"", 7) AS ""month"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""o"".""order_date"", 7) IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""month"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) SELECT ""c"".""customer_id"",""c"".""name"" FROM ""t"" JOIN ""customers"" AS ""c"" ON ""t"".""customer_id""=""c"".""customer_id"" GROUP BY ""t"".""customer_id"" HAVING COUNT(""month"")=2"
410,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",SUM(""price""*""quantity"") AS ""total"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""month"") AS ""a"" GROUP BY 1 HAVING SUM(CASE WHEN ""month""='2020-06' AND ""total"">=100 THEN 1 WHEN ""month""='2020-07' AND ""total"">=100 THEN 1 ELSE 0 END)=2"
411,"SELECT ""customer_id"",""name"" FROM (""customers"" JOIN ""orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN SUBSTRING(""order_date"", 1, 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
412,"WITH ""tb1"" AS (SELECT ""o"".""customer_id"",EXTRACT(YEAR_MONTH FROM ""order_date"") AS ""order_month"",SUM(""price""*""quantity"") AS ""total"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"",EXTRACT(YEAR_MONTH FROM ""order_date"") HAVING ""order_month"" IN (202006,202007)), ""JUN"" AS (SELECT ""customer_id"" FROM ""tb1"" WHERE ""order_month""=202006 AND ""total"">=100), ""JUL"" AS (SELECT ""customer_id"" FROM ""tb1"" WHERE ""order_month""=202007 AND ""total"">=100) SELECT ""JUN"".""customer_id"",""c"".""name"" FROM (""JUN"" JOIN ""JUL"" ON ""JUN"".""customer_id""=""JUL"".""customer_id"") JOIN ""Customers"" AS ""c"" ON ""JUN"".""customer_id""=""c"".""customer_id"""
413,"SELECT ""jj"".""customer_id"",""jj"".""name"" FROM (SELECT ""cst"".""customer_id"",""cst"".""name"",SUM(""pd"".""price""*""ord"".""quantity"") AS ""tot_order"",EXTRACT(MONTH FROM ""ord"".""order_date"") FROM (""Orders"" AS ""ord"" LEFT JOIN ""Product"" AS ""pd"" USING (""product_id"")) LEFT JOIN ""Customers"" AS ""cst"" USING (""customer_id"") WHERE EXTRACT(MONTH FROM ""ord"".""order_date"") IN ('06','07') GROUP BY 1,4 HAVING SUM(""ord"".""quantity""*""pd"".""price"")>=100) AS ""jj"" GROUP BY 1 HAVING COUNT(1)=2"
414,"WITH ""base"" AS (SELECT TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"",""customer_id"",""name"",SUM(""quantity""*""price"") AS ""total"" FROM (""Orders"" JOIN ""Product"" USING (""product_id"")) JOIN ""Customers"" USING (""customer_id"") WHERE TO_CHAR(""order_date"", 'YYYY-%m') BETWEEN '2020-06' AND '2020-07' GROUP BY 1,2,3) SELECT ""customer_id"",""name"" FROM ""base"" WHERE ""total"">=100 GROUP BY 1,2 HAVING COUNT(DISTINCT ""month"")=2"
415,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN ""order_date"" LIKE '2020-06%' THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN ""order_date"" LIKE '2020-07%' THEN ""quantity""*""price"" ELSE 0 END)>=100"
416,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
417,"SELECT ""a"".""customer_id"",""a"".""name"" FROM (""customers"" AS ""a"" JOIN ""product"" AS ""b"") LEFT JOIN ""orders"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" AND ""b"".""product_id""=""c"".""product_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100 AND SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100"
418,"SELECT ""customers"".""customer_id"" AS ""customer_id"",""customers"".""name"" AS ""name"" FROM (""Orders"" AS ""orders"" JOIN ""Product"" AS ""prod"" ON ""orders"".""product_id""=""prod"".""product_id"") JOIN ""Customers"" AS ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"" WHERE LEFT(""orders"".""order_date"", 7)='2020-06' OR LEFT(""orders"".""order_date"", 7)='2020-07' GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-06' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100) AND (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-07' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100)"
419,"SELECT ""t"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""price""*""quantity"") AS ""total_price"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING ""total_price"">=100 AND ""month"" IN (6,7)) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(""c"".""customer_id"")>1"
420,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"",SUBSTRING(""order_date"", 1, 7) AS ""month"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(MONTH FROM ""order_date"")='6' OR EXTRACT(MONTH FROM ""order_date"")='7' GROUP BY ""month"",""customer_id"" HAVING ""total"">=100) AS ""t"" GROUP BY ""customer_id"" HAVING COUNT(1)>=2"
421,"SELECT DISTINCT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" ELSE NULL END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" ELSE NULL END)>=100"
422,"SELECT ""cs"".""customer_id"",""cs"".""name"" FROM (""Customers"" AS ""cs"" JOIN ""Orders"" AS ""ord"" ON ""cs"".""customer_id""=""ord"".""customer_id"") JOIN ""Product"" AS ""pr"" ON ""pr"".""product_id""=""ord"".""product_id"" GROUP BY ""cs"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
423,"WITH ""month_sp"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_price"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"")) SELECT ""m"".""customer_id"",""c"".""name"" FROM ""month_sp"" AS ""m"" JOIN ""Customers"" AS ""c"" ON ""m"".""customer_id""=""c"".""customer_id"" WHERE ""m"".""total_price"">=100 GROUP BY ""m"".""customer_id"" HAVING COUNT(""month"")=2"
424,"SELECT ""A"".""customer_id"" AS ""customer_id"",""A"".""name"" AS ""name"" FROM (SELECT ""C"".""customer_id"",""C"".""name"",SUM((CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN (""price""*""quantity"") ELSE 0 END)) AS ""Jun_spend"",SUM((CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN (""price""*""quantity"") ELSE 0 END)) AS ""Jul_spend"" FROM (""Orders"" AS ""O"" JOIN ""Product"" AS ""P"" ON ""O"".""product_id""=""P"".""product_id"") JOIN ""Customers"" AS ""C"" ON ""C"".""customer_id""=""O"".""customer_id"" GROUP BY ""C"".""customer_id"",""C"".""name"" HAVING ""Jun_spend"">=100 AND ""Jul_spend"">=100) AS ""A"""
425,"SELECT ""o"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" USING (""product_id"")) LEFT JOIN ""customers"" AS ""c"" USING (""customer_id"") GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
426,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""p"".""Price""*""o"".""quantity"") AS ""total_spend"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""order_date"">'2020-06-30' AND ""order_date""<'2020-08-01' GROUP BY ""c"".""customer_id"",""c"".""name"") AS ""july"" WHERE ""total_spend"">=100 AND ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""p"".""Price""*""o"".""quantity"") AS ""total_spend"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE ""order_date"">'2020-05-30' AND ""order_date""<'2020-07-01' GROUP BY ""c"".""customer_id"",""c"".""name"") AS ""june"" WHERE ""total_spend"">=100)"
427,"SELECT ""c1"".""customer_id"",""c1"".""name"" FROM ((SELECT ""o1"".""customer_id"" FROM ""orders"" AS ""o1"" JOIN ""product"" AS ""p1"" ON ""o1"".""product_id""=""p1"".""product_id"" WHERE EXTRACT(YEAR FROM ""o1"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o1"".""order_date"")=6 GROUP BY ""o1"".""customer_id"" HAVING SUM(""o1"".""quantity""*""p1"".""price"")>=100) AS ""temp1"" JOIN (SELECT ""o2"".""customer_id"" FROM ""orders"" AS ""o2"" JOIN ""product"" AS ""p2"" ON ""o2"".""product_id""=""p2"".""product_id"" WHERE EXTRACT(YEAR FROM ""o2"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o2"".""order_date"")=7 GROUP BY ""o2"".""customer_id"" HAVING SUM(""o2"".""quantity""*""p2"".""price"")>=100) AS ""temp2"" ON ""temp1"".""customer_id""=""temp2"".""customer_id"") JOIN ""Customers"" AS ""c1"" ON ""temp1"".""customer_id""=""c1"".""customer_id"""
428,"WITH ""t"" AS (SELECT ""Orders"".""customer_id"",""Customers"".""name"",""order_date"",SUM(""price""*""quantity"") AS ""total"" FROM (""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"") LEFT JOIN ""Customers"" ON ""Orders"".""customer_id""=""Customers"".""customer_id"" WHERE (SUBSTRING(""order_date"", 1, 7)='2020-06' OR SUBSTRING(""order_date"", 1, 7)='2020-07') GROUP BY ""customer_id"",SUBSTRING(""order_date"", 1, 7)) SELECT ""customer_id"",""name"" FROM ""t"" WHERE ""total"">=100 GROUP BY 1 HAVING COUNT(1)=2"
429,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
430,"SELECT DISTINCT ""customer_id"",""name"" FROM (SELECT ""z1"".""customer_id"",""z1"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""z2"".""quantity""*""z3"".""price"" END) AS ""jun_order_value"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""z2"".""quantity""*""z3"".""price"" END) AS ""jul_order_value"" FROM (""Customers"" AS ""z1"" JOIN ""Orders"" AS ""z2"" ON ""z1"".""customer_id""=""z2"".""customer_id"") JOIN ""Product"" AS ""z3"" ON ""z2"".""product_id""=""z3"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY 1,2) AS ""y1"" WHERE ""jun_order_value"">=100 AND ""jul_order_value"">=100"
431,"WITH ""info"" AS (SELECT ""c"".""customer_id"",""c"".""name"",""p"".""product_id"",""p"".""price"",""o"".""order_date"",""o"".""quantity"" FROM (""Product"" AS ""p"" RIGHT JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") SELECT ""customer_id"",""name"" FROM (SELECT EXTRACT(MONTH FROM ""order_date""),""customer_id"",""name"",SUM(""price""*""quantity"") FROM ""info"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY EXTRACT(MONTH FROM ""order_date""),""customer_id"" HAVING SUM(""price""*""quantity"")>=100) AS ""a"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")=2"
432,"SELECT ""customer_id"",""name"" FROM (""Orders"" AS ""o"" JOIN ""Customers"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE SUBSTR(""order_date"", 1, 7)='2020-06' AND ""customer_id"" IN (SELECT ""a"".""customer_id"" FROM (SELECT ""customer_id"",SUM(""p"".""price""*""o"".""quantity"") FROM (""Orders"" AS ""o"" JOIN ""Customers"" USING (""customer_id"")) JOIN ""Product"" AS ""p"" USING (""product_id"") WHERE SUBSTR(""order_date"", 1, 7)='2020-07' GROUP BY ""customer_id"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""a"") GROUP BY ""customer_id"" HAVING SUM(""p"".""price""*""o"".""quantity"")>=100"
433,"WITH ""a"" AS (SELECT ""customer_id"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""mon"",SUM(""quantity""*""price"") AS ""sum_price"" FROM ""Orders"" AS ""t1"" JOIN ""Product"" AS ""t2"" ON ""t1"".""product_id""=""t2"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"",""mon"") SELECT ""a"".""customer_id"",""name"" FROM ""a"" JOIN ""Customers"" ON ""a"".""customer_id""=""Customers"".""customer_id"" GROUP BY ""customer_id"",""name"" HAVING SUM(""sum_price"">=100)=2"
434,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY 1,LEFT(""order_date"", 7) HAVING SUM(""quantity""*""price"")>=100) AS ""temp"" GROUP BY 2 HAVING COUNT(1)=2"
435,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
436,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
437,"SELECT ""customer_id"",""name"" FROM (""Orders"" JOIN ""Product"" USING (""product_id"")) JOIN ""Customers"" USING (""customer_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""price""*""quantity"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""price""*""quantity"" ELSE 0 END)>=100"
438,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
439,"SELECT ""c"".""customer_id"",""name"" FROM ((""Orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""Customers"" AS ""c"" WHERE ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" ELSE 0 END)>=100"
440,"SELECT ""customer_id"",""name"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") FROM ""Orders"" LEFT JOIN ""Product"" USING (""product_id"") WHERE EXTRACT(YEAR FROM ""order_date"")='2020' AND EXTRACT(MONTH FROM ""order_date"") IN ('06','07') GROUP BY 1,2 HAVING SUM(""price""*""quantity"")>=100) AS ""a"" JOIN ""Customers"" USING (""customer_id"") GROUP BY 1 HAVING COUNT(1)=2"
441,"WITH ""june_sales"" AS (SELECT ""Orders"".""customer_id"",""Orders"".""quantity"",""Product"".""price"" FROM ""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE ""order_date"" BETWEEN DATE('2020-06-01') AND DATE('2020-06-30')), ""july_sales"" AS (SELECT ""Orders"".""customer_id"",""Orders"".""quantity"",""Product"".""price"" FROM ""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE ""order_date"" BETWEEN DATE('2020-07-01') AND DATE('2020-07-31')) SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""june_sales"" ON ""c"".""customer_id""=""june_sales"".""customer_id"") LEFT JOIN ""july_sales"" ON ""c"".""customer_id""=""july_sales"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(""june_sales"".""quantity""*""june_sales"".""price"")>=100 AND SUM(""july_sales"".""quantity""*""july_sales"".""price"")>=100"
442,"SELECT ""t1"".""customer_id"",""c"".""name"" FROM (SELECT ""customer_id"" FROM (SELECT ""o"".""customer_id"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ((EXTRACT(MONTH FROM ""order_date"")=6 AND EXTRACT(YEAR FROM ""order_date"")=2020)) OR (EXTRACT(MONTH FROM ""order_date"")=7 AND EXTRACT(YEAR FROM ""order_date"")=2020) GROUP BY ""o"".""customer_id"",LEFT(""order_date"", 7) HAVING SUM(""p"".""price""*""o"".""quantity"")>=100) AS ""t"" GROUP BY ""customer_id"" HAVING COUNT(""customer_id"")>1) AS ""t1"" LEFT JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""t1"".""customer_id"""
443,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
444,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
445,"SELECT ""customer_id"",""name"" FROM (SELECT ""o"".""customer_id"",""c"".""name"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price""*""o"".""quantity"" END) AS ""July_sale"",SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price""*""o"".""quantity"" END) AS ""June_sale"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""o"".""customer_id"" HAVING ""July_sale"">=100 AND ""June_sale"">=100) AS ""freq_tab1"""
446,"WITH ""CTE"" AS (SELECT ""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""yr_month"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""o"".""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) SELECT ""cu"".""customer_id"" AS ""customer_id"",""cu"".""name"" AS ""name"" FROM ""Customers"" AS ""cu"" JOIN ""CTE"" AS ""c"" ON ""cu"".""customer_id""=""c"".""customer_id"" GROUP BY ""cu"".""customer_id"" HAVING COUNT(DISTINCT ""yr_month"")>1"
447,"SELECT ""f"".""customer_id"",""c"".""name"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""m"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY 1,2 HAVING SUM(""quantity""*""price"")>=100) AS ""f"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""f"".""customer_id"" GROUP BY 1 HAVING COUNT(1)=2"
448,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-06' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t1"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY-%m')='2020-07' THEN ""p"".""price""*""o"".""quantity"" ELSE 0 END) AS ""t2"" FROM (""Product"" AS ""p"" JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"") AS ""a"" WHERE ""t1"">=100 AND ""t2"">=100"
449,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""o"".""quantity""*""p"".""price"" END) AS ""June"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""o"".""quantity""*""p"".""price"" END) AS ""July"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY 1 ORDER BY 1) SELECT ""cte"".""customer_id"",""c"".""name"" FROM ""cte"" JOIN ""Customers"" AS ""c"" ON ""cte"".""customer_id""=""c"".""customer_id"" AND ""cte"".""June"">=100 AND ""cte"".""July"">=100 ORDER BY 1"
450,"SELECT ""customer_id"",""name"" FROM (""Orders"" JOIN ""Customers"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN MONTHNAME(""order_date"")='June' AND EXTRACT(YEAR FROM ""order_date"")=2020 THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN MONTHNAME(""order_date"")='July' AND EXTRACT(YEAR FROM ""order_date"")=2020 THEN ""quantity""*""price"" ELSE 0 END)>=100"
451,"SELECT ""c"".""customer_id"",""c"".""name"" FROM (""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""p"".""price"" ELSE 0 END*""o"".""quantity"")>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""p"".""price"" ELSE 0 END*""o"".""quantity"")>=100"
452,"SELECT ""customers"".""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" ON ""customers"".""customer_id""=""orders"".""customer_id"") JOIN ""Product"" ON ""product"".""product_id""=""orders"".""product_id"" GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
453,"SELECT ""c"".""customer_id"",""name"" FROM (SELECT LEFT(""order_date"", 7) AS ""month"",""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND (EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7) GROUP BY LEFT(""order_date"", 7),""o"".""customer_id"" HAVING SUM(""quantity""*""price"")>=100) AS ""sub"" JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""sub"".""customer_id"" GROUP BY ""sub"".""customer_id"" HAVING COUNT(1)=2"
454,"SELECT DISTINCT ""customer_id"",""name"" FROM (SELECT ""z1"".""customer_id"",""z1"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""z2"".""quantity""*""z3"".""price"" END) AS ""jun_order_value"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""z2"".""quantity""*""z3"".""price"" END) AS ""jul_order_value"" FROM (""Customers"" AS ""z1"" JOIN ""Orders"" AS ""z2"" ON ""z1"".""customer_id""=""z2"".""customer_id"") JOIN ""Product"" AS ""z3"" ON ""z2"".""product_id""=""z3"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY 1,2) AS ""y1"" WHERE ""jun_order_value"">=100 AND ""jul_order_value"">=100"
455,"SELECT DISTINCT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE ""o"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE (EXTRACT(MONTH FROM ""o"".""order_date"")='06') GROUP BY ""o"".""customer_id"" HAVING (SUM(""o"".""quantity""*""p"".""price""))>=100 AND ""o"".""customer_id"" IN (SELECT ""o"".""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE (EXTRACT(MONTH FROM ""o"".""order_date"")='07') GROUP BY ""o"".""customer_id"" HAVING (SUM(""o"".""quantity""*""p"".""price""))>=100))"
456,"SELECT ""d"".""customer_id"",""d"".""name"" FROM (SELECT ""order_id"",""a"".""customer_id"",""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""a"".""order_date"")=6 THEN (""b"".""price""*""a"".""quantity"") ELSE NULL END) AS ""June_total"",SUM(CASE WHEN EXTRACT(MONTH FROM ""a"".""order_date"")=7 THEN (""b"".""price""*""a"".""quantity"") ELSE NULL END) AS ""July_total"" FROM (""Orders"" AS ""a"" JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"") JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" GROUP BY ""a"".""customer_id"") AS ""d"" WHERE ""d"".""June_total"">=100 AND ""d"".""July_total"">=100"
457,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='06' THEN ""p"".""price""*""quantity"" END) AS ""sm06"",SUM(CASE WHEN TO_CHAR(""order_date"", '%m')='07' THEN ""p"".""price""*""quantity"" END) AS ""sm07"" FROM ""orders"" AS ""o"" JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""customer_id"" HAVING ""sm06"">=100 AND ""sm07"">=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"""
458,"SELECT ""customers"".""customer_id"" AS ""customer_id"",""customers"".""name"" AS ""name"" FROM (""Orders"" AS ""orders"" JOIN ""Product"" AS ""prod"" ON ""orders"".""product_id""=""prod"".""product_id"") JOIN ""Customers"" AS ""customers"" ON ""orders"".""customer_id""=""customers"".""customer_id"" WHERE ""orders"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"" HAVING (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-06' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100) AND (SUM(CASE WHEN LEFT(""orders"".""order_date"", 7)='2020-07' THEN ""orders"".""quantity""*""prod"".""price"" ELSE NULL END)>=100)"
459,"SELECT ""a"".""customer_id"" AS ""customer_id"",""a"".""name"" AS ""name"" FROM (""orders"" AS ""c"" JOIN ""customers"" AS ""a"") LEFT JOIN ""product"" AS ""b"" ON ""c"".""customer_id""=""a"".""customer_id"" AND ""c"".""product_id""=""b"".""product_id"" GROUP BY ""a"".""customer_id"" HAVING SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100 AND SUM(CASE WHEN ""c"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' THEN ""c"".""quantity"" ELSE 0 END*""b"".""price"")>=100"
460,"SELECT ""o"".""customer_id"",""c"".""name"" FROM ((""Customers"" AS ""c"") JOIN ""Orders"" AS ""o"") JOIN ""Product"" AS ""p"" WHERE ""o"".""product_id""=""p"".""product_id"" AND ""o"".""customer_id""=""c"".""customer_id"" AND ""o"".""order_date""<='20200731' AND ""o"".""order_date"">='20200601' GROUP BY ""o"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-06' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN LEFT(""o"".""order_date"", 7)='2020-07' THEN ""o"".""quantity""*""p"".""price"" ELSE 0 END)>=100"
461,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY 1,LEFT(""order_date"", 7) HAVING SUM(""quantity""*""price"")>=100) AS ""temp"" GROUP BY 2 HAVING COUNT(1)=2"
462,"SELECT ""customer_id"",""name"" FROM (SELECT EXTRACT(MONTH FROM ""order_date""),""c"".""customer_id"",""c"".""name"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY 1,2,3 HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""_"" GROUP BY 1,2 HAVING COUNT(1)=2"
463,"WITH ""cte"" AS (SELECT ""c"".""customer_id"",""c"".""name"",TO_CHAR(""o"".""order_date"", 'YYYY-%m') AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_spend"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""customer_id"",""month"" HAVING ""total_spend"">=100) SELECT ""customer_id"",""name"" FROM ""cte"" WHERE ""month"" IN ('2020-06','2020-07') GROUP BY ""customer_id"" HAVING COUNT(1)=2"
464,"WITH ""r"" AS (SELECT ""c"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""month"",SUM(""p"".""price""*""o"".""quantity"") AS ""total_sum"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""o"".""customer_id""=""c"".""customer_id"") JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""total_sum"">=100 AND ""month"" IN (6,7)) SELECT ""customer_id"",""name"" FROM ""r"" GROUP BY ""customer_id"",""name"" HAVING COUNT(1)>=2"
465,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
466,"SELECT ""t"".""customer_id"",""t"".""name"" FROM (SELECT ""a"".""customer_id"",""c"".""name"",EXTRACT(MONTH FROM ""order_date"") AS ""OrderMonth"",SUM(""p"".""price""*""a"".""quantity"") AS ""OrderSpend"" FROM (""orders"" AS ""a"" LEFT JOIN ""product"" AS ""p"" ON ""p"".""product_id""=""a"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""a"".""customer_id""=""c"".""customer_id"" WHERE 1=1 AND (EXTRACT(MONTH FROM ""a"".""order_date"")=6 OR EXTRACT(MONTH FROM ""a"".""order_date"")=7) GROUP BY 1,2,3 HAVING SUM(""p"".""price""*""a"".""quantity"")>=100) AS ""t"" GROUP BY 1,2 HAVING COUNT(1)=2"
467,"WITH ""june_customers"" AS (SELECT ""customers"".""customer_id"" FROM (""orders"" JOIN ""customers"") JOIN ""product"" ON ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_id""=""product"".""product_id"" WHERE ""orders"".""order_date"" BETWEEN '2020-06-01' AND '2020-06-30' GROUP BY ""customers"".""customer_id"" HAVING SUM(""product"".""price""*""orders"".""quantity"")>=100), ""july_customers"" AS (SELECT ""customers"".""customer_id"" FROM (""orders"" JOIN ""customers"") JOIN ""product"" ON ""orders"".""customer_id""=""customers"".""customer_id"" AND ""orders"".""product_id""=""product"".""product_id"" WHERE ""orders"".""order_date"" BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY ""customers"".""customer_id"" HAVING SUM(""product"".""price""*""orders"".""quantity"")>=100) SELECT ""customer_id"",""name"" FROM ""customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""june_customers"") AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""july_customers"")"
468,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""tmp"" GROUP BY ""name"" HAVING COUNT(1)=2"
469,"SELECT ""c"".""customer_id"" AS ""CUSTOMER_ID"",""c"".""name"" AS ""NAME"" FROM ""customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""months"",SUM(""p"".""price""*""o"".""quantity"") AS ""tot"",1 AS ""counts"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN (6,7) GROUP BY 1,2 HAVING SUM(""p"".""price""*""o"".""quantity"")>=100 ORDER BY ""months"") AS ""t1"" ON ""c"".""customer_id""=""t1"".""customer_id"" GROUP BY 1,2 HAVING SUM(""counts"")=2"
470,"SELECT ""f"".""customer_id"",""c"".""name"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") AS ""m"" FROM ""orders"" AS ""o"" LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"") IN (6,7) GROUP BY 1,2 HAVING SUM(""quantity""*""price"")>=100) AS ""f"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""f"".""customer_id"" GROUP BY 1 HAVING COUNT(1)=2"
471,"SELECT ""O"".""customer_id"",""C"".""name"" FROM (""Customers"" AS ""C"" JOIN ""Orders"" AS ""O"" ON ""C"".""customer_id""=""O"".""customer_id"") JOIN ""product"" AS ""P"" ON ""P"".""product_id""=""O"".""product_id"" GROUP BY ""O"".""customer_id"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""O"".""order_date"")='06' THEN ""O"".""quantity""*""P"".""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""O"".""order_date"")='07' THEN ""O"".""quantity""*""P"".""price"" ELSE 0 END)>=100"
472,"WITH ""a1"" AS (SELECT ""customer_id"",""o"".""product_id"",SUM(""quantity"")*""price"" AS ""total"",EXTRACT(MONTH FROM ""order_date"") AS ""month"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2020 AND (EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7) GROUP BY ""customer_id"",""o"".""product_id"",EXTRACT(MONTH FROM ""order_date"")) SELECT ""c"".""customer_id"",""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",COUNT(1) AS ""n_months"" FROM (SELECT ""customer_id"",SUM(""total"") AS ""monthly_total"",""month"" FROM ""a1"" GROUP BY ""customer_id"",""month"" HAVING SUM(""total"")>=100) AS ""a2"" GROUP BY ""customer_id"") AS ""a3"" WHERE ""n_months""=2) AS ""a4"" ON ""c"".""customer_id""=""a4"".""customer_id"""
473,"WITH ""month"" AS (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""quantity""*""price"") AS ""spent"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""quantity""*""price"")>=100) SELECT ""m1"".""customer_id"",""c"".""name"" FROM (""month"" AS ""m1"" JOIN ""month"" AS ""m2"" ON ""m1"".""customer_id""=""m2"".""customer_id"" AND ""m1"".""month""=6 AND ""m2"".""month""=7) JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""m1"".""customer_id"""
474,"WITH ""a"" AS (SELECT ""customer_id"",""month"",SUM(""quantity""*""price"") AS ""total_spend"" FROM (SELECT ""orders"".*,""price"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""month"" FROM ""orders"" LEFT JOIN ""Product"" ON ""orders"".""product_id""=""Product"".""product_id"") AS ""temp"" GROUP BY ""customer_id"",""month"") SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""a"" WHERE ""month""='2020-07' AND ""total_spend"">=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""a"" WHERE ""month""='2020-06' AND ""total_spend"">=100)"
475,"WITH ""OP1"" AS (SELECT ""O"".""customer_id"",TO_CHAR(""O"".""order_date"", 'YYYY-%m') AS ""YM"",""O"".""quantity""*""P"".""price"" AS ""spending"" FROM (""Orders"" AS ""O"") JOIN ""Product"" AS ""P"" WHERE ""O"".""product_id""=""P"".""product_id"" AND ""O"".""order_date"" BETWEEN '2020-06-01' AND '2020-07-31'), ""OP2"" AS (SELECT ""customer_id"",""YM"",SUM(""spending"") AS ""spending"" FROM ""OP1"" GROUP BY ""customer_id"",""YM"" HAVING SUM(""spending"")>=100) SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""OP2"" GROUP BY ""customer_id"" HAVING COUNT(1)=2)"
476,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
477,"SELECT ""a"".""customer_id"",""a"".""name"" FROM (""Orders"" AS ""b"" LEFT JOIN ""Customers"" AS ""a"" ON ""b"".""customer_id""=""a"".""customer_id"") LEFT JOIN ""Product"" AS ""C"" ON ""b"".""product_id""=""c"".""product_id"" GROUP BY ""b"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""b"".""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""c"".""price"")>=100 AND SUM(CASE WHEN LEFT(""b"".""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""c"".""price"")>=100"
478,"SELECT DISTINCT ""customer_id"",""a"".""name"" FROM (SELECT ""customer_id"",""name"" FROM (""customers"" JOIN ""orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") WHERE EXTRACT(YEAR_MONTH FROM ""order_date"")='202006' GROUP BY ""customer_id"",""name"" HAVING SUM(""price""*""quantity"")>=100) AS ""a"" JOIN (SELECT ""customer_id"",""name"" FROM (""customers"" JOIN ""orders"" USING (""customer_id"")) JOIN ""product"" USING (""product_id"") WHERE EXTRACT(YEAR_MONTH FROM ""order_date"")='202007' GROUP BY ""customer_id"",""name"" HAVING SUM(""price""*""quantity"")>=100) AS ""b"" USING (""customer_id"")"
479,"WITH ""cte"" AS (SELECT ""o"".""customer_id"",""name"",TO_CHAR(""order_date"", 'YYYY-%m') AS ""od"",SUM(""quantity""*""price"") AS ""pr"" FROM (""orders"" AS ""o"" LEFT JOIN ""customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"") LEFT JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE TO_CHAR(""order_date"", 'YYYY-%m') IN ('2020-06','2020-07') GROUP BY ""o"".""customer_id"",""name"",""od"" HAVING ""pr"">=100) SELECT ""customer_id"",""name"" FROM ""cte"" GROUP BY ""customer_id"",""name"" HAVING COUNT(""od"")=2"
480,"WITH ""cte"" AS (SELECT EXTRACT(MONTH FROM ""order_date"") AS ""Month"",""o"".""customer_id"",SUM(""quantity""*""price"") FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE ""order_date"">='2020-06-01' AND ""order_date""<'2020-08-01' GROUP BY EXTRACT(MONTH FROM ""order_date""),""o"".""customer_id"" HAVING SUM(""quantity""*""price"")>=100) SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""cte"" GROUP BY ""customer_id"" HAVING COUNT(1)=2)"
481,"SELECT ""c"".""customer_id"",""name"" FROM ""customers"" AS ""c"" JOIN (SELECT ""customer_id"",LEFT(""order_date"", 7) AS ""date"",SUM(""price""*""quantity"") AS ""total"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE LEFT(""order_date"", 7)='2020-06' OR LEFT(""order_date"", 7)='2020-07' GROUP BY ""customer_id"",LEFT(""order_date"", 7) HAVING SUM(""price""*""quantity"")>=100) AS ""t"" ON ""c"".""customer_id""=""t"".""customer_id"" GROUP BY ""c"".""customer_id"" HAVING COUNT(1)=2"
482,"SELECT ""Customers"".""customer_id"",""Customers"".""name"" FROM ""Customers"" JOIN (SELECT ""Orders"".""customer_id"",EXTRACT(MONTH FROM ""Orders"".""order_date""),SUM(""Product"".""price""*""Orders"".""quantity"") AS ""Monthly_Spending"" FROM ""Orders"" LEFT JOIN ""Product"" ON ""Orders"".""product_id""=""Product"".""product_id"" WHERE EXTRACT(MONTH FROM ""Orders"".""order_date"") IN (6,7) GROUP BY ""Orders"".""customer_id"",EXTRACT(MONTH FROM ""Orders"".""order_date"")) AS ""Orders_1"" ON ""Customers"".""customer_id""=""Orders_1"".""customer_id"" WHERE ""Orders_1"".""Monthly_Spending"">=100 GROUP BY ""Customers"".""customer_id"" HAVING COUNT(""Customers"".""name"")=2"
483,"SELECT ""customer_id"",""name"" FROM ""Customers"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM (SELECT ""customer_id"",EXTRACT(MONTH FROM ""order_date"") FROM ""Orders"" AS ""a"" LEFT JOIN ""Product"" AS ""b"" ON ""a"".""product_id""=""b"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"")=6 OR EXTRACT(MONTH FROM ""order_date"")=7 GROUP BY ""customer_id"",EXTRACT(MONTH FROM ""order_date"") HAVING SUM(""quantity""*""price"")>=100) AS ""a"" GROUP BY ""customer_id"" HAVING COUNT(1)=2)"
484,"SELECT DISTINCT ""customers"".""customer_id"",""customers"".""name"" FROM (""customers"" JOIN ""orders"" ON ""customers"".""customer_id""=""orders"".""customer_id"") JOIN ""product"" ON ""product"".""product_Id""=""orders"".""product_id"" WHERE ""order_date"" BETWEEN '2020-06-01' AND '2020-07-31' GROUP BY 1 HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" END)>=100"
485,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" JOIN (SELECT ""o"".""customer_id"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""p"".""price""*""o"".""quantity"" ELSE NULL END) AS ""june"",SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""p"".""price""*""o"".""quantity"" ELSE NULL END) AS ""july"" FROM ""Product"" AS ""p"" RIGHT JOIN ""Orders"" AS ""o"" ON ""p"".""product_id""=""o"".""product_id"" GROUP BY ""o"".""customer_id"") AS ""temp"" ON ""c"".""customer_id""=""temp"".""customer_id"" WHERE ""temp"".""june"">=100 AND ""temp"".""july"">=100"
486,"WITH ""temp"" AS (SELECT ""order_id"",""customer_id"",""product_id"",""quantity"",CASE WHEN EXTRACT(MONTH FROM ""order_date"")=6 THEN 'June' WHEN EXTRACT(MONTH FROM ""order_date"")=7 THEN 'July' ELSE NULL END AS ""Month"" FROM ""orders""), ""temp2"" AS (SELECT ""temp"".""month"",""temp"".""customer_id"",(""temp"".""quantity""*""Product"".""price"") AS ""sales"" FROM ""temp"" JOIN ""Product"" ON ""Product"".""product_id""=""temp"".""product_id"" AND ""month"" IS NOT NULL), ""temp3"" AS (SELECT ""Customers"".""customer_id"",""Customers"".""name"",""temp2"".""month"" FROM ""temp2"" JOIN ""Customers"" ON ""temp2"".""customer_id""=""Customers"".""customer_id"" GROUP BY ""Customers"".""customer_id"",""temp2"".""month"" HAVING SUM(""temp2"".""sales"")>=100) SELECT ""temp3"".""customer_id"",""temp3"".""name"" FROM ""temp3"" GROUP BY ""customer_id"" HAVING COUNT(1)>1"
487,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
488,"SELECT ""tmp"".""customer_id"",""tmp"".""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""o"".""quantity""*""p"".""price"") AS ""amount"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""c"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING ""amount"">=100) AS ""tmp"" GROUP BY ""tmp"".""customer_id"" HAVING COUNT(1)>1"
489,"SELECT ""o"".""customer_id"",""name"" FROM ((""Orders"" AS ""o"") JOIN ""Product"" AS ""p"") JOIN ""Customers"" AS ""c"" WHERE ""o"".""product_id""=""p"".""product_id"" AND ""c"".""customer_id""=""o"".""customer_id"" GROUP BY 1 HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
490,"SELECT DISTINCT ""c"".""customer_id"",""c"".""name"" AS ""name"" FROM (SELECT ""o"".""customer_id"",EXTRACT(MONTH FROM ""order_date"") AS ""month"",SUM(""o"".""quantity""*""p"".""price"") AS ""spend_per_month"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(MONTH FROM ""order_date"") IN ('06','07') GROUP BY ""o"".""customer_id"",""month"" HAVING ""spend_per_month"">=100) AS ""a"" JOIN ""customers"" AS ""c"" ON ""c"".""customer_id""=""a"".""customer_id"" GROUP BY ""c"".""customer_id"",""c"".""customer_id"" HAVING COUNT(""a"".""month"")=2"
491,"WITH ""group_customer"" AS (SELECT ""c"".""customer_id"",""c"".""name"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=6 THEN ""quantity""*""price"" ELSE 0 END) AS ""june_cost"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2020 AND EXTRACT(MONTH FROM ""order_date"")=7 THEN ""quantity""*""price"" ELSE 0 END) AS ""july_cost"" FROM ((""customers"" AS ""c"") JOIN ""orders"" AS ""o"") JOIN ""product"" AS ""p"" WHERE ""c"".""customer_id""=""o"".""customer_id"" AND ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"",""c"".""name"") SELECT ""customer_id"",""name"" FROM ""group_customer"" WHERE ""june_cost"">=100 AND ""july_cost"">=100"
492,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
493,"SELECT DISTINCT ""c"".""customer_id"",""c"".""name"" FROM (""Customers"" AS ""c"" LEFT JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 GROUP BY ""c"".""name"" HAVING SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=6 THEN ""quantity""*""price"" ELSE 0 END)>=100 AND SUM(CASE WHEN EXTRACT(MONTH FROM ""o"".""order_date"")=7 THEN ""quantity""*""price"" ELSE 0 END)>=100"
494,"SELECT ""c"".""customer_id"",""c"".""name"" FROM ""Customers"" AS ""c"" WHERE ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"")=6 GROUP BY ""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AND ""customer_id"" IN (SELECT ""customer_id"" FROM ""Orders"" AS ""o"" JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2020 AND EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""customer_id"" HAVING SUM(""o"".""quantity""*""p"".""price"")>=100)"
495,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"",SUM(""p"".""price""*""o"".""quantity"") AS ""total"",SUBSTRING(""order_date"", 1, 7) AS ""month"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""o"".""customer_id""=""c"".""customer_id"" WHERE EXTRACT(MONTH FROM ""order_date"")='6' OR EXTRACT(MONTH FROM ""order_date"")='7' GROUP BY ""month"",""customer_id"" HAVING ""total"">=100) AS ""t"" GROUP BY ""customer_id"" HAVING COUNT(1)>=2"
496,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
497,"SELECT ""customer_id"",""name"" FROM (SELECT ""c"".""name"",""o"".""customer_id"" FROM (""Orders"" AS ""o"" LEFT JOIN ""Product"" AS ""p"" ON ""p"".""product_id""=""o"".""product_id"") LEFT JOIN ""Customers"" AS ""c"" ON ""c"".""customer_id""=""o"".""customer_id"" WHERE EXTRACT(MONTH FROM ""o"".""order_date"")=6 OR EXTRACT(MONTH FROM ""o"".""order_date"")=7 GROUP BY ""o"".""customer_id"",EXTRACT(MONTH FROM ""o"".""order_date"") HAVING SUM(""o"".""quantity""*""p"".""price"")>=100) AS ""temp"" GROUP BY ""name"" HAVING COUNT(1)=2"
498,"SELECT ""c"".""customer_id"",""name"" FROM (""Customers"" AS ""c"" JOIN ""Orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""Product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY ""c"".""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
499,"SELECT ""customer_id"",""name"" FROM (""Customers"" JOIN ""Orders"" USING (""customer_id"")) JOIN ""Product"" USING (""product_id"") GROUP BY ""customer_id"" HAVING SUM(CASE WHEN LEFT(""order_date"", 7)='2020-06' THEN ""quantity"" ELSE 0 END*""price"")>=100 AND SUM(CASE WHEN LEFT(""order_date"", 7)='2020-07' THEN ""quantity"" ELSE 0 END*""price"")>=100"
500,"SELECT DISTINCT ""customer_id"",""name"" FROM (SELECT ""c"".""customer_id"",""c"".""name"" AS ""name"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='06' THEN (""price""*""quantity"") END) AS ""jun"",SUM(CASE WHEN EXTRACT(MONTH FROM ""order_date"")='07' THEN (""price""*""quantity"") END) AS ""july"" FROM (""customers"" AS ""c"" JOIN ""orders"" AS ""o"" ON ""c"".""customer_id""=""o"".""customer_id"") JOIN ""product"" AS ""p"" ON ""o"".""product_id""=""p"".""product_id"" GROUP BY 1,2) AS ""d"" WHERE ""jun"">=100 AND ""july"">=100"
