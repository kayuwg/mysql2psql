id,original query
1,"SELECT ""t"".""team_name"",COALESCE(COUNT(1), 0) AS ""matches_played"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END), 0) AS ""points"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END), 0) AS ""goal_for"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END), 0) AS ""goal_against"",COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END), 0)-COALESCE(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END), 0) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
2,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
3,"WITH ""cte"" AS (SELECT * FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""Teams"" AS ""t"" JOIN (SELECT ""home_team_id"" AS ""id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""cte"" GROUP BY 1) AS ""m"" ON ""t"".""team_id""=""m"".""id"" ORDER BY 3 DESC,6 DESC,1"
4,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",(""home_team_goals""-""away_team_goals"") AS ""goal_diff"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"",(""away_team_goals""-""home_team_goals"") AS ""goal_diff"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""points"" FROM ""matches"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""cte1"" AS ""c"" LEFT JOIN ""teams"" AS ""t"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
5,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END)) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" WHERE ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
6,"WITH ""home_tb"" AS (SELECT ""Teams"".""team_name"",""Matches"".""home_team_goals"" AS ""goal_for"",""Matches"".""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" JOIN ""Teams"" ON ""Matches"".""home_team_id""=""Teams"".""team_id""), ""away_tb"" AS (SELECT ""Teams"".""team_name"",""Matches"".""away_team_goals"" AS ""goal_for"",""Matches"".""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" JOIN ""Teams"" ON ""Matches"".""away_team_id""=""Teams"".""team_id""), ""union_tb"" AS (SELECT * FROM ""home_tb"" UNION ALL SELECT * FROM ""away_tb"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""union_tb"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
7,"WITH ""stat"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""point"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""away_point"",""away_team_goals"",""home_team_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""point"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""stat"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id"" GROUP BY ""team_name"" ORDER BY SUM(""point"") DESC,SUM(""goal_for""-""goal_against"") DESC,""team_name"""
8,"WITH ""points"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""matches""), ""points_stats"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"",COUNT(1) AS ""matches_played"",SUM(""goals"") AS ""goal_for"",SUM(""goal_aganist"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_points"" AS ""points"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""goal_aganist"" FROM ""points"" UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_points"" AS ""points"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""goal_aganist"" FROM ""points"")) AS ""tmp"" GROUP BY ""team_id"") SELECT ""t3"".""team_name"",""t1"".""matches_played"",""t1"".""points"",""t1"".""goal_for"",""t1"".""goal_against"",""t1"".""goal_for""-""t1"".""goal_against"" AS ""goal_diff"" FROM ""points_stats"" AS ""t1"" JOIN ""teams"" AS ""t3"" ON ""t1"".""team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
9,"SELECT ""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"") THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END) AS ""goal_against"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END)) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
10,"WITH ""points_results"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""home_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 END AS ""away_points"" FROM ""matches""), ""long_results"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""points"" FROM ""points_results"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""points"" FROM ""points_results"") SELECT ""b"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""long_results"" AS ""a"" LEFT JOIN ""Teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
11,"WITH ""cte"" AS (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""cte"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
12,"WITH ""final"" AS (WITH ""cte"" AS (SELECT ""t"".""team_id"" AS ""id_first"",""t"".""team_name"",""m"".* FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") SELECT *,CASE WHEN ""id_first""=""home_team_id"" THEN ""home_team_goals"" WHEN ""id_first""=""away_team_id"" THEN ""away_team_goals"" END AS ""updated_for_goals"",CASE WHEN ""id_first""=""home_team_id"" THEN ""away_team_goals"" WHEN ""id_first""=""away_team_id"" THEN ""home_team_goals"" END AS ""updated_against_goals"",CASE WHEN ""id_first""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""id_first""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""id_first""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""id_first""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""updated_points"" FROM ""cte"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""updated_points"") AS ""points"",SUM(""updated_for_goals"") AS ""goal_for"",SUM(""updated_against_goals"") AS ""goal_against"",SUM(""updated_for_goals"")-SUM(""updated_against_goals"") AS ""goal_diff"" FROM ""final"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,SUM(""updated_for_goals"")-SUM(""updated_against_goals"") DESC,""team_name"""
13,"WITH ""cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""cte"") SELECT ""b"".""team_name"",COUNT(""b"".""team_name"") AS ""matches_played"",SUM(""a"".""score"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""cte2"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""b"".""team_id""=""a"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""b"".""team_name"""
14,"WITH ""t1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""op_goals"",""home_points"" AS ""points"" FROM ""t1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",""away_points"" FROM ""t1""), ""t3"" AS (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""t2"".""points"") AS ""points"",SUM(""t2"".""goals"") AS ""goal_for"",SUM(""t2"".""op_goals"") AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""t2"" USING (""team_id"") GROUP BY ""team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""t3"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
15,"WITH ""statsTable"" AS (SELECT ""t1"".""team_name"",CASE WHEN ""m1"".""home_team_id""=""t1"".""team_id"" AND ""m1"".""home_team_goals"">""m1"".""away_team_goals"" THEN 3 WHEN ""m1"".""away_team_id""=""t1"".""team_id"" AND ""m1"".""away_team_goals"">""m1"".""home_team_goals"" THEN 3 WHEN ""m1"".""home_team_goals""=""m1"".""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",CASE WHEN ""m1"".""home_team_id""=""t1"".""team_id"" THEN ""m1"".""home_team_goals"" ELSE 0 END AS ""homeGoals"",CASE WHEN ""m1"".""away_team_id""=""t1"".""team_id"" THEN ""m1"".""away_team_goals"" ELSE 0 END AS ""homeGoals2"",CASE WHEN ""m1"".""home_team_id""=""t1"".""team_id"" THEN ""m1"".""away_team_goals"" ELSE 0 END AS ""awayGoals"",CASE WHEN ""m1"".""away_team_id""=""t1"".""team_id"" THEN ""m1"".""home_team_goals"" ELSE 0 END AS ""awayGoals2"",""m1"".""away_team_id"",""m1"".""home_team_id"" FROM ""Teams"" AS ""t1"" LEFT JOIN ""Matches"" AS ""m1"" ON ""t1"".""team_id""=""m1"".""home_team_id"" OR ""t1"".""team_id""=""m1"".""away_team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""homeGoals""+""homeGoals2"") AS ""goal_for"",SUM(""awayGoals""+""awayGoals2"") AS ""goal_against"",SUM(""homeGoals""+""homeGoals2""-""awayGoals""-""awayGoals2"") AS ""goal_diff"" FROM ""statsTable"" WHERE ""away_team_id"" IS NOT NULL OR ""home_team_id"" IS NOT NULL GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
16,"WITH ""tmp"" AS (SELECT * FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""home_team_id"" AS ""away_team_id"",""away_team_goals"" AS ""home_team_goals"",""home_team_goals"" AS ""away_team_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""tmp"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
17,"WITH ""temp"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Matches""), ""score_table"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""score"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""score"" FROM ""temp"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM (SELECT ""Teams"".""team_name"",""score_table"".""goal_for"",""score_table"".""goal_against"",""score_table"".""score"" FROM ""score_table"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""score_table"".""team_id"") AS ""join_score"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
18,"WITH ""CTE1"" AS (SELECT ""t"".""team_name"",""m"".""home_team_id"" AS ""team_id"",""m"".""home_team_goals"" AS ""goals"",(CASE WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""away_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_name"",""m"".""away_team_id"" AS ""team_id"",""m"".""away_team_goals"" AS ""goals"",(CASE WHEN ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 WHEN ""m"".""away_team_goals""<""m"".""home_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""home_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""away_team_id""=""t"".""team_id"") SELECT ""c"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goals"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""CTE1"" AS ""c"" GROUP BY ""c"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
19,"WITH ""temp"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Matches""), ""score_table"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""score"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""score"" FROM ""temp"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM (SELECT ""Teams"".""team_name"",""score_table"".""goal_for"",""score_table"".""goal_against"",""score_table"".""score"" FROM ""score_table"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""score_table"".""team_id"") AS ""join_score"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
20,"WITH ""cte"" AS ((SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"")) SELECT ""t"".""team_name"" AS ""team_name"",COUNT(""cte"".""goals_for"") AS ""matches_played"",SUM(""cte"".""points"") AS ""points"",SUM(""cte"".""goals_for"") AS ""goal_for"",SUM(""cte"".""goals_against"") AS ""goal_against"",(SUM(""cte"".""goals_for"")-SUM(""cte"".""goals_against"")) AS ""goal_diff"" FROM ""cte"" JOIN ""Teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
21,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""Matches"") AS ""g"" ON ""t"".""team_id""=""g"".""home_team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
22,"WITH ""CTE"" AS (SELECT ""home_team_id"" AS ""ID"",""home_team_goals"",""away_team_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""ID"",""away_team_goals"" AS ""home_team_goals"",""home_team_goals"" AS ""away_team_goals"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",COALESCE(SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END), 0) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""CTE"" AS ""M"" ON ""T"".""team_id""=""M"".""ID"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
23,"WITH ""cte"" AS (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""m"".""home_team_id""=""t"".""team_id"" OR ""m"".""away_team_id""=""t"".""team_id"" GROUP BY 1) SELECT *,""cte"".""goal_for""-""cte"".""goal_against"" AS ""goal_diff"" FROM ""cte"" ORDER BY ""cte"".""points"" DESC,""goal_diff"" DESC,""cte"".""team_name"""
24,"WITH ""goals"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""Matches""), ""stats"" AS (SELECT ""team_id"",COUNT(1) AS ""matches_played"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""points"") AS ""points"" FROM ""goals"" GROUP BY ""team_id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""TEAMS"" JOIN ""stats"" USING (""team_id"") ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
25,"WITH ""temp"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Matches""), ""score_table"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""score"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""score"" FROM ""temp"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM (SELECT ""Teams"".""team_name"",""score_table"".""goal_for"",""score_table"".""goal_against"",""score_table"".""score"" FROM ""score_table"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""score_table"".""team_id"") AS ""join_score"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
26,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_diff"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
27,"WITH ""temp1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""oppo_goals"") AS ""goal_against"",SUM(""goals"")-SUM(""oppo_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""oppo_goals"",""home_points"" AS ""points"" FROM ""temp1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""oppo_goals"",""away_points"" AS ""points"" FROM ""temp1"") AS ""t1"" JOIN ""teams"" AS ""t"" ON ""t1"".""team_id""=""t"".""team_id"" GROUP BY ""t1"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
28,"WITH ""score"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""for_goals"",""away_team_goals"" AS ""against_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""for_goals"",""home_team_goals"" AS ""against_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""for_goals"">""against_goals"" THEN 3 WHEN ""for_goals""=""against_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""for_goals"") AS ""goal_for"",SUM(""against_goals"") AS ""goal_against"",SUM(""for_goals"")-SUM(""against_goals"") AS ""goal_diff"" FROM ""score"" AS ""s"" LEFT JOIN ""teams"" AS ""t"" ON ""s"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
29,"WITH ""CTE"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" JOIN ""teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"" GROUP BY ""cte"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
30,"WITH ""scores"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""teams"" JOIN ""scores"" ON ""teams"".""team_id""=""scores"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
31,"WITH ""S0"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",COUNT(""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY ""home_team_id""), ""S1"" AS (SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",COUNT(""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END) AS ""points"" FROM ""Matches"" GROUP BY ""away_team_id""), ""S2"" AS (SELECT ""S0"".""team_id"",COALESCE(""S0"".""matches_played"", 0)+COALESCE(""S1"".""matches_played"", 0) AS ""matches_played"",COALESCE(""S0"".""points"", 0)+COALESCE(""S1"".""points"", 0) AS ""points"",COALESCE(""S0"".""goal_for"", 0)+COALESCE(""S1"".""goal_for"", 0) AS ""goal_for"",COALESCE(""S0"".""goal_against"", 0)+COALESCE(""S1"".""goal_against"", 0) AS ""goal_against"",COALESCE(""S0"".""goal_for"", 0)+COALESCE(""S1"".""goal_for"", 0)-COALESCE(""S0"".""goal_against"", 0)-COALESCE(""S1"".""goal_against"", 0) AS ""goal_diff"" FROM ""S0"" LEFT JOIN ""S1"" ON ""S0"".""team_id""=""S1"".""team_id"" UNION SELECT ""S1"".""team_id"",COALESCE(""S0"".""matches_played"", 0)+COALESCE(""S1"".""matches_played"", 0) AS ""matches_played"",COALESCE(""S0"".""points"", 0)+COALESCE(""S1"".""points"", 0) AS ""points"",COALESCE(""S0"".""goal_for"", 0)+COALESCE(""S1"".""goal_for"", 0) AS ""goal_for"",COALESCE(""S0"".""goal_against"", 0)+COALESCE(""S1"".""goal_against"", 0) AS ""goal_against"",COALESCE(""S0"".""goal_for"", 0)+COALESCE(""S1"".""goal_for"", 0)-COALESCE(""S0"".""goal_against"", 0)-COALESCE(""S1"".""goal_against"", 0) AS ""goal_diff"" FROM ""S0"" RIGHT JOIN ""S1"" ON ""S0"".""team_id""=""S1"".""team_id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""Teams"" LEFT JOIN ""S2"" ON ""Teams"".""team_id""=""S2"".""team_id"" WHERE ""matches_played"" IS NOT NULL AND ""points"" IS NOT NULL AND ""goal_for"" IS NOT NULL AND ""goal_against"" IS NOT NULL AND ""goal_diff"" IS NOT NULL ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
32,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals""-""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals""-""home_team_goals"" END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
33,"WITH ""t"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END AS ""point"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END AS ""point"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""point"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""t"" JOIN ""teams"" AS ""m"" ON ""t"".""id""=""m"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
34,"WITH ""A"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""A"" AS ""a"" ON ""t"".""team_id""=""a"".""id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
35,"WITH ""team_match"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""m"".""score"") AS ""points"",SUM(""m"".""goal_for"") AS ""goal_for"",SUM(""m"".""goal_against"") AS ""goal_against"",SUM(""m"".""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""team_match"" AS ""m"" ON ""t"".""team_id""=""m"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
36,"WITH ""h"" AS (SELECT ""home_team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""home_team_id""), ""a"" AS (SELECT ""away_team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""away_team_id"") SELECT ""t"".""team_name"",COALESCE(""h"".""matches_played"", 0)+COALESCE(""a"".""matches_played"", 0) AS ""matches_played"",COALESCE(""h"".""points"", 0)+COALESCE(""a"".""points"", 0) AS ""points"",COALESCE(""h"".""goal_for"", 0)+COALESCE(""a"".""goal_for"", 0) AS ""goal_for"",COALESCE(""h"".""goal_against"", 0)+COALESCE(""a"".""goal_against"", 0) AS ""goal_against"",COALESCE(""h"".""goal_for"", 0)+COALESCE(""a"".""goal_for"", 0)-COALESCE(""h"".""goal_against"", 0)-COALESCE(""a"".""goal_against"", 0) AS ""goal_diff"" FROM (""Teams"" AS ""t"" LEFT JOIN ""h"" ON ""t"".""team_id""=""h"".""home_team_id"") LEFT JOIN ""a"" ON ""t"".""team_id""=""a"".""away_team_id"" WHERE ""h"".""home_team_id"" IS NOT NULL OR ""a"".""away_team_id"" IS NOT NULL ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
37,"WITH ""cte_all"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_team_points"",""home_team_goals"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""away_team_points"",""away_team_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_points"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""cte_all"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_points"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""cte_all"") AS ""a"" JOIN ""Teams"" AS ""t"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY SUM(""points"") DESC,SUM(""goal_for"")-SUM(""goal_against"") DESC,""t"".""team_name"""
38,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_scored"") AS ""goal_for"",SUM(""goals_conceaded"") AS ""goal_against"",SUM(""goals_scored"")-SUM(""goals_conceaded"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN (SELECT CASE WHEN ""home_team_goals"">""away_team_goals"" THEN ""home_team_id"" WHEN ""home_team_goals""<""away_team_goals"" THEN ""away_team_id"" END AS ""team_id"",3 AS ""points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN ""away_team_goals"" WHEN ""home_team_goals"">""away_team_goals"" THEN ""home_team_goals"" END AS ""goals_scored"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN ""home_team_goals"" WHEN ""home_team_goals"">""away_team_goals"" THEN ""away_team_goals"" END AS ""goals_conceaded"" FROM ""matches"" WHERE ""home_team_goals""!=""away_team_goals"" UNION ALL SELECT CASE WHEN ""home_team_goals""<""away_team_goals"" THEN ""home_team_id"" WHEN ""home_team_goals"">""away_team_goals"" THEN ""away_team_id"" END AS ""team_id"",0 AS ""points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN ""home_team_goals"" WHEN ""home_team_goals"">""away_team_goals"" THEN ""away_team_goals"" END AS ""goals_scored"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN ""away_team_goals"" WHEN ""home_team_goals"">""away_team_goals"" THEN ""home_team_goals"" END AS ""goals_conceaded"" FROM ""matches"" WHERE ""home_team_goals""!=""away_team_goals"" UNION ALL SELECT ""home_team_id"" AS ""team_id"",1 AS ""points"",""home_team_goals"" AS ""goals_scored"",""away_team_goals"" AS ""goals_conceaded"" FROM ""matches"" WHERE ""home_team_goals""=""away_team_goals"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""points"",""away_team_goals"" AS ""goals_scored"",""home_team_goals"" AS ""goals_conceaded"" FROM ""matches"" WHERE ""home_team_goals""=""away_team_goals"") AS ""team_points"" USING (""team_id"") GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY SUM(""points"") DESC,""goal_diff"" DESC,""team_name"""
39,"SELECT ""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"") THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END) AS ""goal_against"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END)) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
40,"SELECT ""t"".""team_name"",COUNT(""t"".""team_id"") AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"") THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
41,"WITH ""all_games"" AS (SELECT ""home_team_id"" AS ""a_id"",""away_team_id"" AS ""b_id"",""home_team_goals"" AS ""a_goals"",""away_team_goals"" AS ""b_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""a_id"",""home_team_id"" AS ""b_id"",""away_team_goals"" AS ""a_goals"",""home_team_goals"" AS ""b_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""a_goals"">""b_goals"" THEN 3 WHEN ""a_goals""=""b_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""a_goals"") AS ""goal_for"",SUM(""b_goals"") AS ""goal_against"",SUM(""a_goals""-""b_goals"") AS ""goal_diff"" FROM ""all_games"" AS ""a"" JOIN ""Teams"" AS ""t"" ON ""a"".""a_id""=""t"".""team_id"" GROUP BY ""a_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,1"
42,"WITH ""cte_allteam"" AS (SELECT ""home_team_id"" AS ""plyr1"",""away_team_id"" AS ""plyr2"",""home_team_goals"" AS ""plyr1goals"",""away_team_goals"" AS ""plyr2goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""plyr1"",""home_team_id"" AS ""plyr2"",""away_team_goals"" AS ""plyr1goals"",""home_team_goals"" AS ""plyr2goals"" FROM ""matches"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""plyr1goals"">""plyr2goals"" THEN 3 WHEN ""plyr1goals""<""plyr2goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""plyr1goals"") AS ""goal_for"",SUM(""plyr2goals"") AS ""goal_against"",SUM(""plyr1goals"")-SUM(""plyr2goals"") AS ""goal_diff"" FROM ""cte_allteam"" AS ""ca"" JOIN ""Teams"" AS ""t"" ON ""ca"".""plyr1""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
43,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY ""away_team_id""), ""cte2"" AS (SELECT ""team_id"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""cte1"" GROUP BY ""team_id""), ""cte3"" AS (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team_id"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"" FROM ""matches"") AS ""r1"" GROUP BY ""team_id""), ""cte4"" AS (SELECT ""home_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches""), ""cte5"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"" FROM ""cte4"" GROUP BY ""team_id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ((""teams"" NATURAL JOIN ""cte2"") NATURAL JOIN ""cte3"") NATURAL JOIN ""cte5"" ORDER BY 3 DESC,6 DESC,1"
44,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
45,"WITH ""cte"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""home_team_id"" AS ""away_team_id"",""away_team_goals"" AS ""home_team_goals"",""home_team_goals"" AS ""away_team_goals"" FROM ""Matches"") SELECT ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""A"" JOIN ""cte"" AS ""B"" ON ""A"".""team_id""=""B"".""home_team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
46,"WITH ""s0"" AS (SELECT ""t"".""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 1 ELSE 0 END) AS ""wins"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 1 ELSE 0 END) AS ""losses"",SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""ties"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" GROUP BY 1), ""s1"" AS (SELECT ""t"".""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 1 ELSE 0 END) AS ""wins"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 1 ELSE 0 END) AS ""losses"",SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""ties"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1), ""s9"" AS (SELECT * FROM ""s0"" UNION ALL SELECT * FROM ""s1""), ""s2"" AS (SELECT ""team_id"",SUM(""matches_played"") AS ""matches_played"",3*SUM(""wins"")+SUM(""ties"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""s9"" GROUP BY 1) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""s2"" JOIN ""teams"" USING (""team_id"") ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
47,"WITH ""Scores"" (""team_id"", ""points"", ""goals_for"", ""goals_against"", ""goals_diff"", ""matches"") AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END,""home_team_goals"",""away_team_goals"",""home_team_goals""-""away_team_goals"",1 FROM ""Matches"" UNION ALL SELECT ""away_team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END,""away_team_goals"",""home_team_goals"",""away_team_goals""-""home_team_goals"",1 FROM ""Matches"") SELECT ""t"".""team_name"",SUM(""matches"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goals_diff"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Scores"" AS ""s"" ON ""t"".""team_id""=""s"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY SUM(""points"") DESC,SUM(""goals_diff"") DESC,""t"".""team_name"""
48,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
49,"SELECT ""t"".""team_name"",SUM(""team_id""=""away_team_id"" OR ""team_id""=""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals""-""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals""-""home_team_goals"" END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
50,"WITH ""home_team"" AS (SELECT ""home_team_id"" AS ""id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY ""home_team_id""), ""away_team"" AS (SELECT ""away_team_id"" AS ""id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY ""away_team_id"") SELECT ""t"".""team_name"",SUM(""tt"".""matches_played"") AS ""matches_played"",SUM(""tt"".""points"") AS ""points"",SUM(""tt"".""goal_for"") AS ""goal_for"",SUM(""tt"".""goal_against"") AS ""goal_against"",SUM(""tt"".""goal_for"")-SUM(""tt"".""goal_against"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN (SELECT * FROM ""home_team"" UNION ALL SELECT * FROM ""away_team"") AS ""tt"" ON ""t"".""team_id""=""tt"".""id"" GROUP BY ""t"".""team_name"" ORDER BY 3 DESC,6 DESC,1"
51,"SELECT ""t"".""team_name"",COUNT(""t"".""team_id"") AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"") THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
52,"WITH ""teams1"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(""teams1"".""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""teams1"" JOIN ""Teams"" ON ""teams1"".""id""=""Teams"".""team_id"" GROUP BY ""teams1"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
53,"WITH ""agg"" AS (SELECT ""home_team_id"" AS ""team_id"",""away_team_id"" AS ""team_against"",""home_team_goals"" AS ""goal"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""home_team_id"" AS ""team_against"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(""agg"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""goal"">""goal_against"" THEN 3 WHEN ""goal""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""agg"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""agg"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
54,"WITH ""tb1"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""g1"",""away_team_goals"" AS ""g2"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""g1"",""home_team_goals"" AS ""g2"" FROM ""Matches"") SELECT ""team_name"",COUNT(""tb1"".""id"") AS ""matches_played"",SUM(CASE WHEN ""g1"">""g2"" THEN 3 WHEN ""g1""=""g2"" THEN 1 ELSE 0 END) AS ""points"",SUM(""g1"") AS ""goal_for"",SUM(""g2"") AS ""goal_against"",SUM(""g1"")-SUM(""g2"") AS ""goal_diff"" FROM ""tb1"" JOIN ""Teams"" ON ""Teams"".""team_id""=""tb1"".""id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
55,"SELECT ""teams"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY ""home_team_id"" UNION SELECT ""away_team_Id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""a"" LEFT JOIN ""teams"" ON ""teams"".""team_id""=""a"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
56,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
57,"SELECT ""t"".""team_name"",COUNT(""t"".""team_name"") AS ""matches_played"",SUM(CASE WHEN ""t"".""goal_for"">""t"".""goal_against"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t"".""goal_for""=""t"".""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""t"".""goal_for"") AS ""goal_for"",SUM(""t"".""goal_against"") AS ""goal_against"",SUM(""t"".""goal_for"")-SUM(""t"".""goal_against"") AS ""goal_diff"" FROM ((SELECT ""t1"".""team_name"",""m"".""home_team_goals"" AS ""goal_for"",""m"".""away_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t1"" ON ""m"".""home_team_id""=""t1"".""team_id"") UNION ALL (SELECT ""t2"".""team_name"",""m"".""away_team_goals"" AS ""goal_for"",""m"".""home_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t2"" ON ""m"".""away_team_id""=""t2"".""team_id"")) AS ""t"" GROUP BY ""t"".""team_name"" ORDER BY SUM(CASE WHEN ""t"".""goal_for"">""t"".""goal_against"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""t"".""goal_for""=""t"".""goal_against"" THEN 1 ELSE 0 END) DESC,SUM(""t"".""goal_for"")-SUM(""t"".""goal_against"") DESC,""t"".""team_name"""
58,"WITH ""score"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""pt"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""pt"" FROM ""Matches"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(""s"".""team_id"") AS ""matches_played"",SUM(""s"".""pt"") AS ""points"",SUM(""s"".""goal_for"") AS ""goal_for"",SUM(""s"".""goal_against"") AS ""goal_against"",SUM(""s"".""goal_for"")-SUM(""s"".""goal_against"") AS ""goal_diff"" FROM ""score"" AS ""s"" JOIN ""Teams"" AS ""t"" ON ""s"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
59,"WITH ""temp1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""oppo_goals"") AS ""goal_against"",SUM(""goals"")-SUM(""oppo_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""oppo_goals"",""home_points"" AS ""points"" FROM ""temp1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""oppo_goals"",""away_points"" AS ""points"" FROM ""temp1"") AS ""t1"" JOIN ""teams"" AS ""t"" ON ""t1"".""team_id""=""t"".""team_id"" GROUP BY ""t1"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
60,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""cte2"" AS (SELECT ""team_id"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte1"" GROUP BY ""team_id"") SELECT ""teams"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""teams"" JOIN ""cte2"" ON ""teams"".""team_id""=""cte2"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
61,"WITH ""t"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""t"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""t"" JOIN ""Teams"" AS ""te"" ON ""t"".""team_id""=""te"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
62,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
63,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(""cte"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" JOIN ""teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
64,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id"" IN (""m"".""home_team_id"",""m"".""away_team_id"") GROUP BY ""team_id"",""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
65,"WITH ""MatchesWithScores"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_team_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""away_team_points"" FROM ""Matches""), ""asHomeTeam"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""totalGoals"",SUM(""away_team_goals"") AS ""opponentTotalGoals"",SUM(""home_team_points"") AS ""totalPoints"",COUNT(1) AS ""numMatches"" FROM ""MatchesWithScores"" GROUP BY ""home_team_id""), ""asAwayTeam"" AS (SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""totalGoals"",SUM(""home_team_goals"") AS ""opponentTotalGoals"",SUM(""away_team_points"") AS ""totalPoints"",COUNT(1) AS ""numMatches"" FROM ""MatchesWithScores"" GROUP BY ""away_team_id""), ""perTeamInfo"" AS (SELECT ""team_id"",SUM(""numMatches"") AS ""matches_played"",SUM(""totalPoints"") AS ""points"",SUM(""totalGoals"") AS ""goal_for"",SUM(""opponentTotalGoals"") AS ""goal_against"" FROM (SELECT * FROM ""asHomeTeam"" UNION SELECT * FROM ""asAwayTeam"") AS ""teamsInfo"" GROUP BY ""team_id"") SELECT ""Teams"".""team_name"" AS ""team_name"",""perTeamInfo"".""matches_played"" AS ""matches_played"",""perTeamInfo"".""points"" AS ""points"",""perTeamInfo"".""goal_for"" AS ""goal_for"",""perTeamInfo"".""goal_against"" AS ""goal_against"",""perTeamInfo"".""goal_for""-""perTeamInfo"".""goal_against"" AS ""goal_diff"" FROM ""perTeamInfo"" JOIN ""Teams"" ON ""perTeamInfo"".""team_id""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
66,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
67,"SELECT ""team_name"",""M"".""matches_played"",SUM(""B"".""Points"") AS ""points"",SUM(""B"".""goals"") AS ""goal_for"",SUM(""B"".""away_goals"") AS ""goal_against"",SUM(""B"".""goals"")-SUM(""B"".""away_goals"") AS ""goal_diff"" FROM (""Teams"" AS ""T"" JOIN (SELECT ""team_id"",SUM(""Match_CNT"") AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(""home_team_id"") AS ""Match_CNT"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(""away_team_id"") AS ""Match_CNT"" FROM ""Matches"" GROUP BY ""away_team_id"") AS ""A"" GROUP BY ""team_id"") AS ""M"" ON ""T"".""team_id""=""M"".""team_id"") JOIN (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""away_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""Points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""away_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""Points"" FROM ""Matches"") AS ""B"" ON ""T"".""team_id""=""B"".""team_id"" GROUP BY ""T"".""team_name"",""M"".""matches_played"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
68,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
69,"WITH ""cte"" AS (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""cte"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
70,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
71,"WITH ""t1"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(""home_team_id"") AS ""matches_played"" FROM (SELECT ""home_team_id"",""away_team_id"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"" FROM ""Matches"") AS ""temp"" GROUP BY 1), ""t2"" AS (SELECT ""team_id"",SUM(""team_points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""team_points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""team_points"" FROM ""Matches"") AS ""temp"" GROUP BY 1), ""t3"" AS (SELECT ""team_id"",SUM(""goal_for"") AS ""goal_for"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"" FROM ""Matches"") AS ""temp"" GROUP BY 1), ""t4"" AS (SELECT ""team_id"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""home_team_goals"" FROM ""Matches"") AS ""temp"" GROUP BY 1) SELECT ""t"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM (((""t1"" JOIN ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"") JOIN ""t3"" ON ""t2"".""team_id""=""t3"".""team_id"") JOIN ""t4"" ON ""t3"".""team_id""=""t4"".""team_id"") JOIN ""Teams"" AS ""t"" ON ""t4"".""team_id""=""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
72,"WITH ""A"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m""), ""B"" AS (SELECT ""A"".""team_id"",CASE WHEN ""A"".""goal_for"">""A"".""goal_against"" THEN 3 WHEN ""A"".""goal_for""<""A"".""goal_against"" THEN 0 ELSE 1 END AS ""points"",""A"".""goal_for"",""A"".""goal_against"",""A"".""goal_for""-""A"".""goal_against"" AS ""goal_diff"" FROM ""A"") SELECT ""T"".""team_name"",COUNT(""B"".""team_id"") AS ""matches_played"",SUM(""B"".""points"") AS ""points"",SUM(""B"".""goal_for"") AS ""goal_for"",SUM(""B"".""goal_against"") AS ""goal_against"",SUM(""B"".""goal_diff"") AS ""goal_diff"" FROM ""B"" JOIN ""Teams"" AS ""T"" ON ""B"".""team_id""=""T"".""team_id"" GROUP BY ""T"".""team_name"" ORDER BY SUM(""B"".""points"") DESC,SUM(""B"".""goal_diff"") DESC,""T"".""team_name"""
73,"SELECT ""t1"".""team_name"",COUNT(""t2"".""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""t2"".""home_team_goals"">""t2"".""away_team_goals"" THEN 3 WHEN ""t2"".""home_team_goals""=""t2"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""t2"".""home_team_goals"") AS ""goal_for"",SUM(""t2"".""away_team_goals"") AS ""goal_against"",SUM(""t2"".""home_team_goals""-""t2"".""away_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""t1"" JOIN (SELECT * FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""home_team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
74,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
75,"WITH ""cte1"" AS (SELECT ""home_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""home_points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 END AS ""away_points"" FROM ""matches"") SELECT ""a"".""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""home_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""a"" JOIN ""cte1"" AS ""b"" ON ""a"".""team_id""=""b"".""home_team_id"" GROUP BY ""a"".""team_name"" ORDER BY 3 DESC,6 DESC,1"
76,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""t1_id"",""home_team_goals"" AS ""t1_goals"",""away_team_goals"" AS ""t2_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""t1_id"",""away_team_goals"" AS ""t1_goals"",""home_team_goals"" AS ""t2_goals"" FROM ""matches"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t1_goals"">""t2_goals"" THEN 3 WHEN ""t1_goals""=""t2_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""t1_goals"") AS ""goal_for"",SUM(""t2_goals"") AS ""goal_against"",SUM(""t1_goals"")-SUM(""t2_goals"") AS ""goal_diff"" FROM ""cte"" AS ""c"" JOIN ""teams"" AS ""t"" ON ""c"".""t1_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
77,"WITH ""temp"" AS (SELECT ""home_team_id"",SUM(""home_team_goals"") AS ""home_team_goals"",SUM(""away_team_goals"") AS ""away_team_goals"",COUNT(""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION SELECT ""away_team_id"" AS ""home_team_id"",SUM(""away_team_goals"") AS ""home_team_goals"",SUM(""home_team_goals"") AS ""away_team_goals"",COUNT(""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY ""away_team_id"") SELECT ""t"".""team_name"",SUM(""d"".""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""d"".""home_team_goals"") AS ""goal_for"",SUM(""d"".""away_team_goals"") AS ""goal_against"",SUM(""d"".""home_team_goals"")-SUM(""d"".""away_team_goals"") AS ""goal_diff"" FROM ""temp"" AS ""d"" JOIN ""Teams"" AS ""t"" ON ""d"".""home_team_id""=""t"".""team_id"" GROUP BY ""home_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
78,"WITH ""t1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""op_goals"",""home_points"" AS ""points"" FROM ""t1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",""away_points"" FROM ""t1""), ""t3"" AS (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""t2"".""points"") AS ""points"",SUM(""t2"".""goals"") AS ""goal_for"",SUM(""t2"".""op_goals"") AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""t2"" USING (""team_id"") GROUP BY ""team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""t3"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
79,"SELECT ""c"".""team_name"",""c"".""matches_played"",""c"".""points"",""d"".""goal_for"",""d"".""goal_against"",""d"".""goal_diff"" FROM (SELECT ""team_id"",""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""m"".""home_team_id""=""t"".""team_id"" OR ""m"".""away_team_id""=""t"".""team_id"" GROUP BY ""team_id"") AS ""c"" JOIN (SELECT ""a"".""id"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") AS ""a"" GROUP BY ""id"") AS ""d"" ON ""c"".""team_id""=""d"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
80,"WITH ""t1"" AS (SELECT ""id"",COUNT(""id"") AS ""matches_played"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") AS ""tmp1"" GROUP BY ""id""), ""t2"" AS (SELECT ""id"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""tmp2"" GROUP BY ""id"") SELECT ""t"".""team_name"",""t1"".""matches_played"",""t2"".""points"",""t1"".""goal_for"",""t1"".""goal_against"",(""t1"".""goal_for""-""t1"".""goal_against"") AS ""goal_diff"" FROM (""teams"" AS ""t"" JOIN ""t1"" ON ""t"".""team_id""=""t1"".""id"") JOIN ""t2"" ON ""t1"".""id""=""t2"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
81,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""away_team_id"") AS ""sub"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""sub"".""team_id"" GROUP BY ""sub"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
82,"SELECT ""teams"".""team_name"",COUNT(""team1"") AS ""matches_played"",SUM(CASE WHEN ""goal1"">""goal2"" THEN 3 WHEN ""goal1""=""goal2"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal1"") AS ""goal_for"",SUM(""goal2"") AS ""goal_against"",SUM(""goal1""-""goal2"") AS ""goal_diff"" FROM ""Teams"" AS ""teams"" JOIN (SELECT ""home_team_id"" AS ""team1"",""away_team_id"" AS ""team2"",""home_team_goals"" AS ""goal1"",""away_team_goals"" AS ""goal2"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team1"",""home_team_id"" AS ""team2"",""away_team_goals"" AS ""goal1"",""home_team_goals"" AS ""goal2"" FROM ""Matches"") AS ""union_team"" ON ""teams"".""team_id""=""union_team"".""team1"" GROUP BY ""teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
83,"WITH ""A"" AS (SELECT *,(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 1 END) AS ""home_team_points"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""away_team_points"" FROM ""Matches""), ""B"" AS (SELECT ""home_team_id"",""home_team_goals"",""away_team_goals"",""home_team_points"" FROM ""A"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",""away_team_points"" FROM ""A"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM (SELECT ""home_team_id"",COUNT(1) AS ""matches_played"",SUM(""home_team_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""B"" GROUP BY ""home_team_id"") AS ""C"" JOIN ""Teams"" ON ""C"".""home_team_id""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
84,"SELECT ""a"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""t"" JOIN ""Teams"" AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY ""a"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""a"".""team_name"""
85,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""away"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""away"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") SELECT ""team_name"",COUNT(""team"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",(SUM(""goals"")-SUM(""away"")) AS ""goal_diff"" FROM ""teams"" JOIN ""cte"" ON ""teams"".""team_id""=""cte"".""team"" GROUP BY ""team"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
86,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END) AS ""away_points"" FROM ""Matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""id"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_points"") AS ""points"" FROM ""cte"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""id"",COUNT(""away_team_id"") AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_points"") AS ""points"" FROM ""cte"" GROUP BY ""away_team_id"") SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte2"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""cte2"".""id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
87,"WITH ""getResult"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1) SELECT ""Teams"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""getResult"" JOIN ""Teams"" ON ""getResult"".""team_id""=""Teams"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
88,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
89,"WITH ""expanded_matches"" AS ((SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""matches"")) SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""expanded_matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""m"".""team_id"",""t"".""team_name"" ORDER BY 3 DESC,6 DESC,1"
90,"WITH ""points_table"" AS ((SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""points"" FROM ""matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 END AS ""points"" FROM ""matches"")), ""goals_table"" AS ((SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"")), ""points_summary"" AS (SELECT ""team_id"",COUNT(""points"") AS ""matches_played"",SUM(""points"") AS ""points"" FROM ""points_table"" GROUP BY ""team_id""), ""goals_summary"" AS (SELECT ""team_id"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""goals_table"" GROUP BY ""team_id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM (""teams"" JOIN ""points_summary"" USING (""team_id"")) JOIN ""goals_summary"" USING (""team_id"") ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
91,"WITH ""calc"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",SUM(""goals"")-SUM(""against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""calc"" ON ""t"".""team_id""=""calc"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
92,"WITH ""temp1"" AS (SELECT ""team"",COUNT(1) AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" FROM ""Matches"") AS ""t"" GROUP BY 1), ""temp2"" AS (SELECT ""home_team_id"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 'home' WHEN ""home_team_goals""=""away_team_goals"" THEN 'tie' WHEN ""home_team_goals""<""away_team_goals"" THEN 'away' END AS ""match_result"" FROM ""Matches""), ""temp3"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""team"",SUM(CASE WHEN ""match_result""='home' THEN 3 WHEN ""match_result""='tie' THEN 1 ELSE 0 END) AS ""points"" FROM ""temp2"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team"",SUM(CASE WHEN ""match_result""='away' THEN 3 WHEN ""match_result""='tie' THEN 1 ELSE 0 END) AS ""points"" FROM ""temp2"" GROUP BY 1) AS ""g"" GROUP BY 1), ""temp4"" AS (SELECT ""team"",SUM(""goals"") AS ""goal_for"" FROM (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goals"" FROM ""Matches"") AS ""t"" GROUP BY 1), ""temp5"" AS (SELECT ""team"",SUM(""goals"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team"",""away_team_goals"" AS ""goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""home_team_goals"" AS ""goals"" FROM ""Matches"") AS ""t"" GROUP BY 1) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM (((""temp1"" JOIN ""Teams"" ON ""temp1"".""team""=""Teams"".""team_id"") JOIN ""temp3"" ON ""temp1"".""team""=""temp3"".""team"") JOIN ""temp4"" ON ""temp1"".""team""=""temp4"".""team"") JOIN ""temp5"" ON ""temp1"".""team""=""temp5"".""team"" ORDER BY 3 DESC,6 DESC,1"
93,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
94,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(""home_team_goals"") AS ""home_matches"",SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 END END END) AS ""points"",SUM(""home_team_goals"") AS ""home_goals"",SUM(""away_team_goals"") AS ""away_goals"" FROM ""Matches"" GROUP BY ""home_team_id""), ""cte2"" AS (SELECT ""away_team_id"" AS ""team_id"",COUNT(""away_team_goals"") AS ""away_matches"",SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 END END END) AS ""points"",SUM(""home_team_goals"") AS ""home_goals"",SUM(""away_team_goals"") AS ""away_goals"" FROM ""Matches"" GROUP BY ""away_team_id""), ""cte3"" AS (SELECT ""t"".""team_name"",((CASE WHEN ""home_matches"" IS NULL THEN 0 ELSE ""home_matches"" END)+(CASE WHEN ""away_matches"" IS NULL THEN 0 ELSE ""away_matches"" END)) AS ""matches_played"",((CASE WHEN ""c1"".""points"" IS NULL THEN 0 ELSE ""c1"".""points"" END)+(CASE WHEN ""c2"".""points"" IS NULL THEN 0 ELSE ""c2"".""points"" END)) AS ""points"",((CASE WHEN ""c1"".""home_goals"" IS NULL THEN 0 ELSE ""c1"".""home_goals"" END)+(CASE WHEN ""c2"".""away_goals"" IS NULL THEN 0 ELSE ""c2"".""away_goals"" END)) AS ""goal_for"",((CASE WHEN ""c1"".""away_goals"" IS NULL THEN 0 ELSE ""c1"".""away_goals"" END)+(CASE WHEN ""c2"".""home_goals"" IS NULL THEN 0 ELSE ""c2"".""home_goals"" END)) AS ""goal_against"" FROM (""Teams"" AS ""t"" LEFT JOIN ""cte1"" AS ""c1"" ON ""t"".""team_id""=""c1"".""team_id"") LEFT JOIN ""cte2"" AS ""c2"" ON ""t"".""team_id""=""c2"".""team_id""), ""cte4"" AS (SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte3"") SELECT * FROM ""cte4"" WHERE ""matches_played""!=0 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
95,"SELECT ""team_name"",COUNT(""away_team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""home_team_id"" AS ""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",(""away_team_goals""-""home_team_goals"") AS ""goal_diff"" FROM ""Matches"") AS ""temp"" JOIN ""Teams"" ON ""team_id""=""home_team_id"" GROUP BY ""home_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
96,"WITH ""home"" AS (SELECT ""home_team_id"",COUNT(""home_team_id"") AS ""mp"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"",COUNT(""away_team_id"") AS ""mp"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""away_team_id"") SELECT ""Teams"".""team_name"",SUM(""mp"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""home"" JOIN ""Teams"" ON ""home"".""home_team_id""=""Teams"".""team_id"" GROUP BY ""home_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""Teams"".""team_name"""
97,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ((SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""-""away_team_goals"">0 THEN 3 WHEN ""home_team_goals""-""away_team_goals""<0 THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""home_team_id"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""away_team_goals""-""home_team_goals"">0 THEN 3 WHEN ""away_team_goals""-""home_team_goals""<0 THEN 0 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""away_team_id"")) AS ""m"" JOIN ""Teams"" AS ""t"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""m"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
98,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""b"".""team_name"" AS ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM (""Matches"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id"") JOIN ""Teams"" AS ""c"" ON ""a"".""away_team_id""=""c"".""team_id"" GROUP BY ""team_name"" UNION SELECT ""c"".""team_name"" AS ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals""-""home_team_goals"") AS ""goal_diff"" FROM (""Matches"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id"") JOIN ""Teams"" AS ""c"" ON ""a"".""away_team_id""=""c"".""team_id"" GROUP BY ""team_name"") AS ""t"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
99,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""c"" JOIN ""teams"" AS ""t"" ON ""c"".""id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY 3 DESC,6 DESC,1"
100,"WITH ""t"" AS (SELECT ""t"".""team_name"",""m"".""home_team_goals"" AS ""wingoals"",""m"".""away_team_goals"" AS ""losegoals"",CASE WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 0 END AS ""points"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" UNION ALL SELECT ""t"".""team_name"",""m"".""away_team_goals"" AS ""wingoals"",""m"".""home_team_goals"" AS ""losegoals"",CASE WHEN ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 0 END AS ""points"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""away_team_id"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""wingoals"") AS ""goal_for"",SUM(""losegoals"") AS ""goal_against"",SUM(""wingoals"")-SUM(""losegoals"") AS ""goal_diff"" FROM ""t"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
101,"WITH ""home_table"" AS (SELECT ""team_name"",""home_team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""m"".""home_team_id""=""t"".""team_id""), ""away_table"" AS (SELECT ""team_name"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""m"".""away_team_id""=""t"".""team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""team_name"",""points"",""goals_for"",""goals_against"",""goals_for""-""goals_against"" AS ""goal_diff"" FROM ""home_table"" UNION ALL SELECT ""team_name"",""points"",""goals_for"",""goals_against"",""goals_for""-""goals_against"" AS ""goal_diff"" FROM ""away_table"") AS ""sub"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
102,"WITH ""temp"" AS (SELECT * FROM (SELECT ""home_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""sub"") SELECT ""t"".""team_name"",COUNT(""t"".""team_name"") AS ""matches_played"",SUM(""te"".""points"") AS ""points"",SUM(""te"".""goal_for"") AS ""goal_for"",SUM(""te"".""goal_against"") AS ""goal_against"",(SUM(""te"".""goal_for"")-SUM(""te"".""goal_against"")) AS ""goal_diff"" FROM ""Teams"" AS ""t"" RIGHT JOIN ""temp"" AS ""te"" ON ""t"".""team_id""=""te"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
103,"SELECT ""team_name"",SUM(""match_count"") AS ""matches_played"",SUM(""total"") AS ""points"",SUM(""home_goals"") AS ""goal_for"",SUM(""away_goals"") AS ""goal_against"",SUM(""home_goals"")-SUM(""away_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""match_count"",SUM(""home_team_goals"") AS ""home_goals"",SUM(""away_team_goals"") AS ""away_goals"",SUM(""home_points"") AS ""total"" FROM (SELECT ""home_team_id"",""home_team_goals"",""away_team_goals"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"" FROM ""Matches"") AS ""a"" GROUP BY ""home_team_id"" UNION SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""match_count"",SUM(""away_team_goals"") AS ""home_goals"",SUM(""home_team_goals"") AS ""away_goals"",SUM(""away_points"") AS ""total"" FROM (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Matches"") AS ""b"" GROUP BY ""away_team_id"") AS ""x"" JOIN ""Teams"" AS ""t"" ON ""x"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
104,"WITH ""h"" AS (SELECT ""home_team_id"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY ""home_team_id""), ""a"" AS (SELECT ""away_team_id"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY ""away_team_id"") SELECT ""team_name"",COALESCE(""h"".""matches_played"", 0)+COALESCE(""a"".""matches_played"", 0) AS ""matches_played"",COALESCE(""h"".""points"", 0)+COALESCE(""a"".""points"", 0) AS ""points"",COALESCE(""h"".""goal_for"", 0)+COALESCE(""a"".""goal_for"", 0) AS ""goal_for"",COALESCE(""h"".""goal_against"", 0)+COALESCE(""a"".""goal_against"", 0) AS ""goal_against"",COALESCE(""h"".""goal_for"", 0)+COALESCE(""a"".""goal_for"", 0)-(COALESCE(""h"".""goal_against"", 0)+COALESCE(""a"".""goal_against"", 0)) AS ""goal_diff"" FROM (((SELECT DISTINCT ""home_team_id"" AS ""team_id"" FROM ""h"" UNION SELECT DISTINCT ""away_team_id"" AS ""team_id"" FROM ""a"") AS ""t"" JOIN ""Teams"" AS ""t1"" ON ""t"".""team_id""=""t1"".""team_id"") LEFT JOIN ""h"" ON ""t"".""team_id""=""h"".""home_team_id"") LEFT JOIN ""a"" ON ""t"".""team_id""=""a"".""away_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
105,"SELECT ""t"".""team_name"",""m"".""matches_played"",""m"".""points"",""m"".""goal_for"",""m"".""goal_against"",""m"".""goal_diff"" FROM ""Teams"" AS ""t"" JOIN (SELECT ""team_id"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",SUM(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goals_for"",SUM(""away_team_goals"") AS ""goals_against"",SUM(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goals_for"",SUM(""home_team_goals"") AS ""goals_against"",SUM(""away_team_goals""-""home_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY 1) AS ""tmp"" GROUP BY 1) AS ""m"" ON ""t"".""team_id""=""m"".""team_id"" ORDER BY ""m"".""points"" DESC,""m"".""goal_diff"" DESC,""t"".""team_name"""
106,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"")*3+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"")*3+SUM(""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"")+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"") AS ""points"",SUM((""team_id""=""home_team_id"")*""home_team_goals"")+SUM((""team_id""=""away_team_id"")*""away_team_goals"") AS ""goal_for"",SUM((""team_id""=""home_team_id"")*""away_team_goals"")+SUM((""team_id""=""away_team_id"")*""home_team_goals"") AS ""goal_against"",SUM((""team_id""=""home_team_id"")*(""home_team_goals""-""away_team_goals""))+SUM((""team_id""=""away_team_id"")*(""away_team_goals""-""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
107,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""m"".""home_team_id""=""t"".""team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"")*3+SUM(""m"".""away_team_id""=""t"".""team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"")*3+SUM((""m"".""away_team_id""=""t"".""team_id"" OR ""m"".""home_team_id""=""t"".""team_id"") AND ""m"".""home_team_goals""=""m"".""away_team_goals"") AS ""points"",SUM((""m"".""home_team_id""=""t"".""team_id"")*""m"".""home_team_goals"")+SUM((""m"".""away_team_id""=""t"".""team_id"")*""m"".""away_team_goals"") AS ""goal_for"",SUM((""m"".""home_team_id""=""t"".""team_id"")*""m"".""away_team_goals"")+SUM((""m"".""away_team_id""=""t"".""team_id"")*""m"".""home_team_goals"") AS ""goal_against"",SUM((""m"".""home_team_id""=""t"".""team_id"")*(""m"".""home_team_goals""-""m"".""away_team_goals""))+SUM((""m"".""away_team_id""=""t"".""team_id"")*(""m"".""away_team_goals""-""m"".""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
108,"WITH ""CTE"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(""t"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" AS ""c"" JOIN ""teams"" AS ""t"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
109,"WITH ""t"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""t1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""t"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""t"") SELECT ""b"".""team_name"",COUNT(""b"".""team_name"") AS ""matches_played"",SUM(""a"".""score"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""t1"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""b"".""team_id""=""a"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""b"".""team_name"""
110,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""p"" JOIN ""teams"" ON ""home_team_id""=""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
111,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ((SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""home_team_id"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END) AS ""points"",SUM(-""home_team_goals""+""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""away_team_id"")) AS ""tab"" ON ""t"".""team_id""=""tab"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
112,"WITH ""t1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""home_team_id"" AS ""away_team_id"",""away_team_goals"" AS ""home_team_goals"",""home_team_goals"" AS ""away_team_goals"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""t1"" LEFT JOIN ""Teams"" AS ""t"" ON ""t1"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
113,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
114,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""num_match"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"",COUNT(1) AS ""num_match"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE CASE WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY 1) SELECT ""team_name"",SUM(""num_match"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""cte"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""cte"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
115,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
116,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""score"",""away_team_goals"" AS ""op_goal"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""score"",""home_team_goals"" AS ""op_goal"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(""temp"".""team_id"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""op_goal"") AS ""goal_against"",SUM(""team_goals"")-SUM(""op_goal"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""temp"" ON ""t"".""team_id""=""temp"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
117,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""p1"",""away_team_id"" AS ""p2"",""home_team_goals"" AS ""score"",""away_team_goals"" AS ""lost"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""p1"",""home_team_id"" AS ""p2"",""away_team_goals"" AS ""score"",""home_team_goals"" AS ""lost"" FROM ""matches"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""score"">""lost"" THEN 3 WHEN ""score""<""lost"" THEN 0 ELSE 1 END) AS ""points"",SUM(""score"") AS ""goal_for"",SUM(""lost"") AS ""goal_against"",SUM(""score"")-SUM(""lost"") AS ""goal_diff"" FROM ""temp"" AS ""tp"" JOIN ""teams"" AS ""t"" ON ""tp"".""p1""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
118,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""matches"") AS ""a"" LEFT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
119,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""Matches"") SELECT ""t"".""team_name"",SUM(""c"".""matches_played"") AS ""matches_played"",SUM(""c"".""points"") AS ""points"",SUM(""c"".""goal_for"") AS ""goal_for"",SUM(""c"".""goal_against"") AS ""goal_against"",SUM(""c"".""goal_diff"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
120,"WITH ""score"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""home"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_score"" AS ""gain_score"" FROM ""score"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_score"" AS ""gain_score"" FROM ""score""), ""matches_play"" AS (SELECT ""h"".""team_id"",""team_name"",COUNT(1) AS ""matches_played"" FROM ""home"" AS ""h"" LEFT JOIN ""Teams"" AS ""t"" ON ""h"".""team_id""=""t"".""team_id"" GROUP BY ""team_id""), ""team_points_goal"" AS (SELECT ""team_id"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""gain_score"") AS ""points"" FROM ""home"" GROUP BY 1) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""team_points_goal"" AS ""t"" JOIN ""matches_play"" AS ""m"" ON ""t"".""team_id""=""m"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
121,"WITH ""cte1"" AS (SELECT ""team"",SUM(""matches_played"") AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team"",COUNT(""home_team_id"") AS ""matches_played"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team"",COUNT(""away_team_id"") AS ""matches_played"" FROM ""matches"" GROUP BY 1) AS ""c"" GROUP BY 1), ""cte2"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""team"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""matches"" GROUP BY 1) AS ""c"" GROUP BY 1), ""cte3"" AS (SELECT ""team"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"" FROM ""matches"") AS ""c"" GROUP BY 1) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ((""teams"" JOIN ""cte1"" ON ""teams"".""team_id""=""cte1"".""team"") JOIN ""cte2"" ON ""teams"".""team_id""=""cte2"".""team"") JOIN ""cte3"" ON ""teams"".""team_id""=""cte3"".""team"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
122,"WITH ""cte1"" AS (SELECT ""team"",SUM(""matches_played"") AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team"",COUNT(""home_team_id"") AS ""matches_played"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team"",COUNT(""away_team_id"") AS ""matches_played"" FROM ""matches"" GROUP BY 1) AS ""c"" GROUP BY 1), ""cte2"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""team"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""matches"" GROUP BY 1) AS ""c"" GROUP BY 1), ""cte3"" AS (SELECT ""team"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"" FROM ""matches"") AS ""c"" GROUP BY 1) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ((""teams"" JOIN ""cte1"" ON ""teams"".""team_id""=""cte1"".""team"") JOIN ""cte2"" ON ""teams"".""team_id""=""cte2"".""team"") JOIN ""cte3"" ON ""teams"".""team_id""=""cte3"".""team"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
123,"WITH ""CTE_points"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_team_points"" FROM ""Matches""), ""cte"" AS (SELECT ""id"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""id"",COUNT(1) AS ""matches_played"",SUM(""home_team_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""CTE_points"" GROUP BY ""id"" UNION ALL SELECT ""away_team_id"" AS ""id"",COUNT(1) AS ""matches_played"",SUM(""away_team_points"") AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""CTE_points"" GROUP BY ""id"") AS ""t"" GROUP BY ""id"") SELECT ""t"".""team_name"",""c"".""matches_played"",""c"".""points"",""c"".""goal_for"",""c"".""goal_against"",(""c"".""goal_for""-""c"".""goal_against"") AS ""goal_diff"" FROM ""cte"" AS ""c"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
124,"WITH ""t1"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",""home_team_goals"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_point"",""away_team_goals"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_point"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""t1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_point"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""t1""), ""t3"" AS (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""t2"" GROUP BY 1) SELECT ""T"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""t3"".""goal_for""-""t3"".""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""t3"" ON ""T"".""team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
125,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""t1"" JOIN ""teams"" AS ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
126,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""Matches"") AS ""a"" LEFT JOIN ""Teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
127,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""matches"") AS ""a"" LEFT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
128,"WITH ""MatchesWithScore"" AS (SELECT ""home_team_id"",""away_team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""home_team_points"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""away_team_points"",""home_team_goals"",""away_team_goals"" FROM ""Matches""), ""HomeTeamScore"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(1) AS ""matches_played"",SUM(""home_team_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""MatchesWithScore"" GROUP BY ""home_team_id""), ""AwayTeamScore"" AS (SELECT ""away_team_id"" AS ""team_id"",SUM(1) AS ""matches_played"",SUM(""away_team_points"") AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""MatchesWithScore"" GROUP BY ""away_team_id""), ""UnionTables"" AS (SELECT * FROM ""HomeTeamScore"" UNION ALL SELECT * FROM ""AwayTeamScore""), ""UnionGroupedTable"" AS (SELECT ""team_id"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""UnionTables"" GROUP BY ""team_id""), ""FinalTable"" AS (SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""UnionGroupedTable"" AS ""U"" JOIN ""Teams"" AS ""T"" ON ""U"".""team_id""=""T"".""team_id"") SELECT * FROM ""FinalTable"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
129,"SELECT ""team_name"",COALESCE(SUM(""matches_played""), 0) AS ""matches_played"",COALESCE(SUM(""points""), 0) AS ""points"",COALESCE(SUM(""goal_for""), 0) AS ""goal_for"",COALESCE(SUM(""goal_against""), 0) AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""Teams"" JOIN (SELECT ""home_team_id"" AS ""team_id"",COUNT(""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""away_team_id"") AS ""temp"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
130,"WITH ""getResult"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1) SELECT ""Teams"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""getResult"" JOIN ""Teams"" ON ""getResult"".""team_id""=""Teams"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
131,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END) AS ""away_points"" FROM ""Matches"") SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""id"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_points"") AS ""points"" FROM ""cte"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""id"",COUNT(""away_team_id"") AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_points"") AS ""points"" FROM ""cte"" GROUP BY ""away_team_id"") AS ""sub"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""sub"".""id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
132,"WITH ""t1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""op_goals"",""home_points"" AS ""points"" FROM ""t1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",""away_points"" FROM ""t1""), ""t3"" AS (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""t2"".""points"") AS ""points"",SUM(""t2"".""goals"") AS ""goal_for"",SUM(""t2"".""op_goals"") AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""t2"" USING (""team_id"") GROUP BY ""team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""t3"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
133,"WITH ""totalpoints"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"",COUNT(""team_id"") AS ""matches_played"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""A"" GROUP BY ""team_id"") SELECT ""teams"".""team_name"",""tp"".""matches_played"",""tp"".""points"",""tp"".""goal_for"",""tp"".""goal_against"",""tp"".""goal_for""-""tp"".""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""teams"" JOIN ""totalpoints"" AS ""tp"" ON ""teams"".""team_id""=""tp"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
134,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
135,"WITH ""cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_team_point"" FROM ""matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""firstteam"",""away_team_id"" AS ""secondteam"",""home_team_goals"" AS ""firstteamgoals"",""away_team_goals"" AS ""secondteamgoals"",""home_team_point"" AS ""firstteampoint"",""away_team_point"" AS ""secondteampoint"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""firstteam"",""home_team_id"" AS ""secondteam"",""away_team_goals"" AS ""firstteamgoals"",""home_team_goals"" AS ""secondteamgoals"",""away_team_point"" AS ""firstteampoint"",""home_team_point"" AS ""secondteampoint"" FROM ""cte"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(COALESCE(""firstteam"", 0)) AS ""matches_played"",SUM(COALESCE(""firstteampoint"", 0)) AS ""points"",SUM(COALESCE(""firstteamgoals"", 1)) AS ""goal_for"",SUM(COALESCE(""secondteamgoals"", 0)) AS ""goal_against"",SUM(COALESCE(""firstteamgoals"", 0))-SUM(COALESCE(""secondteamgoals"", 0)) AS ""goal_diff"" FROM ""cte2"" JOIN ""Teams"" AS ""t"" ON ""cte2"".""firstteam""=""t"".""team_id"" GROUP BY ""firstteam"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
136,"WITH ""temp"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",COUNT(""team_id"") AS ""matches_played"" FROM ((SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"")) AS ""t"" GROUP BY ""t"".""team_id"") SELECT ""t1"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""teams"" AS ""t1"" JOIN ""temp"" ON ""t1"".""team_id""=""temp"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
137,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""p1"",""home_team_goals"" AS ""score"",""away_team_goals"" AS ""lost"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""p1"",""away_team_goals"" AS ""score"",""home_team_goals"" AS ""lost"" FROM ""matches"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""score"">""lost"" THEN 3 WHEN ""score""<""lost"" THEN 0 ELSE 1 END) AS ""points"",SUM(""score"") AS ""goal_for"",SUM(""lost"") AS ""goal_against"",SUM(""score"")-SUM(""lost"") AS ""goal_diff"" FROM ""temp"" AS ""tp"" JOIN ""teams"" AS ""t"" ON ""tp"".""p1""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
138,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN (SELECT 'home' AS ""type"",""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT 'away' AS ""type"",""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") AS ""m"" ON ""t"".""team_id""=""m"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
139,"WITH ""result_base"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"") SELECT ""b"".""team_name"",COUNT(""a"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM (""result_base"" AS ""a"") JOIN ""teams"" AS ""b"" WHERE ""a"".""team_id""=""b"".""team_id"" GROUP BY ""a"".""team_id"" ORDER BY ""points"" DESC,(SUM(""goals"")-SUM(""against"")) DESC,""team_name"""
140,"WITH ""A1"" AS (SELECT ""Teams"".""team_id"",""Teams"".""team_name"",""A"".""scoreFor"",""A"".""scoreAga"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""scoreFor"",""away_team_goals"" AS ""scoreAga"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""scoreFor"",""home_team_goals"" AS ""scoreAga"" FROM ""Matches"") AS ""A"" JOIN ""Teams"" ON ""A"".""team_id""=""Teams"".""team_id"") SELECT ""team_name"" AS ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""scoreFor"">""scoreAga"" THEN 3 WHEN ""scoreFor""=""scoreAga"" THEN 1 ELSE 0 END) AS ""points"",SUM(""scorefor"") AS ""goal_for"",SUM(""scoreAga"") AS ""goal_against"",SUM(""scorefor""-""scoreAga"") AS ""goal_diff"" FROM ""A1"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
141,"WITH ""result"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""home_team_score"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""away_team_score"" FROM ""matches"") SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""team_score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_score"") AS ""team_score"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",COUNT(""home_team_id"") AS ""matches_played"" FROM ""result"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_score"") AS ""team_score"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",COUNT(""away_team_id"") AS ""matches_played"" FROM ""result"" GROUP BY 1) AS ""B"" JOIN ""teams"" ON ""teams"".""team_id""=""B"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
142,"WITH ""CTE1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_team_point"" FROM ""matches""), ""CTE2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""h_goals"",""home_team_point"" AS ""points"",""away_team_goals"" AS ""a_goals"" FROM ""CTE1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""h_goals"",""away_team_point"" AS ""points"",""home_team_goals"" AS ""a_goals"" FROM ""CTE1"") SELECT ""t"".""team_name"",COUNT(""c"".""team_id"") AS ""matches_played"",SUM(""c"".""points"") AS ""points"",SUM(""c"".""h_goals"") AS ""goal_for"",SUM(""c"".""a_goals"") AS ""goal_against"",SUM(""c"".""h_goals"")-SUM(""c"".""a_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""CTE2"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
143,"WITH ""mp"" AS (SELECT ""team_id"",SUM(""matches_played"") AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"" FROM ""matches"" GROUP BY 1) AS ""a"" GROUP BY 1), ""p"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""away_points"" FROM ""matches""), ""p1"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_points"") AS ""points"" FROM ""p"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(""away_points"") AS ""points"" FROM ""p"" GROUP BY 1) AS ""a"" GROUP BY 1), ""gf"" AS (SELECT ""team_id"",SUM(""goal_for"") AS ""goal_for"" FROM (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""goal_for"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""goal_for"" FROM ""matches"" GROUP BY 1) AS ""a"" GROUP BY 1), ""ga"" AS (SELECT ""team_id"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY 1) AS ""a"" GROUP BY 1) SELECT ""a"".""team_name"",""b"".""matches_played"",""c"".""points"",""d"".""goal_for"",""e"".""goal_against"",""d"".""goal_for""-""e"".""goal_against"" AS ""goal_diff"" FROM (((""Teams"" AS ""a"" JOIN ""mp"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"") JOIN ""p1"" AS ""c"" ON ""a"".""team_id""=""c"".""team_id"") JOIN ""gf"" AS ""d"" ON ""a"".""team_id""=""d"".""team_id"") JOIN ""ga"" AS ""e"" ON ""a"".""team_id""=""e"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
144,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
145,"WITH ""normalized_goal"" AS (SELECT ""m"".""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" AS ""m"" UNION ALL SELECT ""m"".""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"" AS ""m"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""a"".""points"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""normalized_goal"" AS ""a"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
146,"WITH ""team_match"" AS (SELECT ""team_id"",COUNT(1) AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team_id"",""away_team_id"" AS ""match_id"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""tem_id"",""home_team_id"" AS ""match_id"" FROM ""matches"") AS ""m"" GROUP BY ""team_id""), ""goals"" AS (SELECT ""team_id"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") AS ""m"" GROUP BY ""team_id""), ""points"" AS (SELECT ""p"".""team_id"",SUM(""p"".""points"") AS ""points"" FROM (SELECT ""tie"".""team_id"",1 AS ""points"" FROM (SELECT ""home_team_id"" AS ""team_id"" FROM (SELECT ""home_team_id"",""away_team_id"" FROM ""matches"" WHERE ""home_team_goals""=""away_team_goals"") AS ""t1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"" FROM (SELECT ""home_team_id"",""away_team_id"" FROM ""matches"" WHERE ""home_team_goals""=""away_team_goals"") AS ""t2"") AS ""tie"" UNION ALL SELECT ""home_team_id"" AS ""team_id"",3 AS ""points"" FROM ""matches"" WHERE ""home_team_goals"">""away_team_goals"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",3 AS ""points"" FROM ""matches"" WHERE ""away_team_goals"">""home_team_goals"") AS ""p"" GROUP BY ""p"".""team_id"") SELECT ""t"".""team_name"",COALESCE(""tm"".""matches_played"", 0) AS ""matches_played"",COALESCE(""p"".""points"", 0) AS ""points"",COALESCE(""g"".""goal_for"", 0) AS ""goal_for"",COALESCE(""g"".""goal_against"", 0) AS ""goal_against"",COALESCE(""goal_for""-""goal_against"", 0) AS ""goal_diff"" FROM ((""team_match"" AS ""tm"" LEFT JOIN ""points"" AS ""p"" ON ""tm"".""team_id""=""p"".""team_id"") LEFT JOIN ""goals"" AS ""g"" ON ""tm"".""team_id""=""g"".""team_id"") LEFT JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""tm"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
147,"SELECT ""team_name"",COUNT(""points"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goals"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""t"" JOIN ""Teams"" ON ""teams"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
148,"SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""hgoals"">""agoals"" THEN 3 WHEN ""hgoals""<""agoals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""hgoals"") AS ""goal_for"",SUM(""agoals"") AS ""goal_against"",SUM(""hgoals""-""agoals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""hgoals"",""away_team_goals"" AS ""agoals"" FROM ""Matches"" AS ""MH"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""hgoals"",""home_team_goals"" AS ""agoals"" FROM ""Matches"" AS ""MA"") AS ""A"" JOIN ""Teams"" AS ""T"" ON ""T"".""team_id""=""A"".""id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
149,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""a"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
150,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""t1"" JOIN ""Teams"" AS ""t2"" ON ""t1"".""id""=""t2"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
151,"WITH ""matches_statistics"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""matches_statistics"" AS ""m"" JOIN ""teams"" AS ""t"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""m"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
152,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
153,"SELECT ""team_name"",SUM(CASE WHEN ""home_team_id""=""team_id"" OR ""away_team_id""=""team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""home_team_goals"" WHEN ""away_team_id""=""team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""home_team_goals""-""away_team_goals"" ELSE ""away_team_goals""-""home_team_goals"" END) AS ""goal_diff"" FROM ""matches"" AS ""m"" JOIN ""teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" OR ""m"".""away_team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
154,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""num_points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""num_points"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""t2"".""num_points"") AS ""points"",SUM(""t2"".""goals_for"") AS ""goal_for"",SUM(""t2"".""goals_against"") AS ""goal_against"",SUM(""t2"".""goals_for"")-SUM(""t2"".""goals_against"") AS ""goal_diff"" FROM (""teams"" AS ""t"") JOIN ""temp"" AS ""t2"" WHERE ""t"".""team_id""=""t2"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY 3 DESC,6 DESC,1"
155,"SELECT ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_Team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_Team_Goals""=""away_Team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_Goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_Team_id"" THEN ""away_Team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_Team_Goals"" WHEN ""team_id""=""away_Team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_Team_id"" THEN ""away_Team_goals"" ELSE 0 END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_Team_Goals"" WHEN ""team_id""=""away_Team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""away_Team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
156,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
157,"WITH ""stacked"" AS (SELECT ""home_team_id"" AS ""t1"",""away_team_id"" AS ""t2"",""home_team_goals"" AS ""t1goals"",""away_team_goals"" AS ""t2goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""t1"",""home_team_id"" AS ""t2"",""away_team_goals"" AS ""t1goals"",""home_team_goals"" AS ""t1goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""t1goals"">""t2goals"" THEN 3 WHEN ""t2goals""=""t1goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""t1goals"") AS ""goal_for"",SUM(""t2goals"") AS ""goal_against"",SUM(""t1goals"")-SUM(""t2goals"") AS ""goal_diff"" FROM ""stacked"" AS ""s"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""s"".""t1"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
158,"SELECT ""team_name"",SUM(""X"".""f"") AS ""matches_played"",SUM(""X"".""b"") AS ""points"",SUM(""X"".""c"") AS ""goal_for"",SUM(""x"".""d"") AS ""goal_against"",SUM(""X"".""e"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""a"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END) AS ""b"",SUM(""home_team_goals"") AS ""c"",SUM(""away_team_goals"") AS ""d"",(SUM(""home_team_goals"")-SUM(""away_team_goals"")) AS ""e"",COUNT(""home_team_id"") AS ""f"" FROM ""Matches"" AS ""m"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""a"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 END) AS ""b"",SUM(""away_team_goals"") AS ""c"",SUM(""home_team_goals"") AS ""d"",(SUM(""away_team_goals"")-SUM(""home_team_goals"")) AS ""e"",COUNT(""away_team_id"") AS ""f"" FROM ""Matches"" AS ""m1"" GROUP BY ""away_team_id"") AS ""X"" JOIN ""Teams"" ON ""X"".""a""=""Teams"".""team_id"" GROUP BY ""X"".""a"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
159,"WITH ""cte"" AS (SELECT ""t"".""team_name"",COUNT(DISTINCT ""m"".""home_team_id"", ""m"".""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""m"".""home_team_id""=""t"".""team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_id""=""t"".""team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""away_team_id""=""t"".""team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""away_team_id""=""t"".""team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1) SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""cte"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
160,"WITH ""raw_data"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",(""away_team_goals""-""home_team_goals"") AS ""goal_diff"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(""rd"".""team_id"") AS ""matches_played"",SUM(""rd"".""points"") AS ""points"",SUM(""rd"".""goal_for"") AS ""goal_for"",SUM(""rd"".""goal_against"") AS ""goal_against"",SUM(""rd"".""goal_for""-""rd"".""goal_against"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""raw_data"" AS ""rd"" ON ""t"".""team_id""=""rd"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
161,"SELECT ""team_name"",SUM(""a"".""team_id""=""b"".""home_team_id"")+SUM(""a"".""team_id""=""b"".""away_team_id"") AS ""matches_played"",3*SUM(""a"".""team_id""=""b"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"")+3*SUM(""a"".""team_id""=""b"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"")+SUM(""a"".""team_id""=""b"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"")+SUM(""a"".""team_id""=""b"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"") AS ""points"",SUM((""a"".""team_id""=""b"".""home_team_id"")*""home_team_goals"")+SUM((""a"".""team_id""=""b"".""away_team_id"")*""away_team_goals"") AS ""goal_for"",SUM((""a"".""team_id""=""b"".""home_team_id"")*""away_team_goals"")+SUM((""a"".""team_id""=""b"".""away_team_id"")*""home_team_goals"") AS ""goal_against"",SUM((""a"".""team_id""=""b"".""home_team_id"")*(""home_team_goals""-""away_team_goals""))+SUM((""a"".""team_id""=""b"".""away_team_id"")*(""away_team_goals""-""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" AS ""a"" JOIN ""Matches"" AS ""b"" ON ""a"".""team_id""=""b"".""home_team_id"" OR ""a"".""team_id""=""b"".""away_team_id"" GROUP BY ""a"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
162,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Teams"" AS ""m"" JOIN ""Matches"" AS ""r"" ON ""m"".""team_id""=""r"".""home_team_id"" GROUP BY ""team_name"" UNION ALL SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Teams"" AS ""m"" JOIN ""Matches"" AS ""r"" ON ""m"".""team_id""=""r"".""away_team_id"" GROUP BY ""team_name"") AS ""temp"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
163,"WITH ""matches_summary"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",1 AS ""matches"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",1 AS ""matches"" FROM ""matches"") SELECT ""t1"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""teams"" AS ""t1"" RIGHT JOIN (SELECT ""team_id"",SUM(""matches"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against_goals"") AS ""goal_against"" FROM ""matches_summary"" GROUP BY ""team_id"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
164,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
165,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END) AS ""goal_against"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END)) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
166,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""a"">""b"" THEN 3 WHEN ""a""=""b"" THEN 1 ELSE 0 END) AS ""points"",SUM(""a"") AS ""goal_for"",SUM(""b"") AS ""goal_against"",SUM(""a"")-SUM(""b"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""a"",""away_team_goals"" AS ""b"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""a"",""home_team_goals"" AS ""b"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
167,"WITH ""home_away_teams"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"" FROM ""matches"" GROUP BY 1) SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""home_away_teams"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
168,"WITH ""t"" AS (SELECT ""home_team_id"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" FROM ""matches""), ""matches_played"" AS (SELECT ""home_team_id"" AS ""team"",COUNT(1) AS ""matches_played"" FROM ""t"" GROUP BY ""home_team_id""), ""t2"" AS (SELECT ""home_team_id"" AS ""team"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches""), ""points"" AS (SELECT ""team"",SUM(""points"") AS ""points"" FROM ""t2"" GROUP BY ""team""), ""t3"" AS (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goals"" FROM ""matches""), ""goals_for"" AS (SELECT ""team"",SUM(""goals"") AS ""goals_for"" FROM ""t3"" GROUP BY ""team""), ""t4"" AS (SELECT ""home_team_id"" AS ""team"",""away_team_goals"" AS ""goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""home_team_goals"" AS ""goals"" FROM ""matches""), ""goals_against"" AS (SELECT ""team"",SUM(""goals"") AS ""goals_against"" FROM ""t4"" GROUP BY ""team""), ""goal_diff"" AS (SELECT ""a"".""team"",""a"".""goals_for""-""b"".""goals_against"" AS ""goal_diff"" FROM ""goals_for"" AS ""a"" JOIN ""goals_against"" AS ""b"" ON ""a"".""team""=""b"".""team"") SELECT ""teams"".""team_name"",""matches_played"",""points"",""goals_for"" AS ""goal_for"",""goals_against"" AS ""goal_against"",""goal_diff"" FROM ((((""matches_played"" JOIN ""points"" ON ""matches_played"".""team""=""points"".""team"") JOIN ""goals_for"" ON ""goals_for"".""team""=""matches_played"".""team"") JOIN ""goals_against"" ON ""goals_against"".""team""=""matches_played"".""team"") JOIN ""goal_diff"" ON ""goal_diff"".""team""=""matches_played"".""team"") JOIN ""teams"" ON ""teams"".""team_id""=""matches_played"".""team"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
169,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""scored_for"",""away_team_goals"" AS ""scored_agnst"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""scored_for"",""home_team_goals"" AS ""scored_agnst"" FROM ""Matches""), ""cte2"" AS (SELECT ""team_name"",""t"".""team_id"",""scored_for"",""scored_agnst"" FROM ""cte"" JOIN ""Teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"") SELECT ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""scored_for"">""scored_agnst"" THEN 3 WHEN ""scored_for""=""scored_agnst"" THEN 1 ELSE 0 END) AS ""points"",SUM(""scored_for"") AS ""goal_for"",SUM(""scored_agnst"") AS ""goal_against"",SUM(""scored_for"")-SUM(""scored_agnst"") AS ""goal_diff"" FROM ""cte2"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
170,"WITH ""points"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_point"" FROM ""Matches""), ""unioned"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""gf"",""home_team_point"" AS ""pt"",""away_team_goals"" AS ""ga"" FROM ""points"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""gf"",""away_team_point"" AS ""pt"",""home_team_goals"" AS ""ga"" FROM ""points"") SELECT ""t1"".""team_name"",""t2"".""matches_played"",""t2"".""points"",""t2"".""goal_for"",""t2"".""goal_against"",""t2"".""goal_diff"" FROM ""Teams"" AS ""t1"" JOIN (SELECT ""id"",COUNT(1) AS ""matches_played"",SUM(""pt"") AS ""points"",SUM(""gf"") AS ""goal_for"",SUM(""ga"") AS ""goal_against"",SUM(""gf"")-SUM(""ga"") AS ""goal_diff"" FROM ""unioned"" GROUP BY ""id"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""id"" ORDER BY ""t2"".""points"" DESC,""t2"".""goal_diff"" DESC,""t1"".""team_name"""
171,"WITH ""cte"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""home_team_id"" AS ""away_team_id"",""away_team_goals"" AS ""home_team_goals"",""home_team_goals"" AS ""away_team_goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""cte"" LEFT JOIN ""Teams"" ON ""cte"".""home_team_id""=""Teams"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
172,"WITH ""tmp"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_againt"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_againt"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""points"" FROM ""Matches""), ""tmp2"" AS (SELECT ""team_id"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_againt"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_againt"") AS ""goal_diff"" FROM ""tmp"" GROUP BY ""team_id"") SELECT ""Teams"".""team_name"",""tmp2"".""matches_played"",""tmp2"".""points"",""tmp2"".""goal_for"",""tmp2"".""goal_against"",""tmp2"".""goal_diff"" FROM ""tmp2"" LEFT JOIN ""Teams"" ON ""tmp2"".""team_id""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
173,"WITH ""CTE1"" AS (SELECT ""t"".""team_name"",""m"".""home_team_id"" AS ""team_id"",""m"".""home_team_goals"" AS ""goals"",(CASE WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""away_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_name"",""m"".""away_team_id"" AS ""team_id"",""m"".""away_team_goals"" AS ""goals"",(CASE WHEN ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 WHEN ""m"".""away_team_goals""<""m"".""home_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""home_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""away_team_id""=""t"".""team_id"") SELECT ""c"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goals"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""CTE1"" AS ""c"" GROUP BY ""c"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
174,"WITH ""T"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_score"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_score"" FROM ""Matches""), ""T2"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_score"" AS ""points"" FROM ""T"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_score"" AS ""points"" FROM ""T""), ""T3"" AS (SELECT ""id"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""T2"" GROUP BY ""id"") SELECT ""team_name"",""T3"".""matches_played"",""T3"".""points"",""T3"".""goal_for"",""T3"".""goal_against"",""T3"".""goal_diff"" FROM ""T3"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""T3"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
175,"WITH ""home"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""against"" AS (SELECT *,CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") SELECT ""team_name"",SUM(""matches"") AS ""matches_played"",SUM(""point"") AS ""points"",SUM(""goal"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",SUM(""goal"")-SUM(""against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches"",SUM(""points"") AS ""point"",SUM(""home_team_goals"") AS ""goal"",SUM(""away_team_goals"") AS ""against"" FROM ""home"" GROUP BY ""home_team_id"" UNION (SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches"",SUM(""points"") AS ""point"",SUM(""away_team_goals"") AS ""goal"",SUM(""home_team_goals"") AS ""against"" FROM ""against"" GROUP BY ""away_team_id"")) AS ""t"" JOIN ""Teams"" ON ""t"".""team_id""=""Teams"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
176,"WITH ""breakdown"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""opponent_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""home_team_goals"" AS ""opponent_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""opponent_goals"") AS ""goal_against"",SUM(""team_goals"")-SUM(""opponent_goals"") AS ""goal_diff"" FROM ""breakdown"" LEFT JOIN ""Teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
177,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_for"",CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""away_team_id"") AS ""tb"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
178,"WITH ""temp"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_team_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""away_team_points"" FROM ""Matches""), ""temp2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_points"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_points"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""temp"") SELECT ""team_name"",COUNT(""temp2"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""temp2"" JOIN ""teams"" ON ""temp2"".""team_id""=""teams"".""team_id"" GROUP BY ""temp2"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
179,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""c"".""goal_for"">""c"".""goal_against"" THEN 3 WHEN ""c"".""goal_for""=""c"".""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""c"".""goal_for"") AS ""goal_for"",SUM(""c"".""goal_against"") AS ""goal_against"",SUM(""c"".""goal_for""-""c"".""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
180,"WITH ""CTE1"" AS (SELECT ""t"".""team_name"",""m"".""home_team_id"" AS ""team_id"",""m"".""home_team_goals"" AS ""goals"",(CASE WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""away_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_name"",""m"".""away_team_id"" AS ""team_id"",""m"".""away_team_goals"" AS ""goals"",(CASE WHEN ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 WHEN ""m"".""away_team_goals""<""m"".""home_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""home_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""away_team_id""=""t"".""team_id"") SELECT ""c"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goals"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""CTE1"" AS ""c"" GROUP BY ""c"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
181,"WITH ""cte"" AS (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""team_id"") SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
182,"WITH ""cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""cte"") SELECT ""b"".""team_name"",COUNT(""b"".""team_name"") AS ""matches_played"",SUM(""a"".""score"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""cte2"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""b"".""team_id""=""a"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""b"".""team_name"""
183,"SELECT ""team_name"",COUNT(""all_teams"".""team_id"") AS ""matches_played"",SUM(""points_got"") AS ""points"",SUM(""goals_by"") AS ""goal_for"",SUM(""goals_away"") AS ""goal_against"",SUM(""goals_d"") AS ""goal_diff"" FROM ((SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_by"",""away_team_goals"" AS ""goals_away"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points_got"",""home_team_goals""-""away_team_goals"" AS ""goals_d"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_by"",""home_team_goals"" AS ""goals_away"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points_got"",""away_team_goals""-""home_team_goals"" AS ""goals_d"" FROM ""Matches"")) AS ""all_teams"" JOIN ""Teams"" AS ""t"" ON ""all_teams"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
184,"SELECT ""T"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""home_team_id"",""away_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""M"" JOIN ""Teams"" ON (""team_id"" IN (""home_team_id"",""away_team_id"")) GROUP BY ""team_id"") AS ""T"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
185,"WITH ""teams_id"" AS (SELECT ""home_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") SELECT ""t2"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""teams_id"" AS ""t1"" JOIN ""teams"" AS ""t2"" ON ""t1"".""id""=""t2"".""team_id"" GROUP BY ""t1"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
186,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
187,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_diff"" FROM ""teams"" JOIN ""matches"" ON ""teams"".""team_id""=""matches"".""home_team_id"" OR ""teams"".""team_id""=""matches"".""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
188,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""temp"".""goal_a"">""temp"".""goal_b"" THEN 3 WHEN ""temp"".""goal_a""=""temp"".""goal_b"" THEN 1 ELSE 0 END) AS ""points"",SUM(""temp"".""goal_a"") AS ""goal_for"",SUM(""temp"".""goal_b"") AS ""goal_against"",(SUM(""temp"".""goal_a"")-SUM(""temp"".""goal_b"")) AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_a"",""away_team_id"" AS ""team_b"",""home_team_goals"" AS ""goal_a"",""away_team_goals"" AS ""goal_b"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_a"",""home_team_id"" AS ""team_b"",""away_team_goals"" AS ""goal_a"",""home_team_goals"" AS ""goal_b"" FROM ""Matches"") AS ""temp"" JOIN ""Teams"" AS ""t"" ON ""temp"".""team_a""=""t"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
189,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_name"") AS ""a"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
190,"WITH ""report"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goal"",""away_team_goals"" AS ""oppo_goal"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m2"") SELECT ""team_name"",COUNT(""r"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goal"") AS ""goal_for"",SUM(""oppo_goal"") AS ""goal_against"",(SUM(""team_goal"")-SUM(""oppo_goal"")) AS ""goal_diff"" FROM ""report"" AS ""r"" JOIN ""Teams"" AS ""t"" ON ""r"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,(SUM(""team_goal"")-SUM(""oppo_goal"")) DESC,""team_name"""
191,"SELECT ""temp"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""home_team_id"",""away_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""team_id"") AS ""temp"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
192,"SELECT ""team_name"",COUNT(""a"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""score_for"">""score_against"" THEN 3 WHEN ""score_for""<""score_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""score_for"") AS ""goal_for"",SUM(""score_against"") AS ""goal_against"",SUM(""score_for""-""score_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""score_for"",""away_team_goals"" AS ""score_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""score_for"",""home_team_goals"" AS ""score_against"" FROM ""Matches"") AS ""a"" JOIN ""teams"" AS ""t"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""TEAM_NAME"""
193,"WITH ""cte"" AS (SELECT ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""team_id"") SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
194,"SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END AS ""points"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_for"",CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") AS ""a"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
195,"SELECT ""a"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""t"" JOIN ""Teams"" AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY ""a"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""a"".""team_name"""
196,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""CTE"" JOIN ""TEAMS"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
197,"SELECT ""U"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""U"".""points"") AS ""points"",SUM(""U"".""goal_for"") AS ""goal_for"",SUM(""U"".""goal_against"") AS ""goal_against"",SUM(""U"".""goal_for""-""U"".""goal_against"") AS ""goal_diff"" FROM (SELECT ""T"".""team_name"",CASE WHEN ""M"".""home_team_goals"">""M"".""away_team_goals"" THEN 3 ELSE (CASE WHEN ""M"".""home_team_goals""=""M"".""away_team_goals"" THEN 1 ELSE 0 END) END AS ""points"",""M"".""home_team_goals"" AS ""goal_for"",""M"".""away_team_goals"" AS ""goal_against"" FROM ""Teams"" AS ""T"" JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""home_team_id"" UNION ALL SELECT ""T"".""team_name"",CASE WHEN ""M"".""away_team_goals"">""M"".""home_team_goals"" THEN 3 ELSE (CASE WHEN ""M"".""away_team_goals""=""M"".""home_team_goals"" THEN 1 ELSE 0 END) END AS ""points"",""M"".""away_team_goals"" AS ""goal_for"",""M"".""home_team_goals"" AS ""goal_against"" FROM ""Teams"" AS ""T"" JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""away_team_id"") AS ""U"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
198,"WITH ""getResult"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1) SELECT ""Teams"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""getResult"" JOIN ""Teams"" ON ""getResult"".""team_id""=""Teams"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
199,"SELECT ""temp"".*,(""temp"".""goal_for""-""temp"".""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_id""=""team_id"" AND ""home_team_goals"">""away_Team_goals"" THEN 3 WHEN ""home_team_id""=""team_id"" AND ""home_team_goals""<""away_Team_goals"" THEN 0 WHEN ""away_team_id""=""team_id"" AND ""home_team_goals"">""away_Team_Goals"" THEN 0 WHEN ""away_Team_id""=""team_id"" AND ""home_Team_goals""<""away_Team_Goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""home_Team_goals"" WHEN ""away_Team_id""=""team_id"" THEN ""away_Team_Goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""away_Team_goals"" WHEN ""away_Team_id""=""team_id"" THEN ""home_Team_Goals"" ELSE 0 END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""team_id"") AS ""temp"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
200,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
201,"WITH ""temp"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END END AS ""home_team_points"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END END AS ""away_team_points"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""oppo_goals"") AS ""goal_against"",(SUM(""goals"")-SUM(""oppo_goals"")) AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""oppo_goals"",""home_team_points"" AS ""points"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""oppo_goals"",""away_team_points"" AS ""points"" FROM ""temp"") AS ""m"" JOIN ""teams"" AS ""t"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"",""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
202,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
203,"WITH ""tbP"" AS (SELECT ""t"".""team_name"",(CASE WHEN ((""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"")) THEN 3 WHEN ((""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"")) THEN 1 ELSE 0 END) AS ""points"",(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END) AS ""goals_for"",(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END) AS ""goals_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",(SUM(""goals_for"")-SUM(""goals_against"")) AS ""goal_diff"" FROM ""tbP"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
204,"WITH ""match_scores"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""home_team_score"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""away_team_score"" FROM ""Matches"") SELECT ""a"".""team_name"",(COUNT(1)) AS ""matches_played"",SUM(""a"".""score"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",(SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"")) AS ""goal_diff"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_score"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_score"" ELSE 0 END AS ""score"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END AS ""goal_for"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""match_scores"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") AS ""a"" GROUP BY ""a"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""a"".""team_name"""
205,"WITH ""getResult"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""points"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1) SELECT ""Teams"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""getResult"" JOIN ""Teams"" ON ""getResult"".""team_id""=""Teams"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
206,"WITH ""A1"" AS (SELECT ""Teams"".""team_id"",""Teams"".""team_name"",""A"".""scoreFor"",""A"".""scoreAga"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""scoreFor"",""away_team_goals"" AS ""scoreAga"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""scoreFor"",""home_team_goals"" AS ""scoreAga"" FROM ""Matches"") AS ""A"" JOIN ""Teams"" ON ""A"".""team_id""=""Teams"".""team_id"") SELECT ""team_name"" AS ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""scoreFor"">""scoreAga"" THEN 3 WHEN ""scoreFor""=""scoreAga"" THEN 1 ELSE 0 END) AS ""points"",SUM(""scorefor"") AS ""goal_for"",SUM(""scoreAga"") AS ""goal_against"",SUM(""scorefor""-""scoreAga"") AS ""goal_diff"" FROM ""A1"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
207,"SELECT ""team_name"",SUM(""matched_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""team_name"",COUNT(1) AS ""matched_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" GROUP BY 1 UNION SELECT ""away_team_id"" AS ""team_id"",""team_name"",COUNT(1) AS ""matched_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""m"".""away_team_id""=""t"".""team_id"" GROUP BY 1) AS ""tmp"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
208,"WITH ""base"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""matches""), ""unioned"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",""home_score"" AS ""points"" FROM ""base"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"",""away_score"" AS ""points"" FROM ""base"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"" FROM ""unioned"" AS ""u"" JOIN ""teams"" AS ""t"" ON ""u"".""team_id""=""t"".""team_id"" GROUP BY ""u"".""team_id"") AS ""sub"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
209,"WITH ""cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_points"" FROM ""matches""), ""allteam"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""against_goals"",""home_team_points"" AS ""team_points"" FROM ""cte"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",""away_team_points"" FROM ""cte"") SELECT ""team_name"",COUNT(""allteam"".""team_id"") AS ""matches_played"",SUM(""team_points"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""against_goals"") AS ""goal_against"",SUM(""team_goals"")-SUM(""against_goals"") AS ""goal_diff"" FROM ""allteam"" JOIN ""teams"" ON ""allteam"".""team_id""=""teams"".""team_id"" GROUP BY ""allteam"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
210,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
211,"SELECT (SELECT ""team_name"" FROM ""Teams"" WHERE ""team_id""=""A"".""team_id"") AS ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ((SELECT ""home_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END) AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",(""away_team_goals""-""home_team_goals"") AS ""goal_diff"" FROM ""Matches"")) AS ""A"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
212,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""Matches"") SELECT ""t"".""team_name"",SUM(""c"".""matches_played"") AS ""matches_played"",SUM(""c"".""points"") AS ""points"",SUM(""c"".""goal_for"") AS ""goal_for"",SUM(""c"".""goal_against"") AS ""goal_against"",SUM(""c"".""goal_diff"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""cte"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
213,"WITH ""A"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""A"" AS ""a"" ON ""t"".""team_id""=""a"".""id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
214,"WITH ""t"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""t"" JOIN ""Teams"" AS ""te"" ON ""t"".""id""=""te"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
215,"SELECT ""t1"".*,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""matches"" JOIN ""teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
216,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
217,"WITH ""report"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goal"",""away_team_goals"" AS ""oppo_goal"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m2"") SELECT ""team_name"",COUNT(""r"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goal"") AS ""goal_for"",SUM(""oppo_goal"") AS ""goal_against"",(SUM(""team_goal"")-SUM(""oppo_goal"")) AS ""goal_diff"" FROM ""report"" AS ""r"" JOIN ""Teams"" AS ""t"" ON ""r"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,(SUM(""team_goal"")-SUM(""oppo_goal"")) DESC,""team_name"""
218,"WITH ""temp1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""oppo_goals"") AS ""goal_against"",SUM(""goals"")-SUM(""oppo_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""oppo_goals"",""home_points"" AS ""points"" FROM ""temp1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""oppo_goals"",""away_points"" AS ""points"" FROM ""temp1"") AS ""t1"" JOIN ""teams"" AS ""t"" ON ""t1"".""team_id""=""t"".""team_id"" GROUP BY ""t1"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
219,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_goals"") AS ""goals_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",COUNT(""home_team_id"") AS ""matches_played"" FROM ""Matches"" GROUP BY ""home_team_id""), ""cte2"" AS (SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_goals"") AS ""goals_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) AS ""points"",COUNT(""away_team_id"") AS ""matches_played"" FROM ""Matches"" GROUP BY ""away_team_id"") SELECT ""T"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goals_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT * FROM ""cte1"" UNION SELECT * FROM ""cte2"") AS ""sub"" JOIN ""Teams"" AS ""T"" ON ""sub"".""team_id""=""T"".""team_id"" GROUP BY ""team_name"" ORDER BY SUM(""points"") DESC,(SUM(""goals_for"")-SUM(""goal_against"")) DESC,""team_name"""
220,"WITH ""temp"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"",""away_team_goals"",""home_team_goals"" FROM ""matches"") SELECT ""t1"".""team_name"" AS ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""temp"" AS ""t"" JOIN ""teams"" AS ""t1"" ON ""t"".""home_team_id""=""t1"".""team_id"" GROUP BY ""t"".""home_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
221,"WITH ""t1"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",""home_team_goals"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_point"",""away_team_goals"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_point"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""t1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_point"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""t1""), ""t3"" AS (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""t2"" GROUP BY 1) SELECT ""T"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""t3"".""goal_for""-""t3"".""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""t3"" ON ""T"".""team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
222,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"")*3+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"")*3+SUM(""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"")+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"") AS ""points"",SUM((""team_id""=""home_team_id"")*""home_team_goals"")+SUM((""team_id""=""away_team_id"")*""away_team_goals"") AS ""goal_for"",SUM((""team_id""=""home_team_id"")*""away_team_goals"")+SUM((""team_id""=""away_team_id"")*""home_team_goals"") AS ""goal_against"",SUM((""team_id""=""home_team_id"")*(""home_team_goals""-""away_team_goals""))+SUM((""team_id""=""away_team_id"")*(""away_team_goals""-""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
223,"WITH ""tmp"" AS (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""score"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""score"" FROM ""matches"") SELECT ""t"".""team_name"",COALESCE(COUNT(""tmp"".""team""), 0) AS ""matches_played"",COALESCE(SUM(""score""), 0) AS ""points"",COALESCE(SUM(""goal_for""), 0) AS ""goal_for"",COALESCE(SUM(""goal_against""), 0) AS ""goal_against"",COALESCE(SUM(""goal_for"")-SUM(""goal_against""), 0) AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""tmp"" ON ""t"".""team_id""=""tmp"".""team"" GROUP BY ""tmp"".""team"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
224,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""homepoint"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""awaypoint"" FROM ""matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""sel"",""away_team_goals"" AS ""opponent"",""homepoint"" AS ""points"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"",""home_team_goals"",""awaypoint"" FROM ""cte"") SELECT ""t"".""team_name"",COUNT(""t2"".""team_id"") AS ""matches_played"",SUM(""t2"".""points"") AS ""points"",SUM(""t2"".""sel"") AS ""goal_for"",SUM(""t2"".""opponent"") AS ""goal_against"",SUM(""t2"".""sel"")-SUM(""t2"".""opponent"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""cte2"" AS ""t2"" USING (""team_id"") GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
225,"WITH ""home"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""points"" FROM ""matches""), ""away"" AS (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 END AS ""points"" FROM ""matches""), ""combined"" AS (SELECT * FROM ""home"" UNION ALL SELECT * FROM ""away"") SELECT ""t"".""team_name"",COALESCE(COUNT(""c"".""team_id""), 0) AS ""matches_played"",COALESCE(SUM(""c"".""points""), 0) AS ""points"",COALESCE(SUM(""c"".""goal_for""), 0) AS ""goal_for"",COALESCE(SUM(""c"".""goal_against""), 0) AS ""goal_against"",COALESCE(SUM(""c"".""goal_for"")-SUM(""c"".""goal_against""), 0) AS ""goal_diff"" FROM ""combined"" AS ""c"" JOIN ""teams"" AS ""t"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
226,"SELECT ""t"".""team_name"",""hh"".""game_played"" AS ""matches_played"",""hh"".""points"" AS ""points"",""hh"".""goals"" AS ""goal_for"",""hh"".""goals_against"" AS ""goal_against"",""hh"".""goals""-""hh"".""goals_against"" AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN (SELECT ""a"".""team_id"",SUM(""a"".""game_played"") AS ""game_played"",SUM(""a"".""points"") AS ""points"",SUM(""a"".""goals"") AS ""goals"",SUM(""a"".""goals_against"") AS ""goals_against"",SUM(""a"".""goals"")-SUM(""a"".""goals_against"") AS ""goals_diff"" FROM (SELECT ""away_team_id"" AS ""team_id"",COUNT(""away_team_id"") AS ""game_played"",SUM(""away_team_goals"") AS ""goals"",SUM(""home_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"" GROUP BY ""away_team_id"" UNION ALL SELECT ""home_team_id"" AS ""team_id"",COUNT(""home_team_id"") AS ""game_played"",SUM(""home_team_goals"") AS ""goals"",SUM(""away_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"" GROUP BY ""home_team_id"") AS ""a"" GROUP BY ""a"".""team_id"") AS ""hh"" ON ""hh"".""team_id""=""t"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
227,"WITH ""Table1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"",""away_team_goals"" FROM ""Matches"" AS ""a"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""home_team_goals"",""home_team_goals"" AS ""away_team_goals"" FROM ""Matches"" AS ""b"") SELECT ""b"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_Team_goals"" THEN 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Table1"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY 3 DESC,6 DESC,1"
228,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT DISTINCT ""t"".""team_name"",COUNT(""h"".""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""h"".""home_team_goals"">""h"".""away_team_goals"" THEN 3 WHEN ""h"".""home_team_goals""=""h"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""h"".""home_team_goals"") AS ""goal_for"",SUM(""h"".""away_team_goals"") AS ""goal_against"",SUM(""h"".""home_team_goals"")-SUM(""h"".""away_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""h"" ON ""h"".""home_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" UNION SELECT DISTINCT ""t"".""team_name"",COUNT(""a"".""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""a"".""home_team_goals""<""a"".""away_team_goals"" THEN 3 WHEN ""a"".""home_team_goals""=""a"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""a"".""away_team_goals"") AS ""goal_for"",SUM(""a"".""home_team_goals"") AS ""goal_against"",SUM(""a"".""away_team_goals"")-SUM(""a"".""home_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""a"" ON ""a"".""away_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"") AS ""result_table"" GROUP BY ""team_name"" ORDER BY 3 DESC,6 DESC,1"
229,"WITH ""score"" AS (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""score"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
230,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""points"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goals"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" LEFT JOIN ""teams"" USING (""team_id"") GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
231,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""temp"" JOIN ""teams"" ON ""teams"".""team_id""=""temp"".""team_id"" GROUP BY ""temp"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
232,"WITH ""result_base"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""matches"") SELECT ""b"".""team_name"",COUNT(""a"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""result_base"" AS ""a"" LEFT JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""a"".""team_id"" ORDER BY ""points"" DESC,(SUM(""goals"")-SUM(""against"")) DESC,""team_name"""
233,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE CASE WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END END AS ""points"" FROM ""matches"") AS ""f1"" ON ""t"".""team_id""=""f1"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
234,"SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""away_team_id"" GROUP BY ""t"".""team_id"") AS ""t"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
235,"WITH ""t1"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",""home_team_goals"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_point"",""away_team_goals"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_point"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""t1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_point"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""t1""), ""t3"" AS (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""t2"" GROUP BY 1) SELECT ""T"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""t3"".""goal_for""-""t3"".""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""t3"" ON ""T"".""team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
236,"SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"",(SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END)) AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
237,"WITH ""cte"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 END AS ""home_team_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 END AS ""away_team_points"" FROM ""Matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""away_goals"",""home_team_points"" AS ""team_points"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""home_team_goals"" AS ""away_goals"",""away_team_points"" AS ""team_points"" FROM ""cte"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""c"".""team_points"") AS ""points"",SUM(""c"".""team_goals"") AS ""goal_for"",SUM(""c"".""away_goals"") AS ""goal_against"",SUM(""c"".""team_goals"")-SUM(""c"".""away_goals"") AS ""goal_diff"" FROM ""cte2"" AS ""c"" JOIN ""Teams"" AS ""t"" ON ""c"".""team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
238,"WITH ""CTE"" AS (SELECT ""t"".""team_name"",COUNT(""home_team_goals"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"" UNION ALL SELECT ""t"".""team_name"",COUNT(""away_team_goals"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""m"".""away_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"") SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""CTE"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
239,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
240,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(""cte"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" LEFT JOIN ""Teams"" ON ""cte"".""team_id""=""Teams"".""team_id"" GROUP BY ""cte"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
241,"SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""team_id"") AS ""t"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
242,"WITH ""statsTable"" AS (SELECT ""t1"".""team_name"",CASE WHEN ""m1"".""home_team_id""=""t1"".""team_id"" AND ""m1"".""home_team_goals"">""m1"".""away_team_goals"" THEN 3 WHEN ""m1"".""away_team_id""=""t1"".""team_id"" AND ""m1"".""away_team_goals"">""m1"".""home_team_goals"" THEN 3 WHEN ""m1"".""home_team_goals""=""m1"".""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",CASE WHEN ""m1"".""home_team_id""=""t1"".""team_id"" THEN ""m1"".""home_team_goals"" ELSE 0 END AS ""homeGoals"",CASE WHEN ""m1"".""away_team_id""=""t1"".""team_id"" THEN ""m1"".""away_team_goals"" ELSE 0 END AS ""homeGoals2"",CASE WHEN ""m1"".""home_team_id""=""t1"".""team_id"" THEN ""m1"".""away_team_goals"" ELSE 0 END AS ""awayGoals"",CASE WHEN ""m1"".""away_team_id""=""t1"".""team_id"" THEN ""m1"".""home_team_goals"" ELSE 0 END AS ""awayGoals2"",""m1"".""away_team_id"",""m1"".""home_team_id"" FROM ""Teams"" AS ""t1"" LEFT JOIN ""Matches"" AS ""m1"" ON ""t1"".""team_id""=""m1"".""home_team_id"" OR ""t1"".""team_id""=""m1"".""away_team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""homeGoals""+""homeGoals2"") AS ""goal_for"",SUM(""awayGoals""+""awayGoals2"") AS ""goal_against"",SUM(""homeGoals""+""homeGoals2""-""awayGoals""-""awayGoals2"") AS ""goal_diff"" FROM ""statsTable"" WHERE ""away_team_id"" IS NOT NULL OR ""home_team_id"" IS NOT NULL GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
243,"WITH ""t1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""t1"" JOIN ""teams"" AS ""b"" ON ""t1"".""team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
244,"WITH ""breakdown"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""opponent_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""home_team_goals"" AS ""opponent_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""opponent_goals"") AS ""goal_against"",SUM(""team_goals"")-SUM(""opponent_goals"") AS ""goal_diff"" FROM ""breakdown"" LEFT JOIN ""Teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
245,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""home_score"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""away_score"" FROM ""matches""), ""cte2"" AS (SELECT ""home_team_id"",""home_team_goals"",""home_score"",""away_team_goals"" FROM ""cte"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""away_score"",""home_team_goals"" FROM ""cte"") SELECT ""t"".""team_name"",COUNT(""c"".""home_team_goals"") AS ""matches_played"",SUM(""c"".""home_score"") AS ""points"",SUM(""c"".""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",(SUM(""c"".""home_team_goals"")-SUM(""away_team_goals"")) AS ""goal_diff"" FROM ""cte2"" AS ""c"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c"".""home_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
246,"SELECT ""team_name"",COUNT(""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"",""away_team_goals"",""home_team_goals"" FROM ""matches"") AS ""t"" JOIN ""teams"" ON ""teams"".""team_id""=""t"".""home_team_id"" GROUP BY ""team_name"" ORDER BY 3 DESC,6 DESC,1"
247,"WITH ""home_team_goals"" AS (SELECT ""team_id"",""team_name"",""home_team_goals"" AS ""goals_for"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goals_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id""), ""away_team_goals"" AS (SELECT ""team_id"",""team_name"",""away_team_goals"" AS ""goals_for"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goals_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""away_team_id""), ""summary"" AS (SELECT ""team_id"",""team_name"",""goals_for"",""points"",""goals_against"" FROM ""home_team_goals"" UNION ALL SELECT ""team_id"",""team_name"",""goals_for"",""points"",""goals_against"" FROM ""away_team_goals""), ""pre_finalas"" AS (SELECT ""team_id"",""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"" FROM ""summary"" GROUP BY 1,2) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""pre_finalas"" ORDER BY 3 DESC,""goal_diff"" DESC,1"
248,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"" FROM ""Matches""), ""cte2"" AS (SELECT ""team"",COUNT(1) AS ""matches_played"" FROM ""cte1"" GROUP BY ""team""), ""cte3"" AS (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goals"" FROM ""Matches""), ""cte4"" AS (SELECT ""team"",SUM(""goals"") AS ""goal_for"" FROM ""cte3"" GROUP BY ""team""), ""cte5"" AS (SELECT ""home_team_id"" AS ""team"",""away_team_goals"" AS ""goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""home_team_goals"" AS ""goals"" FROM ""Matches""), ""cte6"" AS (SELECT ""team"",SUM(""goals"") AS ""goal_against"" FROM ""cte5"" GROUP BY ""team""), ""cte7"" AS (SELECT ""home_team_id"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_points"" FROM ""Matches""), ""cte8"" AS (SELECT ""home_team_id"" AS ""team"",""home_points"" AS ""point"" FROM ""cte7"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_points"" AS ""point"" FROM ""cte7""), ""cte9"" AS (SELECT ""team"",SUM(""point"") AS ""points"" FROM ""cte8"" GROUP BY ""team"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM (((""cte9"" JOIN ""cte2"" ON ""cte9"".""team""=""cte2"".""team"") JOIN ""cte4"" ON ""cte9"".""team""=""cte4"".""team"") JOIN ""cte6"" ON ""cte9"".""team""=""cte6"".""team"") JOIN ""Teams"" ON ""cte9"".""team""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
249,"SELECT ""temp"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""home_team_id"",""away_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""team_id"") AS ""temp"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
250,"WITH ""report"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goal"",""away_team_goals"" AS ""oppo_goal"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m2"") SELECT ""team_name"",COUNT(""r"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goal"") AS ""goal_for"",SUM(""oppo_goal"") AS ""goal_against"",(SUM(""team_goal"")-SUM(""oppo_goal"")) AS ""goal_diff"" FROM ""report"" AS ""r"" JOIN ""Teams"" AS ""t"" ON ""r"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,(SUM(""team_goal"")-SUM(""oppo_goal"")) DESC,""team_name"""
251,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
252,"WITH ""CTE"" AS (SELECT ""team_name"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""A"" LEFT JOIN ""Teams"" AS ""B"" ON ""A"".""home_team_id""=""B"".""team_id"" UNION ALL SELECT ""team_name"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""A"" LEFT JOIN ""Teams"" AS ""B"" ON ""A"".""away_team_id""=""B"".""team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""CTE"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
253,"WITH ""cte_points"" AS (SELECT ""home_team_id"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""home_team_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""away_team_points"",""home_team_goals"",""away_team_goals"" FROM ""matches""), ""cte_unionpoints"" AS (SELECT ""Id"",COUNT(""Id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"" FROM (SELECT ""home_team_id"" AS ""Id"",""home_team_points"" AS ""points"",""home_team_goals"" AS ""goals"" FROM ""cte_points"" UNION ALL SELECT ""away_team_id"",""away_team_points"",""away_team_goals"" FROM ""cte_points"") AS ""x"" GROUP BY ""ID""), ""cte_goalsagainst"" AS (SELECT ""Id"",SUM(""goals"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""Id"",""away_team_goals"" AS ""goals"" FROM ""cte_points"" UNION ALL SELECT ""away_team_id"",""home_team_goals"" FROM ""cte_points"") AS ""x"" GROUP BY ""Id"") SELECT ""t"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (""teams"" AS ""t"" JOIN ""cte_unionpoints"" AS ""p"" ON ""t"".""team_id""=""p"".""ID"") JOIN ""cte_goalsagainst"" AS ""g"" ON ""g"".""Id""=""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
254,"WITH ""match_score_cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""team_score_cte"" AS ((SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""match_score_cte"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""match_score_cte"")) SELECT ""t"".""team_name"",COUNT(""t"".""team_name"") AS ""matches_played"",SUM(""s"".""score"") AS ""points"",SUM(""s"".""goal_for"") AS ""goal_for"",SUM(""s"".""goal_against"") AS ""goal_against"",SUM(""s"".""goal_for"")-SUM(""s"".""goal_against"") AS ""goal_diff"" FROM ""team_score_cte"" AS ""s"" LEFT JOIN ""Teams"" AS ""t"" ON ""s"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
255,"WITH ""t1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""b"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""t1"" LEFT JOIN ""Teams"" AS ""b"" ON ""t1"".""team_id""=""b"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) DESC,(SUM(""goal_for"")-SUM(""goal_against"")) DESC,""team_name"""
256,"WITH ""score"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""pt"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""pt"" FROM ""Matches"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(""s"".""team_id"") AS ""matches_played"",SUM(""s"".""pt"") AS ""points"",SUM(""s"".""goal_for"") AS ""goal_for"",SUM(""s"".""goal_against"") AS ""goal_against"",SUM(""s"".""goal_for"")-SUM(""s"".""goal_against"") AS ""goal_diff"" FROM ""score"" AS ""s"" JOIN ""Teams"" AS ""t"" ON ""s"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
257,"SELECT ""t2"".""team_name"",COUNT(""t1"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_goals"">""away_team_goals"" THEN 3 WHEN ""team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""home_team_goals"" AS ""away_team_goals"" FROM ""Matches"") AS ""t1"" LEFT JOIN ""Teams"" AS ""t2"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
258,"WITH ""tbP"" AS (SELECT ""t"".""team_name"",(CASE WHEN ((""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""<""m"".""away_team_goals"")) THEN 3 WHEN ((""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"")) THEN 1 ELSE 0 END) AS ""points"",(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END) AS ""goals_for"",(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END) AS ""goals_against"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",(SUM(""goals_for"")-SUM(""goals_against"")) AS ""goal_diff"" FROM ""tbP"" GROUP BY ""team_name"" HAVING ""goal_diff"" IS NOT NULL ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
259,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
260,"WITH ""cte"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_team_pts"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_team_pts"" FROM ""matches""), ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches"",SUM(""home_team_pts"") AS ""Pts"",SUM(""home_team_goals"") AS ""for_goals"",SUM(""away_team_goals"") AS ""against_goals"" FROM ""cte"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"",COUNT(1) AS ""matches"",SUM(""away_team_pts"") AS ""Pts"",SUM(""away_team_goals"") AS ""for_goals"",SUM(""home_team_goals"") AS ""against_goals"" FROM ""cte"" GROUP BY ""away_team_id"") SELECT ""team_name"",SUM(""matches"") AS ""matches_played"",SUM(""pts"") AS ""points"",SUM(""for_goals"") AS ""goal_for"",SUM(""against_goals"") AS ""goal_against"",SUM(""for_goals"")-SUM(""against_goals"") AS ""goal_diff"" FROM ""cte1"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""a"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
261,"WITH ""cte"" AS (SELECT ""home_team_id"",""away_team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""home_goals"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""away_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",""t1"".""matches_played"",""t2"".""points"",""t3"".""goal_for"",""t4"".""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (((""Teams"" AS ""t"" JOIN (SELECT ""id"",COUNT(1) AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""id"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"" FROM ""Matches"") AS ""t"" GROUP BY ""id"") AS ""t1"" ON ""t"".""team_id""=""t1"".""id"") JOIN (SELECT ""id"",SUM(""goals"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""id"",""home_goals"" AS ""goals"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_goals"" AS ""goals"" FROM ""cte"") AS ""t"" GROUP BY ""id"") AS ""t2"" ON ""t"".""team_id""=""t2"".""id"") JOIN (SELECT ""id"",SUM(""goal_for"") AS ""goal_for"" FROM (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"" FROM ""Matches"") AS ""a"" GROUP BY ""id"") AS ""t3"" ON ""t"".""team_id""=""t3"".""id"") JOIN (SELECT ""id"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""id"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""b"" GROUP BY ""id"") AS ""t4"" ON ""t"".""team_id""=""t4"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
262,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"")*3+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"")*3+SUM(""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"")+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"") AS ""points"",SUM((""team_id""=""home_team_id"")*""home_team_goals"")+SUM((""team_id""=""away_team_id"")*""away_team_goals"") AS ""goal_for"",SUM((""team_id""=""home_team_id"")*""away_team_goals"")+SUM((""team_id""=""away_team_id"")*""home_team_goals"") AS ""goal_against"",SUM((""team_id""=""home_team_id"")*(""home_team_goals""-""away_team_goals""))+SUM((""team_id""=""away_team_id"")*(""away_team_goals""-""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
263,"WITH ""m"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""op_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""op_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(""t"".""team_name"") AS ""matches_played"",SUM(CASE WHEN ""goals"">""op_goals"" THEN 3 WHEN ""goals""=""op_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""op_goals"") AS ""goal_against"",SUM(""goals"")-SUM(""op_goals"") AS ""goal_diff"" FROM ""m"" JOIN ""Teams"" AS ""t"" ON ""m"".""id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
264,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"" AS ""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""m"".""home_team_id""=""t"".""team_id"" OR ""m"".""away_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"") AS ""a"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
265,"SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""status""='home' THEN ""home_point"" ELSE ""away_point"" END) AS ""points"",SUM(CASE WHEN ""status""='home' THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""status""='away' THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""status""='home' THEN ""home_team_goals"" ELSE ""away_team_goals"" END)-SUM(CASE WHEN ""status""='away' THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_diff"" FROM (SELECT *,CASE WHEN ""team_id""=""home_team_id"" THEN 'home' ELSE 'away' END AS ""status"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_point"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_point"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""home_team_id"" OR ""t"".""team_id""=""away_team_id"") AS ""t"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
266,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""matches"") AS ""a"" LEFT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
267,"WITH ""temp"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Matches""), ""score_table"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""score"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""score"" FROM ""temp"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM (SELECT ""Teams"".""team_name"",""score_table"".""goal_for"",""score_table"".""goal_against"",""score_table"".""score"" FROM ""score_table"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""score_table"".""team_id"") AS ""join_score"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
268,"WITH ""report"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goal"",""away_team_goals"" AS ""oppo_goal"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m1"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""m2"") SELECT ""team_name"",COUNT(""r"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goal"") AS ""goal_for"",SUM(""oppo_goal"") AS ""goal_against"",(SUM(""team_goal"")-SUM(""oppo_goal"")) AS ""goal_diff"" FROM ""report"" AS ""r"" JOIN ""Teams"" AS ""t"" ON ""r"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,(SUM(""team_goal"")-SUM(""oppo_goal"")) DESC,""team_name"""
269,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""t2"" JOIN (SELECT ""team_id"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" USING (""team_id"") ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
270,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
271,"WITH ""match_list"" AS (SELECT ""home_team_id"" AS ""id"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"" FROM ""Matches""), ""match_played"" AS (SELECT DISTINCT ""id"",COUNT(1) OVER (PARTITION BY ""id"") AS ""matches_played"" FROM ""match_list""), ""point_list"" AS (SELECT ""home_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""points"" FROM ""Matches""), ""point"" AS (SELECT DISTINCT ""id"",SUM(""points"") OVER (PARTITION BY ""id"") AS ""points"" FROM ""point_list""), ""goal_list"" AS (SELECT ""home_team_id"" AS ""id"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""id"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY ""away_team_id""), ""goal"" AS (SELECT DISTINCT ""id"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""goal_list"" GROUP BY ""id"") SELECT ""t"".""team_name"" AS ""team_name"",""m"".""matches_played"" AS ""matches_played"",""p"".""points"" AS ""points"",""g"".""goal_for"" AS ""goal_for"",""g"".""goal_against"" AS ""goal_against"",""g"".""goal_diff"" AS ""goal_diff"" FROM ((""Teams"" AS ""t"" JOIN ""match_played"" AS ""m"" ON ""t"".""team_id""=""m"".""id"") JOIN ""point"" AS ""p"" ON ""t"".""team_id""=""p"".""id"") JOIN ""goal"" AS ""g"" ON ""t"".""team_id""=""g"".""id"" ORDER BY ""p"".""points"" DESC,""g"".""goal_diff"" DESC,""t"".""team_name"""
272,"WITH ""all_matches"" AS (SELECT ""home_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""point"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""point"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches""), ""stats"" AS (SELECT ""id"",COUNT(1) AS ""matches_played"",SUM(""point"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""all_matches"" GROUP BY ""id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""stats"" JOIN ""Teams"" ON ""stats"".""id""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
273,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
274,"WITH ""records"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""gain"",""away_team_goals"" AS ""lost"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""gain"",""home_team_goals"" AS ""lost"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""r"".""points"") AS ""points"",SUM(""r"".""gain"") AS ""goal_for"",SUM(""r"".""lost"") AS ""goal_against"",SUM(""r"".""gain"")-SUM(""r"".""lost"") AS ""goal_diff"" FROM ""teams"" AS ""t"" RIGHT JOIN ""records"" AS ""r"" USING (""team_id"") GROUP BY ""t"".""team_name"",""r"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
275,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END AS ""points"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_for"",CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") AS ""tb"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
276,"WITH ""a"" AS (SELECT *,CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""matches""), ""b"" AS (SELECT ""home_team_id"",""home_score"" FROM ""a"" UNION ALL SELECT ""away_team_id"",""away_score"" FROM ""a""), ""c"" AS (SELECT ""home_team_id"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""home_score"") AS ""points"" FROM ""b"" GROUP BY 1), ""points"" AS (SELECT ""home_team_id"",""home_team_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"" FROM ""matches""), ""points_against"" AS (SELECT ""home_team_id"",""away_team_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""home_team_goals"" FROM ""matches""), ""goal_for"" AS (SELECT ""home_team_id"",SUM(""home_team_goals"") AS ""goal_for"" FROM ""points"" GROUP BY 1), ""goal_against"" AS (SELECT ""home_team_id"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""points_against"" GROUP BY 1), ""temp1"" AS (SELECT ""teams"".""team_name"",""c"".""matches_played"",""c"".""points"",""gf"".""goal_for"",""ga"".""goal_against"" FROM ((""c"" JOIN ""teams"" ON ""c"".""home_team_id""=""teams"".""team_id"") JOIN ""goal_for"" AS ""gf"" ON ""c"".""home_team_id""=""gf"".""home_team_id"") JOIN ""goal_against"" AS ""ga"" ON ""c"".""home_team_id""=""ga"".""home_team_id"") SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""temp1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
277,"SELECT ""T"".""team_name"",SUM(CASE WHEN ""T"".""team_id""=""M"".""home_team_id"" THEN 1 WHEN ""T"".""team_id""=""M"".""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""T"".""team_id""=""M"".""home_team_id"" AND ""M"".""home_team_goals"">""M"".""away_team_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""away_team_id"" AND ""M"".""away_team_goals"">""M"".""home_team_goals"" THEN 3 WHEN ""T"".""team_id""=""M"".""home_team_id"" AND ""M"".""home_team_goals""=""M"".""away_team_goals"" THEN 1 WHEN ""T"".""team_id""=""M"".""away_team_id"" AND ""M"".""away_team_goals""=""M"".""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""T"".""team_id""=""M"".""home_team_id"" THEN ""M"".""home_team_goals"" WHEN ""T"".""team_id""=""M"".""away_team_id"" THEN ""M"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""T"".""team_id""=""M"".""home_team_id"" THEN ""M"".""away_team_goals"" WHEN ""T"".""team_id""=""M"".""away_team_id"" THEN ""M"".""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""T"".""team_id""=""M"".""home_team_id"" THEN ""M"".""home_team_goals"" WHEN ""T"".""team_id""=""M"".""away_team_id"" THEN ""M"".""away_team_goals"" ELSE 0 END)-SUM(CASE WHEN ""T"".""team_id""=""M"".""home_team_id"" THEN ""M"".""away_team_goals"" WHEN ""T"".""team_id""=""M"".""away_team_id"" THEN ""M"".""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""home_team_id"" OR ""T"".""team_id""=""M"".""away_team_id"" GROUP BY ""T"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""T"".""team_name"""
278,"SELECT ""team_name"",SUM(CASE WHEN ""t"".""team_id""=""home_team_id"" THEN 1 WHEN ""t"".""team_id""=""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id"" IN (""home_team_id"",""away_team_id"") GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
279,"SELECT ""t"".""team_name"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") OR (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"") THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END) AS ""goal_against"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" END)) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
280,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""t2"" JOIN (SELECT ""team_id"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" USING (""team_id"") ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
281,"SELECT ""a"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""t"" JOIN ""Teams"" AS ""a"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY ""a"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""a"".""team_name"""
282,"WITH ""home"" AS (SELECT ""b"".""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",""b"".""team_name"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""a"" LEFT JOIN ""Teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id""), ""away"" AS (SELECT ""b"".""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"",""b"".""team_name"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" AS ""a"" LEFT JOIN ""Teams"" AS ""b"" ON ""a"".""away_team_id""=""b"".""team_id"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goals_for"")-SUM(""goals_against"") AS ""goal_diff"" FROM (SELECT * FROM ""home"" UNION ALL SELECT * FROM ""away"") AS ""a"" GROUP BY ""team_name"" ORDER BY SUM(""points"") DESC,""goal_diff"" DESC,""team_name"""
283,"WITH ""cte"" AS (SELECT ""A"".""team"",""A"".""points"",""A"".""goals"",""T"".""team_name"",""A"".""goal"" FROM (SELECT ""home_team_id"" AS ""team"",(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END) AS ""points"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""goal"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",(CASE WHEN ""away_team_goals""=""home_team_goals"" THEN 1 WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 END) AS ""points"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""goal"" FROM ""Matches"") AS ""A"" LEFT JOIN ""Teams"" AS ""T"" ON ""A"".""team""=""T"".""team_id"") SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(""team"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal"") AS ""goal_against"" FROM ""cte"" GROUP BY ""team_name"") AS ""B"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
284,"WITH ""cte1"" AS (SELECT ""team_name"",(SUM(CASE WHEN ""team_id""=""home_team_id"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" THEN 1 ELSE 0 END)) AS ""matches_played"",(SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END)) AS ""points"",(SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END)) AS ""goal_for"",(SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END)) AS ""goal_against"" FROM ""teams"" AS ""t"" LEFT JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""away_team_id"" GROUP BY 1) SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte1"" WHERE ""matches_played""!=0 ORDER BY 3 DESC,6 DESC,1"
285,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""cte"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""cte"" LEFT JOIN ""Teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"" GROUP BY ""cte"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
286,"WITH ""tb1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_points"" FROM ""Matches""), ""tb_home_points"" AS (SELECT ""home_team_id"" AS ""team_id"",SUM(""home_team_points"") AS ""total_points"",SUM(""home_team_goals"") AS ""total_scored_goals"",SUM(""away_team_goals"") AS ""total_conceded_goals"",COUNT(1) AS ""total_matches"" FROM ""tb1"" GROUP BY ""home_team_id""), ""tb_away_points"" AS (SELECT ""away_team_id"" AS ""team_id"",SUM(""away_team_points"") AS ""total_points"",SUM(""away_team_goals"") AS ""total_scored_goals"",SUM(""home_team_goals"") AS ""total_conceded_goals"",COUNT(1) AS ""total_matches"" FROM ""tb1"" GROUP BY ""away_team_id""), ""tb_points"" AS (SELECT * FROM ""tb_home_points"" UNION ALL SELECT * FROM ""tb_away_points""), ""tb_points_summary"" AS (SELECT ""team_id"",SUM(""total_points"") AS ""points"",SUM(""total_matches"") AS ""matches_played"",SUM(""total_scored_goals"") AS ""goal_for"",SUM(""total_conceded_goals"") AS ""goal_against"" FROM ""tb_points"" GROUP BY ""team_id"") SELECT ""t"".""team_name"",""tb"".""matches_played"",""tb"".""points"",""tb"".""goal_for"",""tb"".""goal_against"",(""tb"".""goal_for""-""tb"".""goal_against"") AS ""goal_diff"" FROM ""tb_points_summary"" AS ""tb"" JOIN ""Teams"" AS ""t"" ON ""tb"".""team_id""=""t"".""team_id"" ORDER BY ""tb"".""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
287,"WITH ""CTE1"" AS (SELECT ""t"".""team_name"",""m"".""home_team_id"" AS ""team_id"",""m"".""home_team_goals"" AS ""goals"",(CASE WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""m"".""home_team_goals""<""m"".""away_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""away_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""home_team_id""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_name"",""m"".""away_team_id"" AS ""team_id"",""m"".""away_team_goals"" AS ""goals"",(CASE WHEN ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 WHEN ""m"".""away_team_goals""<""m"".""home_team_goals"" THEN 0 ELSE NULL END) AS ""points"",""m"".""home_team_goals"" AS ""goal_against"" FROM ""Matches"" AS ""m"" LEFT JOIN ""Teams"" AS ""t"" ON ""m"".""away_team_id""=""t"".""team_id"") SELECT ""c"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goals"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""CTE1"" AS ""c"" GROUP BY ""c"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
288,"WITH ""cte"" AS (SELECT ""team_name"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN 1 WHEN ""team_id""=""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""<""home_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Teams"" AS ""a"" JOIN ""Matches"" AS ""b"" GROUP BY ""team_name"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" ORDER BY ""points"" DESC,(""goal_for""-""goal_against"") DESC,""team_name"""
289,"SELECT ""c"".""team_name"",""c"".""matches_played"",""c"".""points"",""c"".""goal_for"",""c"".""goal_against"",(""c"".""goal_for""-""c"".""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(CASE WHEN ""t"".""team_id""=""home_team_id"" THEN 1 WHEN ""t"".""team_id""=""away_team_id"" THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""t"".""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""t"".""team_id""=""away_team_id"" AND ""away_team_goals""<""home_team_goals"" THEN 0 WHEN ""t"".""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""home_team_id"" THEN ""away_team_goals"" END) AS ""goal_against"" FROM (""Teams"" AS ""t"") JOIN ""Matches"" AS ""m"" WHERE ""t"".""team_id""=""home_team_id"" OR ""t"".""team_id""=""away_team_id"" GROUP BY ""team_id"") AS ""c"" ORDER BY ""c"".""points"" DESC,(""c"".""goal_for""-""c"".""goal_against"") DESC,""c"".""team_name"""
290,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""a"" LEFT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
291,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
292,"WITH ""matchs"" AS (SELECT *,CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""home_team_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_team_points"" FROM ""Matches""), ""cte1"" AS (SELECT ""home_team_id"",COUNT(""home_team_id"") AS ""cnt"",SUM(""home_team_goals"") AS ""gol"",SUM(""away_team_goals"") AS ""awa"",SUM(""home_team_points"") AS ""p"" FROM ""matchs"" GROUP BY ""home_team_id""), ""cte2"" AS (SELECT ""away_team_id"",COUNT(""away_team_id""),SUM(""away_team_goals""),SUM(""home_team_goals""),SUM(""away_team_points"") FROM ""Matchs"" GROUP BY ""away_team_id""), ""cte3"" AS (SELECT * FROM ""cte1"" UNION ALL SELECT * FROM ""cte2"") SELECT ""tb1"".""team_name"",""tb2"".""matches_played"",""tb2"".""points"",""tb2"".""goal_for"",""tb2"".""goal_against"",(""tb2"".""goal_for""-""tb2"".""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",SUM(""cnt"") AS ""matches_played"",SUM(""p"") AS ""points"",SUM(""gol"") AS ""goal_for"",SUM(""awa"") AS ""goal_against"" FROM ""cte3"" GROUP BY ""home_team_id"") AS ""tb2"" JOIN ""Teams"" AS ""tb1"" ON ""tb2"".""home_team_id""=""tb1"".""team_id"" ORDER BY ""tb2"".""points"" DESC,""goal_diff"" DESC,""tb1"".""team_name"""
293,"SELECT DISTINCT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT DISTINCT ""t"".""team_name"",COUNT(""h"".""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""h"".""home_team_goals"">""h"".""away_team_goals"" THEN 3 WHEN ""h"".""home_team_goals""=""h"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""h"".""home_team_goals"") AS ""goal_for"",SUM(""h"".""away_team_goals"") AS ""goal_against"",SUM(""h"".""home_team_goals"")-SUM(""h"".""away_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""h"" ON ""h"".""home_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" UNION SELECT DISTINCT ""t"".""team_name"",COUNT(""a"".""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""a"".""home_team_goals""<""a"".""away_team_goals"" THEN 3 WHEN ""a"".""home_team_goals""=""a"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""a"".""away_team_goals"") AS ""goal_for"",SUM(""a"".""home_team_goals"") AS ""goal_against"",SUM(""a"".""away_team_goals"")-SUM(""a"".""home_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""a"" ON ""a"".""away_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"") AS ""result_table"" GROUP BY ""team_name"" ORDER BY 3 DESC,6 DESC,1"
294,"WITH ""t1_points"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_pt"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""away_pt"" FROM ""matches""), ""t2_goalfor"" AS (SELECT ""teamid"",SUM(""goalf"") AS ""goal_for"",COUNT(1) AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""teamid"",""home_team_goals"" AS ""goalf"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""teamid"",""away_team_goals"" AS ""goalf"" FROM ""matches"") AS ""temp1"" GROUP BY ""teamid""), ""t3_goalagainst"" AS (SELECT ""teamid"",SUM(""goalag"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""teamid"",""away_team_goals"" AS ""goalag"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""teamid"",""home_team_goals"" AS ""goalag"" FROM ""matches"") AS ""temp2"" GROUP BY ""teamid""), ""t4_totalpts"" AS (SELECT ""tid"",SUM(""pt"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""tid"",""home_pt"" AS ""pt"" FROM ""t1_points"" UNION ALL SELECT ""away_team_id"" AS ""tid"",""away_pt"" AS ""pt"" FROM ""t1_points"") AS ""temp3"" GROUP BY 1) SELECT ""t"".""team_name"",""t2"".""matches_played"",""t4"".""points"",""t2"".""goal_for"",""t3"".""goal_against"",(""t2"".""goal_for""-""t3"".""goal_against"") AS ""goal_diff"" FROM ((""teams"" AS ""t"" JOIN ""t2_goalfor"" AS ""t2"" ON ""t"".""team_id""=""t2"".""teamid"") JOIN ""t3_goalagainst"" AS ""t3"" ON ""t"".""team_id""=""t3"".""teamid"") JOIN ""t4_totalpts"" AS ""t4"" ON ""t"".""team_id""=""t4"".""tid"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
295,"WITH ""a"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_team_points"" FROM ""matches"") SELECT ""t1"".""team_name"",COALESCE(COUNT(1), 0) AS ""matches_played"",COALESCE(SUM(""points""), 0) AS ""points"",COALESCE(SUM(""goal_for""), 0) AS ""goal_for"",COALESCE(SUM(""goal_against""), 0) AS ""goal_against"",COALESCE(SUM(""goal_for"")-SUM(""goal_against""), 0) AS ""goal_diff"" FROM ""teams"" AS ""t1"" JOIN (SELECT ""home_team_id"" AS ""team_id"",""home_team_points"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""a"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_points"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""a"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""team_id"" GROUP BY 1 ORDER BY SUM(""points"") DESC,SUM(""goal_for"")-SUM(""goal_against"") DESC,""team_name"""
296,"WITH ""score"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""pt"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""pt"" FROM ""Matches"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(""s"".""team_id"") AS ""matches_played"",SUM(""s"".""pt"") AS ""points"",SUM(""s"".""goal_for"") AS ""goal_for"",SUM(""s"".""goal_against"") AS ""goal_against"",SUM(""s"".""goal_for"")-SUM(""s"".""goal_against"") AS ""goal_diff"" FROM ""score"" AS ""s"" JOIN ""Teams"" AS ""t"" ON ""s"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
297,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 'win' WHEN ""home_team_goals""=""away_team_goals"" THEN 'tie' ELSE 'loss' END AS ""result"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 'win' WHEN ""away_team_goals""=""home_team_goals"" THEN 'tie' ELSE 'loss' END AS ""result"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(""c1"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""result""='win' THEN 3 WHEN ""result""='tie' THEN 1 ELSE 0 END) AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goals_for"")-SUM(""goals_against"") AS ""goal_diff"" FROM ""cte"" AS ""c1"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""c1"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
298,"WITH ""a"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""matches""), ""b"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_points"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""a"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_points"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""a""), ""c"" AS (SELECT ""t"".""team_name"",""b"".""points"",""b"".""goal_for"",""b"".""goal_against"" FROM ""teams"" AS ""t"" RIGHT JOIN ""b"" ON ""t"".""team_id""=""b"".""team_id"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""c"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
299,"SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(CASE WHEN ""home_team_id""=""team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_id""=""team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""away_team_id""=""team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""away_team_id""=""team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""home_team_goals"" WHEN ""away_team_id""=""team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""home_team_id""=""team_id"" THEN ""away_team_goals"" WHEN ""away_team_id""=""team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""T1"" JOIN ""Matches"" AS ""M1"" ON ""T1"".""team_id""=""M1"".""home_team_id"" OR ""T1"".""team_id""=""M1"".""away_team_id"" GROUP BY ""T1"".""team_name"") AS ""Temp"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
300,"WITH ""t1"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",""home_team_goals"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_point"",""away_team_goals"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_point"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""t1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_point"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""t1""), ""t3"" AS (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""t2"" GROUP BY 1) SELECT ""T"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""t3"".""goal_for""-""t3"".""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""t3"" ON ""T"".""team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
301,"SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",SUM(CASE WHEN ""team_id"" IN (""home_team_id"",""away_team_id"") THEN 1 ELSE 0 END) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id"" IN (""m"".""home_team_id"",""m"".""away_team_id"") GROUP BY ""t"".""team_id"") AS ""temp"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
302,"WITH ""table1"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_team_points"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""away_team_points"" FROM ""Matches""), ""table2"" AS (SELECT ""home_team_id"",""home_team_points"",""home_team_goals"",""away_team_goals"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"",""t"".""team_name"" FROM ""table1"" JOIN ""Teams"" AS ""t"" WHERE ""table1"".""home_team_id""=""t"".""team_id"" UNION ALL SELECT ""away_team_id"",""away_team_points"",""away_team_goals"",""home_team_goals"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"",""t"".""team_name"" FROM ""table1"" JOIN ""Teams"" AS ""t"" WHERE ""table1"".""away_team_id""=""t"".""team_id"") SELECT ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""home_team_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""table2"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
303,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""tid"",""home_team_goals"" AS ""mg"",""away_team_goals"" AS ""gg"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END AS ""pts"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""tid"",""away_team_goals"" AS ""mg"",""home_team_goals"" AS ""gg"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END AS ""pts"" FROM ""matches""), ""cte2"" AS (SELECT ""t"".""team_name"",""c"".* FROM ""Teams"" AS ""t"" RIGHT JOIN ""cte"" AS ""c"" ON ""T"".""team_id""=""c"".""tid"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""pts"") AS ""points"",SUM(""mg"") AS ""goal_for"",SUM(""gg"") AS ""goal_against"",SUM(""mg"")-SUM(""gg"") AS ""goal_diff"" FROM ""cte2"" GROUP BY ""team_name"" ORDER BY 3 DESC,6 DESC,1"
304,"WITH ""match_score_cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""team_score_cte"" AS ((SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""match_score_cte"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""match_score_cte"")) SELECT ""t"".""team_name"",COUNT(""t"".""team_name"") AS ""matches_played"",SUM(""s"".""score"") AS ""points"",SUM(""s"".""goal_for"") AS ""goal_for"",SUM(""s"".""goal_against"") AS ""goal_against"",SUM(""s"".""goal_for"")-SUM(""s"".""goal_against"") AS ""goal_diff"" FROM ""team_score_cte"" AS ""s"" JOIN ""Teams"" AS ""t"" ON ""s"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
305,"WITH ""T1"" AS (SELECT *,CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""Matches""), ""T2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""points"" FROM ""T1"" UNION ALL SELECT ""away_team_id"" AS ""away_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""points"" FROM ""T1"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""T2"" JOIN ""Teams"" AS ""T"" ON ""T2"".""team_id""=""T"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
306,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM (SELECT ""team_id"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""away_team_id"") AS ""sub1"" GROUP BY ""team_id"") AS ""sub2"" LEFT JOIN ""Teams"" ON ""sub2"".""team_id""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
307,"SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""T"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" AND ""t"".""team_id""=""m"".""home_team_id"" THEN 3 WHEN ""away_team_goals"">""home_team_goals"" AND ""t"".""team_id""=""m"".""away_team_id"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""T"" LEFT JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""T"".""team_name"") AS ""f"" WHERE ""goal_for"" IS NOT NULL ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
308,"WITH ""t1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""t1"" JOIN ""teams"" AS ""b"" ON ""t1"".""team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
309,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""CTE"" JOIN ""TEAMS"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
310,"WITH ""breakdown"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""opponent_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""home_team_goals"" AS ""opponent_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""opponent_goals"") AS ""goal_against"",SUM(""team_goals"")-SUM(""opponent_goals"") AS ""goal_diff"" FROM ""breakdown"" LEFT JOIN ""Teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
311,"WITH ""cte1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""away_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""home_score"" AS ""score"",""away_team_goals"" AS ""against_goal"" FROM ""cte1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""away_score"" AS ""score"",""home_team_goals"" AS ""against_goal"" FROM ""cte1"") SELECT ""team_name"",COUNT(""a"".""team_id"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""against_goal"") AS ""goal_against"",SUM(""team_goals""-""against_goal"") AS ""goal_diff"" FROM ""cte2"" AS ""a"" LEFT JOIN ""Teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
312,"SELECT ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
313,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" JOIN ""teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
314,"WITH ""tmp"" AS (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY 1) SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""tmp"" ORDER BY 3 DESC,6 DESC,1"
315,"WITH ""matches2"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_team_points"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""away_team_points"" FROM ""Matches""), ""home_team"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""opp_team_goals"",""home_team_points"" AS ""team_points"" FROM ""matches2""), ""away_team"" AS (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""team_goals"",""home_team_goals"" AS ""opp_team_goals"",""away_team_points"" AS ""team_points"" FROM ""matches2""), ""matches3"" AS (SELECT * FROM ""home_team"" UNION ALL SELECT * FROM ""away_team"") SELECT ""t"".""team_name"",COUNT(""t"".""team_id"") AS ""matches_played"",SUM(""m"".""team_points"") AS ""points"",SUM(""m"".""team_goals"") AS ""goal_for"",SUM(""m"".""opp_team_goals"") AS ""goal_against"",SUM(""m"".""team_goals"")-SUM(""m"".""opp_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""matches3"" AS ""m"" ON ""t"".""team_id""=""m"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY SUM(""m"".""team_points"") DESC,SUM(""m"".""team_goals"")-SUM(""m"".""opp_team_goals"") DESC,""team_name"""
316,"WITH ""host"" AS (SELECT ""home_team_id"" AS ""id"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END) AS ""points"" FROM ""matches"" GROUP BY 1), ""away"" AS (SELECT ""away_team_id"" AS ""id"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 END) AS ""points"" FROM ""matches"" GROUP BY 1), ""team_info"" AS (SELECT ""id"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"",SUM(""points"") AS ""points"" FROM (SELECT ""id"",""goal_for"",""goal_against"",""goal_diff"",""points"" FROM ""host"" UNION ALL SELECT ""id"",""goal_for"",""goal_against"",""goal_diff"",""points"" FROM ""away"") AS ""temp"" GROUP BY 1), ""h_count"" AS (SELECT ""home_team_id"" AS ""id"",COUNT(1) AS ""matches_num"" FROM ""matches"" GROUP BY 1), ""a_count"" AS (SELECT ""away_team_id"" AS ""id"",COUNT(1) AS ""matches_num"" FROM ""matches"" GROUP BY 1), ""matches_count"" AS (SELECT ""id"",SUM(""matches_num"") AS ""matches_num"" FROM (SELECT ""id"",""matches_num"" FROM ""h_count"" AS ""h"" UNION ALL SELECT ""id"",""matches_num"" FROM ""a_count"" AS ""h"") AS ""temp2"" GROUP BY 1) SELECT ""t"".""team_name"",""mc"".""matches_num"" AS ""matches_played"",""tf"".""points"",""tf"".""goal_for"",""tf"".""goal_against"",""tf"".""goal_diff"" FROM (""team_info"" AS ""tf"" JOIN ""teams"" AS ""t"" ON ""tf"".""id""=""t"".""team_id"") JOIN ""matches_count"" AS ""mc"" ON ""t"".""team_id""=""mc"".""id"" ORDER BY ""tf"".""points"" DESC,""tf"".""goal_diff"" DESC,""t"".""team_name"""
317,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals""-""away_team_goals"" AS ""diff"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals""-""home_team_goals"" AS ""diff"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""diff"">0 THEN 3 WHEN ""diff""=0 THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""diff"") AS ""goal_diff"" FROM ""temp"" AS ""t"" JOIN ""Teams"" AS ""te"" ON ""te"".""team_id""=""t"".""id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
318,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches""), ""cte2"" AS (SELECT ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte1"" GROUP BY ""team_id"") SELECT ""b"".""team_name"",""a"".""matches_played"",""a"".""points"",""a"".""goal_for"",""a"".""goal_against"",""a"".""goal_diff"" FROM ""cte2"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" ORDER BY ""a"".""points"" DESC,""goal_diff"" DESC,""b"".""team_name"""
319,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
320,"WITH ""agg"" AS (SELECT ""home_team_id"" AS ""team_id"",""away_team_id"" AS ""team_against"",""home_team_goals"" AS ""goal"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""home_team_id"" AS ""team_against"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(""agg"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""goal"">""goal_against"" THEN 3 WHEN ""goal""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""agg"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""agg"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
321,"WITH ""CTE1"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_team_pts"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END) AS ""away_team_pts"" FROM ""Matches""), ""CTE2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_pts"" AS ""pts"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""CTE1"" UNION ALL SELECT ""away_team_id"",""away_team_pts"",""away_team_goals"",""home_team_goals"" FROM ""CTE1""), ""CTE3"" AS (SELECT ""team_id"",SUM(""pts"") AS ""pts"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",COUNT(1) AS ""matches_played"" FROM ""CTE2"" GROUP BY ""team_id"") SELECT ""Teams"".""team_name"",""matches_played"",""pts"" AS ""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""CTE3"" JOIN ""Teams"" ON ""CTE3"".""team_id""=""Teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
322,"WITH ""cte"" AS (SELECT ""t"".""team_id"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") AS ""t"" GROUP BY ""t"".""team_id"") SELECT ""ts"".""team_name"",""c"".""matches_played"",""c"".""points"",""c"".""goal_for"",""c"".""goal_against"",""c"".""goal_diff"" FROM ""Teams"" AS ""ts"" JOIN ""cte"" AS ""c"" ON ""ts"".""team_id""=""c"".""team_id"" ORDER BY ""c"".""points"" DESC,""c"".""goal_diff"" DESC,""ts"".""team_name"""
323,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
324,"WITH ""Home"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY 1), ""Away"" AS (SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"" FROM ""Matches"" GROUP BY 1) SELECT ""A"".""team_name"",COALESCE(""B"".""matches"", 0)+COALESCE(""C"".""matches"", 0) AS ""matches_played"",COALESCE(""B"".""points"", 0)+COALESCE(""C"".""points"", 0) AS ""points"",COALESCE(""B"".""goal_for"", 0)+COALESCE(""C"".""goal_for"", 0) AS ""goal_for"",COALESCE(""B"".""goal_against"", 0)+COALESCE(""C"".""goal_against"", 0) AS ""goal_against"",COALESCE(""B"".""goal_for"", 0)+COALESCE(""C"".""goal_for"", 0)-COALESCE(""B"".""goal_against"", 0)-COALESCE(""C"".""goal_against"", 0) AS ""goal_diff"" FROM (""Teams"" AS ""A"" LEFT JOIN ""Home"" AS ""B"" ON ""A"".""team_id""=""B"".""team_id"") LEFT JOIN ""Away"" AS ""C"" ON ""A"".""team_id""=""C"".""team_id"" HAVING ""matches_played"">0 ORDER BY 3 DESC,6 DESC,1"
325,"WITH ""t"" AS (SELECT *,CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END AS ""away_points"" FROM ""matches""), ""new"" AS (SELECT ""t"".""home_team_id"" AS ""team_id"",""t"".""home_team_goals"" AS ""team_goals"",""t"".""home_points"" AS ""points"" FROM ""t"" UNION ALL SELECT ""t"".""away_team_id"" AS ""team_id"",""t"".""away_team_goals"" AS ""team_goals"",""t"".""away_points"" AS ""points"" FROM ""t""), ""against"" AS (SELECT ""tb"".""team_id"",SUM(""tb"".""goals"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"" FROM ""matches"") AS ""tb"" GROUP BY ""tb"".""team_id"") SELECT ""teams"".""team_name"",COUNT(""new"".""team_id"") AS ""matches_played"",SUM(""new"".""points"") AS ""points"",SUM(""new"".""team_goals"") AS ""goal_for"",""against"".""goal_against"" AS ""goal_against"",SUM(""new"".""team_goals"")-""against"".""goal_against"" AS ""goal_diff"" FROM (""new"" JOIN ""teams"" ON ""teams"".""team_id""=""new"".""team_id"") JOIN ""against"" ON ""against"".""team_id""=""new"".""team_id"" GROUP BY ""new"".""team_id"" ORDER BY SUM(""new"".""points"") DESC,""goal_diff"" DESC,""teams"".""team_name"""
326,"SELECT ""team_name"",""matches_played"",""points"",""goals_for"" AS ""goal_for"",""goals_against"" AS ""goal_against"",""goals_for""-""goals_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goals_for"",SUM(""goals_against"") AS ""goals_against"" FROM (SELECT ""t"".""team_id"",""t"".""team_name"",CASE WHEN ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" THEN 1 ELSE NULL END AS ""matches_played"",CASE WHEN ""team_id""=""winning_team"" THEN 3 WHEN ""winning_team"" IS NULL THEN 1 ELSE 0 END AS ""points"",CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END AS ""goals_for"",CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END AS ""goals_against"" FROM ""teams"" AS ""t"" JOIN (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN ""home_team_id"" WHEN ""home_team_goals""<""away_team_goals"" THEN ""away_team_id"" WHEN ""home_team_goals""=""away_team_goals"" THEN NULL END AS ""winning_team"" FROM ""matches"") AS ""derived_matches"" ON ""t"".""team_id""=""derived_matches"".""away_team_id"" OR ""t"".""team_id""=""derived_matches"".""home_team_id"") AS ""A"" GROUP BY ""A"".""team_name"") AS ""B"" ORDER BY ""points"" DESC,""goals_for""-""goals_against"" DESC,""team_name"""
327,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" ELSE 0 END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""matches"" AS ""m"" JOIN ""teams"" AS ""t"" ON (""m"".""home_team_id""=""t"".""team_id"") OR (""m"".""away_team_id""=""t"".""team_id"") GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
328,"SELECT ""Teams"".""team_name"",COUNT(""Matches_2"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""this_team_goals"") AS ""goal_for"",SUM(""other_team_goals"") AS ""goal_against"",SUM(""this_team_goals"")-SUM(""other_team_goals"") AS ""goal_diff"" FROM (SELECT *,CASE WHEN ""this_team_goals"">""other_team_goals"" THEN 3 WHEN ""this_team_goals""=""other_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""this_team_goals"",""away_team_goals"" AS ""other_team_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""this_team_goals"",""home_team_goals"" AS ""other_team_goals"" FROM ""Matches"") AS ""poop"") AS ""Matches_2"" LEFT JOIN ""Teams"" ON ""Matches_2"".""team_id""=""Teams"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
329,"WITH ""stats"" AS (SELECT ""home_team_id"" AS ""h_id"",""away_team_id"" AS ""a_id"",""home_team_goals"" AS ""h_for"",""away_team_goals"" AS ""h_against"",""away_team_goals"" AS ""a_for"",""home_team_goals"" AS ""a_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END AS ""h_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END AS ""a_points"" FROM ""Matches""), ""h_a"" AS (SELECT ""h_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(""h_for"") AS ""goal_for"",SUM(""h_against"") AS ""goal_against"",SUM(""h_points"") AS ""points"" FROM ""stats"" GROUP BY ""h_id"" UNION SELECT ""a_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(""a_for"") AS ""goal_for"",SUM(""a_against"") AS ""goal_against"",SUM(""a_points"") AS ""points"" FROM ""stats"" GROUP BY ""a_id"") SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""h_a"" JOIN ""Teams"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY 3 DESC,6 DESC,1"
330,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home""-""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""Matches"") AS ""temp"" JOIN ""Teams"" AS ""t"" ON ""temp"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
331,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals""-""m"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals""-""m"".""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
332,"WITH ""cte"" AS (SELECT ""team_name"",COUNT(CASE WHEN ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" THEN 1 END) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" ORDER BY 3 DESC,6 DESC,1"
333,"SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m2"".""home_team_id"" THEN ""m2"".""home_team_points"" ELSE ""m2"".""away_team_points"" END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m2"".""home_team_id"" THEN ""m2"".""home_team_goals"" ELSE ""m2"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m2"".""home_team_id"" THEN ""m2"".""away_team_goals"" ELSE ""m2"".""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END+CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END+CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_team_points"" FROM ""Matches"" AS ""m"") AS ""m2"" ON ""t"".""team_id""=""m2"".""home_team_id"" OR ""t"".""team_id""=""m2"".""away_team_id"" GROUP BY ""t"".""team_id"") AS ""t2"" ORDER BY ""t2"".""points"" DESC,(""goal_for""-""goal_against"") DESC,""t2"".""team_name"""
334,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"")*3+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"")*3+SUM(""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"")+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"") AS ""points"",SUM((""team_id""=""home_team_id"")*""home_team_goals"")+SUM((""team_id""=""away_team_id"")*""away_team_goals"") AS ""goal_for"",SUM((""team_id""=""home_team_id"")*""away_team_goals"")+SUM((""team_id""=""away_team_id"")*""home_team_goals"") AS ""goal_against"",SUM((""team_id""=""home_team_id"")*(""home_team_goals""-""away_team_goals""))+SUM((""team_id""=""away_team_id"")*(""away_team_goals""-""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
335,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""oppgoals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals"",""home_team_goals"" AS ""oppgoals"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goals"">""oppgoals"" THEN 3 WHEN ""goals""<""oppgoals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""oppgoals"") AS ""goal_against"",SUM(""goals"")-SUM(""oppgoals"") AS ""goal_diff"" FROM ""cte"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""cte"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
336,"WITH ""CTE"" AS ((SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goals"",""away_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"") UNION ALL (SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"" AS ""against"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"" FROM ""Matches"")) SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals"") AS ""goal_for"",SUM(""against"") AS ""goal_against"",(SUM(""goals"")-SUM(""against"")) AS ""goal_diff"" FROM ""CTE"" LEFT JOIN ""Teams"" AS ""t"" ON ""CTE"".""id""=""t"".""team_id"" GROUP BY ""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
337,"WITH ""CTE"" AS (SELECT ""home_team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION SELECT ""away_team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""away_team_id""), ""CTE1"" AS (SELECT ""home_team_id"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""CTE"" GROUP BY ""home_team_id"") SELECT ""T"".""team_name"",""C"".""matches_played"",""C"".""points"",""C"".""goal_for"",""C"".""goal_against"",""C"".""goal_diff"" FROM ""CTE1"" AS ""C"" JOIN ""Teams"" AS ""T"" ON ""C"".""home_team_id""=""T"".""team_id"" ORDER BY ""C"".""points"" DESC,""C"".""goal_diff"" DESC,""T"".""team_name"""
338,"SELECT ""l"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" AS ""h"" LEFT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""h"".""home_team_id"" GROUP BY ""home_team_id"" UNION ALL SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" AS ""a"" LEFT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""a"".""away_team_id"" GROUP BY ""away_team_id"") AS ""l"" GROUP BY ""l"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
339,"SELECT ""e"".""team_name"",""d"".""matches_played"",""d"".""points"",""d"".""goal_for"",""d"".""goal_against"",""d"".""goal_diff"" FROM (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_points"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_points"" FROM ""Matches"") AS ""a"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_points"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_points"" FROM ""Matches"") AS ""a"") AS ""b"" GROUP BY ""team_id"") AS ""d"" LEFT JOIN ""Teams"" AS ""e"" ON ""d"".""team_id""=""e"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
340,"SELECT ""t"".""team_name"" AS ""team_name"",COUNT(""m"".""team_id"") AS ""matches_played"",SUM(""m"".""points"") AS ""points"",SUM(""m"".""goal_for"") AS ""goal_for"",SUM(""m"".""goal_against"") AS ""goal_against"",SUM(""m"".""goal_for"")-SUM(""m"".""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END FROM ""Matches"") AS ""m"" ON (""t"".""team_id""=""m"".""team_id"") GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
341,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",(SUM(""goals_for"")-SUM(""goals_against"")) AS ""goal_diff"" FROM (SELECT ""team_id"",""team_name"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goals_for"",SUM(""away_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE (CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) END) AS ""points"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""home_team_id"" GROUP BY ""team_id"",""team_name"" UNION SELECT ""team_id"",""team_name"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goals_for"",SUM(""home_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE (CASE WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) END) AS ""points"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""away_team_id"" GROUP BY ""team_id"",""team_name"") AS ""t"" GROUP BY ""team_id"",""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
342,"WITH ""m"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""score"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END FROM ""Matches"") SELECT ""team_name"",COUNT(""m"".""team_id"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""m"" JOIN ""Teams"" ON ""m"".""team_id""=""Teams"".""team_id"" GROUP BY ""m"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
343,"SELECT * FROM (SELECT ""b"".""team_name"",SUM(""a"".""matches_played"") AS ""matches_played"",SUM(""a"".""points"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ((SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",COUNT(""away_team_id"") AS ""matches_played"" FROM ""Matches"" GROUP BY ""home_team_id"") UNION ALL (SELECT ""away_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",COUNT(""home_team_id"") AS ""matches_played"" FROM ""Matches"" GROUP BY ""away_team_id"")) AS ""a"" JOIN ""Teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY ""a"".""team_id"") AS ""c"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
344,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",COUNT(""t"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""m"".""home_team_goals"") AS ""goal_for"",SUM(""m"".""away_team_goals"") AS ""goal_against"",SUM(""m"".""home_team_goals"")-SUM(""m"".""away_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" GROUP BY ""t"".""team_id"" UNION ALL SELECT ""t1"".""team_name"",COUNT(""t1"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""m1"".""away_team_goals"">""m1"".""home_team_goals"" THEN 3 WHEN ""m1"".""away_team_goals""=""m1"".""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""m1"".""away_team_goals"") AS ""goal_for"",SUM(""m1"".""home_team_goals"") AS ""goal_against"",SUM(""m1"".""away_team_goals"")-SUM(""m1"".""home_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""t1"" JOIN ""Matches"" AS ""m1"" ON ""t1"".""team_id""=""m1"".""away_team_id"" GROUP BY ""t1"".""team_id"") AS ""t"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
345,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""scored_for"",""away_team_goals"" AS ""scored_agnst"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""scored_for"",""home_team_goals"" AS ""scored_agnst"" FROM ""Matches""), ""cte2"" AS (SELECT ""team_name"",""t"".""team_id"",""scored_for"",""scored_agnst"" FROM ""cte"" JOIN ""Teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"") SELECT ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""scored_for"">""scored_agnst"" THEN 3 WHEN ""scored_for""=""scored_agnst"" THEN 1 ELSE 0 END) AS ""points"",SUM(""scored_for"") AS ""goal_for"",SUM(""scored_agnst"") AS ""goal_against"",SUM(""scored_for""-""scored_agnst"") AS ""goal_diff"" FROM ""cte2"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
346,"WITH ""cte"" AS (SELECT ""t5"".""team_id"",""t"".""team_name"",""t5"".""points"" FROM (SELECT ""t4"".""team_id"" AS ""team_id"",((""t4"".""wins"")*3+(""t4"".""loss"")*0+(""t4"".""draw"")*1) AS ""points"" FROM (SELECT ""t3"".""team_id"" AS ""team_id"",SUM(""t3"".""wins"") AS ""wins"",SUM(""t3"".""loss"") AS ""loss"",SUM(""t3"".""draw"") AS ""draw"" FROM ((SELECT ""home_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 1 ELSE 0 END) AS ""wins"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 1 ELSE 0 END) AS ""loss"",SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""draw"" FROM ""Matches"" GROUP BY 1) UNION ALL (SELECT ""away_team_id"" AS ""team_id"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 1 ELSE 0 END) AS ""wins"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 1 ELSE 0 END) AS ""loss"",SUM(CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""draw"" FROM ""Matches"" GROUP BY 1)) AS ""t3"" GROUP BY 1) AS ""t4"") AS ""t5"" LEFT JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""t5"".""team_id"") SELECT ""cte"".""team_name"" AS ""team_name"",""t6"".""matches_played"" AS ""matches_played"",""cte"".""points"" AS ""points"",""t6"".""goals_for"" AS ""goal_for"",""t6"".""goals_against"" AS ""goal_against"",""t6"".""goal_diff"" AS ""goal_diff"" FROM ""cte"" JOIN (SELECT ""sub1"".""team_id"" AS ""team_id"",""sub1"".""matches_played"" AS ""matches_played"",""sub1"".""goals_for"" AS ""goals_for"",""sub2"".""goals_against"" AS ""goals_against"",""sub1"".""goals_for""-""sub2"".""goals_against"" AS ""goal_diff"" FROM (SELECT ""t1"".""team_id"" AS ""team_id"",SUM(""t1"".""matches_played"") AS ""matches_played"",SUM(""t1"".""goals_for"") AS ""goals_for"" FROM ((SELECT ""home_team_id"" AS ""team_id"",COUNT(""home_team_goals"") AS ""matches_played"",SUM(""home_team_goals"") AS ""goals_for"" FROM ""Matches"" GROUP BY 1) UNION ALL (SELECT ""away_team_id"",COUNT(""away_team_goals"") AS ""matches_played"",SUM(""away_team_goals"") AS ""goals_for"" FROM ""Matches"" GROUP BY 1)) AS ""t1"" GROUP BY 1) AS ""sub1"" JOIN (SELECT ""t2"".""team_id"" AS ""team_id"",SUM(""t2"".""matches_played"") AS ""matches_played"",SUM(""t2"".""goals_against"") AS ""goals_against"" FROM ((SELECT ""home_team_id"" AS ""team_id"",COUNT(""away_team_goals"") AS ""matches_played"",SUM(""away_team_goals"") AS ""goals_against"" FROM ""Matches"" GROUP BY 1) UNION ALL (SELECT ""away_team_id"",COUNT(""home_team_goals"") AS ""matches_played"",SUM(""home_team_goals"") AS ""goals_against"" FROM ""Matches"" GROUP BY 1)) AS ""t2"" GROUP BY 1) AS ""sub2"" ON ""sub1"".""team_id""=""sub2"".""team_id"" AND ""sub1"".""matches_played""=""sub2"".""matches_played"") AS ""t6"" ON ""cte"".""team_id""=""t6"".""team_id"" ORDER BY ""cte"".""points"" DESC,""t6"".""goal_diff"" DESC,""cte"".""team_name"""
347,"SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END AS ""points"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_for"",CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") AS ""a"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
348,"WITH ""agg"" AS (SELECT ""home_team_id"" AS ""team_id"",""away_team_id"" AS ""team_against"",""home_team_goals"" AS ""goal"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""home_team_id"" AS ""team_against"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") SELECT ""t"".""team_name"",COUNT(""agg"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""goal"">""goal_against"" THEN 3 WHEN ""goal""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""agg"" JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""agg"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
349,"WITH ""CTE1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_team_point"" FROM ""matches""), ""CTE2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""h_goals"",""home_team_point"" AS ""points"",""away_team_goals"" AS ""a_goals"" FROM ""CTE1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""h_goals"",""away_team_point"" AS ""points"",""home_team_goals"" AS ""a_goals"" FROM ""CTE1"") SELECT ""t"".""team_name"",COUNT(""c"".""team_id"") AS ""matches_played"",SUM(""c"".""points"") AS ""points"",SUM(""c"".""h_goals"") AS ""goal_for"",SUM(""c"".""a_goals"") AS ""goal_against"",SUM(""c"".""h_goals"")-SUM(""c"".""a_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""CTE2"" AS ""c"" ON ""t"".""team_id""=""c"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
350,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
351,"WITH ""home_team"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""away_team"" AS (SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches""), ""combined"" AS (SELECT * FROM ""home_team"" UNION ALL SELECT * FROM ""away_team""), ""stats"" AS (SELECT ""team_id"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM ""combined"" GROUP BY ""team_id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""stats"" LEFT JOIN ""teams"" ON ""stats"".""team_id""=""teams"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
352,"WITH ""a"" AS (SELECT ""home_team_id"" AS ""team"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""pts"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""pts"" FROM ""Matches""), ""b"" AS (SELECT ""team"",COUNT(1) AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team"" FROM ""Matches"") AS ""s"" GROUP BY 1), ""c"" AS (SELECT ""team"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""Matches"" GROUP BY 1) AS ""z"" GROUP BY 1) SELECT ""t"".""team_name"",""matches_played"",SUM(""pts"") AS ""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ((""a"" JOIN ""b"" ON ""a"".""team""=""b"".""team"") JOIN ""c"" ON ""a"".""team""=""c"".""team"") JOIN ""Teams"" AS ""t"" ON ""t"".""team_id""=""a"".""team"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,1"
353,"WITH ""cte_allteam"" AS (SELECT ""home_team_id"" AS ""plyr1"",""away_team_id"" AS ""plyr2"",""home_team_goals"" AS ""plyr1goals"",""away_team_goals"" AS ""plyr2goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""plyr1"",""home_team_id"" AS ""plyr2"",""away_team_goals"" AS ""plyr1goals"",""home_team_goals"" AS ""plyr2goals"" FROM ""matches""), ""cte_score"" AS (SELECT *,CASE WHEN ""plyr1goals"">""plyr2goals"" THEN 3 WHEN ""plyr1goals""<""plyr2goals"" THEN 0 ELSE 1 END AS ""score"" FROM ""cte_allteam"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""plyr1goals"") AS ""goal_for"",SUM(""plyr2goals"") AS ""goal_against"",SUM(""plyr1goals"")-SUM(""plyr2goals"") AS ""goal_diff"" FROM ""cte_score"" AS ""cs"" JOIN ""Teams"" AS ""t"" ON ""cs"".""plyr1""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
354,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals""-""m"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals""-""m"".""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
355,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
356,"WITH ""temp"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY 1 UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY 1) SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""temp"" AS ""te"" LEFT JOIN ""teams"" AS ""tm"" ON ""te"".""team_id""=""tm"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,1"
357,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"",""away_team_goals"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",(SUM(""home_team_goals"")-SUM(""away_team_goals"")) AS ""goal_diff"" FROM ""cte"" AS ""c"" LEFT JOIN ""Teams"" USING (""team_id"") GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
358,"WITH ""normalized_goal"" AS (SELECT ""t"".""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""m"".""home_team_id""=""t"".""team_id"" UNION ALL SELECT ""t"".""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""m"".""away_team_id""=""t"".""team_id"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""a"".""points"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""normalized_goal"" AS ""a"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""a"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
359,"WITH ""stat"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""point"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""away_point"",""away_team_goals"",""home_team_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""point"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""stat"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id"" GROUP BY ""team_name"" ORDER BY SUM(""point"") DESC,SUM(""goal_for""-""goal_against"") DESC,""team_name"""
360,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals""=""m"".""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END) AS ""goal_against"",(SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE ""m"".""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE ""m"".""home_team_goals"" END)) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
361,"SELECT ""t1"".""team_name"",COUNT(""t2"".""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""t2"".""home_team_goals"">""t2"".""away_team_goals"" THEN 3 WHEN ""t2"".""home_team_goals""=""t2"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""t2"".""home_team_goals"") AS ""goal_for"",SUM(""t2"".""away_team_goals"") AS ""goal_against"",SUM(""t2"".""home_team_goals""-""t2"".""away_team_goals"") AS ""goal_diff"" FROM ""Teams"" AS ""t1"" JOIN (SELECT * FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") AS ""t2"" ON ""t1"".""team_id""=""t2"".""home_team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
362,"WITH ""Stats"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_points"" FROM ""Matches""), ""Summary"" AS (SELECT ""home_team_id"",""home_team_goals"",""home_points"",""away_team_goals"" FROM ""Stats"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""away_points"",""home_team_goals"" FROM ""Stats"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""home_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Summary"" AS ""s"" LEFT JOIN ""Teams"" AS ""t"" ON ""s"".""home_team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
363,"WITH ""table1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""away_team_points"" FROM ""Matches""), ""table2"" AS ((SELECT ""home_team_id"",""team_name"",""home_team_goals"",""home_team_points"",""away_team_goals"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""table1"" ON ""t"".""team_id""=""table1"".""home_team_id"") UNION ALL (SELECT ""away_team_id"",""team_name"",""away_team_goals"",""away_team_points"",""home_team_goals"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""table1"" ON ""t"".""team_id""=""table1"".""away_team_id"")) SELECT ""team_name"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""home_team_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""table2"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
364,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
365,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
366,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_team_goals""-""away_team_goals"" AS ""goal_diff"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",1 AS ""matches_played"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_team_goals""-""home_team_goals"" AS ""goal_diff"" FROM ""matches"") AS ""a"" LEFT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
367,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
368,"SELECT ""team_name"",COUNT(""team"") AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home""-""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""team""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
369,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM (SELECT ""home_team_id"",COUNT(""home_team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",(SUM(""home_team_goals"")-SUM(""away_team_goals"")) AS ""goal_diff"" FROM (SELECT ""home_team_id"",""away_team_id"",""away_team_goals"",""home_team_goals"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END) AS ""points"" FROM (SELECT * FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""home_team_id"",""away_team_goals"",""home_team_goals"" FROM ""Matches"") AS ""temp1"") AS ""temp"" GROUP BY 1) AS ""temp12"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""temp12"".""home_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
370,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_name"") AS ""t"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
371,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""p_m"" JOIN ""teams"" ON ""p_m"".""team_id""=""teams"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
372,"WITH ""t1"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""<""goal_against"" THEN 0 ELSE 1 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""t1"" JOIN ""teams"" AS ""b"" ON ""t1"".""team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
373,"WITH ""A"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""A"" AS ""a"" ON ""t"".""team_id""=""a"".""id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
374,"WITH ""score"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""point"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""point"" FROM ""Matches"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(""s"".""team_id"") AS ""matches_played"",SUM(""s"".""point"") AS ""points"",SUM(""s"".""goal_for"") AS ""goal_for"",SUM(""s"".""goal_against"") AS ""goal_against"",SUM(""s"".""goal_for"")-SUM(""s"".""goal_against"") AS ""goal_diff"" FROM ""score"" AS ""s"" JOIN ""Teams"" AS ""t"" ON ""s"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
375,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""away_team_goals"" END)-SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""away_team_goals"" WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
376,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""t1_id"",""home_team_goals"" AS ""t1_goals"",""away_team_goals"" AS ""t2_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""t1_id"",""away_team_goals"" AS ""t1_goals"",""home_team_goals"" AS ""t2_goals"" FROM ""matches"") SELECT ""t"".""team_name"" AS ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""t1_goals"">""t2_goals"" THEN 3 WHEN ""t1_goals""=""t2_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""t1_goals"") AS ""goal_for"",SUM(""t2_goals"") AS ""goal_against"",SUM(""t1_goals"")-SUM(""t2_goals"") AS ""goal_diff"" FROM ""cte"" AS ""c"" JOIN ""teams"" AS ""t"" ON ""c"".""t1_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
377,"SELECT ""t"".""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""a"" LEFT JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
378,"SELECT ""T"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""home_team_id"",""away_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""Matches"" AS ""M"" JOIN ""Teams"" ON (""team_id"" IN (""home_team_id"",""away_team_id"")) GROUP BY ""team_id"") AS ""T"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
379,"WITH ""points"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_wins"",(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_wins"" FROM ""matches"" GROUP BY ""home_team_id"",""away_team_id""), ""played"" AS (SELECT ""id"",SUM(""cnt"") AS ""matches_played"",SUM(""wins"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""id"",COUNT(""home_team_id"") AS ""cnt"",SUM(""home_wins"") AS ""wins"" FROM ""points"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""id"",COUNT(""away_team_id"") AS ""cnt"",SUM(""away_wins"") AS ""wins"" FROM ""points"" GROUP BY ""away_team_id"") AS ""a"" GROUP BY ""id""), ""goal_for"" AS (SELECT ""home_team_id"" AS ""id"",SUM(""s"") AS ""goal_for"" FROM (SELECT ""home_team_id"",SUM(""home_team_goals"") AS ""s"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"",SUM(""away_team_goals"") AS ""s"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""a"" GROUP BY ""home_team_id""), ""goal_against"" AS (SELECT ""id"",SUM(""s"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""id"",SUM(""away_team_goals"") AS ""s"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""id"",SUM(""home_team_goals"") AS ""s"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""a"" GROUP BY ""id""), ""final"" AS (SELECT ""played"".""id"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (""played"" JOIN ""goal_for"" ON ""played"".""id""=""goal_for"".""id"") JOIN ""goal_against"" ON ""goal_for"".""id""=""goal_against"".""id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""teams"" JOIN ""final"" ON ""teams"".""team_id""=""final"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
380,"SELECT ""team_name"",SUM(""X"".""f"") AS ""matches_played"",SUM(""X"".""b"") AS ""points"",SUM(""X"".""c"") AS ""goal_for"",SUM(""x"".""d"") AS ""goal_against"",SUM(""X"".""e"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""a"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 END) AS ""b"",SUM(""home_team_goals"") AS ""c"",SUM(""away_team_goals"") AS ""d"",(SUM(""home_team_goals"")-SUM(""away_team_goals"")) AS ""e"",COUNT(""home_team_id"") AS ""f"" FROM ""Matches"" AS ""m"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""a"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 END) AS ""b"",SUM(""away_team_goals"") AS ""c"",SUM(""home_team_goals"") AS ""d"",(SUM(""away_team_goals"")-SUM(""home_team_goals"")) AS ""e"",COUNT(""away_team_id"") AS ""f"" FROM ""Matches"" AS ""m1"" GROUP BY ""away_team_id"") AS ""X"" JOIN ""Teams"" ON ""X"".""a""=""Teams"".""team_id"" GROUP BY ""X"".""a"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
381,"SELECT *,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id""=""home_team_id"")+SUM(""team_id""=""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_name"") AS ""sub"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
382,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",COUNT(""away_team_id"") AS ""matches"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY 1 UNION SELECT ""away_team_id"" AS ""team_id"",COUNT(""home_team_id"") AS ""matches"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"" FROM ""matches"" GROUP BY 1) SELECT ""t"".""team_name"",SUM(""matches"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""teams"" AS ""t"" LEFT JOIN ""cte"" ON ""t"".""team_id""=""cte"".""team_id"" GROUP BY 1 HAVING ""matches_played"">0 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
383,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goals_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" AS ""C"" JOIN ""Teams"" AS ""T"" ON ""C"".""team_id""=""T"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
384,"WITH ""t1"" AS (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_point"",""home_team_goals"",""away_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END AS ""away_team_point"",""away_team_goals"" FROM ""Matches""), ""t2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_point"" AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""t1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_point"" AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""t1""), ""t3"" AS (SELECT ""team_id"",COUNT(""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM ""t2"" GROUP BY 1) SELECT ""T"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""t3"".""goal_for""-""t3"".""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""t3"" ON ""T"".""team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
385,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""scored_for"",""away_team_goals"" AS ""scored_agnst"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""scored_for"",""home_team_goals"" AS ""scored_agnst"" FROM ""Matches""), ""cte2"" AS (SELECT ""team_name"",""t"".""team_id"",""scored_for"",""scored_agnst"" FROM ""cte"" JOIN ""Teams"" AS ""t"" ON ""cte"".""team_id""=""t"".""team_id"") SELECT ""team_name"",COUNT(""team_id"") AS ""matches_played"",SUM(CASE WHEN ""scored_for"">""scored_agnst"" THEN 3 WHEN ""scored_for""=""scored_agnst"" THEN 1 ELSE 0 END) AS ""points"",SUM(""scored_for"") AS ""goal_for"",SUM(""scored_agnst"") AS ""goal_against"",SUM(""scored_for"")-SUM(""scored_agnst"") AS ""goal_diff"" FROM ""cte2"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
386,"WITH ""home_score"" AS (SELECT ""home_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",(""home_team_goals""-""away_team_goals"") AS ""goal_diff"" FROM ""Matches""), ""away_score"" AS (SELECT ""away_team_id"" AS ""team_id"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",(""away_team_goals""-""home_team_goals"") AS ""goal_diff"" FROM ""Matches""), ""allscore"" AS (SELECT * FROM ""home_score"" UNION ALL SELECT * FROM ""away_score""), ""ans"" AS (SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""teams"" JOIN ""allscore"" ON ""teams"".""team_id""=""allscore"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"") SELECT * FROM ""ans"""
387,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
388,"WITH ""cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""cte"") SELECT ""b"".""team_name"",COUNT(""b"".""team_name"") AS ""matches_played"",SUM(""a"".""score"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""cte2"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""b"".""team_id""=""a"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""b"".""team_name"""
389,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goals_for""-""goals_against"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN (SELECT CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 1 END AS ""points"",""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"" FROM ""matches"" UNION ALL SELECT (CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"" FROM ""matches"") AS ""p"" ON ""t"".""team_id""=""p"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
390,"WITH ""temp"" AS (SELECT *,(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""home_points"",(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""away_points"" FROM ""Matches""), ""score_table"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",""home_points"" AS ""score"" FROM ""temp"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",""away_points"" AS ""score"" FROM ""temp"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""score"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM (SELECT ""Teams"".""team_name"",""score_table"".""goal_for"",""score_table"".""goal_against"",""score_table"".""score"" FROM ""score_table"" LEFT JOIN ""Teams"" ON ""Teams"".""team_id""=""score_table"".""team_id"") AS ""join_score"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
391,"SELECT ""T"".""team_name"",SUM(""M"".""home_team_id""=""T"".""team_id"")+SUM(""M"".""away_team_id""=""T"".""team_id"") AS ""matches_played"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" AND ""M"".""home_team_goals"">""M"".""away_team_goals"" THEN 3 WHEN ""M"".""home_team_id""=""T"".""team_id"" AND ""M"".""home_team_goals""<""M"".""away_team_goals"" THEN 0 WHEN ""M"".""away_team_id""=""T"".""team_id"" AND ""M"".""away_team_goals"">""M"".""home_team_goals"" THEN 3 WHEN ""M"".""away_team_id""=""T"".""team_id"" AND ""M"".""away_team_goals""<""M"".""home_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN ""M"".""home_team_goals"" ELSE ""M"".""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN ""M"".""away_team_goals"" ELSE ""M"".""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN ""M"".""home_team_goals"" ELSE ""M"".""away_team_goals"" END)-SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN ""M"".""away_team_goals"" ELSE ""M"".""home_team_goals"" END) AS ""goal_diff"" FROM ""Matches"" AS ""M"" JOIN ""Teams"" AS ""T"" ON ""M"".""home_team_id""=""T"".""team_id"" OR ""M"".""away_team_id""=""T"".""team_id"" GROUP BY ""T"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
392,"WITH ""T1"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""home_team_pts"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""away_team_pts"" FROM ""Matches"" AS ""M""), ""T2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""GF"",""away_team_goals"" AS ""GA"",""home_team_goals""-""away_team_goals"" AS ""GD"",""home_team_pts"" AS ""pt"" FROM ""T1"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""GF"",""home_team_goals"" AS ""GA"",""away_team_goals""-""home_team_goals"" AS ""GD"",""away_team_pts"" AS ""pt"" FROM ""T1"") SELECT ""T"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""T2"".""pt"") AS ""points"",SUM(""T2"".""GF"") AS ""goal_for"",SUM(""T2"".""GA"") AS ""goal_against"",SUM(""T2"".""GD"") AS ""goal_diff"" FROM ""T2"" JOIN ""Teams"" AS ""T"" ON ""T2"".""team_id""=""T"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
393,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY ""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
394,"WITH ""win_or_lose"" AS (SELECT ""team_id"",SUM(""matches"") AS ""matches_played"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""points"") AS ""points"" FROM (SELECT 1 AS ""matches"",""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""points"" FROM ""matches"" WHERE ""home_team_goals""!=""away_team_goals"" UNION ALL SELECT 1 AS ""matches"",""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 END AS ""points"" FROM ""matches"" WHERE ""home_team_goals""!=""away_team_goals"") AS ""f"" GROUP BY 1), ""tie"" AS (SELECT ""team_id"",SUM(""matches"") AS ""matches_played"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""points"") AS ""points"" FROM (SELECT 1 AS ""matches"",""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",1 AS ""points"" FROM ""matches"" WHERE ""home_team_goals""=""away_team_goals"" UNION ALL SELECT 1 AS ""matches"",""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",1 AS ""points"" FROM ""matches"" WHERE ""home_team_goals""=""away_team_goals"") AS ""f"" GROUP BY 1) SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_id"",""matches_played"",""goal_for"",""goal_against"",""points"" FROM ""tie"" UNION ALL SELECT ""team_id"",""matches_played"",""goal_for"",""goal_against"",""points"" FROM ""win_or_lose"") AS ""f"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id""=""f"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
395,"WITH ""cte"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_team_points"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_team_points"" FROM ""Matches""), ""cte2"" AS (SELECT ""T"".""team_name"",COUNT(""C"".""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""C"".""home_team_id""=""t"".""team_id"" THEN ""C"".""home_team_points"" ELSE 0 END)+SUM(CASE WHEN ""C"".""away_team_id""=""t"".""team_id"" THEN ""C"".""away_team_points"" ELSE 0 END) AS ""points"",SUM(CASE WHEN ""C"".""home_team_id""=""t"".""team_id"" THEN ""C"".""home_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""C"".""away_team_id""=""t"".""team_id"" THEN ""C"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""C"".""home_team_id""=""t"".""team_id"" THEN ""C"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""C"".""away_team_id""=""t"".""team_id"" THEN ""C"".""home_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Teams"" AS ""T"" LEFT JOIN ""cte"" AS ""C"" ON ""T"".""team_id""=""C"".""home_team_id"" OR ""T"".""team_id""=""C"".""away_team_id"" GROUP BY ""T"".""team_id"" ORDER BY ""points"" DESC) SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""cte2"" GROUP BY ""team_name"" HAVING ""matches_played"">0 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
396,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_point"" ELSE ""away_point"" END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_against"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END)-SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE ""home_team_goals"" END) AS ""goal_diff"" FROM (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END AS ""home_point"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE CASE WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END END AS ""away_point"" FROM ""matches"" AS ""m"" JOIN ""teams"" AS ""t"" ON ""t"".""team_id"" IN (""m"".""home_team_id"",""m"".""away_team_id"")) AS ""ff"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
397,"SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_for""-""goal_against"" AS ""goal_diff"" FROM ""Teams"" AS ""t2"" JOIN (SELECT ""team_id"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" USING (""team_id"") ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
398,"WITH ""cte"" AS (SELECT *,CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""home_score"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""away_score"" FROM ""Matches""), ""cte2"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_score"" AS ""score"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""cte"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_score"" AS ""score"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""cte"") SELECT ""b"".""team_name"",COUNT(""b"".""team_name"") AS ""matches_played"",SUM(""a"".""score"") AS ""points"",SUM(""a"".""goal_for"") AS ""goal_for"",SUM(""a"".""goal_against"") AS ""goal_against"",SUM(""a"".""goal_for"")-SUM(""a"".""goal_against"") AS ""goal_diff"" FROM ""cte2"" AS ""a"" JOIN ""Teams"" AS ""b"" ON ""b"".""team_id""=""a"".""team_id"" GROUP BY ""b"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""b"".""team_name"""
399,"SELECT ""Teams"".""team_name"",""sub"".""matches_played"",""sub"".""points"",""sub"".""goal_for"",""sub"".""goal_against"",""sub"".""goal_diff"" FROM (SELECT ""home_id"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""home_goals"") AS ""goal_for"",SUM(""away_goals"") AS ""goal_against"",SUM(""home_goals"")-SUM(""away_goals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""home_id"",""away_team_id"" AS ""away_id"",""home_team_goals"" AS ""home_goals"",""away_team_goals"" AS ""away_goals"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE 1 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""home_id"",""home_team_id"" AS ""away_id"",""away_team_goals"" AS ""home_goals"",""home_team_goals"" AS ""away_goals"",CASE WHEN ""away_team_goals""<""home_team_goals"" THEN 0 WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE 1 END AS ""points"" FROM ""Matches"") AS ""total"" GROUP BY ""home_id"") AS ""sub"" JOIN ""Teams"" ON ""Teams"".""team_id""=""sub"".""home_id"" ORDER BY ""sub"".""points"" DESC,""sub"".""goal_diff"" DESC,""Teams"".""team_name"""
400,"SELECT ""team_name"",COUNT(""oppo"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""away_team_id"" AS ""oppo"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""home_team_id"" AS ""oppo"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 END AS ""points"" FROM ""matches"") AS ""a"" LEFT JOIN ""teams"" AS ""b"" ON ""a"".""team_id""=""b"".""team_id"" GROUP BY 1 ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
401,"SELECT ""sub"".*,(""goal_for""-""goal_against"") AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id""=""home_team_id"")+SUM(""team_id""=""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" END) AS ""goal_against"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_name"") AS ""sub"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
402,"SELECT ""t1"".*,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",SUM(""team_id"" IN (""away_team_id"",""home_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""away_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" ELSE 0 END) AS ""goal_against"" FROM ""Matches"" AS ""m"" JOIN ""Teams"" ON (""team_id"" IN (""away_team_id"",""home_team_id"")) GROUP BY ""team_id"") AS ""t1"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
403,"SELECT ""t3"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM (SELECT ""t"".""home_team_id"",SUM(""t"".""n_home"") AS ""matches_played"",SUM(""homescores"") AS ""points"",SUM(""homegoals"") AS ""goal_for"",SUM(""awaygoals"") AS ""goal_against"",SUM(""homegoals"")-SUM(""awaygoals"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",COUNT(""away_team_id"") AS ""n_home"",SUM(""home_team_goals"") AS ""homegoals"",SUM(""away_team_goals"") AS ""awaygoals"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END END) AS ""homescores"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL (SELECT ""away_team_id"",COUNT(""away_team_id"") AS ""n_home"",SUM(""away_team_goals"") AS ""homegoals"",SUM(""home_team_goals"") AS ""awaygoals"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE CASE WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 3 END END) AS ""homescores"" FROM ""Matches"" GROUP BY ""away_team_id"")) AS ""t"" GROUP BY ""t"".""home_team_id"") AS ""t2"" LEFT JOIN ""Teams"" AS ""t3"" ON ""t2"".""home_team_id""=""t3"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t3"".""team_name"""
404,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""team_goals"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"",""away_team_goals"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""team_goals"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""team_goals"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" AS ""c1"" JOIN ""Teams"" AS ""t"" ON ""c1"".""team_id""=""t"".""team_id"" GROUP BY ""c1"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
405,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
406,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",(SUM(""goals_for"")-SUM(""goals_against"")) AS ""goal_diff"" FROM (SELECT ""team_id"",""team_name"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goals_for"",SUM(""away_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE (CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) END) AS ""points"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""home_team_id"" GROUP BY ""team_id"",""team_name"" UNION ALL SELECT ""team_id"",""team_name"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goals_for"",SUM(""home_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE (CASE WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) END) AS ""points"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""away_team_id"" GROUP BY ""team_id"",""team_name"") AS ""t"" GROUP BY ""team_id"",""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
407,"SELECT ""team_name"",COUNT(""a"".""team_id"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",(SUM(""goal_for"")-SUM(""goal_against"")) AS ""goal_diff"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 END AS ""points"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 0 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""home_team_goals""<""away_team_goals"" THEN 3 END AS ""points"" FROM ""Matches"") AS ""a"" JOIN ""Teams"" AS ""t"" ON ""a"".""team_id""=""t"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
408,"WITH ""A"" AS (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(""id"") AS ""matches_played"",SUM(CASE WHEN ""goal_for"">""goal_against"" THEN 3 WHEN ""goal_for""=""goal_against"" THEN 1 ELSE 0 END) AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""A"" AS ""a"" ON ""t"".""team_id""=""a"".""id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
409,"WITH ""cte"" AS (SELECT ""t"".""team_name"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""t"".""team_id""=""m"".""home_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""=""away_team_goals"" THEN 1 WHEN ""t"".""team_id""=""m"".""away_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 3 ELSE 0 END AS ""points"",CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_for"",CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""home_team_goals"" ELSE ""away_team_goals"" END AS ""goal_against"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
410,"WITH ""match_long"" AS (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""goals_for"",""away_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""goals_for"",""home_team_goals"" AS ""goals_against"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals"">""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",SUM(""goals_for"")-SUM(""goals_against"") AS ""goal_diff"" FROM ""match_long"" AS ""ml"" JOIN ""teams"" AS ""t"" USING (""team_id"") GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
411,"SELECT ""team_name"",COALESCE(SUM(""matches_played""), 0) AS ""matches_played"",SUM(""total_points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN (SELECT ""home_team_id"" AS ""team_id"",COALESCE(COUNT(1), 0) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""total_points"",SUM(""home_team_goals"") AS ""goal_for"",SUM(""away_team_goals"") AS ""goal_against"",SUM(""home_team_goals"")-SUM(""away_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",COALESCE(COUNT(1), 0) AS ""matches_played"",SUM(CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""total_points"",SUM(""away_team_goals"") AS ""goal_for"",SUM(""home_team_goals"") AS ""goal_against"",SUM(""away_team_goals"")-SUM(""home_team_goals"") AS ""goal_diff"" FROM ""Matches"" GROUP BY ""away_team_id"") AS ""m"" ON ""m"".""team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" ORDER BY 3 DESC,6 DESC,1"
412,"WITH ""cte1"" AS (SELECT ""home_team_id"" AS ""tn"",COUNT(""home_team_id"") AS ""mp"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""pt"",SUM(""home_team_goals"") AS ""gf"",SUM(""away_team_goals"") AS ""ga"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"" AS ""tn"",COUNT(""away_team_id"") AS ""mp"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END) AS ""pt"",SUM(""away_team_goals"") AS ""gf"",SUM(""home_team_goals"") AS ""ga"" FROM ""matches"" GROUP BY ""away_team_id"") SELECT ""t"".""team_name"" AS ""team_name"",SUM(""mp"") AS ""matches_played"",SUM(""pt"") AS ""points"",SUM(""gf"") AS ""goal_for"",SUM(""ga"") AS ""goal_against"",SUM(""gf""-""ga"") AS ""goal_diff"" FROM ""cte1"" LEFT JOIN ""teams"" AS ""t"" ON ""cte1"".""tn""=""t"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,6 DESC,""team_name"""
413,"SELECT ""TEAMS"".""TEAM_NAME"" AS ""team_name"",COUNT(""B"".""TEAM_ID"") AS ""matches_played"",SUM(CASE WHEN ""B"".""SCORED_FOR"">""B"".""SCORED_AGA"" THEN 3 WHEN ""B"".""SCORED_FOR""=""B"".""SCORED_AGA"" THEN 1 ELSE 0 END) AS ""points"",SUM(""B"".""SCORED_FOR"") AS ""goal_for"",SUM(""B"".""SCORED_AGA"") AS ""goal_against"",SUM(""B"".""SCORED_FOR""-""B"".""SCORED_AGA"") AS ""goal_diff"" FROM (SELECT ""HOME_TEAM_ID"" AS ""TEAM_ID"",""HOME_TEAM_GOALS"" AS ""SCORED_FOR"",""AWAY_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"" UNION ALL SELECT ""AWAY_TEAM_ID"" AS ""TEAM_ID"",""AWAY_TEAM_GOALS"" AS ""SCORED_FOR"",""HOME_TEAM_GOALS"" AS ""SCORED_AGA"" FROM ""MATCHES"") AS ""B"" JOIN ""TEAMS"" ON ""B"".""TEAM_ID""=""TEAMS"".""TEAM_ID"" GROUP BY 1,""B"".""TEAM_ID"" ORDER BY ""POINTS"" DESC,""GOAL_DIFF"" DESC,""TEAM_NAME"""
414,"SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN (""t"".""team_id""=""m"".""home_team_id"" AND ""m"".""home_team_goals"">""m"".""away_team_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN (""t"".""team_id""=""m"".""away_team_id"" AND ""m"".""away_team_goals"">""m"".""home_team_goals"") THEN 3 ELSE 0 END)+SUM(CASE WHEN ""m"".""home_team_goals""=""m"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END) AS ""goal_for"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""home_team_goals"" ELSE 0 END) AS ""goal_against"",SUM(CASE WHEN ""t"".""team_id""=""m"".""home_team_id"" THEN ""m"".""home_team_goals""-""m"".""away_team_goals"" ELSE 0 END)+SUM(CASE WHEN ""t"".""team_id""=""m"".""away_team_id"" THEN ""m"".""away_team_goals""-""m"".""home_team_goals"" ELSE 0 END) AS ""goal_diff"" FROM ""Teams"" AS ""t"" JOIN ""Matches"" AS ""m"" ON ""t"".""team_id""=""m"".""home_team_id"" OR ""t"".""team_id""=""m"".""away_team_id"" GROUP BY ""t"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
415,"WITH ""t1"" AS (SELECT ""id"",COUNT(""id"") AS ""matches_played"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""id"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""matches"") AS ""tmp1"" GROUP BY ""id""), ""t2"" AS (SELECT ""id"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""id"",CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"" FROM ""matches"") AS ""tmp2"" GROUP BY ""id"") SELECT ""t"".""team_name"",""t1"".""matches_played"",""t2"".""points"",""t1"".""goal_for"",""t1"".""goal_against"",(""t1"".""goal_for""-""t1"".""goal_against"") AS ""goal_diff"" FROM (""teams"" AS ""t"" JOIN ""t1"" ON ""t"".""team_id""=""t1"".""id"") JOIN ""t2"" ON ""t"".""team_id""=""t2"".""id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
416,"WITH ""CTE"" AS (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""=""away_team_goals"" THEN 1 ELSE 0 END AS ""points"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"" FROM ""Matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""=""home_team_goals"" THEN 1 ELSE 0 END AS ""points"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"" FROM ""Matches"") SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""Teams"" AS ""T"" JOIN ""CTE"" ON ""T"".""team_id""=""CTE"".""team_id"" GROUP BY ""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
417,"WITH ""cte"" AS (SELECT ""home_team_id"" AS ""home_id"",""away_team_id"" AS ""cpn_id"",""home_team_goals"" AS ""home_goals"",""away_team_goals"" AS ""cpn_goals"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_id"",""home_team_id"" AS ""cpn_id"",""away_team_goals"" AS ""home_goals"",""home_team_goals"" AS ""cpn_goals"" FROM ""matches""), ""tab"" AS (SELECT ""a"".""team_name"",""a"".""team_id"",""b"".""cpn_id"",""b"".""home_goals"",""b"".""cpn_goals"",CASE WHEN ""home_goals"">""cpn_goals"" THEN 3 WHEN ""home_goals""<""cpn_goals"" THEN 0 ELSE 1 END AS ""point"" FROM (""teams"" AS ""a"") JOIN ""cte"" AS ""b"" WHERE ""a"".""team_id""=""b"".""home_id"") SELECT ""team_name"",COUNT(""team_name"") AS ""matches_played"",SUM(""point"") AS ""points"",SUM(""home_goals"") AS ""goal_for"",SUM(""cpn_goals"") AS ""goal_against"",SUM(""home_goals""-""cpn_goals"") AS ""goal_diff"" FROM ""tab"" GROUP BY ""team_id"" ORDER BY SUM(""point"") DESC,SUM(""home_goals"")-SUM(""cpn_goals"") DESC,""team_name"""
418,"WITH ""goal_for"" AS (SELECT ""team_id"",SUM(""score"") AS ""goal_for"",COUNT(""team_id"") AS ""matches_played"" FROM (SELECT ""home_team_id"" AS ""team_id"",""home_team_goals"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""away_team_goals"" AS ""score"" FROM ""matches"") AS ""a"" GROUP BY ""team_id""), ""against"" AS (SELECT ""team_id"",SUM(""score"") AS ""goal_against"" FROM (SELECT ""home_team_id"" AS ""team_id"",""away_team_goals"" AS ""score"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",""home_team_goals"" AS ""score"" FROM ""matches"") AS ""a"" GROUP BY ""team_id""), ""points"" AS (SELECT ""team_id"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"" AS ""team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN '3' WHEN ""home_team_goals""<""away_team_goals"" THEN '0' WHEN ""home_team_goals""=""away_team_goals"" THEN '1' ELSE NULL END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN '3' WHEN ""away_team_goals""<""home_team_goals"" THEN '0' WHEN ""away_team_goals""=""away_team_goals"" THEN '1' ELSE NULL END AS ""points"" FROM ""matches"") AS ""a"" GROUP BY ""team_id"") SELECT ""t"".""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ((""teams"" AS ""t"" JOIN ""goal_for"" AS ""gf"" ON ""t"".""team_id""=""gf"".""team_id"") JOIN ""against"" AS ""ga"" ON ""t"".""team_id""=""ga"".""team_id"") JOIN ""points"" AS ""p"" ON ""t"".""team_id""=""p"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
419,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goals_for"") AS ""goal_for"",SUM(""goals_against"") AS ""goal_against"",(SUM(""goals_for"")-SUM(""goals_against"")) AS ""goal_diff"" FROM (SELECT ""team_id"",""team_name"",COUNT(1) AS ""matches_played"",SUM(""home_team_goals"") AS ""goals_for"",SUM(""away_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 ELSE (CASE WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END) END) AS ""points"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""home_team_id"" GROUP BY ""team_id"",""team_name"" UNION SELECT ""team_id"",""team_name"",COUNT(1) AS ""matches_played"",SUM(""away_team_goals"") AS ""goals_for"",SUM(""home_team_goals"") AS ""goals_against"",SUM(CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 ELSE (CASE WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) END) AS ""points"" FROM ""teams"" JOIN ""matches"" ON ""team_id""=""away_team_id"" GROUP BY ""team_id"",""team_name"") AS ""t"" GROUP BY ""team_id"",""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
420,"WITH ""CTE1"" AS (SELECT ""home_team_id"",""away_team_id"",""home_team_goals"",""away_team_goals"",CASE WHEN ""home_team_goals""-""away_team_goals"">0 THEN 3 WHEN ""home_team_goals""-""away_team_goals""=0 THEN 1 ELSE 0 END AS ""home_points"",CASE WHEN ""home_team_goals""-""away_team_goals""<0 THEN 3 WHEN ""home_team_goals""-""away_team_goals""=0 THEN 1 ELSE 0 END AS ""away_points"" FROM ""matches""), ""CTE2"" AS (SELECT ""home_team_id"",""home_team_goals"",""home_points"" FROM ""CTE1"" UNION ALL SELECT ""away_team_id"",""away_Team_goals"",""away_points"" FROM ""CTE1""), ""CTE3"" AS (SELECT ""home_team_id"",COUNT(1) AS ""matches_played"",SUM(""home_points"") AS ""points"",SUM(""home_team_goals"") AS ""goal_for"" FROM ""CTE2"" GROUP BY ""home_team_id""), ""CTE4"" AS (SELECT ""home_team_id"",""away_team_goals"" FROM ""CTE1"" UNION ALL SELECT ""away_team_id"",""home_Team_goals"" FROM ""CTE1""), ""CTE5"" AS (SELECT ""home_team_id"",SUM(""away_team_goals"") AS ""goal_against"" FROM ""CTE4"" GROUP BY ""home_team_id""), ""CTE6"" AS (SELECT ""a"".""home_team_id"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""CTE3"" AS ""a"" JOIN ""CTE5"" AS ""b"" ON ""a"".""home_team_id""=""b"".""home_team_id"") SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",""goal_diff"" FROM ""CTE6"" AS ""a"" JOIN ""teams"" AS ""b"" ON ""a"".""home_team_id""=""b"".""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
421,"SELECT ""team_name"",SUM(""matches_played"") AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_diff"") AS ""goal_diff"" FROM (SELECT ""t"".""team_name"",COUNT(""h"".""home_team_id"") AS ""matches_played"",SUM(CASE WHEN ""h"".""home_team_goals"">""h"".""away_team_goals"" THEN 3 WHEN ""h"".""home_team_goals""=""h"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""h"".""home_team_goals"") AS ""goal_for"",SUM(""h"".""away_team_goals"") AS ""goal_against"",SUM(""h"".""home_team_goals"")-SUM(""h"".""away_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""h"" ON ""h"".""home_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_id"" UNION SELECT ""t"".""team_name"",COUNT(""a"".""away_team_id"") AS ""matches_played"",SUM(CASE WHEN ""a"".""home_team_goals""<""a"".""away_team_goals"" THEN 3 WHEN ""a"".""home_team_goals""=""a"".""away_team_goals"" THEN 1 ELSE 0 END) AS ""points"",SUM(""a"".""away_team_goals"") AS ""goal_for"",SUM(""a"".""home_team_goals"") AS ""goal_against"",SUM(""a"".""away_team_goals"")-SUM(""a"".""home_team_goals"") AS ""goal_diff"" FROM ""teams"" AS ""t"" JOIN ""matches"" AS ""a"" ON ""a"".""away_team_id""=""t"".""team_id"" GROUP BY ""t"".""team_name"") AS ""result_table"" GROUP BY ""team_name"" ORDER BY 3 DESC,6 DESC,1"
422,"WITH ""CTE"" AS (SELECT ""home_team_id"" AS ""team"",""home_team_goals"" AS ""goal_for"",""away_team_goals"" AS ""goal_against"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""team"",""away_team_goals"" AS ""goal_for"",""home_team_goals"" AS ""goal_against"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") SELECT ""t"".""team_name"",COUNT(1) AS ""matches_played"",SUM(""points"") AS ""points"",SUM(""goal_for"") AS ""goal_for"",SUM(""goal_against"") AS ""goal_against"",SUM(""goal_for"")-SUM(""goal_against"") AS ""goal_diff"" FROM ""cte"" JOIN ""teams"" AS ""t"" ON ""cte"".""team""=""t"".""team_id"" GROUP BY ""t"".""team_name"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""t"".""team_name"""
423,"WITH ""cte"" AS (SELECT ""T"".""team_name"",""T"".""team_id"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN +1 WHEN ""M"".""away_team_id""=""T"".""team_id"" THEN +1 ELSE +0 END) AS ""matches_played"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN +""M"".""home_team_goals"" WHEN ""M"".""away_team_id""=""T"".""team_id"" THEN +""M"".""away_team_goals"" ELSE +0 END) AS ""goal_for"",SUM(CASE WHEN ""M"".""home_team_id""=""T"".""team_id"" THEN +""M"".""away_team_goals"" WHEN ""M"".""away_team_id""=""T"".""team_id"" THEN +""M"".""home_team_goals"" ELSE +0 END) AS ""goal_against"",SUM(CASE WHEN ""M"".""home_team_goals"">""M"".""away_team_goals"" AND ""M"".""home_team_id""=""T"".""team_id"" THEN +3 WHEN ""M"".""away_team_goals"">""M"".""home_team_goals"" AND ""M"".""away_team_id""=""T"".""team_id"" THEN +3 WHEN ""M"".""home_team_goals""=""M"".""away_team_goals"" THEN +1 ELSE +0 END) AS ""points"" FROM ""Teams"" AS ""T"" JOIN ""Matches"" AS ""M"" ON ""T"".""team_id""=""M"".""home_team_id"" OR ""T"".""team_id""=""M"".""away_team_id"" GROUP BY 1,2) SELECT ""team_name"",""matches_played"",""points"",""goal_for"",""goal_against"",(""goal_for""-""goal_against"") AS ""goal_diff"" FROM ""cte"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
424,"SELECT ""team_name"",COUNT(1) AS ""matches_played"",SUM(CASE WHEN ""home"">""away"" THEN 3 WHEN ""home""=""away"" THEN 1 ELSE 0 END) AS ""points"",SUM(""home"") AS ""goal_for"",SUM(""away"") AS ""goal_against"",SUM(""home"")-SUM(""away"") AS ""goal_diff"" FROM (SELECT ""home_team_id"",""home_team_goals"" AS ""home"",""away_team_goals"" AS ""away"" FROM ""matches"" UNION ALL SELECT ""away_team_id"" AS ""home_team_id"",""away_team_goals"" AS ""home"",""home_team_goals"" AS ""away"" FROM ""matches"") AS ""g"" JOIN ""teams"" AS ""t"" ON ""g"".""home_team_id""=""t"".""team_id"" GROUP BY 1 ORDER BY 3 DESC,6 DESC,1"
425,"WITH ""goalfor"" AS (SELECT ""home_team_id"",SUM(""goals"") AS ""goal_for"",SUM(""game"") AS ""game"" FROM (SELECT ""home_team_id"",SUM(""home_team_goals"") AS ""goals"",COUNT(1) AS ""game"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"",SUM(""away_team_goals""),COUNT(1) AS ""game"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""k"" GROUP BY ""home_team_id""), ""goalagainst"" AS (SELECT ""home_team_id"",SUM(""goals"") AS ""goal_against"",SUM(""game"") FROM (SELECT ""home_team_id"",SUM(""away_team_goals"") AS ""goals"",COUNT(1) AS ""game"" FROM ""matches"" GROUP BY ""home_team_id"" UNION ALL SELECT ""away_team_id"",SUM(""home_team_goals""),COUNT(1) AS ""game"" FROM ""matches"" GROUP BY ""away_team_id"") AS ""k"" GROUP BY ""home_team_id""), ""point"" AS (SELECT ""home_team_id"",SUM(""points"") AS ""points"" FROM (SELECT ""home_team_id"",CASE WHEN ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""home_team_goals""<""away_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"" UNION ALL SELECT ""away_team_id"",CASE WHEN ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END AS ""points"" FROM ""matches"") AS ""l"" GROUP BY ""home_team_id"") SELECT ""Teams"".""team_name"",""goalfor"".""game"" AS ""matches_played"",""point"".""points"",""goalfor"".""goal_for"",""goalagainst"".""goal_against"",""goalfor"".""goal_for""-""goalagainst"".""goal_against"" AS ""goal_diff"" FROM ((""Teams"" JOIN ""goalfor"" ON ""Teams"".""team_id""=""goalfor"".""home_team_id"") JOIN ""point"" ON ""point"".""home_team_id""=""goalfor"".""home_team_id"") JOIN ""goalagainst"" ON ""goalagainst"".""home_team_id""=""point"".""home_team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
426,"SELECT *,""goal_for""-""goal_against"" AS ""goal_diff"" FROM (SELECT ""team_name"",COUNT((""team_id"") IN (""home_team_id"",""away_team_id"")) AS ""matches_played"",SUM(CASE WHEN ""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"" THEN 3 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals"">""home_team_goals"" THEN 3 WHEN ""team_id""=""home_team_id"" AND ""home_team_goals""<""away_team_goals"" THEN 0 WHEN ""team_id""=""away_team_id"" AND ""away_team_goals""<""home_team_goals"" THEN 0 ELSE 1 END) AS ""points"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""home_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""away_team_goals"" END) AS ""goal_for"",SUM(CASE WHEN ""team_id""=""home_team_id"" THEN ""away_team_goals"" WHEN ""team_id""=""away_team_id"" THEN ""home_team_goals"" END) AS ""goal_against"" FROM ""Teams"" JOIN ""Matches"" ON ""Teams"".""team_id""=""Matches"".""home_team_id"" OR ""Teams"".""team_id""=""Matches"".""away_team_id"" GROUP BY ""Teams"".""team_id"") AS ""temp"" ORDER BY ""temp"".""points"" DESC,""goal_diff"" DESC,""team_name"""
427,"SELECT ""team_name"",SUM(""team_id""=""home_team_id"")+SUM(""team_id""=""away_team_id"") AS ""matches_played"",SUM(""team_id""=""home_team_id"" AND ""home_team_goals"">""away_team_goals"")*3+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""<""away_team_goals"")*3+SUM(""team_id""=""home_team_id"" AND ""home_team_goals""=""away_team_goals"")+SUM(""team_id""=""away_team_id"" AND ""home_team_goals""=""away_team_goals"") AS ""points"",SUM((""team_id""=""home_team_id"")*""home_team_goals"")+SUM((""team_id""=""away_team_id"")*""away_team_goals"") AS ""goal_for"",SUM((""team_id""=""home_team_id"")*""away_team_goals"")+SUM((""team_id""=""away_team_id"")*""home_team_goals"") AS ""goal_against"",SUM((""team_id""=""home_team_id"")*(""home_team_goals""-""away_team_goals""))+SUM((""team_id""=""away_team_id"")*(""away_team_goals""-""home_team_goals"")) AS ""goal_diff"" FROM ""Teams"" JOIN ""Matches"" ON ""team_id""=""home_team_id"" OR ""team_id""=""away_team_id"" GROUP BY ""team_id"" ORDER BY ""points"" DESC,""goal_diff"" DESC,""team_name"""
