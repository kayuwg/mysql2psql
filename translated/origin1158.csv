id,original query
1,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
2,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""CTE"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
3,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""o"".""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" AS ""o"" WHERE ""o"".""order_date"">='2019-01-01' AND ""o"".""order_date""<='2019-12-31' GROUP BY 1) AS ""m"" ON ""u"".""user_id""=""m"".""buyer_id"""
4,"SELECT ""a"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""a"".""user_id"""
5,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""item_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1"
6,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY ""user_id"""
7,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM (SELECT * FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY')='2019') AS ""tmp"" RIGHT JOIN ""Users"" ON ""buyer_id""=""user_id"" GROUP BY ""user_id"",""join_date"""
8,"WITH ""num_order"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""num_order"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COALESCE(""n"".""num_order"", 0) AS ""orders_in_2019"" FROM ""num_order"" AS ""n"" RIGHT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""n"".""buyer_id"""
9,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
10,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""b"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" GROUP BY ""a"".""user_id"""
11,"WITH ""cte"" AS (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019), ""temp"" AS (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""cte"" GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""temp"" ON ""u"".""user_id""=""temp"".""buyer_id"""
12,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""user_id""=""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"""
13,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
14,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND ""O"".""order_date"" LIKE '2019%' GROUP BY 1"
15,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
16,"WITH ""a"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
17,"SELECT ""users"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" RIGHT JOIN ""Users"" ON ""users"".""user_id""=""t"".""buyer_id"""
18,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""b"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY ""buyer_id"") AS ""b"" ON ""u"".""user_id""=""b"".""buyer_id"" ORDER BY ""b"".""buyer_id"""
19,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1,2"
20,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(CASE WHEN TO_CHAR(""order_date"", 'YYYY')='2019' THEN 1 ELSE NULL END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"",""join_date"" ORDER BY 1"
21,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cte"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" ON ""u"".""user_id""=""cte"".""buyer_id"""
22,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
23,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""T"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""item_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""T"" ON ""u"".""user_id""=""T"".""buyer_id"""
24,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019%' GROUP BY ""u"".""user_id"""
25,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",CASE WHEN ""orders_in_2019"" IS NULL THEN 0 ELSE ""orders_in_2019"" END AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
26,"WITH ""ordercnt"" AS (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",CASE WHEN ""b"".""orders_in_2019"" IS NULL THEN 0 ELSE ""b"".""orders_in_2019"" END AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""ordercnt"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
27,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
28,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Users"".""user_id""=""Orders"".""buyer_id"" AND TO_CHAR(""order_date"", 'YYYY')='2019' GROUP BY ""user_id"""
29,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
30,"WITH ""t"" AS (SELECT ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM (SELECT ""o"".""order_id"",""o"".""buyer_id"",""u"".""join_date"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Users"" AS ""u"" ON ""o"".""buyer_id""=""u"".""user_id"" WHERE LEFT(""order_date"", 4)='2019') AS ""t"" GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",0 AS ""orders_in_2019"" FROM ""Users"" WHERE ""user_id"" NOT IN (SELECT ""buyer_id"" FROM ""t"") UNION ALL SELECT * FROM ""t"""
31,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""r1"" ON ""user_id""=""buyer_id"""
32,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""num"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cte"".""num"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""cte"" ON ""u"".""user_id""=""cte"".""buyer_id"""
33,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
34,"WITH ""purchase_2019"" AS (SELECT ""buyer_id"" AS ""user_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""purchase_2019"" AS ""p"" ON ""u"".""user_id""=""p"".""user_id"""
35,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN ""o"".""order_date"">='2019-01-01' AND ""o"".""order_date""<='2019-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
36,"SELECT ""user_id"" AS ""buyer_id"",""Users"".""join_date"",CASE WHEN ""cnt"" THEN ""cnt"" ELSE 0 END AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" WHERE ""order_date"" LIKE '2019%' GROUP BY ""buyer_id"") AS ""t1"" ON ""Users"".""user_id""=""t1"".""buyer_id"""
37,"SELECT ""u"".""user_id"" AS ""buyer_id"",MIN(""u"".""join_date"") AS ""join_date"",COALESCE(COUNT(DISTINCT ""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"" UNION ALL SELECT ""user_id"",""join_date"",0 AS ""orders_in_2019"" FROM ""users"" WHERE ""user_id"" NOT IN (SELECT ""buyer_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019)"
38,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
39,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1"
40,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON (""o"".""buyer_id""=""u"".""user_id"") AND ""o"".""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""user_id"",""join_date"" ORDER BY ""user_id"""
41,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT ""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"",""u"".""join_date"""
42,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""CNT"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""b"".""CNT"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
43,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(DISTINCT ""num"".""order_id"") AS ""orders_in_2019"" FROM (""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"") LEFT JOIN ""Orders"" AS ""num"" ON ""u"".""user_id""=""num"".""buyer_id"" AND EXTRACT(YEAR FROM ""num"".""order_date"")=2019 GROUP BY 1,2"
44,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""T"".""total_orders"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""total_orders"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""T"" ON ""u"".""user_id""=""T"".""buyer_id"""
45,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""cnt"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") AS ""a"" RIGHT JOIN ""Users"" AS ""u"" ON ""a"".""buyer_id""=""u"".""user_id"" ORDER BY 1"
46,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)=2019 GROUP BY ""user_id"""
47,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2"
48,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""O"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"""
49,"WITH ""br"" AS (SELECT ""buyer_id"",COUNT(1) AS ""t"" FROM ""Orders"" WHERE SUBSTRING(""order_date"", 1, 4)='2019' GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""b"".""t"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""br"" AS ""b"" ON ""u"".""user_id""=""b"".""buyer_id"""
50,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND ""o"".""order_date"" BETWEEN '2019-01-01' AND '2020-01-01' GROUP BY ""user_id"" ORDER BY ""user_id"""
51,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
52,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1,2"
53,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" LIKE '%2019%' GROUP BY ""buyer_id"") AS ""a"" ON ""user_id""=""buyer_id"""
54,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN ""order_date"">'2018-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1"
55,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
56,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
57,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY 1"
58,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",CASE WHEN ""t"".""cnt"" IS NOT NULL THEN ""t"".""cnt"" ELSE 0 END AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
59,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COUNT(""O"".""item_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY 1"
60,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE NULL END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
61,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
62,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_cnt"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)=2019 GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""CTE"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
63,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",SUM(CASE WHEN ""O"".""buyer_id"" IS NULL THEN 0 ELSE 1 END) AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"" FROM ""Users"") AS ""U"" LEFT JOIN (SELECT ""buyer_id"",""order_id"" FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY')='2019') AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" GROUP BY ""U"".""user_id"",""U"".""join_date"""
64,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
65,"WITH ""buy"" AS (SELECT ""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""year"",COUNT(DISTINCT ""order_id"") AS ""num"" FROM ""orders"" GROUP BY ""buyer_id"",""year"" HAVING ""year""='2019') SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""b"".""num"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""buy"" AS ""b"" ON ""u"".""user_id""=""b"".""buyer_id"""
66,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""temp"" ON ""Users"".""user_id""=""temp"".""buyer_id"""
67,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""a"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" GROUP BY 1,2"
68,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""Sub"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN (SELECT COUNT(""O"".""buyer_id"") AS ""orders_in_2019"",""O"".""buyer_id"" FROM ""Orders"" AS ""O"" WHERE DATE(""O"".""order_date"") BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""O"".""buyer_id"") AS ""Sub"" ON ""U"".""user_id""=""Sub"".""buyer_id"""
69,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"""
70,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"""
71,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT CASE WHEN ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' THEN ""order_id"" ELSE NULL END) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""user_id""=""buyer_id"" GROUP BY ""user_id"""
72,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
73,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""order_count"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""u"".""user_id""=""b"".""buyer_id"""
74,"SELECT ""A"".""USER_ID"" AS ""buyer_id"",""A"".""JOIN_DATE"",COUNT(""ORDER_ID"") AS ""orders_in_2019"" FROM ""USERS"" AS ""A"" LEFT JOIN (SELECT ""ORDER_ID"",""BUYER_ID"" FROM ""ORDERS"" WHERE ""order_date"">'2018-12-31' AND ""order_date""<'2020-01-01') AS ""B"" ON ""A"".""USER_ID""=""B"".""BUYER_ID"" GROUP BY ""A"".""USER_ID"",""A"".""JOIN_DATE"""
75,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""o"".""order_date"", 4)='2019' GROUP BY 1"
76,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
77,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT ""o"".""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""user_id"""
78,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
79,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
80,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"" AS ""user_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" WHERE LEFT(""order_date"", 4)=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""u"".""user_id""=""t"".""user_id"""
81,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""o"".""order_date"", 4)='2019' GROUP BY ""u"".""user_id"""
82,"WITH ""cnt"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""counter"" FROM ""Orders"" JOIN ""Items"" ON ""Items"".""item_id""=""Orders"".""item_id"" WHERE EXTRACT(YEAR FROM ""Order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""counter"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""CNT"" ON ""Users"".""user_id""=""CNT"".""buyer_id"""
83,"WITH ""base"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT DISTINCT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""base"" RIGHT JOIN ""Users"" ON ""base"".""buyer_id""=""Users"".""user_id"""
84,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""new"".""orders"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""new"" ON ""u"".""user_id""=""new"".""buyer_id"""
85,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",CASE WHEN ""orders_in_2019"" IS NULL THEN 0 ELSE ""orders_in_2019"" END AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE ""order_date"">='2019-01-01' GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
86,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""b"".""count"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""count"" FROM (SELECT ""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""yr"" FROM ""orders"" HAVING ""yr""='2019') AS ""c"" GROUP BY ""buyer_id"") AS ""b"" ON ""u"".""user_id""=""b"".""buyer_id"""
87,"WITH ""tab"" AS (SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""user_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""od"" ON ""u"".""user_id""=""od"".""buyer_id"" WHERE TO_CHAR(""od"".""order_date"", 'YYYY')='2019' GROUP BY ""user_id"" UNION SELECT ""user_id"" AS ""buyer_id"",""join_date"",0 AS ""orders_in_2019"" FROM ""users"") SELECT ""buyer_id"",""join_date"",SUM(""orders_in_2019"") AS ""orders_in_2019"" FROM ""tab"" GROUP BY ""buyer_id"""
88,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""Users"" AS ""u"" ON ""o"".""buyer_id""=""u"".""user_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY ""user_id"""
89,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
90,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""order_count"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""k"" ON ""buyer_id""=""user_id"""
91,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""order_count"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
92,"WITH ""temp"" AS (SELECT * FROM ""orders"" WHERE SUBSTR(""order_date"", 1, 4)='2019') SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""temp"" ON ""user_id""=""buyer_id"" GROUP BY ""user_id"""
93,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""sub"".""buyer_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""sub"" ON ""u"".""user_id""=""sub"".""buyer_id"" GROUP BY 1 ORDER BY 1"
94,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY 1,2 ORDER BY 1"
95,"WITH ""t1"" AS (SELECT ""buyer_id"",COUNT(""item_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t1"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""t1"" ON ""u"".""user_id""=""t1"".""buyer_id"""
96,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""cte"" AS ""c"" ON ""u"".""user_id""=""c"".""buyer_id"""
97,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
98,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1) SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""CTE"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""CTE"" ON ""U"".""user_id""=""CTE"".""buyer_id"""
99,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""b"".""order_date"")=2019 GROUP BY 1,2 ORDER BY 1"
100,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id"")) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1 ORDER BY 1"
101,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1"
102,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
103,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""Users"" AS ""u"" ON ""o"".""buyer_id""=""u"".""user_id"" AND ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""user_id"""
104,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COUNT(DISTINCT ""O"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY ""U"".""user_id"" ORDER BY ""U"".""user_id"""
105,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""item_id""), 0) AS ""orders_in_2019"" FROM (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""o"" RIGHT JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""user_id"""
106,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COUNT(""O"".""item_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND LEFT(""O"".""order_date"", 4)=2019 GROUP BY 1"
107,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",(CASE WHEN ""t"".""num"" IS NULL THEN 0 ELSE ""t"".""num"" END) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""num"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") AS ""t"" ON ""user_id""=""buyer_id"""
108,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""a"" ON ""a"".""buyer_id""=""u"".""user_id"""
109,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",CASE WHEN ""o"".""num_orders"" IS NULL THEN 0 ELSE ""o"".""num_orders"" END AS ""orders_in_2019"" FROM (SELECT ""user_id"",MIN(""join_date"") AS ""join_date"" FROM ""Users"" GROUP BY 1) AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""num_orders"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
110,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""Users"" AS ""u"" ON ""o"".""buyer_id""=""u"".""user_id"" GROUP BY 1,2"
111,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON (""u"".""user_id""=""o"".""buyer_id"") GROUP BY 1"
112,"WITH ""t"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_count"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""orders_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
113,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"" AS ""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""b"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" GROUP BY ""a"".""user_id"",""a"".""join_date"""
114,"SELECT ""t1"".""user_id"" AS ""buyer_id"",""t1"".""join_date"",CASE WHEN ""t2"".""orders_in_2019"" IS NULL THEN 0 ELSE ""t2"".""orders_in_2019"" END AS ""orders_in_2019"" FROM ""users"" AS ""t1"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t2"" ON ""t2"".""buyer_id""=""t1"".""user_id"""
115,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""o"".""order_date"", 4)=2019 GROUP BY ""u"".""user_id"""
116,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY')='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""orders"" GROUP BY ""buyer_id"") AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
117,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN ""order_id"" IS NOT NULL AND EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2"
118,"WITH ""t"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
119,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
120,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1,2"
121,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COUNT(""O"".""item_id"") AS ""orders_in_2019"" FROM (""Users"" AS ""U"") JOIN ""Orders"" AS ""O"" WHERE ""U"".""user_id""=""O"".""buyer_id"" AND LEFT(""O"".""order_date"", 4)='2019' GROUP BY ""U"".""user_id"",""U"".""join_date"" UNION SELECT ""user_id"" AS ""buyer_id"",""join_date"",0 AS ""orders_in_2019"" FROM ""Users"" WHERE ""user_id"" NOT IN (SELECT ""buyer_id"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019')"
122,"WITH ""TEMP"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""wanted"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""wanted"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""temp"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
123,"SELECT ""U"".""USER_ID"" AS ""BUYER_ID"",""U"".""JOIN_DATE"",COUNT(""O"".""ORDER_ID"") AS ""ORDERS_IN_2019"" FROM ""USERS"" AS ""U"" LEFT JOIN (SELECT ""ORDER_ID"",""BUYER_ID"" FROM ""ORDERS"" WHERE EXTRACT(YEAR FROM ""ORDER_DATE"")=2019) AS ""O"" ON ""U"".""USER_ID""=""O"".""BUYER_ID"" GROUP BY ""U"".""USER_ID"",""U"".""JOIN_DATE"""
124,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"",""u"".""join_date"""
125,"WITH ""cte"" AS (SELECT EXTRACT(YEAR FROM ""order_date"") AS ""yr"",""buyer_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""buyer_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""cte"" ON ""users"".""user_id""=""cte"".""buyer_id"" GROUP BY 1"
126,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
127,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN (SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" WHERE LEFT(""o"".""order_date"", 4)='2019' GROUP BY ""u"".""user_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
128,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
129,"SELECT DISTINCT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",COUNT(""a"".""order_date"") AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" AND EXTRACT(YEAR FROM ""a"".""order_date"")='2019' GROUP BY ""b"".""user_id"" ORDER BY ""b"".""user_id"""
130,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""o"".""order_id"")) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY ""u"".""user_id"",""u"".""join_date"""
131,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY')=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""user_id""=""buyer_id"" GROUP BY 1,2"
132,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" GROUP BY 1"
133,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""a"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" GROUP BY 1,2"
134,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
135,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""order_count"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
136,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""A"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"",EXTRACT(YEAR FROM ""order_date"")) AS ""A"" ON ""A"".""buyer_id""=""U"".""user_id"""
137,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""d1"".""user_id"" AS ""buyer_id"",""d1"".""join_date"",COALESCE(""d2"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""d1"" LEFT JOIN ""CTE"" AS ""d2"" ON ""d1"".""user_id""=""d2"".""buyer_id"""
138,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
139,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""Sub"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN (SELECT COUNT(""O"".""buyer_id"") AS ""orders_in_2019"",""O"".""buyer_id"" FROM ""Orders"" AS ""O"" WHERE DATE(""O"".""order_date"") BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""O"".""buyer_id"") AS ""Sub"" ON ""U"".""user_id""=""Sub"".""buyer_id"""
140,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY ""user_id"""
141,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" GROUP BY 1,2 ORDER BY 1"
142,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT DISTINCT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY 1) AS ""t"" ON ""user_id""=""buyer_id"""
143,"WITH ""number_of_purchase"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""n"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""number_of_purchase"" AS ""n"" ON ""u"".""user_id""=""n"".""buyer_id"""
144,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""b"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" GROUP BY ""a"".""user_id"""
145,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""f"" ON ""f"".""buyer_id""=""u"".""user_id"""
146,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",COALESCE(""a"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""b"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""orders"" WHERE ""order_date"">='2019-01-01' AND ""order_date""<='2019-12-31' GROUP BY ""buyer_id"") AS ""a"" ON ""a"".""buyer_id""=""b"".""user_id"" ORDER BY ""buyer_id"""
147,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
148,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY')=2019 GROUP BY 1) SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
149,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
150,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
151,"WITH ""year2019"" AS (SELECT ""buyer_id"",""order_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' ORDER BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""year2019"" AS ""y"" ON ""u"".""user_id""=""y"".""buyer_id"" GROUP BY ""join_date"",""user_id"""
152,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT ""buyer_id"",""order_date"",COUNT(""item_id"") AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""a"" ON ""user_id""=""a"".""buyer_id"""
153,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND ""o"".""order_date"" BETWEEN '2019-01-01' AND '2020-01-01' GROUP BY ""user_id"" ORDER BY ""user_id"""
154,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_cnt"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)=2019 GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""order_cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""CTE"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
155,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY')='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""orders"" GROUP BY ""buyer_id"") AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
156,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" ORDER BY 1"
157,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnts"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnts"" FROM ""orders"" WHERE TO_CHAR(""order_date"", 'YYYY')=2019 GROUP BY 1) AS ""T1"" ON ""T1"".""buyer_id""=""u"".""user_id"""
158,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""b"".""order_date"")=2019 GROUP BY 1,2 ORDER BY 1"
159,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE NULL END), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""user_id"",""join_date"""
160,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""order_id"",""buyer_id"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""X"" ON ""u"".""user_id""=""X"".""buyer_id"" GROUP BY ""user_id"""
161,"WITH ""ct_orders"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""ct"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""ct"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""ct_orders"" AS ""c"" ON ""u"".""user_id""=""c"".""buyer_id"""
162,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""orders_in_2019"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""order_year"" DESC) AS ""rnk"" FROM (SELECT DISTINCT ""user_id"",""join_date"",""order_year"",CASE WHEN ""order_year""!='2019' THEN 0 WHEN ""order_year""='2019' THEN ""cnt"" END AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""order_year"",COUNT(""order_id"") OVER (PARTITION BY ""buyer_id"", ""order_year"") AS ""cnt"" FROM (SELECT ""a"".""user_id"",""a"".""join_date"",""b"".""order_id"",""b"".""order_date"",""b"".""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""order_year"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"") AS ""sub"") AS ""sub1"") AS ""sub2"") AS ""sub3"" WHERE ""rnk""=1"
163,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY 1"
164,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE CAST('2019-12-31' AS DATE) - ""order_date""<365 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
165,"SELECT ""uu"".""user_id"" AS ""buyer_id"",""uu"".""join_date"",COALESCE(""t"".""counts"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""uu"" LEFT JOIN (SELECT ""u"".""user_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""item_id""), 0) AS ""counts"" FROM (""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"") LEFT JOIN ""Items"" AS ""i"" USING (""item_id"") WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2) AS ""t"" USING (""user_id"") GROUP BY 1,2"
166,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM (SELECT * FROM ""users"") AS ""u"" LEFT JOIN (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
167,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" ON ""user_id""=""buyer_id"" GROUP BY ""user_id"""
168,"WITH ""a"" AS (SELECT DISTINCT ""buyer_id"",COALESCE(COUNT(""item_id""), 0) AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""a"" ON ""u"".""user_id""=""a"".""buyer_id"" ORDER BY ""u"".""user_id"""
169,"WITH ""buyers"" AS (SELECT ""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""years"",COUNT(""order_id"") AS ""total_orders"" FROM ""orders"" GROUP BY ""buyer_id"",""years"") SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",COALESCE(""buyers"".""total_orders"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""buyers"" ON ""user_id""=""buyers"".""buyer_id"" AND ""years""=2019"
170,"SELECT ""u"".""user_id"" AS ""buyer_id"",MIN(""u"".""join_date"") AS ""join_date"",COALESCE(COUNT(""o"".""buyer_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
171,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""orders_in_2019"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""order_year"" DESC) AS ""rnk"" FROM (SELECT DISTINCT ""user_id"",""join_date"",""order_year"",CASE WHEN ""order_year""='2019' THEN ""cnt"" ELSE 0 END AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""order_year"",COUNT(""order_id"") OVER (PARTITION BY ""buyer_id"", ""order_year"") AS ""cnt"" FROM (SELECT ""a"".""user_id"",""a"".""join_date"",""b"".""order_id"",""b"".""order_date"",""b"".""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""order_year"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"") AS ""sub"") AS ""sub1"") AS ""sub2"") AS ""sub3"" WHERE ""rnk""=1"
172,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" ON ""u"".""user_id""=""cte"".""buyer_id"""
173,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2"
174,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"""
175,"SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"" AS ""join_date"",COALESCE(""2019orders"".""2019_orders"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""2019_orders"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") AS ""2019orders"" ON ""users"".""user_id""=""2019orders"".""buyer_id"""
176,"SELECT ""d1"".""user_id"" AS ""buyer_id"",""d1"".""join_date"",SUM(CASE WHEN ""order_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31') THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""d1"" LEFT JOIN ""Orders"" AS ""d2"" ON ""d1"".""user_id""=""d2"".""buyer_id"" GROUP BY ""d1"".""user_id"""
177,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" GROUP BY 1,2"
178,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COALESCE(""sub1"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"">='2019-01-01' AND ""order_date""<='2019-12-31' GROUP BY 1) AS ""sub1"" RIGHT JOIN ""Users"" AS ""u"" ON ""sub1"".""buyer_id""=""u"".""user_id"""
179,"WITH ""num_of_order"" AS (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COALESCE(""n"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""num_of_order"" AS ""n"" ON ""u"".""user_id""=""n"".""buyer_id"""
180,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY 1"
181,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" ORDER BY 1"
182,"WITH ""cte"" AS (SELECT * FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""cte"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" ON ""u"".""user_id""=""cte"".""buyer_id"" GROUP BY ""u"".""user_id"""
183,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
184,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""user_id"",""join_date"""
185,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1"
186,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""f"" ON ""f"".""buyer_id""=""u"".""user_id"""
187,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""order_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""order_2019"" FROM ""Orders"" AS ""o"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) AS ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
188,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
189,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
190,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COALESCE(""CTE"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""CTE"" ON ""Users"".""user_id""=""CTE"".""buyer_id"""
191,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
192,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COALESCE(""CTE"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""CTE"" ON ""Users"".""user_id""=""CTE"".""buyer_id"""
193,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""order_count"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
194,"SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",COALESCE(""o"", 0) AS ""orders_in_2019"" FROM (SELECT ""user_id"",COUNT(""order_id"") AS ""o"" FROM ""users"" AS ""a"" JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY ""user_id"") AS ""c"" RIGHT JOIN ""users"" ON ""c"".""user_id""=""users"".""user_id"""
195,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""buyer_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY 1,2"
196,"SELECT ""u1"".""user_id"" AS ""buyer_id"",""u1"".""join_date"",COALESCE(""a"".""c"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u1"" LEFT JOIN (SELECT ""o"".""buyer_id"",""u"".""join_date"",""o"".""order_date"",""o"".""item_id"",COUNT(""buyer_id"") AS ""c"" FROM ""Orders"" AS ""o"" LEFT JOIN ""Users"" AS ""u"" ON ""o"".""item_id""=""u"".""user_id"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u1"".""user_id""=""a"".""buyer_id"""
197,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2"
198,"SELECT ""Users"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Users"".""user_id""=""Orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""Orders"".""order_date"")='2019' GROUP BY ""Users"".""user_id"""
199,"SELECT ""u"".""user_id"" AS ""buyer_id"",MIN(""join_date"") AS ""join_date"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND SUBSTRING(""order_date"", 1, 4)='2019' GROUP BY 1 ORDER BY 1"
200,"SELECT DISTINCT ""A"".""user_id"" AS ""buyer_id"",""A"".""join_date"",COALESCE(""B"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""A"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE (""order_date"">='2019-01-01') AND (""order_date""<='2019-12-31') GROUP BY ""buyer_id"") AS ""B"" ON ""A"".""user_id""=""B"".""buyer_id"""
201,"SELECT ""x"".""user_id"" AS ""buyer_id"",""x"".""join_date"",COALESCE(""y"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""x"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""y"" ON ""x"".""user_id""=""y"".""buyer_id"""
202,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")='2019' THEN 1 ELSE 0 END), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1"
203,"WITH ""2019OrderCount"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""OC"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""2019OrderCount"" AS ""OC"" ON ""OC"".""buyer_id""=""U"".""user_id"" ORDER BY 1"
204,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""user_id""=""t"".""buyer_id"""
205,"WITH ""ordersCTE"" AS (SELECT ""buyer_id"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COALESCE(""o"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""ordersCTE"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
206,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" LIKE '%2019%' GROUP BY ""buyer_id"") AS ""a"" ON ""user_id""=""buyer_id"""
207,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",""order_id"" FROM ""Orders"" WHERE SUBSTRING(""order_date"", 1, 4)='2019') AS ""t1"" RIGHT JOIN ""Users"" AS ""u"" ON ""u"".""user_id""=""t1"".""buyer_id"" GROUP BY ""user_id"""
208,"SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",COUNT(""orders"".""order_date"") AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"""
209,"SELECT DISTINCT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1,2"
210,"WITH ""cte"" AS (SELECT ""order_date"",""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019_01_01' AND '2019_12_31' GROUP BY 2) SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" GROUP BY 1,2"
211,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
212,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",SUM(CASE WHEN ""o"".""order_date"">='2019-01-01' AND ""o"".""order_date""<='2019-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
213,"SELECT ""d"".""user_id"" AS ""buyer_id"",""d"".""join_date"",COALESCE(""c"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",SUM(""order_2019"") AS ""orders_in_2019"" FROM (SELECT *,CASE WHEN ""order_year""=2019 THEN 1 ELSE 0 END AS ""order_2019"" FROM (SELECT *,TO_CHAR(""order_date"", 'YYYY') AS ""order_year"" FROM ""Orders"") AS ""a"") AS ""b"" GROUP BY ""buyer_id"") AS ""c"" RIGHT JOIN ""Users"" AS ""d"" ON ""c"".""buyer_id""=""d"".""user_id"" ORDER BY ""buyer_id"""
214,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1"
215,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
216,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY')='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2 ORDER BY 1"
217,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""num"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""num"" FROM (SELECT * FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""temp"" GROUP BY ""buyer_id"") AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
218,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
219,"WITH ""t"" AS (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""c"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",CASE WHEN ""t"".""c"" IS NULL THEN 0 ELSE ""t"".""c"" END AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""t"" ON ""users"".""user_id""=""t"".""buyer_id"""
220,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""user_id""=""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"""
221,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""cte"" AS ""a"" RIGHT JOIN ""users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"""
222,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
223,"WITH ""temp"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""number"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""number"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""temp"" ON ""users"".""user_id""=""temp"".""buyer_id"""
224,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
225,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(COUNT(DISTINCT ""b"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""b"".""order_date"")=2019 GROUP BY ""a"".""user_id"",""a"".""join_date"""
226,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
227,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""buyer_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND ""order_date"" LIKE '2019%' GROUP BY ""user_id"""
228,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1"
229,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT DISTINCT ""buyer_id"",COUNT(""order_id"") OVER (PARTITION BY ""buyer_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE SUBSTR(""order_date"", 1, 4)='2019') AS ""t"" RIGHT JOIN ""users"" AS ""u"" ON ""u"".""user_id""=""t"".""buyer_id"""
230,"SELECT ""t1"".""user_id"" AS ""buyer_id"",""t1"".""join_date"",COALESCE(""t2"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""t1"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date""<='2019-12-31' AND ""order_date"">='2019-01-01' GROUP BY ""buyer_id"") AS ""t2"" ON ""t1"".""user_id""=""t2"".""buyer_id"""
231,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1,2"
232,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""b"" LEFT JOIN ""Orders"" AS ""o"" ON ""b"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2"
233,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_cnt"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)=2019 GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""order_cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""CTE"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
234,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""u"".""user_id"""
235,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""a"".""orderscount"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orderscount"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" RIGHT JOIN ""Users"" AS ""u"" ON ""a"".""buyer_id""=""u"".""user_id"""
236,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" GROUP BY 1"
237,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY ""user_id"""
238,"SELECT DISTINCT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",COUNT(""a"".""order_date"") AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" AND EXTRACT(YEAR FROM ""a"".""order_date"")='2019' GROUP BY ""b"".""user_id"" ORDER BY ""b"".""user_id"""
239,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
240,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",""orders_in_2019"" AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""orders_in_2019"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""order_year"" DESC) AS ""rnk"" FROM (SELECT DISTINCT ""user_id"",""join_date"",""order_year"",CASE WHEN ""order_year""='2019' THEN ""cnt"" ELSE 0 END AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""order_year"",COUNT(""order_id"") OVER (PARTITION BY ""buyer_id"", ""order_year"") AS ""cnt"" FROM (SELECT ""a"".""user_id"",""a"".""join_date"",""b"".""order_id"",""b"".""order_date"",""b"".""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""order_year"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"") AS ""sub"") AS ""sub1"") AS ""sub2"") AS ""sub3"" WHERE ""rnk""=1"
241,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1,2"
242,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" BETWEEN DATE('2019-01-01') AND DATE('2019-12-31') GROUP BY ""buyer_id"") AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"""
243,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
244,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""user_id""=""b"".""buyer_id"""
245,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"",""u"".""join_date"""
246,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1"
247,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",CASE WHEN ""buyers"".""orders"" IS NULL THEN 0 ELSE ""buyers"".""orders"" END AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""buyers"" ON ""U"".""user_id""=""buyers"".""buyer_id"""
248,"SELECT ""B"".""user_id"" AS ""buyer_id"",""B"".""join_date"",COUNT(""A"".""order_id"") AS ""orders_in_2019"" FROM ""Orders"" AS ""A"" RIGHT JOIN ""Users"" AS ""B"" ON ""A"".""buyer_id""=""B"".""user_id"" AND EXTRACT(YEAR FROM ""A"".""order_date"")=2019 GROUP BY ""B"".""user_id"""
249,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
250,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_date"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
251,"WITH ""number_of_purchase"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""n"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""number_of_purchase"" AS ""n"" ON ""u"".""user_id""=""n"".""buyer_id"""
252,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""o"".""order_date"", 4)='2019' GROUP BY ""u"".""user_id"",""u"".""join_date"""
253,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""O"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1"
254,"WITH ""t1"" AS (SELECT ""buyer_id"" AS ""user_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""a"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""t1"" ON ""a"".""user_id""=""t1"".""user_id"""
255,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY ""u"".""user_id"""
256,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
257,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE LEFT(""order_date"", 4)=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""t"".""buyer_id""=""u"".""user_id"""
258,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"""
259,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 AND ""order_id"" IS NOT NULL THEN 1 ELSE 0 END), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_Id"" GROUP BY 1"
260,"WITH ""t1"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""t1"" ON ""a"".""user_id""=""t1"".""buyer_id"""
261,"WITH ""sumOrders"" AS (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY (""buyer_id"")) SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""sumOrders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
262,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
263,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY')=2019 GROUP BY 1) AS ""order_2019"" ON ""user_id""=""buyer_id"""
264,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1"
265,"SELECT ""a"".""user_id"" AS ""buyer_id"",MIN(""a"".""join_date"") AS ""join_date"",COUNT(""b"".""item_id"") AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""Orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""b"".""order_date"")=2019 GROUP BY 1"
266,"WITH ""temp1"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",CASE WHEN ""orders_in_2019"" IS NOT NULL THEN ""orders_in_2019"" ELSE 0 END AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""orders_in_2019"" FROM ""temp1"" RIGHT JOIN ""Users"" ON ""temp1"".""buyer_id""=""Users"".""user_id"") AS ""x"""
267,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
268,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""temp"" ON ""Users"".""user_id""=""temp"".""buyer_id"""
269,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"" ORDER BY 1"
270,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY 1"
271,"WITH ""merged"" AS (SELECT ""a"".""user_id"",""a"".""join_date"",""b"".""order_date"",""b"".""order_id"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""order_date"",""order_id"",""buyer_id"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" ORDER BY ""a"".""user_id"",""b"".""order_date"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""merged"" GROUP BY ""user_id"",""join_date"" ORDER BY ""user_id"",""join_date"""
272,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
273,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"""
274,"WITH ""temp"" AS (SELECT ""buyer_id"",COUNT(1) AS ""total"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""total"", 0) AS ""orders_in_2019"" FROM ""temp"" AS ""t"" RIGHT JOIN ""users"" AS ""u"" ON ""t"".""buyer_id""=""u"".""user_id"""
275,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"",""join_date"""
276,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""total"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cte"".""total"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" ON ""cte"".""buyer_id""=""u"".""user_id"""
277,"WITH ""temp"" AS (SELECT * FROM ""orders"" WHERE SUBSTR(""order_date"", 1, 4)='2019') SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""temp"" ON ""user_id""=""buyer_id"" GROUP BY ""user_id"""
278,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2 ORDER BY 1"
279,"SELECT ""tab1"".""user_id"" AS ""buyer_id"",""tab1"".""join_date"",COALESCE(""tab2"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""tab1"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1) AS ""tab2"" ON ""tab1"".""user_id""=""tab2"".""buyer_id"""
280,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2"
281,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
282,"SELECT ""u"".""user_id"" AS ""buyer_id"",COALESCE(""u"".""join_date"", 0) AS ""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""order_date"",""order_id"",""buyer_id"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2"
283,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
284,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"",""join_date"""
285,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN ""order_id"" IS NOT NULL THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"",""join_date"" ORDER BY ""buyer_id"""
286,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN ""o"".""order_date"">='2019-01-01' AND ""o"".""order_date""<='2019-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"" ORDER BY ""u"".""user_id"""
287,"SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",SUM(CASE WHEN ""order_date"">='2019-01-01' AND ""order_date""<='2019-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""orders"" RIGHT JOIN ""users"" ON ""orders"".""buyer_id""=""users"".""user_id"" GROUP BY ""users"".""user_id"",""users"".""join_date"" ORDER BY ""users"".""user_id"""
288,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"" AS ""user_id"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""u"".""user_id""=""t"".""user_id"""
289,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""od"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_date"") AS ""od"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
290,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""s"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",SUM(EXTRACT(YEAR FROM ""order_date"")=2019) AS ""orders_in_2019"" FROM ""Orders"" GROUP BY ""buyer_id"") AS ""s"" ON ""u"".""user_id""=""s"".""buyer_id"""
291,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" ORDER BY 1"
292,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""orders"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM ""orders"" AS ""b"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1) AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
293,"SELECT ""buyer_id"",""join_date"",COUNT(""item_id"") AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""buyer_id""=""user_id"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"" UNION SELECT ""user_id"" AS ""buyer_id"",""join_date"",0 FROM ""Users"" WHERE ""user_id"" NOT IN (SELECT ""buyer_id"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) ORDER BY ""buyer_id"""
294,"WITH ""t"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
295,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",(SELECT COUNT(1) FROM ""Orders"" WHERE ""buyer_id""=""u"".""user_id"" AND TO_CHAR(""order_date"", 'YYYY')=2019) AS ""orders_in_2019"" FROM ""Users"" AS ""u"""
296,"SELECT ""t1"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""t1"" LEFT JOIN ""Orders"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""t1"".""user_id"""
297,"SELECT ""buyer_id"",""join_date"",SUM(""orders_in_2019"") AS ""orders_in_2019"" FROM (SELECT ""user_id"" AS ""buyer_id"",""join_date"",""order_id"",CASE WHEN LEFT(""order_date"", 4)=2019 THEN 1 ELSE 0 END AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2,3) AS ""tb"" GROUP BY 1"
298,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",""order_id"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2"
299,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""item_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2"
300,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"",""u"".""join_date"""
301,"SELECT ""c"".""user_id"" AS ""buyer_id"",""c"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""c"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""d"" ON ""c"".""user_id""=""d"".""buyer_id"""
302,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""a"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" GROUP BY 1,2"
303,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" GROUP BY 1"
304,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY 1,2"
305,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
306,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""t"".""buyer_id""=""u"".""user_id"""
307,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""e1"".""count_value"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT *,COUNT(""order_date"") AS ""count_value"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""e1"" ON ""u"".""user_id""=""e1"".""buyer_id"""
308,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""a"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" GROUP BY 1,2"
309,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1"
310,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY ""user_id"""
311,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY ""u"".""user_id"""
312,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT ""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"",""u"".""join_date"""
313,"WITH ""t"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""2019order"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""t"".""2019order"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
314,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) AS ""t"" ON ""a"".""user_id""=""t"".""buyer_id"""
315,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""user_id""=""buyer_id"" AND ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1,2"
316,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" GROUP BY 1"
317,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"",""u"".""join_date"" ORDER BY ""u"".""user_id"""
318,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""item_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1"
319,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""item_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1"
320,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""orders"" AS ""o"" RIGHT JOIN ""users"" AS ""u"" ON ""o"".""buyer_id""=""u"".""user_id"" GROUP BY 1"
321,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN ""order_id"" ELSE NULL END), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON (""u"".""user_id""=""o"".""buyer_id"") GROUP BY 1,2"
322,"WITH ""cte"" AS (SELECT ""user_id"" AS ""buyer_id"",""order_date"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31') SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""c"".""order_date""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""cte"" AS ""c"" ON ""u"".""user_id""=""c"".""buyer_id"" GROUP BY 1,2"
323,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
324,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
325,"WITH ""temp"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""A"".""user_id"" AS ""buyer_id"",""A"".""join_date"",COALESCE(""B"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""A"" LEFT JOIN ""temp"" AS ""B"" ON ""A"".""user_id""=""B"".""buyer_id"""
326,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN ""o"".""item_id"" ELSE NULL END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
327,"WITH ""tbl"" AS (SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COUNT(""O"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""buyer_id""=""U"".""user_id"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""U"".""user_id"",""U"".""join_date"") SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""tbl"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""tbl"" ON ""tbl"".""buyer_id""=""U"".""user_id"""
328,"WITH ""CTE"" AS (SELECT ""u"".""user_id"",COUNT(""o"".""order_id"") AS ""ordercount"" FROM ""Users"" AS ""u"" JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""CTE"".""ordercount"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""CTE"" ON ""u"".""user_id""=""CTE"".""user_id"""
329,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""count_order"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""count_order"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"""
330,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(COUNT(""O"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""buyer_id""=""U"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""U"".""user_id"",""U"".""join_date"""
331,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
332,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1,2"
333,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"" ORDER BY ""user_id"""
334,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND ""o"".""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""u"".""user_id"",""u"".""join_date"""
335,"WITH ""cte"" AS (SELECT ""order_id"",""order_date"",""buyer_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019') SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""cte"" ON ""user_id""=""buyer_id"" GROUP BY ""user_id"""
336,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""c"" FROM ""Orders"" WHERE SUBSTR(""order_date"", 1, 4)='2019' GROUP BY ""buyer_id"") SELECT DISTINCT ""Users"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""c"", 0) AS ""orders_in_2019"" FROM ""cte"" RIGHT JOIN ""Users"" ON ""cte"".""buyer_id""=""Users"".""user_id"" ORDER BY 1"
337,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(CASE WHEN TO_CHAR(""order_date"", 'YYYY')=2019 THEN ""order_id"" END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" GROUP BY 1,2"
338,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",CASE WHEN ""t"".""orders"" IS NULL THEN 0 ELSE ""t"".""orders"" END AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""orders"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
339,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""o"".""order_date"", 4)='2019' GROUP BY ""u"".""user_id"""
340,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"" AS ""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND ""o"".""order_date"">='2019-01-01' AND ""o"".""order_date""<'2020-01-01' GROUP BY ""u"".""user_id"""
341,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1,2"
342,"WITH ""cte"" AS (SELECT ""user_id"" AS ""buyer_id"",SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE NULL END) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""user_id"") SELECT ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" JOIN ""cte"" AS ""c"" ON ""c"".""buyer_id""=""u"".""user_id"""
343,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""cte"" ON ""Users"".""user_id""=""cte"".""buyer_id"""
344,"WITH ""total_orders"" AS (SELECT ""buyer_id"",""order_date"",COUNT(""order_id"") AS ""total"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""t"".""total"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""total_orders"" AS ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
345,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""A"" ON ""u"".""user_id""=""A"".""buyer_id"""
346,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY')='2019' GROUP BY ""buyer_id"") SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""b"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""a"" LEFT JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
347,"WITH ""cte1"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""C"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""cte1"" AS ""C"" ON ""U"".""user_id""=""C"".""buyer_id"""
348,"SELECT ""t1"".""user_id"" AS ""buyer_id"",""t1"".""join_date"",COALESCE(COUNT(DISTINCT CASE WHEN EXTRACT(YEAR FROM ""t2"".""order_date"")=2019 THEN ""t2"".""order_id"" ELSE NULL END), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""t1"" LEFT JOIN ""ORDERS"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""buyer_id"" GROUP BY ""t1"".""user_id"",""t1"".""join_date"""
349,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
350,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"""
351,"SELECT ""t2"".""user_id"" AS ""buyer_id"",""t2"".""join_date"",COALESCE(""t1"".""cnt"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(""order_id"") AS ""cnt"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") AS ""t1"" RIGHT JOIN (SELECT ""user_id"",""join_date"" FROM ""users"") AS ""t2"" ON ""t1"".""buyer_id""=""t2"".""user_id"""
352,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""item_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY 1"
353,"WITH ""user_info"" AS (SELECT ""user_id"",""join_date"" FROM ""Users""), ""order_in_2019"" AS (SELECT ""order_date"",""buyer_id"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31'), ""order_count"" AS (SELECT COUNT(""order_date"") AS ""orders_in_2019"",""buyer_id"" FROM ""order_in_2019"" GROUP BY ""buyer_id"") SELECT ""user_info"".""user_id"" AS ""buyer_id"",""user_info"".""join_date"",COALESCE(""order_count"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""user_info"" LEFT JOIN ""order_count"" ON ""user_info"".""user_id""=""order_count"".""buyer_id"""
354,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"""
355,"WITH ""cte"" AS (SELECT ""order_id"",""buyer_id"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019') SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" AS ""c"" ON ""u"".""user_id""=""c"".""buyer_id"" GROUP BY 1 ORDER BY 1"
356,"WITH ""a"" AS (SELECT ""buyer_id"",""item_id"",COUNT(""item_id"") AS ""tot"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""a"".""tot"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""a"" ON ""u"".""user_id""=""a"".""buyer_id"""
357,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN ""order_id"" IS NOT NULL THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"",""join_date"" ORDER BY ""buyer_id"""
358,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" GROUP BY 1) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
359,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""i"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"" AS ""user_id"",COUNT(1) AS ""orders_in_2019"" FROM ""orders"" AS ""o"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""user_id"") AS ""i"" ON ""u"".""user_id""=""i"".""user_id"""
360,"WITH ""cte"" AS (SELECT COUNT(""order_id"") AS ""orders_in_2019"",""buyer_id"" AS ""user_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""cte"" USING (""user_id"")"
361,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
362,"SELECT ""u"".""user_id"" AS ""buyer_id"",MAX(""u"".""join_date"") AS ""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY 1"
363,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"""
364,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""buyer_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND LEFT(""o"".""order_date"", 4)='2019' GROUP BY ""u"".""user_id"""
365,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) AS ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
366,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY ""user_id"""
367,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""buyer_id"") AS ""orders_in_2019"" FROM (SELECT * FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""t"" RIGHT JOIN ""users"" AS ""u"" ON ""user_id""=""buyer_id"" GROUP BY 1"
368,"WITH ""cte"" AS (SELECT DISTINCT ""o"".""buyer_id"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" WHERE ""o"".""order_date"" LIKE '2019%' GROUP BY ""o"".""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cte"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" ON ""cte"".""buyer_id""=""u"".""user_id"""
369,"WITH ""orders19"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""order_count"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""order_count"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders19"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
370,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
371,"WITH ""Orders_2019"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE((""O"".""orders_in_2019""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders_2019"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"""
372,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(COUNT(""O"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY ""U"".""user_id"",""U"".""join_date"" ORDER BY ""U"".""user_id"""
373,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN TO_CHAR(""order_date"", 'YYYY')=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""user_id""=""buyer_id"" GROUP BY 1,2"
374,"WITH ""a"" AS (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""a"" ON ""Users"".""user_id""=""a"".""buyer_id"""
375,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE ""Orders"".""order_date"">='2019-01-01') AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
376,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Users"".""user_id""=""Orders"".""buyer_id"" GROUP BY 1,2"
377,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""item_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2"
378,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") AS ""TL"" RIGHT JOIN ""Users"" AS ""U"" ON ""TL"".""buyer_id""=""U"".""user_id"" ORDER BY ""buyer_id"""
379,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""u"".""user_id"""
380,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",COALESCE(COUNT(""O"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND ""O"".""order_date"">'2018-12-31' GROUP BY 1"
381,"SELECT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COUNT(CASE WHEN EXTRACT(YEAR FROM ""Orders"".""order_date"")=2019 THEN 1 END) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Users"".""user_id""=""Orders"".""buyer_id"" GROUP BY ""Users"".""user_id"""
382,"WITH ""t1"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""cnt"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""t1"" ON ""a"".""user_id""=""t1"".""buyer_id"""
383,"SELECT ""A"".""USER_ID"" AS ""BUYER_ID"",""A"".""JOIN_DATE"",COALESCE(""B"".""ORDERS_IN_2019"", 0) AS ""ORDERS_IN_2019"" FROM ""USERS"" AS ""A"" LEFT JOIN (SELECT ""BUYER_ID"",EXTRACT(YEAR FROM ""ORDER_DATE"") AS ""YEAR"",COUNT(DISTINCT ""ORDER_ID"") AS ""ORDERS_IN_2019"" FROM ""ORDERS"" GROUP BY ""BUYER_ID"",""YEAR"" HAVING ""YEAR""=2019) AS ""B"" ON ""A"".""USER_ID""=""B"".""BUYER_ID"""
384,"SELECT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COALESCE(COUNT(""Orders"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Users"".""user_id""=""Orders"".""buyer_id"" AND EXTRACT(YEAR FROM ""Orders"".""order_date"")='2019' GROUP BY ""Users"".""user_id"""
385,"WITH ""tmp1"" AS (SELECT ""user_id"",""join_date"" FROM ""Users""), ""tmp2"" AS (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1) SELECT ""t1"".""user_id"" AS ""buyer_id"",""t1"".""join_date"",COALESCE(""t2"".""orders"", 0) AS ""orders_in_2019"" FROM ""tmp1"" AS ""t1"" LEFT JOIN ""tmp2"" AS ""t2"" ON ""t1"".""user_id""=""t2"".""buyer_id"""
386,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY ""u"".""user_id"""
387,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) AS ""t"" ON ""u"".""user_id""=""t"".""buyer_id"""
388,"SELECT ""users"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""orders"".""buyer_id""=""users"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""users"".""user_id"",""join_date"""
389,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""buyer_id""=""user_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"""
390,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""c"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""c"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"""
391,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Orders"".""buyer_id""=""users"".""user_id"" AND SUBSTRING(""order_date"", 1, 4)='2019' GROUP BY ""user_id"""
392,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""o"".""order_date"", 4)='2019' GROUP BY ""u"".""user_id"""
393,"WITH ""CTE"" AS (SELECT ""o"".""buyer_id"",COUNT(1) AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" WHERE ""o"".""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cte"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""CTE"" ON ""CTE"".""buyer_id""=""u"".""user_id"""
394,"WITH ""num"" AS (SELECT ""buyer_id"",COUNT(1) AS ""c"" FROM ""Orders"" WHERE LEFT(""order_date"", 4)='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""c"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""num"" ON ""num"".""buyer_id""=""u"".""user_id"""
395,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE TO_CHAR(""order_date"", 'YYYY')=2019 GROUP BY 1) AS ""order_2019"" ON ""user_id""=""buyer_id"""
396,"SELECT ""b"".""user_id"" AS ""buyer_id"",""b"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""a"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Orders"" AS ""a"" RIGHT JOIN ""Users"" AS ""b"" ON ""a"".""buyer_id""=""b"".""user_id"" GROUP BY 1,2"
397,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""ct"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""ct"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""cte"" ON ""users"".""user_id""=""cte"".""buyer_id"""
398,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" RIGHT JOIN ""users"" AS ""u"" ON ""t"".""buyer_id""=""u"".""user_id"""
399,"WITH ""temp1"" AS (SELECT ""buyer_id"",COUNT(1) AS ""total_orders"" FROM ""orders"" WHERE ""order_date"">='2019-01-01' GROUP BY ""buyer_id"") SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",COALESCE(""temp1"".""total_orders"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""temp1"" ON ""users"".""user_id""=""temp1"".""buyer_id"""
400,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"",""join_date"" ORDER BY ""user_id"""
401,"SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",SUM(CASE WHEN ""order_date"">='2019-01-01' AND ""order_date""<='2019-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" GROUP BY ""users"".""user_id"",""users"".""join_date"" ORDER BY ""users"".""user_id"""
402,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
403,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",SUM(CASE WHEN LEFT(""order_date"", 4)='2019' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
404,"WITH ""cte"" AS (SELECT COUNT(""order_id"") AS ""orders_in_2019"",""buyer_id"" AS ""user_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""cte"" USING (""user_id"")"
405,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"""
406,"WITH ""cte"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""cte"" ON ""u"".""user_id""=""cte"".""buyer_id"""
407,"WITH ""cte"" AS (SELECT DISTINCT ""o"".""buyer_id"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" WHERE EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY ""o"".""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""cte"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""cte"" ON ""cte"".""buyer_id""=""u"".""user_id"""
408,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""orders_in_2019"",RANK() OVER (PARTITION BY ""user_id"" ORDER BY ""order_year"" DESC) AS ""rnk"" FROM (SELECT DISTINCT ""user_id"",""join_date"",""order_year"",CASE WHEN ""order_year""!='2019' THEN 0 WHEN ""order_year""='2019' THEN ""cnt"" END AS ""orders_in_2019"" FROM (SELECT ""user_id"",""join_date"",""order_year"",COUNT(""order_id"") OVER (PARTITION BY ""buyer_id"", ""order_year"") AS ""cnt"" FROM (SELECT ""a"".""user_id"",""a"".""join_date"",""b"".""order_id"",""b"".""order_date"",""b"".""buyer_id"",EXTRACT(YEAR FROM ""order_date"") AS ""order_year"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"") AS ""sub"") AS ""sub1"") AS ""sub2"") AS ""sub3"" WHERE ""rnk""=1"
409,"SELECT ""A"".""user_id"" AS ""buyer_id"",""A"".""join_date"",COALESCE(""B"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""A"" LEFT JOIN (SELECT ""buyer_id"",COUNT(DISTINCT ""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") AS ""B"" ON ""A"".""user_id""=""B"".""buyer_id"""
410,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""Orders"" AS ""o"" RIGHT JOIN ""Users"" AS ""u"" ON ""o"".""buyer_id""=""u"".""user_id"" AND ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' AND ""order_date"" IS NOT NULL GROUP BY ""user_id"""
411,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(DISTINCT ""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")=2019 GROUP BY 1,2"
412,"SELECT ""U"".""user_id"" AS ""buyer_id"",""U"".""join_date"",CASE WHEN ""O"".""order_id"" IS NULL THEN 0 ELSE COUNT(""O"".""order_id"") END AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""U"".""user_id""=""O"".""buyer_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")='2019' GROUP BY ""U"".""user_id"""
413,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY 1"
414,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""b"".""order_date"")=2019 GROUP BY 1,2 ORDER BY 1"
415,"SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",SUM(CASE WHEN ""order_date"">='2019-01-01' AND ""order_date""<='2019-12-31' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""orders"" ON ""users"".""user_id""=""orders"".""buyer_id"" GROUP BY ""users"".""user_id"",""users"".""join_date"" ORDER BY ""users"".""user_id"""
416,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""order_date"") AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND (""o"".""order_date"">='2019-01-01' AND ""o"".""order_date""<='2019-12-31') GROUP BY 1"
417,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""o"".""order_date"")='2019' GROUP BY ""u"".""user_id"""
418,"WITH ""order_num"" AS (SELECT COUNT(""order_id"") AS ""order_num"",""order_date"",""buyer_id"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""buyer_id"") SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""order_num"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN ""order_num"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
419,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_date""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019) AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""u"".""user_id"""
420,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""user_id""=""buyer_id"" AND LEFT(""order_date"", 4)='2019' GROUP BY 1,2"
421,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""sub"".""record"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""u"" LEFT JOIN (SELECT ""buyer_id"",COUNT(1) AS ""record"" FROM ""orders"" WHERE ""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""buyer_id"") AS ""sub"" ON ""u"".""user_id""=""sub"".""buyer_id"""
422,"SELECT ""u"".""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""order_date"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND ""o"".""order_date"" LIKE ('2019%') GROUP BY ""u"".""user_id"""
423,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(COUNT(DISTINCT ""b"".""order_id""), 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN ""orders"" AS ""b"" ON ""a"".""user_id""=""b"".""buyer_id"" AND EXTRACT(YEAR FROM ""b"".""order_date"")=2019 GROUP BY 1"
424,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN ""order_date"" LIKE '2019%' THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY ""user_id"" ORDER BY ""user_id"""
425,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""orders"" AS ""t"" RIGHT JOIN ""users"" AS ""a"" ON ""a"".""user_id""=""t"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1"
426,"SELECT ""a"".""user_id"" AS ""buyer_id"",""a"".""join_date"",COALESCE(""t"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" AS ""a"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""t"" ON ""a"".""user_id""=""t"".""buyer_id"" ORDER BY 1"
427,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(DISTINCT ""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""U"" LEFT JOIN ""Orders"" AS ""O"" ON ""O"".""buyer_id""=""U"".""user_id"" AND EXTRACT(YEAR FROM ""O"".""order_date"")=2019 GROUP BY 1"
428,"SELECT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COALESCE(""a"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") AS ""a"" ON ""Users"".""user_id""=""a"".""buyer_id"""
429,"SELECT ""Users"".""user_id"" AS ""buyer_id"",""Users"".""join_date"",COALESCE(COUNT(""Orders"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" LEFT JOIN ""Orders"" ON ""Users"".""user_id""=""Orders"".""buyer_id"" AND ""Orders"".""order_date"" BETWEEN '2019-01-01' AND '2019-12-31' GROUP BY ""Users"".""user_id"""
430,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"" ORDER BY ""user_id"""
431,"WITH ""CTE"" AS (SELECT ""buyer_id"",COUNT(1) AS ""cnt"" FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""A"".""user_id"" AS ""buyer_id"",""A"".""join_date"",COALESCE(""B"".""cnt"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""A"" LEFT JOIN ""CTE"" AS ""B"" ON ""A"".""user_id""=""B"".""buyer_id"""
432,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY 1"
433,"WITH ""orderss"" AS (SELECT ""buyer_id"",COUNT(DISTINCT (""order_id"")) AS ""orders_in_2019"" FROM ""Orders"" WHERE ""buyer_id"" IN (SELECT ""user_id"" FROM ""Users"") AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY 1) SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(""o"".""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""orderss"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"""
434,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",COALESCE(COUNT(""o"".""order_id""), 0) AS ""orders_in_2019"" FROM ""USERS"" AS ""u"" LEFT JOIN ""ORDERS"" AS ""o"" ON ""o"".""buyer_id""=""u"".""user_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""u"".""user_id"" ORDER BY 1"
435,"WITH ""table1"" AS (SELECT ""u"".""user_id"",""u"".""join_date"",""o_2019"".""order_id"",""o_2019"".""item_id"" FROM ""Users"" AS ""u"" LEFT JOIN (SELECT * FROM ""Orders"" WHERE EXTRACT(YEAR FROM ""order_date"")='2019') AS ""o_2019"" ON ""u"".""user_id""=""o_2019"".""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(COUNT(""order_Id""), 0) AS ""orders_in_2019"" FROM ""table1"" GROUP BY ""user_id"",""join_date"""
436,"SELECT ""user_id"" AS ""buyer_id"",""join_date"",COUNT(""o"".""order_id"") AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" AND EXTRACT(YEAR FROM ""order_date"")='2019' GROUP BY ""user_id"""
437,"WITH ""buyer"" AS (SELECT ""buyer_id"",COUNT(""order_id"") AS ""orders_in_2019"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""user_id"" AS ""buyer_id"",""join_date"",COALESCE(""orders_in_2019"", 0) AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""buyer"" ON ""users"".""user_id""=""buyer"".""buyer_id"""
438,"WITH ""t"" AS (SELECT ""buyer_id"",COUNT(""buyer_id"") AS ""c"" FROM ""orders"" WHERE EXTRACT(YEAR FROM ""order_date"")=2019 GROUP BY ""buyer_id"") SELECT ""users"".""user_id"" AS ""buyer_id"",""users"".""join_date"",CASE WHEN ""t"".""c"" IS NULL THEN 0 ELSE ""t"".""c"" END AS ""orders_in_2019"" FROM ""users"" LEFT JOIN ""t"" ON ""users"".""user_id""=""t"".""buyer_id"""
439,"SELECT ""u"".""user_id"" AS ""buyer_id"",""u"".""join_date"",SUM(CASE WHEN EXTRACT(YEAR FROM ""o"".""order_date"")=2019 THEN 1 ELSE 0 END) AS ""orders_in_2019"" FROM ""Users"" AS ""u"" LEFT JOIN ""Orders"" AS ""o"" ON ""u"".""user_id""=""o"".""buyer_id"" GROUP BY 1,2"
