id,original query
1,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN (SELECT ""user1_id"" AS ""user1"",""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"" AS ""user1"",""user1_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""temp"" ON ""l"".""user_id""=""temp"".""friend"" WHERE ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
2,"WITH ""user1_friends"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friends"" FROM ""Friendship"") SELECT ""l"".""page_id"" AS ""recommended_page"" FROM ""user1_friends"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""friends""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY ""recommended_page"""
3,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" WHERE ""user_id"" IN (SELECT ""user_id_1_friends"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id_1_friends"" FROM ""friendship"") AS ""a"" WHERE ""user_id_1_friends"" IS NOT NULL) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
4,"ERROR: mysql parse error: line 1 column 142 near ""union (Select user1_id as user2_id from Friendship where user2_id=1))) Select * from cte where recommended_page not in (Select distinct page_id from Likes where user_id=1)"" "
5,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT DISTINCT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
6,"WITH ""friends"" AS (SELECT DISTINCT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT DISTINCT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""friends"") AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
7,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (""Likes"" AS ""l"" LEFT JOIN ""Friendship"" AS ""f1"" ON ""f1"".""user2_id""=""l"".""user_id"") LEFT JOIN ""Friendship"" AS ""f2"" ON ""f2"".""user1_id""=""l"".""user_id"" WHERE (""f1"".""user1_id""=1 OR ""f2"".""user2_id""=1) AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
8,"SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""friendship"") AS ""t"" JOIN ""likes"" ON ""user2_id""=""user_id"" WHERE ""user1_id""=1 AND ""likes"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
9,"WITH ""friends"" AS (SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""A"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""A"" WHERE ""A"".""user_id"" IN (SELECT ""user_id"" FROM ""friends"") AND ""A"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
10,"WITH ""friend_1"" AS (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""a"" JOIN ""friend_1"" AS ""b"" ON ""a"".""user_id""=""b"".""user1_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
11,"SELECT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""a"" JOIN ""Likes"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY ""page_id"""
12,"SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""friendship"") AS ""t"" JOIN ""likes"" ON ""user2_id""=""user_id"" WHERE ""user1_id""=1 AND ""likes"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
13,"WITH ""friends"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1), ""already_liked"" AS (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""friends"") AND ""page_id"" NOT IN (SELECT * FROM ""already_liked"")"
14,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
15,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""user1_friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
16,"WITH ""friend_1"" AS (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""a"" JOIN ""friend_1"" AS ""b"" ON ""a"".""user_id""=""b"".""user1_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
17,"SELECT DISTINCT (""l"".""page_id"") AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""user1"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user1""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
18,"WITH ""temp"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""temp"" AS ""t"" JOIN ""Likes"" AS ""l"" ON ""t"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
19,"WITH ""cte"" AS (SELECT ""l"".""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""l"".""user_id""=""f"".""user1_id"" WHERE ""f"".""user2_id""=1 UNION SELECT ""l"".""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""l"".""user_id""=""f"".""user2_id"" WHERE ""f"".""user1_id""=1) SELECT ""page_id"" AS ""recommended_page"" FROM ""cte"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
20,"WITH ""cte1"" AS ((SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1) UNION (SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1)), ""cte2"" AS (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friends"" FROM ""cte1"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""cte2"")"
21,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" USING (""user_id"") WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
22,"SELECT ""liked_by_friend"".""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""page_id"" FROM ""Friendship"" AS ""friends"" JOIN ""Likes"" AS ""likes"" ON ""friends"".""user2_id""=""likes"".""user_id"" WHERE ""friends"".""user1_id""=1 UNION SELECT DISTINCT ""page_id"" FROM ""Friendship"" AS ""friends"" JOIN ""Likes"" AS ""likes"" ON ""friends"".""user1_id""=""likes"".""user_id"" WHERE ""friends"".""user2_id""=1) AS ""liked_by_friend"" LEFT JOIN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AS ""liked_by_usr"" ON ""liked_by_usr"".""page_id""=""liked_by_friend"".""page_id"" WHERE ""liked_by_usr"".""page_id"" IS NULL"
23,"SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""friendship"") AS ""t"" JOIN ""likes"" ON ""user2_id""=""user_id"" WHERE ""user1_id""=1 AND ""likes"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
24,"WITH ""cte_likes"" AS (SELECT ""user_id"",""page_id"" FROM ""likes"" WHERE 1=1 AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE 1=1 AND ""user_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (""friendship"" AS ""f"") CROSS JOIN ""cte_likes"" AS ""cl"" WHERE 1=1 AND (""f"".""user2_id""=""cl"".""user_id"" OR ""f"".""user1_id""=""cl"".""user_id"") AND (""f"".""user1_id""=1 OR ""f"".""user2_id""=1)"
25,"WITH ""base"" AS (SELECT ""user1_id"" AS ""id"",""user2_id"" AS ""id1"" FROM ""Friendship"" UNION ALL SELECT ""user2_id"" AS ""id"",""user1_id"" AS ""id1"" FROM ""Friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (""base"") CROSS JOIN ""Likes"" WHERE ""base"".""id1""=""Likes"".""user_id"" AND ""id""=1 AND ""id1""!=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
26,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
27,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND ""page_id"" IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1) OR ""user_id"" IN (SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1))"
28,"WITH ""friendlist"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1), ""alreadyliked"" AS (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""friendlist"") AND ""page_id"" NOT IN (SELECT * FROM ""alreadyliked"")"
29,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
30,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" WHERE ""l"".""user_id"" IN (SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
31,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
32,"SELECT DISTINCT ""likes"" AS ""recommended_page"" FROM (SELECT ""f"".""user1_id"",""f"".""user2_id"",""l"".""page_id"" AS ""likes"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""f"".""user1_id""='1' OR ""f"".""user2_id""='1' UNION SELECT ""f"".""user1_id"",""f"".""user2_id"",""l"".""page_id"" AS ""likes"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" WHERE ""f"".""user1_id""='1' OR ""f"".""user2_id""='1') AS ""a"" WHERE ""likes"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""='1')"
33,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT * FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"",""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""friends"" JOIN ""likes"" ON ""friends"".""user2_id""=""likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
34,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
35,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
36,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""user_id"" FROM ""Friendship"" AS ""f"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
37,"WITH ""friendtable"" AS (SELECT ""user1_id"" AS ""id"",""user2_id"" AS ""friend"" FROM ""Friendship"" UNION SELECT ""user2_id"" AS ""id"",""user1_id"" AS ""friend"" FROM ""friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""friendtable"" AS ""f"" ON ""f"".""friend""=""l"".""user_id"" WHERE ""f"".""id""=1 AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
38,"WITH ""a"" AS (SELECT ""user_id"",""page_id"" FROM ""likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)) SELECT DISTINCT ""a"".""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""fre_user"" FROM (SELECT * FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AS ""b"") AS ""c"" CROSS, ""a"" WHERE ""a"".""user_id""=""c"".""fre_user"""
39,"SELECT DISTINCT ""tb1"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"" AS ""id"",""page_id"" FROM ""friendship"" JOIN ""Likes"" ON ""user2_id""=""user_id"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"" AS ""id"",""page_id"" FROM ""friendship"" JOIN ""Likes"" ON ""user1_id""=""user_id"" WHERE ""user2_id""=1) AS ""tb1"" WHERE ""tb1"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
40,"WITH ""Friends"" AS (SELECT * FROM ""Friendship"" UNION ALL SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""Friends"" AS ""f"" ON ""l"".""user_id""=""f"".""user2_id"" WHERE ""f"".""user1_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
41,"SELECT DISTINCT ""a"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""a"" JOIN ((SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) UNION ALL (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1)) AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" WHERE ""a"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
42,"WITH ""ALL_FRIENDS_TABLE"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""ALL_FRIENDS_TABLE"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
43,"SELECT ""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""freinds"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1)) AS ""k"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
44,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
45,"WITH ""frs"" AS (SELECT ""user1_id"" AS ""me"",""user2_id"" AS ""friends"" FROM ""Friendship"" UNION ALL SELECT ""user2_id"" AS ""me"",""user1_id"" AS ""friends"" FROM ""Friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""frs"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""friends""=""l"".""user_id"" WHERE ""f"".""me""=1 AND ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
46,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" WHERE ""l"".""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE NULL END AS ""user_id"" FROM ""Friendship"") AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
47,"SELECT DISTINCT ""b"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user2_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""a"" CROSS, ""Likes"" AS ""b"" WHERE ""a"".""uid""=""b"".""user_id"" AND ""b"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
48,"SELECT DISTINCT (""l"".""page_id"") AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""t"" JOIN ""Likes"" AS ""l"" USING (""user_id"") WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
49,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
50,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user2_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user2_id""=1) ORDER BY 1"
51,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
52,"WITH ""friends"" AS (SELECT ""user1_id"" AS ""user_id"",""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"" AS ""user_id"",""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""friends"" AS ""f"" LEFT JOIN ""Likes"" AS ""l"" ON ""f"".""friend_id""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""l"".""page_id"" IS NOT NULL"
53,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
54,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT LEAST(""user1_id"", ""user2_id"") AS ""min_user_id"",GREATEST(""user1_id"", ""user2_id"") AS ""max_user_id"" FROM ""Friendship"") AS ""tmp"" JOIN ""Likes"" AS ""l"" ON ""tmp"".""max_user_id""=""l"".""user_id"" WHERE ""min_user_id""=1 AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) ORDER BY 1"
55,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""a"".""user_id"",""l"".""page_id"" FROM (SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""a"" JOIN ""likes"" AS ""l"" ON ""l"".""user_id""=""a"".""user_id"" AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)) AS ""b"""
56,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
57,"WITH ""friend"" AS (SELECT ""user1_id"" AS ""id"",""user2_id"" AS ""friend"" FROM ""friendship"" UNION SELECT ""user2_id"" AS ""id"",""user1_id"" AS ""friend"" FROM ""friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (""friend"" AS ""f"" LEFT JOIN ""likes"" AS ""l"" ON ""f"".""friend""=""l"".""user_id"") LEFT JOIN ""likes"" AS ""l2"" ON ""f"".""id""=""l2"".""user_id"" AND ""l"".""page_id""=""l2"".""page_id"" WHERE ""l2"".""user_id"" IS NULL AND ""f"".""id""=1 AND ""l"".""page_id"" IS NOT NULL"
58,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
59,"WITH ""Friends"" AS (SELECT DISTINCT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT DISTINCT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""LIKES"" WHERE ""user_id"" IN (SELECT DISTINCT ""user_id"" FROM ""FRIENDS"") AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""LIKES"" WHERE ""user_id""=1) ORDER BY ""page_id"""
60,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
61,"WITH ""cte"" AS (SELECT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""l"".""user_id""=""f"".""user2_id"" WHERE ""f"".""user1_id""=1 UNION SELECT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""l"".""user_id""=""f"".""user1_id"" WHERE ""f"".""user2_id""=1) SELECT ""recommended_page"" FROM ""cte"" WHERE ""recommended_page"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
62,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT DISTINCT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
63,"WITH ""CTE"" AS (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""CTE"" ON ""cte"".""user_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
64,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""l"".""user_id"" IN (""f"".""user1_id"",""f"".""user2_id"") AND (""f"".""user1_id""=1 OR ""f"".""user2_id""=1) WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
65,"SELECT ""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""page_id"" FROM ""Likes"" JOIN ""Friendship"" ON ""Likes"".""user_id""=""Friendship"".""user2_id"" WHERE ""user1_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) UNION ALL SELECT DISTINCT ""page_id"" FROM ""Likes"" JOIN ""Friendship"" ON ""Likes"".""user_id""=""Friendship"".""user1_id"" WHERE ""user2_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)) AS ""t1"" ORDER BY ""page_id"""
66,"WITH ""ALL_FRIENDS_TABLE"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT * FROM ""ALL_FRIENDS_TABLE"")"
67,"WITH ""friends"" AS (SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""friends"" AS ""f"" ON ""l"".""user_id""=""f"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
68,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id""=1)"
69,"WITH ""friends"" AS (SELECT ""user1_id"" AS ""uid"" FROM ""friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""uid"" FROM ""friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""uid"" FROM ""friends"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
70,"WITH ""cte"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""cte1"" AS (SELECT ""user1_id"" FROM ""cte"" UNION SELECT ""user2_id"" FROM ""cte"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""i"" JOIN ""cte1"" ON ""cte1"".""user1_id""=""i"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
71,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
72,"WITH ""joined_friends"" AS (SELECT ""user1_id"" AS ""user1_id"",""user2_id"" AS ""user2_id"" FROM ""friendship"" AS ""f"" UNION ALL SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""friendship"" AS ""f""), ""friend_likes"" AS (SELECT DISTINCT ""page_id"" FROM ""likes"" AS ""l"" WHERE ""user_id"" IN (SELECT DISTINCT ""user2_id"" FROM ""joined_friends"" WHERE ""user1_id""=1)), ""liked_by_1"" AS (SELECT DISTINCT ""page_id"" FROM ""likes"" AS ""l"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""friend_likes"" AS ""f"" WHERE ""f"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""liked_by_1"")"
73,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""cte"" ON ""cte"".""id""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
74,"WITH ""myf"" AS (SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""myf"" JOIN ""likes"" ON ""myf"".""id""=""likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
75,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE NULL END AS ""user_id"" FROM ""Friendship"") HAVING ""recommended_page"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
76,"WITH ""friends"" AS (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"",""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""b"".""page_id"" AS ""recommended_page"" FROM ""friends"" AS ""a"" JOIN ""likes"" AS ""b"" ON ""a"".""user2_id""=""b"".""user_id"" WHERE ""b"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
77,"WITH ""friend_list"" AS (SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1), ""user1_page_list"" AS (SELECT ""page_id"" AS ""pages"" FROM ""Likes"" WHERE ""user_id""=1), ""friends_page_list"" AS (SELECT ""page_id"" AS ""pages"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friends"" FROM ""friend_list"")) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" IN (SELECT ""pages"" FROM ""friends_page_list"") AND ""page_id"" NOT IN (SELECT ""pages"" FROM ""user1_page_list"")"
78,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user_id""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
79,"WITH ""a"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship""), ""b"" AS (SELECT DISTINCT ""user2_id"" FROM ""a"" WHERE ""user1_id""=1) SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""b"" JOIN ""Likes"" AS ""l"" ON ""b"".""user2_id""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
80,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (""Likes"" AS ""l"" LEFT JOIN ""Friendship"" AS ""f1"" ON ""f1"".""user2_id""=""l"".""user_id"") LEFT JOIN ""Friendship"" AS ""f2"" ON ""f2"".""user1_id""=""l"".""user_id"" WHERE (""f1"".""user1_id""=1 OR ""f2"".""user2_id""=1) AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
81,"WITH ""Friendship_1"" AS (SELECT ""user2_id"",""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT ""recommended_page"" FROM (SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""f"".""user1_id""=1 AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)) AS ""a"" UNION (SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Friendship_1"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1))"
82,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user1"" FROM ""friendship"") AS ""tb"" JOIN ""likes"" AS ""l"" ON ""l"".""user_id""=""tb"".""user1"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
83,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""F"" JOIN ""Likes"" AS ""L"" ON ""F"".""user_id""=""L"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
84,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
85,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""user_id"" FROM ""Friendship"" AS ""f"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
86,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
87,"WITH ""user_1_friends"" AS (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friend_id"" FROM ""user_1_friends"") AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
88,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user_id"",""page_id"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)) AS ""a"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"" WHERE (""Friendship"".""user1_id""=1 OR ""Friendship"".""user2_id""=1))"
89,"WITH ""temp"" AS (SELECT DISTINCT (""a"".""user2_id"") AS ""friend_id"" FROM ((SELECT ""user1_id"",""user2_id"" FROM ""Friendship"") UNION (SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"")) AS ""a"" WHERE ""a"".""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" JOIN ""temp"" ON ""temp"".""friend_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
90,"WITH ""cte"" AS (SELECT ""user_id"" FROM (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""sub"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
91,"WITH ""friends"" AS (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" JOIN ""friends"" ON ""Likes"".""user_id""=""friends"".""user1_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
92,"WITH ""cte"" AS (SELECT DISTINCT (CASE WHEN ""a"".""user1_id""<=""a"".""user2_id"" THEN ""a"".""user1_id"" ELSE ""a"".""user2_id"" END) AS ""user1"",(CASE WHEN ""a"".""user1_id"">""a"".""user2_id"" THEN ""a"".""user1_id"" ELSE ""a"".""user2_id"" END) AS ""user2"" FROM ""Friendship"" AS ""a"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT * FROM ""cte"" WHERE ""user1""=1 AND ""user1""!=""user2"") AS ""c"" JOIN ""Likes"" AS ""l"" ON ""c"".""user2""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
93,"WITH ""friend"" AS (SELECT ""user1_id"" AS ""id"",""user2_id"" AS ""friend"" FROM ""friendship"" UNION SELECT ""user2_id"" AS ""id"",""user1_id"" AS ""friend"" FROM ""friendship"") SELECT * FROM (SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (""friend"" AS ""f"" LEFT JOIN ""likes"" AS ""l"" ON ""f"".""friend""=""l"".""user_id"") LEFT JOIN ""likes"" AS ""l2"" ON ""f"".""id""=""l2"".""user_id"" AND ""l"".""page_id""=""l2"".""page_id"" WHERE ""l2"".""user_id"" IS NULL AND ""f"".""id""=1) AS ""a"" WHERE ""recommended_page"" IS NOT NULL"
94,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
95,"WITH ""user_liked"" AS (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1), ""friends_liked"" AS (SELECT DISTINCT (""page_id"") FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""f"".""user1_id""=1 UNION SELECT DISTINCT (""page_id"") FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""f"".""user1_id""=""l"".""user_id"" WHERE ""f"".""user2_id""=1) SELECT ""page_id"" AS ""recommended_page"" FROM ""friends_liked"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
96,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
97,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f1"" ON ""f1"".""user1_id""=""l"".""user_id"" AND ""f1"".""user2_id""=1 UNION SELECT ""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f2"" ON ""f2"".""user2_id""=""l"".""user_id"" AND ""f2"".""user1_id""=1) AS ""tmp"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
98,"WITH ""temp0"" AS (SELECT DISTINCT ""user1_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT DISTINCT ""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""a"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""a"" JOIN ""temp0"" AS ""b"" ON ""b"".""friend""=""a"".""user_id"" WHERE ""a"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
99,"WITH ""friend"" AS ((SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) UNION (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""friend"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
100,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""a"" JOIN ""likes"" AS ""b"" ON ""a"".""id""=""b"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
101,"WITH ""cte"" AS (SELECT DISTINCT ""user2_id"" AS ""friend"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION ALL SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"") AS ""t"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friend"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
102,"WITH ""friends"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION SELECT ""user2_id"",""user1_id"" FROM ""Friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""friends"" AS ""F"" JOIN ""Likes"" AS ""L"" ON ""F"".""user2_id""=""L"".""user_id"" WHERE NOT EXISTS (SELECT 2 FROM ""Likes"" AS ""L2"" WHERE ""F"".""user1_id""=""L2"".""user_id"" AND ""L"".""page_id""=""L2"".""page_id"") AND ""user1_id""=1"
103,"SELECT ""a"".""recommended_page"" FROM (SELECT DISTINCT ""b"".""page_id"" AS ""recommended_page"" FROM ((SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) UNION (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)) AS ""a"" LEFT JOIN ""Likes"" AS ""b"" ON ""a"".""user2_id""=""b"".""user_id"" WHERE ""b"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) ORDER BY ""recommended_page"") AS ""a"" WHERE ""a"".""recommended_page"" IS NOT NULL"
104,"WITH ""t1"" AS (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""t2"" AS (SELECT DISTINCT ""user_id"" FROM ""likes"" WHERE (""user_id"" IN (SELECT ""user1_id"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user2_id"" FROM ""t1"")) AND ""user_id""!=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""t2"" LEFT JOIN ""likes"" USING (""user_id"") WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) ORDER BY ""page_id"""
105,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" OR ""f"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND (""user1_id""=1 OR ""user2_id""=1)"
106,"WITH ""cte"" AS (SELECT ""user1_id"" AS ""friend"" FROM ""friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""cte"" AS ""c"" ON ""l"".""user_id""=""c"".""friend"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
107,"WITH ""cte"" AS (SELECT ""user_id"" FROM (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""sub"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
108,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" OR ""f"".""user1_id""=""l"".""user_id"" WHERE (""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
109,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT (CASE WHEN ""user1_id""<""user2_id"" THEN ""user1_id"" ELSE ""user2_id"" END) AS ""user1_id"",(CASE WHEN ""user1_id"">""user2_id"" THEN ""user1_id"" ELSE ""user2_id"" END) AS ""user2_id"" FROM ""Friendship"") AS ""temp"" JOIN ""Likes"" AS ""l"" ON ""temp"".""user2_id""=""l"".""user_id"" AND ""temp"".""user1_id""=1 WHERE ""l"".""user_id""!=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
110,"WITH ""cte_friends"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""already_liked"" AS (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1), ""pages_rec"" AS (SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" JOIN ""cte_friends"" AS ""cf"" ON ""likes"".""user_id""=""cf"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""already_liked"")) SELECT * FROM ""pages_rec"""
111,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END) AS ""user_id"" FROM ""Friendship"") AS ""sub"" JOIN ""likes"" AS ""l"" ON (""sub"".""user_id""=""l"".""user_id"") WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
112,"WITH ""users"" AS (SELECT ""user1_id"" AS ""user1"",""user2_id"" AS ""user2"" FROM ""Friendship"" AS ""f1"" UNION SELECT ""user2_id"" AS ""user1"",""user1_id"" AS ""user2"" FROM ""Friendship"" AS ""f2"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""users"" AS ""u"" JOIN ""Likes"" AS ""l"" ON ""u"".""user2""=""l"".""user_id"" WHERE ""u"".""user1""=1 AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" AS ""l1"" WHERE ""user_id""=1)"
113,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
114,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
115,"WITH ""friend_list"" AS (SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1), ""user1_page_list"" AS (SELECT ""page_id"" AS ""pages"" FROM ""Likes"" WHERE ""user_id""=1), ""friends_page_list"" AS (SELECT ""page_id"" AS ""pages"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friends"" FROM ""friend_list"")) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" IN (SELECT ""pages"" FROM ""friends_page_list"") AND ""page_id"" NOT IN (SELECT ""pages"" FROM ""user1_page_list"")"
116,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""l"".""user_id""=""f"".""user2_id"" OR ""l"".""user_id""=""f"".""user1_id"" WHERE (""f"".""user1_id""=1 OR ""f"".""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
117,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
118,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""user_id"" FROM ""Friendship"" AS ""f"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
119,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT DISTINCT ""user2_id"" AS ""user1_friends"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION ALL SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"") AS ""a"" WHERE ""user1_id""=1)"
120,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1)"
121,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""f1"".""user2_id"" AS ""user_id"" FROM ""friendship"" AS ""f1"" WHERE ""f1"".""user1_id""=1 UNION SELECT DISTINCT ""f2"".""user1_id"" AS ""user_id"" FROM ""friendship"" AS ""f2"" WHERE ""f2"".""user2_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
122,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
123,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT (CASE WHEN ""user1_id""=1 AND ""user2_id""!=1 THEN ""user2_id"" ELSE ""user1_id"" END) AS ""user_id"" FROM ""Friendship"" WHERE (""user1_id""=1 AND ""user2_id""!=1) OR (""user2_id""=1 AND ""user1_id""!=1)) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
124,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
125,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END) AS ""user_id"" FROM ""friendship"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
126,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""a"" WHERE (""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1) OR ""user_id"" IN (SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1)) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
127,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"") AS ""a"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
128,"WITH ""ONES_FRIENDS"" AS (SELECT ""user2_id"" AS ""ones_friends"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""ones_friends"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""ONES_FRIENDS"" AS ""o"" JOIN ""Likes"" AS ""l"" ON ""o"".""ones_friends""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
129,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
130,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE NOT ""page_id"" IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE 0 END) AS ""user"" FROM ""Friendship"" HAVING ""user""!=0)"
131,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""='1' THEN ""user2_id"" ELSE ""user1_id"" END AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""='1' OR ""user2_id""='1') AS ""a"" JOIN ""Likes"" AS ""l"" ON ""a"".""user_id""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
132,"WITH ""user1_friend"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""user1_friend"" AS ""u"" JOIN ""Likes"" AS ""l"" ON ""l"".""user_id""=""u"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
133,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END FROM ""friendship"") AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
134,"WITH ""f"" AS (SELECT CASE WHEN ""user1_id""<""user2_id"" THEN ""user1_id"" ELSE ""user2_id"" END AS ""id"",CASE WHEN ""user1_id"">""user2_id"" THEN ""user1_id"" ELSE ""user2_id"" END AS ""friend_id"" FROM ""Friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""friend_id""=""l"".""user_id"" WHERE ""f"".""id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
135,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" OR ""f"".""user1_id""=""l"".""user_id"" WHERE (""f"".""user1_id""=1 OR ""f"".""user2_id""=1) AND ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
136,"WITH ""cte"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
137,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
138,"WITH ""CTE1"" AS (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"",""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1), ""CTE2"" AS (SELECT ""user2_id"" FROM ""CTE1"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (""likes"") CROSS JOIN ""CTE2"" WHERE ""user_id"" IN (""user2_id"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
139,"SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""likes"" JOIN (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""users"" ON ""likes"".""user_id""=""users"".""user_id"" AND ""likes"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
140,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)"
141,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
142,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
143,"SELECT DISTINCT ""p"".""page_id"" AS ""recommended_page"" FROM (SELECT ""t"".""user_id"",""l"".""page_id"" FROM (SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""t"" JOIN ""likes"" AS ""l"" ON ""t"".""user_id""=""l"".""user_id"") AS ""p"" WHERE ""p"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
144,"WITH ""user_1_friends"" AS (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT (""l"".""page_id"") AS ""recommended_page"" FROM ""user_1_friends"" AS ""u"" JOIN ""Likes"" AS ""l"" ON ""u"".""friend_id""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""LIKES"" WHERE ""user_id""=1) GROUP BY ""l"".""page_id"""
145,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT DISTINCT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
146,"WITH ""friends1"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 GROUP BY ""user_id""), ""friend_like"" AS (SELECT ""l"".""page_id"" FROM ""friends1"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user_id""=""l"".""user_id"" GROUP BY ""page_id"") SELECT ""page_id"" AS ""recommended_page"" FROM ""friend_like"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
147,"WITH ""CET"" AS (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""CET"" ON ""l"".""user_id""=""CET"".""id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) ORDER BY ""page_id"""
148,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" JOIN (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""temp"" ON ""temp"".""id""=""likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
149,"WITH ""cte"" AS (SELECT ""f"".""user1_id"" AS ""users"",""l"".""page_id"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" WHERE ""user2_id""=1 UNION SELECT ""f"".""user2_id"" AS ""users"",""l"".""page_id"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""cte"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
150,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
151,"WITH ""ALL_FRIENDS_TABLE"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""ALL_FRIENDS_TABLE"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
152,"WITH ""friends"" AS (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" JOIN ""friends"" ON ""Likes"".""user_id""=""friends"".""user1_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
153,"WITH ""friends"" AS (SELECT ""user2_id"" AS ""u"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""u"" FROM ""friendship"" WHERE ""user2_id""=1), ""pages"" AS (SELECT ""user_id"",""page_id"" FROM ""likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""pages"" AS ""p"" JOIN ""friends"" AS ""f"" ON ""p"".""user_id""=""f"".""u"""
154,"SELECT DISTINCT ""c"".""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""uid"" FROM (SELECT DISTINCT ""user1_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user2_id""=1 AND ""user1_id""!=1 UNION ALL SELECT DISTINCT ""user2_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user1_id""=1 AND ""user2_id""!=1) AS ""a"") AS ""d"" JOIN (SELECT DISTINCT * FROM ""Likes"") AS ""c"" ON ""d"".""uid""=""c"".""user_id"" WHERE ""c"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1 AND ""page_id"" IS NOT NULL)"
155,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
156,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
157,"WITH ""frnd"" AS (SELECT ""user2_id"" AS ""users"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""users"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""users"" FROM ""frnd"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
158,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT CASE WHEN ""user1_id"">""user2_id"" THEN ""user1_id"" ELSE ""user2_id"" END AS ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1)"
159,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"") AS ""f"" USING (""user_id"") WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
160,"WITH ""t1"" AS (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""t2"" AS (SELECT DISTINCT ""user_id"" FROM ""likes"" WHERE (""user_id"" IN (SELECT ""user1_id"" FROM ""t1"") OR ""user_id"" IN (SELECT ""user2_id"" FROM ""t1"")) AND ""user_id""!=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""t2"" LEFT JOIN ""likes"" USING (""user_id"") WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) ORDER BY ""page_id"""
161,"WITH ""AllFriends"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1), ""FriendsLikes"" AS (SELECT ""page_id"" FROM ""Likes"" AS ""L"" JOIN ""AllFriends"" AS ""AF"" ON ""AF"".""user_id""=""L"".""user_id"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""FriendsLikes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
162,"WITH ""x"" AS (SELECT ""user2_id"" AS ""user"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user"" FROM ""x"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
163,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ((""f"".""user1_id""=""l"".""user_id"" AND ""f"".""user2_id""=1) OR (""f"".""user2_id""=""l"".""user_id"" AND ""f"".""user1_id""=1)) WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
164,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN (SELECT (CASE WHEN ""f"".""user1_id""=1 THEN ""f"".""user2_id"" WHEN ""f"".""user2_id""=1 THEN ""f"".""user1_id"" ELSE NULL END) AS ""one_friend_id"" FROM ""Friendship"" AS ""f"") AS ""t"" ON ""t"".""one_friend_id""=""l"".""user_id"" WHERE ""one_friend_id"" IS NOT NULL AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) ORDER BY ""page_id"""
165,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)"
166,"WITH ""user1_friends"" AS (SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1), ""user1_likes"" AS (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""user1_friends"") AND ""page_id"" NOT IN (SELECT * FROM ""user1_likes"")"
167,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"",""user2_id"",""user_id"" AS ""match_id"",""page_id"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION SELECT ""user2_id"",""user1_id"" FROM ""Friendship"") AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""user1_id""=1) AS ""p"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
168,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friends_id"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
169,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""id"" FROM ""Friendship"") AS ""a"" JOIN ""likes"" AS ""l"" ON ""a"".""id""=""l"".""user_id"" WHERE ROW(1,""l"".""page_id"") NOT IN (SELECT * FROM ""Likes"")"
170,"WITH ""cte_friends"" AS (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""cte_final"" AS (SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte_friends"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)) SELECT * FROM ""cte_final"""
171,"WITH ""all_friendship"" AS (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" UNION SELECT ""user2_id"",""user1_id"" FROM ""friendship"") SELECT DISTINCT ""a"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""a"" JOIN ""all_friendship"" AS ""b"" ON ""b"".""user2_id""=""a"".""user_id"" WHERE ""b"".""user1_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
172,"WITH ""usersfriends"" AS (SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friends"" FROM ""usersfriends"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
173,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
174,"WITH ""cte1"" AS (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""cte2"" AS (SELECT ""page_id"" FROM ""cte1"" LEFT JOIN ""likes"" ON ""user1_id""=""user_id"" WHERE ""user_id""!=1 UNION ALL SELECT ""page_id"" FROM ""cte1"" LEFT JOIN ""likes"" ON ""user2_id""=""user_id"" WHERE ""user_id""!=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""cte2"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
175,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friend_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
176,"SELECT DISTINCT ""a"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user_id"",""page_id"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT DISTINCT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)) AS ""a"""
177,"WITH ""user1_friend"" AS (SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION ALL SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT ""page_id"" AS ""recommended_page"" FROM ""Likes"" JOIN ""user1_friend"" USING (""user_id"") WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY 1"
178,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""a"" JOIN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" AND ""a"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
179,"WITH ""t"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user_id"" FROM ""t"")"
180,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION ALL SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
181,"WITH ""friend"" AS (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""friend"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
182,"ERROR: mysql parse error: line 1 column 232 near ""UNION (select id from f2)) AND page_id NOT IN (select page_id from Likes where user_id=1) "" "
183,"ERROR: mysql parse error: line 1 column 61 near ""), user1 AS ( SELECT DISTINCT user1_id FROM Friendship WHERE user2_id = 1 ) SELECT DISTINCT page_id AS recommended_page FROM Likes WHERE user_id IN ( SELECT user2_id FROM user2 UNION SELECT user1_id FROM user1 ) AND page_id NOT IN ( SELECT page_id FROM Likes WHERE user_id = 1 ) "" "
184,"WITH ""friends"" AS (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" JOIN ""friends"" ON ""friends"".""id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
185,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
186,"WITH ""user_friend"" AS (SELECT DISTINCT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT DISTINCT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1), ""liked_pages"" AS (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""user_friend"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""liked_pages"")"
187,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE '' END FROM ""Friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
188,"WITH ""table1"" AS (SELECT ""user2_id"" AS ""users"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""users"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""table1"" AS ""t"" JOIN ""Likes"" AS ""l"" ON ""t"".""users""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
189,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"" AS ""user_id"",""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"" AS ""user_id"",""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""a"" JOIN ""Likes"" AS ""l"" ON ""a"".""friend_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
190,"WITH ""cte"" AS (SELECT DISTINCT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1 UNION ALL SELECT DISTINCT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
191,"WITH ""cte"" AS (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""cte"" AS ""c"" JOIN ""Likes"" AS ""l"" ON ""c"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
192,"SELECT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friendid"" FROM ""Friendship"") AS ""f"" ON ""f"".""friendid""=""l"".""user_id"" GROUP BY 1 HAVING ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
193,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT DISTINCT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""A"" JOIN ""likes"" AS ""l"" ON ""l"".""user_id""=""A"".""id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
194,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
195,"WITH ""t1"" AS ((SELECT ""user1_id"" AS ""freind1"",""user2_id"" AS ""freind2"" FROM ""Friendship"" WHERE ""user1_id""<""user2_id"") UNION (SELECT ""user2_id"" AS ""freind1"",""user1_id"" AS ""freind2"" FROM ""Friendship"" WHERE ""user2_id""<""user1_id"")) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""freind2"" FROM ""t1"" WHERE ""freind1""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
196,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
197,"WITH ""cte_friends"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""already_liked"" AS (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1), ""pages_rec"" AS (SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM (""likes"" JOIN ""cte_friends"" AS ""cf"" ON ""likes"".""user_id""=""cf"".""user_id"") LEFT JOIN ""already_liked"" AS ""al"" ON ""likes"".""page_id""=""al"".""page_id"" WHERE ""al"".""page_id"" IS NULL) SELECT * FROM ""pages_rec"""
198,"WITH ""friends"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1), ""user_liked"" AS (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) SELECT ""l"".""page_id"" AS ""recommended_page"" FROM (""likes"" AS ""l"" JOIN ""friends"" AS ""f"" ON ""l"".""user_id""=""f"".""user_id"") LEFT JOIN ""user_liked"" AS ""u"" ON ""u"".""page_id""=""l"".""page_id"" WHERE ""u"".""page_id"" IS NULL GROUP BY ""l"".""page_id"""
199,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""cte"" AS ""c"" ON ""l"".""user_id""=""c"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
200,"WITH ""cte"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""fr"" FROM ""friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""fr"" FROM ""cte"" WHERE ""fr"" IS NOT NULL) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
201,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT (CASE WHEN ""user1_id""=1 AND ""user2_id""!=1 THEN ""user2_id"" ELSE ""user1_id"" END) AS ""user_id"" FROM ""Friendship"" WHERE (""user1_id""=1 AND ""user2_id""!=1) OR (""user2_id""=1 AND ""user1_id""!=1)) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
202,"WITH ""cte"" AS (SELECT ""user1_id"" AS ""a"",""user2_id"" AS ""b"" FROM ""friendship"" UNION ALL SELECT ""user2_id"" AS ""a"",""user1_id"" AS ""b"" FROM ""friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""b"" AS ""user_id"" FROM ""cte"" WHERE ""a""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
203,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
204,"WITH ""cte"" AS (SELECT ""user1_id"" AS ""id"",""user2_id"" AS ""user"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user2_id"" AS ""id"",""user1_id"" AS ""user"" FROM ""Friendship"" WHERE ""user2_id""=1), ""cte2"" AS (SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user"" FROM ""cte"")) SELECT ""recommended_page"" FROM ""cte2"" WHERE ""recommended_page"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
205,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
206,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""cte"" ON ""cte"".""id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
207,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""page_id"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""l"".""user_id""=""f"".""user1_id"" WHERE ""f"".""user2_id""=1 UNION SELECT DISTINCT ""page_id"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""l"".""user_id""=""f"".""user2_id"" WHERE ""f"".""user1_id""=1) AS ""x"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
208,"WITH ""user1_friends"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friends"" FROM ""Friendship"") SELECT ""l"".""page_id"" AS ""recommended_page"" FROM ""user1_friends"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""friends""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY ""recommended_page"""
209,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
210,"WITH ""temp"" AS (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""id"" FROM ""temp"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
211,"WITH ""FRIENDS"" AS (SELECT ""USER1_ID"" AS ""ID"" FROM ""FRIENDSHIP"" WHERE ""USER2_ID""=1 UNION SELECT ""USER2_ID"" FROM ""FRIENDSHIP"" WHERE ""USER1_ID""=1) SELECT DISTINCT ""L"".""PAGE_ID"" AS ""RECOMMENDED_PAGE"" FROM ""LIKES"" AS ""L"" JOIN ""FRIENDS"" AS ""F"" ON ""L"".""USER_ID""=""F"".""ID"" AND ""PAGE_ID"" NOT IN (SELECT ""PAGE_ID"" FROM ""LIKES"" WHERE ""USER_ID""=1)"
212,"SELECT DISTINCT ""a"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""a"" JOIN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user1_friends"" FROM ""Friendship"") AS ""t"" ON ""a"".""user_id""=""t"".""user1_friends"" WHERE ""a"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
213,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE (""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) OR ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
214,"WITH ""cte1"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION ALL SELECT ""user2_id"",""user1_id"" FROM ""Friendship"") SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM ""likes"" JOIN ""cte1"" ON ""cte1"".""user2_id""=""likes"".""user_id"" WHERE ""cte1"".""user1_id""=1 AND ""cte1"".""user2_id""!=1 AND ""likes"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
215,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
216,"WITH ""new"" AS (SELECT CASE WHEN ""user1_id""<""user2_id"" THEN ""user1_id"" WHEN ""user1_id"">""user2_id"" THEN ""user2_id"" END AS ""user1"",CASE WHEN ""user1_id""<""user2_id"" THEN ""user2_id"" WHEN ""user1_id"">""user2_id"" THEN ""user1_id"" END AS ""user2"" FROM ""friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""new"" AS ""n"" JOIN ""likes"" AS ""l"" ON ""n"".""user2""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND ""n"".""user1""=1 ORDER BY ""l"".""page_id"""
217,"SELECT DISTINCT (""l"".""page_id"") AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""t"" JOIN ""Likes"" AS ""l"" USING (""user_id"") WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
218,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
219,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""user_id"" FROM ""Friendship"" AS ""f"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
220,"SELECT ""recommended_page"" FROM (SELECT ""recommended_page"" FROM (SELECT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1) AND ""user_id""!=1) AS ""a"" UNION ALL (SELECT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""user_id""!=1)) AS ""x"" WHERE ""recommended_page"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) GROUP BY ""recommended_page"""
221,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""users"" FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
222,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" OR ""f"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND (""user1_id""=1 OR ""user2_id""=1)"
223,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"")) AS ""sub"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
224,"WITH ""user1friends"" AS (SELECT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END) AS ""friends_id"" FROM ""Friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friends_id"" FROM ""user1friends"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""='1')"
225,"WITH ""user1_friends"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""friends"" FROM ""Friendship"") SELECT ""l"".""page_id"" AS ""recommended_page"" FROM ""user1_friends"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""friends""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY ""recommended_page"""
226,"SELECT ""C"".""pg"" AS ""recommended_page"" FROM ((SELECT ""l"".""page_id"" AS ""pg"" FROM ""likes"" AS ""l"" JOIN (SELECT ""user2_id"" AS ""frnd"" FROM ""friendship"" WHERE ""user1_id""=1) AS ""A"" ON ""l"".""user_id""=""A"".""frnd"") UNION (SELECT ""l"".""page_id"" AS ""pg"" FROM ""likes"" AS ""l"" JOIN (SELECT ""user1_id"" AS ""frnd"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""B"" ON ""l"".""user_id""=""B"".""frnd"")) AS ""C"" WHERE ""C"".""pg"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
227,"WITH ""t1"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""t1"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
228,"WITH ""tmp"" AS (SELECT ""user2_id"" AS ""fid"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""fid"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""a"" JOIN ""tmp"" AS ""b"" ON ""a"".""user_id""=""b"".""fid"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""a"".""page_id"" FROM ""likes"" AS ""a"" WHERE ""a"".""user_id""=1)"
229,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
230,"WITH ""cte"" AS (SELECT ""user1_friend"" FROM (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user1_friend"" FROM ""friendship"") AS ""a"" WHERE ""user1_friend"" IS NOT NULL) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT * FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
231,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT (CASE WHEN ""f"".""user1_id""=1 THEN ""f"".""user2_id"" WHEN ""f"".""user2_id""=1 THEN ""f"".""user1_id"" ELSE NULL END) AS ""user_id"" FROM ""friendship"" AS ""f"") AS ""a"" JOIN ""likes"" AS ""l"" ON ""a"".""user_id""=""l"".""user_id"" AND ""l"".""page_id"" NOT IN (SELECT ""l1"".""page_id"" FROM ""likes"" AS ""l1"" WHERE ""l1"".""user_id""=1)"
232,"WITH ""cte1"" AS (SELECT ""fr"".""user2_id"" AS ""friend"" FROM ""Friendship"" AS ""fr"" WHERE ""fr"".""user1_id""=1 UNION ALL SELECT ""fr"".""user1_id"" AS ""friend"" FROM ""Friendship"" AS ""fr"" WHERE ""fr"".""user2_id""=1) SELECT DISTINCT ""lk"".""page_id"" AS ""recommended_page"" FROM ""cte1"" AS ""ct1"" JOIN ""likes"" AS ""lk"" ON ""ct1"".""friend""=""lk"".""user_id"" WHERE ""lk"".""page_id"" NOT IN (SELECT ""lk1"".""page_id"" FROM ""likes"" AS ""lk1"" WHERE ""lk1"".""user_id""=1) ORDER BY 1"
233,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
234,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON (""l"".""user_id""=""f"".""user2_id"" AND ""f"".""user1_id""=1) OR (""l"".""user_id""=""f"".""user1_id"" AND ""f"".""user2_id""=1) WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
235,"WITH ""f"" AS (SELECT ""user1_id"" AS ""u1"",""user2_id"" AS ""u2"" FROM ""Friendship"" UNION SELECT ""user2_id"" AS ""u1"",""user1_id"" AS ""u2"" FROM ""Friendship"") SELECT DISTINCT ""b"".""page_id"" AS ""recommended_page"" FROM ""f"" AS ""a"" JOIN ""Likes"" AS ""b"" ON ""a"".""u1""=1 AND ""a"".""u2""=""b"".""user_id"" WHERE ""b"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
236,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""='1') AND (""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""='1') OR ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""='1'))"
237,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
238,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
239,"WITH ""f"" AS (SELECT ""u1"",""u2"" FROM (SELECT ""user1_id"" AS ""u1"",""user2_id"" AS ""u2"" FROM ""Friendship"" UNION SELECT ""user2_id"" AS ""u1"",""user1_id"" AS ""u2"" FROM ""Friendship"") AS ""a"" WHERE ""u1""=1) SELECT DISTINCT ""b"".""page_id"" AS ""recommended_page"" FROM ""f"" AS ""a"" JOIN ""Likes"" AS ""b"" ON ""a"".""u2""=""b"".""user_id"" WHERE ""b"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
240,"WITH ""cte"" AS (SELECT ""user1_friend"" FROM (SELECT DISTINCT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user1_friend"" FROM ""friendship"") AS ""a"" WHERE ""user1_friend"" IS NOT NULL) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT * FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
241,"WITH ""cte"" AS (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 AND ""user1_id""!=1 UNION ALL SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""cte"" AS ""c"" ON ""l"".""user_id""=""c"".""user1_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
242,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
243,"SELECT ""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""user1_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) UNION SELECT ""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" WHERE ""user2_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
244,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""l"".""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""a"" ON ""l"".""user_id""=""a"".""user1_id"" WHERE ""a"".""user2_id""=1 UNION SELECT ""l"".""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""a"" ON ""l"".""user_id""=""a"".""user2_id"" WHERE ""a"".""user1_id""=1) AS ""a"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
245,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" WHERE ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
246,"WITH ""user1_friend"" AS (SELECT DISTINCT ""user1_id"" AS ""self_id"",""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT DISTINCT ""user2_id"" AS ""self_id"",""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1), ""tmp1"" AS (SELECT ""t1"".""self_id"",""t2"".""page_id"" AS ""self_like"" FROM ""user1_friend"" AS ""t1"" LEFT JOIN ""Likes"" AS ""t2"" ON ""t1"".""self_id""=""t2"".""user_id"" GROUP BY 1,2), ""tmp2"" AS (SELECT ""t1"".""self_id"",""t3"".""page_id"" AS ""friend_like"" FROM ""user1_friend"" AS ""t1"" LEFT JOIN ""Likes"" AS ""t3"" ON ""t1"".""friend_id""=""t3"".""user_id"" GROUP BY 1,2), ""tmp3"" AS (SELECT ""tmp1"".""self_id"",COALESCE(""tmp1"".""self_like"", 0) AS ""self_like"",COALESCE(""tmp2"".""friend_like"", 0) AS ""friend_like"" FROM ""tmp1"" LEFT JOIN ""tmp2"" ON ""tmp1"".""self_id""=""tmp2"".""self_id"") SELECT DISTINCT (""friend_like"") AS ""recommended_page"" FROM ""tmp3"" WHERE ""friend_like"" NOT IN (SELECT DISTINCT ""self_like"" FROM ""tmp3"") AND ""friend_like""!=0 ORDER BY 1 DESC"
247,"SELECT DISTINCT ""L"".""page_id"" AS ""recommended_page"" FROM (""Friendship"" AS ""F"") CROSS JOIN ""Likes"" AS ""L"" WHERE ((""F"".""user1_id""=1 AND ""L"".""user_id""=""F"".""user2_id"") OR (""F"".""user2_id""=1 AND ""L"".""user_id""=""F"".""user1_id"")) AND ""L"".""page_id"" NOT IN (SELECT ""L2"".""page_id"" FROM ""Likes"" AS ""L2"" WHERE ""L2"".""user_id""=1)"
248,"WITH ""t1"" AS (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""t1"" AS ""a"" JOIN ""likes"" AS ""b"" ON ""a"".""id""=""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
249,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE '' END FROM ""friendship"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
250,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
251,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""userid"" FROM ""friendship"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
252,"SELECT DISTINCT ""likes"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""friendship"") AS ""t"" JOIN ""likes"" ON ""user2_id""=""user_id"" WHERE ""user1_id""=1 AND ""likes"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
253,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)"
254,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN (SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION ALL SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""f"" ON ""l"".""user_id""=""f"".""friends"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
255,"WITH ""combined"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION ALL SELECT ""user2_id"",""user1_id"" FROM ""Friendship""), ""friends"" AS (SELECT ""user2_id"" FROM ""combined"" WHERE ""user1_id""=1) SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friends"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""LIKES"" WHERE ""user_id""=1)"
256,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"") AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""f"".""user1_id""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
257,"WITH ""user1_friends"" AS (SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1), ""user1_likes"" AS (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""user1_friends"") AND ""page_id"" NOT IN (SELECT * FROM ""user1_likes"")"
258,"WITH ""u1_l"" AS (SELECT * FROM ""Likes"" WHERE ""user_id""=1), ""u1_f"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION SELECT ""user2_id"" AS ""user1_id"",""user1_id"" AS ""user2_id"" FROM ""Friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""u1_f"" ON ""u1_f"".""user1_id""=""l"".""user_id"" WHERE (""user1_id""=1 OR ""user2_id""=1) AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""u1_l"")"
259,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
260,"WITH ""friends_of_1"" AS (SELECT ""user2_id"" AS ""user_1_friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_1_friend"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user_1_friend"" FROM ""friends_of_1"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) ORDER BY 1"
261,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user2_id""=1 THEN ""user1_id"" WHEN ""user1_id""=1 THEN ""user2_id"" END AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1 OR ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
262,"SELECT DISTINCT ""L"".""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""F"" JOIN ""Likes"" AS ""L"" ON ""F"".""user2_id""=""L"".""user_id"" WHERE ""F"".""user1_id""=1 AND ""L"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) UNION SELECT DISTINCT ""L"".""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""F"" JOIN ""Likes"" AS ""L"" ON ""F"".""user1_id""=""L"".""user_id"" WHERE ""F"".""user2_id""=1 AND ""L"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
263,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT * FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON (""a"".""user1_id""=""Likes"".""user_id"" AND ""user2_id""=1 OR ""a"".""user2_id""=""Likes"".""user_id"" AND ""user1_id""=1) WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
264,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
265,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user1_friends"" FROM ""Friendship"") AS ""t1"" JOIN ""Likes"" AS ""l"" ON ""t1"".""user1_friends""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
266,"WITH ""Table1"" AS (SELECT CASE WHEN ""user2_id"">""user1_id"" THEN ""user1_id"" ELSE ""user2_id"" END AS ""user1_id"",CASE WHEN ""user2_id""<""user1_id"" THEN ""user1_id"" ELSE ""user2_id"" END AS ""user2_id"" FROM ""Friendship"" ORDER BY 1), ""Table2"" AS (SELECT ""user_id"",""page_id"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Table1"" WHERE ""user1_id""=1)), ""Table3"" AS (SELECT ""user_id"",""page_id"" FROM ""Likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Table2"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Table3"")"
267,"WITH ""t1"" AS (SELECT DISTINCT ""user_id"",""page_id"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""t1"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) OR ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)"
268,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
269,"WITH ""t"" AS (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"",""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""user_id"" IN (SELECT ""user2_id"" FROM ""t"")"
270,"SELECT ""recommended_page"" FROM (SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" AS ""f1"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""friendship"" AS ""f2"" WHERE ""user2_id""=1)) AS ""t"" WHERE ""recommended_page"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
271,"WITH ""friend_1"" AS (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""a"" JOIN ""friend_1"" AS ""b"" ON ""a"".""user_id""=""b"".""user1_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
272,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""A"" JOIN ""Likes"" AS ""B"" ON ""A"".""id""=""B"".""user_id"" WHERE ""B"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
273,"WITH ""friends"" AS (SELECT DISTINCT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT DISTINCT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""friends"") AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
274,"WITH ""A_FRIEND"" AS (SELECT ""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT * FROM ""A_FRIEND"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
275,"WITH ""friend_likes"" AS (SELECT ""l"".""user_id"",""l"".""page_id"" FROM ""likes"" AS ""l"" WHERE ""l"".""user_id""!=1 AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)) SELECT DISTINCT ""fl"".""page_id"" AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""friend_likes"" AS ""fl"" ON ""fl"".""user_id""=""f"".""user2_id"" WHERE ""f"".""user1_id""=1 UNION SELECT ""fl"".""page_id"" AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""friend_likes"" AS ""fl"" ON ""fl"".""user_id""=""f"".""user1_id"" WHERE ""f"".""user2_id""=1 ORDER BY 1"
276,"WITH ""temp"" AS (SELECT DISTINCT (""a"".""friend"") AS ""friend"" FROM (SELECT ""user1_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""a"" WHERE ""friend""!=1) SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""Likes"" JOIN ""temp"" ON ""temp"".""friend""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT DISTINCT (""page_id"") AS ""recommended_page "" FROM ""Likes"" WHERE ""user_id""=1)"
277,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friends"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""friends"" FROM ""cte"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
278,"SELECT DISTINCT ""L"".""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""F"" JOIN ""Likes"" AS ""L"" ON ""F"".""user2_id""=""L"".""user_id"" AND ""F"".""user1_id""=1 HAVING ""recommended_page"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""LIKES"" WHERE ""user_id""=1) UNION SELECT DISTINCT ""L2"".""page_id"" AS ""recommended_page"" FROM ""Friendship"" AS ""F"" JOIN ""Likes"" AS ""L2"" ON ""F"".""user1_id""=""L2"".""user_id"" AND ""F"".""user2_id""=1 AND ""L2"".""user_id""!=1 HAVING ""recommended_page"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""LIKES"" WHERE ""user_id""=1)"
279,"WITH ""CTE"" AS (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""CTE"" AS ""C"" JOIN ""Likes"" AS ""l"" ON ""c"".""user_id""=""l"".""user_id"" AND ""c"".""user_id"" IS NOT NULL WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
280,"WITH ""initital"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user_id"" FROM ""initital"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
281,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""l"" JOIN ""Friendship"" AS ""f"" ON (""l"".""user_id""=""f"".""user1_id"" AND ""f"".""user2_id""=1) OR (""l"".""user_id""=""f"".""user2_id"" AND ""f"".""user1_id""=1) WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
282,"SELECT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) GROUP BY 1"
283,"SELECT ""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""l"".""page_id"" FROM ""Likes"" AS ""l"" JOIN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""t"" ON ""t"".""friend_id""=""l"".""user_id"") AS ""m"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
284,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT ""user2_id"" AS ""friend"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend"" FROM ""friendship"" WHERE ""user2_id""=1) AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""friend""=""l"".""user_id"" WHERE ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) ORDER BY 1"
285,"WITH ""me_f"" AS (SELECT ""user1_id"" AS ""id"",""user2_id"" AS ""friend"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"" AS ""id"",""user1_id"" AS ""friend"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""me_f"" AS ""m"" JOIN ""Likes"" AS ""l"" ON ""m"".""friend""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
286,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" OR ""f"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND (""user1_id""=1 OR ""user2_id""=1)"
287,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM (SELECT DISTINCT ""f"".""user1_id"" FROM ""friendship"" AS ""f"" WHERE ""f"".""user2_id""=1 UNION SELECT DISTINCT ""f1"".""user2_id"" FROM ""friendship"" AS ""f1"" WHERE ""f1"".""user1_id""=1) AS ""a"" JOIN ""likes"" AS ""l"" ON ""a"".""user1_id""=""l"".""user_id"" AND ""l"".""page_id"" NOT IN (SELECT ""l1"".""page_id"" FROM ""likes"" AS ""l1"" WHERE ""l1"".""user_id""=1)"
288,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
289,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" JOIN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""friendship"") AS ""a"" ON ""l"".""user_id""=""a"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
290,"SELECT DISTINCT (""page_id"") AS ""recommended_page"" FROM ""friendship"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user1_id""=""l"".""user_id"" OR ""f"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) AND (""user1_id""=1 OR ""user2_id""=1)"
291,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
292,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
293,"WITH ""f"" AS (SELECT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" JOIN ""f"" ON ""user_id""=""f"".""id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
294,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
295,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1 UNION SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1) AS ""a"" JOIN ""Likes"" AS ""l"" ON ""a"".""id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
296,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE 0 END) AS ""friend"" FROM ""Friendship"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
297,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
298,"WITH ""friends_table"" AS (SELECT ""user2_id"" AS ""friends"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friends"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""friends_table"" JOIN ""likes"" ON ""friends_table"".""friends""=""likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
299,"WITH ""friends"" AS (SELECT ""user1_id"" AS ""user1"",""user2_id"" AS ""user2"" FROM ""friendship"" WHERE ""user1_id""<""user2_id"" UNION SELECT ""user2_id"" AS ""user1"",""user1_id"" AS ""user2"" FROM ""friendship"" WHERE ""user1_id"">""user2_id"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""friends"" AS ""f"" JOIN ""likes"" AS ""l"" ON ""f"".""user2""=""l"".""user_id"" WHERE ""f"".""user1""=1 AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
300,"WITH ""pages_friends"" AS (SELECT DISTINCT ""l"".""page_id"" FROM (SELECT ""user1_id"",""user2_id"" FROM ""Friendship"" UNION SELECT ""user2_id"",""user1_id"" FROM ""Friendship"") AS ""a"" LEFT JOIN ""Likes"" AS ""l"" ON ""l"".""user_id""=""a"".""user2_id"" WHERE ""user1_id""=1) SELECT ""page_id"" AS ""recommended_page"" FROM ""pages_friends"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) AND ""page_id"" IS NOT NULL ORDER BY ""recommended_page"""
301,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
302,"WITH ""one_frnd"" AS (SELECT DISTINCT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION ALL SELECT DISTINCT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""one_frnd"" AS ""o"" JOIN ""likes"" AS ""l"" ON ""o"".""id""=""l"".""user_id"" AND ""l"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
303,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""b"".""user_id"",""b"".""page_id"" FROM ""friendship"" AS ""a"" LEFT JOIN ""likes"" AS ""b"" ON (""a"".""user2_id""=""b"".""user_id"" OR ""a"".""user1_id""=""b"".""user_id"") AND (""a"".""user1_id""=1 OR ""a"".""user2_id""=1) WHERE ""b"".""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)) AS ""t"""
304,"WITH ""friends"" AS (SELECT ""user2_id"" AS ""friend"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_Id"" AS ""friend"" FROM ""friendship"" WHERE ""user2_id""=1), ""notlike"" AS (SELECT ""page_id"" FROM ""likes"" WHERE ""user_Id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""friend"" FROM ""friends"") AND ""page_id"" NOT IN (SELECT ""page_Id"" FROM ""notlike"")"
305,"WITH ""friends"" AS (SELECT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END) AS ""friend"" FROM ""friendship""), ""user_likes"" AS (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT * FROM ""friends"") AND ""page_id"" NOT IN (SELECT * FROM ""user_likes"")"
306,"WITH ""cte"" AS (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""cte"" JOIN ""likes"" AS ""l"" ON ""cte"".""user2_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
307,"WITH ""friends"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""friends"" JOIN ""likes"" USING (""user_id"") WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
308,"WITH ""temp"" AS (SELECT DISTINCT ""user_id"",""page_id"" FROM ""Likes"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""temp"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1) OR ""user_id"" IN (SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1)"
309,"ERROR: mysql parse error: line 1 column 132 near ""union (select user2_id from friendship where user1_id = 1) ) and page_id not in (select page_id from likes where user_id = 1) "" "
310,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
311,"WITH ""friends"" AS (SELECT ""user2_id"" AS ""id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""friends"" JOIN ""Likes"" ON ""friends"".""id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
312,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" ELSE ""user1_id"" END AS ""frd"" FROM (SELECT * FROM ""friendship"" WHERE ""user1_id""=1 OR ""user2_id""=1) AS ""a"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
313,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
314,"WITH ""t1"" AS (SELECT * FROM ""Likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user1_id"" FROM ""Friendship"" AS ""f1"" WHERE ""user2_id""=1 UNION ALL SELECT DISTINCT ""user2_id"" FROM ""Friendship"" AS ""f2"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" AS ""l1"" WHERE ""user_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""t1"""
315,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user2_id"" AS ""id"" FROM ""friendship"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) UNION SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user1_id"" AS ""id"" FROM ""friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
316,"SELECT ""page_id"" AS ""recommended_page"" FROM (SELECT ""f"".""user1_id"" AS ""user_id"",""l"".""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""f"".""user1_id""=""l"".""user_id"" WHERE ""f"".""user2_id""=1 UNION ALL SELECT ""f"".""user2_id"" AS ""user_id"",""l"".""page_id"" FROM ""likes"" AS ""l"" JOIN ""friendship"" AS ""f"" ON ""f"".""user2_id""=""l"".""user_id"" WHERE ""f"".""user1_id""=1 ORDER BY ""user_id"") AS ""a"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1) GROUP BY ""page_id"""
317,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""L"" JOIN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""F"" ON ""L"".""user_id""=""F"".""user_id"" AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
318,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" AS ""L"" JOIN (SELECT ""user2_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""uid"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""new"" ON ""L"".""user_id""=""new"".""uid"" WHERE ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
319,"WITH ""cte"" AS (SELECT ""user2_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" AS ""user_id"" FROM ""friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""user_id""=""b"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
320,"SELECT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY ""page_id"""
321,"SELECT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION ALL SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1) GROUP BY ""page_id"""
322,"WITH ""filtered_users"" AS (SELECT ""user1_id"" AS ""user_id"",""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user2_id"" AS ""user_id"",""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""filtered_users"" AS ""f"" JOIN ""Likes"" AS ""l"" ON ""f"".""friend_id""=""l"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
323,"SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" WHERE ""user_id"" IN (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" ELSE '' END FROM ""friendship"") AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
324,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END AS ""user_id"" FROM ""Friendship"") AS ""a"" JOIN ""Likes"" ON ""a"".""user_id""=""Likes"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
325,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend"" FROM ""Friendship"" WHERE ""user2_id""=1)) AS ""t"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
326,"WITH ""temp"" AS (SELECT (CASE WHEN ""user1_id""=1 THEN ""user2_id"" WHEN ""user2_id""=1 THEN ""user1_id"" END) AS ""user_id"" FROM ""friendship"") SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""k"" JOIN ""temp"" AS ""t"" ON ""k"".""user_id""=""t"".""user_id"" WHERE ""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
327,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" WHERE ""user_id"" IN (SELECT ""user2_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" AS ""friend_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
328,"WITH ""t1"" AS (SELECT * FROM ""Likes"" WHERE ""user_id"" IN (SELECT DISTINCT ""user1_id"" FROM ""Friendship"" AS ""f1"" WHERE ""user2_id""=1 UNION ALL SELECT DISTINCT ""user2_id"" FROM ""Friendship"" AS ""f2"" WHERE ""user1_id""=1) AND ""page_id"" NOT IN (SELECT DISTINCT ""page_id"" FROM ""Likes"" AS ""l1"" WHERE ""user_id""=1)) SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""t1"""
329,"WITH ""t1"" AS (SELECT ""user1_id"" AS ""u"",""user2_id"" AS ""t"" FROM ""friendship"" UNION ALL SELECT ""user2_id"" AS ""u"",""user1_id"" AS ""t"" FROM ""friendship"") SELECT DISTINCT ""l"".""page_id"" AS ""recommended_page"" FROM ""likes"" AS ""l"" WHERE ""l"".""user_id"" IN (SELECT ""t"" FROM ""t1"" WHERE ""u""=1) AND ""l"".""page_id"" NOT IN (SELECT ""page_id"" FROM ""likes"" WHERE ""user_id""=1)"
330,"SELECT DISTINCT ""page_id"" AS ""recommended_page"" FROM ""Likes"" LEFT JOIN (SELECT ""user2_id"" FROM ""Friendship"" WHERE ""user1_id""=1 UNION SELECT ""user1_id"" FROM ""Friendship"" WHERE ""user2_id""=1) AS ""tmp"" ON ""Likes"".""user_id""=""tmp"".""user2_id"" WHERE ""Likes"".""user_id""=""tmp"".""user2_id"" AND ""page_id"" NOT IN (SELECT ""page_id"" FROM ""Likes"" WHERE ""user_id""=1)"
