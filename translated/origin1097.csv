id,original query
1,"WITH ""tb1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""tb1"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY 1"
2,"WITH ""cte"" AS (SELECT DISTINCT MIN(""event_date"") AS ""e_date"",""player_id"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""e_date"" AS ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT CASE WHEN ""event_date""=""e_date""+1 THEN ""a"".""player_id"" END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""Day1_retention"" FROM (""Activity"" AS ""a"") JOIN ""cte"" AS ""b"" WHERE ""a"".""player_id""=""b"".""player_id"" GROUP BY 1"
3,"SELECT ""a1"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""=""a2"".""event_date""-1 GROUP BY ""install_dt"""
4,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""i"".""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_dt""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_dt""=""a"".""event_date"" + INTERVAL '-1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY 1 ORDER BY 1"
5,"WITH ""first_install"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""a"".""first_date"" AS ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""first_install"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""first_date"" + INTERVAL '1 DAY' GROUP BY ""a"".""first_date"" ORDER BY COUNT(""a"".""player_id"") DESC"
6,"WITH ""install_dt"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1), ""install_num"" AS (SELECT ""install_date"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""install_dt"" GROUP BY 1), ""ret"" AS (SELECT ""install_date"",COUNT(DISTINCT ""install_dt"".""player_id"") AS ""return_n"" FROM ""Activity"" JOIN ""install_dt"" ON ""Activity"".""player_id""=""install_dt"".""player_id"" AND ""Activity"".""event_date"" - ""install_dt"".""install_date""=1 GROUP BY 1) SELECT ""install_num"".""install_date"" AS ""install_dt"",""installs"",COALESCE(ROUND(""return_n""/""installs"", 2), 0.00) AS ""Day1_retention"" FROM ""install_num"" LEFT JOIN ""ret"" ON ""install_num"".""install_date""=""ret"".""install_date"" ORDER BY 1"
7,"WITH ""tbDate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id""), ""tbTCnt"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""installs"" FROM ""tbDate"" GROUP BY ""event_date""), ""tbCnt"" AS (SELECT ""tbDate"".""event_date"",COUNT(""a2"".""player_id"") AS ""install"" FROM ""tbDate"" LEFT JOIN ""activity"" AS ""a2"" ON ""a2"".""event_date"" - ""tbDate"".""event_date""=1 AND ""a2"".""player_id""=""tbDate"".""player_id"" GROUP BY ""tbDate"".""event_date"") SELECT ""tbTcnt"".""event_date"" AS ""install_dt"",""tbTCnt"".""installs"",ROUND(""tbCnt"".""install""/""tbTCnt"".""installs"", 2) AS ""Day1_retention"" FROM ""tbTcnt"" JOIN ""tbCnt"" ON ""tbTcnt"".""event_date""=""tbCnt"".""event_date"""
8,"WITH ""main"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(""main"".""player_id"") AS ""installs"",ROUND(COUNT(""event_date"")/COUNT(""main"".""player_id""), 2) AS ""Day1_retention"" FROM ""main"" LEFT JOIN ""Activity"" ON ""main"".""player_id""=""Activity"".""player_id"" AND ""Activity"".""event_date"" - ""main"".""install_dt""=1 GROUP BY ""install_dt"""
9,"WITH ""Installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(""Installs"".""player_id"") AS ""installs"",ROUND(COUNT(""Activity"".""player_id"")/COUNT(""Installs"".""player_id""), 2) AS ""Day1_retention"" FROM ""Installs"" LEFT JOIN ""Activity"" ON ""Installs"".""player_id""=""Activity"".""player_id"" AND ""install_dt"" + INTERVAL '1 DAY'=""Activity"".""event_date"" GROUP BY 1"
10,"WITH ""wa"" AS (SELECT ""x"".""player_id"",MIN(""x"".""event_date"") AS ""install_dt"" FROM ""Activity"" AS ""x"" GROUP BY 1), ""wb"" AS (SELECT ""x"".*,""y"".""install_dt"",CASE WHEN ""x"".""event_date"" - ""y"".""install_dt""=1 THEN TRUE ELSE FALSE END AS ""retention_flg"" FROM ""Activity"" AS ""x"" LEFT JOIN ""wa"" AS ""y"" ON ""x"".""player_id""=""y"".""player_id"") SELECT ""x"".""install_dt"",COUNT(DISTINCT ""x"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT CASE WHEN ""x"".""retention_flg""=TRUE THEN ""x"".""player_id"" END)/COUNT(DISTINCT ""x"".""player_id""), 2) AS ""Day1_retention"" FROM ""wb"" AS ""x"" GROUP BY 1 ORDER BY 1"
11,"SELECT ""I"".""install_dt"",""I"".""installs"",ROUND(COALESCE(""retention""/""installs"", 0), 2) AS ""Day1_retention"" FROM (SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" GROUP BY ""install_dt"") AS ""I"" LEFT JOIN (SELECT ""event_date"",COUNT(DISTINCT ""player_id"") AS ""retention"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""d"" FROM ""Activity"" GROUP BY ""player_id"") GROUP BY ""event_date"") AS ""R"" ON ""I"".""install_dt"" + INTERVAL '1 DAY'=""R"".""event_date"""
12,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""i"".""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_dt""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_dt""=""a"".""event_date"" + INTERVAL '-1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY 1"
13,"SELECT ""t1"".""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""t2"".""event_date"" IS NULL THEN 0 ELSE 1 END)/COUNT(1), 2) AS ""day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON (""t2"".""player_id""=""t1"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""event_date""=1) GROUP BY ""t1"".""event_date"""
14,"SELECT ""t1"".""install_date"" AS ""install_dt"",COUNT(""t1"".""install_date"") AS ""installs"",ROUND(COUNT(""t2"".""event_date"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1) AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""install_date"" + INTERVAL '1 DAY'=""t2"".""event_date"" AND ""t1"".""player_id""=""t2"".""player_id"" GROUP BY 1 ORDER BY 1"
15,"WITH ""min_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""min_day"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""b"".""min_day"" AS ""install_dt"",COUNT(""b"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""player_id"")/COUNT(""b"".""player_id""), 2) AS ""Day1_retention"" FROM ""activity"" AS ""a"" RIGHT JOIN ""min_date"" AS ""b"" ON ""a"".""event_date""=""b"".""min_day""+1 AND ""a"".""player_id""=""b"".""player_id"" GROUP BY 1"
16,"SELECT ""t"".""install_date"" AS ""install_dt"",COUNT(DISTINCT ""t"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""t"".""player_id""), 2) AS ""Day1_retention"" FROM ""Activity"" AS ""a"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1) AS ""t"" ON ""a"".""player_id""=""t"".""player_id"" AND ""a"".""event_date""=""t"".""install_date"" + INTERVAL '1 DAY' GROUP BY 1"
17,"WITH ""t1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""t2"" AS (SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"" FROM ""t1"" GROUP BY ""install_dt""), ""t3"" AS (SELECT ""install_dt"",COUNT(1) AS ""next_day_login"" FROM ""t1"" WHERE ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") GROUP BY 1) SELECT ""t2"".""install_dt"",""installs"",ROUND(COALESCE(""next_day_login""/""installs"", 0), 2) AS ""Day1_retention"" FROM ""t2"" LEFT JOIN ""t3"" ON ""t2"".""install_dt""=""t3"".""install_dt"""
18,"WITH ""player_dates"" AS (SELECT DISTINCT ""player_id"",""event_date"",FIRST_VALUE(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"" FROM ""Activity""), ""players"" AS (SELECT ""player_id"",""install_dt"",CASE WHEN ""event_date""=""install_dt""+1 THEN ""player_id"" ELSE NULL END AS ""retained_player_id"" FROM ""player_dates"") SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""retained_player_id"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""players"" GROUP BY 1 ORDER BY 1"
19,"SELECT ""a1"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""-1=""a1"".""event_date"" GROUP BY ""install_dt"""
20,"WITH ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(DISTINCT ""install_date"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""Activity"".""player_id"")/COUNT(DISTINCT ""install_date"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_date"" LEFT JOIN ""Activity"" ON ""install_date"".""install_dt"" + INTERVAL '1 DAY'=""Activity"".""event_date"" AND ""install_date"".""player_id""=""Activity"".""player_id"" GROUP BY 1 ORDER BY 1"
21,"SELECT ""install_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""next_day_login"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a"".""player_id"",""a"".""install_date"",COALESCE(""b"".""next_day_login"", 0) AS ""next_day_login"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"",TO_CHAR(MIN(""event_date"")+1, 'YYYY-%m-%d') AS ""next_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN (SELECT ""player_id"",""event_date"",1 AS ""next_day_login"" FROM ""Activity"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""next_date""=""b"".""event_date"") AS ""c"" GROUP BY ""install_date"""
22,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""A"".""player_id"",""A"".""install_dt"",""B"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" AND ""B"".""event_date""=""A"".""install_dt"" + INTERVAL '1 DAY') AS ""t"" GROUP BY ""install_dt"""
23,"WITH ""installation"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""r_flag"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""i"".""event_date"",""i"".""player_id"",CASE WHEN ""a"".""player_id"" IS NULL THEN 0 ELSE 1 END AS ""r_flag"" FROM ""installation"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""a"".""event_date""-""i"".""event_date""=1) AS ""temp"" GROUP BY ""event_date"""
24,"WITH ""cte"" AS (SELECT MIN(""event_date"") AS ""install_dt"",""player_id"" FROM ""Activity"" GROUP BY 2) SELECT ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY 1"
25,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(DISTINCT ""b"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN (""a"".""event_date"" - ""b"".""install_dt""=1) THEN 1 ELSE 0 END)/(COUNT(DISTINCT ""b"".""player_id"")), 2) AS ""Day1_retention"" FROM ""cte"" AS ""b"" JOIN ""activity"" AS ""a"" ON ""b"".""player_id""=""a"".""player_id"" GROUP BY ""install_dt"""
26,"WITH ""t"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""r"" FROM ""activity""), ""n"" AS (SELECT ""t1"".""player_id"" AS ""pid1"",""t1"".""event_date"" AS ""d1"",""t1"".""r"",""t2"".""player_id"" AS ""pid2"",""t2"".""event_date"" AS ""d2"",CASE WHEN ""t2"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END AS ""stay"" FROM ""t"" AS ""t1"" LEFT JOIN ""t"" AS ""t2"" ON ""t1"".""event_date"" + INTERVAL '1 DAY'=""t2"".""event_date"" AND ""t1"".""player_id""=""t2"".""player_id"" WHERE ""t1"".""r""=1) SELECT DISTINCT ""d1"" AS ""install_dt"",SUM(""r"") AS ""installs"",ROUND(SUM(""stay"")/SUM(""r""), 2) AS ""Day1_retention"" FROM ""n"" GROUP BY ""d1"""
27,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1) SELECT ""a1"".""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY 1"
28,"WITH ""retention"" AS (SELECT ""player_id"",""install_dt"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""activity"") AS ""t"" WHERE ""event_date""-""install_dt""=1), ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""a"".""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_date"" AS ""a"" LEFT JOIN ""retention"" AS ""b"" ON ""a"".""install_dt""=""b"".""install_dt"" AND ""a"".""player_id""=""b"".""player_id"" GROUP BY ""a"".""install_dt"""
29,"WITH ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(DISTINCT ""install_date"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""Activity"".""player_id"")/COUNT(DISTINCT ""install_date"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_date"" LEFT JOIN ""Activity"" ON ""install_date"".""install_dt"" + INTERVAL '1 DAY'=""Activity"".""event_date"" AND ""install_date"".""player_id""=""Activity"".""player_id"" GROUP BY 1 ORDER BY 1"
30,"WITH ""tbDate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id""), ""tbTCnt"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""installs"" FROM ""tbDate"" GROUP BY ""event_date""), ""tbCnt"" AS (SELECT ""tbDate"".""event_date"" AS ""install_dt"",""tbTCnt"".""installs"",ROUND(COUNT(""a2"".""player_id"")/""tbTCnt"".""installs"", 2) AS ""Day1_retention"" FROM (""tbDate"" LEFT JOIN ""tbTcnt"" ON ""tbTcnt"".""event_date""=""tbDate"".""event_date"") LEFT JOIN ""activity"" AS ""a2"" ON ""a2"".""event_date"" - ""tbDate"".""event_date""=1 AND ""a2"".""player_id""=""tbDate"".""player_id"" GROUP BY ""tbDate"".""event_date"") SELECT * FROM ""tbCnt"""
31,"WITH ""t1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""t1"".""install_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND((COUNT(""a"".""event_date"")/COUNT(1)), 2) AS ""Day1_retention"" FROM ""t1"" LEFT JOIN ""Activity"" AS ""a"" ON ""t1"".""install_date"" + INTERVAL '1 DAY'=""a"".""event_date"" AND ""t1"".""player_id""=""a"".""player_id"" GROUP BY ""t1"".""install_date"""
32,"SELECT ""t1"".""install_dt"",COUNT(DISTINCT (""t1"".""player_id"")) AS ""installs"",ROUND(SUM(CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT (""t1"".""player_id"")), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""install_dt""=1 GROUP BY ""t1"".""install_dt"""
33,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""install_date"" AS ""install_dt"",COUNT(""cte"".""player_id"") AS ""installs"",ROUND(AVG(CASE WHEN ""a"".""player_id"" THEN 1 ELSE 0 END), 2) AS ""Day1_retention"" FROM ""cte"" LEFT JOIN ""activity"" AS ""a"" ON ""cte"".""player_id""=""a"".""player_id"" AND ""cte"".""install_date"" + INTERVAL '1 DAY'=""event_date"" GROUP BY ""install_date"""
34,"WITH ""installs"" AS (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") AS ""a"" WHERE ""rn""=1), ""install_cnt"" AS (SELECT ""event_date"",COUNT(1) FROM ""installs"" GROUP BY 1) SELECT ""i"".""event_date"" AS ""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(COALESCE(SUM((""a"".""player_id"" IS NOT NULL))/COUNT(""i"".""player_id""), 0), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON (""i"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""i"".""event_date""=1) GROUP BY 1"
35,"SELECT ""t1"".""install_date"" AS ""install_dt"",COUNT(""t1"".""install_date"") AS ""installs"",ROUND(COUNT(""t2"".""event_date"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1) AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""install_date"" + INTERVAL '1 DAY'=""t2"".""event_date"" AND ""t1"".""player_id""=""t2"".""player_id"" GROUP BY 1 ORDER BY 1"
36,"WITH ""install_cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""a"".""player_id"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""install_cte"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""i"".""install_dt""=1 GROUP BY ""install_dt"""
37,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""Activity"") SELECT * FROM (SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COALESCE(COUNT(""id2"")/COUNT(""player_id""), 0), 2) AS ""Day1_retention"" FROM (SELECT ""c1"".""event_date"",""c1"".""rn"",CASE WHEN ""c1"".""rn""=1 THEN ""c1"".""player_id"" ELSE NULL END AS ""player_id"",CASE WHEN ""c1"".""rn""=1 THEN ""c2"".""player_id"" ELSE NULL END AS ""id2"" FROM ""cte"" AS ""c1"" LEFT JOIN ""cte"" AS ""c2"" ON ""c1"".""player_id""=""c2"".""player_id"" AND ""c1"".""event_date"" + INTERVAL '1 DAY'=""c2"".""event_date"") AS ""temp"" GROUP BY ""install_dt"") AS ""temp2"" WHERE ""installs"">0 ORDER BY ""install_dt"""
38,"WITH ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(DISTINCT ""install_date"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""Activity"".""player_id"")/COUNT(DISTINCT ""install_date"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_date"" LEFT JOIN ""Activity"" ON ""install_date"".""install_dt"" + INTERVAL '1 DAY'=""Activity"".""event_date"" AND ""install_date"".""player_id""=""Activity"".""player_id"" GROUP BY 1 ORDER BY 1"
39,"WITH ""installday"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""userid_retent"")*1.0/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a"".*,""b"".""player_id"" AS ""userid_retent"" FROM ""installday"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""install_dt""=""event_date"" + INTERVAL '-1 DAY' AND ""a"".""player_id""=""b"".""player_id"") AS ""temp"" GROUP BY 1"
40,"WITH ""installdateplayer"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""installdateplayer"".""install_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COALESCE(""temp"".""retention"", 0)/COUNT(1), 2) AS ""Day1_retention"" FROM ""installdateplayer"" LEFT JOIN (SELECT ""i2"".""install_date"",COUNT(""i2"".""player_id"") AS ""retention"" FROM ""installdateplayer"" AS ""i2"" JOIN ""Activity"" ON ""Activity"".""player_id""=""i2"".""player_id"" AND ""i2"".""install_date"" + INTERVAL '1 DAY'=""Activity"".""event_date"" GROUP BY ""i2"".""install_date"") AS ""temp"" ON ""installdateplayer"".""install_date""=""temp"".""install_date"" GROUP BY ""installdateplayer"".""install_date"""
41,"WITH ""ranked_event_date"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_rank"" FROM ""Activity"") SELECT ""date1"" AS ""install_dt"",COUNT(""day_one"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""date2"" - ""date1""=1 THEN 1 ELSE 0 END)/COUNT(""day_one"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""event_date"" AS ""date1"",""player_id"" FROM ""ranked_event_date"" WHERE ""event_date_rank""=1) AS ""day_one"" LEFT JOIN (SELECT ""event_date"" AS ""date2"",""player_id"" FROM ""ranked_event_date"" WHERE ""event_date_rank""=2) AS ""day_two"" ON ""day_one"".""player_id""=""day_two"".""player_id"" GROUP BY ""date1"""
42,"WITH ""nextt"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextday"" FROM ""Activity""), ""mindate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""nextt"" GROUP BY 1), ""minandnext"" AS (SELECT ""mindate"".""player_id"",""mindate"".""first_date"",""nextt"".""nextday"" FROM ""mindate"" LEFT JOIN ""nextt"" ON ""mindate"".""player_id""=""nextt"".""player_id"" AND ""mindate"".""first_date""=""nextt"".""event_date"") SELECT ""first_date"" AS ""install_dt"",COUNT(DISTINCT (""player_id"")) AS ""installs"",ROUND(SUM(CASE WHEN ""nextday"" - ""first_date""=1 THEN 1 ELSE 0 END)/COUNT(CASE WHEN ""nextday"" - ""first_date""=1 THEN 1 ELSE 0 END), 2) AS ""Day1_retention"" FROM ""minandnext"" GROUP BY 1"
43,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_day"" FROM ""activity"") SELECT ""A"".""first_day"" AS ""install_dt"",""A"".""total"" AS ""Installs"",ROUND(COALESCE(""retention""/""total"", 0), 2) AS ""Day1_retention"" FROM (SELECT ""first_day"",COUNT(DISTINCT ""player_id"") AS ""total"" FROM ""temp"" GROUP BY ""first_day"") AS ""A"" LEFT JOIN (SELECT ""first_day"",SUM(CASE WHEN ""event_date"" - ""first_day""=1 THEN 1 ELSE 0 END) AS ""retention"" FROM ""temp"" GROUP BY ""first_day"") AS ""B"" ON ""A"".""first_day""=""B"".""first_day"""
44,"WITH ""cte1"" AS (SELECT * FROM ""activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""activity"" GROUP BY 1)), ""cte2"" AS (SELECT ""c1"".""event_date"",COUNT(1) AS ""retention"" FROM ""cte1"" AS ""c1"" JOIN ""activity"" AS ""a"" ON ""c1"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date"" - ""c1"".""event_date""=1 GROUP BY 1) SELECT ""c1"".""event_date"" AS ""install_dt"",COUNT(""c1"".""player_id"") AS ""installs"",ROUND(COALESCE(""retention""/COUNT(""c1"".""player_id""), 0), 2) AS ""Day1_retention"" FROM ""cte1"" AS ""c1"" LEFT JOIN ""cte2"" AS ""c2"" ON ""c1"".""event_date""=""c2"".""event_date"" GROUP BY 1 ORDER BY 1"
45,"WITH ""first_login_cte"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(DISTINCT ""f"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""event_date"" - ""f"".""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""f"".""player_id""), 2) AS ""day1_retention"" FROM ""first_login_cte"" AS ""f"" JOIN ""activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" GROUP BY 1"
46,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""i"".""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_dt""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_dt""=""a"".""event_date"" + INTERVAL '-1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY 1 ORDER BY 1"
47,"SELECT ""a1"".""first_login"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a1"".""first_login""+1=""a2"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""a1"".""first_login"""
48,"WITH ""PlayerActivityRanking"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""Rk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""Activity""), ""Player1DayRetention"" AS (SELECT ""player_id"",""event_date"" AS ""install_dt"",CASE WHEN ""next_login"" - ""event_date""=1 THEN 1 ELSE 0 END AS ""retentionFlag"" FROM ""PlayerActivityRanking"" WHERE ""Rk""=1) SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""retentionFlag"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""Player1DayRetention"" GROUP BY ""install_dt"" ORDER BY 1"
49,"SELECT ""a1"".""first_login"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a1"".""first_login""+1=""a2"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""a1"".""first_login"""
50,"WITH ""temp"" AS (SELECT ""t1"".""player_id"",""dt"",""a"".""event_date"" AS ""next_day"" FROM (SELECT *,MIN(""event_date"") AS ""dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""a"" ON ""t1"".""player_id""=""a"".""player_id"" AND ""dt""=""a"".""event_date""-1) SELECT ""dt"" AS ""install_dt"",COUNT(""dt"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""temp"" GROUP BY 1"
51,"SELECT ""t1"".""d0"" AS ""install_dt"",COUNT(""t1"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""t1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""d0"" FROM ""activity"" GROUP BY 1) AS ""t1"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""event_date"" - ""t1"".""d0""=1 AND ""t1"".""player_id""=""a"".""player_id"" GROUP BY 1"
52,"WITH ""retention"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rownum"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND((SUM(CASE WHEN (""next_date""-""event_date""=1) THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id"")), 2) AS ""Day1_retention"" FROM ""retention"" WHERE ""rownum""=1 GROUP BY ""install_dt"""
53,"WITH ""first_activity"" AS (SELECT ""player_id"",""event_date"" AS ""install_dt"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank_num"" FROM ""Activity"") AS ""a"" WHERE ""rank_num""=1) SELECT ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date""-1=""install_dt"" THEN ""a"".""player_id"" END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""Activity"" AS ""b"" LEFT JOIN ""first_activity"" AS ""a"" ON ""b"".""player_id""=""a"".""player_id"" GROUP BY ""install_dt"""
54,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""event_date"" - ""install_dt""=1)/COUNT(DISTINCT ""player_id""), 2) AS ""day1_retention"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""activity"") AS ""t"" GROUP BY 1"
55,"WITH ""first_day"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"" FROM ""activity"" GROUP BY 1,2) SELECT ""install_dt"",""installs"",ROUND(""second_day_count""/""installs"", 2) AS ""day1_retention"" FROM (SELECT ""f"".""event_date"" AS ""install_dt"",COUNT(""f"".""player_id"") AS ""installs"",COUNT(""a"".""player_id"") AS ""second_day_count"" FROM ""first_day"" AS ""f"" LEFT JOIN ""activity"" AS ""a"" ON ""f"".""event_date""=""a"".""event_date"" - INTERVAL '1 DAY' AND ""f"".""player_id""=""a"".""player_id"" WHERE ""f"".""date_rank""=1 GROUP BY 1) AS ""result_table"""
56,"WITH ""user_install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY 1) SELECT ""uid"".""install_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""a"".""player_id"" IS NOT NULL)/COUNT(1), 2) AS ""day1_retention"" FROM ""user_install_date"" AS ""uid"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""player_id""=""uid"".""player_id"" AND ""a"".""event_date""=(""uid"".""install_date""+1) GROUP BY 1"
57,"WITH ""CTE1"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_lead1"" FROM ""Activity"") SELECT * FROM (SELECT ""event_date"" AS ""install_dt"",SUM(CASE WHEN ""rn""=1 THEN 1 ELSE 0 END) AS ""installs"",ROUND(1.00*SUM(CASE WHEN ""rn""=1 AND ""event_date_lead1"" - ""event_date""=1 THEN 1 ELSE 0 END)/SUM(CASE WHEN ""rn""=1 THEN 1 ELSE 0 END), 2) AS ""Day1_retention"" FROM ""CTE1"" GROUP BY ""event_date"") AS ""sub"" WHERE ""installs""!=0"
58,"WITH ""cte"" AS (SELECT ""event_date"",""player_id"" FROM (SELECT ""event_date"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""Activity"") AS ""temp"" WHERE ""rn""=1), ""cte2"" AS (SELECT ""a"".""event_date"" AS ""event_date1"",""b"".""event_date"" AS ""event_date2"",""a"".""player_id"" FROM ""cte"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""-""a"".""event_date""=1) SELECT ""event_date1"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date2"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""cte2"" GROUP BY ""event_date1"""
59,"WITH ""retention"" AS (SELECT ""player_id"",""install_dt"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""activity"") AS ""t"" WHERE ""event_date""-""install_dt""=1), ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""a"".""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_date"" AS ""a"" LEFT JOIN ""retention"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" GROUP BY ""a"".""install_dt"""
60,"WITH ""cte"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" AS ""first_login"",""a2"".""event_date"" AS ""second_login"",RANK() OVER (PARTITION BY ""a1"".""player_id"" ORDER BY ""a1"".""event_date"") AS ""ranking"" FROM ""Activity"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""event_date""=1), ""cte_1"" AS (SELECT ""player_id"",""first_login"",""second_login"" FROM ""cte"" WHERE ""ranking""=1) SELECT ""first_login"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""second_login"")/COUNT(""first_login""), 2) AS ""Day1_retention"" FROM ""cte_1"" GROUP BY ""first_login"""
61,"WITH ""i"" AS (SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"" FROM (SELECT ""player_id"",""event_date"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""t0"" WHERE ""rnk""=1) AS ""t1"" GROUP BY ""event_date""), ""l"" AS (SELECT ""install_dt"",""log_back_dt"",COUNT(CASE WHEN ""log_back_dt"" - ""install_dt""=1 THEN ""player_id"" ELSE NULL END) AS ""dividend"" FROM (SELECT ""i1"".""player_id"",""l1"".""log_back_dt"",""i1"".""install_dt"" FROM (SELECT ""player_id"",""event_date"" AS ""log_back_dt"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""t2"" WHERE ""rnk""=2) AS ""l1"" RIGHT JOIN (SELECT ""player_id"",""event_date"" AS ""install_dt"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""t3"" WHERE ""rnk""=1) AS ""i1"" ON ""l1"".""player_id""=""i1"".""player_id"") AS ""t4"" GROUP BY ""install_dt"") SELECT ""i"".""install_dt"",""i"".""installs"",ROUND(""l"".""dividend""/""i"".""installs"", 2) AS ""Day1_retention"" FROM ""i"" LEFT JOIN ""l"" ON ""i"".""install_dt""=""l"".""install_dt"""
62,"SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""retention"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",""event_date"",CASE WHEN ""next_date""-""event_date""=1 THEN 1 ELSE 0 END AS ""retention"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""a"" WHERE ""rnk""=1) AS ""b"" GROUP BY 1"
63,"WITH ""t1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1), ""t2"" AS (SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""t1"" GROUP BY 1), ""t3"" AS (SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""retention"" FROM ""t1"" WHERE ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") GROUP BY 1) SELECT ""t2"".""install_dt"",""installs"",ROUND(COALESCE(""retention"", 0)/""installs"", 2) AS ""Day1_retention"" FROM ""t2"" LEFT JOIN ""t3"" ON ""t2"".""install_dt""=""t3"".""install_dt"""
64,"WITH ""installdate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id""), ""numplayer"" AS (SELECT ""install_date"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""installdate"" GROUP BY ""install_date""), ""retention"" AS (SELECT ""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login_date"",""player_id"" FROM ""Activity"") SELECT ""install_date"" AS ""install_dt"",""installs"",ROUND(COALESCE(""day1_logins""/""installs"", 0), 2) AS ""Day1_retention"" FROM ""numplayer"" LEFT JOIN (SELECT ""event_date"",COUNT(DISTINCT ""i"".""player_id"") AS ""day1_logins"" FROM ""retention"" AS ""r"" RIGHT JOIN ""installdate"" AS ""i"" ON ""r"".""event_date""=""i"".""install_date"" AND ""r"".""player_id""=""i"".""player_id"" WHERE ""next_login_date"" - ""event_date""=1 AND ""i"".""player_id"" IS NOT NULL GROUP BY ""event_date"") AS ""t"" ON ""numplayer"".""install_date""=""t"".""event_date"" ORDER BY ""numplayer"".""install_date"""
65,"WITH ""installdate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""ins"".""install_date"" AS ""install_dt"",COUNT(""ins"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""act"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""ins"".""player_id""), 2) AS ""Day1_retention"" FROM ""installdate"" AS ""ins"" LEFT JOIN ""Activity"" AS ""act"" ON ""act"".""event_date"" - ""ins"".""install_date""=1 AND ""ins"".""player_id""=""act"".""player_id"" GROUP BY ""ins"".""install_date"""
66,"WITH ""install_dt"" AS (SELECT DISTINCT ""event_date"" AS ""install_dt"",""player_id"" FROM (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank_"" FROM ""Activity"") AS ""tmp"" WHERE ""rank_""=1) SELECT ""t1"".""install_dt"",COUNT(""t1"".""player_id"") AS ""installs"",ROUND(COUNT(""t2"".""player_id"")*1.0/COUNT(""t1"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_dt"" AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""install_dt"" + INTERVAL '1 DAY'=""t2"".""event_date"" GROUP BY ""t1"".""install_dt"""
67,"WITH ""t1"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nxt"" FROM ""activity"") SELECT DISTINCT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""nxt""=""install_dt""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t1"" WHERE ""rk""=1 GROUP BY ""install_dt"" ORDER BY ""install_dt"""
68,"WITH ""prep"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",CASE WHEN LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""isLoginNextDay"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""isLoginNextDay"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""prep"" WHERE ""rn""=1 GROUP BY ""event_date"""
69,"SELECT ""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""next_dt"")/COUNT(""install_dt""), 2) AS ""Day1_retention"" FROM (SELECT ""t1"".""player_id"",""t1"".""event_date"" AS ""install_dt"",""t2"".""event_date"" AS ""next_dt"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t2"".""player_id""=""t1"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""event_date""=1) AS ""t"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
70,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextd"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date""=""nextd"" - INTERVAL '1 DAY' THEN ""player_id"" ELSE NULL END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""t"" WHERE ""rk""=1 GROUP BY ""event_date"""
71,"WITH ""user_install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY 1) SELECT ""uid"".""install_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""a"".""player_id"" IS NOT NULL)/COUNT(1), 2) AS ""day1_retention"" FROM ""user_install_date"" AS ""uid"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""player_id""=""uid"".""player_id"" AND ""a"".""event_date""=(""uid"".""install_date""+1) GROUP BY 1"
72,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity""), ""cte1"" AS (SELECT ""t1"".""event_date"",""t1"".""player_id"" AS ""t1p"",CASE WHEN ""t2"".""player_id"" IS NULL THEN 0 ELSE 1 END AS ""t2p"" FROM (SELECT ""event_date"",""player_id"" FROM ""cte"" WHERE ""rn""=1) AS ""t1"" LEFT JOIN (SELECT ""event_date"",""player_id"" FROM ""cte"" WHERE ""rn""=2) AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""event_date"" + INTERVAL '1 DAY'=""t2"".""event_date"") SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""t2p"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""cte1"" GROUP BY ""event_date"""
73,"SELECT ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""install_dt""=1 GROUP BY ""install_dt"" ORDER BY ""install_dt"""
74,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""install_dt"",""a1"".""player_id"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""install_dt""=""a2"".""event_date""-1) AS ""a"" GROUP BY ""a"".""install_dt"""
75,"SELECT ""a"".""event_date"" AS ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"" GROUP BY ""a"".""event_date"""
76,"ERROR: mysql parse error: line 1 column 84 near "") select a.install_dt, count(distinct a.player_id) as installs, round(1.00 * count( distinct b.player_id) / count(distinct a.player_id), 2) as Day1_retention from cte1 a left join activity b on a.player_id = b.player_id and b.event_date-1 = a.install_dt group by a.install_dt "" "
77,"SELECT ""temp"".""install_dt"",COUNT(DISTINCT ""temp"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"" LEFT JOIN ""Activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""install_dt""=1 GROUP BY ""install_dt"""
78,"SELECT ""first_login"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""activity"") AS ""tb1"" GROUP BY ""first_login"""
79,"WITH ""prep"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",CASE WHEN LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""NextDayLogin"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""NextDayLogin"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""prep"" WHERE ""rnk""=1 GROUP BY ""install_dt"""
80,"SELECT ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(""a1"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""a1"" ON ""a"".""player_id""=""a1"".""player_id"" AND ""a"".""install_dt""=""a1"".""event_date""-1 GROUP BY ""install_dt"""
81,"WITH ""t"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",CASE WHEN LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""retention"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""retention"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t"" WHERE ""rnk""=1 GROUP BY ""event_date"""
82,"ERROR: mysql parse error: line 1 column 235 near ""t1 left join Activity t2 on t1.player_id = t2.player_id and t1.dt = t2.event_date - 1)) temp group by 1"" "
83,"WITH ""install"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""installdate"" FROM ""activity"" GROUP BY 1) SELECT ""installdate"" AS ""install_dt"",COUNT(""i"".""player_Id"") AS ""installs"",ROUND(COALESCE(COUNT(""a"".""player_id""), 0)/COUNT(""i"".""player_Id""), 2) AS ""Day1_retention"" FROM ""install"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""event_date""=""installdate"" + INTERVAL '1 DAY' GROUP BY ""installdate"""
84,"SELECT ""u"".""event_date"" AS ""install_dt"",SUM(""u"".""rn"") AS ""installs"",ROUND(SUM(""flag"")/SUM(""u"".""rn""), 2) AS ""Day1_retention"" FROM (SELECT *,(CASE WHEN ""t"".""ld""=0 THEN 0 WHEN ""t"".""ld""-""t"".""event_date""=1 THEN 1 ELSE 0 END) AS ""flag"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ld"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") AS ""t"" WHERE ""t"".""rn""=1) AS ""u"" GROUP BY ""u"".""event_date"" ORDER BY ""event_date"""
85,"SELECT ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""activity"" AS ""a"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") AS ""install_act"" ON ""a"".""player_id""=""install_act"".""player_id"" GROUP BY ""install_dt"""
86,"WITH ""Install_day"" AS (SELECT MIN(""event_date"") AS ""install_date"",""player_id"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""i"".""install_date"" AS ""install_dt"",COUNT(DISTINCT ""i"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""i"".""player_id""), 2) AS ""Day1_retention"" FROM ""Install_day"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_date"" - ""a"".""event_date""=-1 AND ""i"".""player_id""=""a"".""player_id"" GROUP BY ""i"".""install_date"""
87,"WITH ""a"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id""), ""b"" AS (SELECT ""t"".""event_date"",COALESCE(COUNT(""t"".""player_id""), 0) AS ""ct"" FROM ""a"" LEFT JOIN ""Activity"" AS ""t"" ON ""t"".""player_id""=""a"".""player_id"" WHERE ""t"".""event_date""=""a"".""install_dt""+1 GROUP BY ""t"".""event_date"") SELECT ""install_dt"",COUNT(1) AS ""installs"",ROUND(COALESCE(""b"".""ct"", 0)/COUNT(1), 2) AS ""day1_retention"" FROM ""a"" LEFT JOIN ""b"" ON ""a"".""install_dt""=""b"".""event_date""-1 GROUP BY ""install_dt"""
88,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",CASE WHEN LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""retention"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""retention"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t"" WHERE ""rnk""=1 GROUP BY ""event_date"""
89,"WITH ""install_date_record"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" AS ""a"" GROUP BY ""player_id"") SELECT ""idr"".""install_date"" AS ""install_dt"",COUNT(""idr"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""event_date"" IS NULL THEN 0 ELSE 1 END)/COUNT(""idr"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_date_record"" AS ""idr"" LEFT JOIN ""Activity"" AS ""a"" ON ""idr"".""install_date""=""a"".""event_date"" - INTERVAL '1 DAY' AND ""a"".""player_id""=""idr"".""player_id"" GROUP BY ""install_dt"""
90,"SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""next_login"" - ""event_date""=1 THEN 1 ELSE 0 END)*1.0/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""activity"") AS ""t1"" WHERE ""date_rank""=1 GROUP BY ""event_date"" ORDER BY 1"
91,"WITH ""CTE1"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""installs"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity"") AS ""sub"" WHERE ""ranking""=1 GROUP BY ""event_date""), ""CTE2"" AS (SELECT ""event_date"",COUNT(DISTINCT ""player_id"") AS ""cnt_logged_back_next_day"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_lead"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity"") AS ""sub"" WHERE ""event_date_lead"" - ""event_date""=1 AND ""ranking""=1 GROUP BY ""event_date"") SELECT ""d1"".""event_date"" AS ""install_dt"",""d1"".""installs"",ROUND(COALESCE(""d2"".""cnt_logged_back_next_day"", 0)/""d1"".""installs"", 2) AS ""Day1_retention"" FROM ""CTE1"" AS ""d1"" LEFT JOIN ""CTE2"" AS ""d2"" ON ""d1"".""event_date""=""d2"".""event_date"""
92,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - INTERVAL '1 DAY'=""a1"".""install_dt"") AS ""t"" GROUP BY ""install_dt"""
93,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""install_dt""+1) AS ""t"" GROUP BY ""install_dt"""
94,"WITH ""prep"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",CASE WHEN LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""isLoginNextDay"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""isLoginNextDay"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""prep"" WHERE ""rn""=1 GROUP BY ""install_dt"""
95,"WITH ""res"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""next_date""=""event_date"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END)/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""res"" WHERE ""rnk""=1 GROUP BY 1"
96,"WITH ""FirstDay"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""instl_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""FirstDay"".""instl_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""Activity"".""player_id"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""FirstDay"" LEFT JOIN ""Activity"" ON ""Activity"".""player_id""=""FirstDay"".""player_id"" AND ""Activity"".""event_date"" - ""FirstDay"".""instl_date""=1 GROUP BY ""FirstDay"".""instl_date"" ORDER BY 1"
97,"SELECT ""act1"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""act1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""act2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""act1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",""player_id"" FROM ""Activity"") AS ""act1"" LEFT JOIN ""Activity"" AS ""act2"" ON ""act1"".""event_date""+1=""act2"".""event_date"" AND ""act1"".""player_id""=""act2"".""player_id"" WHERE ""rk""=1 GROUP BY 1"
98,"SELECT ""a"".""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COALESCE(SUM(CASE WHEN ""b"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 0), 2) AS ""day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""install_dt"" + INTERVAL '1 DAY' GROUP BY 1 ORDER BY 1"
99,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_event_date"" FROM ""Activity"" GROUP BY ""player_id""), ""consecutive_second_login"" AS (SELECT ""a"".""player_id"",""f"".""first_event_date"" FROM ""Activity"" AS ""a"" JOIN ""first_login"" AS ""f"" ON ""a"".""player_id""=""f"".""player_id"" AND ""a"".""event_date""=""f"".""first_event_date"" + INTERVAL '1 DAY' GROUP BY ""a"".""player_id"",""f"".""first_event_date""), ""count_users_by_event_date"" AS (SELECT ""first_event_date"",COUNT(1) AS ""usercount"" FROM ""first_login"" GROUP BY ""first_event_date""), ""count_consecutive_secondlogin_users_by_event_date"" AS (SELECT ""first_event_date"",COUNT(1) AS ""secondusercount"" FROM ""consecutive_second_login"" GROUP BY ""first_event_date"") SELECT ""c"".""first_event_date"" AS ""install_dt"",""c"".""usercount"" AS ""installs"",ROUND(COALESCE(""c2"".""secondusercount"", 0)/""c"".""usercount"", 2) AS ""Day1_retention"" FROM ""count_users_by_event_date"" AS ""c"" LEFT JOIN ""count_consecutive_secondlogin_users_by_event_date"" AS ""c2"" ON ""c"".""first_event_date""=""c2"".""first_event_date"""
100,"SELECT ""a"".""event_date"" AS ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"" GROUP BY ""a"".""event_date"""
101,"WITH ""cte"" AS (SELECT MIN(""event_date"") AS ""install_dt"",""player_id"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""install_dt"""
102,"SELECT ""t1"".""install_dt"",COUNT(DISTINCT ""t1"".""player_id"") AS ""installs"",ROUND(AVG(CASE WHEN ""a1"".""games_played"" IS NOT NULL THEN 1 ELSE 0 END), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""a1"" ON ""t1"".""player_id""=""a1"".""player_id"" AND ""t1"".""install_dt""+1=""a1"".""event_date"" GROUP BY ""t1"".""install_dt"""
103,"WITH ""cte1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1), ""cte2"" AS (SELECT ""cte1"".""player_id"",""install_date"",CASE WHEN ""event_date"" IS NULL THEN 0 ELSE 1 END AS ""retention"" FROM ""cte1"" LEFT JOIN ""Activity"" ON ""cte1"".""player_id""=""Activity"".""player_id"" AND ""install_date""+1=""event_date"") SELECT ""install_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(AVG(""retention""), 2) AS ""Day1_retention"" FROM ""cte2"" GROUP BY 1 ORDER BY 1"
104,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - INTERVAL '1 DAY'=""a1"".""install_dt"") AS ""t"" GROUP BY ""install_dt"""
105,"WITH ""t"" (""player_id"", ""minlogindate"") AS (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") SELECT ""t"".""minlogindate"" AS ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NOT NULL THEN 1.00 ELSE 0.00 END)/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""minlogindate""=""a"".""event_date"" + INTERVAL '-1 DAY' GROUP BY ""t"".""minlogindate"""
106,"WITH ""CTE"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""gamesRank"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""Next_Login"" FROM ""Activity"") SELECT ""Installs"".""install_dt"",""installs"",CASE WHEN ""Day1_retention"" IS NULL THEN 0.00 ELSE ROUND((""Day1_retention""/""installs""), 2) END AS ""Day1_retention"" FROM (SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""CTE"" WHERE ""gamesRank""<2 GROUP BY ""event_date"") AS ""Installs"" LEFT JOIN (SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""Day1_retention"" FROM ""CTE"" WHERE ""gamesRank""<2 AND ""event_date""=""Next_Login"" - INTERVAL '1 DAY' GROUP BY ""event_date"") AS ""Day1_retention"" USING (""install_dt"")"
107,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT (CASE WHEN ""time_gap""=1 THEN ""player_id"" ELSE NULL END))*1.00/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"",""event_date"" - MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""time_gap"" FROM ""activity"") AS ""tmp"" GROUP BY 1 ORDER BY 1"
108,"SELECT ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") AS ""a1"" JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""install_dt"""
109,"SELECT ""fisrt_date"" AS ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(""event_date"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""fisrt_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""fisrt_date""=""b"".""event_date""-1 AND ""a"".""player_id""=""b"".""player_id"" GROUP BY ""install_dt"""
110,"WITH ""cte1"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""prev_day"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank_index"" FROM ""Activity""), ""cte2"" AS (SELECT ""event_date"",COUNT(DISTINCT ""player_id"") AS ""dr"" FROM ""cte1"" WHERE ""rank_index""=1 AND (""prev_day""-""event_date"")=1 GROUP BY ""event_date"") SELECT ""tmp"".""event_date"" AS ""install_dt"",""installs"",CASE WHEN ""dr"" IS NULL THEN 0.00 ELSE ROUND(""dr""/""installs"", 2) END AS ""Day1_retention"" FROM (SELECT ""event_date"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""cte1"" WHERE ""rank_index""=1 GROUP BY ""event_date"") AS ""tmp"" LEFT JOIN ""cte2"" ON ""tmp"".""event_date""=""cte2"".""event_date"""
111,"WITH ""cte1"" AS (SELECT * FROM ""activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""activity"" GROUP BY 1)), ""cte2"" AS (SELECT ""c1"".""event_date"",COUNT(1) AS ""retention"" FROM ""cte1"" AS ""c1"" JOIN ""activity"" AS ""a"" ON ""c1"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date"" - ""c1"".""event_date""=1 GROUP BY 1) SELECT ""c1"".""event_date"" AS ""install_dt"",COUNT(""c1"".""player_id"") AS ""installs"",ROUND(COALESCE(""retention""/COUNT(""c1"".""player_id""), 0), 2) AS ""Day1_retention"" FROM ""cte1"" AS ""c1"" LEFT JOIN ""cte2"" AS ""c2"" ON ""c1"".""event_date""=""c2"".""event_date"" GROUP BY 1 ORDER BY 1"
112,"SELECT ""a1"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1 GROUP BY 1"
113,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT DISTINCT ""cte"".""player_id"" AS ""installed"",""a"".""player_id"" AS ""returned"",""cte"".""install_date"" FROM ""cte"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""event_date"" + INTERVAL '-1 DAY'=""cte"".""install_date"" AND ""cte"".""player_id""=""a"".""player_id"") SELECT ""install_date"" AS ""install_dt"",COUNT(""installed"") AS ""installs"",ROUND(COUNT(""returned"")/COUNT(""installed""), 2) AS ""day1_retention"" FROM ""cte2"" GROUP BY ""install_date"""
114,"WITH ""cte1"" AS (SELECT * FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"" FROM ""activity"") AS ""t"" WHERE ""rnk""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",(ROUND(SUM(CASE WHEN ""event_date""=""next_day""-1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2)) AS ""Day1_retention"" FROM ""cte1"" GROUP BY 1"
115,"WITH ""ist"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""i"".""install_date"" AS ""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""player_id"")/COUNT(""i"".""player_id""), 2) AS ""Day1_retention"" FROM ""ist"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""i"".""install_date"" + INTERVAL '1 DAY'=""a"".""event_date"" GROUP BY ""i"".""install_date"""
116,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") SELECT ""b"".""event_date"" AS ""install_dt"",""denom"" AS ""installs"",ROUND(COALESCE(""num"", 0)/""denom"", 2) AS ""Day1_retention"" FROM (SELECT ""event_date"",COUNT(""player_id"") AS ""num"" FROM ""cte"" WHERE ""event_date"" + INTERVAL '1 DAY'=""next"" AND ""rnk""=1 GROUP BY ""event_date"") AS ""a"" RIGHT JOIN (SELECT ""event_date"",COUNT(""player_id"") AS ""denom"" FROM ""cte"" WHERE ""rnk""=1 GROUP BY ""event_date"") AS ""b"" ON ""a"".""event_date""=""b"".""event_date"""
117,"WITH ""InstallDate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id""), ""IntallDateAnalysis"" AS (SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"" FROM ""InstallDate"" GROUP BY ""install_dt""), ""NextLogin"" AS (SELECT ""A"".""player_id"",""A"".""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""A"".""player_id"" ORDER BY ""A"".""event_date"") AS ""NextLogin"" FROM ""Activity"" AS ""A""), ""1DayRetentionCounting"" AS (SELECT ""NL"".""player_id"",""ID"".""install_dt"",CASE WHEN ABS(""NL"".""event_date"" - ""NL"".""NextLogin"")=1 THEN 1 ELSE 0 END AS ""Retention"" FROM ""NextLogin"" AS ""NL"" JOIN ""InstallDate"" AS ""ID"" ON ""ID"".""install_dt""=""NL"".""event_date"" AND ""NL"".""player_id""=""ID"".""player_id""), ""1DayRetentionSummary"" AS (SELECT ""install_dt"",SUM(""Retention"") AS ""Retention"" FROM ""1DayRetentionCounting"" GROUP BY ""install_dt"") SELECT ""IAD"".""install_dt"",""IAD"".""installs"",ROUND(""1DRS"".""Retention""/""IAD"".""installs"", 2) AS ""Day1_retention"" FROM ""1DayRetentionSummary"" AS ""1DRS"" JOIN ""IntallDateAnalysis"" AS ""IAD"" ON ""IAD"".""install_dt""=""1DRS"".""install_dt"" ORDER BY 1"
118,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"" FROM ""cte"" GROUP BY ""install_dt""), ""cte3"" AS (SELECT COUNT(""a"".""player_id"") AS ""cnt"",""c"".""install_dt"" FROM ""activity"" AS ""a"" JOIN ""cte"" AS ""c"" ON ""a"".""event_date""=""c"".""install_dt""+1 AND ""a"".""player_id""=""c"".""player_id"" GROUP BY ""c"".""install_dt"") SELECT ""cte2"".""install_dt"",""cte2"".""installs"",ROUND(COALESCE((""cte3"".""cnt""/""cte2"".""installs""), 0), 2) AS ""Day1_retention"" FROM ""cte2"" LEFT JOIN ""cte3"" ON ""cte2"".""install_dt""=""cte3"".""install_dt"""
119,"SELECT ""install_dt"",COUNT(1) AS ""installs"",ROUND(AVG(""retained""), 2) AS ""Day1_retention"" FROM (SELECT ""t_install_dt"".""player_id"",""t_install_dt"".""install_dt"",CASE WHEN ""a1"".""event_date"" IS NULL THEN 0 ELSE 1 END AS ""retained"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t_install_dt"" LEFT JOIN ""Activity"" AS ""a1"" ON ""t_install_dt"".""player_id""=""a1"".""player_id"" AND ""t_install_dt"".""install_dt"" + INTERVAL '1 DAY'=""a1"".""event_date"") AS ""t1"" GROUP BY ""install_dt"""
120,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" AS ""a1"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(DISTINCT ""f"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""f"".""player_id""), 2) AS ""Day1_retention"" FROM ""first_login"" AS ""f"" LEFT JOIN ""Activity"" AS ""a"" ON ""f"".""install_dt""=""a"".""event_date"" - INTERVAL '1 DAY' AND ""f"".""player_id""=""a"".""player_id"" GROUP BY 1"
121,"WITH ""tmp1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_index"" FROM ""Activity""), ""tmp2"" AS (SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""tmp1"" WHERE ""row_index""=1 GROUP BY 1), ""tmp3"" AS (SELECT ""t2"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""t1"".""player_id"") AS ""day1_installs"" FROM (SELECT * FROM ""tmp1"" WHERE ""row_index""=2) AS ""t1"" LEFT JOIN (SELECT * FROM ""tmp1"" WHERE ""row_index""=1) AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""event_date"" - ""t2"".""event_date""=1 GROUP BY 1) SELECT ""tmp2"".""install_dt"",""tmp2"".""installs"",CAST(COALESCE(""tmp3"".""day1_installs""*1.0/""tmp2"".""installs"", 0) AS DECIMAL(10, 2)) AS ""Day1_retention"" FROM ""tmp2"" LEFT JOIN ""tmp3"" ON ""tmp2"".""install_dt""=""tmp3"".""install_dt"""
122,"WITH ""tb1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""tb1"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY 1"
123,"SELECT ""a"".""event_date"" AS ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"" GROUP BY ""a"".""event_date"""
124,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""install_dt""+1) AS ""t"" GROUP BY ""install_dt"""
125,"WITH ""t"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id""), ""t1"" AS (SELECT ""player_id"",""install_dt"" + INTERVAL '1 DAY' AS ""event_date"" FROM ""t""), ""ins_cnt"" AS (SELECT ""install_dt"",COUNT(1) AS ""installs"" FROM ""t"" GROUP BY ""install_dt""), ""ret_cnt"" AS (SELECT ""event_date"" - INTERVAL '1 DAY' AS ""install_dt"",COUNT(1) AS ""cnt"" FROM ""t1"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",""event_date"" FROM ""Activity"") GROUP BY ""event_date"") SELECT ""i"".""install_dt"",""installs"",ROUND(COALESCE(""cnt""/""installs"", 0), 2) AS ""Day1_retention"" FROM ""ins_cnt"" AS ""i"" LEFT JOIN ""ret_cnt"" AS ""r"" ON ""i"".""install_dt""=""r"".""install_dt"""
126,"SELECT ""a1"".""event_date"" AS ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a2"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""activity"" AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""event_date""=1 WHERE ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") GROUP BY ""a1"".""event_date"" ORDER BY ""a1"".""event_date"""
127,"WITH ""install_activity"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id""), ""count_retention"" AS (SELECT ""iact"".""install_date"" AS ""install_date"",COUNT(""act"".""player_id"") AS ""cnt"" FROM ""Activity"" AS ""act"" JOIN ""install_activity"" AS ""iact"" ON ""act"".""player_id""=""iact"".""player_id"" AND ""act"".""event_date""=""iact"".""install_date"" + INTERVAL '1 DAY' GROUP BY ""install_date"") SELECT ""ia"".""install_date"" AS ""install_dt"",COUNT(""ia"".""player_id"") AS ""installs"",ROUND(COALESCE(""cr"".""cnt"", 0)/COUNT(""ia"".""player_id""), 2) AS ""Day1_retention"" FROM ""install_activity"" AS ""ia"" LEFT JOIN ""count_retention"" AS ""cr"" ON ""ia"".""install_date""=""cr"".""install_date"" GROUP BY ""install_dt"""
128,"WITH ""idt"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""ret"" AS (SELECT ""idt"".*,""event_date"" FROM ""idt"" LEFT JOIN ""activity"" AS ""a"" ON ""idt"".""player_id""=""a"".""player_id"" AND ""idt"".""install_dt"" + INTERVAL '1 DAY'=""a"".""event_date"") SELECT ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""event_date"")/COUNT(1)*1.0, 2) AS ""Day1_retention"" FROM ""ret"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
129,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity""), ""temp1"" AS (SELECT ""t"".""player_id"",""t"".""event_date"" AS ""install_dt"" FROM ""temp"" AS ""t"" JOIN ""temp"" AS ""u"" ON ""t"".""player_id""=""u"".""player_id"" AND ""u"".""event_date"" - ""t"".""event_date""=1 WHERE ""t"".""ranking""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(""temp"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""temp1"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""temp"".""player_id""), 2) AS ""Day1_retention"" FROM ""temp"" LEFT JOIN ""temp1"" ON ""temp"".""event_date""=""temp1"".""install_dt"" AND ""temp1"".""player_id""=""temp"".""player_id"" WHERE ""temp"".""ranking""=1 GROUP BY ""event_date"""
130,"WITH ""temp"" AS (SELECT ""a"".""player_id"",""a"".""event_date"" FROM ""Activity"" AS ""a"" JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" WHERE ""a"".""event_date"">=""b"".""event_date"" GROUP BY ""a"".""player_id"",""a"".""event_date"" HAVING COUNT(""b"".""event_date"")=1), ""temp1"" AS (SELECT ""temp"".""player_id"",""temp"".""event_date"",CASE WHEN ""a"".""event_date"" IS NULL THEN 0 ELSE 1 END AS ""retent"" FROM ""temp"" LEFT JOIN ""Activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""retent"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""temp1"" GROUP BY ""event_date"" ORDER BY ""install_dt"""
131,"WITH ""install_date_df"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""i"".""install_date"" AS ""install_dt"",COUNT(""i"".""install_date"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_date""), 2) AS ""Day1_retention"" FROM ""install_date_df"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""event_date""=""i"".""install_date"" + INTERVAL '1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY ""i"".""install_date"""
132,"WITH ""tbDate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id""), ""tbTCnt"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""installs"" FROM ""tbDate"" GROUP BY ""event_date""), ""tbCnt"" AS (SELECT ""tbDate"".""event_date"" AS ""install_dt"",""tbTCnt"".""installs"",ROUND(COUNT(""a2"".""player_id"")/""tbTCnt"".""installs"", 2) AS ""Day1_retention"" FROM (""tbDate"" JOIN ""tbTcnt"" ON ""tbTcnt"".""event_date""=""tbDate"".""event_date"") LEFT JOIN ""activity"" AS ""a2"" ON ""a2"".""event_date"" - ""tbDate"".""event_date""=1 AND ""a2"".""player_id""=""tbDate"".""player_id"" GROUP BY ""tbDate"".""event_date"") SELECT * FROM ""tbCnt"""
133,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextd"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date""=""nextd"" - INTERVAL '1 DAY' THEN ""player_id"" ELSE NULL END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""t"" WHERE ""rk""=1 GROUP BY ""event_date"""
134,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextd"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date""=""nextd"" - INTERVAL '1 DAY' THEN ""player_id"" ELSE NULL END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""t"" WHERE ""rk""=1 GROUP BY ""event_date"""
135,"SELECT ""temp1"".""install_dt"",""temp1"".""installs"" AS ""installs"",ROUND(""temp2"".""retention""/""temp1"".""installs"", 2) AS ""Day1_retention"" FROM (SELECT ""t"".""install_dt"",COUNT(DISTINCT ""t"".""player_id"") AS ""installs"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"" GROUP BY ""t"".""install_dt"") AS ""temp1"" LEFT JOIN (SELECT ""t"".""install_dt"",SUM(CASE WHEN ""a"".""player_id"" IS NULL THEN 0 ELSE 1 END) AS ""retention"" FROM ""Activity"" AS ""a"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"" ON ""a"".""player_id""=""t"".""player_id"" AND ""a"".""event_date"" - ""t"".""install_dt""=1 GROUP BY ""t"".""install_dt"") AS ""temp2"" ON ""temp1"".""install_dt""=""temp2"".""install_dt"""
136,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""install_dt""+1=""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""activity"") AS ""tmp"" GROUP BY ""install_dt"""
137,"WITH ""temp"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""next_day"" FROM ""Activity"" GROUP BY ""player_id""), ""temp2"" AS (SELECT ""temp"".*,""activity"".""device_id"" FROM ""temp"" LEFT JOIN ""activity"" ON ""temp"".""player_id""=""activity"".""player_id"" AND ""temp"".""next_day""=""activity"".""event_date"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""device_id"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""temp2"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
138,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""fl"".""first_login"" AS ""install_dt"",COUNT(""fl"".""first_login"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""fl"".""first_login""), 2) AS ""day1_retention"" FROM ""activity"" AS ""a"" RIGHT JOIN ""first_login"" AS ""fl"" ON ""a"".""event_date""=""first_login"" + INTERVAL '1 DAY' AND ""a"".""player_id""=""fl"".""player_id"" GROUP BY 1"
139,"WITH ""day0_table"" AS (SELECT ""B"".""first_login"" AS ""install_date"",COUNT(""B"".""player_id"") AS ""day0_num"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""B"" GROUP BY ""B"".""first_login""), ""day1_table"" AS (SELECT ""T"".""first_login"" AS ""install_date"",COALESCE(COUNT(DISTINCT ""A"".""player_id""), 0) AS ""day1_num"" FROM ""Activity"" AS ""A"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""T"" ON ""A"".""player_id""=""T"".""player_id"" AND ""A"".""event_date""=""T"".""first_login""+1 GROUP BY ""T"".""first_login"") SELECT ""day0_table"".""install_date"" AS ""install_dt"",""day0_table"".""day0_num"" AS ""installs"",ROUND(""day1_table"".""day1_num""/""day0_table"".""day0_num"", 2) AS ""Day1_retention"" FROM ""day0_table"" JOIN ""day1_table"" ON ""day0_table"".""install_date""=""day1_table"".""install_date"" GROUP BY ""day0_table"".""install_date"""
140,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""date"" FROM ""activity"" GROUP BY 1) SELECT ""date"" AS ""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""player_id"")/COUNT(""i"".""player_id""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""i"".""date""=""a"".""event_date""-1 GROUP BY 1 ORDER BY 1"
141,"WITH ""earliest_date"" AS (SELECT * FROM (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") AS ""a"" WHERE ""rn""=1), ""retained"" AS (SELECT ""b"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""b"".""player_id"") AS ""day1_retained"" FROM ""activity"" AS ""a"" JOIN ""earliest_date"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" + INTERVAL '1 DAY'=""a"".""event_date"" GROUP BY ""b"".""event_date""), ""installed_on_first_day"" AS (SELECT ""b"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""b"".""player_id"") AS ""installed_on_first_day"" FROM ""activity"" AS ""a"" JOIN ""earliest_date"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""event_date"" GROUP BY ""b"".""event_date""), ""agg_activity"" AS (SELECT ""a"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"" FROM ""activity"" AS ""a"" JOIN ""earliest_date"" AS ""b"" USING (""player_id"",""event_date"") GROUP BY ""a"".""event_date"") SELECT ""a"".""install_dt"",""a"".""installs"",COALESCE(ROUND(""b"".""day1_retained""/""c"".""installed_on_first_day"", 2), 0) AS ""Day1_retention"" FROM (""agg_activity"" AS ""a"" LEFT JOIN ""retained"" AS ""b"" USING (""install_dt"")) LEFT JOIN ""installed_on_first_day"" AS ""c"" USING (""install_dt"")"
142,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nxt"" FROM ""Activity"") SELECT DISTINCT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""nxt""=""event_date""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t1"" WHERE ""rnk""=1 GROUP BY 1 ORDER BY 1"
143,"WITH ""first_activity"" AS (SELECT ""player_id"",""event_date"" AS ""install_dt"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank_num"" FROM ""Activity"") AS ""a"" WHERE ""rank_num""=1) SELECT ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date""-1=""install_dt"" THEN ""a"".""player_id"" END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""Activity"" AS ""b"" LEFT JOIN ""first_activity"" AS ""a"" ON ""b"".""player_id""=""a"".""player_id"" GROUP BY ""install_dt"""
144,"SELECT ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""install_dt"""
145,"SELECT ""a1"".""mindate"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""mindate"" FROM ""Activity"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a2"".""event_date"" - ""a1"".""mindate""=1 AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""a1"".""mindate"""
146,"WITH ""installs_A"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""a"".""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""installs_A"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""install_dt"" + INTERVAL '1 DAY' GROUP BY ""a"".""install_dt"""
147,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rownum"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""next_day"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" WHERE ""rownum""=1 GROUP BY ""install_dt"""
148,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity""), ""temp1"" AS (SELECT ""t"".""player_id"",""t"".""event_date"" AS ""install_dt"" FROM ""temp"" AS ""t"" JOIN ""temp"" AS ""u"" ON ""t"".""player_id""=""u"".""player_id"" AND ""u"".""event_date"" - ""t"".""event_date""=1 WHERE ""t"".""ranking""=1), ""temp2"" AS (SELECT ""player_id"",""event_date"" FROM ""temp"" WHERE ""ranking""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(""temp2"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""temp1"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""temp2"".""player_id""), 2) AS ""Day1_retention"" FROM ""temp2"" LEFT JOIN ""temp1"" ON ""temp2"".""event_date""=""temp1"".""install_dt"" AND ""temp1"".""player_id""=""temp2"".""player_id"" GROUP BY ""event_date"""
149,"SELECT ""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""install_dt""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""b"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""event_date""=""b"".""install_dt""+1 AND ""b"".""player_id""=""a"".""player_id"" GROUP BY ""install_dt"""
150,"SELECT ""a1"".""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""Activity"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""event_date""=""a2"".""event_date""-1 AND ""a1"".""player_id""=""a2"".""player_id"" WHERE ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") GROUP BY 1"
151,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""retention"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""install_dt""+1=""a2"".""event_date"") AS ""tmp"" GROUP BY ""install_dt"""
152,"WITH ""cte1"" AS (SELECT * FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"" FROM ""activity"") AS ""t"" WHERE ""rnk""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",(ROUND(SUM(CASE WHEN ""event_date""=""next_day""-1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2)) AS ""Day1_retention"" FROM ""cte1"" GROUP BY 1"
153,"WITH ""t"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextday"" FROM ""Activity"") SELECT ""t"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(COALESCE(""back"", 0)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t"" LEFT JOIN (SELECT ""t"".""event_date"",COUNT(1) AS ""back"" FROM ""t"" WHERE ""rn""=1 AND ""nextday"" - ""event_date""=1 GROUP BY ""event_date"") AS ""t1"" ON ""t"".""event_date""=""t1"".""event_date"" WHERE ""rn""=1 GROUP BY ""t"".""event_date"""
154,"SELECT ""f"".""first_date"" AS ""install_dt"",COUNT(""f"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""f"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""f"" LEFT JOIN ""Activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" AND ""f"".""first_date""=""a"".""event_date""-1 GROUP BY ""f"".""first_date"""
155,"SELECT ""first_login"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""player_status"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""ll"".""player_id"",""ll"".""first_login"",CASE WHEN ""rr"".""player_id"" IS NULL THEN 0 ELSE 1 END AS ""player_status"" FROM (SELECT ""a"".""player_id"",MIN(""a"".""event_date"") AS ""first_login"" FROM ""activity"" AS ""a"" GROUP BY ""a"".""player_id"") AS ""ll"" LEFT JOIN (SELECT DISTINCT ""l"".""player_id"" FROM (SELECT ""b"".""player_id"",MIN(""b"".""event_date"") AS ""first_login"" FROM ""activity"" AS ""b"" GROUP BY ""b"".""player_id"") AS ""l"" JOIN ""activity"" AS ""r"" ON ""l"".""player_id""=""r"".""player_id"" WHERE ""l"".""first_login""+1=""r"".""event_date"") AS ""rr"" ON ""ll"".""player_id""=""rr"".""player_id"") AS ""t"" GROUP BY ""first_login"""
156,"WITH ""t2"" AS (SELECT ""PLAYER_ID"",MIN(CASE WHEN ""rnum""=1 THEN ""event_date"" ELSE NULL END) AS ""INSTALL_DT"",MIN(CASE WHEN ""rnum""=2 THEN ""event_date"" ELSE NULL END) AS ""NEXT_LOGIN"" FROM (SELECT ""PLAYER_ID"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""PLAYER_ID"" ORDER BY ""event_date"") AS ""rnum"" FROM ""Activity"") AS ""t1"" WHERE ""rnum""<=2 GROUP BY ""PLAYER_ID"") SELECT ""INSTALL_DT"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""NEXT_LOGIN"" - ""INSTALL_DT""=1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""T2"" GROUP BY ""INSTALL_DT"" ORDER BY ""INSTALL_DT"""
157,"WITH ""player_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""a"".""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""player_login"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""install_dt"" + INTERVAL '1 DAY' GROUP BY 1"
158,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1, NULL) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_visit_dt"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"" FROM ""Activity""), ""installation"" AS (SELECT ""player_id"",""event_date"" AS ""install_dt"",""next_visit_dt"" - ""event_date"" AS ""date_diff"" FROM ""temp"" WHERE ""date_rank""=1) SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(CASE WHEN ""date_diff""=1 THEN 1 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""installation"" GROUP BY ""install_dt"""
159,"SELECT ""a"".""event_date"" AS ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""b"".""event_date"" - ""a"".""event_date""=1 AND ""a"".""player_id""=""b"".""player_id"" GROUP BY 1"
160,"WITH ""tbDate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id""), ""tbTCnt"" AS (SELECT ""tbDate"".""event_date"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"" FROM ""activity"" AS ""a1"" JOIN ""tbDate"" ON ""a1"".""event_date""=""tbDate"".""event_date"" AND ""a1"".""player_id""=""tbDate"".""player_id"" GROUP BY ""tbDate"".""event_date""), ""tbCnt"" AS (SELECT ""tbDate"".""event_date"",COUNT(""a2"".""player_id"") AS ""install"" FROM ""tbDate"" LEFT JOIN ""activity"" AS ""a2"" ON ""a2"".""event_date"" - ""tbDate"".""event_date""=1 AND ""a2"".""player_id""=""tbDate"".""player_id"" GROUP BY ""tbDate"".""event_date"") SELECT ""tbTcnt"".""event_date"" AS ""install_dt"",""tbTCnt"".""installs"",ROUND(""tbCnt"".""install""/""tbTCnt"".""installs"", 2) AS ""Day1_retention"" FROM ""tbTcnt"" JOIN ""tbCnt"" ON ""tbTcnt"".""event_date""=""tbCnt"".""event_date"""
161,"WITH ""install_tbl"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""retention_date_def"" FROM ""Activity"" GROUP BY 1) SELECT ""a"".""install_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""b"".""event_date"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""install_tbl"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""retention_date_def""=""b"".""event_date"" GROUP BY 1"
162,"WITH ""install_dt"" AS (SELECT MIN(""event_date"") AS ""install_dt"",""player_id"" FROM ""Activity"" GROUP BY ""player_id""), ""install_num"" AS (SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"" FROM ""install_dt"" GROUP BY ""install_dt""), ""retention_num"" AS (SELECT COUNT(DISTINCT ""a"".""player_id"") AS ""retention_num"",""i"".""install_dt"" AS ""install_dt"" FROM ""install_dt"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_dt"" - ""a"".""event_date""=-1 AND ""i"".""player_id""=""a"".""player_id"" GROUP BY ""i"".""install_dt"") SELECT ""i"".""install_dt"" AS ""install_dt"",""i"".""installs"" AS ""installs"",ROUND(COALESCE(""r"".""retention_num"", 0)/""i"".""installs"", 2) AS ""Day1_retention"" FROM ""install_num"" AS ""i"" LEFT JOIN ""retention_num"" AS ""r"" ON ""i"".""install_dt""=""r"".""install_dt"""
163,"WITH ""temp"" AS (SELECT ""t1"".""player_id"",""dt"",""a"".""event_date"" AS ""next_day"" FROM (SELECT *,MIN(""event_date"") AS ""dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""a"" ON ""t1"".""player_id""=""a"".""player_id"" AND ""t1"".""dt""=""a"".""event_date""-1) SELECT ""dt"" AS ""install_dt"",COUNT(""dt"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""temp"" GROUP BY 1"
164,"WITH ""min_date"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"" FROM ""activity"") SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""min_date"" GROUP BY ""install_dt"""
165,"WITH ""first_login"" AS (SELECT ""a"".""player_id"",""a"".""event_date"" AS ""first_login"",""b"".""event_date"" AS ""logback"" FROM ""Activity"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""b"".""event_date""=""a"".""event_date"" + INTERVAL '1 DAY' AND ""a"".""player_id""=""b"".""player_id"" WHERE ROW(""a"".""player_id"",""a"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY 1)) SELECT ""first_login"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""logback"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""first_login"" GROUP BY 1"
166,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1) SELECT ""i"".""install_date"" AS ""install_dt"",COUNT(""install_date"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_date""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_date""=""a"".""event_date"" + INTERVAL '-1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY 1 ORDER BY 1"
167,"SELECT ""first_login"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""activity"") AS ""tb1"" GROUP BY ""first_login"""
168,"WITH ""a"" AS (SELECT RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""r"",""player_id"",""event_date"" FROM ""Activity""), ""b"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" AS ""install_dt"",CASE WHEN ""a2"".""r"" IS NULL THEN 0 ELSE 1 END AS ""retention"" FROM ""a"" AS ""a1"" LEFT JOIN ""a"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""=""a2"".""event_date""-1 WHERE ""a1"".""r""=1) SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COALESCE(SUM(""retention"")/COUNT(""player_id""), 0), 2) AS ""Day1_retention"" FROM ""b"" GROUP BY ""install_dt"""
169,"WITH ""sorting"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""day_num"",(LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"")-""event_date"") AS ""next_login_gap"" FROM ""Activity""), ""coming_back"" AS (SELECT ""event_date"",COUNT(1) AS ""returned"" FROM ""sorting"" WHERE ""day_num""=1 AND ""next_login_gap""=1 GROUP BY 1) SELECT ""s"".""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COALESCE(""c"".""returned""/COUNT(1), 0), 2) AS ""Day1_retention"" FROM ""sorting"" AS ""s"" LEFT JOIN ""coming_back"" AS ""c"" ON ""s"".""event_date""=""c"".""event_date"" WHERE ""s"".""day_num""=1 GROUP BY 1 ORDER BY 1"
170,"SELECT ""A"".""event_date"" AS ""install_dt"",COUNT(""A"".""player_id"") AS ""installs"",ROUND(COUNT(""B"".""player_id"")/COUNT(""A"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" AND ""A"".""event_date""+1=""B"".""event_Date"" GROUP BY ""A"".""event_date"""
171,"WITH ""temp"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""install_date"" AS ""install_dt"",SUM(CASE WHEN ""install_date""=""event_date"" THEN 1 ELSE 0 END) AS ""installs"",ROUND(SUM(CASE WHEN ""install_date""+1=""event_date"" THEN 1 ELSE 0 END)/SUM(CASE WHEN ""install_date""=""event_date"" THEN 1 ELSE 0 END), 2) AS ""day1_retention"" FROM ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"" GROUP BY ""install_date"""
172,"WITH ""temp1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id""), ""temp2"" AS (SELECT ""first_login"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""temp1"" GROUP BY ""first_login""), ""temp3"" AS (SELECT ""b"".""first_login"",""a"".""player_id"" FROM ""Activity"" AS ""a"" JOIN ""temp1"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date"" - ""b"".""first_login""=1), ""temp4"" AS (SELECT ""first_login"",COUNT(DISTINCT ""player_id"") AS ""next_day"" FROM ""temp3"" GROUP BY ""first_login"") SELECT ""b"".""install_dt"",""b"".""installs"",ROUND(COALESCE((""c"".""next_day""/""b"".""installs""), 0), 2) AS ""Day1_retention"" FROM ""temp2"" AS ""b"" LEFT JOIN ""temp4"" AS ""c"" ON ""b"".""install_dt""=""c"".""first_login"" ORDER BY ""install_dt"""
173,"WITH ""cte"" AS (SELECT ""t2"".""install_dt"",COUNT(1) AS ""day2log"" FROM (SELECT ""a"".""player_id"",""a"".""event_date"",""a"".""games_played"",""t1"".""install_dt"" FROM ""Activity"" AS ""a"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" ON ""t1"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date""=(""t1"".""install_dt""+1)) AS ""t2"" GROUP BY ""t2"".""install_dt""), ""cte2"" AS (SELECT ""t1"".""install_dt"",COUNT(""t1"".""player_id"") AS ""installs"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" GROUP BY ""t1"".""install_dt""), ""cte3"" AS (SELECT ""t3"".""install_dt"",""t3"".""installs"",ROUND(""cte"".""day2log""/""t3"".""installs"", 2) AS ""Day2_rentention"" FROM (SELECT ""t1"".""install_dt"",COUNT(""t1"".""player_id"") AS ""installs"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" GROUP BY ""t1"".""install_dt"") AS ""t3"" JOIN ""cte"" ON ""cte"".""install_dt""=""t3"".""install_dt"") SELECT ""cte2"".""install_dt"",""cte2"".""installs"",COALESCE(""cte3"".""Day2_rentention"", 0) AS ""Day1_retention"" FROM ""cte2"" LEFT JOIN ""cte3"" ON ""cte2"".""install_dt""=""cte3"".""install_dt"""
174,"SELECT ""TBL"".""install_dt"",COUNT(""TBL"".""player_id"") AS ""installs"",ROUND(COUNT(""A"".""player_id"")/COUNT(""TBL"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) AS ""TBL"" LEFT JOIN ""Activity"" AS ""A"" ON ""TBL"".""player_id""=""A"".""player_id"" AND ""TBL"".""install_dt""=""A"".""event_date""-1 GROUP BY 1"
175,"WITH ""install_date_df"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id""), ""retain_dates"" AS (SELECT ""i"".""player_id"",""i"".""install_date"",""a"".""event_date"" AS ""retained_date"" FROM ""install_date_df"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""event_date""=""i"".""install_date"" + INTERVAL '1 DAY' AND ""i"".""player_id""=""a"".""player_id"") SELECT ""install_date"" AS ""install_dt"",COUNT(""install_date"") AS ""installs"",ROUND(COUNT(""retained_date"")/COUNT(""install_date""), 2) AS ""Day1_retention"" FROM ""retain_dates"" GROUP BY ""install_date"""
176,"WITH ""t"" (""player_id"", ""minlogindate"") AS (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") SELECT ""t"".""minlogindate"" AS ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NOT NULL THEN 1.00 ELSE 0.00 END)/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""minlogindate""=""a"".""event_date"" + INTERVAL '-1 DAY' GROUP BY ""t"".""minlogindate"""
177,"WITH ""Installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(DISTINCT ""Installs"".""player_id"") AS ""installs"",ROUND(COALESCE(COUNT(""Activity"".""player_id"")/COUNT(""Installs"".""player_id""), 0), 2) AS ""Day1_retention"" FROM ""Installs"" LEFT JOIN ""Activity"" ON ""Installs"".""player_id""=""Activity"".""player_id"" AND ""install_dt"" + INTERVAL '1 DAY'=""Activity"".""event_date"" GROUP BY 1"
178,"WITH ""cte"" AS (SELECT ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",COALESCE(COUNT(""v"".""event_date""), 0) AS ""rets"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"" LEFT JOIN (SELECT ""player_id"",""event_date"" FROM ""Activity"") AS ""v"" ON ""t"".""player_id""=""v"".""player_id"" AND ""install_dt""=""v"".""event_date""-1 GROUP BY ""install_dt"") SELECT ""install_dt"",""installs"",ROUND((""rets""/""installs""), 2) AS ""Day1_retention"" FROM ""cte"""
179,"WITH ""cte"" AS (SELECT * FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") AS ""t1"" WHERE ""rnk""<3), ""cte2"" AS (SELECT ""player_id"",MAX(CASE WHEN ""rnk""=1 THEN ""event_date"" END) AS ""install_date"",MAX(CASE WHEN ""rnk""=2 THEN ""event_date"" END) AS ""day2"" FROM ""cte"" GROUP BY ""player_id"") SELECT ""install_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND((SUM(CASE WHEN ""day2"" IS NOT NULL AND ""day2"" - ""install_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id"")), 2) AS ""Day1_retention"" FROM ""cte2"" GROUP BY ""install_date"" ORDER BY ""install_date"""
180,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""install_dt""+1) AS ""t"" GROUP BY ""install_dt"""
181,"WITH ""prep"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",CASE WHEN LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""isLoginNextDay"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""isLoginNextDay"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""prep"" WHERE ""rn""=1 GROUP BY ""install_dt"""
182,"WITH ""tb1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""tb1"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY 1"
183,"WITH ""ranked_event_date"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_rank"" FROM ""Activity"") SELECT ""date1"" AS ""install_dt"",COUNT(""day_one"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""date2"" - ""date1""=1 THEN 1 ELSE 0 END)/COUNT(""day_one"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""event_date"" AS ""date1"",""player_id"" FROM ""ranked_event_date"" WHERE ""event_date_rank""=1) AS ""day_one"" LEFT JOIN (SELECT ""event_date"" AS ""date2"",""player_id"" FROM ""ranked_event_date"" WHERE ""event_date_rank""=2) AS ""day_two"" ON ""day_one"".""player_id""=""day_two"".""player_id"" GROUP BY ""date1"""
184,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""theNextDay"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""fl"".""first_login"" AS ""install_dt"",COUNT(""fl"".""first_login"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""fl"".""first_login""), 2) AS ""day1_retention"" FROM ""activity"" AS ""a"" RIGHT JOIN ""first_login"" AS ""fl"" ON ""a"".""event_date""=""theNextDay"" AND ""a"".""player_id""=""fl"".""player_id"" GROUP BY 1"
185,"WITH ""cte1"" AS (SELECT * FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""activity"" GROUP BY 1)), ""cte2"" AS (SELECT ""cte1"".""event_date"",COUNT(1) AS ""retention_count"" FROM ""cte1"" JOIN ""activity"" AS ""a"" ON ""cte1"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date"" - ""cte1"".""event_date""=1 GROUP BY 1) SELECT ""cte1"".""event_date"" AS ""install_dt"",COUNT(""cte1"".""player_id"") AS ""installs"",ROUND(COALESCE(""cte2"".""retention_count""/COUNT(""cte1"".""player_id""), 0), 2) AS ""Day1_retention"" FROM ""cte1"" LEFT JOIN ""cte2"" ON ""cte1"".""event_date""=""cte2"".""event_date"" GROUP BY 1 ORDER BY 1"
186,"WITH ""cte"" AS (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""install_dt""=""a2"".""event_date""-1) SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" GROUP BY ""install_dt"""
187,"SELECT ""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""install_dt""=1 GROUP BY ""install_dt"" ORDER BY ""install_dt"""
188,"WITH ""CTE"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""gamesRank"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""Next_Login"" FROM ""Activity"") SELECT ""Installs"".""install_dt"",""installs"",CASE WHEN ""Day1_retention"" IS NULL THEN 0.00 ELSE ROUND((""Day1_retention""/""installs""), 2) END AS ""Day1_retention"" FROM (SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM ""CTE"" WHERE ""gamesRank""<2 GROUP BY ""event_date"") AS ""Installs"" LEFT JOIN (SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""Day1_retention"" FROM ""CTE"" WHERE ""gamesRank""<2 AND ""event_date""=""Next_Login"" - INTERVAL '1 DAY' GROUP BY ""event_date"") AS ""Day1_retention"" USING (""install_dt"")"
189,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""a"".""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""install_dt""=""b"".""event_date""-1 GROUP BY 1"
190,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""activity"") AS ""x"" GROUP BY ""install_dt"""
191,"SELECT ""install_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""next_day_login"")/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a"".""player_id"",""a"".""install_date"",COALESCE(""b"".""next_day_login"", 0) AS ""next_day_login"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"",TO_CHAR(MIN(""event_date"")+1, 'YYYY-%m-%d') AS ""next_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN (SELECT ""player_id"",""event_date"",1 AS ""next_day_login"" FROM ""Activity"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""next_date""=""b"".""event_date"") AS ""c"" GROUP BY ""install_date"""
192,"SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""lead_date"" - ""event_Date""=1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""n_row"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead_date"" FROM ""Activity"" GROUP BY 1,2) AS ""a"" WHERE ""n_row""=1 GROUP BY 1"
193,"SELECT ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""b"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""install_dt"" + INTERVAL '1 DAY'=""b"".""event_date"" GROUP BY 1"
194,"WITH ""install_dates"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id""), ""activity_grouped"" AS (SELECT ""player_id"",""event_date"" FROM ""Activity"" GROUP BY 1,2) SELECT ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""install_dates"" AS ""i"" LEFT JOIN ""activity_grouped"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""i"".""install_dt""=1 GROUP BY ""i"".""install_dt"""
195,"WITH ""in_dt"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" AS ""a"" GROUP BY 1), ""retent"" AS (SELECT DISTINCT ""i"".""player_id"",""first_login"" FROM ""in_dt"" AS ""i"" JOIN ""activity"" AS ""a"" ON ""a"".""player_id""=""i"".""player_id"" AND ""i"".""first_login"" + INTERVAL '1 DAY'=""a"".""event_date"") SELECT ""i"".""first_login"" AS ""install_dt"",COUNT(DISTINCT ""i"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""r"".""player_id"")/COUNT(DISTINCT ""i"".""player_id""), 2) AS ""Day1_retention"" FROM ""in_dt"" AS ""i"" LEFT JOIN ""retent"" AS ""r"" ON ""r"".""player_id""=""i"".""player_id"" GROUP BY 1 ORDER BY 1"
196,"WITH ""c"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""dseq"" FROM ""Activity"") SELECT ""c1"".""event_date"" AS ""install_dt"",COUNT(""c1"".""dseq"") AS ""installs"",ROUND(1.0*COUNT(""c2"".""dseq"")/COUNT(""c1"".""dseq""), 2) AS ""Day1_retention"" FROM ""c"" AS ""c1"" LEFT JOIN ""c"" AS ""c2"" ON ""c1"".""player_id""=""c2"".""player_id"" AND ""c2"".""dseq""=2 AND ""c2"".""event_date"" - ""c1"".""event_date""=1 WHERE ""c1"".""dseq""=1 GROUP BY ""c1"".""event_date"" ORDER BY 1"
197,"WITH ""cte"" AS (SELECT MIN(""event_date"") AS ""install_dt"",""player_id"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""a"".""install_dt"",COUNT(""a"".""player_id"") AS ""installs"",ROUND(COALESCE((""b_player""/COUNT(""a"".""player_id"")), 0), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a"" LEFT JOIN (SELECT COUNT(""player_id"") AS ""b_player"",""event_date"" FROM ""activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",""install_dt"" + INTERVAL '1 DAY' FROM ""cte"") GROUP BY ""event_date"") AS ""b"" ON ""a"".""install_dt""=""b"".""event_date"" + INTERVAL '-1 DAY' GROUP BY ""a"".""install_dt"""
198,"WITH ""retention"" AS (SELECT ""event_date"",COUNT(""player_id"") OVER (PARTITION BY ""event_date"") AS ""num_retained"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM (""Activity"" AS ""a1"") JOIN ""Activity"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY 1))), ""installation"" AS (SELECT ""event_date"",COUNT(""player_id"") OVER (PARTITION BY ""event_date"") AS ""num_installed"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"")) SELECT DISTINCT ""i"".""event_date"" AS ""install_dt"",""i"".""num_installed"" AS ""installs"",COALESCE(ROUND(""r"".""num_retained""/""i"".""num_installed"", 2), 0) AS ""Day1_retention"" FROM ""installation"" AS ""i"" LEFT JOIN ""retention"" AS ""r"" ON ""i"".""event_date""=""r"".""event_date"""
199,"SELECT ""install_dt"",COUNT(DISTINCT ""x"".""player_id"") AS ""installs"",ROUND(CAST(COALESCE(COUNT(DISTINCT ""a"".""player_id""), 0) AS DECIMAL(10))/COUNT(DISTINCT ""x"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""x"" LEFT JOIN ""Activity"" AS ""a"" ON ""x"".""player_id""=""a"".""player_id"" AND ""x"".""install_dt""+1=""a"".""event_date"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
200,"WITH ""t1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id""), ""t2"" AS (SELECT ""t1"".""player_id"",""t1"".""install_date"",COALESCE(MIN(""a"".""event_date"" - ""t1"".""install_date""), 0) AS ""NEXT_LOGIN_AFTER_DAYS"" FROM ""Activity"" AS ""a"" RIGHT JOIN ""t1"" ON ""a"".""player_id""=""t1"".""player_id"" AND ""a"".""event_date"">""t1"".""install_date"" GROUP BY ""a"".""player_id"",""t1"".""install_date"") SELECT ""install_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""NEXT_LOGIN_AFTER_DAYS""=1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""T2"" GROUP BY ""install_date"""
201,"WITH ""TEMP"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""B"".""event_date"")/COUNT(""A"".""install_dt""), 2) AS ""day1_retention"" FROM ""TEMP"" AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""install_dt""=""B"".""event_date"" + INTERVAL '-1 DAY' AND ""A"".""player_id""=""B"".""player_id"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
202,"WITH ""install_date_df"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""i"".""install_date"" AS ""install_dt"",COUNT(""i"".""install_date"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_date""), 2) AS ""Day1_retention"" FROM ""install_date_df"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""event_date""=""i"".""install_date"" + INTERVAL '1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY ""i"".""install_date"""
203,"ERROR: mysql parse error: line 1 column 277 near ""as a1 left join activity as a2 on a1.player_id = a2.player_id and a1.install_dt=a2.event_date-1 ) ) as temp group by install_dt"" "
204,"WITH ""first_login"" AS (SELECT ""event_date"",""player_id"" FROM (SELECT ""event_date"",""player_id"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") AS ""a"" WHERE ""a"".""rnk""=1), ""one_plus_days"" AS (SELECT ""f"".""player_id"",""f"".""event_date"" AS ""first_date"",""a"".""event_date"" AS ""second_date"" FROM ""first_login"" AS ""f"" LEFT JOIN ""activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" AND ""f"".""event_date""=""a"".""event_date"" + INTERVAL '-1 DAY'), ""cases"" AS (SELECT ""first_date"",""second_date"",CASE WHEN ""second_date"" IS NOT NULL THEN 1 ELSE 0 END AS ""cnt1"" FROM ""one_plus_days"") SELECT ""first_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""cnt1"")/COUNT(1), 2) AS ""Day1_retention"" FROM ""cases"" GROUP BY ""first_date"""
205,"SELECT ""a1"".""mindate"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""mindate"" FROM ""Activity"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a2"".""event_date"" - ""a1"".""mindate""=1 AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""a1"".""mindate"""
206,"WITH ""t"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextd"" FROM ""activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(CASE WHEN ""event_date""=""nextd"" - INTERVAL '1 DAY' THEN ""player_id"" ELSE NULL END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""t"" WHERE ""rk""=1 GROUP BY ""event_date"""
207,"WITH ""cte"" AS (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""install_dt""+1=""a2"".""event_date"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""retention"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" GROUP BY 1 ORDER BY 1"
208,"WITH ""a"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lag1_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM ""ACTIVITY""), ""b"" AS (SELECT * FROM ""a"" WHERE ""rk""=1), ""c"" AS (SELECT ""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",SUM(CASE WHEN ""lag1_date"" - ""event_date""=1 THEN 1 ELSE 0 END) AS ""ct"" FROM ""b"" GROUP BY ""event_date"") SELECT ""install_dt"",""installs"",ROUND(""ct""/""installs"", 2) AS ""Day1_retention"" FROM ""c"""
209,"WITH ""indiv_install"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1), ""retained_people"" AS (SELECT ""i"".""player_id"",""i"".""install_date"" FROM ""indiv_install"" AS ""i"" JOIN ""Activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""i"".""install_date""=""a"".""event_date""-1), ""retained_ct"" AS (SELECT ""install_date"",COUNT(""player_id"") AS ""retained_1day"" FROM ""retained_people"" GROUP BY 1), ""installed"" AS (SELECT ""install_date"",COUNT(""player_id"") AS ""installs"" FROM ""indiv_install"" GROUP BY 1) SELECT ""i"".""install_date"" AS ""install_dt"",""i"".""installs"",ROUND(COALESCE(""r"".""retained_1day"", 0)/""i"".""installs"", 2) AS ""Day1_retention"" FROM ""installed"" AS ""i"" LEFT JOIN ""retained_ct"" AS ""r"" ON ""i"".""install_date""=""r"".""install_date"""
210,"WITH ""day1retained"" AS (SELECT ""a"".""event_date"",COUNT(""a"".""player_id"") AS ""X"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""dateorder"" FROM ""Activity"") AS ""a"" WHERE ""a"".""dateorder""=1 AND CASE WHEN COALESCE(""a"".""next_date"", 0)=""a"".""event_date"" + INTERVAL '1 DAY' THEN TRUE ELSE FALSE END GROUP BY ""a"".""event_date""), ""day1logins"" AS (SELECT ""b"".""event_date"",COUNT(""b"".""player_id"") AS ""X"" FROM (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""dateorder"" FROM ""Activity"") AS ""b"" WHERE ""b"".""dateorder""=1 GROUP BY ""b"".""event_date"") SELECT ""day1logins"".""event_date"" AS ""install_dt"",""day1logins"".""X"" AS ""installs"",ROUND(COALESCE(""day1retained"".""X"", 0)/""day1logins"".""X"", 2) AS ""Day1_retention"" FROM ""day1logins"" LEFT JOIN ""day1retained"" ON ""day1logins"".""event_date""=""day1retained"".""event_date"""
211,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""t"".""player_id"",""t"".""install_dt"",""a"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""player_id""=""t"".""player_id"" AND ""a"".""event_date""=""install_dt""+1) AS ""t2"" GROUP BY ""install_dt"""
212,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",COALESCE(ROUND(COUNT(CASE WHEN ""install_dt"" + INTERVAL '1 DAY'=""lddt"" THEN ""player_id"" END)/COUNT(DISTINCT ""player_id""), 2), 0) AS ""Day1_retention"" FROM (SELECT ""event_date"" AS ""install_dt"",""player_id"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lddt"" FROM (SELECT DISTINCT ""player_id"",""event_date"" FROM ""activity"") AS ""t"") AS ""t"" WHERE ""rn""=1 GROUP BY ""install_dt"""
213,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""install_dt""+1=""b"".""event_date"" GROUP BY ""a"".""install_dt"""
214,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(""back"")/SUM(""installs""), 2) AS ""day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"",CASE WHEN MIN(""event_date"") OVER (PARTITION BY ""player_id"")=""event_date"" THEN 1 ELSE 0 END AS ""installs"",CASE WHEN (MIN(""event_date"") OVER (PARTITION BY ""player_id""))+1=""event_date"" THEN 1 ELSE 0 END AS ""back"" FROM ""activity"") AS ""t"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
215,"WITH ""indiv_install"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1), ""next_login"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""Activity""), ""retained_people"" AS (SELECT ""player_id"",""event_date"" FROM ""next_login"" WHERE ""next_login"" - INTERVAL '1 DAY'=""event_date"" AND ROW(""player_id"",""event_date"") IN (SELECT * FROM ""indiv_install"")), ""retained"" AS (SELECT ""event_date"",COUNT(DISTINCT ""player_id"") AS ""retained_1day"" FROM ""retained_people"" GROUP BY 1), ""installed"" AS (SELECT ""install_date"",COUNT(""player_id"") AS ""installs"" FROM ""indiv_install"" GROUP BY 1) SELECT ""i"".""install_date"" AS ""install_dt"",""i"".""installs"",ROUND(COALESCE(""r"".""retained_1day"", 0)/""i"".""installs"", 2) AS ""Day1_retention"" FROM ""installed"" AS ""i"" LEFT JOIN ""retained"" AS ""r"" ON ""i"".""install_date""=""r"".""event_date"""
216,"WITH ""t"" (""player_id"", ""minlogindate"") AS (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") SELECT ""t"".""minlogindate"" AS ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NOT NULL THEN 1.00 ELSE 0.00 END)/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""minlogindate""=""a"".""event_date"" + INTERVAL '-1 DAY' GROUP BY ""t"".""minlogindate"""
217,"WITH ""CTE1"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""installs"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity"") AS ""sub"" WHERE ""ranking""=1 GROUP BY ""event_date""), ""CTE2"" AS (SELECT ""event_date"",COUNT(DISTINCT ""player_id"") AS ""cnt_logged_back_next_day"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_lead"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity"") AS ""sub"" WHERE ""event_date_lead"" - ""event_date""=1 AND ""ranking""=1 GROUP BY ""event_date"") SELECT ""d1"".""event_date"" AS ""install_dt"",""d1"".""installs"",ROUND(COALESCE(""d2"".""cnt_logged_back_next_day"", 0)/""d1"".""installs"", 2) AS ""Day1_retention"" FROM ""CTE1"" AS ""d1"" LEFT JOIN ""CTE2"" AS ""d2"" ON ""d1"".""event_date""=""d2"".""event_date"""
218,"SELECT ""t1"".""install_date"" AS ""install_dt"",COUNT(""t1"".""install_date"") AS ""installs"",ROUND(COUNT(""t2"".""event_date"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1) AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""install_date"" + INTERVAL '1 DAY'=""t2"".""event_date"" AND ""t1"".""player_id""=""t2"".""player_id"" GROUP BY 1 ORDER BY 1"
219,"SELECT ""install_dt"",COUNT(""b"".""player_id"") AS ""installs"",ROUND(COALESCE(SUM(""retention_ind"")/COUNT(""player_id""), 0), 2) AS ""day1_retention"" FROM (SELECT ""a"".""player_id"",""a"".""install_dt"",CASE WHEN ""b"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END AS ""retention_ind"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""install_dt"" + INTERVAL '1 DAY'=""b"".""event_date"") AS ""b"" GROUP BY 1"
220,"WITH ""cte1"" AS (SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"" FROM (SELECT ""event_date"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""activity"") AS ""tmp"" WHERE ""row_num""=1 GROUP BY 1), ""cte2"" AS (SELECT ""a"".""install_dt"",SUM(CASE WHEN ""b"".""event_date"" - INTERVAL '1 DAY'=""a"".""install_dt"" THEN 1 ELSE 0 END) AS ""day1retention"" FROM (SELECT ""event_date"" AS ""install_dt"",""player_id"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""activity"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" WHERE ""a"".""row_num""=1 GROUP BY 1) SELECT ""a"".""install_dt"",""a"".""installs"",ROUND(""b"".""day1retention""/""a"".""installs"", 2) AS ""Day1_retention"" FROM ""cte1"" AS ""a"" JOIN ""cte2"" AS ""b"" ON ""a"".""install_dt""=""b"".""install_dt"""
221,"WITH ""Retention"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",CASE WHEN LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""day1retention"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""day1retention"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""Retention"" WHERE ""row_num""=1 GROUP BY ""event_date"""
222,"SELECT ""first_log_per_player"".""event_date"" AS ""install_dt"",COUNT(""first_log_per_player"".""player_id"") AS ""installs"",ROUND(COUNT(""activity"".""player_id"")/COUNT(""first_log_per_player"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""first_log_per_player"" LEFT JOIN ""activity"" ON ""first_log_per_player"".""player_id""=""activity"".""player_id"" AND ""first_log_per_player"".""event_date""+1=""activity"".""event_date"" GROUP BY ""first_log_per_player"".""event_date"""
223,"WITH ""Day1"" AS (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""RowOrdered"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"")-1 AS ""ComDate"" FROM ""Activity"") AS ""Ordered"" WHERE ""RowOrdered""=1), ""Day1R"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""R"" FROM ""Day1"" WHERE ""event_date""=""ComDate"" GROUP BY ""event_date""), ""Day1A"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""A"" FROM ""Day1"" GROUP BY ""event_date"") SELECT ""Day1A"".""event_date"" AS ""install_dt"",""A"" AS ""installs"",ROUND(CASE WHEN ""R""/""A"" IS NULL THEN 0 ELSE ""R""/""A"" END, 2) AS ""Day1_retention"" FROM ""Day1A"" LEFT JOIN ""Day1R"" ON ""Day1A"".""event_date""=""Day1R"".""event_date"" ORDER BY ""Day1A"".""event_date"""
224,"SELECT ""p1"".""first_login"" AS ""install_dt"",""p1"".""installs"",ROUND(""p2"".""retained""/""p1"".""installs"", 2) AS ""Day1_retention"" FROM (SELECT ""first_login"",COUNT(""player_id"") AS ""installs"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" GROUP BY ""first_login"") AS ""p1"" JOIN (SELECT ""t1"".""first_login"",COUNT(""t2"".""player_id"") AS ""retained"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1 GROUP BY ""t1"".""first_login"") AS ""p2"" ON ""p1"".""first_login""=""p2"".""first_login"""
225,"ERROR: mysql parse error: line 1 column 84 near "") select a.install_dt, count(distinct a.player_id) as installs, round(1.00 * count( distinct b.player_id) / count(distinct a.player_id), 2) as Day1_retention from cte1 a left join activity b on a.player_id = b.player_id and b.event_date-1 = a.install_dt group by a.install_dt "" "
226,"WITH ""cte"" AS (SELECT MIN(""event_date"") AS ""install_dt"",""player_id"" FROM ""Activity"" GROUP BY 2) SELECT ""install_dt"",COUNT(""a1"".""player_id"") AS ""installs"",ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""install_dt""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY 1"
227,"WITH ""install_activity"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY ""player_id""), ""count_retention"" AS (SELECT ""iact"".""install_date"" AS ""install_date"",COUNT(""act"".""player_id"") AS ""cnt"" FROM ""Activity"" AS ""act"" JOIN ""install_activity"" AS ""iact"" ON ""act"".""player_id""=""iact"".""player_id"" AND ""act"".""event_date""=""iact"".""install_date"" + INTERVAL '1 DAY' GROUP BY ""install_date"") SELECT ""ia"".""install_date"" AS ""install_dt"",COUNT(""ia"".""install_date"") AS ""installs"",ROUND(COALESCE(""cr"".""cnt"", 0)/COUNT(""ia"".""install_date""), 2) AS ""Day1_retention"" FROM ""install_activity"" AS ""ia"" LEFT JOIN ""count_retention"" AS ""cr"" ON ""ia"".""install_date""=""cr"".""install_date"" GROUP BY ""install_dt"""
228,"WITH ""activity1"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") SELECT ""D1"" AS ""install_dt"",COUNT(""D1"") AS ""installs"",ROUND(COUNT(""D2"")/COUNT(""D1""), 2) AS ""Day1_retention"" FROM (SELECT ""a"".""player_id"",""a"".""event_date"" AS ""D1"",""b"".""event_date"" AS ""D2"" FROM ""activity1"" AS ""a"" LEFT JOIN ""activity1"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""event_date""=1 WHERE ""a"".""rnk""=1) AS ""c"" GROUP BY 1"
229,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""i"".""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_dt""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_dt""=""a"".""event_date"" + INTERVAL '-1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY 1 ORDER BY 1"
230,"WITH ""cte"" AS (SELECT DISTINCT ""player_id"",FIRST_VALUE(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_date"" FROM ""activity""), ""cte2"" AS (SELECT ""cte"".*,CASE WHEN ""a"".""event_date"" THEN 1 ELSE 0 END AS ""retension"" FROM ""cte"" LEFT JOIN ""activity"" AS ""a"" ON ""cte"".""player_id""=""a"".""player_id"" AND ""cte"".""install_date""=""a"".""event_date"" - INTERVAL '1 DAY') SELECT ""install_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""retension"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""cte2"" GROUP BY ""install_date"""
231,"WITH ""cte"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""RK"" FROM ""activity"") SELECT DISTINCT ""c"".""min_dt"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(""date_1"")/COUNT(1), 2) AS ""day1_retention"" FROM ((SELECT ""a"".""player_id"",""a"".""min_dt"",""b"".""sec_dt"",CASE WHEN ABS(""a"".""min_dt"" - ""b"".""sec_dt"")=1 THEN 1 ELSE 0 END AS ""date_1"" FROM (SELECT DISTINCT ""player_id"",""event_date"" AS ""min_dt"" FROM ""cte"" WHERE ""RK""=1) AS ""a"" LEFT JOIN (SELECT DISTINCT ""player_id"",""event_date"" AS ""sec_dt"" FROM ""cte"" WHERE ""RK""=2) AS ""b"" ON ""a"".""player_id""=""b"".""player_id"")) AS ""c"" GROUP BY 1"
232,"WITH ""t"" (""player_id"", ""minlogindate"") AS (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") SELECT ""t"".""minlogindate"" AS ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NOT NULL THEN 1.00 ELSE 0.00 END)/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""minlogindate""=""a"".""event_date"" + INTERVAL '-1 DAY' GROUP BY ""t"".""minlogindate"""
233,"ERROR: mysql parse error: line 1 column 346 near ""InstallTbl2 LEFT JOIN Activity ON InstallTbl2.retention_dt = Activity.event_date AND InstallTbl2.player_id = Activity.player_id ) Group By install_dt "" "
234,"WITH ""first_day"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"" FROM ""activity"" GROUP BY 1,2) SELECT ""f"".""event_date"" AS ""install_dt"",COUNT(""f"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""player_id"")/COUNT(""f"".""player_id""), 2) AS ""day1_retention"" FROM ""first_day"" AS ""f"" LEFT JOIN ""activity"" AS ""a"" ON ""f"".""event_date""=""a"".""event_date"" - INTERVAL '1 DAY' AND ""f"".""player_id""=""a"".""player_id"" WHERE ""f"".""date_rank""=1 GROUP BY 1"
235,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity""), ""temp1"" AS (SELECT ""t"".""player_id"",""t"".""event_date"" AS ""install_dt"" FROM ""temp"" AS ""t"" JOIN ""temp"" AS ""u"" ON ""t"".""player_id""=""u"".""player_id"" AND ""u"".""event_date"" - ""t"".""event_date""=1 WHERE ""t"".""ranking""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(""temp"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""temp1"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""temp"".""player_id""), 2) AS ""Day1_retention"" FROM ""temp"" LEFT JOIN ""temp1"" ON ""temp"".""event_date""=""temp1"".""install_dt"" AND ""temp1"".""player_id""=""temp"".""player_id"" WHERE ""temp"".""ranking""=1 GROUP BY ""event_date"""
236,"WITH ""T1"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""Activity"") SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date""=""install_dt""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""T1"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
237,"WITH ""prep"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextDay"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") SELECT ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""nextDay"" IS NOT NULL AND ""nextDay"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""prep"" WHERE ""rn""=1 GROUP BY ""install_dt"""
238,"SELECT ""first_login"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COALESCE(AVG(""second_login"" - ""first_login""=1), 0), 2) AS ""Day1_retention"" FROM (SELECT *,(SELECT MIN(""event_date"") FROM ""Activity"" WHERE ""player_id""=""tmp"".""player_id"" AND ""event_date""!=""tmp"".""first_login"") AS ""second_login"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""tmp"") AS ""tmp2"" GROUP BY ""first_login"""
239,"WITH ""ranking"" AS (SELECT ""player_id"",""device_id"",""event_date"",""games_played"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""number"" FROM ""Activity""), ""install_table"" AS (SELECT ""event_date"",COUNT(1) AS ""inst"" FROM ""ranking"" WHERE ""number""=1 GROUP BY ""event_date""), ""tab_day1"" AS (SELECT ""player_id"",""event_date"",""installs"",""nexts"",""nexts""=""event_date"" AS ""1_day"" FROM (SELECT ""player_id"",""event_date"",LAG(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""installs"",LAG(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") + INTERVAL '1 DAY' AS ""nexts"",""number"" FROM ""ranking"") AS ""tab1"" WHERE ""number""=2), ""tab_day1_group"" AS (SELECT ""installs"",COUNT(1) AS ""day1"" FROM ""tab_day1"" WHERE ""1_day""=1 GROUP BY ""installs"") SELECT ""event_date"" AS ""install_dt"",""inst"" AS ""installs"",ROUND((COALESCE(""day1"", 0)*1)/(""inst""), 2) AS ""Day1_retention"" FROM ""install_table"" LEFT JOIN ""tab_day1_group"" ON ""event_date""=""installs"""
240,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY 1), ""day1"" AS (SELECT ""f"".""player_id"",""f"".""install_date"" FROM ""first_login"" AS ""f"" JOIN ""activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""f"".""install_date""=1) SELECT ""f"".""install_date"" AS ""install_dt"",COUNT(""f"".""player_id"") AS ""installs"",ROUND(COUNT(""day1"".""player_id"")/COUNT(""f"".""player_id""), 2) AS ""Day1_retention"" FROM ""first_login"" AS ""f"" LEFT JOIN ""day1"" ON ""day1"".""player_id""=""f"".""player_id"" AND ""f"".""install_date""=""day1"".""install_date"" GROUP BY 1"
241,"WITH ""cte1"" AS (SELECT * FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"" FROM ""activity"") AS ""t"" WHERE ""rnk""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",(ROUND(SUM(CASE WHEN ""event_date""=""next_day""-1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2)) AS ""Day1_retention"" FROM ""cte1"" GROUP BY 1"
242,"WITH ""inst"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY 1), ""retention"" AS (SELECT ""i"".""player_id"",""i"".""install_date"" FROM ""inst"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date""-""i"".""install_date""=1) SELECT ""l"".""install_date"" AS ""install_dt"",COUNT(DISTINCT ""l"".""player_id"") AS ""installs"",ROUND((COUNT(DISTINCT ""r"".""player_id"")/COUNT(DISTINCT ""l"".""player_id"")), 2) AS ""Day1_retention"" FROM ""inst"" AS ""l"" LEFT JOIN ""retention"" AS ""r"" ON ""l"".""player_id""=""r"".""player_id"" GROUP BY 1"
243,"WITH ""cte1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""player_id"",""install_dt"",(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 'yes' ELSE 'no' END) AS ""returned"" FROM ""cte1"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""returned""='yes')/COUNT(""player_id""), 2) AS ""day1_retention"" FROM ""cte2"" GROUP BY ""install_dt"""
244,"WITH ""fist_log"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1) SELECT ""sdate"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(SUM(CASE WHEN ""ndate"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""f"".""player_id"",""f"".""event_date"" AS ""sdate"",""a"".""event_date"" AS ""ndate"" FROM ""fist_log"" AS ""f"" LEFT JOIN ""Activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" AND ""f"".""event_date"" - ""a"".""event_date""=-1) AS ""t2"" GROUP BY ""sdate"" ORDER BY ""sdate"""
245,"SELECT ""t1"".""install_date"" AS ""install_dt"",COUNT(""t1"".""install_date"") AS ""installs"",ROUND(COUNT(""t2"".""event_date"")/COUNT(1), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""Activity"" GROUP BY 1) AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""install_date"" + INTERVAL '1 DAY'=""t2"".""event_date"" AND ""t1"".""player_id""=""t2"".""player_id"" GROUP BY 1 ORDER BY 1"
246,"SELECT ""t"".""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(COUNT(""t"".""next_day"")/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""t1"".""player_id"",""install_dt"",""t2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""install_dt""=""t2"".""event_date"" - INTERVAL '1 DAY') AS ""t"" GROUP BY ""install_dt"""
247,"SELECT ""k"".""install_dt"",COUNT(""k"".""player_id"") AS ""installs"",ROUND(SUM(""a"".""player_id"" IS NOT NULL)/COUNT(""k"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT DISTINCT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"" FROM ""Activity"") AS ""k"" LEFT JOIN ""Activity"" AS ""a"" ON ""k"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""k"".""install_dt""=1 GROUP BY ""install_dt"""
248,"WITH ""C"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(DISTINCT ""C"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""C"".""player_id""), 2) AS ""Day1_retention"" FROM ""C"" JOIN ""Activity"" AS ""a"" ON ""C"".""player_id""=""a"".""player_id"" GROUP BY ""install_dt"""
249,"SELECT ""install_dt"",COUNT(DISTINCT ""sub"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""event_date"" IS NULL THEN 0 ELSE 1 END)/COUNT(DISTINCT ""sub"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""Activity"") AS ""sub"" LEFT JOIN ""Activity"" AS ""a"" ON ""sub"".""event_date"" + INTERVAL '1 DAY'=""a"".""event_date"" AND ""sub"".""player_id""=""a"".""player_id"" WHERE ""sub"".""event_date""=""install_dt"" GROUP BY ""install_dt"""
250,"WITH ""inst"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY 1), ""retention"" AS (SELECT ""i"".""player_id"",""i"".""install_date"" FROM ""inst"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date""-""i"".""install_date""=1) SELECT ""l"".""install_date"" AS ""install_dt"",COUNT(DISTINCT ""l"".""player_id"") AS ""installs"",ROUND((COUNT(DISTINCT ""r"".""player_id"")/COUNT(DISTINCT ""l"".""player_id"")), 2) AS ""Day1_retention"" FROM ""inst"" AS ""l"" LEFT JOIN ""retention"" AS ""r"" ON ""l"".""player_id""=""r"".""player_id"" GROUP BY 1"
251,"WITH ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""retain"" AS (SELECT ""player_id"",""install_dt"",(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 'Y' ELSE 'N' END) AS ""retain"" FROM ""install_date"") SELECT ""install_dt"",COUNT(""install_dt"") AS ""installs"",ROUND(SUM(CASE WHEN ""retain""='Y' THEN 1 ELSE 0 END)/COUNT(""install_dt""), 2) AS ""Day1_retention"" FROM ""retain"" GROUP BY ""install_dt"""
252,"WITH ""cte1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""player_id"",""install_dt"",(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 'yes' ELSE 'no' END) AS ""returned"" FROM ""cte1"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""returned""='yes')/COUNT(""player_id""), 2) AS ""day1_retention"" FROM ""cte2"" GROUP BY ""install_dt"""
253,"WITH ""install"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 1 ELSE 0 END)/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""install"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
254,"WITH ""Install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""T1"".""install_dt"",ROUND(COUNT(""T1"".""player_id""), 2) AS ""installs"",ROUND(COUNT(""T2"".""event_date"")/COUNT(""install_dt""), 2) AS ""Day1_retention"" FROM ""Install_date"" AS ""T1"" LEFT JOIN ""Activity"" AS ""T2"" ON ""T1"".""player_id""=""T2"".""player_id"" AND ""T1"".""install_dt""+1=""T2"".""event_date"" GROUP BY ""T1"".""install_dt"" ORDER BY ""T1"".""install_dt"""
255,"WITH ""installs"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) SELECT ""i"".""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(COUNT(""a"".""event_date"")/COUNT(""i"".""install_dt""), 2) AS ""Day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""install_dt""=""a"".""event_date"" + INTERVAL '-1 DAY' AND ""i"".""player_id""=""a"".""player_id"" GROUP BY 1"
256,"SELECT ""event_date"" AS ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ROW(""event_date"" + INTERVAL '1 DAY',""a"".""player_id"") IN (SELECT ""event_date"",""player_id"" FROM ""Activity"") THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""Activity"" AS ""a"" WHERE ROW(""a"".""player_id"",""a"".""event_date"") IN (SELECT DISTINCT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") GROUP BY ""event_date"""
257,"WITH ""tmp"" AS (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") SELECT * FROM (SELECT ""event_date"" AS ""install_dt"",SUM(CASE WHEN ROW(""player_id"",""event_date"") IN (SELECT * FROM ""tmp"") THEN 1 ELSE 0 END) AS ""installs"",COALESCE(ROUND(SUM(CASE WHEN ROW(""player_id"",""event_date"") IN (SELECT * FROM ""tmp"") AND ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",""event_date"" + INTERVAL '-1 DAY' FROM ""Activity"") THEN 1 ELSE 0 END)*1.0/SUM(CASE WHEN ROW(""player_id"",""event_date"") IN (SELECT * FROM ""tmp"") THEN 1 ELSE 0 END), 2), 0) AS ""Day1_retention"" FROM ""Activity"" GROUP BY ""event_date"") AS ""t"" WHERE ""t"".""installs""!=0"
258,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""event_date"" - ""install_dt""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"" FROM ""activity"") AS ""i"" GROUP BY ""install_dt"""
259,"WITH ""install"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""installdate"" FROM ""activity"" GROUP BY 1) SELECT ""installdate"" AS ""install_dt"",COUNT(""i"".""player_Id"") AS ""installs"",ROUND(COALESCE(COUNT(""a"".""player_id""), 0)/COUNT(""i"".""player_Id""), 2) AS ""Day1_retention"" FROM ""install"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""event_date""=""installdate"" + INTERVAL '1 DAY' GROUP BY ""installdate"""
260,"SELECT ""A"".""event_date"" AS ""install_dt"",COUNT(""A"".""player_id"") AS ""installs"",ROUND(COUNT(""B"".""player_id"")/COUNT(""A"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" AND ""A"".""event_date""+1=""B"".""event_Date"" GROUP BY ""A"".""event_date"""
261,"SELECT ""a1"".""mindate"" AS ""install_dt"",COUNT(DISTINCT ""a1"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""mindate"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a2"".""event_date"" - ""a1"".""mindate""=1 AND ""a1"".""player_id""=""a2"".""player_id"" GROUP BY ""a1"".""mindate"""
262,"WITH ""Date_cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id""), ""Retention_cte"" AS (SELECT ""a"".""player_id"" FROM ""Activity"" AS ""a"" JOIN ""Date_cte"" AS ""d"" ON ""a"".""player_id""=""d"".""player_id"" AND ""a"".""event_date""=""d"".""install_dt"" + INTERVAL '1 DAY') SELECT ""d"".""install_dt"",COUNT(""d"".""player_id"") AS ""installs"",ROUND((1.0*COUNT(""r"".""player_id""))/COUNT(""d"".""player_id""), 2) AS ""Day1_retention"" FROM ""Date_cte"" AS ""d"" LEFT JOIN ""Retention_cte"" AS ""r"" ON ""d"".""player_id""=""r"".""player_id"" GROUP BY ""d"".""install_dt"" ORDER BY ""d"".""install_dt"""
263,"WITH ""installdt"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id""), ""day1"" AS (SELECT ""Activity"".""player_id"",""installdt"".""install_dt"" FROM ""Activity"" JOIN ""installdt"" ON ""Activity"".""player_id""=""installdt"".""player_id"" AND ""Activity"".""event_date"" - INTERVAL '1 DAY'=""installdt"".""install_dt"") SELECT ""installdt"".""install_dt"",COUNT(""installdt"".""player_id"") AS ""installs"",ROUND(COUNT(""day1"".""player_id"")/COUNT(""installdt"".""player_id""), 2) AS ""Day1_retention"" FROM ""installdt"" LEFT JOIN ""day1"" ON ""day1"".""install_dt""=""installdt"".""install_dt"" AND ""day1"".""player_id""=""installdt"".""player_id"" GROUP BY ""installdt"".""install_dt"""
264,"WITH ""I"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1), ""R"" AS (SELECT ""event_date"",COUNT(1) AS ""retention"" FROM (SELECT ""a"".* FROM (""I"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date"" - ""b"".""event_date""=-1) AS ""c"" GROUP BY 1) SELECT ""a"".""event_date"" AS ""install_dt"",""a"".""cnt"" AS ""installs"",ROUND(COALESCE(""b"".""retention"", 0)/""a"".""cnt"", 2) AS ""Day1_retention"" FROM (SELECT ""event_date"",COUNT(1) AS ""cnt"" FROM ""I"" GROUP BY 1) AS ""a"" LEFT JOIN ""R"" AS ""b"" ON ""a"".""event_date""=""b"".""event_date"""
265,"WITH ""cte1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""c1"".""player_id"",""c1"".""event_date"" FROM ""cte1"" AS ""c1"" JOIN ""Activity"" AS ""a1"" ON ""c1"".""player_id""=""a1"".""player_id"" WHERE ""c1"".""event_date""=""a1"".""event_date"" AND (SELECT ""a2"".""event_date"" FROM ""Activity"" AS ""a2"" WHERE ""a2"".""event_date""=""c1"".""event_date""+1 AND ""a2"".""player_id""=""c1"".""player_id"") IS NOT NULL), ""cte3"" AS (SELECT ""c1"".""event_date"" AS ""install_dt"",COUNT(""c1"".""player_id"") AS ""installs"",ROUND((SELECT COUNT(""c2"".""player_id"") FROM ""cte2"" AS ""c2"" WHERE ""c2"".""event_date""=""c1"".""event_date"")/COUNT(""c1"".""player_id""), 2) AS ""Day1_retention"" FROM ""cte1"" AS ""c1"" GROUP BY ""c1"".""event_date"") SELECT * FROM ""cte3"""
266,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""a2"".""player_id"",""a2"".""install_dt"" FROM ""activity"" AS ""a1"" JOIN ""cte"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""=""a2"".""install_dt"" + INTERVAL '1 DAY') SELECT ""c1"".""install_dt"",COUNT(""c1"".""install_dt"") AS ""installs"",ROUND(SUM(CASE WHEN ""c2"".""install_dt"" IS NULL THEN 0 ELSE 1 END)/COUNT(""c1"".""install_dt""), 2) AS ""Day1_retention"" FROM ""cte"" AS ""c1"" LEFT JOIN ""cte2"" AS ""c2"" ON ""c1"".""install_dt""=""c2"".""install_dt"" AND ""c1"".""player_id""=""c2"".""player_id"" GROUP BY ""c1"".""install_dt"""
267,"SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY 1) AS ""t1"" GROUP BY 1"
268,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk1"",COALESCE(LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date""), ""event_date"") AS ""lead_date"" FROM ""activity""), ""cte2"" AS (SELECT ""player_id"",""event_date"",""lead_date"",CASE WHEN (""lead_date""-""event_date"")=1 THEN 1 ELSE 0 END AS ""day_ret"" FROM ""cte"" WHERE ""rnk1""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""day_ret"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""cte2"" GROUP BY ""event_date"""
269,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",""installs"",ROUND(COALESCE(""retention""/""installs"", 0), 2) AS ""Day1_retention"" FROM (SELECT ""event_date"",SUM(CASE WHEN ""rnk""=1 THEN 1 ELSE 0 END) AS ""installs"",SUM(CASE WHEN ""rnk""=1 AND ""next_date""=""event_date"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END) AS ""retention"" FROM ""cte"" WHERE ""rnk""=1 GROUP BY ""event_date"") AS ""t"""
270,"SELECT ""a3"".""event_date"" - INTERVAL '1 DAY' AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COUNT(""device_id"")/COUNT(1), 2) AS ""day1_retention"" FROM ""Activity"" AS ""a2"" RIGHT JOIN (SELECT ""a1"".""player_id"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""event_date"" FROM ""Activity"" AS ""a1"" GROUP BY ""a1"".""player_id"") AS ""a3"" ON ""a2"".""player_id""=""a3"".""player_id"" AND ""a2"".""event_date""=""a3"".""event_date"" GROUP BY ""a3"".""event_date"""
271,"WITH ""installs"" AS (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") AS ""a"" WHERE ""rn""=1), ""install_cnt"" AS (SELECT ""event_date"",COUNT(1) FROM ""installs"" GROUP BY 1) SELECT ""i"".""event_date"" AS ""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(COALESCE(SUM((""a"".""player_id"" IS NOT NULL))/COUNT(""i"".""player_id""), 0), 2) AS ""day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON (""i"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""i"".""event_date""=1) GROUP BY 1"
272,"SELECT ""A"".""event_date"" AS ""install_dt"",COUNT(""A"".""player_id"") AS ""installs"",ROUND(COUNT(""B"".""player_id"")/COUNT(""A"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" AND ""A"".""event_date""+1=""B"".""event_Date"" GROUP BY ""A"".""event_date"""
273,"SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""install_dt""+1) AS ""t"" GROUP BY ""install_dt"""
274,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",""installs"",ROUND(COALESCE(""retention""/""installs"", 0), 2) AS ""Day1_retention"" FROM (SELECT ""event_date"",SUM(CASE WHEN ""rnk""=1 THEN 1 ELSE 0 END) AS ""installs"",SUM(CASE WHEN ""rnk""=1 AND ""next_date""=""event_date"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END) AS ""retention"" FROM ""cte"" WHERE ""rnk""=1 GROUP BY ""event_date"") AS ""t"""
275,"WITH ""tb1"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM ""activity""), ""tb2"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""install"" FROM ""tb1"" WHERE ""rk""=1 GROUP BY ""event_date""), ""tb3"" AS (SELECT ""a"".""event_date"",COUNT(""a"".""player_id"") AS ""ret"" FROM (""tb1"" AS ""a"") JOIN ""tb1"" AS ""b"" WHERE ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"" AND ""a"".""rk""=1 GROUP BY ""a"".""event_date"") SELECT ""tb2"".""event_date"" AS ""install_dt"",""install"" AS ""installs"",ROUND(COALESCE(""ret""/""install"", 0), 2) AS ""Day1_retention"" FROM ""tb2"" LEFT JOIN ""tb3"" ON ""tb2"".""event_date""=""tb3"".""event_date"""
276,"WITH ""cte"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""next_date""=""event_date""+1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""cte"" WHERE ""rnk""=1 GROUP BY 1 ORDER BY 1"
277,"WITH ""installs"" AS (SELECT * FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") AS ""a"" WHERE ""rn""=1), ""install_cnt"" AS (SELECT ""event_date"",COUNT(1) FROM ""installs"" GROUP BY 1) SELECT ""i"".""event_date"" AS ""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(COALESCE(SUM((""a"".""player_id"" IS NOT NULL))/COUNT(""i"".""player_id""), 0), 2) AS ""day1_retention"" FROM ""installs"" AS ""i"" LEFT JOIN ""activity"" AS ""a"" ON (""i"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""i"".""event_date""=1) GROUP BY 1"
278,"WITH ""INSTALL_DATE"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id""), ""INSTALLS"" AS (SELECT ""event_date"",COUNT(""player_id"") AS ""installs"" FROM ""INSTALL_DATE"" GROUP BY ""event_date""), ""RETENTION"" AS (SELECT ""player_id"",""event_date"" FROM ""INSTALL_DATE"" WHERE ROW(""player_id"",""event_date""+1) IN (SELECT ""player_id"",""event_date"" FROM ""Activity"")) SELECT ""T1"".""event_date"" AS ""install_dt"",""installs"",ROUND(COUNT(""T2"".""player_id"")/""installs"", 2) AS ""Day1_retention"" FROM ""INSTALLS"" AS ""T1"" LEFT JOIN ""RETENTION"" AS ""T2"" ON ""T1"".""event_date""=""T2"".""event_date"" GROUP BY ""T1"".""event_date"""
279,"WITH ""t"" (""player_id"", ""minlogindate"") AS (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") SELECT ""t"".""minlogindate"" AS ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NOT NULL THEN 1.00 ELSE 0.00 END)/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""minlogindate""=""a"".""event_date"" + INTERVAL '-1 DAY' GROUP BY ""t"".""minlogindate"""
280,"WITH ""installTable"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""i"".""install_dt"",COUNT(""i"".""player_id"") AS ""installs"",ROUND(SUM(""a"".""player_id"" IS NOT NULL)/COUNT(""i"".""player_id""), 2) AS ""Day1_retention"" FROM ""installTable"" AS ""i"" LEFT JOIN ""Activity"" AS ""a"" ON ""i"".""player_id""=""a"".""player_id"" AND ""i"".""install_dt""+1=""a"".""event_date"" GROUP BY ""i"".""install_dt"""
281,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") SELECT ""event_date"" AS ""install_dt"",""installs"",ROUND(COALESCE(""retention""/""installs"", 0), 2) AS ""Day1_retention"" FROM (SELECT ""event_date"",SUM(CASE WHEN ""rnk""=1 THEN 1 ELSE 0 END) AS ""installs"",SUM(CASE WHEN ""rnk""=1 AND ""next_date""=""event_date"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END) AS ""retention"" FROM ""cte"" WHERE ""rnk""=1 GROUP BY ""event_date"") AS ""t"""
282,"SELECT ""t"".""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(COUNT(""t"".""next_day"")/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""a1"".""player_id"",""a1"".""install_dt"",""a2"".""event_date"" AS ""next_day"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""install_dt""=1) AS ""t"" GROUP BY ""t"".""install_dt"""
283,"WITH ""a"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") SELECT ""a"".""event_date"" AS ""install_dt"",COUNT(DISTINCT ""a"".""player_id"") AS ""installs"",ROUND(COUNT(DISTINCT ""a1"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""day1_retention"" FROM ""a"" LEFT JOIN ""activity"" AS ""a1"" ON ""a"".""event_date""+1=""a1"".""event_date"" AND ""a"".""player_id""=""a1"".""player_id"" GROUP BY ""a"".""event_date"""
284,"WITH ""cte1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""player_id"",""install_dt"",(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 'yes' ELSE 'no' END) AS ""returned"" FROM ""cte1"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""returned""='yes')/COUNT(""player_id""), 2) AS ""day1_retention"" FROM ""cte2"" GROUP BY ""install_dt"""
285,"SELECT ""install_dt"",""installs"",ROUND(SUM(CASE WHEN ""temp2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/""installs"", 2) AS ""Day1_retention"" FROM (SELECT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id"") AS ""temp"" GROUP BY ""install_dt"") AS ""temp1"" LEFT JOIN (SELECT ""a"".""event_date"" AS ""event_date"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"") AS ""temp2"" ON ""temp1"".""install_dt""=""temp2"".""event_date"" GROUP BY ""install_dt"",""installs"""
286,"WITH ""cte1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""player_id"",""install_dt"",(CASE WHEN ROW(""player_id"",""install_dt"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"") THEN 'yes' ELSE 'no' END) AS ""returned"" FROM ""cte1"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""returned""='yes' THEN 1 ELSE 0 END)/COUNT(""player_id""), 2) AS ""day1_retention"" FROM ""cte2"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
287,"WITH ""installed"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_date"" FROM ""activity"" GROUP BY 1), ""retention"" AS (SELECT ""install_date"",""a1"".""player_id"" AS ""first_day"",""a2"".""player_id"" AS ""next_day"" FROM ""installed"" AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""install_date""+1=""a2"".""event_date"") SELECT ""install_date"" AS ""install_dt"",COUNT(""first_day"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""first_day""), 2) AS ""Day1_retention"" FROM ""retention"" GROUP BY 1"
288,"WITH ""t1"" AS (SELECT ""a"".""player_id"",MIN(""a"".""event_date"") AS ""install_dt"",CASE WHEN MIN(""a"".""event_date"")+1 IN (SELECT ""a1"".""event_date"" FROM ""Activity"" AS ""a1"" WHERE ""a1"".""player_id""=""a"".""player_id"") THEN 1 ELSE 0 END AS ""sec_ind"" FROM ""Activity"" AS ""a"" GROUP BY ""player_id"") SELECT ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""sec_ind"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM ""t1"" GROUP BY ""install_dt"" ORDER BY ""install_dt"""
289,"WITH ""sorting"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""day_num"",(LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"")-""event_date"") AS ""next_login_gap"" FROM ""Activity""), ""coming_back"" AS (SELECT ""event_date"",COUNT(1) AS ""returned"" FROM ""sorting"" WHERE ""day_num""=1 AND ""next_login_gap""=1 GROUP BY 1) SELECT ""s"".""event_date"" AS ""install_dt"",COUNT(1) AS ""installs"",ROUND(COALESCE(""c"".""returned""/COUNT(1), 0), 2) AS ""Day1_retention"" FROM ""sorting"" AS ""s"" LEFT JOIN ""coming_back"" AS ""c"" ON ""s"".""event_date""=""c"".""event_date"" WHERE ""s"".""day_num""=1 GROUP BY 1 ORDER BY 1"
290,"SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ROW(""player_id"",""event_date""+1) IN (SELECT ""player_id"",""event_date"" FROM ""Activity"") THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""Day1_retention"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") GROUP BY ""event_date"" ORDER BY ""event_date"""
291,"WITH ""t1"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""install_dt"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nxt"" FROM ""Activity"") SELECT DISTINCT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""nxt""=""install_dt""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t1"" WHERE ""rnk""=1 GROUP BY 1 ORDER BY 1"
292,"WITH ""t1"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""install_dt"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nxt"" FROM ""activity"") SELECT DISTINCT ""install_dt"",COUNT(DISTINCT ""player_id"") AS ""installs"",ROUND(SUM(CASE WHEN ""nxt""=""install_dt""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""Day1_retention"" FROM ""t1"" WHERE ""rk""=1 GROUP BY ""install_dt"" ORDER BY ""install_dt"""
293,"SELECT ""install_dt"",COUNT(""t"".""player_id"") AS ""installs"",ROUND(COUNT(""next_day"")/COUNT(""t"".""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""install_dt"",""b"".""player_id"",""a"".""event_date"" AS ""next_day"" FROM ""Activity"" AS ""a"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY 1) AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""install_dt""+1) AS ""t"" GROUP BY 1"
294,"WITH ""Activity"" AS (SELECT ""t1"".""player_id"",""t1"".""event_date"",CASE WHEN ""t2"".""event_date"" IS NULL THEN 0 ELSE 1 END AS ""d1r"" FROM ""Activity"" AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date""-""t1"".""event_date""=1) SELECT ""event_date"" AS ""install_dt"",COUNT(""player_id"") AS ""installs"",ROUND(SUM(""d1r"")/COUNT(""player_id""), 2) AS ""Day1_retention"" FROM (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",""d1r"" FROM ""Activity"") AS ""t"" WHERE ""rnk""=1 GROUP BY ""event_date"""
295,"WITH ""install_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""install_dt"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ""install_dt"",SUM(CASE WHEN ""i"".""install_dt""=""a"".""event_date"" THEN 1 ELSE 0 END) AS ""installs"",ROUND(SUM(CASE WHEN ""a"".""event_date""=""i"".""install_dt"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""i"".""install_dt""=""a"".""event_date"" THEN 1 ELSE 0 END), 2) AS ""Day1_retention"" FROM ""Activity"" AS ""a"" JOIN ""install_date"" AS ""i"" ON ""a"".""player_id""=""i"".""player_id"" GROUP BY ""install_dt"""
