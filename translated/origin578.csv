id,original query
1,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
2,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)*100/SUM(CASE WHEN ""answer_id"" IS NULL THEN 1 ELSE 0 END) AS ""show_cnt"" FROM ""survey_log"" WHERE ""action"" IN ('show','answer') GROUP BY ""question_id"") AS ""sub"" ORDER BY ""show_cnt"" DESC LIMIT 1"
3,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
4,"WITH ""temp"" AS (SELECT ""question_id"",COUNT(""answer_id""),COUNT(""action""),RANK() OVER (ORDER BY (COUNT(""answer_id"")/COUNT(""action"")) DESC) FROM ""survey_log"" GROUP BY 1 LIMIT 1) SELECT ""question_id"" AS ""survey_log"" FROM ""temp"""
5,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"" ORDER BY ""answer_rate"" DESC LIMIT 1"
6,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""fraction"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""asd"" ORDER BY ""fraction"" DESC LIMIT 1"
7,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(CASE WHEN ""action""='answer' THEN 1 END)/COUNT(CASE WHEN ""action""='show' OR ""action""='answer' THEN 1 END) DESC LIMIT 1"
8,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
9,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY 1 ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
10,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 END)/SUM(CASE WHEN ""action""='show' THEN 1 END) DESC LIMIT 1"
11,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
12,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') AS ""ratio"" FROM ""survey_log"" GROUP BY 1) AS ""f"" ORDER BY ""ratio"" DESC LIMIT 1"
13,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"" ORDER BY COUNT(1) DESC LIMIT 1"
14,"WITH ""temp"" AS (SELECT DISTINCT ""question_id"",COUNT(""answer_id"") OVER (PARTITION BY ""question_id"") AS ""ct"" FROM ""survey_log"") SELECT ""question_id"" AS ""survey_log"" FROM ""temp"" ORDER BY ""ct"" DESC LIMIT 1"
15,"WITH ""sub"" AS (SELECT ""sub_shows"".""question_id"",""sub_answers"".""answers""/""sub_shows"".""shows"" AS ""rate"" FROM (SELECT ""question_id"",COUNT(1) AS ""shows"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY 1) AS ""sub_shows"" JOIN (SELECT ""question_id"",COUNT(1) AS ""answers"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY 1) AS ""sub_answers"" ON ""sub_answers"".""question_id""=""sub_shows"".""question_id"" GROUP BY 1) SELECT ""sub"".""question_id"" AS ""survey_log"" FROM ""sub"" WHERE ""sub"".""rate""=(SELECT MAX(""rate"") FROM ""sub"") LIMIT 1"
16,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY ""count"" DESC) AS ""rank1"" FROM (SELECT ""question_id"",COUNT(""answer_id"") AS ""count"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""d"") AS ""d"" WHERE ""rank1""=1"
17,"SELECT ""QUESTION_ID"" AS ""SURVEY_LOG"" FROM ""SURVEY_LOG"" GROUP BY ""QUESTION_ID"" ORDER BY SUM(CASE WHEN ""ACTION""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""ACTION""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
18,"SELECT ""QUESTION_ID"" AS ""survey_log"" FROM ""SURVEY_LOG"" GROUP BY ""QUESTION_ID"" ORDER BY SUM(CASE WHEN ""ACTION""='ANSWER' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""ACTION""='SHOW' THEN 1 ELSE 0 END) DESC LIMIT 1"
19,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""action""='answer')/SUM(""action""='show') AS ""answer_rate"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""t"""
20,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') AS ""survey_rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""s"" ORDER BY ""survey_rate"" DESC LIMIT 1"
21,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(1) DESC LIMIT 1"
22,"WITH ""answered"" AS (SELECT ""question_id"",COUNT(1) AS ""num_answered"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id""), ""shown"" AS (SELECT ""question_id"",COUNT(1) AS ""num_shown"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""shown"".""question_id"",COALESCE(""num_answered""/""shown"".""num_shown"", 0) AS ""ans_rate"" FROM ""shown"" LEFT JOIN ""answered"" ON ""shown"".""question_id""=""answered"".""question_id"") AS ""compare"" ORDER BY ""ans_rate"" DESC LIMIT 1"
23,"WITH ""cases"" AS (SELECT ""question_id"",COUNT(CASE WHEN ""answer_id"" IS NOT NULL THEN ""question_id"" END) AS ""answered"",COUNT(CASE WHEN ""action""='show' THEN ""question_id"" END) AS ""shown"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT DISTINCT ""question_id"" AS ""survey_log"" FROM ""cases"" GROUP BY 1 ORDER BY MAX(""answered""/""shown"") DESC LIMIT 1"
24,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""rate"" DESC LIMIT 1"
25,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""num"" DESC LIMIT 1) AS ""a"""
26,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""id"") AS ""q_rate"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""a"""
27,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tbl"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
28,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(1) DESC) AS ""rnk"" FROM ""survey_log"" GROUP BY 1) AS ""TBL"" WHERE ""rnk""=1"
29,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",COUNT(CASE WHEN ""action""='answer' THEN ""action"" END)/COUNT(CASE WHEN ""action""='show' THEN ""action"" END) AS ""ratio"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""cte"""
30,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY 1 ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
31,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""temp1"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
32,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",""ans_count""/""ans_show_count"" AS ""highest_ans_rate"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_count"",SUM(CASE WHEN ""action""='show' OR ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_show_count"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""rate"" ORDER BY ""highest_ans_rate"" DESC) AS ""res"" LIMIT 1"
33,"SELECT ""tb"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""s"".""action"" IN ('answer') THEN 1 ELSE 0 END)/SUM(CASE WHEN ""s"".""action"" IN ('show') THEN 1 ELSE 0 END) AS ""ar"" FROM ""survey_log"" AS ""s"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""tb"""
34,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT DISTINCT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN 1 END) OVER (PARTITION BY ""question_id"") AS ""answered_times_per_question"" FROM ""survey_log"") AS ""t"" ORDER BY ""answered_times_per_question"" DESC LIMIT 1"
35,"WITH ""cte"" AS (SELECT ""question_id"",SUM(""action""='answer')/SUM(""action""='show') AS ""ratio"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) SELECT ""question_id"" AS ""survey_log"" FROM ""cte"""
36,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COALESCE(COUNT(""answer_id"")/COUNT(DISTINCT ""question_id""), 0) DESC LIMIT 1"
37,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
38,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_cnt"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""total_cnt"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tb"" ORDER BY (""ans_cnt""/""total_cnt"") DESC LIMIT 1"
39,"WITH ""CTE"" AS (SELECT ""question_id"",ROUND((1.0*SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END))/SUM(CASE WHEN ""action""='show' THEN 1 END), 2) AS ""ratio"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""CTE"" ORDER BY ""ratio"" DESC LIMIT 1"
40,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(CASE WHEN ""answer_id"" IS NOT NULL THEN ""id"" END)*1.0/COUNT(CASE WHEN ""action""='show' THEN ""id"" END) AS ""ratio"" FROM ""survey_log"" GROUP BY 1) AS ""a"" ORDER BY ""ratio"" DESC LIMIT 1"
41,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/COUNT(DISTINCT ""question_id"") DESC LIMIT 1"
42,"WITH ""cte"" AS (SELECT ""question_id"",SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY 2 DESC) SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" LIMIT 1"
43,"WITH ""cnt_ans"" AS (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1) AS ""rate"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM ""cnt_ans"" WHERE ""rate""=(SELECT MAX(""rate"") FROM ""cnt_ans"")"
44,"WITH ""tmp"" AS (SELECT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN ""answer_id"" ELSE NULL END)*100.0/COUNT(1) AS ""answer_rate"" FROM ""survey_log"" GROUP BY 1), ""tmp2"" AS (SELECT ""question_id"" AS ""survey_log"",DENSE_RANK() OVER (ORDER BY ""answer_rate"" DESC) AS ""ranks"" FROM ""tmp"") SELECT ""survey_log"" FROM ""tmp2"" WHERE ""ranks""=1 GROUP BY 1"
45,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tbl"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
46,"WITH ""answers"" AS (SELECT COUNT(CASE WHEN ""answer_id"" IS NOT NULL THEN ""answer_id"" END)/COUNT(CASE WHEN ""action"" IN ('show','skip') THEN ""question_id"" END) AS ""answer_rate"",""question_id"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""answers"" WHERE ""answer_rate"" IN (SELECT MAX(""answer_rate"") FROM ""answers"")"
47,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
48,"WITH ""getLogs"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""q_showed"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""q_answered"" FROM ""survey_log"" GROUP BY 1) SELECT ""tbl"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",MAX(""q_answered""/""q_showed"") AS ""max_answer_rate"" FROM ""getLogs"" GROUP BY 1) AS ""tbl"" ORDER BY ""tbl"".""max_answer_rate"" DESC LIMIT 1"
49,"SELECT ""s"".""question_id"" AS ""survey_log"" FROM ""survey_log"" AS ""s"" GROUP BY ""s"".""question_id"" ORDER BY (SUM(""s"".""action""='answer')/SUM(""action""='show')) DESC LIMIT 1"
50,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""action""!='skip' GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/COUNT(1) DESC LIMIT 1"
51,"WITH ""CTE"" AS (SELECT ""question_id"",ROW_NUMBER() OVER (ORDER BY SUM(""action""='answer')/SUM(""action""='show') DESC) AS ""R"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""CTE"" WHERE ""R""=1"
52,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
53,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(CASE WHEN ""action""='show' THEN 1 END) AS ""qu"",COUNT(CASE WHEN ""action""='answer' THEN 1 END) AS ""ans"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""q"" ORDER BY (""ans""/""qu"") DESC LIMIT 1"
54,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",(SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END)) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""c"" ORDER BY ""answer_rate"" DESC LIMIT 1"
55,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY COUNT(""answer_id"")/COUNT(""action"") DESC) AS ""rk"" FROM ""survey_log"" GROUP BY 1) AS ""s"" WHERE ""rk""=1"
56,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""answer_id"")/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""rate"" DESC LIMIT 1) AS ""temp"""
57,"WITH ""temp"" AS (SELECT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN 1 END)/COUNT(1) AS ""total"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY 2 DESC) SELECT ""question_id"" AS ""survey_log"" FROM ""temp"" LIMIT 1"
58,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
59,"WITH ""CTE"" AS (SELECT ""question_id"",COUNT(""answer_id"")/COUNT(1) AS ""count_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC) SELECT ""question_id"" AS ""survey_log"" FROM ""CTE"" LIMIT 1"
60,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/COUNT(1) AS ""arate"" FROM ""survey_log"" AS ""s"" GROUP BY ""question_id"") AS ""a"" ORDER BY ""a"".""arate"" DESC LIMIT 1"
61,"WITH ""cte1"" AS (SELECT ""question_id"",COUNT(""answer_id"") AS ""counts"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte1"" WHERE ""counts""=(SELECT MAX(""counts"") FROM ""cte1"")"
62,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN 1 ELSE NULL END)/COUNT(DISTINCT ""question_id"") AS ""rate"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC) AS ""t"" LIMIT 1"
63,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY 1 ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 END) DESC LIMIT 1"
64,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_ans"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""new_table"" ORDER BY ""num_ans""/""num_show"" DESC LIMIT 1"
65,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",(SUM(""action""='answer')/(SUM(""action""='answer')+SUM(""action""='show'))) AS ""ans_sum"" FROM ""survey_log"" GROUP BY 1) AS ""TAB"" ORDER BY ""ans_sum"" DESC LIMIT 1"
66,"WITH ""cte"" AS (SELECT ""question_id"",COUNT(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE NULL END) AS ""answercnt"",COUNT(CASE WHEN ""action""='show' THEN 1 ELSE NULL END) AS ""showcnt"" FROM ""survey_log"" GROUP BY 1) SELECT ""a"".""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",""answercnt""/""showcnt"" AS ""ratio"" FROM ""cte"" ORDER BY 2 DESC LIMIT 1) AS ""a"""
67,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/COUNT(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
68,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",COUNT(""answer_id"") FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""a"""
69,"SELECT DISTINCT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""question_id""=(SELECT ""question_id"" FROM ""survey_log"" GROUP BY 1 ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1)"
70,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""action""='answer')/SUM(""action""='show') AS ""ratio"" FROM ""survey_log"" GROUP BY 1) AS ""f"" ORDER BY ""ratio"" DESC LIMIT 1"
71,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""b"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""c"""
72,"SELECT ""t1"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COALESCE(SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END), 0) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""answer_rate"" DESC LIMIT 1) AS ""t1"""
73,"SELECT ""a"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NULL THEN 0 ELSE 1 END)/COUNT(""question_id"") AS ""ans_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY 2 DESC) AS ""a"" LIMIT 1"
74,"WITH ""TEMP"" AS (SELECT ""QUESTION_ID"" AS ""SURVEY_LOG"",SUM(CASE WHEN ""ACTION""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""ACTION""='show' THEN 1 ELSE 0 END) AS ""RATE"" FROM ""SURVEY_LOG"" WHERE ""ACTION"" IN ('show','answer') GROUP BY ""QUESTION_ID"") SELECT ""SURVEY_LOG"" FROM ""TEMP"" ORDER BY ""RATE"" DESC LIMIT 1"
75,"WITH ""status"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""Answer_status"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""Show_status"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""status"" ORDER BY ""Answer_status""/""show_status"" DESC LIMIT 1"
76,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",(SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END))/(SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END)) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""answer_rate"" DESC) AS ""ans"" LIMIT 1"
77,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""!='skip' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""rate"" DESC) AS ""ZZ"" LIMIT 1"
78,"WITH ""s"" AS (SELECT COUNT(1) AS ""n"",""question_id"" FROM ""survey_log"" WHERE ""action""='show' OR ""action""='skip' GROUP BY ""question_id""), ""a"" AS (SELECT COUNT(1) AS ""n"",""question_id"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"") SELECT ""a"".""question_id"" AS ""survey_log"" FROM ""s"" JOIN ""a"" ON ""a"".""question_id""=""s"".""question_id"" WHERE ""a"".""n""/""s"".""n""=(SELECT MAX(""a"".""n""/""s"".""n"") FROM ""s"" JOIN ""a"" ON ""a"".""question_id""=""s"".""question_id"")"
79,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY (SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1)) DESC LIMIT 1"
80,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
81,"SELECT ""drv"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_cnt"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_cnt"" FROM ""survey_log"" GROUP BY 1) AS ""drv"" GROUP BY 1 ORDER BY SUM(""drv"".""ans_cnt""/""drv"".""show_cnt"") DESC LIMIT 1"
82,"SELECT ""tb"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tb"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
83,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""showcount"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answercount"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t"" ORDER BY ""answercount""/""showcount"" DESC LIMIT 1"
84,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY (COUNT(""answer_id"")/COUNT(""action"")) DESC) AS ""rk"" FROM ""survey_log"" GROUP BY 1) AS ""temp"" WHERE ""rk""=1"
85,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(1) DESC LIMIT 1"
86,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
87,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NULL THEN 0 ELSE 1 END) AS ""answer_num"",COUNT(DISTINCT ""id"") AS ""user_num"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",""answer_num""/""user_num"" AS ""answer_rate"" FROM ""cte"" GROUP BY 1) AS ""new"" ORDER BY ""answer_rate"" DESC LIMIT 1"
88,"WITH ""question_rate"" AS (SELECT ""question_id"",ROUND(SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/SUM(CASE WHEN ""question_id"" THEN 1 ELSE 0 END)*100, 2) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""question_rate"" ORDER BY ""rate"" DESC LIMIT 1"
89,"WITH ""cte"" AS (SELECT ""question_id"",SUM(""action""='answer')/SUM(""action""='show') AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY 2 DESC) SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" LIMIT 1"
90,"WITH ""answers"" AS (SELECT ""question_id"",COUNT(""answer_id"") AS ""answers"" FROM ""survey_log"" AS ""sl"" GROUP BY 1), ""questions"" AS (SELECT ""question_id"",COUNT(DISTINCT ""id"") AS ""questions"" FROM ""survey_log"" AS ""sl"" WHERE ""action""='show' GROUP BY 1), ""answer_rate"" AS (SELECT ""q"".""question_id"",""answers""/""questions"" AS ""answr_rate"" FROM ""questions"" AS ""q"" LEFT JOIN ""answers"" AS ""a"" ON ""a"".""question_id""=""q"".""question_id"") SELECT DISTINCT ""question_id"" AS ""survey_log"" FROM ""answer_rate"" AS ""ar"" WHERE ""answr_rate""=(SELECT MAX(""answr_rate"") FROM ""answer_rate"") ORDER BY ""answr_rate"" DESC LIMIT 1"
91,"WITH ""base"" AS (SELECT ""question_id"",CAST(SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS FLOAT)/SUM(CASE WHEN ""action"" IN ('answer','show') THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""base"" ORDER BY ""answer_rate"" DESC LIMIT 1"
92,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_num"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_num"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""temp"" ORDER BY (""ans_num""/""show_num"") DESC LIMIT 1"
93,"WITH ""tmptable"" AS (SELECT *,SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""tmptable"" WHERE ""rate"" IN (SELECT MAX(""rate"") FROM ""tmptable"")"
94,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tbl"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
95,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(1) DESC LIMIT 1"
96,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""answer_rate"" DESC) SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" LIMIT 1"
97,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",ROW_NUMBER() OVER (ORDER BY ""rate"" DESC) AS ""rank"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"") AS ""b"" WHERE ""b"".""rank""=1"
98,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""rate"" DESC LIMIT 1"
99,"WITH ""cte"" AS (SELECT ""question_id"",SUM(""action""='answer')/COUNT(""action""='show') AS ""cnt"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""cnt"" DESC LIMIT 1"
100,"WITH ""a"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answer_tot"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_tot"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM ""a"" ORDER BY (""answer_tot""/""show_tot"") DESC LIMIT 1"
101,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""RATIO"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""TMP"" ORDER BY ""RATIO"" DESC LIMIT 1"
102,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY 1 ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
103,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",DENSE_RANK() OVER (ORDER BY (COALESCE(SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END), 0)/COUNT(DISTINCT ""question_id"")) DESC) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tmp"" WHERE ""answer_rate""=1"
104,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""action""='answer')/SUM(1) AS ""ratio"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"" ORDER BY ""ratio"" DESC LIMIT 1"
105,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""ratio"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""ratio"" DESC) AS ""r"" LIMIT 1"
106,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN (""action""='answer') THEN 1 ELSE 0 END)/SUM(CASE WHEN (""action""!='answer') THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" WHERE ""rate""=(SELECT MAX(""rate"") FROM ""cte"")"
107,"WITH ""cte1"" AS (SELECT ""question_id"",COUNT(""answer_id"") AS ""counts"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte1"" WHERE ""counts""=(SELECT MAX(""counts"") FROM ""cte1"")"
108,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",CASE WHEN ""action""='show' THEN 1 ELSE 0 END AS ""shows"",CASE WHEN ""action""='answer' THEN 1 ELSE 0 END AS ""answers"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""answers"")/SUM(""shows"") DESC) AS ""tmp"" LIMIT 1"
109,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
110,"WITH ""cte"" AS (SELECT DISTINCT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN 1 END) OVER (PARTITION BY ""question_id"") AS ""sum_answer_id"" FROM ""survey_log"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""sum_answer_id"" DESC LIMIT 1"
111,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_ans"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""new_table"" ORDER BY ""num_ans""/""num_show"" DESC LIMIT 1"
112,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COALESCE(COUNT(""answer_id""), 0)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
113,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"" ORDER BY COUNT(""action"") DESC LIMIT 1"
114,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/(COUNT(1)) DESC LIMIT 1"
115,"WITH ""ans_table"" AS (SELECT ""question_id"",COUNT(1) AS ""ans"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"",""id""), ""show_table"" AS (SELECT ""question_id"",COUNT(1) AS ""sho"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id"",""id""), ""temp"" AS (SELECT ""a"".""question_id"",""a"".""ans""/""s"".""sho"" AS ""ans_rate"" FROM ""ans_table"" AS ""a"" JOIN ""show_table"" AS ""s"" ON ""a"".""question_id""=""s"".""question_id"") SELECT DISTINCT ""question_id"" AS ""survey_log"" FROM ""temp"" ORDER BY ""ans_rate"" DESC LIMIT 1"
116,"WITH ""answer_rate_df"" AS (SELECT ""question_id"",COUNT(""answer_id"")/COUNT(1) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""answer_rate_df"" WHERE ""answer_rate""=(SELECT MAX(""answer_rate"") FROM ""answer_rate_df"")"
117,"SELECT DISTINCT ""question_id"" AS ""survey_log"" FROM (SELECT ""a"".""question_id"",RANK() OVER (ORDER BY ""answers_ct""/""show_ct"" DESC) AS ""ratio_rank"" FROM (SELECT ""question_id"",COUNT(1) AS ""show_ct"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY 1) AS ""a"" LEFT JOIN (SELECT ""question_id"",COUNT(1) AS ""answers_ct"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY 1) AS ""b"" ON ""a"".""question_id""=""b"".""question_id"") AS ""x"" LIMIT 1"
118,"WITH ""CTE1"" AS (SELECT *,CASE WHEN ""action""='answer' THEN 1 ELSE 0 END AS ""answer_stats"",CASE WHEN ""action"" IN ('show','skip') THEN 1 ELSE 0 END AS ""show_stats"" FROM ""survey_log""), ""CTE2"" AS (SELECT ""question_id"",SUM(""answer_stats"")/SUM(""show_stats"") AS ""answer_rate"" FROM ""CTE1"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""CTE2"" WHERE ""answer_rate""=(SELECT MAX(""answer_rate"") FROM ""CTE2"")"
119,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""num_answer"")/SUM(""num_show"") AS ""answer_rate"" FROM (SELECT *,CASE WHEN ""action""='show' THEN 1 ELSE 0 END AS ""num_show"",CASE WHEN ""action""='answer' THEN 1 ELSE 0 END AS ""num_answer"" FROM ""survey_log"") AS ""survey_counted"" GROUP BY ""question_id"") AS ""answer_rates"" ORDER BY ""answer_rate"" DESC LIMIT 1"
120,"SELECT ""QUESTION_ID"" AS ""survey_log"" FROM ""SURVEY_LOG"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
121,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""question"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans"" FROM ""survey_log"" GROUP BY 1) AS ""a"" ORDER BY ""ans""/""question"" DESC LIMIT 1"
122,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_ans"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""new_table"" ORDER BY ""num_ans""/""num_show"" DESC LIMIT 1"
123,"SELECT ""survey_log"" FROM (SELECT SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""cnt"",""question_id"" AS ""survey_log"",DENSE_RANK() OVER (ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) DESC) AS ""r"" FROM ""survey_log"" GROUP BY 2) AS ""aaa"" WHERE ""r""=1"
124,"WITH ""answerrate"" AS (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/SUM(CASE WHEN ""answer_id"" IS NULL THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""answerrate"" WHERE ""answer_rate""=(SELECT MAX(""answer_rate"") FROM ""answerrate"")"
125,"SELECT ""sl"".""question_id"" AS ""survey_log"" FROM ""survey_log"" AS ""sl"" JOIN (SELECT ""question_id"",COUNT(""question_id"") AS ""tqcnt"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id"") AS ""sq"" ON ""sl"".""question_id""=""sq"".""question_id"" GROUP BY ""sl"".""question_id"" ORDER BY (COUNT(""sl"".""answer_id"")/""sq"".""tqcnt"") DESC LIMIT 1"
126,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""action""='answer')/COUNT(""action""='show') DESC LIMIT 1"
127,"WITH ""cte"" AS (SELECT ""question_id"",SUM(""action""='answer')/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" WHERE ""rate""=(SELECT MAX(""rate"") FROM ""cte"") LIMIT 1"
128,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",CASE WHEN ""action""='show' THEN 1 ELSE 0 END AS ""show_time"",CASE WHEN ""action""='answer' THEN 1 ELSE 0 END AS ""answer_time"" FROM ""survey_log"") AS ""a"" GROUP BY ""question_id"" ORDER BY SUM(""answer_time"")/SUM(""show_time"") DESC LIMIT 1"
129,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END) AS ""cnt"",COUNT(DISTINCT ""question_id"") AS ""total"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COALESCE(""cnt""/""total"", 0) AS ""ans_rate"" FROM ""cte"") AS ""t"" ORDER BY ""ans_rate"" DESC LIMIT 1"
130,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t1"" ORDER BY ""rate"" DESC LIMIT 1"
131,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tbl"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
132,"WITH ""count_answer"" AS (SELECT ""question_id"",COUNT(""action"") OVER (PARTITION BY ""question_id"") AS ""count_ans"" FROM ""survey_log"" WHERE ""action""='answer'), ""count_tot"" AS (SELECT ""question_id"",COUNT(""action"") OVER (PARTITION BY ""question_id"") AS ""count_tot"" FROM ""survey_log"") SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""a"".""question_id"",""a"".""count_ans""/""t"".""count_tot"" AS ""answer_rate"" FROM ""count_answer"" AS ""a"" JOIN ""count_tot"" AS ""t"" ORDER BY ""answer_rate"" DESC LIMIT 1) AS ""t"""
133,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(CASE WHEN ""action""='answer' THEN 1 ELSE NULL END)/COUNT(CASE WHEN ""action""='show' THEN 1 ELSE NULL END) DESC LIMIT 1"
134,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""answer_id"") AS ""num_answer"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tbl"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
135,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",COUNT(""answer_id"")/COUNT(1) AS ""answer_rate"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""rating"""
136,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') DESC LIMIT 1"
137,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
138,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",(SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/COUNT(1)) AS ""num"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""num"" DESC) AS ""t"" LIMIT 1"
139,"WITH ""cnt_ans"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/COUNT(1) AS ""rate"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM ""cnt_ans"" WHERE ""rate""=(SELECT MAX(""rate"") FROM ""cnt_ans"")"
140,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
141,"SELECT ""question_id"" AS ""survey_Log"" FROM (SELECT DISTINCT ""question_id"",DENSE_RANK() OVER (ORDER BY COUNT(""answer_id"")/COUNT(""action"") DESC) AS ""rk"" FROM ""survey_log"" GROUP BY 1) AS ""temp"" WHERE ""rk""=1"
142,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_num"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_num"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""T"" ORDER BY (""ans_num""/""show_num"") DESC LIMIT 1"
143,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""temp"" ORDER BY ""num_answer""/""num_show"" DESC LIMIT 1"
144,"SELECT ""z"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY 1) AS ""z"" ORDER BY ""z"".""rate"" DESC LIMIT 1"
145,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" HAVING COUNT(""answer_id"")/COUNT(DISTINCT ""id"")=(SELECT COUNT(""answer_id"")/COUNT(DISTINCT ""id"") FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY 1 DESC LIMIT 1) ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
146,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') AS ""ans_ratio"" FROM ""survey_log"" GROUP BY 1) AS ""f"" ORDER BY ""ans_ratio"" DESC LIMIT 1"
147,"SELECT ""t2"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""s"".""action""='show' THEN 1 ELSE 0 END) AS ""show_cnt"" FROM ""survey_log"" AS ""s"" GROUP BY ""question_id"") AS ""t1"" JOIN (SELECT ""question_id"",SUM(CASE WHEN ""s"".""action""='answer' THEN 1 ELSE 0 END) AS ""answer_cnt"" FROM ""survey_log"" AS ""s"" GROUP BY ""question_id"") AS ""t2"" HAVING (""question_id"") ORDER BY (""t2"".""answer_cnt""/""t1"".""show_cnt"") DESC LIMIT 1"
148,"WITH ""a"" AS (SELECT ""question_id"",CASE WHEN ""answer_id""!='null' THEN 1 ELSE 0 END AS ""if_answered"" FROM ""survey_log"") SELECT ""question_id"" AS ""survey_log"" FROM ""a"" GROUP BY 1 ORDER BY AVG(""if_answered"") DESC LIMIT 1"
149,"WITH ""cte_answer"" AS (SELECT ""question_id"",COALESCE(COUNT(""answer_id""), 0) AS ""ans"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id""), ""cte_question"" AS (SELECT ""question_id"",COUNT(""question_id"") AS ""shown"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id""), ""cte_answerrate"" AS (SELECT ""q"".""question_id"",""ans"",""shown"",COALESCE((""ans""/""shown""), 0) AS ""answer_rate"" FROM ""cte_question"" AS ""q"" LEFT JOIN ""cte_answer"" AS ""a"" ON ""q"".""question_id""=""a"".""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY ""answer_rate"" DESC,""shown"" DESC) AS ""rnk"" FROM ""cte_answerrate"") AS ""x"" WHERE ""rnk""=1"
150,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
151,"WITH ""cte1"" AS (SELECT ""question_id"",COUNT(""answer_id"") AS ""counts"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte1"" WHERE ""counts""=(SELECT MAX(""counts"") FROM ""cte1"")"
152,"WITH ""cte1"" AS (SELECT ""question_id"",COUNT(""answer_id"") AS ""counts"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte1"" ORDER BY ""counts"" DESC LIMIT 1"
153,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",CASE WHEN ""show_ct""=0 THEN 0 ELSE CAST(""answer_ct"" AS FLOAT)/""show_ct"" END AS ""r"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answer_ct"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_ct"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"") AS ""b"" ORDER BY ""r"" DESC LIMIT 1"
154,"WITH ""base"" AS (SELECT ""question_id"",CAST(SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS FLOAT)/SUM(CASE WHEN ""action"" IN ('answer','show') THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id""), ""answer_rank"" AS (SELECT *,ROW_NUMBER() OVER (ORDER BY ""answer_rate"" DESC) AS ""answer_rate_rank"" FROM ""base"") SELECT ""question_id"" AS ""survey_log"" FROM ""answer_rank"" WHERE ""answer_rate_rank""=1"
155,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY ""count"" DESC) FROM (SELECT ""question_id"",COUNT(""answer_id"") AS ""count"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""d"" LIMIT 1) AS ""d"""
156,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY (COUNT(""answer_id"")/COUNT(""action"")) DESC) FROM ""survey_log"" GROUP BY 1 LIMIT 1) AS ""temp"""
157,"WITH ""b"" AS (SELECT ""question_id"",CASE WHEN ""answer_id"" IS NULL THEN 0 ELSE 1 END AS ""a"",1 AS ""overall_response"" FROM ""survey_log""), ""c"" AS (SELECT ""question_id"",SUM(""a"")/SUM(""overall_response"") AS ""rate"" FROM ""b"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""c"" WHERE ""rate"" ORDER BY ""rate"" DESC LIMIT 1"
158,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""action""='answer')/SUM(""action""='show') DESC LIMIT 1"
159,"SELECT ""sorted_answered_questions"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(1) AS ""num_times_answered"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"" ORDER BY COUNT(1) DESC) AS ""sorted_answered_questions"" LIMIT 1"
160,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""answer_rate"" DESC) AS ""sub"" LIMIT 1"
161,"SELECT ""sl"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""TQ"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""TA"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""sl"" ORDER BY (""sl"".""TA""/""sl"".""TQ"") DESC LIMIT 1"
162,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answer"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""shown"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tmp"" ORDER BY ""answer""/""shown"" DESC LIMIT 1"
163,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
164,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""action""='answer')/SUM(""action""='show') DESC LIMIT 1"
165,"SELECT ""t1"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(1) AS ""answer_count"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""id"",""question_id"") AS ""t1"" JOIN (SELECT ""question_id"",COUNT(1) AS ""total_count"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""id"",""question_id"") AS ""t2"" ON ""t1"".""question_id""=""t2"".""question_id"" ORDER BY ""answer_count""/""total_count"" DESC LIMIT 1"
166,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",""ratio"",""count_tol"",DENSE_RANK() OVER (PARTITION BY ""ratio"" ORDER BY ""count_tol"" DESC) AS ""ranks"" FROM (SELECT ""a"".""question_id"",""ans_tol""*1.0/""count_tol"" AS ""ratio"",""count_tol"" FROM (SELECT ""question_id"",COUNT(DISTINCT ""id"") AS ""count_tol"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"" LEFT JOIN (SELECT ""question_id"",COUNT(""answer_id"") AS ""ans_tol"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""b"" ON ""a"".""question_id""=""b"".""question_id"") AS ""c"" ORDER BY ""ratio"" DESC) AS ""d"" WHERE ""ranks""=1 ORDER BY ""ratio"" DESC LIMIT 1"
167,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""action""='answer')/SUM(""action""='answer' OR ""action""='show') DESC LIMIT 1"
168,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",RANK() OVER (ORDER BY COUNT(""answer_id"")/COUNT(""action"") DESC) AS ""ranks"" FROM ""survey_log"" GROUP BY 1) AS ""t1"" WHERE ""ranks""=1"
169,"SELECT ""question_id"" AS ""survey_log"" FROM ((SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY 1 ORDER BY ""answer_Rate"" DESC)) AS ""a"" LIMIT 1"
170,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY (COUNT(CASE WHEN ""action""='answer' THEN ""answer_id"" ELSE NULL END)/COUNT(CASE WHEN ""action""='show' THEN 1 ELSE NULL END)) DESC LIMIT 1"
171,"SELECT ""s"".""question_id"" AS ""survey_log"" FROM ""survey_log"" AS ""s"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""s"".""question_id"" ORDER BY COUNT(1) DESC LIMIT 1"
172,"WITH ""temp"" AS (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""temp"" WHERE ""rate"" IN (SELECT MAX(""rate"") FROM ""temp"")"
173,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN ""action"" ELSE NULL END)/COUNT(CASE WHEN ""action""='show' THEN ""action"" ELSE NULL END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"" ORDER BY ""rate"" DESC LIMIT 1"
174,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""answer_id"" IS NOT NULL)/COUNT(1) DESC LIMIT 1"
175,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""question_id"") AS ""resp"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"" ORDER BY ""resp"" DESC) AS ""b"" LIMIT 1"
176,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",""answer_rate"",RANK() OVER (ORDER BY ""answer_rate"" DESC) AS ""answer_rate_rank"" FROM (SELECT ""question_id"",""answers""/""t_answers"" AS ""answer_rate"" FROM (SELECT ""question_id"",COUNT(""answer_id"") AS ""answers"" FROM ""survey_log"" GROUP BY 1) AS ""a1"" JOIN (SELECT COUNT(""answer_id"") AS ""t_answers"" FROM ""survey_log"") AS ""a2"") AS ""b"") AS ""c"" WHERE ""answer_rate_rank""=1"
177,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
178,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",DENSE_RANK() OVER (ORDER BY ""rate"" DESC) AS ""rank"" FROM (SELECT ""question_id"",""rate"" FROM (SELECT ""question_id"",(SUM(""action""='answer')/COUNT(""action"")) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""rate"" DESC) AS ""A"") AS ""B"") AS ""C"" WHERE ""C"".""rank""=1"
179,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""answer_id"")/COUNT(""action""='show') AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""rate"" DESC LIMIT 1) AS ""temp"""
180,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""ratio"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""ratio"" DESC LIMIT 1"
181,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
182,"SELECT ""s"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""answer_id"") AS ""answer_time"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""s"" ORDER BY ""s"".""answer_time"" DESC LIMIT 1"
183,"SELECT ""question_id"" AS ""survey_Log"" FROM (SELECT DISTINCT ""question_id"",DENSE_RANK() OVER (ORDER BY COUNT(""answer_id"")/COUNT(""action"") DESC) AS ""rk"" FROM ""survey_log"" GROUP BY 1) AS ""temp"" WHERE ""rk""=1"
184,"SELECT DISTINCT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY 1 ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
185,"WITH ""cte1"" AS (SELECT ""question_id"",CASE WHEN ""action""='answer' THEN 1 ELSE 0 END AS ""flagging"" FROM ""survey_log""), ""cte2"" AS (SELECT ""question_id"",COUNT(""question_id"") AS ""count_val"" FROM ""cte1"" WHERE ""flagging""=1 GROUP BY ""question_id"" ORDER BY ""count_val"" DESC) SELECT ""question_id"" AS ""survey_log"" FROM ""cte2"" HAVING MAX(""count_val"")"
186,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""answer_id"" IS NOT NULL)/SUM(""action""='show') AS ""ans_ratio"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t"" ORDER BY ""ans_ratio"" DESC LIMIT 1"
187,"SELECT ""a"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""sl"".""action""='show' THEN 1 ELSE 0 END) AS ""show_cnt"" FROM ""survey_log"" AS ""sl"" GROUP BY ""question_id"") AS ""s"" JOIN (SELECT ""question_id"",SUM(CASE WHEN ""sl"".""action""='answer' THEN 1 ELSE 0 END) AS ""answer_cnt"" FROM ""survey_log"" AS ""sl"" GROUP BY ""question_id"") AS ""a"" HAVING (""question_id"") ORDER BY (""a"".""answer_cnt""/""s"".""show_cnt"") DESC LIMIT 1"
188,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"" ORDER BY COUNT(""question_id"") DESC LIMIT 1"
189,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/COUNT(1) DESC LIMIT 1"
190,"SELECT ""t2"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""answer_id"") AS ""answernum"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"") AS ""t1"" RIGHT JOIN (SELECT ""question_id"",COUNT(""question_id"") AS ""shownum"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id"") AS ""t2"" ON ""t1"".""question_id""=""t2"".""question_id"" ORDER BY (COALESCE(""answernum"", 0))/""shownum"" DESC LIMIT 1"
191,"WITH ""temp"" AS (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END) AS ""answered"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""temp"" ORDER BY ""answered"" DESC LIMIT 1"
192,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
193,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""showed"",(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answered"" FROM ""survey_log"") AS ""a"" GROUP BY ""question_id"" ORDER BY SUM(""answered"")/SUM(""showed"") DESC LIMIT 1"
194,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""show_t""/""total"" AS ""ratio"",""t1"".""question_id"" FROM (SELECT COUNT(""action"") AS ""show_t"",""question_id"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"") AS ""t1"" LEFT JOIN (SELECT COUNT(""action"") AS ""total"",""question_id"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t2"" ON ""t1"".""question_id""=""t2"".""question_id"") AS ""t3"" ORDER BY ""ratio"" DESC LIMIT 1"
195,"WITH ""show_table"" AS (SELECT ""question_id"",COUNT(""survey_log"".""action"") AS ""show_count"" FROM ""survey_log"" WHERE ""survey_log"".""action""='show' GROUP BY ""question_id""), ""answer_table"" AS (SELECT ""question_id"",COUNT(""survey_log"".""action"") AS ""answer_count"" FROM ""survey_log"" WHERE ""survey_log"".""action""='answer' GROUP BY ""question_id""), ""rate_table"" AS (SELECT ""A"".""question_id"",(""B"".""answer_count""/""A"".""show_count"") AS ""rate"" FROM ""show_table"" AS ""A"" LEFT JOIN ""answer_table"" AS ""B"" ON ""A"".""question_id""=""B"".""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""rate_table"" ORDER BY ""rate"" DESC LIMIT 1"
196,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(""action""='answer')/SUM(""action""='show') AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""rate"" DESC LIMIT 1) AS ""a"""
197,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answer_num"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_num"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""answer_num""/""show_num"" DESC LIMIT 1"
198,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_num"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_num"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""C"" ORDER BY (""ans_num""/""show_num"") DESC LIMIT 1"
199,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""a"" ORDER BY ""answer_rate"" DESC LIMIT 1"
200,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",CASE WHEN ""action""='answer' THEN 1 ELSE 0 END AS ""num"" FROM ""survey_log"") AS ""T"" GROUP BY ""question_id"" ORDER BY SUM(""num"") DESC LIMIT 1"
201,"WITH ""temp"" AS (SELECT ""question_id"",COUNT(""answer_id"")/COUNT(""question_id"") AS ""fraction"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM ""temp"" WHERE ""fraction"" IN (SELECT MAX(""fraction"") FROM ""temp"")"
202,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) DESC LIMIT 1"
203,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_col"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""answer_col"" FROM ""survey_log"" GROUP BY (""question_id"")) AS ""A"" ORDER BY ""answer_col""/""show_col"" DESC LIMIT 1"
204,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 END)/SUM(CASE WHEN ""action""='show' THEN 1 END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" WHERE ""answer_rate""=(SELECT MAX(""answer_rate"") FROM ""cte"") ORDER BY ""question_id"" LIMIT 1"
205,"SELECT ""survey_log"" FROM (SELECT ""question_id"" AS ""survey_log"",ROW_NUMBER() OVER (ORDER BY SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1) DESC) AS ""rk"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""sub"" WHERE ""rk""=1"
206,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)*1.0/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
207,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""showed"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""b"" ORDER BY (""b"".""ans""/""b"".""showed"") DESC LIMIT 1"
208,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""T"" ORDER BY ""rate"" DESC LIMIT 1"
209,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_ans"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_ques"",""question_id"" FROM ""survey_log"" GROUP BY 3) AS ""a"" ORDER BY (""a"".""num_ans""/""a"".""num_ques"") DESC LIMIT 1"
210,"WITH ""answer"" AS (SELECT ""question_id"",COUNT(""question_id"") AS ""answer_number"" FROM ""survey_log"" WHERE ""survey_log"".""action""='answer' GROUP BY ""question_id""), ""total"" AS (SELECT ""question_id"",COUNT(""question_id"") AS ""total_number"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""Survey_log"" FROM (SELECT ""answer"".""question_id"",""answer_number""/""total_number"",RANK() OVER (ORDER BY ""answer_number""/""total_number"" DESC) AS ""ranks"" FROM ""answer"" JOIN ""total"" ON ""answer"".""question_id""=""total"".""question_id"") AS ""a"" WHERE ""ranks""=1"
211,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",AVG(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""avg_ans"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""t"" ORDER BY ""avg_ans"" DESC LIMIT 1"
212,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
213,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"")/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
214,"WITH ""tmp"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""tmp"" ORDER BY ""rate"" DESC LIMIT 1"
215,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY 1 ORDER BY 2 DESC LIMIT 1) AS ""a"""
216,"WITH ""total_count"" AS (SELECT ""question_id"",COUNT(""question_id"") AS ""total"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id""), ""answer_count"" AS (SELECT ""question_id"",COUNT(""answer_id"") AS ""answer"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id""), ""tbl_rate"" AS (SELECT ""total"".""question_id"",""total"".""total"",COALESCE(""answer"".""answer"", 0),(""answer"".""answer""/""total"".""total"") AS ""rate"" FROM ""total_count"" AS ""total"" LEFT JOIN ""answer_count"" AS ""answer"" ON ""total"".""question_id""=""answer"".""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""tbl_rate"" WHERE ""rate""=(SELECT MAX(""rate"") FROM ""tbl_rate"") LIMIT 1"
217,"WITH ""t1"" AS (SELECT ""question_id"",""ans_cnt""/""show_cnt"" AS ""ans_rate"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_cnt"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_cnt"" FROM ""survey_log"" GROUP BY 1) AS ""tmp"") SELECT ""question_id"" AS ""survey_log"" FROM ""t1"" GROUP BY 1 ORDER BY ""ans_rate"" DESC LIMIT 1"
218,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" HAVING COUNT(""answer_id"")>0 ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
219,"SELECT ""z"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""rate"" FROM ""survey_log"" GROUP BY 1) AS ""z"" ORDER BY ""z"".""rate"" DESC LIMIT 1"
220,"WITH ""t"" AS (SELECT ""question_id"",SUM(""action""='answer')/SUM(""action""='show' OR ""action""='skip') AS ""ans_rate"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""t"" WHERE ""ans_rate""=(SELECT MAX(""ans_rate"") FROM ""t"")"
221,"SELECT ""a"".""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' AND ""answer_id"" IS NOT NULL THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action"" IN ('answer','show') THEN 1 ELSE 0 END) AS ""ans_rate"" FROM ""survey_log"" GROUP BY 1) AS ""a"" ORDER BY ""ans_rate"" DESC LIMIT 1"
222,"WITH ""answers"" AS (SELECT COUNT(CASE WHEN ""answer_id"" IS NOT NULL THEN ""answer_id"" END)/COUNT(CASE WHEN ""action"" IN ('show','skip') THEN ""question_id"" END) AS ""answer_rate"",""question_id"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""answers"" WHERE ""question_id"" IN (SELECT ""question_id"" FROM ""answers"" WHERE ""answer_rate"" IN (SELECT MAX(""answer_rate"") FROM ""answers""))"
223,"SELECT ""QUESTION_ID"" AS ""SURVEY_LOG"" FROM ""SURVEY_LOG"" WHERE ""ANSWER_ID"" IS NOT NULL GROUP BY ""QUESTION_ID"" ORDER BY COUNT(""QUESTION_ID"") DESC LIMIT 1"
224,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" WHERE ""answer_id"" IS NOT NULL GROUP BY ""question_id"" ORDER BY COUNT(""answer_id"") DESC LIMIT 1"
225,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""num_show"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""num_answer"" FROM ""survey_log"" GROUP BY ""question_id"") AS ""tbl"" ORDER BY (""num_answer""/""num_show"") DESC LIMIT 1"
226,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",RANK() OVER (ORDER BY (COUNT(""answer_id"")/COUNT(""action"")) DESC) AS ""rk"" FROM ""survey_log"" GROUP BY 1) AS ""temp"" WHERE ""rk""=1"
227,"WITH ""cte"" AS (SELECT ""question_id"",(SUM(CASE WHEN ""answer_id"" IS NULL THEN 0 ELSE 1 END)/COUNT(1)) AS ""answer_rate"" FROM ""survey_log"" GROUP BY 1) SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" WHERE ""answer_rate""=(SELECT MAX(""answer_rate"") FROM ""cte"")"
228,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(""answer_id"")/COUNT(""action"") AS ""ratio"" FROM ""survey_log"" GROUP BY 1) AS ""temp"" GROUP BY 1 ORDER BY ""ratio"" DESC LIMIT 1"
229,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
230,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""action""='answer')/COUNT(""action"") DESC LIMIT 1"
231,"SELECT DISTINCT ""s"".""question_id"" AS ""survey_log"" FROM ""survey_log"" AS ""s"" LEFT JOIN (SELECT ""question_id"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END)/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""fraction"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""fraction"" DESC LIMIT 1) AS ""t"" ON ""s"".""question_id""=""t"".""question_id"" WHERE ""t"".""fraction"" IS NOT NULL"
232,"SELECT ""question_id"" AS ""survey_log"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY SUM(""action""='answer')/SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) DESC LIMIT 1"
233,"WITH ""cte"" AS (SELECT ""question_id"",SUM(CASE WHEN ""action""='show' THEN 1 ELSE 0 END) AS ""show_count"",SUM(CASE WHEN ""action""='answer' THEN 1 ELSE 0 END) AS ""ans_count"" FROM ""survey_log"" GROUP BY ""question_id"") SELECT ""question_id"" AS ""survey_log"" FROM ""cte"" ORDER BY ""ans_count""/""show_count"" DESC LIMIT 1"
234,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",COUNT(CASE WHEN ""action""='answer' THEN 1 ELSE NULL END)/COUNT(CASE WHEN ""action""='show' THEN 1 ELSE NULL END) AS ""answer_rate"" FROM ""survey_log"" GROUP BY ""question_id"" ORDER BY ""answer_rate"" DESC) AS ""a"" LIMIT 1"
235,"SELECT ""question_id"" AS ""survey_log"" FROM (SELECT ""question_id"",""an""/""sh"" AS ""rate"" FROM (SELECT ""question_id"",COUNT(""action"") AS ""an"" FROM ""survey_log"" WHERE ""action""='answer' GROUP BY ""question_id"") AS ""t2"" NATURAL JOIN (SELECT ""question_id"",COUNT(""action"") AS ""sh"" FROM ""survey_log"" WHERE ""action""='show' GROUP BY ""question_id"") AS ""t3"" ORDER BY ""rate"" DESC) AS ""t1"" LIMIT 1"
