id,original query
1,"SELECT ROUND(COUNT(""T2"".""player_id"")/COUNT(""T1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""T1"" LEFT JOIN ""Activity"" AS ""T2"" ON ""T1"".""player_id""=""T2"".""player_id"" AND ""T1"".""first_login""=""T2"".""event_date""-1"
2,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
3,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
4,"SELECT ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""dates"" FROM ""Activity"" GROUP BY 1) AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""dates""=1"
5,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""firstlogin"" FROM ""activity"" GROUP BY ""player_id"") AS ""b"" LEFT JOIN ""activity"" AS ""a"" ON ""b"".""firstlogin""+1=""a"".""event_date"" AND ""a"".""player_id""=""b"".""player_id"""
6,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
7,"SELECT ROUND(COUNT(DISTINCT ""B"".""player_id"")/COUNT(DISTINCT ""A"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""mineventdate"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" AND ""A"".""mineventdate""=""B"".""event_date""-1"
8,"WITH ""CTE"" AS (SELECT ""b"".""player_id"",""b"".""event_date"" FROM ""Activity"" AS ""a"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""b"" ON ""b"".""player_id""=""a"".""player_id"" AND ""b"".""event_date""=""a"".""event_date""-1) SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""CTE"""
9,"WITH ""nactivity"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""drank"" FROM ""activity""), ""second_day"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""nactivity"" AS ""a1"" JOIN ""nactivity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date"" + INTERVAL '1 DAY' AND ""a1"".""drank""=1) SELECT ROUND((SELECT COUNT(1) FROM ""second_day"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
10,"SELECT ROUND(SUM(CASE WHEN ""temp"".""min_date""+1=""a"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"""
11,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_day"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""first_day""=""b"".""event_date""-1 AND ""a"".""player_id""=""b"".""player_id"""
12,"SELECT ROUND(COUNT(""A2"".""player_id"")/COUNT(DISTINCT ""A1"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""A1"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A2"" ON ""A1"".""player_id""=""A2"".""player_id"" AND ""A1"".""event_date""=""A2"".""first_date""+1"
13,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""first_login""=1"
14,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_day"" FROM ""Activity"" GROUP BY 1) SELECT ROUND(SUM(CASE WHEN ""a"".""player_id"" IS NULL THEN 0 ELSE 1 END)/COUNT(DISTINCT ""cte"".""player_id""), 2) AS ""fraction"" FROM ""cte"" LEFT JOIN ""Activity"" AS ""a"" ON ""cte"".""player_id""=""a"".""player_id"" AND ""cte"".""first_day""+1=""a"".""event_date"""
15,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
16,"WITH ""first_login_info"" AS (SELECT ""player_id"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""second_day"" FROM ""activity"" GROUP BY ""player_id""), ""second_login"" AS (SELECT MAX(CASE WHEN ""event_date""=""second_day"" THEN 1 ELSE 0 END) AS ""flag"" FROM ""activity"" AS ""A"" LEFT JOIN ""first_login_info"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" GROUP BY ""A"".""player_id"") SELECT ROUND(AVG(""flag""), 2) AS ""fraction"" FROM ""second_login"""
17,"WITH ""fr"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""a2"".""player_id"")/COUNT(""fr"".""player_id""), 2) AS ""fraction"" FROM ""fr"" LEFT JOIN ""activity"" AS ""a2"" ON ""fr"".""player_id""=""a2"".""player_id"" AND ""fr"".""first_login""=""a2"".""event_date""-1"
18,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""t"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""t"" LEFT JOIN ""activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""first_login""+1=""a"".""event_date"""
19,"WITH ""cte"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""minn"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte"" WHERE ""event_date""-""minn""=1"
20,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t2"".""player_id""=""t1"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""first_login""=1"
21,"WITH ""nactivity"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""drank"" FROM ""activity""), ""second_day"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""nactivity"" AS ""a1"" JOIN ""nactivity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date"" + INTERVAL '1 DAY' AND ""a1"".""drank""=1) SELECT ROUND((SELECT COUNT(1) FROM ""second_day"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
22,"WITH ""consecutive_logins"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""activity"" AS ""a1"" JOIN ""activity"" AS ""a2"" ON ""a1"".""event_date""=""a2"".""event_date"" - INTERVAL '1 DAY' AND ""a1"".""player_id""=""a2"".""player_id""), ""first_consecutive_logins"" AS (SELECT ""player_id"" FROM ""consecutive_logins"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""activity"" GROUP BY ""player_id"")) SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""first_consecutive_logins"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
23,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN ""t2"".""player_id"" ELSE NULL END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""rk""=1 AND ""t2"".""rk""=2 AND ""t2"".""event_date"" - ""t1"".""event_date""=1"
24,"SELECT ROUND(COUNT(DISTINCT ""c"".""Player_ID"")/COUNT(DISTINCT ""b"".""Player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""b"" LEFT JOIN (SELECT MIN(""a"".""event_date"") AS ""MinDate"",""a"".""Player_ID"" FROM ""Activity"" AS ""a"" GROUP BY ""Player_id"") AS ""c"" ON ""b"".""event_date"" - INTERVAL '1 DAY'=""c"".""MinDate"" AND ""b"".""Player_id""=""c"".""Player_ID"""
25,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
26,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""first_login""=""t2"".""event_date"" - INTERVAL '1 DAY'"
27,"SELECT ROUND(SUM(CASE WHEN ""temp"".""min_date""+1=""a1"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY 1) AS ""temp"", ""Activity"" AS ""a1"" WHERE ""a1"".""player_id""=""temp"".""player_id"""
28,"WITH ""row_nbr"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity""), ""first_login"" AS (SELECT ""player_id"",""event_date"" AS ""first_dt"" FROM ""row_nbr"" WHERE ""rn""=1), ""second_login"" AS (SELECT ""player_id"",""event_date"" AS ""second_dt"" FROM ""row_nbr"" WHERE ""rn""=2) SELECT ROUND(AVG(""if_cont""), 2) AS ""fraction"" FROM (SELECT ""f"".""player_id"",""f"".""first_dt"",(CASE WHEN (""s"".""second_dt""-""f"".""first_dt"")=1 THEN 1 ELSE 0 END) AS ""if_cont"" FROM ""first_login"" AS ""f"" LEFT JOIN ""second_login"" AS ""s"" ON ""f"".""player_id""=""s"".""player_id"") AS ""tmp"""
29,"WITH ""cte"" AS (SELECT ""player_id"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",""event_date"" FROM ""Activity"") SELECT ROUND(COUNT(""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""event_date""=1 WHERE ""a"".""rnk""=1"
30,"SELECT ROUND(SUM(CASE WHEN ""temp"".""min_date""+1=""a"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"""
31,"SELECT ROUND(SUM(CASE WHEN ""t1"".""event_date""=""t2"".""first_date""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""t1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY 1) AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"""
32,"WITH ""fr"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""a2"".""player_id"")/COUNT(""fr"".""player_id""), 2) AS ""fraction"" FROM ""fr"" LEFT JOIN ""activity"" AS ""a2"" ON ""fr"".""player_id""=""a2"".""player_id"" AND ""fr"".""first_login""=""a2"".""event_date""-1"
33,"SELECT ROUND(SUM(CASE WHEN ""temp"".""min_date""+1=""a"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"""
34,"SELECT ROUND(SUM(CASE WHEN ""A1"".""event_date""=""A2"".""event_date_min""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT (""A1"".""player_id"")), 2) AS ""fraction"" FROM ""Activity"" AS ""A1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date_min"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A2"" ON ""A1"".""player_id""=""A2"".""player_id"""
35,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
36,"SELECT COALESCE(ROUND((SELECT COUNT(DISTINCT ""a"".""player_id"") FROM (""activity"" AS ""a"" JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""event_date""=1) JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""activity"" GROUP BY 1) AS ""c"" ON ""a"".""player_id""=""c"".""player_id"" AND ""a"".""event_date""=""c"".""first_date"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2), 0) AS ""fraction"""
37,"WITH ""FIRST_LOGIN_TABLE"" AS (SELECT *,CASE WHEN ""event_date""-MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"")=1 THEN 1 ELSE 0 END AS ""FIRST_LOGIN"" FROM ""Activity"") SELECT ROUND(SUM(""FIRST_LOGIN"")/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""Activity""), 2) AS ""fraction"" FROM ""FIRST_LOGIN_TABLE"""
38,"WITH ""cte"" AS (SELECT ""a"".""player_id"",""a"".""event_date"",""fl"" FROM ""activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""fl"" FROM ""activity"" GROUP BY 1) AS ""b"" ON ""a"".""player_id""=""b"".""player_id"") SELECT ROUND(SUM(CASE WHEN TIMESTAMPDIFF(DAY, ""fl"", ""event_date"")=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"""
39,"WITH ""a1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""joindate"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""joindate"" + INTERVAL '1 DAY'"
40,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(""f"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""f"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""player_id""=""f"".""player_id"" AND ""f"".""first_date""=""a"".""event_date""-1"
41,"SELECT ROUND(COUNT(DISTINCT ""y"".""player_id"")/COUNT(DISTINCT ""x"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""x"" LEFT JOIN ""activity"" AS ""y"" ON ""x"".""player_id""=""y"".""player_id"" AND ""x"".""event_date"" - ""y"".""event_date""=-1 WHERE ROW(""x"".""player_id"",""x"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY 1)"
42,"SELECT ROUND((SELECT COUNT(DISTINCT ""t1"".""player_id"") FROM (SELECT ""player_id"",MIN(""event_date"") AS ""firstdate"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"", ""Activity"" AS ""t2"" WHERE ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""firstdate""=1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
43,"SELECT ROUND((SELECT COUNT(""a"".""player_id"") AS ""player_id"" FROM (SELECT ""a"".* FROM (SELECT *,LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ld"" FROM ""Activity"") AS ""a"" WHERE ""a"".""ld""-""a"".""event_date""=1) AS ""a"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
44,"WITH ""t"" AS (SELECT ""player_id"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""t""), 2) AS ""fraction"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",""event_date"" FROM ""t"")"
45,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
46,"SELECT ROUND(SUM(""flag"")/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",""next_date"",""row_num"",CASE WHEN ""next_date"" - ""event_date""=1 THEN 1 ELSE 0 END AS ""flag"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""Activity"") AS ""t1"") AS ""t2"" WHERE ""row_num""=1"
47,"SELECT ROUND(COUNT(DISTINCT ""A2"".""PLAYER_ID"")/COUNT(DISTINCT ""A1"".""PLAYER_ID""), 2) AS ""FRACTION"" FROM (SELECT DISTINCT ""PLAYER_ID"",MIN(""EVENT_DATE"") AS ""FIRST_LOGIN"" FROM ""ACTIVITY"" GROUP BY ""PLAYER_ID"") AS ""A1"" LEFT JOIN ""ACTIVITY"" AS ""A2"" ON ""A1"".""PLAYER_ID""=""A2"".""PLAYER_ID"" AND ""A1"".""FIRST_LOGIN""+1=""A2"".""EVENT_DATE"""
48,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""b"".""event_date"" - ""a"".""event_date""=1 AND ""a"".""player_id""=""b"".""player_id"""
49,"WITH ""player_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""date"" FROM ""Activity"" GROUP BY 1), ""main"" AS (SELECT ""p"".""player_id"" FROM ""player_login"" AS ""p"" JOIN ""activity"" AS ""a"" ON ""p"".""player_id""=""a"".""player_id"" AND ""p"".""date"" + INTERVAL '1 DAY'=""a"".""event_date"") SELECT ROUND((SELECT COUNT(1) FROM ""main"")/COUNT(DISTINCT (""player_id"")), 2) AS ""fraction"" FROM ""activity"""
50,"SELECT ROUND(COUNT(DISTINCT ""temp"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
51,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"" - INTERVAL '1 DAY') IN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"")"
52,"SELECT ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""Activity"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""first_login""=1"
53,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""min_date""=""t2"".""event_date"" - INTERVAL '1 DAY'"
54,"SELECT ROUND(COUNT(""table2"".""player_id"")/COUNT(""table1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""table1"" LEFT JOIN ""activity"" AS ""table2"" ON ""table1"".""player_id""=""table2"".""player_id"" AND ""table1"".""first_login""=""table2"".""event_date""-1"
55,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" AS ""a"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"""
56,"WITH ""a"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(SUM(CASE WHEN ""Activity"".""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" JOIN ""a"" ON ""Activity"".""player_id""=""a"".""player_id"""
57,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"" - INTERVAL '1 DAY') IN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"")"
58,"WITH ""nactivity"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""drank"" FROM ""activity""), ""second_day"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""nactivity"" AS ""a1"" JOIN ""nactivity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date"" + INTERVAL '1 DAY' AND ""a1"".""drank""=1) SELECT ROUND((SELECT COUNT(1) FROM ""second_day"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
59,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""c"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""a1"" LEFT JOIN ""cte"" AS ""c"" ON ""c"".""player_id""=""a1"".""player_id"" AND ""a1"".""event_date"" - ""c"".""event_date""=1"
60,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rownum"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""activity"") AS ""t"" WHERE ""rownum""=1 AND ""diff""=1"
61,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""min_date""=""b"".""event_date""-1"
62,"WITH ""a"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM (SELECT ""player_id"",""event_date"" FROM ""activity"" GROUP BY ""player_id"",""event_date"") AS ""t"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""a1"".""rk""=1 AND ""a2"".""event_date"" IS NOT NULL THEN ""a1"".""player_id"" END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM ""a"" AS ""a1"" LEFT JOIN ""a"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date"" - ""a2"".""event_date""=-1"
63,"SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""a"".""event_date"",""a"".""player_id"" FROM ""Activity"" AS ""a"" JOIN (SELECT MIN(""event_date"") AS ""eventdate"",""player_id"" FROM ""Activity"" GROUP BY ""player_id"") AS ""act"" ON ""a"".""player_id""=""act"".""player_id"" AND ""a"".""event_date""=""act"".""eventdate""+1) AS ""res"""
64,"SELECT ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""Activity"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""first_login""=1"
65,"SELECT ROUND(SUM(CASE WHEN ""temp"".""mindate""+1=""a"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""mindate"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"" JOIN ""Activity"" AS ""a"" ON ""a"".""player_id""=""temp"".""player_id"""
66,"SELECT ROUND((COUNT(""f"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity"")), 2) AS ""fraction"" FROM ""activity"" AS ""f"" JOIN ""activity"" AS ""s"" ON ""f"".""player_id""=""s"".""player_id"" AND (""s"".""event_date""-""f"".""event_date"")=1 WHERE ROW(""f"".""player_id"",""f"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""activity"" GROUP BY ""player_id"")"
67,"SELECT ROUND(""cn""/""c"", 2) AS ""fraction"" FROM (SELECT COUNT(""t1"".""player_id"") AS ""cn"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" JOIN ""Activity"" ON ""Activity"".""player_id""=""t1"".""player_id"" AND ""T1"".""EVENT_DATE"" + INTERVAL '1 DAY'=""Activity"".""event_date"") AS ""t2"", (SELECT COUNT(DISTINCT ""player_id"") AS ""c"" FROM ""Activity"") AS ""t3"""
68,"WITH ""firsts"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""Activity"") SELECT ROUND(1.0*COUNT(DISTINCT CASE WHEN ""first_login"" + INTERVAL '1 DAY'=""event_date"" THEN ""player_id"" ELSE NULL END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""firsts"""
69,"WITH ""temp"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY 1) SELECT ROUND(COUNT(DISTINCT ""y"".""player_id"")/COUNT(DISTINCT ""x"".""player_id""), 2) AS ""fraction"" FROM ""temp"" AS ""x"" LEFT JOIN ""activity"" AS ""y"" ON ""x"".""player_id""=""y"".""player_id"" AND ""x"".""event_date"" - ""y"".""event_date""=-1"
70,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" RIGHT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""first_date""+1=""b"".""event_date"""
71,"SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") AS ""A"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""tom"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") AS ""a"" WHERE ""tom"" - ""event_date""=1 AND ""rnk""=1)/(SELECT COUNT(DISTINCT ""player_id"") AS ""B"" FROM ""activity""), 2) AS ""fraction"" FROM ""activity"" LIMIT 1"
72,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
73,"WITH ""cte"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""RNK"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""after"" FROM ""Activity""), ""cte2"" AS (SELECT ""player_id"" FROM ""cte"" WHERE ""RNK""=1 AND ""after"" - ""event_date""=1) SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte2"""
74,"SELECT ROUND(""z"".""c""/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (""Activity"" AS ""a"") JOIN (SELECT COUNT(""a1"".""player_id"") AS ""c"" FROM (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") AS ""a1"", (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date"" - ""a2"".""event_date""=1) AS ""z"""
75,"WITH ""temp1"" AS (SELECT ""player_id"",""device_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"",LEAD(""event_date"", 1, NULL) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login_date"" FROM ""Activity""), ""temp2"" AS (SELECT ""player_id"" FROM ""temp1"" WHERE ""date_rank""=1 AND ""next_login_date"" - ""event_date""=1) SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""temp2"""
76,"SELECT ROUND(COUNT(DISTINCT ""a2"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""Activity"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""first_login""=1"
77,"WITH ""cte"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""count1"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1, 0) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") AS ""t"" WHERE ""next_day"" - ""event_date""=1 AND ""rnk""=1) SELECT ROUND(""cte"".""count1""/COUNT(DISTINCT ""Activity"".""player_id""), 2) AS ""fraction"" FROM (""Activity"") JOIN ""cte"""
78,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""next_date"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"" WHERE ""rnk""=1"
79,"WITH ""f"" AS (SELECT ""n"".""player_id"",MIN(""n"".""event_date"") AS ""first"",CASE WHEN ""n"".""nex"" IS NULL THEN 0 WHEN ""n"".""nex"" - ""n"".""event_date""=1 THEN 1 ELSE 0 END AS ""w"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nex"" FROM ""activity"") AS ""n"" GROUP BY 1) SELECT ROUND(SUM(""w""=1)/COUNT(1), 2) AS ""fraction"" FROM ""f"""
80,"SELECT ROUND(COUNT(DISTINCT ""temp"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
81,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ranking"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""t"".""event_date"" - ""u"".""event_date""=1 AND ""t"".""ranking""=2 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""t"".""player_id""), 2) AS ""fraction"" FROM ""temp"" AS ""t"" JOIN ""temp"" AS ""u"" ON ""t"".""player_id""=""u"".""player_id"""
82,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
83,"SELECT ROUND(COUNT(DISTINCT ""B"".""player_id"")/COUNT(DISTINCT ""A"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""mineventdate"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"" LEFT JOIN ""Activity"" AS ""B"" ON ""A"".""player_id""=""B"".""player_id"" AND ""A"".""mineventdate""=""B"".""event_date""-1"
84,"WITH ""a"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""firstday"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""diffdate""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT *,""event_date"" - ""firstday"" AS ""diffdate"" FROM ""a"") AS ""new"""
85,"SELECT ROUND(COUNT(DISTINCT ""first_login"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login_dt"" FROM ""Activity"" GROUP BY ""player_id"") AS ""first_login"" LEFT JOIN (SELECT ""player_id"",""event_date"" AS ""nxt_login_dt"" FROM ""Activity"") AS ""nxt_login"" ON ""first_login"".""player_id""=""nxt_login"".""player_id"" AND ""first_login"".""first_login_dt""+1=""nxt_login"".""nxt_login_dt"" WHERE ""nxt_login_dt"" IS NOT NULL"
86,"WITH ""tb1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id""), ""tb2"" AS (SELECT ""a"".""player_id"",""a"".""event_date"",""a"".""event_date""-""tb1"".""min_date"" AS ""tag"" FROM (""Activity"" AS ""a"") JOIN ""tb1"" WHERE ""a"".""player_id""=""tb1"".""player_id"") SELECT DISTINCT ROUND((COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity"")), 2) AS ""fraction"" FROM ""tb2"" WHERE ""tag""=1"
87,"WITH ""a"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(SUM(CASE WHEN ""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""Activity"".""player_id""), 2) AS ""fraction"" FROM ""a"" JOIN ""Activity"" ON ""a"".""player_id""=""Activity"".""player_id"""
88,"WITH ""tot_players"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""next_date"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""tot_players"" WHERE ""row_num""=1"
89,"SELECT ROUND(""t"".""count1""/COUNT(DISTINCT ""a_full"".""player_id""), 2) AS ""fraction"" FROM (""activity"" AS ""a_full"") JOIN (SELECT COUNT(DISTINCT ""a1"".""player_id"") AS ""count1"" FROM ""activity"" AS ""a1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a2"" ON ""a1"".""event_date"" - ""a2"".""first_date""=1 AND ""a1"".""player_id""=""a2"".""player_id"" WHERE ""a2"".""player_id"" IS NOT NULL) AS ""t"""
90,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
91,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"" - INTERVAL '1 DAY'"
92,"WITH ""table1"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""table1"" WHERE ""lead_date"" - ""event_date""=1 AND ""rnk""=1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
93,"SELECT ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""first_login""=1"
94,"SELECT ROUND(SUM(CASE WHEN ""t1"".""first_login""+1=""t2"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"""
95,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""r"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""Activity"") SELECT ROUND(((SELECT COUNT(DISTINCT ""player_id"") FROM ""cte"" WHERE ""r""=1 AND ""diff""=1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity"")), 2) AS ""fraction"""
96,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""log"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""log"" ON ""a"".""player_id""=""log"".""player_id"" AND ""a"".""event_date""=""log"".""first_login""+1"
97,"SELECT ROUND(SUM(CASE WHEN ""b"".""player_id"" IS NULL THEN 0 ELSE 1 END)/COUNT(1), 2) AS ""fraction"" FROM (SELECT ""a"".""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" AS ""a"" GROUP BY 1) AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""first_date"" + INTERVAL '1 DAY'"
98,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
99,"WITH ""cte"" AS (SELECT *,LEAD(""event_date"", 1, ""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_event_date"" FROM ""Activity"") SELECT ROUND(COALESCE(SUM(CASE WHEN ""next_event_date"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 0), 2) AS ""fraction"" FROM ""cte"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY 1)"
100,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""first_date""=""b"".""event_date""-1"
101,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""device_id"",""event_date"",""games_played"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""t"" WHERE ""next_login_date""-""event_date""=1 AND ""rnk""=1"
102,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rownum"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""activity"") AS ""t"" WHERE ""rownum""=1 AND ""diff""=1"
103,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
104,"SELECT ROUND(COUNT(DISTINCT (""tbl2"".""player_id""))/COUNT(DISTINCT (""tbl1"".""player_id"")), 2) AS ""fraction"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""first_login"" FROM ""activity"") AS ""tbl1"" LEFT JOIN ""activity"" AS ""tbl2"" ON ""tbl1"".""player_id""=""tbl2"".""player_id"" AND ""tbl2"".""event_date"" - ""tbl1"".""first_login""=1"
105,"SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""login_rank"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""activity"") AS ""login_table"" WHERE ""login_table"".""login_rank""=1 AND ""login_table"".""next_login"" IS NOT NULL AND ""login_table"".""next_login"" - ""login_table"".""event_date""=1"
106,"SELECT ROUND(SUM(CASE WHEN ""event_date"" - INTERVAL '1 DAY'=""prev_day"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LAG(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""prev_day"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""log_in_rank"" FROM ""Activity"") AS ""t"" WHERE ""log_in_rank""<=2"
107,"SELECT ROUND((SUM(CASE WHEN ""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id"")), 2) AS ""fraction"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""activity"") AS ""t"""
108,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""act"".""player_id""), 2) AS ""fraction"" FROM (SELECT * FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""previous"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""num"" FROM ""activity"") AS ""a"" WHERE ""num""=1 AND ""previous""=""event_date""+1) AS ""b"", ""activity"" AS ""act"""
109,"SELECT ROUND(COUNT(""D1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_day"" FROM ""Activity"" GROUP BY ""player_id"") AS ""D1"" JOIN ""Activity"" AS ""D2"" ON ""D2"".""event_date"" - ""D1"".""first_day""=1 AND ""D1"".""player_id""=""D2"".""player_id"""
110,"WITH ""t1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY 1), ""t2"" AS (SELECT ""player_id"" FROM ""t1"" WHERE ROW(""player_id"",""first_login"" + INTERVAL '1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""activity"")) SELECT ROUND((SELECT COUNT(1) FROM ""t2"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
111,"SELECT ROUND(COUNT(DISTINCT CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN ""t1"".""player_id"" ELSE NULL END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t2"".""event_date"" - ""t1"".""event_date""=1 AND ""t1"".""player_id""=""t2"".""player_id"""
112,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LAG(""event_date"", 1, NULL) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""prev_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"" FROM ""Activity"") AS ""temp"" WHERE ""event_date"" - ""prev_date""=1 AND ""date_rank""=2"
113,"SELECT ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_event_date"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""b"".""event_date"" - ""a"".""min_event_date""=1 AND ""a"".""player_id""=""b"".""player_id"""
114,"SELECT ROUND(SUM(CASE WHEN ""t1"".""event_date""=""t2"".""first_login""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""t1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"""
115,"SELECT ROUND(COUNT(DISTINCT CASE WHEN ""r""=1 AND ""d""=1 THEN ""player_id"" ELSE NULL END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""a"".*,LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""d"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""r"" FROM ""activity"" AS ""a"") AS ""abc"""
116,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""min_date""=""t2"".""event_date""-1"
117,"WITH ""A"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""min_dt"" FROM ""activity"" GROUP BY 1) SELECT ROUND(SUM(CASE WHEN EXISTS (SELECT 1 FROM ""A"" WHERE ""A"".""min_dt""+1=""b"".""event_date"" AND ""A"".""player_id""=""b"".""player_id"") THEN 1 ELSE 0 END)/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""b"""
118,"SELECT ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""event_date"" - ""b"".""event_date""=-1 AND ""a"".""player_id""=""b"".""player_id"" WHERE ROW(""a"".""player_id"",""a"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"")"
119,"WITH ""sub"" AS (SELECT * FROM (SELECT ""player_id"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",""event_date"" FROM ""Activity"") AS ""tmp"" WHERE ""rnk"" IN (1,2)), ""cnt"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""cnt"" FROM ""Activity"") SELECT ROUND(COUNT(""s1"".""player_id"")/""cnt"", 2) AS ""fraction"" FROM (""sub"" AS ""s1"" JOIN ""sub"" AS ""s2"" USING (""player_id"")) JOIN ""cnt"" WHERE ""s2"".""event_date"" - ""s1"".""event_date""=1"
120,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""date_diff"" FROM ""Activity"") AS ""r"" WHERE ""rn""=1 AND ""date_diff""=1"
121,"WITH ""temp"" AS (SELECT *,LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""LEAD_"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""RANK_"" FROM ""Activity"") SELECT ROUND((""temp2"".""active"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""temp""), 2) AS ""fraction"" FROM (SELECT COUNT(DISTINCT ""player_id"") AS ""active"" FROM ""temp"" WHERE ""LEAD_"" - ""event_date""=1 AND ""RANK_""=1) AS ""temp2"""
122,"SELECT ROUND(COUNT(DISTINCT ""a1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""event_date""+1=""a2"".""event_date"" AND ""a1"".""player_id""=""a2"".""player_id"" WHERE ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"")"
123,"WITH ""datecalc"" AS (SELECT DISTINCT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""second_day"" FROM ""Activity""), ""firstlogindate"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id""), ""logged"" AS (SELECT COUNT(DISTINCT ""a"".""Player_id"") AS ""logged"" FROM (""datecalc"" AS ""a"") JOIN ""firstlogindate"" AS ""b"" WHERE ""a"".""second_day"" - ""a"".""event_date""=1 AND ""a"".""event_date""=""b"".""min_date"" AND ""a"".""player_id""=""b"".""player_id""), ""totalp"" AS (SELECT COUNT(DISTINCT ""Player_id"") AS ""total"" FROM ""datecalc"") SELECT ROUND(""logged""/""total"", 2) AS ""fraction"" FROM (""logged"") JOIN ""totalp"""
124,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
125,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""t"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""t"".""event_date""=1"
126,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"" - INTERVAL ''1' DAY'"
127,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
128,"WITH ""t3"" AS (SELECT COUNT(""player_id"") AS ""count_player_consec"" FROM (SELECT ""player_id"",SUM(""consec_or_not"") AS ""player_consec"" FROM (SELECT ""player_id"",CASE WHEN ""num""=1 THEN 1 ELSE 0 END AS ""consec_or_not"" FROM (SELECT ""player_id"",""event_date"" - MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""num"" FROM ""Activity"") AS ""t0"") AS ""t1"" GROUP BY ""player_id"") AS ""t2"" WHERE ""player_consec""!=0), ""t5"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""count_player"" FROM ""Activity"") SELECT ROUND(""count_player_consec""/""count_player"", 2) AS ""fraction"" FROM ""t3"" JOIN ""t5"""
129,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
130,"SELECT ROUND(SUM(CASE WHEN ""event_date""-1=""first_time"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_time"" FROM ""Activity"") AS ""sub"""
131,"SELECT ROUND(COUNT(DISTINCT ""a1"".""player_id"")/COUNT(DISTINCT ""a2"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY 1) AS ""a1"" RIGHT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""min_date""=""a2"".""event_date"" - INTERVAL '1 DAY'"
132,"WITH ""table1"" AS (SELECT *,RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""Activity""), ""table2"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""num_players"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/""table2"".""num_players"", 2) AS ""fraction"" FROM (""table1"") JOIN ""table2"" WHERE ""rk""=1 AND ""diff""=1"
133,"WITH ""cte"" AS (SELECT DISTINCT ""a"".""player_id"",""a"".""event_date"" AS ""first_login"",""b"".""event_date"" AS ""next_login"" FROM ""activity"" AS ""a"" JOIN ""activity"" AS ""b"" WHERE ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""event_date""+1), ""cte2"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id""), ""cte3"" AS (SELECT ""cte"".""player_id"" FROM ""cte"" JOIN ""cte2"" WHERE ""cte"".""player_id""=""cte2"".""player_id"" AND ""cte"".""first_login""=""cte2"".""first_login"") SELECT ROUND(COUNT(DISTINCT ""cte3"".""player_id"")/COUNT(DISTINCT ""activity"".""player_id""), 2) AS ""fraction"" FROM ""cte3"" JOIN ""activity"""
134,"WITH ""temp"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""activity"" GROUP BY 1) SELECT ROUND(COUNT(""a"".""player_id"")/(SELECT COUNT(1) FROM ""temp""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" JOIN ""temp"" AS ""t"" ON ""a"".""player_id""=""t"".""player_id"" AND ""a"".""event_date""=""t"".""first_date""+1"
135,"SELECT ROUND(COUNT(DISTINCT ""return_user"")/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""a"".""player_id"",""a"".""event_date"" AS ""first_date"",""b"".""player_id"" AS ""return_user"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date"" + INTERVAL '1 DAY'=""b"".""event_date"") AS ""c"""
136,"SELECT ROUND(COUNT(DISTINCT ""t1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") AS ""t1"" WHERE ""event_date""=""first_date"" AND ""next_date""=""event_date"" + INTERVAL '1 DAY'"
137,"WITH ""cte"" AS (SELECT ""player_id"",""rowNum"",""nextEvent"" - ""event_date"" AS ""nextEventDiff"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rowNum"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextEvent"" FROM ""Activity"") AS ""z"" WHERE ""rowNum""=1 AND ""nextEvent"" - ""event_date""=1) SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""cte"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
138,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
139,"WITH ""temp"" AS (SELECT ""player_id"" FROM (SELECT *,LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""activity"") AS ""t"" WHERE ""next_login"" - ""event_date""=1 AND ""rn""=1) SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""temp"""
140,"WITH ""a"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""d"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND((COUNT(""player_id"")/(SELECT COUNT(1) FROM ""a"")), 2) AS ""fraction"" FROM (SELECT ""a"".""player_id"" FROM (""a"") JOIN ""Activity"" AS ""a1"" WHERE ""a"".""player_id""=""a1"".""player_id"" AND ""a"".""d""+1=""a1"".""event_date"") AS ""t1"""
141,"SELECT ROUND(CAST(COUNT(DISTINCT CASE WHEN ""flag""=1 THEN ""player_id"" ELSE NULL END) AS FLOAT)/CAST(COUNT(DISTINCT ""player_id"") AS FLOAT), 2) AS ""fraction"" FROM (SELECT ""player_id"",CASE WHEN (LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date""))=""event_date"" + INTERVAL '1 DAY' AND (MIN(""event_date"") OVER (PARTITION BY ""player_id"")=""event_date"") THEN 1 ELSE 0 END AS ""flag"" FROM ""Activity"") AS ""a"""
142,"WITH ""table1"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""table1"" WHERE ""lead_date"" - ""event_date""=1 AND ""rnk""=1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
143,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
144,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""minddt"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""minddt""=""b"".""event_date""-1"
145,"WITH ""total_customer"" AS (SELECT COUNT(1) AS ""total_num"" FROM (SELECT DISTINCT ""player_id"" FROM ""activity"") AS ""temp""), ""customer_first_login_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""start_date"" FROM ""activity"" GROUP BY 1), ""customer_login_next_day"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""login_net_date_num"" FROM (SELECT ""a1"".""player_id"",""a1"".""start_date"",""a2"".""event_date"" FROM ""customer_first_login_date"" AS ""a1"" JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""start_date""=1) AS ""temp"") SELECT ROUND(COALESCE(((SELECT ""login_net_date_num"" FROM ""customer_login_next_day"")/(SELECT ""total_num"" FROM ""total_customer"")), 0), 2) AS ""fraction"""
146,"SELECT ROUND(SUM(CASE WHEN ""nextday"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT *,LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextday"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""day_rank"" FROM ""Activity"") AS ""base"" WHERE ""day_rank""=1"
147,"WITH ""temp_first"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1 ORDER BY 1,""event_date"") SELECT ROUND(COUNT(""t"".""player_id"")/(SELECT COUNT(1) FROM ""temp_first""), 2) AS ""fraction"" FROM (SELECT ""t"".""player_id"" AS ""player_id"" FROM ""temp_first"" AS ""t"" JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" WHERE ""a"".""event_date"" - ""t"".""event_date""=1) AS ""t"""
148,"SELECT ROUND(COUNT(DISTINCT ""min_table"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") AS ""min_date"" FROM ""Activity"" AS ""a1"" GROUP BY ""a1"".""player_id"") AS ""min_table"" JOIN ""Activity"" AS ""a2"" ON ""min_table"".""player_id""=""a2"".""player_id"" AND ""min_table"".""min_date"" + INTERVAL '1 DAY'=""a2"".""event_date"""
149,"WITH ""first_log"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1) SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""fl"".""player_id""), 2) AS ""fraction"" FROM ""first_log"" AS ""fl"" LEFT JOIN ""Activity"" AS ""a"" ON ""fl"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""fl"".""event_date""=1"
150,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
151,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/(COUNT(DISTINCT ""a"".""player_id"")), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"" - INTERVAL '1 DAY'"
152,"SELECT ROUND(COUNT(""f"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""f"" ON ""a"".""event_date"" - ""f"".""first_login""=1 AND ""a"".""player_id""=""f"".""player_id"""
153,"WITH ""a1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""joindate"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""joindate"" + INTERVAL '1 DAY'"
154,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" GROUP BY 1) SELECT ROUND(COUNT(1)/(SELECT COUNT(1) FROM ""cte""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" JOIN ""cte"" AS ""b"" ON ""a"".""event_date"" - ""b"".""min_date""=1 AND ""a"".""player_id""=""b"".""player_id"""
155,"SELECT ROUND(COUNT(DISTINCT (""temp2"".""player_id""))/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""temp"".""player_id"",""first_date"",""a2"".""event_date"" FROM (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") AS ""first_date"" FROM ""Activity"" AS ""a1"" GROUP BY ""a1"".""player_id"") AS ""temp"" JOIN ""Activity"" AS ""a2"" ON ""temp"".""player_id""=""a2"".""player_id"" AND ""first_date""+1=""a2"".""event_date"") AS ""temp2"""
156,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
157,"WITH ""nactivity"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""drank"" FROM ""activity""), ""second_day"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""nactivity"" AS ""a1"" JOIN ""nactivity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date"" + INTERVAL '1 DAY' AND ""a1"".""drank""=1) SELECT ROUND((SELECT COUNT(1) FROM ""second_day"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
158,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
159,"SELECT ROUND(""cn""/""c"", 2) AS ""fraction"" FROM (SELECT COUNT(""t1"".""player_id"") AS ""cn"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" JOIN ""Activity"" ON ""Activity"".""player_id""=""t1"".""player_id"" AND ""T1"".""EVENT_DATE"" + INTERVAL '1 DAY'=""Activity"".""event_date"") AS ""t2"", (SELECT COUNT(DISTINCT ""player_id"") AS ""c"" FROM ""Activity"") AS ""t3"""
160,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""device_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ldate"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""Activity"") AS ""a"" WHERE ""a"".""event_date""+1=""a"".""ldate"" AND ""rn""=1"
161,"SELECT ROUND(COUNT(DISTINCT ""d0"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""d0"" JOIN ""Activity"" AS ""d1"" WHERE ((""d1"".""event_date""-""d0"".""event_date"")=1) AND (""d1"".""player_id""=""d0"".""player_id"")"
162,"SELECT ROUND(COALESCE(SUM(""if_login_day2"")/COUNT(1), 0), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"",CASE WHEN LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date""=1 THEN 1 ELSE 0 END AS ""if_login_day2"" FROM ""Activity"") AS ""sub"" WHERE ""event_date""=""first_login"""
163,"SELECT ROUND(COUNT(DISTINCT (""a1"".""player_id""))/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""activity""), 2) AS ""fraction"" FROM ""activity"" AS ""a1"" JOIN (SELECT MIN(""event_date"") AS ""first_date"",""player_id"" AS ""pid"" FROM ""activity"" AS ""a1"" GROUP BY ""pid"") AS ""fdt"" ON ""a1"".""event_date"" - ""fdt"".""first_date""=1 AND ""fdt"".""pid""=""a1"".""player_id"""
164,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""-""a"".""event_date""=1 AND ROW(""a"".""player_id"",""a"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""activity"" GROUP BY ""player_id"")"
165,"SELECT ROUND(COUNT(DISTINCT CASE WHEN ""date_rank""=1 AND ""days_since_first_login""=-1 THEN ""player_id"" END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"",""event_date""-LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""days_since_first_login"" FROM ""Activity"") AS ""a"""
166,"SELECT ROUND(COUNT(""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""firstday"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" WHERE ""b"".""event_date"" - ""a"".""firstday""=1"
167,"WITH ""CTE_0"" AS (SELECT ""PLAYER_ID"",MIN(""EVENT_DATE"") AS ""FIRST_LOGIN"" FROM ""ACTIVITY"" GROUP BY ""PLAYER_ID""), ""CTE_1"" AS (SELECT COUNT(DISTINCT ""A"".""PLAYER_ID"") AS ""P_COUNT"" FROM (""ACTIVITY"" AS ""A"") JOIN ""CTE_0"" AS ""C0"" WHERE ""A"".""PLAYER_ID""=""C0"".""PLAYER_ID"" AND EXISTS (SELECT 'X' FROM ""ACTIVITY"" AS ""AA"" WHERE ""AA"".""PLAYER_ID""=""A"".""PLAYER_ID"" AND ""AA"".""EVENT_DATE""=""C0"".""FIRST_LOGIN"" + INTERVAL '1 DAY')), ""CTE_2"" AS (SELECT COUNT(DISTINCT ""PLAYER_ID"") AS ""TOT_COUNT"" FROM ""ACTIVITY"") SELECT ROUND(""C1"".""P_COUNT""/""C2"".""TOT_COUNT"", 2) AS ""FRACTION"" FROM (""CTE_1"" AS ""C1"") JOIN ""CTE_2"" AS ""C2"""
168,"WITH ""FirstLogin"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id""), ""NextLogin"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""Activity""), ""Retention"" AS (SELECT ""NL"".""player_id"",CASE WHEN ""NL"".""next_login"" - ""NL"".""event_date""=1 THEN 1 ELSE 0 END AS ""day1retention"" FROM ""NextLogin"" AS ""NL"" JOIN ""FirstLogin"" AS ""FL"" ON ""FL"".""player_id""=""NL"".""player_id"" AND ""FL"".""first_login""=""NL"".""event_date"") SELECT ROUND(SUM(""day1retention"")/COUNT(""player_id""), 2) AS ""fraction"" FROM ""Retention"""
169,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead1"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""lead1"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"" WHERE ""row_num""=1"
170,"WITH ""first_activity"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") SELECT ROUND(SUM(CASE WHEN ""t2"".""player_id"" IS NULL THEN 0 ELSE 1 END)/COUNT(1), 2) AS ""fraction"" FROM (SELECT DISTINCT ""player_id"" FROM ""activity"") AS ""t1"" LEFT JOIN (SELECT DISTINCT ""t1"".""player_id"" FROM ""first_activity"" AS ""t1"" JOIN ""activity"" AS ""t2"" ON ""t2"".""player_id""=""t1"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""event_date""=1) AS ""t2"" ON ""t2"".""player_id""=""t1"".""player_id"""
171,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""first_login""=1"
172,"SELECT ROUND(COUNT(DISTINCT ""t1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_time"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" JOIN ""Activity"" AS ""a"" ON ""t1"".""player_id""=""a"".""player_id"" AND ""t1"".""first_time""=""a"".""event_date""-1"
173,"WITH ""tot_players"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""next_date"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""tot_players"" WHERE ""row_num""=1"
174,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT ""t2"".""player_id"")/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""rk""=1 AND ""t2"".""rk""=2 AND ""t2"".""event_date"" - ""t1"".""event_date""=1"
175,"SELECT ROUND(COUNT(DISTINCT ""t"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""t"" JOIN ""activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""first_login""+1=""a"".""event_date"""
176,"WITH ""cte"" AS (SELECT ""a"".""player_id"",""a"".""event_date"",""fl"" FROM ""activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""fl"" FROM ""activity"" GROUP BY 1) AS ""b"" ON ""a"".""player_id""=""b"".""player_id"") SELECT ROUND(SUM(CASE WHEN TIMESTAMPDIFF(DAY, ""fl"", ""event_date"")=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"""
177,"SELECT ROUND(SUM(CASE WHEN ""a"".""event_date""+1=""b"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"""
178,"SELECT ROUND(COUNT(DISTINCT ""a2"".""player_id"")*1.0/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""first_date""=1"
179,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rownum"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""activity"") AS ""t"" WHERE ""rownum""=1 AND ""diff""=1"
180,"WITH ""cte1"" AS (SELECT DISTINCT ""a1"".""player_id"",""a1"".""event_date"" AS ""login_date"",""a2"".""event_date"" AS ""next_login"" FROM ""Activity"" AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""+1=""a2"".""event_date""), ""cte2"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" AS ""a"" GROUP BY ""player_id""), ""cte3"" AS (SELECT DISTINCT ""cte2"".""player_id"" FROM ""cte1"" JOIN ""cte2"" ON ""cte1"".""player_id""=""cte2"".""player_id"" AND ""cte1"".""login_date""=""cte2"".""first_login"") SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte3"""
181,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/(COUNT(DISTINCT ""a"".""player_id"")), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"" - INTERVAL '1 DAY'"
182,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN ""t2"".""player_id"" ELSE NULL END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""rk""=1 AND ""t2"".""rk""=2 AND ""t2"".""event_date"" - ""t1"".""event_date""=1"
183,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"") JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"" WHERE ""a"".""event_date"" - ""temp"".""first_login""=1 AND ""a"".""player_id""=""temp"".""player_id"""
184,"SELECT ROUND(CAST(COUNT(DISTINCT CASE WHEN ""flag""=1 THEN ""player_id"" ELSE NULL END) AS FLOAT)/CAST(COUNT(DISTINCT ""player_id"") AS FLOAT), 2) AS ""fraction"" FROM (SELECT ""player_id"",CASE WHEN (MIN(""event_date"") OVER (PARTITION BY ""player_id"")=""event_date"" + INTERVAL '-1 DAY') THEN 1 ELSE 0 END AS ""flag"" FROM ""Activity"") AS ""a"""
185,"SELECT ROUND(""cnt""/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT COUNT(DISTINCT ""player_id"") AS ""cnt"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""t"" WHERE ""next_day"" - ""event_date""=1 AND ""rnk""=1) AS ""temp"""
186,"WITH ""first_login_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" AS ""a"" JOIN ""first_login_date"" AS ""fld"" ON ""a"".""player_id""=""fld"".""player_id"" AND ""a"".""event_date""=""fld"".""event_date""+1"
187,"SELECT ROUND(COUNT(DISTINCT (CASE WHEN ""b"".""event_date"" IS NOT NULL THEN ""a"".""player_id"" ELSE NULL END))/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""first_date""=1"
188,"SELECT ROUND(CAST(COUNT(DISTINCT CASE WHEN ""flag""=1 THEN ""player_id"" ELSE NULL END) AS FLOAT)/CAST(COUNT(DISTINCT ""player_id"") AS FLOAT), 2) AS ""fraction"" FROM (SELECT ""player_id"",CASE WHEN (MIN(""event_date"") OVER (PARTITION BY ""player_id"")=""event_date"" + INTERVAL '-1 DAY') THEN 1 ELSE 0 END AS ""flag"" FROM ""Activity"") AS ""a"""
189,"(SELECT ROUND(COUNT(DISTINCT ""A2"".""player_id"")/COUNT(DISTINCT ""A1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A1"" LEFT JOIN ""Activity"" AS ""A2"" ON ""A1"".""player_id""=""A2"".""player_id"" AND ""A1"".""event_date"" - ""A2"".""event_date""=-1)"
190,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""next_day"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"" WHERE ""row_num""=1"
191,"SELECT ROUND(SUM(CASE WHEN ""a"".""event_date""=""f_lg"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""f_lg"" FROM ""Activity"" GROUP BY 1) AS ""a1"" ON ""a"".""player_id""=""a1"".""player_id"""
192,"WITH ""min_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT (CASE WHEN ""b"".""event_date"" IS NOT NULL THEN ""a"".""player_id"" ELSE NULL END))/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""min_date"" AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""first_date""=1"
193,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"""
194,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""login"" FROM ""Activity"" GROUP BY 1) AS ""temp"" LEFT JOIN ""Activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date""-""temp"".""login""=1"
195,"WITH ""A"" AS (SELECT MIN(""event_date"") AS ""min_date"",""player_id"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""A"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""A"" JOIN ""Activity"" ON ""A"".""player_id""=""Activity"".""player_id"" AND ""A"".""min_date""+1=""Activity"".""event_date"""
196,"SELECT ROUND(COUNT(DISTINCT ""a1"".""player_id"")/COUNT(DISTINCT ""a2"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY 1) AS ""a1"" RIGHT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""min_date""=""a2"".""event_date"" - INTERVAL '1 DAY'"
197,"SELECT ROUND(COUNT(DISTINCT (CASE WHEN ""B"".""PLAYER_ID"" IS NOT NULL THEN ""B"".""PLAYER_ID"" END))/COUNT(1), 2) AS ""FRACTION"" FROM (SELECT ""PLAYER_ID"",MIN(""EVENT_DATE"") AS ""FIRST_EVENT"" FROM ""ACTIVITY"" GROUP BY ""PLAYER_ID"") AS ""A"" LEFT JOIN ""ACTIVITY"" AS ""B"" ON ""A"".""PLAYER_ID""=""B"".""PLAYER_ID"" AND ""A"".""FIRST_EVENT""=""B"".""EVENT_DATE"" + INTERVAL '-1 DAY'"
198,"WITH ""cte1"" AS (SELECT ""a"".""player_id"",""a"".""event_date"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""r1"" FROM ""activity"") AS ""a"" WHERE ""a"".""r1"" IN (1,2)), ""cte2"" AS (SELECT COUNT(DISTINCT ""a"".""player_id"") AS ""c1"" FROM (""cte1"" AS ""a"") JOIN ""cte1"" AS ""b"" WHERE ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""event_date""=1), ""cte3"" AS (SELECT COUNT(DISTINCT (""player_id"")) AS ""c2"" FROM ""activity"") SELECT ROUND(""a"".""c1""/""b"".""c2"", 2) AS ""fraction"" FROM (""cte2"" AS ""a"") JOIN ""cte3"" AS ""b"""
199,"WITH ""a"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"",(""event_date""-LAG(""event_date"") OVER (PARTITION BY ""player_id"")) AS ""diff_of_one"" FROM ""activity"") SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""a"" WHERE ""row_num""=2 AND ""diff_of_one""=1"
200,"WITH ""first_data"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""a"".""player_id"")/(SELECT COUNT(""player_id"") FROM ""first_data""), 2) AS ""fraction"" FROM ""Activity"" AS ""a"" LEFT JOIN ""first_data"" AS ""f"" ON ""a"".""player_id""=""f"".""player_id"" WHERE ""a"".""event_date"" - ""f"".""first_login""=1"
201,"WITH ""stat"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND((SELECT COUNT(DISTINCT ""a2"".""player_id"") FROM ""Activity"" AS ""a2"" JOIN ""stat"" ON ""a2"".""event_date"" - ""stat"".""first_login""=1 AND ""a2"".""player_id""=""stat"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
202,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
203,"WITH ""temp_table"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""login_order"",""event_date""-LAG(""event_date"") OVER (PARTITION BY ""player_id"") AS ""days_next_login"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""login_order""=2 AND ""days_next_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""temp_table"""
204,"SELECT ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""b"".""event_date"" - ""first_login""=1 AND ""a"".""player_id""=""b"".""player_id"""
205,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date""-1"
206,"SELECT ROUND(SUM(CASE WHEN ""a"".""event_date""+1=""b"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"""
207,"WITH ""cte1"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"" FROM ""activity""), ""cte2"" AS (SELECT COUNT(DISTINCT ""cte1"".""player_id"") AS ""player_id"" FROM ""cte1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_day"" FROM ""activity"" GROUP BY 1) AS ""f"" ON ""cte1"".""player_id""=""f"".""player_id"" AND ""cte1"".""event_date""=""f"".""first_day"" WHERE ""cte1"".""next_day"" - ""cte1"".""event_date""=1) SELECT ROUND((SELECT ""player_id"" FROM ""cte2"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
208,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(1), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""activity"" GROUP BY 1) AS ""f"" LEFT JOIN ""activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" + INTERVAL '-1 DAY'=""f"".""first_date"" AND ""a"".""player_id"" IS NOT NULL"
209,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" RIGHT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""first_date""+1=""b"".""event_date"""
210,"SELECT ROUND(SUM(CASE WHEN ""a1"".""event_date""=""a2"".""event_date""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT (""a1"".""player_id"")), 2) AS ""fraction"" FROM ""Activity"" AS ""a1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"""
211,"WITH ""cte"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_event_date"" FROM ""Activity"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""cte"" WHERE ""event_date"" - ""first_event_date""=1)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""Activity"""
212,"WITH ""t"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rw_num"" FROM ""Activity"" GROUP BY 1,2 ORDER BY 1,2) SELECT ROUND(SUM(CASE WHEN ""event_date_2"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",""rw_num"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_2"" FROM ""t"") AS ""a"" WHERE ""rw_num""=1"
213,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" RIGHT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""first_date""+1=""b"".""event_date"""
214,"SELECT ROUND(SUM(CASE WHEN ""a2"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(0), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"",MIN(""event_date"")+1 AS ""day_after_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a2"".""player_id""=""a1"".""player_id"" AND ""a2"".""event_date""=""a1"".""day_after_login"""
215,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""first_login""=1"
216,"WITH ""a"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ordered_days"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"" FROM ""Activity""), ""b"" AS (SELECT ""player_id"",""event_date"",""next_day"" FROM ""a"" WHERE ""ordered_days""=1 AND ""event_date"" - ""next_day""=-1) SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""b"""
217,"SELECT ROUND((SELECT COUNT(DISTINCT ""a1"".""player_id"") FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""event_date""=""a2"".""event_date""-1 AND ""a1"".""player_id""=""a2"".""player_id"" WHERE ""a2"".""player_id"" IS NOT NULL)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
218,"SELECT ROUND(COUNT(DISTINCT ""t"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""t"" JOIN ""activity"" AS ""a"" ON ""t"".""event_date""=""a"".""event_date"" - INTERVAL '1 DAY' AND ""t"".""player_id""=""a"".""player_id"""
219,"WITH ""first_login"" AS (SELECT ""a"".""player_id"",MIN(""a"".""event_date"") AS ""first_login"" FROM ""activity"" AS ""a"" GROUP BY 1), ""lead_date"" AS (SELECT ""f"".""player_id"",""f"".""first_login"",""a"".""event_date""-""f"".""first_login"" AS ""event_datediff"" FROM ""first_login"" AS ""f"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""player_id""=""f"".""player_id"" AND ""a"".""event_date""!=""f"".""first_login"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""event_datediff""=1 THEN ""player_id"" END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""lead_date"""
220,"WITH ""t"" AS (SELECT ""a1"".""player_id"" FROM ""activity"" AS ""a1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY 1) AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""=""a2"".""event_date"" + INTERVAL '1 DAY') SELECT CAST(CAST(COUNT(DISTINCT ""player_id"") AS DECIMAL(18, 2))/CAST((SELECT COUNT(DISTINCT ""player_id"") FROM ""activity"") AS DECIMAL(18, 2)) AS DECIMAL(4, 2)) AS ""fraction"" FROM ""t"""
221,"WITH ""temp"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY 1) SELECT ROUND(SUM(CASE WHEN ""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"""
222,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") AS ""A"" WHERE ""next_date""=""event_date"" + INTERVAL '1 DAY' AND ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"")"
223,"WITH ""temp1"" AS (SELECT *,""event_date""-LAG(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""diff"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""number"" FROM ""activity""), ""temp2"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""player_num"" FROM ""activity"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/""temp2"".""player_num"", 2) AS ""fraction"" FROM (""temp1"") JOIN ""temp2"" WHERE ""diff""=1 AND ""number""<=2"
224,"SELECT ROUND(COUNT(DISTINCT ""t1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""min_date"",LAG(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""prev_date"" FROM ""Activity"") AS ""t1"" WHERE ""prev_date""=""min_date"" AND ""event_date""=""prev_date"" + INTERVAL '1 DAY'"
225,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""min_date"" FROM ""Activity"") SELECT ROUND(SUM(""event_date""=""min_date""+1)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"""
226,"SELECT ROUND(SUM(CASE WHEN ""t1"".""event_date""-""t2"".""first_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""t1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"""
227,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""min_dates"", ""activity"" AS ""a"") JOIN ""activity"" AS ""b"" WHERE ""a"".""player_id""=""min_dates"".""player_id"" AND ""a"".""event_date"" - ""min_dates"".""event_date""=1"
228,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"" - INTERVAL '1 DAY') IN (SELECT ""player_id"",MIN(""event_date"") AS ""FIRST_LOGIN"" FROM ""Activity"" GROUP BY ""player_id"")"
229,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"" LEFT JOIN ""Activity"" AS ""a"" ON ""min_date""+1=""a"".""event_date"" AND ""a"".""player_id""=""temp"".""player_id"""
230,"WITH ""nactivity"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""drank"" FROM ""activity""), ""second_day"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""nactivity"" AS ""a1"" JOIN ""nactivity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date"" + INTERVAL '1 DAY' AND ""a1"".""drank""=1) SELECT ROUND((SELECT COUNT(1) FROM ""second_day"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
231,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/(COUNT(DISTINCT ""a"".""player_id"")), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"" - INTERVAL '1 DAY'"
232,"WITH ""fl"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""activity"") SELECT ROUND(COUNT(CASE WHEN ""event_date""=""first_login""+1 THEN 1 ELSE NULL END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""fl"""
233,"SELECT ROUND((COUNT(""b"".""player_id"")/COUNT(""a"".""player_id"")), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_logged"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""-""a"".""first_logged""=1"
234,"WITH ""cteY"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""Y"" FROM ""Activity""), ""cteX"" AS (SELECT COUNT(""a"".""event_date"") AS ""X"" FROM (SELECT ""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""dateorder"" FROM ""Activity"") AS ""a"" WHERE ""a"".""dateorder""=1 AND CASE WHEN COALESCE(""a"".""next_date"", 0)=""a"".""event_date"" + INTERVAL '1 DAY' THEN TRUE ELSE FALSE END) SELECT ROUND(""cteX"".""X""/""cteY"".""Y"", 2) AS ""fraction"" FROM (""cteY"") JOIN ""cteX"" WHERE 1=1"
235,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
236,"WITH ""consecutive"" AS (SELECT ""a2"".""player_id"",""a2"".""event_date"" FROM (""activity"" AS ""a1"") JOIN ""activity"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") FROM ""activity"" AS ""a1"" GROUP BY 1)) SELECT ROUND((SELECT COUNT(""player_id"") FROM ""consecutive"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
237,"SELECT ROUND(SUM(CASE WHEN ""a"".""first_login_date""+1=""b"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"""
238,"SELECT ROUND(SUM(CASE WHEN ""a"".""event_date""+1=""b"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"""
239,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lags"" FROM ""activity"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""cte"" WHERE ABS(""first_login""-""lags"")=1)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""activity"""
240,"SELECT ROUND(1-AVG(""activity"".""player_id"" IS NULL), 2) AS ""fraction"" FROM ""activity"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""first_date"" ON ""first_date"".""player_id""=""activity"".""player_id"" AND ""activity"".""event_date"" - ""first_date"".""min_date""=1"
241,"SELECT ROUND(SUM(""event_date"" - ""first_login""=1)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""Activity"") AS ""t"""
242,"SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity"" WHERE ROW(""player_id"",""event_date"" + INTERVAL '-1 DAY') IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id""))/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
243,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",LEAD(""event_date"", 1, NULL) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""p_day"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""D_min"" FROM ""Activity"") AS ""temp"" WHERE ""p_day"" - ""D_min""=1"
244,"WITH ""cte"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""cnt"" FROM (SELECT *,LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""num"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") AS ""a"" WHERE ""event_date""=""num""-1 AND ""rnk""=1) SELECT ROUND(""cnt""/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""cte"""
245,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
246,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lag_date"" FROM ""Activity"") AS ""a"" WHERE ""event_date""-""a"".""lag_date""=1"
247,"WITH ""cte"" AS (SELECT ""player_id"" FROM (SELECT ""player_id"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""Activity"") AS ""t"" WHERE ""next_date"" - ""event_date""=1 AND ""rn""=1) SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte"""
248,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""-""a"".""first_login""=1"
249,"WITH ""first_login"" AS (SELECT ""a"".""player_id"",""a"".""event_date"" FROM ""Activity"" AS ""a"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY 1) AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""first_login"" + INTERVAL '1 DAY') SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""first_login"""
250,"WITH ""consecutive"" AS (SELECT ""a2"".""player_id"",""a2"".""event_date"" FROM (""activity"" AS ""a1"") JOIN ""activity"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") FROM ""activity"" AS ""a1"" GROUP BY 1)) SELECT ROUND((SELECT COUNT(""player_id"") FROM ""consecutive"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
251,"SELECT ROUND(COUNT(DISTINCT ""t"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"" JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""event_date""=""a"".""event_date""-1"
252,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""first_login""=1"
253,"SELECT ROUND(COUNT(DISTINCT ""sub"".""player_id"")/COUNT(DISTINCT ""a0"".""player_id""), 2) AS ""fraction"" FROM (SELECT * FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead0"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank0"" FROM ""activity"") AS ""sub0"" WHERE ""lead0""-""event_date""=1 AND ""rank0""=1) AS ""sub"", ""activity"" AS ""a0"""
254,"SELECT ROUND(COUNT(""A1"".""PLAYER_ID"")/(SELECT COUNT(DISTINCT (""A3"".""PLAYER_ID"")) FROM ""ACTIVITY"" AS ""A3""), 2) AS ""fraction"" FROM (""ACTIVITY"" AS ""A1"") JOIN ""ACTIVITY"" AS ""A2"" WHERE ""A1"".""PLAYER_ID""=""A2"".""PLAYER_ID"" AND ""A1"".""EVENT_DATE""!=""A2"".""EVENT_DATE"" AND ""A2"".""EVENT_DATE"" - ""A1"".""EVENT_DATE""=1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""a3"".""player_id"",MIN(""a3"".""event_date"") FROM ""activity"" AS ""a3"" GROUP BY 1)"
255,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""loginRank"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""l2"".""event_date"" - ""l1"".""event_date""=1 THEN 1 ELSE 0 END)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"" FROM ""cte"" WHERE ""loginRank""=1) AS ""l1"" JOIN (SELECT ""player_id"",""event_date"" FROM ""cte"" WHERE ""loginRank""=2) AS ""l2"" ON ""l1"".""player_id""=""l2"".""player_id"""
256,"WITH ""f"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""f"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date"" + INTERVAL '-1 DAY'"
257,"WITH ""tot_player"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""next_date"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""tot_player"" WHERE ""row_num""=1"
258,"WITH ""cte1"" AS (SELECT COUNT(1) AS ""num"" FROM (SELECT ""player_id"",""device_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"") AS ""ld0"" FROM ""activity"") AS ""tbl"" WHERE ""ld0""-""event_date""=1 AND ""rnk""=1) SELECT ROUND(""num""/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""cte1"""
259,"WITH ""next_event"" AS (SELECT *,LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rak"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""next_date"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""next_event"" WHERE ""rak""=1"
260,"SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""login_rank"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""Activity"") AS ""login_table"" WHERE ""login_table"".""login_rank""=1 AND ""login_table"".""next_login"" IS NOT NULL AND ""login_table"".""next_login"" - ""login_table"".""event_date""=1"
261,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
262,"WITH ""events_rnked"" AS (SELECT *,DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""dt_rnk"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""e1"".""dt_rnk""=1 AND ""e2"".""event_date"" - ""e1"".""event_date""=1 THEN ""e1"".""player_id"" ELSE NULL END)/COUNT(DISTINCT ""e1"".""player_id""), 2) AS ""fraction"" FROM ""events_rnked"" AS ""e1"" JOIN ""events_rnked"" AS ""e2"" ON ""e1"".""player_id""=""e2"".""player_id"""
263,"WITH ""total_players"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""total_players"" FROM ""Activity""), ""players_signup_date"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""signup_date"" FROM ""Activity"" GROUP BY 1), ""players_login_day_after_signup"" AS (SELECT COUNT(""a"".""player_id"") AS ""players_login_day_after_signup"" FROM ""players_signup_date"" AS ""a"" JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""signup_date""=""b"".""event_date""-1) SELECT ROUND(""players_login_day_after_signup""/""total_players"", 2) AS ""fraction"" FROM ""players_login_day_after_signup"" LEFT JOIN ""total_players"" ON 1=1"
264,"SELECT ROUND(COALESCE(COUNT(""a2"".""player_id""), 0)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1"
265,"WITH ""T1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""T1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""T1"" JOIN ""Activity"" AS ""A"" ON ""T1"".""player_id""=""A"".""player_id"" AND ""event_date"" - ""first_login""=1"
266,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
267,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_log"" FROM ""activity"" GROUP BY 1), ""T1"" AS (SELECT ""player_id"",CASE WHEN ""event_date"" - ""first_log""=1 THEN 1 ELSE 0 END AS ""date_check"" FROM ""activity"" JOIN ""first_login"" USING (""player_id"")) SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM ""T1"" WHERE ""date_check""=1"
268,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity"") AS ""a"" WHERE ""next_date"" - ""event_date""=1 AND ""rnk""=1"
269,"SELECT ROUND(COUNT(DISTINCT ""t2"".""player_id"")/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
270,"WITH ""cte"" AS (SELECT ""a"".""player_id"",""a"".""event_date"",""fl"" FROM ""activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""fl"" FROM ""activity"" GROUP BY 1) AS ""b"" ON ""a"".""player_id""=""b"".""player_id"") SELECT ROUND(SUM(CASE WHEN TIMESTAMPDIFF(DAY, ""fl"", ""event_date"")=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"""
271,"WITH ""consecutive"" AS (SELECT ""a2"".""player_id"",""a2"".""event_date"" FROM (""activity"" AS ""a1"") JOIN ""activity"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") FROM ""activity"" AS ""a1"" GROUP BY 1)) SELECT ROUND((SELECT COUNT(""player_id"") FROM ""consecutive"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
272,"SELECT ROUND(COUNT(DISTINCT (""t"".""player_id""))/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",(""event_date""-LAG(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"")) AS ""dif"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""num"" FROM ""activity"") AS ""t"" WHERE ""dif""=1 AND ""num""=2"
273,"SELECT DISTINCT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT DISTINCT ""a"".""player_id"",MIN(""a"".""event_date"") AS ""event_date"" FROM ""activity"" AS ""a"" GROUP BY ""a"".""player_id"") AS ""b"" LEFT JOIN (SELECT DISTINCT ""a"".""player_id"",""a"".""event_date"" FROM ""activity"" AS ""a"") AS ""a"" ON ""b"".""player_id""=""a"".""player_id"" AND ""a"".""event_date""=""b"".""event_date""+1"
274,"WITH ""Ranked"" AS (SELECT ""player_id"",RANK() OVER ""w"" AS ""date_rank"",NTH_VALUE(""event_date"", 1) OVER ""w"" AS ""first_date"",NTH_VALUE(""event_date"", 2) OVER ""w"" AS ""second_date"" FROM ""Activity"" WINDOW ""w"" AS (PARTITION BY ""player_id"" ORDER BY ""event_date"")) SELECT ROUND(SUM(""first_date""+1=""second_date"" AND ""date_rank""=2)/SUM(""date_rank""=1), 2) AS ""fraction"" FROM ""Ranked"""
275,"WITH ""a1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""fraction"" FROM ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""first_login""+1"
276,"WITH ""a"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM (SELECT ""player_id"",""event_date"" FROM ""activity"" GROUP BY ""player_id"",""event_date"") AS ""t"") SELECT ROUND(COUNT(DISTINCT CASE WHEN ""a1"".""rk""=1 AND ""a2"".""event_date"" IS NOT NULL THEN ""a1"".""player_id"" END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM ""a"" AS ""a1"" LEFT JOIN ""a"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date"" - ""a2"".""event_date""=-1"
277,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""min_event_date"" FROM ""Activity"") SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""cte""), 2) AS ""fraction"" FROM ""cte"" WHERE ""event_date"" - ""next_event_date""=-1 AND ""event_date""=""min_event_date"""
278,"WITH ""consecutive"" AS (SELECT ""a2"".""player_id"",""a2"".""event_date"" FROM (""activity"" AS ""a1"") JOIN ""activity"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date""+1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") FROM ""activity"" AS ""a1"" GROUP BY 1)) SELECT ROUND((SELECT COUNT(""player_id"") FROM ""consecutive"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
279,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_date"" FROM ""Activity"") AS ""t"" WHERE ""event_date""=""first_date"" + INTERVAL '1 DAY'"
280,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""first_date""+1"
281,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_day"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""next_day"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" AS ""a"" JOIN ""cte"" ON ""cte"".""player_id""=""a"".""player_id"" AND ""a"".""event_date""=""cte"".""next_day"""
282,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""ld"" FROM ""activity"") AS ""a"", ""activity"" AS ""b"" WHERE ""rk""=1 AND ""ld"" - ""a"".""event_date""=1"
283,"SELECT ROUND(COUNT(DISTINCT ""A2"".""player_id"")/COUNT(DISTINCT ""A1"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""A1"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A2"" ON ""A1"".""player_id""=""A2"".""player_id"" AND ""A1"".""event_date""=""A2"".""first_date""+1"
284,"SELECT ROUND(SUM(CASE WHEN ""temp"".""min_date""+1=""a"".""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"""
285,"SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""login_rank"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"" FROM ""activity"") AS ""a"" WHERE ""next_login"" IS NOT NULL AND ""login_rank""=1 AND ABS(""event_date"" - ""next_login"")=1"
286,"SELECT ROUND(COUNT(DISTINCT ""a1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",""games_played"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""r"" FROM ""Activity"" AS ""a"") AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" WHERE (""a1"".""event_date"" + INTERVAL '1 DAY'=""a2"".""event_date"") AND (""a1"".""r""=1)"
287,"SELECT ROUND(COUNT(DISTINCT ""t"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT * FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead0"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""cn"" FROM ""Activity"") AS ""temp"" WHERE ""lead0""-""event_date""=1 AND ""cn""=1) AS ""t"", ""Activity"" AS ""a"""
288,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date""=""t1"".""first_login""+1"
289,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY 1) AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
290,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"""
291,"SELECT ROUND(COUNT(DISTINCT ""sub"".""player_id"")/COUNT(DISTINCT ""a0"".""player_id""), 2) AS ""fraction"" FROM (SELECT * FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead0"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank0"" FROM ""activity"") AS ""sub0"" WHERE ""lead0""-""event_date""=1 AND ""rank0""=1) AS ""sub"", ""activity"" AS ""a0"""
292,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
293,"SELECT ROUND((SELECT COUNT(DISTINCT ""a1"".""player_id"") FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" RIGHT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" WHERE ""a1"".""min_date"" - ""a2"".""event_date""=-1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
294,"WITH ""CTE"" AS (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"",""event_date""-MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""diff"" FROM ""Activity"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""CTE"" WHERE ""diff""=1)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""Activity"""
295,"SELECT ROUND(COUNT(""b"".""event_date"")/COUNT(1), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""event_date""=1"
296,"SELECT ROUND(COUNT(DISTINCT ""a1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" AS ""a1"" JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""event_date""=1 AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY 1)"
297,"WITH ""temp"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""num_logged"" FROM (SELECT *,""event_date""-LAG(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""diff"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""Activity"") AS ""t"" WHERE ""diff"" IS NOT NULL AND ""diff""=1 AND ""row_num""<=2 GROUP BY ""diff"") SELECT ROUND(""num_logged""/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""temp"""
298,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY 1) SELECT COALESCE(ROUND(AVG(CASE WHEN ""a"".""event_date"" IS NULL THEN 0 ELSE 1 END), 2), 0) AS ""fraction"" FROM ""cte"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""player_id""=""cte"".""player_id"" AND ""a"".""event_date"" - ""cte"".""first_login""=1"
299,"WITH ""A"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity""), ""B"" AS (SELECT ""player_id"",""event_date"",CASE WHEN ""next_login""-""event_date""=1 THEN 1 ELSE 0 END AS ""consecutive"" FROM ""a"" WHERE ""rnk""=1) SELECT ROUND(SUM(""consecutive"")/COUNT(1), 2) AS ""fraction"" FROM ""b"""
300,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""t"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""next_day"" FROM ""activity"" GROUP BY ""player_id"") AS ""t"" LEFT JOIN ""activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""t"".""next_day""=""a"".""event_date"""
301,"WITH ""t1"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity""), ""t2"" AS (SELECT ""player_id"",""event_date"" FROM ""t1"" WHERE ""rnk""=1), ""t3"" AS (SELECT ""t2"".""player_id"" FROM ""t2"" JOIN ""activity"" AS ""a"" ON ""t2"".""player_id""=""a"".""player_id"" AND ""t2"".""event_date"" + INTERVAL '1 DAY'=""a"".""event_date"") SELECT ROUND((SELECT COUNT(1) FROM ""t3"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
302,"SELECT ROUND(COUNT(DISTINCT CASE WHEN ""first_login""+1=""nextlogin"" THEN ""player_id"" END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",FIRST_VALUE(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""first_login"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextlogin"" FROM ""Activity"") AS ""A"""
303,"SELECT ROUND(COUNT(""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""grp"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""Activity"") AS ""L"" WHERE ""grp""=1 AND ""diff""=1"
304,"SELECT ROUND((SUM(CASE WHEN ""event_date"" - ""first_login""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id"")), 2) AS ""fraction"" FROM (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_login"" FROM ""activity"") AS ""t"""
305,"SELECT ROUND(COUNT(DISTINCT ""t1"".""player_id"")/""t2"".""total_players"", 2) AS ""fraction"" FROM (SELECT ""a"".""player_id"",""a"".""event_date"" FROM ((""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"") JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""login_1st"" FROM ""Activity"" GROUP BY ""player_id"") AS ""c"" WHERE ""a"".""player_id""=""b"".""player_id"" AND ABS(""a"".""event_date"" - ""b"".""event_date"")=1 AND ""a"".""player_id""=""c"".""player_id"" AND ""a"".""event_date""=""c"".""login_1st"") AS ""t1"", (SELECT COUNT(DISTINCT ""player_id"") AS ""total_players"" FROM ""Activity"") AS ""t2"""
306,"SELECT ROUND(COUNT(DISTINCT CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN ""t1"".""player_id"" ELSE NULL END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t2"".""event_date"" - ""t1"".""event_date""=1 AND ""t1"".""player_id""=""t2"".""player_id"""
307,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"""
308,"WITH ""first_login"" AS (SELECT ""player_id"",""event_date"" AS ""first_date"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rn"" FROM ""Activity"") AS ""a"" WHERE ""rn""=1) SELECT ROUND(SUM(CASE WHEN ""s"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""fraction"" FROM ""first_login"" AS ""f"" LEFT JOIN ""Activity"" AS ""s"" ON ""f"".""player_id""=""s"".""player_id"" AND ""s"".""event_date"" - ""f"".""first_date""=1"
309,"SELECT ROUND(COUNT(DISTINCT ""t2"".""player_id"")/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
310,"SELECT ROUND(COUNT(""player_id"")/COUNT(1), 2) AS ""fraction"" FROM (SELECT ""a"".""player_id"",""a"".""event_date"" FROM ""activity"" AS ""a"" RIGHT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""initial"" FROM ""activity"" GROUP BY ""player_id"") AS ""temp"" ON ""a"".""player_id""=""temp"".""player_id"" AND ""a"".""event_date""=""temp"".""initial""+1) AS ""temp2"""
311,"SELECT ROUND(SUM(CASE WHEN ""a"".""event_date""=""f_lg"" + INTERVAL '1 DAY' THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""f_lg"" FROM ""Activity"" GROUP BY 1) AS ""a1"" ON ""a"".""player_id""=""a1"".""player_id"""
312,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""t"".""player_id""), 2) AS ""fraction"" FROM (SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""first_log"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t"" LEFT JOIN ""Activity"" AS ""a"" ON ""t"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""t"".""first_log""=1"
313,"SELECT ROUND((SUM(CASE WHEN ""a1"".""event_date""=""a2"".""first_login_date""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a2"".""player_id"")), 2) AS ""fraction"" FROM ""activity"" AS ""a1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_login_date"" FROM ""activity"" GROUP BY 1) AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"""
314,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""player_id""=""temp"".""player_id"" AND ""a"".""event_date""=""min_date""+1"
315,"SELECT ROUND(COUNT(""a2"".""player_id"")/COUNT(""a1"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""+1=""a2"".""event_date"" WHERE ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"")"
316,"SELECT ROUND(COALESCE(SUM(CASE WHEN ROW(""player_id"",""event_date"" - INTERVAL '-1 DAY') IN (SELECT ""player_id"",""event_date"" FROM ""Activity"") THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 0), 2) AS ""fraction"" FROM ""Activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"")"
317,"SELECT ROUND(COUNT(CASE WHEN ""b"".""event_date"" IS NOT NULL THEN 1 END)/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY 1) AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date""=""a"".""event_date""+1"
318,"WITH ""first_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"",MIN(""event_date"")+1 AS ""target_date"" FROM ""Activity"" GROUP BY ""player_id""), ""second_logins"" AS (SELECT ""Activity"".""player_id"",""Activity"".""event_date"",CASE WHEN ""first_login"".""player_id"" IS NULL THEN 0 ELSE 1 END AS ""target_login"" FROM ""Activity"" LEFT JOIN ""first_login"" ON ""Activity"".""player_id""=""first_login"".""player_id"" AND ""Activity"".""event_date""=""first_login"".""target_date"") SELECT ROUND(SUM(""target_login"")/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""second_logins"""
319,"WITH ""cte1"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""drank"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS ""first_login"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte1"" WHERE ""drank""=2 AND ""event_date"" - ""first_login""=1"
320,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
321,"WITH ""T1"" AS (WITH ""LEAD_DAY_TABLE"" AS (SELECT *,MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""MIN_DAY"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""LEAD_DAY"" FROM ""Activity"") SELECT * FROM ""LEAD_DAY_TABLE"" WHERE ""LEAD_DAY""=""event_date"" + INTERVAL '1 DAY' AND ""event_date""=""MIN_DAY"") SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""Activity""), 2) AS ""fraction"" FROM ""T1"""
322,"WITH ""CTE1"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""CT1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""CTE1"" AS ""CT1"" JOIN ""Activity"" AS ""T2"" ON ""CT1"".""player_id""=""T2"".""player_id"" AND ""CT1"".""first_login""=""T2"".""event_date""-1"
323,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
324,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
325,"SELECT ROUND(((SELECT COUNT(1) FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",DATE(MIN(""event_date"")+1) FROM ""activity"" GROUP BY ""player_id"") GROUP BY ""player_id"") AS ""g"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity"")), 2) AS ""fraction"""
326,"WITH ""nd"" AS (SELECT ""player_id"",""device_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"",FIRST_VALUE(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""first_log"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""event_date"" - ""first_log""=1 THEN (1) ELSE 0 END)/(COUNT(DISTINCT ""player_id"")), 2) AS ""fraction"" FROM ""nd"""
327,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(""f"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""f"" LEFT JOIN ""Activity"" AS ""a"" ON ""a"".""event_date"" - ""f"".""first_date""=1 AND ""a"".""player_id""=""f"".""player_id"""
328,"WITH ""temp"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rk"" FROM ""Activity"") SELECT ROUND(COUNT(CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN ""t2"".""player_id"" ELSE NULL END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""temp"" AS ""t1"" LEFT JOIN ""temp"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""rk""=1 AND ""t2"".""rk""=2 AND ""t2"".""event_date"" - ""t1"".""event_date""=1"
329,"SELECT ROUND(COUNT(DISTINCT ""A"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" AS ""A"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""day"" FROM ""Activity"" GROUP BY ""player_id"") AS ""T"" ON ""A"".""player_id""=""T"".""player_id"" AND ""A"".""event_date""=""T"".""day""+1"
330,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""m"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t2"" RIGHT JOIN ""Activity"" AS ""t1"" ON ""t2"".""m""=""t1"".""event_date""-1 AND ""t1"".""player_id""=""t2"".""player_id"""
331,"WITH ""t1"" AS (SELECT ""player_id"",""event_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""activity""), ""t2"" AS (SELECT ""player_id"",""event_date"" FROM ""t1"" WHERE ""rnk""=1), ""t3"" AS (SELECT ""t2"".""player_id"" FROM ""t2"" JOIN ""activity"" AS ""a"" ON ""t2"".""player_id""=""a"".""player_id"" AND ""t2"".""event_date"" + INTERVAL '1 DAY'=""a"".""event_date"") SELECT ROUND((SELECT COUNT(1) FROM ""t3"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
332,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LAG(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lag_event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""min_event_date"" FROM ""Activity""), ""cte2"" AS (SELECT ""player_id"" FROM ""cte"" WHERE ""lag_event_date""=""event_date"" - INTERVAL '1 DAY' AND ""min_event_date""=""lag_event_date"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""cte2"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
333,"WITH ""cte"" AS (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""num"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextday"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""cte"" WHERE ""num""=1 AND ""nextday"" - ""event_date""=1"
334,"WITH ""cte"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_day"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""next_day"" - ""event_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""cte"" WHERE ""row_num""=1"
335,"SELECT ROUND(SUM(CASE WHEN ""first"".""player_id"" IS NULL THEN 0 ELSE 1 END)/COUNT(DISTINCT ""Activity"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""join_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""first"" ON ""first"".""player_id""=""Activity"".""player_id"" AND ""activity"".""event_date"" - ""first"".""join_date""=1"
336,"SELECT ROUND(SUM(CASE WHEN ""a"".""event_date""=""b"".""min_date""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_date"" FROM ""activity"" GROUP BY 1) AS ""b"" LEFT JOIN ""activity"" AS ""a"" ON ""a"".""player_id""=""b"".""player_id"""
337,"SELECT ROUND(SUM(CASE WHEN ""a2"".""player_id"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT MIN(""event_date"") AS ""event_date"",""player_id"" FROM ""activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date"" - ""a1"".""event_date""=1"
338,"WITH ""player_login"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""date"" FROM ""Activity"" GROUP BY 1), ""main"" AS (SELECT ""p"".""player_id"" FROM ""player_login"" AS ""p"" JOIN ""activity"" AS ""a"" ON ""p"".""player_id""=""a"".""player_id"" AND ""p"".""date"" + INTERVAL '1 DAY'=""a"".""event_date"") SELECT ROUND((SELECT COUNT(1) FROM ""main"")/COUNT(DISTINCT (""player_id"")), 2) AS ""fraction"" FROM ""activity"""
339,"SELECT ROUND(SUM(CASE WHEN ROW(""player_id"",""first_login"" + INTERVAL '1 DAY') IN (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"""
340,"SELECT ROUND(COUNT(1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rownum"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"" FROM ""activity"") AS ""t"" WHERE ""rownum""=1 AND ""diff""=1"
341,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") AS ""denom"" FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""first_L_I"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" JOIN (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") AS ""b"" ON ""a"".""first_L_I""=""b"".""event_date"" - INTERVAL '1 DAY' AND ""a"".""player_id""=""b"".""player_id"""
342,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
343,"SELECT ROUND(""act_user"".""u_loggedtwo""/COUNT(DISTINCT (""a1"".""player_id"")), 2) AS ""fraction"" FROM (SELECT COUNT(DISTINCT (""a"".""player_id"")) AS ""u_loggedtwo"" FROM (""activity"" AS ""a"") JOIN ""activity"" AS ""b"" WHERE ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date"" - ""b"".""event_date""=1 AND ""b"".""event_date""=(SELECT MIN(""event_date"") AS ""l_date"" FROM ""activity"" AS ""c"" WHERE ""c"".""player_id""=""b"".""player_id"" GROUP BY ""c"".""player_id"")) AS ""act_user"", ""activity"" AS ""a1"""
344,"WITH ""cte1"" AS (SELECT ""player_id"" AS ""d1"",MIN(""event_date"") AS ""mevent_date"" FROM ""Activity"" GROUP BY ""player_id""), ""cte2"" AS (SELECT ""a1"".""player_id"" AS ""s1"" FROM ""cte1"" JOIN ""Activity"" AS ""a1"" ON ""d1""=""a1"".""player_id"" AND ""cte1"".""mevent_date""+1=""a1"".""event_date"") SELECT ROUND(COUNT(DISTINCT (""s1""))/COUNT(DISTINCT (""d1"")), 2) AS ""fraction"" FROM (""cte2"") JOIN ""cte1"""
345,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_event"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""a"" WHERE ""rnk""=1 AND ""next_event"" - ""event_date""=1"
346,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (""Activity"" AS ""a"") JOIN (SELECT *,ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_num"",LAG(""event_date"" + INTERVAL '1 DAY', 1, 0) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") AS ""b"" WHERE ""b"".""event_date""=""b"".""next_date"" AND ""b"".""date_num""=2"
347,"SELECT ROUND(COUNT(""a1"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (""Activity"" AS ""a1"") JOIN ""Activity"" AS ""a2"" WHERE ""a2"".""event_date"" - ""a1"".""event_date""=1 AND ""a1"".""player_id""=""a2"".""player_id"" AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") FROM ""activity"" AS ""a1"" GROUP BY ""a1"".""player_id"")"
348,"WITH ""temp"" AS (SELECT *,LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead_"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank_"" FROM ""Activity"") SELECT ROUND(""x"".""active""/(SELECT COUNT(DISTINCT ""player_id"") FROM ""temp""), 2) AS ""fraction"" FROM (SELECT COUNT(DISTINCT ""player_id"") AS ""active"" FROM ""temp"" WHERE ""lead_"" - ""event_date""=1 AND ""rank_""=1) AS ""x"""
349,"SELECT ROUND(SUM(""event_date""=""min_date""+1)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""min_date"" FROM ""Activity"") AS ""t"""
350,"SELECT ROUND(COUNT(DISTINCT (""a2"".""player_id""))/COUNT(DISTINCT (""a1"".""player_id"")), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a1"" LEFT JOIN ""Activity"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""first_login""=""a2"".""event_date""-1"
351,"WITH ""a"" AS (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""row_num"" FROM ""Activity"") SELECT ROUND((SELECT COUNT(1) FROM (SELECT ""a1"".""player_id"",(""a2"".""event_date""-""a1"".""event_date"") AS ""diff"" FROM (""a"" AS ""a1"") JOIN ""a"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""row_num""=1 AND ""a2"".""row_num""=2 HAVING ""diff""=1) AS ""t"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
352,"SELECT ROUND(COALESCE(COUNT(""t2"".""player_id""), 0)/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""ACTIVITY"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""ACTIVITY"" AS ""t2"" ON ""t2"".""player_id""=""t1"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
353,"SELECT ROUND((SELECT COUNT(1) FROM (""Activity"" AS ""a"") JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY 1) AS ""t"" WHERE ""a"".""player_id""=""t"".""player_id"" AND ""a"".""event_date"" - ""t"".""first_date""=1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"""
354,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
355,"SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(""temp"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""login"" FROM ""Activity"" GROUP BY 1) AS ""temp"" LEFT JOIN ""Activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date""-""temp"".""login""=1"
356,"WITH ""CTE"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(""a"".""player_id"")/COUNT(""CTE"".""player_id""), 2) AS ""fraction"" FROM ""CTE"" LEFT JOIN ""Activity"" AS ""a"" ON ""CTE"".""player_id""=""a"".""player_id"" AND ""a"".""event_date""-""CTE"".""first_login""=1"
357,"WITH ""consecutive"" AS (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") + INTERVAL '1 DAY' AS ""event_date1"" FROM ""Activity"" GROUP BY ""player_id"",""event_date"") SELECT CAST(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id"") AS DECIMAL(5, 2)) AS ""fraction"" FROM ""Activity"" AS ""a"" LEFT JOIN ""consecutive"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""=""b"".""event_date1"""
358,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""first_login""=1"
359,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""Activity"") AS ""A"" WHERE ""next_date""=""event_date"" + INTERVAL '1 DAY' AND ""event_date""=(SELECT MIN(""event_date"") FROM ""Activity"" WHERE ""A"".""player_id""=""player_id"")"
360,"WITH ""tmp"" AS (SELECT ""player_id"",""device_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"" FROM ""activity"") SELECT ROUND(SUM(CASE WHEN ""next_date""-""first_date""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""tmp"""
361,"SELECT ROUND(COUNT(DISTINCT (""a1"".""player_id""))/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""Activity""), 2) AS ""fraction"" FROM (""Activity"" AS ""a1"") JOIN ""Activity"" AS ""a2"" WHERE ""a1"".""player_id""=""a2"".""player_id"" AND ""a1"".""event_date""+1=""a2"".""event_date"" AND ROW(""a1"".""player_id"",""a1"".""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"")"
362,"WITH ""a"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""firstday"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(SUM(CASE WHEN ""event_date"" - ""firstday""=1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""Activity"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" JOIN ""a"" ON ""a"".""player_id""=""Activity"".""player_id"""
363,"SELECT ROUND(SUM(CASE WHEN ""t1"".""event_date""=""t2"".""first_event""+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""t1"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""t1"" JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_event"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"""
364,"WITH ""t"" AS (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_login"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") SELECT ROUND(SUM(CASE WHEN ""next_login""-""event_date""=1 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""fraction"" FROM ""t"" WHERE ""rnk""=1"
365,"SELECT ROUND(CAST(COUNT(DISTINCT CASE WHEN ""flag""=1 THEN ""player_id"" ELSE NULL END) AS FLOAT)/CAST(COUNT(DISTINCT ""player_id"") AS FLOAT), 2) AS ""fraction"" FROM (SELECT ""player_id"",CASE WHEN (MIN(""event_date"") OVER (PARTITION BY ""player_id"")=""event_date"" + INTERVAL '-1 DAY') THEN 1 ELSE 0 END AS ""flag"" FROM ""Activity"") AS ""a"""
366,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
367,"WITH ""CTE"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COALESCE(COUNT(DISTINCT ""b"".""player_id""), 0)/COALESCE(COUNT(DISTINCT ""a"".""player_id""), 0), 2) AS ""fraction"" FROM ""CTE"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""event_date"" - ""first_login""=1"
368,"SELECT ROUND(SUM(CASE WHEN ""t2"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT (""t1"".""player_id"")), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t2"".""event_date"" - ""t1"".""event_date""=1"
369,"WITH ""cteY"" AS (SELECT COUNT(DISTINCT ""player_id"") AS ""Y"" FROM ""Activity""), ""cteX"" AS (SELECT COUNT(""a"".""event_date"") AS ""X"" FROM (SELECT ""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""dateorder"" FROM ""Activity"") AS ""a"" WHERE ""a"".""dateorder""=1 AND CASE WHEN COALESCE(""a"".""next_date"", 0)=""a"".""event_date"" + INTERVAL '1 DAY' THEN TRUE ELSE FALSE END) SELECT ROUND(""cteX"".""X""/""cteY"".""Y"", 2) AS ""fraction"" FROM (""cteY"") JOIN ""cteX"" WHERE 1=1"
370,"SELECT ROUND(SUM(CASE WHEN ""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT DISTINCT ""a"".""player_id"",""a"".""min_event_date"",""b"".""event_date"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""b"".""event_date""=""a"".""min_event_date""+1 AND ""a"".""player_id""=""b"".""player_id"") AS ""c"""
371,"SELECT ROUND(COUNT(DISTINCT CASE WHEN ""first_login""+1=""nextlogin"" THEN ""player_id"" END)/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""first_login"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""nextlogin"" FROM ""Activity"") AS ""A"""
372,"SELECT ROUND(""count_""/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT COUNT(""player_id"") AS ""count_"" FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""next_date"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank_"" FROM ""activity"") AS ""f"" WHERE ""event_date""=""next_date"" - INTERVAL '1 DAY' AND ""rank_""=1) AS ""c"""
373,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY 1) SELECT ROUND(COUNT(""b"".""player_id"")/COUNT(""a"".""player_id""), 2) AS ""fraction"" FROM ""cte"" AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""first_login""=1"
374,"SELECT ROUND(((SELECT COUNT(""player_id"") FROM (SELECT ""player_id"",""event_date"",MAX(""event_date"") - MIN(""event_date"") AS ""days"" FROM (SELECT ""player_id"",""event_date"",""event_date"" + INTERVAL '-(""date_rank""-1) DAY' AS ""date_group"" FROM (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""date_rank"" FROM ""Activity"") AS ""temp1"") AS ""temp2"" GROUP BY ""player_id"",""date_group"") AS ""temp3"" WHERE ROW(""player_id"",""event_date"") IN (SELECT ""player_id"",MIN(""event_date"") FROM ""Activity"" GROUP BY ""player_id"") AND ""days"">=1)/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity"")), 2) AS ""fraction"""
375,"WITH ""T1"" AS (SELECT ""A1"".""player_id"",MIN(""A1"".""event_date"") AS ""d1"",MIN(""A2"".""event_date"") AS ""d2"" FROM ""Activity"" AS ""A1"" LEFT JOIN ""Activity"" AS ""A2"" ON ""A2"".""event_date""=""A1"".""event_date""+1 AND ""A1"".""player_id""=""A2"".""player_id"" GROUP BY ""A1"".""player_id"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""T1"" WHERE ""d2"" - ""d1""=1"
376,"WITH ""temp"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""activity"" GROUP BY ""player_id"") SELECT ROUND(SUM(CASE WHEN ""first_login"" - ""event_date""=-1 THEN 1 ELSE 0 END)/COUNT(DISTINCT ""temp"".""player_id""), 2) AS ""fraction"" FROM ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""player_id""=""a"".""player_id"""
377,"SELECT ROUND(ROUND(SUM(CASE WHEN ""b"".""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(1), 2), 5) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN (SELECT DISTINCT ""player_id"",""event_date"" FROM ""Activity"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""b"".""event_date"" - ""a"".""event_date""=1"
378,"SELECT ROUND(COUNT(DISTINCT ""sub"".""player_id"")/COUNT(DISTINCT ""a0"".""player_id""), 2) AS ""fraction"" FROM (SELECT * FROM (SELECT ""player_id"",""event_date"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""lead0"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rank0"" FROM ""activity"") AS ""sub0"" WHERE ""lead0""-""event_date""=1 AND ""rank0""=1) AS ""sub"", ""activity"" AS ""a0"""
379,"WITH ""cte_first_date"" AS (SELECT ""player_id"",""event_date"" FROM (SELECT ""player_id"",""event_date"",ROW_NUMBER() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""event_date_rank"" FROM ""Activity"") AS ""r"" WHERE ""event_date_rank""=1) SELECT ROUND(""relogin_count""/""total_count"", 2) AS ""fraction"" FROM (SELECT COUNT(DISTINCT ""f"".""player_id"") AS ""relogin_count"" FROM ""cte_first_date"" AS ""f"" JOIN ""Activity"" AS ""a"" ON ""f"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""f"".""event_date""=1) AS ""r"" JOIN (SELECT COUNT(DISTINCT ""player_id"") AS ""total_count"" FROM ""Activity"") AS ""t"" ON 1=1"
380,"WITH ""first_loggin"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""first_loggin_date"" FROM ""Activity"") SELECT ROUND((SELECT COUNT(DISTINCT ""player_id"") FROM ""first_loggin"" WHERE ""event_date""=""first_loggin_date"" + INTERVAL '1 DAY')/(SELECT COUNT(DISTINCT ""player_id"") FROM ""first_loggin""), 2) AS ""fraction"""
381,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_log"" FROM ""activity"" GROUP BY ""player_id"") SELECT ROUND(SUM(CASE WHEN ""first_log""+1=""event_date"" THEN 1 ELSE 0 END)/COUNT(DISTINCT ""activity"".""player_id""), 2) AS ""fraction"" FROM ""activity"" JOIN ""cte"" ON ""activity"".""player_id""=""cte"".""player_id"""
382,"SELECT ROUND(COUNT(DISTINCT ""a3"".""player_id"")/COUNT(DISTINCT ""a1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""a1"" LEFT JOIN (SELECT * FROM (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"" FROM ""Activity"") AS ""a2"" WHERE ""rnk""=2) AS ""a3"" ON ""a1"".""player_id""=""a3"".""player_id"" AND ""a1"".""event_date""=""a3"".""event_date"" - INTERVAL '1 DAY'"
383,"SELECT ROUND(COUNT(DISTINCT (""temp2"".""player_id""))/(SELECT COUNT(DISTINCT (""player_id"")) FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""temp"".""player_id"",""first_date"",""a2"".""event_date"" FROM (SELECT ""a1"".""player_id"",MIN(""a1"".""event_date"") AS ""first_date"" FROM ""Activity"" AS ""a1"" GROUP BY ""a1"".""player_id"") AS ""temp"" JOIN ""Activity"" AS ""a2"" ON ""temp"".""player_id""=""a2"".""player_id"" AND ""first_date""+1=""a2"".""event_date"") AS ""temp2"""
384,"SELECT ROUND(SUM(CASE WHEN ""event_date"" IS NOT NULL THEN 1 ELSE 0 END)/COUNT(""player_id""), 2) AS ""fraction"" FROM (SELECT ""p1"".""player_id"",""firstlog"",""event_date"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""firstlog"" FROM ""Activity"" GROUP BY ""player_id"") AS ""p1"" LEFT JOIN ""Activity"" ON ""Activity"".""player_id""=""p1"".""player_id"" AND ""event_date"" - ""firstlog""=1) AS ""p2"""
385,"WITH ""next_day_log"" AS (SELECT ""player_id"",LEAD(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"")-""event_date"" AS ""date_diff"",RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""rnk"",""event_date"" FROM ""Activity"") SELECT ROUND(COUNT(DISTINCT ""nedl"".""player_id"")/COUNT(DISTINCT ""act"".""player_id""), 2) AS ""fraction"" FROM ""Activity"" AS ""act"" LEFT JOIN ""next_day_log"" AS ""nedl"" ON ""act"".""player_id""=""nedl"".""player_id"" AND ""act"".""event_date""=""nedl"".""event_date"" AND ""rnk""=1 AND ""date_diff""=1"
386,"SELECT ROUND(COUNT(""A"".""player_id"")/(SELECT COUNT(1) FROM (SELECT DISTINCT ""player_id"" FROM ""Activity"") AS ""TBL""), 2) AS ""fraction"" FROM (SELECT DISTINCT ""player_id"",MIN(""event_date"") + INTERVAL '1 DAY' AS ""test_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""A"", (SELECT ""player_id"",""test_date"" FROM (SELECT ""player_id"",""event_date"" AS ""test_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""min_date"" FROM ""Activity"" GROUP BY ""player_id"",""event_date"") AS ""X"" WHERE ""test_date"">""min_date"") AS ""B"" WHERE ""A"".""player_id""=""B"".""player_id"" AND ""A"".""test_date""=""B"".""test_date"""
387,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",""event_date"",LAG(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""pre_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""min_event_date"" FROM ""activity"") AS ""tmpt"" WHERE ""event_date"" - ""pre_date""=1 AND ""pre_date""=""min_event_date"""
388,"SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM (SELECT ""player_id"",LEAD(""event_date"", 1) OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") - ""event_date"" AS ""diff"",MIN(""event_date"") OVER (PARTITION BY ""player_id"")=""event_date"" AS ""compare_min"" FROM ""Activity"") AS ""t"" WHERE ""diff""=1 AND ""compare_min""=TRUE"
389,"SELECT ROUND(COUNT(""t2"".""player_id"")/COUNT(""t1"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") AS ""t1"" LEFT JOIN ""Activity"" AS ""t2"" ON ""t1"".""player_id""=""t2"".""player_id"" AND ""t1"".""first_login""=""t2"".""event_date""-1"
390,"SELECT ROUND(COUNT(DISTINCT ""a"".""player_id"")/COUNT(DISTINCT ""b"".""player_id""), 2) AS ""fraction"" FROM ((SELECT DISTINCT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""temp"", ""Activity"" AS ""a"") JOIN ""Activity"" AS ""b"" WHERE ""temp"".""player_id""=""a"".""player_id"" AND ""a"".""event_date"" - ""temp"".""event_date""=1"
391,"WITH ""min_date_tmp"" AS (SELECT ""player_id"",""event_date"",MIN(""event_date"") OVER (PARTITION BY ""player_id"") AS ""min_date"" FROM ""activity"") SELECT ROUND(COUNT(DISTINCT ""p1"".""player_id"")/COUNT(DISTINCT ""p2"".""player_id""), 2) AS ""fraction"" FROM ""activity"" AS ""p2"" LEFT JOIN ""min_date_tmp"" AS ""p1"" ON ""p1"".""player_id""=""p2"".""player_id"" AND ""p2"".""event_date"" - ""p1"".""min_date""=1"
392,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""event_date"" FROM ""Activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""Activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""event_date""+1=""b"".""event_date"""
393,"SELECT ROUND(COUNT(DISTINCT ""b"".""player_id"")/COUNT(DISTINCT ""a"".""player_id""), 2) AS ""fraction"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""min_event_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""a"" LEFT JOIN ""activity"" AS ""b"" ON ""a"".""player_id""=""b"".""player_id"" AND ""a"".""min_event_date""=""b"".""event_date""-1"
394,"SELECT ROUND((SELECT COUNT(DISTINCT ""a"".""player_id"") AS ""n_con"" FROM (SELECT ""player_id"",MIN(""event_date"") AS ""firstdate"" FROM ""activity"" GROUP BY ""player_id"") AS ""temp"" JOIN ""activity"" AS ""a"" ON ""temp"".""firstdate""+1=""a"".""event_date"" AND ""a"".""player_id""=""temp"".""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
395,"WITH ""temp1"" AS (SELECT ""player_id"",""event_date"",DENSE_RANK() OVER (PARTITION BY ""player_id"" ORDER BY ""event_date"") AS ""drank"" FROM ""activity""), ""next_day"" AS (SELECT ""a1"".""player_id"",""a1"".""event_date"" FROM ""temp1"" AS ""a1"" JOIN ""temp1"" AS ""a2"" ON ""a1"".""player_id""=""a2"".""player_id"" AND ""a2"".""event_date""=""a1"".""event_date"" + INTERVAL '1 DAY' AND ""a1"".""drank""=1) SELECT ROUND((SELECT COUNT(1) FROM ""next_day"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""activity""), 2) AS ""fraction"""
396,"WITH ""cte"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_login"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND((COUNT(DISTINCT ""c"".""player_id"")/COUNT(DISTINCT ""a"".""player_id"")), 2) AS ""fraction"" FROM ""Activity"" AS ""a"" LEFT JOIN ""cte"" AS ""c"" ON ""a"".""player_id""=""c"".""player_id"" AND ""a"".""event_date"" - ""c"".""first_login""=1"
397,"WITH ""T"" AS (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""Activity"" GROUP BY ""player_id"") SELECT ROUND(COUNT(DISTINCT ""player_id"")/(SELECT COUNT(DISTINCT ""player_id"") FROM ""Activity""), 2) AS ""fraction"" FROM ""Activity"" JOIN ""T"" USING (""player_id"") WHERE ""event_date"" - ""first_date""=1"
398,"WITH ""t"" AS (SELECT ""a"".*,""b"".""first_date"",CASE WHEN ""a"".""event_date"" - ""b"".""first_date""=1 THEN 1 ELSE 0 END AS ""flag"" FROM ""activity"" AS ""a"" LEFT JOIN (SELECT ""player_id"",MIN(""event_date"") AS ""first_date"" FROM ""activity"" GROUP BY ""player_id"") AS ""b"" ON ""a"".""player_id""=""b"".""player_id"") SELECT ROUND(SUM(""flag"")/COUNT(DISTINCT ""player_id""), 2) AS ""fraction"" FROM ""t"""
