id,original query
1,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
2,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
3,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
4,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(""rating""<3)/COUNT(""rating""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
5,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
6,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
7,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
8,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/SUM(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
9,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
10,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
11,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
12,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
13,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
14,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
15,"SELECT ""query_name"",ROUND(AVG(""quality""), 2) AS ""quality"",ROUND(AVG(""poor"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating""/""position"" AS ""quality"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor"" FROM ""Queries"") AS ""t"" GROUP BY ""query_name"""
16,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
17,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""result"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
18,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
19,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
20,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""poorrating"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""position"",""rating"",(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END) AS ""poorrating"" FROM ""queries"") AS ""temp"" GROUP BY ""query_name"""
21,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
22,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
23,"SELECT ""query_name"",COALESCE(ROUND(AVG(""rating""/""position""), 2), 0) AS ""quality"",COALESCE(ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2), 0) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
24,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
25,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
26,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
27,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
28,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM (SELECT DISTINCT * FROM ""queries"") AS ""q"" GROUP BY 1"
29,"SELECT ""t"".""query_name"",ROUND(AVG(""quality""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""r"".""rating""<3 THEN 1 ELSE 0 END)/COUNT(""r"".""rating"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating""/""position"" AS ""quality"" FROM ""queries"") AS ""t"", ""queries"" AS ""r"" WHERE ""r"".""query_name""=""t"".""query_name"" GROUP BY ""t"".""query_name"""
30,"WITH ""temp"" AS (SELECT ""query_name"",""rating""/""position"" AS ""quality"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor"" FROM ""queries"") SELECT ""query_name"",ROUND(AVG(""quality""), 2) AS ""quality"",ROUND(AVG(""poor"")*100, 2) AS ""poor_query_percentage"" FROM ""temp"" GROUP BY ""query_name"""
31,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
32,"SELECT ""a"".""query_name"",ROUND(AVG(""a"".""rating""/""a"".""position""), 2) AS ""quality"",COALESCE(ROUND(""b"".""coun""/COUNT(1)*100, 2), 0.00) AS ""poor_query_percentage"" FROM ""Queries"" AS ""a"" LEFT JOIN (SELECT ""query_name"",COUNT(1) AS ""coun"" FROM ""Queries"" WHERE ""rating""<3 GROUP BY ""query_name"") AS ""b"" ON ""a"".""query_name""=""b"".""query_name"" GROUP BY ""a"".""query_name"""
33,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
34,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
35,"ERROR: mysql parse error: line 1 column 5 near ""round(sum(case when rating < 3 then 1 else 0 end)/count(q.query_name)*100,2) as poor_query_percentage from Queries q group by q.query_name "" "
36,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
37,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
38,"SELECT DISTINCT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
39,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
40,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
41,"SELECT ""query_name"",ROUND(AVG(""new_rate""), 2) AS ""quality"",ROUND(SUM(""rating_1"")/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating""/""position"" AS ""new_rate"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""rating_1"" FROM ""Queries"") AS ""a"" GROUP BY ""query_name"""
42,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
43,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
44,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
45,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
46,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
47,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
48,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
49,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
50,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
51,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
52,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
53,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
54,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
55,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
56,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
57,"SELECT ""query_name"",ROUND((SUM(""rating""/""position"")/COUNT(""query_name"")), 2) AS ""quality"",ROUND(100*(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
58,"SELECT ""a"".""query_name"",""a"".""qua"" AS ""quality"",ROUND(""poor""*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""rating""), 2) AS ""qua"" FROM ""queries"" GROUP BY ""query_name"") AS ""a"" JOIN (SELECT ""query_name"",(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")) AS ""poor"" FROM ""queries"" GROUP BY ""query_name"") AS ""b"" ON ""a"".""query_name""=""b"".""query_name"""
59,"SELECT ""query_name"",ROUND((SUM(""rating""/""position"")/COUNT(1)), 2) AS ""quality"",COALESCE(ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE NULL END)/COUNT(1))*100, 2), 0) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
60,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
61,"SELECT ""q1"".""query_name"",ROUND(AVG(""q1"".""rating""/""q1"".""position""), 2) AS ""quality"",ROUND(COUNT(DISTINCT ""q2"".""result"")/COUNT(DISTINCT ""q1"".""result"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q1"" LEFT JOIN (SELECT ""query_name"",""result"" FROM ""queries"" WHERE ""rating""<3) AS ""q2"" ON ""q1"".""query_name""=""q2"".""query_name"" GROUP BY ""q1"".""query_name"""
62,"SELECT ""query_name"",ROUND(AVG(""r""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT *,""rating""/""position"" AS ""r"" FROM ""Queries"") AS ""a"" GROUP BY ""query_name"""
63,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
64,"SELECT ""query_name"",ROUND((SUM(""rating""/""position"")/COUNT(1)), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""rating"" END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
65,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
66,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
67,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
68,"ERROR: mysql parse error: line 1 column 344 near ""as t1 left join (select query_name,count(*) as cnt from Queries group by query_name) as t2 on t1.query_name = t2.query_name ) "" "
69,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
70,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
71,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
72,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
73,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
74,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
75,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(""rating""<3)/COUNT(""rating""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
76,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
77,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
78,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
79,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
80,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",COALESCE(ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(""query_name"")*100, 2), 0.00000) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
81,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
82,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
83,"SELECT DISTINCT ""query_name"",""quality"",ROUND(""num_good_results""*100/""num_query_results"", 2) AS ""poor_query_percentage"" FROM (SELECT *,ROUND(AVG(""rating""/""position"") OVER (PARTITION BY ""query_name""), 2) AS ""quality"",COUNT(""result"") OVER (PARTITION BY ""query_name"") AS ""num_query_results"",COUNT(CASE WHEN ""rating""<3 THEN 1 END) OVER (PARTITION BY ""query_name"") AS ""num_good_results"" FROM ""Queries"") AS ""query_results_table"""
84,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
85,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
86,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(CASE WHEN ""rating"">2 THEN 0 ELSE 1 END), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
87,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
88,"SELECT ""query_name"",COALESCE(ROUND(AVG(""rating""/""position""), 2), 0.00) AS ""quality"",COALESCE(ROUND(AVG(""rating""<3)*100, 2), 0.00) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
89,"WITH ""t1"" AS (SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1) SELECT * FROM ""t1"""
90,"SELECT ""query_name"",ROUND(AVG((""rating""/""position"")), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
91,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
92,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
93,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
94,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
95,"SELECT ""query_name"",ROUND(AVG(""rating""*100/""position""), 0)/100 AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
96,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
97,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
98,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
99,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
100,"SELECT DISTINCT (""Q"".""query_name""),ROUND(AVG(""Q"".""quality""), 2) AS ""quality"",ROUND((SUM(""Q"".""quality_index"")/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating"",""rating""/""position"" AS ""quality"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""quality_index"" FROM ""Queries"") AS ""Q"" GROUP BY ""query_name"""
101,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
102,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
103,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""position""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
104,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
105,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
106,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((COUNT(CASE WHEN ""rating""<3 THEN 1 ELSE NULL END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
107,"WITH ""cte"" AS (SELECT ""query_name"",""result"",""position"",""rating"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""status"" FROM ""queries"") SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND((SUM(""status"")/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""cte"" GROUP BY ""query_name"""
108,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
109,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
110,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
111,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
112,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
113,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
114,"SELECT ""query_name"",ROUND(SUM(""quality"")/COUNT(1), 2) AS ""quality"",ROUND((SUM(""poor"")/COUNT(1)*100), 2) AS ""poor_query_percentage"" FROM (SELECT *,""rating""/""position"" AS ""quality"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor"" FROM ""queries"") AS ""t1"" GROUP BY ""query_name"""
115,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
116,"SELECT ""query_name"",ROUND((SUM(""rating""/""position""))/COUNT(""query_name""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
117,"SELECT DISTINCT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
118,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
119,"SELECT ""x"".""query_name"",ROUND(SUM(""x"".""rating""/""x"".""position"")/COUNT(""x"".""rating""), 2) AS ""quality"",ROUND(SUM(""x"".""flag"")/COUNT(""x"".""rating"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""position"",""rating"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""flag"" FROM ""queries"") AS ""x"" GROUP BY 1"
120,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
121,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
122,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
123,"SELECT ""query_name"",ROUND((SUM(""rating""/""position"")/COUNT(""query_name"")), 2) AS ""quality"",ROUND((COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(""query_name"")*100), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
124,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
125,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
126,"SELECT ""query_name"",CAST(SUM(""rating""/""position"")/COUNT(""query_name"") AS DECIMAL(32, 2)) AS ""quality"",CAST(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100 AS DECIMAL(32, 2)) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
127,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""position""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
128,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
129,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
130,"SELECT ""QUERY_NAME"",ROUND(AVG(""RATING""/""POSITION""), 2) AS ""QUALITY"",ROUND((SUM(CASE WHEN ""RATING""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""POOR_QUERY_PERCENTAGE"" FROM ""Queries"" GROUP BY ""QUERY_NAME"""
131,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
132,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
133,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
134,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
135,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
136,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
137,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",COALESCE(ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1)), 2), 0) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
138,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
139,"SELECT ""QUERY_NAME"",ROUND(AVG(""RATING""/""POSITION""), 2) AS ""QUALITY"",ROUND(AVG(CASE WHEN ""RATING""<3 THEN 1 ELSE 0 END)*100, 2) AS ""POOR_QUERY_PERCENTAGE"" FROM ""QUERIES"" GROUP BY ""QUERY_NAME"""
140,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
141,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(DISTINCT ""result""), 2) AS ""quality"",ROUND((COUNT(CASE WHEN ""rating""<3 THEN ""rating"" ELSE NULL END)/COUNT(DISTINCT ""result""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
142,"SELECT ""query_name"",CAST(SUM((""rating""*1.0)/(""position""*1.0))/COUNT(1) AS DECIMAL(32, 2)) AS ""quality"",CAST((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100.00)/COUNT(""rating"") AS DECIMAL(32, 2)) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""Query_name"""
143,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
144,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
145,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
146,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""*1.0), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100.0/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
147,"SELECT ""query_name"",ROUND(AVG(""rating""*100/""POSITION""))/100 AS ""quality"",ROUND(SUM(""rating""<3)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY NULL"
148,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""result"" ELSE NULL END)/COUNT(""result"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
149,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
150,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
151,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
152,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
153,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(""rating""<3)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
154,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
155,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
156,"SELECT ""query_name"",ROUND((SUM(""rating""/""position""))/COUNT(""query_name""), 2) AS ""quality"",ROUND(((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
157,"SELECT ""query_name"",ROUND(SUM(""qual"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(""poor"")/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",(""rating""/""position"") AS ""qual"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor"" FROM ""Queries"") AS ""base"" GROUP BY ""query_name"""
158,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
159,"SELECT ""query_name"",ROUND(AVG(""rating""*100/""position""), 0)/100 AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
160,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(""rating""<3)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
161,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
162,"SELECT ""QUERY_NAME"",ROUND(AVG(""RATING""/""POSITION""), 2) AS ""QUALITY"",ROUND(AVG(CASE WHEN ""RATING""<3 THEN 1 ELSE 0 END)*100, 2) AS ""POOR_QUERY_PERCENTAGE"" FROM ""QUERIES"" GROUP BY ""QUERY_NAME"""
163,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
164,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(""rating""<3)/COUNT(""result""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
165,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
166,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
167,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
168,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
169,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
170,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
171,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
172,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
173,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
174,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
175,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
176,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
177,"SELECT ""query_name"",ROUND(COALESCE(AVG(""rating""/""position""), 0), 2) AS ""quality"",ROUND(COALESCE(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 0)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
178,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
179,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
180,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
181,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
182,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
183,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
184,"WITH ""cte_quality"" AS (SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1) SELECT * FROM ""cte_quality"""
185,"SELECT ""query_name"",ROUND((AVG(""rating""/""position"")), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
186,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
187,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
188,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
189,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((COUNT(CASE WHEN ""rating""<3 THEN 1 ELSE NULL END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
190,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
191,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
192,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
193,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
194,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
195,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
196,"WITH ""query_quality"" AS (SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"" FROM ""Queries"" GROUP BY 1), ""query_poor_percet"" AS (SELECT ""query_name"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1) SELECT ""t1"".*,""t2"".""poor_query_percentage"" FROM ""query_quality"" AS ""t1"" JOIN ""query_poor_percet"" AS ""t2"" ON ""t1"".""query_name""=""t2"".""query_name"""
197,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""result"" ELSE NULL END)/COUNT(""result"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
198,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
199,"WITH ""cte"" AS (SELECT ""query_name"",""rating""/""position"" AS ""ratio"",""rating"",""position"" FROM ""queries"") SELECT ""query_name"",ROUND(AVG(""ratio""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""cte"" GROUP BY ""query_name"""
200,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""rating"" ELSE NULL END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
201,"SELECT ""query_name"",ROUND(AVG(""rp""), 2) AS ""quality"",ROUND(SUM(""rating_lt_3"")/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating""/""position"" AS ""rp"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""rating_lt_3"",""rating"" FROM ""Queries"") AS ""sub"" GROUP BY ""query_name"""
202,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
203,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
204,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
205,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
206,"SELECT ""query_name"",ROUND(AVG((""rating""/""position"")), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
207,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
208,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
209,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
210,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM((CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
211,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
212,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
213,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
214,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
215,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
216,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
217,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
218,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
219,"SELECT ""query_name"",ROUND(AVG(""q"".""rating""/""position""), 2) AS ""quality"",ROUND((SUM(""rating""<3)/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""q"" GROUP BY ""query_name"""
220,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
221,"SELECT ""query_name"",ROUND(AVG((""rating""/""position"")), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""result"" END)/COUNT(DISTINCT ""result"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
222,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
223,"SELECT ""query_name"",ROUND(SUM(""rating""*1.0/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
224,"SELECT ""x"".""query_name"",ROUND(AVG(""x"".""rating""/""x"".""position""), 2) AS ""quality"",ROUND(SUM(""x"".""flag"")/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""position"",""rating"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""flag"" FROM ""queries"") AS ""x"" GROUP BY 1"
225,"WITH ""x"" AS (SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"" FROM ""queries"" GROUP BY 1), ""y"" AS (SELECT ""q"".""query_name"",ROUND((COUNT(""rating"")/(SELECT COUNT(1) FROM ""queries"" WHERE ""q"".""query_name""=""query_name"" GROUP BY ""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" WHERE ""rating""<3 GROUP BY 1) SELECT ""x"".""query_name"",""x"".""quality"",CASE WHEN ""y"".""poor_query_percentage"" IS NULL THEN 0 ELSE ""y"".""poor_query_percentage"" END AS ""poor_query_percentage"" FROM ""x"" LEFT JOIN ""y"" ON ""x"".""query_name""=""y"".""query_name"""
226,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""result""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""result"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
227,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
228,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
229,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
230,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
231,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
232,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
233,"SELECT ""query_name"",ROUND(AVG(""rating""*100/""position""), 0)/100 AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
234,"WITH ""cte"" AS (SELECT *,ROUND(AVG(""rating""/""position"") OVER (PARTITION BY ""query_name""), 2) AS ""quality"",COUNT(""result"") OVER (PARTITION BY ""query_name"") AS ""total"",COUNT(CASE WHEN ""rating""<3 THEN 1 END) OVER (PARTITION BY ""query_name"") AS ""good"" FROM ""Queries"") SELECT DISTINCT ""query_name"",""quality"",ROUND(""good""*100/""total"", 2) AS ""poor_query_percentage"" FROM ""cte"""
235,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
236,"SELECT ""query_name"",CAST(SUM((""rating""*1.0)/(""position""*1.0))/COUNT(1) AS DECIMAL(32, 2)) AS ""quality"",CAST((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100.00)/COUNT(""rating"") AS DECIMAL(32, 2)) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
237,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
238,"SELECT ""queries"".""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",COALESCE(ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END*100))/COUNT(1), 2), 0) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
239,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
240,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
241,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
242,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
243,"SELECT ""query_name"",ROUND(AVG(""rating""*1.00/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
244,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
245,"SELECT ""query_name"",ROUND(SUM((""rating""/""position""))/COUNT(""query_name""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
246,"WITH ""tmp"" AS (SELECT ""query_name"",ROUND(COALESCE(AVG(""rating""/""position""), 0.00), 2) AS ""quality"" FROM ""Queries"" GROUP BY ""query_name""), ""tb1"" AS (SELECT ""query_name"",COUNT(""rating"") AS ""numer1"" FROM ""Queries"" WHERE ""rating""<3 GROUP BY ""query_name""), ""tb2"" AS (SELECT ""query_name"",COUNT(""rating"") AS ""denom"" FROM ""Queries"" GROUP BY ""query_name""), ""tb3"" AS (SELECT ""query_name"",0 AS ""numer2"" FROM ""Queries"" WHERE ""rating"">=3 GROUP BY ""query_name""), ""tb4"" AS (SELECT ""query_name"",""numer1"" AS ""numer3"" FROM ""tb1"" UNION ALL SELECT ""query_name"",""numer2"" FROM ""tb3""), ""tb5"" AS (SELECT ""query_name"",SUM(""numer3"") AS ""numer"" FROM ""tb4"" GROUP BY ""query_name"") SELECT ""tmp"".""query_name"",""quality"",ROUND(COALESCE(""numer""/""denom""*100, 0.00), 2) AS ""poor_query_percentage"" FROM (""tmp"" LEFT JOIN ""tb5"" ON ""tb5"".""query_name""=""tmp"".""query_name"") LEFT JOIN ""tb2"" ON ""tmp"".""query_name""=""tb2"".""query_name"""
247,"SELECT ""query_name"",ROUND(AVG(""qua""), 2) AS ""quality"",ROUND(AVG(""poor_query"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating"",""rating""/""position"" AS ""qua"",CASE WHEN ""rating"">=3 THEN 0 ELSE 1 END AS ""poor_query"" FROM ""Queries"") AS ""temp"" GROUP BY ""query_name"""
248,"WITH ""q"" AS (SELECT ""query_name"",ROUND(COALESCE(SUM(""rating""/""position"")/COUNT(1), 0), 2) AS ""quality"",COUNT(1) AS ""n_queries"" FROM ""queries"" GROUP BY ""query_name""), ""p"" AS (SELECT ""query_name"",COUNT(1) AS ""poor_queries"" FROM ""queries"" WHERE ""rating""<3 GROUP BY ""query_name"") SELECT ""n"".""query_name"",""quality"",ROUND(COALESCE(""poor_queries""/""n_queries""*100, 0), 2) AS ""poor_query_percentage"" FROM ((SELECT DISTINCT ""query_name"" FROM ""queries"") AS ""n"" LEFT JOIN ""p"" USING (""query_name"")) LEFT JOIN ""q"" USING (""query_name"")"
249,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
250,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
251,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
252,"SELECT ""QUERY_NAME"",ROUND(AVG(""RATING""/""POSITION""), 2) AS ""QUALITY"",ROUND((SUM(CASE WHEN ""RATING""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""POOR_QUERY_PERCENTAGE"" FROM ""Queries"" GROUP BY ""QUERY_NAME"""
253,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
254,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
255,"SELECT ""query_name"",ROUND(1.0*AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100.0*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
256,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
257,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
258,"SELECT ""q"".""query_name"",ROUND(AVG(""q"".""rating""/""q"".""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""q"".""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""q"".""query_name"""
259,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(""rating""<3)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
260,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
261,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
262,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
263,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
264,"SELECT ""query_name"",ROUND(SUM(""RATING""/""POSITION"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(""RATING""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""QUERIES"" GROUP BY ""query_name"""
265,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
266,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
267,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
268,"SELECT ""query_name"" AS ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
269,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
270,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
271,"WITH ""t1"" AS (SELECT DISTINCT ""query_name"",""result"",""position"",""rating"" FROM ""Queries"") SELECT ""h1"" AS ""query_name"",ROUND(AVG(""s1""/""s4""), 2) AS ""quality"",ROUND(COUNT(""s2"")/COUNT(""s1"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""t1"".""query_name"" AS ""h1"",""q"".""query_name"" AS ""h2"",""t1"".""rating"" AS ""s1"",""q"".""rating"" AS ""s2"",""t1"".""position"" AS ""s4"" FROM ""t1"" LEFT JOIN (SELECT * FROM ""t1"" WHERE ""rating""<3) AS ""q"" ON ""t1"".""query_name""=""q"".""query_name"" AND ""q"".""rating""=""t1"".""rating"" AND ""t1"".""result""=""q"".""result"") AS ""gamma"" GROUP BY ""h1"""
272,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
273,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
274,"SELECT ""q2"".""query_name"",ROUND(SUM(""q1"".""rating""/""q1"".""position"")/COUNT(""q1"".""query_name""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""q2"".""rating""<3 THEN 1 ELSE 0 END)/COUNT(""q2"".""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""QUERIES"" AS ""q1"" JOIN ""Queries"" AS ""q2"" USING (""query_name"") GROUP BY ""q2"".""query_name"""
275,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
276,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
277,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
278,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
279,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1 ORDER BY 1 DESC"
280,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
281,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
282,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" AS ""q"" GROUP BY ""query_name"""
283,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
284,"SELECT ""query_name"",CAST(AVG(""rating""*1.0/""position"") AS DECIMAL(10, 2)) AS ""quality"",CAST(AVG(CASE WHEN ""rating""<3 THEN 100.0 ELSE 0 END) AS DECIMAL(10, 2)) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
285,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
286,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
287,"SELECT ""query_name"",ROUND(AVG(""qualityrate""), 2) AS ""quality"",ROUND(AVG(""rate"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""result"",""position"",""rating"",(""rating""/""position"") AS ""qualityrate"",(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END) AS ""rate"" FROM ""Queries"") AS ""tem"" GROUP BY ""query_name"""
288,"SELECT ""q"".""query_name"",ROUND(AVG(""q"".""rating""/""q"".""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""q"".""rating""<3 THEN 1 ELSE 0 END)/COUNT(""q"".""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""q"" GROUP BY ""q"".""query_name"""
289,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
290,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
291,"SELECT ""query_name"",COALESCE(ROUND(AVG(""rating""/""position""), 2), 0) AS ""quality"",COALESCE(ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2), 0) AS ""poor_query_percentage"" FROM (SELECT DISTINCT ""query_name"",""result"",""position"",""rating"" FROM ""Queries"") AS ""Q"" GROUP BY ""query_name"""
292,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
293,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
294,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
295,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
296,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
297,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
298,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
299,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
300,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
301,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
302,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
303,"WITH ""quality"" AS (SELECT DISTINCT ""query_name"",ROUND(AVG(""rating""/""position"") OVER (PARTITION BY ""query_name""), 2) AS ""quality"" FROM ""queries"") SELECT ""a"".""query_name"",""quality"",ROUND((SUM(""a"".""poor_query"")/COUNT(""a"".""query_name""))*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor_query"" FROM ""queries"") AS ""a"" LEFT JOIN ""quality"" ON ""quality"".""query_name""=""a"".""query_name"" GROUP BY ""a"".""query_name"",""quality"""
304,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
305,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
306,"SELECT ""q"".""query_name"",ROUND(AVG(""q"".""rating""/""q"".""position""), 2) AS ""quality"",ROUND((SELECT COUNT(""q1"".""rating"") FROM ""Queries"" AS ""q1"" WHERE ""q1"".""rating""<3 AND ""q1"".""query_name""=""q"".""query_name"")/(SELECT COUNT(1) FROM ""Queries"" AS ""q2"" WHERE ""q2"".""query_name""=""q"".""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""q"" GROUP BY ""q"".""query_name"""
307,"SELECT DISTINCT (""query_name""),ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
308,"SELECT ""t1"".""query_name"",ROUND(AVG(""t1"".""rating""/""t1"".""position""), 2) AS ""quality"",ROUND((COUNT(CASE WHEN ""t1"".""rating""<3 THEN 1 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM (SELECT DISTINCT * FROM ""Queries"") AS ""t1"" GROUP BY ""t1"".""query_name"""
309,"SELECT ""query_name"",ROUND(AVG(""rating""*100/""position""), 0)/100 AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
310,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
311,"SELECT ""query_name"",ROUND(AVG(""rating""*100/""position""), 0)/100 AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
312,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""query_name"" END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
313,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
314,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END))/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
315,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
316,"SELECT DISTINCT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
317,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
318,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
319,"WITH ""queries"" AS (SELECT ""query_name"",""rating""/""position"" AS ""quality"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor_flag"" FROM ""Queries"") SELECT ""query_name"",ROUND(AVG(""quality""), 2) AS ""quality"",ROUND(SUM(""poor_flag"")/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
320,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 100 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
321,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
322,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
323,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
324,"WITH ""a"" AS (SELECT ""query_name"",(COUNT(CASE WHEN ""rating""<3 THEN 1 ELSE NULL END)/COUNT(""rating""))*100 AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name""), ""b"" AS (SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""rating""), 2) AS ""quality"" FROM ""queries"" GROUP BY ""query_name"") SELECT ""b"".""query_name"",""b"".""quality"",ROUND(""a"".""poor_query_percentage"", 2) AS ""poor_query_percentage"" FROM ""a"" JOIN ""b"" ON ""b"".""query_name""=""a"".""query_name"""
325,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
326,"SELECT ""a"".""query_name"",ROUND(AVG(""a"".""rating""/""a"".""position""), 2) AS ""quality"",ROUND(100*(SELECT COUNT(1) FROM ""Queries"" AS ""b"" WHERE ""b"".""query_name""=""a"".""query_name"" AND ""b"".""rating""<3)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""a"" GROUP BY ""a"".""query_name"""
327,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
328,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
329,"SELECT ""a1"".""query_name"",ROUND(AVG(""a1"".""temp""), 2) AS ""quality"",ROUND(100*(SUM(""a1"".""q"")/COUNT(""a1"".""q"")), 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""rating""/""position"" AS ""temp"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""q"" FROM ""Queries"") AS ""a1"" GROUP BY ""a1"".""query_name"""
330,"SELECT ""q"".""query_name"",ROUND(AVG(""q"".""rating""/""q"".""position""), 2) AS ""quality"",ROUND((SELECT COUNT(""q1"".""rating"") FROM ""Queries"" AS ""q1"" WHERE ""q1"".""rating""<3 AND ""q1"".""query_name""=""q"".""query_name"")/(SELECT COUNT(1) FROM ""Queries"" AS ""q2"" WHERE ""q2"".""query_name""=""q"".""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""q"" GROUP BY ""q"".""query_name"""
331,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
332,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
333,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
334,"SELECT ""QUERY_NAME"",ROUND(AVG(""RATING""/""POSITION""), 2) AS ""QUALITY"",ROUND((SUM(CASE WHEN ""RATING""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""POOR_QUERY_PERCENTAGE"" FROM ""Queries"" GROUP BY ""QUERY_NAME"""
335,"SELECT ""query_name"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"",ROUND(SUM(""rating""/""position"")/COUNT(""rating""), 2) AS ""quality"" FROM ""Queries"" GROUP BY ""query_name"""
336,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(COUNT(CASE WHEN ""rating""<3 THEN ""rating"" END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
337,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((AVG(""rating""<3)*100), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
338,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
339,"SELECT ""query_name"",ROUND(AVG(1.0*""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
340,"SELECT ""q"".""query_name"",ROUND(AVG(""q"".""rating""/""q"".""position""), 2) AS ""quality"",ROUND((SELECT COUNT(""q1"".""rating"") FROM ""Queries"" AS ""q1"" WHERE ""q1"".""rating""<3 AND ""q1"".""query_name""=""q"".""query_name"")/(SELECT COUNT(1) FROM ""Queries"" AS ""q2"" WHERE ""q2"".""query_name""=""q"".""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""q"" GROUP BY ""q"".""query_name"""
341,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(""rating""<3)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
342,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
343,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
344,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
345,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
346,"SELECT ""query_name"",ROUND((SUM(""rating""/""position""))/COUNT(""query_name""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100)/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"" ORDER BY ""query_name"""
347,"SELECT ""query_name"",ROUND((SUM(""rating""/""position"")/COUNT(""query_name"")), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
348,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
349,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*COUNT(CASE WHEN ""rating""<3 THEN 1 ELSE NULL END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
350,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
351,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
352,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
353,"SELECT ""q"".""query_name"",ROUND(AVG(""q"".""rating""/""q"".""position""), 2) AS ""quality"",ROUND((SELECT COUNT(""q1"".""rating"") FROM ""Queries"" AS ""q1"" WHERE ""q1"".""rating""<3 AND ""q1"".""query_name""=""q"".""query_name"")/(SELECT COUNT(1) FROM ""Queries"" AS ""q2"" WHERE ""q2"".""query_name""=""q"".""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" AS ""q"" GROUP BY ""q"".""query_name"""
354,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
355,"WITH ""a"" AS (SELECT ""query_name"",(COUNT(CASE WHEN ""rating""<3 THEN 1 ELSE NULL END)/COUNT(""rating""))*100 AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name""), ""b"" AS (SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""rating""), 2) AS ""quality"" FROM ""queries"" GROUP BY ""query_name"") SELECT ""b"".""query_name"",""b"".""quality"",ROUND(""a"".""poor_query_percentage"", 2) AS ""poor_query_percentage"" FROM ""a"" JOIN ""b"" ON ""b"".""query_name""=""a"".""query_name"""
356,"WITH ""metrics"" AS (SELECT *,""rating""*1.0/""position"" AS ""quality"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""is_poor_query"" FROM ""Queries"") SELECT ""query_name"",ROUND(AVG(""quality""), 2) AS ""quality"",ROUND(AVG(""is_poor_query"")*100, 2) AS ""poor_query_percentage"" FROM ""metrics"" GROUP BY 1"
357,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
358,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
359,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
360,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
361,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
362,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
363,"SELECT ""query_name"",ROUND(COALESCE(AVG(""rating""/""position""), 0), 2) AS ""quality"",ROUND(COALESCE(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating""), 0)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
364,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
365,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""rating""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
366,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(1.0*100*COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
367,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""rating""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""rating""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
368,"WITH ""q_cte"" AS (SELECT DISTINCT ""query_name"",""result"",""position"",""rating"" FROM ""queries"") SELECT ""query_name"",ROUND((SUM((""rating"")/(""position"")))/COUNT(1), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""q_cte"" GROUP BY ""query_name"""
369,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name""))*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
370,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
371,"SELECT ""query_name"",ROUND(AVG(""quality""), 2) AS ""quality"",ROUND((AVG(""poor_check"")*100), 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""position"",""rating"",(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END) AS ""poor_check"",""rating""/""position"" AS ""quality"" FROM ""queries"") AS ""a"" GROUP BY ""query_name"""
372,"SELECT ""query_name"",ROUND(AVG(""qua""), 2) AS ""quality"",ROUND(SUM(""rr"")/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM (SELECT ""query_name"",""result"",""position"",""rating"",""rating""/""position"" AS ""qua"",(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END) AS ""rr"" FROM ""queries"") AS ""cte"" GROUP BY 1"
373,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
374,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
375,"WITH ""cte"" AS (SELECT ""query_name"",COUNT(1) AS ""total_count"",SUM(""rating""/""position"") AS ""total_position"",SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END) AS ""total_rating"" FROM ""Queries"" GROUP BY ""query_name"") SELECT ""query_name"",ROUND((""total_position""/""total_count""), 2) AS ""quality"",ROUND((""total_rating""/""total_count"")*100.00, 2) AS ""poor_query_percentage"" FROM ""cte"""
376,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)*100/COUNT(""query_name""), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
377,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
378,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
379,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(1), 2) AS ""quality"",ROUND(100*SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
380,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
381,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(100*AVG(""rating""<3), 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY 1"
382,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
383,"SELECT ""query_name"",COALESCE(ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2), 0) AS ""quality"",COALESCE(ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2), 0) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
384,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((COUNT(CASE WHEN ""rating""<3 THEN 1 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
385,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY ""query_name"""
386,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND((SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(1))*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
387,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(AVG(""rating""<3)*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
388,"SELECT ""query_name"",ROUND(AVG(""rating""/""position""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""rating"")*100, 2) AS ""poor_query_percentage"" FROM ""queries"" GROUP BY 1"
389,"WITH ""CTE"" AS (SELECT ""query_name"",""rating"",""position"",""result"",CASE WHEN ""rating""<3 THEN 1 ELSE 0 END AS ""poor_quality_number"" FROM ""Queries"") SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""result""), 2) AS ""quality"",ROUND(100*SUM(""poor_quality_number"")/COUNT(""result""), 2) AS ""poor_query_percentage"" FROM ""CTE"" GROUP BY ""query_name"""
390,"SELECT ""query_name"",ROUND(SUM(""rating""/""position"")/COUNT(""query_name""), 2) AS ""quality"",ROUND(SUM(CASE WHEN ""rating""<3 THEN 1 ELSE 0 END)/COUNT(""query_name"")*100, 2) AS ""poor_query_percentage"" FROM ""Queries"" GROUP BY ""query_name"""
