id,original query
1,"WITH ""temp"" AS (SELECT ""id"",""country"",""amount"",""state"",LEFT(""trans_date"", 7) AS ""month"" FROM ""Transactions"") SELECT ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE '0' END) AS ""approved_total_amount"" FROM ""temp"" GROUP BY ""month"",""country"""
2,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
3,"WITH ""cte"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2) SELECT * FROM ""cte"""
4,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
5,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
6,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COUNT(DISTINCT CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2 ORDER BY 1,2 DESC"
7,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
8,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
9,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
10,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
11,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
12,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"" ORDER BY ""month"""
13,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
14,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
15,"SELECT ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM (SELECT ""id"",""country"",""state"",""amount"",LEFT(""trans_date"", 7) AS ""month"" FROM ""Transactions"") AS ""t"" GROUP BY ""month"",""country"""
16,"SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM (SELECT ""country"",""state"",""amount"",LEFT(""trans_date"", 7) AS ""month"" FROM ""Transactions"") AS ""t"" GROUP BY ""month"",""country"""
17,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
18,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
19,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
20,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
21,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""trans_date"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,""country"" ORDER BY 1"
22,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
23,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
24,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
25,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
26,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
27,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
28,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"" ORDER BY LEFT(""trans_date"", 7),""country"" DESC"
29,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"" ORDER BY ""country"" DESC"
30,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
31,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""country"",TO_CHAR(""trans_date"", 'YYYY-%m')"
32,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE ""state"" WHEN 'approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE ""state"" WHEN 'approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY SUBSTR(""trans_date"", 1, 7),""country"""
33,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
34,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
35,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
36,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
37,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
38,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""approved_type"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""approved_amount"") AS ""approved_total_amount"" FROM (SELECT *,CASE WHEN ""state""='approved' THEN 1 ELSE 0 END AS ""approved_type"",CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END AS ""approved_amount"" FROM ""Transactions"") AS ""a"" GROUP BY LEFT(""trans_date"", 7),""country"""
39,"SELECT TO_CHAR(""trans_Date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
40,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
41,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
42,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
43,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
44,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
45,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
46,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
47,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""trans_date"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
48,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE ""state"" WHEN 'approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE ""state"" WHEN 'approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
49,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
50,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
51,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
52,"WITH ""t"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",SUM(""amount"") AS ""trans_total_amount"",COUNT(1) AS ""trans_count"" FROM ""transactions"" GROUP BY ""month"",""country""), ""s"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",SUM(""amount"") AS ""approved_total_amount"",COUNT(1) AS ""approved_count"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY ""month"",""country"") SELECT ""month"",""country"",""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""t"" LEFT JOIN ""s"" USING (""month"",""country"") UNION SELECT ""month"",""country"",COALESCE(""trans_count"", 0) AS ""trans_count"",""approved_count"",COALESCE(""trans_total_amount"", 0) AS ""trans_total_amount"",""approved_total_amount"" FROM ""t"" RIGHT JOIN ""s"" USING (""month"",""country"")"
53,"SELECT MID(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
54,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
55,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
56,"SELECT LEFT(""tr"".""trans_date"", 7) AS ""month"",""tr"".""country"" AS ""country"",COUNT(""tr"".""id"") AS ""trans_count"",COUNT(CASE WHEN ""tr"".""state""='approved' THEN ""tr"".""id"" ELSE NULL END) AS ""approved_count"",SUM(""tr"".""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""tr"".""state""='approved' THEN ""tr"".""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""tr"" GROUP BY 1,2"
57,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,""country"""
58,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
59,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
60,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
61,"SELECT ""mt"" AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""st"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""st""*""amount"") AS ""approved_total_amount"" FROM (SELECT TO_CHAR(""TRANS_DATE"", 'YYYY-%m') AS ""mt"",""country"",""id"",CASE WHEN ""state""='approved' THEN 1 ELSE 0 END AS ""st"",""amount"" FROM ""TRANSACTIONS"") AS ""X"" GROUP BY ""mt"",""country"""
62,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""=1) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""=1 THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
63,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",EXTRACT(YEAR FROM ""trans_date""),EXTRACT(MONTH FROM ""trans_date"")"
64,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
65,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY SUBSTRING(""trans_date"", 1, 7),""country"""
66,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state"" LIKE 'approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state"" LIKE 'approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
67,"WITH ""ALL_TRANS"" AS (SELECT TO_CHAR(""TRANS_DATE"", 'YYYY-%m') AS ""month"",""COUNTRY"",COUNT(1) AS ""TRANS_COUNT"",SUM(""AMOUNT"") AS ""TRANS_TOTAL_AMOUNT"" FROM ""TRANSACTIONS"" GROUP BY ""MONTH"",""COUNTRY""), ""APR_TRANS"" AS (SELECT TO_CHAR(""TRANS_DATE"", 'YYYY-%m') AS ""month"",""COUNTRY"",COUNT(1) AS ""APPROVED_COUNT"",SUM(""AMOUNT"") AS ""APPROVED_TOTAL_AMOUNT"" FROM ""TRANSACTIONS"" WHERE ""STATE""='approved' GROUP BY ""MONTH"",""COUNTRY"") SELECT ""T"".""MONTH"",""T"".""COUNTRY"",""T"".""TRANS_COUNT"",COALESCE(""A"".""APPROVED_COUNT"", 0) AS ""APPROVED_COUNT"",""T"".""TRANS_TOTAL_AMOUNT"",COALESCE(""A"".""APPROVED_TOTAL_AMOUNT"", 0) AS ""APPROVED_TOTAL_AMOUNT"" FROM ""ALL_TRANS"" AS ""T"" LEFT JOIN ""APR_TRANS"" AS ""A"" ON ""T"".""MONTH""=""A"".""MONTH"" AND ""T"".""COUNTRY""=""A"".""COUNTRY"""
68,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""trans_total_amount"",SUM(""amount"") AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
69,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT (""id"")) AS ""trans_count"",COUNT(DISTINCT (CASE WHEN ""State""='approved' THEN ""id"" END)) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""State""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
70,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY SUBSTR(""trans_date"", 1, 7),""country"" ORDER BY SUBSTR(""trans_date"", 1, 7),""country"""
71,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
72,"SELECT ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM (SELECT *,TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""Transactions"") AS ""t"" GROUP BY ""month"",""country"""
73,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
74,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",EXTRACT(MONTH FROM ""trans_date"")"
75,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COUNT(DISTINCT CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
76,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
77,"WITH ""T1"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""id"",""country"",""state"",""amount"" FROM ""Transactions""), ""T2"" AS (SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""T1"" GROUP BY 1,2) SELECT * FROM ""T2"""
78,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1,2"
79,"WITH ""total_transaction"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country""), ""approved_transaction"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" WHERE ""state""='approved' GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"") SELECT ""t"".""month"",""t"".""country"",""t"".""trans_count"",COALESCE(""a"".""approved_count"", 0) AS ""approved_count"",""t"".""trans_total_amount"",COALESCE(""a"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""total_transaction"" AS ""t"" LEFT JOIN ""approved_transaction"" AS ""a"" ON ""t"".""month""=""a"".""month"" AND ""t"".""country""=""a"".""country"""
80,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
81,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
82,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(DISTINCT CASE WHEN ""state""='approved' THEN ""id"" END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
83,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
84,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END), 0) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
85,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
86,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"" ORDER BY LEFT(""trans_date"", 7),""country"""
87,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"" ORDER BY ""month"",""country"" DESC"
88,"WITH ""cte"" AS (SELECT LEFT(""trans_date"", 7) AS ""month_"",""country"",COUNT(""id"") AS ""numm"",SUM(""amount"") AS ""amt"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country""), ""cte1"" AS (SELECT LEFT(""trans_date"", 7) AS ""month_"",""country"",COUNT(""id"") AS ""num_"",SUM(""amount"") AS ""amt1"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY LEFT(""trans_date"", 7),""country"") SELECT ""cte"".""month_"" AS ""month"",""cte"".""country"" AS ""country"",""cte"".""numm"" AS ""trans_count"",COALESCE(""cte1"".""num_"", 0) AS ""approved_count"",""cte"".""amt"" AS ""trans_total_amount"",COALESCE(""cte1"".""amt1"", 0) AS ""approved_total_amount"" FROM ""cte"" LEFT JOIN ""cte1"" ON ""cte"".""month_""=""cte1"".""month_"" AND ""cte"".""country""=""cte1"".""country"""
89,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
90,"WITH ""CTE1"" AS (SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",""state"",""amount"" FROM ""Transactions"") SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""CTE1"" GROUP BY ""month"",""country"""
91,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
92,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
93,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
94,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""country"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
95,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
96,"SELECT ""c1"".""year_mon"" AS ""month"",""c1"".""country"",""c1"".""total_trans"" AS ""trans_count"",COALESCE(""c2"".""approve_trans"", 0) AS ""approved_count"",""c1"".""total_trans_amount"" AS ""trans_total_amount"",COALESCE(""c2"".""approve_trans_amount"", 0) AS ""approved_total_amount"" FROM (SELECT ""country"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""year_mon"",COUNT(""country"") AS ""total_trans"",SUM(""amount"") AS ""total_trans_amount"" FROM ""transactions"" GROUP BY ""country"",TO_CHAR(""trans_date"", 'YYYY-%m')) AS ""c1"" LEFT JOIN (SELECT ""country"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""year_mon"",COUNT(""country"") AS ""approve_trans"",SUM(""amount"") AS ""approve_trans_amount"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY ""country"",TO_CHAR(""trans_date"", 'YYYY-%m')) AS ""c2"" ON ""c1"".""country""=""c2"".""country"" AND ""c1"".""year_mon""=""c2"".""year_mon"""
97,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
98,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
99,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY ""month"",""country"""
100,"SELECT ""a"".""month"",""a"".""country"",""a"".""trans_count"",COALESCE(""b"".""approved_count"", 0) AS ""approved_count"",COALESCE(""a"".""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""b"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""transactions"" GROUP BY 1,2) AS ""a"" LEFT JOIN (SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY 1,2) AS ""b"" ON ""a"".""month""=""b"".""month"" AND ""a"".""country""=""b"".""country"""
101,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
102,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
103,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""ID"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
104,"WITH ""trans_fliter"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country""), ""approv_fliter"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY ""month"",""country"") SELECT ""t"".""month"",""t"".""country"",""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""trans_fliter"" AS ""t"" LEFT JOIN ""approv_fliter"" AS ""a"" ON ""t"".""month""=""a"".""month"" AND ""t"".""country""=""a"".""country"""
105,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
106,"WITH ""t"" AS (SELECT *,LEFT(""trans_date"", 7) AS ""month"" FROM ""Transactions"") SELECT DISTINCT ""t1"".""month"",""t1"".""country"",""t1"".""trans_count"",COALESCE(""t2"".""approved_count"", 0) AS ""approved_count"",""t1"".""trans_total_amount"",COALESCE(""t2"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""t"" GROUP BY ""month"",""country"") AS ""t1"" LEFT JOIN (SELECT ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""t"" WHERE ""state""='approved' GROUP BY ""month"",""country"") AS ""t2"" ON ""t1"".""month""=""t2"".""month"" AND ""t1"".""country""=""t2"".""country"""
107,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
108,"SELECT ""month"",""country"",COALESCE(SUM(""trans_count""), 0) AS ""trans_count"",COALESCE(SUM(""approved_count""), 0) AS ""approved_count"",COALESCE(SUM(""trans_total_amount""), 0) AS ""trans_total_amount"",COALESCE(SUM(""approved_total_amount""), 0) AS ""approved_total_amount"" FROM (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(0) AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"",0 AS ""trans_count"",0 AS ""trans_total_amount"" FROM ""Transactions"" AS ""t"" WHERE ""state""='approved' GROUP BY LEFT(""trans_date"", 7),""country"" UNION SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",0 AS ""approved_count"",0 AS ""approved_total_amount"",COUNT(0) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY LEFT(""trans_date"", 7),""country"") AS ""temp"" GROUP BY ""month"",""country"" ORDER BY ""month"",""country"""
109,"WITH ""cte"" AS (SELECT ""id"",""country"",CASE WHEN ""state""='approved' THEN 1 ELSE 0 END AS ""approved_count"",1 AS ""trans_count"",CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END AS ""approved_trans_amount"",""amount"" AS ""trans_total_amount"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""Transactions"") SELECT ""month"",""country"",SUM(""trans_count"") AS ""trans_count"",SUM(""approved_count"") AS ""approved_count"",SUM(""trans_total_amount"") AS ""trans_total_amount"",SUM(""approved_trans_amount"") AS ""approved_total_amount"" FROM ""cte"" GROUP BY ""month"",""country"""
110,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
111,"SELECT ""a"".""month"",""a"".""country"",COALESCE(""trans_count"", 0) AS ""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",COALESCE(""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY 1,2) AS ""a"" LEFT JOIN (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY 1,2) AS ""b"" ON ""a"".""month""=""b"".""month"" AND ""a"".""country""=""b"".""country"""
112,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state"" IN ('approved','declined') THEN ""amount"" ELSE 0 END) AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
113,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1,2"
114,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
115,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
116,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 2,1 ORDER BY 1"
117,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
118,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY SUBSTRING(""trans_date"", 1, 7),""country"""
119,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
120,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
121,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""trans_date"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
122,"SELECT LEFT(""t1"".""trans_date"", 7) AS ""month"",""t1"".""country"",COUNT(""t1"".""state"") AS ""trans_count"",COUNT(""t2"".""state"") AS ""approved_count"",SUM(""t1"".""amount"") AS ""trans_total_amount"",COALESCE(SUM(""t2"".""amount""), 0) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t1"" LEFT JOIN (SELECT * FROM ""Transactions"" WHERE ""state""='approved') AS ""t2"" ON ""t1"".""id""=""t2"".""id"" GROUP BY 1,2"
123,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
124,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
125,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(LEFT(""trans_date"", 7)) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" AS ""t"" GROUP BY ""month"",""country"""
126,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
127,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
128,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
129,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
130,"WITH ""cte"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",SUM(""amount"") AS ""approved_total_amount"",COUNT(""amount"") AS ""approved_count"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country""), ""cte2"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",SUM(""amount"") AS ""trans_total_amount"",COUNT(""amount"") AS ""trans_count"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY LEFT(""trans_date"", 7),""country"") SELECT ""a"".""month"",""a"".""country"",COALESCE(""b"".""trans_count"", 0) AS ""trans_count"",COALESCE(""a"".""approved_count"", 0) AS ""approved_count"",COALESCE(""b"".""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""a"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""cte"" AS ""a"" LEFT JOIN ""cte2"" AS ""b"" ON ""a"".""month""=""b"".""month"" AND ""a"".""country""=""b"".""country"""
131,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2 ORDER BY 1"
132,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
133,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
134,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
135,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
136,"SELECT DISTINCT ""month"",""country"",COUNT(""amount"") OVER (PARTITION BY ""month"", ""country"") AS ""trans_count"",COUNT(""approved_count"") OVER (PARTITION BY ""month"", ""country"") AS ""approved_count"",SUM(""amount"") OVER (PARTITION BY ""month"", ""country"") AS ""trans_total_amount"",SUM(""approved_amount"") OVER (PARTITION BY ""month"", ""country"") AS ""approved_total_amount"" FROM (SELECT *,SUBSTR(""trans_date"", 1, 7) AS ""month"",(CASE WHEN ""state""='approved' THEN ""amount"" ELSE NULL END) AS ""approved_count"",(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_amount"" FROM ""Transactions"") AS ""t"""
137,"SELECT DISTINCT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") OVER (PARTITION BY LEFT(""trans_date"", 7), ""country"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) OVER (PARTITION BY LEFT(""trans_date"", 7), ""country"") AS ""approved_count"",SUM(""amount"") OVER (PARTITION BY LEFT(""trans_date"", 7), ""country"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) OVER (PARTITION BY LEFT(""trans_date"", 7), ""country"") AS ""approved_total_amount"" FROM ""transactions"""
138,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
139,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
140,"SELECT DISTINCT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COALESCE(COUNT(1) OVER (PARTITION BY SUBSTRING(""trans_date"", 1, 7), ""country""), 0) AS ""trans_count"",COALESCE(COUNT(CASE WHEN ""state""='approved' THEN 1 END) OVER (PARTITION BY SUBSTRING(""trans_date"", 1, 7), ""country""), 0) AS ""approved_count"",COALESCE(SUM(""amount"") OVER (PARTITION BY SUBSTRING(""trans_date"", 1, 7), ""country""), 0) AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END) OVER (PARTITION BY SUBSTRING(""trans_date"", 1, 7), ""country""), 0) AS ""approved_total_amount"" FROM ""Transactions"""
141,"SELECT TO_CHAR(CONCAT_WS('-', ""T1"".""trans_year"", ""T1"".""trans_month"", '1'), 'YYYY-%m') AS ""month"",""T1"".""country"",""T1"".""trans_count"",COALESCE(""T2"".""approved_count"", 0) AS ""approved_count"",""T1"".""trans_total_amount"",COALESCE(""T2"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT ""country"",EXTRACT(YEAR FROM ""trans_date"") AS ""trans_year"",EXTRACT(MONTH FROM ""trans_date"") AS ""trans_month"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY ""country"",EXTRACT(YEAR FROM ""trans_date""),EXTRACT(MONTH FROM ""trans_date"")) AS ""T1"" LEFT JOIN (SELECT ""country"",EXTRACT(YEAR FROM ""trans_date"") AS ""trans_year"",EXTRACT(MONTH FROM ""trans_date"") AS ""trans_month"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY ""country"",EXTRACT(YEAR FROM ""trans_date""),EXTRACT(MONTH FROM ""trans_date"")) AS ""T2"" ON ""T1"".""country""=""T2"".""country"" AND ""T1"".""trans_year""=""T2"".""trans_year"" AND ""T1"".""trans_month""=""T2"".""trans_month"""
142,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY ""month"",""country"""
143,"WITH ""Results"" AS (SELECT ""country"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""amount"",CASE WHEN ""state""='approved' THEN ""amount"" ELSE NULL END AS ""approved_amount"" FROM ""Transactions"") SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(""approved_amount"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(COALESCE(""approved_amount"", 0)) AS ""approved_total_amount"" FROM ""Results"" GROUP BY ""month"",""country"""
144,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_Count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
145,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
146,"SELECT ""t1"".""month"",""t1"".""country"",""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"") AS ""t1"" LEFT JOIN (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY ""month"",""country"") AS ""t2"" ON (""t1"".""month""=""t2"".""month"" AND ""t1"".""country""=""t2"".""country"")"
147,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE ""state"" WHEN 'approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
148,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
149,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""trans_date"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
150,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
151,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
152,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM((CASE WHEN ""state""='approved' THEN 1 ELSE 0 END)) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM((CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END)) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
153,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"" FROM ""Transactions"" GROUP BY ""country"",""month"""
154,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
155,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
156,"WITH ""t1"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY 1,2), ""t2"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""=1 GROUP BY 1,2) SELECT ""t1"".""month"",""t1"".""country"",COALESCE(""t1"".""trans_count"", 0) AS ""trans_count"",COALESCE(""t2"".""approved_count"", 0) AS ""approved_count"",COALESCE(""t1"".""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""t2"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""t1"" LEFT JOIN ""t2"" USING (""month"",""country"") UNION SELECT ""t1"".""month"",""t1"".""country"",COALESCE(""t1"".""trans_count"", 0) AS ""trans_count"",COALESCE(""t2"".""approved_count"", 0) AS ""approved_count"",COALESCE(""t1"".""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""t2"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""t1"" RIGHT JOIN ""t2"" USING (""month"",""country"")"
157,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
158,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY 1,2"
159,"SELECT LEFT(""trans_date"", 7) AS ""month"",""t"".""country"",COUNT(""t"".""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY 1,2"
160,"SELECT ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM (SELECT *,TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""transactions"") AS ""temp"" GROUP BY ""month"",""country"""
161,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
162,"SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",""state"",""amount"" FROM ""Transactions"") AS ""t"" GROUP BY ""month"",""country"""
163,"WITH ""tot"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""ym_data"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY ""country"",""ym_data""), ""app"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""ym_data"",""country"",COUNT(1) AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY ""country"",""ym_data"") SELECT ""t"".""ym_data"" AS ""month"",""t"".""country"",""t"".""trans_count"",COALESCE(""p"".""approved_count"", 0) AS ""approved_count"",""t"".""trans_total_amount"",COALESCE(""p"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""tot"" AS ""t"" LEFT JOIN ""app"" AS ""p"" ON ""t"".""country""=""p"".""country"" AND ""t"".""ym_data""=""p"".""ym_data"" ORDER BY ""month"""
164,"SELECT ""C"".""month"",""C"".""country"",COALESCE(""C"".""trans_count"", 0) AS ""trans_count"",COALESCE(""D"".""approved_count"", 0) AS ""approved_count"",COALESCE(""C"".""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""D"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT ""A"".""month"",""A"".""country"",COUNT(""A"".""id"") AS ""trans_count"",SUM(""A"".""amount"") AS ""trans_total_amount"" FROM (SELECT (CASE WHEN EXTRACT(MONTH FROM ""trans_date"")-10<0 THEN CONCAT(EXTRACT(YEAR FROM ""trans_date""), '-0', EXTRACT(MONTH FROM ""trans_date"")) ELSE CONCAT(EXTRACT(YEAR FROM ""trans_date""), '-', EXTRACT(MONTH FROM ""trans_date"")) END) AS ""month"",""country"",""state"",""amount"",""id"" FROM ""Transactions"") AS ""A"" GROUP BY ""A"".""month"",""A"".""country"") AS ""C"" LEFT JOIN (SELECT ""A"".""month"",""A"".""country"",COUNT(""A"".""id"") AS ""approved_count"",SUM(""A"".""amount"") AS ""approved_total_amount"" FROM (SELECT (CASE WHEN EXTRACT(MONTH FROM ""trans_date"")-10<0 THEN CONCAT(EXTRACT(YEAR FROM ""trans_date""), '-0', EXTRACT(MONTH FROM ""trans_date"")) ELSE CONCAT(EXTRACT(YEAR FROM ""trans_date""), '-', EXTRACT(MONTH FROM ""trans_date"")) END) AS ""month"",""country"",""state"",""amount"",""id"" FROM ""Transactions"" WHERE ""state""='approved') AS ""A"" GROUP BY ""A"".""month"",""A"".""country"") AS ""D"" ON ""C"".""month""=""D"".""month"" AND ""C"".""country""=""D"".""country"""
165,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
166,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
167,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""TRansactions"" GROUP BY ""month"",""country"""
168,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
169,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
170,"WITH ""cte1"" AS (SELECT ""id"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""trans_date"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY 1,2) SELECT TO_CHAR(""t"".""trans_date"", 'YYYY-%m') AS ""month"",""t"".""country"",COUNT(""t"".""trans_date"") AS ""trans_count"",COALESCE(COUNT(""c"".""approved_count""), 0) AS ""approved_count"",SUM(""t"".""amount"") AS ""trans_total_amount"",COALESCE(SUM(""c"".""approved_total_amount""), 0) AS ""approved_total_amount"" FROM ""transactions"" AS ""t"" LEFT JOIN ""cte1"" AS ""c"" ON ""t"".""id""=""c"".""id"" GROUP BY 1,2"
171,"WITH ""t1"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY 1,2), ""t2"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY 1,2) SELECT ""t1"".""month"",""t1"".""country"",""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""t1"" LEFT JOIN ""t2"" ON ""t1"".""month""=""t2"".""month"" AND ""t1"".""country""=""t2"".""country"""
172,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2 ORDER BY 1"
173,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
174,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
175,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
176,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"" ORDER BY ""month"",""country"" DESC"
177,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY ""month"",""country"""
178,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,""country"""
179,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM((""state""='approved')*""amount"") AS ""approved_total_amount"" FROM ""transactions"" AS ""t"" GROUP BY EXTRACT(YEAR FROM ""trans_date""),EXTRACT(MONTH FROM ""trans_date""),""country"""
180,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
181,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
182,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,""country"" ORDER BY 1,2 DESC"
183,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
184,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1,2"
185,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
186,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
187,"WITH ""total_transactions"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country""), ""approved_transactions"" AS (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY ""month"",""country"") SELECT ""t"".""month"",""t"".""country"",""t"".""trans_count"",COALESCE(""a"".""approved_count"", 0) AS ""approved_count"",""t"".""trans_total_amount"",COALESCE(""a"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""total_transactions"" AS ""t"" LEFT JOIN ""approved_transactions"" AS ""a"" ON ""t"".""month""=""a"".""month"" AND ""t"".""country""=""a"".""country"""
188,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""amount""*CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
189,"WITH ""newtable"" AS (SELECT *,TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""Transactions"") SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN 1 END), 0) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""newtable"" GROUP BY ""month"",""country"""
190,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
191,"WITH ""cte"" AS (SELECT ""id"",""country"",CASE WHEN ""state""='approved' THEN 1 ELSE 0 END AS ""apr"",""amount"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""Transactions"") SELECT ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""apr"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""amount""*""apr"") AS ""approved_total_amount"" FROM ""cte"" GROUP BY ""month"",""country"""
192,"WITH ""cte"" AS (SELECT *,LEFT(""trans_date"", 7) AS ""month_str"",(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""isApproved"",(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approvedAmount"" FROM ""Transactions"") SELECT ""month_str"" AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""isApproved"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""approvedAmount"") AS ""approved_total_amount"" FROM ""cte"" GROUP BY ""month_str"",""country"""
193,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
194,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
195,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
196,"SELECT CONCAT(EXTRACT(YEAR FROM ""trans_date""), '-', TO_CHAR(""trans_date"", '%m')) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
197,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
198,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='Approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='Approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
199,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
200,"WITH ""cte"" AS (SELECT LEFT(""trans_date"", 7) AS ""month_"",""country"",COUNT(""id"") AS ""numm"",SUM(""amount"") AS ""amt"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country""), ""cte1"" AS (SELECT LEFT(""trans_date"", 7) AS ""month_"",""country"",COUNT(""id"") AS ""num_"",SUM(""amount"") AS ""amt1"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY LEFT(""trans_date"", 7),""country"") SELECT ""cte"".""month_"" AS ""month"",""cte"".""country"" AS ""country"",""cte"".""numm"" AS ""trans_count"",COALESCE(""cte1"".""num_"", 0) AS ""approved_count"",""cte"".""amt"" AS ""trans_total_amount"",COALESCE(""cte1"".""amt1"", 0) AS ""approved_total_amount"" FROM ""cte"" LEFT JOIN ""cte1"" ON ""cte"".""month_""=""cte1"".""month_"" AND ""cte"".""country""=""cte1"".""country"""
201,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",""month"""
202,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
203,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
204,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
205,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
206,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
207,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
208,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
209,"WITH ""cte"" AS (SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",""state"",""amount"",""trans_date"",CASE WHEN ""state""='approved' THEN 1 ELSE 0 END AS ""approved_count"",CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END AS ""approved_amount"" FROM ""transactions"") SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""approved_count"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""approved_amount"") AS ""approved_total_amount"" FROM ""cte"" GROUP BY ""month"",""country"""
210,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 2,1"
211,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
212,"WITH ""trans"" AS (SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""transactions"" GROUP BY 1,2), ""app"" AS (SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""transactions"" WHERE ""state""='approved' GROUP BY 1,2) SELECT ""trans"".""month"",""trans"".""country"",""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""trans"" LEFT JOIN ""app"" ON ""trans"".""month""=""app"".""month"" AND ""trans"".""country""=""app"".""country"""
213,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
214,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
215,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY ""month"",""country"""
216,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
217,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY EXTRACT(MONTH FROM ""trans_date""),""country"""
218,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""state""='approved') AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
219,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(0) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
220,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"" ORDER BY ""month"""
221,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
222,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
223,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
224,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
225,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
226,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COUNT(DISTINCT CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,""country"""
227,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
228,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
229,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
230,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",SUM(CASE WHEN ""state""='approved' THEN 1 WHEN ""state""='declined' THEN 1 ELSE 0 END) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" WHEN ""state""='declined' THEN ""amount"" ELSE 0 END) AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
231,"SELECT ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",""state"",""amount"" FROM ""Transactions"") AS ""t"" GROUP BY ""month"",""country"""
232,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
233,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
234,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
235,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",""month"""
236,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2 ORDER BY 1"
237,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",SUM(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
238,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
239,"SELECT ""t1"".""month"" AS ""month"",""t1"".""country"" AS ""country"",""t1"".""trans_count"" AS ""trans_count"",COALESCE(""t2"".""approved_count"", 0) AS ""approved_count"",""t1"".""trans_total_amount"" AS ""trans_total_amount"",COALESCE(""t2"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY 1,2) AS ""t1"" LEFT JOIN (SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY 1,2) AS ""t2"" ON ""t1"".""month""=""t2"".""month"" AND ""t1"".""country""=""t2"".""country"""
240,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY CONCAT(EXTRACT(YEAR FROM ""trans_date""), EXTRACT(MONTH FROM ""trans_date"")),""country"""
241,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
242,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
243,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
244,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
245,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
246,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COUNT(DISTINCT CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
247,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
248,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"" ORDER BY ""country"" DESC"
249,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
250,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
251,"WITH ""temp"" (""id"", ""country"", ""state"", ""amount"", ""month"") AS (SELECT ""id"",""country"",""state"",""amount"",LEFT(""trans_date"", 7) AS ""month"" FROM ""transactions""), ""temp1"" (""month"", ""country"", ""trans_count"", ""trans_total_amount"") AS (SELECT DISTINCT ""month"",""country"",COUNT(""id"") OVER (PARTITION BY ""month"", ""country"") AS ""trans_count"",SUM(""amount"") OVER (PARTITION BY ""month"", ""country"") AS ""trans_total_amount"" FROM ""temp""), ""temp2"" (""month"", ""country"", ""approved_count"", ""approved_total_amount"") AS (SELECT DISTINCT ""month"",""country"",COUNT(""id"") OVER (PARTITION BY ""month"", ""country"") AS ""approved_count"",SUM(""amount"") OVER (PARTITION BY ""month"", ""country"") AS ""approved_total_amount"" FROM ""temp"" WHERE ""state""='approved') SELECT DISTINCT ""t1"".""month"",""t1"".""country"",""t1"".""trans_count"",COALESCE(""t2"".""approved_count"", 0) AS ""approved_count"",""t1"".""trans_total_amount"",COALESCE(""t2"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""temp1"" AS ""t1"" LEFT JOIN ""temp2"" AS ""t2"" ON ""t1"".""month""=""t2"".""month"" AND ""t1"".""country""=""t2"".""country"" ORDER BY ""month"",""country"" DESC"
252,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
253,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
254,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
255,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
256,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"",COUNT(CASE WHEN ""state""='approved' THEN ""id"" ELSE NULL END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
257,"SELECT ""a"".""month"",""a"".""country"",""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"") AS ""a"" LEFT JOIN (SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY ""month"",""country"") AS ""b"" ON ""a"".""month""=""b"".""month"" AND ""a"".""country""=""b"".""country"""
258,"SELECT CASE WHEN LENGTH(""month"")=6 THEN CONCAT(SUBSTRING(""month"", 1, 5), '0', SUBSTRING(""month"", -1, 1)) ELSE ""month"" END AS ""month"",""country"",""trans"" AS ""trans_count"",""app"" AS ""approved_count"",""total"" AS ""trans_total_amount"",""app_tot"" AS ""approved_total_amount"" FROM (SELECT ""country"",CONCAT_WS('-', EXTRACT(YEAR FROM ""trans_date""), EXTRACT(MONTH FROM ""trans_date"")) AS ""month"",SUM(""amount"") AS ""total"",SUM(CASE WHEN ""state"" LIKE 'approved' THEN ""amount"" ELSE 0 END) AS ""app_tot"",SUM(CASE WHEN ""state"" LIKE 'approved' THEN 1 ELSE 0 END) AS ""app"",COUNT(""id"") AS ""trans"" FROM ""transactions"" GROUP BY ""month"",""country"") AS ""t"""
259,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
260,"SELECT ""t1"".""dt"" AS ""month"",""t1"".""country"",COALESCE(""t1"".""tot_cnt"", 0) AS ""trans_count"",COALESCE(""t2"".""tot_cnt"", 0) AS ""approved_count"",COALESCE(""t1"".""tot"", 0) AS ""trans_total_amount"",COALESCE(""t2"".""tot"", 0) AS ""approved_total_amount"" FROM (SELECT LEFT(""trans_date"", 7) AS ""dt"",""country"",SUM(""amount"") AS ""tot"",COUNT(""id"") AS ""tot_cnt"" FROM ""Transactions"" GROUP BY 1,2) AS ""t1"" LEFT JOIN (SELECT LEFT(""trans_date"", 7) AS ""dt"",""country"",SUM(""amount"") AS ""tot"",COUNT(""id"") AS ""tot_cnt"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY 1,2) AS ""t2"" ON ""t1"".""dt""=""t2"".""dt"" AND ""t1"".""country""=""t2"".""country"" GROUP BY 1,2"
261,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"" ORDER BY LEFT(""trans_date"", 7),""country"" DESC"
262,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
263,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
264,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
265,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
266,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
267,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
268,"SELECT DISTINCT ""a"".""month"",""a"".""country"",COUNT(""a"".""state"") OVER (PARTITION BY ""a"".""month"", ""a"".""country"") AS ""trans_count"",SUM(CASE WHEN ""state""='A' THEN 1 ELSE 0 END) OVER (PARTITION BY ""a"".""month"", ""a"".""country"") AS ""approved_count"",SUM(""a"".""AMOUNT"") OVER (PARTITION BY ""a"".""month"", ""a"".""country"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='A' THEN ""a"".""amount"" ELSE 0 END) OVER (PARTITION BY ""a"".""month"", ""a"".""country"") AS ""approved_total_amount"" FROM (SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",CASE WHEN ""state""='approved' THEN 'A' ELSE 'D' END AS ""state"",""amount"" FROM ""transactions"") AS ""a"""
269,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
270,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
271,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
272,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
273,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
274,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
275,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
276,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
277,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
278,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""amount"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
279,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
280,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
281,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
282,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
283,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
284,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
285,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
286,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM((""state""='approved')*""amount"") AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
287,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
288,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
289,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END*""amount"") AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
290,"SELECT DISTINCT ""new_date"" AS ""month"",""country"",COUNT(""id"") OVER (PARTITION BY ""new_date"", ""country"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) OVER (PARTITION BY ""new_date"", ""country"") AS ""approved_count"",SUM(""amount"") OVER (PARTITION BY ""new_date"", ""country"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) OVER (PARTITION BY ""new_date"", ""country"") AS ""approved_total_amount"" FROM (SELECT *,TO_CHAR(""trans_date"", 'YYYY-%m') AS ""new_date"" FROM ""transactions"") AS ""sub"" ORDER BY ""trans_date"""
291,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN 1 END), 0) AS ""approved_count"",COALESCE(SUM(""amount""), 0) AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1"
292,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
293,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
294,"SELECT ""country"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",COUNT(1) AS ""trans_count"" FROM ""Transactions"" GROUP BY EXTRACT(MONTH FROM ""trans_date""),EXTRACT(YEAR FROM ""trans_date""),""country"""
295,"WITH ""T1"" AS (SELECT ""id"",""country"",CASE WHEN ""state""='approved' THEN 1 ELSE 0 END AS ""approved_state"",""amount"",CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END AS ""approved_amount"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""Transactions"") SELECT ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""approved_state"") AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(""approved_amount"") AS ""approved_total_amount"" FROM ""T1"" GROUP BY ""month"",""country"""
296,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
297,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
298,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",EXTRACT(MONTH FROM ""trans_date"")"
299,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",EXTRACT(MONTH FROM ""trans_date"")"
300,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""=1 THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
301,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
302,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY LEFT(""trans_date"", 7),""country"""
303,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
304,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""country"",EXTRACT(MONTH FROM ""trans_date"")"
305,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
306,"WITH ""trans"" AS (SELECT EXTRACT(YEAR FROM ""t"".""trans_date"") AS ""year"",EXTRACT(MONTH FROM ""t"".""trans_date"") AS ""month"",""t"".""country"",COUNT(1) AS ""trans_count"",SUM(""t"".""amount"") AS ""trans_total_amount"" FROM ""Transactions"" AS ""t"" GROUP BY 1,2,3), ""approved"" AS (SELECT EXTRACT(YEAR FROM ""t"".""trans_date"") AS ""year"",EXTRACT(MONTH FROM ""t"".""trans_date"") AS ""month"",""t"".""country"",COUNT(1) AS ""approved_count"",SUM(""t"".""amount"") AS ""approved_total_amount"" FROM ""Transactions"" AS ""t"" WHERE ""state""='approved' GROUP BY 1,2,3) SELECT CASE WHEN LENGTH(""t"".""month"")=1 THEN CONCAT(""t"".""year"", '-0', ""t"".""month"") ELSE CONCAT(""t"".""year"", '-', ""t"".""month"") END AS ""month"",""t"".""country"",COALESCE(""t"".""trans_count"", 0) AS ""trans_count"",COALESCE(""a"".""approved_count"", 0) AS ""approved_count"",COALESCE(""t"".""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""a"".""approved_total_amount"", 0) AS ""approved_total_amount"" FROM ""trans"" AS ""t"" LEFT JOIN ""approved"" AS ""a"" ON ""t"".""year""=""a"".""year"" AND ""t"".""month""=""a"".""month"" AND ""t"".""country""=""a"".""country"" WHERE ""t"".""trans_count"" IS NOT NULL"
307,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
308,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
309,"SELECT ""T1"".""month"",""T1"".""country"",""trans_count"",""trans_total_amount"",COALESCE(""approved_count"", 0) AS ""approved_count"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"") AS ""T1"" LEFT JOIN (SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"") AS ""T2"" ON ""T1"".""month""=""T2"".""month"" AND ""T1"".""country""=""T2"".""country"""
310,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
311,"WITH ""T1"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""approved_count"",SUM(""amount"") AS ""approved_total_amount"" FROM ""Transactions"" WHERE ""state""='approved' GROUP BY ""month"",""country""), ""T2"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(""amount"") AS ""trans_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country""), ""T3"" AS (SELECT LEFT(""trans_date"", 7) AS ""month"",""country"" FROM ""Transactions"") SELECT DISTINCT ""T3"".""month"",""T3"".""country"",COALESCE(""trans_count"", 0) AS ""trans_count"",COALESCE(""approved_count"", 0) AS ""approved_count"",COALESCE(""trans_total_amount"", 0) AS ""trans_total_amount"",COALESCE(""approved_total_amount"", 0) AS ""approved_total_amount"" FROM (""T3"" LEFT JOIN ""T2"" ON ""T2"".""month""=""T3"".""month"" AND ""T2"".""country""=""T3"".""country"") LEFT JOIN ""T1"" ON ""T1"".""month""=""T2"".""month"" AND ""T1"".""country""=""T2"".""country"""
312,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
313,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""trans_date"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(CASE WHEN ""state""='approved' OR ""state""='declined' THEN ""Amount"" ELSE 0 END) AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""Amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",""month"""
314,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
315,"WITH ""cte"" AS (SELECT ""country"",""state"",""amount"",TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"" FROM ""transactions"") SELECT ""month"",""country"",COUNT(""amount"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""cte"" GROUP BY ""month"",""country"""
316,"SELECT MID(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
317,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE ""state"" WHEN 'approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE ""state"" WHEN 'approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
318,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
319,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN ""state"" ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
320,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(DISTINCT ""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
321,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END), 0) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",COALESCE(SUM(CASE WHEN ""state""='approved' THEN ""amount"" END), 0) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
322,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
323,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
324,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
325,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 ELSE NULL END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
326,"SELECT SUBSTR(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2 ORDER BY 1,2"
327,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY TO_CHAR(""trans_date"", 'YYYY-%m'),""country"""
328,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
329,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY EXTRACT(MONTH FROM ""trans_date""),""country"""
330,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY 1,2"
331,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
332,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"""
333,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(""state""='approved') AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""country"",""month"""
334,"SELECT SUBSTRING(""trans_date"", 1, 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
335,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(""state"") AS ""trans_count"",COUNT(CASE WHEN ""state""='approved' THEN 1 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""transactions"" GROUP BY ""month"",""country"" ORDER BY ""month"""
336,"SELECT TO_CHAR(""trans_date"", 'YYYY-%m') AS ""month"",""country"",COUNT(1) AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
337,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY ""month"",""country"""
338,"SELECT LEFT(""trans_date"", 7) AS ""month"",""country"",COUNT(""id"") AS ""trans_count"",SUM(CASE WHEN ""state""='approved' THEN 1 ELSE 0 END) AS ""approved_count"",SUM(""amount"") AS ""trans_total_amount"",SUM(CASE WHEN ""state""='approved' THEN ""amount"" ELSE 0 END) AS ""approved_total_amount"" FROM ""Transactions"" GROUP BY 1,2"
